import{createRequire as __WEBPACK_EXTERNAL_createRequire}from"module";var __webpack_modules__={896:(e,t,r)=>{e.exports=r.p+"293248747edf5d37944a.js?."},339:e=>{e.exports=__WEBPACK_EXTERNAL_createRequire(import.meta.url)("module")}};var __webpack_module_cache__={};function __nccwpck_require__(e){var t=__webpack_module_cache__[e];if(t!==undefined){return t.exports}var r=__webpack_module_cache__[e]={exports:{}};var n=true;try{__webpack_modules__[e](r,r.exports,__nccwpck_require__);n=false}finally{if(n)delete __webpack_module_cache__[e]}return r.exports}__nccwpck_require__.m=__webpack_modules__;(()=>{__nccwpck_require__.d=(e,t)=>{for(var r in t){if(__nccwpck_require__.o(t,r)&&!__nccwpck_require__.o(e,r)){Object.defineProperty(e,r,{enumerable:true,get:t[r]})}}}})();(()=>{__nccwpck_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})();(()=>{var e;if(typeof import.meta.url==="string")e=import.meta.url;if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/");__nccwpck_require__.p=e})();if(typeof __nccwpck_require__!=="undefined")__nccwpck_require__.ab=new URL(".",import.meta.url).pathname.slice(import.meta.url.match(/^file:\/\/\/\w:/)?1:0,-1)+"/";(()=>{__nccwpck_require__.b=new URL("./",import.meta.url);var e={792:0}})();var __webpack_exports__={};__nccwpck_require__.d(__webpack_exports__,{$:()=>__webpack_exports__config,A:()=>__webpack_exports__default});var module__WEBPACK_IMPORTED_MODULE_0__=__nccwpck_require__(339);var __webpack_modules__={8772:(e,t,r)=>{const n=r(5317);const{isLinux:i,getReport:o}=r(3235);const{LDD_PATH:s,SELF_PATH:a,readFile:l,readFileSync:c}=r(3991);const{interpreterPath:h}=r(167);let u;let p;let d;const m="getconf GNU_LIBC_VERSION 2>&1 || true; ldd --version 2>&1 || true";let g="";const safeCommand=()=>{if(!g){return new Promise((e=>{n.exec(m,((t,r)=>{g=t?" ":r;e(g)}))}))}return g};const safeCommandSync=()=>{if(!g){try{g=n.execSync(m,{encoding:"utf8"})}catch(e){g=" "}}return g};const b="glibc";const w=/LIBC[a-z0-9 \-).]*?(\d+\.\d+)/i;const E="musl";const isFileMusl=e=>e.includes("libc.musl-")||e.includes("ld-musl-");const familyFromReport=()=>{const e=o();if(e.header&&e.header.glibcVersionRuntime){return b}if(Array.isArray(e.sharedObjects)){if(e.sharedObjects.some(isFileMusl)){return E}}return null};const familyFromCommand=e=>{const[t,r]=e.split(/[\r\n]+/);if(t&&t.includes(b)){return b}if(r&&r.includes(E)){return E}return null};const familyFromInterpreterPath=e=>{if(e){if(e.includes("/ld-musl-")){return E}else if(e.includes("/ld-linux-")){return b}}return null};const getFamilyFromLddContent=e=>{e=e.toString();if(e.includes("musl")){return E}if(e.includes("GNU C Library")){return b}return null};const familyFromFilesystem=async()=>{if(p!==undefined){return p}p=null;try{const e=await l(s);p=getFamilyFromLddContent(e)}catch(e){}return p};const familyFromFilesystemSync=()=>{if(p!==undefined){return p}p=null;try{const e=c(s);p=getFamilyFromLddContent(e)}catch(e){}return p};const familyFromInterpreter=async()=>{if(u!==undefined){return u}u=null;try{const e=await l(a);const t=h(e);u=familyFromInterpreterPath(t)}catch(e){}return u};const familyFromInterpreterSync=()=>{if(u!==undefined){return u}u=null;try{const e=c(a);const t=h(e);u=familyFromInterpreterPath(t)}catch(e){}return u};const family=async()=>{let e=null;if(i()){e=await familyFromInterpreter();if(!e){e=await familyFromFilesystem();if(!e){e=familyFromReport()}if(!e){const t=await safeCommand();e=familyFromCommand(t)}}}return e};const familySync=()=>{let e=null;if(i()){e=familyFromInterpreterSync();if(!e){e=familyFromFilesystemSync();if(!e){e=familyFromReport()}if(!e){const t=safeCommandSync();e=familyFromCommand(t)}}}return e};const isNonGlibcLinux=async()=>i()&&await family()!==b;const isNonGlibcLinuxSync=()=>i()&&familySync()!==b;const versionFromFilesystem=async()=>{if(d!==undefined){return d}d=null;try{const e=await l(s);const t=e.match(w);if(t){d=t[1]}}catch(e){}return d};const versionFromFilesystemSync=()=>{if(d!==undefined){return d}d=null;try{const e=c(s);const t=e.match(w);if(t){d=t[1]}}catch(e){}return d};const versionFromReport=()=>{const e=o();if(e.header&&e.header.glibcVersionRuntime){return e.header.glibcVersionRuntime}return null};const versionSuffix=e=>e.trim().split(/\s+/)[1];const versionFromCommand=e=>{const[t,r,n]=e.split(/[\r\n]+/);if(t&&t.includes(b)){return versionSuffix(t)}if(r&&n&&r.includes(E)){return versionSuffix(n)}return null};const version=async()=>{let e=null;if(i()){e=await versionFromFilesystem();if(!e){e=versionFromReport()}if(!e){const t=await safeCommand();e=versionFromCommand(t)}}return e};const versionSync=()=>{let e=null;if(i()){e=versionFromFilesystemSync();if(!e){e=versionFromReport()}if(!e){const t=safeCommandSync();e=versionFromCommand(t)}}return e};e.exports={GLIBC:b,MUSL:E,family:family,familySync:familySync,isNonGlibcLinux:isNonGlibcLinux,isNonGlibcLinuxSync:isNonGlibcLinuxSync,version:version,versionSync:versionSync}},167:e=>{const interpreterPath=e=>{if(e.length<64){return null}if(e.readUInt32BE(0)!==2135247942){return null}if(e.readUInt8(4)!==2){return null}if(e.readUInt8(5)!==1){return null}const t=e.readUInt32LE(32);const r=e.readUInt16LE(54);const n=e.readUInt16LE(56);for(let i=0;i<n;i++){const n=t+i*r;const o=e.readUInt32LE(n);if(o===3){const t=e.readUInt32LE(n+8);const r=e.readUInt32LE(n+32);return e.subarray(t,t+r).toString().replace(/\0.*$/g,"")}}return null};e.exports={interpreterPath:interpreterPath}},3991:(e,t,r)=>{const n=r(9896);const i="/usr/bin/ldd";const o="/proc/self/exe";const s=2048;const readFileSync=e=>{const t=n.openSync(e,"r");const r=Buffer.alloc(s);const i=n.readSync(t,r,0,s,0);n.close(t,(()=>{}));return r.subarray(0,i)};const readFile=e=>new Promise(((t,r)=>{n.open(e,"r",((e,i)=>{if(e){r(e)}else{const e=Buffer.alloc(s);n.read(i,e,0,s,0,((r,o)=>{t(e.subarray(0,o));n.close(i,(()=>{}))}))}}))}));e.exports={LDD_PATH:i,SELF_PATH:o,readFileSync:readFileSync,readFile:readFile}},3235:e=>{const isLinux=()=>process.platform==="linux";let t=null;const getReport=()=>{if(!t){if(isLinux()&&process.report){const e=process.report.excludeNetwork;process.report.excludeNetwork=true;t=process.report.getReport();process.report.excludeNetwork=e}else{t={}}}return t};e.exports={isLinux:isLinux,getReport:getReport}},7586:(e,t,r)=>{e=r.nmd(e);var n,i;i=function(){function kMeans(e){var t,r,n,i,o;if(e==null){e={}}this.K=(t=e.K)!=null?t:5;this.maxIterations=(r=e.maxIterations)!=null?r:100;this.enableConvergenceTest=(n=e.enableConvergenceTest)!=null?n:true;this.tolerance=(i=e.tolerance)!=null?i:1e-9;this.initialize=(o=e.initialize)!=null?o:kMeans.initializeForgy}kMeans.prototype.cluster=function(e){var t;this.X=e;this.prevCentroids=[];this.clusters=[];this.currentIteration=0;t=[this.X.length,this.X[0].length],this.m=t[0],this.n=t[1];if(this.m==null||this.n==null||this.m<this.K||this.n<1){throw"You must pass more data"}return this.centroids=this.initialize(this.X,this.K,this.m,this.n)};kMeans.prototype.step=function(){return this.currentIteration++<this.maxIterations};kMeans.prototype.autoCluster=function(e){var t;this.cluster(e);t=[];while(this.step()){this.findClosestCentroids();this.moveCentroids();if(this.hasConverged()){break}else{t.push(void 0)}}return t};kMeans.initializeForgy=function(e,t,r,n){var i,o,s;s=[];for(i=o=0;0<=t?o<t:o>t;i=0<=t?++o:--o){s.push(e[Math.floor(Math.random()*r)])}return s};kMeans.initializeInRange=function(e,t,r,n){var i,o,s,a,l,c,h,u,p,d,m,g,b,w;for(o=h=0;0<=n?h<n:h>n;o=0<=n?++h:--h){l=Infinity}for(o=u=0;0<=n?u<n:u>n;o=0<=n?++u:--u){a=-Infinity}for(p=0,m=e.length;p<m;p++){c=e[p];for(o=d=0,g=c.length;d<g;o=++d){i=c[o];l[o]=Math.min(l[o],i);a[o]=Math.max(a[o],i)}}w=[];for(s=b=0;0<=t?b<t:b>t;s=0<=t?++b:--b){w.push(function(){var e,t;t=[];for(i=e=0;0<=n?e<n:e>n;i=0<=n?++e:--e){t.push(Math.random()*(a[i]-l[i])+l[i])}return t}())}return w};kMeans.prototype.findClosestCentroids=function(){var e,t,r,n,i,o,s,a,l,c,h,u,p,d,m,g,b,w;if(this.enableConvergenceTest){this.prevCentroids=function(){var e,t,r,n;r=this.centroids;n=[];for(e=0,t=r.length;e<t;e++){s=r[e];n.push(s.slice(0))}return n}.call(this)}this.clusters=function(){var e,t,n;n=[];for(r=e=0,t=this.K;0<=t?e<t:e>t;r=0<=t?++e:--e){n.push([])}return n}.call(this);m=this.X;w=[];for(r=c=0,p=m.length;c<p;r=++c){a=m[r];t=0;l=Infinity;g=this.centroids;for(n=h=0,d=g.length;h<d;n=++h){e=g[n];o=0;for(i=u=0,b=a.length;0<=b?u<b:u>b;i=0<=b?++u:--u){o+=(a[i]-e[i])*(a[i]-e[i])}if(o<l){t=n;l=o}}w.push(this.clusters[t].push(r))}return w};kMeans.prototype.moveCentroids=function(){var e,t,r,n,i,o,s,a,l;a=this.clusters;l=[];for(r=o=0,s=a.length;o<s;r=++o){e=a[r];if(e.length<1){continue}l.push(function(){var o,s,a,l,c;c=[];for(n=o=0,l=this.n;0<=l?o<l:o>l;n=0<=l?++o:--o){i=0;for(s=0,a=e.length;s<a;s++){t=e[s];i+=this.X[t][n]}c.push(this.centroids[r][n]=i/e.length)}return c}.call(this))}return l};kMeans.prototype.hasConverged=function(){var e,t,r,n,i,o,s;if(!this.enableConvergenceTest){return false}for(t=n=0,o=this.n;0<=o?n<o:n>o;t=0<=o?++n:--n){for(r=i=0,s=this.m;0<=s?i<s:i>s;r=0<=s?++i:--i){e=Math.abs(this.prevCentroids[t][r]-this.centroids[t][r]);if(this.tolerance>e){return true}}}return false};return kMeans}();if((true&&e!==null?e.exports:void 0)!=null||typeof n!=="undefined"&&n!==null){e.exports=n=i}else{window.kMeans=i}},6747:(e,t,r)=>{const n=Symbol("SemVer ANY");class Comparator{static get ANY(){return n}constructor(e,t){t=i(t);if(e instanceof Comparator){if(e.loose===!!t.loose){return e}else{e=e.value}}e=e.trim().split(/\s+/).join(" ");l("comparator",e,t);this.options=t;this.loose=!!t.loose;this.parse(e);if(this.semver===n){this.value=""}else{this.value=this.operator+this.semver.version}l("comp",this)}parse(e){const t=this.options.loose?o[s.COMPARATORLOOSE]:o[s.COMPARATOR];const r=e.match(t);if(!r){throw new TypeError(`Invalid comparator: ${e}`)}this.operator=r[1]!==undefined?r[1]:"";if(this.operator==="="){this.operator=""}if(!r[2]){this.semver=n}else{this.semver=new c(r[2],this.options.loose)}}toString(){return this.value}test(e){l("Comparator.test",e,this.options.loose);if(this.semver===n||e===n){return true}if(typeof e==="string"){try{e=new c(e,this.options)}catch(e){return false}}return a(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof Comparator)){throw new TypeError("a Comparator is required")}if(this.operator===""){if(this.value===""){return true}return new h(e.value,t).test(this.value)}else if(e.operator===""){if(e.value===""){return true}return new h(this.value,t).test(e.semver)}t=i(t);if(t.includePrerelease&&(this.value==="<0.0.0-0"||e.value==="<0.0.0-0")){return false}if(!t.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))){return false}if(this.operator.startsWith(">")&&e.operator.startsWith(">")){return true}if(this.operator.startsWith("<")&&e.operator.startsWith("<")){return true}if(this.semver.version===e.semver.version&&this.operator.includes("=")&&e.operator.includes("=")){return true}if(a(this.semver,"<",e.semver,t)&&this.operator.startsWith(">")&&e.operator.startsWith("<")){return true}if(a(this.semver,">",e.semver,t)&&this.operator.startsWith("<")&&e.operator.startsWith(">")){return true}return false}}e.exports=Comparator;const i=r(1788);const{safeRe:o,t:s}=r(5047);const a=r(286);const l=r(8895);const c=r(5075);const h=r(2566)},2566:(e,t,r)=>{const n=/\s+/g;class Range{constructor(e,t){t=s(t);if(e instanceof Range){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease){return e}else{return new Range(e.raw,t)}}if(e instanceof a){this.raw=e.value;this.set=[[e]];this.formatted=undefined;return this}this.options=t;this.loose=!!t.loose;this.includePrerelease=!!t.includePrerelease;this.raw=e.trim().replace(n," ");this.set=this.raw.split("||").map((e=>this.parseRange(e.trim()))).filter((e=>e.length));if(!this.set.length){throw new TypeError(`Invalid SemVer Range: ${this.raw}`)}if(this.set.length>1){const e=this.set[0];this.set=this.set.filter((e=>!isNullSet(e[0])));if(this.set.length===0){this.set=[e]}else if(this.set.length>1){for(const e of this.set){if(e.length===1&&isAny(e[0])){this.set=[e];break}}}}this.formatted=undefined}get range(){if(this.formatted===undefined){this.formatted="";for(let e=0;e<this.set.length;e++){if(e>0){this.formatted+="||"}const t=this.set[e];for(let e=0;e<t.length;e++){if(e>0){this.formatted+=" "}this.formatted+=t[e].toString().trim()}}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){const t=(this.options.includePrerelease&&g)|(this.options.loose&&b);const r=t+":"+e;const n=o.get(r);if(n){return n}const i=this.options.loose;const s=i?h[u.HYPHENRANGELOOSE]:h[u.HYPHENRANGE];e=e.replace(s,hyphenReplace(this.options.includePrerelease));l("hyphen replace",e);e=e.replace(h[u.COMPARATORTRIM],p);l("comparator trim",e);e=e.replace(h[u.TILDETRIM],d);l("tilde trim",e);e=e.replace(h[u.CARETTRIM],m);l("caret trim",e);let c=e.split(" ").map((e=>parseComparator(e,this.options))).join(" ").split(/\s+/).map((e=>replaceGTE0(e,this.options)));if(i){c=c.filter((e=>{l("loose invalid filter",e,this.options);return!!e.match(h[u.COMPARATORLOOSE])}))}l("range list",c);const w=new Map;const E=c.map((e=>new a(e,this.options)));for(const e of E){if(isNullSet(e)){return[e]}w.set(e.value,e)}if(w.size>1&&w.has("")){w.delete("")}const v=[...w.values()];o.set(r,v);return v}intersects(e,t){if(!(e instanceof Range)){throw new TypeError("a Range is required")}return this.set.some((r=>isSatisfiable(r,t)&&e.set.some((e=>isSatisfiable(e,t)&&r.every((r=>e.every((e=>r.intersects(e,t)))))))))}test(e){if(!e){return false}if(typeof e==="string"){try{e=new c(e,this.options)}catch(e){return false}}for(let t=0;t<this.set.length;t++){if(testSet(this.set[t],e,this.options)){return true}}return false}}e.exports=Range;const i=r(95);const o=new i;const s=r(1788);const a=r(6747);const l=r(8895);const c=r(5075);const{safeRe:h,t:u,comparatorTrimReplace:p,tildeTrimReplace:d,caretTrimReplace:m}=r(5047);const{FLAG_INCLUDE_PRERELEASE:g,FLAG_LOOSE:b}=r(3493);const isNullSet=e=>e.value==="<0.0.0-0";const isAny=e=>e.value==="";const isSatisfiable=(e,t)=>{let r=true;const n=e.slice();let i=n.pop();while(r&&n.length){r=n.every((e=>i.intersects(e,t)));i=n.pop()}return r};const parseComparator=(e,t)=>{e=e.replace(h[u.BUILD],"");l("comp",e,t);e=replaceCarets(e,t);l("caret",e);e=replaceTildes(e,t);l("tildes",e);e=replaceXRanges(e,t);l("xrange",e);e=replaceStars(e,t);l("stars",e);return e};const isX=e=>!e||e.toLowerCase()==="x"||e==="*";const replaceTildes=(e,t)=>e.trim().split(/\s+/).map((e=>replaceTilde(e,t))).join(" ");const replaceTilde=(e,t)=>{const r=t.loose?h[u.TILDELOOSE]:h[u.TILDE];return e.replace(r,((t,r,n,i,o)=>{l("tilde",e,t,r,n,i,o);let s;if(isX(r)){s=""}else if(isX(n)){s=`>=${r}.0.0 <${+r+1}.0.0-0`}else if(isX(i)){s=`>=${r}.${n}.0 <${r}.${+n+1}.0-0`}else if(o){l("replaceTilde pr",o);s=`>=${r}.${n}.${i}-${o} <${r}.${+n+1}.0-0`}else{s=`>=${r}.${n}.${i} <${r}.${+n+1}.0-0`}l("tilde return",s);return s}))};const replaceCarets=(e,t)=>e.trim().split(/\s+/).map((e=>replaceCaret(e,t))).join(" ");const replaceCaret=(e,t)=>{l("caret",e,t);const r=t.loose?h[u.CARETLOOSE]:h[u.CARET];const n=t.includePrerelease?"-0":"";return e.replace(r,((t,r,i,o,s)=>{l("caret",e,t,r,i,o,s);let a;if(isX(r)){a=""}else if(isX(i)){a=`>=${r}.0.0${n} <${+r+1}.0.0-0`}else if(isX(o)){if(r==="0"){a=`>=${r}.${i}.0${n} <${r}.${+i+1}.0-0`}else{a=`>=${r}.${i}.0${n} <${+r+1}.0.0-0`}}else if(s){l("replaceCaret pr",s);if(r==="0"){if(i==="0"){a=`>=${r}.${i}.${o}-${s} <${r}.${i}.${+o+1}-0`}else{a=`>=${r}.${i}.${o}-${s} <${r}.${+i+1}.0-0`}}else{a=`>=${r}.${i}.${o}-${s} <${+r+1}.0.0-0`}}else{l("no pr");if(r==="0"){if(i==="0"){a=`>=${r}.${i}.${o}${n} <${r}.${i}.${+o+1}-0`}else{a=`>=${r}.${i}.${o}${n} <${r}.${+i+1}.0-0`}}else{a=`>=${r}.${i}.${o} <${+r+1}.0.0-0`}}l("caret return",a);return a}))};const replaceXRanges=(e,t)=>{l("replaceXRanges",e,t);return e.split(/\s+/).map((e=>replaceXRange(e,t))).join(" ")};const replaceXRange=(e,t)=>{e=e.trim();const r=t.loose?h[u.XRANGELOOSE]:h[u.XRANGE];return e.replace(r,((r,n,i,o,s,a)=>{l("xRange",e,r,n,i,o,s,a);const c=isX(i);const h=c||isX(o);const u=h||isX(s);const p=u;if(n==="="&&p){n=""}a=t.includePrerelease?"-0":"";if(c){if(n===">"||n==="<"){r="<0.0.0-0"}else{r="*"}}else if(n&&p){if(h){o=0}s=0;if(n===">"){n=">=";if(h){i=+i+1;o=0;s=0}else{o=+o+1;s=0}}else if(n==="<="){n="<";if(h){i=+i+1}else{o=+o+1}}if(n==="<"){a="-0"}r=`${n+i}.${o}.${s}${a}`}else if(h){r=`>=${i}.0.0${a} <${+i+1}.0.0-0`}else if(u){r=`>=${i}.${o}.0${a} <${i}.${+o+1}.0-0`}l("xRange return",r);return r}))};const replaceStars=(e,t)=>{l("replaceStars",e,t);return e.trim().replace(h[u.STAR],"")};const replaceGTE0=(e,t)=>{l("replaceGTE0",e,t);return e.trim().replace(h[t.includePrerelease?u.GTE0PRE:u.GTE0],"")};const hyphenReplace=e=>(t,r,n,i,o,s,a,l,c,h,u,p)=>{if(isX(n)){r=""}else if(isX(i)){r=`>=${n}.0.0${e?"-0":""}`}else if(isX(o)){r=`>=${n}.${i}.0${e?"-0":""}`}else if(s){r=`>=${r}`}else{r=`>=${r}${e?"-0":""}`}if(isX(c)){l=""}else if(isX(h)){l=`<${+c+1}.0.0-0`}else if(isX(u)){l=`<${c}.${+h+1}.0-0`}else if(p){l=`<=${c}.${h}.${u}-${p}`}else if(e){l=`<${c}.${h}.${+u+1}-0`}else{l=`<=${l}`}return`${r} ${l}`.trim()};const testSet=(e,t,r)=>{for(let r=0;r<e.length;r++){if(!e[r].test(t)){return false}}if(t.prerelease.length&&!r.includePrerelease){for(let r=0;r<e.length;r++){l(e[r].semver);if(e[r].semver===a.ANY){continue}if(e[r].semver.prerelease.length>0){const n=e[r].semver;if(n.major===t.major&&n.minor===t.minor&&n.patch===t.patch){return true}}}return false}return true}},5075:(e,t,r)=>{const n=r(8895);const{MAX_LENGTH:i,MAX_SAFE_INTEGER:o}=r(3493);const{safeRe:s,t:a}=r(5047);const l=r(1788);const{compareIdentifiers:c}=r(5772);class SemVer{constructor(e,t){t=l(t);if(e instanceof SemVer){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease){return e}else{e=e.version}}else if(typeof e!=="string"){throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`)}if(e.length>i){throw new TypeError(`version is longer than ${i} characters`)}n("SemVer",e,t);this.options=t;this.loose=!!t.loose;this.includePrerelease=!!t.includePrerelease;const r=e.trim().match(t.loose?s[a.LOOSE]:s[a.FULL]);if(!r){throw new TypeError(`Invalid Version: ${e}`)}this.raw=e;this.major=+r[1];this.minor=+r[2];this.patch=+r[3];if(this.major>o||this.major<0){throw new TypeError("Invalid major version")}if(this.minor>o||this.minor<0){throw new TypeError("Invalid minor version")}if(this.patch>o||this.patch<0){throw new TypeError("Invalid patch version")}if(!r[4]){this.prerelease=[]}else{this.prerelease=r[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<o){return t}}return e}))}this.build=r[5]?r[5].split("."):[];this.format()}format(){this.version=`${this.major}.${this.minor}.${this.patch}`;if(this.prerelease.length){this.version+=`-${this.prerelease.join(".")}`}return this.version}toString(){return this.version}compare(e){n("SemVer.compare",this.version,this.options,e);if(!(e instanceof SemVer)){if(typeof e==="string"&&e===this.version){return 0}e=new SemVer(e,this.options)}if(e.version===this.version){return 0}return this.compareMain(e)||this.comparePre(e)}compareMain(e){if(!(e instanceof SemVer)){e=new SemVer(e,this.options)}if(this.major<e.major){return-1}if(this.major>e.major){return 1}if(this.minor<e.minor){return-1}if(this.minor>e.minor){return 1}if(this.patch<e.patch){return-1}if(this.patch>e.patch){return 1}return 0}comparePre(e){if(!(e instanceof SemVer)){e=new SemVer(e,this.options)}if(this.prerelease.length&&!e.prerelease.length){return-1}else if(!this.prerelease.length&&e.prerelease.length){return 1}else if(!this.prerelease.length&&!e.prerelease.length){return 0}let t=0;do{const r=this.prerelease[t];const i=e.prerelease[t];n("prerelease compare",t,r,i);if(r===undefined&&i===undefined){return 0}else if(i===undefined){return 1}else if(r===undefined){return-1}else if(r===i){continue}else{return c(r,i)}}while(++t)}compareBuild(e){if(!(e instanceof SemVer)){e=new SemVer(e,this.options)}let t=0;do{const r=this.build[t];const i=e.build[t];n("build compare",t,r,i);if(r===undefined&&i===undefined){return 0}else if(i===undefined){return 1}else if(r===undefined){return-1}else if(r===i){continue}else{return c(r,i)}}while(++t)}inc(e,t,r){if(e.startsWith("pre")){if(!t&&r===false){throw new Error("invalid increment argument: identifier is empty")}if(t){const e=`-${t}`.match(this.options.loose?s[a.PRERELEASELOOSE]:s[a.PRERELEASE]);if(!e||e[1]!==t){throw new Error(`invalid identifier: ${t}`)}}}switch(e){case"premajor":this.prerelease.length=0;this.patch=0;this.minor=0;this.major++;this.inc("pre",t,r);break;case"preminor":this.prerelease.length=0;this.patch=0;this.minor++;this.inc("pre",t,r);break;case"prepatch":this.prerelease.length=0;this.inc("patch",t,r);this.inc("pre",t,r);break;case"prerelease":if(this.prerelease.length===0){this.inc("patch",t,r)}this.inc("pre",t,r);break;case"release":if(this.prerelease.length===0){throw new Error(`version ${this.raw} is not a prerelease`)}this.prerelease.length=0;break;case"major":if(this.minor!==0||this.patch!==0||this.prerelease.length===0){this.major++}this.minor=0;this.patch=0;this.prerelease=[];break;case"minor":if(this.patch!==0||this.prerelease.length===0){this.minor++}this.patch=0;this.prerelease=[];break;case"patch":if(this.prerelease.length===0){this.patch++}this.prerelease=[];break;case"pre":{const e=Number(r)?1:0;if(this.prerelease.length===0){this.prerelease=[e]}else{let n=this.prerelease.length;while(--n>=0){if(typeof this.prerelease[n]==="number"){this.prerelease[n]++;n=-2}}if(n===-1){if(t===this.prerelease.join(".")&&r===false){throw new Error("invalid increment argument: identifier already exists")}this.prerelease.push(e)}}if(t){let n=[t,e];if(r===false){n=[t]}if(c(this.prerelease[0],t)===0){if(isNaN(this.prerelease[1])){this.prerelease=n}}else{this.prerelease=n}}break}default:throw new Error(`invalid increment argument: ${e}`)}this.raw=this.format();if(this.build.length){this.raw+=`+${this.build.join(".")}`}return this}}e.exports=SemVer},286:(e,t,r)=>{const n=r(2450);const i=r(7350);const o=r(3071);const s=r(7308);const a=r(2632);const l=r(6565);const cmp=(e,t,r,c)=>{switch(t){case"===":if(typeof e==="object"){e=e.version}if(typeof r==="object"){r=r.version}return e===r;case"!==":if(typeof e==="object"){e=e.version}if(typeof r==="object"){r=r.version}return e!==r;case"":case"=":case"==":return n(e,r,c);case"!=":return i(e,r,c);case">":return o(e,r,c);case">=":return s(e,r,c);case"<":return a(e,r,c);case"<=":return l(e,r,c);default:throw new TypeError(`Invalid operator: ${t}`)}};e.exports=cmp},5105:(e,t,r)=>{const n=r(5075);const i=r(9689);const{safeRe:o,t:s}=r(5047);const coerce=(e,t)=>{if(e instanceof n){return e}if(typeof e==="number"){e=String(e)}if(typeof e!=="string"){return null}t=t||{};let r=null;if(!t.rtl){r=e.match(t.includePrerelease?o[s.COERCEFULL]:o[s.COERCE])}else{const n=t.includePrerelease?o[s.COERCERTLFULL]:o[s.COERCERTL];let i;while((i=n.exec(e))&&(!r||r.index+r[0].length!==e.length)){if(!r||i.index+i[0].length!==r.index+r[0].length){r=i}n.lastIndex=i.index+i[1].length+i[2].length}n.lastIndex=-1}if(r===null){return null}const a=r[2];const l=r[3]||"0";const c=r[4]||"0";const h=t.includePrerelease&&r[5]?`-${r[5]}`:"";const u=t.includePrerelease&&r[6]?`+${r[6]}`:"";return i(`${a}.${l}.${c}${h}${u}`,t)};e.exports=coerce},3565:(e,t,r)=>{const n=r(5075);const compare=(e,t,r)=>new n(e,r).compare(new n(t,r));e.exports=compare},2450:(e,t,r)=>{const n=r(3565);const eq=(e,t,r)=>n(e,t,r)===0;e.exports=eq},3071:(e,t,r)=>{const n=r(3565);const gt=(e,t,r)=>n(e,t,r)>0;e.exports=gt},7308:(e,t,r)=>{const n=r(3565);const gte=(e,t,r)=>n(e,t,r)>=0;e.exports=gte},2632:(e,t,r)=>{const n=r(3565);const lt=(e,t,r)=>n(e,t,r)<0;e.exports=lt},6565:(e,t,r)=>{const n=r(3565);const lte=(e,t,r)=>n(e,t,r)<=0;e.exports=lte},7350:(e,t,r)=>{const n=r(3565);const neq=(e,t,r)=>n(e,t,r)!==0;e.exports=neq},9689:(e,t,r)=>{const n=r(5075);const parse=(e,t,r=false)=>{if(e instanceof n){return e}try{return new n(e,t)}catch(e){if(!r){return null}throw e}};e.exports=parse},4243:(e,t,r)=>{const n=r(2566);const satisfies=(e,t,r)=>{try{t=new n(t,r)}catch(e){return false}return t.test(e)};e.exports=satisfies},3493:e=>{const t="2.0.0";const r=256;const n=Number.MAX_SAFE_INTEGER||9007199254740991;const i=16;const o=r-6;const s=["major","premajor","minor","preminor","patch","prepatch","prerelease"];e.exports={MAX_LENGTH:r,MAX_SAFE_COMPONENT_LENGTH:i,MAX_SAFE_BUILD_LENGTH:o,MAX_SAFE_INTEGER:n,RELEASE_TYPES:s,SEMVER_SPEC_VERSION:t,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},8895:e=>{const t=typeof process==="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=t},5772:e=>{const t=/^[0-9]+$/;const compareIdentifiers=(e,r)=>{if(typeof e==="number"&&typeof r==="number"){return e===r?0:e<r?-1:1}const n=t.test(e);const i=t.test(r);if(n&&i){e=+e;r=+r}return e===r?0:n&&!i?-1:i&&!n?1:e<r?-1:1};const rcompareIdentifiers=(e,t)=>compareIdentifiers(t,e);e.exports={compareIdentifiers:compareIdentifiers,rcompareIdentifiers:rcompareIdentifiers}},95:e=>{class LRUCache{constructor(){this.max=1e3;this.map=new Map}get(e){const t=this.map.get(e);if(t===undefined){return undefined}else{this.map.delete(e);this.map.set(e,t);return t}}delete(e){return this.map.delete(e)}set(e,t){const r=this.delete(e);if(!r&&t!==undefined){if(this.map.size>=this.max){const e=this.map.keys().next().value;this.delete(e)}this.map.set(e,t)}return this}}e.exports=LRUCache},1788:e=>{const t=Object.freeze({loose:true});const r=Object.freeze({});const parseOptions=e=>{if(!e){return r}if(typeof e!=="object"){return t}return e};e.exports=parseOptions},5047:(e,t,r)=>{const{MAX_SAFE_COMPONENT_LENGTH:n,MAX_SAFE_BUILD_LENGTH:i,MAX_LENGTH:o}=r(3493);const s=r(8895);t=e.exports={};const a=t.re=[];const l=t.safeRe=[];const c=t.src=[];const h=t.safeSrc=[];const u=t.t={};let p=0;const d="[a-zA-Z0-9-]";const m=[["\\s",1],["\\d",o],[d,i]];const makeSafeRegex=e=>{for(const[t,r]of m){e=e.split(`${t}*`).join(`${t}{0,${r}}`).split(`${t}+`).join(`${t}{1,${r}}`)}return e};const createToken=(e,t,r)=>{const n=makeSafeRegex(t);const i=p++;s(e,i,t);u[e]=i;c[i]=t;h[i]=n;a[i]=new RegExp(t,r?"g":undefined);l[i]=new RegExp(n,r?"g":undefined)};createToken("NUMERICIDENTIFIER","0|[1-9]\\d*");createToken("NUMERICIDENTIFIERLOOSE","\\d+");createToken("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${d}*`);createToken("MAINVERSION",`(${c[u.NUMERICIDENTIFIER]})\\.`+`(${c[u.NUMERICIDENTIFIER]})\\.`+`(${c[u.NUMERICIDENTIFIER]})`);createToken("MAINVERSIONLOOSE",`(${c[u.NUMERICIDENTIFIERLOOSE]})\\.`+`(${c[u.NUMERICIDENTIFIERLOOSE]})\\.`+`(${c[u.NUMERICIDENTIFIERLOOSE]})`);createToken("PRERELEASEIDENTIFIER",`(?:${c[u.NONNUMERICIDENTIFIER]}|${c[u.NUMERICIDENTIFIER]})`);createToken("PRERELEASEIDENTIFIERLOOSE",`(?:${c[u.NONNUMERICIDENTIFIER]}|${c[u.NUMERICIDENTIFIERLOOSE]})`);createToken("PRERELEASE",`(?:-(${c[u.PRERELEASEIDENTIFIER]}(?:\\.${c[u.PRERELEASEIDENTIFIER]})*))`);createToken("PRERELEASELOOSE",`(?:-?(${c[u.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${c[u.PRERELEASEIDENTIFIERLOOSE]})*))`);createToken("BUILDIDENTIFIER",`${d}+`);createToken("BUILD",`(?:\\+(${c[u.BUILDIDENTIFIER]}(?:\\.${c[u.BUILDIDENTIFIER]})*))`);createToken("FULLPLAIN",`v?${c[u.MAINVERSION]}${c[u.PRERELEASE]}?${c[u.BUILD]}?`);createToken("FULL",`^${c[u.FULLPLAIN]}$`);createToken("LOOSEPLAIN",`[v=\\s]*${c[u.MAINVERSIONLOOSE]}${c[u.PRERELEASELOOSE]}?${c[u.BUILD]}?`);createToken("LOOSE",`^${c[u.LOOSEPLAIN]}$`);createToken("GTLT","((?:<|>)?=?)");createToken("XRANGEIDENTIFIERLOOSE",`${c[u.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);createToken("XRANGEIDENTIFIER",`${c[u.NUMERICIDENTIFIER]}|x|X|\\*`);createToken("XRANGEPLAIN",`[v=\\s]*(${c[u.XRANGEIDENTIFIER]})`+`(?:\\.(${c[u.XRANGEIDENTIFIER]})`+`(?:\\.(${c[u.XRANGEIDENTIFIER]})`+`(?:${c[u.PRERELEASE]})?${c[u.BUILD]}?`+`)?)?`);createToken("XRANGEPLAINLOOSE",`[v=\\s]*(${c[u.XRANGEIDENTIFIERLOOSE]})`+`(?:\\.(${c[u.XRANGEIDENTIFIERLOOSE]})`+`(?:\\.(${c[u.XRANGEIDENTIFIERLOOSE]})`+`(?:${c[u.PRERELEASELOOSE]})?${c[u.BUILD]}?`+`)?)?`);createToken("XRANGE",`^${c[u.GTLT]}\\s*${c[u.XRANGEPLAIN]}$`);createToken("XRANGELOOSE",`^${c[u.GTLT]}\\s*${c[u.XRANGEPLAINLOOSE]}$`);createToken("COERCEPLAIN",`${"(^|[^\\d])"+"(\\d{1,"}${n}})`+`(?:\\.(\\d{1,${n}}))?`+`(?:\\.(\\d{1,${n}}))?`);createToken("COERCE",`${c[u.COERCEPLAIN]}(?:$|[^\\d])`);createToken("COERCEFULL",c[u.COERCEPLAIN]+`(?:${c[u.PRERELEASE]})?`+`(?:${c[u.BUILD]})?`+`(?:$|[^\\d])`);createToken("COERCERTL",c[u.COERCE],true);createToken("COERCERTLFULL",c[u.COERCEFULL],true);createToken("LONETILDE","(?:~>?)");createToken("TILDETRIM",`(\\s*)${c[u.LONETILDE]}\\s+`,true);t.tildeTrimReplace="$1~";createToken("TILDE",`^${c[u.LONETILDE]}${c[u.XRANGEPLAIN]}$`);createToken("TILDELOOSE",`^${c[u.LONETILDE]}${c[u.XRANGEPLAINLOOSE]}$`);createToken("LONECARET","(?:\\^)");createToken("CARETTRIM",`(\\s*)${c[u.LONECARET]}\\s+`,true);t.caretTrimReplace="$1^";createToken("CARET",`^${c[u.LONECARET]}${c[u.XRANGEPLAIN]}$`);createToken("CARETLOOSE",`^${c[u.LONECARET]}${c[u.XRANGEPLAINLOOSE]}$`);createToken("COMPARATORLOOSE",`^${c[u.GTLT]}\\s*(${c[u.LOOSEPLAIN]})$|^$`);createToken("COMPARATOR",`^${c[u.GTLT]}\\s*(${c[u.FULLPLAIN]})$|^$`);createToken("COMPARATORTRIM",`(\\s*)${c[u.GTLT]}\\s*(${c[u.LOOSEPLAIN]}|${c[u.XRANGEPLAIN]})`,true);t.comparatorTrimReplace="$1$2$3";createToken("HYPHENRANGE",`^\\s*(${c[u.XRANGEPLAIN]})`+`\\s+-\\s+`+`(${c[u.XRANGEPLAIN]})`+`\\s*$`);createToken("HYPHENRANGELOOSE",`^\\s*(${c[u.XRANGEPLAINLOOSE]})`+`\\s+-\\s+`+`(${c[u.XRANGEPLAINLOOSE]})`+`\\s*$`);createToken("STAR","(<|>)?=?\\s*\\*");createToken("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");createToken("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},7063:module=>{module.exports=eval("require")("@img/sharp-libvips-dev/cplusplus")},6576:module=>{module.exports=eval("require")("@img/sharp-libvips-dev/include")},6279:module=>{module.exports=eval("require")("@img/sharp-wasm32/versions")},5317:e=>{e.exports=(0,module__WEBPACK_IMPORTED_MODULE_0__.createRequire)(import.meta.url)("child_process")},9896:e=>{e.exports=(0,module__WEBPACK_IMPORTED_MODULE_0__.createRequire)(import.meta.url)("fs")},1421:e=>{e.exports=(0,module__WEBPACK_IMPORTED_MODULE_0__.createRequire)(import.meta.url)("node:child_process")},7598:e=>{e.exports=(0,module__WEBPACK_IMPORTED_MODULE_0__.createRequire)(import.meta.url)("node:crypto")},8474:e=>{e.exports=(0,module__WEBPACK_IMPORTED_MODULE_0__.createRequire)(import.meta.url)("node:events")},8161:e=>{e.exports=(0,module__WEBPACK_IMPORTED_MODULE_0__.createRequire)(import.meta.url)("node:os")},6760:e=>{e.exports=(0,module__WEBPACK_IMPORTED_MODULE_0__.createRequire)(import.meta.url)("node:path")},7075:e=>{e.exports=(0,module__WEBPACK_IMPORTED_MODULE_0__.createRequire)(import.meta.url)("node:stream")},7975:e=>{e.exports=(0,module__WEBPACK_IMPORTED_MODULE_0__.createRequire)(import.meta.url)("node:util")},7016:(e,t,r)=>{
/*!
  Copyright 2013 Lovell Fuller and others.
  SPDX-License-Identifier: Apache-2.0
*/
const n=r(3031);const i={and:"and",or:"or",eor:"eor"};function removeAlpha(){this.options.removeAlpha=true;return this}function ensureAlpha(e){if(n.defined(e)){if(n.number(e)&&n.inRange(e,0,1)){this.options.ensureAlpha=e}else{throw n.invalidParameterError("alpha","number between 0 and 1",e)}}else{this.options.ensureAlpha=1}return this}function extractChannel(e){const t={red:0,green:1,blue:2,alpha:3};if(Object.keys(t).includes(e)){e=t[e]}if(n.integer(e)&&n.inRange(e,0,4)){this.options.extractChannel=e}else{throw n.invalidParameterError("channel","integer or one of: red, green, blue, alpha",e)}return this}function joinChannel(e,t){if(Array.isArray(e)){e.forEach((function(e){this.options.joinChannelIn.push(this._createInputDescriptor(e,t))}),this)}else{this.options.joinChannelIn.push(this._createInputDescriptor(e,t))}return this}function bandbool(e){if(n.string(e)&&n.inArray(e,["and","or","eor"])){this.options.bandBoolOp=e}else{throw n.invalidParameterError("boolOp","one of: and, or, eor",e)}return this}e.exports=e=>{Object.assign(e.prototype,{removeAlpha:removeAlpha,ensureAlpha:ensureAlpha,extractChannel:extractChannel,joinChannel:joinChannel,bandbool:bandbool});e.bool=i}},8459:(e,t,r)=>{
/*!
  Copyright 2013 Lovell Fuller and others.
  SPDX-License-Identifier: Apache-2.0
*/
const n=r(171);const i=r(3031);const o={multiband:"multiband","b-w":"b-w",bw:"b-w",cmyk:"cmyk",srgb:"srgb"};function tint(e){this._setBackgroundColourOption("tint",e);return this}function greyscale(e){this.options.greyscale=i.bool(e)?e:true;return this}function grayscale(e){return this.greyscale(e)}function pipelineColourspace(e){if(!i.string(e)){throw i.invalidParameterError("colourspace","string",e)}this.options.colourspacePipeline=e;return this}function pipelineColorspace(e){return this.pipelineColourspace(e)}function toColourspace(e){if(!i.string(e)){throw i.invalidParameterError("colourspace","string",e)}this.options.colourspace=e;return this}function toColorspace(e){return this.toColourspace(e)}function _getBackgroundColourOption(e){if(i.object(e)||i.string(e)&&e.length>=3&&e.length<=200){const t=n(e);return[t.red(),t.green(),t.blue(),Math.round(t.alpha()*255)]}else{throw i.invalidParameterError("background","object or string",e)}}function _setBackgroundColourOption(e,t){if(i.defined(t)){this.options[e]=_getBackgroundColourOption(t)}}e.exports=e=>{Object.assign(e.prototype,{tint:tint,greyscale:greyscale,grayscale:grayscale,pipelineColourspace:pipelineColourspace,pipelineColorspace:pipelineColorspace,toColourspace:toColourspace,toColorspace:toColorspace,_getBackgroundColourOption:_getBackgroundColourOption,_setBackgroundColourOption:_setBackgroundColourOption});e.colourspace=o;e.colorspace=o}},6360:(e,t,r)=>{
/*!
  Copyright 2013 Lovell Fuller and others.
  SPDX-License-Identifier: Apache-2.0
*/
const n=r(3031);const i={clear:"clear",source:"source",over:"over",in:"in",out:"out",atop:"atop",dest:"dest","dest-over":"dest-over","dest-in":"dest-in","dest-out":"dest-out","dest-atop":"dest-atop",xor:"xor",add:"add",saturate:"saturate",multiply:"multiply",screen:"screen",overlay:"overlay",darken:"darken",lighten:"lighten","colour-dodge":"colour-dodge","color-dodge":"colour-dodge","colour-burn":"colour-burn","color-burn":"colour-burn","hard-light":"hard-light","soft-light":"soft-light",difference:"difference",exclusion:"exclusion"};function composite(e){if(!Array.isArray(e)){throw n.invalidParameterError("images to composite","array",e)}this.options.composite=e.map((e=>{if(!n.object(e)){throw n.invalidParameterError("image to composite","object",e)}const t=this._inputOptionsFromObject(e);const r={input:this._createInputDescriptor(e.input,t,{allowStream:false}),blend:"over",tile:false,left:0,top:0,hasOffset:false,gravity:0,premultiplied:false};if(n.defined(e.blend)){if(n.string(i[e.blend])){r.blend=i[e.blend]}else{throw n.invalidParameterError("blend","valid blend name",e.blend)}}if(n.defined(e.tile)){if(n.bool(e.tile)){r.tile=e.tile}else{throw n.invalidParameterError("tile","boolean",e.tile)}}if(n.defined(e.left)){if(n.integer(e.left)){r.left=e.left}else{throw n.invalidParameterError("left","integer",e.left)}}if(n.defined(e.top)){if(n.integer(e.top)){r.top=e.top}else{throw n.invalidParameterError("top","integer",e.top)}}if(n.defined(e.top)!==n.defined(e.left)){throw new Error("Expected both left and top to be set")}else{r.hasOffset=n.integer(e.top)&&n.integer(e.left)}if(n.defined(e.gravity)){if(n.integer(e.gravity)&&n.inRange(e.gravity,0,8)){r.gravity=e.gravity}else if(n.string(e.gravity)&&n.integer(this.constructor.gravity[e.gravity])){r.gravity=this.constructor.gravity[e.gravity]}else{throw n.invalidParameterError("gravity","valid gravity",e.gravity)}}if(n.defined(e.premultiplied)){if(n.bool(e.premultiplied)){r.premultiplied=e.premultiplied}else{throw n.invalidParameterError("premultiplied","boolean",e.premultiplied)}}return r}));return this}e.exports=e=>{e.prototype.composite=composite;e.blend=i}},9667:(e,t,r)=>{
/*!
  Copyright 2013 Lovell Fuller and others.
  SPDX-License-Identifier: Apache-2.0
*/
const n=r(7975);const i=r(7075);const o=r(3031);r(1395);const s=n.debuglog("sharp");const queueListener=e=>{Sharp.queue.emit("change",e)};const Sharp=function(e,t){if(arguments.length===1&&!o.defined(e)){throw new Error("Invalid input")}if(!(this instanceof Sharp)){return new Sharp(e,t)}i.Duplex.call(this);this.options={topOffsetPre:-1,leftOffsetPre:-1,widthPre:-1,heightPre:-1,topOffsetPost:-1,leftOffsetPost:-1,widthPost:-1,heightPost:-1,width:-1,height:-1,canvas:"crop",position:0,resizeBackground:[0,0,0,255],angle:0,rotationAngle:0,rotationBackground:[0,0,0,255],rotateBefore:false,orientBefore:false,flip:false,flop:false,extendTop:0,extendBottom:0,extendLeft:0,extendRight:0,extendBackground:[0,0,0,255],extendWith:"background",withoutEnlargement:false,withoutReduction:false,affineMatrix:[],affineBackground:[0,0,0,255],affineIdx:0,affineIdy:0,affineOdx:0,affineOdy:0,affineInterpolator:this.constructor.interpolators.bilinear,kernel:"lanczos3",fastShrinkOnLoad:true,tint:[-1,0,0,0],flatten:false,flattenBackground:[0,0,0],unflatten:false,negate:false,negateAlpha:true,medianSize:0,blurSigma:0,precision:"integer",minAmpl:.2,sharpenSigma:0,sharpenM1:1,sharpenM2:2,sharpenX1:2,sharpenY2:10,sharpenY3:20,threshold:0,thresholdGrayscale:true,trimBackground:[],trimThreshold:-1,trimLineArt:false,dilateWidth:0,erodeWidth:0,gamma:0,gammaOut:0,greyscale:false,normalise:false,normaliseLower:1,normaliseUpper:99,claheWidth:0,claheHeight:0,claheMaxSlope:3,brightness:1,saturation:1,hue:0,lightness:0,booleanBufferIn:null,booleanFileIn:"",joinChannelIn:[],extractChannel:-1,removeAlpha:false,ensureAlpha:-1,colourspace:"srgb",colourspacePipeline:"last",composite:[],fileOut:"",formatOut:"input",streamOut:false,keepMetadata:0,withMetadataOrientation:-1,withMetadataDensity:0,withIccProfile:"",withExif:{},withExifMerge:true,withXmp:"",resolveWithObject:false,loop:-1,delay:[],jpegQuality:80,jpegProgressive:false,jpegChromaSubsampling:"4:2:0",jpegTrellisQuantisation:false,jpegOvershootDeringing:false,jpegOptimiseScans:false,jpegOptimiseCoding:true,jpegQuantisationTable:0,pngProgressive:false,pngCompressionLevel:6,pngAdaptiveFiltering:false,pngPalette:false,pngQuality:100,pngEffort:7,pngBitdepth:8,pngDither:1,jp2Quality:80,jp2TileHeight:512,jp2TileWidth:512,jp2Lossless:false,jp2ChromaSubsampling:"4:4:4",webpQuality:80,webpAlphaQuality:100,webpLossless:false,webpNearLossless:false,webpSmartSubsample:false,webpSmartDeblock:false,webpPreset:"default",webpEffort:4,webpMinSize:false,webpMixed:false,gifBitdepth:8,gifEffort:7,gifDither:1,gifInterFrameMaxError:0,gifInterPaletteMaxError:3,gifKeepDuplicateFrames:false,gifReuse:true,gifProgressive:false,tiffQuality:80,tiffCompression:"jpeg",tiffBigtiff:false,tiffPredictor:"horizontal",tiffPyramid:false,tiffMiniswhite:false,tiffBitdepth:8,tiffTile:false,tiffTileHeight:256,tiffTileWidth:256,tiffXres:1,tiffYres:1,tiffResolutionUnit:"inch",heifQuality:50,heifLossless:false,heifCompression:"av1",heifEffort:4,heifChromaSubsampling:"4:4:4",heifBitdepth:8,jxlDistance:1,jxlDecodingTier:0,jxlEffort:7,jxlLossless:false,rawDepth:"uchar",tileSize:256,tileOverlap:0,tileContainer:"fs",tileLayout:"dz",tileFormat:"last",tileDepth:"last",tileAngle:0,tileSkipBlanks:-1,tileBackground:[255,255,255,255],tileCentre:false,tileId:"https://example.com/iiif",tileBasename:"",timeoutSeconds:0,linearA:[],linearB:[],pdfBackground:[255,255,255,255],debuglog:e=>{this.emit("warning",e);s(e)},queueListener:queueListener};this.options.input=this._createInputDescriptor(e,t,{allowStream:true});return this};Object.setPrototypeOf(Sharp.prototype,i.Duplex.prototype);Object.setPrototypeOf(Sharp,i.Duplex);function clone(){const e=this.constructor.call();const{debuglog:t,queueListener:r,...n}=this.options;e.options=structuredClone(n);e.options.debuglog=t;e.options.queueListener=r;if(this._isStreamInput()){this.on("finish",(()=>{this._flattenBufferIn();e.options.input.buffer=this.options.input.buffer;e.emit("finish")}))}return e}Object.assign(Sharp.prototype,{clone:clone});e.exports=Sharp},3491:(e,t,r)=>{
/*!
  Copyright 2013 Lovell Fuller and others.
  SPDX-License-Identifier: Apache-2.0
*/
const n=r(9667);r(5019)(n);r(1527)(n);r(6360)(n);r(6450)(n);r(8459)(n);r(7016)(n);r(982)(n);r(735)(n);e.exports=n},5019:(e,t,r)=>{
/*!
  Copyright 2013 Lovell Fuller and others.
  SPDX-License-Identifier: Apache-2.0
*/
const n=r(3031);const i=r(1395);const o={left:"low",top:"low",low:"low",center:"centre",centre:"centre",right:"high",bottom:"high",high:"high"};const s=["failOn","limitInputPixels","unlimited","animated","autoOrient","density","ignoreIcc","page","pages","sequentialRead","jp2","openSlide","pdf","raw","svg","tiff","failOnError","openSlideLevel","pdfBackground","tiffSubifd"];function _inputOptionsFromObject(e){const t=s.filter((t=>n.defined(e[t]))).map((t=>[t,e[t]]));return t.length?Object.fromEntries(t):undefined}function _createInputDescriptor(e,t,r){const i={autoOrient:false,failOn:"warning",limitInputPixels:16383**2,ignoreIcc:false,unlimited:false,sequentialRead:true};if(n.string(e)){i.file=e}else if(n.buffer(e)){if(e.length===0){throw Error("Input Buffer is empty")}i.buffer=e}else if(n.arrayBuffer(e)){if(e.byteLength===0){throw Error("Input bit Array is empty")}i.buffer=Buffer.from(e,0,e.byteLength)}else if(n.typedArray(e)){if(e.length===0){throw Error("Input Bit Array is empty")}i.buffer=Buffer.from(e.buffer,e.byteOffset,e.byteLength)}else if(n.plainObject(e)&&!n.defined(t)){t=e;if(_inputOptionsFromObject(t)){i.buffer=[]}}else if(!n.defined(e)&&!n.defined(t)&&n.object(r)&&r.allowStream){i.buffer=[]}else if(Array.isArray(e)){if(e.length>1){if(!this.options.joining){this.options.joining=true;this.options.join=e.map((e=>this._createInputDescriptor(e)))}else{throw new Error("Recursive join is unsupported")}}else{throw new Error("Expected at least two images to join")}}else{throw new Error(`Unsupported input '${e}' of type ${typeof e}${n.defined(t)?` when also providing options of type ${typeof t}`:""}`)}if(n.object(t)){if(n.defined(t.failOnError)){if(n.bool(t.failOnError)){i.failOn=t.failOnError?"warning":"none"}else{throw n.invalidParameterError("failOnError","boolean",t.failOnError)}}if(n.defined(t.failOn)){if(n.string(t.failOn)&&n.inArray(t.failOn,["none","truncated","error","warning"])){i.failOn=t.failOn}else{throw n.invalidParameterError("failOn","one of: none, truncated, error, warning",t.failOn)}}if(n.defined(t.autoOrient)){if(n.bool(t.autoOrient)){i.autoOrient=t.autoOrient}else{throw n.invalidParameterError("autoOrient","boolean",t.autoOrient)}}if(n.defined(t.density)){if(n.inRange(t.density,1,1e5)){i.density=t.density}else{throw n.invalidParameterError("density","number between 1 and 100000",t.density)}}if(n.defined(t.ignoreIcc)){if(n.bool(t.ignoreIcc)){i.ignoreIcc=t.ignoreIcc}else{throw n.invalidParameterError("ignoreIcc","boolean",t.ignoreIcc)}}if(n.defined(t.limitInputPixels)){if(n.bool(t.limitInputPixels)){i.limitInputPixels=t.limitInputPixels?16383**2:0}else if(n.integer(t.limitInputPixels)&&n.inRange(t.limitInputPixels,0,Number.MAX_SAFE_INTEGER)){i.limitInputPixels=t.limitInputPixels}else{throw n.invalidParameterError("limitInputPixels","positive integer",t.limitInputPixels)}}if(n.defined(t.unlimited)){if(n.bool(t.unlimited)){i.unlimited=t.unlimited}else{throw n.invalidParameterError("unlimited","boolean",t.unlimited)}}if(n.defined(t.sequentialRead)){if(n.bool(t.sequentialRead)){i.sequentialRead=t.sequentialRead}else{throw n.invalidParameterError("sequentialRead","boolean",t.sequentialRead)}}if(n.defined(t.raw)){if(n.object(t.raw)&&n.integer(t.raw.width)&&t.raw.width>0&&n.integer(t.raw.height)&&t.raw.height>0&&n.integer(t.raw.channels)&&n.inRange(t.raw.channels,1,4)){i.rawWidth=t.raw.width;i.rawHeight=t.raw.height;i.rawChannels=t.raw.channels;switch(e.constructor){case Uint8Array:case Uint8ClampedArray:i.rawDepth="uchar";break;case Int8Array:i.rawDepth="char";break;case Uint16Array:i.rawDepth="ushort";break;case Int16Array:i.rawDepth="short";break;case Uint32Array:i.rawDepth="uint";break;case Int32Array:i.rawDepth="int";break;case Float32Array:i.rawDepth="float";break;case Float64Array:i.rawDepth="double";break;default:i.rawDepth="uchar";break}}else{throw new Error("Expected width, height and channels for raw pixel input")}i.rawPremultiplied=false;if(n.defined(t.raw.premultiplied)){if(n.bool(t.raw.premultiplied)){i.rawPremultiplied=t.raw.premultiplied}else{throw n.invalidParameterError("raw.premultiplied","boolean",t.raw.premultiplied)}}i.rawPageHeight=0;if(n.defined(t.raw.pageHeight)){if(n.integer(t.raw.pageHeight)&&t.raw.pageHeight>0&&t.raw.pageHeight<=t.raw.height){if(t.raw.height%t.raw.pageHeight!==0){throw new Error(`Expected raw.height ${t.raw.height} to be a multiple of raw.pageHeight ${t.raw.pageHeight}`)}i.rawPageHeight=t.raw.pageHeight}else{throw n.invalidParameterError("raw.pageHeight","positive integer",t.raw.pageHeight)}}}if(n.defined(t.animated)){if(n.bool(t.animated)){i.pages=t.animated?-1:1}else{throw n.invalidParameterError("animated","boolean",t.animated)}}if(n.defined(t.pages)){if(n.integer(t.pages)&&n.inRange(t.pages,-1,1e5)){i.pages=t.pages}else{throw n.invalidParameterError("pages","integer between -1 and 100000",t.pages)}}if(n.defined(t.page)){if(n.integer(t.page)&&n.inRange(t.page,0,1e5)){i.page=t.page}else{throw n.invalidParameterError("page","integer between 0 and 100000",t.page)}}if(n.object(t.openSlide)&&n.defined(t.openSlide.level)){if(n.integer(t.openSlide.level)&&n.inRange(t.openSlide.level,0,256)){i.openSlideLevel=t.openSlide.level}else{throw n.invalidParameterError("openSlide.level","integer between 0 and 256",t.openSlide.level)}}else if(n.defined(t.level)){if(n.integer(t.level)&&n.inRange(t.level,0,256)){i.openSlideLevel=t.level}else{throw n.invalidParameterError("level","integer between 0 and 256",t.level)}}if(n.object(t.tiff)&&n.defined(t.tiff.subifd)){if(n.integer(t.tiff.subifd)&&n.inRange(t.tiff.subifd,-1,1e5)){i.tiffSubifd=t.tiff.subifd}else{throw n.invalidParameterError("tiff.subifd","integer between -1 and 100000",t.tiff.subifd)}}else if(n.defined(t.subifd)){if(n.integer(t.subifd)&&n.inRange(t.subifd,-1,1e5)){i.tiffSubifd=t.subifd}else{throw n.invalidParameterError("subifd","integer between -1 and 100000",t.subifd)}}if(n.object(t.svg)){if(n.defined(t.svg.stylesheet)){if(n.string(t.svg.stylesheet)){i.svgStylesheet=t.svg.stylesheet}else{throw n.invalidParameterError("svg.stylesheet","string",t.svg.stylesheet)}}if(n.defined(t.svg.highBitdepth)){if(n.bool(t.svg.highBitdepth)){i.svgHighBitdepth=t.svg.highBitdepth}else{throw n.invalidParameterError("svg.highBitdepth","boolean",t.svg.highBitdepth)}}}if(n.object(t.pdf)&&n.defined(t.pdf.background)){i.pdfBackground=this._getBackgroundColourOption(t.pdf.background)}else if(n.defined(t.pdfBackground)){i.pdfBackground=this._getBackgroundColourOption(t.pdfBackground)}if(n.object(t.jp2)&&n.defined(t.jp2.oneshot)){if(n.bool(t.jp2.oneshot)){i.jp2Oneshot=t.jp2.oneshot}else{throw n.invalidParameterError("jp2.oneshot","boolean",t.jp2.oneshot)}}if(n.defined(t.create)){if(n.object(t.create)&&n.integer(t.create.width)&&t.create.width>0&&n.integer(t.create.height)&&t.create.height>0&&n.integer(t.create.channels)){i.createWidth=t.create.width;i.createHeight=t.create.height;i.createChannels=t.create.channels;i.createPageHeight=0;if(n.defined(t.create.pageHeight)){if(n.integer(t.create.pageHeight)&&t.create.pageHeight>0&&t.create.pageHeight<=t.create.height){if(t.create.height%t.create.pageHeight!==0){throw new Error(`Expected create.height ${t.create.height} to be a multiple of create.pageHeight ${t.create.pageHeight}`)}i.createPageHeight=t.create.pageHeight}else{throw n.invalidParameterError("create.pageHeight","positive integer",t.create.pageHeight)}}if(n.defined(t.create.noise)){if(!n.object(t.create.noise)){throw new Error("Expected noise to be an object")}if(t.create.noise.type!=="gaussian"){throw new Error("Only gaussian noise is supported at the moment")}i.createNoiseType=t.create.noise.type;if(!n.inRange(t.create.channels,1,4)){throw n.invalidParameterError("create.channels","number between 1 and 4",t.create.channels)}i.createNoiseMean=128;if(n.defined(t.create.noise.mean)){if(n.number(t.create.noise.mean)&&n.inRange(t.create.noise.mean,0,1e4)){i.createNoiseMean=t.create.noise.mean}else{throw n.invalidParameterError("create.noise.mean","number between 0 and 10000",t.create.noise.mean)}}i.createNoiseSigma=30;if(n.defined(t.create.noise.sigma)){if(n.number(t.create.noise.sigma)&&n.inRange(t.create.noise.sigma,0,1e4)){i.createNoiseSigma=t.create.noise.sigma}else{throw n.invalidParameterError("create.noise.sigma","number between 0 and 10000",t.create.noise.sigma)}}}else if(n.defined(t.create.background)){if(!n.inRange(t.create.channels,3,4)){throw n.invalidParameterError("create.channels","number between 3 and 4",t.create.channels)}i.createBackground=this._getBackgroundColourOption(t.create.background)}else{throw new Error("Expected valid noise or background to create a new input image")}delete i.buffer}else{throw new Error("Expected valid width, height and channels to create a new input image")}}if(n.defined(t.text)){if(n.object(t.text)&&n.string(t.text.text)){i.textValue=t.text.text;if(n.defined(t.text.height)&&n.defined(t.text.dpi)){throw new Error("Expected only one of dpi or height")}if(n.defined(t.text.font)){if(n.string(t.text.font)){i.textFont=t.text.font}else{throw n.invalidParameterError("text.font","string",t.text.font)}}if(n.defined(t.text.fontfile)){if(n.string(t.text.fontfile)){i.textFontfile=t.text.fontfile}else{throw n.invalidParameterError("text.fontfile","string",t.text.fontfile)}}if(n.defined(t.text.width)){if(n.integer(t.text.width)&&t.text.width>0){i.textWidth=t.text.width}else{throw n.invalidParameterError("text.width","positive integer",t.text.width)}}if(n.defined(t.text.height)){if(n.integer(t.text.height)&&t.text.height>0){i.textHeight=t.text.height}else{throw n.invalidParameterError("text.height","positive integer",t.text.height)}}if(n.defined(t.text.align)){if(n.string(t.text.align)&&n.string(this.constructor.align[t.text.align])){i.textAlign=this.constructor.align[t.text.align]}else{throw n.invalidParameterError("text.align","valid alignment",t.text.align)}}if(n.defined(t.text.justify)){if(n.bool(t.text.justify)){i.textJustify=t.text.justify}else{throw n.invalidParameterError("text.justify","boolean",t.text.justify)}}if(n.defined(t.text.dpi)){if(n.integer(t.text.dpi)&&n.inRange(t.text.dpi,1,1e6)){i.textDpi=t.text.dpi}else{throw n.invalidParameterError("text.dpi","integer between 1 and 1000000",t.text.dpi)}}if(n.defined(t.text.rgba)){if(n.bool(t.text.rgba)){i.textRgba=t.text.rgba}else{throw n.invalidParameterError("text.rgba","bool",t.text.rgba)}}if(n.defined(t.text.spacing)){if(n.integer(t.text.spacing)&&n.inRange(t.text.spacing,-1e6,1e6)){i.textSpacing=t.text.spacing}else{throw n.invalidParameterError("text.spacing","integer between -1000000 and 1000000",t.text.spacing)}}if(n.defined(t.text.wrap)){if(n.string(t.text.wrap)&&n.inArray(t.text.wrap,["word","char","word-char","none"])){i.textWrap=t.text.wrap}else{throw n.invalidParameterError("text.wrap","one of: word, char, word-char, none",t.text.wrap)}}delete i.buffer}else{throw new Error("Expected a valid string to create an image with text.")}}if(n.defined(t.join)){if(n.defined(this.options.join)){if(n.defined(t.join.animated)){if(n.bool(t.join.animated)){i.joinAnimated=t.join.animated}else{throw n.invalidParameterError("join.animated","boolean",t.join.animated)}}if(n.defined(t.join.across)){if(n.integer(t.join.across)&&n.inRange(t.join.across,1,1e6)){i.joinAcross=t.join.across}else{throw n.invalidParameterError("join.across","integer between 1 and 100000",t.join.across)}}if(n.defined(t.join.shim)){if(n.integer(t.join.shim)&&n.inRange(t.join.shim,0,1e6)){i.joinShim=t.join.shim}else{throw n.invalidParameterError("join.shim","integer between 0 and 100000",t.join.shim)}}if(n.defined(t.join.background)){i.joinBackground=this._getBackgroundColourOption(t.join.background)}if(n.defined(t.join.halign)){if(n.string(t.join.halign)&&n.string(this.constructor.align[t.join.halign])){i.joinHalign=this.constructor.align[t.join.halign]}else{throw n.invalidParameterError("join.halign","valid alignment",t.join.halign)}}if(n.defined(t.join.valign)){if(n.string(t.join.valign)&&n.string(this.constructor.align[t.join.valign])){i.joinValign=this.constructor.align[t.join.valign]}else{throw n.invalidParameterError("join.valign","valid alignment",t.join.valign)}}}else{throw new Error("Expected input to be an array of images to join")}}}else if(n.defined(t)){throw new Error(`Invalid input options ${t}`)}return i}function _write(e,t,r){if(Array.isArray(this.options.input.buffer)){if(n.buffer(e)){if(this.options.input.buffer.length===0){this.on("finish",(()=>{this.streamInFinished=true}))}this.options.input.buffer.push(e);r()}else{r(new Error("Non-Buffer data on Writable Stream"))}}else{r(new Error("Unexpected data on Writable Stream"))}}function _flattenBufferIn(){if(this._isStreamInput()){this.options.input.buffer=Buffer.concat(this.options.input.buffer)}}function _isStreamInput(){return Array.isArray(this.options.input.buffer)}function metadata(e){const t=Error();if(n.fn(e)){if(this._isStreamInput()){this.on("finish",(()=>{this._flattenBufferIn();i.metadata(this.options,((r,i)=>{if(r){e(n.nativeError(r,t))}else{e(null,i)}}))}))}else{i.metadata(this.options,((r,i)=>{if(r){e(n.nativeError(r,t))}else{e(null,i)}}))}return this}else{if(this._isStreamInput()){return new Promise(((e,r)=>{const finished=()=>{this._flattenBufferIn();i.metadata(this.options,((i,o)=>{if(i){r(n.nativeError(i,t))}else{e(o)}}))};if(this.writableFinished){finished()}else{this.once("finish",finished)}}))}else{return new Promise(((e,r)=>{i.metadata(this.options,((i,o)=>{if(i){r(n.nativeError(i,t))}else{e(o)}}))}))}}}function stats(e){const t=Error();if(n.fn(e)){if(this._isStreamInput()){this.on("finish",(()=>{this._flattenBufferIn();i.stats(this.options,((r,i)=>{if(r){e(n.nativeError(r,t))}else{e(null,i)}}))}))}else{i.stats(this.options,((r,i)=>{if(r){e(n.nativeError(r,t))}else{e(null,i)}}))}return this}else{if(this._isStreamInput()){return new Promise(((e,r)=>{this.on("finish",(function(){this._flattenBufferIn();i.stats(this.options,((i,o)=>{if(i){r(n.nativeError(i,t))}else{e(o)}}))}))}))}else{return new Promise(((e,r)=>{i.stats(this.options,((i,o)=>{if(i){r(n.nativeError(i,t))}else{e(o)}}))}))}}}e.exports=e=>{Object.assign(e.prototype,{_inputOptionsFromObject:_inputOptionsFromObject,_createInputDescriptor:_createInputDescriptor,_write:_write,_flattenBufferIn:_flattenBufferIn,_isStreamInput:_isStreamInput,metadata:metadata,stats:stats});e.align=o}},3031:e=>{
/*!
  Copyright 2013 Lovell Fuller and others.
  SPDX-License-Identifier: Apache-2.0
*/
const defined=e=>typeof e!=="undefined"&&e!==null;const object=e=>typeof e==="object";const plainObject=e=>Object.prototype.toString.call(e)==="[object Object]";const fn=e=>typeof e==="function";const bool=e=>typeof e==="boolean";const buffer=e=>e instanceof Buffer;const typedArray=e=>{if(defined(e)){switch(e.constructor){case Uint8Array:case Uint8ClampedArray:case Int8Array:case Uint16Array:case Int16Array:case Uint32Array:case Int32Array:case Float32Array:case Float64Array:return true}}return false};const arrayBuffer=e=>e instanceof ArrayBuffer;const string=e=>typeof e==="string"&&e.length>0;const number=e=>typeof e==="number"&&!Number.isNaN(e);const integer=e=>Number.isInteger(e);const inRange=(e,t,r)=>e>=t&&e<=r;const inArray=(e,t)=>t.includes(e);const invalidParameterError=(e,t,r)=>new Error(`Expected ${t} for ${e} but received ${r} of type ${typeof r}`);const nativeError=(e,t)=>{t.message=e.message;return t};e.exports={defined:defined,object:object,plainObject:plainObject,fn:fn,bool:bool,buffer:buffer,typedArray:typedArray,arrayBuffer:arrayBuffer,string:string,number:number,integer:integer,inRange:inRange,inArray:inArray,invalidParameterError:invalidParameterError,nativeError:nativeError}},1808:(e,t,r)=>{
/*!
  Copyright 2013 Lovell Fuller and others.
  SPDX-License-Identifier: Apache-2.0
*/
const{spawnSync:n}=r(1421);const{createHash:i}=r(7598);const o=r(5105);const s=r(7308);const a=r(4243);const l=r(8772);const{config:c,engines:h,optionalDependencies:u}=r(7816);const p=process.env.npm_package_config_libvips||c.libvips;const d=o(p).version;const m=["darwin-arm64","darwin-x64","linux-arm","linux-arm64","linux-ppc64","linux-riscv64","linux-s390x","linux-x64","linuxmusl-arm64","linuxmusl-x64","win32-arm64","win32-ia32","win32-x64"];const g={encoding:"utf8",shell:true};const log=e=>{if(e instanceof Error){console.error(`sharp: Installation error: ${e.message}`)}else{console.log(`sharp: ${e}`)}};const runtimeLibc=()=>l.isNonGlibcLinuxSync()?l.familySync():"";const runtimePlatformArch=()=>`${process.platform}${runtimeLibc()}-${process.arch}`;const buildPlatformArch=()=>{if(isEmscripten()){return"wasm32"}const{npm_config_arch:e,npm_config_platform:t,npm_config_libc:r}=process.env;const n=typeof r==="string"?r:runtimeLibc();return`${t||process.platform}${n}-${e||process.arch}`};const buildSharpLibvipsIncludeDir=()=>{try{return(0,module__WEBPACK_IMPORTED_MODULE_0__.createRequire)(import.meta.url)(`@img/sharp-libvips-dev-${buildPlatformArch()}/include`)}catch{try{return r(6576)}catch{}}return""};const buildSharpLibvipsCPlusPlusDir=()=>{try{return r(7063)}catch{}return""};const buildSharpLibvipsLibDir=()=>{try{return(0,module__WEBPACK_IMPORTED_MODULE_0__.createRequire)(import.meta.url)(`@img/sharp-libvips-dev-${buildPlatformArch()}/lib`)}catch{try{return(0,module__WEBPACK_IMPORTED_MODULE_0__.createRequire)(import.meta.url)(`@img/sharp-libvips-${buildPlatformArch()}/lib`)}catch{}}return""};const isUnsupportedNodeRuntime=()=>{if(process.release?.name==="node"&&process.versions){if(!a(process.versions.node,h.node)){return{found:process.versions.node,expected:h.node}}}};const isEmscripten=()=>{const{CC:e}=process.env;return Boolean(e?.endsWith("/emcc"))};const isRosetta=()=>{if(process.platform==="darwin"&&process.arch==="x64"){const e=n("sysctl sysctl.proc_translated",g).stdout;return(e||"").trim()==="sysctl.proc_translated: 1"}return false};const sha512=e=>i("sha512").update(e).digest("hex");const yarnLocator=()=>{try{const e=sha512(`imgsharp-libvips-${buildPlatformArch()}`);const t=o(u[`@img/sharp-libvips-${buildPlatformArch()}`],{includePrerelease:true}).version;return sha512(`${e}npm:${t}`).slice(0,10)}catch{}return""};const spawnRebuild=()=>n(`node-gyp rebuild --directory=src ${isEmscripten()?"--nodedir=emscripten":""}`,{...g,stdio:"inherit"}).status;const globalLibvipsVersion=()=>{if(process.platform!=="win32"){const e=n("pkg-config --modversion vips-cpp",{...g,env:{...process.env,PKG_CONFIG_PATH:pkgConfigPath()}}).stdout;return(e||"").trim()}else{return""}};const pkgConfigPath=()=>{if(process.platform!=="win32"){const e=n('which brew >/dev/null 2>&1 && brew environment --plain | grep PKG_CONFIG_LIBDIR | cut -d" " -f2',g).stdout||"";return[e.trim(),process.env.PKG_CONFIG_PATH,"/usr/local/lib/pkgconfig","/usr/lib/pkgconfig","/usr/local/libdata/pkgconfig","/usr/libdata/pkgconfig"].filter(Boolean).join(":")}else{return""}};const skipSearch=(e,t,r)=>{if(r){r(`Detected ${t}, skipping search for globally-installed libvips`)}return e};const useGlobalLibvips=e=>{if(Boolean(process.env.SHARP_IGNORE_GLOBAL_LIBVIPS)===true){return skipSearch(false,"SHARP_IGNORE_GLOBAL_LIBVIPS",e)}if(Boolean(process.env.SHARP_FORCE_GLOBAL_LIBVIPS)===true){return skipSearch(true,"SHARP_FORCE_GLOBAL_LIBVIPS",e)}if(isRosetta()){return skipSearch(false,"Rosetta",e)}const t=globalLibvipsVersion();return!!t&&s(t,d)};e.exports={minimumLibvipsVersion:d,prebuiltPlatforms:m,buildPlatformArch:buildPlatformArch,buildSharpLibvipsIncludeDir:buildSharpLibvipsIncludeDir,buildSharpLibvipsCPlusPlusDir:buildSharpLibvipsCPlusPlusDir,buildSharpLibvipsLibDir:buildSharpLibvipsLibDir,isUnsupportedNodeRuntime:isUnsupportedNodeRuntime,runtimePlatformArch:runtimePlatformArch,log:log,yarnLocator:yarnLocator,spawnRebuild:spawnRebuild,globalLibvipsVersion:globalLibvipsVersion,pkgConfigPath:pkgConfigPath,useGlobalLibvips:useGlobalLibvips}},6450:(e,t,r)=>{
/*!
  Copyright 2013 Lovell Fuller and others.
  SPDX-License-Identifier: Apache-2.0
*/
const n=r(3031);const i={integer:"integer",float:"float",approximate:"approximate"};function rotate(e,t){if(!n.defined(e)){return this.autoOrient()}if(this.options.angle||this.options.rotationAngle){this.options.debuglog("ignoring previous rotate options");this.options.angle=0;this.options.rotationAngle=0}if(n.integer(e)&&!(e%90)){this.options.angle=e}else if(n.number(e)){this.options.rotationAngle=e;if(n.object(t)&&t.background){this._setBackgroundColourOption("rotationBackground",t.background)}}else{throw n.invalidParameterError("angle","numeric",e)}return this}function autoOrient(){this.options.input.autoOrient=true;return this}function flip(e){this.options.flip=n.bool(e)?e:true;return this}function flop(e){this.options.flop=n.bool(e)?e:true;return this}function affine(e,t){const r=[].concat(...e);if(r.length===4&&r.every(n.number)){this.options.affineMatrix=r}else{throw n.invalidParameterError("matrix","1x4 or 2x2 array",e)}if(n.defined(t)){if(n.object(t)){this._setBackgroundColourOption("affineBackground",t.background);if(n.defined(t.idx)){if(n.number(t.idx)){this.options.affineIdx=t.idx}else{throw n.invalidParameterError("options.idx","number",t.idx)}}if(n.defined(t.idy)){if(n.number(t.idy)){this.options.affineIdy=t.idy}else{throw n.invalidParameterError("options.idy","number",t.idy)}}if(n.defined(t.odx)){if(n.number(t.odx)){this.options.affineOdx=t.odx}else{throw n.invalidParameterError("options.odx","number",t.odx)}}if(n.defined(t.ody)){if(n.number(t.ody)){this.options.affineOdy=t.ody}else{throw n.invalidParameterError("options.ody","number",t.ody)}}if(n.defined(t.interpolator)){if(n.inArray(t.interpolator,Object.values(this.constructor.interpolators))){this.options.affineInterpolator=t.interpolator}else{throw n.invalidParameterError("options.interpolator","valid interpolator name",t.interpolator)}}}else{throw n.invalidParameterError("options","object",t)}}return this}function sharpen(e,t,r){if(!n.defined(e)){this.options.sharpenSigma=-1}else if(n.bool(e)){this.options.sharpenSigma=e?-1:0}else if(n.number(e)&&n.inRange(e,.01,1e4)){this.options.sharpenSigma=e;if(n.defined(t)){if(n.number(t)&&n.inRange(t,0,1e4)){this.options.sharpenM1=t}else{throw n.invalidParameterError("flat","number between 0 and 10000",t)}}if(n.defined(r)){if(n.number(r)&&n.inRange(r,0,1e4)){this.options.sharpenM2=r}else{throw n.invalidParameterError("jagged","number between 0 and 10000",r)}}}else if(n.plainObject(e)){if(n.number(e.sigma)&&n.inRange(e.sigma,1e-6,10)){this.options.sharpenSigma=e.sigma}else{throw n.invalidParameterError("options.sigma","number between 0.000001 and 10",e.sigma)}if(n.defined(e.m1)){if(n.number(e.m1)&&n.inRange(e.m1,0,1e6)){this.options.sharpenM1=e.m1}else{throw n.invalidParameterError("options.m1","number between 0 and 1000000",e.m1)}}if(n.defined(e.m2)){if(n.number(e.m2)&&n.inRange(e.m2,0,1e6)){this.options.sharpenM2=e.m2}else{throw n.invalidParameterError("options.m2","number between 0 and 1000000",e.m2)}}if(n.defined(e.x1)){if(n.number(e.x1)&&n.inRange(e.x1,0,1e6)){this.options.sharpenX1=e.x1}else{throw n.invalidParameterError("options.x1","number between 0 and 1000000",e.x1)}}if(n.defined(e.y2)){if(n.number(e.y2)&&n.inRange(e.y2,0,1e6)){this.options.sharpenY2=e.y2}else{throw n.invalidParameterError("options.y2","number between 0 and 1000000",e.y2)}}if(n.defined(e.y3)){if(n.number(e.y3)&&n.inRange(e.y3,0,1e6)){this.options.sharpenY3=e.y3}else{throw n.invalidParameterError("options.y3","number between 0 and 1000000",e.y3)}}}else{throw n.invalidParameterError("sigma","number between 0.01 and 10000",e)}return this}function median(e){if(!n.defined(e)){this.options.medianSize=3}else if(n.integer(e)&&n.inRange(e,1,1e3)){this.options.medianSize=e}else{throw n.invalidParameterError("size","integer between 1 and 1000",e)}return this}function blur(e){let t;if(n.number(e)){t=e}else if(n.plainObject(e)){if(!n.number(e.sigma)){throw n.invalidParameterError("options.sigma","number between 0.3 and 1000",t)}t=e.sigma;if("precision"in e){if(n.string(i[e.precision])){this.options.precision=i[e.precision]}else{throw n.invalidParameterError("precision","one of: integer, float, approximate",e.precision)}}if("minAmplitude"in e){if(n.number(e.minAmplitude)&&n.inRange(e.minAmplitude,.001,1)){this.options.minAmpl=e.minAmplitude}else{throw n.invalidParameterError("minAmplitude","number between 0.001 and 1",e.minAmplitude)}}}if(!n.defined(e)){this.options.blurSigma=-1}else if(n.bool(e)){this.options.blurSigma=e?-1:0}else if(n.number(t)&&n.inRange(t,.3,1e3)){this.options.blurSigma=t}else{throw n.invalidParameterError("sigma","number between 0.3 and 1000",t)}return this}function dilate(e){if(!n.defined(e)){this.options.dilateWidth=1}else if(n.integer(e)&&e>0){this.options.dilateWidth=e}else{throw n.invalidParameterError("dilate","positive integer",dilate)}return this}function erode(e){if(!n.defined(e)){this.options.erodeWidth=1}else if(n.integer(e)&&e>0){this.options.erodeWidth=e}else{throw n.invalidParameterError("erode","positive integer",erode)}return this}function flatten(e){this.options.flatten=n.bool(e)?e:true;if(n.object(e)){this._setBackgroundColourOption("flattenBackground",e.background)}return this}function unflatten(){this.options.unflatten=true;return this}function gamma(e,t){if(!n.defined(e)){this.options.gamma=2.2}else if(n.number(e)&&n.inRange(e,1,3)){this.options.gamma=e}else{throw n.invalidParameterError("gamma","number between 1.0 and 3.0",e)}if(!n.defined(t)){this.options.gammaOut=this.options.gamma}else if(n.number(t)&&n.inRange(t,1,3)){this.options.gammaOut=t}else{throw n.invalidParameterError("gammaOut","number between 1.0 and 3.0",t)}return this}function negate(e){this.options.negate=n.bool(e)?e:true;if(n.plainObject(e)&&"alpha"in e){if(!n.bool(e.alpha)){throw n.invalidParameterError("alpha","should be boolean value",e.alpha)}else{this.options.negateAlpha=e.alpha}}return this}function normalise(e){if(n.plainObject(e)){if(n.defined(e.lower)){if(n.number(e.lower)&&n.inRange(e.lower,0,99)){this.options.normaliseLower=e.lower}else{throw n.invalidParameterError("lower","number between 0 and 99",e.lower)}}if(n.defined(e.upper)){if(n.number(e.upper)&&n.inRange(e.upper,1,100)){this.options.normaliseUpper=e.upper}else{throw n.invalidParameterError("upper","number between 1 and 100",e.upper)}}}if(this.options.normaliseLower>=this.options.normaliseUpper){throw n.invalidParameterError("range","lower to be less than upper",`${this.options.normaliseLower} >= ${this.options.normaliseUpper}`)}this.options.normalise=true;return this}function normalize(e){return this.normalise(e)}function clahe(e){if(n.plainObject(e)){if(n.integer(e.width)&&e.width>0){this.options.claheWidth=e.width}else{throw n.invalidParameterError("width","integer greater than zero",e.width)}if(n.integer(e.height)&&e.height>0){this.options.claheHeight=e.height}else{throw n.invalidParameterError("height","integer greater than zero",e.height)}if(n.defined(e.maxSlope)){if(n.integer(e.maxSlope)&&n.inRange(e.maxSlope,0,100)){this.options.claheMaxSlope=e.maxSlope}else{throw n.invalidParameterError("maxSlope","integer between 0 and 100",e.maxSlope)}}}else{throw n.invalidParameterError("options","plain object",e)}return this}function convolve(e){if(!n.object(e)||!Array.isArray(e.kernel)||!n.integer(e.width)||!n.integer(e.height)||!n.inRange(e.width,3,1001)||!n.inRange(e.height,3,1001)||e.height*e.width!==e.kernel.length){throw new Error("Invalid convolution kernel")}if(!n.integer(e.scale)){e.scale=e.kernel.reduce(((e,t)=>e+t),0)}if(e.scale<1){e.scale=1}if(!n.integer(e.offset)){e.offset=0}this.options.convKernel=e;return this}function threshold(e,t){if(!n.defined(e)){this.options.threshold=128}else if(n.bool(e)){this.options.threshold=e?128:0}else if(n.integer(e)&&n.inRange(e,0,255)){this.options.threshold=e}else{throw n.invalidParameterError("threshold","integer between 0 and 255",e)}if(!n.object(t)||t.greyscale===true||t.grayscale===true){this.options.thresholdGrayscale=true}else{this.options.thresholdGrayscale=false}return this}function boolean(e,t,r){this.options.boolean=this._createInputDescriptor(e,r);if(n.string(t)&&n.inArray(t,["and","or","eor"])){this.options.booleanOp=t}else{throw n.invalidParameterError("operator","one of: and, or, eor",t)}return this}function linear(e,t){if(!n.defined(e)&&n.number(t)){e=1}else if(n.number(e)&&!n.defined(t)){t=0}if(!n.defined(e)){this.options.linearA=[]}else if(n.number(e)){this.options.linearA=[e]}else if(Array.isArray(e)&&e.length&&e.every(n.number)){this.options.linearA=e}else{throw n.invalidParameterError("a","number or array of numbers",e)}if(!n.defined(t)){this.options.linearB=[]}else if(n.number(t)){this.options.linearB=[t]}else if(Array.isArray(t)&&t.length&&t.every(n.number)){this.options.linearB=t}else{throw n.invalidParameterError("b","number or array of numbers",t)}if(this.options.linearA.length!==this.options.linearB.length){throw new Error("Expected a and b to be arrays of the same length")}return this}function recomb(e){if(!Array.isArray(e)){throw n.invalidParameterError("inputMatrix","array",e)}if(e.length!==3&&e.length!==4){throw n.invalidParameterError("inputMatrix","3x3 or 4x4 array",e.length)}const t=e.flat().map(Number);if(t.length!==9&&t.length!==16){throw n.invalidParameterError("inputMatrix","cardinality of 9 or 16",t.length)}this.options.recombMatrix=t;return this}function modulate(e){if(!n.plainObject(e)){throw n.invalidParameterError("options","plain object",e)}if("brightness"in e){if(n.number(e.brightness)&&e.brightness>=0){this.options.brightness=e.brightness}else{throw n.invalidParameterError("brightness","number above zero",e.brightness)}}if("saturation"in e){if(n.number(e.saturation)&&e.saturation>=0){this.options.saturation=e.saturation}else{throw n.invalidParameterError("saturation","number above zero",e.saturation)}}if("hue"in e){if(n.integer(e.hue)){this.options.hue=e.hue%360}else{throw n.invalidParameterError("hue","number",e.hue)}}if("lightness"in e){if(n.number(e.lightness)){this.options.lightness=e.lightness}else{throw n.invalidParameterError("lightness","number",e.lightness)}}return this}e.exports=e=>{Object.assign(e.prototype,{autoOrient:autoOrient,rotate:rotate,flip:flip,flop:flop,affine:affine,sharpen:sharpen,erode:erode,dilate:dilate,median:median,blur:blur,flatten:flatten,unflatten:unflatten,gamma:gamma,negate:negate,normalise:normalise,normalize:normalize,clahe:clahe,convolve:convolve,threshold:threshold,boolean:boolean,linear:linear,recomb:recomb,modulate:modulate})}},982:(e,t,r)=>{
/*!
  Copyright 2013 Lovell Fuller and others.
  SPDX-License-Identifier: Apache-2.0
*/
const n=r(6760);const i=r(3031);const o=r(1395);const s=new Map([["heic","heif"],["heif","heif"],["avif","avif"],["jpeg","jpeg"],["jpg","jpeg"],["jpe","jpeg"],["tile","tile"],["dz","tile"],["png","png"],["raw","raw"],["tiff","tiff"],["tif","tiff"],["webp","webp"],["gif","gif"],["jp2","jp2"],["jpx","jp2"],["j2k","jp2"],["j2c","jp2"],["jxl","jxl"]]);const a=/\.(jp[2x]|j2[kc])$/i;const errJp2Save=()=>new Error("JP2 output requires libvips with support for OpenJPEG");const bitdepthFromColourCount=e=>1<<31-Math.clz32(Math.ceil(Math.log2(e)));function toFile(e,t){let r;if(!i.string(e)){r=new Error("Missing output file path")}else if(i.string(this.options.input.file)&&n.resolve(this.options.input.file)===n.resolve(e)){r=new Error("Cannot use same file for input and output")}else if(a.test(n.extname(e))&&!this.constructor.format.jp2k.output.file){r=errJp2Save()}if(r){if(i.fn(t)){t(r)}else{return Promise.reject(r)}}else{this.options.fileOut=e;const r=Error();return this._pipeline(t,r)}return this}function toBuffer(e,t){if(i.object(e)){this._setBooleanOption("resolveWithObject",e.resolveWithObject)}else if(this.options.resolveWithObject){this.options.resolveWithObject=false}this.options.fileOut="";const r=Error();return this._pipeline(i.fn(e)?e:t,r)}function keepExif(){this.options.keepMetadata|=1;return this}function withExif(e){if(i.object(e)){for(const[t,r]of Object.entries(e)){if(i.object(r)){for(const[e,n]of Object.entries(r)){if(i.string(n)){this.options.withExif[`exif-${t.toLowerCase()}-${e}`]=n}else{throw i.invalidParameterError(`${t}.${e}`,"string",n)}}}else{throw i.invalidParameterError(t,"object",r)}}}else{throw i.invalidParameterError("exif","object",e)}this.options.withExifMerge=false;return this.keepExif()}function withExifMerge(e){this.withExif(e);this.options.withExifMerge=true;return this}function keepIccProfile(){this.options.keepMetadata|=8;return this}function withIccProfile(e,t){if(i.string(e)){this.options.withIccProfile=e}else{throw i.invalidParameterError("icc","string",e)}this.keepIccProfile();if(i.object(t)){if(i.defined(t.attach)){if(i.bool(t.attach)){if(!t.attach){this.options.keepMetadata&=~8}}else{throw i.invalidParameterError("attach","boolean",t.attach)}}}return this}function keepXmp(){this.options.keepMetadata|=2;return this}function withXmp(e){if(i.string(e)&&e.length>0){this.options.withXmp=e;this.options.keepMetadata|=2}else{throw i.invalidParameterError("xmp","non-empty string",e)}return this}function keepMetadata(){this.options.keepMetadata=31;return this}function withMetadata(e){this.keepMetadata();this.withIccProfile("srgb");if(i.object(e)){if(i.defined(e.orientation)){if(i.integer(e.orientation)&&i.inRange(e.orientation,1,8)){this.options.withMetadataOrientation=e.orientation}else{throw i.invalidParameterError("orientation","integer between 1 and 8",e.orientation)}}if(i.defined(e.density)){if(i.number(e.density)&&e.density>0){this.options.withMetadataDensity=e.density}else{throw i.invalidParameterError("density","positive number",e.density)}}if(i.defined(e.icc)){this.withIccProfile(e.icc)}if(i.defined(e.exif)){this.withExifMerge(e.exif)}}return this}function toFormat(e,t){const r=s.get((i.object(e)&&i.string(e.id)?e.id:e).toLowerCase());if(!r){throw i.invalidParameterError("format",`one of: ${[...s.keys()].join(", ")}`,e)}return this[r](t)}function jpeg(e){if(i.object(e)){if(i.defined(e.quality)){if(i.integer(e.quality)&&i.inRange(e.quality,1,100)){this.options.jpegQuality=e.quality}else{throw i.invalidParameterError("quality","integer between 1 and 100",e.quality)}}if(i.defined(e.progressive)){this._setBooleanOption("jpegProgressive",e.progressive)}if(i.defined(e.chromaSubsampling)){if(i.string(e.chromaSubsampling)&&i.inArray(e.chromaSubsampling,["4:2:0","4:4:4"])){this.options.jpegChromaSubsampling=e.chromaSubsampling}else{throw i.invalidParameterError("chromaSubsampling","one of: 4:2:0, 4:4:4",e.chromaSubsampling)}}const t=i.bool(e.optimizeCoding)?e.optimizeCoding:e.optimiseCoding;if(i.defined(t)){this._setBooleanOption("jpegOptimiseCoding",t)}if(i.defined(e.mozjpeg)){if(i.bool(e.mozjpeg)){if(e.mozjpeg){this.options.jpegTrellisQuantisation=true;this.options.jpegOvershootDeringing=true;this.options.jpegOptimiseScans=true;this.options.jpegProgressive=true;this.options.jpegQuantisationTable=3}}else{throw i.invalidParameterError("mozjpeg","boolean",e.mozjpeg)}}const r=i.bool(e.trellisQuantization)?e.trellisQuantization:e.trellisQuantisation;if(i.defined(r)){this._setBooleanOption("jpegTrellisQuantisation",r)}if(i.defined(e.overshootDeringing)){this._setBooleanOption("jpegOvershootDeringing",e.overshootDeringing)}const n=i.bool(e.optimizeScans)?e.optimizeScans:e.optimiseScans;if(i.defined(n)){this._setBooleanOption("jpegOptimiseScans",n);if(n){this.options.jpegProgressive=true}}const o=i.number(e.quantizationTable)?e.quantizationTable:e.quantisationTable;if(i.defined(o)){if(i.integer(o)&&i.inRange(o,0,8)){this.options.jpegQuantisationTable=o}else{throw i.invalidParameterError("quantisationTable","integer between 0 and 8",o)}}}return this._updateFormatOut("jpeg",e)}function png(e){if(i.object(e)){if(i.defined(e.progressive)){this._setBooleanOption("pngProgressive",e.progressive)}if(i.defined(e.compressionLevel)){if(i.integer(e.compressionLevel)&&i.inRange(e.compressionLevel,0,9)){this.options.pngCompressionLevel=e.compressionLevel}else{throw i.invalidParameterError("compressionLevel","integer between 0 and 9",e.compressionLevel)}}if(i.defined(e.adaptiveFiltering)){this._setBooleanOption("pngAdaptiveFiltering",e.adaptiveFiltering)}const t=e.colours||e.colors;if(i.defined(t)){if(i.integer(t)&&i.inRange(t,2,256)){this.options.pngBitdepth=bitdepthFromColourCount(t)}else{throw i.invalidParameterError("colours","integer between 2 and 256",t)}}if(i.defined(e.palette)){this._setBooleanOption("pngPalette",e.palette)}else if([e.quality,e.effort,e.colours,e.colors,e.dither].some(i.defined)){this._setBooleanOption("pngPalette",true)}if(this.options.pngPalette){if(i.defined(e.quality)){if(i.integer(e.quality)&&i.inRange(e.quality,0,100)){this.options.pngQuality=e.quality}else{throw i.invalidParameterError("quality","integer between 0 and 100",e.quality)}}if(i.defined(e.effort)){if(i.integer(e.effort)&&i.inRange(e.effort,1,10)){this.options.pngEffort=e.effort}else{throw i.invalidParameterError("effort","integer between 1 and 10",e.effort)}}if(i.defined(e.dither)){if(i.number(e.dither)&&i.inRange(e.dither,0,1)){this.options.pngDither=e.dither}else{throw i.invalidParameterError("dither","number between 0.0 and 1.0",e.dither)}}}}return this._updateFormatOut("png",e)}function webp(e){if(i.object(e)){if(i.defined(e.quality)){if(i.integer(e.quality)&&i.inRange(e.quality,1,100)){this.options.webpQuality=e.quality}else{throw i.invalidParameterError("quality","integer between 1 and 100",e.quality)}}if(i.defined(e.alphaQuality)){if(i.integer(e.alphaQuality)&&i.inRange(e.alphaQuality,0,100)){this.options.webpAlphaQuality=e.alphaQuality}else{throw i.invalidParameterError("alphaQuality","integer between 0 and 100",e.alphaQuality)}}if(i.defined(e.lossless)){this._setBooleanOption("webpLossless",e.lossless)}if(i.defined(e.nearLossless)){this._setBooleanOption("webpNearLossless",e.nearLossless)}if(i.defined(e.smartSubsample)){this._setBooleanOption("webpSmartSubsample",e.smartSubsample)}if(i.defined(e.smartDeblock)){this._setBooleanOption("webpSmartDeblock",e.smartDeblock)}if(i.defined(e.preset)){if(i.string(e.preset)&&i.inArray(e.preset,["default","photo","picture","drawing","icon","text"])){this.options.webpPreset=e.preset}else{throw i.invalidParameterError("preset","one of: default, photo, picture, drawing, icon, text",e.preset)}}if(i.defined(e.effort)){if(i.integer(e.effort)&&i.inRange(e.effort,0,6)){this.options.webpEffort=e.effort}else{throw i.invalidParameterError("effort","integer between 0 and 6",e.effort)}}if(i.defined(e.minSize)){this._setBooleanOption("webpMinSize",e.minSize)}if(i.defined(e.mixed)){this._setBooleanOption("webpMixed",e.mixed)}}trySetAnimationOptions(e,this.options);return this._updateFormatOut("webp",e)}function gif(e){if(i.object(e)){if(i.defined(e.reuse)){this._setBooleanOption("gifReuse",e.reuse)}if(i.defined(e.progressive)){this._setBooleanOption("gifProgressive",e.progressive)}const t=e.colours||e.colors;if(i.defined(t)){if(i.integer(t)&&i.inRange(t,2,256)){this.options.gifBitdepth=bitdepthFromColourCount(t)}else{throw i.invalidParameterError("colours","integer between 2 and 256",t)}}if(i.defined(e.effort)){if(i.number(e.effort)&&i.inRange(e.effort,1,10)){this.options.gifEffort=e.effort}else{throw i.invalidParameterError("effort","integer between 1 and 10",e.effort)}}if(i.defined(e.dither)){if(i.number(e.dither)&&i.inRange(e.dither,0,1)){this.options.gifDither=e.dither}else{throw i.invalidParameterError("dither","number between 0.0 and 1.0",e.dither)}}if(i.defined(e.interFrameMaxError)){if(i.number(e.interFrameMaxError)&&i.inRange(e.interFrameMaxError,0,32)){this.options.gifInterFrameMaxError=e.interFrameMaxError}else{throw i.invalidParameterError("interFrameMaxError","number between 0.0 and 32.0",e.interFrameMaxError)}}if(i.defined(e.interPaletteMaxError)){if(i.number(e.interPaletteMaxError)&&i.inRange(e.interPaletteMaxError,0,256)){this.options.gifInterPaletteMaxError=e.interPaletteMaxError}else{throw i.invalidParameterError("interPaletteMaxError","number between 0.0 and 256.0",e.interPaletteMaxError)}}if(i.defined(e.keepDuplicateFrames)){if(i.bool(e.keepDuplicateFrames)){this._setBooleanOption("gifKeepDuplicateFrames",e.keepDuplicateFrames)}else{throw i.invalidParameterError("keepDuplicateFrames","boolean",e.keepDuplicateFrames)}}}trySetAnimationOptions(e,this.options);return this._updateFormatOut("gif",e)}function jp2(e){if(!this.constructor.format.jp2k.output.buffer){throw errJp2Save()}if(i.object(e)){if(i.defined(e.quality)){if(i.integer(e.quality)&&i.inRange(e.quality,1,100)){this.options.jp2Quality=e.quality}else{throw i.invalidParameterError("quality","integer between 1 and 100",e.quality)}}if(i.defined(e.lossless)){if(i.bool(e.lossless)){this.options.jp2Lossless=e.lossless}else{throw i.invalidParameterError("lossless","boolean",e.lossless)}}if(i.defined(e.tileWidth)){if(i.integer(e.tileWidth)&&i.inRange(e.tileWidth,1,32768)){this.options.jp2TileWidth=e.tileWidth}else{throw i.invalidParameterError("tileWidth","integer between 1 and 32768",e.tileWidth)}}if(i.defined(e.tileHeight)){if(i.integer(e.tileHeight)&&i.inRange(e.tileHeight,1,32768)){this.options.jp2TileHeight=e.tileHeight}else{throw i.invalidParameterError("tileHeight","integer between 1 and 32768",e.tileHeight)}}if(i.defined(e.chromaSubsampling)){if(i.string(e.chromaSubsampling)&&i.inArray(e.chromaSubsampling,["4:2:0","4:4:4"])){this.options.jp2ChromaSubsampling=e.chromaSubsampling}else{throw i.invalidParameterError("chromaSubsampling","one of: 4:2:0, 4:4:4",e.chromaSubsampling)}}}return this._updateFormatOut("jp2",e)}function trySetAnimationOptions(e,t){if(i.object(e)&&i.defined(e.loop)){if(i.integer(e.loop)&&i.inRange(e.loop,0,65535)){t.loop=e.loop}else{throw i.invalidParameterError("loop","integer between 0 and 65535",e.loop)}}if(i.object(e)&&i.defined(e.delay)){if(i.integer(e.delay)&&i.inRange(e.delay,0,65535)){t.delay=[e.delay]}else if(Array.isArray(e.delay)&&e.delay.every(i.integer)&&e.delay.every((e=>i.inRange(e,0,65535)))){t.delay=e.delay}else{throw i.invalidParameterError("delay","integer or an array of integers between 0 and 65535",e.delay)}}}function tiff(e){if(i.object(e)){if(i.defined(e.quality)){if(i.integer(e.quality)&&i.inRange(e.quality,1,100)){this.options.tiffQuality=e.quality}else{throw i.invalidParameterError("quality","integer between 1 and 100",e.quality)}}if(i.defined(e.bitdepth)){if(i.integer(e.bitdepth)&&i.inArray(e.bitdepth,[1,2,4,8])){this.options.tiffBitdepth=e.bitdepth}else{throw i.invalidParameterError("bitdepth","1, 2, 4 or 8",e.bitdepth)}}if(i.defined(e.tile)){this._setBooleanOption("tiffTile",e.tile)}if(i.defined(e.tileWidth)){if(i.integer(e.tileWidth)&&e.tileWidth>0){this.options.tiffTileWidth=e.tileWidth}else{throw i.invalidParameterError("tileWidth","integer greater than zero",e.tileWidth)}}if(i.defined(e.tileHeight)){if(i.integer(e.tileHeight)&&e.tileHeight>0){this.options.tiffTileHeight=e.tileHeight}else{throw i.invalidParameterError("tileHeight","integer greater than zero",e.tileHeight)}}if(i.defined(e.miniswhite)){this._setBooleanOption("tiffMiniswhite",e.miniswhite)}if(i.defined(e.pyramid)){this._setBooleanOption("tiffPyramid",e.pyramid)}if(i.defined(e.xres)){if(i.number(e.xres)&&e.xres>0){this.options.tiffXres=e.xres}else{throw i.invalidParameterError("xres","number greater than zero",e.xres)}}if(i.defined(e.yres)){if(i.number(e.yres)&&e.yres>0){this.options.tiffYres=e.yres}else{throw i.invalidParameterError("yres","number greater than zero",e.yres)}}if(i.defined(e.compression)){if(i.string(e.compression)&&i.inArray(e.compression,["none","jpeg","deflate","packbits","ccittfax4","lzw","webp","zstd","jp2k"])){this.options.tiffCompression=e.compression}else{throw i.invalidParameterError("compression","one of: none, jpeg, deflate, packbits, ccittfax4, lzw, webp, zstd, jp2k",e.compression)}}if(i.defined(e.bigtiff)){this._setBooleanOption("tiffBigtiff",e.bigtiff)}if(i.defined(e.predictor)){if(i.string(e.predictor)&&i.inArray(e.predictor,["none","horizontal","float"])){this.options.tiffPredictor=e.predictor}else{throw i.invalidParameterError("predictor","one of: none, horizontal, float",e.predictor)}}if(i.defined(e.resolutionUnit)){if(i.string(e.resolutionUnit)&&i.inArray(e.resolutionUnit,["inch","cm"])){this.options.tiffResolutionUnit=e.resolutionUnit}else{throw i.invalidParameterError("resolutionUnit","one of: inch, cm",e.resolutionUnit)}}}return this._updateFormatOut("tiff",e)}function avif(e){return this.heif({...e,compression:"av1"})}function heif(e){if(i.object(e)){if(i.string(e.compression)&&i.inArray(e.compression,["av1","hevc"])){this.options.heifCompression=e.compression}else{throw i.invalidParameterError("compression","one of: av1, hevc",e.compression)}if(i.defined(e.quality)){if(i.integer(e.quality)&&i.inRange(e.quality,1,100)){this.options.heifQuality=e.quality}else{throw i.invalidParameterError("quality","integer between 1 and 100",e.quality)}}if(i.defined(e.lossless)){if(i.bool(e.lossless)){this.options.heifLossless=e.lossless}else{throw i.invalidParameterError("lossless","boolean",e.lossless)}}if(i.defined(e.effort)){if(i.integer(e.effort)&&i.inRange(e.effort,0,9)){this.options.heifEffort=e.effort}else{throw i.invalidParameterError("effort","integer between 0 and 9",e.effort)}}if(i.defined(e.chromaSubsampling)){if(i.string(e.chromaSubsampling)&&i.inArray(e.chromaSubsampling,["4:2:0","4:4:4"])){this.options.heifChromaSubsampling=e.chromaSubsampling}else{throw i.invalidParameterError("chromaSubsampling","one of: 4:2:0, 4:4:4",e.chromaSubsampling)}}if(i.defined(e.bitdepth)){if(i.integer(e.bitdepth)&&i.inArray(e.bitdepth,[8,10,12])){if(e.bitdepth!==8&&this.constructor.versions.heif){throw i.invalidParameterError("bitdepth when using prebuilt binaries",8,e.bitdepth)}this.options.heifBitdepth=e.bitdepth}else{throw i.invalidParameterError("bitdepth","8, 10 or 12",e.bitdepth)}}}else{throw i.invalidParameterError("options","Object",e)}return this._updateFormatOut("heif",e)}function jxl(e){if(i.object(e)){if(i.defined(e.quality)){if(i.integer(e.quality)&&i.inRange(e.quality,1,100)){this.options.jxlDistance=e.quality>=30?.1+(100-e.quality)*.09:53/3e3*e.quality*e.quality-23/20*e.quality+25}else{throw i.invalidParameterError("quality","integer between 1 and 100",e.quality)}}else if(i.defined(e.distance)){if(i.number(e.distance)&&i.inRange(e.distance,0,15)){this.options.jxlDistance=e.distance}else{throw i.invalidParameterError("distance","number between 0.0 and 15.0",e.distance)}}if(i.defined(e.decodingTier)){if(i.integer(e.decodingTier)&&i.inRange(e.decodingTier,0,4)){this.options.jxlDecodingTier=e.decodingTier}else{throw i.invalidParameterError("decodingTier","integer between 0 and 4",e.decodingTier)}}if(i.defined(e.lossless)){if(i.bool(e.lossless)){this.options.jxlLossless=e.lossless}else{throw i.invalidParameterError("lossless","boolean",e.lossless)}}if(i.defined(e.effort)){if(i.integer(e.effort)&&i.inRange(e.effort,1,9)){this.options.jxlEffort=e.effort}else{throw i.invalidParameterError("effort","integer between 1 and 9",e.effort)}}}trySetAnimationOptions(e,this.options);return this._updateFormatOut("jxl",e)}function raw(e){if(i.object(e)){if(i.defined(e.depth)){if(i.string(e.depth)&&i.inArray(e.depth,["char","uchar","short","ushort","int","uint","float","complex","double","dpcomplex"])){this.options.rawDepth=e.depth}else{throw i.invalidParameterError("depth","one of: char, uchar, short, ushort, int, uint, float, complex, double, dpcomplex",e.depth)}}}return this._updateFormatOut("raw")}function tile(e){if(i.object(e)){if(i.defined(e.size)){if(i.integer(e.size)&&i.inRange(e.size,1,8192)){this.options.tileSize=e.size}else{throw i.invalidParameterError("size","integer between 1 and 8192",e.size)}}if(i.defined(e.overlap)){if(i.integer(e.overlap)&&i.inRange(e.overlap,0,8192)){if(e.overlap>this.options.tileSize){throw i.invalidParameterError("overlap",`<= size (${this.options.tileSize})`,e.overlap)}this.options.tileOverlap=e.overlap}else{throw i.invalidParameterError("overlap","integer between 0 and 8192",e.overlap)}}if(i.defined(e.container)){if(i.string(e.container)&&i.inArray(e.container,["fs","zip"])){this.options.tileContainer=e.container}else{throw i.invalidParameterError("container","one of: fs, zip",e.container)}}if(i.defined(e.layout)){if(i.string(e.layout)&&i.inArray(e.layout,["dz","google","iiif","iiif3","zoomify"])){this.options.tileLayout=e.layout}else{throw i.invalidParameterError("layout","one of: dz, google, iiif, iiif3, zoomify",e.layout)}}if(i.defined(e.angle)){if(i.integer(e.angle)&&!(e.angle%90)){this.options.tileAngle=e.angle}else{throw i.invalidParameterError("angle","positive/negative multiple of 90",e.angle)}}this._setBackgroundColourOption("tileBackground",e.background);if(i.defined(e.depth)){if(i.string(e.depth)&&i.inArray(e.depth,["onepixel","onetile","one"])){this.options.tileDepth=e.depth}else{throw i.invalidParameterError("depth","one of: onepixel, onetile, one",e.depth)}}if(i.defined(e.skipBlanks)){if(i.integer(e.skipBlanks)&&i.inRange(e.skipBlanks,-1,65535)){this.options.tileSkipBlanks=e.skipBlanks}else{throw i.invalidParameterError("skipBlanks","integer between -1 and 255/65535",e.skipBlanks)}}else if(i.defined(e.layout)&&e.layout==="google"){this.options.tileSkipBlanks=5}const t=i.bool(e.center)?e.center:e.centre;if(i.defined(t)){this._setBooleanOption("tileCentre",t)}if(i.defined(e.id)){if(i.string(e.id)){this.options.tileId=e.id}else{throw i.invalidParameterError("id","string",e.id)}}if(i.defined(e.basename)){if(i.string(e.basename)){this.options.tileBasename=e.basename}else{throw i.invalidParameterError("basename","string",e.basename)}}}if(i.inArray(this.options.formatOut,["jpeg","png","webp"])){this.options.tileFormat=this.options.formatOut}else if(this.options.formatOut!=="input"){throw i.invalidParameterError("format","one of: jpeg, png, webp",this.options.formatOut)}return this._updateFormatOut("dz")}function timeout(e){if(!i.plainObject(e)){throw i.invalidParameterError("options","object",e)}if(i.integer(e.seconds)&&i.inRange(e.seconds,0,3600)){this.options.timeoutSeconds=e.seconds}else{throw i.invalidParameterError("seconds","integer between 0 and 3600",e.seconds)}return this}function _updateFormatOut(e,t){if(!(i.object(t)&&t.force===false)){this.options.formatOut=e}return this}function _setBooleanOption(e,t){if(i.bool(t)){this.options[e]=t}else{throw i.invalidParameterError(e,"boolean",t)}}function _read(){if(!this.options.streamOut){this.options.streamOut=true;const e=Error();this._pipeline(undefined,e)}}function _pipeline(e,t){if(typeof e==="function"){if(this._isStreamInput()){this.on("finish",(()=>{this._flattenBufferIn();o.pipeline(this.options,((r,n,o)=>{if(r){e(i.nativeError(r,t))}else{e(null,n,o)}}))}))}else{o.pipeline(this.options,((r,n,o)=>{if(r){e(i.nativeError(r,t))}else{e(null,n,o)}}))}return this}else if(this.options.streamOut){if(this._isStreamInput()){this.once("finish",(()=>{this._flattenBufferIn();o.pipeline(this.options,((e,r,n)=>{if(e){this.emit("error",i.nativeError(e,t))}else{this.emit("info",n);this.push(r)}this.push(null);this.on("end",(()=>this.emit("close")))}))}));if(this.streamInFinished){this.emit("finish")}}else{o.pipeline(this.options,((e,r,n)=>{if(e){this.emit("error",i.nativeError(e,t))}else{this.emit("info",n);this.push(r)}this.push(null);this.on("end",(()=>this.emit("close")))}))}return this}else{if(this._isStreamInput()){return new Promise(((e,r)=>{this.once("finish",(()=>{this._flattenBufferIn();o.pipeline(this.options,((n,o,s)=>{if(n){r(i.nativeError(n,t))}else{if(this.options.resolveWithObject){e({data:o,info:s})}else{e(o)}}}))}))}))}else{return new Promise(((e,r)=>{o.pipeline(this.options,((n,o,s)=>{if(n){r(i.nativeError(n,t))}else{if(this.options.resolveWithObject){e({data:o,info:s})}else{e(o)}}}))}))}}}e.exports=e=>{Object.assign(e.prototype,{toFile:toFile,toBuffer:toBuffer,keepExif:keepExif,withExif:withExif,withExifMerge:withExifMerge,keepIccProfile:keepIccProfile,withIccProfile:withIccProfile,keepXmp:keepXmp,withXmp:withXmp,keepMetadata:keepMetadata,withMetadata:withMetadata,toFormat:toFormat,jpeg:jpeg,jp2:jp2,png:png,webp:webp,tiff:tiff,avif:avif,heif:heif,jxl:jxl,gif:gif,raw:raw,tile:tile,timeout:timeout,_updateFormatOut:_updateFormatOut,_setBooleanOption:_setBooleanOption,_read:_read,_pipeline:_pipeline})}},1527:(e,t,r)=>{
/*!
  Copyright 2013 Lovell Fuller and others.
  SPDX-License-Identifier: Apache-2.0
*/
const n=r(3031);const i={center:0,centre:0,north:1,east:2,south:3,west:4,northeast:5,southeast:6,southwest:7,northwest:8};const o={top:1,right:2,bottom:3,left:4,"right top":5,"right bottom":6,"left bottom":7,"left top":8};const s={background:"background",copy:"copy",repeat:"repeat",mirror:"mirror"};const a={entropy:16,attention:17};const l={nearest:"nearest",linear:"linear",cubic:"cubic",mitchell:"mitchell",lanczos2:"lanczos2",lanczos3:"lanczos3",mks2013:"mks2013",mks2021:"mks2021"};const c={contain:"contain",cover:"cover",fill:"fill",inside:"inside",outside:"outside"};const h={contain:"embed",cover:"crop",fill:"ignore_aspect",inside:"max",outside:"min"};function isRotationExpected(e){return e.angle%360!==0||e.rotationAngle!==0}function isResizeExpected(e){return e.width!==-1||e.height!==-1}function resize(e,t,r){if(isResizeExpected(this.options)){this.options.debuglog("ignoring previous resize options")}if(this.options.widthPost!==-1){this.options.debuglog("operation order will be: extract, resize, extract")}if(n.defined(e)){if(n.object(e)&&!n.defined(r)){r=e}else if(n.integer(e)&&e>0){this.options.width=e}else{throw n.invalidParameterError("width","positive integer",e)}}else{this.options.width=-1}if(n.defined(t)){if(n.integer(t)&&t>0){this.options.height=t}else{throw n.invalidParameterError("height","positive integer",t)}}else{this.options.height=-1}if(n.object(r)){if(n.defined(r.width)){if(n.integer(r.width)&&r.width>0){this.options.width=r.width}else{throw n.invalidParameterError("width","positive integer",r.width)}}if(n.defined(r.height)){if(n.integer(r.height)&&r.height>0){this.options.height=r.height}else{throw n.invalidParameterError("height","positive integer",r.height)}}if(n.defined(r.fit)){const e=h[r.fit];if(n.string(e)){this.options.canvas=e}else{throw n.invalidParameterError("fit","valid fit",r.fit)}}if(n.defined(r.position)){const e=n.integer(r.position)?r.position:a[r.position]||o[r.position]||i[r.position];if(n.integer(e)&&(n.inRange(e,0,8)||n.inRange(e,16,17))){this.options.position=e}else{throw n.invalidParameterError("position","valid position/gravity/strategy",r.position)}}this._setBackgroundColourOption("resizeBackground",r.background);if(n.defined(r.kernel)){if(n.string(l[r.kernel])){this.options.kernel=l[r.kernel]}else{throw n.invalidParameterError("kernel","valid kernel name",r.kernel)}}if(n.defined(r.withoutEnlargement)){this._setBooleanOption("withoutEnlargement",r.withoutEnlargement)}if(n.defined(r.withoutReduction)){this._setBooleanOption("withoutReduction",r.withoutReduction)}if(n.defined(r.fastShrinkOnLoad)){this._setBooleanOption("fastShrinkOnLoad",r.fastShrinkOnLoad)}}if(isRotationExpected(this.options)&&isResizeExpected(this.options)){this.options.rotateBefore=true}return this}function extend(e){if(n.integer(e)&&e>0){this.options.extendTop=e;this.options.extendBottom=e;this.options.extendLeft=e;this.options.extendRight=e}else if(n.object(e)){if(n.defined(e.top)){if(n.integer(e.top)&&e.top>=0){this.options.extendTop=e.top}else{throw n.invalidParameterError("top","positive integer",e.top)}}if(n.defined(e.bottom)){if(n.integer(e.bottom)&&e.bottom>=0){this.options.extendBottom=e.bottom}else{throw n.invalidParameterError("bottom","positive integer",e.bottom)}}if(n.defined(e.left)){if(n.integer(e.left)&&e.left>=0){this.options.extendLeft=e.left}else{throw n.invalidParameterError("left","positive integer",e.left)}}if(n.defined(e.right)){if(n.integer(e.right)&&e.right>=0){this.options.extendRight=e.right}else{throw n.invalidParameterError("right","positive integer",e.right)}}this._setBackgroundColourOption("extendBackground",e.background);if(n.defined(e.extendWith)){if(n.string(s[e.extendWith])){this.options.extendWith=s[e.extendWith]}else{throw n.invalidParameterError("extendWith","one of: background, copy, repeat, mirror",e.extendWith)}}}else{throw n.invalidParameterError("extend","integer or object",e)}return this}function extract(e){const t=isResizeExpected(this.options)||this.options.widthPre!==-1?"Post":"Pre";if(this.options[`width${t}`]!==-1){this.options.debuglog("ignoring previous extract options")}["left","top","width","height"].forEach((function(r){const i=e[r];if(n.integer(i)&&i>=0){this.options[r+(r==="left"||r==="top"?"Offset":"")+t]=i}else{throw n.invalidParameterError(r,"integer",i)}}),this);if(isRotationExpected(this.options)&&!isResizeExpected(this.options)){if(this.options.widthPre===-1||this.options.widthPost===-1){this.options.rotateBefore=true}}if(this.options.input.autoOrient){this.options.orientBefore=true}return this}function trim(e){this.options.trimThreshold=10;if(n.defined(e)){if(n.object(e)){if(n.defined(e.background)){this._setBackgroundColourOption("trimBackground",e.background)}if(n.defined(e.threshold)){if(n.number(e.threshold)&&e.threshold>=0){this.options.trimThreshold=e.threshold}else{throw n.invalidParameterError("threshold","positive number",e.threshold)}}if(n.defined(e.lineArt)){this._setBooleanOption("trimLineArt",e.lineArt)}}else{throw n.invalidParameterError("trim","object",e)}}if(isRotationExpected(this.options)){this.options.rotateBefore=true}return this}e.exports=e=>{Object.assign(e.prototype,{resize:resize,extend:extend,extract:extract,trim:trim});e.gravity=i;e.strategy=a;e.kernel=l;e.fit=c;e.position=o}},1395:(e,t,r)=>{
/*!
  Copyright 2013 Lovell Fuller and others.
  SPDX-License-Identifier: Apache-2.0
*/
const{familySync:n,versionSync:i}=r(8772);const{runtimePlatformArch:o,isUnsupportedNodeRuntime:s,prebuiltPlatforms:a,minimumLibvipsVersion:l}=r(1808);const c=o();const h=[`../src/build/Release/sharp-${c}.node`,"../src/build/Release/sharp-wasm32.node",`@img/sharp-${c}/sharp.node`,"@img/sharp-wasm32/sharp.node"];let u,p;const d=[];for(u of h){try{p=(0,module__WEBPACK_IMPORTED_MODULE_0__.createRequire)(import.meta.url)(u);break}catch(e){d.push(e)}}if(p&&u.startsWith("@img/sharp-linux-x64")&&!p._isUsingX64V2()){const e=new Error("Prebuilt binaries for linux-x64 require v2 microarchitecture");e.code="Unsupported CPU";d.push(e);p=null}if(p){e.exports=p}else{const[t,r,o]=["linux","darwin","win32"].map((e=>c.startsWith(e)));const h=[`Could not load the "sharp" module using the ${c} runtime`];d.forEach((e=>{if(e.code!=="MODULE_NOT_FOUND"){h.push(`${e.code}: ${e.message}`)}}));const u=d.map((e=>e.message)).join(" ");h.push("Possible solutions:");if(s()){const{found:e,expected:t}=s();h.push("- Please upgrade Node.js:",`    Found ${e}`,`    Requires ${t}`)}else if(a.includes(c)){const[e,t]=c.split("-");const r=e.endsWith("musl")?" --libc=musl":"";h.push("- Ensure optional dependencies can be installed:","    npm install --include=optional sharp","- Ensure your package manager supports multi-platform installation:","    See https://sharp.pixelplumbing.com/install#cross-platform","- Add platform-specific dependencies:",`    npm install --os=${e.replace("musl","")}${r} --cpu=${t} sharp`)}else{h.push(`- Manually install libvips >= ${l}`,"- Add experimental WebAssembly-based dependencies:","    npm install --cpu=wasm32 sharp","    npm install @img/sharp-wasm32")}if(t&&/(symbol not found|CXXABI_)/i.test(u)){try{const{config:e}=(0,module__WEBPACK_IMPORTED_MODULE_0__.createRequire)(import.meta.url)(`@img/sharp-libvips-${c}/package`);const t=`${n()} ${i()}`;const r=`${e.musl?"musl":"glibc"} ${e.musl||e.glibc}`;h.push("- Update your OS:",`    Found ${t}`,`    Requires ${r}`)}catch(e){}}if(t&&/\/snap\/core[0-9]{2}/.test(u)){h.push("- Remove the Node.js Snap, which does not support native modules","    snap remove node")}if(r&&/Incompatible library version/.test(u)){h.push("- Update Homebrew:","    brew update && brew upgrade vips")}if(d.some((e=>e.code==="ERR_DLOPEN_DISABLED"))){h.push("- Run Node.js without using the --no-addons flag")}if(o&&/The specified procedure could not be found/.test(u)){h.push("- Using the canvas package on Windows?","    See https://sharp.pixelplumbing.com/install#canvas-and-windows","- Check for outdated versions of sharp in the dependency tree:","    npm ls sharp")}h.push("- Consult the installation documentation:","    See https://sharp.pixelplumbing.com/install");throw new Error(h.join("\n"))}},735:(e,t,r)=>{
/*!
  Copyright 2013 Lovell Fuller and others.
  SPDX-License-Identifier: Apache-2.0
*/
const n=r(8474);const i=r(8772);const o=r(3031);const{runtimePlatformArch:s}=r(1808);const a=r(1395);const l=s();const c=a.libvipsVersion();const h=a.format();h.heif.output.alias=["avif","heic"];h.jpeg.output.alias=["jpe","jpg"];h.tiff.output.alias=["tif"];h.jp2k.output.alias=["j2c","j2k","jp2","jpx"];const u={nearest:"nearest",bilinear:"bilinear",bicubic:"bicubic",locallyBoundedBicubic:"lbb",nohalo:"nohalo",vertexSplitQuadraticBasisSpline:"vsqbs"};let p={vips:c.semver};if(!c.isGlobal){if(!c.isWasm){try{p=(0,module__WEBPACK_IMPORTED_MODULE_0__.createRequire)(import.meta.url)(`@img/sharp-${l}/versions`)}catch(e){try{p=(0,module__WEBPACK_IMPORTED_MODULE_0__.createRequire)(import.meta.url)(`@img/sharp-libvips-${l}/versions`)}catch(e){}}}else{try{p=r(6279)}catch(e){}}}p.sharp=r(7816).version;if(p.heif&&h.heif){h.heif.input.fileSuffix=[".avif"];h.heif.output.alias=["avif"]}function cache(e){if(o.bool(e)){if(e){return a.cache(50,20,100)}else{return a.cache(0,0,0)}}else if(o.object(e)){return a.cache(e.memory,e.files,e.items)}else{return a.cache()}}cache(true);function concurrency(e){return a.concurrency(o.integer(e)?e:null)}if(i.familySync()===i.GLIBC&&!a._isUsingJemalloc()){a.concurrency(1)}else if(i.familySync()===i.MUSL&&a.concurrency()===1024){a.concurrency(r(8161).availableParallelism())}const d=new n.EventEmitter;function counters(){return a.counters()}function simd(e){return a.simd(o.bool(e)?e:null)}function block(e){if(o.object(e)){if(Array.isArray(e.operation)&&e.operation.every(o.string)){a.block(e.operation,true)}else{throw o.invalidParameterError("operation","Array<string>",e.operation)}}else{throw o.invalidParameterError("options","object",e)}}function unblock(e){if(o.object(e)){if(Array.isArray(e.operation)&&e.operation.every(o.string)){a.block(e.operation,false)}else{throw o.invalidParameterError("operation","Array<string>",e.operation)}}else{throw o.invalidParameterError("options","object",e)}}e.exports=e=>{e.cache=cache;e.concurrency=concurrency;e.counters=counters;e.simd=simd;e.format=h;e.interpolators=u;e.versions=p;e.queue=d;e.block=block;e.unblock=unblock}},5446:e=>{var t=Object.defineProperty;var r=Object.getOwnPropertyDescriptor;var n=Object.getOwnPropertyNames;var i=Object.prototype.hasOwnProperty;var __export=(e,r)=>{for(var n in r)t(e,n,{get:r[n],enumerable:true})};var __copyProps=(e,o,s,a)=>{if(o&&typeof o==="object"||typeof o==="function"){for(let l of n(o))if(!i.call(e,l)&&l!==s)t(e,l,{get:()=>o[l],enumerable:!(a=r(o,l))||a.enumerable})}return e};var __toCommonJS=e=>__copyProps(t({},"__esModule",{value:true}),e);var o={};__export(o,{default:()=>x});e.exports=__toCommonJS(o);var s={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};var a=Object.create(null);for(const e in s){if(Object.hasOwn(s,e)){a[s[e]]=e}}var l={to:{},get:{}};l.get=function(e){const t=e.slice(0,3).toLowerCase();let r;let n;switch(t){case"hsl":{r=l.get.hsl(e);n="hsl";break}case"hwb":{r=l.get.hwb(e);n="hwb";break}default:{r=l.get.rgb(e);n="rgb";break}}if(!r){return null}return{model:n,value:r}};l.get.rgb=function(e){if(!e){return null}const t=/^#([a-f\d]{3,4})$/i;const r=/^#([a-f\d]{6})([a-f\d]{2})?$/i;const n=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[\s,|/]\s*([+-]?[\d.]+)(%?)\s*)?\)$/;const i=/^rgba?\(\s*([+-]?[\d.]+)%\s*,?\s*([+-]?[\d.]+)%\s*,?\s*([+-]?[\d.]+)%\s*(?:[\s,|/]\s*([+-]?[\d.]+)(%?)\s*)?\)$/;const o=/^(\w+)$/;let a=[0,0,0,1];let l;let c;let h;if(l=e.match(r)){h=l[2];l=l[1];for(c=0;c<3;c++){const e=c*2;a[c]=Number.parseInt(l.slice(e,e+2),16)}if(h){a[3]=Number.parseInt(h,16)/255}}else if(l=e.match(t)){l=l[1];h=l[3];for(c=0;c<3;c++){a[c]=Number.parseInt(l[c]+l[c],16)}if(h){a[3]=Number.parseInt(h+h,16)/255}}else if(l=e.match(n)){for(c=0;c<3;c++){a[c]=Number.parseInt(l[c+1],10)}if(l[4]){a[3]=l[5]?Number.parseFloat(l[4])*.01:Number.parseFloat(l[4])}}else if(l=e.match(i)){for(c=0;c<3;c++){a[c]=Math.round(Number.parseFloat(l[c+1])*2.55)}if(l[4]){a[3]=l[5]?Number.parseFloat(l[4])*.01:Number.parseFloat(l[4])}}else if(l=e.match(o)){if(l[1]==="transparent"){return[0,0,0,0]}if(!Object.hasOwn(s,l[1])){return null}a=s[l[1]];a[3]=1;return a}else{return null}for(c=0;c<3;c++){a[c]=clamp(a[c],0,255)}a[3]=clamp(a[3],0,1);return a};l.get.hsl=function(e){if(!e){return null}const t=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d.]+)%\s*,?\s*([+-]?[\d.]+)%\s*(?:[,|/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/;const r=e.match(t);if(r){const e=Number.parseFloat(r[4]);const t=(Number.parseFloat(r[1])%360+360)%360;const n=clamp(Number.parseFloat(r[2]),0,100);const i=clamp(Number.parseFloat(r[3]),0,100);const o=clamp(Number.isNaN(e)?1:e,0,1);return[t,n,i,o]}return null};l.get.hwb=function(e){if(!e){return null}const t=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*[\s,]\s*([+-]?[\d.]+)%\s*[\s,]\s*([+-]?[\d.]+)%\s*(?:[\s,]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/;const r=e.match(t);if(r){const e=Number.parseFloat(r[4]);const t=(Number.parseFloat(r[1])%360+360)%360;const n=clamp(Number.parseFloat(r[2]),0,100);const i=clamp(Number.parseFloat(r[3]),0,100);const o=clamp(Number.isNaN(e)?1:e,0,1);return[t,n,i,o]}return null};l.to.hex=function(...e){return"#"+hexDouble(e[0])+hexDouble(e[1])+hexDouble(e[2])+(e[3]<1?hexDouble(Math.round(e[3]*255)):"")};l.to.rgb=function(...e){return e.length<4||e[3]===1?"rgb("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+")":"rgba("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+", "+e[3]+")"};l.to.rgb.percent=function(...e){const t=Math.round(e[0]/255*100);const r=Math.round(e[1]/255*100);const n=Math.round(e[2]/255*100);return e.length<4||e[3]===1?"rgb("+t+"%, "+r+"%, "+n+"%)":"rgba("+t+"%, "+r+"%, "+n+"%, "+e[3]+")"};l.to.hsl=function(...e){return e.length<4||e[3]===1?"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)":"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+e[3]+")"};l.to.hwb=function(...e){let t="";if(e.length>=4&&e[3]!==1){t=", "+e[3]}return"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+t+")"};l.to.keyword=function(...e){return a[e.slice(0,3)]};function clamp(e,t,r){return Math.min(Math.max(t,e),r)}function hexDouble(e){const t=Math.round(e).toString(16).toUpperCase();return t.length<2?"0"+t:t}var c=l;var h={};for(const e of Object.keys(s)){h[s[e]]=e}var u={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},oklab:{channels:3,labels:["okl","oka","okb"]},lch:{channels:3,labels:"lch"},oklch:{channels:3,labels:["okl","okc","okh"]},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};var p=u;var d=(6/29)**3;function srgbNonlinearTransform(e){const t=e>.0031308?1.055*e**(1/2.4)-.055:e*12.92;return Math.min(Math.max(0,t),1)}function srgbNonlinearTransformInv(e){return e>.04045?((e+.055)/1.055)**2.4:e/12.92}for(const e of Object.keys(u)){if(!("channels"in u[e])){throw new Error("missing channels property: "+e)}if(!("labels"in u[e])){throw new Error("missing channel labels property: "+e)}if(u[e].labels.length!==u[e].channels){throw new Error("channel and label counts mismatch: "+e)}const{channels:t,labels:r}=u[e];delete u[e].channels;delete u[e].labels;Object.defineProperty(u[e],"channels",{value:t});Object.defineProperty(u[e],"labels",{value:r})}u.rgb.hsl=function(e){const t=e[0]/255;const r=e[1]/255;const n=e[2]/255;const i=Math.min(t,r,n);const o=Math.max(t,r,n);const s=o-i;let a;let l;switch(o){case i:{a=0;break}case t:{a=(r-n)/s;break}case r:{a=2+(n-t)/s;break}case n:{a=4+(t-r)/s;break}}a=Math.min(a*60,360);if(a<0){a+=360}const c=(i+o)/2;if(o===i){l=0}else if(c<=.5){l=s/(o+i)}else{l=s/(2-o-i)}return[a,l*100,c*100]};u.rgb.hsv=function(e){let t;let r;let n;let i;let o;const s=e[0]/255;const a=e[1]/255;const l=e[2]/255;const c=Math.max(s,a,l);const h=c-Math.min(s,a,l);const diffc=function(e){return(c-e)/6/h+1/2};if(h===0){i=0;o=0}else{o=h/c;t=diffc(s);r=diffc(a);n=diffc(l);switch(c){case s:{i=n-r;break}case a:{i=1/3+t-n;break}case l:{i=2/3+r-t;break}}if(i<0){i+=1}else if(i>1){i-=1}}return[i*360,o*100,c*100]};u.rgb.hwb=function(e){const t=e[0];const r=e[1];let n=e[2];const i=u.rgb.hsl(e)[0];const o=1/255*Math.min(t,Math.min(r,n));n=1-1/255*Math.max(t,Math.max(r,n));return[i,o*100,n*100]};u.rgb.oklab=function(e){const t=srgbNonlinearTransformInv(e[0]/255);const r=srgbNonlinearTransformInv(e[1]/255);const n=srgbNonlinearTransformInv(e[2]/255);const i=Math.cbrt(.4122214708*t+.5363325363*r+.0514459929*n);const o=Math.cbrt(.2119034982*t+.6806995451*r+.1073969566*n);const s=Math.cbrt(.0883024619*t+.2817188376*r+.6299787005*n);const a=.2104542553*i+.793617785*o-.0040720468*s;const l=1.9779984951*i-2.428592205*o+.4505937099*s;const c=.0259040371*i+.7827717662*o-.808675766*s;return[a*100,l*100,c*100]};u.rgb.cmyk=function(e){const t=e[0]/255;const r=e[1]/255;const n=e[2]/255;const i=Math.min(1-t,1-r,1-n);const o=(1-t-i)/(1-i)||0;const s=(1-r-i)/(1-i)||0;const a=(1-n-i)/(1-i)||0;return[o*100,s*100,a*100,i*100]};function comparativeDistance(e,t){return(e[0]-t[0])**2+(e[1]-t[1])**2+(e[2]-t[2])**2}u.rgb.keyword=function(e){const t=h[e];if(t){return t}let r=Number.POSITIVE_INFINITY;let n;for(const t of Object.keys(s)){const i=s[t];const o=comparativeDistance(e,i);if(o<r){r=o;n=t}}return n};u.keyword.rgb=function(e){return s[e]};u.rgb.xyz=function(e){const t=srgbNonlinearTransformInv(e[0]/255);const r=srgbNonlinearTransformInv(e[1]/255);const n=srgbNonlinearTransformInv(e[2]/255);const i=t*.4124564+r*.3575761+n*.1804375;const o=t*.2126729+r*.7151522+n*.072175;const s=t*.0193339+r*.119192+n*.9503041;return[i*100,o*100,s*100]};u.rgb.lab=function(e){const t=u.rgb.xyz(e);let r=t[0];let n=t[1];let i=t[2];r/=95.047;n/=100;i/=108.883;r=r>d?r**(1/3):7.787*r+16/116;n=n>d?n**(1/3):7.787*n+16/116;i=i>d?i**(1/3):7.787*i+16/116;const o=116*n-16;const s=500*(r-n);const a=200*(n-i);return[o,s,a]};u.hsl.rgb=function(e){const t=e[0]/360;const r=e[1]/100;const n=e[2]/100;let i;let o;if(r===0){o=n*255;return[o,o,o]}const s=n<.5?n*(1+r):n+r-n*r;const a=2*n-s;const l=[0,0,0];for(let e=0;e<3;e++){i=t+1/3*-(e-1);if(i<0){i++}if(i>1){i--}if(6*i<1){o=a+(s-a)*6*i}else if(2*i<1){o=s}else if(3*i<2){o=a+(s-a)*(2/3-i)*6}else{o=a}l[e]=o*255}return l};u.hsl.hsv=function(e){const t=e[0];let r=e[1]/100;let n=e[2]/100;let i=r;const o=Math.max(n,.01);n*=2;r*=n<=1?n:2-n;i*=o<=1?o:2-o;const s=(n+r)/2;const a=n===0?2*i/(o+i):2*r/(n+r);return[t,a*100,s*100]};u.hsv.rgb=function(e){const t=e[0]/60;const r=e[1]/100;let n=e[2]/100;const i=Math.floor(t)%6;const o=t-Math.floor(t);const s=255*n*(1-r);const a=255*n*(1-r*o);const l=255*n*(1-r*(1-o));n*=255;switch(i){case 0:{return[n,l,s]}case 1:{return[a,n,s]}case 2:{return[s,n,l]}case 3:{return[s,a,n]}case 4:{return[l,s,n]}case 5:{return[n,s,a]}}};u.hsv.hsl=function(e){const t=e[0];const r=e[1]/100;const n=e[2]/100;const i=Math.max(n,.01);let o;let s;s=(2-r)*n;const a=(2-r)*i;o=r*i;o/=a<=1?a:2-a;o=o||0;s/=2;return[t,o*100,s*100]};u.hwb.rgb=function(e){const t=e[0]/360;let r=e[1]/100;let n=e[2]/100;const i=r+n;let o;if(i>1){r/=i;n/=i}const s=Math.floor(6*t);const a=1-n;o=6*t-s;if((s&1)!==0){o=1-o}const l=r+o*(a-r);let c;let h;let u;switch(s){default:case 6:case 0:{c=a;h=l;u=r;break}case 1:{c=l;h=a;u=r;break}case 2:{c=r;h=a;u=l;break}case 3:{c=r;h=l;u=a;break}case 4:{c=l;h=r;u=a;break}case 5:{c=a;h=r;u=l;break}}return[c*255,h*255,u*255]};u.cmyk.rgb=function(e){const t=e[0]/100;const r=e[1]/100;const n=e[2]/100;const i=e[3]/100;const o=1-Math.min(1,t*(1-i)+i);const s=1-Math.min(1,r*(1-i)+i);const a=1-Math.min(1,n*(1-i)+i);return[o*255,s*255,a*255]};u.xyz.rgb=function(e){const t=e[0]/100;const r=e[1]/100;const n=e[2]/100;let i;let o;let s;i=t*3.2404542+r*-1.5371385+n*-.4985314;o=t*-.969266+r*1.8760108+n*.041556;s=t*.0556434+r*-.2040259+n*1.0572252;i=srgbNonlinearTransform(i);o=srgbNonlinearTransform(o);s=srgbNonlinearTransform(s);return[i*255,o*255,s*255]};u.xyz.lab=function(e){let t=e[0];let r=e[1];let n=e[2];t/=95.047;r/=100;n/=108.883;t=t>d?t**(1/3):7.787*t+16/116;r=r>d?r**(1/3):7.787*r+16/116;n=n>d?n**(1/3):7.787*n+16/116;const i=116*r-16;const o=500*(t-r);const s=200*(r-n);return[i,o,s]};u.xyz.oklab=function(e){const t=e[0]/100;const r=e[1]/100;const n=e[2]/100;const i=Math.cbrt(.8189330101*t+.3618667424*r-.1288597137*n);const o=Math.cbrt(.0329845436*t+.9293118715*r+.0361456387*n);const s=Math.cbrt(.0482003018*t+.2643662691*r+.633851707*n);const a=.2104542553*i+.793617785*o-.0040720468*s;const l=1.9779984951*i-2.428592205*o+.4505937099*s;const c=.0259040371*i+.7827717662*o-.808675766*s;return[a*100,l*100,c*100]};u.oklab.oklch=function(e){return u.lab.lch(e)};u.oklab.xyz=function(e){const t=e[0]/100;const r=e[1]/100;const n=e[2]/100;const i=(.999999998*t+.396337792*r+.215803758*n)**3;const o=(1.000000008*t-.105561342*r-.063854175*n)**3;const s=(1.000000055*t-.089484182*r-1.291485538*n)**3;const a=1.227013851*i-.55779998*o+.281256149*s;const l=-.040580178*i+1.11225687*o-.071676679*s;const c=-.076381285*i-.421481978*o+1.58616322*s;return[a*100,l*100,c*100]};u.oklab.rgb=function(e){const t=e[0]/100;const r=e[1]/100;const n=e[2]/100;const i=(t+.3963377774*r+.2158037573*n)**3;const o=(t-.1055613458*r-.0638541728*n)**3;const s=(t-.0894841775*r-1.291485548*n)**3;const a=srgbNonlinearTransform(4.0767416621*i-3.3077115913*o+.2309699292*s);const l=srgbNonlinearTransform(-1.2684380046*i+2.6097574011*o-.3413193965*s);const c=srgbNonlinearTransform(-.0041960863*i-.7034186147*o+1.707614701*s);return[a*255,l*255,c*255]};u.oklch.oklab=function(e){return u.lch.lab(e)};u.lab.xyz=function(e){const t=e[0];const r=e[1];const n=e[2];let i;let o;let s;o=(t+16)/116;i=r/500+o;s=o-n/200;const a=o**3;const l=i**3;const c=s**3;o=a>d?a:(o-16/116)/7.787;i=l>d?l:(i-16/116)/7.787;s=c>d?c:(s-16/116)/7.787;i*=95.047;o*=100;s*=108.883;return[i,o,s]};u.lab.lch=function(e){const t=e[0];const r=e[1];const n=e[2];let i;const o=Math.atan2(n,r);i=o*360/2/Math.PI;if(i<0){i+=360}const s=Math.sqrt(r*r+n*n);return[t,s,i]};u.lch.lab=function(e){const t=e[0];const r=e[1];const n=e[2];const i=n/360*2*Math.PI;const o=r*Math.cos(i);const s=r*Math.sin(i);return[t,o,s]};u.rgb.ansi16=function(e,t=null){const[r,n,i]=e;let o=t===null?u.rgb.hsv(e)[2]:t;o=Math.round(o/50);if(o===0){return 30}let s=30+(Math.round(i/255)<<2|Math.round(n/255)<<1|Math.round(r/255));if(o===2){s+=60}return s};u.hsv.ansi16=function(e){return u.rgb.ansi16(u.hsv.rgb(e),e[2])};u.rgb.ansi256=function(e){const t=e[0];const r=e[1];const n=e[2];if(t>>4===r>>4&&r>>4===n>>4){if(t<8){return 16}if(t>248){return 231}return Math.round((t-8)/247*24)+232}const i=16+36*Math.round(t/255*5)+6*Math.round(r/255*5)+Math.round(n/255*5);return i};u.ansi16.rgb=function(e){e=e[0];let t=e%10;if(t===0||t===7){if(e>50){t+=3.5}t=t/10.5*255;return[t,t,t]}const r=(Math.trunc(e>50)+1)*.5;const n=(t&1)*r*255;const i=(t>>1&1)*r*255;const o=(t>>2&1)*r*255;return[n,i,o]};u.ansi256.rgb=function(e){e=e[0];if(e>=232){const t=(e-232)*10+8;return[t,t,t]}e-=16;let t;const r=Math.floor(e/36)/5*255;const n=Math.floor((t=e%36)/6)/5*255;const i=t%6/5*255;return[r,n,i]};u.rgb.hex=function(e){const t=((Math.round(e[0])&255)<<16)+((Math.round(e[1])&255)<<8)+(Math.round(e[2])&255);const r=t.toString(16).toUpperCase();return"000000".slice(r.length)+r};u.hex.rgb=function(e){const t=e.toString(16).match(/[a-f\d]{6}|[a-f\d]{3}/i);if(!t){return[0,0,0]}let r=t[0];if(t[0].length===3){r=[...r].map((e=>e+e)).join("")}const n=Number.parseInt(r,16);const i=n>>16&255;const o=n>>8&255;const s=n&255;return[i,o,s]};u.rgb.hcg=function(e){const t=e[0]/255;const r=e[1]/255;const n=e[2]/255;const i=Math.max(Math.max(t,r),n);const o=Math.min(Math.min(t,r),n);const s=i-o;let a;const l=s<1?o/(1-s):0;if(s<=0){a=0}else if(i===t){a=(r-n)/s%6}else if(i===r){a=2+(n-t)/s}else{a=4+(t-r)/s}a/=6;a%=1;return[a*360,s*100,l*100]};u.hsl.hcg=function(e){const t=e[1]/100;const r=e[2]/100;const n=r<.5?2*t*r:2*t*(1-r);let i=0;if(n<1){i=(r-.5*n)/(1-n)}return[e[0],n*100,i*100]};u.hsv.hcg=function(e){const t=e[1]/100;const r=e[2]/100;const n=t*r;let i=0;if(n<1){i=(r-n)/(1-n)}return[e[0],n*100,i*100]};u.hcg.rgb=function(e){const t=e[0]/360;const r=e[1]/100;const n=e[2]/100;if(r===0){return[n*255,n*255,n*255]}const i=[0,0,0];const o=t%1*6;const s=o%1;const a=1-s;let l=0;switch(Math.floor(o)){case 0:{i[0]=1;i[1]=s;i[2]=0;break}case 1:{i[0]=a;i[1]=1;i[2]=0;break}case 2:{i[0]=0;i[1]=1;i[2]=s;break}case 3:{i[0]=0;i[1]=a;i[2]=1;break}case 4:{i[0]=s;i[1]=0;i[2]=1;break}default:{i[0]=1;i[1]=0;i[2]=a}}l=(1-r)*n;return[(r*i[0]+l)*255,(r*i[1]+l)*255,(r*i[2]+l)*255]};u.hcg.hsv=function(e){const t=e[1]/100;const r=e[2]/100;const n=t+r*(1-t);let i=0;if(n>0){i=t/n}return[e[0],i*100,n*100]};u.hcg.hsl=function(e){const t=e[1]/100;const r=e[2]/100;const n=r*(1-t)+.5*t;let i=0;if(n>0&&n<.5){i=t/(2*n)}else if(n>=.5&&n<1){i=t/(2*(1-n))}return[e[0],i*100,n*100]};u.hcg.hwb=function(e){const t=e[1]/100;const r=e[2]/100;const n=t+r*(1-t);return[e[0],(n-t)*100,(1-n)*100]};u.hwb.hcg=function(e){const t=e[1]/100;const r=e[2]/100;const n=1-r;const i=n-t;let o=0;if(i<1){o=(n-i)/(1-i)}return[e[0],i*100,o*100]};u.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]};u.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]};u.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]};u.gray.hsl=function(e){return[0,0,e[0]]};u.gray.hsv=u.gray.hsl;u.gray.hwb=function(e){return[0,100,e[0]]};u.gray.cmyk=function(e){return[0,0,0,e[0]]};u.gray.lab=function(e){return[e[0],0,0]};u.gray.hex=function(e){const t=Math.round(e[0]/100*255)&255;const r=(t<<16)+(t<<8)+t;const n=r.toString(16).toUpperCase();return"000000".slice(n.length)+n};u.rgb.gray=function(e){const t=(e[0]+e[1]+e[2])/3;return[t/255*100]};function buildGraph(){const e={};const t=Object.keys(p);for(let{length:r}=t,n=0;n<r;n++){e[t[n]]={distance:-1,parent:null}}return e}function deriveBFS(e){const t=buildGraph();const r=[e];t[e].distance=0;while(r.length>0){const e=r.pop();const n=Object.keys(p[e]);for(let{length:i}=n,o=0;o<i;o++){const i=n[o];const s=t[i];if(s.distance===-1){s.distance=t[e].distance+1;s.parent=e;r.unshift(i)}}}return t}function link(e,t){return function(r){return t(e(r))}}function wrapConversion(e,t){const r=[t[e].parent,e];let n=p[t[e].parent][e];let i=t[e].parent;while(t[i].parent){r.unshift(t[i].parent);n=link(p[t[i].parent][i],n);i=t[i].parent}n.conversion=r;return n}function route(e){const t=deriveBFS(e);const r={};const n=Object.keys(t);for(let{length:e}=n,i=0;i<e;i++){const e=n[i];const o=t[e];if(o.parent===null){continue}r[e]=wrapConversion(e,t)}return r}var m=route;var g={};var b=Object.keys(p);function wrapRaw(e){const wrappedFn=function(...t){const r=t[0];if(r===void 0||r===null){return r}if(r.length>1){t=r}return e(t)};if("conversion"in e){wrappedFn.conversion=e.conversion}return wrappedFn}function wrapRounded(e){const wrappedFn=function(...t){const r=t[0];if(r===void 0||r===null){return r}if(r.length>1){t=r}const n=e(t);if(typeof n==="object"){for(let{length:e}=n,t=0;t<e;t++){n[t]=Math.round(n[t])}}return n};if("conversion"in e){wrappedFn.conversion=e.conversion}return wrappedFn}for(const e of b){g[e]={};Object.defineProperty(g[e],"channels",{value:p[e].channels});Object.defineProperty(g[e],"labels",{value:p[e].labels});const t=m(e);const r=Object.keys(t);for(const n of r){const r=t[n];g[e][n]=wrapRounded(r);g[e][n].raw=wrapRaw(r)}}var w=g;var E=["keyword","gray","hex"];var v={};for(const e of Object.keys(w)){v[[...w[e].labels].sort().join("")]=e}var y={};function Color(e,t){if(!(this instanceof Color)){return new Color(e,t)}if(t&&t in E){t=null}if(t&&!(t in w)){throw new Error("Unknown model: "+t)}let r;let n;if(e==null){this.model="rgb";this.color=[0,0,0];this.valpha=1}else if(e instanceof Color){this.model=e.model;this.color=[...e.color];this.valpha=e.valpha}else if(typeof e==="string"){const t=c.get(e);if(t===null){throw new Error("Unable to parse color from string: "+e)}this.model=t.model;n=w[this.model].channels;this.color=t.value.slice(0,n);this.valpha=typeof t.value[n]==="number"?t.value[n]:1}else if(e.length>0){this.model=t||"rgb";n=w[this.model].channels;const r=Array.prototype.slice.call(e,0,n);this.color=zeroArray(r,n);this.valpha=typeof e[n]==="number"?e[n]:1}else if(typeof e==="number"){this.model="rgb";this.color=[e>>16&255,e>>8&255,e&255];this.valpha=1}else{this.valpha=1;const t=Object.keys(e);if("alpha"in e){t.splice(t.indexOf("alpha"),1);this.valpha=typeof e.alpha==="number"?e.alpha:0}const n=t.sort().join("");if(!(n in v)){throw new Error("Unable to parse color from object: "+JSON.stringify(e))}this.model=v[n];const{labels:i}=w[this.model];const o=[];for(r=0;r<i.length;r++){o.push(e[i[r]])}this.color=zeroArray(o)}if(y[this.model]){n=w[this.model].channels;for(r=0;r<n;r++){const e=y[this.model][r];if(e){this.color[r]=e(this.color[r])}}}this.valpha=Math.max(0,Math.min(1,this.valpha));if(Object.freeze){Object.freeze(this)}}Color.prototype={toString(){return this.string()},toJSON(){return this[this.model]()},string(e){let t=this.model in c.to?this:this.rgb();t=t.round(typeof e==="number"?e:1);const r=t.valpha===1?t.color:[...t.color,this.valpha];return c.to[t.model](...r)},percentString(e){const t=this.rgb().round(typeof e==="number"?e:1);const r=t.valpha===1?t.color:[...t.color,this.valpha];return c.to.rgb.percent(...r)},array(){return this.valpha===1?[...this.color]:[...this.color,this.valpha]},object(){const e={};const{channels:t}=w[this.model];const{labels:r}=w[this.model];for(let n=0;n<t;n++){e[r[n]]=this.color[n]}if(this.valpha!==1){e.alpha=this.valpha}return e},unitArray(){const e=this.rgb().color;e[0]/=255;e[1]/=255;e[2]/=255;if(this.valpha!==1){e.push(this.valpha)}return e},unitObject(){const e=this.rgb().object();e.r/=255;e.g/=255;e.b/=255;if(this.valpha!==1){e.alpha=this.valpha}return e},round(e){e=Math.max(e||0,0);return new Color([...this.color.map(roundToPlace(e)),this.valpha],this.model)},alpha(e){if(e!==void 0){return new Color([...this.color,Math.max(0,Math.min(1,e))],this.model)}return this.valpha},red:getset("rgb",0,maxfn(255)),green:getset("rgb",1,maxfn(255)),blue:getset("rgb",2,maxfn(255)),hue:getset(["hsl","hsv","hsl","hwb","hcg"],0,(e=>(e%360+360)%360)),saturationl:getset("hsl",1,maxfn(100)),lightness:getset("hsl",2,maxfn(100)),saturationv:getset("hsv",1,maxfn(100)),value:getset("hsv",2,maxfn(100)),chroma:getset("hcg",1,maxfn(100)),gray:getset("hcg",2,maxfn(100)),white:getset("hwb",1,maxfn(100)),wblack:getset("hwb",2,maxfn(100)),cyan:getset("cmyk",0,maxfn(100)),magenta:getset("cmyk",1,maxfn(100)),yellow:getset("cmyk",2,maxfn(100)),black:getset("cmyk",3,maxfn(100)),x:getset("xyz",0,maxfn(95.047)),y:getset("xyz",1,maxfn(100)),z:getset("xyz",2,maxfn(108.833)),l:getset("lab",0,maxfn(100)),a:getset("lab",1),b:getset("lab",2),keyword(e){if(e!==void 0){return new Color(e)}return w[this.model].keyword(this.color)},hex(e){if(e!==void 0){return new Color(e)}return c.to.hex(...this.rgb().round().color)},hexa(e){if(e!==void 0){return new Color(e)}const t=this.rgb().round().color;let r=Math.round(this.valpha*255).toString(16).toUpperCase();if(r.length===1){r="0"+r}return c.to.hex(...t)+r},rgbNumber(){const e=this.rgb().color;return(e[0]&255)<<16|(e[1]&255)<<8|e[2]&255},luminosity(){const e=this.rgb().color;const t=[];for(const[r,n]of e.entries()){const e=n/255;t[r]=e<=.04045?e/12.92:((e+.055)/1.055)**2.4}return.2126*t[0]+.7152*t[1]+.0722*t[2]},contrast(e){const t=this.luminosity();const r=e.luminosity();if(t>r){return(t+.05)/(r+.05)}return(r+.05)/(t+.05)},level(e){const t=this.contrast(e);if(t>=7){return"AAA"}return t>=4.5?"AA":""},isDark(){const e=this.rgb().color;const t=(e[0]*2126+e[1]*7152+e[2]*722)/1e4;return t<128},isLight(){return!this.isDark()},negate(){const e=this.rgb();for(let t=0;t<3;t++){e.color[t]=255-e.color[t]}return e},lighten(e){const t=this.hsl();t.color[2]+=t.color[2]*e;return t},darken(e){const t=this.hsl();t.color[2]-=t.color[2]*e;return t},saturate(e){const t=this.hsl();t.color[1]+=t.color[1]*e;return t},desaturate(e){const t=this.hsl();t.color[1]-=t.color[1]*e;return t},whiten(e){const t=this.hwb();t.color[1]+=t.color[1]*e;return t},blacken(e){const t=this.hwb();t.color[2]+=t.color[2]*e;return t},grayscale(){const e=this.rgb().color;const t=e[0]*.3+e[1]*.59+e[2]*.11;return Color.rgb(t,t,t)},fade(e){return this.alpha(this.valpha-this.valpha*e)},opaquer(e){return this.alpha(this.valpha+this.valpha*e)},rotate(e){const t=this.hsl();let r=t.color[0];r=(r+e)%360;r=r<0?360+r:r;t.color[0]=r;return t},mix(e,t){if(!e||!e.rgb){throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof e)}const r=e.rgb();const n=this.rgb();const i=t===void 0?.5:t;const o=2*i-1;const s=r.alpha()-n.alpha();const a=((o*s===-1?o:(o+s)/(1+o*s))+1)/2;const l=1-a;return Color.rgb(a*r.red()+l*n.red(),a*r.green()+l*n.green(),a*r.blue()+l*n.blue(),r.alpha()*i+n.alpha()*(1-i))}};for(const e of Object.keys(w)){if(E.includes(e)){continue}const{channels:t}=w[e];Color.prototype[e]=function(...t){if(this.model===e){return new Color(this)}if(t.length>0){return new Color(t,e)}return new Color([...assertArray(w[this.model][e].raw(this.color)),this.valpha],e)};Color[e]=function(...r){let n=r[0];if(typeof n==="number"){n=zeroArray(r,t)}return new Color(n,e)}}function roundTo(e,t){return Number(e.toFixed(t))}function roundToPlace(e){return function(t){return roundTo(t,e)}}function getset(e,t,r){e=Array.isArray(e)?e:[e];for(const n of e){(y[n]||=[])[t]=r}e=e[0];return function(n){let i;if(n!==void 0){if(r){n=r(n)}i=this[e]();i.color[t]=n;return i}i=this[e]().color[t];if(r){i=r(i)}return i}}function maxfn(e){return function(t){return Math.max(0,Math.min(e,t))}}function assertArray(e){return Array.isArray(e)?e:[e]}function zeroArray(e,t){for(let r=0;r<t;r++){if(typeof e[r]!=="number"){e[r]=0}}return e}var x=Color},171:(e,t,r)=>{e.exports=r(5446)["default"]},7816:e=>{e.exports=JSON.parse('{"name":"sharp","description":"High performance Node.js image processing, the fastest module to resize JPEG, PNG, WebP, GIF, AVIF and TIFF images","version":"0.34.5","author":"Lovell Fuller <npm@lovell.info>","homepage":"https://sharp.pixelplumbing.com","contributors":["Pierre Inglebert <pierre.inglebert@gmail.com>","Jonathan Ong <jonathanrichardong@gmail.com>","Chanon Sajjamanochai <chanon.s@gmail.com>","Juliano Julio <julianojulio@gmail.com>","Daniel Gasienica <daniel@gasienica.ch>","Julian Walker <julian@fiftythree.com>","Amit Pitaru <pitaru.amit@gmail.com>","Brandon Aaron <hello.brandon@aaron.sh>","Andreas Lind <andreas@one.com>","Maurus Cuelenaere <mcuelenaere@gmail.com>","Linus Unnebck <linus@folkdatorn.se>","Victor Mateevitsi <mvictoras@gmail.com>","Alaric Holloway <alaric.holloway@gmail.com>","Bernhard K. Weisshuhn <bkw@codingforce.com>","Chris Riley <criley@primedia.com>","David Carley <dacarley@gmail.com>","John Tobin <john@limelightmobileinc.com>","Kenton Gray <kentongray@gmail.com>","Felix Bnemann <Felix.Buenemann@gmail.com>","Samy Al Zahrani <samyalzahrany@gmail.com>","Chintan Thakkar <lemnisk8@gmail.com>","F. Orlando Galashan <frulo@gmx.de>","Kleis Auke Wolthuizen <info@kleisauke.nl>","Matt Hirsch <mhirsch@media.mit.edu>","Matthias Thoemmes <thoemmes@gmail.com>","Patrick Paskaris <patrick@paskaris.gr>","Jrmy Lal <kapouer@melix.org>","Rahul Nanwani <r.nanwani@gmail.com>","Alice Monday <alice0meta@gmail.com>","Kristo Jorgenson <kristo.jorgenson@gmail.com>","YvesBos <yves_bos@outlook.com>","Guy Maliar <guy@tailorbrands.com>","Nicolas Coden <nicolas@ncoden.fr>","Matt Parrish <matt.r.parrish@gmail.com>","Marcel Bretschneider <marcel.bretschneider@gmail.com>","Matthew McEachen <matthew+github@mceachen.org>","Jarda Kotovec <jarda.kotesovec@gmail.com>","Kenric D\'Souza <kenric.dsouza@gmail.com>","Oleh Aleinyk <oleg.aleynik@gmail.com>","Marcel Bretschneider <marcel.bretschneider@gmail.com>","Andrea Bianco <andrea.bianco@unibas.ch>","Rik Heywood <rik@rik.org>","Thomas Parisot <hi@oncletom.io>","Nathan Graves <nathanrgraves+github@gmail.com>","Tom Lokhorst <tom@lokhorst.eu>","Espen Hovlandsdal <espen@hovlandsdal.com>","Sylvain Dumont <sylvain.dumont35@gmail.com>","Alun Davies <alun.owain.davies@googlemail.com>","Aidan Hoolachan <ajhoolachan21@gmail.com>","Axel Eirola <axel.eirola@iki.fi>","Freezy <freezy@xbmc.org>","Daiz <taneli.vatanen@gmail.com>","Julian Aubourg <j@ubourg.net>","Keith Belovay <keith@picthrive.com>","Michael B. Klein <mbklein@gmail.com>","Jordan Prudhomme <jordan@raboland.fr>","Ilya Ovdin <iovdin@gmail.com>","Andargor <andargor@yahoo.com>","Paul Neave <paul.neave@gmail.com>","Brendan Kennedy <brenwken@gmail.com>","Brychan Bennett-Odlum <git@brychan.io>","Edward Silverton <e.silverton@gmail.com>","Roman Malieiev <aromaleev@gmail.com>","Tomas Szabo <tomas.szabo@deftomat.com>","Robert O\'Rourke <robert@o-rourke.org>","Guillermo Alfonso Varela Choucio <guillevch@gmail.com>","Christian Flintrup <chr@gigahost.dk>","Manan Jadhav <manan@motionden.com>","Leon Radley <leon@radley.se>","alza54 <alza54@thiocod.in>","Jacob Smith <jacob@frende.me>","Michael Nutt <michael@nutt.im>","Brad Parham <baparham@gmail.com>","Taneli Vatanen <taneli.vatanen@gmail.com>","Joris Dugu <zaruike10@gmail.com>","Chris Banks <christopher.bradley.banks@gmail.com>","Ompal Singh <ompal.hitm09@gmail.com>","Brodan <christopher.hranj@gmail.com>","Ankur Parihar <ankur.github@gmail.com>","Brahim Ait elhaj <brahima@gmail.com>","Mart Jansink <m.jansink@gmail.com>","Lachlan Newman <lachnewman007@gmail.com>","Dennis Beatty <dennis@dcbeatty.com>","Ingvar Stepanyan <me@rreverser.com>","Don Denton <don@happycollision.com>"],"scripts":{"build":"node install/build.js","install":"node install/check.js || npm run build","clean":"rm -rf src/build/ .nyc_output/ coverage/ test/fixtures/output.*","test":"npm run lint && npm run test-unit","lint":"npm run lint-cpp && npm run lint-js && npm run lint-types","lint-cpp":"cpplint --quiet src/*.h src/*.cc","lint-js":"biome lint","lint-types":"tsd --files ./test/types/sharp.test-d.ts","test-leak":"./test/leak/leak.sh","test-unit":"node --experimental-test-coverage test/unit.mjs","package-from-local-build":"node npm/from-local-build.js","package-release-notes":"node npm/release-notes.js","docs-build":"node docs/build.mjs","docs-serve":"cd docs && npm start","docs-publish":"cd docs && npm run build && npx firebase-tools deploy --project pixelplumbing --only hosting:pixelplumbing-sharp"},"type":"commonjs","main":"lib/index.js","types":"lib/index.d.ts","files":["install","lib","src/*.{cc,h,gyp}"],"repository":{"type":"git","url":"git://github.com/lovell/sharp.git"},"keywords":["jpeg","png","webp","avif","tiff","gif","svg","jp2","dzi","image","resize","thumbnail","crop","embed","libvips","vips"],"dependencies":{"@img/colour":"^1.0.0","detect-libc":"^2.1.2","semver":"^7.7.3"},"optionalDependencies":{"@img/sharp-darwin-arm64":"0.34.5","@img/sharp-darwin-x64":"0.34.5","@img/sharp-libvips-darwin-arm64":"1.2.4","@img/sharp-libvips-darwin-x64":"1.2.4","@img/sharp-libvips-linux-arm":"1.2.4","@img/sharp-libvips-linux-arm64":"1.2.4","@img/sharp-libvips-linux-ppc64":"1.2.4","@img/sharp-libvips-linux-riscv64":"1.2.4","@img/sharp-libvips-linux-s390x":"1.2.4","@img/sharp-libvips-linux-x64":"1.2.4","@img/sharp-libvips-linuxmusl-arm64":"1.2.4","@img/sharp-libvips-linuxmusl-x64":"1.2.4","@img/sharp-linux-arm":"0.34.5","@img/sharp-linux-arm64":"0.34.5","@img/sharp-linux-ppc64":"0.34.5","@img/sharp-linux-riscv64":"0.34.5","@img/sharp-linux-s390x":"0.34.5","@img/sharp-linux-x64":"0.34.5","@img/sharp-linuxmusl-arm64":"0.34.5","@img/sharp-linuxmusl-x64":"0.34.5","@img/sharp-wasm32":"0.34.5","@img/sharp-win32-arm64":"0.34.5","@img/sharp-win32-ia32":"0.34.5","@img/sharp-win32-x64":"0.34.5"},"devDependencies":{"@biomejs/biome":"^2.3.4","@cpplint/cli":"^0.1.0","@emnapi/runtime":"^1.7.0","@img/sharp-libvips-dev":"1.2.4","@img/sharp-libvips-dev-wasm32":"1.2.4","@img/sharp-libvips-win32-arm64":"1.2.4","@img/sharp-libvips-win32-ia32":"1.2.4","@img/sharp-libvips-win32-x64":"1.2.4","@types/node":"*","emnapi":"^1.7.0","exif-reader":"^2.0.2","extract-zip":"^2.0.1","icc":"^3.0.0","jsdoc-to-markdown":"^9.1.3","node-addon-api":"^8.5.0","node-gyp":"^11.5.0","tar-fs":"^3.1.1","tsd":"^0.33.0"},"license":"Apache-2.0","engines":{"node":"^18.17.0 || ^20.3.0 || >=21.0.0"},"config":{"libvips":">=8.17.3"},"funding":{"url":"https://opencollective.com/libvips"}}')}};var __webpack_module_cache__={};function __nccwpck_require2_(e){var t=__webpack_module_cache__[e];if(t!==undefined){return t.exports}var r=__webpack_module_cache__[e]={id:e,loaded:false,exports:{}};var n=true;try{__webpack_modules__[e](r,r.exports,__nccwpck_require2_);n=false}finally{if(n)delete __webpack_module_cache__[e]}r.loaded=true;return r.exports}(()=>{__nccwpck_require2_.n=e=>{var t=e&&e.__esModule?()=>e["default"]:()=>e;__nccwpck_require2_.d(t,{a:t});return t}})();(()=>{__nccwpck_require2_.d=(e,t)=>{for(var r in t){if(__nccwpck_require2_.o(t,r)&&!__nccwpck_require2_.o(e,r)){Object.defineProperty(e,r,{enumerable:true,get:t[r]})}}}})();(()=>{__nccwpck_require2_.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})();(()=>{__nccwpck_require2_.nmd=e=>{e.paths=[];if(!e.children)e.children=[];return e}})();if(typeof __nccwpck_require2_!=="undefined")__nccwpck_require2_.ab=new URL(__nccwpck_require__(896),__nccwpck_require__.b).pathname.slice(import.meta.url.match(/^file:\/\/\/\w:/)?1:0,-1)+"/";var __nested_webpack_exports__={};__nccwpck_require2_.d(__nested_webpack_exports__,{$:()=>config,A:()=>handler});var lib=__nccwpck_require2_(3491);var lib_default=__nccwpck_require2_.n(lib);var kMeans=__nccwpck_require2_(7586);var kMeans_default=__nccwpck_require2_.n(kMeans);const D65_REFERENCE={Xn:.95047,Yn:1,Zn:1.08883};const RGB_TO_XYZ_MATRIX=[[.4124564,.3575761,.1804375],[.2126729,.7151522,.072175],[.0193339,.119192,.9503041]];const XYZ_TO_RGB_MATRIX=null&&0;function gammaExpand(e){return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function gammaCompress(e){return e<=.0031308?e*12.92:1.055*Math.pow(e,1/2.4)-.055}function sRGBToLinearRGB(e){return{R:gammaExpand(e.R/255),G:gammaExpand(e.G/255),B:gammaExpand(e.B/255)}}function linearRGBToSRGB(e){return{R:Math.round(gammaCompress(e.R)*255),G:Math.round(gammaCompress(e.G)*255),B:Math.round(gammaCompress(e.B)*255)}}function linearRGBToXYZ(e){const[t,r,n]=RGB_TO_XYZ_MATRIX;return{X:t[0]*e.R+t[1]*e.G+t[2]*e.B,Y:r[0]*e.R+r[1]*e.G+r[2]*e.B,Z:n[0]*e.R+n[1]*e.G+n[2]*e.B}}function xyzToLinearRGB(e){const[t,r,n]=XYZ_TO_RGB_MATRIX;return{R:t[0]*e.X+t[1]*e.Y+t[2]*e.Z,G:r[0]*e.X+r[1]*e.Y+r[2]*e.Z,B:n[0]*e.X+n[1]*e.Y+n[2]*e.Z}}function f(e){const t=6/29;return e>Math.pow(t,3)?Math.pow(e,1/3):e/(3*t*t)+4/29}function fInv(e){const t=6/29;return e>t?Math.pow(e,3):3*t*t*(e-4/29)}function xyzToLab(e){const t=f(e.X/D65_REFERENCE.Xn);const r=f(e.Y/D65_REFERENCE.Yn);const n=f(e.Z/D65_REFERENCE.Zn);return{L:116*r-16,a:500*(t-r),b:200*(r-n)}}function labToXYZ(e){const t=(e.L+16)/116;const r=e.a/500+t;const n=t-e.b/200;return{X:D65_REFERENCE.Xn*fInv(r),Y:D65_REFERENCE.Yn*fInv(t),Z:D65_REFERENCE.Zn*fInv(n)}}function sRGBToLab(e){const t=sRGBToLinearRGB(e);const r=linearRGBToXYZ(t);return xyzToLab(r)}function labToSRGB(e){const t=labToXYZ(e);const r=xyzToLinearRGB(t);return linearRGBToSRGB(r)}function hexToRGB(e){const t=e.replace("#","");const r=parseInt(t,16);return{R:r>>16&255,G:r>>8&255,B:r&255}}function rgbToHex(e){const t=Math.round(Math.max(0,Math.min(255,e.R)));const r=Math.round(Math.max(0,Math.min(255,e.G)));const n=Math.round(Math.max(0,Math.min(255,e.B)));return`#${((1<<24)+(t<<16)+(r<<8)+n).toString(16).slice(1).toUpperCase()}`}function clampRGB(e){return{R:Math.max(0,Math.min(255,Math.round(e.R))),G:Math.max(0,Math.min(255,Math.round(e.G))),B:Math.max(0,Math.min(255,Math.round(e.B)))}}class RasterExtractor{constructor(e={}){this.options={maxColours:e.maxColours??20,minPercentage:e.minPercentage??.5,resampleSize:e.resampleSize??400,iterations:e.iterations??20}}async extract(e,t){const r=Date.now();try{const n=lib_default()(Buffer.from(e));const i=await n.metadata();if(!i.width||!i.height){throw new Error("Invalid image dimensions")}const o=Math.max(i.width,i.height);const s=o>this.options.resampleSize?this.options.resampleSize/o:1;const a=Math.round(i.width*s);const l=Math.round(i.height*s);const{data:c,info:h}=await n.resize(a,l,{kernel:lib_default().kernel.lanczos3,fit:"fill"}).removeAlpha().raw().toBuffer({resolveWithObject:true});const u=[];for(let e=0;e<c.length;e+=3){u.push({R:c[e],G:c[e+1],B:c[e+2]})}const p=this.performKMeans(u,this.options.maxColours);const d=u.length;const m=p.map(((e,t)=>{const r=e.centroid;const n={R:Math.round(Math.max(0,Math.min(255,r[0]))),G:Math.round(Math.max(0,Math.min(255,r[1]))),B:Math.round(Math.max(0,Math.min(255,r[2])))};const i=e.cluster.length;const o=i/d*100;return{rgb:n,pixels:i,percentage:o}})).filter((e=>e.percentage>=this.options.minPercentage)).sort(((e,t)=>t.percentage-e.percentage));const g=Date.now()-r;console.info(`Final palette: ${m.length} colors, top 5 areas: ${m.slice(0,5).map((e=>e.percentage.toFixed(1)+"%")).join(", ")}`);console.info(`Extraction completed in ${g}ms`);return{colours:m,metadata:{width:i.width,height:i.height,totalPixels:i.width*i.height,format:t}}}catch(e){throw new Error(`Raster extraction failed: ${e.message}`)}}async extractFromCanvas(e){try{const t=e.getContext("2d");if(!t){throw new Error("Could not get canvas context")}const r=t.getImageData(0,0,e.width,e.height);const n=[];for(let e=0;e<r.data.length;e+=4){n.push({R:r.data[e],G:r.data[e+1],B:r.data[e+2]})}const i=this.performKMeans(n,this.options.maxColours);const o=n.length;const s=i.map((e=>{const t=e.centroid;const r={R:Math.round(Math.max(0,Math.min(255,t[0]))),G:Math.round(Math.max(0,Math.min(255,t[1]))),B:Math.round(Math.max(0,Math.min(255,t[2])))};const n=e.cluster.length;const i=n/o*100;return{rgb:r,pixels:n,percentage:i}})).filter((e=>e.percentage>=this.options.minPercentage)).sort(((e,t)=>t.percentage-e.percentage));return{colours:s,metadata:{width:e.width,height:e.height,totalPixels:o,format:"canvas"}}}catch(e){throw new Error(`Canvas extraction failed: ${e.message}`)}}performKMeans(e,t){console.info(`K-means input: ${e.length} pixels, requesting ${t} clusters`);const r=[];let n=0;for(const t of e){try{const e=sRGBToLinearRGB(t);const i=linearRGBToXYZ(e);const o=xyzToLab(i);if(isNaN(o.L)||isNaN(o.a)||isNaN(o.b)){n++;continue}r.push(o)}catch(e){n++;continue}}if(n>0){console.info(`NaN dropped: ${n}`)}if(r.length===0){console.warn("No valid Lab pixels, using RGB fallback");return this.simpleDominantColors(e,t)}const i=Math.min(r.length,5e3);const o=r.length>i?this.sampleArray(r,i):r;console.info(`Using ${o.length} sampled pixels`);const s=this.calculateOptimalK(o,t);console.info(`Adjusted k from ${t} to ${s}`);if(s<=1){const t=this.calculateAverageColor(e);console.info("Single color case, using average:",t);return[{centroid:[t.R,t.G,t.B],cluster:e.map((e=>[e.R,e.G,e.B]))}]}const a=3;for(let t=0;t<a;t++){try{console.info(`K-means attempt ${t+1}/${a} with k=${s}`);const n=o.map((e=>[e.L,e.a,e.b]));const i=kMeans_default()(n,s,{maxIterations:this.options.iterations,tolerance:1,seed:Date.now()+t*1e3});if(!i||i.length===0){throw new Error(`K-means returned empty result on attempt ${t+1}`)}console.info(`K-means attempt ${t+1}: success with ${i.length} clusters`);return this.convertLabClustersToRGB(i,e,r)}catch(r){console.warn(`K-means attempt ${t+1} failed:`,r.message);if(t===a-1){console.warn("All k-means attempts failed, using fallback method");return this.simpleDominantColors(e,s)}}}return this.simpleDominantColors(e,s)}calculateOptimalK(e,t){const r=new Set;for(const t of e){const e=Math.round(t.L/4)*4;const n=Math.round(t.a/2)*2;const i=Math.round(t.b/2)*2;r.add(`${e},${n},${i}`)}const n=r.size;if(n<64){return Math.min(n,10,t)}else{const e=Math.round(Math.sqrt(n/2));return Math.max(6,Math.min(e,18,t))}}convertLabClustersToRGB(e,t,r){const n=[];for(const i of e){const[o,s,a]=i.centroid;try{const e={X:95.047*Math.pow((o+16)/116+s/500,3)/100,Y:100*Math.pow((o+16)/116,3)/100,Z:108.883*Math.pow((o+16)/116-a/200,3)/100};const i=e.X*3.2406+e.Y*-1.5372+e.Z*-.4986;const l=e.X*-.9689+e.Y*1.8758+e.Z*.0415;const c=e.X*.0557+e.Y*-.204+e.Z*1.057;const toSRGB=e=>{e=Math.max(0,Math.min(1,e));return e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055};const h={R:Math.round(toSRGB(i)*255),G:Math.round(toSRGB(l)*255),B:Math.round(toSRGB(c)*255)};const u=[];for(let e=0;e<r.length;e++){const n=r[e];const i=Math.sqrt(Math.pow(n.L-o,2)+Math.pow(n.a-s,2)+Math.pow(n.b-a,2));let l=Infinity;let c=0;for(let e=0;e<t.length;e++){const r=Math.sqrt(Math.pow(t[e].R-h.R,2)+Math.pow(t[e].G-h.G,2)+Math.pow(t[e].B-h.B,2));if(r<l){l=r;c=e}}u.push([t[c].R,t[c].G,t[c].B])}n.push({centroid:[h.R,h.G,h.B],cluster:u.length>0?u:[[h.R,h.G,h.B]]})}catch(e){console.warn("Failed to convert Lab cluster to RGB:",e);const r=this.calculateAverageColor(t);n.push({centroid:[r.R,r.G,r.B],cluster:t.map((e=>[e.R,e.G,e.B]))})}}return n}sampleArray(e,t){if(e.length<=t)return e;const r=e.length/t;const n=[];for(let t=0;t<e.length;t+=r){n.push(e[Math.floor(t)])}return n.slice(0,t)}findClosestCluster(e,t){let r=Infinity;let n=t[0];for(const i of t){const t=Math.sqrt(Math.pow(e[0][0]-i[0],2)+Math.pow(e[0][1]-i[1],2)+Math.pow(e[0][2]-i[2],2));if(t<r){r=t;n=i}}return n}simpleDominantColors(e,t){console.info("Using simple color quantization fallback");const r=new Map;const n=e.length;for(const t of e){const n={R:Math.floor(t.R/6)*6,G:Math.floor(t.G/6)*6,B:Math.floor(t.B/6)*6};const i=`${n.R},${n.G},${n.B}`;const o=r.get(i);if(o){o.count++}else{let t;try{const e=sRGBToLinearRGB(n);const r=linearRGBToXYZ(e);t=xyzToLab(r)}catch(e){}r.set(i,{count:1,rgb:n,lab:t})}}let i=Array.from(r.entries()).filter((([e,t])=>t.lab!==undefined)).map((([e,t])=>({key:e,rgb:t.rgb,lab:t.lab,count:t.count,percentage:t.count/n*100})));console.info(`Pre-merge: ${i.length} quantized colors`);i=this.mergeNearbyColors(i).filter((e=>e.lab!==undefined));const o=i.sort(((e,t)=>t.count-e.count)).slice(0,t);console.info(`Post-merge: ${o.length} final colors`);return o.map((t=>({centroid:[t.rgb.R,t.rgb.G,t.rgb.B],cluster:e.filter((e=>{const r={R:Math.floor(e.R/6)*6,G:Math.floor(e.G/6)*6,B:Math.floor(e.B/6)*6};return`${r.R},${r.G},${r.B}`===t.key})).map((e=>[e.R,e.G,e.B]))})))}mergeNearbyColors(e){const t=1.5;const r=.75;const n=8;e.sort(((e,t)=>t.percentage-e.percentage));const i=[];for(const o of e){let e=false;if(o.percentage>=r){i.push(o);continue}for(const r of i){if(!o.lab||!r.lab){continue}const i=Math.sqrt(Math.pow(o.lab.L-r.lab.L,2)+Math.pow(o.lab.a-r.lab.a,2)+Math.pow(o.lab.b-r.lab.b,2));const s=Math.abs(o.lab.a-r.lab.a);const a=Math.abs(o.lab.b-r.lab.b);if(i<=t&&s<=n&&a<=n){const t=r.percentage+o.percentage;const n=r.count+o.count;r.rgb={R:Math.round((r.rgb.R*r.count+o.rgb.R*o.count)/n),G:Math.round((r.rgb.G*r.count+o.rgb.G*o.count)/n),B:Math.round((r.rgb.B*r.count+o.rgb.B*o.count)/n)};r.lab={L:(r.lab.L*r.percentage+o.lab.L*o.percentage)/t,a:(r.lab.a*r.percentage+o.lab.a*o.percentage)/t,b:(r.lab.b*r.percentage+o.lab.b*o.percentage)/t};r.count=n;r.percentage=t;e=true;break}}if(!e){i.push(o)}}return i}calculateAverageColor(e){if(e.length===0){return{R:0,G:0,B:0}}const t=e.reduce(((e,t)=>({R:e.R+t.R,G:e.G+t.G,B:e.B+t.B})),{R:0,G:0,B:0});return{R:Math.round(t.R/e.length),G:Math.round(t.G/e.length),B:Math.round(t.B/e.length)}}}class ColourSpaceConverter{constructor(e={}){this.options={whitePoint:e.whitePoint??"D65",gamma:e.gamma??2.4}}rgbToLab(e){return sRGBToLab(e)}rgbToHex(e){const toHex=e=>Math.round(Math.max(0,Math.min(255,e))).toString(16).padStart(2,"0");return`#${toHex(e.R)}${toHex(e.G)}${toHex(e.B)}`}hexToRgb(e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);if(!t){throw new Error(`Invalid hex color: ${e}`)}return{R:parseInt(t[1],16),G:parseInt(t[2],16),B:parseInt(t[3],16)}}calculateDeltaE(e,t){const r=e.L-t.L;const n=e.a-t.a;const i=e.b-t.b;return Math.sqrt(r*r+n*n+i*i)}deduplicate(e,t=5){const r=[];for(const n of e){const e=r.some((e=>this.calculateDeltaE(e.lab,n.lab)<t));if(!e){r.push(n)}else{const e=r.find((e=>this.calculateDeltaE(e.lab,n.lab)<t));if(e){e.areaPct+=n.areaPct;if(e.pageIds&&n.pageIds){e.pageIds=[...new Set([...e.pageIds,...n.pageIds])]}}}}return r}normalizeAreas(e){const t=e.reduce(((e,t)=>e+t.areaPct),0);if(t===0){return e}return e.map((e=>({...e,areaPct:e.areaPct/t*100})))}filterInsignificant(e,t=1,r=true,n=true){return e.filter((e=>{if(e.areaPct<t){return false}if(r&&e.lab.L>95){return false}if(n&&e.lab.L<5){return false}return true}))}sortByImportance(e){return e.sort(((e,t)=>{if(Math.abs(e.areaPct-t.areaPct)>1){return t.areaPct-e.areaPct}const r=Math.sqrt(e.lab.a*e.lab.a+e.lab.b*e.lab.b);const n=Math.sqrt(t.lab.a*t.lab.a+t.lab.b*t.lab.b);return n-r}))}}function generateColourId(e,t){const r=(new ColourSpaceConverter).rgbToHex(e);const n=Array.from(r).reduce(((e,t)=>{e=(e<<5)-e+t.charCodeAt(0);return e&e}),0);return`${t}_${Math.abs(n).toString(36)}`}function combineColourSources(e,t,r="merge"){const n=new ColourSpaceConverter;switch(r){case"prefer-pdf":return e.length>0?e:t;case"prefer-raster":return t.length>0?t:e;case"merge":default:const r=[...e,...t];const i=n.deduplicate(r,8);const o=n.normalizeAreas(i);const s=n.sortByImportance(o);return s}}function validateFileType(e){const t=e.toLowerCase().split(".").pop();if(!t){return{isValid:false,type:null}}const r=["png","jpg","jpeg","svg","webp"];const n=["pdf"];if(n.includes(t)){return{isValid:true,type:"pdf",format:t}}if(r.includes(t)){return{isValid:true,type:"image",format:t}}return{isValid:false,type:null}}function estimateExtractionComplexity(e,t){const r=1024*1024;if(t==="pdf"){if(e<2*r)return"low";if(e<10*r)return"medium";return"high"}if(e<1*r)return"low";if(e<5*r)return"medium";return"high"}class MemoryCache{constructor(e={}){this.cache=new Map;this.options={defaultTTL:e.defaultTTL??30*60*1e3,maxEntries:e.maxEntries??100,cleanupInterval:e.cleanupInterval??5*60*1e3};this.startCleanup()}set(e,t,r){const n={data:t,timestamp:Date.now(),ttl:r??this.options.defaultTTL,hits:0};this.cache.set(e,n);this.evictOldest()}get(e){const t=this.cache.get(e);if(!t){return null}const r=Date.now();const n=r-t.timestamp;if(n>t.ttl){this.cache.delete(e);return null}t.hits++;return t.data}has(e){const t=this.cache.get(e);if(!t){return false}const r=Date.now();const n=r-t.timestamp;if(n>t.ttl){this.cache.delete(e);return false}return true}delete(e){return this.cache.delete(e)}clear(){this.cache.clear()}size(){return this.cache.size}getStats(){const e=Array.from(this.cache.values());const t=Date.now();const r=e.reduce(((e,t)=>e+t.hits),0);const n=e.reduce(((e,r)=>e+(t-r.timestamp)),0);const i=e.length>0?n/e.length:0;const o=e.length>0?r/e.length:0;return{entries:e.length,totalHits:r,averageAge:i,hitRate:o}}evictOldest(){if(this.cache.size<=this.options.maxEntries){return}let e="";let t=Date.now();for(const[r,n]of this.cache){if(n.timestamp<t){t=n.timestamp;e=r}}if(e){this.cache.delete(e)}}startCleanup(){this.cleanupTimer=setInterval((()=>{this.cleanup()}),this.options.cleanupInterval)}cleanup(){const e=Date.now();const t=[];for(const[r,n]of this.cache){const i=e-n.timestamp;if(i>n.ttl){t.push(r)}}for(const e of t){this.cache.delete(e)}}destroy(){if(this.cleanupTimer){clearInterval(this.cleanupTimer)}this.clear()}}let extractionCache=null;function getExtractionCache(){if(!extractionCache){extractionCache=new MemoryCache({defaultTTL:60*60*1e3,maxEntries:50,cleanupInterval:10*60*1e3})}return extractionCache}function generateCacheKey(e,t,r={}){const n=JSON.stringify(r);const i=`${e}-${t}-${n}`;let o=0;for(let e=0;e<i.length;e++){const t=i.charCodeAt(e);o=(o<<5)-o+t;o=o&o}return Math.abs(o).toString(36)}class ProgressiveLoader{constructor(){this.startTime=Date.now();this.currentStage="uploading";this.listeners=[];this.startTime=Date.now()}onProgress(e){this.listeners.push(e);return()=>{const t=this.listeners.indexOf(e);if(t>-1){this.listeners.splice(t,1)}}}updateProgress(e,t,r,n){this.currentStage=e;const i=Date.now()-this.startTime;const o={stage:e,progress:Math.max(0,Math.min(100,t)),message:r,timeElapsed:i,estimatedTimeRemaining:n};for(const t of this.listeners){try{t(o)}catch(e){console.error("Progress listener error:",e)}}}complete(){this.updateProgress("complete",100,"Extraction complete")}error(e){this.updateProgress("error",0,e)}}class PaletteExtractor{constructor(e={}){this.options={maxColours:e.maxColours??15,minAreaPct:e.minAreaPct??1,combineStrategy:e.combineStrategy??"merge",rasterFallback:e.rasterFallback??true,pdfOptions:{minFrequency:3,tolerance:8,...e.pdfOptions},rasterOptions:{resampleSize:400,iterations:15,...e.rasterOptions}};this.converter=new ColourSpaceConverter;this.rasterExtractor=new RasterExtractor({maxColours:this.options.maxColours,minPercentage:this.options.minAreaPct,...this.options.rasterOptions})}async extract(e,t,r){const n=Date.now();const i=validateFileType(t);const o=estimateExtractionComplexity(e.byteLength,i.type);const s=[];const a=[];if(!i.isValid){throw new Error(`Unsupported file type: ${t}`)}const l=getExtractionCache();const c=generateCacheKey(t,e.byteLength,this.options);const h=l.get(c);if(h){r?.updateProgress("complete",100,"Using cached result");return h}r?.updateProgress("extracting",10,"Starting color extraction...");try{let h=[];let u=[];if(i.type==="pdf"){r?.updateProgress("extracting",25,"Skipping server PDF processing - client handles extraction...");s.push("PDF processing handled client-side. Server extraction skipped to avoid canvas dependencies.");console.info("Skipping server-side PDF processing - relying on client-side extraction")}if(i.type==="image"){try{r?.updateProgress("extracting",40,"Analyzing raster image colors...");const t=await this.rasterExtractor.extract(e,i.format);u=t.colours.map((e=>({id:generateColourId(e.rgb,"raster"),rgb:e.rgb,lab:this.converter.rgbToLab(e.rgb),areaPct:e.percentage,source:"raster",metadata:{pixels:e.pixels,percentage:e.percentage}})));a.push("raster");if(u.length===0){s.push("No significant colors found in raster image")}}catch(e){throw new Error(`Image extraction failed: ${e.message}`)}}r?.updateProgress("processing",70,"Combining and filtering colors...");let p=combineColourSources(h,u,this.options.combineStrategy);p=this.converter.filterInsignificant(p,this.options.minAreaPct);p=this.converter.sortByImportance(p);if(p.length>this.options.maxColours){p=p.slice(0,this.options.maxColours);s.push(`Truncated to ${this.options.maxColours} most significant colors`)}if(p.length===0){s.push("No colors extracted, using fallback");p=[{id:generateColourId({R:128,G:128,B:128},"fallback"),rgb:{R:128,G:128,B:128},lab:this.converter.rgbToLab({R:128,G:128,B:128}),areaPct:100,source:"raster"}]}const d={palette:p,metadata:{filename:t,fileSize:e.byteLength,fileType:i.type,extractionTime:Date.now()-n,complexity:o,sources:a,totalColours:{pdf:h.length||undefined,raster:u.length||undefined,combined:p.length}},warnings:s.length>0?s:undefined};r?.updateProgress("caching",90,"Caching extraction result...");l.set(c,d,60*60*1e3);r?.complete();return d}catch(e){throw new Error(`Palette extraction failed: ${e.message}`)}}}function deltaE2000(e,t){const{L:r,a:n,b:i}=e;const{L:o,a:s,b:a}=t;const l=1;const c=1;const h=1;const u=Math.sqrt(n*n+i*i);const p=Math.sqrt(s*s+a*a);const d=(u+p)/2;const m=.5*(1-Math.sqrt(Math.pow(d,7)/(Math.pow(d,7)+Math.pow(25,7))));const g=(1+m)*n;const b=(1+m)*s;const w=Math.sqrt(g*g+i*i);const E=Math.sqrt(b*b+a*a);let v=Math.atan2(i,g)*180/Math.PI;if(v<0)v+=360;let y=Math.atan2(a,b)*180/Math.PI;if(y<0)y+=360;const x=o-r;const _=E-w;let R;if(w*E===0){R=0}else{let e=y-v;if(Math.abs(e)<=180){R=e}else if(e>180){R=e-360}else{R=e+360}}const P=2*Math.sqrt(w*E)*Math.sin(R*Math.PI/360);const k=(r+o)/2;const M=(w+E)/2;let O;if(w*E===0){O=v+y}else{const e=Math.abs(v-y);const t=v+y;if(e<=180){O=t/2}else if(t<360){O=(t+360)/2}else{O=(t-360)/2}}const I=1-.17*Math.cos((O-30)*Math.PI/180)+.24*Math.cos(2*O*Math.PI/180)+.32*Math.cos((3*O+6)*Math.PI/180)-.2*Math.cos((4*O-63)*Math.PI/180);const B=30*Math.exp(-Math.pow((O-275)/25,2));const j=2*Math.sqrt(Math.pow(M,7)/(Math.pow(M,7)+Math.pow(25,7)));const L=1+.015*Math.pow(k-50,2)/Math.sqrt(20+Math.pow(k-50,2));const C=1+.045*M;const A=1+.015*M*I;const $=-Math.sin(2*B*Math.PI/180)*j;const S=Math.sqrt(Math.pow(x/(l*L),2)+Math.pow(_/(c*C),2)+Math.pow(P/(h*A),2)+$*(_/(c*C))*(P/(h*A)));return S}function deltaE76(e,t){const r=t.L-e.L;const n=t.a-e.a;const i=t.b-e.b;return Math.sqrt(r*r+n*n+i*i)}function enhanceTPVColours(e){return e.map((e=>({...e,linearRGB:sRGBToLinearRGB({R:e.R,G:e.G,B:e.B})})))}function mixLinearRGB(e){let t=0,r=0,n=0;let i=0;for(const{color:o,weight:s}of e){t+=o.R*s;r+=o.G*s;n+=o.B*s;i+=s}if(i===0){return{R:0,G:0,B:0}}return{R:t/i,G:r/i,B:n/i}}function normalizeWeights(e){const t=e.reduce(((e,t)=>e+t),0);if(t===0)return e;return e.map((e=>e/t))}function gcd(e,t){return t===0?Math.abs(e):gcd(t,e%t)}function gcdArray(e){if(e.length===0)return 1;if(e.length===1)return Math.abs(e[0]);return e.reduce(((e,t)=>gcd(e,t)),0)||1}function argmax(e){return e.reduce(((e,t,r,n)=>t>n[e]?r:e),0)}function clamp(e,t,r){return Math.max(t,Math.min(r,e))}function getRecipeKey(e){return Object.entries(e).filter((([,e])=>e>.001)).sort((([e],[t])=>e.localeCompare(t))).map((([e,t])=>`${e}:${Math.round(t*1e3)}`)).join("|")}function canonicalParts(e,t){const r=gcdArray(e);const n=e.map((e=>Math.max(1,Math.round(e/r))));const i=t.map(((e,t)=>({c:e,w:n[t]}))).sort(((e,t)=>e.c.localeCompare(t.c)));const o=i.map((e=>e.c));const s=i.map((e=>e.w));const a=s.reduce(((e,t)=>e+t),0);const l=`parts:${o.map(((e,t)=>`${e}:${s[t]}`)).join("|")}`;return{codes:o,parts:s,total:a,key:l}}function canonicalPerc(e){const t=2400;const r=e.map((({code:e,pct:r})=>({c:e,n:Math.round(r*t)}))).filter((e=>e.n>0));const n=gcdArray(r.map((e=>e.n)));const i=r.map((e=>({c:e.c,n:Math.max(1,Math.round(e.n/n))})));i.sort(((e,t)=>e.c.localeCompare(t.c)));const o=`pct:${i.map((e=>`${e.c}:${e.n}`)).join("|")}`;const s=i.reduce(((e,t)=>e+t.n),0);const a=i.map((e=>e.n/s));const l=i.map((e=>e.c));return{codes:l,weights:a,key:o}}function colourBucketKey(e){const quantize=(e,t)=>Math.round(e/t);return`lab:${quantize(e.L,.75)}:${quantize(e.a,1)}:${quantize(e.b,1)}`}function better(e,t){const r=e.mode==="parts"&&e.parts?e.parts.codes.length:e.components.length;const n=t.mode==="parts"&&t.parts?t.parts.codes.length:t.components.length;if(r!==n)return r<n;const i=e.mode==="parts"&&e.parts?e.parts.total:Infinity;const o=t.mode==="parts"&&t.parts?t.parts.total:Infinity;if(i!==o)return i<o;return e.deltaE<t.deltaE}function rank(e){const t=e.mode==="parts"&&e.parts?e.parts.codes.length:e.components.length;const r=e.mode==="parts"&&e.parts?e.parts.total:9999;return t*1e3+r+e.deltaE}function deduplicateRecipes(e){const t=new Map;for(const r of e){const e=r.mode==="parts"&&r.parts?canonicalParts(r.parts.parts,r.parts.codes).key:canonicalPerc(r.components).key;const n=t.get(e);if(!n||better(r,n)){t.set(e,r)}}const r=new Map;for(const e of Array.from(t.values())){const t=colourBucketKey(e.lab);const n=r.get(t)||[];n.push(e);r.set(t,n)}const n=[];for(const e of Array.from(r.values())){e.sort(((e,t)=>rank(e)-rank(t)));n.push(e[0])}return n.sort(((e,t)=>rank(e)-rank(t)))}function mmrSelect(e,t,r=.75){const n=[];const i=[...e];const distance=(e,t)=>Math.hypot(e.lab.L-t.lab.L,e.lab.a-t.lab.a,e.lab.b-t.lab.b);while(n.length<t&&i.length>0){let e=0;let t=Infinity;for(let o=0;o<i.length;o++){const s=i[o];const a=s.deltaE;const l=n.length>0?Math.min(...n.map((e=>distance(s,e)))):1e3;const c=r*a-(1-r)*l;if(c<t){t=c;e=o}}n.push(i.splice(e,1)[0])}return n}function deduplicateRecipesLegacy(e,t=50){const r=new Map;for(const t of e){const e=getRecipeKey(t.weights);const n=r.get(e);if(!n||t.deltaE<n.deltaE){r.set(e,t)}}return Array.from(r.values()).sort(((e,t)=>e.deltaE-t.deltaE)).slice(0,t)}function oppositionPenalty(e,t,r,n={separation:45,closeness:12,penalty:2}){const i=deltaE2000(e,t);const o=deltaE2000(e,r);const s=deltaE2000(t,r);if(i>n.separation&&Math.min(o,s)>n.closeness){return n.penalty}return 0}function sparsityBonus(e,t={dominant:.7,adjuster:.25,dominantBonus:-.3,adjusterBonus:-.2}){const r=[...e].sort(((e,t)=>t-e));let n=0;if(r[0]>=t.dominant){n+=t.dominantBonus}if(r.length>1&&r[1]<=t.adjuster){n+=t.adjusterBonus}return n}function anchorBonus(e,t,r,n,i={topN:6,minWeight:.6,bonus:-.5}){const o=deltaE2000(e,t);const s=[...n].sort(((e,t)=>e-t));const a=o<=s[i.topN-1];if(a&&r>=i.minWeight){return i.bonus}return 0}function evaluateBlendPenalties(e,t,r){let n=0;if(e.length>=2){for(let r=0;r<e.length;r++){for(let i=r+1;i<e.length;i++){const o=oppositionPenalty(e[r].lab,e[i].lab,t);n+=e.length===3?o*.5:o}}}const i=e.map((e=>e.weight));n+=sparsityBonus(i);if(e.length>0){const i=e.reduce(((e,t)=>t.weight>e.weight?t:e));n+=anchorBonus(i.lab,t,i.weight,r)}return n}function snapToParts(e,t,r,n){const{total:i,minPer:o,maxAttempts:s=3}=n;const a=Object.keys(e).filter((t=>e[t]>0));if(a.length===0)return null;let l=a.map((t=>Math.max(o,Math.round(e[t]*i))));let c=l.reduce(((e,t)=>e+t),0);let h=0;while(c!==i&&h<s*10){const t=i-c;if(t>0){const t=l.map(((t,r)=>e[a[r]]*i-t));const r=argmax(t);l[r]++}else{const t=l.map(((t,r)=>t-e[a[r]]*i));const r=argmax(t);if(l[r]>o){l[r]--}}c=l.reduce(((e,t)=>e+t),0);h++}if(c!==i){return null}let u=[...l];let p=evaluatePartsAccuracy(a,l,t,r);for(let e=0;e<5;e++){let e=false;for(let n=0;n<a.length;n++){for(let i=0;i<a.length;i++){if(n===i||l[n]<=o)continue;const s=[...l];s[n]--;s[i]++;const c=evaluatePartsAccuracy(a,s,t,r);if(c<p){u=[...s];p=c;e=true}}}if(!e)break;l=[...u]}const d=gcdArray(u);const m=u.map((e=>e/d));const g=m.reduce(((e,t)=>e+t),0);const b=normalizeWeights(m);const w={};const E={};a.forEach(((e,t)=>{w[e]=m[t];E[e]=b[t]}));const v=a.map(((e,r)=>{const n=t.find((t=>t.code===e));return{color:n.linearRGB,weight:b[r]}}));const y=mixLinearRGB(v);const x=linearRGBToSRGB(y);const _=linearRGBToXYZ(y);const R=xyzToLab(_);return{parts:w,weights:E,total:g,deltaE:deltaE2000(r,R),lab:R,rgb:x}}function evaluatePartsAccuracy(e,t,r,n){const i=normalizeWeights(t);const o=e.map(((e,t)=>{const n=r.find((t=>t.code===e));return{color:n.linearRGB,weight:i[t]}}));const s=mixLinearRGB(o);const a=linearRGBToXYZ(s);const l=xyzToLab(a);return deltaE2000(n,l)}function findOptimalParts(e,t,r,n={totals:[9,12,15,18],minPer:1,maxDeltaEPenalty:.8}){let i=null;for(const o of n.totals){const s=snapToParts(e,t,r,{total:o,minPer:n.minPer});if(!s)continue;if(!i||s.deltaE<n.maxDeltaEPenalty||s.deltaE<i.deltaE){i=s}if(s.deltaE<n.maxDeltaEPenalty){break}}return i}class SmartBlendSolver{constructor(e,t){this.colours=e;this.constraints=t;this.twoWayCache=[];this.singleDistances=[];this.enhancedColours=enhanceTPVColours(e);this.precomputeTwoWayBlends()}getHueSector(e){const t=Math.atan2(e.b,e.a)*180/Math.PI;const r=(t%360+360)%360;return Math.floor(r/60)}toDedupeRecipe(e){return{components:e.components,mode:this.constraints.mode,parts:e.parts&&e.total?{codes:Object.keys(e.parts),parts:Object.values(e.parts),total:e.total}:undefined,lab:e.lab,deltaE:e.deltaE,weights:e.weights}}fromDedupeRecipe(e){const t=e.parts?e.parts.codes.reduce(((t,r,n)=>{t[r]=e.parts.parts[n];return t}),{}):undefined;const r=this.calculateRGBFromWeights(e.weights);return{components:e.components,weights:e.weights,parts:t,total:e.parts?.total,lab:e.lab,rgb:r,deltaE:e.deltaE,baseDeltaE:e.deltaE,note:e.mode==="parts"?"Parts blend":"Percentage blend",reasoning:"Generated by enhanced solver"}}calculateRGBFromWeights(e){const t=Object.entries(e).map((([e,t])=>{const r=this.enhancedColours.find((t=>t.code===e));if(!r){return{color:{R:.5,G:.5,B:.5},weight:t}}return{color:r.linearRGB,weight:t}}));if(t.length===0){return{R:128,G:128,B:128}}const r=mixLinearRGB(t);return linearRGBToSRGB(r)}solve(e,t=5){const r=[];this.singleDistances=this.enhancedColours.map((t=>deltaE2000(e,{L:t.L,a:t.a,b:t.b})));if(this.constraints.maxComponents>=1){const t=this.solveSingleComponents(e);r.push(...t)}if(this.constraints.maxComponents>=2){const t=this.solveTwoWayBlends(e);r.push(...t)}if(this.constraints.maxComponents>=3){const t=this.solveThreeWayBlendsWithHueDiversity(e);r.push(...t)}if(r.length<t*3&&this.constraints.maxComponents<3){const n=this.autoExpandSearch(e,t*2);r.push(...n)}const n=r.map((t=>this.convertToPartsIfNeeded(t,e)));const i=n.map((e=>this.toDedupeRecipe(e)));const o=deduplicateRecipes(i);const s=mmrSelect(o,t*2,.75);const a=s.slice(0,t).map((e=>this.fromDedupeRecipe(e)));return a}autoExpandSearch(e,t){const r=[];if(this.constraints.maxComponents<3){const n=this.constraints.maxComponents;this.constraints.maxComponents=3;const i=this.solveThreeWayBlendsWithHueDiversity(e);r.push(...i.slice(0,Math.ceil(t/2)));this.constraints.maxComponents=n}if(r.length<t){const n=this.constraints.minPct;const i=Math.max(.05,this.constraints.minPct-.03);this.constraints.minPct=i;for(const n of this.twoWayCache.slice(0,t*2)){if(n.p>=i&&1-n.p>=i){n.deltaE=deltaE2000(e,n.lab);const i=this.enhancedColours[n.i];const o=this.enhancedColours[n.j];const s=evaluateBlendPenalties([{lab:{L:i.L,a:i.a,b:i.b},weight:n.p},{lab:{L:o.L,a:o.a,b:o.b},weight:1-n.p}],e,this.singleDistances);n.adjustedDeltaE=n.deltaE+s;const a=n.p>=.6?i:n.p<=.4?o:null;const l=a?`Relaxed ${a.name} with ${a===i?o.name:i.name} adjustment`:`Relaxed balanced mix of ${i.name} and ${o.name}`;r.push({components:[{code:i.code,pct:n.p},{code:o.code,pct:1-n.p}],weights:{[i.code]:n.p,[o.code]:1-n.p},lab:n.lab,rgb:linearRGBToSRGB(mixLinearRGB([{color:i.linearRGB,weight:n.p},{color:o.linearRGB,weight:1-n.p}])),deltaE:n.adjustedDeltaE,baseDeltaE:n.deltaE,note:"2-component expanded blend",reasoning:l});if(r.length>=t)break}}this.constraints.minPct=n}return r.slice(0,t)}precomputeTwoWayBlends(){const{minPct:e}=this.constraints;const t=1-e;const r=Math.max(.04,this.constraints.stepPct*2);for(let n=0;n<this.enhancedColours.length;n++){for(let i=n+1;i<this.enhancedColours.length;i++){const o=this.enhancedColours[n];const s=this.enhancedColours[i];for(let a=e;a<=t;a+=r){const e=mixLinearRGB([{color:o.linearRGB,weight:a},{color:s.linearRGB,weight:1-a}]);const t=linearRGBToXYZ(e);const r=xyzToLab(t);this.twoWayCache.push({i:n,j:i,p:a,lab:r,deltaE:0,adjustedDeltaE:0})}}}}refineTopCandidates(e,t,r=20){const n=[];const i=Math.min(.01,this.constraints.stepPct);for(const o of e.slice(0,r)){const e=this.enhancedColours[o.i];const r=this.enhancedColours[o.j];const s=.08;const a=Math.max(this.constraints.minPct,o.p-s);const l=Math.min(1-this.constraints.minPct,o.p+s);let c=o;for(let n=a;n<=l;n+=i){const i=mixLinearRGB([{color:e.linearRGB,weight:n},{color:r.linearRGB,weight:1-n}]);const s=linearRGBToXYZ(i);const a=xyzToLab(s);const l=deltaE2000(t,a);const h=evaluateBlendPenalties([{lab:{L:e.L,a:e.a,b:e.b},weight:n},{lab:{L:r.L,a:r.a,b:r.b},weight:1-n}],t,this.singleDistances);const u=l+h;if(u<c.adjustedDeltaE){c={i:o.i,j:o.j,p:n,lab:a,deltaE:l,adjustedDeltaE:u}}}n.push(c)}return n.sort(((e,t)=>e.adjustedDeltaE-t.adjustedDeltaE))}solveSingleComponents(e){const t=[];for(let r=0;r<this.enhancedColours.length;r++){const n=this.enhancedColours[r];const i={L:n.L,a:n.a,b:n.b};const o=deltaE2000(e,i);t.push({components:[{code:n.code,pct:1}],weights:{[n.code]:1},lab:i,rgb:{R:n.R,G:n.G,B:n.B},deltaE:o,baseDeltaE:o,note:"Single component",reasoning:`Direct match with ${n.name}`})}return t.sort(((e,t)=>e.deltaE-t.deltaE)).slice(0,2)}solveTwoWayBlends(e){for(const t of this.twoWayCache){t.deltaE=deltaE2000(e,t.lab);const r=this.enhancedColours[t.i];const n=this.enhancedColours[t.j];const i=evaluateBlendPenalties([{lab:{L:r.L,a:r.a,b:r.b},weight:t.p},{lab:{L:n.L,a:n.a,b:n.b},weight:1-t.p}],e,this.singleDistances);t.adjustedDeltaE=t.deltaE+i}const t=this.twoWayCache.slice().sort(((e,t)=>e.adjustedDeltaE-t.adjustedDeltaE)).slice(0,30);const r=this.refineTopCandidates(t,e,15);return r.slice(0,10).map((e=>{const t=this.enhancedColours[e.i];const r=this.enhancedColours[e.j];const n=e.p>=.6?t:e.p<=.4?r:null;const i=n?`Anchor ${n.name} with ${n===t?r.name:t.name} adjustment`:`Balanced mix of ${t.name} and ${r.name}`;return{components:[{code:t.code,pct:e.p},{code:r.code,pct:1-e.p}],weights:{[t.code]:e.p,[r.code]:1-e.p},lab:e.lab,rgb:linearRGBToSRGB(mixLinearRGB([{color:t.linearRGB,weight:e.p},{color:r.linearRGB,weight:1-e.p}])),deltaE:e.adjustedDeltaE,baseDeltaE:e.deltaE,note:"2-component blend",reasoning:i}}))}solveThreeWayBlendsWithHueDiversity(e){const t=[];const r=new Map;for(const t of this.twoWayCache){t.deltaE=deltaE2000(e,t.lab);const n=this.enhancedColours[t.i];const i=this.enhancedColours[t.j];const o=evaluateBlendPenalties([{lab:{L:n.L,a:n.a,b:n.b},weight:t.p},{lab:{L:i.L,a:i.a,b:i.b},weight:1-t.p}],e,this.singleDistances);t.adjustedDeltaE=t.deltaE+o;const s=this.getHueSector(t.lab);const a=r.get(s)||[];a.push(t);r.set(s,a)}const n=[];for(const e of Array.from(r.values())){e.sort(((e,t)=>e.adjustedDeltaE-t.adjustedDeltaE));n.push(...e.slice(0,4))}if(n.length<24){const e=Array.from(r.values()).flat();e.sort(((e,t)=>e.adjustedDeltaE-t.adjustedDeltaE));const t=30-n.length;n.push(...e.slice(0,t))}return this.generateThreeWayFromSeeds(n,e)}generateThreeWayFromSeeds(e,t){const r=[];for(const n of e){const e=[n.i,n.j];for(let i=0;i<this.enhancedColours.length;i++){if(e.includes(i))continue;const o=this.enhancedColours[i];for(let e=this.constraints.minPct;e<=1-2*this.constraints.minPct;e+=this.constraints.stepPct*2){const i=1-e;const s=Math.max(this.constraints.minPct,n.p*i);const a=i-s;if(a<this.constraints.minPct)continue;const l=normalizeWeights([s,a,e]);const[c,h,u]=l;const p=mixLinearRGB([{color:this.enhancedColours[n.i].linearRGB,weight:c},{color:this.enhancedColours[n.j].linearRGB,weight:h},{color:o.linearRGB,weight:u}]);const d=linearRGBToXYZ(p);const m=xyzToLab(d);const g=deltaE2000(t,m);const b=evaluateBlendPenalties([{lab:{L:this.enhancedColours[n.i].L,a:this.enhancedColours[n.i].a,b:this.enhancedColours[n.i].b},weight:c},{lab:{L:this.enhancedColours[n.j].L,a:this.enhancedColours[n.j].a,b:this.enhancedColours[n.j].b},weight:h},{lab:{L:o.L,a:o.a,b:o.b},weight:u}],t,this.singleDistances);const w=g+b;r.push({components:[{code:this.enhancedColours[n.i].code,pct:c},{code:this.enhancedColours[n.j].code,pct:h},{code:o.code,pct:u}],weights:{[this.enhancedColours[n.i].code]:c,[this.enhancedColours[n.j].code]:h,[o.code]:u},lab:m,rgb:linearRGBToSRGB(p),deltaE:w,baseDeltaE:g,note:"3-component blend",reasoning:"Refined blend with three components"})}}}return r.sort(((e,t)=>e.deltaE-t.deltaE)).slice(0,5)}convertToPartsIfNeeded(e,t){if(this.constraints.mode!=="parts"||!this.constraints.parts?.enabled){return e}const r=findOptimalParts(e.weights,this.enhancedColours,t,{totals:this.constraints.parts.total?[this.constraints.parts.total]:[9,12,15],minPer:this.constraints.parts.minPer||1,maxDeltaEPenalty:.8});if(r){return{...e,parts:r.parts,total:r.total,weights:r.weights,lab:r.lab,rgb:r.rgb,deltaE:r.deltaE,note:e.note+` (${r.total} parts total)`,reasoning:e.reasoning+` - Snapped to ${r.total} parts with E ${(r.deltaE-e.baseDeltaE).toFixed(2)} penalty`}}return e}}const rosehill_tpv_21_colours_namespaceObject=JSON.parse('[{"code":"RH01","name":"Standard Red","hex":"#B71E2D","R":183,"G":30,"B":45,"L":39.4,"a":58.5,"b":29},{"code":"RH02","name":"Bright Red","hex":"#E31D25","R":227,"G":29,"B":37,"L":47.4,"a":70.1,"b":44},{"code":"RH10","name":"Standard Green","hex":"#006B3F","R":0,"G":107,"B":63,"L":40.5,"a":-42.2,"b":17.9},{"code":"RH11","name":"Bright Green","hex":"#4BAA34","R":75,"G":170,"B":52,"L":62.1,"a":-47.7,"b":47.2},{"code":"RH12","name":"Dark Green","hex":"#006747","R":0,"G":103,"B":71,"L":39.6,"a":-38.3,"b":13.1},{"code":"RH20","name":"Standard Blue","hex":"#1B4F9C","R":27,"G":79,"B":156,"L":36.4,"a":14.2,"b":-46.7},{"code":"RH21","name":"Purple","hex":"#662D91","R":102,"G":45,"B":145,"L":31.5,"a":41.9,"b":-40.9},{"code":"RH22","name":"Light Blue","hex":"#0091D7","R":0,"G":145,"B":215,"L":55.3,"a":-19.1,"b":-37.3},{"code":"RH23","name":"Azure","hex":"#0076B6","R":0,"G":118,"B":182,"L":47.7,"a":-4.8,"b":-34.8},{"code":"RH26","name":"Turquoise","hex":"#00A499","R":0,"G":164,"B":153,"L":58.8,"a":-38.4,"b":-3},{"code":"RH30","name":"Standard Beige","hex":"#D4B585","R":212,"G":181,"B":133,"L":75.2,"a":3.8,"b":24.8},{"code":"RH31","name":"Cream","hex":"#F2E6C8","R":242,"G":230,"B":200,"L":91.8,"a":-0.5,"b":12.5},{"code":"RH32","name":"Brown","hex":"#754C29","R":117,"G":76,"B":41,"L":40,"a":15.9,"b":27.1},{"code":"RH90","name":"Funky Pink","hex":"#e8457e","R":232,"G":69,"B":126,"L":55,"a":66.1,"b":4.9},{"code":"RH40","name":"Mustard Yellow","hex":"#C6972D","R":198,"G":151,"B":45,"L":66,"a":8.4,"b":56.3},{"code":"RH41","name":"Bright Yellow","hex":"#FFD100","R":255,"G":209,"B":0,"L":86.9,"a":-1,"b":90.6},{"code":"RH50","name":"Orange","hex":"#F47920","R":244,"G":121,"B":32,"L":63.2,"a":49.8,"b":60.2},{"code":"RH60","name":"Dark Grey","hex":"#4D4F53","R":77,"G":79,"B":83,"L":34.1,"a":-0.4,"b":-2.4},{"code":"RH61","name":"Light Grey","hex":"#A7A8AA","R":167,"G":168,"B":170,"L":69,"a":-0.5,"b":-1},{"code":"RH65","name":"Pale Grey","hex":"#DCDDDE","R":220,"G":221,"B":222,"L":87.6,"a":-0.2,"b":-0.7},{"code":"RH70","name":"Black","hex":"#101820","R":16,"G":24,"B":32,"L":9.1,"a":-0.3,"b":-6.3}]');async function handler(e,t){if(e.method!=="POST"){return t.status(405).json({success:false,error:"Method not allowed. Use POST."})}try{const{svg_url:r,job_id:n,max_colors:i=8,max_components:o=2}=e.body;if(!r){return t.status(400).json({success:false,error:"Missing required field: svg_url"})}console.log("[BLEND-RECIPES] Starting color extraction for job:",n);console.log("[BLEND-RECIPES] SVG URL:",r);console.log("[BLEND-RECIPES] Max colors:",i,"Max components:",o);const s=Date.now();console.log("[BLEND-RECIPES] Fetching SVG from URL...");const a=await fetch(r);if(!a.ok){throw new Error(`Failed to fetch SVG: ${a.status} ${a.statusText}`)}const l=await a.arrayBuffer();console.log(`[BLEND-RECIPES] SVG fetched (${l.byteLength} bytes)`);console.log("[BLEND-RECIPES] Extracting colors...");const c=new PaletteExtractor({maxColours:i,minAreaPct:1,rasterOptions:{resampleSize:400,iterations:15}});const h=await c.extract(l,"design.svg");const u=Date.now()-s;console.log(`[BLEND-RECIPES] Extracted ${h.palette.length} colors in ${u}ms`);if(h.palette.length===0){return t.status(200).json({success:true,colors:[],recipes:[],message:"No significant colors found in SVG (all colors below 1% coverage)"})}console.log("[BLEND-RECIPES] Initializing blend solver...");const p=new SmartBlendSolver(rosehill_tpv_21_colours_namespaceObject,{maxComponents:o,stepPct:.04,minPct:.1,mode:"parts",parts:{enabled:true,total:12,minPer:1},preferAnchor:true});console.log("[BLEND-RECIPES] Generating blend recipes...");const d=[];const m=Date.now();for(let e=0;e<h.palette.length;e++){const t=h.palette[e];console.log(`[BLEND-RECIPES]   Color ${e+1}/${h.palette.length}: RGB(${t.rgb.R}, ${t.rgb.G}, ${t.rgb.B}) - ${t.areaPct.toFixed(1)}%`);const r=p.solve(t.lab,3);const n=r.map((e=>({parts:e.parts||{},total:e.total||0,deltaE:e.deltaE,quality:e.deltaE<1?"Excellent":e.deltaE<2?"Good":"Fair",resultRgb:e.rgb,components:e.components.map((t=>({code:t.code,name:rosehill_tpv_21_colours_namespaceObject.find((e=>e.code===t.code))?.name||t.code,weight:t.pct,parts:e.parts?e.parts[t.code]:null})))})));console.log(`[BLEND-RECIPES]     Best E: ${r[0].deltaE.toFixed(2)} (${n[0].quality})`);d.push({targetColor:{hex:blend_recipes_rgbToHex(t.rgb),rgb:t.rgb,lab:t.lab,areaPct:t.areaPct},blends:n})}const g=Date.now()-m;const b=Date.now()-s;console.log(`[BLEND-RECIPES] Generated ${d.length} recipe sets in ${g}ms (total: ${b}ms)`);const w=h.palette.map((e=>({hex:blend_recipes_rgbToHex(e.rgb),rgb:e.rgb,lab:e.lab,areaPct:e.areaPct})));return t.status(200).json({success:true,colors:w,recipes:d,metadata:{colorsExtracted:h.palette.length,extractionTime:u,solveTime:g,totalTime:b,maxComponents:o}})}catch(e){console.error("[BLEND-RECIPES] Error:",e);console.error(e.stack);return t.status(500).json({success:false,error:e.message||"Internal server error",stack:process.env.NODE_ENV==="development"?e.stack:undefined})}}function blend_recipes_rgbToHex(e){const toHex=e=>Math.round(e).toString(16).padStart(2,"0");return`#${toHex(e.R)}${toHex(e.G)}${toHex(e.B)}`}const config={api:{bodyParser:{sizeLimit:"2mb"},responseLimit:"4mb",externalResolver:false},maxDuration:60};var __webpack_exports__config=__nested_webpack_exports__.$;var __webpack_exports__default=__nested_webpack_exports__.A;var __webpack_exports__config=__webpack_exports__.$;var __webpack_exports__default=__webpack_exports__.A;export{__webpack_exports__config as config,__webpack_exports__default as default};