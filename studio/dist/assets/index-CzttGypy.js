var u2=Object.defineProperty;var h2=(t,e,n)=>e in t?u2(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var p2=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var Ul=(t,e,n)=>h2(t,typeof e!="symbol"?e+"":e,n);var UW=p2((Xn,Zn)=>{function f2(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var As=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function jl(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function m2(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var s=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return t[r]}})}),n}var Gx={exports:{}},Td={},Vx={exports:{}},gt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cl=Symbol.for("react.element"),g2=Symbol.for("react.portal"),y2=Symbol.for("react.fragment"),x2=Symbol.for("react.strict_mode"),v2=Symbol.for("react.profiler"),b2=Symbol.for("react.provider"),w2=Symbol.for("react.context"),_2=Symbol.for("react.forward_ref"),S2=Symbol.for("react.suspense"),k2=Symbol.for("react.memo"),j2=Symbol.for("react.lazy"),zm=Symbol.iterator;function C2(t){return t===null||typeof t!="object"?null:(t=zm&&t[zm]||t["@@iterator"],typeof t=="function"?t:null)}var Yx={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},qx=Object.assign,Xx={};function Jo(t,e,n){this.props=t,this.context=e,this.refs=Xx,this.updater=n||Yx}Jo.prototype.isReactComponent={};Jo.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Jo.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Zx(){}Zx.prototype=Jo.prototype;function Rp(t,e,n){this.props=t,this.context=e,this.refs=Xx,this.updater=n||Yx}var Op=Rp.prototype=new Zx;Op.constructor=Rp;qx(Op,Jo.prototype);Op.isPureReactComponent=!0;var Fm=Array.isArray,Kx=Object.prototype.hasOwnProperty,Ap={current:null},Jx={key:!0,ref:!0,__self:!0,__source:!0};function Qx(t,e,n){var r,s={},i=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)Kx.call(e,r)&&!Jx.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];s.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:Cl,type:t,key:i,ref:a,props:s,_owner:Ap.current}}function E2(t,e){return{$$typeof:Cl,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Mp(t){return typeof t=="object"&&t!==null&&t.$$typeof===Cl}function T2(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Bm=/\/+/g;function du(t,e){return typeof t=="object"&&t!==null&&t.key!=null?T2(""+t.key):e.toString(36)}function Ec(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Cl:case g2:a=!0}}if(a)return a=t,s=s(a),t=r===""?"."+du(a,0):r,Fm(s)?(n="",t!=null&&(n=t.replace(Bm,"$&/")+"/"),Ec(s,e,n,"",function(d){return d})):s!=null&&(Mp(s)&&(s=E2(s,n+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(Bm,"$&/")+"/")+t)),e.push(s)),1;if(a=0,r=r===""?".":r+":",Fm(t))for(var l=0;l<t.length;l++){i=t[l];var c=r+du(i,l);a+=Ec(i,e,n,c,s)}else if(c=C2(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=r+du(i,l++),a+=Ec(i,e,n,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Wl(t,e,n){if(t==null)return t;var r=[],s=0;return Ec(t,r,"","",function(i){return e.call(n,i,s++)}),r}function N2(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Nn={current:null},Tc={transition:null},P2={ReactCurrentDispatcher:Nn,ReactCurrentBatchConfig:Tc,ReactCurrentOwner:Ap};function ev(){throw Error("act(...) is not supported in production builds of React.")}gt.Children={map:Wl,forEach:function(t,e,n){Wl(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Wl(t,function(){e++}),e},toArray:function(t){return Wl(t,function(e){return e})||[]},only:function(t){if(!Mp(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};gt.Component=Jo;gt.Fragment=y2;gt.Profiler=v2;gt.PureComponent=Rp;gt.StrictMode=x2;gt.Suspense=S2;gt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=P2;gt.act=ev;gt.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=qx({},t.props),s=t.key,i=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=Ap.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)Kx.call(e,c)&&!Jx.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:Cl,type:t.type,key:s,ref:i,props:r,_owner:a}};gt.createContext=function(t){return t={$$typeof:w2,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:b2,_context:t},t.Consumer=t};gt.createElement=Qx;gt.createFactory=function(t){var e=Qx.bind(null,t);return e.type=t,e};gt.createRef=function(){return{current:null}};gt.forwardRef=function(t){return{$$typeof:_2,render:t}};gt.isValidElement=Mp;gt.lazy=function(t){return{$$typeof:j2,_payload:{_status:-1,_result:t},_init:N2}};gt.memo=function(t,e){return{$$typeof:k2,type:t,compare:e===void 0?null:e}};gt.startTransition=function(t){var e=Tc.transition;Tc.transition={};try{t()}finally{Tc.transition=e}};gt.unstable_act=ev;gt.useCallback=function(t,e){return Nn.current.useCallback(t,e)};gt.useContext=function(t){return Nn.current.useContext(t)};gt.useDebugValue=function(){};gt.useDeferredValue=function(t){return Nn.current.useDeferredValue(t)};gt.useEffect=function(t,e){return Nn.current.useEffect(t,e)};gt.useId=function(){return Nn.current.useId()};gt.useImperativeHandle=function(t,e,n){return Nn.current.useImperativeHandle(t,e,n)};gt.useInsertionEffect=function(t,e){return Nn.current.useInsertionEffect(t,e)};gt.useLayoutEffect=function(t,e){return Nn.current.useLayoutEffect(t,e)};gt.useMemo=function(t,e){return Nn.current.useMemo(t,e)};gt.useReducer=function(t,e,n){return Nn.current.useReducer(t,e,n)};gt.useRef=function(t){return Nn.current.useRef(t)};gt.useState=function(t){return Nn.current.useState(t)};gt.useSyncExternalStore=function(t,e,n){return Nn.current.useSyncExternalStore(t,e,n)};gt.useTransition=function(){return Nn.current.useTransition()};gt.version="18.3.1";Vx.exports=gt;var R=Vx.exports;const $=jl(R);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var R2=R,O2=Symbol.for("react.element"),A2=Symbol.for("react.fragment"),M2=Object.prototype.hasOwnProperty,$2=R2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,L2={key:!0,ref:!0,__self:!0,__source:!0};function tv(t,e,n){var r,s={},i=null,a=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)M2.call(e,r)&&!L2.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:O2,type:t,key:i,ref:a,props:s,_owner:$2.current}}Td.Fragment=A2;Td.jsx=tv;Td.jsxs=tv;Gx.exports=Td;var o=Gx.exports,dh={},nv={exports:{}},er={},rv={exports:{}},sv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(ee,F){var K=ee.length;ee.push(F);e:for(;0<K;){var U=K-1>>>1,V=ee[U];if(0<s(V,F))ee[U]=F,ee[K]=V,K=U;else break e}}function n(ee){return ee.length===0?null:ee[0]}function r(ee){if(ee.length===0)return null;var F=ee[0],K=ee.pop();if(K!==F){ee[0]=K;e:for(var U=0,V=ee.length,J=V>>>1;U<J;){var oe=2*(U+1)-1,me=ee[oe],je=oe+1,he=ee[je];if(0>s(me,K))je<V&&0>s(he,me)?(ee[U]=he,ee[je]=K,U=je):(ee[U]=me,ee[oe]=K,U=oe);else if(je<V&&0>s(he,K))ee[U]=he,ee[je]=K,U=je;else break e}}return F}function s(ee,F){var K=ee.sortIndex-F.sortIndex;return K!==0?K:ee.id-F.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],d=[],u=1,p=null,h=3,f=!1,m=!1,g=!1,v=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(ee){for(var F=n(d);F!==null;){if(F.callback===null)r(d);else if(F.startTime<=ee)r(d),F.sortIndex=F.expirationTime,e(c,F);else break;F=n(d)}}function w(ee){if(g=!1,b(ee),!m)if(n(c)!==null)m=!0,pe(S);else{var F=n(d);F!==null&&Z(w,F.startTime-ee)}}function S(ee,F){m=!1,g&&(g=!1,y(E),E=-1),f=!0;var K=h;try{for(b(F),p=n(c);p!==null&&(!(p.expirationTime>F)||ee&&!q());){var U=p.callback;if(typeof U=="function"){p.callback=null,h=p.priorityLevel;var V=U(p.expirationTime<=F);F=t.unstable_now(),typeof V=="function"?p.callback=V:p===n(c)&&r(c),b(F)}else r(c);p=n(c)}if(p!==null)var J=!0;else{var oe=n(d);oe!==null&&Z(w,oe.startTime-F),J=!1}return J}finally{p=null,h=K,f=!1}}var _=!1,k=null,E=-1,T=5,O=-1;function q(){return!(t.unstable_now()-O<T)}function P(){if(k!==null){var ee=t.unstable_now();O=ee;var F=!0;try{F=k(!0,ee)}finally{F?W():(_=!1,k=null)}}else _=!1}var W;if(typeof x=="function")W=function(){x(P)};else if(typeof MessageChannel<"u"){var j=new MessageChannel,G=j.port2;j.port1.onmessage=P,W=function(){G.postMessage(null)}}else W=function(){v(P,0)};function pe(ee){k=ee,_||(_=!0,W())}function Z(ee,F){E=v(function(){ee(t.unstable_now())},F)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ee){ee.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,pe(S))},t.unstable_forceFrameRate=function(ee){0>ee||125<ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<ee?Math.floor(1e3/ee):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(ee){switch(h){case 1:case 2:case 3:var F=3;break;default:F=h}var K=h;h=F;try{return ee()}finally{h=K}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(ee,F){switch(ee){case 1:case 2:case 3:case 4:case 5:break;default:ee=3}var K=h;h=ee;try{return F()}finally{h=K}},t.unstable_scheduleCallback=function(ee,F,K){var U=t.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?U+K:U):K=U,ee){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=K+V,ee={id:u++,callback:F,priorityLevel:ee,startTime:K,expirationTime:V,sortIndex:-1},K>U?(ee.sortIndex=K,e(d,ee),n(c)===null&&ee===n(d)&&(g?(y(E),E=-1):g=!0,Z(w,K-U))):(ee.sortIndex=V,e(c,ee),m||f||(m=!0,pe(S))),ee},t.unstable_shouldYield=q,t.unstable_wrapCallback=function(ee){var F=h;return function(){var K=h;h=F;try{return ee.apply(this,arguments)}finally{h=K}}}})(sv);rv.exports=sv;var D2=rv.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var I2=R,Jn=D2;function Pe(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var iv=new Set,nl={};function Mi(t,e){Ho(t,e),Ho(t+"Capture",e)}function Ho(t,e){for(nl[t]=e,t=0;t<e.length;t++)iv.add(e[t])}var hs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),uh=Object.prototype.hasOwnProperty,z2=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Hm={},Um={};function F2(t){return uh.call(Um,t)?!0:uh.call(Hm,t)?!1:z2.test(t)?Um[t]=!0:(Hm[t]=!0,!1)}function B2(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function H2(t,e,n,r){if(e===null||typeof e>"u"||B2(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Pn(t,e,n,r,s,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var xn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){xn[t]=new Pn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];xn[e]=new Pn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){xn[t]=new Pn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){xn[t]=new Pn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){xn[t]=new Pn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){xn[t]=new Pn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){xn[t]=new Pn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){xn[t]=new Pn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){xn[t]=new Pn(t,5,!1,t.toLowerCase(),null,!1,!1)});var $p=/[\-:]([a-z])/g;function Lp(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace($p,Lp);xn[e]=new Pn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace($p,Lp);xn[e]=new Pn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace($p,Lp);xn[e]=new Pn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){xn[t]=new Pn(t,1,!1,t.toLowerCase(),null,!1,!1)});xn.xlinkHref=new Pn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){xn[t]=new Pn(t,1,!1,t.toLowerCase(),null,!0,!0)});function Dp(t,e,n,r){var s=xn.hasOwnProperty(e)?xn[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(H2(e,n,s,r)&&(n=null),r||s===null?F2(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var gs=I2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Gl=Symbol.for("react.element"),wo=Symbol.for("react.portal"),_o=Symbol.for("react.fragment"),Ip=Symbol.for("react.strict_mode"),hh=Symbol.for("react.profiler"),ov=Symbol.for("react.provider"),av=Symbol.for("react.context"),zp=Symbol.for("react.forward_ref"),ph=Symbol.for("react.suspense"),fh=Symbol.for("react.suspense_list"),Fp=Symbol.for("react.memo"),Cs=Symbol.for("react.lazy"),lv=Symbol.for("react.offscreen"),Wm=Symbol.iterator;function va(t){return t===null||typeof t!="object"?null:(t=Wm&&t[Wm]||t["@@iterator"],typeof t=="function"?t:null)}var Wt=Object.assign,uu;function $a(t){if(uu===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);uu=e&&e[1]||""}return`
`+uu+t}var hu=!1;function pu(t,e){if(!t||hu)return"";hu=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),a=s.length-1,l=i.length-1;1<=a&&0<=l&&s[a]!==i[l];)l--;for(;1<=a&&0<=l;a--,l--)if(s[a]!==i[l]){if(a!==1||l!==1)do if(a--,l--,0>l||s[a]!==i[l]){var c=`
`+s[a].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=a&&0<=l);break}}}finally{hu=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?$a(t):""}function U2(t){switch(t.tag){case 5:return $a(t.type);case 16:return $a("Lazy");case 13:return $a("Suspense");case 19:return $a("SuspenseList");case 0:case 2:case 15:return t=pu(t.type,!1),t;case 11:return t=pu(t.type.render,!1),t;case 1:return t=pu(t.type,!0),t;default:return""}}function mh(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case _o:return"Fragment";case wo:return"Portal";case hh:return"Profiler";case Ip:return"StrictMode";case ph:return"Suspense";case fh:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case av:return(t.displayName||"Context")+".Consumer";case ov:return(t._context.displayName||"Context")+".Provider";case zp:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Fp:return e=t.displayName||null,e!==null?e:mh(t.type)||"Memo";case Cs:e=t._payload,t=t._init;try{return mh(t(e))}catch{}}return null}function W2(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return mh(e);case 8:return e===Ip?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Gs(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function cv(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function G2(t){var e=cv(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Vl(t){t._valueTracker||(t._valueTracker=G2(t))}function dv(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=cv(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Fc(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function gh(t,e){var n=e.checked;return Wt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Gm(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Gs(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function uv(t,e){e=e.checked,e!=null&&Dp(t,"checked",e,!1)}function yh(t,e){uv(t,e);var n=Gs(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?xh(t,e.type,n):e.hasOwnProperty("defaultValue")&&xh(t,e.type,Gs(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Vm(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function xh(t,e,n){(e!=="number"||Fc(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var La=Array.isArray;function Mo(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Gs(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function vh(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Pe(91));return Wt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Ym(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Pe(92));if(La(n)){if(1<n.length)throw Error(Pe(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Gs(n)}}function hv(t,e){var n=Gs(e.value),r=Gs(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function qm(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function pv(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function bh(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?pv(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Yl,fv=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Yl=Yl||document.createElement("div"),Yl.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Yl.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function rl(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Ua={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},V2=["Webkit","ms","Moz","O"];Object.keys(Ua).forEach(function(t){V2.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ua[e]=Ua[t]})});function mv(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Ua.hasOwnProperty(t)&&Ua[t]?(""+e).trim():e+"px"}function gv(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=mv(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var Y2=Wt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function wh(t,e){if(e){if(Y2[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Pe(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Pe(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Pe(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Pe(62))}}function _h(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Sh=null;function Bp(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var kh=null,$o=null,Lo=null;function Xm(t){if(t=Nl(t)){if(typeof kh!="function")throw Error(Pe(280));var e=t.stateNode;e&&(e=Ad(e),kh(t.stateNode,t.type,e))}}function yv(t){$o?Lo?Lo.push(t):Lo=[t]:$o=t}function xv(){if($o){var t=$o,e=Lo;if(Lo=$o=null,Xm(t),e)for(t=0;t<e.length;t++)Xm(e[t])}}function vv(t,e){return t(e)}function bv(){}var fu=!1;function wv(t,e,n){if(fu)return t(e,n);fu=!0;try{return vv(t,e,n)}finally{fu=!1,($o!==null||Lo!==null)&&(bv(),xv())}}function sl(t,e){var n=t.stateNode;if(n===null)return null;var r=Ad(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Pe(231,e,typeof n));return n}var jh=!1;if(hs)try{var ba={};Object.defineProperty(ba,"passive",{get:function(){jh=!0}}),window.addEventListener("test",ba,ba),window.removeEventListener("test",ba,ba)}catch{jh=!1}function q2(t,e,n,r,s,i,a,l,c){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(u){this.onError(u)}}var Wa=!1,Bc=null,Hc=!1,Ch=null,X2={onError:function(t){Wa=!0,Bc=t}};function Z2(t,e,n,r,s,i,a,l,c){Wa=!1,Bc=null,q2.apply(X2,arguments)}function K2(t,e,n,r,s,i,a,l,c){if(Z2.apply(this,arguments),Wa){if(Wa){var d=Bc;Wa=!1,Bc=null}else throw Error(Pe(198));Hc||(Hc=!0,Ch=d)}}function $i(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function _v(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Zm(t){if($i(t)!==t)throw Error(Pe(188))}function J2(t){var e=t.alternate;if(!e){if(e=$i(t),e===null)throw Error(Pe(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Zm(s),t;if(i===r)return Zm(s),e;i=i.sibling}throw Error(Pe(188))}if(n.return!==r.return)n=s,r=i;else{for(var a=!1,l=s.child;l;){if(l===n){a=!0,n=s,r=i;break}if(l===r){a=!0,r=s,n=i;break}l=l.sibling}if(!a){for(l=i.child;l;){if(l===n){a=!0,n=i,r=s;break}if(l===r){a=!0,r=i,n=s;break}l=l.sibling}if(!a)throw Error(Pe(189))}}if(n.alternate!==r)throw Error(Pe(190))}if(n.tag!==3)throw Error(Pe(188));return n.stateNode.current===n?t:e}function Sv(t){return t=J2(t),t!==null?kv(t):null}function kv(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=kv(t);if(e!==null)return e;t=t.sibling}return null}var jv=Jn.unstable_scheduleCallback,Km=Jn.unstable_cancelCallback,Q2=Jn.unstable_shouldYield,eS=Jn.unstable_requestPaint,Jt=Jn.unstable_now,tS=Jn.unstable_getCurrentPriorityLevel,Hp=Jn.unstable_ImmediatePriority,Cv=Jn.unstable_UserBlockingPriority,Uc=Jn.unstable_NormalPriority,nS=Jn.unstable_LowPriority,Ev=Jn.unstable_IdlePriority,Nd=null,Gr=null;function rS(t){if(Gr&&typeof Gr.onCommitFiberRoot=="function")try{Gr.onCommitFiberRoot(Nd,t,void 0,(t.current.flags&128)===128)}catch{}}var Rr=Math.clz32?Math.clz32:oS,sS=Math.log,iS=Math.LN2;function oS(t){return t>>>=0,t===0?32:31-(sS(t)/iS|0)|0}var ql=64,Xl=4194304;function Da(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Wc(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,a=n&268435455;if(a!==0){var l=a&~s;l!==0?r=Da(l):(i&=a,i!==0&&(r=Da(i)))}else a=n&~s,a!==0?r=Da(a):i!==0&&(r=Da(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Rr(e),s=1<<n,r|=t[n],e&=~s;return r}function aS(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function lS(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var a=31-Rr(i),l=1<<a,c=s[a];c===-1?(!(l&n)||l&r)&&(s[a]=aS(l,e)):c<=e&&(t.expiredLanes|=l),i&=~l}}function Eh(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Tv(){var t=ql;return ql<<=1,!(ql&4194240)&&(ql=64),t}function mu(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function El(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Rr(e),t[e]=n}function cS(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Rr(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function Up(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Rr(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var jt=0;function Nv(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Pv,Wp,Rv,Ov,Av,Th=!1,Zl=[],Ds=null,Is=null,zs=null,il=new Map,ol=new Map,Ns=[],dS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Jm(t,e){switch(t){case"focusin":case"focusout":Ds=null;break;case"dragenter":case"dragleave":Is=null;break;case"mouseover":case"mouseout":zs=null;break;case"pointerover":case"pointerout":il.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ol.delete(e.pointerId)}}function wa(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Nl(e),e!==null&&Wp(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function uS(t,e,n,r,s){switch(e){case"focusin":return Ds=wa(Ds,t,e,n,r,s),!0;case"dragenter":return Is=wa(Is,t,e,n,r,s),!0;case"mouseover":return zs=wa(zs,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return il.set(i,wa(il.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,ol.set(i,wa(ol.get(i)||null,t,e,n,r,s)),!0}return!1}function Mv(t){var e=wi(t.target);if(e!==null){var n=$i(e);if(n!==null){if(e=n.tag,e===13){if(e=_v(n),e!==null){t.blockedOn=e,Av(t.priority,function(){Rv(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Nc(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Nh(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Sh=r,n.target.dispatchEvent(r),Sh=null}else return e=Nl(n),e!==null&&Wp(e),t.blockedOn=n,!1;e.shift()}return!0}function Qm(t,e,n){Nc(t)&&n.delete(e)}function hS(){Th=!1,Ds!==null&&Nc(Ds)&&(Ds=null),Is!==null&&Nc(Is)&&(Is=null),zs!==null&&Nc(zs)&&(zs=null),il.forEach(Qm),ol.forEach(Qm)}function _a(t,e){t.blockedOn===e&&(t.blockedOn=null,Th||(Th=!0,Jn.unstable_scheduleCallback(Jn.unstable_NormalPriority,hS)))}function al(t){function e(s){return _a(s,t)}if(0<Zl.length){_a(Zl[0],t);for(var n=1;n<Zl.length;n++){var r=Zl[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ds!==null&&_a(Ds,t),Is!==null&&_a(Is,t),zs!==null&&_a(zs,t),il.forEach(e),ol.forEach(e),n=0;n<Ns.length;n++)r=Ns[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Ns.length&&(n=Ns[0],n.blockedOn===null);)Mv(n),n.blockedOn===null&&Ns.shift()}var Do=gs.ReactCurrentBatchConfig,Gc=!0;function pS(t,e,n,r){var s=jt,i=Do.transition;Do.transition=null;try{jt=1,Gp(t,e,n,r)}finally{jt=s,Do.transition=i}}function fS(t,e,n,r){var s=jt,i=Do.transition;Do.transition=null;try{jt=4,Gp(t,e,n,r)}finally{jt=s,Do.transition=i}}function Gp(t,e,n,r){if(Gc){var s=Nh(t,e,n,r);if(s===null)ju(t,e,r,Vc,n),Jm(t,r);else if(uS(s,t,e,n,r))r.stopPropagation();else if(Jm(t,r),e&4&&-1<dS.indexOf(t)){for(;s!==null;){var i=Nl(s);if(i!==null&&Pv(i),i=Nh(t,e,n,r),i===null&&ju(t,e,r,Vc,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else ju(t,e,r,null,n)}}var Vc=null;function Nh(t,e,n,r){if(Vc=null,t=Bp(r),t=wi(t),t!==null)if(e=$i(t),e===null)t=null;else if(n=e.tag,n===13){if(t=_v(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Vc=t,null}function $v(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(tS()){case Hp:return 1;case Cv:return 4;case Uc:case nS:return 16;case Ev:return 536870912;default:return 16}default:return 16}}var Ms=null,Vp=null,Pc=null;function Lv(){if(Pc)return Pc;var t,e=Vp,n=e.length,r,s="value"in Ms?Ms.value:Ms.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===s[i-r];r++);return Pc=s.slice(t,1<r?1-r:void 0)}function Rc(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Kl(){return!0}function eg(){return!1}function tr(t){function e(n,r,s,i,a){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Kl:eg,this.isPropagationStopped=eg,this}return Wt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Kl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Kl)},persist:function(){},isPersistent:Kl}),e}var Qo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Yp=tr(Qo),Tl=Wt({},Qo,{view:0,detail:0}),mS=tr(Tl),gu,yu,Sa,Pd=Wt({},Tl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:qp,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Sa&&(Sa&&t.type==="mousemove"?(gu=t.screenX-Sa.screenX,yu=t.screenY-Sa.screenY):yu=gu=0,Sa=t),gu)},movementY:function(t){return"movementY"in t?t.movementY:yu}}),tg=tr(Pd),gS=Wt({},Pd,{dataTransfer:0}),yS=tr(gS),xS=Wt({},Tl,{relatedTarget:0}),xu=tr(xS),vS=Wt({},Qo,{animationName:0,elapsedTime:0,pseudoElement:0}),bS=tr(vS),wS=Wt({},Qo,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),_S=tr(wS),SS=Wt({},Qo,{data:0}),ng=tr(SS),kS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},jS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},CS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ES(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=CS[t])?!!e[t]:!1}function qp(){return ES}var TS=Wt({},Tl,{key:function(t){if(t.key){var e=kS[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Rc(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?jS[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:qp,charCode:function(t){return t.type==="keypress"?Rc(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Rc(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),NS=tr(TS),PS=Wt({},Pd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),rg=tr(PS),RS=Wt({},Tl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:qp}),OS=tr(RS),AS=Wt({},Qo,{propertyName:0,elapsedTime:0,pseudoElement:0}),MS=tr(AS),$S=Wt({},Pd,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),LS=tr($S),DS=[9,13,27,32],Xp=hs&&"CompositionEvent"in window,Ga=null;hs&&"documentMode"in document&&(Ga=document.documentMode);var IS=hs&&"TextEvent"in window&&!Ga,Dv=hs&&(!Xp||Ga&&8<Ga&&11>=Ga),sg=" ",ig=!1;function Iv(t,e){switch(t){case"keyup":return DS.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zv(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var So=!1;function zS(t,e){switch(t){case"compositionend":return zv(e);case"keypress":return e.which!==32?null:(ig=!0,sg);case"textInput":return t=e.data,t===sg&&ig?null:t;default:return null}}function FS(t,e){if(So)return t==="compositionend"||!Xp&&Iv(t,e)?(t=Lv(),Pc=Vp=Ms=null,So=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Dv&&e.locale!=="ko"?null:e.data;default:return null}}var BS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function og(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!BS[t.type]:e==="textarea"}function Fv(t,e,n,r){yv(r),e=Yc(e,"onChange"),0<e.length&&(n=new Yp("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Va=null,ll=null;function HS(t){Kv(t,0)}function Rd(t){var e=Co(t);if(dv(e))return t}function US(t,e){if(t==="change")return e}var Bv=!1;if(hs){var vu;if(hs){var bu="oninput"in document;if(!bu){var ag=document.createElement("div");ag.setAttribute("oninput","return;"),bu=typeof ag.oninput=="function"}vu=bu}else vu=!1;Bv=vu&&(!document.documentMode||9<document.documentMode)}function lg(){Va&&(Va.detachEvent("onpropertychange",Hv),ll=Va=null)}function Hv(t){if(t.propertyName==="value"&&Rd(ll)){var e=[];Fv(e,ll,t,Bp(t)),wv(HS,e)}}function WS(t,e,n){t==="focusin"?(lg(),Va=e,ll=n,Va.attachEvent("onpropertychange",Hv)):t==="focusout"&&lg()}function GS(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Rd(ll)}function VS(t,e){if(t==="click")return Rd(e)}function YS(t,e){if(t==="input"||t==="change")return Rd(e)}function qS(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ar=typeof Object.is=="function"?Object.is:qS;function cl(t,e){if(Ar(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!uh.call(e,s)||!Ar(t[s],e[s]))return!1}return!0}function cg(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function dg(t,e){var n=cg(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=cg(n)}}function Uv(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Uv(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Wv(){for(var t=window,e=Fc();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Fc(t.document)}return e}function Zp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function XS(t){var e=Wv(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Uv(n.ownerDocument.documentElement,n)){if(r!==null&&Zp(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=dg(n,i);var a=dg(n,r);s&&a&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var ZS=hs&&"documentMode"in document&&11>=document.documentMode,ko=null,Ph=null,Ya=null,Rh=!1;function ug(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Rh||ko==null||ko!==Fc(r)||(r=ko,"selectionStart"in r&&Zp(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Ya&&cl(Ya,r)||(Ya=r,r=Yc(Ph,"onSelect"),0<r.length&&(e=new Yp("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=ko)))}function Jl(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var jo={animationend:Jl("Animation","AnimationEnd"),animationiteration:Jl("Animation","AnimationIteration"),animationstart:Jl("Animation","AnimationStart"),transitionend:Jl("Transition","TransitionEnd")},wu={},Gv={};hs&&(Gv=document.createElement("div").style,"AnimationEvent"in window||(delete jo.animationend.animation,delete jo.animationiteration.animation,delete jo.animationstart.animation),"TransitionEvent"in window||delete jo.transitionend.transition);function Od(t){if(wu[t])return wu[t];if(!jo[t])return t;var e=jo[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Gv)return wu[t]=e[n];return t}var Vv=Od("animationend"),Yv=Od("animationiteration"),qv=Od("animationstart"),Xv=Od("transitionend"),Zv=new Map,hg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Xs(t,e){Zv.set(t,e),Mi(e,[t])}for(var _u=0;_u<hg.length;_u++){var Su=hg[_u],KS=Su.toLowerCase(),JS=Su[0].toUpperCase()+Su.slice(1);Xs(KS,"on"+JS)}Xs(Vv,"onAnimationEnd");Xs(Yv,"onAnimationIteration");Xs(qv,"onAnimationStart");Xs("dblclick","onDoubleClick");Xs("focusin","onFocus");Xs("focusout","onBlur");Xs(Xv,"onTransitionEnd");Ho("onMouseEnter",["mouseout","mouseover"]);Ho("onMouseLeave",["mouseout","mouseover"]);Ho("onPointerEnter",["pointerout","pointerover"]);Ho("onPointerLeave",["pointerout","pointerover"]);Mi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Mi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Mi("onBeforeInput",["compositionend","keypress","textInput","paste"]);Mi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Mi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Mi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ia="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),QS=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ia));function pg(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,K2(r,e,void 0,t),t.currentTarget=null}function Kv(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var a=r.length-1;0<=a;a--){var l=r[a],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;pg(s,l,d),i=c}else for(a=0;a<r.length;a++){if(l=r[a],c=l.instance,d=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;pg(s,l,d),i=c}}}if(Hc)throw t=Ch,Hc=!1,Ch=null,t}function Mt(t,e){var n=e[Lh];n===void 0&&(n=e[Lh]=new Set);var r=t+"__bubble";n.has(r)||(Jv(e,t,2,!1),n.add(r))}function ku(t,e,n){var r=0;e&&(r|=4),Jv(n,t,r,e)}var Ql="_reactListening"+Math.random().toString(36).slice(2);function dl(t){if(!t[Ql]){t[Ql]=!0,iv.forEach(function(n){n!=="selectionchange"&&(QS.has(n)||ku(n,!1,t),ku(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Ql]||(e[Ql]=!0,ku("selectionchange",!1,e))}}function Jv(t,e,n,r){switch($v(e)){case 1:var s=pS;break;case 4:s=fS;break;default:s=Gp}n=s.bind(null,e,n,t),s=void 0,!jh||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function ju(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(a===4)for(a=r.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;a=a.return}for(;l!==null;){if(a=wi(l),a===null)return;if(c=a.tag,c===5||c===6){r=i=a;continue e}l=l.parentNode}}r=r.return}wv(function(){var d=i,u=Bp(n),p=[];e:{var h=Zv.get(t);if(h!==void 0){var f=Yp,m=t;switch(t){case"keypress":if(Rc(n)===0)break e;case"keydown":case"keyup":f=NS;break;case"focusin":m="focus",f=xu;break;case"focusout":m="blur",f=xu;break;case"beforeblur":case"afterblur":f=xu;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=tg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=yS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=OS;break;case Vv:case Yv:case qv:f=bS;break;case Xv:f=MS;break;case"scroll":f=mS;break;case"wheel":f=LS;break;case"copy":case"cut":case"paste":f=_S;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=rg}var g=(e&4)!==0,v=!g&&t==="scroll",y=g?h!==null?h+"Capture":null:h;g=[];for(var x=d,b;x!==null;){b=x;var w=b.stateNode;if(b.tag===5&&w!==null&&(b=w,y!==null&&(w=sl(x,y),w!=null&&g.push(ul(x,w,b)))),v)break;x=x.return}0<g.length&&(h=new f(h,m,null,n,u),p.push({event:h,listeners:g}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",h&&n!==Sh&&(m=n.relatedTarget||n.fromElement)&&(wi(m)||m[ps]))break e;if((f||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,f?(m=n.relatedTarget||n.toElement,f=d,m=m?wi(m):null,m!==null&&(v=$i(m),m!==v||m.tag!==5&&m.tag!==6)&&(m=null)):(f=null,m=d),f!==m)){if(g=tg,w="onMouseLeave",y="onMouseEnter",x="mouse",(t==="pointerout"||t==="pointerover")&&(g=rg,w="onPointerLeave",y="onPointerEnter",x="pointer"),v=f==null?h:Co(f),b=m==null?h:Co(m),h=new g(w,x+"leave",f,n,u),h.target=v,h.relatedTarget=b,w=null,wi(u)===d&&(g=new g(y,x+"enter",m,n,u),g.target=b,g.relatedTarget=v,w=g),v=w,f&&m)t:{for(g=f,y=m,x=0,b=g;b;b=Xi(b))x++;for(b=0,w=y;w;w=Xi(w))b++;for(;0<x-b;)g=Xi(g),x--;for(;0<b-x;)y=Xi(y),b--;for(;x--;){if(g===y||y!==null&&g===y.alternate)break t;g=Xi(g),y=Xi(y)}g=null}else g=null;f!==null&&fg(p,h,f,g,!1),m!==null&&v!==null&&fg(p,v,m,g,!0)}}e:{if(h=d?Co(d):window,f=h.nodeName&&h.nodeName.toLowerCase(),f==="select"||f==="input"&&h.type==="file")var S=US;else if(og(h))if(Bv)S=YS;else{S=GS;var _=WS}else(f=h.nodeName)&&f.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(S=VS);if(S&&(S=S(t,d))){Fv(p,S,n,u);break e}_&&_(t,h,d),t==="focusout"&&(_=h._wrapperState)&&_.controlled&&h.type==="number"&&xh(h,"number",h.value)}switch(_=d?Co(d):window,t){case"focusin":(og(_)||_.contentEditable==="true")&&(ko=_,Ph=d,Ya=null);break;case"focusout":Ya=Ph=ko=null;break;case"mousedown":Rh=!0;break;case"contextmenu":case"mouseup":case"dragend":Rh=!1,ug(p,n,u);break;case"selectionchange":if(ZS)break;case"keydown":case"keyup":ug(p,n,u)}var k;if(Xp)e:{switch(t){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else So?Iv(t,n)&&(E="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(E="onCompositionStart");E&&(Dv&&n.locale!=="ko"&&(So||E!=="onCompositionStart"?E==="onCompositionEnd"&&So&&(k=Lv()):(Ms=u,Vp="value"in Ms?Ms.value:Ms.textContent,So=!0)),_=Yc(d,E),0<_.length&&(E=new ng(E,t,null,n,u),p.push({event:E,listeners:_}),k?E.data=k:(k=zv(n),k!==null&&(E.data=k)))),(k=IS?zS(t,n):FS(t,n))&&(d=Yc(d,"onBeforeInput"),0<d.length&&(u=new ng("onBeforeInput","beforeinput",null,n,u),p.push({event:u,listeners:d}),u.data=k))}Kv(p,e)})}function ul(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Yc(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=sl(t,n),i!=null&&r.unshift(ul(t,i,s)),i=sl(t,e),i!=null&&r.push(ul(t,i,s))),t=t.return}return r}function Xi(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function fg(t,e,n,r,s){for(var i=e._reactName,a=[];n!==null&&n!==r;){var l=n,c=l.alternate,d=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&d!==null&&(l=d,s?(c=sl(n,i),c!=null&&a.unshift(ul(n,c,l))):s||(c=sl(n,i),c!=null&&a.push(ul(n,c,l)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var ek=/\r\n?/g,tk=/\u0000|\uFFFD/g;function mg(t){return(typeof t=="string"?t:""+t).replace(ek,`
`).replace(tk,"")}function ec(t,e,n){if(e=mg(e),mg(t)!==e&&n)throw Error(Pe(425))}function qc(){}var Oh=null,Ah=null;function Mh(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var $h=typeof setTimeout=="function"?setTimeout:void 0,nk=typeof clearTimeout=="function"?clearTimeout:void 0,gg=typeof Promise=="function"?Promise:void 0,rk=typeof queueMicrotask=="function"?queueMicrotask:typeof gg<"u"?function(t){return gg.resolve(null).then(t).catch(sk)}:$h;function sk(t){setTimeout(function(){throw t})}function Cu(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),al(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);al(e)}function Fs(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function yg(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var ea=Math.random().toString(36).slice(2),Ur="__reactFiber$"+ea,hl="__reactProps$"+ea,ps="__reactContainer$"+ea,Lh="__reactEvents$"+ea,ik="__reactListeners$"+ea,ok="__reactHandles$"+ea;function wi(t){var e=t[Ur];if(e)return e;for(var n=t.parentNode;n;){if(e=n[ps]||n[Ur]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=yg(t);t!==null;){if(n=t[Ur])return n;t=yg(t)}return e}t=n,n=t.parentNode}return null}function Nl(t){return t=t[Ur]||t[ps],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Co(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Pe(33))}function Ad(t){return t[hl]||null}var Dh=[],Eo=-1;function Zs(t){return{current:t}}function Dt(t){0>Eo||(t.current=Dh[Eo],Dh[Eo]=null,Eo--)}function Ot(t,e){Eo++,Dh[Eo]=t.current,t.current=e}var Vs={},kn=Zs(Vs),Dn=Zs(!1),Ti=Vs;function Uo(t,e){var n=t.type.contextTypes;if(!n)return Vs;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function In(t){return t=t.childContextTypes,t!=null}function Xc(){Dt(Dn),Dt(kn)}function xg(t,e,n){if(kn.current!==Vs)throw Error(Pe(168));Ot(kn,e),Ot(Dn,n)}function Qv(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(Pe(108,W2(t)||"Unknown",s));return Wt({},n,r)}function Zc(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Vs,Ti=kn.current,Ot(kn,t),Ot(Dn,Dn.current),!0}function vg(t,e,n){var r=t.stateNode;if(!r)throw Error(Pe(169));n?(t=Qv(t,e,Ti),r.__reactInternalMemoizedMergedChildContext=t,Dt(Dn),Dt(kn),Ot(kn,t)):Dt(Dn),Ot(Dn,n)}var ls=null,Md=!1,Eu=!1;function eb(t){ls===null?ls=[t]:ls.push(t)}function ak(t){Md=!0,eb(t)}function Ks(){if(!Eu&&ls!==null){Eu=!0;var t=0,e=jt;try{var n=ls;for(jt=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}ls=null,Md=!1}catch(s){throw ls!==null&&(ls=ls.slice(t+1)),jv(Hp,Ks),s}finally{jt=e,Eu=!1}}return null}var To=[],No=0,Kc=null,Jc=0,cr=[],dr=0,Ni=null,cs=1,ds="";function hi(t,e){To[No++]=Jc,To[No++]=Kc,Kc=t,Jc=e}function tb(t,e,n){cr[dr++]=cs,cr[dr++]=ds,cr[dr++]=Ni,Ni=t;var r=cs;t=ds;var s=32-Rr(r)-1;r&=~(1<<s),n+=1;var i=32-Rr(e)+s;if(30<i){var a=s-s%5;i=(r&(1<<a)-1).toString(32),r>>=a,s-=a,cs=1<<32-Rr(e)+s|n<<s|r,ds=i+t}else cs=1<<i|n<<s|r,ds=t}function Kp(t){t.return!==null&&(hi(t,1),tb(t,1,0))}function Jp(t){for(;t===Kc;)Kc=To[--No],To[No]=null,Jc=To[--No],To[No]=null;for(;t===Ni;)Ni=cr[--dr],cr[dr]=null,ds=cr[--dr],cr[dr]=null,cs=cr[--dr],cr[dr]=null}var Kn=null,qn=null,Ft=!1,Tr=null;function nb(t,e){var n=hr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function bg(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Kn=t,qn=Fs(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Kn=t,qn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Ni!==null?{id:cs,overflow:ds}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=hr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Kn=t,qn=null,!0):!1;default:return!1}}function Ih(t){return(t.mode&1)!==0&&(t.flags&128)===0}function zh(t){if(Ft){var e=qn;if(e){var n=e;if(!bg(t,e)){if(Ih(t))throw Error(Pe(418));e=Fs(n.nextSibling);var r=Kn;e&&bg(t,e)?nb(r,n):(t.flags=t.flags&-4097|2,Ft=!1,Kn=t)}}else{if(Ih(t))throw Error(Pe(418));t.flags=t.flags&-4097|2,Ft=!1,Kn=t}}}function wg(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Kn=t}function tc(t){if(t!==Kn)return!1;if(!Ft)return wg(t),Ft=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Mh(t.type,t.memoizedProps)),e&&(e=qn)){if(Ih(t))throw rb(),Error(Pe(418));for(;e;)nb(t,e),e=Fs(e.nextSibling)}if(wg(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Pe(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){qn=Fs(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}qn=null}}else qn=Kn?Fs(t.stateNode.nextSibling):null;return!0}function rb(){for(var t=qn;t;)t=Fs(t.nextSibling)}function Wo(){qn=Kn=null,Ft=!1}function Qp(t){Tr===null?Tr=[t]:Tr.push(t)}var lk=gs.ReactCurrentBatchConfig;function ka(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Pe(309));var r=n.stateNode}if(!r)throw Error(Pe(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var l=s.refs;a===null?delete l[i]:l[i]=a},e._stringRef=i,e)}if(typeof t!="string")throw Error(Pe(284));if(!n._owner)throw Error(Pe(290,t))}return t}function nc(t,e){throw t=Object.prototype.toString.call(e),Error(Pe(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function _g(t){var e=t._init;return e(t._payload)}function sb(t){function e(y,x){if(t){var b=y.deletions;b===null?(y.deletions=[x],y.flags|=16):b.push(x)}}function n(y,x){if(!t)return null;for(;x!==null;)e(y,x),x=x.sibling;return null}function r(y,x){for(y=new Map;x!==null;)x.key!==null?y.set(x.key,x):y.set(x.index,x),x=x.sibling;return y}function s(y,x){return y=Ws(y,x),y.index=0,y.sibling=null,y}function i(y,x,b){return y.index=b,t?(b=y.alternate,b!==null?(b=b.index,b<x?(y.flags|=2,x):b):(y.flags|=2,x)):(y.flags|=1048576,x)}function a(y){return t&&y.alternate===null&&(y.flags|=2),y}function l(y,x,b,w){return x===null||x.tag!==6?(x=Mu(b,y.mode,w),x.return=y,x):(x=s(x,b),x.return=y,x)}function c(y,x,b,w){var S=b.type;return S===_o?u(y,x,b.props.children,w,b.key):x!==null&&(x.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Cs&&_g(S)===x.type)?(w=s(x,b.props),w.ref=ka(y,x,b),w.return=y,w):(w=Ic(b.type,b.key,b.props,null,y.mode,w),w.ref=ka(y,x,b),w.return=y,w)}function d(y,x,b,w){return x===null||x.tag!==4||x.stateNode.containerInfo!==b.containerInfo||x.stateNode.implementation!==b.implementation?(x=$u(b,y.mode,w),x.return=y,x):(x=s(x,b.children||[]),x.return=y,x)}function u(y,x,b,w,S){return x===null||x.tag!==7?(x=Ci(b,y.mode,w,S),x.return=y,x):(x=s(x,b),x.return=y,x)}function p(y,x,b){if(typeof x=="string"&&x!==""||typeof x=="number")return x=Mu(""+x,y.mode,b),x.return=y,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Gl:return b=Ic(x.type,x.key,x.props,null,y.mode,b),b.ref=ka(y,null,x),b.return=y,b;case wo:return x=$u(x,y.mode,b),x.return=y,x;case Cs:var w=x._init;return p(y,w(x._payload),b)}if(La(x)||va(x))return x=Ci(x,y.mode,b,null),x.return=y,x;nc(y,x)}return null}function h(y,x,b,w){var S=x!==null?x.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return S!==null?null:l(y,x,""+b,w);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Gl:return b.key===S?c(y,x,b,w):null;case wo:return b.key===S?d(y,x,b,w):null;case Cs:return S=b._init,h(y,x,S(b._payload),w)}if(La(b)||va(b))return S!==null?null:u(y,x,b,w,null);nc(y,b)}return null}function f(y,x,b,w,S){if(typeof w=="string"&&w!==""||typeof w=="number")return y=y.get(b)||null,l(x,y,""+w,S);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Gl:return y=y.get(w.key===null?b:w.key)||null,c(x,y,w,S);case wo:return y=y.get(w.key===null?b:w.key)||null,d(x,y,w,S);case Cs:var _=w._init;return f(y,x,b,_(w._payload),S)}if(La(w)||va(w))return y=y.get(b)||null,u(x,y,w,S,null);nc(x,w)}return null}function m(y,x,b,w){for(var S=null,_=null,k=x,E=x=0,T=null;k!==null&&E<b.length;E++){k.index>E?(T=k,k=null):T=k.sibling;var O=h(y,k,b[E],w);if(O===null){k===null&&(k=T);break}t&&k&&O.alternate===null&&e(y,k),x=i(O,x,E),_===null?S=O:_.sibling=O,_=O,k=T}if(E===b.length)return n(y,k),Ft&&hi(y,E),S;if(k===null){for(;E<b.length;E++)k=p(y,b[E],w),k!==null&&(x=i(k,x,E),_===null?S=k:_.sibling=k,_=k);return Ft&&hi(y,E),S}for(k=r(y,k);E<b.length;E++)T=f(k,y,E,b[E],w),T!==null&&(t&&T.alternate!==null&&k.delete(T.key===null?E:T.key),x=i(T,x,E),_===null?S=T:_.sibling=T,_=T);return t&&k.forEach(function(q){return e(y,q)}),Ft&&hi(y,E),S}function g(y,x,b,w){var S=va(b);if(typeof S!="function")throw Error(Pe(150));if(b=S.call(b),b==null)throw Error(Pe(151));for(var _=S=null,k=x,E=x=0,T=null,O=b.next();k!==null&&!O.done;E++,O=b.next()){k.index>E?(T=k,k=null):T=k.sibling;var q=h(y,k,O.value,w);if(q===null){k===null&&(k=T);break}t&&k&&q.alternate===null&&e(y,k),x=i(q,x,E),_===null?S=q:_.sibling=q,_=q,k=T}if(O.done)return n(y,k),Ft&&hi(y,E),S;if(k===null){for(;!O.done;E++,O=b.next())O=p(y,O.value,w),O!==null&&(x=i(O,x,E),_===null?S=O:_.sibling=O,_=O);return Ft&&hi(y,E),S}for(k=r(y,k);!O.done;E++,O=b.next())O=f(k,y,E,O.value,w),O!==null&&(t&&O.alternate!==null&&k.delete(O.key===null?E:O.key),x=i(O,x,E),_===null?S=O:_.sibling=O,_=O);return t&&k.forEach(function(P){return e(y,P)}),Ft&&hi(y,E),S}function v(y,x,b,w){if(typeof b=="object"&&b!==null&&b.type===_o&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Gl:e:{for(var S=b.key,_=x;_!==null;){if(_.key===S){if(S=b.type,S===_o){if(_.tag===7){n(y,_.sibling),x=s(_,b.props.children),x.return=y,y=x;break e}}else if(_.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Cs&&_g(S)===_.type){n(y,_.sibling),x=s(_,b.props),x.ref=ka(y,_,b),x.return=y,y=x;break e}n(y,_);break}else e(y,_);_=_.sibling}b.type===_o?(x=Ci(b.props.children,y.mode,w,b.key),x.return=y,y=x):(w=Ic(b.type,b.key,b.props,null,y.mode,w),w.ref=ka(y,x,b),w.return=y,y=w)}return a(y);case wo:e:{for(_=b.key;x!==null;){if(x.key===_)if(x.tag===4&&x.stateNode.containerInfo===b.containerInfo&&x.stateNode.implementation===b.implementation){n(y,x.sibling),x=s(x,b.children||[]),x.return=y,y=x;break e}else{n(y,x);break}else e(y,x);x=x.sibling}x=$u(b,y.mode,w),x.return=y,y=x}return a(y);case Cs:return _=b._init,v(y,x,_(b._payload),w)}if(La(b))return m(y,x,b,w);if(va(b))return g(y,x,b,w);nc(y,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,x!==null&&x.tag===6?(n(y,x.sibling),x=s(x,b),x.return=y,y=x):(n(y,x),x=Mu(b,y.mode,w),x.return=y,y=x),a(y)):n(y,x)}return v}var Go=sb(!0),ib=sb(!1),Qc=Zs(null),ed=null,Po=null,ef=null;function tf(){ef=Po=ed=null}function nf(t){var e=Qc.current;Dt(Qc),t._currentValue=e}function Fh(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Io(t,e){ed=t,ef=Po=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Ln=!0),t.firstContext=null)}function fr(t){var e=t._currentValue;if(ef!==t)if(t={context:t,memoizedValue:e,next:null},Po===null){if(ed===null)throw Error(Pe(308));Po=t,ed.dependencies={lanes:0,firstContext:t}}else Po=Po.next=t;return e}var _i=null;function rf(t){_i===null?_i=[t]:_i.push(t)}function ob(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,rf(e)):(n.next=s.next,s.next=n),e.interleaved=n,fs(t,r)}function fs(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Es=!1;function sf(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ab(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function us(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Bs(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,wt&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,fs(t,n)}return s=r.interleaved,s===null?(e.next=e,rf(r)):(e.next=s.next,s.next=e),r.interleaved=e,fs(t,n)}function Oc(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Up(t,n)}}function Sg(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function td(t,e,n,r){var s=t.updateQueue;Es=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,d=c.next;c.next=null,a===null?i=d:a.next=d,a=c;var u=t.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==a&&(l===null?u.firstBaseUpdate=d:l.next=d,u.lastBaseUpdate=c))}if(i!==null){var p=s.baseState;a=0,u=d=c=null,l=i;do{var h=l.lane,f=l.eventTime;if((r&h)===h){u!==null&&(u=u.next={eventTime:f,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var m=t,g=l;switch(h=e,f=n,g.tag){case 1:if(m=g.payload,typeof m=="function"){p=m.call(f,p,h);break e}p=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=g.payload,h=typeof m=="function"?m.call(f,p,h):m,h==null)break e;p=Wt({},p,h);break e;case 2:Es=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,h=s.effects,h===null?s.effects=[l]:h.push(l))}else f={eventTime:f,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(d=u=f,c=p):u=u.next=f,a|=h;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;h=l,l=h.next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}while(!0);if(u===null&&(c=p),s.baseState=c,s.firstBaseUpdate=d,s.lastBaseUpdate=u,e=s.shared.interleaved,e!==null){s=e;do a|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Ri|=a,t.lanes=a,t.memoizedState=p}}function kg(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(Pe(191,s));s.call(r)}}}var Pl={},Vr=Zs(Pl),pl=Zs(Pl),fl=Zs(Pl);function Si(t){if(t===Pl)throw Error(Pe(174));return t}function of(t,e){switch(Ot(fl,e),Ot(pl,t),Ot(Vr,Pl),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:bh(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=bh(e,t)}Dt(Vr),Ot(Vr,e)}function Vo(){Dt(Vr),Dt(pl),Dt(fl)}function lb(t){Si(fl.current);var e=Si(Vr.current),n=bh(e,t.type);e!==n&&(Ot(pl,t),Ot(Vr,n))}function af(t){pl.current===t&&(Dt(Vr),Dt(pl))}var Ht=Zs(0);function nd(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Tu=[];function lf(){for(var t=0;t<Tu.length;t++)Tu[t]._workInProgressVersionPrimary=null;Tu.length=0}var Ac=gs.ReactCurrentDispatcher,Nu=gs.ReactCurrentBatchConfig,Pi=0,Ut=null,on=null,un=null,rd=!1,qa=!1,ml=0,ck=0;function bn(){throw Error(Pe(321))}function cf(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ar(t[n],e[n]))return!1;return!0}function df(t,e,n,r,s,i){if(Pi=i,Ut=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ac.current=t===null||t.memoizedState===null?pk:fk,t=n(r,s),qa){i=0;do{if(qa=!1,ml=0,25<=i)throw Error(Pe(301));i+=1,un=on=null,e.updateQueue=null,Ac.current=mk,t=n(r,s)}while(qa)}if(Ac.current=sd,e=on!==null&&on.next!==null,Pi=0,un=on=Ut=null,rd=!1,e)throw Error(Pe(300));return t}function uf(){var t=ml!==0;return ml=0,t}function Hr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return un===null?Ut.memoizedState=un=t:un=un.next=t,un}function mr(){if(on===null){var t=Ut.alternate;t=t!==null?t.memoizedState:null}else t=on.next;var e=un===null?Ut.memoizedState:un.next;if(e!==null)un=e,on=t;else{if(t===null)throw Error(Pe(310));on=t,t={memoizedState:on.memoizedState,baseState:on.baseState,baseQueue:on.baseQueue,queue:on.queue,next:null},un===null?Ut.memoizedState=un=t:un=un.next=t}return un}function gl(t,e){return typeof e=="function"?e(t):e}function Pu(t){var e=mr(),n=e.queue;if(n===null)throw Error(Pe(311));n.lastRenderedReducer=t;var r=on,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=a=null,c=null,d=i;do{var u=d.lane;if((Pi&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var p={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=p,a=r):c=c.next=p,Ut.lanes|=u,Ri|=u}d=d.next}while(d!==null&&d!==i);c===null?a=r:c.next=l,Ar(r,e.memoizedState)||(Ln=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,Ut.lanes|=i,Ri|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Ru(t){var e=mr(),n=e.queue;if(n===null)throw Error(Pe(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var a=s=s.next;do i=t(i,a.action),a=a.next;while(a!==s);Ar(i,e.memoizedState)||(Ln=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function cb(){}function db(t,e){var n=Ut,r=mr(),s=e(),i=!Ar(r.memoizedState,s);if(i&&(r.memoizedState=s,Ln=!0),r=r.queue,hf(pb.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||un!==null&&un.memoizedState.tag&1){if(n.flags|=2048,yl(9,hb.bind(null,n,r,s,e),void 0,null),hn===null)throw Error(Pe(349));Pi&30||ub(n,e,s)}return s}function ub(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Ut.updateQueue,e===null?(e={lastEffect:null,stores:null},Ut.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function hb(t,e,n,r){e.value=n,e.getSnapshot=r,fb(e)&&mb(t)}function pb(t,e,n){return n(function(){fb(e)&&mb(t)})}function fb(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ar(t,n)}catch{return!0}}function mb(t){var e=fs(t,1);e!==null&&Or(e,t,1,-1)}function jg(t){var e=Hr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:gl,lastRenderedState:t},e.queue=t,t=t.dispatch=hk.bind(null,Ut,t),[e.memoizedState,t]}function yl(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Ut.updateQueue,e===null?(e={lastEffect:null,stores:null},Ut.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function gb(){return mr().memoizedState}function Mc(t,e,n,r){var s=Hr();Ut.flags|=t,s.memoizedState=yl(1|e,n,void 0,r===void 0?null:r)}function $d(t,e,n,r){var s=mr();r=r===void 0?null:r;var i=void 0;if(on!==null){var a=on.memoizedState;if(i=a.destroy,r!==null&&cf(r,a.deps)){s.memoizedState=yl(e,n,i,r);return}}Ut.flags|=t,s.memoizedState=yl(1|e,n,i,r)}function Cg(t,e){return Mc(8390656,8,t,e)}function hf(t,e){return $d(2048,8,t,e)}function yb(t,e){return $d(4,2,t,e)}function xb(t,e){return $d(4,4,t,e)}function vb(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function bb(t,e,n){return n=n!=null?n.concat([t]):null,$d(4,4,vb.bind(null,e,t),n)}function pf(){}function wb(t,e){var n=mr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&cf(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function _b(t,e){var n=mr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&cf(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Sb(t,e,n){return Pi&21?(Ar(n,e)||(n=Tv(),Ut.lanes|=n,Ri|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Ln=!0),t.memoizedState=n)}function dk(t,e){var n=jt;jt=n!==0&&4>n?n:4,t(!0);var r=Nu.transition;Nu.transition={};try{t(!1),e()}finally{jt=n,Nu.transition=r}}function kb(){return mr().memoizedState}function uk(t,e,n){var r=Us(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},jb(t))Cb(e,n);else if(n=ob(t,e,n,r),n!==null){var s=Tn();Or(n,t,r,s),Eb(n,e,r)}}function hk(t,e,n){var r=Us(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(jb(t))Cb(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,l=i(a,n);if(s.hasEagerState=!0,s.eagerState=l,Ar(l,a)){var c=e.interleaved;c===null?(s.next=s,rf(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=ob(t,e,s,r),n!==null&&(s=Tn(),Or(n,t,r,s),Eb(n,e,r))}}function jb(t){var e=t.alternate;return t===Ut||e!==null&&e===Ut}function Cb(t,e){qa=rd=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Eb(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Up(t,n)}}var sd={readContext:fr,useCallback:bn,useContext:bn,useEffect:bn,useImperativeHandle:bn,useInsertionEffect:bn,useLayoutEffect:bn,useMemo:bn,useReducer:bn,useRef:bn,useState:bn,useDebugValue:bn,useDeferredValue:bn,useTransition:bn,useMutableSource:bn,useSyncExternalStore:bn,useId:bn,unstable_isNewReconciler:!1},pk={readContext:fr,useCallback:function(t,e){return Hr().memoizedState=[t,e===void 0?null:e],t},useContext:fr,useEffect:Cg,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Mc(4194308,4,vb.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Mc(4194308,4,t,e)},useInsertionEffect:function(t,e){return Mc(4,2,t,e)},useMemo:function(t,e){var n=Hr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Hr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=uk.bind(null,Ut,t),[r.memoizedState,t]},useRef:function(t){var e=Hr();return t={current:t},e.memoizedState=t},useState:jg,useDebugValue:pf,useDeferredValue:function(t){return Hr().memoizedState=t},useTransition:function(){var t=jg(!1),e=t[0];return t=dk.bind(null,t[1]),Hr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Ut,s=Hr();if(Ft){if(n===void 0)throw Error(Pe(407));n=n()}else{if(n=e(),hn===null)throw Error(Pe(349));Pi&30||ub(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,Cg(pb.bind(null,r,i,t),[t]),r.flags|=2048,yl(9,hb.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Hr(),e=hn.identifierPrefix;if(Ft){var n=ds,r=cs;n=(r&~(1<<32-Rr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=ml++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=ck++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},fk={readContext:fr,useCallback:wb,useContext:fr,useEffect:hf,useImperativeHandle:bb,useInsertionEffect:yb,useLayoutEffect:xb,useMemo:_b,useReducer:Pu,useRef:gb,useState:function(){return Pu(gl)},useDebugValue:pf,useDeferredValue:function(t){var e=mr();return Sb(e,on.memoizedState,t)},useTransition:function(){var t=Pu(gl)[0],e=mr().memoizedState;return[t,e]},useMutableSource:cb,useSyncExternalStore:db,useId:kb,unstable_isNewReconciler:!1},mk={readContext:fr,useCallback:wb,useContext:fr,useEffect:hf,useImperativeHandle:bb,useInsertionEffect:yb,useLayoutEffect:xb,useMemo:_b,useReducer:Ru,useRef:gb,useState:function(){return Ru(gl)},useDebugValue:pf,useDeferredValue:function(t){var e=mr();return on===null?e.memoizedState=t:Sb(e,on.memoizedState,t)},useTransition:function(){var t=Ru(gl)[0],e=mr().memoizedState;return[t,e]},useMutableSource:cb,useSyncExternalStore:db,useId:kb,unstable_isNewReconciler:!1};function kr(t,e){if(t&&t.defaultProps){e=Wt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Bh(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Wt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Ld={isMounted:function(t){return(t=t._reactInternals)?$i(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Tn(),s=Us(t),i=us(r,s);i.payload=e,n!=null&&(i.callback=n),e=Bs(t,i,s),e!==null&&(Or(e,t,s,r),Oc(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Tn(),s=Us(t),i=us(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Bs(t,i,s),e!==null&&(Or(e,t,s,r),Oc(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Tn(),r=Us(t),s=us(n,r);s.tag=2,e!=null&&(s.callback=e),e=Bs(t,s,r),e!==null&&(Or(e,t,r,n),Oc(e,t,r))}};function Eg(t,e,n,r,s,i,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,a):e.prototype&&e.prototype.isPureReactComponent?!cl(n,r)||!cl(s,i):!0}function Tb(t,e,n){var r=!1,s=Vs,i=e.contextType;return typeof i=="object"&&i!==null?i=fr(i):(s=In(e)?Ti:kn.current,r=e.contextTypes,i=(r=r!=null)?Uo(t,s):Vs),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Ld,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function Tg(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Ld.enqueueReplaceState(e,e.state,null)}function Hh(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},sf(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=fr(i):(i=In(e)?Ti:kn.current,s.context=Uo(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Bh(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Ld.enqueueReplaceState(s,s.state,null),td(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Yo(t,e){try{var n="",r=e;do n+=U2(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Ou(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Uh(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var gk=typeof WeakMap=="function"?WeakMap:Map;function Nb(t,e,n){n=us(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){od||(od=!0,Qh=r),Uh(t,e)},n}function Pb(t,e,n){n=us(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Uh(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Uh(t,e),typeof r!="function"&&(Hs===null?Hs=new Set([this]):Hs.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function Ng(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new gk;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=Pk.bind(null,t,e,n),e.then(t,t))}function Pg(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Rg(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=us(-1,1),e.tag=2,Bs(n,e,1))),n.lanes|=1),t)}var yk=gs.ReactCurrentOwner,Ln=!1;function Cn(t,e,n,r){e.child=t===null?ib(e,null,n,r):Go(e,t.child,n,r)}function Og(t,e,n,r,s){n=n.render;var i=e.ref;return Io(e,s),r=df(t,e,n,r,i,s),n=uf(),t!==null&&!Ln?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,ms(t,e,s)):(Ft&&n&&Kp(e),e.flags|=1,Cn(t,e,r,s),e.child)}function Ag(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!wf(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,Rb(t,e,i,r,s)):(t=Ic(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:cl,n(a,r)&&t.ref===e.ref)return ms(t,e,s)}return e.flags|=1,t=Ws(i,r),t.ref=e.ref,t.return=e,e.child=t}function Rb(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(cl(i,r)&&t.ref===e.ref)if(Ln=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Ln=!0);else return e.lanes=t.lanes,ms(t,e,s)}return Wh(t,e,n,r,s)}function Ob(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ot(Oo,Gn),Gn|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ot(Oo,Gn),Gn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Ot(Oo,Gn),Gn|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Ot(Oo,Gn),Gn|=r;return Cn(t,e,s,n),e.child}function Ab(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Wh(t,e,n,r,s){var i=In(n)?Ti:kn.current;return i=Uo(e,i),Io(e,s),n=df(t,e,n,r,i,s),r=uf(),t!==null&&!Ln?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,ms(t,e,s)):(Ft&&r&&Kp(e),e.flags|=1,Cn(t,e,n,s),e.child)}function Mg(t,e,n,r,s){if(In(n)){var i=!0;Zc(e)}else i=!1;if(Io(e,s),e.stateNode===null)$c(t,e),Tb(e,n,r),Hh(e,n,r,s),r=!0;else if(t===null){var a=e.stateNode,l=e.memoizedProps;a.props=l;var c=a.context,d=n.contextType;typeof d=="object"&&d!==null?d=fr(d):(d=In(n)?Ti:kn.current,d=Uo(e,d));var u=n.getDerivedStateFromProps,p=typeof u=="function"||typeof a.getSnapshotBeforeUpdate=="function";p||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==r||c!==d)&&Tg(e,a,r,d),Es=!1;var h=e.memoizedState;a.state=h,td(e,r,a,s),c=e.memoizedState,l!==r||h!==c||Dn.current||Es?(typeof u=="function"&&(Bh(e,n,u,r),c=e.memoizedState),(l=Es||Eg(e,n,l,r,h,c,d))?(p||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),a.props=r,a.state=c,a.context=d,r=l):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,ab(t,e),l=e.memoizedProps,d=e.type===e.elementType?l:kr(e.type,l),a.props=d,p=e.pendingProps,h=a.context,c=n.contextType,typeof c=="object"&&c!==null?c=fr(c):(c=In(n)?Ti:kn.current,c=Uo(e,c));var f=n.getDerivedStateFromProps;(u=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==p||h!==c)&&Tg(e,a,r,c),Es=!1,h=e.memoizedState,a.state=h,td(e,r,a,s);var m=e.memoizedState;l!==p||h!==m||Dn.current||Es?(typeof f=="function"&&(Bh(e,n,f,r),m=e.memoizedState),(d=Es||Eg(e,n,d,r,h,m,c)||!1)?(u||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,m,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,m,c)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=m),a.props=r,a.state=m,a.context=c,r=d):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),r=!1)}return Gh(t,e,n,r,i,s)}function Gh(t,e,n,r,s,i){Ab(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return s&&vg(e,n,!1),ms(t,e,i);r=e.stateNode,yk.current=e;var l=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=Go(e,t.child,null,i),e.child=Go(e,null,l,i)):Cn(t,e,l,i),e.memoizedState=r.state,s&&vg(e,n,!0),e.child}function Mb(t){var e=t.stateNode;e.pendingContext?xg(t,e.pendingContext,e.pendingContext!==e.context):e.context&&xg(t,e.context,!1),of(t,e.containerInfo)}function $g(t,e,n,r,s){return Wo(),Qp(s),e.flags|=256,Cn(t,e,n,r),e.child}var Vh={dehydrated:null,treeContext:null,retryLane:0};function Yh(t){return{baseLanes:t,cachePool:null,transitions:null}}function $b(t,e,n){var r=e.pendingProps,s=Ht.current,i=!1,a=(e.flags&128)!==0,l;if((l=a)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Ot(Ht,s&1),t===null)return zh(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,i?(r=e.mode,i=e.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=zd(a,r,0,null),t=Ci(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Yh(n),e.memoizedState=Vh,t):ff(e,a));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return xk(t,e,a,r,l,s,n);if(i){i=r.fallback,a=e.mode,s=t.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(a&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=Ws(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Ws(l,i):(i=Ci(i,a,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,a=t.child.memoizedState,a=a===null?Yh(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=t.childLanes&~n,e.memoizedState=Vh,r}return i=t.child,t=i.sibling,r=Ws(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function ff(t,e){return e=zd({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function rc(t,e,n,r){return r!==null&&Qp(r),Go(e,t.child,null,n),t=ff(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function xk(t,e,n,r,s,i,a){if(n)return e.flags&256?(e.flags&=-257,r=Ou(Error(Pe(422))),rc(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=zd({mode:"visible",children:r.children},s,0,null),i=Ci(i,s,a,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Go(e,t.child,null,a),e.child.memoizedState=Yh(a),e.memoizedState=Vh,i);if(!(e.mode&1))return rc(t,e,a,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(Pe(419)),r=Ou(i,r,void 0),rc(t,e,a,r)}if(l=(a&t.childLanes)!==0,Ln||l){if(r=hn,r!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,fs(t,s),Or(r,t,s,-1))}return bf(),r=Ou(Error(Pe(421))),rc(t,e,a,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=Rk.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,qn=Fs(s.nextSibling),Kn=e,Ft=!0,Tr=null,t!==null&&(cr[dr++]=cs,cr[dr++]=ds,cr[dr++]=Ni,cs=t.id,ds=t.overflow,Ni=e),e=ff(e,r.children),e.flags|=4096,e)}function Lg(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Fh(t.return,e,n)}function Au(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function Lb(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Cn(t,e,r.children,n),r=Ht.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Lg(t,n,e);else if(t.tag===19)Lg(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ot(Ht,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&nd(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Au(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&nd(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Au(e,!0,n,null,i);break;case"together":Au(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function $c(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ms(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Ri|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Pe(153));if(e.child!==null){for(t=e.child,n=Ws(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ws(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function vk(t,e,n){switch(e.tag){case 3:Mb(e),Wo();break;case 5:lb(e);break;case 1:In(e.type)&&Zc(e);break;case 4:of(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Ot(Qc,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ot(Ht,Ht.current&1),e.flags|=128,null):n&e.child.childLanes?$b(t,e,n):(Ot(Ht,Ht.current&1),t=ms(t,e,n),t!==null?t.sibling:null);Ot(Ht,Ht.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Lb(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ot(Ht,Ht.current),r)break;return null;case 22:case 23:return e.lanes=0,Ob(t,e,n)}return ms(t,e,n)}var Db,qh,Ib,zb;Db=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};qh=function(){};Ib=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Si(Vr.current);var i=null;switch(n){case"input":s=gh(t,s),r=gh(t,r),i=[];break;case"select":s=Wt({},s,{value:void 0}),r=Wt({},r,{value:void 0}),i=[];break;case"textarea":s=vh(t,s),r=vh(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=qc)}wh(n,r);var a;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var l=s[d];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(nl.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var c=r[d];if(l=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(i||(i=[]),i.push(d,n)),n=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(nl.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Mt("scroll",t),i||l===c||(i=[])):(i=i||[]).push(d,c))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};zb=function(t,e,n,r){n!==r&&(e.flags|=4)};function ja(t,e){if(!Ft)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function wn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function bk(t,e,n){var r=e.pendingProps;switch(Jp(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return wn(e),null;case 1:return In(e.type)&&Xc(),wn(e),null;case 3:return r=e.stateNode,Vo(),Dt(Dn),Dt(kn),lf(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(tc(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Tr!==null&&(np(Tr),Tr=null))),qh(t,e),wn(e),null;case 5:af(e);var s=Si(fl.current);if(n=e.type,t!==null&&e.stateNode!=null)Ib(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Pe(166));return wn(e),null}if(t=Si(Vr.current),tc(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Ur]=e,r[hl]=i,t=(e.mode&1)!==0,n){case"dialog":Mt("cancel",r),Mt("close",r);break;case"iframe":case"object":case"embed":Mt("load",r);break;case"video":case"audio":for(s=0;s<Ia.length;s++)Mt(Ia[s],r);break;case"source":Mt("error",r);break;case"img":case"image":case"link":Mt("error",r),Mt("load",r);break;case"details":Mt("toggle",r);break;case"input":Gm(r,i),Mt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Mt("invalid",r);break;case"textarea":Ym(r,i),Mt("invalid",r)}wh(n,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var l=i[a];a==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&ec(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&ec(r.textContent,l,t),s=["children",""+l]):nl.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&Mt("scroll",r)}switch(n){case"input":Vl(r),Vm(r,i,!0);break;case"textarea":Vl(r),qm(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=qc)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=pv(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[Ur]=e,t[hl]=r,Db(t,e,!1,!1),e.stateNode=t;e:{switch(a=_h(n,r),n){case"dialog":Mt("cancel",t),Mt("close",t),s=r;break;case"iframe":case"object":case"embed":Mt("load",t),s=r;break;case"video":case"audio":for(s=0;s<Ia.length;s++)Mt(Ia[s],t);s=r;break;case"source":Mt("error",t),s=r;break;case"img":case"image":case"link":Mt("error",t),Mt("load",t),s=r;break;case"details":Mt("toggle",t),s=r;break;case"input":Gm(t,r),s=gh(t,r),Mt("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Wt({},r,{value:void 0}),Mt("invalid",t);break;case"textarea":Ym(t,r),s=vh(t,r),Mt("invalid",t);break;default:s=r}wh(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?gv(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&fv(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&rl(t,c):typeof c=="number"&&rl(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(nl.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Mt("scroll",t):c!=null&&Dp(t,i,c,a))}switch(n){case"input":Vl(t),Vm(t,r,!1);break;case"textarea":Vl(t),qm(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Gs(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Mo(t,!!r.multiple,i,!1):r.defaultValue!=null&&Mo(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=qc)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return wn(e),null;case 6:if(t&&e.stateNode!=null)zb(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Pe(166));if(n=Si(fl.current),Si(Vr.current),tc(e)){if(r=e.stateNode,n=e.memoizedProps,r[Ur]=e,(i=r.nodeValue!==n)&&(t=Kn,t!==null))switch(t.tag){case 3:ec(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&ec(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Ur]=e,e.stateNode=r}return wn(e),null;case 13:if(Dt(Ht),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ft&&qn!==null&&e.mode&1&&!(e.flags&128))rb(),Wo(),e.flags|=98560,i=!1;else if(i=tc(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(Pe(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Pe(317));i[Ur]=e}else Wo(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;wn(e),i=!1}else Tr!==null&&(np(Tr),Tr=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Ht.current&1?ln===0&&(ln=3):bf())),e.updateQueue!==null&&(e.flags|=4),wn(e),null);case 4:return Vo(),qh(t,e),t===null&&dl(e.stateNode.containerInfo),wn(e),null;case 10:return nf(e.type._context),wn(e),null;case 17:return In(e.type)&&Xc(),wn(e),null;case 19:if(Dt(Ht),i=e.memoizedState,i===null)return wn(e),null;if(r=(e.flags&128)!==0,a=i.rendering,a===null)if(r)ja(i,!1);else{if(ln!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=nd(t),a!==null){for(e.flags|=128,ja(i,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,t=a.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ot(Ht,Ht.current&1|2),e.child}t=t.sibling}i.tail!==null&&Jt()>qo&&(e.flags|=128,r=!0,ja(i,!1),e.lanes=4194304)}else{if(!r)if(t=nd(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),ja(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!Ft)return wn(e),null}else 2*Jt()-i.renderingStartTime>qo&&n!==1073741824&&(e.flags|=128,r=!0,ja(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(n=i.last,n!==null?n.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Jt(),e.sibling=null,n=Ht.current,Ot(Ht,r?n&1|2:n&1),e):(wn(e),null);case 22:case 23:return vf(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Gn&1073741824&&(wn(e),e.subtreeFlags&6&&(e.flags|=8192)):wn(e),null;case 24:return null;case 25:return null}throw Error(Pe(156,e.tag))}function wk(t,e){switch(Jp(e),e.tag){case 1:return In(e.type)&&Xc(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Vo(),Dt(Dn),Dt(kn),lf(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return af(e),null;case 13:if(Dt(Ht),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Pe(340));Wo()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Dt(Ht),null;case 4:return Vo(),null;case 10:return nf(e.type._context),null;case 22:case 23:return vf(),null;case 24:return null;default:return null}}var sc=!1,Sn=!1,_k=typeof WeakSet=="function"?WeakSet:Set,Be=null;function Ro(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){qt(t,e,r)}else n.current=null}function Xh(t,e,n){try{n()}catch(r){qt(t,e,r)}}var Dg=!1;function Sk(t,e){if(Oh=Gc,t=Wv(),Zp(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,l=-1,c=-1,d=0,u=0,p=t,h=null;t:for(;;){for(var f;p!==n||s!==0&&p.nodeType!==3||(l=a+s),p!==i||r!==0&&p.nodeType!==3||(c=a+r),p.nodeType===3&&(a+=p.nodeValue.length),(f=p.firstChild)!==null;)h=p,p=f;for(;;){if(p===t)break t;if(h===n&&++d===s&&(l=a),h===i&&++u===r&&(c=a),(f=p.nextSibling)!==null)break;p=h,h=p.parentNode}p=f}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Ah={focusedElem:t,selectionRange:n},Gc=!1,Be=e;Be!==null;)if(e=Be,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Be=t;else for(;Be!==null;){e=Be;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var g=m.memoizedProps,v=m.memoizedState,y=e.stateNode,x=y.getSnapshotBeforeUpdate(e.elementType===e.type?g:kr(e.type,g),v);y.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Pe(163))}}catch(w){qt(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,Be=t;break}Be=e.return}return m=Dg,Dg=!1,m}function Xa(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Xh(e,n,i)}s=s.next}while(s!==r)}}function Dd(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Zh(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Fb(t){var e=t.alternate;e!==null&&(t.alternate=null,Fb(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ur],delete e[hl],delete e[Lh],delete e[ik],delete e[ok])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Bb(t){return t.tag===5||t.tag===3||t.tag===4}function Ig(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Bb(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Kh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=qc));else if(r!==4&&(t=t.child,t!==null))for(Kh(t,e,n),t=t.sibling;t!==null;)Kh(t,e,n),t=t.sibling}function Jh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Jh(t,e,n),t=t.sibling;t!==null;)Jh(t,e,n),t=t.sibling}var gn=null,Cr=!1;function ks(t,e,n){for(n=n.child;n!==null;)Hb(t,e,n),n=n.sibling}function Hb(t,e,n){if(Gr&&typeof Gr.onCommitFiberUnmount=="function")try{Gr.onCommitFiberUnmount(Nd,n)}catch{}switch(n.tag){case 5:Sn||Ro(n,e);case 6:var r=gn,s=Cr;gn=null,ks(t,e,n),gn=r,Cr=s,gn!==null&&(Cr?(t=gn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):gn.removeChild(n.stateNode));break;case 18:gn!==null&&(Cr?(t=gn,n=n.stateNode,t.nodeType===8?Cu(t.parentNode,n):t.nodeType===1&&Cu(t,n),al(t)):Cu(gn,n.stateNode));break;case 4:r=gn,s=Cr,gn=n.stateNode.containerInfo,Cr=!0,ks(t,e,n),gn=r,Cr=s;break;case 0:case 11:case 14:case 15:if(!Sn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&Xh(n,e,a),s=s.next}while(s!==r)}ks(t,e,n);break;case 1:if(!Sn&&(Ro(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){qt(n,e,l)}ks(t,e,n);break;case 21:ks(t,e,n);break;case 22:n.mode&1?(Sn=(r=Sn)||n.memoizedState!==null,ks(t,e,n),Sn=r):ks(t,e,n);break;default:ks(t,e,n)}}function zg(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new _k),e.forEach(function(r){var s=Ok.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function br(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,a=e,l=a;e:for(;l!==null;){switch(l.tag){case 5:gn=l.stateNode,Cr=!1;break e;case 3:gn=l.stateNode.containerInfo,Cr=!0;break e;case 4:gn=l.stateNode.containerInfo,Cr=!0;break e}l=l.return}if(gn===null)throw Error(Pe(160));Hb(i,a,s),gn=null,Cr=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(d){qt(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Ub(e,t),e=e.sibling}function Ub(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(br(e,t),Fr(t),r&4){try{Xa(3,t,t.return),Dd(3,t)}catch(g){qt(t,t.return,g)}try{Xa(5,t,t.return)}catch(g){qt(t,t.return,g)}}break;case 1:br(e,t),Fr(t),r&512&&n!==null&&Ro(n,n.return);break;case 5:if(br(e,t),Fr(t),r&512&&n!==null&&Ro(n,n.return),t.flags&32){var s=t.stateNode;try{rl(s,"")}catch(g){qt(t,t.return,g)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,a=n!==null?n.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&uv(s,i),_h(l,a);var d=_h(l,i);for(a=0;a<c.length;a+=2){var u=c[a],p=c[a+1];u==="style"?gv(s,p):u==="dangerouslySetInnerHTML"?fv(s,p):u==="children"?rl(s,p):Dp(s,u,p,d)}switch(l){case"input":yh(s,i);break;case"textarea":hv(s,i);break;case"select":var h=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var f=i.value;f!=null?Mo(s,!!i.multiple,f,!1):h!==!!i.multiple&&(i.defaultValue!=null?Mo(s,!!i.multiple,i.defaultValue,!0):Mo(s,!!i.multiple,i.multiple?[]:"",!1))}s[hl]=i}catch(g){qt(t,t.return,g)}}break;case 6:if(br(e,t),Fr(t),r&4){if(t.stateNode===null)throw Error(Pe(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(g){qt(t,t.return,g)}}break;case 3:if(br(e,t),Fr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{al(e.containerInfo)}catch(g){qt(t,t.return,g)}break;case 4:br(e,t),Fr(t);break;case 13:br(e,t),Fr(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(yf=Jt())),r&4&&zg(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(Sn=(d=Sn)||u,br(e,t),Sn=d):br(e,t),Fr(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!u&&t.mode&1)for(Be=t,u=t.child;u!==null;){for(p=Be=u;Be!==null;){switch(h=Be,f=h.child,h.tag){case 0:case 11:case 14:case 15:Xa(4,h,h.return);break;case 1:Ro(h,h.return);var m=h.stateNode;if(typeof m.componentWillUnmount=="function"){r=h,n=h.return;try{e=r,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(g){qt(r,n,g)}}break;case 5:Ro(h,h.return);break;case 22:if(h.memoizedState!==null){Bg(p);continue}}f!==null?(f.return=h,Be=f):Bg(p)}u=u.sibling}e:for(u=null,p=t;;){if(p.tag===5){if(u===null){u=p;try{s=p.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=p.stateNode,c=p.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=mv("display",a))}catch(g){qt(t,t.return,g)}}}else if(p.tag===6){if(u===null)try{p.stateNode.nodeValue=d?"":p.memoizedProps}catch(g){qt(t,t.return,g)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;u===p&&(u=null),p=p.return}u===p&&(u=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:br(e,t),Fr(t),r&4&&zg(t);break;case 21:break;default:br(e,t),Fr(t)}}function Fr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Bb(n)){var r=n;break e}n=n.return}throw Error(Pe(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(rl(s,""),r.flags&=-33);var i=Ig(t);Jh(t,i,s);break;case 3:case 4:var a=r.stateNode.containerInfo,l=Ig(t);Kh(t,l,a);break;default:throw Error(Pe(161))}}catch(c){qt(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function kk(t,e,n){Be=t,Wb(t)}function Wb(t,e,n){for(var r=(t.mode&1)!==0;Be!==null;){var s=Be,i=s.child;if(s.tag===22&&r){var a=s.memoizedState!==null||sc;if(!a){var l=s.alternate,c=l!==null&&l.memoizedState!==null||Sn;l=sc;var d=Sn;if(sc=a,(Sn=c)&&!d)for(Be=s;Be!==null;)a=Be,c=a.child,a.tag===22&&a.memoizedState!==null?Hg(s):c!==null?(c.return=a,Be=c):Hg(s);for(;i!==null;)Be=i,Wb(i),i=i.sibling;Be=s,sc=l,Sn=d}Fg(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Be=i):Fg(t)}}function Fg(t){for(;Be!==null;){var e=Be;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Sn||Dd(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Sn)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:kr(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&kg(e,i,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}kg(e,a,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var p=u.dehydrated;p!==null&&al(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Pe(163))}Sn||e.flags&512&&Zh(e)}catch(h){qt(e,e.return,h)}}if(e===t){Be=null;break}if(n=e.sibling,n!==null){n.return=e.return,Be=n;break}Be=e.return}}function Bg(t){for(;Be!==null;){var e=Be;if(e===t){Be=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Be=n;break}Be=e.return}}function Hg(t){for(;Be!==null;){var e=Be;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Dd(4,e)}catch(c){qt(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){qt(e,s,c)}}var i=e.return;try{Zh(e)}catch(c){qt(e,i,c)}break;case 5:var a=e.return;try{Zh(e)}catch(c){qt(e,a,c)}}}catch(c){qt(e,e.return,c)}if(e===t){Be=null;break}var l=e.sibling;if(l!==null){l.return=e.return,Be=l;break}Be=e.return}}var jk=Math.ceil,id=gs.ReactCurrentDispatcher,mf=gs.ReactCurrentOwner,pr=gs.ReactCurrentBatchConfig,wt=0,hn=null,en=null,yn=0,Gn=0,Oo=Zs(0),ln=0,xl=null,Ri=0,Id=0,gf=0,Za=null,$n=null,yf=0,qo=1/0,os=null,od=!1,Qh=null,Hs=null,ic=!1,$s=null,ad=0,Ka=0,ep=null,Lc=-1,Dc=0;function Tn(){return wt&6?Jt():Lc!==-1?Lc:Lc=Jt()}function Us(t){return t.mode&1?wt&2&&yn!==0?yn&-yn:lk.transition!==null?(Dc===0&&(Dc=Tv()),Dc):(t=jt,t!==0||(t=window.event,t=t===void 0?16:$v(t.type)),t):1}function Or(t,e,n,r){if(50<Ka)throw Ka=0,ep=null,Error(Pe(185));El(t,n,r),(!(wt&2)||t!==hn)&&(t===hn&&(!(wt&2)&&(Id|=n),ln===4&&Ps(t,yn)),zn(t,r),n===1&&wt===0&&!(e.mode&1)&&(qo=Jt()+500,Md&&Ks()))}function zn(t,e){var n=t.callbackNode;lS(t,e);var r=Wc(t,t===hn?yn:0);if(r===0)n!==null&&Km(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Km(n),e===1)t.tag===0?ak(Ug.bind(null,t)):eb(Ug.bind(null,t)),rk(function(){!(wt&6)&&Ks()}),n=null;else{switch(Nv(r)){case 1:n=Hp;break;case 4:n=Cv;break;case 16:n=Uc;break;case 536870912:n=Ev;break;default:n=Uc}n=Jb(n,Gb.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Gb(t,e){if(Lc=-1,Dc=0,wt&6)throw Error(Pe(327));var n=t.callbackNode;if(zo()&&t.callbackNode!==n)return null;var r=Wc(t,t===hn?yn:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=ld(t,r);else{e=r;var s=wt;wt|=2;var i=Yb();(hn!==t||yn!==e)&&(os=null,qo=Jt()+500,ji(t,e));do try{Tk();break}catch(l){Vb(t,l)}while(!0);tf(),id.current=i,wt=s,en!==null?e=0:(hn=null,yn=0,e=ln)}if(e!==0){if(e===2&&(s=Eh(t),s!==0&&(r=s,e=tp(t,s))),e===1)throw n=xl,ji(t,0),Ps(t,r),zn(t,Jt()),n;if(e===6)Ps(t,r);else{if(s=t.current.alternate,!(r&30)&&!Ck(s)&&(e=ld(t,r),e===2&&(i=Eh(t),i!==0&&(r=i,e=tp(t,i))),e===1))throw n=xl,ji(t,0),Ps(t,r),zn(t,Jt()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(Pe(345));case 2:pi(t,$n,os);break;case 3:if(Ps(t,r),(r&130023424)===r&&(e=yf+500-Jt(),10<e)){if(Wc(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Tn(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=$h(pi.bind(null,t,$n,os),e);break}pi(t,$n,os);break;case 4:if(Ps(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var a=31-Rr(r);i=1<<a,a=e[a],a>s&&(s=a),r&=~i}if(r=s,r=Jt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*jk(r/1960))-r,10<r){t.timeoutHandle=$h(pi.bind(null,t,$n,os),r);break}pi(t,$n,os);break;case 5:pi(t,$n,os);break;default:throw Error(Pe(329))}}}return zn(t,Jt()),t.callbackNode===n?Gb.bind(null,t):null}function tp(t,e){var n=Za;return t.current.memoizedState.isDehydrated&&(ji(t,e).flags|=256),t=ld(t,e),t!==2&&(e=$n,$n=n,e!==null&&np(e)),t}function np(t){$n===null?$n=t:$n.push.apply($n,t)}function Ck(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Ar(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ps(t,e){for(e&=~gf,e&=~Id,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Rr(e),r=1<<n;t[n]=-1,e&=~r}}function Ug(t){if(wt&6)throw Error(Pe(327));zo();var e=Wc(t,0);if(!(e&1))return zn(t,Jt()),null;var n=ld(t,e);if(t.tag!==0&&n===2){var r=Eh(t);r!==0&&(e=r,n=tp(t,r))}if(n===1)throw n=xl,ji(t,0),Ps(t,e),zn(t,Jt()),n;if(n===6)throw Error(Pe(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,pi(t,$n,os),zn(t,Jt()),null}function xf(t,e){var n=wt;wt|=1;try{return t(e)}finally{wt=n,wt===0&&(qo=Jt()+500,Md&&Ks())}}function Oi(t){$s!==null&&$s.tag===0&&!(wt&6)&&zo();var e=wt;wt|=1;var n=pr.transition,r=jt;try{if(pr.transition=null,jt=1,t)return t()}finally{jt=r,pr.transition=n,wt=e,!(wt&6)&&Ks()}}function vf(){Gn=Oo.current,Dt(Oo)}function ji(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,nk(n)),en!==null)for(n=en.return;n!==null;){var r=n;switch(Jp(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Xc();break;case 3:Vo(),Dt(Dn),Dt(kn),lf();break;case 5:af(r);break;case 4:Vo();break;case 13:Dt(Ht);break;case 19:Dt(Ht);break;case 10:nf(r.type._context);break;case 22:case 23:vf()}n=n.return}if(hn=t,en=t=Ws(t.current,null),yn=Gn=e,ln=0,xl=null,gf=Id=Ri=0,$n=Za=null,_i!==null){for(e=0;e<_i.length;e++)if(n=_i[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=s,r.next=a}n.pending=r}_i=null}return t}function Vb(t,e){do{var n=en;try{if(tf(),Ac.current=sd,rd){for(var r=Ut.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}rd=!1}if(Pi=0,un=on=Ut=null,qa=!1,ml=0,mf.current=null,n===null||n.return===null){ln=1,xl=e,en=null;break}e:{var i=t,a=n.return,l=n,c=e;if(e=yn,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=l,p=u.tag;if(!(u.mode&1)&&(p===0||p===11||p===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=Pg(a);if(f!==null){f.flags&=-257,Rg(f,a,l,i,e),f.mode&1&&Ng(i,d,e),e=f,c=d;var m=e.updateQueue;if(m===null){var g=new Set;g.add(c),e.updateQueue=g}else m.add(c);break e}else{if(!(e&1)){Ng(i,d,e),bf();break e}c=Error(Pe(426))}}else if(Ft&&l.mode&1){var v=Pg(a);if(v!==null){!(v.flags&65536)&&(v.flags|=256),Rg(v,a,l,i,e),Qp(Yo(c,l));break e}}i=c=Yo(c,l),ln!==4&&(ln=2),Za===null?Za=[i]:Za.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var y=Nb(i,c,e);Sg(i,y);break e;case 1:l=c;var x=i.type,b=i.stateNode;if(!(i.flags&128)&&(typeof x.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Hs===null||!Hs.has(b)))){i.flags|=65536,e&=-e,i.lanes|=e;var w=Pb(i,l,e);Sg(i,w);break e}}i=i.return}while(i!==null)}Xb(n)}catch(S){e=S,en===n&&n!==null&&(en=n=n.return);continue}break}while(!0)}function Yb(){var t=id.current;return id.current=sd,t===null?sd:t}function bf(){(ln===0||ln===3||ln===2)&&(ln=4),hn===null||!(Ri&268435455)&&!(Id&268435455)||Ps(hn,yn)}function ld(t,e){var n=wt;wt|=2;var r=Yb();(hn!==t||yn!==e)&&(os=null,ji(t,e));do try{Ek();break}catch(s){Vb(t,s)}while(!0);if(tf(),wt=n,id.current=r,en!==null)throw Error(Pe(261));return hn=null,yn=0,ln}function Ek(){for(;en!==null;)qb(en)}function Tk(){for(;en!==null&&!Q2();)qb(en)}function qb(t){var e=Kb(t.alternate,t,Gn);t.memoizedProps=t.pendingProps,e===null?Xb(t):en=e,mf.current=null}function Xb(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=wk(n,e),n!==null){n.flags&=32767,en=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ln=6,en=null;return}}else if(n=bk(n,e,Gn),n!==null){en=n;return}if(e=e.sibling,e!==null){en=e;return}en=e=t}while(e!==null);ln===0&&(ln=5)}function pi(t,e,n){var r=jt,s=pr.transition;try{pr.transition=null,jt=1,Nk(t,e,n,r)}finally{pr.transition=s,jt=r}return null}function Nk(t,e,n,r){do zo();while($s!==null);if(wt&6)throw Error(Pe(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Pe(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(cS(t,i),t===hn&&(en=hn=null,yn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ic||(ic=!0,Jb(Uc,function(){return zo(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=pr.transition,pr.transition=null;var a=jt;jt=1;var l=wt;wt|=4,mf.current=null,Sk(t,n),Ub(n,t),XS(Ah),Gc=!!Oh,Ah=Oh=null,t.current=n,kk(n),eS(),wt=l,jt=a,pr.transition=i}else t.current=n;if(ic&&(ic=!1,$s=t,ad=s),i=t.pendingLanes,i===0&&(Hs=null),rS(n.stateNode),zn(t,Jt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(od)throw od=!1,t=Qh,Qh=null,t;return ad&1&&t.tag!==0&&zo(),i=t.pendingLanes,i&1?t===ep?Ka++:(Ka=0,ep=t):Ka=0,Ks(),null}function zo(){if($s!==null){var t=Nv(ad),e=pr.transition,n=jt;try{if(pr.transition=null,jt=16>t?16:t,$s===null)var r=!1;else{if(t=$s,$s=null,ad=0,wt&6)throw Error(Pe(331));var s=wt;for(wt|=4,Be=t.current;Be!==null;){var i=Be,a=i.child;if(Be.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(Be=d;Be!==null;){var u=Be;switch(u.tag){case 0:case 11:case 15:Xa(8,u,i)}var p=u.child;if(p!==null)p.return=u,Be=p;else for(;Be!==null;){u=Be;var h=u.sibling,f=u.return;if(Fb(u),u===d){Be=null;break}if(h!==null){h.return=f,Be=h;break}Be=f}}}var m=i.alternate;if(m!==null){var g=m.child;if(g!==null){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(g!==null)}}Be=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,Be=a;else e:for(;Be!==null;){if(i=Be,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Xa(9,i,i.return)}var y=i.sibling;if(y!==null){y.return=i.return,Be=y;break e}Be=i.return}}var x=t.current;for(Be=x;Be!==null;){a=Be;var b=a.child;if(a.subtreeFlags&2064&&b!==null)b.return=a,Be=b;else e:for(a=x;Be!==null;){if(l=Be,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Dd(9,l)}}catch(S){qt(l,l.return,S)}if(l===a){Be=null;break e}var w=l.sibling;if(w!==null){w.return=l.return,Be=w;break e}Be=l.return}}if(wt=s,Ks(),Gr&&typeof Gr.onPostCommitFiberRoot=="function")try{Gr.onPostCommitFiberRoot(Nd,t)}catch{}r=!0}return r}finally{jt=n,pr.transition=e}}return!1}function Wg(t,e,n){e=Yo(n,e),e=Nb(t,e,1),t=Bs(t,e,1),e=Tn(),t!==null&&(El(t,1,e),zn(t,e))}function qt(t,e,n){if(t.tag===3)Wg(t,t,n);else for(;e!==null;){if(e.tag===3){Wg(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Hs===null||!Hs.has(r))){t=Yo(n,t),t=Pb(e,t,1),e=Bs(e,t,1),t=Tn(),e!==null&&(El(e,1,t),zn(e,t));break}}e=e.return}}function Pk(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Tn(),t.pingedLanes|=t.suspendedLanes&n,hn===t&&(yn&n)===n&&(ln===4||ln===3&&(yn&130023424)===yn&&500>Jt()-yf?ji(t,0):gf|=n),zn(t,e)}function Zb(t,e){e===0&&(t.mode&1?(e=Xl,Xl<<=1,!(Xl&130023424)&&(Xl=4194304)):e=1);var n=Tn();t=fs(t,e),t!==null&&(El(t,e,n),zn(t,n))}function Rk(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Zb(t,n)}function Ok(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(Pe(314))}r!==null&&r.delete(e),Zb(t,n)}var Kb;Kb=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Dn.current)Ln=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Ln=!1,vk(t,e,n);Ln=!!(t.flags&131072)}else Ln=!1,Ft&&e.flags&1048576&&tb(e,Jc,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;$c(t,e),t=e.pendingProps;var s=Uo(e,kn.current);Io(e,n),s=df(null,e,r,t,s,n);var i=uf();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,In(r)?(i=!0,Zc(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,sf(e),s.updater=Ld,e.stateNode=s,s._reactInternals=e,Hh(e,r,t,n),e=Gh(null,e,r,!0,i,n)):(e.tag=0,Ft&&i&&Kp(e),Cn(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch($c(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=Mk(r),t=kr(r,t),s){case 0:e=Wh(null,e,r,t,n);break e;case 1:e=Mg(null,e,r,t,n);break e;case 11:e=Og(null,e,r,t,n);break e;case 14:e=Ag(null,e,r,kr(r.type,t),n);break e}throw Error(Pe(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:kr(r,s),Wh(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:kr(r,s),Mg(t,e,r,s,n);case 3:e:{if(Mb(e),t===null)throw Error(Pe(387));r=e.pendingProps,i=e.memoizedState,s=i.element,ab(t,e),td(e,r,null,n);var a=e.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Yo(Error(Pe(423)),e),e=$g(t,e,r,n,s);break e}else if(r!==s){s=Yo(Error(Pe(424)),e),e=$g(t,e,r,n,s);break e}else for(qn=Fs(e.stateNode.containerInfo.firstChild),Kn=e,Ft=!0,Tr=null,n=ib(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Wo(),r===s){e=ms(t,e,n);break e}Cn(t,e,r,n)}e=e.child}return e;case 5:return lb(e),t===null&&zh(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,a=s.children,Mh(r,s)?a=null:i!==null&&Mh(r,i)&&(e.flags|=32),Ab(t,e),Cn(t,e,a,n),e.child;case 6:return t===null&&zh(e),null;case 13:return $b(t,e,n);case 4:return of(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Go(e,null,r,n):Cn(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:kr(r,s),Og(t,e,r,s,n);case 7:return Cn(t,e,e.pendingProps,n),e.child;case 8:return Cn(t,e,e.pendingProps.children,n),e.child;case 12:return Cn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,a=s.value,Ot(Qc,r._currentValue),r._currentValue=a,i!==null)if(Ar(i.value,a)){if(i.children===s.children&&!Dn.current){e=ms(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){a=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=us(-1,n&-n),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),Fh(i.return,n,e),l.lanes|=n;break}c=c.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(Pe(341));a.lanes|=n,l=a.alternate,l!==null&&(l.lanes|=n),Fh(a,n,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}Cn(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Io(e,n),s=fr(s),r=r(s),e.flags|=1,Cn(t,e,r,n),e.child;case 14:return r=e.type,s=kr(r,e.pendingProps),s=kr(r.type,s),Ag(t,e,r,s,n);case 15:return Rb(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:kr(r,s),$c(t,e),e.tag=1,In(r)?(t=!0,Zc(e)):t=!1,Io(e,n),Tb(e,r,s),Hh(e,r,s,n),Gh(null,e,r,!0,t,n);case 19:return Lb(t,e,n);case 22:return Ob(t,e,n)}throw Error(Pe(156,e.tag))};function Jb(t,e){return jv(t,e)}function Ak(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function hr(t,e,n,r){return new Ak(t,e,n,r)}function wf(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Mk(t){if(typeof t=="function")return wf(t)?1:0;if(t!=null){if(t=t.$$typeof,t===zp)return 11;if(t===Fp)return 14}return 2}function Ws(t,e){var n=t.alternate;return n===null?(n=hr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ic(t,e,n,r,s,i){var a=2;if(r=t,typeof t=="function")wf(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case _o:return Ci(n.children,s,i,e);case Ip:a=8,s|=8;break;case hh:return t=hr(12,n,e,s|2),t.elementType=hh,t.lanes=i,t;case ph:return t=hr(13,n,e,s),t.elementType=ph,t.lanes=i,t;case fh:return t=hr(19,n,e,s),t.elementType=fh,t.lanes=i,t;case lv:return zd(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case ov:a=10;break e;case av:a=9;break e;case zp:a=11;break e;case Fp:a=14;break e;case Cs:a=16,r=null;break e}throw Error(Pe(130,t==null?t:typeof t,""))}return e=hr(a,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Ci(t,e,n,r){return t=hr(7,t,r,e),t.lanes=n,t}function zd(t,e,n,r){return t=hr(22,t,r,e),t.elementType=lv,t.lanes=n,t.stateNode={isHidden:!1},t}function Mu(t,e,n){return t=hr(6,t,null,e),t.lanes=n,t}function $u(t,e,n){return e=hr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function $k(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mu(0),this.expirationTimes=mu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mu(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function _f(t,e,n,r,s,i,a,l,c){return t=new $k(t,e,n,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=hr(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},sf(i),t}function Lk(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wo,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function Qb(t){if(!t)return Vs;t=t._reactInternals;e:{if($i(t)!==t||t.tag!==1)throw Error(Pe(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(In(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Pe(171))}if(t.tag===1){var n=t.type;if(In(n))return Qv(t,n,e)}return e}function ew(t,e,n,r,s,i,a,l,c){return t=_f(n,r,!0,t,s,i,a,l,c),t.context=Qb(null),n=t.current,r=Tn(),s=Us(n),i=us(r,s),i.callback=e??null,Bs(n,i,s),t.current.lanes=s,El(t,s,r),zn(t,r),t}function Fd(t,e,n,r){var s=e.current,i=Tn(),a=Us(s);return n=Qb(n),e.context===null?e.context=n:e.pendingContext=n,e=us(i,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Bs(s,e,a),t!==null&&(Or(t,s,a,i),Oc(t,s,a)),a}function cd(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Gg(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Sf(t,e){Gg(t,e),(t=t.alternate)&&Gg(t,e)}function Dk(){return null}var tw=typeof reportError=="function"?reportError:function(t){console.error(t)};function kf(t){this._internalRoot=t}Bd.prototype.render=kf.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Pe(409));Fd(t,e,null,null)};Bd.prototype.unmount=kf.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Oi(function(){Fd(null,t,null,null)}),e[ps]=null}};function Bd(t){this._internalRoot=t}Bd.prototype.unstable_scheduleHydration=function(t){if(t){var e=Ov();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ns.length&&e!==0&&e<Ns[n].priority;n++);Ns.splice(n,0,t),n===0&&Mv(t)}};function jf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Hd(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Vg(){}function Ik(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=cd(a);i.call(d)}}var a=ew(e,r,t,0,null,!1,!1,"",Vg);return t._reactRootContainer=a,t[ps]=a.current,dl(t.nodeType===8?t.parentNode:t),Oi(),a}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var d=cd(c);l.call(d)}}var c=_f(t,0,!1,null,null,!1,!1,"",Vg);return t._reactRootContainer=c,t[ps]=c.current,dl(t.nodeType===8?t.parentNode:t),Oi(function(){Fd(e,c,n,r)}),c}function Ud(t,e,n,r,s){var i=n._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var l=s;s=function(){var c=cd(a);l.call(c)}}Fd(e,a,t,s)}else a=Ik(n,e,t,s,r);return cd(a)}Pv=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Da(e.pendingLanes);n!==0&&(Up(e,n|1),zn(e,Jt()),!(wt&6)&&(qo=Jt()+500,Ks()))}break;case 13:Oi(function(){var r=fs(t,1);if(r!==null){var s=Tn();Or(r,t,1,s)}}),Sf(t,1)}};Wp=function(t){if(t.tag===13){var e=fs(t,134217728);if(e!==null){var n=Tn();Or(e,t,134217728,n)}Sf(t,134217728)}};Rv=function(t){if(t.tag===13){var e=Us(t),n=fs(t,e);if(n!==null){var r=Tn();Or(n,t,e,r)}Sf(t,e)}};Ov=function(){return jt};Av=function(t,e){var n=jt;try{return jt=t,e()}finally{jt=n}};kh=function(t,e,n){switch(e){case"input":if(yh(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Ad(r);if(!s)throw Error(Pe(90));dv(r),yh(r,s)}}}break;case"textarea":hv(t,n);break;case"select":e=n.value,e!=null&&Mo(t,!!n.multiple,e,!1)}};vv=xf;bv=Oi;var zk={usingClientEntryPoint:!1,Events:[Nl,Co,Ad,yv,xv,xf]},Ca={findFiberByHostInstance:wi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Fk={bundleType:Ca.bundleType,version:Ca.version,rendererPackageName:Ca.rendererPackageName,rendererConfig:Ca.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:gs.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Sv(t),t===null?null:t.stateNode},findFiberByHostInstance:Ca.findFiberByHostInstance||Dk,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var oc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!oc.isDisabled&&oc.supportsFiber)try{Nd=oc.inject(Fk),Gr=oc}catch{}}er.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=zk;er.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!jf(e))throw Error(Pe(200));return Lk(t,e,null,n)};er.createRoot=function(t,e){if(!jf(t))throw Error(Pe(299));var n=!1,r="",s=tw;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=_f(t,1,!1,null,null,n,!1,r,s),t[ps]=e.current,dl(t.nodeType===8?t.parentNode:t),new kf(e)};er.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Pe(188)):(t=Object.keys(t).join(","),Error(Pe(268,t)));return t=Sv(e),t=t===null?null:t.stateNode,t};er.flushSync=function(t){return Oi(t)};er.hydrate=function(t,e,n){if(!Hd(e))throw Error(Pe(200));return Ud(null,t,e,!0,n)};er.hydrateRoot=function(t,e,n){if(!jf(t))throw Error(Pe(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",a=tw;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=ew(e,null,t,1,n??null,s,!1,i,a),t[ps]=e.current,dl(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Bd(e)};er.render=function(t,e,n){if(!Hd(e))throw Error(Pe(200));return Ud(null,t,e,!1,n)};er.unmountComponentAtNode=function(t){if(!Hd(t))throw Error(Pe(40));return t._reactRootContainer?(Oi(function(){Ud(null,null,t,!1,function(){t._reactRootContainer=null,t[ps]=null})}),!0):!1};er.unstable_batchedUpdates=xf;er.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Hd(n))throw Error(Pe(200));if(t==null||t._reactInternals===void 0)throw Error(Pe(38));return Ud(t,e,n,!1,r)};er.version="18.3.1-next-f1338f8080-20240426";function nw(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(nw)}catch(t){console.error(t)}}nw(),nv.exports=er;var Bk=nv.exports,Yg=Bk;dh.createRoot=Yg.createRoot,dh.hydrateRoot=Yg.hydrateRoot;var rp=function(t,e){return rp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])},rp(t,e)};function rw(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");rp(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var dd=function(){return dd=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},dd.apply(this,arguments)};function ta(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function sw(t,e,n,r){var s=arguments.length,i=s<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(a=t[l])&&(i=(s<3?a(i):s>3?a(e,n,i):a(e,n))||i);return s>3&&i&&Object.defineProperty(e,n,i),i}function iw(t,e){return function(n,r){e(n,r,t)}}function ow(t,e,n,r,s,i){function a(y){if(y!==void 0&&typeof y!="function")throw new TypeError("Function expected");return y}for(var l=r.kind,c=l==="getter"?"get":l==="setter"?"set":"value",d=!e&&t?r.static?t:t.prototype:null,u=e||(d?Object.getOwnPropertyDescriptor(d,r.name):{}),p,h=!1,f=n.length-1;f>=0;f--){var m={};for(var g in r)m[g]=g==="access"?{}:r[g];for(var g in r.access)m.access[g]=r.access[g];m.addInitializer=function(y){if(h)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(y||null))};var v=(0,n[f])(l==="accessor"?{get:u.get,set:u.set}:u[c],m);if(l==="accessor"){if(v===void 0)continue;if(v===null||typeof v!="object")throw new TypeError("Object expected");(p=a(v.get))&&(u.get=p),(p=a(v.set))&&(u.set=p),(p=a(v.init))&&s.unshift(p)}else(p=a(v))&&(l==="field"?s.unshift(p):u[c]=p)}d&&Object.defineProperty(d,r.name,u),h=!0}function aw(t,e,n){for(var r=arguments.length>2,s=0;s<e.length;s++)n=r?e[s].call(t,n):e[s].call(t);return r?n:void 0}function lw(t){return typeof t=="symbol"?t:"".concat(t)}function cw(t,e,n){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(t,"name",{configurable:!0,value:n?"".concat(n," ",e):e})}function dw(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Ve(t,e,n,r){function s(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function l(u){try{d(r.next(u))}catch(p){a(p)}}function c(u){try{d(r.throw(u))}catch(p){a(p)}}function d(u){u.done?i(u.value):s(u.value).then(l,c)}d((r=r.apply(t,e||[])).next())})}function uw(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,a=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return a.next=l(0),a.throw=l(1),a.return=l(2),typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function l(d){return function(u){return c([d,u])}}function c(d){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,d[0]&&(n=0)),n;)try{if(r=1,s&&(i=d[0]&2?s.return:d[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,d[1])).done)return i;switch(s=0,i&&(d=[d[0]&2,i.value]),d[0]){case 0:case 1:i=d;break;case 4:return n.label++,{value:d[1],done:!1};case 5:n.label++,s=d[1],d=[0];continue;case 7:d=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(d[0]===6||d[0]===2)){n=0;continue}if(d[0]===3&&(!i||d[1]>i[0]&&d[1]<i[3])){n.label=d[1];break}if(d[0]===6&&n.label<i[1]){n.label=i[1],i=d;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(d);break}i[2]&&n.ops.pop(),n.trys.pop();continue}d=e.call(t,n)}catch(u){d=[6,u],s=0}finally{r=i=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}var Wd=Object.create?function(t,e,n,r){r===void 0&&(r=n);var s=Object.getOwnPropertyDescriptor(e,n);(!s||("get"in s?!e.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,s)}:function(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]};function hw(t,e){for(var n in t)n!=="default"&&!Object.prototype.hasOwnProperty.call(e,n)&&Wd(e,t,n)}function ud(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Cf(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),s,i=[],a;try{for(;(e===void 0||e-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(l){a={error:l}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return i}function pw(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Cf(arguments[e]));return t}function fw(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),s=0,e=0;e<n;e++)for(var i=arguments[e],a=0,l=i.length;a<l;a++,s++)r[s]=i[a];return r}function mw(t,e,n){if(n||arguments.length===2)for(var r=0,s=e.length,i;r<s;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}function Xo(t){return this instanceof Xo?(this.v=t,this):new Xo(t)}function gw(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),s,i=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",a),s[Symbol.asyncIterator]=function(){return this},s;function a(f){return function(m){return Promise.resolve(m).then(f,p)}}function l(f,m){r[f]&&(s[f]=function(g){return new Promise(function(v,y){i.push([f,g,v,y])>1||c(f,g)})},m&&(s[f]=m(s[f])))}function c(f,m){try{d(r[f](m))}catch(g){h(i[0][3],g)}}function d(f){f.value instanceof Xo?Promise.resolve(f.value.v).then(u,p):h(i[0][2],f)}function u(f){c("next",f)}function p(f){c("throw",f)}function h(f,m){f(m),i.shift(),i.length&&c(i[0][0],i[0][1])}}function yw(t){var e,n;return e={},r("next"),r("throw",function(s){throw s}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(s,i){e[s]=t[s]?function(a){return(n=!n)?{value:Xo(t[s](a)),done:!1}:i?i(a):a}:i}}function xw(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof ud=="function"?ud(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(i){n[i]=t[i]&&function(a){return new Promise(function(l,c){a=t[i](a),s(l,c,a.done,a.value)})}}function s(i,a,l,c){Promise.resolve(c).then(function(d){i({value:d,done:l})},a)}}function vw(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}var Hk=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e},sp=function(t){return sp=Object.getOwnPropertyNames||function(e){var n=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[n.length]=r);return n},sp(t)};function bw(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n=sp(t),r=0;r<n.length;r++)n[r]!=="default"&&Wd(e,t,n[r]);return Hk(e,t),e}function ww(t){return t&&t.__esModule?t:{default:t}}function _w(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)}function Sw(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n}function kw(t,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof t=="function"?e===t:t.has(e)}function jw(t,e,n){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var r,s;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=e[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=e[Symbol.dispose],n&&(s=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");s&&(r=function(){try{s.call(this)}catch(i){return Promise.reject(i)}}),t.stack.push({value:e,dispose:r,async:n})}else n&&t.stack.push({async:!0});return e}var Uk=typeof SuppressedError=="function"?SuppressedError:function(t,e,n){var r=new Error(n);return r.name="SuppressedError",r.error=t,r.suppressed=e,r};function Cw(t){function e(i){t.error=t.hasError?new Uk(i,t.error,"An error was suppressed during disposal."):i,t.hasError=!0}var n,r=0;function s(){for(;n=t.stack.pop();)try{if(!n.async&&r===1)return r=0,t.stack.push(n),Promise.resolve().then(s);if(n.dispose){var i=n.dispose.call(n.value);if(n.async)return r|=2,Promise.resolve(i).then(s,function(a){return e(a),s()})}else r|=1}catch(a){e(a)}if(r===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return s()}function Ew(t,e){return typeof t=="string"&&/^\.\.?\//.test(t)?t.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(n,r,s,i,a){return r?e?".jsx":".js":s&&(!i||!a)?n:s+i+"."+a.toLowerCase()+"js"}):t}const Wk={__extends:rw,__assign:dd,__rest:ta,__decorate:sw,__param:iw,__esDecorate:ow,__runInitializers:aw,__propKey:lw,__setFunctionName:cw,__metadata:dw,__awaiter:Ve,__generator:uw,__createBinding:Wd,__exportStar:hw,__values:ud,__read:Cf,__spread:pw,__spreadArrays:fw,__spreadArray:mw,__await:Xo,__asyncGenerator:gw,__asyncDelegator:yw,__asyncValues:xw,__makeTemplateObject:vw,__importStar:bw,__importDefault:ww,__classPrivateFieldGet:_w,__classPrivateFieldSet:Sw,__classPrivateFieldIn:kw,__addDisposableResource:jw,__disposeResources:Cw,__rewriteRelativeImportExtension:Ew},Gk=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:jw,get __assign(){return dd},__asyncDelegator:yw,__asyncGenerator:gw,__asyncValues:xw,__await:Xo,__awaiter:Ve,__classPrivateFieldGet:_w,__classPrivateFieldIn:kw,__classPrivateFieldSet:Sw,__createBinding:Wd,__decorate:sw,__disposeResources:Cw,__esDecorate:ow,__exportStar:hw,__extends:rw,__generator:uw,__importDefault:ww,__importStar:bw,__makeTemplateObject:vw,__metadata:dw,__param:iw,__propKey:lw,__read:Cf,__rest:ta,__rewriteRelativeImportExtension:Ew,__runInitializers:aw,__setFunctionName:cw,__spread:pw,__spreadArray:mw,__spreadArrays:fw,__values:ud,default:Wk},Symbol.toStringTag,{value:"Module"})),Vk=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class Ef extends Error{constructor(e,n="FunctionsError",r){super(e),this.name=n,this.context=r}}class qg extends Ef{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Xg extends Ef{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Zg extends Ef{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var ip;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(ip||(ip={}));class Yk{constructor(e,{headers:n={},customFetch:r,region:s=ip.Any}={}){this.url=e,this.headers=n,this.region=s,this.fetch=Vk(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return Ve(this,arguments,void 0,function*(n,r={}){var s;try{const{headers:i,method:a,body:l,signal:c}=r;let d={},{region:u}=r;u||(u=this.region);const p=new URL(`${this.url}/${n}`);u&&u!=="any"&&(d["x-region"]=u,p.searchParams.set("forceFunctionRegion",u));let h;l&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)?typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(d["Content-Type"]="application/octet-stream",h=l):typeof l=="string"?(d["Content-Type"]="text/plain",h=l):typeof FormData<"u"&&l instanceof FormData?h=l:(d["Content-Type"]="application/json",h=JSON.stringify(l)):h=l;const f=yield this.fetch(p.toString(),{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},d),this.headers),i),body:h,signal:c}).catch(y=>{throw y.name==="AbortError"?y:new qg(y)}),m=f.headers.get("x-relay-error");if(m&&m==="true")throw new Xg(f);if(!f.ok)throw new Zg(f);let g=((s=f.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),v;return g==="application/json"?v=yield f.json():g==="application/octet-stream"||g==="application/pdf"?v=yield f.blob():g==="text/event-stream"?v=f:g==="multipart/form-data"?v=yield f.formData():v=yield f.text(),{data:v,error:null,response:f}}catch(i){return i instanceof Error&&i.name==="AbortError"?{data:null,error:new qg(i)}:{data:null,error:i,response:i instanceof Zg||i instanceof Xg?i.context:void 0}}})}}var En={};const na=m2(Gk);var ac={},lc={},cc={},dc={},uc={},hc={},Kg;function Tw(){if(Kg)return hc;Kg=1,Object.defineProperty(hc,"__esModule",{value:!0});class t extends Error{constructor(n){super(n.message),this.name="PostgrestError",this.details=n.details,this.hint=n.hint,this.code=n.code}}return hc.default=t,hc}var Jg;function Nw(){if(Jg)return uc;Jg=1,Object.defineProperty(uc,"__esModule",{value:!0});const e=na.__importDefault(Tw());class n{constructor(s){var i,a;this.shouldThrowOnError=!1,this.method=s.method,this.url=s.url,this.headers=new Headers(s.headers),this.schema=s.schema,this.body=s.body,this.shouldThrowOnError=(i=s.shouldThrowOnError)!==null&&i!==void 0?i:!1,this.signal=s.signal,this.isMaybeSingle=(a=s.isMaybeSingle)!==null&&a!==void 0?a:!1,s.fetch?this.fetch=s.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(s,i){return this.headers=new Headers(this.headers),this.headers.set(s,i),this}then(s,i){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const a=this.fetch;let l=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var d,u,p,h;let f=null,m=null,g=null,v=c.status,y=c.statusText;if(c.ok){if(this.method!=="HEAD"){const S=await c.text();S===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((d=this.headers.get("Accept"))===null||d===void 0)&&d.includes("application/vnd.pgrst.plan+text"))?m=S:m=JSON.parse(S))}const b=(u=this.headers.get("Prefer"))===null||u===void 0?void 0:u.match(/count=(exact|planned|estimated)/),w=(p=c.headers.get("content-range"))===null||p===void 0?void 0:p.split("/");b&&w&&w.length>1&&(g=parseInt(w[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(m)&&(m.length>1?(f={code:"PGRST116",details:`Results contain ${m.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},m=null,g=null,v=406,y="Not Acceptable"):m.length===1?m=m[0]:m=null)}else{const b=await c.text();try{f=JSON.parse(b),Array.isArray(f)&&c.status===404&&(m=[],f=null,v=200,y="OK")}catch{c.status===404&&b===""?(v=204,y="No Content"):f={message:b}}if(f&&this.isMaybeSingle&&(!((h=f==null?void 0:f.details)===null||h===void 0)&&h.includes("0 rows"))&&(f=null,v=200,y="OK"),f&&this.shouldThrowOnError)throw new e.default(f)}return{error:f,data:m,count:g,status:v,statusText:y}});return this.shouldThrowOnError||(l=l.catch(c=>{var d,u,p;return{error:{message:`${(d=c==null?void 0:c.name)!==null&&d!==void 0?d:"FetchError"}: ${c==null?void 0:c.message}`,details:`${(u=c==null?void 0:c.stack)!==null&&u!==void 0?u:""}`,hint:"",code:`${(p=c==null?void 0:c.code)!==null&&p!==void 0?p:""}`},data:null,count:null,status:0,statusText:""}})),l.then(s,i)}returns(){return this}overrideTypes(){return this}}return uc.default=n,uc}var Qg;function Pw(){if(Qg)return dc;Qg=1,Object.defineProperty(dc,"__esModule",{value:!0});const e=na.__importDefault(Nw());class n extends e.default{select(s){let i=!1;const a=(s??"*").split("").map(l=>/\s/.test(l)&&!i?"":(l==='"'&&(i=!i),l)).join("");return this.url.searchParams.set("select",a),this.headers.append("Prefer","return=representation"),this}order(s,{ascending:i=!0,nullsFirst:a,foreignTable:l,referencedTable:c=l}={}){const d=c?`${c}.order`:"order",u=this.url.searchParams.get(d);return this.url.searchParams.set(d,`${u?`${u},`:""}${s}.${i?"asc":"desc"}${a===void 0?"":a?".nullsfirst":".nullslast"}`),this}limit(s,{foreignTable:i,referencedTable:a=i}={}){const l=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(l,`${s}`),this}range(s,i,{foreignTable:a,referencedTable:l=a}={}){const c=typeof l>"u"?"offset":`${l}.offset`,d=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${s}`),this.url.searchParams.set(d,`${i-s+1}`),this}abortSignal(s){return this.signal=s,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:s=!1,verbose:i=!1,settings:a=!1,buffers:l=!1,wal:c=!1,format:d="text"}={}){var u;const p=[s?"analyze":null,i?"verbose":null,a?"settings":null,l?"buffers":null,c?"wal":null].filter(Boolean).join("|"),h=(u=this.headers.get("Accept"))!==null&&u!==void 0?u:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${d}; for="${h}"; options=${p};`),d==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(s){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${s}`),this}}return dc.default=n,dc}var e0;function Tf(){if(e0)return cc;e0=1,Object.defineProperty(cc,"__esModule",{value:!0});const e=na.__importDefault(Pw()),n=new RegExp("[,()]");class r extends e.default{eq(i,a){return this.url.searchParams.append(i,`eq.${a}`),this}neq(i,a){return this.url.searchParams.append(i,`neq.${a}`),this}gt(i,a){return this.url.searchParams.append(i,`gt.${a}`),this}gte(i,a){return this.url.searchParams.append(i,`gte.${a}`),this}lt(i,a){return this.url.searchParams.append(i,`lt.${a}`),this}lte(i,a){return this.url.searchParams.append(i,`lte.${a}`),this}like(i,a){return this.url.searchParams.append(i,`like.${a}`),this}likeAllOf(i,a){return this.url.searchParams.append(i,`like(all).{${a.join(",")}}`),this}likeAnyOf(i,a){return this.url.searchParams.append(i,`like(any).{${a.join(",")}}`),this}ilike(i,a){return this.url.searchParams.append(i,`ilike.${a}`),this}ilikeAllOf(i,a){return this.url.searchParams.append(i,`ilike(all).{${a.join(",")}}`),this}ilikeAnyOf(i,a){return this.url.searchParams.append(i,`ilike(any).{${a.join(",")}}`),this}is(i,a){return this.url.searchParams.append(i,`is.${a}`),this}in(i,a){const l=Array.from(new Set(a)).map(c=>typeof c=="string"&&n.test(c)?`"${c}"`:`${c}`).join(",");return this.url.searchParams.append(i,`in.(${l})`),this}contains(i,a){return typeof a=="string"?this.url.searchParams.append(i,`cs.${a}`):Array.isArray(a)?this.url.searchParams.append(i,`cs.{${a.join(",")}}`):this.url.searchParams.append(i,`cs.${JSON.stringify(a)}`),this}containedBy(i,a){return typeof a=="string"?this.url.searchParams.append(i,`cd.${a}`):Array.isArray(a)?this.url.searchParams.append(i,`cd.{${a.join(",")}}`):this.url.searchParams.append(i,`cd.${JSON.stringify(a)}`),this}rangeGt(i,a){return this.url.searchParams.append(i,`sr.${a}`),this}rangeGte(i,a){return this.url.searchParams.append(i,`nxl.${a}`),this}rangeLt(i,a){return this.url.searchParams.append(i,`sl.${a}`),this}rangeLte(i,a){return this.url.searchParams.append(i,`nxr.${a}`),this}rangeAdjacent(i,a){return this.url.searchParams.append(i,`adj.${a}`),this}overlaps(i,a){return typeof a=="string"?this.url.searchParams.append(i,`ov.${a}`):this.url.searchParams.append(i,`ov.{${a.join(",")}}`),this}textSearch(i,a,{config:l,type:c}={}){let d="";c==="plain"?d="pl":c==="phrase"?d="ph":c==="websearch"&&(d="w");const u=l===void 0?"":`(${l})`;return this.url.searchParams.append(i,`${d}fts${u}.${a}`),this}match(i){return Object.entries(i).forEach(([a,l])=>{this.url.searchParams.append(a,`eq.${l}`)}),this}not(i,a,l){return this.url.searchParams.append(i,`not.${a}.${l}`),this}or(i,{foreignTable:a,referencedTable:l=a}={}){const c=l?`${l}.or`:"or";return this.url.searchParams.append(c,`(${i})`),this}filter(i,a,l){return this.url.searchParams.append(i,`${a}.${l}`),this}}return cc.default=r,cc}var t0;function Rw(){if(t0)return lc;t0=1,Object.defineProperty(lc,"__esModule",{value:!0});const e=na.__importDefault(Tf());class n{constructor(s,{headers:i={},schema:a,fetch:l}){this.url=s,this.headers=new Headers(i),this.schema=a,this.fetch=l}select(s,i){const{head:a=!1,count:l}=i??{},c=a?"HEAD":"GET";let d=!1;const u=(s??"*").split("").map(p=>/\s/.test(p)&&!d?"":(p==='"'&&(d=!d),p)).join("");return this.url.searchParams.set("select",u),l&&this.headers.append("Prefer",`count=${l}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(s,{count:i,defaultToNull:a=!0}={}){var l;const c="POST";if(i&&this.headers.append("Prefer",`count=${i}`),a||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const d=s.reduce((u,p)=>u.concat(Object.keys(p)),[]);if(d.length>0){const u=[...new Set(d)].map(p=>`"${p}"`);this.url.searchParams.set("columns",u.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}upsert(s,{onConflict:i,ignoreDuplicates:a=!1,count:l,defaultToNull:c=!0}={}){var d;const u="POST";if(this.headers.append("Prefer",`resolution=${a?"ignore":"merge"}-duplicates`),i!==void 0&&this.url.searchParams.set("on_conflict",i),l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const p=s.reduce((h,f)=>h.concat(Object.keys(f)),[]);if(p.length>0){const h=[...new Set(p)].map(f=>`"${f}"`);this.url.searchParams.set("columns",h.join(","))}}return new e.default({method:u,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}update(s,{count:i}={}){var a;const l="PATCH";return i&&this.headers.append("Prefer",`count=${i}`),new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}delete({count:s}={}){var i;const a="DELETE";return s&&this.headers.append("Prefer",`count=${s}`),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}}return lc.default=n,lc}var n0;function qk(){if(n0)return ac;n0=1,Object.defineProperty(ac,"__esModule",{value:!0});const t=na,e=t.__importDefault(Rw()),n=t.__importDefault(Tf());class r{constructor(i,{headers:a={},schema:l,fetch:c}={}){this.url=i,this.headers=new Headers(a),this.schemaName=l,this.fetch=c}from(i){const a=new URL(`${this.url}/${i}`);return new e.default(a,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(i){return new r(this.url,{headers:this.headers,schema:i,fetch:this.fetch})}rpc(i,a={},{head:l=!1,get:c=!1,count:d}={}){var u;let p;const h=new URL(`${this.url}/rpc/${i}`);let f;l||c?(p=l?"HEAD":"GET",Object.entries(a).filter(([g,v])=>v!==void 0).map(([g,v])=>[g,Array.isArray(v)?`{${v.join(",")}}`:`${v}`]).forEach(([g,v])=>{h.searchParams.append(g,v)})):(p="POST",f=a);const m=new Headers(this.headers);return d&&m.set("Prefer",`count=${d}`),new n.default({method:p,url:h,headers:m,schema:this.schemaName,body:f,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}}return ac.default=r,ac}Object.defineProperty(En,"__esModule",{value:!0});var Ow=En.PostgrestError=Hw=En.PostgrestBuilder=Fw=En.PostgrestTransformBuilder=Iw=En.PostgrestFilterBuilder=Lw=En.PostgrestQueryBuilder=Mw=En.PostgrestClient=void 0;const ra=na,Aw=ra.__importDefault(qk());var Mw=En.PostgrestClient=Aw.default;const $w=ra.__importDefault(Rw());var Lw=En.PostgrestQueryBuilder=$w.default;const Dw=ra.__importDefault(Tf());var Iw=En.PostgrestFilterBuilder=Dw.default;const zw=ra.__importDefault(Pw());var Fw=En.PostgrestTransformBuilder=zw.default;const Bw=ra.__importDefault(Nw());var Hw=En.PostgrestBuilder=Bw.default;const Uw=ra.__importDefault(Tw());Ow=En.PostgrestError=Uw.default;var Ww=En.default={PostgrestClient:Aw.default,PostgrestQueryBuilder:$w.default,PostgrestFilterBuilder:Dw.default,PostgrestTransformBuilder:zw.default,PostgrestBuilder:Bw.default,PostgrestError:Uw.default};const Xk=f2({__proto__:null,get PostgrestBuilder(){return Hw},get PostgrestClient(){return Mw},get PostgrestError(){return Ow},get PostgrestFilterBuilder(){return Iw},get PostgrestQueryBuilder(){return Lw},get PostgrestTransformBuilder(){return Fw},default:Ww},[En]),{PostgrestClient:Zk,PostgrestQueryBuilder:YW,PostgrestFilterBuilder:qW,PostgrestTransformBuilder:XW,PostgrestBuilder:ZW,PostgrestError:KW}=Ww||Xk;class Kk{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const n=process.versions;if(n&&n.node){const r=n.node,s=parseInt(r.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let n=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(n+=`

Suggested solution: ${e.workaround}`),new Error(n)}static createWebSocket(e,n){const r=this.getWebSocketConstructor();return new r(e,n)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const Jk="2.79.0",Qk=`realtime-js/${Jk}`,ej="1.0.0",op=1e4,tj=1e3,nj=100;var Ja;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Ja||(Ja={}));var sn;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(sn||(sn={}));var Er;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Er||(Er={}));var ap;(function(t){t.websocket="websocket"})(ap||(ap={}));var yi;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(yi||(yi={}));class rj{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,n,r)}_decodeBroadcast(e,n,r){const s=n.getUint8(1),i=n.getUint8(2);let a=this.HEADER_LENGTH+2;const l=r.decode(e.slice(a,a+s));a=a+s;const c=r.decode(e.slice(a,a+i));a=a+i;const d=JSON.parse(r.decode(e.slice(a,e.byteLength)));return{ref:null,topic:l,event:c,payload:d}}}class Gw{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Pt;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Pt||(Pt={}));const r0=(t,e,n={})=>{var r;const s=(r=n.skipTypes)!==null&&r!==void 0?r:[];return e?Object.keys(e).reduce((i,a)=>(i[a]=sj(a,t,e,s),i),{}):{}},sj=(t,e,n,r)=>{const s=e.find(l=>l.name===t),i=s==null?void 0:s.type,a=n[t];return i&&!r.includes(i)?Vw(i,a):lp(a)},Vw=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return lj(e,n)}switch(t){case Pt.bool:return ij(e);case Pt.float4:case Pt.float8:case Pt.int2:case Pt.int4:case Pt.int8:case Pt.numeric:case Pt.oid:return oj(e);case Pt.json:case Pt.jsonb:return aj(e);case Pt.timestamp:return cj(e);case Pt.abstime:case Pt.date:case Pt.daterange:case Pt.int4range:case Pt.int8range:case Pt.money:case Pt.reltime:case Pt.text:case Pt.time:case Pt.timestamptz:case Pt.timetz:case Pt.tsrange:case Pt.tstzrange:return lp(e);default:return lp(e)}},lp=t=>t,ij=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},oj=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},aj=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},lj=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,r=t[n];if(t[0]==="{"&&r==="}"){let i;const a=t.slice(1,n);try{i=JSON.parse("["+a+"]")}catch{i=a?a.split(","):[]}return i.map(l=>Vw(e,l))}return t},cj=t=>typeof t=="string"?t.replace(" ","T"):t,Yw=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class Lu{constructor(e,n,r={},s=op){this.channel=e,this.event=n,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var r;return this._hasReceived(e)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var s0;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(s0||(s0={}));class Qa{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},s=>{const{onJoin:i,onLeave:a,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Qa.syncState(this.state,s,i,a),this.pendingDiffs.forEach(c=>{this.state=Qa.syncDiff(this.state,c,i,a)}),this.pendingDiffs=[],l()}),this.channel._on(r.diff,{},s=>{const{onJoin:i,onLeave:a,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Qa.syncDiff(this.state,s,i,a),l())}),this.onJoin((s,i,a)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:a})}),this.onLeave((s,i,a)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,r,s){const i=this.cloneDeep(e),a=this.transformState(n),l={},c={};return this.map(i,(d,u)=>{a[d]||(c[d]=u)}),this.map(a,(d,u)=>{const p=i[d];if(p){const h=u.map(v=>v.presence_ref),f=p.map(v=>v.presence_ref),m=u.filter(v=>f.indexOf(v.presence_ref)<0),g=p.filter(v=>h.indexOf(v.presence_ref)<0);m.length>0&&(l[d]=m),g.length>0&&(c[d]=g)}else l[d]=u}),this.syncDiff(i,{joins:l,leaves:c},r,s)}static syncDiff(e,n,r,s){const{joins:i,leaves:a}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(i,(l,c)=>{var d;const u=(d=e[l])!==null&&d!==void 0?d:[];if(e[l]=this.cloneDeep(c),u.length>0){const p=e[l].map(f=>f.presence_ref),h=u.filter(f=>p.indexOf(f.presence_ref)<0);e[l].unshift(...h)}r(l,u,c)}),this.map(a,(l,c)=>{let d=e[l];if(!d)return;const u=c.map(p=>p.presence_ref);d=d.filter(p=>u.indexOf(p.presence_ref)<0),e[l]=d,s(l,d,c),d.length===0&&delete e[l]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(r=>n(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,r)=>{const s=e[r];return"metas"in s?n[r]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):n[r]=s,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var i0;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(i0||(i0={}));var el;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(el||(el={}));var as;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(as||(as={}));class Nf{constructor(e,n={config:{}},r){var s,i;if(this.topic=e,this.params=n,this.socket=r,this.bindings={},this.state=sn.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new Lu(this,Er.join,this.params,this.timeout),this.rejoinTimer=new Gw(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=sn.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=sn.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=sn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=sn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=sn.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Er.reply,{},(a,l)=>{this._trigger(this._replyEventName(l),a)}),this.presence=new Qa(this),this.broadcastEndpointURL=Yw(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,n=this.timeout){var r,s,i;if(this.socket.isConnected()||this.socket.connect(),this.state==sn.closed){const{config:{broadcast:a,presence:l,private:c}}=this.params,d=(s=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(f=>f.filter))!==null&&s!==void 0?s:[],u=!!this.bindings[el.PRESENCE]&&this.bindings[el.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,p={},h={broadcast:a,presence:Object.assign(Object.assign({},l),{enabled:u}),postgres_changes:d,private:c};this.socket.accessTokenValue&&(p.access_token=this.socket.accessTokenValue),this._onError(f=>e==null?void 0:e(as.CHANNEL_ERROR,f)),this._onClose(()=>e==null?void 0:e(as.CLOSED)),this.updateJoinPayload(Object.assign({config:h},p)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:f})=>{var m;if(this.socket.setAuth(),f===void 0){e==null||e(as.SUBSCRIBED);return}else{const g=this.bindings.postgres_changes,v=(m=g==null?void 0:g.length)!==null&&m!==void 0?m:0,y=[];for(let x=0;x<v;x++){const b=g[x],{filter:{event:w,schema:S,table:_,filter:k}}=b,E=f&&f[x];if(E&&E.event===w&&E.schema===S&&E.table===_&&E.filter===k)y.push(Object.assign(Object.assign({},b),{id:E.id}));else{this.unsubscribe(),this.state=sn.errored,e==null||e(as.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=y,e&&e(as.SUBSCRIBED);return}}).receive("error",f=>{this.state=sn.errored,e==null||e(as.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(f).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(as.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,r){return this.state===sn.joined&&e===el.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,n,r)}async httpSend(e,n,r={}){var s;const i=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(n==null)return Promise.reject("Payload is required for httpSend()");const a={method:"POST",headers:{Authorization:i,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:n,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,a,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);if(l.status===202)return{success:!0};let c=l.statusText;try{const d=await l.json();c=d.error||d.message||c}catch{}return Promise.reject(new Error(c))}async send(e,n={}){var r,s;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:a}=e,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:a,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((s=d.body)===null||s===void 0?void 0:s.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var a,l,c;const d=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(l=(a=this.params)===null||a===void 0?void 0:a.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),d.receive("ok",()=>i("ok")),d.receive("error",()=>i("error")),d.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=sn.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Er.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(s=>{r=new Lu(this,Er.leave,{},e),r.receive("ok",()=>{n(),s("ok")}).receive("timeout",()=>{n(),s("timed out")}).receive("error",()=>{s("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=sn.closed,this.bindings={}}async _fetchWithTimeout(e,n,r){const s=new AbortController,i=setTimeout(()=>s.abort(),r),a=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:s.signal}));return clearTimeout(i),a}_push(e,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Lu(this,e,n,r);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>nj){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(e,n,r){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,r){var s,i;const a=e.toLocaleLowerCase(),{close:l,error:c,leave:d,join:u}=Er;if(r&&[l,c,d,u].indexOf(a)>=0&&r!==this._joinRef())return;let h=this._onMessage(a,n,r);if(n&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(f=>{var m,g,v;return((m=f.filter)===null||m===void 0?void 0:m.event)==="*"||((v=(g=f.filter)===null||g===void 0?void 0:g.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===a}).map(f=>f.callback(h,r)):(i=this.bindings[a])===null||i===void 0||i.filter(f=>{var m,g,v,y,x,b;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in f){const w=f.id,S=(m=f.filter)===null||m===void 0?void 0:m.event;return w&&((g=n.ids)===null||g===void 0?void 0:g.includes(w))&&(S==="*"||(S==null?void 0:S.toLocaleLowerCase())===((v=n.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))}else{const w=(x=(y=f==null?void 0:f.filter)===null||y===void 0?void 0:y.event)===null||x===void 0?void 0:x.toLocaleLowerCase();return w==="*"||w===((b=n==null?void 0:n.event)===null||b===void 0?void 0:b.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===a}).map(f=>{if(typeof h=="object"&&"ids"in h){const m=h.data,{schema:g,table:v,commit_timestamp:y,type:x,errors:b}=m;h=Object.assign(Object.assign({},{schema:g,table:v,commit_timestamp:y,eventType:x,new:{},old:{},errors:b}),this._getPayloadRecords(m))}f.callback(h,r)})}_isClosed(){return this.state===sn.closed}_isJoined(){return this.state===sn.joined}_isJoining(){return this.state===sn.joining}_isLeaving(){return this.state===sn.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,r){const s=e.toLocaleLowerCase(),i={type:s,filter:n,callback:r};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(e,n){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&Nf.isEqual(s.filter,n))})),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const r in e)if(e[r]!==n[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Er.close,{},e)}_onError(e){this._on(Er.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=sn.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=r0(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=r0(e.columns,e.old_record)),n}}const Du=()=>{},pc={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},dj=[1e3,2e3,5e3,1e4],uj=1e4,hj=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class pj{constructor(e,n){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=op,this.transport=null,this.heartbeatIntervalMs=pc.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Du,this.ref=0,this.reconnectTimer=null,this.logger=Du,this.conn=null,this.sendBuffer=[],this.serializer=new rj,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>s?(...i)=>s(...i):(...i)=>fetch(...i),!(!((r=n==null?void 0:n.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${e}/${ap.websocket}`,this.httpEndpoint=Yw(e),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Kk.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const n=e.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:ej}))}disconnect(e,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},e?this.conn.close(e,n??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,r){this.logger(e,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Ja.connecting:return yi.Connecting;case Ja.open:return yi.Open;case Ja.closing:return yi.Closing;default:return yi.Closed}}isConnected(){return this.connectionState()===yi.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,n={config:{}}){const r=`realtime:${e}`,s=this.getChannels().find(i=>i.topic===r);if(s)return s;{const i=new Nf(`realtime:${e}`,n,this);return this.channels.push(i),i}}push(e){const{topic:n,event:r,payload:s,ref:i}=e,a=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${n} ${r} (${i})`,s),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(tj,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},pc.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply")try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:s,payload:i,ref:a}=n,l=a?`(${a})`:"",c=i.status||"";this.log("receive",`${c} ${r} ${s} ${l}`.trim(),i),this.channels.filter(d=>d._isMember(r)).forEach(d=>d._trigger(s,i,a)),this._triggerStateCallbacks("message",n)})}_clearTimer(e){var n;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var n;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Er.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const r=e.match(/\?/)?"&":"?",s=new URLSearchParams(n);return`${e}${r}${s}`}_workerObjectUrl(e){let n;if(e)n=e;else{const r=new Blob([hj],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}_setConnectionState(e,n=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(e=null){let n;e?n=e:this.accessToken?n=await this.accessToken():n=this.accessTokenValue,this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(r=>{const s={access_token:n,version:Qk};n&&r.updateJoinPayload(s),r.joinedOnce&&r._isJoined()&&r._push(Er.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(n=>{this.log("error",`error setting auth in ${e}`,n)})}_triggerStateCallbacks(e,n){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(n)}catch(s){this.log("error",`error in ${e} callback`,s)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new Gw(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},pc.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var n,r,s,i,a,l,c,d,u;if(this.transport=(n=e==null?void 0:e.transport)!==null&&n!==void 0?n:null,this.timeout=(r=e==null?void 0:e.timeout)!==null&&r!==void 0?r:op,this.heartbeatIntervalMs=(s=e==null?void 0:e.heartbeatIntervalMs)!==null&&s!==void 0?s:pc.HEARTBEAT_INTERVAL,this.worker=(i=e==null?void 0:e.worker)!==null&&i!==void 0?i:!1,this.accessToken=(a=e==null?void 0:e.accessToken)!==null&&a!==void 0?a:null,this.heartbeatCallback=(l=e==null?void 0:e.heartbeatCallback)!==null&&l!==void 0?l:Du,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=e==null?void 0:e.reconnectAfterMs)!==null&&c!==void 0?c:p=>dj[p-1]||uj,this.encode=(d=e==null?void 0:e.encode)!==null&&d!==void 0?d:(p,h)=>h(JSON.stringify(p)),this.decode=(u=e==null?void 0:e.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class Pf extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Bt(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class fj extends Pf{constructor(e,n,r){super(e),this.name="StorageApiError",this.status=n,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class cp extends Pf{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}const Rf=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),mj=()=>Response,dp=t=>{if(Array.isArray(t))return t.map(n=>dp(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,r])=>{const s=n.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[s]=dp(r)}),e},gj=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Iu=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},yj=(t,e,n)=>Ve(void 0,void 0,void 0,function*(){const r=yield mj();t instanceof r&&!(n!=null&&n.noResolveJson)?t.json().then(s=>{const i=t.status||500,a=(s==null?void 0:s.statusCode)||i+"";e(new fj(Iu(s),i,a))}).catch(s=>{e(new cp(Iu(s),s))}):e(new cp(Iu(t),t))}),xj=(t,e,n,r)=>{const s={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!r?s:(gj(r)?(s.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),s.body=JSON.stringify(r)):s.body=r,e!=null&&e.duplex&&(s.duplex=e.duplex),Object.assign(Object.assign({},s),n))};function Rl(t,e,n,r,s,i){return Ve(this,void 0,void 0,function*(){return new Promise((a,l)=>{t(n,xj(e,r,s,i)).then(c=>{if(!c.ok)throw c;return r!=null&&r.noResolveJson?c:c.json()}).then(c=>a(c)).catch(c=>yj(c,l,r))})})}function vl(t,e,n,r){return Ve(this,void 0,void 0,function*(){return Rl(t,"GET",e,n,r)})}function jr(t,e,n,r,s){return Ve(this,void 0,void 0,function*(){return Rl(t,"POST",e,r,s,n)})}function up(t,e,n,r,s){return Ve(this,void 0,void 0,function*(){return Rl(t,"PUT",e,r,s,n)})}function vj(t,e,n,r){return Ve(this,void 0,void 0,function*(){return Rl(t,"HEAD",e,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)})}function Of(t,e,n,r,s){return Ve(this,void 0,void 0,function*(){return Rl(t,"DELETE",e,r,s,n)})}class bj{constructor(e,n){this.downloadFn=e,this.shouldThrowOnError=n}then(e,n){return this.execute().then(e,n)}execute(){return Ve(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Bt(e))return{data:null,error:e};throw e}})}}var qw;class wj{constructor(e,n){this.downloadFn=e,this.shouldThrowOnError=n,this[qw]="BlobDownloadBuilder",this.promise=null}asStream(){return new bj(this.downloadFn,this.shouldThrowOnError)}then(e,n){return this.getPromise().then(e,n)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return Ve(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Bt(e))return{data:null,error:e};throw e}})}}qw=Symbol.toStringTag;const _j={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},o0={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Sj{constructor(e,n={},r,s){this.shouldThrowOnError=!1,this.url=e,this.headers=n,this.bucketId=r,this.fetch=Rf(s)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,n,r,s){return Ve(this,void 0,void 0,function*(){try{let i;const a=Object.assign(Object.assign({},o0),s);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(a.upsert)});const c=a.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",a.cacheControl),c&&i.append("metadata",this.encodeMetadata(c)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.has("cacheControl")||i.append("cacheControl",a.cacheControl),c&&!i.has("metadata")&&i.append("metadata",this.encodeMetadata(c))):(i=r,l["cache-control"]=`max-age=${a.cacheControl}`,l["content-type"]=a.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!a.duplex&&(a.duplex="half")),s!=null&&s.headers&&(l=Object.assign(Object.assign({},l),s.headers));const d=this._removeEmptyFolders(n),u=this._getFinalPath(d),p=yield(e=="PUT"?up:jr)(this.fetch,`${this.url}/object/${u}`,i,Object.assign({headers:l},a!=null&&a.duplex?{duplex:a.duplex}:{}));return{data:{path:d,id:p.Id,fullPath:p.Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Bt(i))return{data:null,error:i};throw i}})}upload(e,n,r){return Ve(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,r)})}uploadToSignedUrl(e,n,r,s){return Ve(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),a=this._getFinalPath(i),l=new URL(this.url+`/object/upload/sign/${a}`);l.searchParams.set("token",n);try{let c;const d=Object.assign({upsert:o0.upsert},s),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&r instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",r)):typeof FormData<"u"&&r instanceof FormData?(c=r,c.append("cacheControl",d.cacheControl)):(c=r,u["cache-control"]=`max-age=${d.cacheControl}`,u["content-type"]=d.contentType);const p=yield up(this.fetch,l.toString(),c,{headers:u});return{data:{path:i,fullPath:p.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(Bt(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,n){return Ve(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const s=Object.assign({},this.headers);n!=null&&n.upsert&&(s["x-upsert"]="true");const i=yield jr(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:s}),a=new URL(this.url+i.url),l=a.searchParams.get("token");if(!l)throw new Pf("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:l},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Bt(r))return{data:null,error:r};throw r}})}update(e,n,r){return Ve(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,r)})}move(e,n,r){return Ve(this,void 0,void 0,function*(){try{return{data:yield jr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Bt(s))return{data:null,error:s};throw s}})}copy(e,n,r){return Ve(this,void 0,void 0,function*(){try{return{data:{path:(yield jr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Bt(s))return{data:null,error:s};throw s}})}createSignedUrl(e,n,r){return Ve(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),i=yield jr(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:n},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const a=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${a}`)},{data:i,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Bt(s))return{data:null,error:s};throw s}})}createSignedUrls(e,n,r){return Ve(this,void 0,void 0,function*(){try{const s=yield jr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:s.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${i}`):null})),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Bt(s))return{data:null,error:s};throw s}})}download(e,n){const s=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),a=i?`?${i}`:"",l=this._getFinalPath(e),c=()=>vl(this.fetch,`${this.url}/${s}/${l}${a}`,{headers:this.headers,noResolveJson:!0});return new wj(c,this.shouldThrowOnError)}info(e){return Ve(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{const r=yield vl(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:dp(r),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Bt(r))return{data:null,error:r};throw r}})}exists(e){return Ve(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{return yield vj(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Bt(r)&&r instanceof cp){const s=r.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,n){const r=this._getFinalPath(e),s=[],i=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";i!==""&&s.push(i);const l=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});c!==""&&s.push(c);let d=s.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${r}${d}`)}}}remove(e){return Ve(this,void 0,void 0,function*(){try{return{data:yield Of(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Bt(n))return{data:null,error:n};throw n}})}list(e,n,r){return Ve(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},_j),n),{prefix:e||""});return{data:yield jr(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Bt(s))return{data:null,error:s};throw s}})}listV2(e,n){return Ve(this,void 0,void 0,function*(){try{const r=Object.assign({},e);return{data:yield jr(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},n),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Bt(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const Xw="2.79.0",Zw={"X-Client-Info":`storage-js/${Xw}`};class kj{constructor(e,n={},r,s){this.shouldThrowOnError=!1;const i=new URL(e);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Zw),n),this.fetch=Rf(r)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(e){return Ve(this,void 0,void 0,function*(){try{const n=this.listBucketOptionsToQueryString(e);return{data:yield vl(this.fetch,`${this.url}/bucket${n}`,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Bt(n))return{data:null,error:n};throw n}})}getBucket(e){return Ve(this,void 0,void 0,function*(){try{return{data:yield vl(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Bt(n))return{data:null,error:n};throw n}})}createBucket(e){return Ve(this,arguments,void 0,function*(n,r={public:!1}){try{return{data:yield jr(this.fetch,`${this.url}/bucket`,{id:n,name:n,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Bt(s))return{data:null,error:s};throw s}})}updateBucket(e,n){return Ve(this,void 0,void 0,function*(){try{return{data:yield up(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Bt(r))return{data:null,error:r};throw r}})}emptyBucket(e){return Ve(this,void 0,void 0,function*(){try{return{data:yield jr(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Bt(n))return{data:null,error:n};throw n}})}deleteBucket(e){return Ve(this,void 0,void 0,function*(){try{return{data:yield Of(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Bt(n))return{data:null,error:n};throw n}})}listBucketOptionsToQueryString(e){const n={};return e&&("limit"in e&&(n.limit=String(e.limit)),"offset"in e&&(n.offset=String(e.offset)),e.search&&(n.search=e.search),e.sortColumn&&(n.sortColumn=e.sortColumn),e.sortOrder&&(n.sortOrder=e.sortOrder)),Object.keys(n).length>0?"?"+new URLSearchParams(n).toString():""}}class jj{constructor(e,n={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Zw),n),this.fetch=Rf(r)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return Ve(this,void 0,void 0,function*(){try{return{data:yield jr(this.fetch,`${this.url}/bucket`,{name:e},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Bt(n))return{data:null,error:n};throw n}})}listBuckets(e){return Ve(this,void 0,void 0,function*(){try{const n=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&n.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&n.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&n.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&n.set("sortOrder",e.sortOrder),e!=null&&e.search&&n.set("search",e.search);const r=n.toString(),s=r?`${this.url}/bucket?${r}`:`${this.url}/bucket`;return{data:yield vl(this.fetch,s,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Bt(n))return{data:null,error:n};throw n}})}deleteBucket(e){return Ve(this,void 0,void 0,function*(){try{return{data:yield Of(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Bt(n))return{data:null,error:n};throw n}})}}const Af={"X-Client-Info":`storage-js/${Xw}`,"Content-Type":"application/json"};class Kw extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function Vn(t){return typeof t=="object"&&t!==null&&"__isStorageVectorsError"in t}class zu extends Kw{constructor(e,n,r){super(e),this.name="StorageVectorsApiError",this.status=n,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Cj extends Kw{constructor(e,n){super(e),this.name="StorageVectorsUnknownError",this.originalError=n}}var a0;(function(t){t.InternalError="InternalError",t.S3VectorConflictException="S3VectorConflictException",t.S3VectorNotFoundException="S3VectorNotFoundException",t.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",t.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",t.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(a0||(a0={}));const Mf=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),Ej=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},l0=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Tj=(t,e,n)=>Ve(void 0,void 0,void 0,function*(){if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!(n!=null&&n.noResolveJson)){const s=t.status||500,i=t;if(typeof i.json=="function")i.json().then(a=>{const l=(a==null?void 0:a.statusCode)||(a==null?void 0:a.code)||s+"";e(new zu(l0(a),s,l))}).catch(()=>{const a=s+"",l=i.statusText||`HTTP ${s} error`;e(new zu(l,s,a))});else{const a=s+"",l=i.statusText||`HTTP ${s} error`;e(new zu(l,s,a))}}else e(new Cj(l0(t),t))}),Nj=(t,e,n,r)=>{const s={method:t,headers:(e==null?void 0:e.headers)||{}};return r?(Ej(r)?(s.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),s.body=JSON.stringify(r)):s.body=r,Object.assign(Object.assign({},s),n)):s};function Pj(t,e,n,r,s,i){return Ve(this,void 0,void 0,function*(){return new Promise((a,l)=>{t(n,Nj(e,r,s,i)).then(c=>{if(!c.ok)throw c;if(r!=null&&r.noResolveJson)return c;const d=c.headers.get("content-type");return!d||!d.includes("application/json")?{}:c.json()}).then(c=>a(c)).catch(c=>Tj(c,l,r))})})}function Yn(t,e,n,r,s){return Ve(this,void 0,void 0,function*(){return Pj(t,"POST",e,r,s,n)})}class Rj{constructor(e,n={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Af),n),this.fetch=Mf(r)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(e){return Ve(this,void 0,void 0,function*(){try{return{data:(yield Yn(this.fetch,`${this.url}/CreateIndex`,e,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Vn(n))return{data:null,error:n};throw n}})}getIndex(e,n){return Ve(this,void 0,void 0,function*(){try{return{data:yield Yn(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:e,indexName:n},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Vn(r))return{data:null,error:r};throw r}})}listIndexes(e){return Ve(this,void 0,void 0,function*(){try{return{data:yield Yn(this.fetch,`${this.url}/ListIndexes`,e,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Vn(n))return{data:null,error:n};throw n}})}deleteIndex(e,n){return Ve(this,void 0,void 0,function*(){try{return{data:(yield Yn(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:e,indexName:n},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Vn(r))return{data:null,error:r};throw r}})}}class Oj{constructor(e,n={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Af),n),this.fetch=Mf(r)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(e){return Ve(this,void 0,void 0,function*(){try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield Yn(this.fetch,`${this.url}/PutVectors`,e,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Vn(n))return{data:null,error:n};throw n}})}getVectors(e){return Ve(this,void 0,void 0,function*(){try{return{data:yield Yn(this.fetch,`${this.url}/GetVectors`,e,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Vn(n))return{data:null,error:n};throw n}})}listVectors(e){return Ve(this,void 0,void 0,function*(){try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:yield Yn(this.fetch,`${this.url}/ListVectors`,e,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Vn(n))return{data:null,error:n};throw n}})}queryVectors(e){return Ve(this,void 0,void 0,function*(){try{return{data:yield Yn(this.fetch,`${this.url}/QueryVectors`,e,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Vn(n))return{data:null,error:n};throw n}})}deleteVectors(e){return Ve(this,void 0,void 0,function*(){try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield Yn(this.fetch,`${this.url}/DeleteVectors`,e,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Vn(n))return{data:null,error:n};throw n}})}}class Aj{constructor(e,n={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Af),n),this.fetch=Mf(r)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return Ve(this,void 0,void 0,function*(){try{return{data:(yield Yn(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Vn(n))return{data:null,error:n};throw n}})}getBucket(e){return Ve(this,void 0,void 0,function*(){try{return{data:yield Yn(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:e},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Vn(n))return{data:null,error:n};throw n}})}listBuckets(){return Ve(this,arguments,void 0,function*(e={}){try{return{data:yield Yn(this.fetch,`${this.url}/ListVectorBuckets`,e,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Vn(n))return{data:null,error:n};throw n}})}deleteBucket(e){return Ve(this,void 0,void 0,function*(){try{return{data:(yield Yn(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Vn(n))return{data:null,error:n};throw n}})}}class Mj extends Aj{constructor(e,n={}){super(e,n.headers||{},n.fetch)}from(e){return new $j(this.url,this.headers,e,this.fetch)}}class $j extends Rj{constructor(e,n,r,s){super(e,n,s),this.vectorBucketName=r}createIndex(e){const n=Object.create(null,{createIndex:{get:()=>super.createIndex}});return Ve(this,void 0,void 0,function*(){return n.createIndex.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const e=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return Ve(this,arguments,void 0,function*(n={}){return e.listIndexes.call(this,Object.assign(Object.assign({},n),{vectorBucketName:this.vectorBucketName}))})}getIndex(e){const n=Object.create(null,{getIndex:{get:()=>super.getIndex}});return Ve(this,void 0,void 0,function*(){return n.getIndex.call(this,this.vectorBucketName,e)})}deleteIndex(e){const n=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return Ve(this,void 0,void 0,function*(){return n.deleteIndex.call(this,this.vectorBucketName,e)})}index(e){return new Lj(this.url,this.headers,this.vectorBucketName,e,this.fetch)}}class Lj extends Oj{constructor(e,n,r,s,i){super(e,n,i),this.vectorBucketName=r,this.indexName=s}putVectors(e){const n=Object.create(null,{putVectors:{get:()=>super.putVectors}});return Ve(this,void 0,void 0,function*(){return n.putVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(e){const n=Object.create(null,{getVectors:{get:()=>super.getVectors}});return Ve(this,void 0,void 0,function*(){return n.getVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const e=Object.create(null,{listVectors:{get:()=>super.listVectors}});return Ve(this,arguments,void 0,function*(n={}){return e.listVectors.call(this,Object.assign(Object.assign({},n),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(e){const n=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return Ve(this,void 0,void 0,function*(){return n.queryVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(e){const n=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return Ve(this,void 0,void 0,function*(){return n.deleteVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class Dj extends kj{constructor(e,n={},r,s){super(e,n,r,s)}from(e){return new Sj(this.url,this.headers,e,this.fetch)}get vectors(){return new Mj(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new jj(this.url+"/iceberg",this.headers,this.fetch)}}const Ij="2.79.0";let za="";typeof Deno<"u"?za="deno":typeof document<"u"?za="web":typeof navigator<"u"&&navigator.product==="ReactNative"?za="react-native":za="node";const zj={"X-Client-Info":`supabase-js-${za}/${Ij}`},Fj={headers:zj},Bj={schema:"public"},Hj={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Uj={},Wj=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),Gj=()=>Headers,Vj=(t,e,n)=>{const r=Wj(n),s=Gj();return async(i,a)=>{var l;const c=(l=await e())!==null&&l!==void 0?l:t;let d=new s(a==null?void 0:a.headers);return d.has("apikey")||d.set("apikey",t),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),r(i,Object.assign(Object.assign({},a),{headers:d}))}};function Yj(t){return t.endsWith("/")?t:t+"/"}function qj(t,e){var n,r;const{db:s,auth:i,realtime:a,global:l}=t,{db:c,auth:d,realtime:u,global:p}=e,h={db:Object.assign(Object.assign({},c),s),auth:Object.assign(Object.assign({},d),i),realtime:Object.assign(Object.assign({},u),a),storage:{},global:Object.assign(Object.assign(Object.assign({},p),l),{headers:Object.assign(Object.assign({},(n=p==null?void 0:p.headers)!==null&&n!==void 0?n:{}),(r=l==null?void 0:l.headers)!==null&&r!==void 0?r:{})}),accessToken:async()=>""};return t.accessToken?h.accessToken=t.accessToken:delete h.accessToken,h}function Xj(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Yj(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const Jw="2.79.0",to=30*1e3,hp=3,Fu=hp*to,Zj="http://localhost:9999",Kj="supabase.auth.token",Jj={"X-Client-Info":`gotrue-js/${Jw}`},pp="X-Supabase-Api-Version",Qw={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Qj=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,eC=10*60*1e3;class bl extends Error{constructor(e,n,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function Ke(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class tC extends bl{constructor(e,n,r){super(e,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function nC(t){return Ke(t)&&t.name==="AuthApiError"}class xi extends bl{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class Js extends bl{constructor(e,n,r,s){super(e,r,s),this.name=n,this.status=r}}class wr extends Js{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function rC(t){return Ke(t)&&t.name==="AuthSessionMissingError"}class Zi extends Js{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class fc extends Js{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class mc extends Js{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function sC(t){return Ke(t)&&t.name==="AuthImplicitGrantRedirectError"}class c0 extends Js{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class fp extends Js{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function Bu(t){return Ke(t)&&t.name==="AuthRetryableFetchError"}class d0 extends Js{constructor(e,n,r){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}class mp extends Js{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const hd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),u0=` 	
\r=`.split(""),iC=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<u0.length;e+=1)t[u0[e].charCodeAt(0)]=-2;for(let e=0;e<hd.length;e+=1)t[hd[e].charCodeAt(0)]=e;return t})();function h0(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(hd[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(hd[r]),e.queuedBits-=6}}function e1(t,e,n){const r=iC[t];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function p0(t){const e=[],n=a=>{e.push(String.fromCodePoint(a))},r={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=a=>{lC(a,r,n)};for(let a=0;a<t.length;a+=1)e1(t.charCodeAt(a),s,i);return e.join("")}function oC(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function aC(t,e){for(let n=0;n<t.length;n+=1){let r=t.charCodeAt(n);if(r>55295&&r<=56319){const s=(r-55296)*1024&65535;r=(t.charCodeAt(n+1)-56320&65535|s)+65536,n+=1}oC(r,e)}}function lC(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let r=1;r<6;r+=1)if(!(t>>7-r&1)){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function Fo(t){const e=[],n={queue:0,queuedBits:0},r=s=>{e.push(s)};for(let s=0;s<t.length;s+=1)e1(t.charCodeAt(s),n,r);return new Uint8Array(e)}function cC(t){const e=[];return aC(t,n=>e.push(n)),new Uint8Array(e)}function ki(t){const e=[],n={queue:0,queuedBits:0},r=s=>{e.push(s)};return t.forEach(s=>h0(s,n,r)),h0(null,n,r),e.join("")}function dC(t){return Math.round(Date.now()/1e3)+t}function uC(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const _n=()=>typeof window<"u"&&typeof document<"u",ci={tested:!1,writable:!1},t1=()=>{if(!_n())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ci.tested)return ci.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),ci.tested=!0,ci.writable=!0}catch{ci.tested=!0,ci.writable=!1}return ci.writable};function hC(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((s,i)=>{e[i]=s})}catch{}return n.searchParams.forEach((r,s)=>{e[s]=r}),e}const n1=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),pC=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",no=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},di=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},js=async(t,e)=>{await t.removeItem(e)};class Gd{constructor(){this.promise=new Gd.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}Gd.promiseConstructor=Promise;function Hu(t){const e=t.split(".");if(e.length!==3)throw new mp("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!Qj.test(e[r]))throw new mp("JWT not in base64url format");return{header:JSON.parse(p0(e[0])),payload:JSON.parse(p0(e[1])),signature:Fo(e[2]),raw:{header:e[0],payload:e[1]}}}async function fC(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function mC(t,e){return new Promise((r,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const a=await t(i);if(!e(i,null,a)){r(a);return}}catch(a){if(!e(i,a)){s(a);return}}})()})}function gC(t){return("0"+t.toString(16)).substr(-2)}function yC(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let s="";for(let i=0;i<56;i++)s+=n.charAt(Math.floor(Math.random()*r));return s}return crypto.getRandomValues(e),Array.from(e,gC).join("")}async function xC(t){const n=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",n),s=new Uint8Array(r);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function vC(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await xC(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ki(t,e,n=!1){const r=yC();let s=r;n&&(s+="/PASSWORD_RECOVERY"),await no(t,`${e}-code-verifier`,s);const i=await vC(r);return[i,r===i?"plain":"s256"]}const bC=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function wC(t){const e=t.headers.get(pp);if(!e||!e.match(bC))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function _C(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function SC(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const kC=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Ji(t){if(!kC.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Uu(){const t={};return new Proxy(t,{get:(e,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const r=n.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function jC(t,e){return new Proxy(t,{get:(n,r,s)=>{if(r==="__isInsecureUserWarningProxy")return!0;if(typeof r=="symbol"){const i=r.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)"||i==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(n,r,s)}return!e.value&&typeof r=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(n,r,s)}})}function f0(t){return JSON.parse(JSON.stringify(t))}const fi=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),CC=[502,503,504];async function m0(t){var e;if(!pC(t))throw new fp(fi(t),0);if(CC.includes(t.status))throw new fp(fi(t),t.status);let n;try{n=await t.json()}catch(i){throw new xi(fi(i),i)}let r;const s=wC(t);if(s&&s.getTime()>=Qw["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new d0(fi(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new wr}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((i,a)=>i&&typeof a=="string",!0))throw new d0(fi(n),t.status,n.weak_password.reasons);throw new tC(fi(n),t.status||500,r)}const EC=(t,e,n,r)=>{const s={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),n))};async function st(t,e,n,r){var s;const i=Object.assign({},r==null?void 0:r.headers);i[pp]||(i[pp]=Qw["2024-01-01"].name),r!=null&&r.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const a=(s=r==null?void 0:r.query)!==null&&s!==void 0?s:{};r!=null&&r.redirectTo&&(a.redirect_to=r.redirectTo);const l=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",c=await TC(t,e,n+l,{headers:i,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(c):{data:Object.assign({},c),error:null}}async function TC(t,e,n,r,s,i){const a=EC(e,r,s,i);let l;try{l=await t(n,Object.assign({},a))}catch(c){throw console.error(c),new fp(fi(c),0)}if(l.ok||await m0(l),r!=null&&r.noResolveJson)return l;try{return await l.json()}catch(c){await m0(c)}}function _r(t){var e;let n=null;RC(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=dC(t.expires_in)));const r=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:r},error:null}}function g0(t){const e=_r(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Rs(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function NC(t){return{data:t,error:null}}function PC(t){const{action_link:e,email_otp:n,hashed_token:r,redirect_to:s,verification_type:i}=t,a=ta(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:n,hashed_token:r,redirect_to:s,verification_type:i},c=Object.assign({},a);return{data:{properties:l,user:c},error:null}}function y0(t){return t}function RC(t){return t.access_token&&t.refresh_token&&t.expires_in}const Wu=["global","local","others"];class OC{constructor({url:e="",headers:n={},fetch:r}){this.url=e,this.headers=n,this.fetch=n1(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,n=Wu[0]){if(Wu.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Wu.join(", ")}`);try{return await st(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Ke(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,n={}){try{return await st(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:Rs})}catch(r){if(Ke(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:n}=e,r=ta(e,["options"]),s=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(s.new_email=r==null?void 0:r.newEmail,delete s.newEmail),await st(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:PC,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(Ke(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await st(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Rs})}catch(n){if(Ke(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,r,s,i,a,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await st(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(i=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:y0});if(u.error)throw u.error;const p=await u.json(),h=(a=u.headers.get("x-total-count"))!==null&&a!==void 0?a:0,f=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return f.length>0&&(f.forEach(m=>{const g=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(m.split(";")[1].split("=")[1]);d[`${v}Page`]=g}),d.total=parseInt(h)),{data:Object.assign(Object.assign({},p),d),error:null}}catch(d){if(Ke(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){Ji(e);try{return await st(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Rs})}catch(n){if(Ke(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){Ji(e);try{return await st(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:Rs})}catch(r){if(Ke(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,n=!1){Ji(e);try{return await st(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:Rs})}catch(r){if(Ke(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){Ji(e.userId);try{const{data:n,error:r}=await st(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:n,error:r}}catch(n){if(Ke(n))return{data:null,error:n};throw n}}async _deleteFactor(e){Ji(e.userId),Ji(e.id);try{return{data:await st(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(Ke(n))return{data:null,error:n};throw n}}async _listOAuthClients(e){var n,r,s,i,a,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await st(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(i=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:y0});if(u.error)throw u.error;const p=await u.json(),h=(a=u.headers.get("x-total-count"))!==null&&a!==void 0?a:0,f=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return f.length>0&&(f.forEach(m=>{const g=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(m.split(";")[1].split("=")[1]);d[`${v}Page`]=g}),d.total=parseInt(h)),{data:Object.assign(Object.assign({},p),d),error:null}}catch(d){if(Ke(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(e){try{return await st(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Ke(n))return{data:null,error:n};throw n}}async _getOAuthClient(e){try{return await st(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Ke(n))return{data:null,error:n};throw n}}async _updateOAuthClient(e,n){try{return await st(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:n,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ke(r))return{data:null,error:r};throw r}}async _deleteOAuthClient(e){try{return await st(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Ke(n))return{data:null,error:n};throw n}}async _regenerateOAuthClientSecret(e){try{return await st(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Ke(n))return{data:null,error:n};throw n}}}function x0(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}const Qi={debug:!!(globalThis&&t1()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class r1 extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class AC extends r1{}async function MC(t,e,n){Qi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),Qi.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async s=>{if(s){Qi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,s.name);try{return await n()}finally{Qi.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,s.name)}}else{if(e===0)throw Qi.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new AC(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Qi.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}function $C(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function s1(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function LC(t){return parseInt(t,16)}function DC(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,r=>r.toString(16).padStart(2,"0")).join("")}function IC(t){var e;const{chainId:n,domain:r,expirationTime:s,issuedAt:i=new Date,nonce:a,notBefore:l,requestId:c,resources:d,scheme:u,uri:p,version:h}=t;{if(!Number.isInteger(n))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${n}`);if(!r)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(a&&a.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${a}`);if(!p)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(h!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${h}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const f=s1(t.address),m=u?`${u}://${r}`:r,g=t.statement?`${t.statement}
`:"",v=`${m} wants you to sign in with your Ethereum account:
${f}

${g}`;let y=`URI: ${p}
Version: ${h}
Chain ID: ${n}${a?`
Nonce: ${a}`:""}
Issued At: ${i.toISOString()}`;if(s&&(y+=`
Expiration Time: ${s.toISOString()}`),l&&(y+=`
Not Before: ${l.toISOString()}`),c&&(y+=`
Request ID: ${c}`),d){let x=`
Resources:`;for(const b of d){if(!b||typeof b!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${b}`);x+=`
- ${b}`}y+=x}return`${v}
${y}`}class Qt extends Error{constructor({message:e,code:n,cause:r,name:s}){var i;super(e,{cause:r}),this.__isWebAuthnError=!0,this.name=(i=s??(r instanceof Error?r.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=n}}class pd extends Qt{constructor(e,n){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n,message:e}),this.name="WebAuthnUnknownError",this.originalError=n}}function zC({error:t,options:e}){var n,r,s;const{publicKey:i}=e;if(!i)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Qt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((n=i.authenticatorSelection)===null||n===void 0?void 0:n.requireResidentKey)===!0)return new Qt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((r=i.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new Qt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((s=i.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new Qt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new Qt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new Qt({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return i.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new Qt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new Qt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const a=window.location.hostname;if(i1(a)){if(i.rp.id!==a)return new Qt({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Qt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new Qt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new Qt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Qt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function FC({error:t,options:e}){const{publicKey:n}=e;if(!n)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Qt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new Qt({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const r=window.location.hostname;if(i1(r)){if(n.rpId!==r)return new Qt({message:`The RP ID "${n.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Qt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new Qt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Qt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class BC{createNewAbortSignal(){if(this.controller){const n=new Error("Cancelling existing WebAuthn API call for new one");n.name="AbortError",this.controller.abort(n)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const HC=new BC;function UC(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:n,excludeCredentials:r}=t,s=ta(t,["challenge","user","excludeCredentials"]),i=Fo(e).buffer,a=Object.assign(Object.assign({},n),{id:Fo(n.id).buffer}),l=Object.assign(Object.assign({},s),{challenge:i,user:a});if(r&&r.length>0){l.excludeCredentials=new Array(r.length);for(let c=0;c<r.length;c++){const d=r[c];l.excludeCredentials[c]=Object.assign(Object.assign({},d),{id:Fo(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return l}function WC(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:n}=t,r=ta(t,["challenge","allowCredentials"]),s=Fo(e).buffer,i=Object.assign(Object.assign({},r),{challenge:s});if(n&&n.length>0){i.allowCredentials=new Array(n.length);for(let a=0;a<n.length;a++){const l=n[a];i.allowCredentials[a]=Object.assign(Object.assign({},l),{id:Fo(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return i}function GC(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const n=t;return{id:t.id,rawId:t.id,response:{attestationObject:ki(new Uint8Array(t.response.attestationObject)),clientDataJSON:ki(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=n.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function VC(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const n=t,r=t.getClientExtensionResults(),s=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:ki(new Uint8Array(s.authenticatorData)),clientDataJSON:ki(new Uint8Array(s.clientDataJSON)),signature:ki(new Uint8Array(s.signature)),userHandle:s.userHandle?ki(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:r,authenticatorAttachment:(e=n.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function i1(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function v0(){var t,e;return!!(_n()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function YC(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new pd("Browser returned unexpected credential type",e)}:{data:null,error:new pd("Empty credential response",e)}}catch(e){return{data:null,error:zC({error:e,options:t})}}}async function qC(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new pd("Browser returned unexpected credential type",e)}:{data:null,error:new pd("Empty credential response",e)}}catch(e){return{data:null,error:FC({error:e,options:t})}}}const XC={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},ZC={userVerification:"preferred",hints:["security-key"]};function fd(...t){const e=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),n=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),r={};for(const s of t)if(s)for(const i in s){const a=s[i];if(a!==void 0)if(Array.isArray(a))r[i]=a;else if(n(a))r[i]=a;else if(e(a)){const l=r[i];e(l)?r[i]=fd(l,a):r[i]=fd(a)}else r[i]=a}return r}function KC(t,e){return fd(XC,t,e||{})}function JC(t,e){return fd(ZC,t,e||{})}class QC{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:n,friendlyName:r,signal:s},i){try{const{data:a,error:l}=await this.client.mfa.challenge({factorId:e,webauthn:n});if(!a)return{data:null,error:l};const c=s??HC.createNewAbortSignal();if(a.webauthn.type==="create"){const{user:d}=a.webauthn.credential_options.publicKey;d.name||(d.name=`${d.id}:${r}`),d.displayName||(d.displayName=d.name)}switch(a.webauthn.type){case"create":{const d=KC(a.webauthn.credential_options.publicKey,i==null?void 0:i.create),{data:u,error:p}=await YC({publicKey:d,signal:c});return u?{data:{factorId:e,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:u}},error:null}:{data:null,error:p}}case"request":{const d=JC(a.webauthn.credential_options.publicKey,i==null?void 0:i.request),{data:u,error:p}=await qC(Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:d,signal:c}));return u?{data:{factorId:e,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:u}},error:null}:{data:null,error:p}}}}catch(a){return Ke(a)?{data:null,error:a}:{data:null,error:new xi("Unexpected error in challenge",a)}}}async _verify({challengeId:e,factorId:n,webauthn:r}){return this.client.mfa.verify({factorId:n,challengeId:e,webauthn:r})}async _authenticate({factorId:e,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:s}},i){if(!n)return{data:null,error:new bl("rpId is required for WebAuthn authentication")};try{if(!v0())return{data:null,error:new xi("Browser does not support WebAuthn",null)};const{data:a,error:l}=await this.challenge({factorId:e,webauthn:{rpId:n,rpOrigins:r},signal:s},{request:i});if(!a)return{data:null,error:l};const{webauthn:c}=a;return this._verify({factorId:e,challengeId:a.challengeId,webauthn:{type:c.type,rpId:n,rpOrigins:r,credential_response:c.credential_response}})}catch(a){return Ke(a)?{data:null,error:a}:{data:null,error:new xi("Unexpected error in authenticate",a)}}}async _register({friendlyName:e,rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:s},i){if(!n)return{data:null,error:new bl("rpId is required for WebAuthn registration")};try{if(!v0())return{data:null,error:new xi("Browser does not support WebAuthn",null)};const{data:a,error:l}=await this._enroll({friendlyName:e});if(!a)return await this.client.mfa.listFactors().then(u=>{var p;return(p=u.data)===null||p===void 0?void 0:p.all.find(h=>h.factor_type==="webauthn"&&h.friendly_name===e&&h.status!=="unverified")}).then(u=>u?this.client.mfa.unenroll({factorId:u==null?void 0:u.id}):void 0),{data:null,error:l};const{data:c,error:d}=await this._challenge({factorId:a.id,friendlyName:a.friendly_name,webauthn:{rpId:n,rpOrigins:r},signal:s},{create:i});return c?this._verify({factorId:a.id,challengeId:c.challengeId,webauthn:{rpId:n,rpOrigins:r,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:d}}catch(a){return Ke(a)?{data:null,error:a}:{data:null,error:new xi("Unexpected error in register",a)}}}}$C();const eE={url:Zj,storageKey:Kj,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Jj,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function b0(t,e,n){return await n()}const eo={};class wl{get jwks(){var e,n;return(n=(e=eo[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(e){eo[this.storageKey]=Object.assign(Object.assign({},eo[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,n;return(n=(e=eo[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){eo[this.storageKey]=Object.assign(Object.assign({},eo[this.storageKey]),{cachedAt:e})}constructor(e){var n,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=wl.nextInstanceID,wl.nextInstanceID+=1,this.instanceID>0&&_n()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},eE),e);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new OC({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=n1(s.fetch),this.lock=s.lock||b0,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,this.throwOnError=s.throwOnError,s.lock?this.lock=s.lock:_n()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=MC:this.lock=b0,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new QC(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:t1()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=x0(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=x0(this.memoryStorage)),_n()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Jw}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let n={},r="none";if(_n()&&(n=hC(window.location.href),this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce")),_n()&&this.detectSessionInUrl&&r!=="none"){const{data:s,error:i}=await this._getSessionFromURL(n,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),sC(i)){const c=(e=i.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:a,redirectType:l}=s;return this._debug("#_initialize()","detected session in URL",a,"redirect type",l),await this._saveSession(a),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return Ke(n)?this._returnResult({error:n}):this._returnResult({error:new xi("Unexpected error during initialization",n)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,r,s;try{const i=await st(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(s=e==null?void 0:e.options)===null||s===void 0?void 0:s.captchaToken}},xform:_r}),{data:a,error:l}=i;if(l||!a)return this._returnResult({data:{user:null,session:null},error:l});const c=a.session,d=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(i){if(Ke(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signUp(e){var n,r,s;try{let i;if("email"in e){const{email:u,password:p,options:h}=e;let f=null,m=null;this.flowType==="pkce"&&([f,m]=await Ki(this.storage,this.storageKey)),i=await st(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:u,password:p,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:f,code_challenge_method:m},xform:_r})}else if("phone"in e){const{phone:u,password:p,options:h}=e;i=await st(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:p,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},channel:(s=h==null?void 0:h.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:_r})}else throw new fc("You must provide either an email or phone number and a password");const{data:a,error:l}=i;if(l||!a)return this._returnResult({data:{user:null,session:null},error:l});const c=a.session,d=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(i){if(Ke(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithPassword(e){try{let n;if("email"in e){const{email:i,password:a,options:l}=e;n=await st(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:g0})}else if("phone"in e){const{phone:i,password:a,options:l}=e;n=await st(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:g0})}else throw new fc("You must provide either an email or phone number and a password");const{data:r,error:s}=n;if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!r||!r.session||!r.user){const i=new Zi;return this._returnResult({data:{user:null,session:null},error:i})}return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),this._returnResult({data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s})}catch(n){if(Ke(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOAuth(e){var n,r,s,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;switch(n){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}}async signInWithEthereum(e){var n,r,s,i,a,l,c,d,u,p,h;let f,m;if("message"in e)f=e.message,m=e.signature;else{const{chain:g,wallet:v,statement:y,options:x}=e;let b;if(_n())if(typeof v=="object")b=v;else{const T=window;if("ethereum"in T&&typeof T.ethereum=="object"&&"request"in T.ethereum&&typeof T.ethereum.request=="function")b=T.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof v!="object"||!(x!=null&&x.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");b=v}const w=new URL((n=x==null?void 0:x.url)!==null&&n!==void 0?n:window.location.href),S=await b.request({method:"eth_requestAccounts"}).then(T=>T).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!S||S.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const _=s1(S[0]);let k=(r=x==null?void 0:x.signInWithEthereum)===null||r===void 0?void 0:r.chainId;if(!k){const T=await b.request({method:"eth_chainId"});k=LC(T)}const E={domain:w.host,address:_,statement:y,uri:w.href,version:"1",chainId:k,nonce:(s=x==null?void 0:x.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(a=(i=x==null?void 0:x.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&a!==void 0?a:new Date,expirationTime:(l=x==null?void 0:x.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=x==null?void 0:x.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(d=x==null?void 0:x.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(u=x==null?void 0:x.signInWithEthereum)===null||u===void 0?void 0:u.resources};f=IC(E),m=await b.request({method:"personal_sign",params:[DC(f),_]})}try{const{data:g,error:v}=await st(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:f,signature:m},!((p=e.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(h=e.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:_r});if(v)throw v;if(!g||!g.session||!g.user){const y=new Zi;return this._returnResult({data:{user:null,session:null},error:y})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:Object.assign({},g),error:v})}catch(g){if(Ke(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async signInWithSolana(e){var n,r,s,i,a,l,c,d,u,p,h,f;let m,g;if("message"in e)m=e.message,g=e.signature;else{const{chain:v,wallet:y,statement:x,options:b}=e;let w;if(_n())if(typeof y=="object")w=y;else{const _=window;if("solana"in _&&typeof _.solana=="object"&&("signIn"in _.solana&&typeof _.solana.signIn=="function"||"signMessage"in _.solana&&typeof _.solana.signMessage=="function"))w=_.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!(b!=null&&b.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=y}const S=new URL((n=b==null?void 0:b.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in w&&w.signIn){const _=await w.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},b==null?void 0:b.signInWithSolana),{version:"1",domain:S.host,uri:S.href}),x?{statement:x}:null));let k;if(Array.isArray(_)&&_[0]&&typeof _[0]=="object")k=_[0];else if(_&&typeof _=="object"&&"signedMessage"in _&&"signature"in _)k=_;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in k&&"signature"in k&&(typeof k.signedMessage=="string"||k.signedMessage instanceof Uint8Array)&&k.signature instanceof Uint8Array)m=typeof k.signedMessage=="string"?k.signedMessage:new TextDecoder().decode(k.signedMessage),g=k.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in w)||typeof w.signMessage!="function"||!("publicKey"in w)||typeof w!="object"||!w.publicKey||!("toBase58"in w.publicKey)||typeof w.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");m=[`${S.host} wants you to sign in with your Solana account:`,w.publicKey.toBase58(),...x?["",x,""]:[""],"Version: 1",`URI: ${S.href}`,`Issued At: ${(s=(r=b==null?void 0:b.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((i=b==null?void 0:b.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${b.signInWithSolana.notBefore}`]:[],...!((a=b==null?void 0:b.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${b.signInWithSolana.expirationTime}`]:[],...!((l=b==null?void 0:b.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${b.signInWithSolana.chainId}`]:[],...!((c=b==null?void 0:b.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${b.signInWithSolana.nonce}`]:[],...!((d=b==null?void 0:b.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${b.signInWithSolana.requestId}`]:[],...!((p=(u=b==null?void 0:b.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||p===void 0)&&p.length?["Resources",...b.signInWithSolana.resources.map(k=>`- ${k}`)]:[]].join(`
`);const _=await w.signMessage(new TextEncoder().encode(m),"utf8");if(!_||!(_ instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");g=_}}try{const{data:v,error:y}=await st(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:m,signature:ki(g)},!((h=e.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:_r});if(y)throw y;if(!v||!v.session||!v.user){const x=new Zi;return this._returnResult({data:{user:null,session:null},error:x})}return v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),this._returnResult({data:Object.assign({},v),error:y})}catch(v){if(Ke(v))return this._returnResult({data:{user:null,session:null},error:v});throw v}}async _exchangeCodeForSession(e){const n=await di(this.storage,`${this.storageKey}-code-verifier`),[r,s]=(n??"").split("/");try{const{data:i,error:a}=await st(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:_r});if(await js(this.storage,`${this.storageKey}-code-verifier`),a)throw a;if(!i||!i.session||!i.user){const l=new Zi;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:a})}catch(i){if(Ke(i))return this._returnResult({data:{user:null,session:null,redirectType:null},error:i});throw i}}async signInWithIdToken(e){try{const{options:n,provider:r,token:s,access_token:i,nonce:a}=e,l=await st(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:i,nonce:a,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:_r}),{data:c,error:d}=l;if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!c||!c.session||!c.user){const u=new Zi;return this._returnResult({data:{user:null,session:null},error:u})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:d})}catch(n){if(Ke(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOtp(e){var n,r,s,i,a;try{if("email"in e){const{email:l,options:c}=e;let d=null,u=null;this.flowType==="pkce"&&([d,u]=await Ki(this.storage,this.storageKey));const{error:p}=await st(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(n=c==null?void 0:c.data)!==null&&n!==void 0?n:{},create_user:(r=c==null?void 0:c.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:d,code_challenge_method:u},redirectTo:c==null?void 0:c.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:p})}if("phone"in e){const{phone:l,options:c}=e,{data:d,error:u}=await st(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(s=c==null?void 0:c.data)!==null&&s!==void 0?s:{},create_user:(i=c==null?void 0:c.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(a=c==null?void 0:c.channel)!==null&&a!==void 0?a:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:u})}throw new fc("You must provide either an email or phone number.")}catch(l){if(Ke(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(e){var n,r;try{let s,i;"options"in e&&(s=(n=e.options)===null||n===void 0?void 0:n.redirectTo,i=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:a,error:l}=await st(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:_r});if(l)throw l;if(!a)throw new Error("An error occurred on token verification.");const c=a.session,d=a.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(s){if(Ke(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithSSO(e){var n,r,s;try{let i=null,a=null;this.flowType==="pkce"&&([i,a]=await Ki(this.storage,this.storageKey));const l=await st(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((s=e==null?void 0:e.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:a}),headers:this.headers,xform:NC});return this._returnResult(l)}catch(i){if(Ke(i))return this._returnResult({data:null,error:i});throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:r}=e;if(r)throw r;if(!n)throw new wr;const{error:s}=await st(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return this._returnResult({data:{user:null,session:null},error:s})})}catch(e){if(Ke(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:r,type:s,options:i}=e,{error:a}=await st(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:a})}else if("phone"in e){const{phone:r,type:s,options:i}=e,{data:a,error:l}=await st(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:l})}throw new fc("You must provide either an email or phone number and a type")}catch(n){if(Ke(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await di(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<Fu:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const a=await di(this.userStorage,this.storageKey+"-user");a!=null&&a.user?e.user=a.user:e.user=Uu()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const a={value:this.suppressGetSessionWarning};e.user=jC(e.user,a),a.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{session:null},error:i}):this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await st(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Rs}):await this._useSession(async n=>{var r,s,i;const{data:a,error:l}=n;if(l)throw l;return!(!((r=a.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new wr}:await st(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:Rs})})}catch(n){if(Ke(n))return rC(n)&&(await this._removeSession(),await js(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:n});throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async r=>{const{data:s,error:i}=r;if(i)throw i;if(!s.session)throw new wr;const a=s.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await Ki(this.storage,this.storageKey));const{data:d,error:u}=await st(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:a.access_token,xform:Rs});if(u)throw u;return a.user=d.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),this._returnResult({data:{user:a.user},error:null})})}catch(r){if(Ke(r))return this._returnResult({data:{user:null},error:r});throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new wr;const n=Date.now()/1e3;let r=n,s=!0,i=null;const{payload:a}=Hu(e.access_token);if(a.exp&&(r=a.exp,s=r<=n),s){const{data:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)throw c;i={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return this._returnResult({data:{user:i.user,session:i},error:null})}catch(n){if(Ke(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var r;if(!e){const{data:a,error:l}=n;if(l)throw l;e=(r=a.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new wr;const{data:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{user:null,session:null},error:i}):s?this._returnResult({data:{user:s.user,session:s},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(n){if(Ke(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async _getSessionFromURL(e,n){try{if(!_n())throw new mc("No browser detected.");if(e.error||e.error_description||e.error_code)throw new mc(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new c0("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new mc("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new c0("No code detected.");const{data:x,error:b}=await this._exchangeCodeForSession(e.code);if(b)throw b;const w=new URL(window.location.href);return w.searchParams.delete("code"),window.history.replaceState(window.history.state,"",w.toString()),{data:{session:x.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:s,access_token:i,refresh_token:a,expires_in:l,expires_at:c,token_type:d}=e;if(!i||!l||!a||!d)throw new mc("No session defined in URL");const u=Math.round(Date.now()/1e3),p=parseInt(l);let h=u+p;c&&(h=parseInt(c));const f=h-u;f*1e3<=to&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${p}s`);const m=h-p;u-m>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",m,h,u):u-m<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",m,h,u);const{data:g,error:v}=await this._getUser(i);if(v)throw v;const y={provider_token:r,provider_refresh_token:s,access_token:i,expires_in:p,expires_at:h,refresh_token:a,token_type:d,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:y,redirectType:e.type},error:null})}catch(r){if(Ke(r))return this._returnResult({data:{session:null,redirectType:null},error:r});throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await di(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:s,error:i}=n;if(i)return this._returnResult({error:i});const a=(r=s.session)===null||r===void 0?void 0:r.access_token;if(a){const{error:l}=await this.admin.signOut(a,e);if(l&&!(nC(l)&&(l.status===404||l.status===401||l.status===403)))return this._returnResult({error:l})}return e!=="others"&&(await this._removeSession(),await js(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const n=uC(),r={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async n=>{var r,s;try{const{data:{session:i},error:a}=n;if(a)throw a;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,n={}){let r=null,s=null;this.flowType==="pkce"&&([r,s]=await Ki(this.storage,this.storageKey,!0));try{return await st(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(i){if(Ke(i))return this._returnResult({data:null,error:i});throw i}}async getUserIdentities(){var e;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return this._returnResult({data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(n){if(Ke(n))return this._returnResult({data:null,error:n});throw n}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var n;try{const{data:r,error:s}=await this._useSession(async i=>{var a,l,c,d,u;const{data:p,error:h}=i;if(h)throw h;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await st(this.fetch,"GET",f,{headers:this.headers,jwt:(u=(d=p.session)===null||d===void 0?void 0:d.access_token)!==null&&u!==void 0?u:void 0})});if(s)throw s;return _n()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),this._returnResult({data:{provider:e.provider,url:r==null?void 0:r.url},error:null})}catch(r){if(Ke(r))return this._returnResult({data:{provider:e.provider,url:null},error:r});throw r}}async linkIdentityIdToken(e){return await this._useSession(async n=>{var r;try{const{error:s,data:{session:i}}=n;if(s)throw s;const{options:a,provider:l,token:c,access_token:d,nonce:u}=e,p=await st(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(r=i==null?void 0:i.access_token)!==null&&r!==void 0?r:void 0,body:{provider:l,id_token:c,access_token:d,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:_r}),{data:h,error:f}=p;return f?this._returnResult({data:{user:null,session:null},error:f}):!h||!h.session||!h.user?this._returnResult({data:{user:null,session:null},error:new Zi}):(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("USER_UPDATED",h.session)),this._returnResult({data:h,error:f}))}catch(s){if(Ke(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}})}async unlinkIdentity(e){try{return await this._useSession(async n=>{var r,s;const{data:i,error:a}=n;if(a)throw a;return await st(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0})})}catch(n){if(Ke(n))return this._returnResult({data:null,error:n});throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await mC(async s=>(s>0&&await fC(200*Math.pow(2,s-1)),this._debug(n,"refreshing attempt",s),await st(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:_r})),(s,i)=>{const a=200*Math.pow(2,s);return i&&Bu(i)&&Date.now()+a-r<to})}catch(r){if(this._debug(n,"error",r),Ke(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",r),_n()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,n;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const s=await di(this.storage,this.storageKey);if(s&&this.userStorage){let a=await di(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:s.user},await no(this.userStorage,this.storageKey+"-user",a)),s.user=(e=a==null?void 0:a.user)!==null&&e!==void 0?e:Uu()}else if(s&&!s.user&&!s.user){const a=await di(this.storage,this.storageKey+"-user");a&&(a!=null&&a.user)?(s.user=a.user,await js(this.storage,this.storageKey+"-user"),await no(this.storage,this.storageKey,s)):s.user=Uu()}if(this._debug(r,"session from storage",s),!this._isValidSession(s)){this._debug(r,"session is not valid"),s!==null&&await this._removeSession();return}const i=((n=s.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<Fu;if(this._debug(r,`session has${i?"":" not"} expired with margin of ${Fu}s`),i){if(this.autoRefreshToken&&s.refresh_token){const{error:a}=await this._callRefreshToken(s.refresh_token);a&&(console.error(a),Bu(a)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:l}=await this._getUser(s.access_token);!l&&(a!=null&&a.user)?(s.user=a.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(r,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(r,"error",s),console.error(s);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var n,r;if(!e)throw new wr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Gd;const{data:i,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!i.session)throw new wr;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={data:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(s,"error",i),Ke(i)){const a={data:null,error:i};return Bu(i)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(a),a}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,n,r=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:n});const i=[],a=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,n)}catch(c){i.push(c)}});if(await Promise.all(a),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const n=Object.assign({},e),r=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&n.user&&await no(this.userStorage,this.storageKey+"-user",{user:n.user});const s=Object.assign({},n);delete s.user;const i=f0(s);await no(this.storage,this.storageKey,i)}else{const s=f0(n);await no(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await js(this.storage,this.storageKey),await js(this.storage,this.storageKey+"-code-verifier"),await js(this.storage,this.storageKey+"-user"),this.userStorage&&await js(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&_n()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),to);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((r.expires_at*1e3-e)/to);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${to}ms, refresh threshold is ${hp} ticks`),s<=hp&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof r1)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!_n()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,r){const s=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[i,a]=await Ki(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(a)}`});s.push(l.toString())}if(r!=null&&r.queryParams){const i=new URLSearchParams(r.queryParams);s.push(i.toString())}return r!=null&&r.skipBrowserRedirect&&s.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var r;const{data:s,error:i}=n;return i?this._returnResult({data:null,error:i}):await st(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(Ke(n))return this._returnResult({data:null,error:n});throw n}}async _enroll(e){try{return await this._useSession(async n=>{var r,s;const{data:i,error:a}=n;if(a)return this._returnResult({data:null,error:a});const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:c,error:d}=await st(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return d?this._returnResult({data:null,error:d}):(e.factorType==="totp"&&c.type==="totp"&&(!((s=c==null?void 0:c.totp)===null||s===void 0)&&s.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(n){if(Ke(n))return this._returnResult({data:null,error:n});throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:s,error:i}=n;if(i)return this._returnResult({data:null,error:i});const a=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?GC(e.webauthn.credential_response):VC(e.webauthn.credential_response)})}:{code:e.code}),{data:l,error:c}=await st(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:a,headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:c}))})}catch(n){if(Ke(n))return this._returnResult({data:null,error:n});throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:s,error:i}=n;if(i)return this._returnResult({data:null,error:i});const a=await st(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});if(a.error)return a;const{data:l}=a;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:UC(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:WC(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(n){if(Ke(n))return this._returnResult({data:null,error:n});throw n}})}async _challengeAndVerify(e){const{data:n,error:r}=await this._challenge({factorId:e.factorId});return r?this._returnResult({data:null,error:r}):await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){var e;const{data:{user:n},error:r}=await this.getUser();if(r)return{data:null,error:r};const s={all:[],phone:[],totp:[],webauthn:[]};for(const i of(e=n==null?void 0:n.factors)!==null&&e!==void 0?e:[])s.all.push(i),i.status==="verified"&&s[i.factor_type].push(i);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(){var e,n;const{data:{session:r},error:s}=await this.getSession();if(s)return this._returnResult({data:null,error:s});if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=Hu(r.access_token);let a=null;i.aal&&(a=i.aal);let l=a;((n=(e=r.user.factors)===null||e===void 0?void 0:e.filter(u=>u.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const d=i.amr||[];return{data:{currentLevel:a,nextLevel:l,currentAuthenticationMethods:d},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async n=>{const{data:{session:r},error:s}=n;return s?this._returnResult({data:null,error:s}):r?await st(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:r.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new wr})})}catch(n){if(Ke(n))return this._returnResult({data:null,error:n});throw n}}async _approveAuthorization(e,n){try{return await this._useSession(async r=>{const{data:{session:s},error:i}=r;if(i)return this._returnResult({data:null,error:i});if(!s)return this._returnResult({data:null,error:new wr});const a=await st(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return a.data&&a.data.redirect_url&&_n()&&!(n!=null&&n.skipBrowserRedirect)&&window.location.assign(a.data.redirect_url),a})}catch(r){if(Ke(r))return this._returnResult({data:null,error:r});throw r}}async _denyAuthorization(e,n){try{return await this._useSession(async r=>{const{data:{session:s},error:i}=r;if(i)return this._returnResult({data:null,error:i});if(!s)return this._returnResult({data:null,error:new wr});const a=await st(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return a.data&&a.data.redirect_url&&_n()&&!(n!=null&&n.skipBrowserRedirect)&&window.location.assign(a.data.redirect_url),a})}catch(r){if(Ke(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(e,n={keys:[]}){let r=n.keys.find(l=>l.kid===e);if(r)return r;const s=Date.now();if(r=this.jwks.keys.find(l=>l.kid===e),r&&this.jwks_cached_at+eC>s)return r;const{data:i,error:a}=await st(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=s,r=i.keys.find(l=>l.kid===e),!r)?null:r}async getClaims(e,n={}){try{let r=e;if(!r){const{data:f,error:m}=await this.getSession();if(m||!f.session)return this._returnResult({data:null,error:m});r=f.session.access_token}const{header:s,payload:i,signature:a,raw:{header:l,payload:c}}=Hu(r);n!=null&&n.allowExpired||_C(i.exp);const d=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!d){const{error:f}=await this.getUser(r);if(f)throw f;return{data:{claims:i,header:s,signature:a},error:null}}const u=SC(s.alg),p=await crypto.subtle.importKey("jwk",d,u,!0,["verify"]);if(!await crypto.subtle.verify(u,p,a,cC(`${l}.${c}`)))throw new mp("Invalid JWT signature");return{data:{claims:i,header:s,signature:a},error:null}}catch(r){if(Ke(r))return this._returnResult({data:null,error:r});throw r}}}wl.nextInstanceID=0;const tE=wl;class nE extends tE{constructor(e){super(e)}}class rE{constructor(e,n,r){var s,i,a;this.supabaseUrl=e,this.supabaseKey=n;const l=Xj(e);if(!n)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,d={db:Bj,realtime:Uj,auth:Object.assign(Object.assign({},Hj),{storageKey:c}),global:Fj},u=qj(r??{},d);this.storageKey=(s=u.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=u.global.headers)!==null&&i!==void 0?i:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(p,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=u.auth)!==null&&a!==void 0?a:{},this.headers,u.global.fetch),this.fetch=Vj(n,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new Zk(new URL("rest/v1",l).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new Dj(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new Yk(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,n,r)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,n;if(this.accessToken)return await this.accessToken();const{data:r}=await this.auth.getSession();return(n=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:s,userStorage:i,storageKey:a,flowType:l,lock:c,debug:d,throwOnError:u},p,h){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new nE({url:this.authUrl.href,headers:Object.assign(Object.assign({},f),p),storageKey:a,autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:s,userStorage:i,flowType:l,lock:c,debug:d,throwOnError:u,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(m=>m.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new pj(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,r)=>{this._handleTokenChanged(n,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,n,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const sE=(t,e,n)=>new rE(t,e,n);function iE(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}iE()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const w0={DRAFTIFY:"/api/studio-draftify",GEOMETRIC_GENERATE:"/api/studio-generate-geometric"},_0={URL:"https://okakomwfikxmwllvliva.supabase.co",ANON_KEY:""},S0={AUTH_SESSION:"studio_auth_session"},vi={BLEND_MODE_ENABLED:!1},an=sE(_0.URL,_0.ANON_KEY),Nr={async signIn(t,e){const{data:n,error:r}=await an.auth.signInWithPassword({email:t,password:e});if(r)throw r;return localStorage.setItem(S0.AUTH_SESSION,JSON.stringify(n.session)),n},async signOut(){await an.auth.signOut(),localStorage.removeItem(S0.AUTH_SESSION)},async getSession(){const{data:t}=await an.auth.getSession();return t.session},async updatePassword(t){const{data:e,error:n}=await an.auth.updateUser({password:t});if(n)throw n;return await an.auth.updateUser({data:{password_setup_complete:!0}}),e},onAuthStateChange(t){return an.auth.onAuthStateChange(t)}};async function Vd(){var n,r;const t=await an.auth.getSession(),e=(r=(n=t==null?void 0:t.data)==null?void 0:n.session)==null?void 0:r.access_token;if(!e)throw new Error("Not authenticated");return{"Content-Type":"application/json",Authorization:`Bearer ${e}`}}async function $f(t){const e=await Vd(),n=await fetch("/api/designs/save",{method:"POST",headers:e,body:JSON.stringify(t)});if(!n.ok){const r=await n.json();throw new Error(r.error||"Unable to save your design. Please check your connection and try again.")}return n.json()}async function md({project_id:t,limit:e=50,offset:n=0,search:r}={}){const s=await Vd(),i=new URLSearchParams;t&&i.append("project_id",t),i.append("limit",e),i.append("offset",n),r&&i.append("search",r);const a=await fetch(`/api/designs/list?${i}`,{method:"GET",headers:s});if(!a.ok){const l=await a.json();throw new Error(l.error||"Unable to load your designs. Please refresh the page and try again.")}return a.json()}async function Ol(t){const e=await Vd(),n=await fetch(`/api/designs/by-id?id=${t}`,{method:"GET",headers:e});if(!n.ok){const r=await n.json();throw new Error(r.error||"Unable to open this design. It may have been deleted or you may not have permission to view it.")}return n.json()}async function oE(t){const e=await Vd(),n=await fetch(`/api/designs/by-id?id=${t}`,{method:"DELETE",headers:e});if(!n.ok){const r=await n.json();throw new Error(r.error||"Unable to delete this design. Please check your connection and try again.")}return n.json()}class aE extends $.Component{constructor(n){super(n);Ul(this,"handleReset",()=>{this.setState({hasError:!1,error:null,errorInfo:null})});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(n){return{hasError:!0}}componentDidCatch(n,r){console.error("[ErrorBoundary] Caught error:",n,r),this.setState({error:n,errorInfo:r})}render(){return this.state.hasError?o.jsxs("div",{className:"error-boundary",children:[o.jsxs("div",{className:"error-content",children:[o.jsx("h1",{children:"Something went wrong"}),o.jsx("p",{children:"We're sorry, but something unexpected happened. Please try refreshing the page."}),o.jsxs("div",{className:"error-actions",children:[o.jsx("button",{onClick:this.handleReset,className:"btn-primary",children:"Try Again"}),o.jsx("button",{onClick:()=>window.location.reload(),className:"btn-secondary",children:"Refresh Page"})]}),!1]}),o.jsx("style",{jsx:!0,children:`
            .error-boundary {
              min-height: 100vh;
              display: flex;
              align-items: center;
              justify-content: center;
              padding: 2rem;
              background: #f9fafb;
            }

            .error-content {
              max-width: 500px;
              text-align: center;
              background: white;
              padding: 3rem;
              border-radius: 12px;
              box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            }

            h1 {
              color: #1e4a7a;
              margin: 0 0 1rem 0;
              font-size: 1.75rem;
            }

            p {
              color: #6b7280;
              margin: 0 0 2rem 0;
              line-height: 1.6;
            }

            .error-actions {
              display: flex;
              gap: 1rem;
              justify-content: center;
            }

            .btn-primary,
            .btn-secondary {
              padding: 0.75rem 1.5rem;
              border-radius: 6px;
              font-weight: 500;
              cursor: pointer;
              transition: all 0.2s;
              border: none;
            }

            .btn-primary {
              background: #ff6b35;
              color: white;
            }

            .btn-primary:hover {
              background: #e55a2b;
              transform: translateY(-1px);
            }

            .btn-secondary {
              background: white;
              color: #374151;
              border: 1px solid #d1d5db;
            }

            .btn-secondary:hover {
              background: #f9fafb;
            }

            .error-details {
              margin-top: 2rem;
              text-align: left;
              font-size: 0.875rem;
            }

            .error-details summary {
              cursor: pointer;
              color: #6b7280;
              margin-bottom: 0.5rem;
            }

            .error-details pre {
              background: #f3f4f6;
              padding: 1rem;
              border-radius: 4px;
              overflow-x: auto;
              font-size: 0.75rem;
              color: #dc2626;
            }
          `})]}):this.props.children}}const lE="modulepreload",cE=function(t){return"/"+t},k0={},dE=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),l=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));s=Promise.allSettled(n.map(c=>{if(c=cE(c),c in k0)return;k0[c]=!0;const d=c.endsWith(".css"),u=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const p=document.createElement("link");if(p.rel=d?"stylesheet":lE,d||(p.as="script"),p.crossOrigin="",p.href=c,l&&p.setAttribute("nonce",l),document.head.appendChild(p),d)return new Promise((h,f)=>{p.addEventListener("load",h),p.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(a){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=a,window.dispatchEvent(l),!l.defaultPrevented)throw a}return s.then(a=>{for(const l of a||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})},j0=t=>{let e;const n=new Set,r=(d,u)=>{const p=typeof d=="function"?d(e):d;if(!Object.is(p,e)){const h=e;e=u??(typeof p!="object"||p===null)?p:Object.assign({},e,p),n.forEach(f=>f(e,h))}},s=()=>e,l={setState:r,getState:s,getInitialState:()=>c,subscribe:d=>(n.add(d),()=>n.delete(d))},c=e=t(r,s,l);return l},uE=t=>t?j0(t):j0,hE=t=>t;function pE(t,e=hE){const n=$.useSyncExternalStore(t.subscribe,$.useCallback(()=>e(t.getState()),[t,e]),$.useCallback(()=>e(t.getInitialState()),[t,e]));return $.useDebugValue(n),n}const C0=t=>{const e=uE(t),n=r=>pE(e,r);return Object.assign(n,e),n},o1=t=>t?C0(t):C0,E0={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},_l=new Map,gc=t=>{const e=_l.get(t);return e?Object.fromEntries(Object.entries(e.stores).map(([n,r])=>[n,r.getState()])):{}},fE=(t,e,n)=>{if(t===void 0)return{type:"untracked",connection:e.connect(n)};const r=_l.get(n.name);if(r)return{type:"tracked",store:t,...r};const s={connection:e.connect(n),stores:{}};return _l.set(n.name,s),{type:"tracked",store:t,...s}},mE=(t,e)=>{if(e===void 0)return;const n=_l.get(t);n&&(delete n.stores[e],Object.keys(n.stores).length===0&&_l.delete(t))},gE=t=>{var e,n;if(!t)return;const r=t.split(`
`),s=r.findIndex(a=>a.includes("api.setState"));if(s<0)return;const i=((e=r[s+1])==null?void 0:e.trim())||"";return(n=/.+ (.+) .+/.exec(i))==null?void 0:n[1]},yE=(t,e={})=>(n,r,s)=>{const{enabled:i,anonymousActionType:a,store:l,...c}=e;let d;try{d=(i??(E0?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!d)return t(n,r,s);const{connection:u,...p}=fE(l,d,c);let h=!0;s.setState=(g,v,y)=>{const x=n(g,v);if(!h)return x;const b=y===void 0?{type:a||gE(new Error().stack)||"anonymous"}:typeof y=="string"?{type:y}:y;return l===void 0?(u==null||u.send(b,r()),x):(u==null||u.send({...b,type:`${l}/${b.type}`},{...gc(c.name),[l]:s.getState()}),x)},s.devtools={cleanup:()=>{u&&typeof u.unsubscribe=="function"&&u.unsubscribe(),mE(c.name,l)}};const f=(...g)=>{const v=h;h=!1,n(...g),h=v},m=t(s.setState,r,s);if(p.type==="untracked"?u==null||u.init(m):(p.stores[p.store]=s,u==null||u.init(Object.fromEntries(Object.entries(p.stores).map(([g,v])=>[g,g===p.store?m:v.getState()])))),s.dispatchFromDevtools&&typeof s.dispatch=="function"){let g=!1;const v=s.dispatch;s.dispatch=(...y)=>{(E0?"production":void 0)!=="production"&&y[0].type==="__setState"&&!g&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),g=!0),v(...y)}}return u.subscribe(g=>{var v;switch(g.type){case"ACTION":if(typeof g.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return Gu(g.payload,y=>{if(y.type==="__setState"){if(l===void 0){f(y.state);return}Object.keys(y.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format.
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const x=y.state[l];if(x==null)return;JSON.stringify(s.getState())!==JSON.stringify(x)&&f(x);return}s.dispatchFromDevtools&&typeof s.dispatch=="function"&&s.dispatch(y)});case"DISPATCH":switch(g.payload.type){case"RESET":return f(m),l===void 0?u==null?void 0:u.init(s.getState()):u==null?void 0:u.init(gc(c.name));case"COMMIT":if(l===void 0){u==null||u.init(s.getState());return}return u==null?void 0:u.init(gc(c.name));case"ROLLBACK":return Gu(g.state,y=>{if(l===void 0){f(y),u==null||u.init(s.getState());return}f(y[l]),u==null||u.init(gc(c.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return Gu(g.state,y=>{if(l===void 0){f(y);return}JSON.stringify(s.getState())!==JSON.stringify(y[l])&&f(y[l])});case"IMPORT_STATE":{const{nextLiftedState:y}=g.payload,x=(v=y.computedStates.slice(-1)[0])==null?void 0:v.state;if(!x)return;f(l===void 0?x:x[l]),u==null||u.send(null,y);return}case"PAUSE_RECORDING":return h=!h}return}}),m},a1=yE,Gu=(t,e)=>{let n;try{n=JSON.parse(t)}catch(r){console.error("[zustand devtools middleware] Could not parse the received json",r)}n!==void 0&&e(n)};function sa(t){let e=t%2147483647;return e<=0&&(e+=2147483646),function(){return e=e*16807%2147483647,(e-1)/2147483646}}function T0(t,e,n){const r=sa(n),s=[],i=.4,a=.5,l=.5;for(let c=0;c<t;c++){const d=c/t*Math.PI*2-Math.PI/2,u=(r()-.5)*.4*e,p=d+u,h=1+(r()-.5)*e*.8,f=i*h,m=a+f*Math.cos(p),g=l+f*Math.sin(p),v=.35/t*(1+e*(r()-.5)),y=p+Math.PI/2,x=(r()-.5)*.3*e,b=y+Math.PI+x,w=y+x;s.push({x:m,y:g,handleIn:{x:Math.cos(b)*v,y:Math.sin(b)*v},handleOut:{x:Math.cos(w)*v,y:Math.sin(w)*v}})}return s}function xE(t,e,n){if(!t||t.length<3)return vE(e,n);const r=[],s=t.length;for(let i=0;i<s;i++){const a=t[i],l=t[(i+1)%s],c=a.x*e,d=a.y*n,u=l.x*e,p=l.y*n,h=c+a.handleOut.x*e,f=d+a.handleOut.y*n,m=u+l.handleIn.x*e,g=p+l.handleIn.y*n;i===0&&r.push(`M ${c.toFixed(2)},${d.toFixed(2)}`),r.push(`C ${h.toFixed(2)},${f.toFixed(2)} ${m.toFixed(2)},${g.toFixed(2)} ${u.toFixed(2)},${p.toFixed(2)}`)}return r.push("Z"),r.join(" ")}function vE(t,e){const n=t/2,r=e/2,s=n,i=r;return`M ${s-n},${i} A ${n},${r} 0 1,1 ${s+n},${i} A ${n},${r} 0 1,1 ${s-n},${i} Z`}function bE(){const n=[];for(let a=0;a<8;a++){const l=a/8*Math.PI*2-Math.PI/2,c=.5+.4*Math.cos(l),d=.5+.4*Math.sin(l),u=l+Math.PI/2;n.push({x:c,y:d,handleIn:{x:Math.cos(u+Math.PI)*.2,y:Math.sin(u+Math.PI)*.2},handleOut:{x:Math.cos(u)*.2,y:Math.sin(u)*.2}})}return n}const Zo={organic:{name:"Organic",description:"Smooth, gentle curves like a pebble",minPoints:6,maxPoints:8,blobinessMin:.15,blobinessMax:.25,handleLengthFactor:.4,radiusVariation:.15},splashy:{name:"Splashy",description:"Irregular edges, some spikes like paint splatter",minPoints:10,maxPoints:12,blobinessMin:.3,blobinessMax:.5,handleLengthFactor:.25,radiusVariation:.35},cloudy:{name:"Cloudy",description:"Soft bumps, fluffy cloud-like appearance",minPoints:8,maxPoints:10,blobinessMin:.2,blobinessMax:.3,handleLengthFactor:.5,radiusVariation:.2},rocky:{name:"Rocky",description:"Angular variations, irregular stone-like edges",minPoints:8,maxPoints:12,blobinessMin:.25,blobinessMax:.4,handleLengthFactor:.2,radiusVariation:.3}};function Ea(t,e){const n=Zo[t]||Zo.organic,r=sa(e),s=Math.floor(r()*(n.maxPoints-n.minPoints+1))+n.minPoints,i=n.blobinessMin+r()*(n.blobinessMax-n.blobinessMin),a=[],l=.4,c=.5,d=.5;for(let u=0;u<s;u++){const p=u/s*Math.PI*2-Math.PI/2,h=(r()-.5)*.4*i,f=p+h,m=1+(r()-.5)*n.radiusVariation*2,g=l*m,v=c+g*Math.cos(f),y=d+g*Math.sin(f),b=n.handleLengthFactor/s*(.8+r()*.4),w=f+Math.PI/2,S=(r()-.5)*.3*i,_=w+Math.PI+S,k=w+S;a.push({x:v,y,handleIn:{x:Math.cos(_)*b,y:Math.sin(_)*b},handleOut:{x:Math.cos(k)*b,y:Math.sin(k)*b}})}return a}function wE(t,e,n,r){return{x:n?.5-(t-.5):t,y:r?.5-(e-.5):e}}function _E(t,e,n,r){return{x:n?-t:t,y:r?-e:e}}function l1(t,e,n,r=4){const s=[{index:t,mirrorX:!1,mirrorY:!1,rotationAngle:0}];if(n==="none"||!n)return s;if(n==="horizontal"){const i=(e-t)%e;return i!==t&&s.push({index:i,mirrorX:!0,mirrorY:!1,rotationAngle:0}),s}if(n==="vertical"){const i=(Math.floor(e/2)-t+e)%e;return i!==t&&s.push({index:i,mirrorX:!1,mirrorY:!0,rotationAngle:0}),s}if(n==="radial"){for(let i=1;i<r;i++){const a=Math.round(t+i*e/r)%e;if(a!==t){const l=i*2*Math.PI/r;s.push({index:a,mirrorX:!1,mirrorY:!1,rotationAngle:l})}}return s}return s}function SE(t,e,n,r,s,i=4){if(s==="none"||!s)return t.map((l,c)=>c!==e?l:{...l,x:n,y:r});const a=l1(e,t.length,s,i);return t.map((l,c)=>{const d=a.find(p=>p.index===c);if(!d)return l;if(d.rotationAngle!==0){const f=n-.5,m=r-.5,g=Math.cos(d.rotationAngle),v=Math.sin(d.rotationAngle);return{...l,x:.5+f*g-m*v,y:.5+f*v+m*g}}const u=wE(n,r,d.mirrorX,d.mirrorY);return{...l,x:u.x,y:u.y}})}function kE(t,e,n,r,s,i,a=4){if(i==="none"||!i)return t.map((c,d)=>d!==e?c:{...c,[n]:{x:r,y:s}});const l=l1(e,t.length,i,a);return t.map((c,d)=>{const u=l.find(m=>m.index===d);if(!u)return c;let p=n,h=r,f=s;if(u.rotationAngle!==0){const m=Math.cos(u.rotationAngle),g=Math.sin(u.rotationAngle);h=r*m-s*g,f=r*g+s*m}else{const m=_E(r,s,u.mirrorX,u.mirrorY);h=m.x,f=m.y}return{...c,[p]:{x:h,y:f}}})}function c1(t,e,n,r=!0,s=!1){if(!t||t.length<2)return"";const i=[],a=t.length;for(let l=0;l<a;l++){const c=t[l],d=l===a-1,u=r?t[(l+1)%a]:d?null:t[l+1],p=c.x*e,h=c.y*n;if(l===0&&i.push(`M ${p.toFixed(2)},${h.toFixed(2)}`),!u)continue;const f=u.x*e,m=u.y*n;if(s&&c.handleOut&&u.handleIn){const g=p+c.handleOut.x*e,v=h+c.handleOut.y*n,y=f+u.handleIn.x*e,x=m+u.handleIn.y*n;i.push(`C ${g.toFixed(2)},${v.toFixed(2)} ${y.toFixed(2)},${x.toFixed(2)} ${f.toFixed(2)},${m.toFixed(2)}`)}else i.push(`L ${f.toFixed(2)},${m.toFixed(2)}`)}return r&&i.push("Z"),i.join(" ")}function Vu(t,e=!0,n=.3){if(!t||t.length<2)return t;const r=t.length,s=t.map(i=>({...i,handleIn:{x:0,y:0},handleOut:{x:0,y:0}}));for(let i=0;i<r;i++){const a=e?t[(i-1+r)%r]:i>0?t[i-1]:t[i];t[i];const l=e?t[(i+1)%r]:i<r-1?t[i+1]:t[i],c=l.x-a.x,d=l.y-a.y,u=n*.5;!e&&i===0?(s[i].handleIn={x:0,y:0},s[i].handleOut={x:c*u,y:d*u}):!e&&i===r-1?(s[i].handleIn={x:-c*u,y:-d*u},s[i].handleOut={x:0,y:0}):(s[i].handleIn={x:-c*u,y:-d*u},s[i].handleOut={x:c*u,y:d*u})}return s}function jE(t,e,n,r){const s={x:n,y:r,handleIn:{x:0,y:0},handleOut:{x:0,y:0}},i=[...t];return i.splice(e,0,s),i}function CE(t,e,n=3){if(t.length<=n)return null;const r=[...t];return r.splice(e,1),r}const gd={splash:{name:"Splash / Water",description:"Central splash with flying droplets",icon:"",defaultSize:{width:4e3,height:4e3}},cloud:{name:"Cloud / Fluffy",description:"Layered cumulus cloud with bumps",icon:"",defaultSize:{width:5e3,height:3e3}},flower:{name:"Flower / Organic",description:"Center with surrounding petals",icon:"",defaultSize:{width:4e3,height:4e3}},abstract:{name:"Abstract / Artistic",description:"Overlapping organic forms",icon:"",defaultSize:{width:5e3,height:5e3}}};function N0({centerX:t,centerY:e,totalWidth:n,totalHeight:r,seed:s,primaryColor:i,secondaryColor:a}){const l=sa(s),c=[],d=.55+l()*.15,u=n*d,p=r*d;c.push({shapeType:"blob",blobStyle:"splashy",width_mm:u,height_mm:p,position:{x:t-u/2,y:e-p/2},seed:s,fillColor:i,rotation:0});const h=5+Math.floor(l()*5),f=Math.min(n,r)*.5;for(let m=0;m<h;m++){const g=m/h*Math.PI*2,v=(l()-.5)*.6,y=g+v,x=.6+l()*.35,b=f*x,w=(.08+l()*.08)*Math.min(n,r),S=t+Math.cos(y)*b-w/2,_=e+Math.sin(y)*b-w/2;c.push({shapeType:"blob",blobStyle:"organic",width_mm:w,height_mm:w*(.8+l()*.4),position:{x:S,y:_},seed:s+m+1,fillColor:a||i,rotation:l()*360})}return c}function EE({centerX:t,centerY:e,totalWidth:n,totalHeight:r,seed:s,primaryColor:i,secondaryColor:a}){const l=sa(s),c=[],d=n*.9,u=r*.45,p=e+r*.15;c.push({shapeType:"blob",blobStyle:"cloudy",width_mm:d,height_mm:u,position:{x:t-d/2,y:p-u/2},seed:s,fillColor:i,rotation:0});const h=4+Math.floor(l()*4),f=e-r*.15;for(let m=0;m<h;m++){const v=(m-(h-1)/2)/((h-1)/2||1)*n*.35,y=(.25+l()*.15)*Math.min(n,r),x=(l()-.5)*r*.15;c.push({shapeType:"blob",blobStyle:"organic",width_mm:y,height_mm:y*.85,position:{x:t+v-y/2,y:f+x-y/2},seed:s+m+1,fillColor:a||i,rotation:l()*20-10})}return c}function TE({centerX:t,centerY:e,totalWidth:n,totalHeight:r,seed:s,primaryColor:i,secondaryColor:a}){const l=sa(s),c=[],d=5+Math.floor(l()*4),u=Math.min(n,r);for(let h=0;h<d;h++){const f=h/d*Math.PI*2-Math.PI/2,m=(.22+l()*.08)*u,g=(.35+l()*.1)*u,v=u*.28,y=t+Math.cos(f)*v-m/2,x=e+Math.sin(f)*v-g/2,b=f*180/Math.PI+90;c.push({shapeType:"blob",blobStyle:"organic",width_mm:m,height_mm:g,position:{x:y,y:x},seed:s+h+1,fillColor:i,rotation:b})}const p=(.15+l()*.07)*u;return c.push({shapeType:"blob",blobStyle:"organic",width_mm:p,height_mm:p,position:{x:t-p/2,y:e-p/2},seed:s,fillColor:a||i,rotation:0}),c}function NE({centerX:t,centerY:e,totalWidth:n,totalHeight:r,seed:s,primaryColor:i,secondaryColor:a}){const l=sa(s),c=[],d=3+Math.floor(l()*3),u=["organic","splashy","cloudy","rocky"],p=[i,a||i];for(let h=0;h<d;h++){const f=(.25+l()*.25)*n,m=(.25+l()*.25)*r,g=(l()-.5)*n*.4,v=(l()-.5)*r*.4,y=l()*360,x=u[Math.floor(l()*u.length)],b=p[h%p.length];c.push({shapeType:"blob",blobStyle:x,width_mm:f,height_mm:m,position:{x:t+g-f/2,y:e+v-m/2},seed:s+h,fillColor:b,rotation:y})}return c}function P0(t,e){switch(t){case"splash":return N0(e);case"cloud":return EE(e);case"flower":return TE(e);case"abstract":return NE(e);default:return console.warn(`Unknown compound type: ${t}, defaulting to splash`),N0(e)}}function PE(t){switch(t){case"l-shape":return[{x:0,y:0,handleIn:{x:0,y:0},handleOut:{x:0,y:0}},{x:.5,y:0,handleIn:{x:0,y:0},handleOut:{x:0,y:0}},{x:.5,y:.5,handleIn:{x:0,y:0},handleOut:{x:0,y:0}},{x:1,y:.5,handleIn:{x:0,y:0},handleOut:{x:0,y:0}},{x:1,y:1,handleIn:{x:0,y:0},handleOut:{x:0,y:0}},{x:0,y:1,handleIn:{x:0,y:0},handleOut:{x:0,y:0}}];case"custom":default:return[{x:0,y:0,handleIn:{x:0,y:0},handleOut:{x:0,y:0}},{x:1,y:0,handleIn:{x:0,y:0},handleOut:{x:0,y:0}},{x:1,y:1,handleIn:{x:0,y:0},handleOut:{x:0,y:0}},{x:0,y:1,handleIn:{x:0,y:0},handleOut:{x:0,y:0}}]}}function RE(t){switch(t){case"l-shape":return[{x:0,y:0},{x:.6,y:0},{x:.6,y:.4},{x:1,y:.4},{x:1,y:1},{x:0,y:1}];case"u-shape":return[{x:0,y:0},{x:.35,y:0},{x:.35,y:.4},{x:.65,y:.4},{x:.65,y:0},{x:1,y:0},{x:1,y:1},{x:0,y:1}];case"t-shape":return[{x:0,y:0},{x:1,y:0},{x:1,y:.4},{x:.7,y:.4},{x:.7,y:1},{x:.3,y:1},{x:.3,y:.4},{x:0,y:.4}];case"rectangle":default:return null}}const Yu={surface:{width_mm:5e4,length_mm:5e4,color:{tpv_code:"RH12",hex:"#006C55",name:"Dark Green"},boundary:{type:"rectangle",controlPoints:null}},courts:{},selectedCourtId:null,tracks:{},selectedTrackId:null,motifs:{},selectedMotifId:null,shapes:{},selectedShapeId:null,texts:{},selectedTextId:null,editingTextId:null,exclusionZones:{},selectedExclusionZoneId:null,groups:{},selectedGroupId:null,selectedElementIds:[],editingGroupId:null,elementOrder:[],customMarkings:[],backgroundZones:[],designName:"Untitled Design",designDescription:"",designTags:[],history:[],historyIndex:-1,maxHistory:50,showCourtLibrary:!0,showPropertiesPanel:!0,propertiesPanelUserClosed:!1,showColorEditor:!1,snapToGrid:!0,gridSize_mm:100,mobileLibraryOpen:!1,mobilePropertiesOpen:!1,mobileColoursOpen:!1,mobileActiveTab:"courts",standaloneMode:!1,standaloneDesignId:null,pathDrawingMode:!1,activePathId:null,isSaving:!1,lastSaved:null},it=o1(a1((t,e)=>({...Yu,setSurfaceDimensions:(n,r)=>{t(s=>({surface:{...s.surface,width_mm:n,length_mm:r}})),e().addToHistory()},setSurfaceColor:n=>{t(r=>({surface:{...r.surface,color:n}})),e().addToHistory()},setSurfaceBoundaryPreset:n=>{const r=RE(n);t(s=>({surface:{...s.surface,boundary:{type:n,controlPoints:r}}})),e().addToHistory()},setSurfaceBoundaryPoints:n=>{t(r=>({surface:{...r.surface,boundary:{type:"custom",controlPoints:n}}})),e().addToHistory()},resetSurfaceBoundary:()=>{t(n=>({surface:{...n.surface,boundary:{type:"rectangle",controlPoints:null}}})),e().addToHistory()},addCourt:(n,r)=>{const s=`court-${Date.now()}`,i=u=>({RH01:{tpv_code:"RH01",hex:"#A5362F",name:"Standard Red"},RH02:{tpv_code:"RH02",hex:"#E21F2F",name:"Bright Red"},RH10:{tpv_code:"RH10",hex:"#609B63",name:"Standard Green"},RH11:{tpv_code:"RH11",hex:"#3BB44A",name:"Bright Green"},RH12:{tpv_code:"RH12",hex:"#006C55",name:"Dark Green"},RH20:{tpv_code:"RH20",hex:"#0075BC",name:"Standard Blue"},RH21:{tpv_code:"RH21",hex:"#493D8C",name:"Purple"},RH22:{tpv_code:"RH22",hex:"#47AFE3",name:"Light Blue"},RH23:{tpv_code:"RH23",hex:"#039DC4",name:"Azure"},RH26:{tpv_code:"RH26",hex:"#00A6A3",name:"Turquoise"},RH30:{tpv_code:"RH30",hex:"#E4C4AA",name:"Standard Beige"},RH31:{tpv_code:"RH31",hex:"#E8E3D8",name:"Cream"},RH32:{tpv_code:"RH32",hex:"#8B5F3C",name:"Brown"},RH40:{tpv_code:"RH40",hex:"#E5A144",name:"Mustard Yellow"},RH41:{tpv_code:"RH41",hex:"#FFD833",name:"Bright Yellow"},RH50:{tpv_code:"RH50",hex:"#F15B32",name:"Orange"},RH60:{tpv_code:"RH60",hex:"#59595B",name:"Dark Grey"},RH61:{tpv_code:"RH61",hex:"#939598",name:"Light Grey"},RH65:{tpv_code:"RH65",hex:"#D9D9D6",name:"Pale Grey"},RH70:{tpv_code:"RH70",hex:"#231F20",name:"Black"},RH90:{tpv_code:"RH90",hex:"#E8457E",name:"Funky Pink"}})[u]||{tpv_code:"RH31",hex:"#E8E3D8",name:"Cream"},a={};if(r.defaultLineColor){const u=i(r.defaultLineColor);r.markings.forEach(p=>{a[p.id]=u})}const l={};if(r.defaultLineColor&&r.zones){const u=i(r.defaultLineColor);r.zones.forEach(p=>{l[p.id]=u})}const c=r.defaultSurfaceColor?i(r.defaultSurfaceColor):null,d={id:s,templateId:n,template:r,position:{x:e().surface.width_mm/2-r.dimensions.width_mm/2,y:e().surface.length_mm/2-r.dimensions.length_mm/2},rotation:0,scale:1,lineColorOverrides:a,zoneColorOverrides:l,courtSurfaceColor:c};t(u=>({courts:{...u.courts,[s]:d},elementOrder:[...u.elementOrder,s],selectedCourtId:s,selectedTrackId:null})),e().addToHistory()},removeCourt:n=>{const{[n]:r,...s}=e().courts;t(i=>({courts:s,elementOrder:i.elementOrder.filter(a=>a!==n),selectedCourtId:i.selectedCourtId===n?null:i.selectedCourtId})),e().addToHistory()},updateCourtPosition:(n,r)=>{t(s=>({courts:{...s.courts,[n]:{...s.courts[n],position:r}}}))},updateCourtRotation:(n,r)=>{t(s=>({courts:{...s.courts,[n]:{...s.courts[n],rotation:r}}}))},updateCourtScale:(n,r)=>{t(s=>({courts:{...s.courts,[n]:{...s.courts[n],scale:r}}}))},duplicateCourt:n=>{const r=e().courts[n];if(!r)return;const s=`court-${Date.now()}`,i={...r,id:s,position:{x:r.position.x+500,y:r.position.y+500}};t(a=>({courts:{...a.courts,[s]:i},elementOrder:[...a.elementOrder,s],selectedCourtId:s,selectedTrackId:null})),e().addToHistory()},duplicateTrack:n=>{const r=e().tracks[n];if(!r)return;const s=`track-${Date.now()}`,i={...r,id:s,position:{x:r.position.x+500,y:r.position.y+500}};t(a=>({tracks:{...a.tracks,[s]:i},elementOrder:[...a.elementOrder,s],selectedTrackId:s,selectedCourtId:null})),e().addToHistory()},renameElement:(n,r)=>{n.startsWith("court-")?t(s=>({courts:{...s.courts,[n]:{...s.courts[n],customName:r}}})):n.startsWith("track-")?t(s=>({tracks:{...s.tracks,[n]:{...s.tracks[n],customName:r}}})):n.startsWith("motif-")?t(s=>({motifs:{...s.motifs,[n]:{...s.motifs[n],customName:r}}})):n.startsWith("shape-")?t(s=>({shapes:{...s.shapes,[n]:{...s.shapes[n],customName:r}}})):n.startsWith("text-")?t(s=>({texts:{...s.texts,[n]:{...s.texts[n],customName:r}}})):n.startsWith("exclusion-")&&t(s=>({exclusionZones:{...s.exclusionZones,[n]:{...s.exclusionZones[n],customName:r}}})),e().addToHistory()},toggleElementLock:n=>{n.startsWith("court-")?t(r=>{var s;return{courts:{...r.courts,[n]:{...r.courts[n],locked:!((s=r.courts[n])!=null&&s.locked)}}}}):n.startsWith("track-")?t(r=>{var s;return{tracks:{...r.tracks,[n]:{...r.tracks[n],locked:!((s=r.tracks[n])!=null&&s.locked)}}}}):n.startsWith("motif-")?t(r=>{var s;return{motifs:{...r.motifs,[n]:{...r.motifs[n],locked:!((s=r.motifs[n])!=null&&s.locked)}}}}):n.startsWith("shape-")?t(r=>{var s;return{shapes:{...r.shapes,[n]:{...r.shapes[n],locked:!((s=r.shapes[n])!=null&&s.locked)}}}}):n.startsWith("text-")?t(r=>{var s;return{texts:{...r.texts,[n]:{...r.texts[n],locked:!((s=r.texts[n])!=null&&s.locked)}}}}):n.startsWith("exclusion-")&&t(r=>{var s;return{exclusionZones:{...r.exclusionZones,[n]:{...r.exclusionZones[n],locked:!((s=r.exclusionZones[n])!=null&&s.locked)}}}}),e().addToHistory()},toggleElementVisibility:n=>{n.startsWith("court-")?t(r=>{var s;return{courts:{...r.courts,[n]:{...r.courts[n],visible:((s=r.courts[n])==null?void 0:s.visible)===!1}}}}):n.startsWith("track-")?t(r=>{var s;return{tracks:{...r.tracks,[n]:{...r.tracks[n],visible:((s=r.tracks[n])==null?void 0:s.visible)===!1}}}}):n.startsWith("motif-")?t(r=>{var s;return{motifs:{...r.motifs,[n]:{...r.motifs[n],visible:((s=r.motifs[n])==null?void 0:s.visible)===!1}}}}):n.startsWith("shape-")?t(r=>{var s;return{shapes:{...r.shapes,[n]:{...r.shapes[n],visible:((s=r.shapes[n])==null?void 0:s.visible)===!1}}}}):n.startsWith("text-")?t(r=>{var s;return{texts:{...r.texts,[n]:{...r.texts[n],visible:((s=r.texts[n])==null?void 0:s.visible)===!1}}}}):n.startsWith("exclusion-")&&t(r=>{var s;return{exclusionZones:{...r.exclusionZones,[n]:{...r.exclusionZones[n],visible:((s=r.exclusionZones[n])==null?void 0:s.visible)===!1}}}}),e().addToHistory()},setLineColor:(n,r,s)=>{t(i=>({courts:{...i.courts,[n]:{...i.courts[n],lineColorOverrides:{...i.courts[n].lineColorOverrides,[r]:s}}}})),e().addToHistory()},setZoneColor:(n,r,s)=>{t(i=>({courts:{...i.courts,[n]:{...i.courts[n],zoneColorOverrides:{...i.courts[n].zoneColorOverrides,[r]:s}}}})),e().addToHistory()},resetCourtColors:n=>{t(r=>({courts:{...r.courts,[n]:{...r.courts[n],lineColorOverrides:{},zoneColorOverrides:{}}}})),e().addToHistory()},setCourtSurfaceColor:(n,r)=>{t(s=>({courts:{...s.courts,[n]:{...s.courts[n],courtSurfaceColor:r}}})),e().addToHistory()},selectCourt:n=>{const{propertiesPanelUserClosed:r}=e();t(r?{selectedCourtId:n,selectedTrackId:null,selectedMotifId:null,selectedShapeId:null,selectedTextId:null,selectedExclusionZoneId:null,editingTextId:null}:{selectedCourtId:n,selectedTrackId:null,selectedMotifId:null,selectedShapeId:null,selectedTextId:null,selectedExclusionZoneId:null,editingTextId:null,showPropertiesPanel:!0})},deselectCourt:()=>{t({selectedCourtId:null,showPropertiesPanel:!1,propertiesPanelUserClosed:!0})},setElementOrder:n=>{t({elementOrder:n})},moveElementUp:n=>{const{elementOrder:r}=e(),s=r.indexOf(n);if(s<r.length-1){const i=[...r];[i[s],i[s+1]]=[i[s+1],i[s]],t({elementOrder:i}),e().addToHistory()}},moveElementDown:n=>{const{elementOrder:r}=e(),s=r.indexOf(n);if(s>0){const i=[...r];[i[s],i[s-1]]=[i[s-1],i[s]],t({elementOrder:i}),e().addToHistory()}},bringToFront:n=>{const{elementOrder:r}=e(),s=r.filter(i=>i!==n);s.push(n),t({elementOrder:s}),e().addToHistory()},sendToBack:n=>{const{elementOrder:r}=e(),s=r.filter(i=>i!==n);s.unshift(n),t({elementOrder:s}),e().addToHistory()},addTrack:(n,r)=>{const s=`track-${Date.now()}`,i=e().surface,a=i.width_mm,l=i.length_mm,c=y=>({RH01:{tpv_code:"RH01",hex:"#A5362F",name:"Standard Red"},RH31:{tpv_code:"RH31",hex:"#E8E3D8",name:"Cream"},RH30:{tpv_code:"RH30",hex:"#E4C4AA",name:"Standard Beige"},RH20:{tpv_code:"RH20",hex:"#0075BC",name:"Standard Blue"},RH12:{tpv_code:"RH12",hex:"#006C55",name:"Dark Green"}})[y]||{tpv_code:y,hex:"#A5362F",name:"Standard Red"},d=r.defaultTrackSurfaceColor?c(r.defaultTrackSurfaceColor):c("RH01"),u=c("RH31"),p=r.trackType==="straight";let h,f,m;const g={enabled:!1,depth_mm:800,lineWidth_mm:50,style:"staggered",direction:"counterclockwise",startPosition:0};if(p){const y=r.parameters.numLanes,x=r.parameters.laneWidth_mm,b=y*x,w=Math.max(a,l)*.9,S=r.parameters.height_mm||1e5,_=Math.min(S,w);h={...r.parameters,width_mm:b,height_mm:_,cornerRadius:{topLeft:0,topRight:0,bottomLeft:0,bottomRight:0},laneWidth_mm:x,startingBoxes:{...g,...r.parameters.startingBoxes}},m=90,f={x:a/2-b/2,y:l/2-_/2}}else{const y=a*.9,x=l*.9,b=r.parameters.width_mm||25e3,w=r.parameters.height_mm||15e3,S=y/b,_=x/w,k=Math.min(S,_),E=r.parameters.cornerRadius||{topLeft:3e3,topRight:3e3,bottomLeft:3e3,bottomRight:3e3},T={topLeft:E.topLeft*k,topRight:E.topRight*k,bottomLeft:E.bottomLeft*k,bottomRight:E.bottomRight*k};h={...r.parameters,width_mm:y,height_mm:x,cornerRadius:T,laneWidth_mm:r.parameters.laneWidth_mm,startingBoxes:{...g,...r.parameters.startingBoxes}},m=0,f={x:a/2-y/2,y:l/2-x/2}}const v={id:s,templateId:n,template:r,position:f,rotation:m,parameters:h,trackSurfaceColor:d,laneSurfaceColors:[],trackLineColor:u};t(y=>({tracks:{...y.tracks,[s]:v},elementOrder:[...y.elementOrder,s],selectedTrackId:s,selectedCourtId:null})),e().addToHistory()},removeTrack:n=>{const{[n]:r,...s}=e().tracks;t(i=>({tracks:s,elementOrder:i.elementOrder.filter(a=>a!==n),selectedTrackId:i.selectedTrackId===n?null:i.selectedTrackId})),e().addToHistory()},updateTrackParameters:(n,r)=>{t(s=>{var p;const i=s.tracks[n];if(!i)return s;const a=i.parameters,l={...a,...r},c=((p=i.template)==null?void 0:p.trackType)==="straight";let d=i.position,u=i.laneSurfaceColors||[];if(r.numLanes!==void 0&&r.numLanes!==a.numLanes&&r.numLanes<a.numLanes&&(u=u.slice(0,r.numLanes)),c&&r.numLanes!==void 0&&r.numLanes!==a.numLanes){const h=a.laneWidth_mm,f=a.numLanes*h,m=r.numLanes*h;l.width_mm=m;const g=i.position.x+f/2,v=i.position.y+a.height_mm/2;d={x:g-m/2,y:v-l.height_mm/2}}return{tracks:{...s.tracks,[n]:{...i,parameters:l,position:d,laneSurfaceColors:u}}}}),e().addToHistory()},updateTrackPosition:(n,r)=>{t(s=>({tracks:{...s.tracks,[n]:{...s.tracks[n],position:r}}}))},updateTrackRotation:(n,r)=>{t(s=>({tracks:{...s.tracks,[n]:{...s.tracks[n],rotation:r}}}))},setTrackSurfaceColor:(n,r)=>{t(s=>({tracks:{...s.tracks,[n]:{...s.tracks[n],trackSurfaceColor:r}}})),e().addToHistory()},setTrackLineColor:(n,r)=>{t(s=>({tracks:{...s.tracks,[n]:{...s.tracks[n],trackLineColor:r}}})),e().addToHistory()},setLaneSurfaceColor:(n,r,s)=>{t(i=>{const a=i.tracks[n];if(!a)return i;const l=[...a.laneSurfaceColors||[]];for(;l.length<r;)l.push(null);return l[r-1]=s,{tracks:{...i.tracks,[n]:{...a,laneSurfaceColors:l}}}}),e().addToHistory()},resetLaneSurfaceColors:n=>{t(r=>({tracks:{...r.tracks,[n]:{...r.tracks[n],laneSurfaceColors:[]}}})),e().addToHistory()},selectTrack:n=>{const{propertiesPanelUserClosed:r}=e();t(r?{selectedTrackId:n,selectedCourtId:null,selectedMotifId:null,selectedShapeId:null,selectedTextId:null,selectedExclusionZoneId:null,editingTextId:null}:{selectedTrackId:n,selectedCourtId:null,selectedMotifId:null,selectedShapeId:null,selectedTextId:null,selectedExclusionZoneId:null,editingTextId:null,showPropertiesPanel:!0})},deselectTrack:()=>{t({selectedTrackId:null,showPropertiesPanel:!1,propertiesPanelUserClosed:!0})},addMotif:(n,r,s,i,a,l=null,c={})=>{const d=`motif-${Date.now()}`,u=e().surface,p={id:d,type:"motif",sourceDesignId:n,sourceDesignName:r,sourceThumbnailUrl:l,solidSvgContent:c.solidSvgContent||s,blendSvgContent:c.blendSvgContent||null,hasBothVersions:c.hasBothVersions||!1,viewMode:"solid",svgContent:c.solidSvgContent||s,originalWidth_mm:i,originalHeight_mm:a,position:{x:u.width_mm/2-i/2,y:u.length_mm/2-a/2},rotation:0,scale:1};t(h=>({motifs:{...h.motifs,[d]:p},elementOrder:[...h.elementOrder,d],selectedMotifId:d,selectedCourtId:null,selectedTrackId:null})),e().addToHistory()},removeMotif:n=>{const{[n]:r,...s}=e().motifs;t(i=>({motifs:s,elementOrder:i.elementOrder.filter(a=>a!==n),selectedMotifId:i.selectedMotifId===n?null:i.selectedMotifId})),e().addToHistory()},updateMotifPosition:(n,r)=>{t(s=>({motifs:{...s.motifs,[n]:{...s.motifs[n],position:r}}}))},updateMotifRotation:(n,r)=>{t(s=>({motifs:{...s.motifs,[n]:{...s.motifs[n],rotation:r}}}))},updateMotifScale:(n,r)=>{t(s=>({motifs:{...s.motifs,[n]:{...s.motifs[n],scale:r}}}))},setMotifViewMode:(n,r)=>{const s=e().motifs[n];if(!s)return;const i=r==="blend"?s.blendSvgContent||s.solidSvgContent:s.solidSvgContent||s.blendSvgContent;t(a=>({motifs:{...a.motifs,[n]:{...a.motifs[n],viewMode:r,svgContent:i}}})),e().addToHistory()},duplicateMotif:n=>{const r=e().motifs[n];if(!r)return;const s=`motif-${Date.now()}`,i={...r,id:s,position:{x:r.position.x+500,y:r.position.y+500}};t(a=>({motifs:{...a.motifs,[s]:i},elementOrder:[...a.elementOrder,s],selectedMotifId:s,selectedCourtId:null,selectedTrackId:null})),e().addToHistory()},refreshMotif:async n=>{const r=e().motifs[n];if(!r)return{success:!1,error:"Motif not found"};try{const{fetchMotifFromDesign:s}=await dE(async()=>{const{fetchMotifFromDesign:c}=await Promise.resolve().then(()=>I5);return{fetchMotifFromDesign:c}},void 0),i=await s(r.sourceDesignId),l=(r.viewMode||"solid")==="blend"?i.blendSvgContent||i.solidSvgContent:i.solidSvgContent||i.blendSvgContent;return t(c=>({motifs:{...c.motifs,[n]:{...c.motifs[n],solidSvgContent:i.solidSvgContent,blendSvgContent:i.blendSvgContent,hasBothVersions:i.hasBothVersions,svgContent:l,sourceThumbnailUrl:i.sourceThumbnailUrl,sourceDesignName:i.sourceDesignName,originalWidth_mm:i.originalWidth_mm,originalHeight_mm:i.originalHeight_mm}},lastModified:Date.now()})),e().addToHistory(),{success:!0}}catch(s){return console.error("[MOTIF] Failed to refresh:",s),{success:!1,error:s.message}}},selectMotif:n=>{const{propertiesPanelUserClosed:r}=e();t(r?{selectedMotifId:n,selectedCourtId:null,selectedTrackId:null,selectedShapeId:null,selectedTextId:null,selectedExclusionZoneId:null,editingTextId:null}:{selectedMotifId:n,selectedCourtId:null,selectedTrackId:null,selectedShapeId:null,selectedTextId:null,selectedExclusionZoneId:null,editingTextId:null,showPropertiesPanel:!0})},deselectMotif:()=>{t({selectedMotifId:null,showPropertiesPanel:!1,propertiesPanelUserClosed:!0})},addShape:(n="rectangle")=>{const r=`shape-${Date.now()}`,s=e().surface,i=e().shapes,a={rectangle:{sides:4,aspectLocked:!1,width:3e3,height:2e3},square:{sides:4,aspectLocked:!0,width:2e3,height:2e3},circle:{sides:32,aspectLocked:!0,width:2e3,height:2e3},triangle:{sides:3,aspectLocked:!0,width:2e3,height:2e3},pentagon:{sides:5,aspectLocked:!0,width:2e3,height:2e3},hexagon:{sides:6,aspectLocked:!0,width:2e3,height:2e3},polygon:{sides:6,aspectLocked:!0,width:2e3,height:2e3},star:{sides:5,aspectLocked:!0,width:2e3,height:2e3,starMode:!0,innerRadius:.5}},l=[{tpv_code:"RH20",hex:"#0075BC",name:"Standard Blue"},{tpv_code:"RH50",hex:"#F15B32",name:"Orange"},{tpv_code:"RH10",hex:"#609B63",name:"Standard Green"},{tpv_code:"RH21",hex:"#493D8C",name:"Purple"},{tpv_code:"RH41",hex:"#FFD833",name:"Bright Yellow"},{tpv_code:"RH26",hex:"#00A6A3",name:"Turquoise"},{tpv_code:"RH02",hex:"#E21F2F",name:"Bright Red"},{tpv_code:"RH90",hex:"#E8457E",name:"Funky Pink"}],c=Object.keys(i).length,d=l[c%l.length];if(n==="blob"){const h=Math.floor(Math.random()*1e5),f="organic",m=Ea(f,h),g={id:r,type:"shape",shapeType:"blob",blobStyle:f,seed:h,controlPoints:m,editPointsVisible:!1,numPoints:m.length,blobiness:.2,symmetryMode:"none",radialSymmetryCount:4,width_mm:2e3,height_mm:2e3,position:{x:s.width_mm/2-1e3,y:s.length_mm/2-1e3},rotation:0,fillColor:d,strokeEnabled:!1,strokeColor:null,strokeWidth_mm:50,aspectLocked:!1,locked:!1,visible:!0};t(v=>({shapes:{...v.shapes,[r]:g},elementOrder:[...v.elementOrder,r],selectedShapeId:r,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null})),e().addToHistory();return}const u=a[n]||a.rectangle,p={id:r,type:"shape",shapeType:"polygon",sides:u.sides,width_mm:u.width,height_mm:u.height,cornerRadius:0,starMode:u.starMode||!1,innerRadius:u.innerRadius||.5,position:{x:s.width_mm/2-u.width/2,y:s.length_mm/2-u.height/2},rotation:0,fillColor:d,strokeEnabled:!1,strokeColor:null,strokeWidth_mm:50,aspectLocked:u.aspectLocked,locked:!1,visible:!0};t(h=>({shapes:{...h.shapes,[r]:p},elementOrder:[...h.elementOrder,r],selectedShapeId:r,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null})),e().addToHistory()},removeShape:n=>{const{[n]:r,...s}=e().shapes;t(i=>({shapes:s,elementOrder:i.elementOrder.filter(a=>a!==n),selectedShapeId:i.selectedShapeId===n?null:i.selectedShapeId})),e().addToHistory()},updateShapePosition:(n,r)=>{t(s=>({shapes:{...s.shapes,[n]:{...s.shapes[n],position:r}}}))},updateShapeDimensions:(n,r,s)=>{t(i=>({shapes:{...i.shapes,[n]:{...i.shapes[n],width_mm:r,height_mm:s}}}))},updateShapeSides:(n,r)=>{t(s=>{const i=s.shapes[n];if(!i)return s;const a=Math.max(3,Math.min(32,r));let l=i.width_mm,c=i.height_mm;if(a!==4){const d=Math.min(i.width_mm,i.height_mm);l=d,c=d}return{shapes:{...s.shapes,[n]:{...i,sides:a,width_mm:l,height_mm:c,aspectLocked:a!==4}}}}),e().addToHistory()},updateShapeCornerRadius:(n,r)=>{t(s=>({shapes:{...s.shapes,[n]:{...s.shapes[n],cornerRadius:Math.max(0,Math.min(100,r))}}})),e().addToHistory()},setShapeStarMode:(n,r)=>{t(s=>{const i=s.shapes[n];return{shapes:{...s.shapes,[n]:{...i,starMode:r,sides:r&&i.sides<3?3:i.sides,innerRadius:i.innerRadius??.5}}}}),e().addToHistory()},setShapeInnerRadius:(n,r)=>{t(s=>({shapes:{...s.shapes,[n]:{...s.shapes[n],innerRadius:Math.max(.1,Math.min(.9,r))}}})),e().addToHistory()},updateShapeRotation:(n,r)=>{t(s=>({shapes:{...s.shapes,[n]:{...s.shapes[n],rotation:r}}}))},setShapeFillColor:(n,r)=>{t(s=>({shapes:{...s.shapes,[n]:{...s.shapes[n],fillColor:r}}})),e().addToHistory()},setShapeStroke:(n,r,s=null,i=50)=>{t(a=>({shapes:{...a.shapes,[n]:{...a.shapes[n],strokeEnabled:r,strokeColor:s,strokeWidth_mm:i}}})),e().addToHistory()},setShapeAspectLock:(n,r)=>{t(s=>{const i=s.shapes[n];return{shapes:{...s.shapes,[n]:{...i,aspectLocked:r}}}}),e().addToHistory()},updateBlobPoints:(n,r)=>{t(s=>{const i=s.shapes[n];if(!i||i.shapeType!=="blob")return s;const a=T0(r,i.blobiness,i.seed);return{shapes:{...s.shapes,[n]:{...i,numPoints:r,controlPoints:a}}}}),e().addToHistory()},updateBlobiness:(n,r)=>{t(s=>{const i=s.shapes[n];if(!i||i.shapeType!=="blob")return s;const a=T0(i.numPoints,r,i.seed);return{shapes:{...s.shapes,[n]:{...i,blobiness:r,controlPoints:a}}}}),e().addToHistory()},randomizeBlob:n=>{t(r=>{const s=r.shapes[n];if(!s||s.shapeType!=="blob")return r;const i=Math.floor(Math.random()*1e5),a=s.blobStyle||"organic",l=Ea(a,i);return{shapes:{...r.shapes,[n]:{...s,seed:i,controlPoints:l,numPoints:l.length}}}}),e().addToHistory()},setBlobStyle:(n,r)=>{t(s=>{const i=s.shapes[n];if(!i||i.shapeType!=="blob")return s;const a=Ea(r,i.seed);return{shapes:{...s.shapes,[n]:{...i,blobStyle:r,controlPoints:a,numPoints:a.length}}}}),e().addToHistory()},setEditPointsVisible:(n,r)=>{t(s=>{const i=s.shapes[n];return!i||i.shapeType!=="blob"&&i.shapeType!=="path"?s:{shapes:{...s.shapes,[n]:{...i,editPointsVisible:r}}}})},resetBlob:n=>{t(r=>{const s=r.shapes[n];if(!s||s.shapeType!=="blob")return r;const i=bE();return{shapes:{...r.shapes,[n]:{...s,blobiness:0,controlPoints:i}}}}),e().addToHistory()},updateBlobControlPoint:(n,r,s,i)=>{t(a=>{const l=a.shapes[n];if(!l||l.shapeType!=="blob"||!l.controlPoints)return a;const c=Math.max(0,Math.min(1,s)),d=Math.max(0,Math.min(1,i)),u=SE(l.controlPoints,r,c,d,l.symmetryMode||"none",l.radialSymmetryCount||4);return{shapes:{...a.shapes,[n]:{...l,controlPoints:u}}}})},updateBlobHandle:(n,r,s,i,a)=>{t(l=>{const c=l.shapes[n];if(!c||c.shapeType!=="blob"||!c.controlPoints)return l;const d=kE(c.controlPoints,r,s,i,a,c.symmetryMode||"none",c.radialSymmetryCount||4);return{shapes:{...l.shapes,[n]:{...c,controlPoints:d}}}})},commitBlobEdit:()=>{e().addToHistory()},setBlobSymmetry:(n,r,s=4)=>{t(i=>{const a=i.shapes[n];return!a||a.shapeType!=="blob"?i:{shapes:{...i.shapes,[n]:{...a,symmetryMode:r,radialSymmetryCount:s}}}}),e().addToHistory()},applyBlobPreset:(n,r)=>{const s=BLOB_PRESETS[r];!s||!s.controlPoints||(t(i=>{const a=i.shapes[n];return!a||a.shapeType!=="blob"?i:{shapes:{...i.shapes,[n]:{...a,numPoints:s.controlPoints.length,blobiness:0,controlPoints:JSON.parse(JSON.stringify(s.controlPoints))}}}}),e().addToHistory())},duplicateShape:n=>{const r=e().shapes[n];if(!r)return;const s=`shape-${Date.now()}`,i={...r,id:s,position:{x:r.position.x+500,y:r.position.y+500}};t(a=>({shapes:{...a.shapes,[s]:i},elementOrder:[...a.elementOrder,s],selectedShapeId:s,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null})),e().addToHistory()},selectShape:n=>{const{propertiesPanelUserClosed:r}=e();t(r?{selectedShapeId:n,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,selectedTextId:null,selectedExclusionZoneId:null,editingTextId:null}:{selectedShapeId:n,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,selectedTextId:null,selectedExclusionZoneId:null,editingTextId:null,showPropertiesPanel:!0})},deselectShape:()=>{t({selectedShapeId:null,showPropertiesPanel:!1,propertiesPanelUserClosed:!0})},startPathDrawing:()=>{const n=`shape-path-${Date.now()}`,r=e().surface,s=e().shapes,i=[{tpv_code:"RH20",hex:"#0075BC",name:"Standard Blue"},{tpv_code:"RH50",hex:"#F15B32",name:"Orange"},{tpv_code:"RH10",hex:"#609B63",name:"Standard Green"},{tpv_code:"RH21",hex:"#493D8C",name:"Purple"}],a=Object.keys(s).length,l=i[a%i.length],c={id:n,type:"shape",shapeType:"path",controlPoints:[],closed:!0,smooth:!1,editPointsVisible:!1,width_mm:r.width_mm,height_mm:r.length_mm,position:{x:0,y:0},rotation:0,fillColor:l,strokeEnabled:!0,strokeColor:{tpv_code:"RH70",hex:"#A8A9AD",name:"Light Grey"},strokeWidth_mm:20,aspectLocked:!1,locked:!1,visible:!0};t({pathDrawingMode:!0,activePathId:n,shapes:{...e().shapes,[n]:c},elementOrder:[...e().elementOrder,n],selectedShapeId:n,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,selectedTextId:null})},addPointToPath:(n,r)=>{const{activePathId:s,shapes:i,pathDrawingMode:a}=e();if(!a||!s)return;const l=i[s];if(!l||l.shapeType!=="path")return;const c={x:n,y:r,handleIn:{x:0,y:0},handleOut:{x:0,y:0}};t({shapes:{...i,[s]:{...l,controlPoints:[...l.controlPoints,c]}}})},finishPath:()=>{const{activePathId:n,shapes:r,pathDrawingMode:s}=e();if(!s||!n)return;const i=r[n];if(!i)return;if(i.controlPoints.length<3){e().cancelPath();return}const a=i.controlPoints;let l=1/0,c=1/0,d=-1/0,u=-1/0;for(const w of a)l=Math.min(l,w.x),c=Math.min(c,w.y),d=Math.max(d,w.x),u=Math.max(u,w.y);const p=d-l||1,h=u-c||1,f=.05,m=a.map(w=>({...w,x:f+(w.x-l)/p*(1-2*f),y:f+(w.y-c)/h*(1-2*f)})),g=e().surface,v=p*g.width_mm,y=h*g.length_mm,x=l*g.width_mm,b=c*g.length_mm;t({pathDrawingMode:!1,activePathId:null,shapes:{...r,[n]:{...i,controlPoints:m,width_mm:Math.max(500,v),height_mm:Math.max(500,y),position:{x,y:b},strokeEnabled:!1}}}),e().addToHistory()},cancelPath:()=>{const{activePathId:n,shapes:r,elementOrder:s}=e();if(!n){t({pathDrawingMode:!1});return}const i={...r};delete i[n],t({pathDrawingMode:!1,activePathId:null,shapes:i,elementOrder:s.filter(a=>a!==n),selectedShapeId:null})},setPathClosed:(n,r)=>{const s=e().shapes[n];!s||s.shapeType!=="path"||(t({shapes:{...e().shapes,[n]:{...s,closed:r}}}),e().addToHistory())},setPathSmooth:(n,r)=>{const s=e().shapes[n];if(!s||s.shapeType!=="path")return;let i=s.controlPoints;r&&s.controlPoints.length>=2?i=Vu(s.controlPoints,s.closed,.3):i=s.controlPoints.map(a=>({...a,handleIn:{x:0,y:0},handleOut:{x:0,y:0}})),t({shapes:{...e().shapes,[n]:{...s,smooth:r,controlPoints:i}}}),e().addToHistory()},updatePathControlPoint:(n,r,s,i)=>{const a=e().shapes[n];if(!a||a.shapeType!=="path")return;const l=[...a.controlPoints];l[r]={...l[r],x:s,y:i},t({shapes:{...e().shapes,[n]:{...a,controlPoints:l}}})},updatePathHandle:(n,r,s,i,a)=>{const l=e().shapes[n];if(!l||l.shapeType!=="path")return;const c=[...l.controlPoints];c[r]={...c[r],[s]:{x:i,y:a}},t({shapes:{...e().shapes,[n]:{...l,controlPoints:c}}})},addPointToExistingPath:(n,r,s,i)=>{const a=e().shapes[n];if(!a||a.shapeType!=="path")return;const l=jE(a.controlPoints,r,s,i),c=a.smooth?Vu(l,a.closed,.3):l;t({shapes:{...e().shapes,[n]:{...a,controlPoints:c}}}),e().addToHistory()},removePointFromPath:(n,r)=>{const s=e().shapes[n];if(!s||s.shapeType!=="path")return;const i=s.closed?3:2,a=CE(s.controlPoints,r,i);if(!a){console.log("[STORE] Cannot remove point - minimum reached");return}const l=s.smooth?Vu(a,s.closed,.3):a;t({shapes:{...e().shapes,[n]:{...s,controlPoints:l}}}),e().addToHistory()},commitPathEdit:()=>{e().addToHistory()},addText:()=>{const{surface:n}=e(),r=`text-${Date.now()}`,s={id:r,type:"text",content:"",fontFamily:"Open Sans, sans-serif",fontSize_mm:500,fontWeight:"normal",fontStyle:"normal",textAlign:"left",position:{x:n.width_mm/2,y:n.length_mm/2},rotation:0,fillColor:{tpv_code:"RH70",hex:"#1C1C1C",name:"Black"},strokeColor:null,strokeWidth_mm:0,locked:!1,visible:!0,customName:null};t(i=>({texts:{...i.texts,[r]:s},elementOrder:[...i.elementOrder,r],selectedTextId:r,editingTextId:r,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,selectedShapeId:null})),e().addToHistory()},removeText:n=>{t(r=>{const{[n]:s,...i}=r.texts;return{texts:i,elementOrder:r.elementOrder.filter(a=>a!==n),selectedTextId:r.selectedTextId===n?null:r.selectedTextId,editingTextId:r.editingTextId===n?null:r.editingTextId}}),e().addToHistory()},selectText:n=>{const{propertiesPanelUserClosed:r}=e();t(r?{selectedTextId:n,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,selectedShapeId:null,selectedExclusionZoneId:null}:{selectedTextId:n,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,selectedShapeId:null,selectedExclusionZoneId:null,showPropertiesPanel:!0})},deselectText:()=>{t({selectedTextId:null,editingTextId:null,showPropertiesPanel:!1,propertiesPanelUserClosed:!0})},startEditingText:n=>{t({editingTextId:n})},stopEditingText:()=>{t({editingTextId:null}),e().addToHistory()},updateTextContent:(n,r)=>{t(s=>({texts:{...s.texts,[n]:{...s.texts[n],content:r}}}))},updateTextPosition:(n,r)=>{t(s=>({texts:{...s.texts,[n]:{...s.texts[n],position:r}}}))},updateTextFontSize:(n,r)=>{t(s=>({texts:{...s.texts,[n]:{...s.texts[n],fontSize_mm:Math.max(50,r)}}})),e().addToHistory()},updateTextFont:(n,r,s,i)=>{t(a=>({texts:{...a.texts,[n]:{...a.texts[n],fontFamily:r,fontWeight:s,fontStyle:i}}})),e().addToHistory()},updateTextAlign:(n,r)=>{t(s=>({texts:{...s.texts,[n]:{...s.texts[n],textAlign:r}}})),e().addToHistory()},updateTextRotation:(n,r)=>{t(s=>({texts:{...s.texts,[n]:{...s.texts[n],rotation:r}}}))},setTextFillColor:(n,r)=>{t(s=>({texts:{...s.texts,[n]:{...s.texts[n],fillColor:r}}})),e().addToHistory()},setTextStrokeColor:(n,r)=>{t(s=>({texts:{...s.texts,[n]:{...s.texts[n],strokeColor:r}}})),e().addToHistory()},updateTextStrokeWidth:(n,r)=>{t(s=>({texts:{...s.texts,[n]:{...s.texts[n],strokeWidth_mm:r}}}))},duplicateText:n=>{const{texts:r}=e(),s=r[n];if(!s)return;const i=`text-${Date.now()}`,a={...s,id:i,position:{x:s.position.x+500,y:s.position.y+500},customName:s.customName?`${s.customName} (copy)`:null};t(l=>({texts:{...l.texts,[i]:a},elementOrder:[...l.elementOrder,i],selectedTextId:i,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,selectedShapeId:null})),e().addToHistory()},addExclusionZone:(n="rectangle")=>{const r=`exclusion-${Date.now()}`,s=e().surface,i={rectangle:{shapeType:"polygon",sides:4,width:3e3,height:2e3},square:{shapeType:"polygon",sides:4,width:2e3,height:2e3},circle:{shapeType:"polygon",sides:32,width:2e3,height:2e3},"l-shape":{shapeType:"path",width:4e3,height:3e3},custom:{shapeType:"path",width:3e3,height:3e3}},a=i[n]||i.rectangle,l={id:r,type:"exclusion",shapeType:a.shapeType,sides:a.sides||4,width_mm:a.width,height_mm:a.height,position:{x:s.width_mm/2-a.width/2,y:s.length_mm/2-a.height/2},rotation:0,cornerRadius:0,locked:!1,visible:!0,customName:null,controlPoints:a.shapeType==="path"?PE(n):null};t(c=>({exclusionZones:{...c.exclusionZones,[r]:l},selectedExclusionZoneId:r,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,selectedShapeId:null,selectedTextId:null,editingTextId:null})),e().addToHistory()},removeExclusionZone:n=>{const{[n]:r,...s}=e().exclusionZones;t(i=>({exclusionZones:s,selectedExclusionZoneId:i.selectedExclusionZoneId===n?null:i.selectedExclusionZoneId})),e().addToHistory()},updateExclusionZonePosition:(n,r)=>{t(s=>({exclusionZones:{...s.exclusionZones,[n]:{...s.exclusionZones[n],position:r}}}))},updateExclusionZoneDimensions:(n,r,s)=>{t(i=>({exclusionZones:{...i.exclusionZones,[n]:{...i.exclusionZones[n],width_mm:r,height_mm:s}}}))},updateExclusionZoneRotation:(n,r)=>{t(s=>({exclusionZones:{...s.exclusionZones,[n]:{...s.exclusionZones[n],rotation:r}}}))},updateExclusionZoneCornerRadius:(n,r)=>{t(s=>({exclusionZones:{...s.exclusionZones,[n]:{...s.exclusionZones[n],cornerRadius:Math.max(0,Math.min(100,r))}}})),e().addToHistory()},selectExclusionZone:n=>{const{propertiesPanelUserClosed:r}=e();t(r?{selectedExclusionZoneId:n,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,selectedShapeId:null,selectedTextId:null,editingTextId:null}:{selectedExclusionZoneId:n,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,selectedShapeId:null,selectedTextId:null,editingTextId:null,showPropertiesPanel:!0})},deselectExclusionZone:()=>{t({selectedExclusionZoneId:null,showPropertiesPanel:!1,propertiesPanelUserClosed:!0})},duplicateExclusionZone:n=>{const r=e().exclusionZones[n];if(!r)return;const s=`exclusion-${Date.now()}`,i={...r,id:s,position:{x:r.position.x+500,y:r.position.y+500},customName:r.customName?`${r.customName} (copy)`:null};t(a=>({exclusionZones:{...a.exclusionZones,[s]:i},selectedExclusionZoneId:s,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,selectedShapeId:null,selectedTextId:null})),e().addToHistory()},calculateGroupBounds:n=>{const r=e();let s=1/0,i=1/0,a=-1/0,l=-1/0;for(const c of n){const d=r.shapes[c];if(d){const u=d.position.x,p=d.position.y;s=Math.min(s,u),i=Math.min(i,p),a=Math.max(a,u+d.width_mm),l=Math.max(l,p+d.height_mm)}}return s===1/0?{x:0,y:0,width:0,height:0}:{x:s,y:i,width:a-s,height:l-i}},createGroup:(n,r={})=>{if(!n||n.length<2)return null;const s=`group-${Date.now()}`,i=e().calculateGroupBounds(n),a={id:s,type:"group",childIds:[...n],compoundType:r.compoundType||null,generatorSeed:r.generatorSeed||null,customName:r.customName||null,locked:!1,visible:!0,bounds:i};return t(l=>{const c=Math.min(...n.map(u=>l.elementOrder.indexOf(u)).filter(u=>u>=0)),d=l.elementOrder.filter(u=>!n.includes(u));return d.splice(c,0,s),{groups:{...l.groups,[s]:a},elementOrder:d,selectedGroupId:s,selectedShapeId:null,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,selectedTextId:null,selectedExclusionZoneId:null,selectedElementIds:[]}}),e().addToHistory(),s},ungroup:n=>{const r=e().groups[n];r&&(t(s=>{const i=s.elementOrder.indexOf(n),a=s.elementOrder.filter(d=>d!==n);a.splice(i,0,...r.childIds);const{[n]:l,...c}=s.groups;return{groups:c,elementOrder:a,selectedGroupId:null,selectedElementIds:[...r.childIds]}}),e().addToHistory())},selectGroup:n=>{const{propertiesPanelUserClosed:r}=e();t({selectedGroupId:n,selectedShapeId:null,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,selectedTextId:null,selectedExclusionZoneId:null,editingTextId:null,editingGroupId:null,selectedElementIds:[],showPropertiesPanel:!r})},deselectGroup:()=>{t({selectedGroupId:null,editingGroupId:null,showPropertiesPanel:!1,propertiesPanelUserClosed:!0})},enterGroup:n=>{t({editingGroupId:n,selectedGroupId:null})},exitGroup:()=>{const n=e().editingGroupId;n&&t({editingGroupId:null,selectedGroupId:n,selectedShapeId:null})},updateGroupPosition:(n,r,s)=>{const i=e().groups[n];i&&t(a=>{const l={...a.shapes};for(const d of i.childIds)l[d]&&(l[d]={...l[d],position:{x:l[d].position.x+r,y:l[d].position.y+s}});const c={...i.bounds,x:i.bounds.x+r,y:i.bounds.y+s};return{shapes:l,groups:{...a.groups,[n]:{...i,bounds:c}}}})},commitGroupMove:()=>{e().addToHistory()},updateGroupScale:(n,r,s,i)=>{const a=e().groups[n];a&&t(l=>{const c={...l.shapes};for(const u of a.childIds){const p=c[u];if(p){const h=p.position.x-i.x,f=p.position.y-i.y;c[u]={...p,position:{x:i.x+h*r,y:i.y+f*s},width_mm:p.width_mm*r,height_mm:p.height_mm*s}}}const d=e().calculateGroupBounds(a.childIds);return{shapes:c,groups:{...l.groups,[n]:{...a,bounds:d}}}})},addToSelection:n=>{t(r=>r.selectedElementIds.includes(n)?{selectedElementIds:r.selectedElementIds.filter(s=>s!==n)}:{selectedElementIds:[...r.selectedElementIds,n],selectedShapeId:null,selectedGroupId:null,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,selectedTextId:null,selectedExclusionZoneId:null})},clearMultiSelection:()=>{t({selectedElementIds:[]})},groupSelected:()=>{const{selectedElementIds:n}=e();n.length<2||e().createGroup(n)},removeGroup:n=>{e().ungroup(n)},deleteGroupWithChildren:n=>{const r=e().groups[n];r&&(t(s=>{const i={...s.shapes};for(const d of r.childIds)delete i[d];const{[n]:a,...l}=s.groups,c=s.elementOrder.filter(d=>d!==n&&!r.childIds.includes(d));return{shapes:i,groups:l,elementOrder:c,selectedGroupId:null,selectedShapeId:null}}),e().addToHistory())},refreshGroupBounds:n=>{const r=e().groups[n];if(!r)return;const s=e().calculateGroupBounds(r.childIds);t(i=>({groups:{...i.groups,[n]:{...r,bounds:s}}}))},addCompoundBlob:(n="splash")=>{const r=e().surface,s=Math.floor(Math.random()*1e5),i=gd[n]||gd.splash,{width:a,height:l}=i.defaultSize,c=r.width_mm/2,d=r.length_mm/2,u=[{tpv_code:"RH20",hex:"#0075BC",name:"Standard Blue"},{tpv_code:"RH10",hex:"#609B63",name:"Standard Green"},{tpv_code:"RH50",hex:"#F15B32",name:"Orange"},{tpv_code:"RH21",hex:"#493D8C",name:"Purple"}],p=Object.keys(e().shapes).length,h=u[p%u.length],f=u[(p+1)%u.length],m=P0(n,{centerX:c,centerY:d,totalWidth:a,totalHeight:l,seed:s,primaryColor:h,secondaryColor:f}),g=Date.now(),v={},y=[];m.forEach((S,_)=>{var T;const k=`shape-${g}-${_}`;y.push(k);const E=Ea(S.blobStyle||"organic",S.seed);v[k]={id:k,type:"shape",shapeType:"blob",blobStyle:S.blobStyle||"organic",seed:S.seed,controlPoints:E,numPoints:E.length,blobiness:((T=Zo[S.blobStyle||"organic"])==null?void 0:T.blobinessMax)||.25,symmetryMode:"none",radialSymmetryCount:4,editPointsVisible:!1,width_mm:S.width_mm,height_mm:S.height_mm,position:S.position,rotation:S.rotation||0,fillColor:S.fillColor,strokeEnabled:!1,strokeColor:null,strokeWidth_mm:50,aspectLocked:!0,locked:!1,visible:!0,customName:null}});const x=`group-${g}`,b={x:c-a/2,y:d-l/2,width:a,height:l},w={id:x,type:"group",childIds:y,compoundType:n,generatorSeed:s,customName:i.name,locked:!1,visible:!0,bounds:b};return t(S=>({shapes:{...S.shapes,...v},groups:{...S.groups,[x]:w},elementOrder:[...S.elementOrder,...y],selectedGroupId:x,selectedShapeId:null,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,selectedTextId:null,selectedExclusionZoneId:null,selectedElementIds:[]})),e().addToHistory(),x},regenerateCompound:n=>{const r=e().groups[n];if(!r||!r.compoundType)return;const s=Math.floor(Math.random()*1e5),{bounds:i}=r,a=i.x+i.width/2,l=i.y+i.height/2,c=r.childIds[0],d=e().shapes[c],u=(d==null?void 0:d.fillColor)||{tpv_code:"RH20",hex:"#0075BC",name:"Standard Blue"},p=r.childIds[1],h=e().shapes[p],f=(h==null?void 0:h.fillColor)||u,m=P0(r.compoundType,{centerX:a,centerY:l,totalWidth:i.width,totalHeight:i.height,seed:s,primaryColor:u,secondaryColor:f}),g=r.childIds,v=Date.now(),y={},x=[];m.forEach((b,w)=>{var k;const S=`shape-${v}-${w}`;x.push(S);const _=Ea(b.blobStyle||"organic",b.seed);y[S]={id:S,type:"shape",shapeType:"blob",blobStyle:b.blobStyle||"organic",seed:b.seed,controlPoints:_,numPoints:_.length,blobiness:((k=Zo[b.blobStyle||"organic"])==null?void 0:k.blobinessMax)||.25,symmetryMode:"none",radialSymmetryCount:4,editPointsVisible:!1,width_mm:b.width_mm,height_mm:b.height_mm,position:b.position,rotation:b.rotation||0,fillColor:b.fillColor,strokeEnabled:!1,strokeColor:null,strokeWidth_mm:50,aspectLocked:!0,locked:!1,visible:!0,customName:null}}),t(b=>{const w={...b.shapes};for(const k of g)delete w[k];Object.assign(w,y);const S=b.elementOrder.findIndex(k=>g.includes(k));let _=b.elementOrder.filter(k=>!g.includes(k));return S>=0?_.splice(S,0,...x):_=[..._,...x],{shapes:w,elementOrder:_,groups:{...b.groups,[n]:{...r,childIds:x,generatorSeed:s}}}}),e().addToHistory()},addCustomMarking:n=>{t(r=>({customMarkings:[...r.customMarkings,{...n,id:`custom-${Date.now()}`}]})),e().addToHistory()},removeCustomMarking:n=>{t(r=>({customMarkings:r.customMarkings.filter(s=>s.id!==n)})),e().addToHistory()},addBackgroundZone:n=>{t(r=>({backgroundZones:[...r.backgroundZones,{...n,id:`zone-${Date.now()}`}]})),e().addToHistory()},removeBackgroundZone:n=>{t(r=>({backgroundZones:r.backgroundZones.filter(s=>s.id!==n)})),e().addToHistory()},setDesignName:n=>{t({designName:n})},setDesignDescription:n=>{t({designDescription:n})},setDesignTags:n=>{t({designTags:n})},addToHistory:()=>{const n=e(),r={surface:n.surface,courts:n.courts,tracks:n.tracks,motifs:n.motifs,shapes:n.shapes,texts:n.texts,exclusionZones:n.exclusionZones,elementOrder:n.elementOrder,customMarkings:n.customMarkings,backgroundZones:n.backgroundZones};t(s=>{const i=s.history.slice(0,s.historyIndex+1);return i.push(r),i.length>s.maxHistory&&i.shift(),{history:i,historyIndex:i.length-1}})},undo:()=>{const{history:n,historyIndex:r}=e();if(r>0){const s=n[r-1];t({...s,historyIndex:r-1})}},redo:()=>{const{history:n,historyIndex:r}=e();if(r<n.length-1){const s=n[r+1];t({...s,historyIndex:r+1})}},canUndo:()=>e().historyIndex>0,canRedo:()=>e().historyIndex<e().history.length-1,toggleCourtLibrary:()=>{t(n=>({showCourtLibrary:!n.showCourtLibrary}))},togglePropertiesPanel:()=>{t(n=>({showPropertiesPanel:!n.showPropertiesPanel,propertiesPanelUserClosed:!!n.showPropertiesPanel}))},setMobileLibraryOpen:n=>t({mobileLibraryOpen:n}),setMobilePropertiesOpen:n=>t({mobilePropertiesOpen:n}),setMobileColoursOpen:n=>t({mobileColoursOpen:n}),setMobileActiveTab:n=>t({mobileActiveTab:n}),closeMobileSheets:()=>t({mobileLibraryOpen:!1,mobilePropertiesOpen:!1,mobileColoursOpen:!1}),toggleColorEditor:()=>{t(n=>({showColorEditor:!n.showColorEditor}))},toggleSnapToGrid:()=>{t(n=>({snapToGrid:!n.snapToGrid}))},setGridSize:n=>{t({gridSize_mm:n})},toggleStandaloneMode:()=>{t(n=>({standaloneMode:!n.standaloneMode}))},setStandaloneMode:(n,r=null)=>{t({standaloneMode:n,standaloneDesignId:r})},setSaving:n=>{t({isSaving:n})},setLastSaved:n=>{t({lastSaved:n})},loadDesign:n=>{let r=n.elementOrder;!r&&(n.courtOrder||n.trackOrder)&&(r=[...n.trackOrder||[],...n.courtOrder||[]]),t({surface:n.surface||Yu.surface,courts:n.courts||{},tracks:n.tracks||{},motifs:n.motifs||{},shapes:n.shapes||{},texts:n.texts||{},exclusionZones:n.exclusionZones||{},elementOrder:r||[],customMarkings:n.customMarkings||[],backgroundZones:n.backgroundZones||[],designName:n.name||"Untitled Design",designDescription:n.description||"",designTags:n.tags||[],selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,selectedShapeId:null,selectedTextId:null,selectedExclusionZoneId:null,editingTextId:null,history:[],historyIndex:-1}),e().addToHistory()},exportDesignData:()=>{const n=e();return{surface:n.surface,courts:n.courts,tracks:n.tracks,motifs:n.motifs,shapes:n.shapes,texts:n.texts,exclusionZones:n.exclusionZones,elementOrder:n.elementOrder,customMarkings:n.customMarkings,backgroundZones:n.backgroundZones,name:n.designName,description:n.designDescription,tags:n.designTags}},resetDesign:()=>{t(Yu)},hasUnsavedChanges:()=>{const n=e();return Object.keys(n.courts).length>0||Object.keys(n.tracks).length>0||Object.keys(n.motifs).length>0||Object.keys(n.shapes).length>0||Object.keys(n.texts).length>0||Object.keys(n.exclusionZones).length>0}}),{name:"SportsDesignStore"})),R0={inputMode:"prompt",prompt:"",lengthMM:5e3,widthMM:5e3,selectedFileName:null,uploadedFileUrl:null,arMapping:null,result:null,jobId:null,blendRecipes:null,blendSvgUrl:null,colorMapping:null,blendEditedColors:new Map,solidRecipes:null,solidSvgUrl:null,solidColorMapping:null,solidEditedColors:new Map,viewMode:"solid",showFinalRecipes:!1,showSolidSummary:!1,regionOverrides:new Map,originalTaggedSvg:null,regionOverridesHistory:[new Map],historyIndex:0,designName:"",currentDesignId:null,hasGeneratedContent:!1,lastModified:null},yd=o1(a1((t,e)=>({...R0,setInputMode:n=>t({inputMode:n}),setPrompt:n=>t({prompt:n,lastModified:Date.now()}),setDimensions:(n,r)=>t({widthMM:n,lengthMM:r,lastModified:Date.now()}),setArMapping:n=>t({arMapping:n}),setSelectedFile:(n,r)=>t({selectedFileName:n,uploadedFileUrl:r,lastModified:Date.now()}),clearSelectedFile:()=>t({selectedFileName:null,uploadedFileUrl:null}),setGenerationResult:(n,r)=>t({result:n,jobId:r,hasGeneratedContent:!0,lastModified:Date.now()}),setResult:n=>t({result:n,hasGeneratedContent:!!n,lastModified:Date.now()}),setJobId:n=>t({jobId:n}),setBlendState:(n,r,s)=>t({blendRecipes:n,colorMapping:r,blendSvgUrl:s,lastModified:Date.now()}),setBlendRecipes:n=>t({blendRecipes:n,lastModified:Date.now()}),setColorMapping:n=>t({colorMapping:n,lastModified:Date.now()}),setBlendSvgUrl:n=>t({blendSvgUrl:n}),setBlendEditedColors:n=>t({blendEditedColors:n,lastModified:Date.now()}),updateBlendSvgUrl:n=>t({blendSvgUrl:n}),setSolidState:(n,r,s)=>t({solidRecipes:n,solidColorMapping:r,solidSvgUrl:s,lastModified:Date.now()}),setSolidRecipes:n=>t({solidRecipes:n,lastModified:Date.now()}),setSolidColorMapping:n=>t({solidColorMapping:n,lastModified:Date.now()}),setSolidSvgUrl:n=>t({solidSvgUrl:n}),setSolidEditedColors:n=>t({solidEditedColors:n,lastModified:Date.now()}),updateSolidSvgUrl:n=>t({solidSvgUrl:n}),setViewMode:n=>{if(n==="blend"){console.log("[STORE] Blend mode disabled - forcing solid mode");return}t({viewMode:n})},setShowFinalRecipes:n=>t({showFinalRecipes:n}),setShowSolidSummary:n=>t({showSolidSummary:n}),setOriginalTaggedSvg:n=>t({originalTaggedSvg:n}),setRegionOverrides:n=>t({regionOverrides:n,lastModified:Date.now()}),addRegionOverride:(n,r)=>{const s=new Map(e().regionOverrides),i=typeof r=="string"?{hex:r}:r;s.set(n,i);const a=e().regionOverridesHistory,l=e().historyIndex,c=a.slice(0,l+1);c.push(new Map(s)),c.length>50&&c.shift(),t({regionOverrides:s,regionOverridesHistory:c,historyIndex:c.length-1,lastModified:Date.now()})},setRegionOverridesHistory:n=>{t(typeof n=="function"?{regionOverridesHistory:n(e().regionOverridesHistory)}:{regionOverridesHistory:n})},setHistoryIndex:n=>{t(typeof n=="function"?{historyIndex:n(e().historyIndex)}:{historyIndex:n})},canUndo:()=>e().historyIndex>0,canRedo:()=>e().historyIndex<e().regionOverridesHistory.length-1,undo:()=>{const{historyIndex:n,regionOverridesHistory:r}=e();if(n>0){const s=n-1;t({historyIndex:s,regionOverrides:new Map(r[s])})}},redo:()=>{const{historyIndex:n,regionOverridesHistory:r}=e();if(n<r.length-1){const s=n+1;t({historyIndex:s,regionOverrides:new Map(r[s])})}},setRegionOverridesHistory:(n,r)=>t({regionOverridesHistory:n,historyIndex:r}),setDesignName:n=>t({designName:n}),setCurrentDesignId:n=>t({currentDesignId:n}),loadDesign:n=>{const r=n.regionOverrides||new Map,s=r.size>0?[new Map,new Map(r)]:[new Map],i=r.size>0?1:0;t({inputMode:n.inputMode||"prompt",prompt:n.prompt||"",lengthMM:n.lengthMM||5e3,widthMM:n.widthMM||5e3,uploadedFileUrl:n.selectedFile||null,result:n.result||null,blendRecipes:n.blendRecipes||null,solidRecipes:n.solidRecipes||null,colorMapping:n.colorMapping||null,solidColorMapping:n.solidColorMapping||null,solidEditedColors:n.solidEditedColors||new Map,blendEditedColors:n.blendEditedColors||new Map,blendSvgUrl:n.blendSvgUrl||null,solidSvgUrl:n.solidSvgUrl||null,viewMode:"solid",arMapping:n.arMapping||null,jobId:n.jobId||null,showFinalRecipes:n.showFinalRecipes||!1,showSolidSummary:n.showSolidSummary||!1,hasGeneratedContent:!!n.result,regionOverrides:r,originalTaggedSvg:n.originalTaggedSvg||null,regionOverridesHistory:s,historyIndex:i,lastModified:Date.now()})},exportDesignData:()=>{const n=e();return{inputMode:n.inputMode,prompt:n.prompt,lengthMM:n.lengthMM,widthMM:n.widthMM,uploadedFileUrl:n.uploadedFileUrl,result:n.result,blendRecipes:n.blendRecipes,solidRecipes:n.solidRecipes,colorMapping:n.colorMapping,solidColorMapping:n.solidColorMapping,solidEditedColors:n.solidEditedColors,blendEditedColors:n.blendEditedColors,viewMode:n.viewMode,arMapping:n.arMapping,jobId:n.jobId,showFinalRecipes:n.showFinalRecipes,showSolidSummary:n.showSolidSummary,regionOverrides:n.regionOverrides,designName:n.designName,currentDesignId:n.currentDesignId}},resetDesign:()=>{const{blendSvgUrl:n,solidSvgUrl:r}=e();n&&n.startsWith("blob:")&&URL.revokeObjectURL(n),r&&r.startsWith("blob:")&&URL.revokeObjectURL(r),t({...R0,blendEditedColors:new Map,solidEditedColors:new Map,regionOverrides:new Map,regionOverridesHistory:[new Map]})},hasUnsavedChanges:()=>{const n=e();return n.hasGeneratedContent||n.prompt.trim()!==""||n.selectedFileName!==null}}),{name:"PlaygroundDesignStore"})),d1={"basketball-full":{id:"basketball-full",name:"Basketball (Full Court)",sport:"basketball",standard:"FIBA 2020",category:"court",description:"Official FIBA standard full basketball court with all markings",dimensions:{length_mm:28e3,width_mm:15e3,min_surround_mm:2e3},defaultSurfaceColor:"RH20",defaultLineColor:"RH31",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:15e3,height:28e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"center-line",name:"Center Line",type:"line",params:{x1:0,y1:14e3,x2:15e3,y2:14e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-circle",name:"Center Circle",type:"circle",params:{cx:7500,cy:14e3,radius:1800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"three-point-arc-top",name:"Three-Point Arc (Top)",type:"arc",params:{cx:7500,cy:26425,radius:6750,startAngle:192,endAngle:348},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"three-point-arc-bottom",name:"Three-Point Arc (Bottom)",type:"arc",params:{cx:7500,cy:1575,radius:6750,startAngle:12,endAngle:168},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"three-point-line-bottom-left",name:"Three-Point Line Bottom Left",type:"line",params:{x1:900,y1:0,x2:900,y2:2990},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"three-point-line-bottom-right",name:"Three-Point Line Bottom Right",type:"line",params:{x1:14100,y1:0,x2:14100,y2:2990},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"three-point-line-top-left",name:"Three-Point Line Top Left",type:"line",params:{x1:900,y1:25010,x2:900,y2:28e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"three-point-line-top-right",name:"Three-Point Line Top Right",type:"line",params:{x1:14100,y1:25010,x2:14100,y2:28e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"free-throw-line-top",name:"Free Throw Line (Top)",type:"line",params:{x1:5050,y1:22200,x2:9950,y2:22200},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"free-throw-line-bottom",name:"Free Throw Line (Bottom)",type:"line",params:{x1:5050,y1:5800,x2:9950,y2:5800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"free-throw-circle-top",name:"Free Throw Circle (Top)",type:"circle",params:{cx:7500,cy:22200,radius:1800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"free-throw-circle-bottom",name:"Free Throw Circle (Bottom)",type:"circle",params:{cx:7500,cy:5800,radius:1800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"key-lane-top",name:"Key Lane (Top)",type:"rectangle",params:{x:5050,y:22200,width:4900,height:5800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"key-lane-bottom",name:"Key Lane (Bottom)",type:"rectangle",params:{x:5050,y:0,width:4900,height:5800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"restricted-area-top",name:"Restricted Area (Top)",type:"arc",params:{cx:7500,cy:28e3,radius:1250,startAngle:180,endAngle:360},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"restricted-area-bottom",name:"Restricted Area (Bottom)",type:"arc",params:{cx:7500,cy:0,radius:1250,startAngle:0,endAngle:180},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[{id:"key-area-top",name:"Key Area (Top)",type:"rectangle",params:{x:5050,y:22200,width:4900,height:5800},defaultColor:"RH20",paintable:!0,area_m2:28.42},{id:"key-area-bottom",name:"Key Area (Bottom)",type:"rectangle",params:{x:5050,y:0,width:4900,height:5800},defaultColor:"RH20",paintable:!0,area_m2:28.42}]},"netball-full":{id:"netball-full",name:"Netball (Full Court)",sport:"netball",standard:"World Netball 2020",category:"court",description:"Official World Netball standard court with goal circles and thirds",dimensions:{length_mm:30500,width_mm:15250,min_surround_mm:3050},defaultSurfaceColor:"RH01",defaultLineColor:"RH31",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:15250,height:30500},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"transverse-line-1",name:"Transverse Line 1",type:"line",params:{x1:0,y1:10167,x2:15250,y2:10167},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"transverse-line-2",name:"Transverse Line 2",type:"line",params:{x1:0,y1:20333,x2:15250,y2:20333},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-circle",name:"Center Circle",type:"circle",params:{cx:7625,cy:15250,radius:450},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"goal-circle-bottom",name:"Goal Circle (Bottom)",type:"arc",params:{cx:7625,cy:0,radius:4900,startAngle:0,endAngle:180},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"goal-circle-top",name:"Goal Circle (Top)",type:"arc",params:{cx:7625,cy:30500,radius:4900,startAngle:180,endAngle:360},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"tennis-doubles":{id:"tennis-doubles",name:"Tennis (Doubles)",sport:"tennis",standard:"ITF 2020",category:"court",description:"Official ITF standard doubles tennis court with all service boxes",dimensions:{length_mm:23770,width_mm:10970,min_surround_mm:3660},defaultSurfaceColor:"RH22",defaultLineColor:"RH29",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:10970,height:23770},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"singles-sideline-left",name:"Singles Sideline (Left)",type:"line",params:{x1:1370,y1:0,x2:1370,y2:23770},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"singles-sideline-right",name:"Singles Sideline (Right)",type:"line",params:{x1:9600,y1:0,x2:9600,y2:23770},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"service-line-bottom",name:"Service Line (Bottom)",type:"line",params:{x1:0,y1:6400,x2:10970,y2:6400},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"service-line-top",name:"Service Line (Top)",type:"line",params:{x1:0,y1:17370,x2:10970,y2:17370},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-service-line",name:"Center Service Line",type:"line",params:{x1:5485,y1:6400,x2:5485,y2:17370},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-mark-bottom",name:"Center Mark (Bottom)",type:"line",params:{x1:5485,y1:0,x2:5485,y2:100},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-mark-top",name:"Center Mark (Top)",type:"line",params:{x1:5485,y1:23670,x2:5485,y2:23770},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"futsal-standard":{id:"futsal-standard",name:"Futsal (5-a-side)",sport:"futsal",standard:"FIFA 2020",category:"court",description:"Official FIFA standard futsal court for international matches",dimensions:{length_mm:4e4,width_mm:2e4,min_surround_mm:1e3},defaultSurfaceColor:"RH50",defaultLineColor:"RH30",defaultLineWidth_mm:80,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:2e4,height:4e4},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"boundary"},{id:"center-line",name:"Center Line",type:"line",params:{x1:0,y1:2e4,x2:2e4,y2:2e4},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"center-circle",name:"Center Circle",type:"circle",params:{cx:1e4,cy:2e4,radius:3e3},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"center-spot",name:"Center Spot",type:"circle",params:{cx:1e4,cy:2e4,radius:100},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"penalty-area-bottom",name:"Penalty Area (Bottom)",type:"arc",params:{cx:1e4,cy:0,radius:6e3,startAngle:0,endAngle:180},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"penalty-area-top",name:"Penalty Area (Top)",type:"arc",params:{cx:1e4,cy:4e4,radius:6e3,startAngle:180,endAngle:360},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"penalty-mark-bottom",name:"Penalty Mark (Bottom)",type:"circle",params:{cx:1e4,cy:6e3,radius:100},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"penalty-mark-top",name:"Penalty Mark (Top)",type:"circle",params:{cx:1e4,cy:34e3,radius:100},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"second-penalty-mark-bottom",name:"Second Penalty Mark (Bottom)",type:"circle",params:{cx:1e4,cy:1e4,radius:100},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"second-penalty-mark-top",name:"Second Penalty Mark (Top)",type:"circle",params:{cx:1e4,cy:3e4,radius:100},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"corner-arc-bl",name:"Corner Arc (Bottom Left)",type:"arc",params:{cx:0,cy:0,radius:250,startAngle:0,endAngle:90},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"corner-arc-br",name:"Corner Arc (Bottom Right)",type:"arc",params:{cx:2e4,cy:0,radius:250,startAngle:90,endAngle:180},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"corner-arc-tl",name:"Corner Arc (Top Left)",type:"arc",params:{cx:0,cy:4e4,radius:250,startAngle:270,endAngle:360},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"corner-arc-tr",name:"Corner Arc (Top Right)",type:"arc",params:{cx:2e4,cy:4e4,radius:250,startAngle:180,endAngle:270},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"}],zones:[]},"volleyball-indoor":{id:"volleyball-indoor",name:"Volleyball (Indoor)",sport:"volleyball",standard:"FIVB",category:"court",description:"Official FIVB standard indoor volleyball court with attack lines",dimensions:{length_mm:18e3,width_mm:9e3,min_surround_mm:3e3},defaultSurfaceColor:"RH40",defaultLineColor:"RH29",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:9e3,height:18e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"center-line",name:"Center Line",type:"line",params:{x1:0,y1:9e3,x2:9e3,y2:9e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"attack-line-bottom",name:"Attack Line (Bottom)",type:"line",params:{x1:0,y1:6e3,x2:9e3,y2:6e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"attack-line-top",name:"Attack Line (Top)",type:"line",params:{x1:0,y1:12e3,x2:9e3,y2:12e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"badminton-full":{id:"badminton-full",name:"Badminton (Full Court)",sport:"badminton",standard:"BWF",category:"court",description:"Official BWF standard full badminton court with singles and doubles lines",dimensions:{length_mm:13400,width_mm:6100,min_surround_mm:1e3},defaultSurfaceColor:"RH26",defaultLineColor:"RH12",defaultLineWidth_mm:40,markings:[{id:"boundary",name:"Boundary Lines (Doubles)",type:"rectangle",params:{x:0,y:0,width:6100,height:13400},defaultColor:"RH31",lineWidth_mm:40,required:!0,category:"boundary"},{id:"singles-sideline-left",name:"Singles Sideline (Left)",type:"line",params:{x1:460,y1:0,x2:460,y2:13400},defaultColor:"RH31",lineWidth_mm:40,required:!0,category:"court-marking"},{id:"singles-sideline-right",name:"Singles Sideline (Right)",type:"line",params:{x1:5640,y1:0,x2:5640,y2:13400},defaultColor:"RH31",lineWidth_mm:40,required:!0,category:"court-marking"},{id:"short-service-line-bottom",name:"Short Service Line (Bottom)",type:"line",params:{x1:0,y1:1980,x2:6100,y2:1980},defaultColor:"RH31",lineWidth_mm:40,required:!0,category:"court-marking"},{id:"short-service-line-top",name:"Short Service Line (Top)",type:"line",params:{x1:0,y1:11420,x2:6100,y2:11420},defaultColor:"RH31",lineWidth_mm:40,required:!0,category:"court-marking"},{id:"doubles-long-service-line-bottom",name:"Doubles Long Service Line (Bottom)",type:"line",params:{x1:0,y1:760,x2:6100,y2:760},defaultColor:"RH31",lineWidth_mm:40,required:!0,category:"court-marking"},{id:"doubles-long-service-line-top",name:"Doubles Long Service Line (Top)",type:"line",params:{x1:0,y1:12640,x2:6100,y2:12640},defaultColor:"RH31",lineWidth_mm:40,required:!0,category:"court-marking"},{id:"center-service-line",name:"Center Service Line",type:"line",params:{x1:3050,y1:1980,x2:3050,y2:11420},defaultColor:"RH31",lineWidth_mm:40,required:!0,category:"court-marking"}],zones:[]},"pickleball-standard":{id:"pickleball-standard",name:"Pickleball",sport:"pickleball",standard:"USA Pickleball",category:"court",description:"Official USA Pickleball standard court with non-volley zone (kitchen)",dimensions:{length_mm:13410,width_mm:6100,min_surround_mm:1e3},defaultSurfaceColor:"RH11",defaultLineColor:"RH31",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:6100,height:13410},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"non-volley-zone-line-bottom",name:"Non-Volley Zone Line (Bottom)",type:"line",params:{x1:0,y1:2130,x2:6100,y2:2130},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"non-volley-zone-line-top",name:"Non-Volley Zone Line (Top)",type:"line",params:{x1:0,y1:11280,x2:6100,y2:11280},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-line",name:"Center Line (Net)",type:"line",params:{x1:0,y1:6705,x2:6100,y2:6705},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-service-line",name:"Center Service Line",type:"line",params:{x1:3050,y1:0,x2:3050,y2:13410},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"basketball-half":{id:"basketball-half",name:"Basketball (Half Court / 3x3)",sport:"basketball",standard:"FIBA 3x3",category:"court",description:"Half-court basketball for 3x3 games, practice, or space-constrained areas",dimensions:{length_mm:11e3,width_mm:15e3,min_surround_mm:2e3},defaultSurfaceColor:"RH20",defaultLineColor:"RH31",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:15e3,height:11e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"three-point-arc",name:"Three-Point Arc",type:"arc",params:{cx:7500,cy:1575,radius:6750,startAngle:12,endAngle:168},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"three-point-line-left",name:"Three-Point Line (Left)",type:"line",params:{x1:900,y1:0,x2:900,y2:2990},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"three-point-line-right",name:"Three-Point Line (Right)",type:"line",params:{x1:14100,y1:0,x2:14100,y2:2990},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"free-throw-line",name:"Free Throw Line",type:"line",params:{x1:5050,y1:5800,x2:9950,y2:5800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"free-throw-circle",name:"Free Throw Circle",type:"circle",params:{cx:7500,cy:5800,radius:1800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"key-lane",name:"Key Lane",type:"rectangle",params:{x:5050,y:0,width:4900,height:5800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"restricted-area",name:"Restricted Area",type:"arc",params:{cx:7500,cy:0,radius:1250,startAngle:0,endAngle:180},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[{id:"key-area",name:"Key Area",type:"rectangle",params:{x:5050,y:0,width:4900,height:5800},defaultColor:"RH20",paintable:!0,area_m2:28.42}]},"tennis-singles":{id:"tennis-singles",name:"Tennis (Singles)",sport:"tennis",standard:"ITF",category:"court",description:"Singles-only tennis court without doubles alleys",dimensions:{length_mm:23770,width_mm:8230,min_surround_mm:3660},defaultSurfaceColor:"RH22",defaultLineColor:"RH29",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:8230,height:23770},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"service-line-bottom",name:"Service Line (Bottom)",type:"line",params:{x1:0,y1:6400,x2:8230,y2:6400},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"service-line-top",name:"Service Line (Top)",type:"line",params:{x1:0,y1:17370,x2:8230,y2:17370},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-service-line",name:"Center Service Line",type:"line",params:{x1:4115,y1:6400,x2:4115,y2:17370},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-mark-bottom",name:"Center Mark (Bottom)",type:"line",params:{x1:4115,y1:0,x2:4115,y2:100},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-mark-top",name:"Center Mark (Top)",type:"line",params:{x1:4115,y1:23670,x2:4115,y2:23770},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"mini-tennis-red":{id:"mini-tennis-red",name:"Mini Tennis (Red Court)",sport:"tennis",standard:"ITF Play+Stay",category:"court",description:"Beginner/youth court for red stage tennis coaching (36ft)",dimensions:{length_mm:10970,width_mm:5490,min_surround_mm:2e3},defaultSurfaceColor:"RH02",defaultLineColor:"RH29",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:5490,height:10970},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"net-line",name:"Net Line",type:"line",params:{x1:0,y1:5485,x2:5490,y2:5485},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"service-line-bottom",name:"Service Line (Bottom)",type:"line",params:{x1:0,y1:2745,x2:5490,y2:2745},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"service-line-top",name:"Service Line (Top)",type:"line",params:{x1:0,y1:8225,x2:5490,y2:8225},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-service-line",name:"Center Service Line",type:"line",params:{x1:2745,y1:2745,x2:2745,y2:8225},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"padel-standard":{id:"padel-standard",name:"Padel",sport:"padel",standard:"FIP",category:"court",description:"Official FIP padel court with service boxes",dimensions:{length_mm:2e4,width_mm:1e4,min_surround_mm:0},defaultSurfaceColor:"RH60",defaultLineColor:"RH29",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:1e4,height:2e4},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"net-line",name:"Net Line",type:"line",params:{x1:0,y1:1e4,x2:1e4,y2:1e4},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"service-line-bottom",name:"Service Line (Bottom)",type:"line",params:{x1:0,y1:3e3,x2:1e4,y2:3e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"service-line-top",name:"Service Line (Top)",type:"line",params:{x1:0,y1:17e3,x2:1e4,y2:17e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-service-line-bottom",name:"Center Service Line (Bottom)",type:"line",params:{x1:5e3,y1:0,x2:5e3,y2:3e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-service-line-top",name:"Center Service Line (Top)",type:"line",params:{x1:5e3,y1:17e3,x2:5e3,y2:2e4},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-line",name:"Center Line",type:"line",params:{x1:5e3,y1:3e3,x2:5e3,y2:17e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"handball-standard":{id:"handball-standard",name:"Handball",sport:"handball",standard:"IHF",category:"court",description:"Official IHF handball court with goal areas and penalty lines",dimensions:{length_mm:4e4,width_mm:2e4,min_surround_mm:1e3},defaultSurfaceColor:"RH10",defaultLineColor:"RH31",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:2e4,height:4e4},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"center-line",name:"Center Line",type:"line",params:{x1:0,y1:2e4,x2:2e4,y2:2e4},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"goal-area-bottom",name:"Goal Area (Bottom)",type:"arc",params:{cx:1e4,cy:0,radius:6e3,startAngle:0,endAngle:180},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"goal-area-top",name:"Goal Area (Top)",type:"arc",params:{cx:1e4,cy:4e4,radius:6e3,startAngle:180,endAngle:360},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"free-throw-line-bottom",name:"Free-Throw Line (Bottom)",type:"arc",params:{cx:1e4,cy:0,radius:9e3,startAngle:0,endAngle:180,dashed:!0,dashPattern:"300 150"},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"free-throw-line-top",name:"Free-Throw Line (Top)",type:"arc",params:{cx:1e4,cy:4e4,radius:9e3,startAngle:180,endAngle:360,dashed:!0,dashPattern:"300 150"},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"7m-line-bottom",name:"7m Penalty Line (Bottom)",type:"line",params:{x1:9e3,y1:7e3,x2:11e3,y2:7e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"7m-line-top",name:"7m Penalty Line (Top)",type:"line",params:{x1:9e3,y1:33e3,x2:11e3,y2:33e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"goalkeeper-line-bottom",name:"Goalkeeper Restriction Line (Bottom)",type:"line",params:{x1:9500,y1:4e3,x2:10500,y2:4e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"goalkeeper-line-top",name:"Goalkeeper Restriction Line (Top)",type:"line",params:{x1:9500,y1:36e3,x2:10500,y2:36e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"hockey-d":{id:"hockey-d",name:"Field Hockey D",sport:"hockey",standard:"FIH",category:"overlay",description:"Hockey shooting circle (D) for overlay on sports surfaces",dimensions:{length_mm:14630,width_mm:29260,min_surround_mm:0},defaultSurfaceColor:"RH23",defaultLineColor:"RH29",defaultLineWidth_mm:50,markings:[{id:"shooting-circle",name:"Shooting Circle (D)",type:"arc",params:{cx:14630,cy:0,radius:14630,startAngle:0,endAngle:180},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"goal-line",name:"Goal Line",type:"line",params:{x1:0,y1:0,x2:29260,y2:0},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"penalty-spot",name:"Penalty Spot",type:"circle",params:{cx:14630,cy:6400,radius:150},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"hockey-5s":{id:"hockey-5s",name:"Hockey 5s",sport:"hockey",standard:"England Hockey",category:"court",description:"Scaled-down hockey pitch for 5-a-side games",dimensions:{length_mm:55e3,width_mm:41100,min_surround_mm:2e3},defaultSurfaceColor:"RH23",defaultLineColor:"RH29",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:41100,height:55e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"center-line",name:"Center Line",type:"line",params:{x1:0,y1:27500,x2:41100,y2:27500},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-spot",name:"Center Spot",type:"circle",params:{cx:20550,cy:27500,radius:150},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"shooting-circle-bottom",name:"Shooting Circle (Bottom)",type:"arc",params:{cx:20550,cy:0,radius:9e3,startAngle:0,endAngle:180},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"shooting-circle-top",name:"Shooting Circle (Top)",type:"arc",params:{cx:20550,cy:55e3,radius:9e3,startAngle:180,endAngle:360},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"penalty-spot-bottom",name:"Penalty Spot (Bottom)",type:"circle",params:{cx:20550,cy:6400,radius:150},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"penalty-spot-top",name:"Penalty Spot (Top)",type:"circle",params:{cx:20550,cy:48600,radius:150},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]}},pn=[{code:"RH01",name:"Standard Red",hex:"#A5362F",R:165,G:54,B:47,L:39.4,a:58.5,b:29},{code:"RH02",name:"Bright Red",hex:"#E21F2F",R:226,G:31,B:47,L:47.4,a:70.1,b:44},{code:"RH10",name:"Standard Green",hex:"#609B63",R:96,G:155,B:99,L:40.5,a:-42.2,b:17.9},{code:"RH11",name:"Bright Green",hex:"#3BB44A",R:59,G:180,B:74,L:62.1,a:-47.7,b:47.2},{code:"RH12",name:"Dark Green",hex:"#006C55",R:0,G:108,B:85,L:39.6,a:-38.3,b:13.1},{code:"RH20",name:"Standard Blue",hex:"#0075BC",R:0,G:117,B:188,L:36.4,a:14.2,b:-46.7},{code:"RH21",name:"Purple",hex:"#493D8C",R:73,G:61,B:140,L:31.5,a:41.9,b:-40.9},{code:"RH22",name:"Light Blue",hex:"#47AFE3",R:71,G:175,B:227,L:55.3,a:-19.1,b:-37.3},{code:"RH23",name:"Azure",hex:"#039DC4",R:3,G:157,B:196,L:47.7,a:-4.8,b:-34.8},{code:"RH26",name:"Turquoise",hex:"#00A6A3",R:0,G:166,B:163,L:58.8,a:-38.4,b:-3},{code:"RH30",name:"Standard Beige",hex:"#E4C4AA",R:228,G:196,B:170,L:75.2,a:3.8,b:24.8},{code:"RH31",name:"Cream",hex:"#E8E3D8",R:232,G:227,B:216,L:91.8,a:-.5,b:12.5},{code:"RH32",name:"Brown",hex:"#8B5F3C",R:139,G:95,B:60,L:40,a:15.9,b:27.1},{code:"RH90",name:"Funky Pink",hex:"#E8457E",R:232,G:69,B:126,L:55,a:66.1,b:4.9},{code:"RH40",name:"Mustard Yellow",hex:"#E5A144",R:229,G:161,B:68,L:66,a:8.4,b:56.3},{code:"RH41",name:"Bright Yellow",hex:"#FFD833",R:255,G:216,B:51,L:86.9,a:-1,b:90.6},{code:"RH50",name:"Orange",hex:"#F15B32",R:241,G:91,B:50,L:63.2,a:49.8,b:60.2},{code:"RH60",name:"Dark Grey",hex:"#59595B",R:89,G:89,B:91,L:34.1,a:-.4,b:-2.4},{code:"RH61",name:"Light Grey",hex:"#939598",R:147,G:149,B:152,L:69,a:-.5,b:-1},{code:"RH65",name:"Pale Grey",hex:"#D9D9D6",R:217,G:217,B:214,L:87.6,a:-.2,b:-.7},{code:"RH70",name:"Black",hex:"#231F20",R:35,G:31,B:32,L:9.1,a:-.3,b:-6.3}];function OE(){return Object.values(d1)}function AE(t){return d1[t]||null}function ME(t,e,n){const{type:r,params:s}=t;switch(r){case"line":return LE(s,e,n);case"rectangle":return DE(s,e,n);case"circle":return IE(s,e,n);case"arc":return zE(s,e,n);case"polyline":return FE(s,e,n);default:return console.warn(`Unknown marking type: ${r}`),null}}function $E(t,e){const{type:n,params:r}=t;switch(n){case"rectangle":return{type:"rect",x:r.x,y:r.y,width:r.width,height:r.height,fill:e};case"circle":return{type:"circle",cx:r.cx,cy:r.cy,r:r.radius,fill:e};case"polygon":return{type:"polygon",points:r.points,fill:e};default:return console.warn(`Unknown zone type: ${n}`),null}}function LE(t,e,n){const r={type:"line",x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,stroke:e,strokeWidth:n};return t.dashed&&(r.strokeDasharray=t.dashPattern||"200 100"),r}function DE(t,e,n){return{type:"rect",x:t.x,y:t.y,width:t.width,height:t.height,stroke:e,strokeWidth:n,fill:"none"}}function IE(t,e,n){return{type:"circle",cx:t.cx,cy:t.cy,r:t.radius,stroke:e,strokeWidth:n,fill:"none"}}function zE(t,e,n){const{cx:r,cy:s,radius:i,startAngle:a,endAngle:l}=t,c=a*Math.PI/180,d=l*Math.PI/180,u=r+i*Math.cos(c),p=s+i*Math.sin(c),h=r+i*Math.cos(d),f=s+i*Math.sin(d),m=l-a>180?1:0,v={type:"path",d:`M ${u} ${p} A ${i} ${i} 0 ${m} 1 ${h} ${f}`,stroke:e,strokeWidth:n,fill:"none"};return t.dashed&&(v.strokeDasharray=t.dashPattern||"200 100"),v}function FE(t,e,n){return{type:"polyline",points:t.points.map(s=>`${s[0]},${s[1]}`).join(" "),stroke:e,strokeWidth:n,fill:"none"}}function O0(t){if(t&&t.startsWith("#"))return t;const e=pn.find(n=>n.code===t);return e?e.hex:"#000000"}function BE(t){var a;const{template:e,lineColorOverrides:n,zoneColorOverrides:r}=t;if(!e)return console.error("No template provided for court"),{markings:[],zones:[]};const s=e.markings.map(l=>{var p;const c=((p=n[l.id])==null?void 0:p.hex)||e.defaultLineColor,d=O0(c),u=l.lineWidth_mm||e.defaultLineWidth_mm;return{id:l.id,name:l.name,...ME(l,d,u)}}).filter(Boolean),i=((a=e.zones)==null?void 0:a.map(l=>{var u;const c=((u=r[l.id])==null?void 0:u.hex)||l.defaultColor,d=O0(c);return{id:l.id,name:l.name,...$E(l,d)}}).filter(Boolean))||[];return{markings:s,zones:i}}function A0(t,e){return Math.round(t/e)*e}function HE(t,e){return{x:A0(t.x,e),y:A0(t.y,e)}}function u1(t){let e=t%360;return e<0&&(e+=360),e}function yc(t,e,n){const{width_mm:r,length_mm:s}=e,{width_mm:i,length_mm:a}=n,l=500,c=-(r-l),d=i-l,u=-(s-l),p=a-l;return{x:Math.max(c,Math.min(t.x,d)),y:Math.max(u,Math.min(t.y,p))}}function UE(t){const{position:e,rotation:n,scale:r,template:s}=t,i=s.dimensions.width_mm/2,a=s.dimensions.length_mm/2;return`translate(${e.x}, ${e.y}) scale(${r}) rotate(${n}, ${i}, ${a})`}function WE({court:t,svgRef:e}){const{updateCourtRotation:n,updateCourtScale:r,updateCourtPosition:s,addToHistory:i}=it(),[a,l]=R.useState(!1),[c,d]=R.useState(!1),[u,p]=R.useState(null),[h,f]=R.useState(null),{template:m,position:g,rotation:v,scale:y}=t,x=m.dimensions.width_mm*y,b=m.dimensions.length_mm*y,w=g.x+m.dimensions.width_mm*y/2,S=g.y+m.dimensions.length_mm*y/2,_=m.dimensions.width_mm/2,k=-1e3,E=(j,G)=>{if(!e.current)return{x:0,y:0};const pe=e.current.createSVGPoint();pe.x=j,pe.y=G;const Z=pe.matrixTransform(e.current.getScreenCTM().inverse());return{x:Z.x,y:Z.y}},T=j=>{j.stopPropagation(),l(!0),f({x:j.clientX,y:j.clientY})},O=(j,G)=>{j.stopPropagation(),d(!0),p(G),f({x:j.clientX,y:j.clientY,initialScale:y,initialWidth:x,initialHeight:b,initialPosition:{...g}})};R.useEffect(()=>{if(!a&&!c)return;const j=pe=>{if(a){const Z=E(pe.clientX,pe.clientY),ee=Z.x-w,F=Z.y-S;let K=Math.atan2(F,ee)*(180/Math.PI)+90;K=u1(K),pe.shiftKey&&(K=Math.round(K/15)*15),n(t.id,K)}else if(c&&h){const Z=E(pe.clientX,pe.clientY),ee=E(h.x,h.y),F=Z.x-ee.x,K=Z.y-ee.y;let U=h.initialScale,V={...g};switch(u){case"se":U=Math.max(.3,h.initialScale+F/m.dimensions.width_mm);break;case"nw":U=Math.max(.3,h.initialScale-F/m.dimensions.width_mm),V.x=h.initialPosition.x+(h.initialWidth-m.dimensions.width_mm*U),V.y=h.initialPosition.y+(h.initialHeight-m.dimensions.length_mm*U);break;case"ne":U=Math.max(.3,h.initialScale+F/m.dimensions.width_mm),V.y=h.initialPosition.y+(h.initialHeight-m.dimensions.length_mm*U);break;case"sw":U=Math.max(.3,h.initialScale-F/m.dimensions.width_mm),V.x=h.initialPosition.x+(h.initialWidth-m.dimensions.width_mm*U);break;case"e":U=Math.max(.3,h.initialScale+F/m.dimensions.width_mm);break;case"w":U=Math.max(.3,h.initialScale-F/m.dimensions.width_mm),V.x=h.initialPosition.x+(h.initialWidth-m.dimensions.width_mm*U);break;case"n":U=Math.max(.3,h.initialScale-K/m.dimensions.length_mm),V.y=h.initialPosition.y+(h.initialHeight-m.dimensions.length_mm*U);break;case"s":U=Math.max(.3,h.initialScale+K/m.dimensions.length_mm);break}U=Math.min(3,Math.max(.3,U)),r(t.id,U),(V.x!==g.x||V.y!==g.y)&&s(t.id,V)}},G=()=>{(a||c)&&i(),l(!1),d(!1),p(null),f(null)};return window.addEventListener("mousemove",j),window.addEventListener("mouseup",G),()=>{window.removeEventListener("mousemove",j),window.removeEventListener("mouseup",G)}},[a,c,h,w,S,t.id,g,y,u]);const q=[{type:"nw",x:0,y:0,cursor:"nwse-resize"},{type:"n",x:m.dimensions.width_mm/2,y:0,cursor:"ns-resize"},{type:"ne",x:m.dimensions.width_mm,y:0,cursor:"nesw-resize"},{type:"e",x:m.dimensions.width_mm,y:m.dimensions.length_mm/2,cursor:"ew-resize"},{type:"se",x:m.dimensions.width_mm,y:m.dimensions.length_mm,cursor:"nwse-resize"},{type:"s",x:m.dimensions.width_mm/2,y:m.dimensions.length_mm,cursor:"ns-resize"},{type:"sw",x:0,y:m.dimensions.length_mm,cursor:"nesw-resize"},{type:"w",x:0,y:m.dimensions.length_mm/2,cursor:"ew-resize"}],P=300,W=250;return o.jsxs("g",{className:"transform-handles",children:[o.jsxs("g",{className:"rotation-handle",onMouseDown:T,style:{cursor:a?"grabbing":"grab"},children:[o.jsx("line",{x1:_,y1:0,x2:_,y2:k+W,stroke:"#007bff",strokeWidth:30,strokeDasharray:"100 50"}),o.jsx("circle",{cx:_,cy:k,r:W,fill:"white",stroke:"#007bff",strokeWidth:40}),o.jsx("path",{d:`M ${_-W*.4} ${k}
              A ${W*.5} ${W*.5} 0 1 1 ${_+W*.4} ${k}`,fill:"none",stroke:"#007bff",strokeWidth:30,strokeLinecap:"round"}),o.jsx("path",{d:`M ${_+W*.4} ${k}
              L ${_+W*.6} ${k-W*.2}
              M ${_+W*.4} ${k}
              L ${_+W*.6} ${k+W*.2}`,fill:"none",stroke:"#007bff",strokeWidth:30,strokeLinecap:"round"})]}),q.map(j=>o.jsx("rect",{className:`scale-handle scale-handle--${j.type}`,x:j.x-P/2,y:j.y-P/2,width:P,height:P,fill:"white",stroke:"#007bff",strokeWidth:40,rx:30,ry:30,style:{cursor:c&&u===j.type?"grabbing":j.cursor,pointerEvents:"all"},onMouseDown:G=>O(G,j.type)},j.type)),a&&o.jsxs("text",{x:m.dimensions.width_mm/2,y:-1e3-W-200,textAnchor:"middle",fontSize:400,fill:"#007bff",fontWeight:"bold",style:{pointerEvents:"none"},children:[Math.round(v),""]}),c&&o.jsxs("text",{x:m.dimensions.width_mm/2,y:m.dimensions.length_mm+600,textAnchor:"middle",fontSize:400,fill:"#007bff",fontWeight:"bold",style:{pointerEvents:"none"},children:[(y*100).toFixed(0),"%"]})]})}function h1(t){const{width_mm:e,height_mm:n,numLanes:r,laneWidth_mm:s,cornerRadius:i={topLeft:3e3,topRight:3e3,bottomLeft:3e3,bottomRight:3e3},lineWidth_mm:a=50}=t,l=[];if(i.topLeft===0&&i.topRight===0&&i.bottomLeft===0&&i.bottomRight===0){const d=r*s;for(let u=0;u<r;u++){const p=u*s;l.push({laneNumber:u+1,innerPath:null,outerPath:GE(s,n,u),perimeter:2*n/1e3,isParallel:!0,laneX:p,laneWidth:s})}return{lanes:l,totalWidth:d,totalLength:n,usableWidth:d,usableHeight:n,isStraightTrack:!0}}else for(let d=0;d<r;d++){const u=d*s,p=(d+1)*s,h=Math.max(0,e-p*2),f=Math.max(0,n-p*2),m=Math.max(0,e-u*2),g=Math.max(0,n-u*2),v={topLeft:Math.max(0,i.topLeft-p),topRight:Math.max(0,i.topRight-p),bottomLeft:Math.max(0,i.bottomLeft-p),bottomRight:Math.max(0,i.bottomRight-p)},y={topLeft:Math.max(0,i.topLeft-u),topRight:Math.max(0,i.topRight-u),bottomLeft:Math.max(0,i.bottomLeft-u),bottomRight:Math.max(0,i.bottomRight-u)};l.push({laneNumber:d+1,innerPath:M0(h,f,v,p),outerPath:M0(m,g,y,u),perimeter:VE(m,g,y),isParallel:!1})}return{lanes:l,totalWidth:e,totalLength:n,usableWidth:e-r*s*2,usableHeight:n-r*s*2}}function M0(t,e,n,r=0){if(t<=0||e<=0)return`M ${r} ${r} L ${r} ${r}`;const s=Math.min(t/2,e/2),i=Math.min(n.topLeft,s),a=Math.min(n.topRight,s),l=Math.min(n.bottomRight,s),c=Math.min(n.bottomLeft,s),d=r,u=r+t,p=r,h=r+e;return`
    M ${d+i} ${p}
    L ${u-a} ${p}
    ${a>0?`A ${a} ${a} 0 0 1 ${u} ${p+a}`:""}
    L ${u} ${h-l}
    ${l>0?`A ${l} ${l} 0 0 1 ${u-l} ${h}`:""}
    L ${d+c} ${h}
    ${c>0?`A ${c} ${c} 0 0 1 ${d} ${h-c}`:""}
    L ${d} ${p+i}
    ${i>0?`A ${i} ${i} 0 0 1 ${d+i} ${p}`:""}
    Z
  `.trim().replace(/\s+/g," ")}function GE(t,e,n){const r=n*t;return`M ${r} 0 L ${r+t} 0 L ${r+t} ${e} L ${r} ${e} Z`}function VE(t,e,n){if(t<=0||e<=0)return 0;const r=Math.min(t/2,e/2),s=Math.min(n.topLeft,r),i=Math.min(n.topRight,r),a=Math.min(n.bottomRight,r),l=Math.min(n.bottomLeft,r),c=t-s-i,d=e-i-a,u=t-a-l,p=e-l-s,h=Math.PI*s/2,f=Math.PI*i/2,m=Math.PI*a/2,g=Math.PI*l/2;return(c+d+u+p+h+f+m+g)/1e3}function p1(t){if(!t||!t.lanes||t.lanes.length===0)return[];const e=t.lanes.length-1,n=t.lanes[e].perimeter;return t.lanes.map((r,s)=>r.perimeter-n)}function $0(t,e,n){const{width_mm:r,height_mm:s,laneWidth_mm:i,cornerRadius:a={topLeft:3e3,topRight:3e3,bottomLeft:3e3,bottomRight:3e3}}=n,l=t*i,c=Math.max(0,r-l*2),d=Math.max(0,s-l*2),u=Math.min(c/2,d/2),p=Math.min(Math.max(0,a.topLeft-l),u),h=Math.min(Math.max(0,a.topRight-l),u),f=Math.min(Math.max(0,a.bottomRight-l),u),m=Math.min(Math.max(0,a.bottomLeft-l),u),g=l,v=l+c,y=l,x=l+d,b=[{type:"arc",length:Math.PI*m/2,radius:m,corner:"bottomLeft"},{type:"straight",length:d-m-p,dir:"up"},{type:"arc",length:Math.PI*p/2,radius:p,corner:"topLeft"},{type:"straight",length:c-p-h,dir:"right"},{type:"arc",length:Math.PI*h/2,radius:h,corner:"topRight"},{type:"straight",length:d-h-f,dir:"down"},{type:"arc",length:Math.PI*f/2,radius:f,corner:"bottomRight"},{type:"straight",length:c-f-m,dir:"left"}];let w=e;const S=b.reduce((k,E)=>k+E.length,0);for(;w<0;)w+=S;for(;w>=S;)w-=S;let _=0;for(const k of b){if(w<=_+k.length){const E=w-_,T=k.length>0?E/k.length:0;return k.type==="arc"?YE(k,T,{left:g,right:v,top:y,bottom:x,tl:p,tr:h,br:f,bl:m}):qE(k,T,{left:g,right:v,top:y,bottom:x,tl:p,tr:h,br:f,bl:m})}_+=k.length}return{x:g,y:x-m,angle:-Math.PI/2}}function YE(t,e,n){const{left:r,right:s,top:i,bottom:a,tl:l,tr:c,br:d,bl:u}=n,p=e*(Math.PI/2);switch(t.corner){case"bottomLeft":{const h=r+u,f=a-u,g=Math.PI/2+p;return{x:h+u*Math.cos(g),y:f+u*Math.sin(g),angle:g+Math.PI/2}}case"topLeft":{const h=r+l,f=i+l,g=Math.PI+p;return{x:h+l*Math.cos(g),y:f+l*Math.sin(g),angle:g+Math.PI/2}}case"topRight":{const h=s-c,f=i+c,g=-Math.PI/2+p;return{x:h+c*Math.cos(g),y:f+c*Math.sin(g),angle:g+Math.PI/2}}case"bottomRight":{const h=s-d,f=a-d,g=0+p;return{x:h+d*Math.cos(g),y:f+d*Math.sin(g),angle:g+Math.PI/2}}default:return{x:r,y:i,angle:0}}}function qE(t,e,n){const{left:r,right:s,top:i,bottom:a,tl:l,tr:c,br:d,bl:u}=n;switch(t.dir){case"up":{const p=a-u,h=i+l;return{x:r,y:p+e*(h-p),angle:-Math.PI/2}}case"right":{const p=r+l,h=s-c;return{x:p+e*(h-p),y:i,angle:0}}case"down":{const p=i+c,h=a-d;return{x:s,y:p+e*(h-p),angle:Math.PI/2}}case"left":{const p=s-d,h=r+u;return{x:p+e*(h-p),y:a,angle:Math.PI}}default:return{x:r,y:i,angle:0}}}function L0(t,e,n){const r=$0(t,e,n),s=$0(t+1,e,n);return{x:(r.x+s.x)/2,y:(r.y+s.y)/2,angle:r.angle,innerX:s.x,innerY:s.y,outerX:r.x,outerY:r.y}}function D0(t,e,n){const{width_mm:r,height_mm:s,laneWidth_mm:i,cornerRadius:a={topLeft:3e3,topRight:3e3,bottomLeft:3e3,bottomRight:3e3}}=n,l=t*i,c=Math.max(0,r-l*2),d=Math.max(0,s-l*2),u=Math.min(c/2,d/2),p=Math.min(Math.max(0,a.topLeft-l),u),h=Math.min(Math.max(0,a.topRight-l),u),f=Math.min(Math.max(0,a.bottomRight-l),u),m=Math.min(Math.max(0,a.bottomLeft-l),u),g=[{type:"arc",length:Math.PI*m/2,corner:"bottomLeft"},{type:"straight",length:d-m-p,dir:"up"},{type:"arc",length:Math.PI*p/2,corner:"topLeft"},{type:"straight",length:c-p-h,dir:"right"},{type:"arc",length:Math.PI*h/2,corner:"topRight"},{type:"straight",length:d-h-f,dir:"down"},{type:"arc",length:Math.PI*f/2,corner:"bottomRight"},{type:"straight",length:c-f-m,dir:"left"}],v=g.reduce((b,w)=>b+w.length,0);let y=e;for(;y<0;)y+=v;for(;y>=v;)y-=v;let x=0;for(let b=0;b<g.length;b++){if(y<=x+g[b].length){const w=y-x,S=g[b].length>0?w/g[b].length:0;return{segmentIndex:b,t:S,segments:g,totalPerimeter:v}}x+=g[b].length}return{segmentIndex:0,t:0,segments:g,totalPerimeter:v}}function I0(t,e,n,r){const s=D0(n,e,r),i=D0(t,0,r);let a=0;for(let d=0;d<s.segmentIndex;d++)a+=i.segments[d].length;const l=i.segments[s.segmentIndex].length;return a+s.t*l}function XE({track:t,svgRef:e}){var j;const{updateTrackParameters:n,updateTrackPosition:r,updateTrackRotation:s,addToHistory:i}=it(),[a,l]=R.useState(!1),[c,d]=R.useState(!1),[u,p]=R.useState(null),[h,f]=R.useState(null),{parameters:m,position:g,rotation:v}=t,y=m.width_mm,x=m.height_mm,b=g.x+y/2,w=g.y+x/2,S=y/2,_=-1e3,k=(G,pe)=>{if(!e.current)return{x:0,y:0};const Z=e.current.createSVGPoint();Z.x=G,Z.y=pe;const ee=Z.matrixTransform(e.current.getScreenCTM().inverse());return{x:ee.x,y:ee.y}},E=G=>{G.stopPropagation();const pe=G.touches?G.touches[0].clientX:G.clientX,Z=G.touches?G.touches[0].clientY:G.clientY;d(!0),f({x:pe,y:Z})},T=(G,pe)=>{var V;G.stopPropagation(),l(!0),p(pe);const Z=G.touches?G.touches[0].clientX:G.clientX,ee=G.touches?G.touches[0].clientY:G.clientY,F=k(Z,ee),K=((V=t.template)==null?void 0:V.trackType)==="straight";let U={};if(K){const J=v*Math.PI/180,oe=Math.sin(J),me=Math.cos(J),je=g.x+y/2,he=g.y+x/2,Ee=pe==="n"||pe==="nw"||pe==="ne";U={fixedEdgeCenter:Ee?{x:je-x/2*oe,y:he+x/2*me}:{x:je+x/2*oe,y:he-x/2*me},fixedEdgeIsSouth:Ee,sinR:oe,cosR:me}}f({screenX:Z,screenY:ee,svgX:F.x,svgY:F.y,initialWidth:y,initialHeight:x,initialPosition:{...g},initialCornerRadius:{...m.cornerRadius},...U})};R.useEffect(()=>{if(!a&&!c)return;const G=Z=>{var We;const ee=Z.touches?Z.touches[0].clientX:Z.clientX,F=Z.touches?Z.touches[0].clientY:Z.clientY;if(c){const Ie=k(ee,F),Je=Ie.x-b,Ue=Ie.y-w;let C=Math.atan2(Ue,Je)*(180/Math.PI)+90;C=u1(C),Z.shiftKey&&(C=Math.round(C/15)*15),s(t.id,C);return}if(!h)return;const K=k(ee,F),U=K.x-h.svgX,V=K.y-h.svgY;let J=h.initialWidth,oe=h.initialHeight,me={...g},je={...h.initialCornerRadius};const he=3e3,Ee=((We=t.template)==null?void 0:We.trackType)==="straight";if(Ee&&(u==="e"||u==="w"))return;if(Ee&&h.fixedEdgeCenter){const{fixedEdgeCenter:Ie,fixedEdgeIsSouth:Je,sinR:Ue,cosR:C}=h,Q=K.x-Ie.x,ce=K.y-Ie.y,L=Je?Ue:-Ue,N=Je?-C:C,I=Q*L+ce*N;oe=Math.max(he,I);const H=Ie.x+oe/2*L,X=Ie.y+oe/2*N;me={x:H-J/2,y:X-oe/2}}else switch(u){case"se":J=Math.max(he,h.initialWidth+U),oe=Math.max(he,h.initialHeight+V);const Ie=Math.min(J/h.initialWidth,oe/h.initialHeight);je={topLeft:h.initialCornerRadius.topLeft*Ie,topRight:h.initialCornerRadius.topRight*Ie,bottomLeft:h.initialCornerRadius.bottomLeft*Ie,bottomRight:h.initialCornerRadius.bottomRight*Ie};break;case"nw":J=Math.max(he,h.initialWidth-U),oe=Math.max(he,h.initialHeight-V),me.x=h.initialPosition.x+(h.initialWidth-J),me.y=h.initialPosition.y+(h.initialHeight-oe);const Je=Math.min(J/h.initialWidth,oe/h.initialHeight);je={topLeft:h.initialCornerRadius.topLeft*Je,topRight:h.initialCornerRadius.topRight*Je,bottomLeft:h.initialCornerRadius.bottomLeft*Je,bottomRight:h.initialCornerRadius.bottomRight*Je};break;case"ne":J=Math.max(he,h.initialWidth+U),oe=Math.max(he,h.initialHeight-V),me.y=h.initialPosition.y+(h.initialHeight-oe);const Ue=Math.min(J/h.initialWidth,oe/h.initialHeight);je={topLeft:h.initialCornerRadius.topLeft*Ue,topRight:h.initialCornerRadius.topRight*Ue,bottomLeft:h.initialCornerRadius.bottomLeft*Ue,bottomRight:h.initialCornerRadius.bottomRight*Ue};break;case"sw":J=Math.max(he,h.initialWidth-U),oe=Math.max(he,h.initialHeight+V),me.x=h.initialPosition.x+(h.initialWidth-J);const C=Math.min(J/h.initialWidth,oe/h.initialHeight);je={topLeft:h.initialCornerRadius.topLeft*C,topRight:h.initialCornerRadius.topRight*C,bottomLeft:h.initialCornerRadius.bottomLeft*C,bottomRight:h.initialCornerRadius.bottomRight*C};break;case"e":J=Math.max(he,h.initialWidth+U);const Q=J/h.initialWidth;je={topLeft:h.initialCornerRadius.topLeft*Q,topRight:h.initialCornerRadius.topRight*Q,bottomLeft:h.initialCornerRadius.bottomLeft*Q,bottomRight:h.initialCornerRadius.bottomRight*Q};break;case"w":J=Math.max(he,h.initialWidth-U),me.x=h.initialPosition.x+(h.initialWidth-J);const ce=J/h.initialWidth;je={topLeft:h.initialCornerRadius.topLeft*ce,topRight:h.initialCornerRadius.topRight*ce,bottomLeft:h.initialCornerRadius.bottomLeft*ce,bottomRight:h.initialCornerRadius.bottomRight*ce};break;case"n":oe=Math.max(he,h.initialHeight-V),me.y=h.initialPosition.y+(h.initialHeight-oe);const L=oe/h.initialHeight;je={topLeft:h.initialCornerRadius.topLeft*L,topRight:h.initialCornerRadius.topRight*L,bottomLeft:h.initialCornerRadius.bottomLeft*L,bottomRight:h.initialCornerRadius.bottomRight*L};break;case"s":oe=Math.max(he,h.initialHeight+V);const N=oe/h.initialHeight;je={topLeft:h.initialCornerRadius.topLeft*N,topRight:h.initialCornerRadius.topRight*N,bottomLeft:h.initialCornerRadius.bottomLeft*N,bottomRight:h.initialCornerRadius.bottomRight*N};break}const Me=Math.min(J,oe)/2;je={topLeft:Math.min(je.topLeft,Me),topRight:Math.min(je.topRight,Me),bottomLeft:Math.min(je.bottomLeft,Me),bottomRight:Math.min(je.bottomRight,Me)},n(t.id,{width_mm:J,height_mm:oe,cornerRadius:je}),(me.x!==g.x||me.y!==g.y)&&r(t.id,me)},pe=()=>{(a||c)&&i(),l(!1),d(!1),p(null),f(null)};return window.addEventListener("mousemove",G),window.addEventListener("mouseup",pe),window.addEventListener("touchmove",G,{passive:!1}),window.addEventListener("touchend",pe),window.addEventListener("touchcancel",pe),()=>{window.removeEventListener("mousemove",G),window.removeEventListener("mouseup",pe),window.removeEventListener("touchmove",G),window.removeEventListener("touchend",pe),window.removeEventListener("touchcancel",pe)}},[a,h,u,t.id,g,m,n,r,i]);const O=((j=t.template)==null?void 0:j.trackType)==="straight",q=[{type:"nw",x:0,y:0,cursor:"nwse-resize"},{type:"n",x:y/2,y:0,cursor:"ns-resize"},{type:"ne",x:y,y:0,cursor:"nesw-resize"},{type:"e",x:y,y:x/2,cursor:"ew-resize"},{type:"se",x:y,y:x,cursor:"nwse-resize"},{type:"s",x:y/2,y:x,cursor:"ns-resize"},{type:"sw",x:0,y:x,cursor:"nesw-resize"},{type:"w",x:0,y:x/2,cursor:"ew-resize"}],P=O?q.filter(G=>G.type==="n"||G.type==="s"):q,W=400;return o.jsxs("g",{className:"track-resize-handles",children:[o.jsxs("g",{className:"rotation-handle-group",children:[o.jsx("line",{x1:S,y1:0,x2:S,y2:_,stroke:"#0066CC",strokeWidth:30,strokeDasharray:"100 100",opacity:.5,style:{pointerEvents:"none"}}),o.jsx("circle",{className:"rotation-handle",cx:S,cy:_,r:W/2,fill:"white",stroke:"#0066CC",strokeWidth:50,style:{cursor:c?"grabbing":"grab",pointerEvents:"all"},onMouseDown:E,onTouchStart:E}),o.jsx("path",{d:`M ${S-100} ${_-50}
              A 100 100 0 1 1 ${S+100} ${_-50}`,fill:"none",stroke:"#0066CC",strokeWidth:40,strokeLinecap:"round",style:{pointerEvents:"none"}}),o.jsx("path",{d:`M ${S+100} ${_-50}
              L ${S+80} ${_-120}
              L ${S+150} ${_-80}
              Z`,fill:"#0066CC",style:{pointerEvents:"none"}})]}),P.map(G=>o.jsx("rect",{className:`resize-handle resize-handle--${G.type}`,x:G.x-W/2,y:G.y-W/2,width:W,height:W,fill:"white",stroke:"#0066CC",strokeWidth:50,rx:40,ry:40,style:{cursor:a&&u===G.type?"grabbing":G.cursor,pointerEvents:"all"},onMouseDown:pe=>T(pe,G.type),onTouchStart:pe=>T(pe,G.type)},G.type)),a&&o.jsxs("text",{x:y/2,y:x+800,textAnchor:"middle",fontSize:400,fill:"#0066CC",fontWeight:"bold",style:{pointerEvents:"none"},children:[(y/1e3).toFixed(1),"m  ",(x/1e3).toFixed(1),"m"]}),c&&o.jsxs("text",{x:y/2,y:-1500,textAnchor:"middle",fontSize:400,fill:"#0066CC",fontWeight:"bold",style:{pointerEvents:"none"},children:[v.toFixed(0),""]})]})}function ZE({geometry:t,parameters:e,boxConfig:n,surfaceColor:r,lineColor:s,isStraightTrack:i}){if(!n||!n.enabled)return null;const{depth_mm:a=800,lineWidth_mm:l=50,perLaneOffsets:c=[],style:d="staggered",direction:u="counterclockwise",startPosition:p=0}=n,h="'Black Ops One', 'Impact', sans-serif",f=r||"#A5362F",m=s||"#E8E3D8",g=d==="staggered"||d==="both",v=d==="straight"||d==="both";return o.jsx("g",{className:"starting-boxes",children:t.lanes.map((y,x)=>{const b=x+1;return i?KE(x,b,e,t,a,l,f,m,h,g,v,c,u):JE(x,b,e,t,a,l,f,m,h,g,v,c,u,p)})})}function KE(t,e,n,r,s,i,a,l,c,d,u,p,h){const f=t*n.laneWidth_mm,m=n.laneWidth_mm,g=h==="clockwise",v=g?r.totalLength-s:0,y=g?0:r.totalLength-s,x=(p[t]||0)*1e3,b=[];if(d&&!u){const w=g?v-x:v+x;b.push(o.jsx(xc,{x:f,y:w,width:m,height:s,laneNumber:e,boxFillColor:a,lineColor:l,lineWidth:i,fontFamily:c,flipLine:!g},`stagger-${e}`))}else if(u&&!d)b.push(o.jsx(xc,{x:f,y:v,width:m,height:s,laneNumber:e,boxFillColor:a,lineColor:l,lineWidth:i,fontFamily:c,flipLine:!g},`straight-${e}`));else if(d&&u){const w=g?v-x:v+x;b.push(o.jsx(xc,{x:f,y:w,width:m,height:s,laneNumber:e,boxFillColor:a,lineColor:l,lineWidth:i,fontFamily:c,flipLine:!g},`stagger-${e}`)),b.push(o.jsx(xc,{x:f,y,width:m,height:s,laneNumber:e,boxFillColor:a,lineColor:l,lineWidth:i,fontFamily:c,flipLine:g},`straight-${e}`))}return o.jsx("g",{children:b},`lane-boxes-${e}`)}function xc({x:t,y:e,width:n,height:r,laneNumber:s,boxFillColor:i,lineColor:a,lineWidth:l,fontFamily:c,flipLine:d}){const u=d?e+r:e;return o.jsxs("g",{children:[o.jsx("line",{x1:t,y1:u,x2:t+n,y2:u,stroke:a,strokeWidth:l,strokeLinecap:"butt",pointerEvents:"none"}),o.jsx("text",{x:t+n/2,y:e+r/2,fontSize:Math.min(r*.6,n*.5),fill:a,textAnchor:"middle",dominantBaseline:"middle",fontFamily:c,fontWeight:"bold",pointerEvents:"none",opacity:"0.9",children:s})]})}function JE(t,e,n,r,s,i,a,l,c,d,u,p,h,f=0){var E,T;const m=h==="clockwise",g=r.lanes.length-1,v=(((E=r.lanes[g])==null?void 0:E.perimeter)||0)*1e3,y=v/2,x=f/100*v,b=I0(t,x,g,n),S=(((T=r.lanes[t])==null?void 0:T.perimeter)||0)*1e3/2,_=(p[t]||0)*1e3,k=[];if(d&&!u){const O=m?b+S+_:b+_;k.push(o.jsx(vc,{index:t,laneNumber:e,distance:O,depth_mm:s,parameters:n,boxFillColor:a,lineColor:l,lineWidth:i,fontFamily:c},`stagger-${e}`))}else if(u&&!d){const O=m?b+S:b;k.push(o.jsx(vc,{index:t,laneNumber:e,distance:O,depth_mm:s,parameters:n,boxFillColor:a,lineColor:l,lineWidth:i,fontFamily:c},`straight-${e}`))}else if(d&&u){const O=m?b+S+_:b+_,q=m?x:x+y,P=I0(t,q,g,n),W=P;k.push(o.jsx(vc,{index:t,laneNumber:e,distance:O,depth_mm:s,parameters:n,boxFillColor:a,lineColor:l,lineWidth:i,fontFamily:c},`stagger-${e}`)),k.push(o.jsx(vc,{index:t,laneNumber:e,distance:W,depth_mm:s,parameters:n,boxFillColor:a,lineColor:l,lineWidth:i,fontFamily:c},`straight-${e}`))}return o.jsx("g",{children:k},`lane-boxes-${e}`)}function vc({index:t,laneNumber:e,distance:n,depth_mm:r,parameters:s,boxFillColor:i,lineColor:a,lineWidth:l,fontFamily:c}){const d=L0(t,n,s),u=d.angle+Math.PI/2,p=s.laneWidth_mm/2,h=d.x+Math.cos(u)*p,f=d.y+Math.sin(u)*p,m=d.x-Math.cos(u)*p,g=d.y-Math.sin(u)*p,v=L0(t,n+r/2,s);return o.jsxs("g",{children:[o.jsx("line",{x1:h,y1:f,x2:m,y2:g,stroke:a,strokeWidth:l,strokeLinecap:"butt",pointerEvents:"none"}),o.jsx("text",{x:v.x,y:v.y,fontSize:Math.min(r*.6,s.laneWidth_mm*.5),fill:a,textAnchor:"middle",dominantBaseline:"middle",fontFamily:c,fontWeight:"bold",pointerEvents:"none",opacity:"0.9",transform:`rotate(${v.angle*180/Math.PI+90}, ${v.x}, ${v.y})`,children:e})]})}function QE({track:t,isSelected:e,onMouseDown:n,onTouchStart:r,onDoubleClick:s,svgRef:i}){var k,E,T;const{parameters:a,position:l,rotation:c,trackSurfaceColor:d,trackLineColor:u,laneSurfaceColors:p}=t,h=h1(a),f=h.lanes.length>0&&h.lanes[0].isParallel===!0,m=h.totalWidth,g=h.totalLength,v=m/2,y=g/2,x=`translate(${l.x}, ${l.y}) rotate(${c}, ${v}, ${y})`,b=(d==null?void 0:d.hex)||"#A5362F",w=(u==null?void 0:u.hex)||"#E8E3D8",S=a.lineWidth_mm||50,_=O=>{const q=p==null?void 0:p[O-1];return(q==null?void 0:q.hex)||b};return console.log("TrackRenderer - trackSurfaceColor:",d),console.log("TrackRenderer - defaultSurfaceColor:",b),console.log("TrackRenderer - geometry.lanes.length:",h.lanes.length),o.jsxs("g",{className:`track-element ${e?"track-element--selected":""}`,transform:x,style:{cursor:"move"},children:[f?o.jsxs(o.Fragment,{children:[o.jsx("rect",{x:"0",y:"0",width:m,height:g,fill:"transparent",pointerEvents:"all",onMouseDown:n,onTouchStart:r,onDoubleClick:s,style:{cursor:"move"}}),h.lanes.map(O=>o.jsx("path",{d:O.outerPath,fill:_(O.laneNumber),stroke:"none",pointerEvents:"none"},`lane-fill-${O.laneNumber}`))]}):o.jsx(o.Fragment,{children:h.lanes.map((O,q)=>{const P=h.lanes[q+1],W=P?P.outerPath:O.innerPath,j=q===0;return o.jsx("path",{d:`${O.outerPath} ${W}`,fill:_(O.laneNumber),fillRule:"evenodd",stroke:"none",pointerEvents:j?"all":"none",onMouseDown:j?n:void 0,onTouchStart:j?r:void 0,onDoubleClick:j?s:void 0,style:j?{cursor:"move"}:void 0},`lane-fill-${O.laneNumber}`)})}),h.lanes.map((O,q)=>o.jsx(e5,{lane:O,lineColor:w,lineWidth:S,isLastLane:q===h.lanes.length-1,isStraightTrack:f,geometry:h},`stroke-${O.laneNumber}`)),((k=a.startingBoxes)==null?void 0:k.enabled)&&o.jsx(ZE,{geometry:h,parameters:a,boxConfig:{...a.startingBoxes,perLaneOffsets:((E=t.template)==null?void 0:E.trackType)==="curved"?p1(h):[]},surfaceColor:b,lineColor:w,isStraightTrack:((T=t.template)==null?void 0:T.trackType)==="straight"}),e&&o.jsxs(o.Fragment,{children:[o.jsx("rect",{x:"-10",y:"-10",width:m+20,height:g+20,fill:"none",stroke:"#0066CC",strokeWidth:"80",strokeDasharray:"400 400",opacity:"0.5",pointerEvents:"none"}),o.jsx(XE,{track:t,svgRef:i})]})]})}function e5({lane:t,lineColor:e,lineWidth:n,isLastLane:r,isStraightTrack:s,geometry:i}){const{innerPath:a,outerPath:l}=t,c=50;return s?o.jsxs("g",{className:"track-lane-stroke",children:[t.laneNumber===1&&o.jsx("line",{x1:t.laneX,y1:0,x2:t.laneX,y2:i.totalLength,stroke:e,strokeWidth:c,pointerEvents:"none"}),o.jsx("line",{x1:t.laneX+t.laneWidth,y1:0,x2:t.laneX+t.laneWidth,y2:i.totalLength,stroke:e,strokeWidth:c,pointerEvents:"none"})]}):o.jsxs("g",{className:"track-lane-stroke",children:[o.jsx("path",{d:l,fill:"none",stroke:e,strokeWidth:c,pointerEvents:"none"}),r&&o.jsx("path",{d:a,fill:"none",stroke:e,strokeWidth:c,pointerEvents:"none"})]})}function t5({motif:t,isSelected:e,onMouseDown:n,onTouchStart:r,onDoubleClick:s,onScaleStart:i,onRotateStart:a}){const{svgContent:l,originalWidth_mm:c,originalHeight_mm:d,position:u,rotation:p,scale:h}=t,f=R.useMemo(()=>{if(!l)return null;const _=l.match(/viewBox=["']([^"']+)["']/i);if(_){const T=_[1].split(/\s+/).map(Number);if(T.length>=4)return{width:T[2],height:T[3]}}const k=l.match(/\bwidth=["']?(\d+(?:\.\d+)?)/i),E=l.match(/\bheight=["']?(\d+(?:\.\d+)?)/i);return k&&E?{width:parseFloat(k[1]),height:parseFloat(E[1])}:null},[l]),m=R.useMemo(()=>{if(!f)return{width:c,height:d};const _=f.width/f.height,k=c/d,E=_>=1,T=k>=1;if(E!==T){console.warn("[MOTIF] Orientation mismatch detected - using SVG viewBox aspect ratio"),console.log("[MOTIF] SVG viewBox:",f,"AR:",_.toFixed(2)),console.log("[MOTIF] Physical dims:",c,"",d,"AR:",k.toFixed(2));const O=c*d,q=Math.sqrt(O*_),P=q/_;return{width:q,height:P}}return{width:c,height:d}},[f,c,d]),g=m.width*(h||1),v=m.height*(h||1),y=g/2,x=v/2,b=`translate(${u.x}, ${u.y}) rotate(${p||0}, ${y}, ${x})`,w=R.useMemo(()=>{if(!l)return null;try{let _=l;return _=_.replace(/\s+(width|height)=["'][^"']*["']/gi,""),_.includes("viewBox")||(_=_.replace("<svg",`<svg viewBox="0 0 ${m.width} ${m.height}"`)),_}catch(_){return console.error("[MOTIF] Error processing SVG:",_),l}},[l,m]),S=R.useMemo(()=>{if(!w)return null;try{return`data:image/svg+xml,${encodeURIComponent(w).replace(/'/g,"%27").replace(/"/g,"%22")}`}catch(_){return console.error("[MOTIF] Error creating data URL:",_),null}},[w]);return S?o.jsxs("g",{className:`motif-element ${e?"motif-element--selected":""}`,transform:b,style:{cursor:"move"},children:[o.jsx("image",{href:S,x:"0",y:"0",width:g,height:v,preserveAspectRatio:"xMidYMid meet",pointerEvents:"none"}),o.jsx("rect",{x:"0",y:"0",width:g,height:v,fill:"transparent",pointerEvents:"all",onMouseDown:n,onTouchStart:r,onDoubleClick:s,style:{cursor:"move"}}),e&&o.jsx("rect",{x:"-10",y:"-10",width:g+20,height:v+20,fill:"none",stroke:"#9333EA",strokeWidth:"80",strokeDasharray:"400 400",opacity:"0.7",pointerEvents:"none"}),e&&o.jsx(n5,{width:g,height:v,onScaleStart:i,onRotateStart:a})]}):o.jsxs("g",{transform:b,children:[o.jsx("rect",{x:"0",y:"0",width:g,height:v,fill:"#f0f0f0",stroke:"#ccc",strokeWidth:"50",strokeDasharray:"200 200"}),o.jsx("text",{x:g/2,y:v/2,textAnchor:"middle",dominantBaseline:"middle",fontSize:Math.min(g,v)/10,fill:"#999",children:"Motif Error"})]})}function n5({width:t,height:e,onScaleStart:n,onRotateStart:r}){const s=Math.min(t,e)*.08,l=Math.max(150,Math.min(400,s)),c=[{x:-l/2,y:-l/2,corner:"nw",cursor:"nwse-resize"},{x:t-l/2,y:-l/2,corner:"ne",cursor:"nesw-resize"},{x:-l/2,y:e-l/2,corner:"sw",cursor:"nesw-resize"},{x:t-l/2,y:e-l/2,corner:"se",cursor:"nwse-resize"}],d=l*2.5,u=l*.8;return o.jsxs("g",{className:"motif-handles",children:[c.map(p=>o.jsx("rect",{x:p.x,y:p.y,width:l,height:l,fill:"#9333EA",stroke:"#fff",strokeWidth:"20",rx:l/4,style:{cursor:p.cursor},pointerEvents:"all",onMouseDown:h=>{h.stopPropagation(),n==null||n(h,p.corner)},onTouchStart:h=>{h.stopPropagation(),n==null||n(h,p.corner)}},p.corner)),o.jsx("line",{x1:t/2,y1:0,x2:t/2,y2:-d+u/2,stroke:"#9333EA",strokeWidth:"30",pointerEvents:"none"}),o.jsx("circle",{cx:t/2,cy:-d,r:u,fill:"#9333EA",stroke:"#fff",strokeWidth:"20",style:{cursor:"grab"},pointerEvents:"all",onMouseDown:p=>{p.stopPropagation(),r==null||r(p)},onTouchStart:p=>{p.stopPropagation(),r==null||r(p)}}),o.jsx("path",{d:`M ${t/2-u*.4} ${-d}
            A ${u*.4} ${u*.4} 0 1 1
            ${t/2+u*.4} ${-d}`,fill:"none",stroke:"#fff",strokeWidth:"25",strokeLinecap:"round",pointerEvents:"none"}),o.jsx("polygon",{points:`${t/2+u*.4},${-d-u*.25}
                 ${t/2+u*.4},${-d+u*.25}
                 ${t/2+u*.65},${-d}`,fill:"#fff",pointerEvents:"none"})]})}function f1(t,e,n,r=0,s=!1,i=.5){if(s&&t>=3)return s5(t,e,n,i,r);if(t>=32)return o5(e,n);const a=r5(t,e,n);return r>0?m1(a,r):`M ${a.map(l=>`${l.x},${l.y}`).join(" L ")} Z`}function r5(t,e,n){if(t===4)return[{x:0,y:0},{x:e,y:0},{x:e,y:n},{x:0,y:n}];const r=[],s=2*Math.PI/t,i=-Math.PI/2;for(let m=0;m<t;m++){const g=i+s*m;r.push({x:Math.cos(g),y:Math.sin(g)})}let a=1/0,l=-1/0,c=1/0,d=-1/0;for(const m of r)a=Math.min(a,m.x),l=Math.max(l,m.x),c=Math.min(c,m.y),d=Math.max(d,m.y);const u=l-a,p=d-c,h=e/u,f=n/p;return r.map(m=>({x:(m.x-a)*h,y:(m.y-c)*f}))}function s5(t,e,n,r=.5,s=0){const i=i5(t,e,n,r);return s>0?m1(i,s):`M ${i.map(a=>`${a.x},${a.y}`).join(" L ")} Z`}function i5(t,e,n,r=.5){const s=[],i=t*2,a=2*Math.PI/i,l=-Math.PI/2,c=Math.max(.1,Math.min(.9,r));for(let y=0;y<i;y++){const x=l+a*y,b=y%2===0?1:c;s.push({x:Math.cos(x)*b,y:Math.sin(x)*b})}let d=1/0,u=-1/0,p=1/0,h=-1/0;for(const y of s)d=Math.min(d,y.x),u=Math.max(u,y.x),p=Math.min(p,y.y),h=Math.max(h,y.y);const f=u-d,m=h-p,g=e/f,v=n/m;return s.map(y=>({x:(y.x-d)*g,y:(y.y-p)*v}))}function o5(t,e){const n=t/2,r=e/2,s=n,i=r;return`M ${s-n},${i} A ${n},${r} 0 1,1 ${s+n},${i} A ${n},${r} 0 1,1 ${s-n},${i} Z`}function m1(t,e,n,r){if(t.length<3)return"";let s=1/0;for(let h=0;h<t.length;h++){const f=t[h],m=t[(h+1)%t.length],g=Math.sqrt(Math.pow(m.x-f.x,2)+Math.pow(m.y-f.y,2));s=Math.min(s,g)}const i=s/2,a=e/100*i;if(a<1)return`M ${t.map(h=>`${h.x},${h.y}`).join(" L ")} Z`;const l=[];for(let h=0;h<t.length;h++){const f=t[(h-1+t.length)%t.length],m=t[h],g=t[(h+1)%t.length],v=qu({x:f.x-m.x,y:f.y-m.y}),y=qu({x:g.x-m.x,y:g.y-m.y}),x={x:m.x+v.x*a,y:m.y+v.y*a},b={x:m.x+y.x*a,y:m.y+y.y*a};h===0?l.push(`M ${x.x},${x.y}`):l.push(`L ${x.x},${x.y}`),l.push(`Q ${m.x},${m.y} ${b.x},${b.y}`)}const c=t[t.length-1],d=t[0],u=qu({x:c.x-d.x,y:c.y-d.y}),p={x:d.x+u.x*a,y:d.y+u.y*a};return l.push(`L ${p.x},${p.y}`),l.push("Z"),l.join(" ")}function qu(t){const e=Math.sqrt(t.x*t.x+t.y*t.y);return e===0?{x:0,y:0}:{x:t.x/e,y:t.y/e}}function a5(t,e=!1){if(e)return t===5?"Star":`${t}-Point Star`;const n={3:"Triangle",4:"Rectangle",5:"Pentagon",6:"Hexagon",7:"Heptagon",8:"Octagon",9:"Nonagon",10:"Decagon",12:"Dodecagon"};return t>=32?"Circle":n[t]?n[t]:`${t}-gon`}function l5(t,e=!1){return e?"":t>=32?"":t===3?"":t===4?"":t===5?"":t===6?"":`${t}`}function c5({shape:t,isSelected:e,onMouseDown:n,onTouchStart:r,onDoubleClick:s,onScaleStart:i,onRotateStart:a}){const{sides:l,width_mm:c,height_mm:d,cornerRadius:u,starMode:p,innerRadius:h,position:f,rotation:m,fillColor:g,strokeEnabled:v,strokeColor:y,strokeWidth_mm:x}=t,b=R.useMemo(()=>f1(l,c,d,u,p,h),[l,c,d,u,p,h]),w=c/2,S=d/2,_=`translate(${f.x}, ${f.y}) rotate(${m||0}, ${w}, ${S})`;return o.jsxs("g",{className:`shape-element ${e?"shape-element--selected":""}`,transform:_,style:{cursor:"move"},children:[o.jsx("path",{d:b,fill:(g==null?void 0:g.hex)||"#609B63",stroke:v&&y?y.hex:"none",strokeWidth:v?x:0,pointerEvents:"none"}),o.jsx("path",{d:b,fill:"transparent",stroke:"transparent",strokeWidth:Math.max(x,100),pointerEvents:"all",onMouseDown:n,onTouchStart:r,onDoubleClick:s,style:{cursor:"move"}}),e&&o.jsx("rect",{x:"-10",y:"-10",width:c+20,height:d+20,fill:"none",stroke:"#3b82f6",strokeWidth:"80",strokeDasharray:"400 400",opacity:"0.7",pointerEvents:"none"}),e&&o.jsx(d5,{width:c,height:d,onScaleStart:i,onRotateStart:a})]})}function d5({width:t,height:e,onScaleStart:n,onRotateStart:r}){const s=Math.min(t,e)*.08,l=Math.max(150,Math.min(400,s)),c=[{x:t/2-l/2,y:-l/2,corner:"n",cursor:"ns-resize"},{x:t/2-l/2,y:e-l/2,corner:"s",cursor:"ns-resize"},{x:t-l/2,y:e/2-l/2,corner:"e",cursor:"ew-resize"},{x:-l/2,y:e/2-l/2,corner:"w",cursor:"ew-resize"}],d=l*2.5,u=l*.8;return o.jsxs("g",{className:"shape-handles",children:[c.map(p=>o.jsx("rect",{x:p.x,y:p.y,width:l,height:l,fill:"#3b82f6",stroke:"#fff",strokeWidth:"20",rx:l/4,style:{cursor:p.cursor},pointerEvents:"all",onMouseDown:h=>{h.stopPropagation(),n==null||n(h,p.corner)},onTouchStart:h=>{h.stopPropagation(),n==null||n(h,p.corner)}},p.corner)),o.jsx("line",{x1:t/2,y1:0,x2:t/2,y2:-d+u/2,stroke:"#3b82f6",strokeWidth:"30",pointerEvents:"none"}),o.jsx("circle",{cx:t/2,cy:-d,r:u,fill:"#3b82f6",stroke:"#fff",strokeWidth:"20",style:{cursor:"grab"},pointerEvents:"all",onMouseDown:p=>{p.stopPropagation(),r==null||r(p)},onTouchStart:p=>{p.stopPropagation(),r==null||r(p)}}),o.jsx("path",{d:`M ${t/2-u*.4} ${-d}
            A ${u*.4} ${u*.4} 0 1 1
            ${t/2+u*.4} ${-d}`,fill:"none",stroke:"#fff",strokeWidth:"25",strokeLinecap:"round",pointerEvents:"none"}),o.jsx("polygon",{points:`${t/2+u*.4},${-d-u*.25}
                 ${t/2+u*.4},${-d+u*.25}
                 ${t/2+u*.65},${-d}`,fill:"#fff",pointerEvents:"none"})]})}function g1({controlPoints:t,width:e,height:n,onPointDrag:r,onHandleDrag:s,onDragEnd:i,showHandles:a=!0,selectedPointIndex:l,onPointSelect:c,onPointDelete:d}){const[u,p]=R.useState(null),[h,f]=R.useState(null),m=Math.min(e,n)*.03,y=Math.max(60,Math.min(120,m)),x=y*.7,b=R.useCallback((_,k)=>{_.stopPropagation(),_.preventDefault(),c==null||c(k),p({type:"point",index:k}),f({x:_.clientX,y:_.clientY})},[c]),w=R.useCallback((_,k)=>{_.preventDefault(),_.stopPropagation(),d==null||d(k)},[d]),S=R.useCallback((_,k,E)=>{_.stopPropagation(),_.preventDefault(),p({type:"handle",index:k,handleType:E}),f({x:_.clientX,y:_.clientY})},[]);return R.useEffect(()=>{if(!u)return;const _=E=>{if(!h)return;const T=document.querySelector(".court-canvas__svg");if(!T)return;const O=T.getBoundingClientRect(),q=T.viewBox.baseVal,P=q.width/O.width,W=q.height/O.height,j=(E.clientX-h.x)*P,G=(E.clientY-h.y)*W;if(u.type==="point"){const pe=t[u.index],Z=pe.x+j/e,ee=pe.y+G/n;r==null||r(u.index,Z,ee)}else if(u.type==="handle"){const Z=t[u.index][u.handleType],ee=Z.x+j/e,F=Z.y+G/n;s==null||s(u.index,u.handleType,ee,F)}f({x:E.clientX,y:E.clientY})},k=()=>{p(null),f(null),i==null||i()};return window.addEventListener("mousemove",_),window.addEventListener("mouseup",k),()=>{window.removeEventListener("mousemove",_),window.removeEventListener("mouseup",k)}},[u,h,t,e,n,r,s,i]),!t||t.length===0?null:o.jsx("g",{className:"blob-edit-handles",children:t.map((_,k)=>{const E=_.x*e,T=_.y*n,O=E+_.handleIn.x*e,q=T+_.handleIn.y*n,P=E+_.handleOut.x*e,W=T+_.handleOut.y*n,j=(u==null?void 0:u.type)==="point"&&(u==null?void 0:u.index)===k,G=(u==null?void 0:u.type)==="handle"&&(u==null?void 0:u.index)===k&&(u==null?void 0:u.handleType)==="handleIn",pe=(u==null?void 0:u.type)==="handle"&&(u==null?void 0:u.index)===k&&(u==null?void 0:u.handleType)==="handleOut",Z=l===k;return o.jsxs("g",{className:"blob-control-point-group",children:[a&&o.jsxs(o.Fragment,{children:[o.jsx("line",{x1:E,y1:T,x2:O,y2:q,stroke:"#94a3b8",strokeWidth:"20",strokeDasharray:"60 40",pointerEvents:"none",opacity:"0.8"}),o.jsx("line",{x1:E,y1:T,x2:P,y2:W,stroke:"#94a3b8",strokeWidth:"20",strokeDasharray:"60 40",pointerEvents:"none",opacity:"0.8"}),o.jsx("circle",{cx:O,cy:q,r:x,fill:G?"#f97316":"#ffffff",stroke:"#64748b",strokeWidth:"15",style:{cursor:"crosshair"},pointerEvents:"all",onMouseDown:ee=>S(ee,k,"handleIn")}),o.jsx("circle",{cx:P,cy:W,r:x,fill:pe?"#f97316":"#ffffff",stroke:"#64748b",strokeWidth:"15",style:{cursor:"crosshair"},pointerEvents:"all",onMouseDown:ee=>S(ee,k,"handleOut")})]}),o.jsx("circle",{cx:E,cy:T,r:y,fill:Z?"#ef4444":j?"#f97316":"#3b82f6",stroke:"#ffffff",strokeWidth:"20",style:{cursor:"move"},pointerEvents:"all",onMouseDown:ee=>b(ee,k),onContextMenu:ee=>w(ee,k)}),o.jsx("text",{x:E,y:T+y*.35,textAnchor:"middle",fontSize:y*.8,fill:"#ffffff",fontWeight:"bold",pointerEvents:"none",children:k+1})]},k)})})}function u5({shape:t,isSelected:e,onMouseDown:n,onTouchStart:r,onDoubleClick:s,onScaleStart:i,onRotateStart:a,onPointDrag:l,onHandleDrag:c,onDragEnd:d,selectedPointIndex:u,onPointSelect:p,onPointDelete:h}){const{controlPoints:f,width_mm:m,height_mm:g,position:v,rotation:y,fillColor:x,strokeEnabled:b,strokeColor:w,strokeWidth_mm:S,editPointsVisible:_}=t,k=R.useMemo(()=>xE(f,m,g),[f,m,g]),E=m/2,T=g/2,O=`translate(${v.x}, ${v.y}) rotate(${y||0}, ${E}, ${T})`;return o.jsxs("g",{className:`blob-element ${e?"blob-element--selected":""}`,transform:O,style:{cursor:"move"},children:[o.jsx("path",{d:k,fill:(x==null?void 0:x.hex)||"#609B63",stroke:b&&w?w.hex:"none",strokeWidth:b?S:0,pointerEvents:"none"}),o.jsx("path",{d:k,fill:"transparent",stroke:"transparent",strokeWidth:Math.max(S||0,100),pointerEvents:"all",onTouchStart:r,onMouseDown:n,onDoubleClick:s,style:{cursor:"move"}}),e&&o.jsx("rect",{x:"-10",y:"-10",width:m+20,height:g+20,fill:"none",stroke:"#3b82f6",strokeWidth:"80",strokeDasharray:"400 400",opacity:"0.7",pointerEvents:"none"}),e&&o.jsx(h5,{width:m,height:g,onScaleStart:i,onRotateStart:a}),e&&f&&_&&o.jsx(g1,{controlPoints:f,width:m,height:g,onPointDrag:l,onHandleDrag:c,onDragEnd:d,showHandles:!0,selectedPointIndex:u,onPointSelect:p,onPointDelete:h})]})}function h5({width:t,height:e,onScaleStart:n,onRotateStart:r}){const s=Math.min(t,e)*.08,l=Math.max(150,Math.min(400,s)),c=[{x:-l/2,y:-l/2,corner:"nw",cursor:"nwse-resize"},{x:t-l/2,y:-l/2,corner:"ne",cursor:"nesw-resize"},{x:-l/2,y:e-l/2,corner:"sw",cursor:"nesw-resize"},{x:t-l/2,y:e-l/2,corner:"se",cursor:"nwse-resize"}],d=l*2.5,u=l*.8;return o.jsxs("g",{className:"blob-resize-handles",children:[c.map(p=>o.jsx("rect",{x:p.x,y:p.y,width:l,height:l,fill:"#3b82f6",stroke:"#fff",strokeWidth:"20",rx:l/4,style:{cursor:p.cursor},pointerEvents:"all",onMouseDown:h=>{h.stopPropagation(),n==null||n(h,p.corner)},onTouchStart:h=>{h.stopPropagation(),n==null||n(h,p.corner)}},p.corner)),o.jsx("line",{x1:t/2,y1:0,x2:t/2,y2:-d+u/2,stroke:"#3b82f6",strokeWidth:"30",pointerEvents:"none"}),o.jsx("circle",{cx:t/2,cy:-d,r:u,fill:"#3b82f6",stroke:"#fff",strokeWidth:"20",style:{cursor:"grab"},pointerEvents:"all",onMouseDown:p=>{p.stopPropagation(),r==null||r(p)},onTouchStart:p=>{p.stopPropagation(),r==null||r(p)}}),o.jsx("path",{d:`M ${t/2-u*.4} ${-d}
            A ${u*.4} ${u*.4} 0 1 1
            ${t/2+u*.4} ${-d}`,fill:"none",stroke:"#fff",strokeWidth:"25",strokeLinecap:"round",pointerEvents:"none"}),o.jsx("polygon",{points:`${t/2+u*.4},${-d-u*.25}
                 ${t/2+u*.4},${-d+u*.25}
                 ${t/2+u*.65},${-d}`,fill:"#fff",pointerEvents:"none"})]})}function p5({shape:t,isSelected:e,onMouseDown:n,onTouchStart:r,onDoubleClick:s,onScaleStart:i,onRotateStart:a,onPointDrag:l,onHandleDrag:c,onDragEnd:d,selectedPointIndex:u,onPointSelect:p,onPointDelete:h}){const{controlPoints:f,width_mm:m,height_mm:g,position:v,rotation:y,fillColor:x,strokeEnabled:b,strokeColor:w,strokeWidth_mm:S,editPointsVisible:_,closed:k,smooth:E}=t,T=R.useMemo(()=>!f||f.length<2?"":c1(f,m,g,k,E),[f,m,g,k,E]),O=m/2,q=g/2,P=`translate(${v.x}, ${v.y}) rotate(${y||0}, ${O}, ${q})`;return T?o.jsxs("g",{className:`path-element ${e?"path-element--selected":""}`,transform:P,style:{cursor:"move"},children:[o.jsx("path",{d:T,fill:k?(x==null?void 0:x.hex)||"#609B63":"none",stroke:b&&w?w.hex:k?"none":(x==null?void 0:x.hex)||"#609B63",strokeWidth:b?S:k?0:50,strokeLinecap:"round",strokeLinejoin:"round",pointerEvents:"none"}),o.jsx("path",{d:T,fill:"transparent",stroke:"transparent",strokeWidth:Math.max(S||0,200),pointerEvents:"all",onTouchStart:r,onMouseDown:n,onDoubleClick:s,style:{cursor:"move"}}),e&&o.jsx("rect",{x:"-10",y:"-10",width:m+20,height:g+20,fill:"none",stroke:"#3b82f6",strokeWidth:"80",strokeDasharray:"400 400",opacity:"0.7",pointerEvents:"none"}),e&&o.jsx(f5,{width:m,height:g,onScaleStart:i,onRotateStart:a}),e&&f&&_&&o.jsx(g1,{controlPoints:f,width:m,height:g,onPointDrag:l,onHandleDrag:c,onDragEnd:d,showHandles:E,selectedPointIndex:u,onPointSelect:p,onPointDelete:h})]}):null}function f5({width:t,height:e,onScaleStart:n,onRotateStart:r}){const s=Math.min(t,e)*.08,l=Math.max(150,Math.min(400,s)),c=[{x:-l/2,y:-l/2,corner:"nw",cursor:"nwse-resize"},{x:t-l/2,y:-l/2,corner:"ne",cursor:"nesw-resize"},{x:-l/2,y:e-l/2,corner:"sw",cursor:"nesw-resize"},{x:t-l/2,y:e-l/2,corner:"se",cursor:"nwse-resize"}],d=l*2.5,u=l*.8;return o.jsxs("g",{className:"path-resize-handles",children:[c.map(p=>o.jsx("rect",{x:p.x,y:p.y,width:l,height:l,fill:"#3b82f6",stroke:"#fff",strokeWidth:"20",rx:l/4,style:{cursor:p.cursor},pointerEvents:"all",onMouseDown:h=>{h.stopPropagation(),n==null||n(h,p.corner)},onTouchStart:h=>{h.stopPropagation(),n==null||n(h,p.corner)}},p.corner)),o.jsx("line",{x1:t/2,y1:0,x2:t/2,y2:-d+u/2,stroke:"#3b82f6",strokeWidth:"30",pointerEvents:"none"}),o.jsx("circle",{cx:t/2,cy:-d,r:u,fill:"#3b82f6",stroke:"#fff",strokeWidth:"20",style:{cursor:"grab"},pointerEvents:"all",onMouseDown:p=>{p.stopPropagation(),r==null||r(p)},onTouchStart:p=>{p.stopPropagation(),r==null||r(p)}}),o.jsx("path",{d:`M ${t/2-u*.4} ${-d}
            A ${u*.4} ${u*.4} 0 1 1
            ${t/2+u*.4} ${-d}`,fill:"none",stroke:"#fff",strokeWidth:"25",strokeLinecap:"round",pointerEvents:"none"}),o.jsx("polygon",{points:`${t/2+u*.4},${-d-u*.25}
                 ${t/2+u*.4},${-d+u*.25}
                 ${t/2+u*.65},${-d}`,fill:"#fff",pointerEvents:"none"})]})}function Os(t,e,n,r="normal",s="normal"){Os._canvas||(Os._canvas=document.createElement("canvas"),Os._ctx=Os._canvas.getContext("2d"));const i=Os._ctx,a=s==="italic"?"italic ":"",l=r==="bold"?"bold ":"";i.font=`${a}${l}${n}px ${e}`;const c=i.measureText(t||"Double-click to edit");return{width:Math.max(c.width,100),height:n*1.2}}function m5(){return[{name:"Open Sans",family:"Open Sans, sans-serif"},{name:"Roboto",family:"Roboto, sans-serif"},{name:"Montserrat",family:"Montserrat, sans-serif"},{name:"Oswald",family:"Oswald, sans-serif"},{name:"Black Ops One",family:"Black Ops One, sans-serif"},{name:"Playfair Display",family:"Playfair Display, serif"},{name:"Arial",family:"Arial, sans-serif"},{name:"Georgia",family:"Georgia, serif"},{name:"Impact",family:"Impact, sans-serif"}]}function g5({text:t,isSelected:e,isEditing:n,onMouseDown:r,onTouchStart:s,onDoubleClick:i,onScaleStart:a,onRotateStart:l,onContentChange:c,onEditComplete:d}){const u=R.useRef(null),{content:p,fontFamily:h,fontSize_mm:f,fontWeight:m,fontStyle:g,textAlign:v,position:y,rotation:x,fillColor:b,strokeColor:w,strokeWidth_mm:S}=t,_=R.useMemo(()=>Os(p,h,f,m,g),[p,h,f,m,g]),k=R.useMemo(()=>{switch(v){case"center":return-_.width/2;case"right":return-_.width;default:return 0}},[v,_.width]),E=`translate(${y.x}, ${y.y}) rotate(${x||0})`;R.useEffect(()=>{n&&u.current&&(u.current.focus(),u.current.select())},[n]);const T=q=>{(q.key==="Enter"||q.key==="Escape")&&(q.preventDefault(),d==null||d())},O=p||"Double-click to edit";return o.jsxs("g",{className:`text-element ${e?"text-element--selected":""} ${n?"text-element--editing":""}`,transform:E,children:[n?o.jsx("foreignObject",{x:k-10,y:-f*.85,width:Math.max(_.width+200,500),height:f*1.5,style:{overflow:"visible"},children:o.jsx("input",{ref:u,type:"text",value:p,onChange:q=>c==null?void 0:c(q.target.value),onBlur:d,onKeyDown:T,style:{fontFamily:h,fontSize:`${f}px`,fontWeight:m,fontStyle:g,color:(b==null?void 0:b.hex)||"#1C1C1C",background:"rgba(255,255,255,0.95)",border:"4px solid #3b82f6",borderRadius:"4px",outline:"none",padding:"4px 8px",width:"100%",boxSizing:"border-box",lineHeight:1}})}):o.jsxs(o.Fragment,{children:[o.jsx("text",{x:"0",y:"0",fontFamily:h,fontSize:f,fontWeight:m,fontStyle:g,textAnchor:v==="center"?"middle":v==="right"?"end":"start",fill:(b==null?void 0:b.hex)||"#1C1C1C",stroke:(w==null?void 0:w.hex)||"none",strokeWidth:S||0,strokeLinejoin:"round",strokeLinecap:"round",paintOrder:"stroke fill",style:{cursor:"move",userSelect:"none"},pointerEvents:"none",children:O}),o.jsx("rect",{x:k-20,y:-f*.85,width:_.width+40,height:f*1.2,fill:"transparent",onMouseDown:r,onTouchStart:s,onDoubleClick:i,style:{cursor:"move"}})]}),e&&!n&&o.jsx("rect",{x:k-40,y:-f-40,width:_.width+80,height:f*1.2+80,fill:"none",stroke:"#3b82f6",strokeWidth:"60",strokeDasharray:"300 300",opacity:"0.7",pointerEvents:"none"}),e&&!n&&o.jsx(y5,{bounds:_,fontSize:f,alignOffset:k,onScaleStart:a,onRotateStart:l})]})}function y5({bounds:t,fontSize:e,alignOffset:n,onScaleStart:r,onRotateStart:s}){const i=Math.min(t.width,e)*.15,c=Math.max(100,Math.min(300,i)),d=n-20,u=-e-20,p=t.width+40,h=e*1.2+40,f=[{x:d-c/2,y:u-c/2,corner:"nw",cursor:"nwse-resize"},{x:d+p-c/2,y:u-c/2,corner:"ne",cursor:"nesw-resize"},{x:d-c/2,y:u+h-c/2,corner:"sw",cursor:"nesw-resize"},{x:d+p-c/2,y:u+h-c/2,corner:"se",cursor:"nwse-resize"}],m=c*2.5,g=c*.8,v=d+p/2;return o.jsxs("g",{className:"text-handles",children:[f.map(y=>o.jsx("rect",{x:y.x,y:y.y,width:c,height:c,fill:"#3b82f6",stroke:"#fff",strokeWidth:"15",rx:c/4,style:{cursor:y.cursor},pointerEvents:"all",onMouseDown:x=>{x.stopPropagation(),r==null||r(x,y.corner)},onTouchStart:x=>{x.stopPropagation(),r==null||r(x,y.corner)}},y.corner)),o.jsx("line",{x1:v,y1:u,x2:v,y2:u-m+g/2,stroke:"#3b82f6",strokeWidth:"25",pointerEvents:"none"}),o.jsx("circle",{cx:v,cy:u-m,r:g,fill:"#3b82f6",stroke:"#fff",strokeWidth:"15",style:{cursor:"grab"},pointerEvents:"all",onMouseDown:y=>{y.stopPropagation(),s==null||s(y)},onTouchStart:y=>{y.stopPropagation(),s==null||s(y)}}),o.jsx("path",{d:`M ${v-g*.4} ${u-m}
            A ${g*.4} ${g*.4} 0 1 1
            ${v+g*.4} ${u-m}`,fill:"none",stroke:"#fff",strokeWidth:"20",strokeLinecap:"round",pointerEvents:"none"}),o.jsx("polygon",{points:`${v+g*.4},${u-m-g*.25}
                 ${v+g*.4},${u-m+g*.25}
                 ${v+g*.65},${u-m}`,fill:"#fff",pointerEvents:"none"})]})}function x5({zone:t,isSelected:e,onMouseDown:n,onTouchStart:r,onDoubleClick:s,onScaleStart:i,onRotateStart:a}){const{id:l,shapeType:c,sides:d,width_mm:u,height_mm:p,cornerRadius:h,position:f,rotation:m,controlPoints:g}=t,v=`exclusion-crosshatch-${l}`,y=R.useMemo(()=>c==="path"&&g?c1(g,u,p,!0):f1(d||4,u,p,h||0),[c,d,u,p,h,g]),x=u/2,b=p/2,w=`translate(${f.x}, ${f.y}) rotate(${m||0}, ${x}, ${b})`,S=Math.min(u,p)*.02,E=Math.max(100,Math.min(500,S)),T=E*.15;return o.jsxs("g",{className:`exclusion-zone-element ${e?"exclusion-zone-element--selected":""}`,transform:w,style:{cursor:"move"},children:[o.jsx("defs",{children:o.jsxs("pattern",{id:v,patternUnits:"userSpaceOnUse",width:E,height:E,patternTransform:"rotate(45)",children:[o.jsx("rect",{width:E,height:E,fill:"#e5e5e5"}),o.jsx("line",{x1:"0",y1:"0",x2:"0",y2:E,stroke:"#999",strokeWidth:T}),o.jsx("line",{x1:E/2,y1:"0",x2:E/2,y2:E,stroke:"#999",strokeWidth:T})]})}),o.jsx("path",{d:y,fill:`url(#${v})`,stroke:"#666",strokeWidth:"60",strokeDasharray:"200 100",pointerEvents:"none"}),o.jsx("path",{d:y,fill:"transparent",stroke:"transparent",strokeWidth:"200",pointerEvents:"all",onMouseDown:n,onTouchStart:r,onDoubleClick:s,style:{cursor:"move"}}),e&&o.jsx("rect",{x:"-10",y:"-10",width:u+20,height:p+20,fill:"none",stroke:"#ef4444",strokeWidth:"80",strokeDasharray:"400 400",opacity:"0.7",pointerEvents:"none"}),e&&o.jsx(v5,{width:u,height:p,onScaleStart:i,onRotateStart:a})]})}function v5({width:t,height:e,onScaleStart:n,onRotateStart:r}){const s=Math.min(t,e)*.08,l=Math.max(150,Math.min(400,s)),c=[{x:t/2-l/2,y:-l/2,corner:"n",cursor:"ns-resize"},{x:t/2-l/2,y:e-l/2,corner:"s",cursor:"ns-resize"},{x:t-l/2,y:e/2-l/2,corner:"e",cursor:"ew-resize"},{x:-l/2,y:e/2-l/2,corner:"w",cursor:"ew-resize"}],d=l*2.5,u=l*.8;return o.jsxs("g",{className:"exclusion-zone-handles",children:[c.map(p=>o.jsx("rect",{x:p.x,y:p.y,width:l,height:l,fill:"#ef4444",stroke:"#fff",strokeWidth:"20",rx:l/4,style:{cursor:p.cursor},pointerEvents:"all",onMouseDown:h=>{h.stopPropagation(),n==null||n(h,p.corner)},onTouchStart:h=>{h.stopPropagation(),n==null||n(h,p.corner)}},p.corner)),o.jsx("line",{x1:t/2,y1:0,x2:t/2,y2:-d+u/2,stroke:"#ef4444",strokeWidth:"30",pointerEvents:"none"}),o.jsx("circle",{cx:t/2,cy:-d,r:u,fill:"#ef4444",stroke:"#fff",strokeWidth:"20",style:{cursor:"grab"},pointerEvents:"all",onMouseDown:p=>{p.stopPropagation(),r==null||r(p)},onTouchStart:p=>{p.stopPropagation(),r==null||r(p)}}),o.jsx("path",{d:`M ${t/2-u*.4} ${-d}
            A ${u*.4} ${u*.4} 0 1 1
            ${t/2+u*.4} ${-d}`,fill:"none",stroke:"#fff",strokeWidth:"25",strokeLinecap:"round",pointerEvents:"none"}),o.jsx("polygon",{points:`${t/2+u*.4},${-d-u*.25}
                 ${t/2+u*.4},${-d+u*.25}
                 ${t/2+u*.65},${-d}`,fill:"#fff",pointerEvents:"none"})]})}function b5({groupId:t,scale:e=1}){const{groups:n,selectedGroupId:r,editingGroupId:s,shapes:i,selectGroup:a,enterGroup:l,updateGroupPosition:c,commitGroupMove:d}=it(),u=n[t];if(!u||!u.bounds||s===t)return null;const p=r===t,{x:h,y:f,width:m,height:g}=u.bounds,v=8/e,y=v/2,x=w=>{w.stopPropagation(),a(t)},b=w=>{w.stopPropagation(),l(t)};return u.childIds.map(w=>i[w]).filter(Boolean),o.jsxs("g",{className:"group-element",children:[o.jsx("rect",{x:h,y:f,width:m,height:g,fill:"transparent",stroke:p?"#9333ea":"#a855f7",strokeWidth:p?2/e:1/e,strokeDasharray:p?"none":`${4/e} ${4/e}`,rx:4/e,ry:4/e,style:{cursor:"move"},onMouseDown:x,onDoubleClick:b}),!p&&o.jsx("text",{x:h+4/e,y:f-4/e,fontSize:10/e,fill:"#9333ea",fontFamily:"system-ui, -apple-system, sans-serif",fontWeight:"500",children:u.compoundType?`${u.compoundType.charAt(0).toUpperCase()+u.compoundType.slice(1)} Group`:u.customName||"Group"}),p&&o.jsxs(o.Fragment,{children:[o.jsx("rect",{x:h-y,y:f-y,width:v,height:v,fill:"white",stroke:"#9333ea",strokeWidth:1.5/e,rx:2/e,style:{cursor:"nwse-resize"}}),o.jsx("rect",{x:h+m-y,y:f-y,width:v,height:v,fill:"white",stroke:"#9333ea",strokeWidth:1.5/e,rx:2/e,style:{cursor:"nesw-resize"}}),o.jsx("rect",{x:h-y,y:f+g-y,width:v,height:v,fill:"white",stroke:"#9333ea",strokeWidth:1.5/e,rx:2/e,style:{cursor:"nesw-resize"}}),o.jsx("rect",{x:h+m-y,y:f+g-y,width:v,height:v,fill:"white",stroke:"#9333ea",strokeWidth:1.5/e,rx:2/e,style:{cursor:"nwse-resize"}}),o.jsx("rect",{x:h+m/2-y,y:f-y,width:v,height:v,fill:"white",stroke:"#9333ea",strokeWidth:1.5/e,rx:2/e,style:{cursor:"ns-resize"}}),o.jsx("rect",{x:h+m/2-y,y:f+g-y,width:v,height:v,fill:"white",stroke:"#9333ea",strokeWidth:1.5/e,rx:2/e,style:{cursor:"ns-resize"}}),o.jsx("rect",{x:h-y,y:f+g/2-y,width:v,height:v,fill:"white",stroke:"#9333ea",strokeWidth:1.5/e,rx:2/e,style:{cursor:"ew-resize"}}),o.jsx("rect",{x:h+m-y,y:f+g/2-y,width:v,height:v,fill:"white",stroke:"#9333ea",strokeWidth:1.5/e,rx:2/e,style:{cursor:"ew-resize"}}),o.jsx("line",{x1:h+m/2,y1:f,x2:h+m/2,y2:f-20/e,stroke:"#9333ea",strokeWidth:1.5/e}),o.jsx("circle",{cx:h+m/2,cy:f-24/e,r:v/2,fill:"white",stroke:"#9333ea",strokeWidth:1.5/e,style:{cursor:"grab"}}),o.jsx("text",{x:h+m/2,y:f-32/e,fontSize:10/e,fill:"#9333ea",fontFamily:"system-ui, -apple-system, sans-serif",fontWeight:"600",textAnchor:"middle",children:u.compoundType?`${u.compoundType.charAt(0).toUpperCase()+u.compoundType.slice(1)}`:u.customName||"Group"}),o.jsxs("g",{transform:`translate(${h+m-8/e}, ${f-8/e})`,children:[o.jsx("circle",{cx:0,cy:0,r:8/e,fill:"#9333ea"}),o.jsx("text",{x:0,y:0,fontSize:8/e,fill:"white",fontFamily:"system-ui, -apple-system, sans-serif",fontWeight:"600",textAnchor:"middle",dominantBaseline:"central",children:u.childIds.length})]})]})]})}function z0(t,e,n){if(!t||t.type==="rectangle"||!t.controlPoints)return null;const r=t.controlPoints;if(!r||r.length<3)return null;const s=r.map(a=>({x:a.x*e,y:a.y*n}));let i=`M ${s[0].x} ${s[0].y}`;for(let a=1;a<s.length;a++)i+=` L ${s[a].x} ${s[a].y}`;return i+=" Z",i}const w5=R.forwardRef(function(e,n){var Dm,Im;const r=R.useRef(null),s=R.useRef(null);R.useImperativeHandle(n,()=>r.current);const[i,a]=R.useState(1),[l,c]=R.useState({x:0,y:0}),[d,u]=R.useState(!1),[p,h]=R.useState({x:0,y:0}),[f,m]=R.useState(!1),[g,v]=R.useState({active:!1,initialDistance:0,initialZoom:1,initialPan:{x:0,y:0},initialCenter:{x:0,y:0}}),[y,x]=R.useState(!1),[b,w]=R.useState(null),[S,_]=R.useState(null),[k,E]=R.useState(null),[T,O]=R.useState(null),[q,P]=R.useState(null),[W,j]=R.useState(null),[G,pe]=R.useState(null),[Z,ee]=R.useState(null),[F,K]=R.useState(!1),[U,V]=R.useState(null),[J,oe]=R.useState(null),[me,je]=R.useState(!1),[he,Ee]=R.useState(null),[Me,We]=R.useState(null),[Ie,Je]=R.useState(!1),[Ue,C]=R.useState(null),[Q,ce]=R.useState(null),[L,N]=R.useState(!1),[I,H]=R.useState(null),[X,z]=R.useState(null),[te,ye]=R.useState(!1),[Y,M]=R.useState(null),[ie,fe]=R.useState(null),[Se,De]=R.useState(!1),[ke,ae]=R.useState(null),[ue,Ge]=R.useState(null),[Qe,et]=R.useState(!1),[ht,lt]=R.useState(null),[Le,de]=R.useState(null),[ne,ge]=R.useState(!1),[He,mt]=R.useState(null),[_e,vt]=R.useState(null),[dt,Et]=R.useState(null),[Xe,tn]=R.useState(0),[fn,nr]=R.useState(null),{surface:ft,courts:Lr,tracks:Dr,motifs:jn,shapes:kt,texts:Vt,exclusionZones:pt,elementOrder:yr,selectedCourtId:bt,selectedTrackId:Xr,selectedMotifId:xt,selectedShapeId:nn,selectedTextId:It,selectedExclusionZoneId:Yt,editingTextId:Tt,snapToGrid:Ct,gridSize_mm:rn,selectCourt:_t,deselectCourt:Hn,selectTrack:Zr,deselectTrack:rr,selectMotif:bs,deselectMotif:Kr,selectShape:Un,deselectShape:Ir,selectText:Jr,deselectText:Ui,selectExclusionZone:ei,deselectExclusionZone:ma,startEditingText:ti,stopEditingText:Qr,updateCourtPosition:xr,updateTrackPosition:Rn,updateMotifPosition:es,updateMotifScale:ni,updateMotifRotation:ri,updateShapePosition:zr,updateShapeDimensions:si,updateShapeRotation:ts,updateTextPosition:sr,updateTextFontSize:On,updateTextRotation:ir,updateTextContent:ii,updateExclusionZonePosition:vr,updateExclusionZoneDimensions:ws,updateExclusionZoneRotation:ns,updateBlobControlPoint:_s,updateBlobHandle:Wi,commitBlobEdit:rs,pathDrawingMode:An,activePathId:or,addPointToPath:At,finishPath:ar,cancelPath:Gi,updatePathControlPoint:Vi,updatePathHandle:oi,commitPathEdit:Yi,removePointFromPath:ss,groups:ga,selectedGroupId:Xt,selectedElementIds:cn,editingGroupId:ai,selectGroup:qi,deselectGroup:Ss,enterGroup:re,exitGroup:xe,addToSelection:we,clearMultiSelection:Ne,updateGroupPosition:ot,commitGroupMove:Ze}=it(),Ce=(A,se)=>{const D=r.current,le=D.createSVGPoint();le.x=A,le.y=se;const ze=le.matrixTransform(D.getScreenCTM().inverse());return{x:ze.x,y:ze.y}},be=(A,se)=>{A.stopPropagation(),_t(se);const D=Lr[se];if(D!=null&&D.locked)return;const le=A.touches?A.touches[0].clientX:A.clientX,ze=A.touches?A.touches[0].clientY:A.clientY,Ae=Ce(le,ze);w({x:Ae.x-D.position.x,y:Ae.y-D.position.y}),_(se),x(!0)},B=(A,se)=>{A.stopPropagation(),_t(se),it.setState({showPropertiesPanel:!0,propertiesPanelUserClosed:!1})},ve=(A,se)=>{A.stopPropagation(),Zr(se);const D=Dr[se];if(D!=null&&D.locked)return;const le=A.touches?A.touches[0].clientX:A.clientX,ze=A.touches?A.touches[0].clientY:A.clientY,Ae=Ce(le,ze);w({x:Ae.x-D.position.x,y:Ae.y-D.position.y}),E(se),x(!0)},Re=(A,se)=>{A.stopPropagation(),Zr(se),it.setState({showPropertiesPanel:!0,propertiesPanelUserClosed:!1})},rt=(A,se)=>{A.stopPropagation(),bs(se);const D=jn[se];if(D!=null&&D.locked)return;const le=A.touches?A.touches[0].clientX:A.clientX,ze=A.touches?A.touches[0].clientY:A.clientY,Ae=Ce(le,ze);w({x:Ae.x-D.position.x,y:Ae.y-D.position.y}),O(se),x(!0)},ct=(A,se)=>{A.stopPropagation(),bs(se),it.setState({showPropertiesPanel:!0,propertiesPanelUserClosed:!1})},tt=(A,se,D)=>{A.stopPropagation();const le=jn[se];if(!le||le.locked)return;const ze=A.touches?A.touches[0].clientX:A.clientX,Ae=A.touches?A.touches[0].clientY:A.clientY,qe=Ce(ze,Ae),Fe=le.originalWidth_mm*(le.scale||1),Te=le.originalHeight_mm*(le.scale||1);let $e;switch(D){case"nw":$e={x:le.position.x+Fe,y:le.position.y+Te};break;case"ne":$e={x:le.position.x,y:le.position.y+Te};break;case"sw":$e={x:le.position.x+Fe,y:le.position.y};break;case"se":default:$e={x:le.position.x,y:le.position.y};break}const ut=Math.sqrt(Math.pow(qe.x-$e.x,2)+Math.pow(qe.y-$e.y,2));oe({initialDistance:ut,originalScale:le.scale||1,originalWidth:Fe,originalHeight:Te,corner:D,anchorPoint:$e}),V(se),K(!0)},nt=(A,se)=>{A.stopPropagation();const D=jn[se];if(!D||D.locked)return;const le=A.touches?A.touches[0].clientX:A.clientX,ze=A.touches?A.touches[0].clientY:A.clientY,Ae=Ce(le,ze),qe=D.originalWidth_mm*(D.scale||1),Fe=D.originalHeight_mm*(D.scale||1),Te={x:D.position.x+qe/2,y:D.position.y+Fe/2},$e=Math.atan2(Ae.y-Te.y,Ae.x-Te.x)*(180/Math.PI);We({initialAngle:$e,originalRotation:D.rotation||0,motifCenter:Te}),Ee(se),je(!0)},Zt=(A,se)=>{if(A.stopPropagation(),A.shiftKey){we(se);return}cn.length>0&&Ne(),Un(se);const le=kt[se];if(le!=null&&le.locked)return;const ze=A.touches?A.touches[0].clientX:A.clientX,Ae=A.touches?A.touches[0].clientY:A.clientY,qe=Ce(ze,Ae);w({x:qe.x-le.position.x,y:qe.y-le.position.y}),P(se),x(!0)},Mn=(A,se)=>{A.stopPropagation(),Un(se),it.setState({showPropertiesPanel:!0,propertiesPanelUserClosed:!1})},li=(A,se,D)=>{A.stopPropagation();const le=kt[se];if(!le||le.locked)return;const ze=A.touches?A.touches[0].clientX:A.clientX,Ae=A.touches?A.touches[0].clientY:A.clientY,qe=Ce(ze,Ae),{width_mm:Fe,height_mm:Te}=le;let $e;switch(D){case"n":$e={x:le.position.x+Fe/2,y:le.position.y+Te};break;case"s":$e={x:le.position.x+Fe/2,y:le.position.y};break;case"e":$e={x:le.position.x,y:le.position.y+Te/2};break;case"w":$e={x:le.position.x+Fe,y:le.position.y+Te/2};break;case"nw":$e={x:le.position.x+Fe,y:le.position.y+Te};break;case"ne":$e={x:le.position.x,y:le.position.y+Te};break;case"sw":$e={x:le.position.x+Fe,y:le.position.y};break;case"se":default:$e={x:le.position.x,y:le.position.y};break}const ut=Math.sqrt(Math.pow(qe.x-$e.x,2)+Math.pow(qe.y-$e.y,2));ce({initialDistance:ut,originalWidth:Fe,originalHeight:Te,aspectLocked:le.aspectLocked,corner:D,anchorPoint:$e}),C(se),Je(!0)},Kt=(A,se)=>{A.stopPropagation();const D=kt[se];if(!D||D.locked)return;const le=A.touches?A.touches[0].clientX:A.clientX,ze=A.touches?A.touches[0].clientY:A.clientY,Ae=Ce(le,ze),{width_mm:qe,height_mm:Fe}=D,Te={x:D.position.x+qe/2,y:D.position.y+Fe/2},$e=Math.atan2(Ae.y-Te.y,Ae.x-Te.x)*(180/Math.PI);z({initialAngle:$e,originalRotation:D.rotation||0,shapeCenter:Te}),H(se),N(!0)},ya=(A,se)=>{if(A.stopPropagation(),Tt===se)return;Jr(se);const D=Vt[se];if(D!=null&&D.locked)return;const le=A.touches?A.touches[0].clientX:A.clientX,ze=A.touches?A.touches[0].clientY:A.clientY,Ae=Ce(le,ze);w({x:Ae.x-D.position.x,y:Ae.y-D.position.y}),j(se),x(!0)},Hl=(A,se)=>{A.stopPropagation(),Jr(se),ti(se)},q_=(A,se,D)=>{A.stopPropagation();const le=Vt[se];if(!le||le.locked)return;const ze=A.touches?A.touches[0].clientX:A.clientX,Ae=A.touches?A.touches[0].clientY:A.clientY,qe=Ce(ze,Ae),Fe=Os(le.content,le.fontFamily,le.fontSize_mm,le.fontWeight,le.fontStyle);let Te=le.position.x;le.textAlign==="center"?Te-=Fe.width/2:le.textAlign==="right"&&(Te-=Fe.width);const $e=le.position.y-le.fontSize_mm;let ut;switch(D){case"nw":ut={x:Te+Fe.width,y:$e+le.fontSize_mm*1.2};break;case"ne":ut={x:Te,y:$e+le.fontSize_mm*1.2};break;case"sw":ut={x:Te+Fe.width,y:$e};break;case"se":default:ut={x:Te,y:$e};break}const St=Math.sqrt(Math.pow(qe.x-ut.x,2)+Math.pow(qe.y-ut.y,2));fe({initialDistance:St,originalFontSize:le.fontSize_mm,originalPosition:{...le.position},originalBounds:Fe,textAlign:le.textAlign,corner:D,anchorPoint:ut}),M(se),ye(!0)},X_=(A,se)=>{A.stopPropagation();const D=Vt[se];if(!D||D.locked)return;const le=A.touches?A.touches[0].clientX:A.clientX,ze=A.touches?A.touches[0].clientY:A.clientY,Ae=Ce(le,ze),qe=Os(D.content,D.fontFamily,D.fontSize_mm,D.fontWeight,D.fontStyle);let Fe=D.position.x;D.textAlign==="center"?Fe=D.position.x:D.textAlign==="right"?Fe=D.position.x-qe.width/2:Fe=D.position.x+qe.width/2;const Te={x:Fe,y:D.position.y-D.fontSize_mm*.4},$e=Math.atan2(Ae.y-Te.y,Ae.x-Te.x)*(180/Math.PI);Ge({initialAngle:$e,originalRotation:D.rotation||0,textCenter:Te}),ae(se),De(!0)},Mm=(A,se)=>{A.stopPropagation(),ei(se);const D=pt[se];if(D!=null&&D.locked)return;const le=A.touches?A.touches[0].clientX:A.clientX,ze=A.touches?A.touches[0].clientY:A.clientY,Ae=Ce(le,ze);w({x:Ae.x-D.position.x,y:Ae.y-D.position.y}),pe(se),x(!0)},Z_=(A,se)=>{A.stopPropagation(),ei(se),it.setState({showPropertiesPanel:!0,propertiesPanelUserClosed:!1})},K_=(A,se,D)=>{A.stopPropagation();const le=pt[se];if(!le||le.locked)return;const ze=A.touches?A.touches[0].clientX:A.clientX,Ae=A.touches?A.touches[0].clientY:A.clientY,qe=Ce(ze,Ae),{width_mm:Fe,height_mm:Te}=le;let $e;switch(D){case"n":$e={x:le.position.x+Fe/2,y:le.position.y+Te};break;case"s":$e={x:le.position.x+Fe/2,y:le.position.y};break;case"e":$e={x:le.position.x,y:le.position.y+Te/2};break;case"w":$e={x:le.position.x+Fe,y:le.position.y+Te/2};break;default:$e={x:le.position.x,y:le.position.y};break}const ut=Math.sqrt(Math.pow(qe.x-$e.x,2)+Math.pow(qe.y-$e.y,2));de({initialDistance:ut,originalWidth:Fe,originalHeight:Te,corner:D,anchorPoint:$e}),lt(se),et(!0)},J_=(A,se)=>{A.stopPropagation();const D=pt[se];if(!D||D.locked)return;const le=A.touches?A.touches[0].clientX:A.clientX,ze=A.touches?A.touches[0].clientY:A.clientY,Ae=Ce(le,ze),{width_mm:qe,height_mm:Fe}=D,Te={x:D.position.x+qe/2,y:D.position.y+Fe/2},$e=Math.atan2(Ae.y-Te.y,Ae.x-Te.x)*(180/Math.PI);vt({initialAngle:$e,originalRotation:D.rotation||0,zoneCenter:Te}),mt(se),ge(!0)};R.useEffect(()=>{x(!1),_(null),E(null),O(null),P(null),j(null),pe(null),w(null)},[ft.width_mm,ft.length_mm]),R.useEffect(()=>{if(!y||!S&&!k&&!T&&!q&&!W&&!G)return;const A=D=>{const le=D.touches?D.touches[0].clientX:D.clientX,ze=D.touches?D.touches[0].clientY:D.clientY,Ae=Ce(le,ze);let qe={x:Ae.x-b.x,y:Ae.y-b.y};if(Ct&&(qe=HE(qe,rn)),S){const Fe=Lr[S],Te={width_mm:Fe.template.dimensions.width_mm*Fe.scale,length_mm:Fe.template.dimensions.length_mm*Fe.scale};qe=yc(qe,Te,ft),xr(S,qe)}else if(k)Rn(k,qe);else if(T){const Fe=jn[T],Te={width_mm:Fe.originalWidth_mm*(Fe.scale||1),length_mm:Fe.originalHeight_mm*(Fe.scale||1)};qe=yc(qe,Te,ft),es(T,qe)}else if(q){const Fe=kt[q],Te={width_mm:Fe.width_mm,length_mm:Fe.height_mm};qe=yc(qe,Te,ft),zr(q,qe)}else if(W)sr(W,qe);else if(G){const Fe=pt[G],Te={width_mm:Fe.width_mm,length_mm:Fe.height_mm};qe=yc(qe,Te,ft),vr(G,qe)}},se=()=>{if(S||k||T||q||W||G){const{addToHistory:D}=it.getState();D()}x(!1),_(null),E(null),O(null),P(null),j(null),pe(null),w(null)};return window.addEventListener("mousemove",A),window.addEventListener("mouseup",se),window.addEventListener("touchmove",A,{passive:!1}),window.addEventListener("touchend",se),window.addEventListener("touchcancel",se),()=>{window.removeEventListener("mousemove",A),window.removeEventListener("mouseup",se),window.removeEventListener("touchmove",A),window.removeEventListener("touchend",se),window.removeEventListener("touchcancel",se)}},[y,S,k,T,q,W,G,b,Lr,Dr,jn,kt,Vt,pt,Ct,rn,ft,xr,Rn,es,zr,sr,vr]),R.useEffect(()=>{if(!F||!U||!J)return;const A=D=>{const le=D.touches?D.touches[0].clientX:D.clientX,ze=D.touches?D.touches[0].clientY:D.clientY,Ae=Ce(le,ze),qe=jn[U];if(!qe)return;const Te=Math.sqrt(Math.pow(Ae.x-J.anchorPoint.x,2)+Math.pow(Ae.y-J.anchorPoint.y,2))/J.initialDistance;let $e=J.originalScale*Te;$e=Math.max(.1,$e),$e=Math.round($e*100)/100;const ut=qe.originalWidth_mm*$e,St=qe.originalHeight_mm*$e;let dn;switch(J.corner){case"nw":dn={x:J.anchorPoint.x-ut,y:J.anchorPoint.y-St};break;case"ne":dn={x:J.anchorPoint.x,y:J.anchorPoint.y-St};break;case"sw":dn={x:J.anchorPoint.x-ut,y:J.anchorPoint.y};break;case"se":default:dn={x:J.anchorPoint.x,y:J.anchorPoint.y};break}ni(U,$e),es(U,dn)},se=()=>{const{addToHistory:D}=it.getState();D(),K(!1),V(null),oe(null)};return window.addEventListener("mousemove",A),window.addEventListener("mouseup",se),window.addEventListener("touchmove",A,{passive:!1}),window.addEventListener("touchend",se),window.addEventListener("touchcancel",se),()=>{window.removeEventListener("mousemove",A),window.removeEventListener("mouseup",se),window.removeEventListener("touchmove",A),window.removeEventListener("touchend",se),window.removeEventListener("touchcancel",se)}},[F,U,J,jn,ni,es]),R.useEffect(()=>{if(!me||!he||!Me)return;const A=D=>{const le=D.touches?D.touches[0].clientX:D.clientX,ze=D.touches?D.touches[0].clientY:D.clientY,Ae=Ce(le,ze),Fe=Math.atan2(Ae.y-Me.motifCenter.y,Ae.x-Me.motifCenter.x)*(180/Math.PI)-Me.initialAngle;let Te=Me.originalRotation+Fe;Te=(Te%360+360)%360,D.shiftKey&&(Te=Math.round(Te/15)*15),Te=Math.round(Te*10)/10,ri(he,Te)},se=()=>{const{addToHistory:D}=it.getState();D(),je(!1),Ee(null),We(null)};return window.addEventListener("mousemove",A),window.addEventListener("mouseup",se),window.addEventListener("touchmove",A,{passive:!1}),window.addEventListener("touchend",se),window.addEventListener("touchcancel",se),()=>{window.removeEventListener("mousemove",A),window.removeEventListener("mouseup",se),window.removeEventListener("touchmove",A),window.removeEventListener("touchend",se),window.removeEventListener("touchcancel",se)}},[me,he,Me,ri]),R.useEffect(()=>{if(!Ie||!Ue||!Q)return;const A=D=>{const le=D.touches?D.touches[0].clientX:D.clientX,ze=D.touches?D.touches[0].clientY:D.clientY,Ae=Ce(le,ze);if(!kt[Ue])return;const Te=Math.sqrt(Math.pow(Ae.x-Q.anchorPoint.x,2)+Math.pow(Ae.y-Q.anchorPoint.y,2))/Q.initialDistance;let $e,ut;const St=Q.corner,dn=["n","s","e","w"].includes(St);if(Q.aspectLocked)$e=Q.originalWidth*Te,ut=Q.originalHeight*Te;else if(dn){const lr=Math.abs(Ae.y-Q.anchorPoint.y),xa=Math.abs(Ae.x-Q.anchorPoint.x);St==="n"||St==="s"?($e=Q.originalWidth,ut=Math.max(100,lr)):($e=Math.max(100,xa),ut=Q.originalHeight)}else{const lr=Math.abs(Ae.x-Q.anchorPoint.x),xa=Math.abs(Ae.y-Q.anchorPoint.y);$e=Math.max(100,lr),ut=Math.max(100,xa)}$e=Math.round($e),ut=Math.round(ut);let Nt;switch(St){case"n":Nt={x:Q.anchorPoint.x-$e/2,y:Q.anchorPoint.y-ut};break;case"s":Nt={x:Q.anchorPoint.x-$e/2,y:Q.anchorPoint.y};break;case"e":Nt={x:Q.anchorPoint.x,y:Q.anchorPoint.y-ut/2};break;case"w":Nt={x:Q.anchorPoint.x-$e,y:Q.anchorPoint.y-ut/2};break;case"nw":Nt={x:Q.anchorPoint.x-$e,y:Q.anchorPoint.y-ut};break;case"ne":Nt={x:Q.anchorPoint.x,y:Q.anchorPoint.y-ut};break;case"sw":Nt={x:Q.anchorPoint.x-$e,y:Q.anchorPoint.y};break;case"se":default:Nt={x:Q.anchorPoint.x,y:Q.anchorPoint.y};break}si(Ue,$e,ut),zr(Ue,Nt)},se=()=>{const{addToHistory:D}=it.getState();D(),Je(!1),C(null),ce(null)};return window.addEventListener("mousemove",A),window.addEventListener("mouseup",se),window.addEventListener("touchmove",A,{passive:!1}),window.addEventListener("touchend",se),window.addEventListener("touchcancel",se),()=>{window.removeEventListener("mousemove",A),window.removeEventListener("mouseup",se),window.removeEventListener("touchmove",A),window.removeEventListener("touchend",se),window.removeEventListener("touchcancel",se)}},[Ie,Ue,Q,kt,si,zr]),R.useEffect(()=>{if(!L||!I||!X)return;const A=D=>{const le=D.touches?D.touches[0].clientX:D.clientX,ze=D.touches?D.touches[0].clientY:D.clientY,Ae=Ce(le,ze),Fe=Math.atan2(Ae.y-X.shapeCenter.y,Ae.x-X.shapeCenter.x)*(180/Math.PI)-X.initialAngle;let Te=X.originalRotation+Fe;Te=(Te%360+360)%360,D.shiftKey&&(Te=Math.round(Te/15)*15),Te=Math.round(Te*10)/10,ts(I,Te)},se=()=>{const{addToHistory:D}=it.getState();D(),N(!1),H(null),z(null)};return window.addEventListener("mousemove",A),window.addEventListener("mouseup",se),window.addEventListener("touchmove",A,{passive:!1}),window.addEventListener("touchend",se),window.addEventListener("touchcancel",se),()=>{window.removeEventListener("mousemove",A),window.removeEventListener("mouseup",se),window.removeEventListener("touchmove",A),window.removeEventListener("touchend",se),window.removeEventListener("touchcancel",se)}},[L,I,X,ts]),R.useEffect(()=>{if(!te||!Y||!ie)return;const A=D=>{const le=D.touches?D.touches[0].clientX:D.clientX,ze=D.touches?D.touches[0].clientY:D.clientY,Ae=Ce(le,ze);if(!Vt[Y])return;const Te=Math.sqrt(Math.pow(Ae.x-ie.anchorPoint.x,2)+Math.pow(Ae.y-ie.anchorPoint.y,2))/ie.initialDistance;let $e=ie.originalFontSize*Te;$e=Math.max(50,$e),$e=Math.round($e);const ut=$e/ie.originalFontSize,St=ie.originalBounds.width*ut,{corner:dn,anchorPoint:Nt,textAlign:lr,originalPosition:xa,originalBounds:WW,originalFontSize:GW}=ie;let mn={...xa};switch(dn){case"nw":lr==="left"?mn.x=Nt.x-St:lr==="center"?mn.x=Nt.x-St/2:mn.x=Nt.x,mn.y=Nt.y-$e*.2;break;case"ne":lr==="left"?mn.x=Nt.x:lr==="center"?mn.x=Nt.x+St/2:mn.x=Nt.x+St,mn.y=Nt.y-$e*.2;break;case"sw":lr==="left"?mn.x=Nt.x-St:lr==="center"?mn.x=Nt.x-St/2:mn.x=Nt.x,mn.y=Nt.y+$e;break;case"se":default:lr==="left"?mn.x=Nt.x:lr==="center"?mn.x=Nt.x+St/2:mn.x=Nt.x+St,mn.y=Nt.y+$e;break}On(Y,$e),sr(Y,mn)},se=()=>{const{addToHistory:D}=it.getState();D(),ye(!1),M(null),fe(null)};return window.addEventListener("mousemove",A),window.addEventListener("mouseup",se),window.addEventListener("touchmove",A,{passive:!1}),window.addEventListener("touchend",se),window.addEventListener("touchcancel",se),()=>{window.removeEventListener("mousemove",A),window.removeEventListener("mouseup",se),window.removeEventListener("touchmove",A),window.removeEventListener("touchend",se),window.removeEventListener("touchcancel",se)}},[te,Y,ie,Vt,On,sr]),R.useEffect(()=>{if(!Se||!ke||!ue)return;const A=D=>{const le=D.touches?D.touches[0].clientX:D.clientX,ze=D.touches?D.touches[0].clientY:D.clientY,Ae=Ce(le,ze),Fe=Math.atan2(Ae.y-ue.textCenter.y,Ae.x-ue.textCenter.x)*(180/Math.PI)-ue.initialAngle;let Te=ue.originalRotation+Fe;Te=(Te%360+360)%360,D.shiftKey&&(Te=Math.round(Te/15)*15),Te=Math.round(Te*10)/10,ir(ke,Te)},se=()=>{const{addToHistory:D}=it.getState();D(),De(!1),ae(null),Ge(null)};return window.addEventListener("mousemove",A),window.addEventListener("mouseup",se),window.addEventListener("touchmove",A,{passive:!1}),window.addEventListener("touchend",se),window.addEventListener("touchcancel",se),()=>{window.removeEventListener("mousemove",A),window.removeEventListener("mouseup",se),window.removeEventListener("touchmove",A),window.removeEventListener("touchend",se),window.removeEventListener("touchcancel",se)}},[Se,ke,ue,ir]),R.useEffect(()=>{if(!Qe||!ht||!Le)return;const A=D=>{const le=D.touches?D.touches[0].clientX:D.clientX,ze=D.touches?D.touches[0].clientY:D.clientY,Ae=Ce(le,ze);if(!pt[ht])return;const Fe=Le.corner,Te=Math.abs(Ae.y-Le.anchorPoint.y),$e=Math.abs(Ae.x-Le.anchorPoint.x);let ut,St;Fe==="n"||Fe==="s"?(ut=Le.originalWidth,St=Math.max(500,Te)):Fe==="e"||Fe==="w"?(ut=Math.max(500,$e),St=Le.originalHeight):(ut=Math.max(500,$e),St=Math.max(500,Te)),ut=Math.round(ut),St=Math.round(St);let dn;switch(Fe){case"n":dn={x:Le.anchorPoint.x-ut/2,y:Le.anchorPoint.y-St};break;case"s":dn={x:Le.anchorPoint.x-ut/2,y:Le.anchorPoint.y};break;case"e":dn={x:Le.anchorPoint.x,y:Le.anchorPoint.y-St/2};break;case"w":dn={x:Le.anchorPoint.x-ut,y:Le.anchorPoint.y-St/2};break;default:dn={x:Le.anchorPoint.x,y:Le.anchorPoint.y};break}ws(ht,ut,St),vr(ht,dn)},se=()=>{const{addToHistory:D}=it.getState();D(),et(!1),lt(null),de(null)};return window.addEventListener("mousemove",A),window.addEventListener("mouseup",se),window.addEventListener("touchmove",A,{passive:!1}),window.addEventListener("touchend",se),window.addEventListener("touchcancel",se),()=>{window.removeEventListener("mousemove",A),window.removeEventListener("mouseup",se),window.removeEventListener("touchmove",A),window.removeEventListener("touchend",se),window.removeEventListener("touchcancel",se)}},[Qe,ht,Le,pt,ws,vr]),R.useEffect(()=>{if(!ne||!He||!_e)return;const A=D=>{const le=D.touches?D.touches[0].clientX:D.clientX,ze=D.touches?D.touches[0].clientY:D.clientY,Ae=Ce(le,ze),Fe=Math.atan2(Ae.y-_e.zoneCenter.y,Ae.x-_e.zoneCenter.x)*(180/Math.PI)-_e.initialAngle;let Te=_e.originalRotation+Fe;Te=(Te%360+360)%360,D.shiftKey&&(Te=Math.round(Te/15)*15),Te=Math.round(Te*10)/10,ns(He,Te)},se=()=>{const{addToHistory:D}=it.getState();D(),ge(!1),mt(null),vt(null)};return window.addEventListener("mousemove",A),window.addEventListener("mouseup",se),window.addEventListener("touchmove",A,{passive:!1}),window.addEventListener("touchend",se),window.addEventListener("touchcancel",se),()=>{window.removeEventListener("mousemove",A),window.removeEventListener("mouseup",se),window.removeEventListener("touchmove",A),window.removeEventListener("touchend",se),window.removeEventListener("touchcancel",se)}},[ne,He,_e,ns]);const Q_=A=>{var D;if(An&&or&&(A.target===A.currentTarget||A.target.tagName==="svg"||A.target.closest("svg"))){A.preventDefault(),A.stopPropagation();const le=Date.now(),ze=le-Xe;if(tn(le),ze<300&&ze>0){ar();return}const Ae=A.clientX,qe=A.clientY,Fe=Ce(Ae,qe),Te=kt[or];if(Te){const $e=(Fe.x-Te.position.x)/Te.width_mm,ut=(Fe.y-Te.position.y)/Te.height_mm,St=Math.max(-.5,Math.min(1.5,$e)),dn=Math.max(-.5,Math.min(1.5,ut));At(St,dn)}return}(A.target===A.currentTarget||A.target.tagName==="svg"||((D=A.target.classList)==null?void 0:D.contains("court-canvas__surface"))||A.target.closest(".court-canvas__scroll-container")===A.target)&&(Hn(),rr(),Kr(),Ir(),Ui(),ma(),Ss(),Ne(),nr(null))},e2=()=>{a(A=>Math.min(A*1.25,5))},t2=()=>{a(A=>Math.max(A/1.25,.25))},n2=()=>{a(1),c({x:0,y:0})},r2=A=>{if(A.ctrlKey||A.metaKey){A.preventDefault();const se=A.deltaY*-.002;a(D=>Math.min(Math.max(D+D*se,.25),5))}else{A.preventDefault();const se=1;c(D=>({x:D.x-A.deltaX*se,y:D.y-A.deltaY*se}))}},s2=A=>{(A.button===1||A.button===0&&f)&&(A.preventDefault(),A.stopPropagation(),u(!0),h({x:A.clientX-l.x,y:A.clientY-l.y}))},i2=A=>{d&&c({x:A.clientX-p.x,y:A.clientY-p.y})},o2=()=>{u(!1)},$m=A=>{const se=A[0].clientX-A[1].clientX,D=A[0].clientY-A[1].clientY;return Math.sqrt(se*se+D*D)},Lm=A=>({x:(A[0].clientX+A[1].clientX)/2,y:(A[0].clientY+A[1].clientY)/2}),a2=A=>{if(A.touches.length===2){A.preventDefault();const se=$m(A.touches),D=Lm(A.touches);v({active:!0,initialDistance:se,initialZoom:i,initialPan:{...l},initialCenter:D})}},l2=A=>{if(A.touches.length===2&&g.active){A.preventDefault();const D=$m(A.touches)/g.initialDistance;let le=g.initialZoom*D;le=Math.min(Math.max(le,.25),5);const ze=Lm(A.touches),Ae=ze.x-g.initialCenter.x,qe=ze.y-g.initialCenter.y;a(le),c({x:g.initialPan.x+Ae,y:g.initialPan.y+qe})}},c2=A=>{A.touches.length<2&&v({active:!1,initialDistance:0,initialZoom:1,initialPan:{x:0,y:0},initialCenter:{x:0,y:0}})};R.useEffect(()=>{if(d){const A=D=>i2(D),se=()=>o2();return window.addEventListener("mousemove",A),window.addEventListener("mouseup",se),()=>{window.removeEventListener("mousemove",A),window.removeEventListener("mouseup",se)}}},[d,p]),R.useEffect(()=>{const A=D=>{if(D.code==="Space"&&!D.repeat){if(D.target.tagName==="INPUT"||D.target.tagName==="TEXTAREA")return;D.preventDefault(),m(!0)}if(D.code==="Escape"&&An&&or&&(D.preventDefault(),Gi()),D.code==="Enter"&&An&&or&&(D.preventDefault(),ar()),D.code==="Escape"&&ai&&(D.preventDefault(),xe()),(D.code==="Delete"||D.code==="Backspace")&&nn&&fn!==null){if(D.target.tagName==="INPUT"||D.target.tagName==="TEXTAREA")return;const le=kt[nn];le&&(le.shapeType==="path"||le.shapeType==="blob")&&le.editPointsVisible&&(D.preventDefault(),ss(nn,fn),nr(null))}if((D.metaKey||D.ctrlKey)&&D.key.toLowerCase()==="g"&&!D.shiftKey){if(D.target.tagName==="INPUT"||D.target.tagName==="TEXTAREA")return;cn.length>=2&&(D.preventDefault(),it.getState().groupSelected())}if((D.metaKey||D.ctrlKey)&&D.shiftKey&&D.key.toLowerCase()==="g"){if(D.target.tagName==="INPUT"||D.target.tagName==="TEXTAREA")return;Xt&&(D.preventDefault(),it.getState().ungroup(Xt))}},se=D=>{D.code==="Space"&&(m(!1),u(!1))};return window.addEventListener("keydown",A),window.addEventListener("keyup",se),()=>{window.removeEventListener("keydown",A),window.removeEventListener("keyup",se)}},[An,or,Gi,ar,nn,fn,kt,ss,cn,Xt,ai,xe]);const d2=A=>{if(An&&or){const se=Ce(A.clientX,A.clientY);Et(se)}},vn=An&&or?kt[or]:null,cu=((Dm=vn==null?void 0:vn.controlPoints)==null?void 0:Dm.length)>0?vn.controlPoints[vn.controlPoints.length-1]:null;return o.jsxs("div",{className:`court-canvas ${An?"court-canvas--drawing":""}`,onClick:Q_,onMouseMove:d2,children:[An&&o.jsx("div",{className:"court-canvas__drawing-indicator",children:"Click to add points  Double-click or Enter to finish  Escape to cancel"}),o.jsxs("div",{className:"court-canvas__zoom-controls",children:[o.jsx("button",{onClick:e2,className:"court-canvas__zoom-btn",title:"Zoom In (Ctrl + Scroll)",children:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"11",cy:"11",r:"8"}),o.jsx("line",{x1:"11",y1:"8",x2:"11",y2:"14"}),o.jsx("line",{x1:"8",y1:"11",x2:"14",y2:"11"}),o.jsx("path",{d:"m21 21-4.35-4.35"})]})}),o.jsx("button",{onClick:t2,className:"court-canvas__zoom-btn",title:"Zoom Out (Ctrl + Scroll)",children:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"11",cy:"11",r:"8"}),o.jsx("line",{x1:"8",y1:"11",x2:"14",y2:"11"}),o.jsx("path",{d:"m21 21-4.35-4.35"})]})}),o.jsx("button",{onClick:n2,className:"court-canvas__zoom-btn",title:"Reset View",children:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M1 4v6h6"}),o.jsx("path",{d:"M23 20v-6h-6"}),o.jsx("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})]})}),o.jsxs("span",{className:"court-canvas__zoom-level",title:"Scroll to pan, Ctrl+Scroll to zoom, Space+Drag to pan",children:[Math.round(i*100),"%"]})]}),o.jsx("div",{ref:s,className:"court-canvas__viewport",onWheel:r2,onMouseDown:s2,onTouchStart:a2,onTouchMove:l2,onTouchEnd:c2,style:{cursor:d?"grabbing":f?"grab":void 0,touchAction:"none"},children:o.jsx("div",{className:"court-canvas__transform-wrapper",style:{transform:`translate(${l.x}px, ${l.y}px) scale(${i})`,transformOrigin:"center center"},children:o.jsxs("svg",{ref:r,className:"court-canvas__svg",viewBox:`0 0 ${ft.width_mm} ${ft.length_mm}`,preserveAspectRatio:"xMidYMid meet",children:[o.jsx("defs",{children:ft.boundary&&ft.boundary.type!=="rectangle"&&ft.boundary.controlPoints&&o.jsx("clipPath",{id:"surface-boundary-clip",children:o.jsx("path",{d:z0(ft.boundary,ft.width_mm,ft.length_mm)})})}),o.jsx("g",{clipPath:ft.boundary&&ft.boundary.type!=="rectangle"&&ft.boundary.controlPoints?"url(#surface-boundary-clip)":void 0,children:o.jsx("rect",{x:"0",y:"0",width:ft.width_mm,height:ft.length_mm,fill:ft.color.hex,className:"court-canvas__surface"})}),ft.boundary&&ft.boundary.type!=="rectangle"&&ft.boundary.controlPoints&&o.jsx("path",{d:z0(ft.boundary,ft.width_mm,ft.length_mm),fill:"none",stroke:"#94a3b8",strokeWidth:"60",strokeDasharray:"300 200",pointerEvents:"none"}),Object.values(pt).map(A=>A.visible===!1?null:o.jsx(x5,{zone:A,isSelected:A.id===Yt,onMouseDown:se=>Mm(se,A.id),onTouchStart:se=>Mm(se,A.id),onDoubleClick:se=>Z_(se,A.id),onScaleStart:(se,D)=>K_(se,A.id,D),onRotateStart:se=>J_(se,A.id)},A.id)),yr.map(A=>{if(A.startsWith("court-")){const se=Lr[A];return!se||se.visible===!1?null:o.jsx(_5,{court:se,isSelected:A===bt,onMouseDown:D=>be(D,A),onTouchStart:D=>be(D,A),onDoubleClick:D=>B(D,A),svgRef:r},A)}if(A.startsWith("track-")){const se=Dr[A];return!se||se.visible===!1?null:o.jsx(QE,{track:se,isSelected:A===Xr,onMouseDown:D=>ve(D,A),onTouchStart:D=>ve(D,A),onDoubleClick:D=>Re(D,A),svgRef:r},A)}if(A.startsWith("motif-")){const se=jn[A];return!se||se.visible===!1?null:o.jsx(t5,{motif:se,isSelected:A===xt,onMouseDown:D=>rt(D,A),onTouchStart:D=>rt(D,A),onDoubleClick:D=>ct(D,A),onScaleStart:(D,le)=>tt(D,A,le),onRotateStart:D=>nt(D,A)},A)}if(A.startsWith("shape-")){const se=kt[A];if(!se||se.visible===!1)return null;const D=A===nn||cn.includes(A);return se.shapeType==="blob"?o.jsx(u5,{shape:se,isSelected:D,onMouseDown:le=>Zt(le,A),onTouchStart:le=>Zt(le,A),onDoubleClick:le=>Mn(le,A),onScaleStart:(le,ze)=>li(le,A,ze),onRotateStart:le=>Kt(le,A),onPointDrag:(le,ze,Ae)=>_s(A,le,ze,Ae),onHandleDrag:(le,ze,Ae,qe)=>Wi(A,le,ze,Ae,qe),onDragEnd:()=>rs(),selectedPointIndex:A===nn?fn:null,onPointSelect:le=>nr(le),onPointDelete:le=>ss(A,le)},A):se.shapeType==="path"?o.jsx(p5,{shape:se,isSelected:D,onMouseDown:le=>Zt(le,A),onTouchStart:le=>Zt(le,A),onDoubleClick:le=>Mn(le,A),onScaleStart:(le,ze)=>li(le,A,ze),onRotateStart:le=>Kt(le,A),onPointDrag:(le,ze,Ae)=>Vi(A,le,ze,Ae),onHandleDrag:(le,ze,Ae,qe)=>oi(A,le,ze,Ae,qe),onDragEnd:()=>Yi(),selectedPointIndex:A===nn?fn:null,onPointSelect:le=>nr(le),onPointDelete:le=>ss(A,le)},A):o.jsx(c5,{shape:se,isSelected:D,onMouseDown:le=>Zt(le,A),onTouchStart:le=>Zt(le,A),onDoubleClick:le=>Mn(le,A),onScaleStart:(le,ze)=>li(le,A,ze),onRotateStart:le=>Kt(le,A)},A)}if(A.startsWith("text-")){const se=Vt[A];return!se||se.visible===!1?null:o.jsx(g5,{text:se,isSelected:A===It,isEditing:A===Tt,onMouseDown:D=>ya(D,A),onTouchStart:D=>ya(D,A),onDoubleClick:D=>Hl(D,A),onScaleStart:(D,le)=>q_(D,A,le),onRotateStart:D=>X_(D,A),onContentChange:D=>ii(A,D),onEditComplete:()=>Qr()},A)}return null}),Object.keys(ga).map(A=>o.jsx(b5,{groupId:A,scale:i},A)),An&&vn&&cu&&dt&&o.jsx("line",{x1:vn.position.x+cu.x*vn.width_mm,y1:vn.position.y+cu.y*vn.height_mm,x2:dt.x,y2:dt.y,stroke:"#3b82f6",strokeWidth:"50",strokeDasharray:"100 100",opacity:"0.6",pointerEvents:"none"}),An&&vn&&((Im=vn.controlPoints)==null?void 0:Im.map((A,se)=>o.jsx("circle",{cx:vn.position.x+A.x*vn.width_mm,cy:vn.position.y+A.y*vn.height_mm,r:"80",fill:"#3b82f6",stroke:"#fff",strokeWidth:"20",pointerEvents:"none"},`preview-point-${se}`)))]})})}),o.jsxs("div",{className:"court-canvas__info",children:[o.jsxs("span",{children:[(ft.width_mm/1e3).toFixed(1),"m  ",(ft.length_mm/1e3).toFixed(1),"m"]}),Ct&&o.jsxs("span",{className:"court-canvas__grid-indicator",children:["Grid: ",rn,"mm"]})]}),yr.length===0&&o.jsxs("div",{className:"court-canvas__empty-state",children:[o.jsx("div",{className:"court-canvas__empty-icon",children:o.jsxs("svg",{width:"72",height:"72",viewBox:"0 0 24 24",fill:"none",children:[o.jsx("path",{d:"M12 2L14.4 8.4L21 9.6L16.2 14.4L17.6 21L12 17.6L6.4 21L7.8 14.4L3 9.6L9.6 8.4L12 2Z",fill:"rgba(255,255,255,0.15)",stroke:"currentColor",strokeWidth:"1.5",strokeLinejoin:"round"}),o.jsx("circle",{cx:"19",cy:"5",r:"1.5",fill:"currentColor",opacity:"0.6"}),o.jsx("circle",{cx:"5",cy:"18",r:"1",fill:"currentColor",opacity:"0.4"}),o.jsx("circle",{cx:"20",cy:"16",r:"0.8",fill:"currentColor",opacity:"0.5"})]})}),o.jsx("h3",{className:"court-canvas__empty-title",children:"Your canvas is ready"}),o.jsx("p",{className:"court-canvas__empty-text",children:"Design your perfect TPV surface in minutes"}),o.jsxs("div",{className:"court-canvas__empty-hints",children:[o.jsxs("div",{className:"court-canvas__hint",children:[o.jsx("span",{className:"court-canvas__hint-icon",children:o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),o.jsx("line",{x1:"9",y1:"3",x2:"9",y2:"21"})]})}),o.jsxs("span",{children:["Add ",o.jsx("strong",{children:"Courts"}),", ",o.jsx("strong",{children:"Tracks"}),", ",o.jsx("strong",{children:"Shapes"})," or ",o.jsx("strong",{children:"Designs"})]})]}),o.jsxs("div",{className:"court-canvas__hint",children:[o.jsx("span",{className:"court-canvas__hint-icon",children:o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M12 5v14M5 12h14"})})}),o.jsx("span",{children:"Click elements in the library to place them"})]}),o.jsxs("div",{className:"court-canvas__hint",children:[o.jsx("span",{className:"court-canvas__hint-icon",children:o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M5 9l4 4-4 4"}),o.jsx("path",{d:"M12 4h7a2 2 0 012 2v12a2 2 0 01-2 2h-7"})]})}),o.jsx("span",{children:"Arrange, customise colours and export"})]})]})]})]})});function _5({court:t,isSelected:e,onMouseDown:n,onTouchStart:r,onDoubleClick:s,svgRef:i}){var d;const{markings:a,zones:l}=BE(t),c=((d=t.courtSurfaceColor)==null?void 0:d.hex)||null;return o.jsxs("g",{className:`court-canvas__court ${e?"court-canvas__court--selected":""}`,transform:UE(t),style:{cursor:"move"},children:[c&&o.jsx("rect",{x:"0",y:"0",width:t.template.dimensions.width_mm,height:t.template.dimensions.length_mm,fill:c,className:"court-canvas__court-surface"}),o.jsx("rect",{x:"0",y:"0",width:t.template.dimensions.width_mm,height:t.template.dimensions.length_mm,fill:"none",pointerEvents:"all",onMouseDown:n,onTouchStart:r,onDoubleClick:s,style:{cursor:"move"}}),l.map(u=>o.jsx(S5,{zone:u},u.id)),a.map(u=>o.jsx(k5,{marking:u},u.id)),e&&o.jsxs(o.Fragment,{children:[o.jsx("rect",{x:"0",y:"0",width:t.template.dimensions.width_mm,height:t.template.dimensions.length_mm,fill:"none",stroke:"#007bff",strokeWidth:"100",strokeDasharray:"400 400",className:"court-canvas__selection-outline"}),o.jsx(WE,{court:t,svgRef:i})]})]})}function S5({zone:t}){switch(t.type){case"rect":return o.jsx("rect",{x:t.x,y:t.y,width:t.width,height:t.height,fill:t.fill});case"circle":return o.jsx("circle",{cx:t.cx,cy:t.cy,r:t.r,fill:t.fill});case"polygon":return o.jsx("polygon",{points:t.points,fill:t.fill});default:return null}}function k5({marking:t}){switch(t.type){case"line":return o.jsx("line",{x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,stroke:t.stroke,strokeWidth:t.strokeWidth});case"rect":return o.jsx("rect",{x:t.x,y:t.y,width:t.width,height:t.height,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill});case"circle":return o.jsx("circle",{cx:t.cx,cy:t.cy,r:t.r,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill});case"path":return o.jsx("path",{d:t.d,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill});case"polyline":return o.jsx("polyline",{points:t.points,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill});default:return null}}const y1={"track-flexible":{id:"track-flexible",name:"Running Track",type:"running-track",trackType:"curved",standard:"Flexible Design",category:"track",description:"Flexible running track - adjust size, lanes, and corner radius to fit your surface",parameters:{numLanes:4,laneWidth_mm:1220,width_mm:25e3,height_mm:15e3,cornerRadius:{topLeft:3e3,topRight:3e3,bottomLeft:3e3,bottomRight:3e3},lineWidth_mm:50,startingBoxes:{enabled:!1,depth_mm:400,lineWidth_mm:50}},defaultLineColor:"RH31",defaultTrackSurfaceColor:"RH01",calculatedDimensions:{totalWidth_mm:25e3,totalLength_mm:15e3}},"track-straight":{id:"track-straight",name:"Straight Track",type:"running-track",trackType:"straight",standard:"Sprint Track",category:"track",description:"Straight sprint track - perfect for 60m, 100m, or custom length sprints",parameters:{numLanes:6,laneWidth_mm:1220,width_mm:7320,height_mm:1e5,cornerRadius:{topLeft:0,topRight:0,bottomLeft:0,bottomRight:0},lineWidth_mm:50,startingBoxes:{enabled:!1,depth_mm:400,lineWidth_mm:50}},defaultLineColor:"RH31",defaultTrackSurfaceColor:"RH01",calculatedDimensions:{totalWidth_mm:7320,totalLength_mm:1e5}}};function j5(){return Object.values(y1)}function C5(t){return y1[t]||null}/*! @license DOMPurify 3.3.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.0/LICENSE */var Xu,F0;function B0(){if(F0)return Xu;F0=1;const{entries:t,setPrototypeOf:e,isFrozen:n,getPrototypeOf:r,getOwnPropertyDescriptor:s}=Object;let{freeze:i,seal:a,create:l}=Object,{apply:c,construct:d}=typeof Reflect<"u"&&Reflect;i||(i=function(te){return te}),a||(a=function(te){return te}),c||(c=function(te,ye){for(var Y=arguments.length,M=new Array(Y>2?Y-2:0),ie=2;ie<Y;ie++)M[ie-2]=arguments[ie];return te.apply(ye,M)}),d||(d=function(te){for(var ye=arguments.length,Y=new Array(ye>1?ye-1:0),M=1;M<ye;M++)Y[M-1]=arguments[M];return new te(...Y)});const u=E(Array.prototype.forEach),p=E(Array.prototype.lastIndexOf),h=E(Array.prototype.pop),f=E(Array.prototype.push),m=E(Array.prototype.splice),g=E(String.prototype.toLowerCase),v=E(String.prototype.toString),y=E(String.prototype.match),x=E(String.prototype.replace),b=E(String.prototype.indexOf),w=E(String.prototype.trim),S=E(Object.prototype.hasOwnProperty),_=E(RegExp.prototype.test),k=T(TypeError);function E(z){return function(te){te instanceof RegExp&&(te.lastIndex=0);for(var ye=arguments.length,Y=new Array(ye>1?ye-1:0),M=1;M<ye;M++)Y[M-1]=arguments[M];return c(z,te,Y)}}function T(z){return function(){for(var te=arguments.length,ye=new Array(te),Y=0;Y<te;Y++)ye[Y]=arguments[Y];return d(z,ye)}}function O(z,te){let ye=arguments.length>2&&arguments[2]!==void 0?arguments[2]:g;e&&e(z,null);let Y=te.length;for(;Y--;){let M=te[Y];if(typeof M=="string"){const ie=ye(M);ie!==M&&(n(te)||(te[Y]=ie),M=ie)}z[M]=!0}return z}function q(z){for(let te=0;te<z.length;te++)S(z,te)||(z[te]=null);return z}function P(z){const te=l(null);for(const[ye,Y]of t(z))S(z,ye)&&(Array.isArray(Y)?te[ye]=q(Y):Y&&typeof Y=="object"&&Y.constructor===Object?te[ye]=P(Y):te[ye]=Y);return te}function W(z,te){for(;z!==null;){const Y=s(z,te);if(Y){if(Y.get)return E(Y.get);if(typeof Y.value=="function")return E(Y.value)}z=r(z)}function ye(){return null}return ye}const j=i(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),G=i(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),pe=i(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Z=i(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),ee=i(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),F=i(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),K=i(["#text"]),U=i(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),V=i(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),J=i(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),oe=i(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),me=a(/\{\{[\w\W]*|[\w\W]*\}\}/gm),je=a(/<%[\w\W]*|[\w\W]*%>/gm),he=a(/\$\{[\w\W]*/gm),Ee=a(/^data-[\-\w.\u00B7-\uFFFF]+$/),Me=a(/^aria-[\-\w]+$/),We=a(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Ie=a(/^(?:\w+script|data):/i),Je=a(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Ue=a(/^html$/i),C=a(/^[a-z][.\w]*(-[.\w]+)+$/i);var Q=Object.freeze({__proto__:null,ARIA_ATTR:Me,ATTR_WHITESPACE:Je,CUSTOM_ELEMENT:C,DATA_ATTR:Ee,DOCTYPE_NAME:Ue,ERB_EXPR:je,IS_ALLOWED_URI:We,IS_SCRIPT_OR_DATA:Ie,MUSTACHE_EXPR:me,TMPLIT_EXPR:he});const ce={element:1,text:3,progressingInstruction:7,comment:8,document:9},L=function(){return typeof window>"u"?null:window},N=function(te,ye){if(typeof te!="object"||typeof te.createPolicy!="function")return null;let Y=null;const M="data-tt-policy-suffix";ye&&ye.hasAttribute(M)&&(Y=ye.getAttribute(M));const ie="dompurify"+(Y?"#"+Y:"");try{return te.createPolicy(ie,{createHTML(fe){return fe},createScriptURL(fe){return fe}})}catch{return console.warn("TrustedTypes policy "+ie+" could not be created."),null}},I=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function H(){let z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:L();const te=be=>H(be);if(te.version="3.3.0",te.removed=[],!z||!z.document||z.document.nodeType!==ce.document||!z.Element)return te.isSupported=!1,te;let{document:ye}=z;const Y=ye,M=Y.currentScript,{DocumentFragment:ie,HTMLTemplateElement:fe,Node:Se,Element:De,NodeFilter:ke,NamedNodeMap:ae=z.NamedNodeMap||z.MozNamedAttrMap,HTMLFormElement:ue,DOMParser:Ge,trustedTypes:Qe}=z,et=De.prototype,ht=W(et,"cloneNode"),lt=W(et,"remove"),Le=W(et,"nextSibling"),de=W(et,"childNodes"),ne=W(et,"parentNode");if(typeof fe=="function"){const be=ye.createElement("template");be.content&&be.content.ownerDocument&&(ye=be.content.ownerDocument)}let ge,He="";const{implementation:mt,createNodeIterator:_e,createDocumentFragment:vt,getElementsByTagName:dt}=ye,{importNode:Et}=Y;let Xe=I();te.isSupported=typeof t=="function"&&typeof ne=="function"&&mt&&mt.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:tn,ERB_EXPR:fn,TMPLIT_EXPR:nr,DATA_ATTR:ft,ARIA_ATTR:Lr,IS_SCRIPT_OR_DATA:Dr,ATTR_WHITESPACE:jn,CUSTOM_ELEMENT:kt}=Q;let{IS_ALLOWED_URI:Vt}=Q,pt=null;const yr=O({},[...j,...G,...pe,...ee,...K]);let bt=null;const Xr=O({},[...U,...V,...J,...oe]);let xt=Object.seal(l(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),nn=null,It=null;const Yt=Object.seal(l(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let Tt=!0,Ct=!0,rn=!1,_t=!0,Hn=!1,Zr=!0,rr=!1,bs=!1,Kr=!1,Un=!1,Ir=!1,Jr=!1,Ui=!0,ei=!1;const ma="user-content-";let ti=!0,Qr=!1,xr={},Rn=null;const es=O({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let ni=null;const ri=O({},["audio","video","img","source","image","track"]);let zr=null;const si=O({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ts="http://www.w3.org/1998/Math/MathML",sr="http://www.w3.org/2000/svg",On="http://www.w3.org/1999/xhtml";let ir=On,ii=!1,vr=null;const ws=O({},[ts,sr,On],v);let ns=O({},["mi","mo","mn","ms","mtext"]),_s=O({},["annotation-xml"]);const Wi=O({},["title","style","font","a","script"]);let rs=null;const An=["application/xhtml+xml","text/html"],or="text/html";let At=null,ar=null;const Gi=ye.createElement("form"),Vi=function(B){return B instanceof RegExp||B instanceof Function},oi=function(){let B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(ar&&ar===B)){if((!B||typeof B!="object")&&(B={}),B=P(B),rs=An.indexOf(B.PARSER_MEDIA_TYPE)===-1?or:B.PARSER_MEDIA_TYPE,At=rs==="application/xhtml+xml"?v:g,pt=S(B,"ALLOWED_TAGS")?O({},B.ALLOWED_TAGS,At):yr,bt=S(B,"ALLOWED_ATTR")?O({},B.ALLOWED_ATTR,At):Xr,vr=S(B,"ALLOWED_NAMESPACES")?O({},B.ALLOWED_NAMESPACES,v):ws,zr=S(B,"ADD_URI_SAFE_ATTR")?O(P(si),B.ADD_URI_SAFE_ATTR,At):si,ni=S(B,"ADD_DATA_URI_TAGS")?O(P(ri),B.ADD_DATA_URI_TAGS,At):ri,Rn=S(B,"FORBID_CONTENTS")?O({},B.FORBID_CONTENTS,At):es,nn=S(B,"FORBID_TAGS")?O({},B.FORBID_TAGS,At):P({}),It=S(B,"FORBID_ATTR")?O({},B.FORBID_ATTR,At):P({}),xr=S(B,"USE_PROFILES")?B.USE_PROFILES:!1,Tt=B.ALLOW_ARIA_ATTR!==!1,Ct=B.ALLOW_DATA_ATTR!==!1,rn=B.ALLOW_UNKNOWN_PROTOCOLS||!1,_t=B.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Hn=B.SAFE_FOR_TEMPLATES||!1,Zr=B.SAFE_FOR_XML!==!1,rr=B.WHOLE_DOCUMENT||!1,Un=B.RETURN_DOM||!1,Ir=B.RETURN_DOM_FRAGMENT||!1,Jr=B.RETURN_TRUSTED_TYPE||!1,Kr=B.FORCE_BODY||!1,Ui=B.SANITIZE_DOM!==!1,ei=B.SANITIZE_NAMED_PROPS||!1,ti=B.KEEP_CONTENT!==!1,Qr=B.IN_PLACE||!1,Vt=B.ALLOWED_URI_REGEXP||We,ir=B.NAMESPACE||On,ns=B.MATHML_TEXT_INTEGRATION_POINTS||ns,_s=B.HTML_INTEGRATION_POINTS||_s,xt=B.CUSTOM_ELEMENT_HANDLING||{},B.CUSTOM_ELEMENT_HANDLING&&Vi(B.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(xt.tagNameCheck=B.CUSTOM_ELEMENT_HANDLING.tagNameCheck),B.CUSTOM_ELEMENT_HANDLING&&Vi(B.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(xt.attributeNameCheck=B.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),B.CUSTOM_ELEMENT_HANDLING&&typeof B.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(xt.allowCustomizedBuiltInElements=B.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Hn&&(Ct=!1),Ir&&(Un=!0),xr&&(pt=O({},K),bt=[],xr.html===!0&&(O(pt,j),O(bt,U)),xr.svg===!0&&(O(pt,G),O(bt,V),O(bt,oe)),xr.svgFilters===!0&&(O(pt,pe),O(bt,V),O(bt,oe)),xr.mathMl===!0&&(O(pt,ee),O(bt,J),O(bt,oe))),B.ADD_TAGS&&(typeof B.ADD_TAGS=="function"?Yt.tagCheck=B.ADD_TAGS:(pt===yr&&(pt=P(pt)),O(pt,B.ADD_TAGS,At))),B.ADD_ATTR&&(typeof B.ADD_ATTR=="function"?Yt.attributeCheck=B.ADD_ATTR:(bt===Xr&&(bt=P(bt)),O(bt,B.ADD_ATTR,At))),B.ADD_URI_SAFE_ATTR&&O(zr,B.ADD_URI_SAFE_ATTR,At),B.FORBID_CONTENTS&&(Rn===es&&(Rn=P(Rn)),O(Rn,B.FORBID_CONTENTS,At)),ti&&(pt["#text"]=!0),rr&&O(pt,["html","head","body"]),pt.table&&(O(pt,["tbody"]),delete nn.tbody),B.TRUSTED_TYPES_POLICY){if(typeof B.TRUSTED_TYPES_POLICY.createHTML!="function")throw k('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof B.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw k('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');ge=B.TRUSTED_TYPES_POLICY,He=ge.createHTML("")}else ge===void 0&&(ge=N(Qe,M)),ge!==null&&typeof He=="string"&&(He=ge.createHTML(""));i&&i(B),ar=B}},Yi=O({},[...G,...pe,...Z]),ss=O({},[...ee,...F]),ga=function(B){let ve=ne(B);(!ve||!ve.tagName)&&(ve={namespaceURI:ir,tagName:"template"});const Re=g(B.tagName),rt=g(ve.tagName);return vr[B.namespaceURI]?B.namespaceURI===sr?ve.namespaceURI===On?Re==="svg":ve.namespaceURI===ts?Re==="svg"&&(rt==="annotation-xml"||ns[rt]):!!Yi[Re]:B.namespaceURI===ts?ve.namespaceURI===On?Re==="math":ve.namespaceURI===sr?Re==="math"&&_s[rt]:!!ss[Re]:B.namespaceURI===On?ve.namespaceURI===sr&&!_s[rt]||ve.namespaceURI===ts&&!ns[rt]?!1:!ss[Re]&&(Wi[Re]||!Yi[Re]):!!(rs==="application/xhtml+xml"&&vr[B.namespaceURI]):!1},Xt=function(B){f(te.removed,{element:B});try{ne(B).removeChild(B)}catch{lt(B)}},cn=function(B,ve){try{f(te.removed,{attribute:ve.getAttributeNode(B),from:ve})}catch{f(te.removed,{attribute:null,from:ve})}if(ve.removeAttribute(B),B==="is")if(Un||Ir)try{Xt(ve)}catch{}else try{ve.setAttribute(B,"")}catch{}},ai=function(B){let ve=null,Re=null;if(Kr)B="<remove></remove>"+B;else{const tt=y(B,/^[\r\n\t ]+/);Re=tt&&tt[0]}rs==="application/xhtml+xml"&&ir===On&&(B='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+B+"</body></html>");const rt=ge?ge.createHTML(B):B;if(ir===On)try{ve=new Ge().parseFromString(rt,rs)}catch{}if(!ve||!ve.documentElement){ve=mt.createDocument(ir,"template",null);try{ve.documentElement.innerHTML=ii?He:rt}catch{}}const ct=ve.body||ve.documentElement;return B&&Re&&ct.insertBefore(ye.createTextNode(Re),ct.childNodes[0]||null),ir===On?dt.call(ve,rr?"html":"body")[0]:rr?ve.documentElement:ct},qi=function(B){return _e.call(B.ownerDocument||B,B,ke.SHOW_ELEMENT|ke.SHOW_COMMENT|ke.SHOW_TEXT|ke.SHOW_PROCESSING_INSTRUCTION|ke.SHOW_CDATA_SECTION,null)},Ss=function(B){return B instanceof ue&&(typeof B.nodeName!="string"||typeof B.textContent!="string"||typeof B.removeChild!="function"||!(B.attributes instanceof ae)||typeof B.removeAttribute!="function"||typeof B.setAttribute!="function"||typeof B.namespaceURI!="string"||typeof B.insertBefore!="function"||typeof B.hasChildNodes!="function")},re=function(B){return typeof Se=="function"&&B instanceof Se};function xe(be,B,ve){u(be,Re=>{Re.call(te,B,ve,ar)})}const we=function(B){let ve=null;if(xe(Xe.beforeSanitizeElements,B,null),Ss(B))return Xt(B),!0;const Re=At(B.nodeName);if(xe(Xe.uponSanitizeElement,B,{tagName:Re,allowedTags:pt}),Zr&&B.hasChildNodes()&&!re(B.firstElementChild)&&_(/<[/\w!]/g,B.innerHTML)&&_(/<[/\w!]/g,B.textContent)||B.nodeType===ce.progressingInstruction||Zr&&B.nodeType===ce.comment&&_(/<[/\w]/g,B.data))return Xt(B),!0;if(!(Yt.tagCheck instanceof Function&&Yt.tagCheck(Re))&&(!pt[Re]||nn[Re])){if(!nn[Re]&&ot(Re)&&(xt.tagNameCheck instanceof RegExp&&_(xt.tagNameCheck,Re)||xt.tagNameCheck instanceof Function&&xt.tagNameCheck(Re)))return!1;if(ti&&!Rn[Re]){const rt=ne(B)||B.parentNode,ct=de(B)||B.childNodes;if(ct&&rt){const tt=ct.length;for(let nt=tt-1;nt>=0;--nt){const Zt=ht(ct[nt],!0);Zt.__removalCount=(B.__removalCount||0)+1,rt.insertBefore(Zt,Le(B))}}}return Xt(B),!0}return B instanceof De&&!ga(B)||(Re==="noscript"||Re==="noembed"||Re==="noframes")&&_(/<\/no(script|embed|frames)/i,B.innerHTML)?(Xt(B),!0):(Hn&&B.nodeType===ce.text&&(ve=B.textContent,u([tn,fn,nr],rt=>{ve=x(ve,rt," ")}),B.textContent!==ve&&(f(te.removed,{element:B.cloneNode()}),B.textContent=ve)),xe(Xe.afterSanitizeElements,B,null),!1)},Ne=function(B,ve,Re){if(Ui&&(ve==="id"||ve==="name")&&(Re in ye||Re in Gi))return!1;if(!(Ct&&!It[ve]&&_(ft,ve))){if(!(Tt&&_(Lr,ve))){if(!(Yt.attributeCheck instanceof Function&&Yt.attributeCheck(ve,B))){if(!bt[ve]||It[ve]){if(!(ot(B)&&(xt.tagNameCheck instanceof RegExp&&_(xt.tagNameCheck,B)||xt.tagNameCheck instanceof Function&&xt.tagNameCheck(B))&&(xt.attributeNameCheck instanceof RegExp&&_(xt.attributeNameCheck,ve)||xt.attributeNameCheck instanceof Function&&xt.attributeNameCheck(ve,B))||ve==="is"&&xt.allowCustomizedBuiltInElements&&(xt.tagNameCheck instanceof RegExp&&_(xt.tagNameCheck,Re)||xt.tagNameCheck instanceof Function&&xt.tagNameCheck(Re))))return!1}else if(!zr[ve]){if(!_(Vt,x(Re,jn,""))){if(!((ve==="src"||ve==="xlink:href"||ve==="href")&&B!=="script"&&b(Re,"data:")===0&&ni[B])){if(!(rn&&!_(Dr,x(Re,jn,"")))){if(Re)return!1}}}}}}}return!0},ot=function(B){return B!=="annotation-xml"&&y(B,kt)},Ze=function(B){xe(Xe.beforeSanitizeAttributes,B,null);const{attributes:ve}=B;if(!ve||Ss(B))return;const Re={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:bt,forceKeepAttr:void 0};let rt=ve.length;for(;rt--;){const ct=ve[rt],{name:tt,namespaceURI:nt,value:Zt}=ct,Mn=At(tt),li=Zt;let Kt=tt==="value"?li:w(li);if(Re.attrName=Mn,Re.attrValue=Kt,Re.keepAttr=!0,Re.forceKeepAttr=void 0,xe(Xe.uponSanitizeAttribute,B,Re),Kt=Re.attrValue,ei&&(Mn==="id"||Mn==="name")&&(cn(tt,B),Kt=ma+Kt),Zr&&_(/((--!?|])>)|<\/(style|title|textarea)/i,Kt)){cn(tt,B);continue}if(Mn==="attributename"&&y(Kt,"href")){cn(tt,B);continue}if(Re.forceKeepAttr)continue;if(!Re.keepAttr){cn(tt,B);continue}if(!_t&&_(/\/>/i,Kt)){cn(tt,B);continue}Hn&&u([tn,fn,nr],Hl=>{Kt=x(Kt,Hl," ")});const ya=At(B.nodeName);if(!Ne(ya,Mn,Kt)){cn(tt,B);continue}if(ge&&typeof Qe=="object"&&typeof Qe.getAttributeType=="function"&&!nt)switch(Qe.getAttributeType(ya,Mn)){case"TrustedHTML":{Kt=ge.createHTML(Kt);break}case"TrustedScriptURL":{Kt=ge.createScriptURL(Kt);break}}if(Kt!==li)try{nt?B.setAttributeNS(nt,tt,Kt):B.setAttribute(tt,Kt),Ss(B)?Xt(B):h(te.removed)}catch{cn(tt,B)}}xe(Xe.afterSanitizeAttributes,B,null)},Ce=function be(B){let ve=null;const Re=qi(B);for(xe(Xe.beforeSanitizeShadowDOM,B,null);ve=Re.nextNode();)xe(Xe.uponSanitizeShadowNode,ve,null),we(ve),Ze(ve),ve.content instanceof ie&&be(ve.content);xe(Xe.afterSanitizeShadowDOM,B,null)};return te.sanitize=function(be){let B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ve=null,Re=null,rt=null,ct=null;if(ii=!be,ii&&(be="<!-->"),typeof be!="string"&&!re(be))if(typeof be.toString=="function"){if(be=be.toString(),typeof be!="string")throw k("dirty is not a string, aborting")}else throw k("toString is not a function");if(!te.isSupported)return be;if(bs||oi(B),te.removed=[],typeof be=="string"&&(Qr=!1),Qr){if(be.nodeName){const Zt=At(be.nodeName);if(!pt[Zt]||nn[Zt])throw k("root node is forbidden and cannot be sanitized in-place")}}else if(be instanceof Se)ve=ai("<!---->"),Re=ve.ownerDocument.importNode(be,!0),Re.nodeType===ce.element&&Re.nodeName==="BODY"||Re.nodeName==="HTML"?ve=Re:ve.appendChild(Re);else{if(!Un&&!Hn&&!rr&&be.indexOf("<")===-1)return ge&&Jr?ge.createHTML(be):be;if(ve=ai(be),!ve)return Un?null:Jr?He:""}ve&&Kr&&Xt(ve.firstChild);const tt=qi(Qr?be:ve);for(;rt=tt.nextNode();)we(rt),Ze(rt),rt.content instanceof ie&&Ce(rt.content);if(Qr)return be;if(Un){if(Ir)for(ct=vt.call(ve.ownerDocument);ve.firstChild;)ct.appendChild(ve.firstChild);else ct=ve;return(bt.shadowroot||bt.shadowrootmode)&&(ct=Et.call(Y,ct,!0)),ct}let nt=rr?ve.outerHTML:ve.innerHTML;return rr&&pt["!doctype"]&&ve.ownerDocument&&ve.ownerDocument.doctype&&ve.ownerDocument.doctype.name&&_(Ue,ve.ownerDocument.doctype.name)&&(nt="<!DOCTYPE "+ve.ownerDocument.doctype.name+`>
`+nt),Hn&&u([tn,fn,nr],Zt=>{nt=x(nt,Zt," ")}),ge&&Jr?ge.createHTML(nt):nt},te.setConfig=function(){let be=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};oi(be),bs=!0},te.clearConfig=function(){ar=null,bs=!1},te.isValidAttribute=function(be,B,ve){ar||oi({});const Re=At(be),rt=At(B);return Ne(Re,rt,ve)},te.addHook=function(be,B){typeof B=="function"&&f(Xe[be],B)},te.removeHook=function(be,B){if(B!==void 0){const ve=p(Xe[be],B);return ve===-1?void 0:m(Xe[be],ve,1)[0]}return h(Xe[be])},te.removeHooks=function(be){Xe[be]=[]},te.removeAllHooks=function(){Xe=I()},te}var X=H();return Xu=X,Xu}var E5=self.DOMPurify||(self.DOMPurify=B0().default||B0());const T5=jl(E5);function Lf(t,e={}){if(!t||typeof t!="string")return console.warn("[SVG-SANITIZE] Invalid input:",typeof t),"";const n={USE_PROFILES:{svg:!0,svgFilters:!0},FORBID_TAGS:["script","foreignObject","iframe","embed"],FORBID_ATTR:["onload","onerror","onclick","onmouseover","onmouseout","onmouseenter","onmouseleave","onmousemove","onmousedown","onmouseup","onfocus","onblur","onkeydown","onkeyup","onkeypress","onsubmit","onreset","onselect","onchange","oninput","onanimationstart","onanimationend","onanimationiteration","ontransitionend","ontransitionrun","ontransitionstart","ontransitioncancel","xlink:href",...e.additionalForbiddenAttrs||[]],ALLOW_DATA_ATTR:!0,ALLOW_COMMENTS:!1,RETURN_DOM:!1,RETURN_DOM_FRAGMENT:!1,ALLOWED_URI_REGEXP:/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,HOOKS:{afterSanitizeAttributes:r=>{if(r.hasAttribute("href")){const s=r.getAttribute("href");s&&s.toLowerCase().trim().startsWith("javascript:")&&(r.removeAttribute("href"),console.warn("[SVG-SANITIZE] Removed javascript: href"))}if(r.hasAttribute("xlink:href")){const s=r.getAttribute("xlink:href");s&&(s.toLowerCase().trim().startsWith("javascript:")||s.toLowerCase().trim().startsWith("data:text/html"))&&(r.removeAttribute("xlink:href"),console.warn("[SVG-SANITIZE] Removed dangerous xlink:href"))}}},...e};try{const r=T5.sanitize(t,n);if(!r||!r.includes("<svg"))return console.error("[SVG-SANITIZE] Sanitization removed SVG content - input may be malicious"),"";const s=t.length,i=r.length,a=(s-i)/s*100;return a>10&&console.warn(`[SVG-SANITIZE] Removed ${a.toFixed(1)}% of content (${s-i} chars) - possible malicious SVG detected`),r}catch(r){return console.error("[SVG-SANITIZE] Sanitization failed:",r),""}}function N5(t){if(!t||typeof t!="string")return!1;const e=t.toLowerCase(),n=["<script","javascript:","onload=","onerror=","onclick=","onmouseover=","<foreignobject","<iframe","<embed","data:text/html"];for(const r of n)if(e.includes(r))return console.warn(`[SVG-VALIDATE] Dangerous pattern detected: ${r}`),!1;return e.includes("<svg")?!0:(console.warn("[SVG-VALIDATE] Content does not appear to be valid SVG (no <svg> tag found)"),!1)}function P5(t){return t.replace("#","").toLowerCase()}async function bi(t,e,n=null){try{let r;if(n)r=n,console.log(`[SVG-RECOLOR] Using provided SVG text (${r.length} chars)`);else{console.log("[SVG-RECOLOR] Fetching SVG from:",t);const m=await fetch(t);if(!m.ok)throw new Error(`Failed to fetch SVG: ${m.status} ${m.statusText}`);r=await m.text(),console.log(`[SVG-RECOLOR] Fetched SVG (${r.length} chars)`)}console.log("[SVG-RECOLOR] Sanitizing SVG...");const s=Lf(r);if(!s)throw new Error("SVG sanitization failed - content rejected");const a=new DOMParser().parseFromString(s,"image/svg+xml"),l=a.querySelector("parsererror");if(l)throw new Error(`SVG parse error: ${l.textContent}`);const c=a.documentElement;if(c.tagName!=="svg")throw new Error("Invalid SVG: root element is not <svg>");const d=R5(c,e);console.log("[SVG-RECOLOR] Recoloring complete:",d);const p=new XMLSerializer().serializeToString(a),h=new Blob([p],{type:"image/svg+xml"});return{dataUrl:URL.createObjectURL(h),svgText:p,stats:d}}catch(r){throw console.error("[SVG-RECOLOR] Error:",r),r}}function R5(t,e){const n={totalElements:0,fillsReplaced:0,strokesReplaced:0,stopColorsReplaced:0,stylesProcessed:0,colorsNotMapped:new Set},r=t.querySelectorAll("*");n.totalElements=r.length;for(const a of r){const l=a.getAttribute("fill");if(l&&l!=="none"){const p=Wr(l,e,n.colorsNotMapped);p!==l&&(p==="transparent"||p==="none"?(a.setAttribute("fill","none"),a.setAttribute("fill-opacity","0")):a.setAttribute("fill",p),n.fillsReplaced++)}const c=a.getAttribute("stroke");if(c&&c!=="none"){const p=Wr(c,e,n.colorsNotMapped);p!==c&&(p==="transparent"||p==="none"?(a.setAttribute("stroke","none"),a.setAttribute("stroke-opacity","0")):a.setAttribute("stroke",p),n.strokesReplaced++)}const d=a.getAttribute("stop-color");if(d&&d!=="none"){const p=Wr(d,e,n.colorsNotMapped);p!==d&&(a.setAttribute("stop-color",p),n.stopColorsReplaced++)}const u=a.getAttribute("style");if(u){const p=W0(u,e,n);p!==u&&(a.setAttribute("style",p),n.stylesProcessed++)}}const s=t.querySelectorAll("style");for(const a of s){const l=a.textContent,c=A5(l,e,n);c!==l&&(a.textContent=c,n.stylesProcessed++)}const i=t.querySelectorAll("stop");for(const a of i){const l=a.getAttribute("stop-color");if(l&&l!=="none"){const d=Wr(l,e,n.colorsNotMapped);d!==l&&(a.setAttribute("stop-color",d),n.stopColorsReplaced++)}const c=a.getAttribute("style");if(c&&c.includes("stop-color")){const d=W0(c,e,n);d!==c&&(a.setAttribute("style",d),n.stylesProcessed++)}}return n}function Wr(t,e,n){const r=M5(t);if(!r)return t;const s=`#${r}`,i=e.get(s);if(i)return i.blendHex;const a=H0(r);if(!a)return t;const l=U0(a);let c=null,d=1/0;for(const[u,p]of e.entries()){const h=H0(u.replace("#",""));if(!h)continue;const f=U0(h),m=O5(l,f);if(m<d&&(d=m,c=p),m<=9)return console.log(`[SVG-RECOLOR] Tolerance match: ${s}  ${u} (E=${m.toFixed(2)})`),p.blendHex}return c?(console.log(`[SVG-RECOLOR] Fallback to nearest: ${s}  ${c.blendHex} (E=${d.toFixed(2)})`),n&&n.add(t),c.blendHex):(console.warn(`[SVG-RECOLOR] No mapping found: ${s}`),t)}function H0(t){if(t.length!==6)return null;const e=parseInt(t.substring(0,2),16),n=parseInt(t.substring(2,4),16),r=parseInt(t.substring(4,6),16);return isNaN(e)||isNaN(n)||isNaN(r)?null:{r:e,g:n,b:r}}function U0(t){let e=t.r/255,n=t.g/255,r=t.b/255;e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92,n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92,r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92;const s=(e*.4124+n*.3576+r*.1805)*100,i=(e*.2126+n*.7152+r*.0722)*100,a=(e*.0193+n*.1192+r*.9505)*100,l=95.047,c=100,d=108.883;let u=s/l,p=i/c,h=a/d;return u=u>.008856?Math.pow(u,1/3):7.787*u+16/116,p=p>.008856?Math.pow(p,1/3):7.787*p+16/116,h=h>.008856?Math.pow(h,1/3):7.787*h+16/116,{L:116*p-16,a:500*(u-p),b:200*(p-h)}}function O5(t,e){const i=Math.PI*2,a=Math.PI,l=(t.L+e.L)/2,c=Math.sqrt(t.a*t.a+t.b*t.b),d=Math.sqrt(e.a*e.a+e.b*e.b),u=(c+d)/2,p=.5*(1-Math.sqrt(Math.pow(u,7)/(Math.pow(u,7)+Math.pow(25,7)))),h=t.a*(1+p),f=e.a*(1+p),m=Math.sqrt(h*h+t.b*t.b),g=Math.sqrt(f*f+e.b*e.b),v=(m+g)/2;let y=Math.atan2(t.b,h);y<0&&(y+=i);let x=Math.atan2(e.b,f);x<0&&(x+=i);const b=Math.abs(y-x)>a?(y+x+i)/2:(y+x)/2,w=1-.17*Math.cos(b-Math.PI/6)+.24*Math.cos(2*b)+.32*Math.cos(3*b+Math.PI/30)-.2*Math.cos(4*b-63*Math.PI/180);let S=x-y;Math.abs(S)>a&&(S=S>0?S-i:S+i);const _=e.L-t.L,k=g-m,E=2*Math.sqrt(m*g)*Math.sin(S/2),T=1+.015*Math.pow(l-50,2)/Math.sqrt(20+Math.pow(l-50,2)),O=1+.045*v,q=1+.015*v*w,P=30*Math.PI/180*Math.exp(-Math.pow((b-275*Math.PI/180)/(25*Math.PI/180),2)),j=-(2*Math.sqrt(Math.pow(v,7)/(Math.pow(v,7)+Math.pow(25,7))))*Math.sin(2*P);return Math.sqrt(Math.pow(_/(1*T),2)+Math.pow(k/(1*O),2)+Math.pow(E/(1*q),2)+j*(k/(1*O))*(E/(1*q)))}function W0(t,e,n){let r=t;return r=r.replace(/fill:\s*([^;]+)/gi,(s,i)=>`fill: ${Wr(i.trim(),e,n.colorsNotMapped)}`),r=r.replace(/stroke:\s*([^;]+)/gi,(s,i)=>`stroke: ${Wr(i.trim(),e,n.colorsNotMapped)}`),r=r.replace(/stop-color:\s*([^;]+)/gi,(s,i)=>`stop-color: ${Wr(i.trim(),e,n.colorsNotMapped)}`),r}function A5(t,e,n){let r=t,s=0;return r=r.replace(/fill:\s*([^;}\s]+)/gi,(i,a)=>{const l=a.trim(),c=Wr(l,e,n.colorsNotMapped);return c!==l&&(s++,console.log(`[SVG-RECOLOR-CSS] Replaced fill: ${l}  ${c}`)),`fill: ${c}`}),r=r.replace(/stroke:\s*([^;}\s]+)/gi,(i,a)=>{const l=a.trim(),c=Wr(l,e,n.colorsNotMapped);return c!==l&&(s++,console.log(`[SVG-RECOLOR-CSS] Replaced stroke: ${l}  ${c}`)),`stroke: ${c}`}),r=r.replace(/stop-color:\s*([^;}\s]+)/gi,(i,a)=>{const l=a.trim(),c=Wr(l,e,n.colorsNotMapped);return c!==l&&(s++,console.log(`[SVG-RECOLOR-CSS] Replaced stop-color: ${l}  ${c}`)),`stop-color: ${c}`}),s>0&&console.log(`[SVG-RECOLOR-CSS] Total CSS color replacements: ${s}`),r}function M5(t){const e=t.trim().toLowerCase();if(e.match(/^#?[0-9a-f]{6}$/))return P5(e);const n=e.match(/^#?([0-9a-f]{3})$/);if(n)return n[1].split("").map(a=>a+a).join("");const r=e.match(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/);if(r){const i=parseInt(r[1],10),a=parseInt(r[2],10),l=parseInt(r[3],10);return $5(i,a,l)}const s={white:"ffffff",black:"000000",red:"ff0000",green:"008000",blue:"0000ff",yellow:"ffff00",cyan:"00ffff",magenta:"ff00ff",gray:"808080",grey:"808080",orange:"ffa500",purple:"800080"};return s[e]?s[e]:null}function $5(t,e,n){const r=s=>Math.max(0,Math.min(255,s)).toString(16).padStart(2,"0");return`${r(t)}${r(e)}${r(n)}`}function Bo(t){const n=new DOMParser().parseFromString(t,"image/svg+xml"),r=n.querySelector("parsererror");if(r)return console.error("[SVG-REGION-TAGGER] Parse error:",r.textContent),t;const s=n.documentElement;if(!s.hasAttribute("viewBox")){const l=s.getAttribute("width"),c=s.getAttribute("height");if(l&&c){const d=parseFloat(l),u=parseFloat(c);!isNaN(d)&&!isNaN(u)&&(s.setAttribute("viewBox",`0 0 ${d} ${u}`),console.log(`[SVG-REGION-TAGGER] Added viewBox from dimensions: 0 0 ${d} ${u}`))}else{const d=L5(n);d&&(s.setAttribute("viewBox",`${d.x} ${d.y} ${d.width} ${d.height}`),console.log(`[SVG-REGION-TAGGER] Added viewBox from content bounds: ${d.x} ${d.y} ${d.width} ${d.height}`))}}let i=0;return n.querySelectorAll("path, rect, circle, ellipse, polygon, polyline, line").forEach(l=>{l.hasAttribute("data-region-id")||l.setAttribute("data-region-id",`region-${i++}`)}),console.log(`[SVG-REGION-TAGGER] Tagged ${i} regions`),new XMLSerializer().serializeToString(n)}function L5(t){try{const e=t.documentElement.cloneNode(!0),n=document.createElement("div");n.style.position="absolute",n.style.visibility="hidden",document.body.appendChild(n),n.appendChild(e);const r=e.getBBox();if(document.body.removeChild(n),r.width>0&&r.height>0)return{x:Math.floor(r.x),y:Math.floor(r.y),width:Math.ceil(r.width),height:Math.ceil(r.height)}}catch(e){console.warn("[SVG-REGION-TAGGER] Could not calculate content bounds:",e)}return null}function Ao(t,e){if(!e||e.size===0)return t;const r=new DOMParser().parseFromString(t,"image/svg+xml"),s=r.querySelector("parsererror");if(s)return console.error("[SVG-REGION-OVERRIDES] Parse error:",s.textContent),t;let i=0;return e.forEach((a,l)=>{const c=typeof a=="string"?a:a.hex,d=r.querySelector(`[data-region-id="${l}"]`);if(d){const u=c==="transparent"||c==="none";if((d.hasAttribute("fill")||u)&&(u?(d.setAttribute("fill","none"),d.setAttribute("fill-opacity","0")):(d.setAttribute("fill",c),d.removeAttribute("fill-opacity")),i++),d.hasAttribute("stroke")&&d.getAttribute("stroke")!=="none"){const h=d.getAttribute("stroke");h&&h!=="#000"&&h!=="#000000"&&h!=="#fff"&&h!=="#ffffff"&&(u?(d.setAttribute("stroke","none"),d.setAttribute("stroke-opacity","0")):d.setAttribute("stroke",c))}const p=d.getAttribute("style");if(p&&p.includes("fill:"))if(u){const h=p.replace(/fill:\s*[^;]+/,"fill: none");d.setAttribute("style",h)}else{const h=p.replace(/fill:\s*[^;]+/,`fill: ${c}`);d.setAttribute("style",h)}}else console.warn(`[SVG-REGION-OVERRIDES] Region not found: ${l}`)}),console.log(`[SVG-REGION-OVERRIDES] Applied ${i} region overrides`),new XMLSerializer().serializeToString(r)}async function x1(t){var y,x;const e=await Ol(t),n=(e==null?void 0:e.design)||e;if(!n)throw new Error("Design not found");if(n.input_mode==="sports_surface")throw new Error("Cannot use a sports surface design as a motif");const r=n.original_svg_url;if(!r||r.startsWith("blob:"))throw new Error("Design does not have a valid original SVG. Please ensure the design was saved after generation.");if(!n.solid_color_mapping&&!n.color_mapping)throw new Error("Design does not have color mappings. Please ensure the design was saved after color mapping.");console.log("[MOTIF] Fetching original SVG from:",r);const s=((y=n.design_data)==null?void 0:y.region_overrides)||n.region_overrides||null,i=((x=n.design_data)==null?void 0:x.original_tagged_svg)||n.original_tagged_svg||null;console.log("[MOTIF] Region overrides:",s?Object.keys(s).length:0,"regions"),console.log("[MOTIF] Original tagged SVG:",i?"present":"not present");const a=s?new Map(Object.entries(s)):null,l=await D5(r);if(!l)throw new Error("Failed to load or sanitize the original SVG.");console.log("[MOTIF] Original SVG loaded, regenerating recolored versions...");let c=null,d=null;if(n.solid_color_mapping&&Object.keys(n.solid_color_mapping).length>0)try{const b=G0(n.solid_color_mapping);console.log("[MOTIF] Solid mapping has",b.size,"colors");const{svgText:w}=await bi(null,b,l);if(c=w,console.log("[MOTIF] Generated solid SVG:",c.length,"chars"),a&&a.size>0&&c){console.log("[MOTIF] Applying",a.size,"region overrides to solid SVG");let S=c;S=Bo(c),c=Ao(S,a),console.log("[MOTIF] Applied region overrides to solid SVG")}}catch(b){console.error("[MOTIF] Failed to generate solid SVG:",b)}if(n.color_mapping&&Object.keys(n.color_mapping).length>0)try{const b=G0(n.color_mapping);console.log("[MOTIF] Blend mapping has",b.size,"colors");const{svgText:w}=await bi(null,b,l);if(d=w,console.log("[MOTIF] Generated blend SVG:",d.length,"chars"),a&&a.size>0&&d){console.log("[MOTIF] Applying",a.size,"region overrides to blend SVG");let S=Bo(d);d=Ao(S,a),console.log("[MOTIF] Applied region overrides to blend SVG")}}catch(b){console.error("[MOTIF] Failed to generate blend SVG:",b)}if(!c&&!d)throw new Error("Failed to regenerate TPV-recolored SVG versions.");const u=n.dimensions||{};let p=u.widthMM||u.width_mm||5e3,h=u.lengthMM||u.length_mm||5e3;const f=p===5e3&&h===5e3,m=c||d;if(m){const b=Df(m);if(b&&b.width&&b.height){const w=b.width/b.height;(f||Math.abs(w-1)>.01)&&(w>1?(p=5e3,h=Math.round(5e3/w)):w<1&&(h=5e3,p=Math.round(5e3*w)),console.log("[MOTIF] Corrected dimensions from SVG viewBox:",p,"x",h,"mm (aspect ratio:",w.toFixed(3),")"))}}const g=n.thumbnail_url||n.original_png_url||null,v=c&&d;return{sourceDesignId:t,sourceDesignName:n.name||"Unnamed Design",sourceThumbnailUrl:g,solidSvgContent:c,blendSvgContent:d,svgContent:c||d,hasBothVersions:v,originalWidth_mm:p,originalHeight_mm:h}}function G0(t){const e=new Map;if(!t||typeof t!="object")return e;for(const[n,r]of Object.entries(t)){const s=n.startsWith("#")?n:`#${n}`;e.set(s,r)}return e}async function D5(t){try{console.log("[MOTIF] Fetching SVG from:",t);const e=await fetch(t);if(!e.ok)return console.error("[MOTIF] Failed to fetch SVG:",e.status,e.statusText),null;const n=await e.text();if(console.log("[MOTIF] Fetched content length:",n.length,"chars"),console.log("[MOTIF] Content starts with:",n.substring(0,100)),!N5(n))return console.error("[MOTIF] SVG failed quick validation"),null;const r=Lf(n);return r?(console.log("[MOTIF] Sanitized SVG length:",r.length,"chars"),r):(console.error("[MOTIF] SVG sanitization failed"),null)}catch(e){return console.error("[MOTIF] Error fetching SVG:",e),null}}async function v1(t={}){const e=await md(t);return{designs:(e.designs||[]).filter(r=>r.input_mode==="sports_surface"?!1:r.thumbnail_url||r.original_svg_url||r.original_png_url),pagination:e.pagination}}function Df(t){if(!t)return null;const e=t.match(/viewBox=["']([^"']+)["']/i);if(e){const s=e[1].split(/\s+/).map(Number);if(s.length>=4)return{width:s[2],height:s[3]}}const n=t.match(/\bwidth=["']?(\d+(?:\.\d+)?)/i),r=t.match(/\bheight=["']?(\d+(?:\.\d+)?)/i);return n&&r?{width:parseFloat(n[1]),height:parseFloat(r[1])}:null}const I5=Object.freeze(Object.defineProperty({__proto__:null,extractSVGDimensions:Df,fetchMotifFromDesign:x1,listPlaygroundDesigns:v1},Symbol.toStringTag,{value:"Module"}));function V0({onOpenGenerator:t,mobileMode:e=!1,activeTab:n,onItemAdded:r}){const[s,i]=R.useState(null),[a,l]=R.useState("courts"),c=e?n:a,d=e?()=>{}:l,[u,p]=R.useState([]),[h,f]=R.useState(!1),[m,g]=R.useState(null),[v,y]=R.useState(null),{addCourt:x,addTrack:b,addMotif:w,addShape:S,courts:_,tracks:k,motifs:E,shapes:T}=it(),O=Object.keys(_).length,q=Object.keys(k).length,P=Object.keys(E).length,W=OE(),j=j5();R.useEffect(()=>{c==="designs"&&u.length===0&&!h&&G()},[c]);const G=async()=>{f(!0),g(null);try{const J=await v1({limit:50});p(J.designs||[])}catch(J){console.error("[MOTIFS] Failed to load designs:",J),g(J.message||"Failed to load designs")}finally{f(!1)}},pe=J=>{const oe=AE(J);oe&&(x(J,oe),e&&r&&r())},Z=J=>{const oe=C5(J);oe&&(b(J,oe),e&&r&&r())},ee=async J=>{if(!v){y(J);try{const oe=await x1(J);w(oe.sourceDesignId,oe.sourceDesignName,oe.svgContent,oe.originalWidth_mm,oe.originalHeight_mm,oe.sourceThumbnailUrl,{solidSvgContent:oe.solidSvgContent,blendSvgContent:oe.blendSvgContent,hasBothVersions:oe.hasBothVersions}),e&&r&&r()}catch(oe){console.error("[MOTIFS] Failed to add motif:",oe),alert(`Failed to add motif: ${oe.message}`)}finally{y(null)}}},F=[{id:"rectangle",name:"Rectangle",icon:""},{id:"square",name:"Square",icon:""},{id:"circle",name:"Circle",icon:""},{id:"triangle",name:"Triangle",icon:""},{id:"pentagon",name:"Pentagon",icon:""},{id:"hexagon",name:"Hexagon",icon:""},{id:"blob",name:"Blob",icon:""}],K=Object.keys(T||{}).length,V=(()=>{switch(c){case"courts":return{title:"Courts",count:O,hint:"Select a court to add"};case"tracks":return{title:"Tracks",count:q,hint:"Select a track to add"};case"shapes":return{title:"Shapes",count:K,hint:"Tap a shape to add it"};case"designs":return{title:"Designs",count:P,hint:"Add your saved designs as motifs"};default:return{title:"Library",count:0,hint:""}}})();return o.jsxs("div",{className:`court-library ${e?"court-library--mobile":""}`,children:[!e&&o.jsxs("div",{className:"court-library__header",children:[o.jsxs("div",{className:"court-library__header-row",children:[o.jsx("h2",{children:V.title}),o.jsxs("span",{className:"court-library__count",children:[V.count," on canvas"]})]}),o.jsx("p",{children:V.hint})]}),!e&&o.jsxs("div",{className:"court-library__tabs",children:[o.jsx("button",{className:`court-library__tab ${c==="courts"?"court-library__tab--active":""}`,onClick:()=>{d("courts"),i(null)},children:"Courts"}),o.jsx("button",{className:`court-library__tab ${c==="tracks"?"court-library__tab--active":""}`,onClick:()=>{d("tracks"),i(null)},children:"Tracks"}),o.jsx("button",{className:`court-library__tab ${c==="designs"?"court-library__tab--active":""}`,onClick:()=>{d("designs"),i(null)},children:"Designs"})]}),o.jsxs("div",{className:`court-library__list ${e?"court-library__list--mobile":""}`,children:[c==="courts"&&W.map(J=>o.jsxs("div",{className:`court-library__item ${s===J.id?"court-library__item--selected":""}`,onClick:()=>e?pe(J.id):i(J.id),onDoubleClick:()=>!e&&pe(J.id),children:[o.jsx("div",{className:"court-library__preview",children:o.jsx(z5,{template:J})}),o.jsxs("div",{className:"court-library__info",children:[o.jsx("div",{className:"court-library__name",children:J.name}),o.jsxs("div",{className:"court-library__dimensions",children:[(J.dimensions.width_mm/1e3).toFixed(1),"m  ",(J.dimensions.length_mm/1e3).toFixed(1),"m"]}),o.jsx("div",{className:"court-library__standard",children:J.standard})]}),s===J.id&&o.jsx("button",{className:"court-library__add-btn",onClick:oe=>{oe.stopPropagation(),pe(J.id)},children:"+ ADD"})]},J.id)),c==="tracks"&&j.map(J=>o.jsxs("div",{className:`court-library__item ${s===J.id?"court-library__item--selected":""}`,onClick:()=>e?Z(J.id):i(J.id),onDoubleClick:()=>!e&&Z(J.id),children:[o.jsx("div",{className:"court-library__preview",children:o.jsx(B5,{template:J})}),o.jsxs("div",{className:"court-library__info",children:[o.jsx("div",{className:"court-library__name",children:J.name}),o.jsxs("div",{className:"court-library__standard",children:[J.parameters.numLanes," Lanes  ",J.standard]}),o.jsx("div",{className:"court-library__note",children:"Scales to fit canvas"})]}),s===J.id&&o.jsx("button",{className:"court-library__add-btn",onClick:oe=>{oe.stopPropagation(),Z(J.id)},children:"+ ADD"})]},J.id)),c==="shapes"&&o.jsx("div",{className:`court-library__shapes-grid ${e?"court-library__shapes-grid--mobile":""}`,children:F.map(J=>o.jsxs("button",{className:"court-library__shape-btn",onClick:()=>{S(J.id),e&&r&&r()},children:[o.jsx("span",{className:"court-library__shape-icon",children:J.icon}),o.jsx("span",{className:"court-library__shape-name",children:J.name})]},J.id))}),c==="designs"&&o.jsxs(o.Fragment,{children:[h&&o.jsxs("div",{className:"court-library__loading",children:[o.jsx("div",{className:"court-library__spinner"}),o.jsx("p",{children:"Loading your designs..."})]}),m&&o.jsxs("div",{className:"court-library__error",children:[o.jsx("p",{children:m}),o.jsx("button",{onClick:G,children:"Try Again"})]}),!h&&!m&&u.length===0&&o.jsxs("div",{className:"court-library__empty",children:[o.jsx("p",{children:"No designs found."}),o.jsx("p",{className:"court-library__empty-hint",children:"Generate new designs or save them to use as motifs."})]}),!h&&u.map(J=>{var oe,me;return o.jsxs("div",{className:`court-library__item ${s===J.id?"court-library__item--selected":""} ${v===J.id?"court-library__item--loading":""}`,onClick:()=>e?ee(J.id):i(J.id),onDoubleClick:()=>!e&&ee(J.id),children:[o.jsx("div",{className:"court-library__preview",children:o.jsx(H5,{design:J})}),o.jsxs("div",{className:"court-library__info",children:[o.jsx("div",{className:"court-library__name",children:J.name||"Unnamed Design"}),o.jsxs("div",{className:"court-library__dimensions",children:[((((oe=J.design_data)==null?void 0:oe.widthMM)||5e3)/1e3).toFixed(1),"m  ",((((me=J.design_data)==null?void 0:me.lengthMM)||5e3)/1e3).toFixed(1),"m"]}),o.jsx("div",{className:"court-library__note",children:"Playground Design"})]}),s===J.id&&o.jsx("button",{className:"court-library__add-btn",onClick:je=>{je.stopPropagation(),ee(J.id)},disabled:v===J.id,children:v===J.id?"Adding...":"+ ADD"})]},J.id)})]})]}),!e&&o.jsx("div",{className:"court-library__generate",children:o.jsxs("button",{className:"court-library__generate-btn",onClick:t,children:[o.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M12 5v14M5 12h14"})}),"Generate New Design"]})}),!e&&o.jsx("div",{className:"court-library__footer",children:o.jsxs("p",{className:"court-library__hint",children:[c==="courts"&&"Double-click a court to add it instantly",c==="tracks"&&"Double-click a track to add it instantly",c==="designs"&&"Double-click a design to add it as a motif"]})})]})}function z5({template:t}){const e=t.dimensions.width_mm,n=t.dimensions.length_mm,r=Math.min(62/e,62/n),s=e*r,i=n*r;return o.jsxs("svg",{width:"62",height:"62",viewBox:"0 0 62 62",className:"court-library__svg-preview",children:[o.jsx("rect",{x:(62-s)/2,y:(62-i)/2,width:s,height:i,fill:"#e5e7eb",stroke:"#9ca3af",strokeWidth:"1.5"}),t.markings.map((a,l)=>o.jsx(F5,{marking:a,scale:r,offsetX:(62-s)/2,offsetY:(62-i)/2},l))]})}function F5({marking:t,scale:e,offsetX:n,offsetY:r}){const{type:s,params:i}=t;switch(s){case"line":return o.jsx("line",{x1:i.x1*e+n,y1:i.y1*e+r,x2:i.x2*e+n,y2:i.y2*e+r,stroke:"#1e293b",strokeWidth:"1.5"});case"rectangle":return o.jsx("rect",{x:i.x*e+n,y:i.y*e+r,width:i.width*e,height:i.height*e,stroke:"#1e293b",strokeWidth:"1.5",fill:"none"});case"circle":return o.jsx("circle",{cx:i.cx*e+n,cy:i.cy*e+r,r:i.radius*e,stroke:"#1e293b",strokeWidth:"1.5",fill:"none"});case"arc":{const{cx:a,cy:l,radius:c,startAngle:d,endAngle:u}=i,p=d*Math.PI/180,h=u*Math.PI/180,f=(a+c*Math.cos(p))*e+n,m=(l+c*Math.sin(p))*e+r,g=(a+c*Math.cos(h))*e+n,v=(l+c*Math.sin(h))*e+r,y=u-d>180?1:0,x=`M ${f} ${m} A ${c*e} ${c*e} 0 ${y} 1 ${g} ${v}`;return o.jsx("path",{d:x,stroke:"#1e293b",strokeWidth:"1.5",fill:"none"})}default:return null}}function B5({template:t}){const{parameters:e}=t,n=e.width_mm,r=e.height_mm,s=Math.min(58/n,58/r),i=n*s,a=r*s,l=e.numLanes,c=e.laneWidth_mm*s,d=e.cornerRadius,p=(d.topLeft+d.topRight+d.bottomLeft+d.bottomRight)/4*s,h=(62-i)/2,f=(62-a)/2;return o.jsxs("svg",{width:"62",height:"62",viewBox:"0 0 62 62",className:"court-library__svg-preview",children:[o.jsx("rect",{x:h,y:f,width:i,height:a,rx:p,fill:"#e5e7eb"}),Array.from({length:l}).map((m,g)=>{const v=g*c,y=Math.max(0,p-v);return o.jsx("rect",{x:h+v,y:f+v,width:Math.max(0,i-v*2),height:Math.max(0,a-v*2),rx:y,stroke:"#1e293b",strokeWidth:"1",fill:"none"},g)})]})}function H5({design:t}){const e=t.thumbnail_url||t.original_png_url;return e?o.jsx("img",{src:e,alt:t.name||"Design preview",className:"court-library__motif-img",style:{width:"62px",height:"62px",objectFit:"contain",borderRadius:"4px",backgroundColor:"#f3f4f6"},onError:n=>{n.target.style.display="none",n.target.nextSibling&&(n.target.nextSibling.style.display="flex")}}):o.jsx("div",{className:"court-library__motif-placeholder",style:{width:"62px",height:"62px",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#e5e7eb",borderRadius:"4px",color:"#9ca3af",fontSize:"10px",textAlign:"center"},children:"No Preview"})}function Y0({onEditSourceDesign:t}){var N,I;const{courts:e,tracks:n,motifs:r,shapes:s,texts:i,exclusionZones:a,groups:l,selectedCourtId:c,selectedTrackId:d,selectedMotifId:u,selectedShapeId:p,selectedTextId:h,selectedExclusionZoneId:f,selectedGroupId:m,editingGroupId:g,updateCourtPosition:v,updateCourtRotation:y,updateCourtScale:x,setLineColor:b,setZoneColor:w,setCourtSurfaceColor:S,resetCourtColors:_,removeCourt:k,removeTrack:E,removeMotif:T,updateMotifPosition:O,updateMotifRotation:q,updateMotifScale:P,updateTrackParameters:W,enterGroup:j,exitGroup:G,ungroup:pe,regenerateCompound:Z,deleteGroupWithChildren:ee,addToHistory:F}=it(),[K,U]=R.useState("transform"),[V,J]=R.useState(null);if(m){const H=l[m];return H?o.jsx(q5,{group:H,groupId:m,shapes:s,isEditing:g===m,onEnterGroup:()=>j(m),onExitGroup:()=>G(),onUngroup:()=>pe(m),onRegenerate:()=>Z(m),onDelete:()=>ee(m)}):null}if(f){const H=a[f];return H?o.jsx(Y5,{zone:H,zoneId:f}):null}if(h){const H=i[h];return H?o.jsx(V5,{text:H,textId:h}):null}if(p){const H=s[p];return H?o.jsx(G5,{shape:H,shapeId:p}):null}if(u){const H=r[u];return H?o.jsx(W5,{motif:H,motifId:u,onEditSourceDesign:t}):null}if(d){const H=n[d];return H?o.jsx(U5,{track:H,trackId:d}):null}if(!c)return o.jsx("div",{className:"properties-panel properties-panel--empty",children:o.jsxs("div",{className:"properties-panel__empty-state",children:[o.jsx("p",{children:"No element selected"}),o.jsx("span",{className:"properties-panel__hint",children:"Click on a court, track, or motif to view and edit its properties"})]})});const oe=e[c];if(!oe)return null;const{position:me,rotation:je,scale:he,template:Ee,lineColorOverrides:Me,zoneColorOverrides:We}=oe,Ie=(H,X)=>{const z=parseFloat(X);isNaN(z)||v(c,{...me,[H]:z})},Je=H=>{const X=parseFloat(H);isNaN(X)||y(c,X)},Ue=H=>{const X=parseFloat(H);isNaN(X)||X<=0||x(c,X)},C=()=>{window.confirm(`Delete ${Ee.name}? This action cannot be undone.`)&&k(c)},Q=H=>{if(!V)return;if(V.type==="courtSurface"&&H===null){S(c,null),J(null);return}if(!H)return;const X={tpv_code:H.code,hex:H.hex,name:H.name};V.type==="line"?b(c,V.id,X):V.type==="zone"?w(c,V.id,X):V.type==="courtSurface"?S(c,X):V.type==="allLines"&&Ee.markings.forEach(z=>{b(c,z.id,X)}),J(null)},ce=H=>{const X=Me[H.id];if(X)return{code:X.tpv_code,hex:X.hex,name:X.name};const z=pn.find(te=>te.code===Ee.defaultLineColor);return z?{code:z.code,hex:z.hex,name:z.name}:null},L=H=>{const X=We[H.id];if(X)return{code:X.tpv_code,hex:X.hex,name:X.name};const z=pn.find(te=>te.code===H.defaultColor);return z?{code:z.code,hex:z.hex,name:z.name}:null};return o.jsxs("div",{className:"properties-panel",children:[o.jsxs("div",{className:"properties-panel__header",children:[o.jsx("h3",{children:"Properties"}),o.jsxs("div",{className:"properties-panel__court-info",children:[o.jsx("span",{className:"court-name",children:Ee.name}),o.jsx("span",{className:"court-standard",children:Ee.standard})]})]}),o.jsxs("div",{className:"properties-panel__tabs",children:[o.jsx("button",{className:`tab ${K==="transform"?"tab--active":""}`,onClick:()=>U("transform"),children:"Transform"}),o.jsx("button",{className:`tab ${K==="lines"?"tab--active":""}`,onClick:()=>U("lines"),children:"Lines"}),o.jsx("button",{className:`tab ${K==="zones"?"tab--active":""}`,onClick:()=>U("zones"),children:"Zones"})]}),o.jsxs("div",{className:"properties-panel__content",children:[K==="transform"&&o.jsxs("div",{className:"properties-section",children:[o.jsx("div",{className:"properties-section__header",children:o.jsx("h4",{children:"Transform"})}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Position"}),o.jsxs("div",{className:"property-input-row",children:[o.jsxs("div",{className:"property-input-group",children:[o.jsx("span",{className:"property-label",children:"X"}),o.jsx("input",{type:"number",value:Math.round(me.x),onChange:H=>Ie("x",H.target.value),step:"100"}),o.jsx("span",{className:"property-unit",children:"mm"})]}),o.jsxs("div",{className:"property-input-group",children:[o.jsx("span",{className:"property-label",children:"Y"}),o.jsx("input",{type:"number",value:Math.round(me.y),onChange:H=>Ie("y",H.target.value),step:"100"}),o.jsx("span",{className:"property-unit",children:"mm"})]})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Rotation"}),o.jsxs("div",{className:"property-input-row",children:[o.jsx("input",{type:"range",min:"0",max:"360",value:je,onChange:H=>Je(H.target.value),className:"property-slider"}),o.jsxs("div",{className:"property-input-group property-input-group--compact",children:[o.jsx("input",{type:"number",value:Math.round(je),onChange:H=>Je(H.target.value),min:"0",max:"360"}),o.jsx("span",{className:"property-unit",children:""})]})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Scale"}),o.jsxs("div",{className:"property-input-row",children:[o.jsx("input",{type:"range",min:"0.5",max:"2.0",step:"0.1",value:he,onChange:H=>Ue(H.target.value),className:"property-slider"}),o.jsxs("div",{className:"property-input-group property-input-group--compact",children:[o.jsx("input",{type:"number",value:he.toFixed(2),onChange:H=>Ue(H.target.value),min:"0.5",max:"2.0",step:"0.1"}),o.jsx("span",{className:"property-unit",children:""})]})]})]}),o.jsxs("div",{className:"property-group property-group--info",children:[o.jsx("label",{children:"Dimensions"}),o.jsx("div",{className:"property-info",children:o.jsxs("span",{children:[(Ee.dimensions.width_mm*he/1e3).toFixed(1),"m  ",(Ee.dimensions.length_mm*he/1e3).toFixed(1),"m"]})})]}),o.jsx("div",{className:"property-group property-group--actions",children:o.jsx("button",{className:"btn-delete",onClick:C,title:"Delete court (Delete key)",children:" Delete Court"})})]}),K==="lines"&&o.jsxs("div",{className:"properties-section",children:[o.jsxs("div",{className:"properties-section__header",children:[o.jsx("h4",{children:"Line Markings"}),o.jsx("button",{className:"btn-reset",onClick:()=>_(c),title:"Reset all colours to defaults",children:"Reset"})]}),o.jsxs("div",{className:"color-item color-item--all-lines",children:[o.jsxs("div",{className:"color-item__info",children:[o.jsx("span",{className:"color-item__name",children:"Change All Lines"}),o.jsx("span",{className:"color-item__hint",children:"Set all lines to same colour"})]}),o.jsx("button",{className:"color-item__swatch color-item__swatch--all",onClick:()=>J({type:"allLines"}),title:"Change all line colours at once",children:o.jsx("span",{style:{fontSize:"1rem"},children:""})})]}),o.jsx("div",{className:"color-list",children:Ee.markings.map(H=>{const X=ce(H);return o.jsxs("div",{className:"color-item",children:[o.jsxs("div",{className:"color-item__info",children:[o.jsx("span",{className:"color-item__name",children:H.name}),X&&o.jsx("span",{className:"color-item__code",children:X.code})]}),o.jsx("button",{className:"color-item__swatch",style:{backgroundColor:(X==null?void 0:X.hex)||"#000"},onClick:()=>J({type:"line",id:H.id}),title:(X==null?void 0:X.name)||"Select colour"})]},H.id)})})]}),K==="zones"&&o.jsxs("div",{className:"properties-section",children:[o.jsx("div",{className:"properties-section__header",children:o.jsx("h4",{children:"Fill Colours"})}),o.jsxs("div",{className:"color-item color-item--surface-fill",children:[o.jsxs("div",{className:"color-item__info",children:[o.jsx("span",{className:"color-item__name",children:"Court Surface"}),o.jsx("span",{className:"color-item__hint",children:oe.courtSurfaceColor?oe.courtSurfaceColor.name:"No Fill (transparent)"}),oe.courtSurfaceColor&&o.jsx("span",{className:"color-item__code",children:oe.courtSurfaceColor.tpv_code})]}),o.jsx("button",{className:`color-item__swatch ${oe.courtSurfaceColor?"":"color-item__swatch--no-fill"}`,style:{backgroundColor:((N=oe.courtSurfaceColor)==null?void 0:N.hex)||"transparent"},onClick:()=>J({type:"courtSurface"}),title:((I=oe.courtSurfaceColor)==null?void 0:I.name)||"No Fill - Click to select colour"})]}),Ee.zones&&Ee.zones.length>0&&o.jsx("div",{className:"properties-section__divider",children:o.jsx("span",{children:"Paint Zones"})}),Ee.zones&&Ee.zones.length>0&&o.jsx("div",{className:"color-list",children:Ee.zones.map(H=>{var z;const X=L(H);return o.jsxs("div",{className:"color-item",children:[o.jsxs("div",{className:"color-item__info",children:[o.jsx("span",{className:"color-item__name",children:H.name}),o.jsxs("span",{className:"color-item__area",children:[((z=H.area_m2)==null?void 0:z.toFixed(1))||0," m"]}),X&&o.jsx("span",{className:"color-item__code",children:X.code})]}),o.jsx("button",{className:"color-item__swatch",style:{backgroundColor:(X==null?void 0:X.hex)||"#000"},onClick:()=>J({type:"zone",id:H.id}),title:(X==null?void 0:X.name)||"Select colour"})]},H.id)})})]})]}),V&&o.jsx("div",{className:"color-picker-modal",onClick:()=>J(null),children:o.jsxs("div",{className:"color-picker-modal__content",onClick:H=>H.stopPropagation(),children:[o.jsxs("div",{className:"color-picker-modal__header",children:[o.jsx("h4",{children:V.type==="allLines"?"Change All Line Colours":V.type==="courtSurface"?"Select Court Fill Colour":"Select TPV Colour"}),o.jsx("button",{onClick:()=>J(null),children:""})]}),o.jsxs("div",{className:"color-picker-grid",children:[V.type==="courtSurface"&&o.jsx("button",{className:"color-picker-swatch color-picker-swatch--no-fill",onClick:()=>Q(null),title:"No Fill (transparent)",children:o.jsx("span",{className:"color-picker-swatch__code",children:"None"})}),pn.map(H=>o.jsx("button",{className:"color-picker-swatch",style:{backgroundColor:H.hex},onClick:()=>Q(H),title:`${H.code} - ${H.name}`,children:o.jsx("span",{className:"color-picker-swatch__code",children:H.code})},H.code))]})]})})]})}function U5({track:t,trackId:e}){var Se,De,ke;const{updateTrackParameters:n,updateTrackRotation:r,removeTrack:s,setTrackSurfaceColor:i,setTrackLineColor:a,setLaneSurfaceColor:l,resetLaneSurfaceColors:c,addToHistory:d}=it(),{parameters:u,template:p,trackSurfaceColor:h,trackLineColor:f,laneSurfaceColors:m,rotation:g}=t,[v,y]=$.useState(!0),[x,b]=$.useState(!1),[w,S]=$.useState(!1),[_,k]=$.useState(null),[E,T]=$.useState(""),[O,q]=$.useState(""),[P,W]=$.useState(""),[j,G]=$.useState(!1),[pe,Z]=$.useState(!1),[ee,F]=$.useState(!1),K=p.trackType==="straight",U=h1(u),V=((Se=U.lanes[0])==null?void 0:Se.perimeter)||0,J=U.lanes[U.lanes.length-1],oe=(J==null?void 0:J.perimeter)||0,me=K?[]:p1(U),je=ae=>{const ue=parseInt(ae);if(!(isNaN(ue)||ue<1||ue>8))if(K){const Ge=ue*u.laneWidth_mm;n(e,{numLanes:ue,width_mm:Ge})}else n(e,{numLanes:ue})},he=ae=>{const ue=parseFloat(ae)*1e3;return isNaN(ue)||ue<3e3?!1:(n(e,{width_mm:ue}),!0)},Ee=ae=>{const ue=parseFloat(ae)*1e3;return isNaN(ue)||ue<3e3?!1:(n(e,{height_mm:ue}),!0)},Me=()=>{G(!0),T((u.width_mm/1e3).toFixed(1))},We=()=>{G(!1),he(E)},Ie=ae=>{ae.key==="Enter"?ae.target.blur():ae.key==="Escape"&&(G(!1),T((u.width_mm/1e3).toFixed(1)))},Je=()=>{Z(!0),q((u.height_mm/1e3).toFixed(1))},Ue=()=>{Z(!1),Ee(O)},C=ae=>{ae.key==="Enter"?ae.target.blur():ae.key==="Escape"&&(Z(!1),q((u.height_mm/1e3).toFixed(1)))},Q=ae=>{let ue=parseFloat(ae);return isNaN(ue)?!1:(ue=(ue%360+360)%360,r(e,ue),d(),!0)},ce=()=>{F(!0),W(g.toFixed(0))},L=()=>{F(!1),Q(P)},N=ae=>{ae.key==="Enter"?ae.target.blur():ae.key==="Escape"&&(F(!1),W(g.toFixed(0)))},I=(ae,ue)=>{const Ge=parseFloat(ue)*1e3;if(isNaN(Ge)||Ge<0)return;const Qe=Math.min(u.width_mm,u.height_mm)/2,et=Math.min(Ge,Qe);v?n(e,{cornerRadius:{topLeft:et,topRight:et,bottomLeft:et,bottomRight:et}}):n(e,{cornerRadius:{...u.cornerRadius,[ae]:et}})},H=()=>{window.confirm(`Delete ${p.name}? This action cannot be undone.`)&&s(e)},X=ae=>{i(e,{tpv_code:ae.code,hex:ae.hex,name:ae.name}),b(!1)},z=ae=>{a(e,{tpv_code:ae.code,hex:ae.hex,name:ae.name}),S(!1)},te=ae=>{n(e,{startingBoxes:{...u.startingBoxes,enabled:ae}})},ye=ae=>{const ue=parseFloat(ae)*1e3;isNaN(ue)||ue<100||n(e,{startingBoxes:{...u.startingBoxes,depth_mm:ue}})},Y=ae=>{n(e,{startingBoxes:{...u.startingBoxes,style:ae}})},M=ae=>{n(e,{startingBoxes:{...u.startingBoxes,direction:ae}})},ie=ae=>{const ue=parseFloat(ae);isNaN(ue)||ue<0||ue>100||n(e,{startingBoxes:{...u.startingBoxes,startPosition:ue}})},fe=(u.cornerRadius.topLeft+u.cornerRadius.topRight+u.cornerRadius.bottomLeft+u.cornerRadius.bottomRight)/4;return o.jsxs("div",{className:"properties-panel",children:[o.jsxs("div",{className:"properties-panel__header",children:[o.jsx("h3",{children:"Track Properties"}),o.jsxs("div",{className:"properties-panel__court-info",children:[o.jsx("span",{className:"court-name",children:p.name}),o.jsx("span",{className:"court-standard",children:p.standard})]})]}),o.jsx("div",{className:"properties-panel__content",children:o.jsxs("div",{className:"properties-section",children:[o.jsx("div",{className:"properties-section__header",children:o.jsx("h4",{children:"Track Parameters"})}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Number of Lanes"}),o.jsxs("div",{className:"property-input-row",children:[o.jsx("input",{type:"range",min:"1",max:"8",value:u.numLanes,onChange:ae=>je(ae.target.value),className:"property-slider"}),o.jsxs("div",{className:"property-input-group property-input-group--compact",children:[o.jsx("input",{type:"number",value:u.numLanes,onChange:ae=>je(ae.target.value),min:"1",max:"8"}),o.jsx("span",{className:"property-unit",children:"lanes"})]})]})]}),K?o.jsxs("div",{className:"property-group property-group--info",children:[o.jsx("label",{children:"Track Width"}),o.jsx("div",{className:"property-info",children:o.jsxs("span",{children:[(u.width_mm/1e3).toFixed(1),"m (Auto-calculated from lanes)"]})})]}):o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Track Width"}),o.jsxs("div",{className:"property-input-group",children:[o.jsx("input",{type:"number",value:j?E:(u.width_mm/1e3).toFixed(1),onChange:ae=>T(ae.target.value),onFocus:Me,onBlur:We,onKeyDown:Ie,min:"3",max:"100",step:"0.5"}),o.jsx("span",{className:"property-unit",children:"m"})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:K?"Track Length":"Track Height"}),o.jsxs("div",{className:"property-input-group",children:[o.jsx("input",{type:"number",value:pe?O:(u.height_mm/1e3).toFixed(1),onChange:ae=>q(ae.target.value),onFocus:Je,onBlur:Ue,onKeyDown:C,min:"3",max:"100",step:"0.5"}),o.jsx("span",{className:"property-unit",children:"m"})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Rotation"}),o.jsxs("div",{className:"property-input-group",children:[o.jsx("input",{type:"number",value:ee?P:g.toFixed(0),onChange:ae=>W(ae.target.value),onFocus:ce,onBlur:L,onKeyDown:N,min:"0",max:"360",step:"15"}),o.jsx("span",{className:"property-unit",children:""})]})]}),!K&&o.jsxs("div",{className:"property-group",children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[o.jsx("label",{children:"Corner Radius"}),o.jsx("button",{className:"btn-toggle",onClick:()=>y(!v),style:{padding:"0.25rem 0.5rem",fontSize:"0.75rem",background:v?"#0066CC":"#6b7280",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},title:v?"Click to edit corners independently":"Click to lock all corners together",children:v?" Locked":" Independent"})]}),v?o.jsxs("div",{className:"property-input-group",children:[o.jsx("input",{type:"number",value:(fe/1e3).toFixed(2),onChange:ae=>I("topLeft",ae.target.value),min:"0",max:(Math.min(u.width_mm,u.height_mm)/2e3).toFixed(0),step:"0.5"}),o.jsx("span",{className:"property-unit",children:"m"})]}):o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[o.jsxs("div",{children:[o.jsx("label",{style:{fontSize:"0.75rem",color:"#64748b"},children:"Top Left"}),o.jsxs("div",{className:"property-input-group",children:[o.jsx("input",{type:"number",value:(u.cornerRadius.topLeft/1e3).toFixed(2),onChange:ae=>I("topLeft",ae.target.value),min:"0",max:(Math.min(u.width_mm,u.height_mm)/2e3).toFixed(0),step:"0.5"}),o.jsx("span",{className:"property-unit",children:"m"})]})]}),o.jsxs("div",{children:[o.jsx("label",{style:{fontSize:"0.75rem",color:"#64748b"},children:"Top Right"}),o.jsxs("div",{className:"property-input-group",children:[o.jsx("input",{type:"number",value:(u.cornerRadius.topRight/1e3).toFixed(2),onChange:ae=>I("topRight",ae.target.value),min:"0",max:(Math.min(u.width_mm,u.height_mm)/2e3).toFixed(0),step:"0.5"}),o.jsx("span",{className:"property-unit",children:"m"})]})]}),o.jsxs("div",{children:[o.jsx("label",{style:{fontSize:"0.75rem",color:"#64748b"},children:"Bottom Left"}),o.jsxs("div",{className:"property-input-group",children:[o.jsx("input",{type:"number",value:(u.cornerRadius.bottomLeft/1e3).toFixed(2),onChange:ae=>I("bottomLeft",ae.target.value),min:"0",max:(Math.min(u.width_mm,u.height_mm)/2e3).toFixed(0),step:"0.5"}),o.jsx("span",{className:"property-unit",children:"m"})]})]}),o.jsxs("div",{children:[o.jsx("label",{style:{fontSize:"0.75rem",color:"#64748b"},children:"Bottom Right"}),o.jsxs("div",{className:"property-input-group",children:[o.jsx("input",{type:"number",value:(u.cornerRadius.bottomRight/1e3).toFixed(2),onChange:ae=>I("bottomRight",ae.target.value),min:"0",max:(Math.min(u.width_mm,u.height_mm)/2e3).toFixed(0),step:"0.5"}),o.jsx("span",{className:"property-unit",children:"m"})]})]})]})]}),o.jsxs("div",{className:"property-group property-group--info",children:[o.jsx("label",{children:"Lane Width"}),o.jsx("div",{className:"property-info",children:o.jsxs("span",{children:[(u.laneWidth_mm/1e3).toFixed(2),"m (Fixed)"]})})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Track Surface Colour"}),o.jsxs("div",{className:"color-item",children:[o.jsxs("div",{className:"color-item__info",children:[o.jsx("span",{className:"color-item__name",children:(h==null?void 0:h.name)||"Select Colour"}),h&&o.jsx("span",{className:"color-item__code",children:h.tpv_code})]}),o.jsx("button",{className:"color-item__swatch",style:{backgroundColor:(h==null?void 0:h.hex)||"#A5362F"},onClick:()=>b(!0),title:(h==null?void 0:h.name)||"Select colour"})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[o.jsx("label",{style:{margin:0},children:"Lane Colours"}),(m==null?void 0:m.some(ae=>ae!=null))&&o.jsx("button",{onClick:()=>c(e),title:"Reset all lanes to track surface colour",style:{padding:"0.25rem 0.5rem",fontSize:"0.7rem",background:"#f1f5f9",border:"1px solid #e2e8f0",borderRadius:"4px",cursor:"pointer",color:"#64748b"},children:"Reset All"})]}),o.jsx("div",{className:"lane-color-grid",children:U.lanes.map(ae=>{const ue=(m==null?void 0:m[ae.laneNumber-1])||h,Ge=(m==null?void 0:m[ae.laneNumber-1])!=null;return o.jsxs("div",{className:"lane-color-item",children:[o.jsxs("span",{className:"lane-number",children:["Lane ",ae.laneNumber]}),o.jsx("button",{className:`color-item__swatch lane-swatch ${Ge?"lane-swatch--override":""}`,style:{backgroundColor:(ue==null?void 0:ue.hex)||"#A5362F"},onClick:()=>k({laneNumber:ae.laneNumber}),title:`${(ue==null?void 0:ue.name)||"Standard Red"}${Ge?" (custom)":" (default)"}`}),Ge&&o.jsx("button",{className:"lane-reset-btn",onClick:()=>l(e,ae.laneNumber,null),title:"Reset to track default",children:""})]},ae.laneNumber)})}),o.jsx("div",{style:{fontSize:"0.7rem",color:"#94a3b8",marginTop:"0.5rem"},children:"Click a swatch to change lane colour"})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Line Colour"}),o.jsxs("div",{className:"color-item",children:[o.jsxs("div",{className:"color-item__info",children:[o.jsx("span",{className:"color-item__name",children:(f==null?void 0:f.name)||"Cream"}),f&&o.jsx("span",{className:"color-item__code",children:f.tpv_code})]}),o.jsx("button",{className:"color-item__swatch",style:{backgroundColor:(f==null?void 0:f.hex)||"#E8E3D8"},onClick:()=>S(!0),title:(f==null?void 0:f.name)||"Select colour"})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[o.jsx("input",{type:"checkbox",checked:((De=u.startingBoxes)==null?void 0:De.enabled)||!1,onChange:ae=>te(ae.target.checked)}),"Show Starting Boxes"]}),((ke=u.startingBoxes)==null?void 0:ke.enabled)&&o.jsxs("div",{style:{marginTop:"0.75rem"},children:[o.jsxs("div",{className:"property-input-group",style:{marginBottom:"0.75rem"},children:[o.jsx("span",{className:"property-label",style:{fontSize:"0.875rem"},children:"Depth"}),o.jsx("input",{type:"number",value:(u.startingBoxes.depth_mm/1e3).toFixed(2),onChange:ae=>ye(ae.target.value),min:"0.1",max:"1.0",step:"0.05"}),o.jsx("span",{className:"property-unit",children:"m"})]}),!K&&o.jsxs("div",{style:{marginBottom:"0.75rem"},children:[o.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#64748b",marginBottom:"0.375rem"},children:"Start Style"}),o.jsxs("select",{value:u.startingBoxes.style||"staggered",onChange:ae=>Y(ae.target.value),style:{width:"100%",padding:"0.5rem",border:"1px solid #e4e9f0",borderRadius:"6px",fontSize:"0.875rem",fontFamily:"inherit",background:"white"},children:[o.jsx("option",{value:"straight",children:"Straight Start"}),o.jsx("option",{value:"staggered",children:"Staggered Start"}),o.jsx("option",{value:"both",children:"Both (opposite ends)"})]})]}),o.jsxs("div",{style:{marginBottom:"0.75rem"},children:[o.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#64748b",marginBottom:"0.375rem"},children:"Direction of Travel"}),o.jsxs("select",{value:u.startingBoxes.direction||"counterclockwise",onChange:ae=>M(ae.target.value),style:{width:"100%",padding:"0.5rem",border:"1px solid #e4e9f0",borderRadius:"6px",fontSize:"0.875rem",fontFamily:"inherit",background:"white"},children:[o.jsx("option",{value:"counterclockwise",children:"Counterclockwise (Standard)"}),o.jsx("option",{value:"clockwise",children:"Clockwise"})]})]}),!K&&o.jsxs("div",{style:{marginBottom:"0.75rem"},children:[o.jsxs("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#64748b",marginBottom:"0.375rem"},children:["Start Position (",u.startingBoxes.startPosition||0,"%)"]}),o.jsx("input",{type:"range",min:"0",max:"100",step:"1",value:u.startingBoxes.startPosition||0,onChange:ae=>ie(ae.target.value),className:"property-slider",style:{width:"100%"}}),o.jsx("div",{style:{fontSize:"0.7rem",color:"#94a3b8",marginTop:"0.25rem"},children:"Slide to adjust where the start line appears around the track"})]}),o.jsx("div",{className:"property-info",style:{fontSize:"0.75rem",color:"#64748b",marginTop:"0.5rem"},children:"Boxes use track surface colour with white starting line and lane numbers"}),!K&&me.length>0&&(u.startingBoxes.style==="staggered"||u.startingBoxes.style==="both")&&o.jsxs("div",{style:{marginTop:"0.75rem",padding:"0.5rem",background:"#f8fafc",borderRadius:"4px"},children:[o.jsx("div",{style:{fontSize:"0.75rem",fontWeight:"600",color:"#1e293b",marginBottom:"0.25rem"},children:"Auto-Calculated Staggers:"}),o.jsx("div",{style:{fontSize:"0.7rem",color:"#64748b",lineHeight:"1.4"},children:me.map((ae,ue)=>o.jsxs("div",{children:["Lane ",ue+1,": ",(ae/1e3).toFixed(2),"m"]},ue))}),o.jsx("div",{style:{fontSize:"0.65rem",color:"#64748b",marginTop:"0.25rem",fontStyle:"italic"},children:"Outer lanes start ahead to equalize distance"})]})]})]}),o.jsx("div",{className:"property-divider"}),o.jsx("div",{className:"properties-section__header",children:o.jsx("h4",{children:"Calculated Dimensions"})}),o.jsxs("div",{className:"property-group property-group--info",children:[o.jsx("label",{children:"Usable Infield"}),o.jsx("div",{className:"property-info",children:o.jsxs("span",{children:[(U.usableWidth/1e3).toFixed(1),"m  ",(U.usableHeight/1e3).toFixed(1),"m"]})})]}),o.jsxs("div",{className:"property-group property-group--info",children:[o.jsx("label",{children:"Lane 1 Perimeter"}),o.jsx("div",{className:"property-info",children:o.jsxs("span",{children:[V.toFixed(2),"m"]})})]}),u.numLanes>1&&!K&&o.jsxs("div",{className:"property-group property-group--info",children:[o.jsxs("label",{children:["Lane ",u.numLanes," Perimeter"]}),o.jsx("div",{className:"property-info",children:o.jsxs("span",{children:[oe.toFixed(2),"m"]})})]}),o.jsx("div",{className:"property-group",children:o.jsx("div",{className:"property-hint",style:{fontStyle:"normal",color:"#64748b",fontSize:"0.75rem",marginTop:"1rem"},children:" Tip: Use drag handles on the canvas or edit values here. Corner radius auto-adjusts when locked."})}),o.jsx("div",{className:"property-group property-group--actions",children:o.jsx("button",{className:"btn-delete",onClick:H,title:"Delete track (Delete key)",children:" Delete Track"})})]})}),x&&o.jsx("div",{className:"color-picker-modal",onClick:()=>b(!1),children:o.jsxs("div",{className:"color-picker-modal__content",onClick:ae=>ae.stopPropagation(),children:[o.jsxs("div",{className:"color-picker-modal__header",children:[o.jsx("h4",{children:"Select Track Surface Colour"}),o.jsx("button",{onClick:()=>b(!1),children:""})]}),o.jsx("div",{className:"color-picker-grid",children:pn.map(ae=>o.jsx("button",{className:"color-picker-swatch",style:{backgroundColor:ae.hex},onClick:()=>X(ae),title:`${ae.code} - ${ae.name}`,children:o.jsx("span",{className:"color-picker-swatch__code",children:ae.code})},ae.code))})]})}),w&&o.jsx("div",{className:"color-picker-modal",onClick:()=>S(!1),children:o.jsxs("div",{className:"color-picker-modal__content",onClick:ae=>ae.stopPropagation(),children:[o.jsxs("div",{className:"color-picker-modal__header",children:[o.jsx("h4",{children:"Select Line Colour"}),o.jsx("button",{onClick:()=>S(!1),children:""})]}),o.jsx("div",{className:"color-picker-grid",children:pn.map(ae=>o.jsx("button",{className:"color-picker-swatch",style:{backgroundColor:ae.hex},onClick:()=>z(ae),title:`${ae.code} - ${ae.name}`,children:o.jsx("span",{className:"color-picker-swatch__code",children:ae.code})},ae.code))})]})}),_&&o.jsx("div",{className:"color-picker-modal",onClick:()=>k(null),children:o.jsxs("div",{className:"color-picker-modal__content",onClick:ae=>ae.stopPropagation(),children:[o.jsxs("div",{className:"color-picker-modal__header",children:[o.jsxs("h4",{children:["Lane ",_.laneNumber," Surface Colour"]}),o.jsx("button",{onClick:()=>k(null),children:""})]}),o.jsxs("div",{className:"color-picker-grid",children:[o.jsx("button",{className:"color-picker-swatch color-picker-swatch--default",onClick:()=>{l(e,_.laneNumber,null),k(null)},title:"Use track default colour",style:{backgroundColor:(h==null?void 0:h.hex)||"#A5362F"},children:o.jsx("span",{className:"color-picker-swatch__code",children:"Default"})}),pn.map(ae=>o.jsx("button",{className:"color-picker-swatch",style:{backgroundColor:ae.hex},onClick:()=>{l(e,_.laneNumber,{tpv_code:ae.code,hex:ae.hex,name:ae.name}),k(null)},title:`${ae.code} - ${ae.name}`,children:o.jsx("span",{className:"color-picker-swatch__code",children:ae.code})},ae.code))]})]})})]})}function W5({motif:t,motifId:e,onEditSourceDesign:n}){const{updateMotifPosition:r,updateMotifRotation:s,updateMotifScale:i,removeMotif:a,duplicateMotif:l,refreshMotif:c,setMotifViewMode:d}=it(),{position:u,rotation:p,scale:h,sourceDesignName:f,sourceDesignId:m,originalWidth_mm:g,originalHeight_mm:v,sourceThumbnailUrl:y,viewMode:x,hasBothVersions:b}=t,[w,S]=$.useState(!1),[_,k]=$.useState(null),E=(Z,ee)=>{const F=parseFloat(ee);isNaN(F)||r(e,{...u,[Z]:F})},T=Z=>{const ee=parseFloat(Z);isNaN(ee)||s(e,ee)},O=Z=>{const ee=parseFloat(Z);isNaN(ee)||ee<=0||i(e,ee)},q=()=>{window.confirm("Delete this motif? This action cannot be undone.")&&a(e)},P=()=>{l(e)},W=()=>{if(n)n(m);else{if(!m){alert("Source design ID not found");return}window.open(`/studio/?design=${m}`,"_blank")}},j=async()=>{if(!w){S(!0),k(null);try{const Z=await c(e);Z.success||k(Z.error||"Failed to refresh")}catch(Z){k(Z.message||"Failed to refresh")}finally{S(!1)}}},G=g*(h||1)/1e3,pe=v*(h||1)/1e3;return o.jsxs("div",{className:"properties-panel",children:[o.jsxs("div",{className:"properties-panel__header",children:[o.jsx("h3",{children:"Motif Properties"}),o.jsxs("div",{className:"properties-panel__court-info",children:[o.jsx("span",{className:"court-name",children:f||"Unnamed Motif"}),o.jsx("span",{className:"court-standard",children:"Playground Design"})]})]}),o.jsx("div",{className:"properties-panel__content",children:o.jsxs("div",{className:"properties-section",children:[y&&o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Preview"}),o.jsx("div",{style:{width:"100%",height:"80px",background:"#f3f4f6",borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden"},children:o.jsx("img",{src:y,alt:f,style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})})]}),vi.BLEND_MODE_ENABLED,o.jsx("div",{className:"properties-section__header",children:o.jsx("h4",{children:"Transform"})}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Position"}),o.jsxs("div",{className:"property-input-row",children:[o.jsxs("div",{className:"property-input-group",children:[o.jsx("span",{className:"property-label",children:"X"}),o.jsx("input",{type:"number",value:Math.round(u.x),onChange:Z=>E("x",Z.target.value),step:"100"}),o.jsx("span",{className:"property-unit",children:"mm"})]}),o.jsxs("div",{className:"property-input-group",children:[o.jsx("span",{className:"property-label",children:"Y"}),o.jsx("input",{type:"number",value:Math.round(u.y),onChange:Z=>E("y",Z.target.value),step:"100"}),o.jsx("span",{className:"property-unit",children:"mm"})]})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Rotation"}),o.jsxs("div",{className:"property-input-row",children:[o.jsx("input",{type:"range",min:"0",max:"360",value:p||0,onChange:Z=>T(Z.target.value),className:"property-slider"}),o.jsxs("div",{className:"property-input-group property-input-group--compact",children:[o.jsx("input",{type:"number",value:Math.round(p||0),onChange:Z=>T(Z.target.value),min:"0",max:"360"}),o.jsx("span",{className:"property-unit",children:""})]})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsxs("label",{children:["Scale",o.jsx("span",{style:{fontSize:"0.7rem",color:"#64748b",marginLeft:"0.5rem"},children:"(aspect locked)"})]}),o.jsxs("div",{className:"property-input-row",children:[o.jsx("input",{type:"range",min:"0.1",max:"10",step:"0.1",value:Math.min(h||1,10),onChange:Z=>O(Z.target.value),className:"property-slider"}),o.jsxs("div",{className:"property-input-group property-input-group--compact",children:[o.jsx("input",{type:"number",value:(h||1).toFixed(2),onChange:Z=>O(Z.target.value),min:"0.1",step:"0.1"}),o.jsx("span",{className:"property-unit",children:""})]})]})]}),o.jsxs("div",{className:"property-group property-group--info",children:[o.jsx("label",{children:"Current Size"}),o.jsx("div",{className:"property-info",children:o.jsxs("span",{children:[G.toFixed(2),"m  ",pe.toFixed(2),"m"]})})]}),o.jsxs("div",{className:"property-group property-group--info",children:[o.jsx("label",{children:"Original Size"}),o.jsx("div",{className:"property-info",children:o.jsxs("span",{children:[(g/1e3).toFixed(2),"m  ",(v/1e3).toFixed(2),"m"]})})]}),o.jsx("div",{className:"properties-section__divider",style:{margin:"1rem 0"},children:o.jsx("span",{children:"Source Design"})}),o.jsx("div",{className:"property-group property-group--actions",children:o.jsx("button",{className:"btn-primary",onClick:W,title:"Edit the source playground design in a new tab",style:{width:"100%",padding:"0.5rem",background:"var(--color-primary, #1e4a7a)",color:"white",border:"none",borderRadius:"6px",fontSize:"0.875rem",fontFamily:"inherit",cursor:"pointer",marginBottom:"0.5rem",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem"},children:" Edit Source Design"})}),o.jsxs("div",{className:"property-group property-group--actions",children:[o.jsx("button",{className:"btn-secondary",onClick:j,disabled:w,title:"Refresh this motif with the latest version from the source design",style:{width:"100%",padding:"0.5rem",background:w?"#e5e7eb":"#f3f4f6",border:"1px solid #e4e9f0",borderRadius:"6px",fontSize:"0.875rem",fontFamily:"inherit",cursor:w?"not-allowed":"pointer",marginBottom:"0.5rem",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem"},children:w?" Refreshing...":" Refresh from Source"}),_&&o.jsx("div",{style:{fontSize:"0.75rem",color:"#dc2626",marginTop:"0.25rem"},children:_}),o.jsx("div",{style:{fontSize:"0.7rem",color:"#64748b",marginTop:"0.25rem"},children:"Click after editing the source design to update this motif"})]}),o.jsx("div",{className:"properties-section__divider",style:{margin:"1rem 0"},children:o.jsx("span",{children:"Actions"})}),o.jsx("div",{className:"property-group property-group--actions",children:o.jsx("button",{className:"btn-secondary",onClick:P,title:"Duplicate motif (Ctrl+D)",style:{width:"100%",padding:"0.5rem",background:"#f3f4f6",border:"1px solid #e4e9f0",borderRadius:"6px",fontSize:"0.875rem",fontFamily:"inherit",cursor:"pointer",marginBottom:"0.5rem"},children:" Duplicate Motif"})}),o.jsx("div",{className:"property-group property-group--actions",children:o.jsx("button",{className:"btn-delete",onClick:q,title:"Delete motif (Delete key)",children:" Delete Motif"})}),o.jsx("div",{className:"property-group",children:o.jsx("div",{className:"property-hint",style:{fontStyle:"normal",color:"#64748b",fontSize:"0.75rem",marginTop:"1rem"},children:' Tip: Drag the motif on the canvas to reposition. Edit the source design and click "Refresh" to update.'})})]})})]})}function G5({shape:t,shapeId:e}){var Le;const{updateShapePosition:n,updateShapeDimensions:r,updateShapeSides:s,updateShapeCornerRadius:i,setShapeStarMode:a,setShapeInnerRadius:l,updateShapeRotation:c,setShapeFillColor:d,setShapeStroke:u,setShapeAspectLock:p,removeShape:h,duplicateShape:f,randomizeBlob:m,setBlobStyle:g,setEditPointsVisible:v,setPathClosed:y,setPathSmooth:x}=it(),[b,w]=$.useState(!1),[S,_]=$.useState(!1),[k,E]=$.useState(""),[T,O]=$.useState(""),[q,P]=$.useState(!1),[W,j]=$.useState(!1),{shapeType:G,sides:pe,width_mm:Z,height_mm:ee,cornerRadius:F,starMode:K,innerRadius:U,position:V,rotation:J,fillColor:oe,strokeEnabled:me,strokeColor:je,strokeWidth_mm:he,aspectLocked:Ee,blobStyle:Me,editPointsVisible:We,closed:Ie,smooth:Je,controlPoints:Ue}=t,C=G==="blob",Q=G==="path",ce=(de,ne)=>{const ge=parseFloat(ne);isNaN(ge)||n(e,{...V,[de]:ge})},L=de=>{const ne=parseFloat(de);if(isNaN(ne)||ne<100)return!1;if(Ee){const ge=ee/Z;r(e,ne,ne*ge)}else r(e,ne,ee);return!0},N=de=>{const ne=parseFloat(de);if(isNaN(ne)||ne<100)return!1;if(Ee){const ge=Z/ee;r(e,ne*ge,ne)}else r(e,Z,ne);return!0},I=()=>{P(!0),E(Z.toFixed(0))},H=()=>{P(!1),L(k)},X=de=>{de.key==="Enter"?de.target.blur():de.key==="Escape"&&(P(!1),E(Z.toFixed(0)))},z=()=>{j(!0),O(ee.toFixed(0))},te=()=>{j(!1),N(T)},ye=de=>{de.key==="Enter"?de.target.blur():de.key==="Escape"&&(j(!1),O(ee.toFixed(0)))},Y=de=>{const ne=parseInt(de);isNaN(ne)||ne<3||s(e,ne)},M=de=>{const ne=parseFloat(de);isNaN(ne)||ne<0||ne>100||i(e,ne)},ie=de=>{const ne=parseFloat(de);isNaN(ne)||c(e,ne)},fe=de=>{d(e,{tpv_code:de.code,hex:de.hex,name:de.name}),w(!1)},Se=de=>{u(e,!0,{tpv_code:de.code,hex:de.hex,name:de.name},he),_(!1)},De=de=>{de&&!je?u(e,!0,{tpv_code:"RH31",hex:"#E8E3D8",name:"Cream"},he):u(e,de,je,he)},ke=de=>{const ne=parseFloat(de);isNaN(ne)||ne<10||u(e,me,je,ne)},ae=()=>{p(e,!Ee)},ue=()=>{window.confirm("Delete this shape? This action cannot be undone.")&&h(e)},Ge=()=>{f(e)},Qe=[{sides:3,name:"Triangle",icon:""},{sides:4,name:"Rectangle",icon:""},{sides:5,name:"Pentagon",icon:""},{sides:6,name:"Hexagon",icon:""},{sides:8,name:"Octagon",icon:""},{sides:32,name:"Circle",icon:""},{sides:5,name:"Star",icon:"",starMode:!0}],et=de=>{de.starMode?(a(e,!0),pe!==de.sides&&Y(de.sides)):(K&&a(e,!1),Y(de.sides))},ht=de=>{const ne=parseFloat(de)/100;l(e,ne)},lt=de=>de.starMode?K&&pe===de.sides:!K&&pe===de.sides;return o.jsxs("div",{className:"properties-panel",children:[o.jsxs("div",{className:"properties-panel__header",children:[o.jsx("h3",{children:C?"Blob Shape":Q?"Pen Path":"Shape Properties"}),o.jsxs("div",{className:"properties-panel__court-info",children:[o.jsx("span",{className:"court-name",children:C?((Le=Zo[Me||"organic"])==null?void 0:Le.name)||"Organic":Q?Ie?"Closed Path":"Open Path":a5(pe,K)}),o.jsx("span",{className:"court-standard",children:C?" Blob":Q?` ${(Ue==null?void 0:Ue.length)||0} points`:`${l5(pe,K)} ${pe} ${K?"points":"sides"}`})]})]}),o.jsx("div",{className:"properties-panel__content",children:o.jsxs("div",{className:"properties-section",children:[C?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Style"}),o.jsx("select",{value:Me||"organic",onChange:de=>g(e,de.target.value),style:{width:"100%",padding:"0.5rem 0.75rem",border:"1px solid #e4e9f0",borderRadius:"6px",fontSize:"0.875rem",cursor:"pointer",background:"#fff"},children:Object.entries(Zo).map(([de,ne])=>o.jsxs("option",{value:de,children:[ne.name," - ",ne.description]},de))})]}),o.jsxs("div",{className:"property-group",children:[o.jsxs("button",{onClick:()=>m(e),style:{width:"100%",padding:"0.75rem 1rem",background:"#3b82f6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"0.875rem",fontWeight:"600",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem"},children:[o.jsx("span",{style:{fontSize:"1.1rem"},children:""})," New Shape"]}),o.jsx("div",{style:{fontSize:"0.7rem",color:"#64748b",marginTop:"0.5rem",textAlign:"center"},children:"Generate a new random shape in the selected style"})]}),o.jsxs("div",{className:"property-group",children:[o.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",padding:"0.5rem",border:"1px solid #e4e9f0",borderRadius:"6px",background:We?"#eff6ff":"#fff"},children:[o.jsx("input",{type:"checkbox",checked:We||!1,onChange:de=>v(e,de.target.checked),style:{width:"16px",height:"16px",cursor:"pointer"}}),o.jsx("span",{style:{fontSize:"0.875rem"},children:"Edit Points"})]}),We&&o.jsx("div",{style:{fontSize:"0.7rem",color:"#64748b",marginTop:"0.5rem"},children:"Drag points and handles on canvas for precise control"})]})]}):Q?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"property-group",children:[o.jsx("label",{style:{marginBottom:"0.5rem",display:"block"},children:"Path Options"}),o.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",padding:"0.5rem",border:"1px solid #e4e9f0",borderRadius:"6px",background:Ie?"#eff6ff":"#fff",marginBottom:"0.5rem"},children:[o.jsx("input",{type:"checkbox",checked:Ie||!1,onChange:de=>y(e,de.target.checked),style:{width:"16px",height:"16px",cursor:"pointer"}}),o.jsx("span",{style:{fontSize:"0.875rem"},children:"Closed Path"})]}),o.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",padding:"0.5rem",border:"1px solid #e4e9f0",borderRadius:"6px",background:Je?"#eff6ff":"#fff"},children:[o.jsx("input",{type:"checkbox",checked:Je||!1,onChange:de=>x(e,de.target.checked),style:{width:"16px",height:"16px",cursor:"pointer"}}),o.jsx("span",{style:{fontSize:"0.875rem"},children:"Smooth Curves"})]}),Je&&o.jsx("div",{style:{fontSize:"0.7rem",color:"#64748b",marginTop:"0.5rem"},children:"Uses bezier curves for smooth transitions"})]}),o.jsxs("div",{className:"property-group",children:[o.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",padding:"0.5rem",border:"1px solid #e4e9f0",borderRadius:"6px",background:We?"#eff6ff":"#fff"},children:[o.jsx("input",{type:"checkbox",checked:We||!1,onChange:de=>v(e,de.target.checked),style:{width:"16px",height:"16px",cursor:"pointer"}}),o.jsx("span",{style:{fontSize:"0.875rem"},children:"Edit Points"})]}),We&&o.jsxs("div",{style:{fontSize:"0.7rem",color:"#64748b",marginTop:"0.5rem"},children:["Drag points to reshape. ",Je?"Drag handles for curve control.":"Enable smooth curves for bezier handles."]})]}),o.jsx("div",{className:"property-group",style:{background:"#f8fafc",padding:"0.75rem",borderRadius:"6px"},children:o.jsxs("div",{style:{fontSize:"0.8125rem",color:"#475569"},children:[o.jsx("strong",{children:(Ue==null?void 0:Ue.length)||0})," control points"]})})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Shape Type"}),o.jsx("div",{className:"shape-presets",style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"0.5rem",marginTop:"0.5rem"},children:Qe.map(de=>{const ne=lt(de);return o.jsxs("button",{onClick:()=>et(de),title:de.name,style:{padding:"0.5rem",border:ne?"2px solid #3b82f6":"1px solid #e4e9f0",borderRadius:"6px",background:ne?"#eff6ff":"#fff",cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",gap:"0.25rem",fontSize:"1.25rem"},children:[o.jsx("span",{children:de.icon}),o.jsx("span",{style:{fontSize:"0.65rem",color:"#64748b"},children:de.name})]},`${de.name}-${de.sides}`)})})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:K?"Number of Points":"Number of Sides"}),o.jsxs("div",{className:"property-input-row",children:[o.jsx("input",{type:"range",min:"3",max:K?12:32,value:pe,onChange:de=>Y(de.target.value),className:"property-slider"}),o.jsx("div",{className:"property-input-group property-input-group--compact",children:o.jsx("input",{type:"number",value:pe,onChange:de=>Y(de.target.value),min:"3",max:K?12:32})})]})]}),K&&o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Star Depth"}),o.jsxs("div",{className:"property-input-row",children:[o.jsx("input",{type:"range",min:"10",max:"90",value:Math.round((U||.5)*100),onChange:de=>ht(de.target.value),className:"property-slider"}),o.jsxs("div",{className:"property-input-group property-input-group--compact",children:[o.jsx("input",{type:"number",value:Math.round((U||.5)*100),onChange:de=>ht(de.target.value),min:"10",max:"90"}),o.jsx("span",{className:"property-unit",children:"%"})]})]}),o.jsx("div",{style:{fontSize:"0.7rem",color:"#64748b",marginTop:"0.25rem"},children:"Lower values = deeper points, higher = shallower"})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Corner Smoothing"}),o.jsxs("div",{className:"property-input-row",children:[o.jsx("input",{type:"range",min:"0",max:"100",value:F,onChange:de=>M(de.target.value),className:"property-slider"}),o.jsxs("div",{className:"property-input-group property-input-group--compact",children:[o.jsx("input",{type:"number",value:F,onChange:de=>M(de.target.value),min:"0",max:"100"}),o.jsx("span",{className:"property-unit",children:"%"})]})]})]})]}),o.jsx("div",{className:"properties-section__divider",style:{margin:"1rem 0"},children:o.jsx("span",{children:"Dimensions"})}),o.jsxs("div",{className:"property-group",children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[o.jsx("label",{style:{margin:0},children:"Size"}),o.jsx("button",{onClick:ae,style:{padding:"0.25rem 0.5rem",fontSize:"0.75rem",background:Ee?"#3b82f6":"#6b7280",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},title:Ee?"Aspect ratio locked":"Aspect ratio unlocked",children:Ee?" Locked":" Free"})]}),o.jsxs("div",{className:"property-input-row",children:[o.jsxs("div",{className:"property-input-group",children:[o.jsx("span",{className:"property-label",children:"W"}),o.jsx("input",{type:"number",value:q?k:Z.toFixed(0),onChange:de=>E(de.target.value),onFocus:I,onBlur:H,onKeyDown:X,step:"100",min:"100"}),o.jsx("span",{className:"property-unit",children:"mm"})]}),o.jsxs("div",{className:"property-input-group",children:[o.jsx("span",{className:"property-label",children:"H"}),o.jsx("input",{type:"number",value:W?T:ee.toFixed(0),onChange:de=>O(de.target.value),onFocus:z,onBlur:te,onKeyDown:ye,step:"100",min:"100"}),o.jsx("span",{className:"property-unit",children:"mm"})]})]}),o.jsxs("div",{style:{fontSize:"0.7rem",color:"#64748b",marginTop:"0.25rem"},children:[(Z/1e3).toFixed(2),"m  ",(ee/1e3).toFixed(2),"m"]})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Position"}),o.jsxs("div",{className:"property-input-row",children:[o.jsxs("div",{className:"property-input-group",children:[o.jsx("span",{className:"property-label",children:"X"}),o.jsx("input",{type:"number",value:Math.round(V.x),onChange:de=>ce("x",de.target.value),step:"100"}),o.jsx("span",{className:"property-unit",children:"mm"})]}),o.jsxs("div",{className:"property-input-group",children:[o.jsx("span",{className:"property-label",children:"Y"}),o.jsx("input",{type:"number",value:Math.round(V.y),onChange:de=>ce("y",de.target.value),step:"100"}),o.jsx("span",{className:"property-unit",children:"mm"})]})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Rotation"}),o.jsxs("div",{className:"property-input-row",children:[o.jsx("input",{type:"range",min:"0",max:"360",value:J||0,onChange:de=>ie(de.target.value),className:"property-slider"}),o.jsxs("div",{className:"property-input-group property-input-group--compact",children:[o.jsx("input",{type:"number",value:Math.round(J||0),onChange:de=>ie(de.target.value),min:"0",max:"360"}),o.jsx("span",{className:"property-unit",children:""})]})]})]}),o.jsx("div",{className:"properties-section__divider",style:{margin:"1rem 0"},children:o.jsx("span",{children:"Appearance"})}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Fill Colour"}),o.jsxs("div",{className:"color-item",children:[o.jsxs("div",{className:"color-item__info",children:[o.jsx("span",{className:"color-item__name",children:(oe==null?void 0:oe.name)||"Select Colour"}),oe&&o.jsx("span",{className:"color-item__code",children:oe.tpv_code})]}),o.jsx("button",{className:"color-item__swatch",style:{backgroundColor:(oe==null?void 0:oe.hex)||"#609B63"},onClick:()=>w(!0),title:(oe==null?void 0:oe.name)||"Select colour"})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[o.jsx("input",{type:"checkbox",checked:me||!1,onChange:de=>De(de.target.checked)}),"Border"]}),me&&o.jsxs("div",{style:{marginTop:"0.5rem"},children:[o.jsxs("div",{className:"color-item",style:{marginBottom:"0.5rem"},children:[o.jsxs("div",{className:"color-item__info",children:[o.jsx("span",{className:"color-item__name",children:(je==null?void 0:je.name)||"Select Colour"}),je&&o.jsx("span",{className:"color-item__code",children:je.tpv_code})]}),o.jsx("button",{className:"color-item__swatch",style:{backgroundColor:(je==null?void 0:je.hex)||"#FFFFFF"},onClick:()=>_(!0),title:(je==null?void 0:je.name)||"Select colour"})]}),o.jsxs("div",{className:"property-input-group",children:[o.jsx("span",{className:"property-label",style:{fontSize:"0.8rem"},children:"Width"}),o.jsx("input",{type:"number",value:he,onChange:de=>ke(de.target.value),step:"10",min:"10"}),o.jsx("span",{className:"property-unit",children:"mm"})]})]})]}),o.jsx("div",{className:"properties-section__divider",style:{margin:"1rem 0"},children:o.jsx("span",{children:"Actions"})}),o.jsx("div",{className:"property-group property-group--actions",children:o.jsx("button",{className:"btn-secondary",onClick:Ge,title:"Duplicate shape (Ctrl+D)",style:{width:"100%",padding:"0.5rem",background:"#f3f4f6",border:"1px solid #e4e9f0",borderRadius:"6px",fontSize:"0.875rem",fontFamily:"inherit",cursor:"pointer",marginBottom:"0.5rem"},children:" Duplicate Shape"})}),o.jsx("div",{className:"property-group property-group--actions",children:o.jsx("button",{className:"btn-delete",onClick:ue,title:"Delete shape (Delete key)",children:" Delete Shape"})}),o.jsx("div",{className:"property-group",children:o.jsx("div",{className:"property-hint",style:{fontStyle:"normal",color:"#64748b",fontSize:"0.75rem",marginTop:"1rem"},children:" Tip: Drag corners to resize, drag the rotation handle above the shape to rotate. Hold Shift to snap rotation to 15 increments."})})]})}),b&&o.jsx("div",{className:"color-picker-modal",onClick:()=>w(!1),children:o.jsxs("div",{className:"color-picker-modal__content",onClick:de=>de.stopPropagation(),children:[o.jsxs("div",{className:"color-picker-modal__header",children:[o.jsx("h4",{children:"Select Fill Colour"}),o.jsx("button",{onClick:()=>w(!1),children:""})]}),o.jsx("div",{className:"color-picker-grid",children:pn.map(de=>o.jsx("button",{className:"color-picker-swatch",style:{backgroundColor:de.hex},onClick:()=>fe(de),title:`${de.code} - ${de.name}`,children:o.jsx("span",{className:"color-picker-swatch__code",children:de.code})},de.code))})]})}),S&&o.jsx("div",{className:"color-picker-modal",onClick:()=>_(!1),children:o.jsxs("div",{className:"color-picker-modal__content",onClick:de=>de.stopPropagation(),children:[o.jsxs("div",{className:"color-picker-modal__header",children:[o.jsx("h4",{children:"Select Border Colour"}),o.jsx("button",{onClick:()=>_(!1),children:""})]}),o.jsx("div",{className:"color-picker-grid",children:pn.map(de=>o.jsx("button",{className:"color-picker-swatch",style:{backgroundColor:de.hex},onClick:()=>Se(de),title:`${de.code} - ${de.name}`,children:o.jsx("span",{className:"color-picker-swatch__code",children:de.code})},de.code))})]})})]})}function V5({text:t,textId:e}){const{updateTextContent:n,updateTextPosition:r,updateTextFontSize:s,updateTextFont:i,updateTextAlign:a,updateTextRotation:l,setTextFillColor:c,setTextStrokeColor:d,updateTextStrokeWidth:u,removeText:p,duplicateText:h}=it(),[f,m]=$.useState(!1),[g,v]=$.useState(!1),{content:y,fontFamily:x,fontSize_mm:b,fontWeight:w,fontStyle:S,textAlign:_,position:k,rotation:E,fillColor:T,strokeColor:O,strokeWidth_mm:q}=t,P=m5(),W=he=>{n(e,he)},j=(he,Ee)=>{const Me=parseFloat(Ee);isNaN(Me)||r(e,{...k,[he]:Me})},G=he=>{const Ee=parseFloat(he);isNaN(Ee)||Ee<50||s(e,Ee)},pe=he=>{i(e,he,w,S)},Z=()=>{i(e,x,w==="bold"?"normal":"bold",S)},ee=()=>{i(e,x,w,S==="italic"?"normal":"italic")},F=he=>{a(e,he)},K=he=>{const Ee=parseFloat(he);isNaN(Ee)||l(e,Ee)},U=he=>{c(e,{tpv_code:he.code,hex:he.hex,name:he.name}),m(!1)},V=he=>{d(e,{tpv_code:he.code,hex:he.hex,name:he.name}),(!q||q===0)&&u(e,Math.round(b*.05)),v(!1)},J=he=>{const Ee=parseFloat(he);isNaN(Ee)||Ee<0||u(e,Ee)},oe=()=>{d(e,null),u(e,0)},me=()=>{window.confirm("Delete this text? This action cannot be undone.")&&p(e)},je=()=>{h(e)};return o.jsxs("div",{className:"properties-panel",children:[o.jsxs("div",{className:"properties-panel__header",children:[o.jsx("h3",{children:"Text Properties"}),o.jsxs("div",{className:"properties-panel__court-info",children:[o.jsx("span",{className:"court-name",style:{fontFamily:x},children:y||"Text Label"}),o.jsx("span",{className:"court-standard",children:"T Text Element"})]})]}),o.jsx("div",{className:"properties-panel__content",children:o.jsxs("div",{className:"properties-section",children:[o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Text Content"}),o.jsx("input",{type:"text",value:y,onChange:he=>W(he.target.value),placeholder:"Enter text...",style:{width:"100%",padding:"0.5rem",border:"1px solid #e4e9f0",borderRadius:"6px",fontFamily:x,fontSize:"1rem"}})]}),o.jsx("div",{className:"properties-section__divider",style:{margin:"1rem 0"},children:o.jsx("span",{children:"Typography"})}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Font Family"}),o.jsx("select",{value:x,onChange:he=>pe(he.target.value),style:{width:"100%",padding:"0.5rem",border:"1px solid #e4e9f0",borderRadius:"6px",fontFamily:"inherit",fontSize:"0.875rem"},children:P.map(he=>o.jsx("option",{value:he.family,style:{fontFamily:he.family},children:he.name},he.name))})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Font Size"}),o.jsxs("div",{className:"property-input-row",children:[o.jsx("input",{type:"range",min:"100",max:"2000",step:"50",value:b,onChange:he=>G(he.target.value),className:"property-slider"}),o.jsxs("div",{className:"property-input-group property-input-group--compact",children:[o.jsx("input",{type:"number",value:b.toFixed(0),onChange:he=>G(he.target.value),min:"50",step:"50"}),o.jsx("span",{className:"property-unit",children:"mm"})]})]}),o.jsxs("div",{style:{fontSize:"0.7rem",color:"#64748b",marginTop:"0.25rem"},children:[" ",(b/1e3).toFixed(2),"m height"]})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Style"}),o.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[o.jsx("button",{onClick:Z,style:{flex:1,padding:"0.5rem",border:w==="bold"?"2px solid #3b82f6":"1px solid #e4e9f0",borderRadius:"6px",background:w==="bold"?"#eff6ff":"#fff",fontWeight:"bold",fontSize:"1rem",cursor:"pointer"},title:"Bold",children:"B"}),o.jsx("button",{onClick:ee,style:{flex:1,padding:"0.5rem",border:S==="italic"?"2px solid #3b82f6":"1px solid #e4e9f0",borderRadius:"6px",background:S==="italic"?"#eff6ff":"#fff",fontStyle:"italic",fontSize:"1rem",cursor:"pointer"},title:"Italic",children:"I"})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Alignment"}),o.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[o.jsx("button",{onClick:()=>F("left"),style:{flex:1,padding:"0.5rem",border:_==="left"?"2px solid #3b82f6":"1px solid #e4e9f0",borderRadius:"6px",background:_==="left"?"#eff6ff":"#fff",cursor:"pointer"},title:"Align Left",children:""}),o.jsx("button",{onClick:()=>F("center"),style:{flex:1,padding:"0.5rem",border:_==="center"?"2px solid #3b82f6":"1px solid #e4e9f0",borderRadius:"6px",background:_==="center"?"#eff6ff":"#fff",cursor:"pointer"},title:"Align Center",children:""}),o.jsx("button",{onClick:()=>F("right"),style:{flex:1,padding:"0.5rem",border:_==="right"?"2px solid #3b82f6":"1px solid #e4e9f0",borderRadius:"6px",background:_==="right"?"#eff6ff":"#fff",cursor:"pointer"},title:"Align Right",children:""})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Text Colour"}),o.jsxs("div",{className:"color-item",children:[o.jsxs("div",{className:"color-item__info",children:[o.jsx("span",{className:"color-item__name",children:(T==null?void 0:T.name)||"Select Colour"}),T&&o.jsx("span",{className:"color-item__code",children:T.tpv_code})]}),o.jsx("button",{className:"color-item__swatch",style:{backgroundColor:(T==null?void 0:T.hex)||"#1C1C1C"},onClick:()=>m(!0),title:(T==null?void 0:T.name)||"Select colour"})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Outline"}),O?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"color-item",children:[o.jsxs("div",{className:"color-item__info",children:[o.jsx("span",{className:"color-item__name",children:O.name}),o.jsx("span",{className:"color-item__code",children:O.tpv_code})]}),o.jsx("button",{className:"color-item__swatch",style:{backgroundColor:O.hex},onClick:()=>v(!0),title:O.name})]}),o.jsxs("div",{className:"property-input-row",style:{marginTop:"0.5rem"},children:[o.jsx("input",{type:"range",min:"1",max:Math.round(b*.2),step:"1",value:q||0,onChange:he=>J(he.target.value),className:"property-slider"}),o.jsxs("div",{className:"property-input-group property-input-group--compact",children:[o.jsx("input",{type:"number",value:Math.round(q||0),onChange:he=>J(he.target.value),min:"0",step:"1"}),o.jsx("span",{className:"property-unit",children:"mm"})]})]}),o.jsx("button",{onClick:oe,style:{marginTop:"0.5rem",padding:"0.25rem 0.5rem",fontSize:"0.75rem",background:"#fee2e2",border:"1px solid #fecaca",borderRadius:"4px",color:"#dc2626",cursor:"pointer"},children:"Remove Outline"})]}):o.jsx("button",{onClick:()=>v(!0),style:{width:"100%",padding:"0.5rem",background:"#f3f4f6",border:"1px dashed #d1d5db",borderRadius:"6px",fontSize:"0.875rem",color:"#6b7280",cursor:"pointer"},children:"+ Add Outline"})]}),o.jsx("div",{className:"properties-section__divider",style:{margin:"1rem 0"},children:o.jsx("span",{children:"Transform"})}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Position"}),o.jsxs("div",{className:"property-input-row",children:[o.jsxs("div",{className:"property-input-group",children:[o.jsx("span",{className:"property-label",children:"X"}),o.jsx("input",{type:"number",value:Math.round(k.x),onChange:he=>j("x",he.target.value),step:"100"}),o.jsx("span",{className:"property-unit",children:"mm"})]}),o.jsxs("div",{className:"property-input-group",children:[o.jsx("span",{className:"property-label",children:"Y"}),o.jsx("input",{type:"number",value:Math.round(k.y),onChange:he=>j("y",he.target.value),step:"100"}),o.jsx("span",{className:"property-unit",children:"mm"})]})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Rotation"}),o.jsxs("div",{className:"property-input-row",children:[o.jsx("input",{type:"range",min:"0",max:"360",value:E||0,onChange:he=>K(he.target.value),className:"property-slider"}),o.jsxs("div",{className:"property-input-group property-input-group--compact",children:[o.jsx("input",{type:"number",value:Math.round(E||0),onChange:he=>K(he.target.value),min:"0",max:"360"}),o.jsx("span",{className:"property-unit",children:""})]})]})]}),o.jsx("div",{className:"properties-section__divider",style:{margin:"1rem 0"},children:o.jsx("span",{children:"Actions"})}),o.jsx("div",{className:"property-group property-group--actions",children:o.jsx("button",{className:"btn-secondary",onClick:je,title:"Duplicate text (Ctrl+D)",style:{width:"100%",padding:"0.5rem",background:"#f3f4f6",border:"1px solid #e4e9f0",borderRadius:"6px",fontSize:"0.875rem",fontFamily:"inherit",cursor:"pointer",marginBottom:"0.5rem"},children:" Duplicate Text"})}),o.jsx("div",{className:"property-group property-group--actions",children:o.jsx("button",{className:"btn-delete",onClick:me,title:"Delete text (Delete key)",children:" Delete Text"})}),o.jsx("div",{className:"property-group",children:o.jsx("div",{className:"property-hint",style:{fontStyle:"normal",color:"#64748b",fontSize:"0.75rem",marginTop:"1rem"},children:" Tip: Double-click text on canvas to edit inline. Drag corners to change font size. Hold Shift while rotating to snap to 15 increments."})})]})}),f&&o.jsx("div",{className:"color-picker-modal",onClick:()=>m(!1),children:o.jsxs("div",{className:"color-picker-modal__content",onClick:he=>he.stopPropagation(),children:[o.jsxs("div",{className:"color-picker-modal__header",children:[o.jsx("h4",{children:"Select Text Colour"}),o.jsx("button",{onClick:()=>m(!1),children:""})]}),o.jsx("div",{className:"color-picker-grid",children:pn.map(he=>o.jsx("button",{className:"color-picker-swatch",style:{backgroundColor:he.hex},onClick:()=>U(he),title:`${he.code} - ${he.name}`,children:o.jsx("span",{className:"color-picker-swatch__code",children:he.code})},he.code))})]})}),g&&o.jsx("div",{className:"color-picker-modal",onClick:()=>v(!1),children:o.jsxs("div",{className:"color-picker-modal__content",onClick:he=>he.stopPropagation(),children:[o.jsxs("div",{className:"color-picker-modal__header",children:[o.jsx("h4",{children:"Select Outline Colour"}),o.jsx("button",{onClick:()=>v(!1),children:""})]}),o.jsx("div",{className:"color-picker-grid",children:pn.map(he=>o.jsx("button",{className:"color-picker-swatch",style:{backgroundColor:he.hex},onClick:()=>V(he),title:`${he.code} - ${he.name}`,children:o.jsx("span",{className:"color-picker-swatch__code",children:he.code})},he.code))})]})})]})}function Y5({zone:t,zoneId:e}){const{updateExclusionZonePosition:n,updateExclusionZoneDimensions:r,updateExclusionZoneRotation:s,updateExclusionZoneCornerRadius:i,removeExclusionZone:a,duplicateExclusionZone:l,addToHistory:c}=it(),{position:d,rotation:u,width_mm:p,height_mm:h,sides:f,cornerRadius:m,customName:g}=t,v=(T,O)=>{const q=parseFloat(O);isNaN(q)||n(e,{...d,[T]:q})},y=(T,O)=>{const q=parseFloat(O);isNaN(q)||q<500||(T==="width"?r(e,q,h):r(e,p,q),c())},x=T=>{const O=parseFloat(T);isNaN(O)||(s(e,O),c())},b=T=>{const O=parseFloat(T);isNaN(O)||i(e,O)},w=()=>{window.confirm("Delete this exclusion zone? This action cannot be undone.")&&a(e)},S=()=>{l(e)},_=p*h/1e6,k=g||"Exclusion Zone",E=f===4?"Rectangle":f>=32?"Circle":`${f}-sided`;return o.jsxs("div",{className:"properties-panel",children:[o.jsxs("div",{className:"properties-panel__header",children:[o.jsx("h3",{children:"Exclusion Zone"}),o.jsxs("div",{className:"properties-panel__court-info",children:[o.jsx("span",{className:"court-name",children:k}),o.jsx("span",{className:"court-standard",style:{background:"#f87171",color:"white"},children:"Excluded Area"})]})]}),o.jsx("div",{className:"properties-panel__content",children:o.jsxs("div",{className:"properties-section",children:[o.jsx("div",{className:"property-group",style:{background:"#fef2f2",padding:"0.75rem",borderRadius:"6px",marginBottom:"1rem",border:"1px solid #fecaca"},children:o.jsx("p",{style:{fontSize:"0.75rem",color:"#991b1b",margin:0},children:"This area represents a building, planter, or other obstacle. It is excluded from material calculations."})}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Dimensions"}),o.jsxs("div",{className:"property-input-row",children:[o.jsxs("div",{className:"property-input-group",children:[o.jsx("span",{className:"property-label",children:"W"}),o.jsx("input",{type:"number",value:Math.round(p),onChange:T=>y("width",T.target.value),step:"100",min:"500"}),o.jsx("span",{className:"property-unit",children:"mm"})]}),o.jsxs("div",{className:"property-input-group",children:[o.jsx("span",{className:"property-label",children:"H"}),o.jsx("input",{type:"number",value:Math.round(h),onChange:T=>y("height",T.target.value),step:"100",min:"500"}),o.jsx("span",{className:"property-unit",children:"mm"})]})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Position"}),o.jsxs("div",{className:"property-input-row",children:[o.jsxs("div",{className:"property-input-group",children:[o.jsx("span",{className:"property-label",children:"X"}),o.jsx("input",{type:"number",value:Math.round(d.x),onChange:T=>v("x",T.target.value),step:"100"}),o.jsx("span",{className:"property-unit",children:"mm"})]}),o.jsxs("div",{className:"property-input-group",children:[o.jsx("span",{className:"property-label",children:"Y"}),o.jsx("input",{type:"number",value:Math.round(d.y),onChange:T=>v("y",T.target.value),step:"100"}),o.jsx("span",{className:"property-unit",children:"mm"})]})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Rotation"}),o.jsxs("div",{className:"property-input-row",children:[o.jsx("input",{type:"range",min:"0",max:"360",value:u||0,onChange:T=>x(T.target.value),className:"property-slider"}),o.jsxs("div",{className:"property-input-group property-input-group--compact",children:[o.jsx("input",{type:"number",value:Math.round(u||0),onChange:T=>x(T.target.value),min:"0",max:"360"}),o.jsx("span",{className:"property-unit",children:""})]})]})]}),f===4&&o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Corner Radius"}),o.jsxs("div",{className:"property-input-row",children:[o.jsx("input",{type:"range",min:"0",max:"100",value:m||0,onChange:T=>b(T.target.value),className:"property-slider"}),o.jsxs("div",{className:"property-input-group property-input-group--compact",children:[o.jsx("input",{type:"number",value:Math.round(m||0),onChange:T=>b(T.target.value),min:"0",max:"100"}),o.jsx("span",{className:"property-unit",children:"%"})]})]})]}),o.jsx("div",{className:"properties-section__divider",style:{margin:"1rem 0"},children:o.jsx("span",{children:"Exclusion Info"})}),o.jsxs("div",{className:"property-group property-group--info",children:[o.jsx("label",{children:"Shape"}),o.jsx("div",{className:"property-info",children:o.jsx("span",{children:E})})]}),o.jsxs("div",{className:"property-group property-group--info",children:[o.jsx("label",{children:"Excluded Area"}),o.jsx("div",{className:"property-info",style:{color:"#dc2626"},children:o.jsxs("span",{children:[_.toFixed(2)," m"]})})]}),o.jsx("div",{className:"properties-section__divider",style:{margin:"1rem 0"},children:o.jsx("span",{children:"Actions"})}),o.jsx("div",{className:"property-group property-group--actions",children:o.jsx("button",{className:"btn-secondary",onClick:S,title:"Duplicate exclusion zone",style:{width:"100%",padding:"0.5rem",background:"#f3f4f6",border:"1px solid #e4e9f0",borderRadius:"6px",fontSize:"0.875rem",fontFamily:"inherit",cursor:"pointer",marginBottom:"0.5rem"},children:"Duplicate Zone"})}),o.jsx("div",{className:"property-group property-group--actions",children:o.jsx("button",{className:"btn-delete",onClick:w,title:"Delete exclusion zone",children:"Delete Zone"})}),o.jsx("div",{className:"property-group",children:o.jsx("div",{className:"property-hint",style:{fontStyle:"normal",color:"#64748b",fontSize:"0.75rem",marginTop:"1rem"},children:"Drag the zone on the canvas to reposition. Use handles to resize."})})]})})]})}function q5({group:t,groupId:e,shapes:n,isEditing:r,onEnterGroup:s,onExitGroup:i,onUngroup:a,onRegenerate:l,onDelete:c}){const d=t.compoundType?gd[t.compoundType]:null,u=t.customName||(d?d.name:"Group"),p=t.childIds.map(f=>n[f]).filter(Boolean),h=t.bounds||{width:0,height:0};return o.jsx("div",{className:"properties-panel properties-panel--group",children:o.jsxs("div",{className:"properties-panel__scroll-container",children:[o.jsxs("div",{className:"properties-panel__header",children:[o.jsxs("div",{className:"properties-panel__title-row",children:[o.jsx("span",{className:"properties-panel__icon",style:{color:"#9333ea"},children:(d==null?void 0:d.icon)||""}),o.jsx("h3",{className:"properties-panel__title",children:u})]}),o.jsxs("span",{className:"properties-panel__subtitle",children:[t.childIds.length," element",t.childIds.length!==1?"s":""]})]}),o.jsxs("div",{className:"properties-panel__content",children:[o.jsxs("div",{className:"property-section",children:[o.jsx("div",{className:"property-group",style:{marginBottom:"1rem"},children:r?o.jsx("button",{className:"property-btn property-btn--secondary property-btn--full",onClick:i,style:{borderColor:"#9333ea",color:"#9333ea"},children:" Exit Group Editing"}):o.jsx("button",{className:"property-btn property-btn--primary property-btn--full",onClick:s,style:{background:"#9333ea"},children:"Edit Group Elements"})}),r&&o.jsx("div",{className:"property-hint",style:{fontSize:"0.75rem",color:"#9333ea",marginBottom:"1rem"},children:"Click on individual elements to select and edit them"})]}),d&&o.jsxs("div",{className:"property-section",children:[o.jsx("h4",{className:"property-section__title",children:"Compound Type"}),o.jsx("div",{className:"property-group",children:o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.75rem",background:"rgba(147, 51, 234, 0.08)",borderRadius:"8px"},children:[o.jsx("span",{style:{fontSize:"1.5rem"},children:d.icon}),o.jsxs("div",{children:[o.jsx("div",{style:{fontWeight:"600",color:"#1e293b"},children:d.name}),o.jsx("div",{style:{fontSize:"0.75rem",color:"#64748b"},children:d.description})]})]})}),o.jsx("div",{className:"property-group",children:o.jsx("button",{className:"property-btn property-btn--secondary property-btn--full",onClick:l,title:"Generate a new random variation",children:" Generate New Shape"})})]}),o.jsxs("div",{className:"property-section",children:[o.jsx("h4",{className:"property-section__title",children:"Dimensions"}),o.jsxs("div",{className:"property-group",children:[o.jsxs("div",{className:"property-row",children:[o.jsx("label",{className:"property-label",children:"Width"}),o.jsxs("span",{className:"property-value",children:[(h.width/1e3).toFixed(2),"m"]})]}),o.jsxs("div",{className:"property-row",children:[o.jsx("label",{className:"property-label",children:"Height"}),o.jsxs("span",{className:"property-value",children:[(h.height/1e3).toFixed(2),"m"]})]})]})]}),o.jsxs("div",{className:"property-section",children:[o.jsxs("h4",{className:"property-section__title",children:["Elements (",p.length,")"]}),o.jsx("div",{className:"property-group",children:o.jsx("div",{style:{maxHeight:"150px",overflowY:"auto",borderRadius:"6px",border:"1px solid #e5e7eb"},children:p.map((f,m)=>o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0.75rem",borderBottom:m<p.length-1?"1px solid #f1f5f9":"none",fontSize:"0.8rem"},children:[o.jsx("span",{style:{color:"#9333ea"},children:f.shapeType==="blob"?"":""}),o.jsx("span",{style:{color:"#475569"},children:f.customName||`${f.blobStyle||f.shapeType} ${m+1}`}),o.jsxs("span",{style:{marginLeft:"auto",fontSize:"0.7rem",color:"#9ca3af"},children:[(f.width_mm/1e3).toFixed(1),"m"]})]},f.id))})})]}),o.jsxs("div",{className:"property-section",children:[o.jsx("h4",{className:"property-section__title",children:"Actions"}),o.jsxs("div",{className:"property-group",style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[o.jsx("button",{className:"property-btn property-btn--secondary property-btn--full",onClick:a,title:"Dissolve the group and make elements independent",children:" Ungroup Elements"}),o.jsx("button",{className:"property-btn property-btn--danger property-btn--full",onClick:()=>{confirm(`Delete "${u}" and all its elements?`)&&c()},title:"Delete group and all its elements",children:" Delete Group"})]})]}),o.jsx("div",{className:"property-group",children:o.jsx("div",{className:"property-hint",style:{fontStyle:"normal",color:"#64748b",fontSize:"0.75rem",marginTop:"1rem"},children:"Double-click a group on the canvas to enter edit mode. Press Escape to exit."})})]})]})})}function X5(){const{courts:t,tracks:e,motifs:n,shapes:r,texts:s,exclusionZones:i,groups:a,elementOrder:l,selectedCourtId:c,selectedTrackId:d,selectedMotifId:u,selectedShapeId:p,selectedTextId:h,selectedExclusionZoneId:f,selectedGroupId:m,editingGroupId:g,setElementOrder:v,selectCourt:y,selectTrack:x,selectMotif:b,selectShape:w,selectText:S,selectExclusionZone:_,selectGroup:k,deselectGroup:E,enterGroup:T,exitGroup:O,ungroup:q,deleteGroupWithChildren:P,bringToFront:W,sendToBack:j,duplicateCourt:G,duplicateTrack:pe,duplicateMotif:Z,duplicateShape:ee,duplicateText:F,removeCourt:K,removeTrack:U,removeMotif:V,removeShape:J,removeText:oe,removeExclusionZone:me,renameElement:je,toggleElementLock:he,toggleElementVisibility:Ee,addToHistory:Me}=it(),[We,Ie]=R.useState(null),[Je,Ue]=R.useState(null),[C,Q]=R.useState(null),[ce,L]=R.useState(null),[N,I]=R.useState(""),[H,X]=R.useState(new Set);R.useEffect(()=>{const ne=()=>Q(null);if(C)return document.addEventListener("click",ne),()=>document.removeEventListener("click",ne)},[C]);const z=[...l].reverse(),te=ne=>{var ge,He,mt;if(ne.startsWith("court-")){const _e=t[ne];return{type:"court",name:(_e==null?void 0:_e.customName)||((ge=_e==null?void 0:_e.template)==null?void 0:ge.name)||"Unknown Court",icon:"",sport:((He=_e==null?void 0:_e.template)==null?void 0:He.sport)||"",locked:(_e==null?void 0:_e.locked)||!1,visible:(_e==null?void 0:_e.visible)!==!1}}else if(ne.startsWith("track-")){const _e=e[ne];return{type:"track",name:(_e==null?void 0:_e.customName)||((mt=_e==null?void 0:_e.template)==null?void 0:mt.name)||"Unknown Track",icon:"",sport:"athletics",locked:(_e==null?void 0:_e.locked)||!1,visible:(_e==null?void 0:_e.visible)!==!1}}else if(ne.startsWith("motif-")){const _e=n[ne];return{type:"motif",name:(_e==null?void 0:_e.customName)||(_e==null?void 0:_e.sourceDesignName)||"Unknown Motif",icon:"",sport:"playground",locked:(_e==null?void 0:_e.locked)||!1,visible:(_e==null?void 0:_e.visible)!==!1}}else if(ne.startsWith("shape-")){const _e=r[ne];let vt="Shape",dt="";if((_e==null?void 0:_e.shapeType)==="blob")vt={organic:"Organic Blob",splashy:"Splashy Blob",cloudy:"Cloudy Blob",rocky:"Rocky Blob"}[_e.blobStyle]||"Blob",dt="";else if((_e==null?void 0:_e.shapeType)==="path")vt=_e.closed?"Custom Shape":"Path",dt="";else if(_e!=null&&_e.starMode)vt=`${_e.sides||5}-Point Star`,dt="";else if(_e!=null&&_e.sides){const Et=_e.sides;Et>=32?(vt="Circle",dt=""):Et===3?(vt="Triangle",dt=""):Et===4?(vt="Rectangle",dt=""):Et===5?(vt="Pentagon",dt=""):Et===6?(vt="Hexagon",dt=""):Et===8?(vt="Octagon",dt=""):(vt=`${Et}-gon`,dt="")}return{type:"shape",name:(_e==null?void 0:_e.customName)||vt,icon:dt,sport:"shape",locked:(_e==null?void 0:_e.locked)||!1,visible:(_e==null?void 0:_e.visible)!==!1}}else if(ne.startsWith("text-")){const _e=s[ne],vt=(_e==null?void 0:_e.content)||"Text Label",dt=vt.length>20?vt.substring(0,20)+"...":vt;return{type:"text",name:(_e==null?void 0:_e.customName)||dt,icon:"T",sport:"text",locked:(_e==null?void 0:_e.locked)||!1,visible:(_e==null?void 0:_e.visible)!==!1}}else if(ne.startsWith("exclusion-")){const _e=i[ne];return{type:"exclusion",name:(_e==null?void 0:_e.customName)||"Exclusion Zone",icon:"",sport:"exclusion",locked:(_e==null?void 0:_e.locked)||!1,visible:(_e==null?void 0:_e.visible)!==!1}}return{type:"unknown",name:"Unknown",icon:"",sport:"",locked:!1,visible:!0}},ye=ne=>ne===c||ne===d||ne===u||ne===p||ne===h||ne===f,Y=ne=>{ne.startsWith("court-")?y(ne):ne.startsWith("track-")?x(ne):ne.startsWith("motif-")?b(ne):ne.startsWith("shape-")?w(ne):ne.startsWith("text-")?S(ne):ne.startsWith("exclusion-")&&_(ne)},M=(ne,ge)=>{Ie(ge),ne.dataTransfer.effectAllowed="move",ne.dataTransfer.setData("text/plain",ge),setTimeout(()=>{ne.target.classList.add("layer-item--dragging")},0)},ie=ne=>{ne.target.classList.remove("layer-item--dragging"),Ie(null),Ue(null)},fe=(ne,ge)=>{ne.preventDefault(),ne.dataTransfer.dropEffect="move",ge!==We&&Ue(ge)},Se=()=>{Ue(null)},De=(ne,ge)=>{if(ne.preventDefault(),!We||We===ge){Ie(null),Ue(null);return}const He=[...l],mt=He.indexOf(We),_e=He.indexOf(ge);if(mt===-1||_e===-1)return;He.splice(mt,1);const vt=z.indexOf(We),dt=z.indexOf(ge);vt<dt,He.splice(_e,0,We),v(He),Me(),Ie(null),Ue(null)},ke=(ne,ge)=>{ne.stopPropagation(),W(ge),Q(null)},ae=(ne,ge)=>{ne.stopPropagation(),j(ge),Q(null)},ue=(ne,ge)=>{ne.stopPropagation(),ge.startsWith("court-")?G(ge):ge.startsWith("track-")?pe(ge):ge.startsWith("motif-")?Z(ge):ge.startsWith("shape-")?ee(ge):ge.startsWith("text-")&&F(ge),Q(null)},Ge=(ne,ge)=>{ne.stopPropagation();const He=te(ge);confirm(`Delete "${He.name}"?`)&&(ge.startsWith("court-")?K(ge):ge.startsWith("track-")?U(ge):ge.startsWith("motif-")?V(ge):ge.startsWith("shape-")?J(ge):ge.startsWith("text-")?oe(ge):ge.startsWith("exclusion-")&&me(ge)),Q(null)},Qe=(ne,ge)=>{ne.stopPropagation();const He=te(ge);L(ge),I(He.name),Q(null)},et=ne=>{N.trim()&&je(ne,N.trim()),L(null),I("")},ht=(ne,ge)=>{ne.key==="Enter"?et(ge):ne.key==="Escape"&&(L(null),I(""))},lt=(ne,ge)=>{ne.stopPropagation(),he(ge),Q(null)},Le=(ne,ge)=>{ne.stopPropagation(),Ee(ge),Q(null)},de=(ne,ge)=>{ne.stopPropagation(),Q(C===ge?null:ge)};return l.length===0?o.jsx("div",{className:"layers-panel layers-panel--empty",children:o.jsxs("div",{className:"layers-panel__empty-state",children:[o.jsx("span",{className:"layers-panel__empty-icon",children:""}),o.jsx("p",{children:"No elements yet"}),o.jsx("span",{className:"layers-panel__empty-hint",children:"Add courts, tracks, motifs, shapes, or text"})]})}):o.jsxs("div",{className:"layers-panel",children:[o.jsxs("div",{className:"layers-panel__header",children:[o.jsx("h4",{children:"Layers"}),o.jsx("span",{className:"layers-panel__count",children:l.length})]}),o.jsx("div",{className:"layers-panel__hint",children:"Drag to reorder layers. Top = front, bottom = back."}),o.jsx("div",{className:"layers-panel__list",children:z.map((ne,ge)=>{const He=te(ne),mt=ye(ne),_e=ne===Je,vt=ge===0,dt=ge===z.length-1,Et=ce===ne;return o.jsxs("div",{className:`layer-item ${mt?"layer-item--selected":""} ${_e?"layer-item--drag-over":""} ${He.locked?"layer-item--locked":""} ${He.visible?"":"layer-item--hidden"}`,draggable:!He.locked&&!Et,onDragStart:Xe=>M(Xe,ne),onDragEnd:ie,onDragOver:Xe=>fe(Xe,ne),onDragLeave:Se,onDrop:Xe=>De(Xe,ne),onClick:()=>!Et&&Y(ne),children:[o.jsx("span",{className:`layer-item__handle ${He.locked?"layer-item__handle--disabled":""}`,title:He.locked?"Locked":"Drag to reorder",children:He.locked?"":""}),Et?o.jsx("input",{type:"text",className:"layer-item__rename-input",value:N,onChange:Xe=>I(Xe.target.value),onBlur:()=>et(ne),onKeyDown:Xe=>ht(Xe,ne),autoFocus:!0,onClick:Xe=>Xe.stopPropagation()}):o.jsx("span",{className:`layer-item__name ${He.visible?"":"layer-item__name--hidden"}`,children:He.name}),o.jsx("div",{className:"layer-item__indicators",children:!He.visible&&o.jsx("span",{className:"layer-item__indicator",title:"Hidden",children:""})}),o.jsxs("div",{className:"layer-item__actions",children:[o.jsx("button",{className:"layer-item__menu-btn",onClick:Xe=>de(Xe,ne),title:"More actions",children:""}),C===ne&&o.jsxs("div",{className:"layer-item__menu",children:[o.jsx("button",{onClick:Xe=>ke(Xe,ne),disabled:vt,children:" Bring to Front"}),o.jsx("button",{onClick:Xe=>ae(Xe,ne),disabled:dt,children:" Send to Back"}),o.jsx("div",{className:"layer-item__menu-divider"}),o.jsx("button",{onClick:Xe=>ue(Xe,ne),children:" Duplicate"}),o.jsx("button",{onClick:Xe=>Qe(Xe,ne),children:" Rename"}),o.jsx("div",{className:"layer-item__menu-divider"}),o.jsx("button",{onClick:Xe=>lt(Xe,ne),children:He.locked?" Unlock":" Lock"}),o.jsx("button",{onClick:Xe=>Le(Xe,ne),children:He.visible?" Hide":" Show"}),o.jsx("div",{className:"layer-item__menu-divider"}),o.jsx("button",{onClick:Xe=>Ge(Xe,ne),className:"layer-item__menu-delete",children:" Delete"})]})]})]},ne)})}),Object.keys(a).length>0&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"layers-panel__section-divider",children:o.jsx("span",{children:"Groups"})}),o.jsx("div",{className:"layers-panel__list layers-panel__list--groups",children:Object.entries(a).map(([ne,ge])=>{const He=H.has(ne),mt=m===ne,_e=g===ne,vt=ge.customName||(ge.compoundType?`${ge.compoundType.charAt(0).toUpperCase()+ge.compoundType.slice(1)} Group`:"Group");return o.jsxs("div",{className:"layer-group",children:[o.jsxs("div",{className:`layer-item layer-item--group ${mt?"layer-item--selected":""} ${_e?"layer-item--editing":""}`,onClick:()=>k(ne),onDoubleClick:()=>T(ne),children:[o.jsx("button",{className:"layer-item__expand-btn",onClick:dt=>{dt.stopPropagation(),X(Et=>{const Xe=new Set(Et);return Xe.has(ne)?Xe.delete(ne):Xe.add(ne),Xe})},title:He?"Collapse":"Expand",children:He?"":""}),o.jsx("span",{className:"layer-item__handle layer-item__handle--group",children:ge.compoundType==="splash"?"":ge.compoundType==="cloud"?"":ge.compoundType==="flower"?"":ge.compoundType==="abstract"?"":""}),o.jsxs("span",{className:"layer-item__name",children:[vt,o.jsxs("span",{className:"layer-item__child-count",children:["(",ge.childIds.length,")"]})]}),_e&&o.jsx("span",{className:"layer-item__edit-indicator",title:"Editing group",children:""}),o.jsxs("div",{className:"layer-item__actions",children:[o.jsx("button",{className:"layer-item__menu-btn",onClick:dt=>de(dt,ne),title:"More actions",children:""}),C===ne&&o.jsxs("div",{className:"layer-item__menu",children:[o.jsx("button",{onClick:dt=>{dt.stopPropagation(),T(ne),Q(null)},children:" Edit Group"}),o.jsx("button",{onClick:dt=>{dt.stopPropagation(),q(ne),Q(null)},children:" Ungroup"}),o.jsx("div",{className:"layer-item__menu-divider"}),o.jsx("button",{onClick:dt=>{dt.stopPropagation(),confirm(`Delete group "${vt}" and all its contents?`)&&P(ne),Q(null)},className:"layer-item__menu-delete",children:" Delete Group"})]})]})]}),He&&o.jsx("div",{className:"layer-group__children",children:ge.childIds.map(dt=>{const Et=te(dt),Xe=dt===p||dt===u;return o.jsxs("div",{className:`layer-item layer-item--child ${Xe?"layer-item--selected":""}`,onClick:tn=>{tn.stopPropagation(),_e&&Y(dt)},children:[o.jsx("span",{className:"layer-item__indent"}),o.jsx("span",{className:"layer-item__handle layer-item__handle--disabled",children:Et.icon}),o.jsx("span",{className:`layer-item__name ${Et.visible?"":"layer-item__name--hidden"}`,children:Et.name})]},dt)})})]},ne)})}),g&&o.jsx("div",{className:"layers-panel__exit-group",children:o.jsx("button",{className:"layers-panel__exit-group-btn",onClick:()=>O(),children:" Exit Group Editing"})})]}),Object.keys(i).length>0&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"layers-panel__section-divider",children:o.jsx("span",{children:"Exclusion Zones"})}),o.jsx("div",{className:"layers-panel__list layers-panel__list--exclusions",children:Object.keys(i).map(ne=>{const ge=te(ne),He=ye(ne);return o.jsxs("div",{className:`layer-item layer-item--exclusion ${He?"layer-item--selected":""} ${ge.locked?"layer-item--locked":""} ${ge.visible?"":"layer-item--hidden"}`,onClick:()=>Y(ne),children:[o.jsx("span",{className:"layer-item__handle layer-item__handle--disabled",children:ge.icon}),o.jsx("span",{className:`layer-item__name ${ge.visible?"":"layer-item__name--hidden"}`,children:ge.name}),o.jsx("div",{className:"layer-item__indicators",children:!ge.visible&&o.jsx("span",{className:"layer-item__indicator",title:"Hidden",children:""})}),o.jsxs("div",{className:"layer-item__actions",children:[o.jsx("button",{className:"layer-item__menu-btn",onClick:mt=>de(mt,ne),title:"More actions",children:""}),C===ne&&o.jsxs("div",{className:"layer-item__menu",children:[o.jsx("button",{onClick:mt=>Qe(mt,ne),children:" Rename"}),o.jsx("div",{className:"layer-item__menu-divider"}),o.jsx("button",{onClick:mt=>lt(mt,ne),children:ge.locked?" Unlock":" Lock"}),o.jsx("button",{onClick:mt=>Le(mt,ne),children:ge.visible?" Hide":" Show"}),o.jsx("div",{className:"layer-item__menu-divider"}),o.jsx("button",{onClick:mt=>Ge(mt,ne),className:"layer-item__menu-delete",children:" Delete"})]})]})]},ne)})})]}),o.jsx("div",{className:"layers-panel__footer",children:o.jsx("span",{className:"layers-panel__shortcut-hint",children:"Tip: Use [ and ] keys to reorder selected element"})})]})}async function b1(){var n,r;const t=await an.auth.getSession(),e=(r=(n=t==null?void 0:t.data)==null?void 0:n.session)==null?void 0:r.access_token;if(!e)throw new Error("Not authenticated");return{"Content-Type":"application/json",Authorization:`Bearer ${e}`}}async function w1(t){const e=await b1(),n=await fetch("/api/projects/create",{method:"POST",headers:e,body:JSON.stringify(t)});if(!n.ok){const r=await n.json();throw new Error(r.error||"Unable to create project. Please check your connection and try again.")}return n.json()}async function If(){const t=await b1(),e=await fetch("/api/projects/list",{method:"GET",headers:t});if(!e.ok){const n=await e.json();throw new Error(n.error||"Unable to load your projects. Please refresh the page and try again.")}return e.json()}function Z5(t,e={}){var n,r;return{type:"sports_surface",version:"1.0",name:e.name||t.name||"Untitled Design",description:e.description||t.description||"",tags:e.tags||t.tags||[],surface:t.surface,courts:K5(t.courts),tracks:J5(t.tracks),motifs:Q5(t.motifs),exclusionZones:eT(t.exclusionZones),shapes:tT(t.shapes),texts:nT(t.texts),elementOrder:t.elementOrder||[],customMarkings:t.customMarkings||[],backgroundZones:t.backgroundZones||[],dimensions:{width_mm:((n=t.surface)==null?void 0:n.width_mm)||5e4,length_mm:((r=t.surface)==null?void 0:r.length_mm)||5e4}}}function K5(t){return t?Object.fromEntries(Object.entries(t).map(([e,n])=>[e,{id:n.id,templateId:n.templateId,template:n.template,position:n.position,rotation:n.rotation,scale:n.scale,lineColorOverrides:n.lineColorOverrides||{},zoneColorOverrides:n.zoneColorOverrides||{},courtSurfaceColor:n.courtSurfaceColor}])):{}}function J5(t){return t?Object.fromEntries(Object.entries(t).map(([e,n])=>[e,{id:n.id,templateId:n.templateId,template:n.template,position:n.position,rotation:n.rotation,parameters:n.parameters,trackSurfaceColor:n.trackSurfaceColor,laneSurfaceColors:n.laneSurfaceColors||[],trackLineColor:n.trackLineColor}])):{}}function Q5(t){return t?Object.fromEntries(Object.entries(t).map(([e,n])=>[e,{id:n.id,type:"motif",sourceDesignId:n.sourceDesignId,sourceDesignName:n.sourceDesignName,sourceThumbnailUrl:n.sourceThumbnailUrl,svgContent:n.svgContent,originalWidth_mm:n.originalWidth_mm,originalHeight_mm:n.originalHeight_mm,position:n.position,rotation:n.rotation,scale:n.scale}])):{}}function eT(t){return t?Object.fromEntries(Object.entries(t).map(([e,n])=>[e,{id:n.id,type:"exclusion",shapeType:n.shapeType,sides:n.sides,width_mm:n.width_mm,height_mm:n.height_mm,position:n.position,rotation:n.rotation,cornerRadius:n.cornerRadius,locked:n.locked,visible:n.visible,customName:n.customName,controlPoints:n.controlPoints}])):{}}function tT(t){return t?Object.fromEntries(Object.entries(t).map(([e,n])=>[e,{id:n.id,shapeType:n.shapeType,controlPoints:n.controlPoints,width_mm:n.width_mm,height_mm:n.height_mm,position:n.position,rotation:n.rotation,fillColor:n.fillColor,strokeEnabled:n.strokeEnabled,strokeColor:n.strokeColor,strokeWidth_mm:n.strokeWidth_mm,sides:n.sides,cornerRadius:n.cornerRadius,closed:n.closed,smooth:n.smooth,editPointsVisible:n.editPointsVisible}])):{}}function nT(t){return t?Object.fromEntries(Object.entries(t).map(([e,n])=>[e,{id:n.id,content:n.content,fontFamily:n.fontFamily,fontSize_mm:n.fontSize_mm,fontWeight:n.fontWeight,fontStyle:n.fontStyle,textAlign:n.textAlign,position:n.position,rotation:n.rotation,fillColor:n.fillColor,strokeColor:n.strokeColor,strokeWidth_mm:n.strokeWidth_mm}])):{}}function rT(t){var r,s;const e=[];return t.surface||e.push("Surface configuration is required"),(!((r=t.surface)!=null&&r.width_mm)||!((s=t.surface)!=null&&s.length_mm))&&e.push("Surface dimensions are required"),t.courts&&Object.keys(t.courts).length>0||t.tracks&&Object.keys(t.tracks).length>0||t.motifs&&Object.keys(t.motifs).length>0||e.push("Add at least one court, track, or motif to save"),{valid:e.length===0,errors:e}}async function sT(t,e=400){return new Promise((n,r)=>{try{const s=t.cloneNode(!0);s.querySelectorAll(".court-canvas__court--selected, .transform-handles").forEach(m=>{m.classList.remove("court-canvas__court--selected")}),s.querySelectorAll(".transform-handles").forEach(m=>m.remove());const i=t.getAttribute("viewBox").split(" ").map(Number),a=i[2],l=i[3];let c,d;a>l?(c=e,d=Math.round(l/a*e)):(d=e,c=Math.round(a/l*e)),s.setAttribute("width",c),s.setAttribute("height",d);const u=new XMLSerializer().serializeToString(s),p=new Blob([u],{type:"image/svg+xml;charset=utf-8"}),h=URL.createObjectURL(p),f=new Image;f.onload=()=>{const m=document.createElement("canvas");m.width=c,m.height=d;const g=m.getContext("2d");g.fillStyle="#ffffff",g.fillRect(0,0,c,d),g.drawImage(f,0,0,c,d),m.toBlob(v=>{URL.revokeObjectURL(h),n(v)},"image/png",.9)},f.onerror=m=>{URL.revokeObjectURL(h),r(new Error("Failed to load SVG for thumbnail"))},f.src=h}catch(s){r(s)}})}async function iT(t){const n=`thumbnails/sports/${`sports-${Date.now()}-${Math.random().toString(36).substr(2,9)}.png`}`,{data:r,error:s}=await an.storage.from("tpv-studio-uploads").upload(n,t,{cacheControl:"3600",contentType:"image/png",upsert:!1});if(s)throw s;const{data:{publicUrl:i}}=an.storage.from("tpv-studio-uploads").getPublicUrl(n);return i}function oT({existingDesignId:t=null,initialName:e="",svgRef:n=null,onClose:r,onSaved:s}){const i=it(K=>K.exportDesignData),[a,l]=R.useState(e),[c,d]=R.useState(""),[u,p]=R.useState(""),[h,f]=R.useState(""),[m,g]=R.useState(!1),[v,y]=R.useState([]),[x,b]=R.useState(!1),[w,S]=R.useState(""),[_,k]=R.useState("#1a365d"),[E,T]=R.useState(!1),[O,q]=R.useState(!1),[P,W]=R.useState(!1),[j,G]=R.useState(null);R.useEffect(()=>{pe()},[]);const pe=async()=>{try{const{projects:K}=await If();y(K)}catch(K){console.error("Failed to load projects:",K),G("Failed to load projects")}},Z=async()=>{if(!w.trim()){G("Project name is required");return}W(!0),G(null);try{const{project:K}=await w1({name:w.trim(),color:_});y([K,...v]),p(K.id),b(!1),S(""),k("#1a365d")}catch(K){console.error("Failed to create project:",K),G(K.message)}finally{W(!1)}},ee=async(K=!1)=>{if(!a.trim()){G("Design name is required");return}const U=i(),V=rT(U);if(!V.valid){G(V.errors.join(", "));return}K?q(!0):T(!0),G(null);try{let J=null;if(n!=null&&n.current)try{console.log("[SPORTS-SAVE] Generating thumbnail...");const he=await sT(n.current);console.log("[SPORTS-SAVE] Uploading thumbnail..."),J=await iT(he),console.log("[SPORTS-SAVE] Thumbnail uploaded:",J)}catch(he){console.warn("[SPORTS-SAVE] Thumbnail generation failed, continuing without:",he)}const oe=Z5(U,{name:a.trim(),description:c.trim()||"",tags:h.split(",").map(he=>he.trim()).filter(he=>he)});console.log("[SPORTS-SAVE] Serialized design data:",oe);const me={name:a.trim(),description:c.trim()||null,project_id:u||null,tags:h.split(",").map(he=>he.trim()).filter(he=>he),is_public:m,design_data:oe,thumbnail_url:J};t&&!K&&(me.id=t);const je=await $f(me);s&&s(je,a.trim()),r()}catch(J){console.error("Failed to save design:",J),G(J.message)}finally{T(!1),q(!1)}},F=["#1a365d","#ff6b35","#4a90e2","#50c878","#9b59b6","#e74c3c"];return o.jsx("div",{className:"modal-overlay",onClick:r,children:o.jsxs("div",{className:"modal-content save-design-modal",onClick:K=>K.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsx("h2",{children:t?"Update Design":"Save Design"}),o.jsx("button",{onClick:r,className:"close-button",children:""})]}),o.jsxs("div",{className:"modal-body",children:[j&&o.jsx("div",{className:"error-message",children:j}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"design-name",children:"Design Name *"}),o.jsx("input",{id:"design-name",type:"text",value:a,onChange:K=>l(K.target.value),placeholder:"e.g., Multi-Sport Court Design",autoFocus:!0,disabled:E||O})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"design-description",children:"Description"}),o.jsx("textarea",{id:"design-description",value:c,onChange:K=>d(K.target.value),placeholder:"Optional notes about this sports surface design...",rows:3,disabled:E||O})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"design-project",children:"Project"}),x?o.jsxs("div",{className:"new-project-form",children:[o.jsxs("div",{className:"input-row",children:[o.jsx("input",{type:"text",value:w,onChange:K=>S(K.target.value),placeholder:"Project name...",disabled:P}),o.jsx("div",{className:"color-picker-inline",children:F.map(K=>o.jsx("button",{type:"button",className:`color-swatch ${_===K?"active":""}`,style:{backgroundColor:K},onClick:()=>k(K),disabled:P},K))})]}),o.jsxs("div",{className:"button-row",children:[o.jsx("button",{type:"button",onClick:Z,className:"btn-primary btn-small",disabled:P,children:P?"Creating...":"Create"}),o.jsx("button",{type:"button",onClick:()=>b(!1),className:"btn-secondary btn-small",disabled:P,children:"Cancel"})]})]}):o.jsxs("div",{className:"project-selector",children:[o.jsxs("select",{id:"design-project",value:u,onChange:K=>p(K.target.value),disabled:E||O,children:[o.jsx("option",{value:"",children:"No Project"}),v.map(K=>o.jsxs("option",{value:K.id,children:[K.name," (",K.design_count," designs)"]},K.id))]}),o.jsx("button",{type:"button",onClick:()=>b(!0),className:"btn-secondary btn-small",disabled:E||O,children:"+ New Project"})]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"design-tags",children:"Tags"}),o.jsx("input",{id:"design-tags",type:"text",value:h,onChange:K=>f(K.target.value),placeholder:"e.g., tennis, multi-sport, school (comma-separated)",disabled:E||O}),o.jsx("small",{className:"help-text",children:"Separate tags with commas"})]}),o.jsx("div",{className:"form-group checkbox-group",children:o.jsxs("label",{children:[o.jsx("input",{type:"checkbox",checked:m,onChange:K=>g(K.target.checked),disabled:E||O}),o.jsx("span",{children:"Make this design public (shareable link)"})]})})]}),o.jsxs("div",{className:"modal-footer",children:[o.jsx("button",{onClick:r,className:"btn-secondary",disabled:E||O,children:"Cancel"}),t&&o.jsx("button",{onClick:()=>ee(!0),className:"btn-secondary",disabled:E||O,children:O?"Saving...":"Save as New"}),o.jsx("button",{onClick:()=>ee(!1),className:"btn-primary",disabled:E||O,children:E?"Saving...":t?"Update":"Save Design"})]})]})})}function zf(t,e){var p,h,f,m;if(!t)throw new Error("SVG element not found");const n=t.cloneNode(!0);n.querySelectorAll('.court-canvas__selection-outline, .transform-handles, [class*="selection"], [class*="handle"]').forEach(g=>g.remove()),n.querySelectorAll("[stroke-dasharray]").forEach(g=>{g.getAttribute("stroke-dasharray")&&g.remove()});const i=document.createElementNS("http://www.w3.org/2000/svg","title");i.textContent=(e==null?void 0:e.name)||"Sports Surface Design",n.insertBefore(i,n.firstChild);const a=document.createElementNS("http://www.w3.org/2000/svg","desc");a.textContent=`Generated by TPV Designer. Dimensions: ${(((p=e==null?void 0:e.surface)==null?void 0:p.width_mm)/1e3).toFixed(1)}m  ${(((h=e==null?void 0:e.surface)==null?void 0:h.length_mm)/1e3).toFixed(1)}m`,n.insertBefore(a,n.firstChild.nextSibling),n.setAttribute("xmlns","http://www.w3.org/2000/svg"),n.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");const l=((f=e==null?void 0:e.surface)==null?void 0:f.width_mm)||5e4,c=((m=e==null?void 0:e.surface)==null?void 0:m.length_mm)||5e4;n.setAttribute("width",`${l}mm`),n.setAttribute("height",`${c}mm`),n.setAttribute("data-tpv-studio","1.0"),n.setAttribute("data-design-type","sports_surface");let u=new XMLSerializer().serializeToString(n);return u=`<?xml version="1.0" encoding="UTF-8"?>
`+u,u}function aT(t,e="sports-surface.svg"){const n=new Blob([t],{type:"image/svg+xml"}),r=URL.createObjectURL(n),s=document.createElement("a");s.href=r,s.download=e,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(r)}async function lT(t,e,n="sports-surface.png",r=2){return new Promise((s,i)=>{try{const a=zf(t,e),l=document.createElement("canvas"),c=l.getContext("2d"),d=t.getAttribute("viewBox");let u=1200,p=1200;if(d){const[,,g,v]=d.split(" ").map(Number),y=2400,x=v/g;u=Math.min(g/10,y),p=u*x}l.width=u*r,l.height=p*r;const h=new Image,f=new Blob([a],{type:"image/svg+xml;charset=utf-8"}),m=URL.createObjectURL(f);h.onload=()=>{c.fillStyle="#ffffff",c.fillRect(0,0,l.width,l.height),c.drawImage(h,0,0,l.width,l.height),l.toBlob(g=>{if(!g){i(new Error("Failed to create PNG blob"));return}const v=URL.createObjectURL(g),y=document.createElement("a");y.href=v,y.download=n,document.body.appendChild(y),y.click(),document.body.removeChild(y),URL.revokeObjectURL(m),URL.revokeObjectURL(v),s()},"image/png",.95)},h.onerror=g=>{URL.revokeObjectURL(m),i(new Error("Failed to load SVG for PNG conversion"))},h.src=m}catch(a){i(a)}})}function Ta(t,e){const n=(t||"sports-surface").toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"").substring(0,50),r=new Date().toISOString().split("T")[0];return`${n}_${r}.${e}`}function bc(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var _1={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(t,e){(function(n){t.exports=n()})(function(){return function n(r,s,i){function a(d,u){if(!s[d]){if(!r[d]){var p=typeof bc=="function"&&bc;if(!u&&p)return p(d,!0);if(l)return l(d,!0);var h=new Error("Cannot find module '"+d+"'");throw h.code="MODULE_NOT_FOUND",h}var f=s[d]={exports:{}};r[d][0].call(f.exports,function(m){var g=r[d][1][m];return a(g||m)},f,f.exports,n,r,s,i)}return s[d].exports}for(var l=typeof bc=="function"&&bc,c=0;c<i.length;c++)a(i[c]);return a}({1:[function(n,r,s){var i=n("./utils"),a=n("./support"),l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";s.encode=function(c){for(var d,u,p,h,f,m,g,v=[],y=0,x=c.length,b=x,w=i.getTypeOf(c)!=="string";y<c.length;)b=x-y,p=w?(d=c[y++],u=y<x?c[y++]:0,y<x?c[y++]:0):(d=c.charCodeAt(y++),u=y<x?c.charCodeAt(y++):0,y<x?c.charCodeAt(y++):0),h=d>>2,f=(3&d)<<4|u>>4,m=1<b?(15&u)<<2|p>>6:64,g=2<b?63&p:64,v.push(l.charAt(h)+l.charAt(f)+l.charAt(m)+l.charAt(g));return v.join("")},s.decode=function(c){var d,u,p,h,f,m,g=0,v=0,y="data:";if(c.substr(0,y.length)===y)throw new Error("Invalid base64 input, it looks like a data url.");var x,b=3*(c=c.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(c.charAt(c.length-1)===l.charAt(64)&&b--,c.charAt(c.length-2)===l.charAt(64)&&b--,b%1!=0)throw new Error("Invalid base64 input, bad content length.");for(x=a.uint8array?new Uint8Array(0|b):new Array(0|b);g<c.length;)d=l.indexOf(c.charAt(g++))<<2|(h=l.indexOf(c.charAt(g++)))>>4,u=(15&h)<<4|(f=l.indexOf(c.charAt(g++)))>>2,p=(3&f)<<6|(m=l.indexOf(c.charAt(g++))),x[v++]=d,f!==64&&(x[v++]=u),m!==64&&(x[v++]=p);return x}},{"./support":30,"./utils":32}],2:[function(n,r,s){var i=n("./external"),a=n("./stream/DataWorker"),l=n("./stream/Crc32Probe"),c=n("./stream/DataLengthProbe");function d(u,p,h,f,m){this.compressedSize=u,this.uncompressedSize=p,this.crc32=h,this.compression=f,this.compressedContent=m}d.prototype={getContentWorker:function(){var u=new a(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new c("data_length")),p=this;return u.on("end",function(){if(this.streamInfo.data_length!==p.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),u},getCompressedWorker:function(){return new a(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},d.createWorkerFrom=function(u,p,h){return u.pipe(new l).pipe(new c("uncompressedSize")).pipe(p.compressWorker(h)).pipe(new c("compressedSize")).withStreamInfo("compression",p)},r.exports=d},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(n,r,s){var i=n("./stream/GenericWorker");s.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},s.DEFLATE=n("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(n,r,s){var i=n("./utils"),a=function(){for(var l,c=[],d=0;d<256;d++){l=d;for(var u=0;u<8;u++)l=1&l?3988292384^l>>>1:l>>>1;c[d]=l}return c}();r.exports=function(l,c){return l!==void 0&&l.length?i.getTypeOf(l)!=="string"?function(d,u,p,h){var f=a,m=h+p;d^=-1;for(var g=h;g<m;g++)d=d>>>8^f[255&(d^u[g])];return-1^d}(0|c,l,l.length,0):function(d,u,p,h){var f=a,m=h+p;d^=-1;for(var g=h;g<m;g++)d=d>>>8^f[255&(d^u.charCodeAt(g))];return-1^d}(0|c,l,l.length,0):0}},{"./utils":32}],5:[function(n,r,s){s.base64=!1,s.binary=!1,s.dir=!1,s.createFolders=!0,s.date=null,s.compression=null,s.compressionOptions=null,s.comment=null,s.unixPermissions=null,s.dosPermissions=null},{}],6:[function(n,r,s){var i=null;i=typeof Promise<"u"?Promise:n("lie"),r.exports={Promise:i}},{lie:37}],7:[function(n,r,s){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=n("pako"),l=n("./utils"),c=n("./stream/GenericWorker"),d=i?"uint8array":"array";function u(p,h){c.call(this,"FlateWorker/"+p),this._pako=null,this._pakoAction=p,this._pakoOptions=h,this.meta={}}s.magic="\b\0",l.inherits(u,c),u.prototype.processChunk=function(p){this.meta=p.meta,this._pako===null&&this._createPako(),this._pako.push(l.transformTo(d,p.data),!1)},u.prototype.flush=function(){c.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},u.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this._pako=null},u.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var p=this;this._pako.onData=function(h){p.push({data:h,meta:p.meta})}},s.compressWorker=function(p){return new u("Deflate",p)},s.uncompressWorker=function(){return new u("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(n,r,s){function i(f,m){var g,v="";for(g=0;g<m;g++)v+=String.fromCharCode(255&f),f>>>=8;return v}function a(f,m,g,v,y,x){var b,w,S=f.file,_=f.compression,k=x!==d.utf8encode,E=l.transformTo("string",x(S.name)),T=l.transformTo("string",d.utf8encode(S.name)),O=S.comment,q=l.transformTo("string",x(O)),P=l.transformTo("string",d.utf8encode(O)),W=T.length!==S.name.length,j=P.length!==O.length,G="",pe="",Z="",ee=S.dir,F=S.date,K={crc32:0,compressedSize:0,uncompressedSize:0};m&&!g||(K.crc32=f.crc32,K.compressedSize=f.compressedSize,K.uncompressedSize=f.uncompressedSize);var U=0;m&&(U|=8),k||!W&&!j||(U|=2048);var V=0,J=0;ee&&(V|=16),y==="UNIX"?(J=798,V|=function(me,je){var he=me;return me||(he=je?16893:33204),(65535&he)<<16}(S.unixPermissions,ee)):(J=20,V|=function(me){return 63&(me||0)}(S.dosPermissions)),b=F.getUTCHours(),b<<=6,b|=F.getUTCMinutes(),b<<=5,b|=F.getUTCSeconds()/2,w=F.getUTCFullYear()-1980,w<<=4,w|=F.getUTCMonth()+1,w<<=5,w|=F.getUTCDate(),W&&(pe=i(1,1)+i(u(E),4)+T,G+="up"+i(pe.length,2)+pe),j&&(Z=i(1,1)+i(u(q),4)+P,G+="uc"+i(Z.length,2)+Z);var oe="";return oe+=`
\0`,oe+=i(U,2),oe+=_.magic,oe+=i(b,2),oe+=i(w,2),oe+=i(K.crc32,4),oe+=i(K.compressedSize,4),oe+=i(K.uncompressedSize,4),oe+=i(E.length,2),oe+=i(G.length,2),{fileRecord:p.LOCAL_FILE_HEADER+oe+E+G,dirRecord:p.CENTRAL_FILE_HEADER+i(J,2)+oe+i(q.length,2)+"\0\0\0\0"+i(V,4)+i(v,4)+E+G+q}}var l=n("../utils"),c=n("../stream/GenericWorker"),d=n("../utf8"),u=n("../crc32"),p=n("../signature");function h(f,m,g,v){c.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=m,this.zipPlatform=g,this.encodeFileName=v,this.streamFiles=f,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}l.inherits(h,c),h.prototype.push=function(f){var m=f.meta.percent||0,g=this.entriesCount,v=this._sources.length;this.accumulate?this.contentBuffer.push(f):(this.bytesWritten+=f.data.length,c.prototype.push.call(this,{data:f.data,meta:{currentFile:this.currentFile,percent:g?(m+100*(g-v-1))/g:100}}))},h.prototype.openedSource=function(f){this.currentSourceOffset=this.bytesWritten,this.currentFile=f.file.name;var m=this.streamFiles&&!f.file.dir;if(m){var g=a(f,m,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:g.fileRecord,meta:{percent:0}})}else this.accumulate=!0},h.prototype.closedSource=function(f){this.accumulate=!1;var m=this.streamFiles&&!f.file.dir,g=a(f,m,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(g.dirRecord),m)this.push({data:function(v){return p.DATA_DESCRIPTOR+i(v.crc32,4)+i(v.compressedSize,4)+i(v.uncompressedSize,4)}(f),meta:{percent:100}});else for(this.push({data:g.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},h.prototype.flush=function(){for(var f=this.bytesWritten,m=0;m<this.dirRecords.length;m++)this.push({data:this.dirRecords[m],meta:{percent:100}});var g=this.bytesWritten-f,v=function(y,x,b,w,S){var _=l.transformTo("string",S(w));return p.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(y,2)+i(y,2)+i(x,4)+i(b,4)+i(_.length,2)+_}(this.dirRecords.length,g,f,this.zipComment,this.encodeFileName);this.push({data:v,meta:{percent:100}})},h.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},h.prototype.registerPrevious=function(f){this._sources.push(f);var m=this;return f.on("data",function(g){m.processChunk(g)}),f.on("end",function(){m.closedSource(m.previous.streamInfo),m._sources.length?m.prepareNextSource():m.end()}),f.on("error",function(g){m.error(g)}),this},h.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},h.prototype.error=function(f){var m=this._sources;if(!c.prototype.error.call(this,f))return!1;for(var g=0;g<m.length;g++)try{m[g].error(f)}catch{}return!0},h.prototype.lock=function(){c.prototype.lock.call(this);for(var f=this._sources,m=0;m<f.length;m++)f[m].lock()},r.exports=h},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(n,r,s){var i=n("../compressions"),a=n("./ZipFileWorker");s.generateWorker=function(l,c,d){var u=new a(c.streamFiles,d,c.platform,c.encodeFileName),p=0;try{l.forEach(function(h,f){p++;var m=function(x,b){var w=x||b,S=i[w];if(!S)throw new Error(w+" is not a valid compression method !");return S}(f.options.compression,c.compression),g=f.options.compressionOptions||c.compressionOptions||{},v=f.dir,y=f.date;f._compressWorker(m,g).withStreamInfo("file",{name:h,dir:v,date:y,comment:f.comment||"",unixPermissions:f.unixPermissions,dosPermissions:f.dosPermissions}).pipe(u)}),u.entriesCount=p}catch(h){u.error(h)}return u}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(n,r,s){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new i;for(var l in this)typeof this[l]!="function"&&(a[l]=this[l]);return a}}(i.prototype=n("./object")).loadAsync=n("./load"),i.support=n("./support"),i.defaults=n("./defaults"),i.version="3.10.1",i.loadAsync=function(a,l){return new i().loadAsync(a,l)},i.external=n("./external"),r.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(n,r,s){var i=n("./utils"),a=n("./external"),l=n("./utf8"),c=n("./zipEntries"),d=n("./stream/Crc32Probe"),u=n("./nodejsUtils");function p(h){return new a.Promise(function(f,m){var g=h.decompressed.getContentWorker().pipe(new d);g.on("error",function(v){m(v)}).on("end",function(){g.streamInfo.crc32!==h.decompressed.crc32?m(new Error("Corrupted zip : CRC32 mismatch")):f()}).resume()})}r.exports=function(h,f){var m=this;return f=i.extend(f||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:l.utf8decode}),u.isNode&&u.isStream(h)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",h,!0,f.optimizedBinaryString,f.base64).then(function(g){var v=new c(f);return v.load(g),v}).then(function(g){var v=[a.Promise.resolve(g)],y=g.files;if(f.checkCRC32)for(var x=0;x<y.length;x++)v.push(p(y[x]));return a.Promise.all(v)}).then(function(g){for(var v=g.shift(),y=v.files,x=0;x<y.length;x++){var b=y[x],w=b.fileNameStr,S=i.resolve(b.fileNameStr);m.file(S,b.decompressed,{binary:!0,optimizedBinaryString:!0,date:b.date,dir:b.dir,comment:b.fileCommentStr.length?b.fileCommentStr:null,unixPermissions:b.unixPermissions,dosPermissions:b.dosPermissions,createFolders:f.createFolders}),b.dir||(m.file(S).unsafeOriginalName=w)}return v.zipComment.length&&(m.comment=v.zipComment),m})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(n,r,s){var i=n("../utils"),a=n("../stream/GenericWorker");function l(c,d){a.call(this,"Nodejs stream input adapter for "+c),this._upstreamEnded=!1,this._bindStream(d)}i.inherits(l,a),l.prototype._bindStream=function(c){var d=this;(this._stream=c).pause(),c.on("data",function(u){d.push({data:u,meta:{percent:0}})}).on("error",function(u){d.isPaused?this.generatedError=u:d.error(u)}).on("end",function(){d.isPaused?d._upstreamEnded=!0:d.end()})},l.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},l.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},r.exports=l},{"../stream/GenericWorker":28,"../utils":32}],13:[function(n,r,s){var i=n("readable-stream").Readable;function a(l,c,d){i.call(this,c),this._helper=l;var u=this;l.on("data",function(p,h){u.push(p)||u._helper.pause(),d&&d(h)}).on("error",function(p){u.emit("error",p)}).on("end",function(){u.push(null)})}n("../utils").inherits(a,i),a.prototype._read=function(){this._helper.resume()},r.exports=a},{"../utils":32,"readable-stream":16}],14:[function(n,r,s){r.exports={isNode:typeof Buffer<"u",newBufferFrom:function(i,a){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(i,a);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new Buffer(i,a)},allocBuffer:function(i){if(Buffer.alloc)return Buffer.alloc(i);var a=new Buffer(i);return a.fill(0),a},isBuffer:function(i){return Buffer.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(n,r,s){function i(S,_,k){var E,T=l.getTypeOf(_),O=l.extend(k||{},u);O.date=O.date||new Date,O.compression!==null&&(O.compression=O.compression.toUpperCase()),typeof O.unixPermissions=="string"&&(O.unixPermissions=parseInt(O.unixPermissions,8)),O.unixPermissions&&16384&O.unixPermissions&&(O.dir=!0),O.dosPermissions&&16&O.dosPermissions&&(O.dir=!0),O.dir&&(S=y(S)),O.createFolders&&(E=v(S))&&x.call(this,E,!0);var q=T==="string"&&O.binary===!1&&O.base64===!1;k&&k.binary!==void 0||(O.binary=!q),(_ instanceof p&&_.uncompressedSize===0||O.dir||!_||_.length===0)&&(O.base64=!1,O.binary=!0,_="",O.compression="STORE",T="string");var P=null;P=_ instanceof p||_ instanceof c?_:m.isNode&&m.isStream(_)?new g(S,_):l.prepareContent(S,_,O.binary,O.optimizedBinaryString,O.base64);var W=new h(S,P,O);this.files[S]=W}var a=n("./utf8"),l=n("./utils"),c=n("./stream/GenericWorker"),d=n("./stream/StreamHelper"),u=n("./defaults"),p=n("./compressedObject"),h=n("./zipObject"),f=n("./generate"),m=n("./nodejsUtils"),g=n("./nodejs/NodejsStreamInputAdapter"),v=function(S){S.slice(-1)==="/"&&(S=S.substring(0,S.length-1));var _=S.lastIndexOf("/");return 0<_?S.substring(0,_):""},y=function(S){return S.slice(-1)!=="/"&&(S+="/"),S},x=function(S,_){return _=_!==void 0?_:u.createFolders,S=y(S),this.files[S]||i.call(this,S,null,{dir:!0,createFolders:_}),this.files[S]};function b(S){return Object.prototype.toString.call(S)==="[object RegExp]"}var w={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(S){var _,k,E;for(_ in this.files)E=this.files[_],(k=_.slice(this.root.length,_.length))&&_.slice(0,this.root.length)===this.root&&S(k,E)},filter:function(S){var _=[];return this.forEach(function(k,E){S(k,E)&&_.push(E)}),_},file:function(S,_,k){if(arguments.length!==1)return S=this.root+S,i.call(this,S,_,k),this;if(b(S)){var E=S;return this.filter(function(O,q){return!q.dir&&E.test(O)})}var T=this.files[this.root+S];return T&&!T.dir?T:null},folder:function(S){if(!S)return this;if(b(S))return this.filter(function(T,O){return O.dir&&S.test(T)});var _=this.root+S,k=x.call(this,_),E=this.clone();return E.root=k.name,E},remove:function(S){S=this.root+S;var _=this.files[S];if(_||(S.slice(-1)!=="/"&&(S+="/"),_=this.files[S]),_&&!_.dir)delete this.files[S];else for(var k=this.filter(function(T,O){return O.name.slice(0,S.length)===S}),E=0;E<k.length;E++)delete this.files[k[E].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(S){var _,k={};try{if((k=l.extend(S||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=k.type.toLowerCase(),k.compression=k.compression.toUpperCase(),k.type==="binarystring"&&(k.type="string"),!k.type)throw new Error("No output type specified.");l.checkSupport(k.type),k.platform!=="darwin"&&k.platform!=="freebsd"&&k.platform!=="linux"&&k.platform!=="sunos"||(k.platform="UNIX"),k.platform==="win32"&&(k.platform="DOS");var E=k.comment||this.comment||"";_=f.generateWorker(this,k,E)}catch(T){(_=new c("error")).error(T)}return new d(_,k.type||"string",k.mimeType)},generateAsync:function(S,_){return this.generateInternalStream(S).accumulate(_)},generateNodeStream:function(S,_){return(S=S||{}).type||(S.type="nodebuffer"),this.generateInternalStream(S).toNodejsStream(_)}};r.exports=w},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(n,r,s){r.exports=n("stream")},{stream:void 0}],17:[function(n,r,s){var i=n("./DataReader");function a(l){i.call(this,l);for(var c=0;c<this.data.length;c++)l[c]=255&l[c]}n("../utils").inherits(a,i),a.prototype.byteAt=function(l){return this.data[this.zero+l]},a.prototype.lastIndexOfSignature=function(l){for(var c=l.charCodeAt(0),d=l.charCodeAt(1),u=l.charCodeAt(2),p=l.charCodeAt(3),h=this.length-4;0<=h;--h)if(this.data[h]===c&&this.data[h+1]===d&&this.data[h+2]===u&&this.data[h+3]===p)return h-this.zero;return-1},a.prototype.readAndCheckSignature=function(l){var c=l.charCodeAt(0),d=l.charCodeAt(1),u=l.charCodeAt(2),p=l.charCodeAt(3),h=this.readData(4);return c===h[0]&&d===h[1]&&u===h[2]&&p===h[3]},a.prototype.readData=function(l){if(this.checkOffset(l),l===0)return[];var c=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},r.exports=a},{"../utils":32,"./DataReader":18}],18:[function(n,r,s){var i=n("../utils");function a(l){this.data=l,this.length=l.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(l){this.checkIndex(this.index+l)},checkIndex:function(l){if(this.length<this.zero+l||l<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+l+"). Corrupted zip ?")},setIndex:function(l){this.checkIndex(l),this.index=l},skip:function(l){this.setIndex(this.index+l)},byteAt:function(){},readInt:function(l){var c,d=0;for(this.checkOffset(l),c=this.index+l-1;c>=this.index;c--)d=(d<<8)+this.byteAt(c);return this.index+=l,d},readString:function(l){return i.transformTo("string",this.readData(l))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var l=this.readInt(4);return new Date(Date.UTC(1980+(l>>25&127),(l>>21&15)-1,l>>16&31,l>>11&31,l>>5&63,(31&l)<<1))}},r.exports=a},{"../utils":32}],19:[function(n,r,s){var i=n("./Uint8ArrayReader");function a(l){i.call(this,l)}n("../utils").inherits(a,i),a.prototype.readData=function(l){this.checkOffset(l);var c=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},r.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(n,r,s){var i=n("./DataReader");function a(l){i.call(this,l)}n("../utils").inherits(a,i),a.prototype.byteAt=function(l){return this.data.charCodeAt(this.zero+l)},a.prototype.lastIndexOfSignature=function(l){return this.data.lastIndexOf(l)-this.zero},a.prototype.readAndCheckSignature=function(l){return l===this.readData(4)},a.prototype.readData=function(l){this.checkOffset(l);var c=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},r.exports=a},{"../utils":32,"./DataReader":18}],21:[function(n,r,s){var i=n("./ArrayReader");function a(l){i.call(this,l)}n("../utils").inherits(a,i),a.prototype.readData=function(l){if(this.checkOffset(l),l===0)return new Uint8Array(0);var c=this.data.subarray(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},r.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(n,r,s){var i=n("../utils"),a=n("../support"),l=n("./ArrayReader"),c=n("./StringReader"),d=n("./NodeBufferReader"),u=n("./Uint8ArrayReader");r.exports=function(p){var h=i.getTypeOf(p);return i.checkSupport(h),h!=="string"||a.uint8array?h==="nodebuffer"?new d(p):a.uint8array?new u(i.transformTo("uint8array",p)):new l(i.transformTo("array",p)):new c(p)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(n,r,s){s.LOCAL_FILE_HEADER="PK",s.CENTRAL_FILE_HEADER="PK",s.CENTRAL_DIRECTORY_END="PK",s.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",s.ZIP64_CENTRAL_DIRECTORY_END="PK",s.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(n,r,s){var i=n("./GenericWorker"),a=n("../utils");function l(c){i.call(this,"ConvertWorker to "+c),this.destType=c}a.inherits(l,i),l.prototype.processChunk=function(c){this.push({data:a.transformTo(this.destType,c.data),meta:c.meta})},r.exports=l},{"../utils":32,"./GenericWorker":28}],25:[function(n,r,s){var i=n("./GenericWorker"),a=n("../crc32");function l(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n("../utils").inherits(l,i),l.prototype.processChunk=function(c){this.streamInfo.crc32=a(c.data,this.streamInfo.crc32||0),this.push(c)},r.exports=l},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(n,r,s){var i=n("../utils"),a=n("./GenericWorker");function l(c){a.call(this,"DataLengthProbe for "+c),this.propName=c,this.withStreamInfo(c,0)}i.inherits(l,a),l.prototype.processChunk=function(c){if(c){var d=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=d+c.data.length}a.prototype.processChunk.call(this,c)},r.exports=l},{"../utils":32,"./GenericWorker":28}],27:[function(n,r,s){var i=n("../utils"),a=n("./GenericWorker");function l(c){a.call(this,"DataWorker");var d=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,c.then(function(u){d.dataIsReady=!0,d.data=u,d.max=u&&u.length||0,d.type=i.getTypeOf(u),d.isPaused||d._tickAndRepeat()},function(u){d.error(u)})}i.inherits(l,a),l.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},l.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},l.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},l.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var c=null,d=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":c=this.data.substring(this.index,d);break;case"uint8array":c=this.data.subarray(this.index,d);break;case"array":case"nodebuffer":c=this.data.slice(this.index,d)}return this.index=d,this.push({data:c,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=l},{"../utils":32,"./GenericWorker":28}],28:[function(n,r,s){function i(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return!this.isFinished&&(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,l){return this._listeners[a].push(l),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,l){if(this._listeners[a])for(var c=0;c<this._listeners[a].length;c++)this._listeners[a][c].call(this,l)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var l=this;return a.on("data",function(c){l.processChunk(c)}),a.on("end",function(){l.end()}),a.on("error",function(c){l.error(c)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var a=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,l){return this.extraStreamInfo[a]=l,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},r.exports=i},{}],29:[function(n,r,s){var i=n("../utils"),a=n("./ConvertWorker"),l=n("./GenericWorker"),c=n("../base64"),d=n("../support"),u=n("../external"),p=null;if(d.nodestream)try{p=n("../nodejs/NodejsStreamOutputAdapter")}catch{}function h(m,g){return new u.Promise(function(v,y){var x=[],b=m._internalType,w=m._outputType,S=m._mimeType;m.on("data",function(_,k){x.push(_),g&&g(k)}).on("error",function(_){x=[],y(_)}).on("end",function(){try{var _=function(k,E,T){switch(k){case"blob":return i.newBlob(i.transformTo("arraybuffer",E),T);case"base64":return c.encode(E);default:return i.transformTo(k,E)}}(w,function(k,E){var T,O=0,q=null,P=0;for(T=0;T<E.length;T++)P+=E[T].length;switch(k){case"string":return E.join("");case"array":return Array.prototype.concat.apply([],E);case"uint8array":for(q=new Uint8Array(P),T=0;T<E.length;T++)q.set(E[T],O),O+=E[T].length;return q;case"nodebuffer":return Buffer.concat(E);default:throw new Error("concat : unsupported type '"+k+"'")}}(b,x),S);v(_)}catch(k){y(k)}x=[]}).resume()})}function f(m,g,v){var y=g;switch(g){case"blob":case"arraybuffer":y="uint8array";break;case"base64":y="string"}try{this._internalType=y,this._outputType=g,this._mimeType=v,i.checkSupport(y),this._worker=m.pipe(new a(y)),m.lock()}catch(x){this._worker=new l("error"),this._worker.error(x)}}f.prototype={accumulate:function(m){return h(this,m)},on:function(m,g){var v=this;return m==="data"?this._worker.on(m,function(y){g.call(v,y.data,y.meta)}):this._worker.on(m,function(){i.delay(g,arguments,v)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(m){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new p(this,{objectMode:this._outputType!=="nodebuffer"},m)}},r.exports=f},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(n,r,s){if(s.base64=!0,s.array=!0,s.string=!0,s.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",s.nodebuffer=typeof Buffer<"u",s.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")s.blob=!1;else{var i=new ArrayBuffer(0);try{s.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(i),s.blob=a.getBlob("application/zip").size===0}catch{s.blob=!1}}}try{s.nodestream=!!n("readable-stream").Readable}catch{s.nodestream=!1}},{"readable-stream":16}],31:[function(n,r,s){for(var i=n("./utils"),a=n("./support"),l=n("./nodejsUtils"),c=n("./stream/GenericWorker"),d=new Array(256),u=0;u<256;u++)d[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;d[254]=d[254]=1;function p(){c.call(this,"utf-8 decode"),this.leftOver=null}function h(){c.call(this,"utf-8 encode")}s.utf8encode=function(f){return a.nodebuffer?l.newBufferFrom(f,"utf-8"):function(m){var g,v,y,x,b,w=m.length,S=0;for(x=0;x<w;x++)(64512&(v=m.charCodeAt(x)))==55296&&x+1<w&&(64512&(y=m.charCodeAt(x+1)))==56320&&(v=65536+(v-55296<<10)+(y-56320),x++),S+=v<128?1:v<2048?2:v<65536?3:4;for(g=a.uint8array?new Uint8Array(S):new Array(S),x=b=0;b<S;x++)(64512&(v=m.charCodeAt(x)))==55296&&x+1<w&&(64512&(y=m.charCodeAt(x+1)))==56320&&(v=65536+(v-55296<<10)+(y-56320),x++),v<128?g[b++]=v:(v<2048?g[b++]=192|v>>>6:(v<65536?g[b++]=224|v>>>12:(g[b++]=240|v>>>18,g[b++]=128|v>>>12&63),g[b++]=128|v>>>6&63),g[b++]=128|63&v);return g}(f)},s.utf8decode=function(f){return a.nodebuffer?i.transformTo("nodebuffer",f).toString("utf-8"):function(m){var g,v,y,x,b=m.length,w=new Array(2*b);for(g=v=0;g<b;)if((y=m[g++])<128)w[v++]=y;else if(4<(x=d[y]))w[v++]=65533,g+=x-1;else{for(y&=x===2?31:x===3?15:7;1<x&&g<b;)y=y<<6|63&m[g++],x--;1<x?w[v++]=65533:y<65536?w[v++]=y:(y-=65536,w[v++]=55296|y>>10&1023,w[v++]=56320|1023&y)}return w.length!==v&&(w.subarray?w=w.subarray(0,v):w.length=v),i.applyFromCharCode(w)}(f=i.transformTo(a.uint8array?"uint8array":"array",f))},i.inherits(p,c),p.prototype.processChunk=function(f){var m=i.transformTo(a.uint8array?"uint8array":"array",f.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var g=m;(m=new Uint8Array(g.length+this.leftOver.length)).set(this.leftOver,0),m.set(g,this.leftOver.length)}else m=this.leftOver.concat(m);this.leftOver=null}var v=function(x,b){var w;for((b=b||x.length)>x.length&&(b=x.length),w=b-1;0<=w&&(192&x[w])==128;)w--;return w<0||w===0?b:w+d[x[w]]>b?w:b}(m),y=m;v!==m.length&&(a.uint8array?(y=m.subarray(0,v),this.leftOver=m.subarray(v,m.length)):(y=m.slice(0,v),this.leftOver=m.slice(v,m.length))),this.push({data:s.utf8decode(y),meta:f.meta})},p.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=p,i.inherits(h,c),h.prototype.processChunk=function(f){this.push({data:s.utf8encode(f.data),meta:f.meta})},s.Utf8EncodeWorker=h},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(n,r,s){var i=n("./support"),a=n("./base64"),l=n("./nodejsUtils"),c=n("./external");function d(g){return g}function u(g,v){for(var y=0;y<g.length;++y)v[y]=255&g.charCodeAt(y);return v}n("setimmediate"),s.newBlob=function(g,v){s.checkSupport("blob");try{return new Blob([g],{type:v})}catch{try{var y=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return y.append(g),y.getBlob(v)}catch{throw new Error("Bug : can't construct the Blob.")}}};var p={stringifyByChunk:function(g,v,y){var x=[],b=0,w=g.length;if(w<=y)return String.fromCharCode.apply(null,g);for(;b<w;)v==="array"||v==="nodebuffer"?x.push(String.fromCharCode.apply(null,g.slice(b,Math.min(b+y,w)))):x.push(String.fromCharCode.apply(null,g.subarray(b,Math.min(b+y,w)))),b+=y;return x.join("")},stringifyByChar:function(g){for(var v="",y=0;y<g.length;y++)v+=String.fromCharCode(g[y]);return v},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,l.allocBuffer(1)).length===1}catch{return!1}}()}};function h(g){var v=65536,y=s.getTypeOf(g),x=!0;if(y==="uint8array"?x=p.applyCanBeUsed.uint8array:y==="nodebuffer"&&(x=p.applyCanBeUsed.nodebuffer),x)for(;1<v;)try{return p.stringifyByChunk(g,y,v)}catch{v=Math.floor(v/2)}return p.stringifyByChar(g)}function f(g,v){for(var y=0;y<g.length;y++)v[y]=g[y];return v}s.applyFromCharCode=h;var m={};m.string={string:d,array:function(g){return u(g,new Array(g.length))},arraybuffer:function(g){return m.string.uint8array(g).buffer},uint8array:function(g){return u(g,new Uint8Array(g.length))},nodebuffer:function(g){return u(g,l.allocBuffer(g.length))}},m.array={string:h,array:d,arraybuffer:function(g){return new Uint8Array(g).buffer},uint8array:function(g){return new Uint8Array(g)},nodebuffer:function(g){return l.newBufferFrom(g)}},m.arraybuffer={string:function(g){return h(new Uint8Array(g))},array:function(g){return f(new Uint8Array(g),new Array(g.byteLength))},arraybuffer:d,uint8array:function(g){return new Uint8Array(g)},nodebuffer:function(g){return l.newBufferFrom(new Uint8Array(g))}},m.uint8array={string:h,array:function(g){return f(g,new Array(g.length))},arraybuffer:function(g){return g.buffer},uint8array:d,nodebuffer:function(g){return l.newBufferFrom(g)}},m.nodebuffer={string:h,array:function(g){return f(g,new Array(g.length))},arraybuffer:function(g){return m.nodebuffer.uint8array(g).buffer},uint8array:function(g){return f(g,new Uint8Array(g.length))},nodebuffer:d},s.transformTo=function(g,v){if(v=v||"",!g)return v;s.checkSupport(g);var y=s.getTypeOf(v);return m[y][g](v)},s.resolve=function(g){for(var v=g.split("/"),y=[],x=0;x<v.length;x++){var b=v[x];b==="."||b===""&&x!==0&&x!==v.length-1||(b===".."?y.pop():y.push(b))}return y.join("/")},s.getTypeOf=function(g){return typeof g=="string"?"string":Object.prototype.toString.call(g)==="[object Array]"?"array":i.nodebuffer&&l.isBuffer(g)?"nodebuffer":i.uint8array&&g instanceof Uint8Array?"uint8array":i.arraybuffer&&g instanceof ArrayBuffer?"arraybuffer":void 0},s.checkSupport=function(g){if(!i[g.toLowerCase()])throw new Error(g+" is not supported by this platform")},s.MAX_VALUE_16BITS=65535,s.MAX_VALUE_32BITS=-1,s.pretty=function(g){var v,y,x="";for(y=0;y<(g||"").length;y++)x+="\\x"+((v=g.charCodeAt(y))<16?"0":"")+v.toString(16).toUpperCase();return x},s.delay=function(g,v,y){setImmediate(function(){g.apply(y||null,v||[])})},s.inherits=function(g,v){function y(){}y.prototype=v.prototype,g.prototype=new y},s.extend=function(){var g,v,y={};for(g=0;g<arguments.length;g++)for(v in arguments[g])Object.prototype.hasOwnProperty.call(arguments[g],v)&&y[v]===void 0&&(y[v]=arguments[g][v]);return y},s.prepareContent=function(g,v,y,x,b){return c.Promise.resolve(v).then(function(w){return i.blob&&(w instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(w))!==-1)&&typeof FileReader<"u"?new c.Promise(function(S,_){var k=new FileReader;k.onload=function(E){S(E.target.result)},k.onerror=function(E){_(E.target.error)},k.readAsArrayBuffer(w)}):w}).then(function(w){var S=s.getTypeOf(w);return S?(S==="arraybuffer"?w=s.transformTo("uint8array",w):S==="string"&&(b?w=a.decode(w):y&&x!==!0&&(w=function(_){return u(_,i.uint8array?new Uint8Array(_.length):new Array(_.length))}(w))),w):c.Promise.reject(new Error("Can't read the data of '"+g+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(n,r,s){var i=n("./reader/readerFor"),a=n("./utils"),l=n("./signature"),c=n("./zipEntry"),d=n("./support");function u(p){this.files=[],this.loadOptions=p}u.prototype={checkSignature:function(p){if(!this.reader.readAndCheckSignature(p)){this.reader.index-=4;var h=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(h)+", expected "+a.pretty(p)+")")}},isSignature:function(p,h){var f=this.reader.index;this.reader.setIndex(p);var m=this.reader.readString(4)===h;return this.reader.setIndex(f),m},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var p=this.reader.readData(this.zipCommentLength),h=d.uint8array?"uint8array":"array",f=a.transformTo(h,p);this.zipComment=this.loadOptions.decodeFileName(f)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var p,h,f,m=this.zip64EndOfCentralSize-44;0<m;)p=this.reader.readInt(2),h=this.reader.readInt(4),f=this.reader.readData(h),this.zip64ExtensibleData[p]={id:p,length:h,value:f}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var p,h;for(p=0;p<this.files.length;p++)h=this.files[p],this.reader.setIndex(h.localHeaderOffset),this.checkSignature(l.LOCAL_FILE_HEADER),h.readLocalPart(this.reader),h.handleUTF8(),h.processAttributes()},readCentralDir:function(){var p;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(l.CENTRAL_FILE_HEADER);)(p=new c({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(p);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var p=this.reader.lastIndexOfSignature(l.CENTRAL_DIRECTORY_END);if(p<0)throw this.isSignature(0,l.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(p);var h=p;if(this.checkSignature(l.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(p=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(p),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,l.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var f=this.centralDirOffset+this.centralDirSize;this.zip64&&(f+=20,f+=12+this.zip64EndOfCentralSize);var m=h-f;if(0<m)this.isSignature(h,l.CENTRAL_FILE_HEADER)||(this.reader.zero=m);else if(m<0)throw new Error("Corrupted zip: missing "+Math.abs(m)+" bytes.")},prepareReader:function(p){this.reader=i(p)},load:function(p){this.prepareReader(p),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=u},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(n,r,s){var i=n("./reader/readerFor"),a=n("./utils"),l=n("./compressedObject"),c=n("./crc32"),d=n("./utf8"),u=n("./compressions"),p=n("./support");function h(f,m){this.options=f,this.loadOptions=m}h.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(f){var m,g;if(f.skip(22),this.fileNameLength=f.readInt(2),g=f.readInt(2),this.fileName=f.readData(this.fileNameLength),f.skip(g),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((m=function(v){for(var y in u)if(Object.prototype.hasOwnProperty.call(u,y)&&u[y].magic===v)return u[y];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new l(this.compressedSize,this.uncompressedSize,this.crc32,m,f.readData(this.compressedSize))},readCentralPart:function(f){this.versionMadeBy=f.readInt(2),f.skip(2),this.bitFlag=f.readInt(2),this.compressionMethod=f.readString(2),this.date=f.readDate(),this.crc32=f.readInt(4),this.compressedSize=f.readInt(4),this.uncompressedSize=f.readInt(4);var m=f.readInt(2);if(this.extraFieldsLength=f.readInt(2),this.fileCommentLength=f.readInt(2),this.diskNumberStart=f.readInt(2),this.internalFileAttributes=f.readInt(2),this.externalFileAttributes=f.readInt(4),this.localHeaderOffset=f.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");f.skip(m),this.readExtraFields(f),this.parseZIP64ExtraField(f),this.fileComment=f.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var f=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),f==0&&(this.dosPermissions=63&this.externalFileAttributes),f==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var f=i(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=f.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=f.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=f.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=f.readInt(4))}},readExtraFields:function(f){var m,g,v,y=f.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});f.index+4<y;)m=f.readInt(2),g=f.readInt(2),v=f.readData(g),this.extraFields[m]={id:m,length:g,value:v};f.setIndex(y)},handleUTF8:function(){var f=p.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=d.utf8decode(this.fileName),this.fileCommentStr=d.utf8decode(this.fileComment);else{var m=this.findExtraFieldUnicodePath();if(m!==null)this.fileNameStr=m;else{var g=a.transformTo(f,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(g)}var v=this.findExtraFieldUnicodeComment();if(v!==null)this.fileCommentStr=v;else{var y=a.transformTo(f,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(y)}}},findExtraFieldUnicodePath:function(){var f=this.extraFields[28789];if(f){var m=i(f.value);return m.readInt(1)!==1||c(this.fileName)!==m.readInt(4)?null:d.utf8decode(m.readData(f.length-5))}return null},findExtraFieldUnicodeComment:function(){var f=this.extraFields[25461];if(f){var m=i(f.value);return m.readInt(1)!==1||c(this.fileComment)!==m.readInt(4)?null:d.utf8decode(m.readData(f.length-5))}return null}},r.exports=h},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(n,r,s){function i(m,g,v){this.name=m,this.dir=v.dir,this.date=v.date,this.comment=v.comment,this.unixPermissions=v.unixPermissions,this.dosPermissions=v.dosPermissions,this._data=g,this._dataBinary=v.binary,this.options={compression:v.compression,compressionOptions:v.compressionOptions}}var a=n("./stream/StreamHelper"),l=n("./stream/DataWorker"),c=n("./utf8"),d=n("./compressedObject"),u=n("./stream/GenericWorker");i.prototype={internalStream:function(m){var g=null,v="string";try{if(!m)throw new Error("No output type specified.");var y=(v=m.toLowerCase())==="string"||v==="text";v!=="binarystring"&&v!=="text"||(v="string"),g=this._decompressWorker();var x=!this._dataBinary;x&&!y&&(g=g.pipe(new c.Utf8EncodeWorker)),!x&&y&&(g=g.pipe(new c.Utf8DecodeWorker))}catch(b){(g=new u("error")).error(b)}return new a(g,v,"")},async:function(m,g){return this.internalStream(m).accumulate(g)},nodeStream:function(m,g){return this.internalStream(m||"nodebuffer").toNodejsStream(g)},_compressWorker:function(m,g){if(this._data instanceof d&&this._data.compression.magic===m.magic)return this._data.getCompressedWorker();var v=this._decompressWorker();return this._dataBinary||(v=v.pipe(new c.Utf8EncodeWorker)),d.createWorkerFrom(v,m,g)},_decompressWorker:function(){return this._data instanceof d?this._data.getContentWorker():this._data instanceof u?this._data:new l(this._data)}};for(var p=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],h=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},f=0;f<p.length;f++)i.prototype[p[f]]=h;r.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(n,r,s){(function(i){var a,l,c=i.MutationObserver||i.WebKitMutationObserver;if(c){var d=0,u=new c(m),p=i.document.createTextNode("");u.observe(p,{characterData:!0}),a=function(){p.data=d=++d%2}}else if(i.setImmediate||i.MessageChannel===void 0)a="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var g=i.document.createElement("script");g.onreadystatechange=function(){m(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},i.document.documentElement.appendChild(g)}:function(){setTimeout(m,0)};else{var h=new i.MessageChannel;h.port1.onmessage=m,a=function(){h.port2.postMessage(0)}}var f=[];function m(){var g,v;l=!0;for(var y=f.length;y;){for(v=f,f=[],g=-1;++g<y;)v[g]();y=f.length}l=!1}r.exports=function(g){f.push(g)!==1||l||a()}}).call(this,typeof As<"u"?As:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(n,r,s){var i=n("immediate");function a(){}var l={},c=["REJECTED"],d=["FULFILLED"],u=["PENDING"];function p(y){if(typeof y!="function")throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,y!==a&&g(this,y)}function h(y,x,b){this.promise=y,typeof x=="function"&&(this.onFulfilled=x,this.callFulfilled=this.otherCallFulfilled),typeof b=="function"&&(this.onRejected=b,this.callRejected=this.otherCallRejected)}function f(y,x,b){i(function(){var w;try{w=x(b)}catch(S){return l.reject(y,S)}w===y?l.reject(y,new TypeError("Cannot resolve promise with itself")):l.resolve(y,w)})}function m(y){var x=y&&y.then;if(y&&(typeof y=="object"||typeof y=="function")&&typeof x=="function")return function(){x.apply(y,arguments)}}function g(y,x){var b=!1;function w(k){b||(b=!0,l.reject(y,k))}function S(k){b||(b=!0,l.resolve(y,k))}var _=v(function(){x(S,w)});_.status==="error"&&w(_.value)}function v(y,x){var b={};try{b.value=y(x),b.status="success"}catch(w){b.status="error",b.value=w}return b}(r.exports=p).prototype.finally=function(y){if(typeof y!="function")return this;var x=this.constructor;return this.then(function(b){return x.resolve(y()).then(function(){return b})},function(b){return x.resolve(y()).then(function(){throw b})})},p.prototype.catch=function(y){return this.then(null,y)},p.prototype.then=function(y,x){if(typeof y!="function"&&this.state===d||typeof x!="function"&&this.state===c)return this;var b=new this.constructor(a);return this.state!==u?f(b,this.state===d?y:x,this.outcome):this.queue.push(new h(b,y,x)),b},h.prototype.callFulfilled=function(y){l.resolve(this.promise,y)},h.prototype.otherCallFulfilled=function(y){f(this.promise,this.onFulfilled,y)},h.prototype.callRejected=function(y){l.reject(this.promise,y)},h.prototype.otherCallRejected=function(y){f(this.promise,this.onRejected,y)},l.resolve=function(y,x){var b=v(m,x);if(b.status==="error")return l.reject(y,b.value);var w=b.value;if(w)g(y,w);else{y.state=d,y.outcome=x;for(var S=-1,_=y.queue.length;++S<_;)y.queue[S].callFulfilled(x)}return y},l.reject=function(y,x){y.state=c,y.outcome=x;for(var b=-1,w=y.queue.length;++b<w;)y.queue[b].callRejected(x);return y},p.resolve=function(y){return y instanceof this?y:l.resolve(new this(a),y)},p.reject=function(y){var x=new this(a);return l.reject(x,y)},p.all=function(y){var x=this;if(Object.prototype.toString.call(y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var b=y.length,w=!1;if(!b)return this.resolve([]);for(var S=new Array(b),_=0,k=-1,E=new this(a);++k<b;)T(y[k],k);return E;function T(O,q){x.resolve(O).then(function(P){S[q]=P,++_!==b||w||(w=!0,l.resolve(E,S))},function(P){w||(w=!0,l.reject(E,P))})}},p.race=function(y){var x=this;if(Object.prototype.toString.call(y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var b=y.length,w=!1;if(!b)return this.resolve([]);for(var S=-1,_=new this(a);++S<b;)k=y[S],x.resolve(k).then(function(E){w||(w=!0,l.resolve(_,E))},function(E){w||(w=!0,l.reject(_,E))});var k;return _}},{immediate:36}],38:[function(n,r,s){var i={};(0,n("./lib/utils/common").assign)(i,n("./lib/deflate"),n("./lib/inflate"),n("./lib/zlib/constants")),r.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(n,r,s){var i=n("./zlib/deflate"),a=n("./utils/common"),l=n("./utils/strings"),c=n("./zlib/messages"),d=n("./zlib/zstream"),u=Object.prototype.toString,p=0,h=-1,f=0,m=8;function g(y){if(!(this instanceof g))return new g(y);this.options=a.assign({level:h,method:m,chunkSize:16384,windowBits:15,memLevel:8,strategy:f,to:""},y||{});var x=this.options;x.raw&&0<x.windowBits?x.windowBits=-x.windowBits:x.gzip&&0<x.windowBits&&x.windowBits<16&&(x.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var b=i.deflateInit2(this.strm,x.level,x.method,x.windowBits,x.memLevel,x.strategy);if(b!==p)throw new Error(c[b]);if(x.header&&i.deflateSetHeader(this.strm,x.header),x.dictionary){var w;if(w=typeof x.dictionary=="string"?l.string2buf(x.dictionary):u.call(x.dictionary)==="[object ArrayBuffer]"?new Uint8Array(x.dictionary):x.dictionary,(b=i.deflateSetDictionary(this.strm,w))!==p)throw new Error(c[b]);this._dict_set=!0}}function v(y,x){var b=new g(x);if(b.push(y,!0),b.err)throw b.msg||c[b.err];return b.result}g.prototype.push=function(y,x){var b,w,S=this.strm,_=this.options.chunkSize;if(this.ended)return!1;w=x===~~x?x:x===!0?4:0,typeof y=="string"?S.input=l.string2buf(y):u.call(y)==="[object ArrayBuffer]"?S.input=new Uint8Array(y):S.input=y,S.next_in=0,S.avail_in=S.input.length;do{if(S.avail_out===0&&(S.output=new a.Buf8(_),S.next_out=0,S.avail_out=_),(b=i.deflate(S,w))!==1&&b!==p)return this.onEnd(b),!(this.ended=!0);S.avail_out!==0&&(S.avail_in!==0||w!==4&&w!==2)||(this.options.to==="string"?this.onData(l.buf2binstring(a.shrinkBuf(S.output,S.next_out))):this.onData(a.shrinkBuf(S.output,S.next_out)))}while((0<S.avail_in||S.avail_out===0)&&b!==1);return w===4?(b=i.deflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===p):w!==2||(this.onEnd(p),!(S.avail_out=0))},g.prototype.onData=function(y){this.chunks.push(y)},g.prototype.onEnd=function(y){y===p&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=y,this.msg=this.strm.msg},s.Deflate=g,s.deflate=v,s.deflateRaw=function(y,x){return(x=x||{}).raw=!0,v(y,x)},s.gzip=function(y,x){return(x=x||{}).gzip=!0,v(y,x)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(n,r,s){var i=n("./zlib/inflate"),a=n("./utils/common"),l=n("./utils/strings"),c=n("./zlib/constants"),d=n("./zlib/messages"),u=n("./zlib/zstream"),p=n("./zlib/gzheader"),h=Object.prototype.toString;function f(g){if(!(this instanceof f))return new f(g);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},g||{});var v=this.options;v.raw&&0<=v.windowBits&&v.windowBits<16&&(v.windowBits=-v.windowBits,v.windowBits===0&&(v.windowBits=-15)),!(0<=v.windowBits&&v.windowBits<16)||g&&g.windowBits||(v.windowBits+=32),15<v.windowBits&&v.windowBits<48&&!(15&v.windowBits)&&(v.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var y=i.inflateInit2(this.strm,v.windowBits);if(y!==c.Z_OK)throw new Error(d[y]);this.header=new p,i.inflateGetHeader(this.strm,this.header)}function m(g,v){var y=new f(v);if(y.push(g,!0),y.err)throw y.msg||d[y.err];return y.result}f.prototype.push=function(g,v){var y,x,b,w,S,_,k=this.strm,E=this.options.chunkSize,T=this.options.dictionary,O=!1;if(this.ended)return!1;x=v===~~v?v:v===!0?c.Z_FINISH:c.Z_NO_FLUSH,typeof g=="string"?k.input=l.binstring2buf(g):h.call(g)==="[object ArrayBuffer]"?k.input=new Uint8Array(g):k.input=g,k.next_in=0,k.avail_in=k.input.length;do{if(k.avail_out===0&&(k.output=new a.Buf8(E),k.next_out=0,k.avail_out=E),(y=i.inflate(k,c.Z_NO_FLUSH))===c.Z_NEED_DICT&&T&&(_=typeof T=="string"?l.string2buf(T):h.call(T)==="[object ArrayBuffer]"?new Uint8Array(T):T,y=i.inflateSetDictionary(this.strm,_)),y===c.Z_BUF_ERROR&&O===!0&&(y=c.Z_OK,O=!1),y!==c.Z_STREAM_END&&y!==c.Z_OK)return this.onEnd(y),!(this.ended=!0);k.next_out&&(k.avail_out!==0&&y!==c.Z_STREAM_END&&(k.avail_in!==0||x!==c.Z_FINISH&&x!==c.Z_SYNC_FLUSH)||(this.options.to==="string"?(b=l.utf8border(k.output,k.next_out),w=k.next_out-b,S=l.buf2string(k.output,b),k.next_out=w,k.avail_out=E-w,w&&a.arraySet(k.output,k.output,b,w,0),this.onData(S)):this.onData(a.shrinkBuf(k.output,k.next_out)))),k.avail_in===0&&k.avail_out===0&&(O=!0)}while((0<k.avail_in||k.avail_out===0)&&y!==c.Z_STREAM_END);return y===c.Z_STREAM_END&&(x=c.Z_FINISH),x===c.Z_FINISH?(y=i.inflateEnd(this.strm),this.onEnd(y),this.ended=!0,y===c.Z_OK):x!==c.Z_SYNC_FLUSH||(this.onEnd(c.Z_OK),!(k.avail_out=0))},f.prototype.onData=function(g){this.chunks.push(g)},f.prototype.onEnd=function(g){g===c.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=g,this.msg=this.strm.msg},s.Inflate=f,s.inflate=m,s.inflateRaw=function(g,v){return(v=v||{}).raw=!0,m(g,v)},s.ungzip=m},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(n,r,s){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";s.assign=function(c){for(var d=Array.prototype.slice.call(arguments,1);d.length;){var u=d.shift();if(u){if(typeof u!="object")throw new TypeError(u+"must be non-object");for(var p in u)u.hasOwnProperty(p)&&(c[p]=u[p])}}return c},s.shrinkBuf=function(c,d){return c.length===d?c:c.subarray?c.subarray(0,d):(c.length=d,c)};var a={arraySet:function(c,d,u,p,h){if(d.subarray&&c.subarray)c.set(d.subarray(u,u+p),h);else for(var f=0;f<p;f++)c[h+f]=d[u+f]},flattenChunks:function(c){var d,u,p,h,f,m;for(d=p=0,u=c.length;d<u;d++)p+=c[d].length;for(m=new Uint8Array(p),d=h=0,u=c.length;d<u;d++)f=c[d],m.set(f,h),h+=f.length;return m}},l={arraySet:function(c,d,u,p,h){for(var f=0;f<p;f++)c[h+f]=d[u+f]},flattenChunks:function(c){return[].concat.apply([],c)}};s.setTyped=function(c){c?(s.Buf8=Uint8Array,s.Buf16=Uint16Array,s.Buf32=Int32Array,s.assign(s,a)):(s.Buf8=Array,s.Buf16=Array,s.Buf32=Array,s.assign(s,l))},s.setTyped(i)},{}],42:[function(n,r,s){var i=n("./common"),a=!0,l=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{l=!1}for(var c=new i.Buf8(256),d=0;d<256;d++)c[d]=252<=d?6:248<=d?5:240<=d?4:224<=d?3:192<=d?2:1;function u(p,h){if(h<65537&&(p.subarray&&l||!p.subarray&&a))return String.fromCharCode.apply(null,i.shrinkBuf(p,h));for(var f="",m=0;m<h;m++)f+=String.fromCharCode(p[m]);return f}c[254]=c[254]=1,s.string2buf=function(p){var h,f,m,g,v,y=p.length,x=0;for(g=0;g<y;g++)(64512&(f=p.charCodeAt(g)))==55296&&g+1<y&&(64512&(m=p.charCodeAt(g+1)))==56320&&(f=65536+(f-55296<<10)+(m-56320),g++),x+=f<128?1:f<2048?2:f<65536?3:4;for(h=new i.Buf8(x),g=v=0;v<x;g++)(64512&(f=p.charCodeAt(g)))==55296&&g+1<y&&(64512&(m=p.charCodeAt(g+1)))==56320&&(f=65536+(f-55296<<10)+(m-56320),g++),f<128?h[v++]=f:(f<2048?h[v++]=192|f>>>6:(f<65536?h[v++]=224|f>>>12:(h[v++]=240|f>>>18,h[v++]=128|f>>>12&63),h[v++]=128|f>>>6&63),h[v++]=128|63&f);return h},s.buf2binstring=function(p){return u(p,p.length)},s.binstring2buf=function(p){for(var h=new i.Buf8(p.length),f=0,m=h.length;f<m;f++)h[f]=p.charCodeAt(f);return h},s.buf2string=function(p,h){var f,m,g,v,y=h||p.length,x=new Array(2*y);for(f=m=0;f<y;)if((g=p[f++])<128)x[m++]=g;else if(4<(v=c[g]))x[m++]=65533,f+=v-1;else{for(g&=v===2?31:v===3?15:7;1<v&&f<y;)g=g<<6|63&p[f++],v--;1<v?x[m++]=65533:g<65536?x[m++]=g:(g-=65536,x[m++]=55296|g>>10&1023,x[m++]=56320|1023&g)}return u(x,m)},s.utf8border=function(p,h){var f;for((h=h||p.length)>p.length&&(h=p.length),f=h-1;0<=f&&(192&p[f])==128;)f--;return f<0||f===0?h:f+c[p[f]]>h?f:h}},{"./common":41}],43:[function(n,r,s){r.exports=function(i,a,l,c){for(var d=65535&i|0,u=i>>>16&65535|0,p=0;l!==0;){for(l-=p=2e3<l?2e3:l;u=u+(d=d+a[c++]|0)|0,--p;);d%=65521,u%=65521}return d|u<<16|0}},{}],44:[function(n,r,s){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(n,r,s){var i=function(){for(var a,l=[],c=0;c<256;c++){a=c;for(var d=0;d<8;d++)a=1&a?3988292384^a>>>1:a>>>1;l[c]=a}return l}();r.exports=function(a,l,c,d){var u=i,p=d+c;a^=-1;for(var h=d;h<p;h++)a=a>>>8^u[255&(a^l[h])];return-1^a}},{}],46:[function(n,r,s){var i,a=n("../utils/common"),l=n("./trees"),c=n("./adler32"),d=n("./crc32"),u=n("./messages"),p=0,h=4,f=0,m=-2,g=-1,v=4,y=2,x=8,b=9,w=286,S=30,_=19,k=2*w+1,E=15,T=3,O=258,q=O+T+1,P=42,W=113,j=1,G=2,pe=3,Z=4;function ee(C,Q){return C.msg=u[Q],Q}function F(C){return(C<<1)-(4<C?9:0)}function K(C){for(var Q=C.length;0<=--Q;)C[Q]=0}function U(C){var Q=C.state,ce=Q.pending;ce>C.avail_out&&(ce=C.avail_out),ce!==0&&(a.arraySet(C.output,Q.pending_buf,Q.pending_out,ce,C.next_out),C.next_out+=ce,Q.pending_out+=ce,C.total_out+=ce,C.avail_out-=ce,Q.pending-=ce,Q.pending===0&&(Q.pending_out=0))}function V(C,Q){l._tr_flush_block(C,0<=C.block_start?C.block_start:-1,C.strstart-C.block_start,Q),C.block_start=C.strstart,U(C.strm)}function J(C,Q){C.pending_buf[C.pending++]=Q}function oe(C,Q){C.pending_buf[C.pending++]=Q>>>8&255,C.pending_buf[C.pending++]=255&Q}function me(C,Q){var ce,L,N=C.max_chain_length,I=C.strstart,H=C.prev_length,X=C.nice_match,z=C.strstart>C.w_size-q?C.strstart-(C.w_size-q):0,te=C.window,ye=C.w_mask,Y=C.prev,M=C.strstart+O,ie=te[I+H-1],fe=te[I+H];C.prev_length>=C.good_match&&(N>>=2),X>C.lookahead&&(X=C.lookahead);do if(te[(ce=Q)+H]===fe&&te[ce+H-1]===ie&&te[ce]===te[I]&&te[++ce]===te[I+1]){I+=2,ce++;do;while(te[++I]===te[++ce]&&te[++I]===te[++ce]&&te[++I]===te[++ce]&&te[++I]===te[++ce]&&te[++I]===te[++ce]&&te[++I]===te[++ce]&&te[++I]===te[++ce]&&te[++I]===te[++ce]&&I<M);if(L=O-(M-I),I=M-O,H<L){if(C.match_start=Q,X<=(H=L))break;ie=te[I+H-1],fe=te[I+H]}}while((Q=Y[Q&ye])>z&&--N!=0);return H<=C.lookahead?H:C.lookahead}function je(C){var Q,ce,L,N,I,H,X,z,te,ye,Y=C.w_size;do{if(N=C.window_size-C.lookahead-C.strstart,C.strstart>=Y+(Y-q)){for(a.arraySet(C.window,C.window,Y,Y,0),C.match_start-=Y,C.strstart-=Y,C.block_start-=Y,Q=ce=C.hash_size;L=C.head[--Q],C.head[Q]=Y<=L?L-Y:0,--ce;);for(Q=ce=Y;L=C.prev[--Q],C.prev[Q]=Y<=L?L-Y:0,--ce;);N+=Y}if(C.strm.avail_in===0)break;if(H=C.strm,X=C.window,z=C.strstart+C.lookahead,te=N,ye=void 0,ye=H.avail_in,te<ye&&(ye=te),ce=ye===0?0:(H.avail_in-=ye,a.arraySet(X,H.input,H.next_in,ye,z),H.state.wrap===1?H.adler=c(H.adler,X,ye,z):H.state.wrap===2&&(H.adler=d(H.adler,X,ye,z)),H.next_in+=ye,H.total_in+=ye,ye),C.lookahead+=ce,C.lookahead+C.insert>=T)for(I=C.strstart-C.insert,C.ins_h=C.window[I],C.ins_h=(C.ins_h<<C.hash_shift^C.window[I+1])&C.hash_mask;C.insert&&(C.ins_h=(C.ins_h<<C.hash_shift^C.window[I+T-1])&C.hash_mask,C.prev[I&C.w_mask]=C.head[C.ins_h],C.head[C.ins_h]=I,I++,C.insert--,!(C.lookahead+C.insert<T)););}while(C.lookahead<q&&C.strm.avail_in!==0)}function he(C,Q){for(var ce,L;;){if(C.lookahead<q){if(je(C),C.lookahead<q&&Q===p)return j;if(C.lookahead===0)break}if(ce=0,C.lookahead>=T&&(C.ins_h=(C.ins_h<<C.hash_shift^C.window[C.strstart+T-1])&C.hash_mask,ce=C.prev[C.strstart&C.w_mask]=C.head[C.ins_h],C.head[C.ins_h]=C.strstart),ce!==0&&C.strstart-ce<=C.w_size-q&&(C.match_length=me(C,ce)),C.match_length>=T)if(L=l._tr_tally(C,C.strstart-C.match_start,C.match_length-T),C.lookahead-=C.match_length,C.match_length<=C.max_lazy_match&&C.lookahead>=T){for(C.match_length--;C.strstart++,C.ins_h=(C.ins_h<<C.hash_shift^C.window[C.strstart+T-1])&C.hash_mask,ce=C.prev[C.strstart&C.w_mask]=C.head[C.ins_h],C.head[C.ins_h]=C.strstart,--C.match_length!=0;);C.strstart++}else C.strstart+=C.match_length,C.match_length=0,C.ins_h=C.window[C.strstart],C.ins_h=(C.ins_h<<C.hash_shift^C.window[C.strstart+1])&C.hash_mask;else L=l._tr_tally(C,0,C.window[C.strstart]),C.lookahead--,C.strstart++;if(L&&(V(C,!1),C.strm.avail_out===0))return j}return C.insert=C.strstart<T-1?C.strstart:T-1,Q===h?(V(C,!0),C.strm.avail_out===0?pe:Z):C.last_lit&&(V(C,!1),C.strm.avail_out===0)?j:G}function Ee(C,Q){for(var ce,L,N;;){if(C.lookahead<q){if(je(C),C.lookahead<q&&Q===p)return j;if(C.lookahead===0)break}if(ce=0,C.lookahead>=T&&(C.ins_h=(C.ins_h<<C.hash_shift^C.window[C.strstart+T-1])&C.hash_mask,ce=C.prev[C.strstart&C.w_mask]=C.head[C.ins_h],C.head[C.ins_h]=C.strstart),C.prev_length=C.match_length,C.prev_match=C.match_start,C.match_length=T-1,ce!==0&&C.prev_length<C.max_lazy_match&&C.strstart-ce<=C.w_size-q&&(C.match_length=me(C,ce),C.match_length<=5&&(C.strategy===1||C.match_length===T&&4096<C.strstart-C.match_start)&&(C.match_length=T-1)),C.prev_length>=T&&C.match_length<=C.prev_length){for(N=C.strstart+C.lookahead-T,L=l._tr_tally(C,C.strstart-1-C.prev_match,C.prev_length-T),C.lookahead-=C.prev_length-1,C.prev_length-=2;++C.strstart<=N&&(C.ins_h=(C.ins_h<<C.hash_shift^C.window[C.strstart+T-1])&C.hash_mask,ce=C.prev[C.strstart&C.w_mask]=C.head[C.ins_h],C.head[C.ins_h]=C.strstart),--C.prev_length!=0;);if(C.match_available=0,C.match_length=T-1,C.strstart++,L&&(V(C,!1),C.strm.avail_out===0))return j}else if(C.match_available){if((L=l._tr_tally(C,0,C.window[C.strstart-1]))&&V(C,!1),C.strstart++,C.lookahead--,C.strm.avail_out===0)return j}else C.match_available=1,C.strstart++,C.lookahead--}return C.match_available&&(L=l._tr_tally(C,0,C.window[C.strstart-1]),C.match_available=0),C.insert=C.strstart<T-1?C.strstart:T-1,Q===h?(V(C,!0),C.strm.avail_out===0?pe:Z):C.last_lit&&(V(C,!1),C.strm.avail_out===0)?j:G}function Me(C,Q,ce,L,N){this.good_length=C,this.max_lazy=Q,this.nice_length=ce,this.max_chain=L,this.func=N}function We(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=x,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*k),this.dyn_dtree=new a.Buf16(2*(2*S+1)),this.bl_tree=new a.Buf16(2*(2*_+1)),K(this.dyn_ltree),K(this.dyn_dtree),K(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(E+1),this.heap=new a.Buf16(2*w+1),K(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*w+1),K(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Ie(C){var Q;return C&&C.state?(C.total_in=C.total_out=0,C.data_type=y,(Q=C.state).pending=0,Q.pending_out=0,Q.wrap<0&&(Q.wrap=-Q.wrap),Q.status=Q.wrap?P:W,C.adler=Q.wrap===2?0:1,Q.last_flush=p,l._tr_init(Q),f):ee(C,m)}function Je(C){var Q=Ie(C);return Q===f&&function(ce){ce.window_size=2*ce.w_size,K(ce.head),ce.max_lazy_match=i[ce.level].max_lazy,ce.good_match=i[ce.level].good_length,ce.nice_match=i[ce.level].nice_length,ce.max_chain_length=i[ce.level].max_chain,ce.strstart=0,ce.block_start=0,ce.lookahead=0,ce.insert=0,ce.match_length=ce.prev_length=T-1,ce.match_available=0,ce.ins_h=0}(C.state),Q}function Ue(C,Q,ce,L,N,I){if(!C)return m;var H=1;if(Q===g&&(Q=6),L<0?(H=0,L=-L):15<L&&(H=2,L-=16),N<1||b<N||ce!==x||L<8||15<L||Q<0||9<Q||I<0||v<I)return ee(C,m);L===8&&(L=9);var X=new We;return(C.state=X).strm=C,X.wrap=H,X.gzhead=null,X.w_bits=L,X.w_size=1<<X.w_bits,X.w_mask=X.w_size-1,X.hash_bits=N+7,X.hash_size=1<<X.hash_bits,X.hash_mask=X.hash_size-1,X.hash_shift=~~((X.hash_bits+T-1)/T),X.window=new a.Buf8(2*X.w_size),X.head=new a.Buf16(X.hash_size),X.prev=new a.Buf16(X.w_size),X.lit_bufsize=1<<N+6,X.pending_buf_size=4*X.lit_bufsize,X.pending_buf=new a.Buf8(X.pending_buf_size),X.d_buf=1*X.lit_bufsize,X.l_buf=3*X.lit_bufsize,X.level=Q,X.strategy=I,X.method=ce,Je(C)}i=[new Me(0,0,0,0,function(C,Q){var ce=65535;for(ce>C.pending_buf_size-5&&(ce=C.pending_buf_size-5);;){if(C.lookahead<=1){if(je(C),C.lookahead===0&&Q===p)return j;if(C.lookahead===0)break}C.strstart+=C.lookahead,C.lookahead=0;var L=C.block_start+ce;if((C.strstart===0||C.strstart>=L)&&(C.lookahead=C.strstart-L,C.strstart=L,V(C,!1),C.strm.avail_out===0)||C.strstart-C.block_start>=C.w_size-q&&(V(C,!1),C.strm.avail_out===0))return j}return C.insert=0,Q===h?(V(C,!0),C.strm.avail_out===0?pe:Z):(C.strstart>C.block_start&&(V(C,!1),C.strm.avail_out),j)}),new Me(4,4,8,4,he),new Me(4,5,16,8,he),new Me(4,6,32,32,he),new Me(4,4,16,16,Ee),new Me(8,16,32,32,Ee),new Me(8,16,128,128,Ee),new Me(8,32,128,256,Ee),new Me(32,128,258,1024,Ee),new Me(32,258,258,4096,Ee)],s.deflateInit=function(C,Q){return Ue(C,Q,x,15,8,0)},s.deflateInit2=Ue,s.deflateReset=Je,s.deflateResetKeep=Ie,s.deflateSetHeader=function(C,Q){return C&&C.state?C.state.wrap!==2?m:(C.state.gzhead=Q,f):m},s.deflate=function(C,Q){var ce,L,N,I;if(!C||!C.state||5<Q||Q<0)return C?ee(C,m):m;if(L=C.state,!C.output||!C.input&&C.avail_in!==0||L.status===666&&Q!==h)return ee(C,C.avail_out===0?-5:m);if(L.strm=C,ce=L.last_flush,L.last_flush=Q,L.status===P)if(L.wrap===2)C.adler=0,J(L,31),J(L,139),J(L,8),L.gzhead?(J(L,(L.gzhead.text?1:0)+(L.gzhead.hcrc?2:0)+(L.gzhead.extra?4:0)+(L.gzhead.name?8:0)+(L.gzhead.comment?16:0)),J(L,255&L.gzhead.time),J(L,L.gzhead.time>>8&255),J(L,L.gzhead.time>>16&255),J(L,L.gzhead.time>>24&255),J(L,L.level===9?2:2<=L.strategy||L.level<2?4:0),J(L,255&L.gzhead.os),L.gzhead.extra&&L.gzhead.extra.length&&(J(L,255&L.gzhead.extra.length),J(L,L.gzhead.extra.length>>8&255)),L.gzhead.hcrc&&(C.adler=d(C.adler,L.pending_buf,L.pending,0)),L.gzindex=0,L.status=69):(J(L,0),J(L,0),J(L,0),J(L,0),J(L,0),J(L,L.level===9?2:2<=L.strategy||L.level<2?4:0),J(L,3),L.status=W);else{var H=x+(L.w_bits-8<<4)<<8;H|=(2<=L.strategy||L.level<2?0:L.level<6?1:L.level===6?2:3)<<6,L.strstart!==0&&(H|=32),H+=31-H%31,L.status=W,oe(L,H),L.strstart!==0&&(oe(L,C.adler>>>16),oe(L,65535&C.adler)),C.adler=1}if(L.status===69)if(L.gzhead.extra){for(N=L.pending;L.gzindex<(65535&L.gzhead.extra.length)&&(L.pending!==L.pending_buf_size||(L.gzhead.hcrc&&L.pending>N&&(C.adler=d(C.adler,L.pending_buf,L.pending-N,N)),U(C),N=L.pending,L.pending!==L.pending_buf_size));)J(L,255&L.gzhead.extra[L.gzindex]),L.gzindex++;L.gzhead.hcrc&&L.pending>N&&(C.adler=d(C.adler,L.pending_buf,L.pending-N,N)),L.gzindex===L.gzhead.extra.length&&(L.gzindex=0,L.status=73)}else L.status=73;if(L.status===73)if(L.gzhead.name){N=L.pending;do{if(L.pending===L.pending_buf_size&&(L.gzhead.hcrc&&L.pending>N&&(C.adler=d(C.adler,L.pending_buf,L.pending-N,N)),U(C),N=L.pending,L.pending===L.pending_buf_size)){I=1;break}I=L.gzindex<L.gzhead.name.length?255&L.gzhead.name.charCodeAt(L.gzindex++):0,J(L,I)}while(I!==0);L.gzhead.hcrc&&L.pending>N&&(C.adler=d(C.adler,L.pending_buf,L.pending-N,N)),I===0&&(L.gzindex=0,L.status=91)}else L.status=91;if(L.status===91)if(L.gzhead.comment){N=L.pending;do{if(L.pending===L.pending_buf_size&&(L.gzhead.hcrc&&L.pending>N&&(C.adler=d(C.adler,L.pending_buf,L.pending-N,N)),U(C),N=L.pending,L.pending===L.pending_buf_size)){I=1;break}I=L.gzindex<L.gzhead.comment.length?255&L.gzhead.comment.charCodeAt(L.gzindex++):0,J(L,I)}while(I!==0);L.gzhead.hcrc&&L.pending>N&&(C.adler=d(C.adler,L.pending_buf,L.pending-N,N)),I===0&&(L.status=103)}else L.status=103;if(L.status===103&&(L.gzhead.hcrc?(L.pending+2>L.pending_buf_size&&U(C),L.pending+2<=L.pending_buf_size&&(J(L,255&C.adler),J(L,C.adler>>8&255),C.adler=0,L.status=W)):L.status=W),L.pending!==0){if(U(C),C.avail_out===0)return L.last_flush=-1,f}else if(C.avail_in===0&&F(Q)<=F(ce)&&Q!==h)return ee(C,-5);if(L.status===666&&C.avail_in!==0)return ee(C,-5);if(C.avail_in!==0||L.lookahead!==0||Q!==p&&L.status!==666){var X=L.strategy===2?function(z,te){for(var ye;;){if(z.lookahead===0&&(je(z),z.lookahead===0)){if(te===p)return j;break}if(z.match_length=0,ye=l._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++,ye&&(V(z,!1),z.strm.avail_out===0))return j}return z.insert=0,te===h?(V(z,!0),z.strm.avail_out===0?pe:Z):z.last_lit&&(V(z,!1),z.strm.avail_out===0)?j:G}(L,Q):L.strategy===3?function(z,te){for(var ye,Y,M,ie,fe=z.window;;){if(z.lookahead<=O){if(je(z),z.lookahead<=O&&te===p)return j;if(z.lookahead===0)break}if(z.match_length=0,z.lookahead>=T&&0<z.strstart&&(Y=fe[M=z.strstart-1])===fe[++M]&&Y===fe[++M]&&Y===fe[++M]){ie=z.strstart+O;do;while(Y===fe[++M]&&Y===fe[++M]&&Y===fe[++M]&&Y===fe[++M]&&Y===fe[++M]&&Y===fe[++M]&&Y===fe[++M]&&Y===fe[++M]&&M<ie);z.match_length=O-(ie-M),z.match_length>z.lookahead&&(z.match_length=z.lookahead)}if(z.match_length>=T?(ye=l._tr_tally(z,1,z.match_length-T),z.lookahead-=z.match_length,z.strstart+=z.match_length,z.match_length=0):(ye=l._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++),ye&&(V(z,!1),z.strm.avail_out===0))return j}return z.insert=0,te===h?(V(z,!0),z.strm.avail_out===0?pe:Z):z.last_lit&&(V(z,!1),z.strm.avail_out===0)?j:G}(L,Q):i[L.level].func(L,Q);if(X!==pe&&X!==Z||(L.status=666),X===j||X===pe)return C.avail_out===0&&(L.last_flush=-1),f;if(X===G&&(Q===1?l._tr_align(L):Q!==5&&(l._tr_stored_block(L,0,0,!1),Q===3&&(K(L.head),L.lookahead===0&&(L.strstart=0,L.block_start=0,L.insert=0))),U(C),C.avail_out===0))return L.last_flush=-1,f}return Q!==h?f:L.wrap<=0?1:(L.wrap===2?(J(L,255&C.adler),J(L,C.adler>>8&255),J(L,C.adler>>16&255),J(L,C.adler>>24&255),J(L,255&C.total_in),J(L,C.total_in>>8&255),J(L,C.total_in>>16&255),J(L,C.total_in>>24&255)):(oe(L,C.adler>>>16),oe(L,65535&C.adler)),U(C),0<L.wrap&&(L.wrap=-L.wrap),L.pending!==0?f:1)},s.deflateEnd=function(C){var Q;return C&&C.state?(Q=C.state.status)!==P&&Q!==69&&Q!==73&&Q!==91&&Q!==103&&Q!==W&&Q!==666?ee(C,m):(C.state=null,Q===W?ee(C,-3):f):m},s.deflateSetDictionary=function(C,Q){var ce,L,N,I,H,X,z,te,ye=Q.length;if(!C||!C.state||(I=(ce=C.state).wrap)===2||I===1&&ce.status!==P||ce.lookahead)return m;for(I===1&&(C.adler=c(C.adler,Q,ye,0)),ce.wrap=0,ye>=ce.w_size&&(I===0&&(K(ce.head),ce.strstart=0,ce.block_start=0,ce.insert=0),te=new a.Buf8(ce.w_size),a.arraySet(te,Q,ye-ce.w_size,ce.w_size,0),Q=te,ye=ce.w_size),H=C.avail_in,X=C.next_in,z=C.input,C.avail_in=ye,C.next_in=0,C.input=Q,je(ce);ce.lookahead>=T;){for(L=ce.strstart,N=ce.lookahead-(T-1);ce.ins_h=(ce.ins_h<<ce.hash_shift^ce.window[L+T-1])&ce.hash_mask,ce.prev[L&ce.w_mask]=ce.head[ce.ins_h],ce.head[ce.ins_h]=L,L++,--N;);ce.strstart=L,ce.lookahead=T-1,je(ce)}return ce.strstart+=ce.lookahead,ce.block_start=ce.strstart,ce.insert=ce.lookahead,ce.lookahead=0,ce.match_length=ce.prev_length=T-1,ce.match_available=0,C.next_in=X,C.input=z,C.avail_in=H,ce.wrap=I,f},s.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(n,r,s){r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(n,r,s){r.exports=function(i,a){var l,c,d,u,p,h,f,m,g,v,y,x,b,w,S,_,k,E,T,O,q,P,W,j,G;l=i.state,c=i.next_in,j=i.input,d=c+(i.avail_in-5),u=i.next_out,G=i.output,p=u-(a-i.avail_out),h=u+(i.avail_out-257),f=l.dmax,m=l.wsize,g=l.whave,v=l.wnext,y=l.window,x=l.hold,b=l.bits,w=l.lencode,S=l.distcode,_=(1<<l.lenbits)-1,k=(1<<l.distbits)-1;e:do{b<15&&(x+=j[c++]<<b,b+=8,x+=j[c++]<<b,b+=8),E=w[x&_];t:for(;;){if(x>>>=T=E>>>24,b-=T,(T=E>>>16&255)===0)G[u++]=65535&E;else{if(!(16&T)){if(!(64&T)){E=w[(65535&E)+(x&(1<<T)-1)];continue t}if(32&T){l.mode=12;break e}i.msg="invalid literal/length code",l.mode=30;break e}O=65535&E,(T&=15)&&(b<T&&(x+=j[c++]<<b,b+=8),O+=x&(1<<T)-1,x>>>=T,b-=T),b<15&&(x+=j[c++]<<b,b+=8,x+=j[c++]<<b,b+=8),E=S[x&k];n:for(;;){if(x>>>=T=E>>>24,b-=T,!(16&(T=E>>>16&255))){if(!(64&T)){E=S[(65535&E)+(x&(1<<T)-1)];continue n}i.msg="invalid distance code",l.mode=30;break e}if(q=65535&E,b<(T&=15)&&(x+=j[c++]<<b,(b+=8)<T&&(x+=j[c++]<<b,b+=8)),f<(q+=x&(1<<T)-1)){i.msg="invalid distance too far back",l.mode=30;break e}if(x>>>=T,b-=T,(T=u-p)<q){if(g<(T=q-T)&&l.sane){i.msg="invalid distance too far back",l.mode=30;break e}if(W=y,(P=0)===v){if(P+=m-T,T<O){for(O-=T;G[u++]=y[P++],--T;);P=u-q,W=G}}else if(v<T){if(P+=m+v-T,(T-=v)<O){for(O-=T;G[u++]=y[P++],--T;);if(P=0,v<O){for(O-=T=v;G[u++]=y[P++],--T;);P=u-q,W=G}}}else if(P+=v-T,T<O){for(O-=T;G[u++]=y[P++],--T;);P=u-q,W=G}for(;2<O;)G[u++]=W[P++],G[u++]=W[P++],G[u++]=W[P++],O-=3;O&&(G[u++]=W[P++],1<O&&(G[u++]=W[P++]))}else{for(P=u-q;G[u++]=G[P++],G[u++]=G[P++],G[u++]=G[P++],2<(O-=3););O&&(G[u++]=G[P++],1<O&&(G[u++]=G[P++]))}break}}break}}while(c<d&&u<h);c-=O=b>>3,x&=(1<<(b-=O<<3))-1,i.next_in=c,i.next_out=u,i.avail_in=c<d?d-c+5:5-(c-d),i.avail_out=u<h?h-u+257:257-(u-h),l.hold=x,l.bits=b}},{}],49:[function(n,r,s){var i=n("../utils/common"),a=n("./adler32"),l=n("./crc32"),c=n("./inffast"),d=n("./inftrees"),u=1,p=2,h=0,f=-2,m=1,g=852,v=592;function y(P){return(P>>>24&255)+(P>>>8&65280)+((65280&P)<<8)+((255&P)<<24)}function x(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function b(P){var W;return P&&P.state?(W=P.state,P.total_in=P.total_out=W.total=0,P.msg="",W.wrap&&(P.adler=1&W.wrap),W.mode=m,W.last=0,W.havedict=0,W.dmax=32768,W.head=null,W.hold=0,W.bits=0,W.lencode=W.lendyn=new i.Buf32(g),W.distcode=W.distdyn=new i.Buf32(v),W.sane=1,W.back=-1,h):f}function w(P){var W;return P&&P.state?((W=P.state).wsize=0,W.whave=0,W.wnext=0,b(P)):f}function S(P,W){var j,G;return P&&P.state?(G=P.state,W<0?(j=0,W=-W):(j=1+(W>>4),W<48&&(W&=15)),W&&(W<8||15<W)?f:(G.window!==null&&G.wbits!==W&&(G.window=null),G.wrap=j,G.wbits=W,w(P))):f}function _(P,W){var j,G;return P?(G=new x,(P.state=G).window=null,(j=S(P,W))!==h&&(P.state=null),j):f}var k,E,T=!0;function O(P){if(T){var W;for(k=new i.Buf32(512),E=new i.Buf32(32),W=0;W<144;)P.lens[W++]=8;for(;W<256;)P.lens[W++]=9;for(;W<280;)P.lens[W++]=7;for(;W<288;)P.lens[W++]=8;for(d(u,P.lens,0,288,k,0,P.work,{bits:9}),W=0;W<32;)P.lens[W++]=5;d(p,P.lens,0,32,E,0,P.work,{bits:5}),T=!1}P.lencode=k,P.lenbits=9,P.distcode=E,P.distbits=5}function q(P,W,j,G){var pe,Z=P.state;return Z.window===null&&(Z.wsize=1<<Z.wbits,Z.wnext=0,Z.whave=0,Z.window=new i.Buf8(Z.wsize)),G>=Z.wsize?(i.arraySet(Z.window,W,j-Z.wsize,Z.wsize,0),Z.wnext=0,Z.whave=Z.wsize):(G<(pe=Z.wsize-Z.wnext)&&(pe=G),i.arraySet(Z.window,W,j-G,pe,Z.wnext),(G-=pe)?(i.arraySet(Z.window,W,j-G,G,0),Z.wnext=G,Z.whave=Z.wsize):(Z.wnext+=pe,Z.wnext===Z.wsize&&(Z.wnext=0),Z.whave<Z.wsize&&(Z.whave+=pe))),0}s.inflateReset=w,s.inflateReset2=S,s.inflateResetKeep=b,s.inflateInit=function(P){return _(P,15)},s.inflateInit2=_,s.inflate=function(P,W){var j,G,pe,Z,ee,F,K,U,V,J,oe,me,je,he,Ee,Me,We,Ie,Je,Ue,C,Q,ce,L,N=0,I=new i.Buf8(4),H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!P||!P.state||!P.output||!P.input&&P.avail_in!==0)return f;(j=P.state).mode===12&&(j.mode=13),ee=P.next_out,pe=P.output,K=P.avail_out,Z=P.next_in,G=P.input,F=P.avail_in,U=j.hold,V=j.bits,J=F,oe=K,Q=h;e:for(;;)switch(j.mode){case m:if(j.wrap===0){j.mode=13;break}for(;V<16;){if(F===0)break e;F--,U+=G[Z++]<<V,V+=8}if(2&j.wrap&&U===35615){I[j.check=0]=255&U,I[1]=U>>>8&255,j.check=l(j.check,I,2,0),V=U=0,j.mode=2;break}if(j.flags=0,j.head&&(j.head.done=!1),!(1&j.wrap)||(((255&U)<<8)+(U>>8))%31){P.msg="incorrect header check",j.mode=30;break}if((15&U)!=8){P.msg="unknown compression method",j.mode=30;break}if(V-=4,C=8+(15&(U>>>=4)),j.wbits===0)j.wbits=C;else if(C>j.wbits){P.msg="invalid window size",j.mode=30;break}j.dmax=1<<C,P.adler=j.check=1,j.mode=512&U?10:12,V=U=0;break;case 2:for(;V<16;){if(F===0)break e;F--,U+=G[Z++]<<V,V+=8}if(j.flags=U,(255&j.flags)!=8){P.msg="unknown compression method",j.mode=30;break}if(57344&j.flags){P.msg="unknown header flags set",j.mode=30;break}j.head&&(j.head.text=U>>8&1),512&j.flags&&(I[0]=255&U,I[1]=U>>>8&255,j.check=l(j.check,I,2,0)),V=U=0,j.mode=3;case 3:for(;V<32;){if(F===0)break e;F--,U+=G[Z++]<<V,V+=8}j.head&&(j.head.time=U),512&j.flags&&(I[0]=255&U,I[1]=U>>>8&255,I[2]=U>>>16&255,I[3]=U>>>24&255,j.check=l(j.check,I,4,0)),V=U=0,j.mode=4;case 4:for(;V<16;){if(F===0)break e;F--,U+=G[Z++]<<V,V+=8}j.head&&(j.head.xflags=255&U,j.head.os=U>>8),512&j.flags&&(I[0]=255&U,I[1]=U>>>8&255,j.check=l(j.check,I,2,0)),V=U=0,j.mode=5;case 5:if(1024&j.flags){for(;V<16;){if(F===0)break e;F--,U+=G[Z++]<<V,V+=8}j.length=U,j.head&&(j.head.extra_len=U),512&j.flags&&(I[0]=255&U,I[1]=U>>>8&255,j.check=l(j.check,I,2,0)),V=U=0}else j.head&&(j.head.extra=null);j.mode=6;case 6:if(1024&j.flags&&(F<(me=j.length)&&(me=F),me&&(j.head&&(C=j.head.extra_len-j.length,j.head.extra||(j.head.extra=new Array(j.head.extra_len)),i.arraySet(j.head.extra,G,Z,me,C)),512&j.flags&&(j.check=l(j.check,G,me,Z)),F-=me,Z+=me,j.length-=me),j.length))break e;j.length=0,j.mode=7;case 7:if(2048&j.flags){if(F===0)break e;for(me=0;C=G[Z+me++],j.head&&C&&j.length<65536&&(j.head.name+=String.fromCharCode(C)),C&&me<F;);if(512&j.flags&&(j.check=l(j.check,G,me,Z)),F-=me,Z+=me,C)break e}else j.head&&(j.head.name=null);j.length=0,j.mode=8;case 8:if(4096&j.flags){if(F===0)break e;for(me=0;C=G[Z+me++],j.head&&C&&j.length<65536&&(j.head.comment+=String.fromCharCode(C)),C&&me<F;);if(512&j.flags&&(j.check=l(j.check,G,me,Z)),F-=me,Z+=me,C)break e}else j.head&&(j.head.comment=null);j.mode=9;case 9:if(512&j.flags){for(;V<16;){if(F===0)break e;F--,U+=G[Z++]<<V,V+=8}if(U!==(65535&j.check)){P.msg="header crc mismatch",j.mode=30;break}V=U=0}j.head&&(j.head.hcrc=j.flags>>9&1,j.head.done=!0),P.adler=j.check=0,j.mode=12;break;case 10:for(;V<32;){if(F===0)break e;F--,U+=G[Z++]<<V,V+=8}P.adler=j.check=y(U),V=U=0,j.mode=11;case 11:if(j.havedict===0)return P.next_out=ee,P.avail_out=K,P.next_in=Z,P.avail_in=F,j.hold=U,j.bits=V,2;P.adler=j.check=1,j.mode=12;case 12:if(W===5||W===6)break e;case 13:if(j.last){U>>>=7&V,V-=7&V,j.mode=27;break}for(;V<3;){if(F===0)break e;F--,U+=G[Z++]<<V,V+=8}switch(j.last=1&U,V-=1,3&(U>>>=1)){case 0:j.mode=14;break;case 1:if(O(j),j.mode=20,W!==6)break;U>>>=2,V-=2;break e;case 2:j.mode=17;break;case 3:P.msg="invalid block type",j.mode=30}U>>>=2,V-=2;break;case 14:for(U>>>=7&V,V-=7&V;V<32;){if(F===0)break e;F--,U+=G[Z++]<<V,V+=8}if((65535&U)!=(U>>>16^65535)){P.msg="invalid stored block lengths",j.mode=30;break}if(j.length=65535&U,V=U=0,j.mode=15,W===6)break e;case 15:j.mode=16;case 16:if(me=j.length){if(F<me&&(me=F),K<me&&(me=K),me===0)break e;i.arraySet(pe,G,Z,me,ee),F-=me,Z+=me,K-=me,ee+=me,j.length-=me;break}j.mode=12;break;case 17:for(;V<14;){if(F===0)break e;F--,U+=G[Z++]<<V,V+=8}if(j.nlen=257+(31&U),U>>>=5,V-=5,j.ndist=1+(31&U),U>>>=5,V-=5,j.ncode=4+(15&U),U>>>=4,V-=4,286<j.nlen||30<j.ndist){P.msg="too many length or distance symbols",j.mode=30;break}j.have=0,j.mode=18;case 18:for(;j.have<j.ncode;){for(;V<3;){if(F===0)break e;F--,U+=G[Z++]<<V,V+=8}j.lens[H[j.have++]]=7&U,U>>>=3,V-=3}for(;j.have<19;)j.lens[H[j.have++]]=0;if(j.lencode=j.lendyn,j.lenbits=7,ce={bits:j.lenbits},Q=d(0,j.lens,0,19,j.lencode,0,j.work,ce),j.lenbits=ce.bits,Q){P.msg="invalid code lengths set",j.mode=30;break}j.have=0,j.mode=19;case 19:for(;j.have<j.nlen+j.ndist;){for(;Me=(N=j.lencode[U&(1<<j.lenbits)-1])>>>16&255,We=65535&N,!((Ee=N>>>24)<=V);){if(F===0)break e;F--,U+=G[Z++]<<V,V+=8}if(We<16)U>>>=Ee,V-=Ee,j.lens[j.have++]=We;else{if(We===16){for(L=Ee+2;V<L;){if(F===0)break e;F--,U+=G[Z++]<<V,V+=8}if(U>>>=Ee,V-=Ee,j.have===0){P.msg="invalid bit length repeat",j.mode=30;break}C=j.lens[j.have-1],me=3+(3&U),U>>>=2,V-=2}else if(We===17){for(L=Ee+3;V<L;){if(F===0)break e;F--,U+=G[Z++]<<V,V+=8}V-=Ee,C=0,me=3+(7&(U>>>=Ee)),U>>>=3,V-=3}else{for(L=Ee+7;V<L;){if(F===0)break e;F--,U+=G[Z++]<<V,V+=8}V-=Ee,C=0,me=11+(127&(U>>>=Ee)),U>>>=7,V-=7}if(j.have+me>j.nlen+j.ndist){P.msg="invalid bit length repeat",j.mode=30;break}for(;me--;)j.lens[j.have++]=C}}if(j.mode===30)break;if(j.lens[256]===0){P.msg="invalid code -- missing end-of-block",j.mode=30;break}if(j.lenbits=9,ce={bits:j.lenbits},Q=d(u,j.lens,0,j.nlen,j.lencode,0,j.work,ce),j.lenbits=ce.bits,Q){P.msg="invalid literal/lengths set",j.mode=30;break}if(j.distbits=6,j.distcode=j.distdyn,ce={bits:j.distbits},Q=d(p,j.lens,j.nlen,j.ndist,j.distcode,0,j.work,ce),j.distbits=ce.bits,Q){P.msg="invalid distances set",j.mode=30;break}if(j.mode=20,W===6)break e;case 20:j.mode=21;case 21:if(6<=F&&258<=K){P.next_out=ee,P.avail_out=K,P.next_in=Z,P.avail_in=F,j.hold=U,j.bits=V,c(P,oe),ee=P.next_out,pe=P.output,K=P.avail_out,Z=P.next_in,G=P.input,F=P.avail_in,U=j.hold,V=j.bits,j.mode===12&&(j.back=-1);break}for(j.back=0;Me=(N=j.lencode[U&(1<<j.lenbits)-1])>>>16&255,We=65535&N,!((Ee=N>>>24)<=V);){if(F===0)break e;F--,U+=G[Z++]<<V,V+=8}if(Me&&!(240&Me)){for(Ie=Ee,Je=Me,Ue=We;Me=(N=j.lencode[Ue+((U&(1<<Ie+Je)-1)>>Ie)])>>>16&255,We=65535&N,!(Ie+(Ee=N>>>24)<=V);){if(F===0)break e;F--,U+=G[Z++]<<V,V+=8}U>>>=Ie,V-=Ie,j.back+=Ie}if(U>>>=Ee,V-=Ee,j.back+=Ee,j.length=We,Me===0){j.mode=26;break}if(32&Me){j.back=-1,j.mode=12;break}if(64&Me){P.msg="invalid literal/length code",j.mode=30;break}j.extra=15&Me,j.mode=22;case 22:if(j.extra){for(L=j.extra;V<L;){if(F===0)break e;F--,U+=G[Z++]<<V,V+=8}j.length+=U&(1<<j.extra)-1,U>>>=j.extra,V-=j.extra,j.back+=j.extra}j.was=j.length,j.mode=23;case 23:for(;Me=(N=j.distcode[U&(1<<j.distbits)-1])>>>16&255,We=65535&N,!((Ee=N>>>24)<=V);){if(F===0)break e;F--,U+=G[Z++]<<V,V+=8}if(!(240&Me)){for(Ie=Ee,Je=Me,Ue=We;Me=(N=j.distcode[Ue+((U&(1<<Ie+Je)-1)>>Ie)])>>>16&255,We=65535&N,!(Ie+(Ee=N>>>24)<=V);){if(F===0)break e;F--,U+=G[Z++]<<V,V+=8}U>>>=Ie,V-=Ie,j.back+=Ie}if(U>>>=Ee,V-=Ee,j.back+=Ee,64&Me){P.msg="invalid distance code",j.mode=30;break}j.offset=We,j.extra=15&Me,j.mode=24;case 24:if(j.extra){for(L=j.extra;V<L;){if(F===0)break e;F--,U+=G[Z++]<<V,V+=8}j.offset+=U&(1<<j.extra)-1,U>>>=j.extra,V-=j.extra,j.back+=j.extra}if(j.offset>j.dmax){P.msg="invalid distance too far back",j.mode=30;break}j.mode=25;case 25:if(K===0)break e;if(me=oe-K,j.offset>me){if((me=j.offset-me)>j.whave&&j.sane){P.msg="invalid distance too far back",j.mode=30;break}je=me>j.wnext?(me-=j.wnext,j.wsize-me):j.wnext-me,me>j.length&&(me=j.length),he=j.window}else he=pe,je=ee-j.offset,me=j.length;for(K<me&&(me=K),K-=me,j.length-=me;pe[ee++]=he[je++],--me;);j.length===0&&(j.mode=21);break;case 26:if(K===0)break e;pe[ee++]=j.length,K--,j.mode=21;break;case 27:if(j.wrap){for(;V<32;){if(F===0)break e;F--,U|=G[Z++]<<V,V+=8}if(oe-=K,P.total_out+=oe,j.total+=oe,oe&&(P.adler=j.check=j.flags?l(j.check,pe,oe,ee-oe):a(j.check,pe,oe,ee-oe)),oe=K,(j.flags?U:y(U))!==j.check){P.msg="incorrect data check",j.mode=30;break}V=U=0}j.mode=28;case 28:if(j.wrap&&j.flags){for(;V<32;){if(F===0)break e;F--,U+=G[Z++]<<V,V+=8}if(U!==(4294967295&j.total)){P.msg="incorrect length check",j.mode=30;break}V=U=0}j.mode=29;case 29:Q=1;break e;case 30:Q=-3;break e;case 31:return-4;case 32:default:return f}return P.next_out=ee,P.avail_out=K,P.next_in=Z,P.avail_in=F,j.hold=U,j.bits=V,(j.wsize||oe!==P.avail_out&&j.mode<30&&(j.mode<27||W!==4))&&q(P,P.output,P.next_out,oe-P.avail_out)?(j.mode=31,-4):(J-=P.avail_in,oe-=P.avail_out,P.total_in+=J,P.total_out+=oe,j.total+=oe,j.wrap&&oe&&(P.adler=j.check=j.flags?l(j.check,pe,oe,P.next_out-oe):a(j.check,pe,oe,P.next_out-oe)),P.data_type=j.bits+(j.last?64:0)+(j.mode===12?128:0)+(j.mode===20||j.mode===15?256:0),(J==0&&oe===0||W===4)&&Q===h&&(Q=-5),Q)},s.inflateEnd=function(P){if(!P||!P.state)return f;var W=P.state;return W.window&&(W.window=null),P.state=null,h},s.inflateGetHeader=function(P,W){var j;return P&&P.state&&2&(j=P.state).wrap?((j.head=W).done=!1,h):f},s.inflateSetDictionary=function(P,W){var j,G=W.length;return P&&P.state?(j=P.state).wrap!==0&&j.mode!==11?f:j.mode===11&&a(1,W,G,0)!==j.check?-3:q(P,W,G,G)?(j.mode=31,-4):(j.havedict=1,h):f},s.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(n,r,s){var i=n("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],d=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(u,p,h,f,m,g,v,y){var x,b,w,S,_,k,E,T,O,q=y.bits,P=0,W=0,j=0,G=0,pe=0,Z=0,ee=0,F=0,K=0,U=0,V=null,J=0,oe=new i.Buf16(16),me=new i.Buf16(16),je=null,he=0;for(P=0;P<=15;P++)oe[P]=0;for(W=0;W<f;W++)oe[p[h+W]]++;for(pe=q,G=15;1<=G&&oe[G]===0;G--);if(G<pe&&(pe=G),G===0)return m[g++]=20971520,m[g++]=20971520,y.bits=1,0;for(j=1;j<G&&oe[j]===0;j++);for(pe<j&&(pe=j),P=F=1;P<=15;P++)if(F<<=1,(F-=oe[P])<0)return-1;if(0<F&&(u===0||G!==1))return-1;for(me[1]=0,P=1;P<15;P++)me[P+1]=me[P]+oe[P];for(W=0;W<f;W++)p[h+W]!==0&&(v[me[p[h+W]]++]=W);if(k=u===0?(V=je=v,19):u===1?(V=a,J-=257,je=l,he-=257,256):(V=c,je=d,-1),P=j,_=g,ee=W=U=0,w=-1,S=(K=1<<(Z=pe))-1,u===1&&852<K||u===2&&592<K)return 1;for(;;){for(E=P-ee,O=v[W]<k?(T=0,v[W]):v[W]>k?(T=je[he+v[W]],V[J+v[W]]):(T=96,0),x=1<<P-ee,j=b=1<<Z;m[_+(U>>ee)+(b-=x)]=E<<24|T<<16|O|0,b!==0;);for(x=1<<P-1;U&x;)x>>=1;if(x!==0?(U&=x-1,U+=x):U=0,W++,--oe[P]==0){if(P===G)break;P=p[h+v[W]]}if(pe<P&&(U&S)!==w){for(ee===0&&(ee=pe),_+=j,F=1<<(Z=P-ee);Z+ee<G&&!((F-=oe[Z+ee])<=0);)Z++,F<<=1;if(K+=1<<Z,u===1&&852<K||u===2&&592<K)return 1;m[w=U&S]=pe<<24|Z<<16|_-g|0}}return U!==0&&(m[_+U]=P-ee<<24|64<<16|0),y.bits=pe,0}},{"../utils/common":41}],51:[function(n,r,s){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(n,r,s){var i=n("../utils/common"),a=0,l=1;function c(N){for(var I=N.length;0<=--I;)N[I]=0}var d=0,u=29,p=256,h=p+1+u,f=30,m=19,g=2*h+1,v=15,y=16,x=7,b=256,w=16,S=17,_=18,k=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],E=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],T=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],q=new Array(2*(h+2));c(q);var P=new Array(2*f);c(P);var W=new Array(512);c(W);var j=new Array(256);c(j);var G=new Array(u);c(G);var pe,Z,ee,F=new Array(f);function K(N,I,H,X,z){this.static_tree=N,this.extra_bits=I,this.extra_base=H,this.elems=X,this.max_length=z,this.has_stree=N&&N.length}function U(N,I){this.dyn_tree=N,this.max_code=0,this.stat_desc=I}function V(N){return N<256?W[N]:W[256+(N>>>7)]}function J(N,I){N.pending_buf[N.pending++]=255&I,N.pending_buf[N.pending++]=I>>>8&255}function oe(N,I,H){N.bi_valid>y-H?(N.bi_buf|=I<<N.bi_valid&65535,J(N,N.bi_buf),N.bi_buf=I>>y-N.bi_valid,N.bi_valid+=H-y):(N.bi_buf|=I<<N.bi_valid&65535,N.bi_valid+=H)}function me(N,I,H){oe(N,H[2*I],H[2*I+1])}function je(N,I){for(var H=0;H|=1&N,N>>>=1,H<<=1,0<--I;);return H>>>1}function he(N,I,H){var X,z,te=new Array(v+1),ye=0;for(X=1;X<=v;X++)te[X]=ye=ye+H[X-1]<<1;for(z=0;z<=I;z++){var Y=N[2*z+1];Y!==0&&(N[2*z]=je(te[Y]++,Y))}}function Ee(N){var I;for(I=0;I<h;I++)N.dyn_ltree[2*I]=0;for(I=0;I<f;I++)N.dyn_dtree[2*I]=0;for(I=0;I<m;I++)N.bl_tree[2*I]=0;N.dyn_ltree[2*b]=1,N.opt_len=N.static_len=0,N.last_lit=N.matches=0}function Me(N){8<N.bi_valid?J(N,N.bi_buf):0<N.bi_valid&&(N.pending_buf[N.pending++]=N.bi_buf),N.bi_buf=0,N.bi_valid=0}function We(N,I,H,X){var z=2*I,te=2*H;return N[z]<N[te]||N[z]===N[te]&&X[I]<=X[H]}function Ie(N,I,H){for(var X=N.heap[H],z=H<<1;z<=N.heap_len&&(z<N.heap_len&&We(I,N.heap[z+1],N.heap[z],N.depth)&&z++,!We(I,X,N.heap[z],N.depth));)N.heap[H]=N.heap[z],H=z,z<<=1;N.heap[H]=X}function Je(N,I,H){var X,z,te,ye,Y=0;if(N.last_lit!==0)for(;X=N.pending_buf[N.d_buf+2*Y]<<8|N.pending_buf[N.d_buf+2*Y+1],z=N.pending_buf[N.l_buf+Y],Y++,X===0?me(N,z,I):(me(N,(te=j[z])+p+1,I),(ye=k[te])!==0&&oe(N,z-=G[te],ye),me(N,te=V(--X),H),(ye=E[te])!==0&&oe(N,X-=F[te],ye)),Y<N.last_lit;);me(N,b,I)}function Ue(N,I){var H,X,z,te=I.dyn_tree,ye=I.stat_desc.static_tree,Y=I.stat_desc.has_stree,M=I.stat_desc.elems,ie=-1;for(N.heap_len=0,N.heap_max=g,H=0;H<M;H++)te[2*H]!==0?(N.heap[++N.heap_len]=ie=H,N.depth[H]=0):te[2*H+1]=0;for(;N.heap_len<2;)te[2*(z=N.heap[++N.heap_len]=ie<2?++ie:0)]=1,N.depth[z]=0,N.opt_len--,Y&&(N.static_len-=ye[2*z+1]);for(I.max_code=ie,H=N.heap_len>>1;1<=H;H--)Ie(N,te,H);for(z=M;H=N.heap[1],N.heap[1]=N.heap[N.heap_len--],Ie(N,te,1),X=N.heap[1],N.heap[--N.heap_max]=H,N.heap[--N.heap_max]=X,te[2*z]=te[2*H]+te[2*X],N.depth[z]=(N.depth[H]>=N.depth[X]?N.depth[H]:N.depth[X])+1,te[2*H+1]=te[2*X+1]=z,N.heap[1]=z++,Ie(N,te,1),2<=N.heap_len;);N.heap[--N.heap_max]=N.heap[1],function(fe,Se){var De,ke,ae,ue,Ge,Qe,et=Se.dyn_tree,ht=Se.max_code,lt=Se.stat_desc.static_tree,Le=Se.stat_desc.has_stree,de=Se.stat_desc.extra_bits,ne=Se.stat_desc.extra_base,ge=Se.stat_desc.max_length,He=0;for(ue=0;ue<=v;ue++)fe.bl_count[ue]=0;for(et[2*fe.heap[fe.heap_max]+1]=0,De=fe.heap_max+1;De<g;De++)ge<(ue=et[2*et[2*(ke=fe.heap[De])+1]+1]+1)&&(ue=ge,He++),et[2*ke+1]=ue,ht<ke||(fe.bl_count[ue]++,Ge=0,ne<=ke&&(Ge=de[ke-ne]),Qe=et[2*ke],fe.opt_len+=Qe*(ue+Ge),Le&&(fe.static_len+=Qe*(lt[2*ke+1]+Ge)));if(He!==0){do{for(ue=ge-1;fe.bl_count[ue]===0;)ue--;fe.bl_count[ue]--,fe.bl_count[ue+1]+=2,fe.bl_count[ge]--,He-=2}while(0<He);for(ue=ge;ue!==0;ue--)for(ke=fe.bl_count[ue];ke!==0;)ht<(ae=fe.heap[--De])||(et[2*ae+1]!==ue&&(fe.opt_len+=(ue-et[2*ae+1])*et[2*ae],et[2*ae+1]=ue),ke--)}}(N,I),he(te,ie,N.bl_count)}function C(N,I,H){var X,z,te=-1,ye=I[1],Y=0,M=7,ie=4;for(ye===0&&(M=138,ie=3),I[2*(H+1)+1]=65535,X=0;X<=H;X++)z=ye,ye=I[2*(X+1)+1],++Y<M&&z===ye||(Y<ie?N.bl_tree[2*z]+=Y:z!==0?(z!==te&&N.bl_tree[2*z]++,N.bl_tree[2*w]++):Y<=10?N.bl_tree[2*S]++:N.bl_tree[2*_]++,te=z,ie=(Y=0)===ye?(M=138,3):z===ye?(M=6,3):(M=7,4))}function Q(N,I,H){var X,z,te=-1,ye=I[1],Y=0,M=7,ie=4;for(ye===0&&(M=138,ie=3),X=0;X<=H;X++)if(z=ye,ye=I[2*(X+1)+1],!(++Y<M&&z===ye)){if(Y<ie)for(;me(N,z,N.bl_tree),--Y!=0;);else z!==0?(z!==te&&(me(N,z,N.bl_tree),Y--),me(N,w,N.bl_tree),oe(N,Y-3,2)):Y<=10?(me(N,S,N.bl_tree),oe(N,Y-3,3)):(me(N,_,N.bl_tree),oe(N,Y-11,7));te=z,ie=(Y=0)===ye?(M=138,3):z===ye?(M=6,3):(M=7,4)}}c(F);var ce=!1;function L(N,I,H,X){oe(N,(d<<1)+(X?1:0),3),function(z,te,ye,Y){Me(z),J(z,ye),J(z,~ye),i.arraySet(z.pending_buf,z.window,te,ye,z.pending),z.pending+=ye}(N,I,H)}s._tr_init=function(N){ce||(function(){var I,H,X,z,te,ye=new Array(v+1);for(z=X=0;z<u-1;z++)for(G[z]=X,I=0;I<1<<k[z];I++)j[X++]=z;for(j[X-1]=z,z=te=0;z<16;z++)for(F[z]=te,I=0;I<1<<E[z];I++)W[te++]=z;for(te>>=7;z<f;z++)for(F[z]=te<<7,I=0;I<1<<E[z]-7;I++)W[256+te++]=z;for(H=0;H<=v;H++)ye[H]=0;for(I=0;I<=143;)q[2*I+1]=8,I++,ye[8]++;for(;I<=255;)q[2*I+1]=9,I++,ye[9]++;for(;I<=279;)q[2*I+1]=7,I++,ye[7]++;for(;I<=287;)q[2*I+1]=8,I++,ye[8]++;for(he(q,h+1,ye),I=0;I<f;I++)P[2*I+1]=5,P[2*I]=je(I,5);pe=new K(q,k,p+1,h,v),Z=new K(P,E,0,f,v),ee=new K(new Array(0),T,0,m,x)}(),ce=!0),N.l_desc=new U(N.dyn_ltree,pe),N.d_desc=new U(N.dyn_dtree,Z),N.bl_desc=new U(N.bl_tree,ee),N.bi_buf=0,N.bi_valid=0,Ee(N)},s._tr_stored_block=L,s._tr_flush_block=function(N,I,H,X){var z,te,ye=0;0<N.level?(N.strm.data_type===2&&(N.strm.data_type=function(Y){var M,ie=4093624447;for(M=0;M<=31;M++,ie>>>=1)if(1&ie&&Y.dyn_ltree[2*M]!==0)return a;if(Y.dyn_ltree[18]!==0||Y.dyn_ltree[20]!==0||Y.dyn_ltree[26]!==0)return l;for(M=32;M<p;M++)if(Y.dyn_ltree[2*M]!==0)return l;return a}(N)),Ue(N,N.l_desc),Ue(N,N.d_desc),ye=function(Y){var M;for(C(Y,Y.dyn_ltree,Y.l_desc.max_code),C(Y,Y.dyn_dtree,Y.d_desc.max_code),Ue(Y,Y.bl_desc),M=m-1;3<=M&&Y.bl_tree[2*O[M]+1]===0;M--);return Y.opt_len+=3*(M+1)+5+5+4,M}(N),z=N.opt_len+3+7>>>3,(te=N.static_len+3+7>>>3)<=z&&(z=te)):z=te=H+5,H+4<=z&&I!==-1?L(N,I,H,X):N.strategy===4||te===z?(oe(N,2+(X?1:0),3),Je(N,q,P)):(oe(N,4+(X?1:0),3),function(Y,M,ie,fe){var Se;for(oe(Y,M-257,5),oe(Y,ie-1,5),oe(Y,fe-4,4),Se=0;Se<fe;Se++)oe(Y,Y.bl_tree[2*O[Se]+1],3);Q(Y,Y.dyn_ltree,M-1),Q(Y,Y.dyn_dtree,ie-1)}(N,N.l_desc.max_code+1,N.d_desc.max_code+1,ye+1),Je(N,N.dyn_ltree,N.dyn_dtree)),Ee(N),X&&Me(N)},s._tr_tally=function(N,I,H){return N.pending_buf[N.d_buf+2*N.last_lit]=I>>>8&255,N.pending_buf[N.d_buf+2*N.last_lit+1]=255&I,N.pending_buf[N.l_buf+N.last_lit]=255&H,N.last_lit++,I===0?N.dyn_ltree[2*H]++:(N.matches++,I--,N.dyn_ltree[2*(j[H]+p+1)]++,N.dyn_dtree[2*V(I)]++),N.last_lit===N.lit_bufsize-1},s._tr_align=function(N){oe(N,2,3),me(N,b,q),function(I){I.bi_valid===16?(J(I,I.bi_buf),I.bi_buf=0,I.bi_valid=0):8<=I.bi_valid&&(I.pending_buf[I.pending++]=255&I.bi_buf,I.bi_buf>>=8,I.bi_valid-=8)}(N)}},{"../utils/common":41}],53:[function(n,r,s){r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(n,r,s){(function(i){(function(a,l){if(!a.setImmediate){var c,d,u,p,h=1,f={},m=!1,g=a.document,v=Object.getPrototypeOf&&Object.getPrototypeOf(a);v=v&&v.setTimeout?v:a,c={}.toString.call(a.process)==="[object process]"?function(w){process.nextTick(function(){x(w)})}:function(){if(a.postMessage&&!a.importScripts){var w=!0,S=a.onmessage;return a.onmessage=function(){w=!1},a.postMessage("","*"),a.onmessage=S,w}}()?(p="setImmediate$"+Math.random()+"$",a.addEventListener?a.addEventListener("message",b,!1):a.attachEvent("onmessage",b),function(w){a.postMessage(p+w,"*")}):a.MessageChannel?((u=new MessageChannel).port1.onmessage=function(w){x(w.data)},function(w){u.port2.postMessage(w)}):g&&"onreadystatechange"in g.createElement("script")?(d=g.documentElement,function(w){var S=g.createElement("script");S.onreadystatechange=function(){x(w),S.onreadystatechange=null,d.removeChild(S),S=null},d.appendChild(S)}):function(w){setTimeout(x,0,w)},v.setImmediate=function(w){typeof w!="function"&&(w=new Function(""+w));for(var S=new Array(arguments.length-1),_=0;_<S.length;_++)S[_]=arguments[_+1];var k={callback:w,args:S};return f[h]=k,c(h),h++},v.clearImmediate=y}function y(w){delete f[w]}function x(w){if(m)setTimeout(x,0,w);else{var S=f[w];if(S){m=!0;try{(function(_){var k=_.callback,E=_.args;switch(E.length){case 0:k();break;case 1:k(E[0]);break;case 2:k(E[0],E[1]);break;case 3:k(E[0],E[1],E[2]);break;default:k.apply(l,E)}})(S)}finally{y(w),m=!1}}}}function b(w){w.source===a&&typeof w.data=="string"&&w.data.indexOf(p)===0&&x(+w.data.slice(p.length))}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,typeof As<"u"?As:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(_1);var cT=_1.exports;const dT=jl(cT);function uT(t){let e="",n=t;for(;n>=0;)e=String.fromCharCode(n%26+65)+e,n=Math.floor(n/26)-1;return e}function hT(t,e){return`${uT(t)}${e+1}`}async function S1(t,e,n="design"){const s=Math.ceil(e.width/1e3),i=Math.ceil(e.length/1e3);console.log(`[SLICER] Creating ${s}${i} grid (${s*i} tiles) for ${e.width}mm  ${e.length}mm design`);const c=new DOMParser().parseFromString(t,"image/svg+xml").querySelector("svg");if(!c)throw new Error("Invalid SVG content");const d=c.getAttribute("viewBox");let u,p;if(d){const k=d.split(/\s+/).map(Number);u=k[2],p=k[3]}else u=parseFloat(c.getAttribute("width"))||1024,p=parseFloat(c.getAttribute("height"))||1024;console.log(`[SLICER] SVG internal dimensions: ${u}  ${p}`);const h=u/e.width,f=p/e.length,m=1e3*h,g=1e3*f;console.log(`[SLICER] Tile size in SVG units: ${m}  ${g}`);const v=c.innerHTML,y=c.getAttribute("xmlns")||"http://www.w3.org/2000/svg",x=new dT,b=x.folder("tiles"),w=[];for(let k=0;k<i;k++){const E=[];for(let T=0;T<s;T++){const O=hT(T,k);E.push(O);const q=T*m,P=k*g,W=`${q} ${P} ${m} ${g}`,j=`<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="${y}" viewBox="${W}" width="1000mm" height="1000mm">
  <defs>
    <clipPath id="tile-clip">
      <rect x="${q}" y="${P}" width="${m}" height="${g}"/>
    </clipPath>
  </defs>
  <g clip-path="url(#tile-clip)">
${v}
  </g>
</svg>`,G=`${k1(n)}_${O}.svg`;b.file(G,j)}w.push(E)}const S=pT(w,e,n);x.file("layout-guide.txt",S);const _=await x.generateAsync({type:"blob"});return console.log(`[SLICER] Created ZIP with ${s*i} tiles`),_}function pT(t,e,n){const r=t.length,s=t[0].length;let i=`TPV Studio - Tile Layout Guide
================================

Design: ${n}
Total Size: ${e.width}mm  ${e.length}mm (${e.width/1e3}m  ${e.length/1e3}m)
Tile Size: 1000mm  1000mm (1m  1m)
Grid: ${s} columns  ${r} rows (${s*r} tiles)

Layout (view from above):
-------------------------

`;const a=6;i+=""+("".repeat(a)+"").repeat(s-1)+"".repeat(a)+`
`;for(let l=0;l<r;l++){i+="";for(let c=0;c<s;c++){const d=t[l][c],u=a-d.length,p=Math.floor(u/2),h=u-p;i+=" ".repeat(p)+d+" ".repeat(h)+""}i+=`
`,l<r-1?i+=""+("".repeat(a)+"").repeat(s-1)+"".repeat(a)+`
`:i+=""+("".repeat(a)+"").repeat(s-1)+"".repeat(a)+`
`}return i+=`
Installation Notes:
-------------------
- Each tile is exactly 1m  1m
- Tiles are named by column (A-Z) and row (1-${r})
- Start from top-left corner (A1) when laying out
- Tiles align perfectly when placed edge-to-edge
- Edge tiles may contain partial content if design isn't exactly divisible by 1m

Generated by TPV Studio
`,i}function k1(t){return t.replace(/[<>:"/\\|?*]/g,"_").replace(/\s+/g,"-").substring(0,50)}function j1(t,e){const n=URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download=e,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)}async function fT(t,e,n="design"){try{const r=await fetch(t);if(!r.ok)throw new Error(`Failed to fetch SVG: ${r.statusText}`);const s=await r.text(),i=await S1(s,e,n),a=`${k1(n)}-tiles-1mx1m.zip`;return j1(i,a),console.log(`[SLICER] Downloaded ${a}`),!0}catch(r){throw console.error("[SLICER] Failed to download tiles:",r),r}}var Ls;let mT=(Ls=class{static next(){return(++Ls.seed).toString(16).toUpperCase()}static peek(){return(Ls.seed+1).toString(16).toUpperCase()}},Ul(Ls,"seed",0),Ls);var Ff=mT;const gT=Ff;let yT=class{constructor(e=null){this.handle=gT.next(),this.ownerObjectHandle="0",this.subclassMarkers=[],e&&(Array.isArray(e)?this.subclassMarkers.push(...e):this.subclassMarkers.push(e))}tags(e){e.push(5,this.handle),e.push(330,this.ownerObjectHandle);for(const n of this.subclassMarkers)e.push(100,n)}};var Gt=yT;const xT=Gt;let vT=class extends xT{constructor(e,n,r){super(["AcDbSymbolTableRecord","AcDbLinetypeTableRecord"]),this.name=e,this.description=n,this.elements=r}tags(e){e.push(0,"LTYPE"),super.tags(e),e.push(2,this.name),e.push(3,this.description),e.push(70,0),e.push(72,65),e.push(73,this.elements.length),e.push(40,this.getElementsSum()),this.elements.forEach(n=>{e.push(49,n),e.push(74,0)})}getElementsSum(){return this.elements.reduce((e,n)=>e+Math.abs(n),0)}};var bT=vT;const wT=Gt;let _T=class extends wT{constructor(e,n,r=null){super(["AcDbSymbolTableRecord","AcDbLayerTableRecord"]),this.name=e,this.colorNumber=n,this.lineTypeName=r,this.shapes=[],this.trueColor=-1}tags(e){e.push(0,"LAYER"),super.tags(e),e.push(2,this.name),this.trueColor!==-1?e.push(420,this.trueColor):e.push(62,this.colorNumber),e.push(70,0),this.lineTypeName&&e.push(6,this.lineTypeName),e.push(390,1)}setTrueColor(e){this.trueColor=e}addShape(e){this.shapes.push(e),e.layer=this}getShapes(){return this.shapes}shapesTags(e,n){for(const r of this.shapes)r.ownerObjectHandle=e.handle,r.tags(n)}};var ST=_T;const kT=Gt;let jT=class extends kT{constructor(e){super("AcDbSymbolTable"),this.name=e,this.elements=[]}add(e){e.ownerObjectHandle=this.handle,this.elements.push(e)}tags(e){e.push(0,"TABLE"),e.push(2,this.name),super.tags(e),e.push(70,this.elements.length),this.elements.forEach(n=>{n.tags(e)}),e.push(0,"ENDTAB")}};var C1=jT;const CT=Gt,ET=C1;let TT=class extends ET{constructor(e){super(e),this.subclassMarkers.push("AcDbDimStyleTable")}tags(e){e.push(0,"TABLE"),e.push(2,this.name),CT.prototype.tags.call(this,e),e.push(70,this.elements.length),e.push(71,1);for(const n of this.elements)n.tags(e);e.push(0,"ENDTAB")}};var NT=TT;const PT=Gt;let RT=class extends PT{constructor(n){super(["AcDbSymbolTableRecord","AcDbTextStyleTableRecord"]);Ul(this,"fontFileName","txt");this.name=n}tags(n){n.push(0,"STYLE"),super.tags(n),n.push(2,this.name),n.push(70,0),n.push(40,0),n.push(41,1),n.push(50,0),n.push(71,0),n.push(42,1),n.push(3,this.fontFileName),n.push(4,"")}};var OT=RT;const AT=Gt;let MT=class extends AT{constructor(e,n){super(["AcDbSymbolTableRecord","AcDbViewportTableRecord"]),this.name=e,this.height=n}tags(e){e.push(0,"VPORT"),super.tags(e),e.push(2,this.name),e.push(40,this.height),e.push(70,0)}};var $T=MT;const LT=Gt;let DT=class extends LT{constructor(e){super(["AcDbSymbolTableRecord","AcDbRegAppTableRecord"]),this.name=e}tags(e){e.push(0,"APPID"),super.tags(e),e.push(2,this.name),e.push(70,0)}};var IT=DT;const q0=Gt;let zT=class extends q0{constructor(e){super(["AcDbEntity","AcDbBlockBegin"]),this.name=e,this.end=new q0(["AcDbEntity","AcDbBlockEnd"]),this.recordHandle=null}tags(e){e.push(0,"BLOCK"),super.tags(e),e.push(2,this.name),e.push(70,0),e.point(0,0),e.push(3,this.name),e.push(1,""),e.push(0,"ENDBLK"),this.end.tags(e)}};var FT=zT;const BT=Gt;let HT=class extends BT{constructor(e){super(["AcDbSymbolTableRecord","AcDbBlockTableRecord"]),this.name=e}tags(e){e.push(0,"BLOCK_RECORD"),super.tags(e),e.push(2,this.name),e.push(70,0),e.push(280,0),e.push(281,1)}};var UT=HT;const WT=Gt;let GT=class extends WT{constructor(){super("AcDbDictionary"),this.children={}}addChildDictionary(e,n){n.ownerObjectHandle=this.handle,this.children[e]=n}tags(e){e.push(0,"DICTIONARY"),super.tags(e),e.push(281,1);const n=Object.entries(this.children);for(const s of n){const[i,a]=s;e.push(3,i),e.push(350,a.handle)}const r=Object.values(this.children);for(const s of r)s.tags(e)}};var VT=GT;const YT=Gt;let qT=class extends YT{constructor(e,n,r,s){super(["AcDbEntity","AcDbLine"]),this.x1=e,this.y1=n,this.x2=r,this.y2=s}tags(e){e.push(0,"LINE"),super.tags(e),e.push(8,this.layer.name),e.point(this.x1,this.y1),e.push(11,this.x2),e.push(21,this.y2),e.push(31,0)}};var XT=qT;const ZT=Gt;let KT=class extends ZT{constructor(e,n,r,s,i,a){super(["AcDbEntity","AcDbLine"]),this.x1=e,this.y1=n,this.z1=r,this.x2=s,this.y2=i,this.z2=a}tags(e){e.push(0,"LINE"),super.tags(e),e.push(8,this.layer.name),e.point(this.x1,this.y1,this.z1),e.push(11,this.x2),e.push(21,this.y2),e.push(31,this.z2)}};var JT=KT;const QT=Gt;let eN=class extends QT{constructor(e,n,r,s,i){super(["AcDbEntity","AcDbCircle"]),this.x=e,this.y=n,this.r=r,this.startAngle=s,this.endAngle=i}tags(e){e.push(0,"ARC"),super.tags(e),e.push(8,this.layer.name),e.point(this.x,this.y),e.push(40,this.r),e.push(100,"AcDbArc"),e.push(50,this.startAngle),e.push(51,this.endAngle)}};var tN=eN;const nN=Gt;let rN=class extends nN{constructor(e,n,r){super(["AcDbEntity","AcDbCircle"]),this.x=e,this.y=n,this.r=r}tags(e){e.push(0,"CIRCLE"),super.tags(e),e.push(8,this.layer.name),e.point(this.x,this.y),e.push(40,this.r)}};var sN=rN;const iN=Gt;let oN=class extends iN{constructor(e,n,r,s,i,a,l,c){super(["AcDbEntity","AcDbCircle"]),this.x=e,this.y=n,this.z=r,this.r=s,this.thickness=i,this.extrusionDirectionX=a,this.extrusionDirectionY=l,this.extrusionDirectionZ=c}tags(e){e.push(0,"CIRCLE"),super.tags(e),e.push(8,this.layer.name),e.point(this.x,this.y,this.z),e.push(40,this.r),e.push(39,this.thickness),e.push(210,this.extrusionDirectionX),e.push(220,this.extrusionDirectionY),e.push(230,this.extrusionDirectionZ)}};var aN=oN;const lN=Gt,X0=["left","center","right"],Z0=["baseline","bottom","middle","top"];let cN=class extends lN{constructor(e,n,r,s,i,a="left",l="baseline"){super(["AcDbEntity","AcDbText"]),this.x=e,this.y=n,this.height=r,this.rotation=s,this.value=i,this.hAlign=a,this.vAlign=l}tags(e){e.push(0,"TEXT"),super.tags(e),e.push(8,this.layer.name),e.point(this.x,this.y),e.push(40,this.height),e.push(1,this.value),e.push(50,this.rotation),X0.includes(this.hAlign,1)||Z0.includes(this.vAlign,1)?(e.push(72,Math.max(X0.indexOf(this.hAlign),0)),e.push(11,this.x),e.push(21,this.y),e.push(31,0),e.push(100,"AcDbText"),e.push(73,Math.max(Z0.indexOf(this.vAlign),0))):e.push(100,"AcDbText")}};var dN=cN;const uN=Gt;let hN=class extends uN{constructor(e,n=!1,r=0,s=0){super(["AcDbEntity","AcDbPolyline"]),this.points=e,this.closed=n,this.startWidth=r,this.endWidth=s}tags(e){e.push(0,"LWPOLYLINE"),super.tags(e),e.push(8,this.layer.name),e.push(6,"ByLayer"),e.push(62,256),e.push(370,-1),e.push(90,this.points.length),e.push(70,this.closed?1:0),this.points.forEach(n=>{const[r,s,i]=n;e.push(10,r),e.push(20,s),(this.startWidth!==0||this.endWidth!==0)&&(e.push(40,this.startWidth),e.push(41,this.endWidth)),i!==void 0&&e.push(42,i)})}};var pN=hN;const fN=Gt;let mN=class extends fN{constructor(e,n,r){super(["AcDbEntity","AcDbVertex","AcDb3dPolylineVertex"]),this.x=e,this.y=n,this.z=r}tags(e){e.push(0,"VERTEX"),super.tags(e),e.push(8,this.layer.name),e.point(this.x,this.y,this.z),e.push(70,32)}};var gN=mN;const yN=Gt,xN=Ff,vN=gN;let bN=class extends yN{constructor(e){super(["AcDbEntity","AcDb3dPolyline"]),this.verticies=e.map(n=>{const[r,s,i]=n,a=new vN(r,s,i);return a.ownerObjectHandle=this.handle,a}),this.seqendHandle=xN.next()}tags(e){e.push(0,"POLYLINE"),super.tags(e),e.push(8,this.layer.name),e.push(66,1),e.push(70,0),e.point(0,0),this.verticies.forEach(n=>{n.layer=this.layer,n.tags(e)}),e.push(0,"SEQEND"),e.push(5,this.seqendHandle),e.push(100,"AcDbEntity"),e.push(8,this.layer.name)}};var wN=bN;const _N=Gt;let SN=class extends _N{constructor(e,n,r,s,i,a,l,c,d,u,p,h){super(["AcDbEntity","AcDbFace"]),this.x1=e,this.y1=n,this.z1=r,this.x2=s,this.y2=i,this.z2=a,this.x3=l,this.y3=c,this.z3=d,this.x4=u,this.y4=p,this.z4=h}tags(e){e.push(0,"3DFACE"),super.tags(e),e.push(8,this.layer.name),e.point(this.x1,this.y1,this.z1),e.push(11,this.x2),e.push(21,this.y2),e.push(31,this.z2),e.push(12,this.x3),e.push(22,this.y3),e.push(32,this.z3),e.push(13,this.x4),e.push(23,this.y4),e.push(33,this.z4)}};var kN=SN;const jN=Gt;let CN=class extends jN{constructor(e,n){super(["AcDbEntity","AcDbPoint"]),this.x=e,this.y=n}tags(e){e.push(0,"POINT"),super.tags(e),e.push(8,this.layer.name),e.point(this.x,this.y)}};var EN=CN;const TN=Gt;let NN=class extends TN{constructor(e,n=3,r=null,s=null,i=[]){if(super(["AcDbEntity","AcDbSpline"]),e.length<n+1)throw new Error(`For degree ${n} spline, expected at least ${n+1} control points, but received only ${e.length}`);if(r==null){r=[];for(let p=0;p<n+1;p++)r.push(0);for(let p=1;p<e.length-n;p++)r.push(p);for(let p=0;p<n+1;p++)r.push(e.length-n)}if(r.length!==e.length+n+1)throw new Error(`Invalid knot vector length. Expected ${e.length+n+1} but received ${r.length}.`);this.controlPoints=e,this.knots=r,this.fitPoints=i,this.degree=n,this.weights=s;const a=0,l=0,c=this.weights?1:0,d=1,u=0;this.type=a*1+l*2+c*4+d*8+u*16}tags(e){e.push(0,"SPLINE"),super.tags(e),e.push(8,this.layer.name),e.push(210,0),e.push(220,0),e.push(230,1),e.push(70,this.type),e.push(71,this.degree),e.push(72,this.knots.length),e.push(73,this.controlPoints.length),e.push(74,this.fitPoints.length),e.push(42,1e-7),e.push(43,1e-7),e.push(44,1e-10),this.knots.forEach(n=>{e.push(40,n)}),this.weights&&this.weights.forEach(n=>{e.push(41,n)}),this.controlPoints.forEach(n=>{e.point(n[0],n[1])})}};var PN=NN;const RN=Gt;let ON=class extends RN{constructor(e,n,r,s,i,a,l){super(["AcDbEntity","AcDbEllipse"]),this.x=e,this.y=n,this.majorAxisX=r,this.majorAxisY=s,this.axisRatio=i,this.startAngle=a,this.endAngle=l}tags(e){e.push(0,"ELLIPSE"),super.tags(e),e.push(8,this.layer.name),e.point(this.x,this.y),e.push(11,this.majorAxisX),e.push(21,this.majorAxisY),e.push(31,0),e.push(40,this.axisRatio),e.push(41,this.startAngle),e.push(42,this.endAngle)}};var AN=ON;let MN=class{constructor(){this.lines=[]}point(e,n,r=0){this.push(10,e),this.push(20,n),this.push(30,r)}start(e){this.push(0,"SECTION"),this.push(2,e)}end(){this.push(0,"ENDSEC")}addHeaderVariable(e,n){this.push(9,`$${e}`),n.forEach(r=>{this.push(r[0],r[1])})}push(e,n){this.lines.push(e,n)}toDxfString(){return this.lines.join(`
`)}};var $N=MN;const LN=bT,DN=ST,wc=C1,IN=NT,zN=OT,FN=$T,BN=IT,HN=FT,UN=UT,K0=VT,WN=XT,GN=JT,VN=tN,YN=sN,qN=aN,XN=dN,_c=pN,ZN=wN,KN=kN,JN=EN,QN=PN,eP=AN,tP=$N,nP=Ff;let Ko=class mi{constructor(){this.layers={},this.activeLayer=null,this.lineTypes={},this.headers={},this.tables={},this.blocks={},this.dictionary=new K0,this.setUnits("Unitless");for(const e of mi.LINE_TYPES)this.addLineType(e.name,e.description,e.elements);for(const e of mi.LAYERS)this.addLayer(e.name,e.colorNumber,e.lineTypeName);this.setActiveLayer("0"),this.generateAutocadExtras()}addLineType(e,n,r){return this.lineTypes[e]=new LN(e,n,r),this}addLayer(e,n,r){return this.layers[e]=new DN(e,n,r),this}setActiveLayer(e){return this.activeLayer=this.layers[e],this}addTable(e){const n=new wc(e);return this.tables[e]=n,n}addBlock(e){const n=new HN(e);return this.blocks[e]=n,n}drawLine(e,n,r,s){return this.activeLayer.addShape(new WN(e,n,r,s)),this}drawLine3d(e,n,r,s,i,a){return this.activeLayer.addShape(new GN(e,n,r,s,i,a)),this}drawPoint(e,n){return this.activeLayer.addShape(new JN(e,n)),this}drawRect(e,n,r,s,i,a){const l=r-e,c=s-n;a=a||0;let d=null;return i?d=new _c([[e+l-i,n,a],[e+l,n+i],[e+l,n+c-i,a],[e+l-i,n+c],[e+i,n+c,a],[e,n+c-i],[e,n+i,a],[e+i,n]],!0):d=new _c([[e,n],[e,n+c],[e+l,n+c],[e+l,n]],!0),this.activeLayer.addShape(d),this}drawPolygon(e,n,r,s,i=0,a=!1){const l=2*Math.PI/r,c=[];let d=s;const u=i*Math.PI/180;a&&(d=s/Math.cos(Math.PI/r));for(let p=0;p<r;p++)c.push([e+d*Math.sin(u+p*l),n+d*Math.cos(u+p*l)]);return this.activeLayer.addShape(new _c(c,!0)),this}drawArc(e,n,r,s,i){return this.activeLayer.addShape(new VN(e,n,r,s,i)),this}drawCircle(e,n,r){return this.activeLayer.addShape(new YN(e,n,r)),this}drawCylinder(e,n,r,s,i,a,l,c){return this.activeLayer.addShape(new qN(e,n,r,s,i,a,l,c)),this}drawText(e,n,r,s,i,a="left",l="baseline"){return this.activeLayer.addShape(new XN(e,n,r,s,i,a,l)),this}drawPolyline(e,n=!1,r=0,s=0){return this.activeLayer.addShape(new _c(e,n,r,s)),this}drawPolyline3d(e){return e.forEach(n=>{if(n.length!==3)throw"Require 3D coordinates"}),this.activeLayer.addShape(new ZN(e)),this}setTrueColor(e){return this.activeLayer.setTrueColor(e),this}drawSpline(e,n=3,r=null,s=null,i=[]){return this.activeLayer.addShape(new QN(e,n,r,s,i)),this}drawEllipse(e,n,r,s,i,a=0,l=2*Math.PI){return this.activeLayer.addShape(new eP(e,n,r,s,i,a,l)),this}drawFace(e,n,r,s,i,a,l,c,d,u,p,h){return this.activeLayer.addShape(new KN(e,n,r,s,i,a,l,c,d,u,p,h)),this}_ltypeTable(){const e=new wc("LTYPE"),n=Object.values(this.lineTypes);for(const r of n)e.add(r);return e}_layerTable(e){const n=new wc("LAYER"),r=Object.values(this.layers);for(const s of r)n.add(s);return n}header(e,n){return this.headers[e]=n,this}setUnits(e){return typeof mi.UNITS[e]<"u"?mi.UNITS[e]:mi.UNITS.Unitless,this.header("INSUNITS",[[70,mi.UNITS[e]]]),this}generateAutocadExtras(){this.headers.ACADVER||this.header("ACADVER",[[1,"AC1021"]]),this.lineTypes.ByBlock||this.addLineType("ByBlock","",[]),this.lineTypes.ByLayer||this.addLineType("ByLayer","",[]);let e=this.tables.VPORT;e||(e=this.addTable("VPORT"));let n=this.tables.STYLE;n||(n=this.addTable("STYLE")),this.tables.VIEW||this.addTable("VIEW"),this.tables.UCS||this.addTable("UCS");let r=this.tables.APPID;if(r||(r=this.addTable("APPID")),!this.tables.DIMSTYLE){const i=new IN("DIMSTYLE");this.tables.DIMSTYLE=i}e.add(new FN("*ACTIVE",1e3)),n.add(new zN("standard")),r.add(new BN("ACAD")),this.modelSpace=this.addBlock("*Model_Space"),this.addBlock("*Paper_Space");const s=new K0;this.dictionary.addChildDictionary("ACAD_GROUP",s)}_tagsManager(){const e=new tP,n=new wc("BLOCK_RECORD"),r=Object.values(this.blocks);for(const d of r){const u=new UN(d.name);n.add(u)}const s=this._ltypeTable(),i=this._layerTable();e.start("HEADER"),e.addHeaderVariable("HANDSEED",[[5,nP.peek()]]);const a=Object.entries(this.headers);for(const d of a){const[u,p]=d;e.addHeaderVariable(u,p)}e.end(),e.start("CLASSES"),e.end(),e.start("TABLES"),s.tags(e),i.tags(e);const l=Object.values(this.tables);for(const d of l)d.tags(e);n.tags(e),e.end(),e.start("BLOCKS");for(const d of r)d.tags(e);e.end(),e.start("ENTITIES");const c=Object.values(this.layers);for(const d of c)d.shapesTags(this.modelSpace,e);return e.end(),e.start("OBJECTS"),this.dictionary.tags(e),e.end(),e.push(0,"EOF"),e}toDxfString(){return this._tagsManager().toDxfString()}};Ko.ACI={LAYER:0,RED:1,YELLOW:2,GREEN:3,CYAN:4,BLUE:5,MAGENTA:6,WHITE:7};Ko.LINE_TYPES=[{name:"CONTINUOUS",description:"______",elements:[]},{name:"DASHED",description:"_ _ _ ",elements:[5,-5]},{name:"DOTTED",description:". . . ",elements:[0,-5]}];Ko.LAYERS=[{name:"0",colorNumber:Ko.ACI.WHITE,lineTypeName:"CONTINUOUS"}];Ko.UNITS={Unitless:0,Inches:1,Feet:2,Miles:3,Millimeters:4,Centimeters:5,Meters:6,Kilometers:7,Microinches:8,Mils:9,Yards:10,Angstroms:11,Nanometers:12,Microns:13,Decimeters:14,Decameters:15,Hectometers:16,Gigameters:17,"Astronomical units":18,"Light years":19,Parsecs:20};var rP=Ko,sP=rP;const iP=jl(sP);function oP(t,e=2){if(!t)return[];const n=[];let r=[],s=0,i=0,a=0,l=0;const c=aP(t);for(const d of c){const u=d.type,p=d.args;switch(u){case"M":r.length>0&&n.push(r),s=p[0],i=p[1],a=s,l=i,r=[{x:s,y:i}];break;case"m":r.length>0&&n.push(r),s+=p[0],i+=p[1],a=s,l=i,r=[{x:s,y:i}];break;case"L":s=p[0],i=p[1],r.push({x:s,y:i});break;case"l":s+=p[0],i+=p[1],r.push({x:s,y:i});break;case"H":s=p[0],r.push({x:s,y:i});break;case"h":s+=p[0],r.push({x:s,y:i});break;case"V":i=p[0],r.push({x:s,y:i});break;case"v":i+=p[0],r.push({x:s,y:i});break;case"C":{const h=gp(s,i,p[0],p[1],p[2],p[3],p[4],p[5],e);r.push(...h.slice(1)),s=p[4],i=p[5]}break;case"c":{const h=gp(s,i,s+p[0],i+p[1],s+p[2],i+p[3],s+p[4],i+p[5],e);r.push(...h.slice(1)),s+=p[4],i+=p[5]}break;case"Q":{const h=J0(s,i,p[0],p[1],p[2],p[3],e);r.push(...h.slice(1)),s=p[2],i=p[3]}break;case"q":{const h=J0(s,i,s+p[0],i+p[1],s+p[2],i+p[3],e);r.push(...h.slice(1)),s+=p[2],i+=p[3]}break;case"A":{const h=Q0(s,i,p[0],p[1],p[2],p[3],p[4],p[5],p[6],e);r.push(...h.slice(1)),s=p[5],i=p[6]}break;case"a":{const h=s+p[5],f=i+p[6],m=Q0(s,i,p[0],p[1],p[2],p[3],p[4],h,f,e);r.push(...m.slice(1)),s=h,i=f}break;case"Z":case"z":r.length>0&&(r.push({x:a,y:l}),s=a,i=l);break}}return r.length>0&&n.push(r),n}function aP(t){const e=[],n=/([MmLlHhVvCcSsQqTtAaZz])([^MmLlHhVvCcSsQqTtAaZz]*)/g,r=[...t.matchAll(n)];for(const s of r){const i=s[1],l=s[2].trim().split(/[\s,]+/).filter(c=>c.length>0).map(Number);e.push({type:i,args:l})}return e}function gp(t,e,n,r,s,i,a,l,c){const d=[{x:t,y:e}];return yp(t,e,n,r,s,i,a,l,c,d),d.push({x:a,y:l}),d}function yp(t,e,n,r,s,i,a,l,c,d){const u=a-t,p=l-e;if(Math.sqrt(u*u+p*p)<.001)return;const f=ey(n,r,t,e,a,l),m=ey(s,i,t,e,a,l);if(f<c&&m<c)return;const g=(t+n)/2,v=(e+r)/2,y=(n+s)/2,x=(r+i)/2,b=(s+a)/2,w=(i+l)/2,S=(g+y)/2,_=(v+x)/2,k=(y+b)/2,E=(x+w)/2,T=(S+k)/2,O=(_+E)/2;yp(t,e,g,v,S,_,T,O,c,d),d.push({x:T,y:O}),yp(T,O,k,E,b,w,a,l,c,d)}function J0(t,e,n,r,s,i,a){const l=t+.6666666666666666*(n-t),c=e+2/3*(r-e),d=s+2/3*(n-s),u=i+2/3*(r-i);return gp(t,e,l,c,d,u,s,i,a)}function Q0(t,e,n,r,s,i,a,l,c,d){if(n===0||r===0)return[{x:t,y:e},{x:l,y:c}];const u=lP(t,e,n,r,s,i,a,l,c);if(!u)return[{x:t,y:e},{x:l,y:c}];const{cx:p,cy:h,theta1:f,dtheta:m,rx:g,ry:v}=u,y=s*Math.PI/180,x=(g+v)/2,b=Math.abs(m)*x,w=Math.max(4,Math.ceil(b/(2*Math.sqrt(2*d*x)))),S=[];for(let _=0;_<=w;_++){const k=f+m*_/w,E=Math.cos(k),T=Math.sin(k),O=Math.cos(y),q=Math.sin(y),P=p+g*E*O-v*T*q,W=h+g*E*q+v*T*O;S.push({x:P,y:W})}return S}function lP(t,e,n,r,s,i,a,l,c){const d=s*Math.PI/180,u=Math.cos(d),p=Math.sin(d),h=(t-l)/2,f=(e-c)/2,m=u*h+p*f,g=-p*h+u*f;n=Math.abs(n),r=Math.abs(r);const v=m*m/(n*n)+g*g/(r*r);if(v>1){const K=Math.sqrt(v);n*=K,r*=K}const y=n*n,x=r*r,b=m*m,w=g*g;let S=(y*x-y*w-x*b)/(y*w+x*b);S<0&&(S=0);const _=(i!==a?1:-1)*Math.sqrt(S),k=_*(n*g)/r,E=_*-(r*m)/n,T=u*k-p*E+(t+l)/2,O=p*k+u*E+(e+c)/2,q=(m-k)/n,P=(g-E)/r,W=(-m-k)/n,j=(-g-E)/r,G=Math.sqrt(q*q+P*P),pe=(P>=0?1:-1)*Math.acos(q/G),Z=q*W+P*j,ee=q*j-P*W;let F=Math.acos(Math.max(-1,Math.min(1,Z/(G*Math.sqrt(W*W+j*j)))));return ee<0&&(F=-F),!a&&F>0&&(F-=2*Math.PI),a&&F<0&&(F+=2*Math.PI),{cx:T,cy:O,theta1:pe,dtheta:F,rx:n,ry:r}}function ey(t,e,n,r,s,i){const a=s-n,l=i-r,c=Math.sqrt(a*a+l*l);return c===0?Math.sqrt((t-n)**2+(e-r)**2):Math.abs((l*t-a*e+s*r-i*n)/c)}function cP(t,e,n,r,s=0,i=0){if(t=parseFloat(t)||0,e=parseFloat(e)||0,n=parseFloat(n)||0,r=parseFloat(r)||0,s=parseFloat(s)||0,i=parseFloat(i)||s,s===0&&i===0)return[{x:t,y:e},{x:t+n,y:e},{x:t+n,y:e+r},{x:t,y:e+r},{x:t,y:e}];s=Math.min(s,n/2),i=Math.min(i,r/2);const a=[],l=8;for(let c=0;c<=l;c++){const d=-Math.PI/2+Math.PI/2*(c/l);a.push({x:t+n-s+s*Math.cos(d),y:e+i+i*Math.sin(d)})}for(let c=0;c<=l;c++){const d=0+Math.PI/2*(c/l);a.push({x:t+n-s+s*Math.cos(d),y:e+r-i+i*Math.sin(d)})}for(let c=0;c<=l;c++){const d=Math.PI/2+Math.PI/2*(c/l);a.push({x:t+s+s*Math.cos(d),y:e+r-i+i*Math.sin(d)})}for(let c=0;c<=l;c++){const d=Math.PI+Math.PI/2*(c/l);a.push({x:t+s+s*Math.cos(d),y:e+i+i*Math.sin(d)})}return a.push(a[0]),a}function dP(t,e,n,r=32){t=parseFloat(t)||0,e=parseFloat(e)||0,n=parseFloat(n)||0;const s=[];for(let i=0;i<=r;i++){const a=2*Math.PI*i/r;s.push({x:t+n*Math.cos(a),y:e+n*Math.sin(a)})}return s}function uP(t,e,n,r,s=32){t=parseFloat(t)||0,e=parseFloat(e)||0,n=parseFloat(n)||0,r=parseFloat(r)||0;const i=[];for(let a=0;a<=s;a++){const l=2*Math.PI*a/s;i.push({x:t+n*Math.cos(l),y:e+r*Math.sin(l)})}return i}function hP(t){if(!t)return[];const e=t.trim().split(/[\s,]+/).map(Number),n=[];for(let r=0;r<e.length;r+=2)r+1<e.length&&n.push({x:e[r],y:e[r+1]});return n.length>0&&n.push({x:n[0].x,y:n[0].y}),n}function pP(t){if(!t)return[];const e=t.trim().split(/[\s,]+/).map(Number),n=[];for(let r=0;r<e.length;r+=2)r+1<e.length&&n.push({x:e[r],y:e[r+1]});return n}function fP(t,e,n,r){return[{x:parseFloat(t)||0,y:parseFloat(e)||0},{x:parseFloat(n)||0,y:parseFloat(r)||0}]}function mP(t,e){if(!e||!t.length)return t;const n=gP(e);return t.map(r=>xP(r,n))}function gP(t){let e=[1,0,0,1,0,0];const n=t.match(/\w+\([^)]+\)/g)||[];for(const r of n){const s=r.match(/(\w+)\(([^)]+)\)/);if(!s)continue;const i=s[1],a=s[2].split(/[\s,]+/).map(Number);let l;switch(i){case"translate":l=[1,0,0,1,a[0]||0,a[1]||0];break;case"scale":l=[a[0]||1,0,0,a[1]??a[0]??1,0,0];break;case"rotate":const c=(a[0]||0)*Math.PI/180,d=Math.cos(c),u=Math.sin(c);if(a.length===3){const p=a[1],h=a[2];l=[d,u,-u,d,p-d*p+u*h,h-u*p-d*h]}else l=[d,u,-u,d,0,0];break;case"matrix":for(l=a.slice(0,6);l.length<6;)l.push(0);break;default:continue}e=yP(e,l)}return e}function yP(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}function xP(t,e){return{x:e[0]*t.x+e[2]*t.y+e[4],y:e[1]*t.x+e[3]*t.y+e[5]}}const Zu={"#A5362F":"RH01","#E21F2F":"RH02","#609B63":"RH10","#3BB44A":"RH11","#006C55":"RH12","#0075BC":"RH20","#493D8C":"RH21","#47AFE3":"RH22","#039DC4":"RH23","#00A6A3":"RH26","#E4C4AA":"RH30","#E8E3D8":"RH31","#8B5F3C":"RH32","#E5A144":"RH40","#FFD833":"RH41","#F15B32":"RH50","#59595B":"RH60","#939598":"RH61","#D9D9D6":"RH65","#231F20":"RH70","#E8457E":"RH90"},Ku={RH01:1,RH02:1,RH10:3,RH11:3,RH12:3,RH20:5,RH21:6,RH22:4,RH23:4,RH26:4,RH30:52,RH31:7,RH32:38,RH40:2,RH41:2,RH50:30,RH60:8,RH61:8,RH65:9,RH70:250,RH90:6,OUTER_BORDER:2,NOTES:4};function vP(t,e){const{widthMm:n,lengthMm:r,designName:s="TPV Design",seed:i}=e,a=new iP,l=bP(t),c=n/l.width,d=r/l.height,u=new Map,p=t.querySelectorAll("path, rect, circle, ellipse, polygon, polyline, line");for(const f of p){const m=f.getAttribute("display"),g=f.getAttribute("visibility");if(m==="none"||g==="hidden")continue;const v=wP(f);if(!v||v==="none"||v==="transparent")continue;const x=_P(v)||"UNKNOWN";u.has(x)||u.set(x,[]);const b=SP(f);if(!b||b.length===0)continue;const w=f.getAttribute("transform"),_=(w?mP(b,w):b).map(k=>({x:k.x*c,y:r-k.y*d}));u.get(x).push(_)}for(const[f,m]of u){const g=Ku[f]||7;a.addLayer(f,g,"CONTINUOUS"),a.setActiveLayer(f);for(const v of m)if(v.length>=2){const y=v.length>2&&Math.abs(v[0].x-v[v.length-1].x)<.01&&Math.abs(v[0].y-v[v.length-1].y)<.01,x=v.map(b=>[b.x,b.y]);y&&x.length>1&&x.pop(),a.drawPolyline(x,y)}}a.addLayer("OUTER_BORDER",Ku.OUTER_BORDER,"CONTINUOUS"),a.setActiveLayer("OUTER_BORDER"),a.drawPolyline([[0,0],[n,0],[n,r],[0,r]],!0),a.addLayer("NOTES",Ku.NOTES,"CONTINUOUS"),a.setActiveLayer("NOTES");const h=[`Project: ${s}`,`Size: ${(n/1e3).toFixed(2)}m x ${(r/1e3).toFixed(2)}m`,`Generated: ${new Date().toISOString().split("T")[0]}`,i?`Seed: ${i}`:null,"TPV Studio | rosehilltpv.com"].filter(Boolean).join("\\P");return a.drawText(10,-50,100,0,h),a.toDxfString()}function bP(t){const e=t.getAttribute("viewBox");if(e){const[s,i,a,l]=e.split(/\s+/).map(Number);return{minX:s,minY:i,width:a,height:l}}const n=parseFloat(t.getAttribute("width"))||1e3,r=parseFloat(t.getAttribute("height"))||1e3;return{minX:0,minY:0,width:n,height:r}}function wP(t){const e=t.getAttribute("style");if(e){const r=e.match(/fill:\s*([^;]+)/i);if(r)return ty(r[1].trim())}const n=t.getAttribute("fill");return n?ty(n):"#000000"}function ty(t){if(!t)return null;if(t.startsWith("#"))return t.length===4?"#"+t[1]+t[1]+t[2]+t[2]+t[3]+t[3]:t.toUpperCase();const e=t.match(/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/i);if(e){const n=parseInt(e[1]).toString(16).padStart(2,"0"),r=parseInt(e[2]).toString(16).padStart(2,"0"),s=parseInt(e[3]).toString(16).padStart(2,"0");return`#${n}${r}${s}`.toUpperCase()}return t}function _P(t){if(!t)return null;const e=t.toUpperCase();if(Zu[e])return Zu[e];let n=null,r=1/0;const s=ny(e);if(!s)return null;for(const[i,a]of Object.entries(Zu)){const l=ny(i);if(!l)continue;const c=Math.sqrt(Math.pow(s.r-l.r,2)+Math.pow(s.g-l.g,2)+Math.pow(s.b-l.b,2));c<r&&(r=c,n=a)}return r<=50?n:null}function ny(t){if(!t||!t.startsWith("#"))return null;const e=t.match(/^#([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}function SP(t){switch(t.tagName.toLowerCase()){case"path":const n=t.getAttribute("d"),r=oP(n,2);return r.length>0?r[0]:[];case"rect":return cP(t.getAttribute("x"),t.getAttribute("y"),t.getAttribute("width"),t.getAttribute("height"),t.getAttribute("rx"),t.getAttribute("ry"));case"circle":return dP(t.getAttribute("cx"),t.getAttribute("cy"),t.getAttribute("r"),32);case"ellipse":return uP(t.getAttribute("cx"),t.getAttribute("cy"),t.getAttribute("rx"),t.getAttribute("ry"),32);case"polygon":return hP(t.getAttribute("points"));case"polyline":return pP(t.getAttribute("points"));case"line":return fP(t.getAttribute("x1"),t.getAttribute("y1"),t.getAttribute("x2"),t.getAttribute("y2"));default:return[]}}function kP(t,e="design.dxf"){const n=new Blob([t],{type:"application/dxf"}),r=URL.createObjectURL(n),s=document.createElement("a");s.href=r,s.download=e,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(r)}function jP(t){const e=t.cloneNode(!0),n=[".court-canvas__selection-outline",".transform-handles",".track-resize-handles",'[class*="selection"]','[class*="handle"]',"[stroke-dasharray]"];for(const r of n)e.querySelectorAll(r).forEach(s=>s.remove());return e}async function CP(t){const e=Object.values(t||{});return e.length===0?[]:(await Promise.all(e.map(async r=>{try{const s=await Ol(r.sourceDesignId),i=(s==null?void 0:s.design)||s;if(!i)return console.warn(`[EXPORT] Could not fetch design for motif ${r.id}`),null;console.log("[EXPORT] Loaded design for motif:",i.name),console.log("[EXPORT] Design has solid_recipes:",!!i.solid_recipes),console.log("[EXPORT] Design has blend_recipes:",!!i.blend_recipes);const a=r.scale||1,l=r.originalWidth_mm*a/1e3,c=r.originalHeight_mm*a/1e3,d=l*c,u=r.viewMode||"solid",p=u==="blend"?i.blend_recipes:i.solid_recipes;return console.log(`[EXPORT] Using ${u} recipes:`,(p==null?void 0:p.length)||0,"recipes"),{id:r.id,name:r.customName||r.sourceDesignName||i.name||"Motif",areaM2:d,viewMode:u,widthM:l,heightM:c,recipes:p||[]}}catch(s){return console.error(`[EXPORT] Error processing motif ${r.id}:`,s),null}}))).filter(Boolean)}function ry({svgRef:t}){const[e,n]=R.useState(!1),[r,s]=R.useState(null),i=R.useRef(null),a=it(w=>w.exportDesignData),l=it(w=>w.surface),c=it(w=>w.designName),d=it(w=>w.motifs),u=it(w=>w.shapes),p=it(w=>w.texts),h=it(w=>w.exclusionZones);R.useEffect(()=>{const w=S=>{i.current&&!i.current.contains(S.target)&&n(!1)};return e&&document.addEventListener("mousedown",w),()=>{document.removeEventListener("mousedown",w)}},[e]);const f=()=>t!=null&&t.current?t.current:document.querySelector(".court-canvas__svg"),m=async()=>{s("svg");try{const w=f();if(!w)throw new Error("Canvas not found");const S=a(),_=zf(w,S),k=Ta(S.name,"svg");aT(_,k)}catch(w){console.error("SVG export failed:",w),alert("Failed to export SVG: "+w.message)}finally{s(null),n(!1)}},g=async()=>{s("png");try{const w=f();if(!w)throw new Error("Canvas not found");const S=a(),_=Ta(S.name,"png");await lT(w,S,_,2)}catch(w){console.error("PNG export failed:",w),alert("Failed to export PNG: "+w.message)}finally{s(null),n(!1)}},v=async()=>{s("pdf"),n(!1);try{const w=f();if(!w)throw new Error("Canvas not found");const S=await Nr.getSession();if(!(S!=null&&S.access_token))throw new Error("Authentication required for PDF export");const _=a(),k=_.name||"TPV Design",E=w.cloneNode(!0);E.querySelectorAll('[class*="selected"], .transform-handles, .track-resize-handles, .court-canvas__selection-outline, [class*="selection"], [class*="handle"], [stroke-dasharray]').forEach(G=>G.remove()),E.setAttribute("xmlns","http://www.w3.org/2000/svg"),E.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");const T=new XMLSerializer().serializeToString(E);console.log("[EXPORT] Generating PDF report via API...");const O=await CP(d);console.log("[EXPORT] Motifs for PDF:",O.length);const q=await fetch("/api/export-sports-pdf",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${S.access_token}`},body:JSON.stringify({svgString:T,designName:k,surface:_.surface,courts:_.courts,tracks:_.tracks,shapes:u,texts:p,motifs:O,exclusionZones:h,dimensions:{widthMM:_.surface.width_mm,lengthMM:_.surface.length_mm}})});if(!q.ok){const G=await q.json().catch(()=>({error:"Unknown error"}));throw new Error(G.error||`Server error: ${q.status}`)}const P=await q.blob(),W=Ta(k,"pdf"),j=document.createElement("a");j.href=URL.createObjectURL(P),j.download=W,document.body.appendChild(j),j.click(),document.body.removeChild(j),URL.revokeObjectURL(j.href),console.log("[EXPORT] PDF downloaded:",W)}catch(w){console.error("PDF export failed:",w),alert("Failed to export PDF: "+w.message)}finally{s(null)}},y=async()=>{s("tiles"),n(!1);try{const w=f();if(!w)throw new Error("Canvas not found");const _=new XMLSerializer().serializeToString(w),k={width:l.width_mm,length:l.length_mm},E=c||"sports-surface",T=await S1(_,k,E),O=`${E.replace(/[^a-zA-Z0-9-_]/g,"-")}-tiles-1mx1m.zip`;j1(T,O),console.log("[EXPORT] Tiles ZIP downloaded:",O)}catch(w){console.error("Tiles export failed:",w),alert("Failed to export tiles: "+w.message)}finally{s(null)}},x=async()=>{s("dxf"),n(!1);try{const w=f();if(!w)throw new Error("Canvas not found");const S=a(),_=jP(w),k=vP(_,{widthMm:S.surface.width_mm,lengthMm:S.surface.length_mm,designName:S.name||"Sports Surface",seed:S.seed}),E=Ta(S.name,"dxf");kP(k,E),console.log("[EXPORT] DXF downloaded:",E)}catch(w){console.error("DXF export failed:",w),alert("Failed to export DXF: "+w.message)}finally{s(null)}},b=async()=>{s("canvas-pdf"),n(!1);try{const w=f();if(!w)throw new Error("Canvas not found");const S=await Nr.getSession();if(!(S!=null&&S.access_token))throw new Error("Authentication required for PDF export");const _=a(),k=_.name||"TPV Design",E=w.cloneNode(!0);E.querySelectorAll('[class*="selected"], .transform-handles, .track-resize-handles, .court-canvas__selection-outline, [class*="selection"], [class*="handle"], [stroke-dasharray]').forEach(j=>j.remove()),E.setAttribute("xmlns","http://www.w3.org/2000/svg"),E.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");const T=new XMLSerializer().serializeToString(E),O=await fetch("/api/export-canvas-pdf",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${S.access_token}`},body:JSON.stringify({svgString:T,designName:k,widthMm:_.surface.width_mm,lengthMm:_.surface.length_mm,designType:"sports"})});if(!O.ok){const j=await O.json().catch(()=>({error:"Unknown error"}));throw new Error(j.error||`Server error: ${O.status}`)}const q=await O.blob(),P=Ta(k,"pdf").replace(".pdf","-canvas.pdf"),W=document.createElement("a");W.href=URL.createObjectURL(q),W.download=P,document.body.appendChild(W),W.click(),document.body.removeChild(W),URL.revokeObjectURL(W.href),console.log("[EXPORT] Canvas PDF downloaded:",P)}catch(w){console.error("Canvas PDF export failed:",w),alert("Failed to export Canvas PDF: "+w.message)}finally{s(null)}};return o.jsxs("div",{className:"export-menu",ref:i,children:[o.jsxs("button",{className:"sports-toolbar__btn-export",onClick:()=>n(!e),title:"Export Design",children:["Export",o.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:e?"M18 15l-6-6-6 6":"M6 9l6 6 6-6"})})]}),e&&o.jsxs("div",{className:"export-menu__dropdown",children:[o.jsxs("button",{className:"export-menu__item",onClick:m,disabled:r!==null,children:[o.jsx("span",{className:"export-menu__icon",children:""}),o.jsxs("div",{className:"export-menu__item-content",children:[o.jsx("span",{className:"export-menu__item-title",children:r==="svg"?"Exporting...":"Download SVG"}),o.jsx("span",{className:"export-menu__item-desc",children:"Vector format for CAD/printing"})]})]}),o.jsxs("button",{className:"export-menu__item",onClick:g,disabled:r!==null,children:[o.jsx("span",{className:"export-menu__icon",children:""}),o.jsxs("div",{className:"export-menu__item-content",children:[o.jsx("span",{className:"export-menu__item-title",children:r==="png"?"Exporting...":"Download PNG"}),o.jsx("span",{className:"export-menu__item-desc",children:"High-res image for presentations"})]})]}),o.jsxs("button",{className:"export-menu__item",onClick:y,disabled:r!==null,children:[o.jsx("span",{className:"export-menu__icon",children:""}),o.jsxs("div",{className:"export-menu__item-content",children:[o.jsx("span",{className:"export-menu__item-title",children:r==="tiles"?"Generating...":"Download Tiles ZIP"}),o.jsx("span",{className:"export-menu__item-desc",children:"1m1m SVG tiles for large-format printing"})]})]}),o.jsx("div",{className:"export-menu__divider"}),o.jsxs("button",{className:"export-menu__item",onClick:v,disabled:r!==null,children:[o.jsx("span",{className:"export-menu__icon",children:""}),o.jsxs("div",{className:"export-menu__item-content",children:[o.jsx("span",{className:"export-menu__item-title",children:r==="pdf"?"Generating...":"Materials Report (PDF)"}),o.jsx("span",{className:"export-menu__item-desc",children:"TPV quantities & specifications"})]})]}),o.jsxs("button",{className:"export-menu__item",onClick:b,disabled:r!==null,children:[o.jsx("span",{className:"export-menu__icon",children:""}),o.jsxs("div",{className:"export-menu__item-content",children:[o.jsx("span",{className:"export-menu__item-title",children:r==="canvas-pdf"?"Generating...":"Canvas PDF (1:100)"}),o.jsx("span",{className:"export-menu__item-desc",children:"Scaled design with dimensions"})]})]}),o.jsx("div",{className:"export-menu__divider"}),o.jsxs("button",{className:"export-menu__item",onClick:x,disabled:r!==null,children:[o.jsx("span",{className:"export-menu__icon",children:""}),o.jsxs("div",{className:"export-menu__item-content",children:[o.jsx("span",{className:"export-menu__item-title",children:r==="dxf"?"Exporting...":"Download DXF"}),o.jsx("span",{className:"export-menu__item-desc",children:"CAD format for AutoCAD/Rhino"})]})]})]})]})}function EP({isOpen:t,onClose:e}){if(!t)return null;const n=[{category:"Selection",items:[{keys:["Delete"],description:"Remove selected element"},{keys:["Escape"],description:"Deselect element"}]},{category:"Edit",items:[{keys:["Ctrl","Z"],description:"Undo"},{keys:["Ctrl","Shift","Z"],description:"Redo"},{keys:["Ctrl","D"],description:"Duplicate selected"}]},{category:"Move",items:[{keys:["Arrow Keys"],description:"Nudge element (10mm)"},{keys:["Shift","Arrow Keys"],description:"Large nudge (100mm)"}]},{category:"Layers",items:[{keys:["["],description:"Send backward"},{keys:["]"],description:"Bring forward"}]},{category:"View",items:[{keys:["G"],description:"Toggle snap to grid"},{keys:["?"],description:"Show this help"}]}],s=navigator.platform.toUpperCase().indexOf("MAC")>=0?"":"Ctrl";return o.jsx("div",{className:"keyboard-shortcuts-overlay",onClick:e,style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},children:o.jsxs("div",{className:"keyboard-shortcuts-modal",onClick:i=>i.stopPropagation(),style:{background:"#fff",borderRadius:"8px",padding:"24px",maxWidth:"480px",width:"90%",maxHeight:"80vh",overflow:"auto",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.2)"},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[o.jsx("h2",{style:{margin:0,fontSize:"1.25rem",fontWeight:600},children:"Keyboard Shortcuts"}),o.jsx("button",{onClick:e,style:{background:"none",border:"none",fontSize:"1.5rem",cursor:"pointer",padding:"4px 8px",color:"#666"},"aria-label":"Close",children:""})]}),n.map(i=>o.jsxs("div",{style:{marginBottom:"20px"},children:[o.jsx("h3",{style:{fontSize:"0.75rem",fontWeight:600,textTransform:"uppercase",color:"#666",marginBottom:"8px",letterSpacing:"0.5px"},children:i.category}),o.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:i.items.map((a,l)=>o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 0"},children:[o.jsx("span",{style:{color:"#333",fontSize:"0.9rem"},children:a.description}),o.jsx("div",{style:{display:"flex",gap:"4px"},children:a.keys.map((c,d)=>o.jsx("kbd",{style:{display:"inline-block",padding:"4px 8px",fontSize:"0.75rem",fontFamily:"system-ui, -apple-system, sans-serif",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:"4px",boxShadow:"0 1px 2px rgba(0,0,0,0.1)",minWidth:"24px",textAlign:"center"},children:c==="Ctrl"?s:c},d))})]},l))})]},i.category)),o.jsxs("p",{style:{fontSize:"0.8rem",color:"#888",marginTop:"16px",paddingTop:"16px",borderTop:"1px solid #eee",marginBottom:0},children:["Press ",o.jsx("kbd",{style:{padding:"2px 6px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:"3px",fontSize:"0.75rem"},children:"?"})," at any time to show this help"]})]})})}class TP{async _getAuthHeaders(){const e=await Nr.getSession(),n={"Content-Type":"application/json"};return e!=null&&e.access_token&&(n.Authorization=`Bearer ${e.access_token}`),n}async generateRecraft(e){const n={prompt:e.prompt,width_mm:e.widthMM||5e3,length_mm:e.lengthMM||5e3,max_colours:e.maxColours||6,seed:e.seed||null},r=await this._getAuthHeaders(),s=await fetch("/api/recraft-generate",{method:"POST",headers:r,body:JSON.stringify(n)});if(!s.ok){const i=await s.json();throw new Error(i.error||"Recraft generation failed")}return s.json()}async vectorizeImage(e){const n={image_url:e.image_url,width_mm:e.width_mm||5e3,length_mm:e.length_mm||5e3,seed:e.seed||null},r=await this._getAuthHeaders(),s=await fetch("/api/recraft-vectorize",{method:"POST",headers:r,body:JSON.stringify(n)});if(!s.ok){const i=await s.json();throw new Error(i.error||"Vectorization failed")}return s.json()}async processUploadedSVG(e){const n={svg_url:e.svg_url,width_mm:e.width_mm||5e3,length_mm:e.length_mm||5e3},r=await this._getAuthHeaders(),s=await fetch("/api/process-uploaded-svg",{method:"POST",headers:r,body:JSON.stringify(n)});if(!s.ok){const i=await s.json();throw new Error(i.error||"SVG processing failed")}return s.json()}async getRecraftStatus(e){const n=await this._getAuthHeaders(),r=await fetch(`/api/studio-job-status?jobId=${e}`,{headers:n});if(!r.ok){const s=await r.json();throw new Error(s.error||"Status fetch failed")}return r.json()}async waitForRecraftCompletion(e,n=null,r=2e3){return new Promise((s,i)=>{const a=async()=>{var l,c,d,u;try{const p=await this.getRecraftStatus(e);n&&n(p),p.status==="completed"?((l=p.result)==null?void 0:l.svg_url)?(console.log("[API] Recraft job complete with SVG output"),s(p)):(console.error("[API] Recraft job completed but no SVG output"),i(new Error("Job completed but no output received"))):p.status==="failed"?(c=p.result)!=null&&c.svg_url?(console.warn("[API] Job failed compliance but has output (non-compliant)"),s(p)):i(new Error(p.error||"Job failed")):(p.status==="retrying"&&console.log(`[API] Retrying: ${(d=p.recraft)==null?void 0:d.attempt_current}/${(u=p.recraft)==null?void 0:u.attempt_max}`),setTimeout(a,r))}catch(p){i(p)}};a()})}async matchColor(e,n=2){const r=await fetch("/api/match-color",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({hex:e,max_components:n})});if(!r.ok){const s=await r.json();throw new Error(s.error||"Color matching failed")}return r.json()}async generateDesignName(e){const n={prompt:e.prompt,colors:e.colors||[],dimensions:e.dimensions||{}},r=await this._getAuthHeaders(),s=await fetch("/api/generate-design-name",{method:"POST",headers:r,body:JSON.stringify(n)});if(!s.ok){const i=await s.json();throw new Error(i.error||"Name generation failed")}return s.json()}async inspireSimpleCreateJob(e){const n={prompt:e.prompt,surface:{width_mm:e.lengthMM||5e3,height_mm:e.widthMM||5e3},max_colours:e.maxColours||6,try_simpler:e.trySimpler||!1};e.seed&&(n.seed=e.seed);const r=await fetch("/api/studio-inspire-simple",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!r.ok){const s=await r.json();throw new Error(s.message||"Unable to start design generation. Please check your connection and try again.")}return r.json()}async inspireSimpleGetStatus(e){const n=await this._getAuthHeaders(),r=await fetch(`/api/studio-job-status?jobId=${e}`,{headers:n});if(!r.ok){const s=await r.json();throw new Error(s.message||"Unable to check generation status. Please try again.")}return r.json()}async inspireSimpleWaitForCompletion(e,n=null,r=2e3){return new Promise((s,i)=>{const a=async()=>{var l;try{const c=await this.inspireSimpleGetStatus(e);n&&n(c),c.status==="completed"?((l=c.result)==null?void 0:l.final_url)?(console.log("[API] Job complete with JPG output, resolving"),s(c)):(console.log("[API] Job completed but no output received"),i(new Error("Job completed but no output received"))):c.status==="failed"?i(new Error(c.error||"Job failed")):setTimeout(a,r)}catch(c){i(c)}};a()})}async draftify(e){const n=await fetch(w0.DRAFTIFY,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok){const r=await n.json();throw new Error(r.message||"Unable to convert image to vector format. Please try a different image.")}return n.json()}async generateGeometric(e){const n={brief:e.prompt||e.brief,canvas:{width_mm:e.lengthMM||5e3,height_mm:e.widthMM||5e3},options:{mood:e.mood||"playful",composition:e.composition||"mixed",colorCount:e.maxColours||e.colorCount||5,seed:e.seed},validate:!0},r=await fetch(w0.GEOMETRIC_GENERATE,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!r.ok){const s=await r.json();throw new Error(s.message||"Unable to generate design. Please try a different prompt or settings.")}return r.json()}}const ui=new TP;function NP({recipes:t,onClose:e}){if(!t||t.length===0)return o.jsxs("div",{className:"solid-summary-empty",children:[o.jsx("p",{children:"No colours in design."}),o.jsx("button",{onClick:e,className:"close-button",children:"Close"})]});const n=t.reduce((r,s)=>r+s.targetColor.areaPct,0);return o.jsxs("div",{className:"solid-color-summary",children:[o.jsxs("div",{className:"summary-header",children:[o.jsx("h3",{children:"TPV Colours Used"}),o.jsx("button",{onClick:e,className:"close-button-icon",children:""})]}),o.jsx("div",{className:"summary-info",children:o.jsxs("p",{className:"summary-description",children:["This design uses ",o.jsx("strong",{children:t.length})," pure TPV colour",t.length!==1?"s":""," (no blending required)"]})}),o.jsx("div",{className:"colors-list",children:t.map((r,s)=>{const i=r.chosenRecipe.components[0],a=r.targetColor.areaPct;return o.jsxs("div",{className:"color-item",children:[o.jsx("div",{className:"color-swatch",style:{backgroundColor:r.blendColor.hex},title:`${i.code} - ${i.name}`}),o.jsxs("div",{className:"color-details",children:[o.jsxs("div",{className:"color-primary",children:[o.jsx("span",{className:"color-code",children:i.code}),o.jsx("span",{className:"color-name",children:i.name})]}),o.jsxs("div",{className:"color-secondary",children:[o.jsx("span",{className:"hex-value",children:r.blendColor.hex}),o.jsxs("span",{className:"coverage-badge",children:[a.toFixed(1),"%"]})]})]})]},s)})}),o.jsxs("div",{className:"summary-footer",children:[o.jsxs("div",{className:"footer-stat",children:[o.jsx("span",{className:"stat-label",children:"Total Coverage:"}),o.jsxs("span",{className:"stat-value",children:[n.toFixed(1),"%"]})]}),o.jsxs("div",{className:"footer-stat",children:[o.jsx("span",{className:"stat-label",children:"TPV Colours:"}),o.jsx("span",{className:"stat-value",children:t.length})]})]}),o.jsx("style",{jsx:!0,children:`
        .solid-color-summary {
          background: #fff;
          border-radius: 8px;
          border: 1px solid #ddd;
          padding: 2rem;
          max-width: 800px;
          margin: 2rem auto;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .solid-summary-empty {
          background: #fff;
          border-radius: 8px;
          padding: 2rem;
          text-align: center;
        }

        .summary-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 1.5rem;
          padding-bottom: 1rem;
          border-bottom: 2px solid #1a365d;
        }

        .summary-header h3 {
          margin: 0;
          color: #1a365d;
          font-size: 1.8rem;
        }

        .close-button-icon {
          background: none;
          border: none;
          font-size: 2rem;
          color: #666;
          cursor: pointer;
          padding: 0;
          width: 32px;
          height: 32px;
          line-height: 1;
          transition: color 0.2s;
        }

        .close-button-icon:hover {
          color: #333;
        }

        .summary-info {
          background: #f9f9f9;
          padding: 1rem;
          border-radius: 6px;
          margin-bottom: 1.5rem;
        }

        .summary-description {
          margin: 0;
          color: #333;
          font-size: 1rem;
          line-height: 1.5;
        }

        /* Colors List */
        .colors-list {
          display: flex;
          flex-direction: column;
          gap: 1rem;
          margin-bottom: 1.5rem;
        }

        .color-item {
          display: flex;
          align-items: center;
          gap: 1rem;
          padding: 1rem;
          background: #f9f9f9;
          border-radius: 6px;
          border: 1px solid #e0e0e0;
          transition: all 0.2s;
        }

        .color-item:hover {
          border-color: #ff6b35;
          box-shadow: 0 2px 8px rgba(255, 107, 53, 0.15);
        }

        .color-swatch {
          width: 60px;
          height: 60px;
          border-radius: 8px;
          border: 2px solid #ddd;
          flex-shrink: 0;
          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .color-details {
          flex: 1;
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .color-primary {
          display: flex;
          align-items: baseline;
          gap: 0.5rem;
        }

        .color-code {
          font-family: 'Courier New', monospace;
          font-weight: 700;
          font-size: 1.2rem;
          color: #1a365d;
        }

        .color-name {
          font-size: 1.1rem;
          color: #333;
          font-weight: 500;
        }

        .color-secondary {
          display: flex;
          align-items: center;
          gap: 1rem;
        }

        .hex-value {
          font-family: 'Courier New', monospace;
          font-size: 0.9rem;
          color: #666;
        }

        .coverage-badge {
          background: #ff6b35;
          color: white;
          padding: 0.25rem 0.75rem;
          border-radius: 12px;
          font-weight: 600;
          font-size: 0.9rem;
        }

        /* Summary Footer */
        .summary-footer {
          display: flex;
          justify-content: space-around;
          padding: 1.5rem;
          background: #f9f9f9;
          border-radius: 6px;
          border: 2px solid #ff6b35;
        }

        .footer-stat {
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 0.5rem;
        }

        .stat-label {
          font-size: 0.9rem;
          color: #666;
          font-weight: 500;
        }

        .stat-value {
          font-size: 1.5rem;
          font-weight: 700;
          color: #1a365d;
        }

        .close-button {
          padding: 0.75rem 1.5rem;
          background: #ff6b35;
          color: white;
          border: none;
          border-radius: 4px;
          font-weight: 600;
          cursor: pointer;
          transition: background 0.2s;
        }

        .close-button:hover {
          background: #e55a25;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
          .solid-color-summary {
            padding: 1rem;
          }

          .summary-header h3 {
            font-size: 1.4rem;
          }

          .color-item {
            flex-direction: column;
            align-items: flex-start;
          }

          .color-swatch {
            width: 100%;
            height: 50px;
          }

          .summary-footer {
            flex-direction: column;
            gap: 1rem;
          }
        }
      `})]})}function Bf({content:t,position:e="top"}){const[n,r]=R.useState(!1);return o.jsxs("div",{className:"help-icon-container",children:[o.jsx("button",{className:"help-icon",onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),onClick:s=>{s.preventDefault(),s.stopPropagation(),r(!n)},type:"button","aria-label":"Help",children:"?"}),n&&o.jsx("div",{className:`help-tooltip help-tooltip-${e}`,children:t}),o.jsx("style",{children:`
        .help-icon-container {
          position: relative;
          display: inline-block;
        }

        .help-icon {
          display: inline-flex;
          align-items: center;
          justify-content: center;
          width: 18px;
          height: 18px;
          border-radius: 50%;
          background: #6b7280;
          color: white;
          border: none;
          font-size: 12px;
          font-weight: 600;
          cursor: help;
          transition: all 0.2s;
          padding: 0;
          line-height: 1;
        }

        .help-icon:hover {
          background: #374151;
          transform: scale(1.1);
        }

        .help-tooltip {
          position: absolute;
          z-index: 1000;
          background: #1f2937;
          color: white;
          padding: 0.75rem 1rem;
          border-radius: 6px;
          font-size: 0.875rem;
          line-height: 1.5;
          max-width: 300px;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
          pointer-events: none;
          white-space: normal;
        }

        .help-tooltip-top {
          bottom: calc(100% + 8px);
          left: 50%;
          transform: translateX(-50%);
        }

        .help-tooltip-top::after {
          content: '';
          position: absolute;
          top: 100%;
          left: 50%;
          transform: translateX(-50%);
          border: 6px solid transparent;
          border-top-color: #1f2937;
        }

        .help-tooltip-bottom {
          top: calc(100% + 8px);
          left: 50%;
          transform: translateX(-50%);
        }

        .help-tooltip-bottom::after {
          content: '';
          position: absolute;
          bottom: 100%;
          left: 50%;
          transform: translateX(-50%);
          border: 6px solid transparent;
          border-bottom-color: #1f2937;
        }

        .help-tooltip-right {
          left: calc(100% + 8px);
          top: 50%;
          transform: translateY(-50%);
        }

        .help-tooltip-right::after {
          content: '';
          position: absolute;
          right: 100%;
          top: 50%;
          transform: translateY(-50%);
          border: 6px solid transparent;
          border-right-color: #1f2937;
        }

        .help-tooltip-left {
          right: calc(100% + 8px);
          top: 50%;
          transform: translateY(-50%);
        }

        .help-tooltip-left::after {
          content: '';
          position: absolute;
          left: 100%;
          top: 50%;
          transform: translateY(-50%);
          border: 6px solid transparent;
          border-left-color: #1f2937;
        }

        @media (max-width: 768px) {
          .help-tooltip {
            max-width: 250px;
            font-size: 0.8125rem;
            padding: 0.625rem 0.875rem;
          }
        }
      `})]})}function PP({recipes:t,mode:e="blend",onColorClick:n,selectedColor:r,editedColors:s,onResetAll:i}){if(!t||t.length===0)return null;const a=h=>!s||s.size===0?!1:s.has(h.originalColor.hex.toLowerCase()),l=h=>{if(!s||s.size===0)return!1;const f=s.get(h.originalColor.hex.toLowerCase());return(f==null?void 0:f.newHex)==="transparent"||(f==null?void 0:f.newHex)==="none"},c=s&&s.size>0,d=h=>{const f=h.toLowerCase();return pn.find(m=>m.hex.toLowerCase()===f)},u=h=>{if(l(h))return"Transparent";if(e==="solid"){const f=d(h.blendColor.hex);if(f)return`${f.code} - ${f.name}`}return h.blendColor.hex},p=h=>{if(!r)return!1;const f=r.blendHex||r.hex;return h.blendColor.hex===f||h.targetColor.hex===f};return o.jsxs("div",{className:"color-legend",children:[o.jsxs("div",{className:"legend-header",children:[o.jsxs("div",{className:"legend-header-left",children:[o.jsx("span",{className:"legend-title",children:"Colours"}),o.jsx(Bf,{content:"Click any colour to edit all instances of that colour across the design. Changes apply to every region using that colour.",position:"right"}),n&&o.jsx("span",{className:"edit-hint",children:"(click to edit)"})]}),c&&i&&o.jsx("button",{onClick:i,className:"reset-all-btn",title:"Reset all colours to original",children:"Reset All"})]}),o.jsx("div",{className:"legend-colors",children:t.map((h,f)=>o.jsxs("div",{className:`color-item ${n?"clickable":""} ${p(h)?"selected":""}`,onClick:()=>{n&&n({hex:h.targetColor.hex,originalHex:h.originalColor.hex,blendHex:h.blendColor.hex,areaPct:h.targetColor.areaPct,recipe:h.chosenRecipe,targetColor:h.targetColor,isAddedFromEdit:h.isAddedFromEdit||!1,chosenRecipe:h.chosenRecipe},"palette")},title:n?"Click to edit this colour":"",children:[o.jsxs("div",{className:"color-swatch-wrapper",children:[o.jsx("div",{className:`color-swatch ${l(h)?"transparent-swatch":""}`,style:l(h)?{}:{backgroundColor:h.blendColor.hex}}),l(h)&&o.jsx("span",{className:"transparent-indicator",title:"Made transparent",children:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",width:"14",height:"14",children:[o.jsx("circle",{cx:"12",cy:"12",r:"10"}),o.jsx("line",{x1:"4",y1:"4",x2:"20",y2:"20"})]})}),a(h)&&!l(h)&&o.jsx("span",{className:"edit-indicator",title:"Colour has been modified",children:o.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"12",height:"12",children:o.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"})})})]}),o.jsxs("div",{className:"color-info",children:[o.jsx("span",{className:e==="solid"?"tpv-label":"hex-value",children:u(h)}),o.jsxs("span",{className:"coverage",children:[h.targetColor.areaPct.toFixed(1),"%"]})]})]},f))}),o.jsx("style",{jsx:!0,children:`
        .color-legend {
          background: rgba(255, 255, 255, 0.95);
          border: 1px solid #ddd;
          border-radius: 8px;
          padding: 1rem;
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
          width: 100%;
        }

        .legend-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          gap: 0.5rem;
          margin-bottom: 0.75rem;
          padding-bottom: 0.5rem;
          border-bottom: 1px solid #e0e0e0;
        }

        .legend-header-left {
          display: flex;
          align-items: center;
          gap: 0.5rem;
        }

        .legend-title {
          font-weight: 600;
          color: #1a365d;
          font-size: 0.95rem;
        }

        .edit-hint {
          font-size: 0.75rem;
          color: #ff6b35;
          font-weight: normal;
        }

        .reset-all-btn {
          padding: 0.25rem 0.5rem;
          font-size: 0.7rem;
          font-weight: 600;
          color: #ff6b35;
          background: #fff5f0;
          border: 1px solid #ff6b35;
          border-radius: 4px;
          cursor: pointer;
          transition: all 0.2s;
        }

        .reset-all-btn:hover {
          background: #ff6b35;
          color: white;
        }

        .legend-colors {
          display: grid;
          grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
          gap: 0.75rem;
        }

        .color-item {
          display: flex;
          align-items: center;
          gap: 0.75rem;
          padding: 0.5rem;
          border-radius: 4px;
          background: white;
          border: 1px solid #e8e8e8;
          transition: all 0.2s;
        }

        .color-item.clickable {
          cursor: pointer;
        }

        .color-item.clickable:hover {
          border-color: #ff6b35;
          background: #fff9f7;
          box-shadow: 0 2px 4px rgba(255, 107, 53, 0.15);
          transform: translateY(-2px);
        }

        .color-item.selected {
          border-color: #ff6b35;
          border-width: 2px;
          background: #fff9f7;
          box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.2);
          transform: translateY(-2px);
        }

        .color-swatch-wrapper {
          position: relative;
          flex-shrink: 0;
        }

        .color-swatch {
          width: 40px;
          height: 40px;
          border-radius: 4px;
          border: 2px solid #ddd;
        }

        .color-swatch.transparent-swatch {
          background:
            linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%),
            linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%);
          background-size: 8px 8px;
          background-position: 0 0, 4px 4px;
          background-color: white;
          border-color: #999;
        }

        .transparent-indicator {
          position: absolute;
          top: -4px;
          right: -4px;
          width: 18px;
          height: 18px;
          background: #6b7280;
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          color: white;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }

        .transparent-indicator svg {
          width: 12px;
          height: 12px;
        }

        .edit-indicator {
          position: absolute;
          top: -4px;
          right: -4px;
          width: 16px;
          height: 16px;
          background: #ff6b35;
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          color: white;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }

        .edit-indicator svg {
          width: 10px;
          height: 10px;
        }

        .color-info {
          display: flex;
          flex-direction: column;
          gap: 0.25rem;
          font-size: 0.85rem;
        }

        .hex-value {
          font-family: 'Courier New', monospace;
          font-weight: 600;
          color: #333;
        }

        .tpv-label {
          font-weight: 600;
          color: #1a365d;
          font-size: 0.9rem;
        }

        .coverage {
          color: #666;
          font-size: 0.8rem;
        }

        /* Mobile - compact horizontal grid of swatches */
        @media (max-width: 768px) {
          .color-legend {
            padding: 0.75rem;
          }

          .legend-header {
            margin-bottom: 0.5rem;
            padding-bottom: 0.5rem;
          }

          .legend-title {
            font-size: 0.85rem;
          }

          .edit-hint {
            font-size: 0.7rem;
          }

          .reset-all-btn {
            font-size: 0.65rem;
            padding: 0.2rem 0.4rem;
            min-height: 28px;
          }

          /* Horizontal scrolling grid of swatches */
          .legend-colors {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            justify-content: flex-start;
          }

          .color-item {
            flex-direction: column;
            padding: 0.25rem;
            border-radius: 6px;
            width: auto;
            min-width: 44px;
          }

          /* Hide text info on mobile - just show swatches */
          .color-info {
            display: none;
          }

          .color-swatch {
            width: 44px;
            height: 44px;
            border-radius: 6px;
          }

          .color-item.selected {
            transform: none;
            box-shadow: 0 0 0 2px rgba(255, 107, 53, 0.4);
          }

          .color-item.clickable:hover {
            transform: none;
          }

          .edit-indicator {
            top: -2px;
            right: -2px;
            width: 14px;
            height: 14px;
          }

          .edit-indicator svg {
            width: 8px;
            height: 8px;
          }
        }

        @media (max-width: 480px) {
          .color-legend {
            padding: 0.5rem;
          }

          .legend-colors {
            gap: 0.35rem;
          }

          .color-swatch {
            width: 40px;
            height: 40px;
          }

          .color-item {
            min-width: 40px;
          }
        }
      `})]})}const RP=[{code:"RH01",name:"Standard Red",hex:"#A5362F"},{code:"RH02",name:"Bright Red",hex:"#E21F2F"},{code:"RH10",name:"Standard Green",hex:"#609B63"},{code:"RH11",name:"Bright Green",hex:"#3BB44A"},{code:"RH12",name:"Dark Green",hex:"#006C55"},{code:"RH20",name:"Standard Blue",hex:"#0075BC"},{code:"RH21",name:"Purple",hex:"#493D8C"},{code:"RH22",name:"Light Blue",hex:"#47AFE3"},{code:"RH23",name:"Azure",hex:"#039DC4"},{code:"RH26",name:"Turquoise",hex:"#00A6A3"},{code:"RH30",name:"Standard Beige",hex:"#E4C4AA"},{code:"RH31",name:"Cream",hex:"#E8E3D8"},{code:"RH32",name:"Brown",hex:"#8B5F3C"},{code:"RH90",name:"Funky Pink",hex:"#E8457E"},{code:"RH40",name:"Mustard Yellow",hex:"#E5A144"},{code:"RH41",name:"Bright Yellow",hex:"#FFD833"},{code:"RH50",name:"Orange",hex:"#F15B32"},{code:"RH60",name:"Dark Grey",hex:"#59595B"},{code:"RH61",name:"Light Grey",hex:"#939598"},{code:"RH65",name:"Pale Grey",hex:"#D9D9D6"},{code:"RH70",name:"Black",hex:"#231F20"}];function OP({blendSvgUrl:t,recipes:e,mode:n="blend",onColorClick:r,onRegionClick:s,onEyedropperCancel:i,onMakeTransparent:a,onSelectTPVColor:l,selectedColor:c,editedColors:d,onResetAll:u,designName:p="",onNameChange:h,isNameLoading:f=!1,onInSituClick:m,eyedropperActive:g=!1,eyedropperRegion:v=null,onRegionUndo:y,onRegionRedo:x,canUndo:b=!1,canRedo:w=!1,regionOverridesCount:S=0}){const[_,k]=R.useState(null),[E,T]=R.useState(null),O=R.useRef(null),q=R.useRef(null);R.useRef(null);const[P,W]=R.useState(1),[j,G]=R.useState({x:0,y:0}),[pe,Z]=R.useState(!1),[ee,F]=R.useState({x:0,y:0}),K=R.useRef(null),U=R.useRef(!1),[V,J]=R.useState(()=>localStorage.getItem("tpv_color_editing_tip_dismissed")!=="true"),oe=()=>{J(!1),localStorage.setItem("tpv_color_editing_tip_dismissed","true")};R.useEffect(()=>{if(!t){T(null);return}(async()=>{try{const H=await(await fetch(t)).text();T(H);const X=H.includes("data-region-id"),z=(H.match(/data-region-id/g)||[]).length;console.log("[SVGPreview] Fetched inline SVG content - length:",H.length,"hasRegionTags:",X,"regionCount:",z)}catch(I){console.error("[SVGPreview] Failed to fetch SVG content:",I),T(null)}})()},[t]);const me=R.useMemo(()=>{if(!E)return null;console.log("[SVGPreview] Sanitizing SVG content...");const N=Lf(E);return N?(console.log("[SVGPreview] SVG sanitization complete - length:",N.length),console.log("[SVGPreview] Sanitized content preview:",N.substring(0,200)),N.includes("<svg")?N.replace(/<svg([^>]*)>/i,(H,X)=>(X.includes("width=")||(X+=' width="100%"'),X.includes("height=")||(X+=' height="100%"'),`<svg${X}>`)):(console.error("[SVGPreview] Sanitized SVG does not contain <svg> tag!"),null)):(console.error("[SVGPreview] SVG sanitization failed - content rejected"),null)},[E]);R.useEffect(()=>{if(!c||!t){k(null);return}(async()=>{try{console.log("[SVGPreview] Creating highlight for color:",c);const I=new Image;I.crossOrigin="anonymous";const H=new Promise((ke,ae)=>{I.onload=()=>{console.log("[SVGPreview] Image loaded:",I.width,"x",I.height),ke()},I.onerror=ue=>{console.error("[SVGPreview] Image load error:",ue),ae(ue)}});I.src=t,await H;const X=document.createElement("canvas");X.width=I.naturalWidth||I.width||1e3,X.height=I.naturalHeight||I.height||1e3;const z=X.getContext("2d");z.drawImage(I,0,0);const ye=z.getImageData(0,0,X.width,X.height).data,Y=c.hex,M=je(Y);console.log("[SVGPreview] Target color:",Y,M);const ie=new Set;let fe=0;for(let ke=0;ke<X.height;ke++)for(let ae=0;ae<X.width;ae++){const ue=(ke*X.width+ae)*4,Ge=ye[ue],Qe=ye[ue+1],et=ye[ue+2];ye[ue+3]>0&&he(Ge,Qe,et,M)&&(ie.add(`${ae},${ke}`),fe++)}if(console.log("[SVGPreview] Matched pixels:",fe),fe===0){console.warn("[SVGPreview] No pixels matched the target color"),k(null);return}const Se=z.createImageData(X.width,X.height);for(let ke=0;ke<X.height;ke++)for(let ae=0;ae<X.width;ae++){const ue=(ke*X.width+ae)*4;ie.has(`${ae},${ke}`)&&(!ie.has(`${ae-1},${ke}`)||!ie.has(`${ae+1},${ke}`)||!ie.has(`${ae},${ke-1}`)||!ie.has(`${ae},${ke+1}`))&&(Se.data[ue]=255,Se.data[ue+1]=0,Se.data[ue+2]=255,Se.data[ue+3]=255)}z.clearRect(0,0,X.width,X.height),z.putImageData(Se,0,0);const De=X.toDataURL();console.log("[SVGPreview] Highlight mask created"),k(De)}catch(I){console.error("[SVGPreview] Failed to create highlight mask:",I),k(null)}})()},[c,t]);const je=N=>{const I=N.replace("#","");return{r:parseInt(I.substring(0,2),16),g:parseInt(I.substring(2,4),16),b:parseInt(I.substring(4,6),16)}},he=(N,I,H,X)=>Math.abs(N-X.r)<=50&&Math.abs(I-X.g)<=50&&Math.abs(H-X.b)<=50,Ee=async(N,I)=>{try{if(!O.current||!t)return null;const H=new Image;H.crossOrigin="anonymous";const X=new Promise((ke,ae)=>{H.onload=ke,H.onerror=ae});H.src=t,await X;const z=document.createElement("canvas");z.width=H.naturalWidth||H.width||1e3,z.height=H.naturalHeight||H.height||1e3;const te=z.getContext("2d");te.drawImage(H,0,0);const ye=O.current.getBoundingClientRect(),Y=z.width/ye.width,M=z.height/ye.height,ie=Math.floor(N*Y),fe=Math.floor(I*M),De=te.getImageData(ie,fe,1,1).data;return{r:De[0],g:De[1],b:De[2],a:De[3]}}catch(H){return console.error("[SVGPreview] Failed to get color at position:",H),null}},Me=()=>{W(N=>Math.min(N*1.5,5))},We=()=>{W(N=>Math.max(N/1.5,.5))},Ie=()=>{W(1),G({x:0,y:0})},Je=N=>{N.preventDefault();const I=N.deltaY*-.001;W(H=>Math.min(Math.max(H+I,.5),5))},Ue=N=>{N.button===0&&(Z(!0),F({x:N.clientX-j.x,y:N.clientY-j.y}),U.current=!1)},C=N=>{if(!pe)return;const I=Math.abs(N.clientX-(ee.x+j.x)),H=Math.abs(N.clientY-(ee.y+j.y));(I>5||H>5)&&(U.current=!0),G({x:N.clientX-ee.x,y:N.clientY-ee.y})},Q=()=>{Z(!1)};R.useEffect(()=>{if(pe)return document.addEventListener("mousemove",C),document.addEventListener("mouseup",Q),()=>{document.removeEventListener("mousemove",C),document.removeEventListener("mouseup",Q)}},[pe,ee,j]);const ce=N=>{let I=N;for(;I&&I!==q.current;){if(I.hasAttribute&&I.hasAttribute("data-region-id"))return I;I=I.parentElement}return null},L=async N=>{var Y,M;if(U.current){console.log("[SVGPreview] Click ignored - was dragging");return}if(console.log("[SVGPreview] Click detected - onRegionClick:",!!s,"inlineSvgContent:",!!E,"target:",N.target.tagName),s&&E){console.log("[SVGPreview] Attempting region detection on target:",N.target);const ie=ce(N.target);if(console.log("[SVGPreview] Found region element:",ie),ie){const fe=ie.getAttribute("data-region-id"),Se=ie.getAttribute("fill")||((M=(Y=ie.getAttribute("style"))==null?void 0:Y.match(/fill:\s*([^;]+)/))==null?void 0:M[1]);console.log("[SVGPreview] Region clicked:",fe,"fill:",Se),s({regionId:fe,sourceColor:Se,element:ie});return}else console.log("[SVGPreview] No region element found from target")}else console.log("[SVGPreview] Region detection skipped - onRegionClick:",!!s,"inlineSvgContent:",!!E);if(!r||!e||e.length===0)return;const I=N.currentTarget.getBoundingClientRect(),H=N.clientX-I.left,X=N.clientY-I.top;console.log("[SVGPreview] Clicked at:",H,X);const z=await Ee(H,X);if(!z||z.a===0){console.log("[SVGPreview] Clicked on transparent area");return}console.log("[SVGPreview] Clicked color:",z);let te=null,ye=1/0;for(const ie of e){const fe=ie.targetColor.hex,Se=je(fe);if(he(z.r,z.g,z.b,Se)){const De=Math.sqrt(Math.pow(z.r-Se.r,2)+Math.pow(z.g-Se.g,2)+Math.pow(z.b-Se.b,2));De<ye&&(ye=De,te=ie)}}te?(console.log("[SVGPreview] Matched recipe:",te.targetColor.hex),r({hex:te.targetColor.hex,originalHex:te.originalColor.hex,blendHex:te.blendColor.hex,areaPct:te.targetColor.areaPct,recipe:te.chosenRecipe,targetColor:te.targetColor,isAddedFromEdit:te.isAddedFromEdit||!1,chosenRecipe:te.chosenRecipe})):console.log("[SVGPreview] No matching recipe found for clicked color")};return t?o.jsxs("div",{className:"svg-preview",children:[o.jsxs("div",{className:"preview-header",children:[o.jsxs("div",{className:"design-name-container",children:[h?o.jsx("input",{type:"text",className:"design-name-input",value:p,onChange:N=>h(N.target.value),placeholder:f?"Generating name...":"Enter project name"}):o.jsx("h3",{children:p||"TPV Blend Design"}),f&&o.jsx("span",{className:"name-loading",children:"Generating..."})]}),c&&o.jsxs("span",{className:"editing-hint",children:["Editing: ",c.hex||c.blendHex]})]}),V&&r&&o.jsxs("div",{className:"color-editing-tip",children:[o.jsx("div",{className:"tip-icon",children:""}),o.jsxs("div",{className:"tip-content",children:[o.jsx("strong",{children:"Tip:"})," Click colours in the legend below to edit all instances, or click directly on the design to edit individual regions."]}),o.jsx("button",{onClick:oe,className:"tip-close",title:"Dismiss tip",children:""})]}),o.jsxs("div",{className:"svg-display-container",children:[o.jsxs("div",{className:"svg-panel",children:[o.jsxs("div",{className:"zoom-controls",children:[o.jsx("button",{onClick:Me,className:"zoom-btn",title:"Zoom In",children:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"11",cy:"11",r:"8"}),o.jsx("line",{x1:"11",y1:"8",x2:"11",y2:"14"}),o.jsx("line",{x1:"8",y1:"11",x2:"14",y2:"11"}),o.jsx("path",{d:"m21 21-4.35-4.35"})]})}),o.jsx("button",{onClick:We,className:"zoom-btn",title:"Zoom Out",children:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"11",cy:"11",r:"8"}),o.jsx("line",{x1:"8",y1:"11",x2:"14",y2:"11"}),o.jsx("path",{d:"m21 21-4.35-4.35"})]})}),o.jsx("button",{onClick:Ie,className:"zoom-btn",title:"Reset View",children:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M1 4v6h6"}),o.jsx("path",{d:"M23 20v-6h-6"}),o.jsx("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})]})}),o.jsxs("span",{className:"zoom-level",children:[Math.round(P*100),"%"]})]}),S>0&&o.jsxs("div",{className:"undo-redo-controls",children:[o.jsx("button",{onClick:y,className:"undo-redo-btn",title:"Undo (Ctrl+Z)",disabled:!b,children:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M3 7v6h6"}),o.jsx("path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13"})]})}),o.jsx("button",{onClick:x,className:"undo-redo-btn",title:"Redo (Ctrl+Y)",disabled:!w,children:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M21 7v6h-6"}),o.jsx("path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7"})]})})]}),m&&o.jsxs("button",{onClick:m,className:"in-situ-btn",title:"Upload a photo of your installation site and see how this design will look in place with realistic perspective",children:[o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),o.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),o.jsx("path",{d:"m21 15-5-5L5 21"})]}),o.jsx("span",{children:"Preview In-Situ"})]}),o.jsx("div",{ref:K,className:"svg-wrapper",onWheel:Je,children:o.jsxs("div",{className:"svg-image-container",onClick:L,onMouseDown:Ue,style:{transform:`translate(${j.x}px, ${j.y}px) scale(${P})`,cursor:pe?"grabbing":P>1?"grab":g?"crosshair":r?"pointer":"default"},children:[me?o.jsx("div",{ref:q,className:"svg-inline-container",style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},dangerouslySetInnerHTML:{__html:me}}):o.jsx("img",{ref:O,src:t,alt:"TPV blend design",className:"svg-image"}),_&&o.jsx("img",{src:_,alt:"Colour highlight",className:"svg-highlight-mask"})]})}),g&&v&&o.jsx("div",{className:"eyedropper-overlay",children:o.jsxs("div",{className:"eyedropper-content",children:[o.jsx("div",{className:"eyedropper-header",children:o.jsxs("div",{className:"eyedropper-color-indicator",children:[o.jsx("div",{className:"eyedropper-color-swatch",style:{backgroundColor:v.sourceColor}}),o.jsx("span",{children:"Click another area to copy its colour, or select a TPV colour:"})]})}),o.jsx("div",{className:"eyedropper-palette",children:o.jsx("div",{className:"palette-grid",children:RP.map(N=>o.jsx("button",{className:"palette-swatch",style:{backgroundColor:N.hex},onClick:I=>{I.stopPropagation(),l&&l({hex:N.hex,code:N.code,name:N.name})},title:`${N.name} (${N.code})`},N.code))})}),o.jsxs("div",{className:"eyedropper-actions",children:[o.jsxs("button",{className:"eyedropper-transparent",onClick:N=>{N.stopPropagation(),a&&a()},title:"Remove fill from this region",children:[o.jsx("span",{className:"transparent-icon",children:""}),"Make Transparent"]}),o.jsx("button",{className:"eyedropper-cancel",onClick:N=>{N.stopPropagation(),i&&i()},children:"Cancel (Esc)"})]})]})})]}),e&&e.length>0&&o.jsx("div",{className:"legend-sidebar",children:o.jsx(PP,{recipes:e,mode:n,onColorClick:r,selectedColor:c,editedColors:d,onResetAll:u})})]}),o.jsx("style",{jsx:!0,children:`
        .svg-preview {
          background: #fff;
          border-radius: 8px;
          border: 1px solid #ddd;
          padding: 1.5rem;
          margin-top: 1.5rem;
        }

        .preview-header {
          margin-bottom: 1.5rem;
          display: flex;
          align-items: center;
          justify-content: space-between;
          flex-wrap: wrap;
          gap: 0.5rem;
        }

        .design-name-container {
          display: flex;
          align-items: center;
          gap: 0.75rem;
          flex: 1;
        }

        .preview-header h3 {
          margin: 0;
          color: #1a365d;
          font-size: 1.5rem;
        }

        .design-name-input {
          font-family: var(--font-heading), 'Overpass', sans-serif;
          font-size: 1.5rem;
          font-weight: 600;
          color: #1a365d;
          border: none;
          border-bottom: 2px solid transparent;
          background: transparent;
          padding: 0.25rem 0;
          width: 100%;
          max-width: 400px;
          transition: border-color 0.2s;
        }

        .design-name-input:hover {
          border-bottom-color: #e5e7eb;
        }

        .design-name-input:focus {
          outline: none;
          border-bottom-color: #ff6b35;
        }

        .design-name-input::placeholder {
          color: #9ca3af;
          font-weight: normal;
        }

        .name-loading {
          font-size: 0.75rem;
          color: #9ca3af;
          font-style: italic;
        }

        /* Color Editing Tip Banner */
        .color-editing-tip {
          display: flex;
          align-items: center;
          gap: 0.75rem;
          padding: 0.875rem 1rem;
          background: linear-gradient(to right, #fff7ed, #fffbeb);
          border: 1px solid #fed7aa;
          border-radius: 6px;
          margin-bottom: 1rem;
          font-size: 0.875rem;
          line-height: 1.5;
        }

        .tip-icon {
          font-size: 1.25rem;
          flex-shrink: 0;
        }

        .tip-content {
          flex: 1;
          color: #78350f;
        }

        .tip-content strong {
          color: #92400e;
        }

        .tip-close {
          background: none;
          border: none;
          font-size: 1.5rem;
          color: #92400e;
          cursor: pointer;
          padding: 0;
          line-height: 1;
          opacity: 0.6;
          transition: opacity 0.2s;
          flex-shrink: 0;
        }

        .tip-close:hover {
          opacity: 1;
        }

        /* SVG Display */
        .svg-display-container {
          display: flex;
          flex-direction: column;
          gap: 1.5rem;
          align-items: stretch;
        }

        .svg-panel {
          position: relative;
          flex: 1;
          border: 1px solid #e0e0e0;
          border-radius: 6px;
          overflow: hidden;
          background: #fafafa;
        }

        /* Zoom Controls */
        .zoom-controls {
          position: absolute;
          top: 1rem;
          right: 1rem;
          display: flex;
          gap: 0.5rem;
          background: white;
          border-radius: 8px;
          padding: 0.5rem;
          box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
          z-index: 10;
          align-items: center;
        }

        .zoom-btn {
          display: flex;
          align-items: center;
          justify-content: center;
          width: 36px;
          height: 36px;
          padding: 0;
          background: white;
          border: 1px solid #e0e0e0;
          border-radius: 6px;
          cursor: pointer;
          color: #1a365d;
          transition: all 0.2s ease;
        }

        .zoom-btn:hover {
          background: #f8fafc;
          border-color: #1e4a7a;
          transform: translateY(-1px);
          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .zoom-btn:active {
          transform: translateY(0);
        }

        .zoom-btn svg {
          width: 20px;
          height: 20px;
        }

        .zoom-level {
          font-size: 0.875rem;
          font-weight: 600;
          color: #1a365d;
          min-width: 50px;
          text-align: center;
          padding: 0 0.5rem;
        }

        /* Undo/Redo Controls */
        .undo-redo-controls {
          position: absolute;
          top: 5rem;
          right: 1rem;
          display: flex;
          gap: 0.5rem;
          background: white;
          border-radius: 8px;
          padding: 0.5rem;
          box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
          z-index: 10;
        }

        .undo-redo-btn {
          display: flex;
          align-items: center;
          justify-content: center;
          width: 36px;
          height: 36px;
          padding: 0;
          background: white;
          border: 1px solid #e0e0e0;
          border-radius: 6px;
          cursor: pointer;
          color: #1a365d;
          transition: all 0.2s ease;
        }

        .undo-redo-btn:hover:not(:disabled) {
          background: #f8fafc;
          border-color: #1e4a7a;
          transform: translateY(-1px);
          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .undo-redo-btn:active:not(:disabled) {
          transform: translateY(0);
        }

        .undo-redo-btn:disabled {
          opacity: 0.4;
          cursor: not-allowed;
        }

        .undo-redo-btn svg {
          width: 20px;
          height: 20px;
        }

        .in-situ-btn {
          position: absolute;
          top: 1rem;
          left: 1rem;
          display: flex;
          align-items: center;
          gap: 0.5rem;
          padding: 0.5rem 1rem;
          background: #ff6b35;
          color: white;
          border: none;
          border-radius: 6px;
          font-size: 0.875rem;
          font-weight: 500;
          cursor: pointer;
          box-shadow: 0 2px 12px rgba(255, 107, 53, 0.3);
          z-index: 10;
          transition: all 0.2s ease;
        }

        .in-situ-btn:hover {
          background: #e55a2b;
          transform: translateY(-1px);
          box-shadow: 0 4px 16px rgba(255, 107, 53, 0.4);
        }

        .in-situ-btn:active {
          transform: translateY(0);
        }

        .in-situ-btn svg {
          width: 18px;
          height: 18px;
        }

        .svg-wrapper {
          padding: 2rem;
          background: white;
          min-height: 400px;
          display: flex;
          align-items: center;
          justify-content: center;
          overflow: hidden;
          position: relative;
        }

        .svg-image-container {
          position: relative;
          display: inline-block;
          user-select: none;
          transition: transform 0.1s ease-out;
          transform-origin: center center;
        }

        .svg-image {
          max-width: 100%;
          height: auto;
          display: block;
          border-radius: 4px;
          pointer-events: ${r?"auto":"none"};
        }

        .svg-inline-container {
          max-width: 100%;
          display: block;
          border-radius: 4px;
        }

        .svg-inline-container svg {
          max-width: 100%;
          height: auto;
          display: block;
        }

        .svg-highlight-mask {
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          pointer-events: none;
          border-radius: 4px;
          filter: drop-shadow(0 0 3px rgba(255, 0, 255, 0.8)) drop-shadow(0 0 1px rgba(0, 0, 0, 0.6));
          animation: pulse 2s ease-in-out infinite;
        }

        .eyedropper-overlay {
          position: absolute;
          top: 20px;
          left: 50%;
          transform: translateX(-50%);
          z-index: 100;
        }

        .eyedropper-content {
          background: white;
          border-radius: 12px;
          padding: 16px 20px;
          box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
          display: flex;
          flex-direction: column;
          gap: 12px;
          border: 2px solid #3b82f6;
          max-width: 320px;
        }

        .eyedropper-header {
          display: flex;
          align-items: center;
          gap: 12px;
        }

        .eyedropper-color-indicator {
          display: flex;
          align-items: center;
          gap: 12px;
          font-size: 0.9rem;
          font-weight: 500;
          color: #111827;
        }

        .eyedropper-color-swatch {
          width: 28px;
          height: 28px;
          border-radius: 6px;
          border: 2px solid #d1d5db;
          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
          flex-shrink: 0;
        }

        .eyedropper-palette {
          padding: 10px;
          background: #f9fafb;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
        }

        .palette-grid {
          display: grid;
          grid-template-columns: repeat(7, 1fr);
          gap: 4px;
        }

        .palette-swatch {
          width: 32px;
          height: 32px;
          border: 2px solid rgba(0, 0, 0, 0.15);
          border-radius: 4px;
          cursor: pointer;
          padding: 0;
          transition: all 0.15s ease;
        }

        .palette-swatch:hover {
          transform: scale(1.15);
          z-index: 1;
          box-shadow: 0 3px 8px rgba(0, 0, 0, 0.25);
          border-color: #3b82f6;
        }

        .eyedropper-cancel {
          padding: 8px 16px;
          background: #ef4444;
          color: white;
          border: none;
          border-radius: 6px;
          font-size: 0.9rem;
          font-weight: 500;
          cursor: pointer;
          transition: all 0.2s;
          white-space: nowrap;
        }

        .eyedropper-cancel:hover {
          background: #dc2626;
          box-shadow: 0 2px 6px rgba(239, 68, 68, 0.3);
        }

        .eyedropper-actions {
          display: flex;
          gap: 8px;
          align-items: center;
          justify-content: center;
        }

        .eyedropper-transparent {
          display: flex;
          align-items: center;
          gap: 6px;
          padding: 8px 14px;
          background: linear-gradient(135deg, #f3f4f6 25%, #d1d5db 25%, #d1d5db 50%, #f3f4f6 50%, #f3f4f6 75%, #d1d5db 75%);
          background-size: 8px 8px;
          color: #374151;
          border: 2px solid #6b7280;
          border-radius: 6px;
          font-size: 0.9rem;
          font-weight: 600;
          cursor: pointer;
          transition: all 0.2s;
          white-space: nowrap;
        }

        .eyedropper-transparent:hover {
          border-color: #374151;
          box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
          transform: translateY(-1px);
        }

        .transparent-icon {
          width: 16px;
          height: 16px;
          background: linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%),
                      linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%);
          background-size: 8px 8px;
          background-position: 0 0, 4px 4px;
          background-color: white;
          border: 1px solid #999;
          border-radius: 2px;
          display: inline-block;
          font-size: 0;
        }

        @keyframes pulse {
          0%, 100% {
            opacity: 0.8;
          }
          50% {
            opacity: 1;
          }
        }

        .editing-hint {
          font-size: 0.9rem;
          color: #ff6b35;
          font-weight: 500;
          margin-left: 1rem;
        }

        .legend-sidebar {
          width: 100%;
        }

        @media (max-width: 768px) {
          .svg-preview {
            padding: 0.5rem;
            margin-top: 0.75rem;
            border-radius: 6px;
          }

          .preview-header {
            flex-direction: column;
            align-items: flex-start;
            gap: 0.25rem;
            margin-bottom: 0.5rem;
          }

          .preview-header h3 {
            font-size: 1.1rem;
          }

          .design-name-input {
            font-size: 1.1rem;
            max-width: 100%;
          }

          .editing-hint {
            margin-left: 0;
            font-size: 0.75rem;
          }

          .svg-panel {
            border: none;
            border-radius: 0;
          }

          .svg-wrapper {
            padding: 0;
            min-height: auto;
          }

          /* Position zoom controls at bottom-right on mobile */
          .zoom-controls {
            position: fixed;
            bottom: 1rem;
            right: 1rem;
            top: auto;
            flex-direction: column;
            gap: 0.25rem;
            padding: 0.25rem;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(8px);
            z-index: 50;
          }

          /* Position undo/redo controls above zoom on mobile */
          .undo-redo-controls {
            position: fixed;
            bottom: 12rem;
            right: 1rem;
            top: auto;
            gap: 0.25rem;
            padding: 0.25rem;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(8px);
            z-index: 50;
          }

          /* Make buttons circular and compact on mobile */
          .zoom-btn,
          .undo-redo-btn {
            width: 44px;
            height: 44px;
            padding: 0;
            border-radius: 50%;
            min-width: unset;
            font-size: 1.1rem;
          }

          /* Hide text labels on mobile */
          .zoom-btn span {
            display: none;
          }

          /* In-situ button - compact on mobile */
          .in-situ-btn {
            padding: 0.4rem;
            font-size: 0;
            top: 0.5rem;
            left: 0.5rem;
            border-radius: 50%;
            width: 36px;
            height: 36px;
          }

          .in-situ-btn span {
            display: none;
          }

          .in-situ-btn svg {
            width: 18px;
            height: 18px;
          }

          .svg-image-container {
            /* Allow zoom on mobile via buttons */
            cursor: default !important;
          }
        }

        /* Extra small screens */
        @media (max-width: 480px) {
          .svg-preview {
            padding: 0.25rem;
            margin-top: 0.5rem;
          }

          .preview-header {
            padding: 0 0.25rem;
          }

          .preview-header h3 {
            font-size: 1rem;
          }

          .design-name-input {
            font-size: 1rem;
          }
        }
      `})]}):null}var ur={},Al={},AP=typeof As=="object"&&As&&As.Object===Object&&As,E1=AP,MP=E1,$P=typeof self=="object"&&self&&self.Object===Object&&self,LP=MP||$P||Function("return this")(),qr=LP,DP=qr,IP=DP.Symbol,Ml=IP,sy=Ml,T1=Object.prototype,zP=T1.hasOwnProperty,FP=T1.toString,Na=sy?sy.toStringTag:void 0;function BP(t){var e=zP.call(t,Na),n=t[Na];try{t[Na]=void 0;var r=!0}catch{}var s=FP.call(t);return r&&(e?t[Na]=n:delete t[Na]),s}var HP=BP,UP=Object.prototype,WP=UP.toString;function GP(t){return WP.call(t)}var VP=GP,iy=Ml,YP=HP,qP=VP,XP="[object Null]",ZP="[object Undefined]",oy=iy?iy.toStringTag:void 0;function KP(t){return t==null?t===void 0?ZP:XP:oy&&oy in Object(t)?YP(t):qP(t)}var Li=KP,JP=Array.isArray,Mr=JP;function QP(t){return t!=null&&typeof t=="object"}var ys=QP,eR=Li,tR=Mr,nR=ys,rR="[object String]";function sR(t){return typeof t=="string"||!tR(t)&&nR(t)&&eR(t)==rR}var iR=sR;function oR(t){return function(e,n,r){for(var s=-1,i=Object(e),a=r(e),l=a.length;l--;){var c=a[t?l:++s];if(n(i[c],c,i)===!1)break}return e}}var aR=oR,lR=aR,cR=lR(),dR=cR;function uR(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}var hR=uR,pR=Li,fR=ys,mR="[object Arguments]";function gR(t){return fR(t)&&pR(t)==mR}var yR=gR,ay=yR,xR=ys,N1=Object.prototype,vR=N1.hasOwnProperty,bR=N1.propertyIsEnumerable,wR=ay(function(){return arguments}())?ay:function(t){return xR(t)&&vR.call(t,"callee")&&!bR.call(t,"callee")},P1=wR,xd={exports:{}};function _R(){return!1}var SR=_R;xd.exports;(function(t,e){var n=qr,r=SR,s=e&&!e.nodeType&&e,i=s&&!0&&t&&!t.nodeType&&t,a=i&&i.exports===s,l=a?n.Buffer:void 0,c=l?l.isBuffer:void 0,d=c||r;t.exports=d})(xd,xd.exports);var Hf=xd.exports,kR=9007199254740991,jR=/^(?:0|[1-9]\d*)$/;function CR(t,e){var n=typeof t;return e=e??kR,!!e&&(n=="number"||n!="symbol"&&jR.test(t))&&t>-1&&t%1==0&&t<e}var R1=CR,ER=9007199254740991;function TR(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=ER}var Uf=TR,NR=Li,PR=Uf,RR=ys,OR="[object Arguments]",AR="[object Array]",MR="[object Boolean]",$R="[object Date]",LR="[object Error]",DR="[object Function]",IR="[object Map]",zR="[object Number]",FR="[object Object]",BR="[object RegExp]",HR="[object Set]",UR="[object String]",WR="[object WeakMap]",GR="[object ArrayBuffer]",VR="[object DataView]",YR="[object Float32Array]",qR="[object Float64Array]",XR="[object Int8Array]",ZR="[object Int16Array]",KR="[object Int32Array]",JR="[object Uint8Array]",QR="[object Uint8ClampedArray]",e3="[object Uint16Array]",t3="[object Uint32Array]",$t={};$t[YR]=$t[qR]=$t[XR]=$t[ZR]=$t[KR]=$t[JR]=$t[QR]=$t[e3]=$t[t3]=!0;$t[OR]=$t[AR]=$t[GR]=$t[MR]=$t[VR]=$t[$R]=$t[LR]=$t[DR]=$t[IR]=$t[zR]=$t[FR]=$t[BR]=$t[HR]=$t[UR]=$t[WR]=!1;function n3(t){return RR(t)&&PR(t.length)&&!!$t[NR(t)]}var r3=n3;function s3(t){return function(e){return t(e)}}var Wf=s3,vd={exports:{}};vd.exports;(function(t,e){var n=E1,r=e&&!e.nodeType&&e,s=r&&!0&&t&&!t.nodeType&&t,i=s&&s.exports===r,a=i&&n.process,l=function(){try{var c=s&&s.require&&s.require("util").types;return c||a&&a.binding&&a.binding("util")}catch{}}();t.exports=l})(vd,vd.exports);var Gf=vd.exports,i3=r3,o3=Wf,ly=Gf,cy=ly&&ly.isTypedArray,a3=cy?o3(cy):i3,O1=a3,l3=hR,c3=P1,d3=Mr,u3=Hf,h3=R1,p3=O1,f3=Object.prototype,m3=f3.hasOwnProperty;function g3(t,e){var n=d3(t),r=!n&&c3(t),s=!n&&!r&&u3(t),i=!n&&!r&&!s&&p3(t),a=n||r||s||i,l=a?l3(t.length,String):[],c=l.length;for(var d in t)(e||m3.call(t,d))&&!(a&&(d=="length"||s&&(d=="offset"||d=="parent")||i&&(d=="buffer"||d=="byteLength"||d=="byteOffset")||h3(d,c)))&&l.push(d);return l}var A1=g3,y3=Object.prototype;function x3(t){var e=t&&t.constructor,n=typeof e=="function"&&e.prototype||y3;return t===n}var Vf=x3;function v3(t,e){return function(n){return t(e(n))}}var M1=v3,b3=M1,w3=b3(Object.keys,Object),_3=w3,S3=Vf,k3=_3,j3=Object.prototype,C3=j3.hasOwnProperty;function E3(t){if(!S3(t))return k3(t);var e=[];for(var n in Object(t))C3.call(t,n)&&n!="constructor"&&e.push(n);return e}var T3=E3;function N3(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var ia=N3,P3=Li,R3=ia,O3="[object AsyncFunction]",A3="[object Function]",M3="[object GeneratorFunction]",$3="[object Proxy]";function L3(t){if(!R3(t))return!1;var e=P3(t);return e==A3||e==M3||e==O3||e==$3}var $1=L3,D3=$1,I3=Uf;function z3(t){return t!=null&&I3(t.length)&&!D3(t)}var Yd=z3,F3=A1,B3=T3,H3=Yd;function U3(t){return H3(t)?F3(t):B3(t)}var $l=U3,W3=dR,G3=$l;function V3(t,e){return t&&W3(t,e,G3)}var L1=V3;function Y3(t){return t}var D1=Y3,q3=D1;function X3(t){return typeof t=="function"?t:q3}var Z3=X3,K3=L1,J3=Z3;function Q3(t,e){return t&&K3(t,J3(e))}var Yf=Q3,eO=M1,tO=eO(Object.getPrototypeOf,Object),qf=tO,nO=Li,rO=qf,sO=ys,iO="[object Object]",oO=Function.prototype,aO=Object.prototype,I1=oO.toString,lO=aO.hasOwnProperty,cO=I1.call(Object);function dO(t){if(!sO(t)||nO(t)!=iO)return!1;var e=rO(t);if(e===null)return!0;var n=lO.call(e,"constructor")&&e.constructor;return typeof n=="function"&&n instanceof n&&I1.call(n)==cO}var uO=dO;function hO(t,e){for(var n=-1,r=t==null?0:t.length,s=Array(r);++n<r;)s[n]=e(t[n],n,t);return s}var z1=hO;function pO(){this.__data__=[],this.size=0}var fO=pO;function mO(t,e){return t===e||t!==t&&e!==e}var Xf=mO,gO=Xf;function yO(t,e){for(var n=t.length;n--;)if(gO(t[n][0],e))return n;return-1}var qd=yO,xO=qd,vO=Array.prototype,bO=vO.splice;function wO(t){var e=this.__data__,n=xO(e,t);if(n<0)return!1;var r=e.length-1;return n==r?e.pop():bO.call(e,n,1),--this.size,!0}var _O=wO,SO=qd;function kO(t){var e=this.__data__,n=SO(e,t);return n<0?void 0:e[n][1]}var jO=kO,CO=qd;function EO(t){return CO(this.__data__,t)>-1}var TO=EO,NO=qd;function PO(t,e){var n=this.__data__,r=NO(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this}var RO=PO,OO=fO,AO=_O,MO=jO,$O=TO,LO=RO;function oa(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}oa.prototype.clear=OO;oa.prototype.delete=AO;oa.prototype.get=MO;oa.prototype.has=$O;oa.prototype.set=LO;var Xd=oa,DO=Xd;function IO(){this.__data__=new DO,this.size=0}var zO=IO;function FO(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}var BO=FO;function HO(t){return this.__data__.get(t)}var UO=HO;function WO(t){return this.__data__.has(t)}var GO=WO,VO=qr,YO=VO["__core-js_shared__"],qO=YO,Ju=qO,dy=function(){var t=/[^.]+$/.exec(Ju&&Ju.keys&&Ju.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function XO(t){return!!dy&&dy in t}var ZO=XO,KO=Function.prototype,JO=KO.toString;function QO(t){if(t!=null){try{return JO.call(t)}catch{}try{return t+""}catch{}}return""}var F1=QO,eA=$1,tA=ZO,nA=ia,rA=F1,sA=/[\\^$.*+?()[\]{}|]/g,iA=/^\[object .+?Constructor\]$/,oA=Function.prototype,aA=Object.prototype,lA=oA.toString,cA=aA.hasOwnProperty,dA=RegExp("^"+lA.call(cA).replace(sA,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function uA(t){if(!nA(t)||tA(t))return!1;var e=eA(t)?dA:iA;return e.test(rA(t))}var hA=uA;function pA(t,e){return t==null?void 0:t[e]}var fA=pA,mA=hA,gA=fA;function yA(t,e){var n=gA(t,e);return mA(n)?n:void 0}var Di=yA,xA=Di,vA=qr,bA=xA(vA,"Map"),Zf=bA,wA=Di,_A=wA(Object,"create"),Zd=_A,uy=Zd;function SA(){this.__data__=uy?uy(null):{},this.size=0}var kA=SA;function jA(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var CA=jA,EA=Zd,TA="__lodash_hash_undefined__",NA=Object.prototype,PA=NA.hasOwnProperty;function RA(t){var e=this.__data__;if(EA){var n=e[t];return n===TA?void 0:n}return PA.call(e,t)?e[t]:void 0}var OA=RA,AA=Zd,MA=Object.prototype,$A=MA.hasOwnProperty;function LA(t){var e=this.__data__;return AA?e[t]!==void 0:$A.call(e,t)}var DA=LA,IA=Zd,zA="__lodash_hash_undefined__";function FA(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=IA&&e===void 0?zA:e,this}var BA=FA,HA=kA,UA=CA,WA=OA,GA=DA,VA=BA;function aa(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}aa.prototype.clear=HA;aa.prototype.delete=UA;aa.prototype.get=WA;aa.prototype.has=GA;aa.prototype.set=VA;var YA=aa,hy=YA,qA=Xd,XA=Zf;function ZA(){this.size=0,this.__data__={hash:new hy,map:new(XA||qA),string:new hy}}var KA=ZA;function JA(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var QA=JA,eM=QA;function tM(t,e){var n=t.__data__;return eM(e)?n[typeof e=="string"?"string":"hash"]:n.map}var Kd=tM,nM=Kd;function rM(t){var e=nM(this,t).delete(t);return this.size-=e?1:0,e}var sM=rM,iM=Kd;function oM(t){return iM(this,t).get(t)}var aM=oM,lM=Kd;function cM(t){return lM(this,t).has(t)}var dM=cM,uM=Kd;function hM(t,e){var n=uM(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this}var pM=hM,fM=KA,mM=sM,gM=aM,yM=dM,xM=pM;function la(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}la.prototype.clear=fM;la.prototype.delete=mM;la.prototype.get=gM;la.prototype.has=yM;la.prototype.set=xM;var Kf=la,vM=Xd,bM=Zf,wM=Kf,_M=200;function SM(t,e){var n=this.__data__;if(n instanceof vM){var r=n.__data__;if(!bM||r.length<_M-1)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new wM(r)}return n.set(t,e),this.size=n.size,this}var kM=SM,jM=Xd,CM=zO,EM=BO,TM=UO,NM=GO,PM=kM;function ca(t){var e=this.__data__=new jM(t);this.size=e.size}ca.prototype.clear=CM;ca.prototype.delete=EM;ca.prototype.get=TM;ca.prototype.has=NM;ca.prototype.set=PM;var Jf=ca,RM="__lodash_hash_undefined__";function OM(t){return this.__data__.set(t,RM),this}var AM=OM;function MM(t){return this.__data__.has(t)}var $M=MM,LM=Kf,DM=AM,IM=$M;function bd(t){var e=-1,n=t==null?0:t.length;for(this.__data__=new LM;++e<n;)this.add(t[e])}bd.prototype.add=bd.prototype.push=DM;bd.prototype.has=IM;var zM=bd;function FM(t,e){for(var n=-1,r=t==null?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}var BM=FM;function HM(t,e){return t.has(e)}var UM=HM,WM=zM,GM=BM,VM=UM,YM=1,qM=2;function XM(t,e,n,r,s,i){var a=n&YM,l=t.length,c=e.length;if(l!=c&&!(a&&c>l))return!1;var d=i.get(t),u=i.get(e);if(d&&u)return d==e&&u==t;var p=-1,h=!0,f=n&qM?new WM:void 0;for(i.set(t,e),i.set(e,t);++p<l;){var m=t[p],g=e[p];if(r)var v=a?r(g,m,p,e,t,i):r(m,g,p,t,e,i);if(v!==void 0){if(v)continue;h=!1;break}if(f){if(!GM(e,function(y,x){if(!VM(f,x)&&(m===y||s(m,y,n,r,i)))return f.push(x)})){h=!1;break}}else if(!(m===g||s(m,g,n,r,i))){h=!1;break}}return i.delete(t),i.delete(e),h}var B1=XM,ZM=qr,KM=ZM.Uint8Array,H1=KM;function JM(t){var e=-1,n=Array(t.size);return t.forEach(function(r,s){n[++e]=[s,r]}),n}var QM=JM;function e4(t){var e=-1,n=Array(t.size);return t.forEach(function(r){n[++e]=r}),n}var t4=e4,py=Ml,fy=H1,n4=Xf,r4=B1,s4=QM,i4=t4,o4=1,a4=2,l4="[object Boolean]",c4="[object Date]",d4="[object Error]",u4="[object Map]",h4="[object Number]",p4="[object RegExp]",f4="[object Set]",m4="[object String]",g4="[object Symbol]",y4="[object ArrayBuffer]",x4="[object DataView]",my=py?py.prototype:void 0,Qu=my?my.valueOf:void 0;function v4(t,e,n,r,s,i,a){switch(n){case x4:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case y4:return!(t.byteLength!=e.byteLength||!i(new fy(t),new fy(e)));case l4:case c4:case h4:return n4(+t,+e);case d4:return t.name==e.name&&t.message==e.message;case p4:case m4:return t==e+"";case u4:var l=s4;case f4:var c=r&o4;if(l||(l=i4),t.size!=e.size&&!c)return!1;var d=a.get(t);if(d)return d==e;r|=a4,a.set(t,e);var u=r4(l(t),l(e),r,s,i,a);return a.delete(t),u;case g4:if(Qu)return Qu.call(t)==Qu.call(e)}return!1}var b4=v4;function w4(t,e){for(var n=-1,r=e.length,s=t.length;++n<r;)t[s+n]=e[n];return t}var U1=w4,_4=U1,S4=Mr;function k4(t,e,n){var r=e(t);return S4(t)?r:_4(r,n(t))}var W1=k4;function j4(t,e){for(var n=-1,r=t==null?0:t.length,s=0,i=[];++n<r;){var a=t[n];e(a,n,t)&&(i[s++]=a)}return i}var C4=j4;function E4(){return[]}var G1=E4,T4=C4,N4=G1,P4=Object.prototype,R4=P4.propertyIsEnumerable,gy=Object.getOwnPropertySymbols,O4=gy?function(t){return t==null?[]:(t=Object(t),T4(gy(t),function(e){return R4.call(t,e)}))}:N4,Qf=O4,A4=W1,M4=Qf,$4=$l;function L4(t){return A4(t,$4,M4)}var V1=L4,yy=V1,D4=1,I4=Object.prototype,z4=I4.hasOwnProperty;function F4(t,e,n,r,s,i){var a=n&D4,l=yy(t),c=l.length,d=yy(e),u=d.length;if(c!=u&&!a)return!1;for(var p=c;p--;){var h=l[p];if(!(a?h in e:z4.call(e,h)))return!1}var f=i.get(t),m=i.get(e);if(f&&m)return f==e&&m==t;var g=!0;i.set(t,e),i.set(e,t);for(var v=a;++p<c;){h=l[p];var y=t[h],x=e[h];if(r)var b=a?r(x,y,h,e,t,i):r(y,x,h,t,e,i);if(!(b===void 0?y===x||s(y,x,n,r,i):b)){g=!1;break}v||(v=h=="constructor")}if(g&&!v){var w=t.constructor,S=e.constructor;w!=S&&"constructor"in t&&"constructor"in e&&!(typeof w=="function"&&w instanceof w&&typeof S=="function"&&S instanceof S)&&(g=!1)}return i.delete(t),i.delete(e),g}var B4=F4,H4=Di,U4=qr,W4=H4(U4,"DataView"),G4=W4,V4=Di,Y4=qr,q4=V4(Y4,"Promise"),X4=q4,Z4=Di,K4=qr,J4=Z4(K4,"Set"),Q4=J4,e$=Di,t$=qr,n$=e$(t$,"WeakMap"),r$=n$,xp=G4,vp=Zf,bp=X4,wp=Q4,_p=r$,Y1=Li,da=F1,xy="[object Map]",s$="[object Object]",vy="[object Promise]",by="[object Set]",wy="[object WeakMap]",_y="[object DataView]",i$=da(xp),o$=da(vp),a$=da(bp),l$=da(wp),c$=da(_p),gi=Y1;(xp&&gi(new xp(new ArrayBuffer(1)))!=_y||vp&&gi(new vp)!=xy||bp&&gi(bp.resolve())!=vy||wp&&gi(new wp)!=by||_p&&gi(new _p)!=wy)&&(gi=function(t){var e=Y1(t),n=e==s$?t.constructor:void 0,r=n?da(n):"";if(r)switch(r){case i$:return _y;case o$:return xy;case a$:return vy;case l$:return by;case c$:return wy}return e});var Jd=gi,eh=Jf,d$=B1,u$=b4,h$=B4,Sy=Jd,ky=Mr,jy=Hf,p$=O1,f$=1,Cy="[object Arguments]",Ey="[object Array]",Sc="[object Object]",m$=Object.prototype,Ty=m$.hasOwnProperty;function g$(t,e,n,r,s,i){var a=ky(t),l=ky(e),c=a?Ey:Sy(t),d=l?Ey:Sy(e);c=c==Cy?Sc:c,d=d==Cy?Sc:d;var u=c==Sc,p=d==Sc,h=c==d;if(h&&jy(t)){if(!jy(e))return!1;a=!0,u=!1}if(h&&!u)return i||(i=new eh),a||p$(t)?d$(t,e,n,r,s,i):u$(t,e,c,n,r,s,i);if(!(n&f$)){var f=u&&Ty.call(t,"__wrapped__"),m=p&&Ty.call(e,"__wrapped__");if(f||m){var g=f?t.value():t,v=m?e.value():e;return i||(i=new eh),s(g,v,n,r,i)}}return h?(i||(i=new eh),h$(t,e,n,r,s,i)):!1}var y$=g$,x$=y$,Ny=ys;function q1(t,e,n,r,s){return t===e?!0:t==null||e==null||!Ny(t)&&!Ny(e)?t!==t&&e!==e:x$(t,e,n,r,q1,s)}var X1=q1,v$=Jf,b$=X1,w$=1,_$=2;function S$(t,e,n,r){var s=n.length,i=s,a=!r;if(t==null)return!i;for(t=Object(t);s--;){var l=n[s];if(a&&l[2]?l[1]!==t[l[0]]:!(l[0]in t))return!1}for(;++s<i;){l=n[s];var c=l[0],d=t[c],u=l[1];if(a&&l[2]){if(d===void 0&&!(c in t))return!1}else{var p=new v$;if(r)var h=r(d,u,c,t,e,p);if(!(h===void 0?b$(u,d,w$|_$,r,p):h))return!1}}return!0}var k$=S$,j$=ia;function C$(t){return t===t&&!j$(t)}var Z1=C$,E$=Z1,T$=$l;function N$(t){for(var e=T$(t),n=e.length;n--;){var r=e[n],s=t[r];e[n]=[r,s,E$(s)]}return e}var P$=N$;function R$(t,e){return function(n){return n==null?!1:n[t]===e&&(e!==void 0||t in Object(n))}}var K1=R$,O$=k$,A$=P$,M$=K1;function $$(t){var e=A$(t);return e.length==1&&e[0][2]?M$(e[0][0],e[0][1]):function(n){return n===t||O$(n,t,e)}}var L$=$$,D$=Li,I$=ys,z$="[object Symbol]";function F$(t){return typeof t=="symbol"||I$(t)&&D$(t)==z$}var em=F$,B$=Mr,H$=em,U$=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,W$=/^\w*$/;function G$(t,e){if(B$(t))return!1;var n=typeof t;return n=="number"||n=="symbol"||n=="boolean"||t==null||H$(t)?!0:W$.test(t)||!U$.test(t)||e!=null&&t in Object(e)}var tm=G$,J1=Kf,V$="Expected a function";function nm(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(V$);var n=function(){var r=arguments,s=e?e.apply(this,r):r[0],i=n.cache;if(i.has(s))return i.get(s);var a=t.apply(this,r);return n.cache=i.set(s,a)||i,a};return n.cache=new(nm.Cache||J1),n}nm.Cache=J1;var Y$=nm,q$=Y$,X$=500;function Z$(t){var e=q$(t,function(r){return n.size===X$&&n.clear(),r}),n=e.cache;return e}var K$=Z$,J$=K$,Q$=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,e6=/\\(\\)?/g,t6=J$(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(Q$,function(n,r,s,i){e.push(s?i.replace(e6,"$1"):r||n)}),e}),n6=t6,Py=Ml,r6=z1,s6=Mr,i6=em,Ry=Py?Py.prototype:void 0,Oy=Ry?Ry.toString:void 0;function Q1(t){if(typeof t=="string")return t;if(s6(t))return r6(t,Q1)+"";if(i6(t))return Oy?Oy.call(t):"";var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}var o6=Q1,a6=o6;function l6(t){return t==null?"":a6(t)}var c6=l6,d6=Mr,u6=tm,h6=n6,p6=c6;function f6(t,e){return d6(t)?t:u6(t,e)?[t]:h6(p6(t))}var e_=f6,m6=em;function g6(t){if(typeof t=="string"||m6(t))return t;var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}var Qd=g6,y6=e_,x6=Qd;function v6(t,e){e=y6(e,t);for(var n=0,r=e.length;t!=null&&n<r;)t=t[x6(e[n++])];return n&&n==r?t:void 0}var t_=v6,b6=t_;function w6(t,e,n){var r=t==null?void 0:b6(t,e);return r===void 0?n:r}var _6=w6;function S6(t,e){return t!=null&&e in Object(t)}var k6=S6,j6=e_,C6=P1,E6=Mr,T6=R1,N6=Uf,P6=Qd;function R6(t,e,n){e=j6(e,t);for(var r=-1,s=e.length,i=!1;++r<s;){var a=P6(e[r]);if(!(i=t!=null&&n(t,a)))break;t=t[a]}return i||++r!=s?i:(s=t==null?0:t.length,!!s&&N6(s)&&T6(a,s)&&(E6(t)||C6(t)))}var O6=R6,A6=k6,M6=O6;function $6(t,e){return t!=null&&M6(t,e,A6)}var L6=$6,D6=X1,I6=_6,z6=L6,F6=tm,B6=Z1,H6=K1,U6=Qd,W6=1,G6=2;function V6(t,e){return F6(t)&&B6(e)?H6(U6(t),e):function(n){var r=I6(n,t);return r===void 0&&r===e?z6(n,t):D6(e,r,W6|G6)}}var Y6=V6;function q6(t){return function(e){return e==null?void 0:e[t]}}var X6=q6,Z6=t_;function K6(t){return function(e){return Z6(e,t)}}var J6=K6,Q6=X6,eL=J6,tL=tm,nL=Qd;function rL(t){return tL(t)?Q6(nL(t)):eL(t)}var sL=rL,iL=L$,oL=Y6,aL=D1,lL=Mr,cL=sL;function dL(t){return typeof t=="function"?t:t==null?aL:typeof t=="object"?lL(t)?oL(t[0],t[1]):iL(t):cL(t)}var uL=dL,hL=Yd;function pL(t,e){return function(n,r){if(n==null)return n;if(!hL(n))return t(n,r);for(var s=n.length,i=e?s:-1,a=Object(n);(e?i--:++i<s)&&r(a[i],i,a)!==!1;);return n}}var fL=pL,mL=L1,gL=fL,yL=gL(mL),xL=yL,vL=xL,bL=Yd;function wL(t,e){var n=-1,r=bL(t)?Array(t.length):[];return vL(t,function(s,i,a){r[++n]=e(s,i,a)}),r}var _L=wL,SL=z1,kL=uL,jL=_L,CL=Mr;function EL(t,e){var n=CL(t)?SL:jL;return n(t,kL(e))}var TL=EL;Object.defineProperty(Al,"__esModule",{value:!0});Al.flattenNames=void 0;var NL=iR,PL=eu(NL),RL=Yf,OL=eu(RL),AL=uO,ML=eu(AL),$L=TL,LL=eu($L);function eu(t){return t&&t.__esModule?t:{default:t}}var DL=Al.flattenNames=function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=[];return(0,LL.default)(e,function(r){Array.isArray(r)?t(r).map(function(s){return n.push(s)}):(0,ML.default)(r)?(0,OL.default)(r,function(s,i){s===!0&&n.push(i),n.push(i+"-"+s)}):(0,PL.default)(r)&&n.push(r)}),n};Al.default=DL;var Ll={};function IL(t,e){for(var n=-1,r=t==null?0:t.length;++n<r&&e(t[n],n,t)!==!1;);return t}var zL=IL,FL=Di,BL=function(){try{var t=FL(Object,"defineProperty");return t({},"",{}),t}catch{}}(),HL=BL,Ay=HL;function UL(t,e,n){e=="__proto__"&&Ay?Ay(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}var n_=UL,WL=n_,GL=Xf,VL=Object.prototype,YL=VL.hasOwnProperty;function qL(t,e,n){var r=t[e];(!(YL.call(t,e)&&GL(r,n))||n===void 0&&!(e in t))&&WL(t,e,n)}var r_=qL,XL=r_,ZL=n_;function KL(t,e,n,r){var s=!n;n||(n={});for(var i=-1,a=e.length;++i<a;){var l=e[i],c=r?r(n[l],t[l],l,n,t):void 0;c===void 0&&(c=t[l]),s?ZL(n,l,c):XL(n,l,c)}return n}var tu=KL,JL=tu,QL=$l;function eD(t,e){return t&&JL(e,QL(e),t)}var tD=eD;function nD(t){var e=[];if(t!=null)for(var n in Object(t))e.push(n);return e}var rD=nD,sD=ia,iD=Vf,oD=rD,aD=Object.prototype,lD=aD.hasOwnProperty;function cD(t){if(!sD(t))return oD(t);var e=iD(t),n=[];for(var r in t)r=="constructor"&&(e||!lD.call(t,r))||n.push(r);return n}var dD=cD,uD=A1,hD=dD,pD=Yd;function fD(t){return pD(t)?uD(t,!0):hD(t)}var rm=fD,mD=tu,gD=rm;function yD(t,e){return t&&mD(e,gD(e),t)}var xD=yD,wd={exports:{}};wd.exports;(function(t,e){var n=qr,r=e&&!e.nodeType&&e,s=r&&!0&&t&&!t.nodeType&&t,i=s&&s.exports===r,a=i?n.Buffer:void 0,l=a?a.allocUnsafe:void 0;function c(d,u){if(u)return d.slice();var p=d.length,h=l?l(p):new d.constructor(p);return d.copy(h),h}t.exports=c})(wd,wd.exports);var vD=wd.exports;function bD(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}var wD=bD,_D=tu,SD=Qf;function kD(t,e){return _D(t,SD(t),e)}var jD=kD,CD=U1,ED=qf,TD=Qf,ND=G1,PD=Object.getOwnPropertySymbols,RD=PD?function(t){for(var e=[];t;)CD(e,TD(t)),t=ED(t);return e}:ND,s_=RD,OD=tu,AD=s_;function MD(t,e){return OD(t,AD(t),e)}var $D=MD,LD=W1,DD=s_,ID=rm;function zD(t){return LD(t,ID,DD)}var FD=zD,BD=Object.prototype,HD=BD.hasOwnProperty;function UD(t){var e=t.length,n=new t.constructor(e);return e&&typeof t[0]=="string"&&HD.call(t,"index")&&(n.index=t.index,n.input=t.input),n}var WD=UD,My=H1;function GD(t){var e=new t.constructor(t.byteLength);return new My(e).set(new My(t)),e}var sm=GD,VD=sm;function YD(t,e){var n=e?VD(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}var qD=YD,XD=/\w*$/;function ZD(t){var e=new t.constructor(t.source,XD.exec(t));return e.lastIndex=t.lastIndex,e}var KD=ZD,$y=Ml,Ly=$y?$y.prototype:void 0,Dy=Ly?Ly.valueOf:void 0;function JD(t){return Dy?Object(Dy.call(t)):{}}var QD=JD,eI=sm;function tI(t,e){var n=e?eI(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}var nI=tI,rI=sm,sI=qD,iI=KD,oI=QD,aI=nI,lI="[object Boolean]",cI="[object Date]",dI="[object Map]",uI="[object Number]",hI="[object RegExp]",pI="[object Set]",fI="[object String]",mI="[object Symbol]",gI="[object ArrayBuffer]",yI="[object DataView]",xI="[object Float32Array]",vI="[object Float64Array]",bI="[object Int8Array]",wI="[object Int16Array]",_I="[object Int32Array]",SI="[object Uint8Array]",kI="[object Uint8ClampedArray]",jI="[object Uint16Array]",CI="[object Uint32Array]";function EI(t,e,n){var r=t.constructor;switch(e){case gI:return rI(t);case lI:case cI:return new r(+t);case yI:return sI(t,n);case xI:case vI:case bI:case wI:case _I:case SI:case kI:case jI:case CI:return aI(t,n);case dI:return new r;case uI:case fI:return new r(t);case hI:return iI(t);case pI:return new r;case mI:return oI(t)}}var TI=EI,NI=ia,Iy=Object.create,PI=function(){function t(){}return function(e){if(!NI(e))return{};if(Iy)return Iy(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}(),RI=PI,OI=RI,AI=qf,MI=Vf;function $I(t){return typeof t.constructor=="function"&&!MI(t)?OI(AI(t)):{}}var LI=$I,DI=Jd,II=ys,zI="[object Map]";function FI(t){return II(t)&&DI(t)==zI}var BI=FI,HI=BI,UI=Wf,zy=Gf,Fy=zy&&zy.isMap,WI=Fy?UI(Fy):HI,GI=WI,VI=Jd,YI=ys,qI="[object Set]";function XI(t){return YI(t)&&VI(t)==qI}var ZI=XI,KI=ZI,JI=Wf,By=Gf,Hy=By&&By.isSet,QI=Hy?JI(Hy):KI,e8=QI,t8=Jf,n8=zL,r8=r_,s8=tD,i8=xD,o8=vD,a8=wD,l8=jD,c8=$D,d8=V1,u8=FD,h8=Jd,p8=WD,f8=TI,m8=LI,g8=Mr,y8=Hf,x8=GI,v8=ia,b8=e8,w8=$l,_8=rm,S8=1,k8=2,j8=4,i_="[object Arguments]",C8="[object Array]",E8="[object Boolean]",T8="[object Date]",N8="[object Error]",o_="[object Function]",P8="[object GeneratorFunction]",R8="[object Map]",O8="[object Number]",a_="[object Object]",A8="[object RegExp]",M8="[object Set]",$8="[object String]",L8="[object Symbol]",D8="[object WeakMap]",I8="[object ArrayBuffer]",z8="[object DataView]",F8="[object Float32Array]",B8="[object Float64Array]",H8="[object Int8Array]",U8="[object Int16Array]",W8="[object Int32Array]",G8="[object Uint8Array]",V8="[object Uint8ClampedArray]",Y8="[object Uint16Array]",q8="[object Uint32Array]",Rt={};Rt[i_]=Rt[C8]=Rt[I8]=Rt[z8]=Rt[E8]=Rt[T8]=Rt[F8]=Rt[B8]=Rt[H8]=Rt[U8]=Rt[W8]=Rt[R8]=Rt[O8]=Rt[a_]=Rt[A8]=Rt[M8]=Rt[$8]=Rt[L8]=Rt[G8]=Rt[V8]=Rt[Y8]=Rt[q8]=!0;Rt[N8]=Rt[o_]=Rt[D8]=!1;function zc(t,e,n,r,s,i){var a,l=e&S8,c=e&k8,d=e&j8;if(n&&(a=s?n(t,r,s,i):n(t)),a!==void 0)return a;if(!v8(t))return t;var u=g8(t);if(u){if(a=p8(t),!l)return a8(t,a)}else{var p=h8(t),h=p==o_||p==P8;if(y8(t))return o8(t,l);if(p==a_||p==i_||h&&!s){if(a=c||h?{}:m8(t),!l)return c?c8(t,i8(a,t)):l8(t,s8(a,t))}else{if(!Rt[p])return s?t:{};a=f8(t,p,l)}}i||(i=new t8);var f=i.get(t);if(f)return f;i.set(t,a),b8(t)?t.forEach(function(v){a.add(zc(v,e,n,v,t,i))}):x8(t)&&t.forEach(function(v,y){a.set(y,zc(v,e,n,y,t,i))});var m=d?c?u8:d8:c?_8:w8,g=u?void 0:m(t);return n8(g||t,function(v,y){g&&(y=v,v=t[y]),r8(a,y,zc(v,e,n,y,t,i))}),a}var X8=zc,Z8=X8,K8=1,J8=4;function Q8(t){return Z8(t,K8|J8)}var ez=Q8;Object.defineProperty(Ll,"__esModule",{value:!0});Ll.mergeClasses=void 0;var tz=Yf,nz=l_(tz),rz=ez,sz=l_(rz),iz=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};function l_(t){return t&&t.__esModule?t:{default:t}}var oz=Ll.mergeClasses=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=e.default&&(0,sz.default)(e.default)||{};return n.map(function(s){var i=e[s];return i&&(0,nz.default)(i,function(a,l){r[l]||(r[l]={}),r[l]=iz({},r[l],i[l])}),s}),r};Ll.default=oz;var Dl={};Object.defineProperty(Dl,"__esModule",{value:!0});Dl.autoprefix=void 0;var az=Yf,Uy=cz(az),lz=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};function cz(t){return t&&t.__esModule?t:{default:t}}var dz={borderRadius:function(e){return{msBorderRadius:e,MozBorderRadius:e,OBorderRadius:e,WebkitBorderRadius:e,borderRadius:e}},boxShadow:function(e){return{msBoxShadow:e,MozBoxShadow:e,OBoxShadow:e,WebkitBoxShadow:e,boxShadow:e}},userSelect:function(e){return{WebkitTouchCallout:e,KhtmlUserSelect:e,MozUserSelect:e,msUserSelect:e,WebkitUserSelect:e,userSelect:e}},flex:function(e){return{WebkitBoxFlex:e,MozBoxFlex:e,WebkitFlex:e,msFlex:e,flex:e}},flexBasis:function(e){return{WebkitFlexBasis:e,flexBasis:e}},justifyContent:function(e){return{WebkitJustifyContent:e,justifyContent:e}},transition:function(e){return{msTransition:e,MozTransition:e,OTransition:e,WebkitTransition:e,transition:e}},transform:function(e){return{msTransform:e,MozTransform:e,OTransform:e,WebkitTransform:e,transform:e}},absolute:function(e){var n=e&&e.split(" ");return{position:"absolute",top:n&&n[0],right:n&&n[1],bottom:n&&n[2],left:n&&n[3]}},extend:function(e,n){var r=n[e];return r||{extend:e}}},uz=Dl.autoprefix=function(e){var n={};return(0,Uy.default)(e,function(r,s){var i={};(0,Uy.default)(r,function(a,l){var c=dz[l];c?i=lz({},i,c(a)):i[l]=a}),n[s]=i}),n};Dl.default=uz;var Il={};Object.defineProperty(Il,"__esModule",{value:!0});Il.hover=void 0;var hz=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},pz=R,th=fz(pz);function fz(t){return t&&t.__esModule?t:{default:t}}function mz(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Wy(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function gz(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var yz=Il.hover=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"span";return function(r){gz(s,r);function s(){var i,a,l,c;mz(this,s);for(var d=arguments.length,u=Array(d),p=0;p<d;p++)u[p]=arguments[p];return c=(a=(l=Wy(this,(i=s.__proto__||Object.getPrototypeOf(s)).call.apply(i,[this].concat(u))),l),l.state={hover:!1},l.handleMouseOver=function(){return l.setState({hover:!0})},l.handleMouseOut=function(){return l.setState({hover:!1})},l.render=function(){return th.default.createElement(n,{onMouseOver:l.handleMouseOver,onMouseOut:l.handleMouseOut},th.default.createElement(e,hz({},l.props,l.state)))},a),Wy(l,c)}return s}(th.default.Component)};Il.default=yz;var zl={};Object.defineProperty(zl,"__esModule",{value:!0});zl.active=void 0;var xz=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},vz=R,nh=bz(vz);function bz(t){return t&&t.__esModule?t:{default:t}}function wz(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Gy(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function _z(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var Sz=zl.active=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"span";return function(r){_z(s,r);function s(){var i,a,l,c;wz(this,s);for(var d=arguments.length,u=Array(d),p=0;p<d;p++)u[p]=arguments[p];return c=(a=(l=Gy(this,(i=s.__proto__||Object.getPrototypeOf(s)).call.apply(i,[this].concat(u))),l),l.state={active:!1},l.handleMouseDown=function(){return l.setState({active:!0})},l.handleMouseUp=function(){return l.setState({active:!1})},l.render=function(){return nh.default.createElement(n,{onMouseDown:l.handleMouseDown,onMouseUp:l.handleMouseUp},nh.default.createElement(e,xz({},l.props,l.state)))},a),Gy(l,c)}return s}(nh.default.Component)};zl.default=Sz;var im={};Object.defineProperty(im,"__esModule",{value:!0});var kz=function(e,n){var r={},s=function(a){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;r[a]=l};return e===0&&s("first-child"),e===n-1&&s("last-child"),(e===0||e%2===0)&&s("even"),Math.abs(e%2)===1&&s("odd"),s("nth-child",e),r};im.default=kz;Object.defineProperty(ur,"__esModule",{value:!0});ur.ReactCSS=ur.loop=ur.handleActive=om=ur.handleHover=ur.hover=void 0;var jz=Al,Cz=ua(jz),Ez=Ll,Tz=ua(Ez),Nz=Dl,Pz=ua(Nz),Rz=Il,c_=ua(Rz),Oz=zl,Az=ua(Oz),Mz=im,$z=ua(Mz);function ua(t){return t&&t.__esModule?t:{default:t}}ur.hover=c_.default;var om=ur.handleHover=c_.default;ur.handleActive=Az.default;ur.loop=$z.default;var Lz=ur.ReactCSS=function(e){for(var n=arguments.length,r=Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];var i=(0,Cz.default)(r),a=(0,Tz.default)(e,i);return(0,Pz.default)(a)},at=ur.default=Lz,Dz=function(e,n,r,s,i){var a=i.clientWidth,l=i.clientHeight,c=typeof e.pageX=="number"?e.pageX:e.touches[0].pageX,d=typeof e.pageY=="number"?e.pageY:e.touches[0].pageY,u=c-(i.getBoundingClientRect().left+window.pageXOffset),p=d-(i.getBoundingClientRect().top+window.pageYOffset);if(r==="vertical"){var h=void 0;if(p<0?h=0:p>l?h=1:h=Math.round(p*100/l)/100,n.a!==h)return{h:n.h,s:n.s,l:n.l,a:h,source:"rgb"}}else{var f=void 0;if(u<0?f=0:u>a?f=1:f=Math.round(u*100/a)/100,s!==f)return{h:n.h,s:n.s,l:n.l,a:f,source:"rgb"}}return null},rh={},Iz=function(e,n,r,s){if(typeof document>"u"&&!s)return null;var i=s?new s:document.createElement("canvas");i.width=r*2,i.height=r*2;var a=i.getContext("2d");return a?(a.fillStyle=e,a.fillRect(0,0,i.width,i.height),a.fillStyle=n,a.fillRect(0,0,r,r),a.translate(r,r),a.fillRect(0,0,r,r),i.toDataURL()):null},zz=function(e,n,r,s){var i=e+"-"+n+"-"+r+(s?"-server":"");if(rh[i])return rh[i];var a=Iz(e,n,r,s);return rh[i]=a,a},Vy=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ha=function(e){var n=e.white,r=e.grey,s=e.size,i=e.renderers,a=e.borderRadius,l=e.boxShadow,c=e.children,d=at({default:{grid:{borderRadius:a,boxShadow:l,absolute:"0px 0px 0px 0px",background:"url("+zz(n,r,s,i.canvas)+") center left"}}});return R.isValidElement(c)?$.cloneElement(c,Vy({},c.props,{style:Vy({},c.props.style,d.grid)})):$.createElement("div",{style:d.grid})};ha.defaultProps={size:8,white:"transparent",grey:"rgba(0,0,0,.08)",renderers:{}};var Fz=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Bz=function(){function t(e,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function Hz(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Yy(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function Uz(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var am=function(t){Uz(e,t);function e(){var n,r,s,i;Hz(this,e);for(var a=arguments.length,l=Array(a),c=0;c<a;c++)l[c]=arguments[c];return i=(r=(s=Yy(this,(n=e.__proto__||Object.getPrototypeOf(e)).call.apply(n,[this].concat(l))),s),s.handleChange=function(d){var u=Dz(d,s.props.hsl,s.props.direction,s.props.a,s.container);u&&typeof s.props.onChange=="function"&&s.props.onChange(u,d)},s.handleMouseDown=function(d){s.handleChange(d),window.addEventListener("mousemove",s.handleChange),window.addEventListener("mouseup",s.handleMouseUp)},s.handleMouseUp=function(){s.unbindEventListeners()},s.unbindEventListeners=function(){window.removeEventListener("mousemove",s.handleChange),window.removeEventListener("mouseup",s.handleMouseUp)},r),Yy(s,i)}return Bz(e,[{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"render",value:function(){var r=this,s=this.props.rgb,i=at({default:{alpha:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius},checkboard:{absolute:"0px 0px 0px 0px",overflow:"hidden",borderRadius:this.props.radius},gradient:{absolute:"0px 0px 0px 0px",background:"linear-gradient(to right, rgba("+s.r+","+s.g+","+s.b+`, 0) 0%,
           rgba(`+s.r+","+s.g+","+s.b+", 1) 100%)",boxShadow:this.props.shadow,borderRadius:this.props.radius},container:{position:"relative",height:"100%",margin:"0 3px"},pointer:{position:"absolute",left:s.a*100+"%"},slider:{width:"4px",borderRadius:"1px",height:"8px",boxShadow:"0 0 2px rgba(0, 0, 0, .6)",background:"#fff",marginTop:"1px",transform:"translateX(-2px)"}},vertical:{gradient:{background:"linear-gradient(to bottom, rgba("+s.r+","+s.g+","+s.b+`, 0) 0%,
           rgba(`+s.r+","+s.g+","+s.b+", 1) 100%)"},pointer:{left:0,top:s.a*100+"%"}},overwrite:Fz({},this.props.style)},{vertical:this.props.direction==="vertical",overwrite:!0});return $.createElement("div",{style:i.alpha},$.createElement("div",{style:i.checkboard},$.createElement(ha,{renderers:this.props.renderers})),$.createElement("div",{style:i.gradient}),$.createElement("div",{style:i.container,ref:function(l){return r.container=l},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},$.createElement("div",{style:i.pointer},this.props.pointer?$.createElement(this.props.pointer,this.props):$.createElement("div",{style:i.slider}))))}}]),e}(R.PureComponent||R.Component),Wz=function(){function t(e,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function Gz(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vz(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Yz(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function qz(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var Xz=1,d_=38,Zz=40,Kz=[d_,Zz],Jz=function(e){return Kz.indexOf(e)>-1},Qz=function(e){return Number(String(e).replace(/%/g,""))},eF=1,yt=function(t){qz(e,t);function e(n){Vz(this,e);var r=Yz(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return r.handleBlur=function(){r.state.blurValue&&r.setState({value:r.state.blurValue,blurValue:null})},r.handleChange=function(s){r.setUpdatedValue(s.target.value,s)},r.handleKeyDown=function(s){var i=Qz(s.target.value);if(!isNaN(i)&&Jz(s.keyCode)){var a=r.getArrowOffset(),l=s.keyCode===d_?i+a:i-a;r.setUpdatedValue(l,s)}},r.handleDrag=function(s){if(r.props.dragLabel){var i=Math.round(r.props.value+s.movementX);i>=0&&i<=r.props.dragMax&&r.props.onChange&&r.props.onChange(r.getValueObjectWithLabel(i),s)}},r.handleMouseDown=function(s){r.props.dragLabel&&(s.preventDefault(),r.handleDrag(s),window.addEventListener("mousemove",r.handleDrag),window.addEventListener("mouseup",r.handleMouseUp))},r.handleMouseUp=function(){r.unbindEventListeners()},r.unbindEventListeners=function(){window.removeEventListener("mousemove",r.handleDrag),window.removeEventListener("mouseup",r.handleMouseUp)},r.state={value:String(n.value).toUpperCase(),blurValue:String(n.value).toUpperCase()},r.inputId="rc-editable-input-"+eF++,r}return Wz(e,[{key:"componentDidUpdate",value:function(r,s){this.props.value!==this.state.value&&(r.value!==this.props.value||s.value!==this.state.value)&&(this.input===document.activeElement?this.setState({blurValue:String(this.props.value).toUpperCase()}):this.setState({value:String(this.props.value).toUpperCase(),blurValue:!this.state.blurValue&&String(this.props.value).toUpperCase()}))}},{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"getValueObjectWithLabel",value:function(r){return Gz({},this.props.label,r)}},{key:"getArrowOffset",value:function(){return this.props.arrowOffset||Xz}},{key:"setUpdatedValue",value:function(r,s){var i=this.props.label?this.getValueObjectWithLabel(r):r;this.props.onChange&&this.props.onChange(i,s),this.setState({value:r})}},{key:"render",value:function(){var r=this,s=at({default:{wrap:{position:"relative"}},"user-override":{wrap:this.props.style&&this.props.style.wrap?this.props.style.wrap:{},input:this.props.style&&this.props.style.input?this.props.style.input:{},label:this.props.style&&this.props.style.label?this.props.style.label:{}},"dragLabel-true":{label:{cursor:"ew-resize"}}},{"user-override":!0},this.props);return $.createElement("div",{style:s.wrap},$.createElement("input",{id:this.inputId,style:s.input,ref:function(a){return r.input=a},value:this.state.value,onKeyDown:this.handleKeyDown,onChange:this.handleChange,onBlur:this.handleBlur,placeholder:this.props.placeholder,spellCheck:"false"}),this.props.label&&!this.props.hideLabel?$.createElement("label",{htmlFor:this.inputId,style:s.label,onMouseDown:this.handleMouseDown},this.props.label):null)}}]),e}(R.PureComponent||R.Component),tF=function(e,n,r,s){var i=s.clientWidth,a=s.clientHeight,l=typeof e.pageX=="number"?e.pageX:e.touches[0].pageX,c=typeof e.pageY=="number"?e.pageY:e.touches[0].pageY,d=l-(s.getBoundingClientRect().left+window.pageXOffset),u=c-(s.getBoundingClientRect().top+window.pageYOffset);if(n==="vertical"){var p=void 0;if(u<0)p=359;else if(u>a)p=0;else{var h=-(u*100/a)+100;p=360*h/100}if(r.h!==p)return{h:p,s:r.s,l:r.l,a:r.a,source:"hsl"}}else{var f=void 0;if(d<0)f=0;else if(d>i)f=359;else{var m=d*100/i;f=360*m/100}if(r.h!==f)return{h:f,s:r.s,l:r.l,a:r.a,source:"hsl"}}return null},nF=function(){function t(e,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function rF(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function qy(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function sF(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var pa=function(t){sF(e,t);function e(){var n,r,s,i;rF(this,e);for(var a=arguments.length,l=Array(a),c=0;c<a;c++)l[c]=arguments[c];return i=(r=(s=qy(this,(n=e.__proto__||Object.getPrototypeOf(e)).call.apply(n,[this].concat(l))),s),s.handleChange=function(d){var u=tF(d,s.props.direction,s.props.hsl,s.container);u&&typeof s.props.onChange=="function"&&s.props.onChange(u,d)},s.handleMouseDown=function(d){s.handleChange(d),window.addEventListener("mousemove",s.handleChange),window.addEventListener("mouseup",s.handleMouseUp)},s.handleMouseUp=function(){s.unbindEventListeners()},r),qy(s,i)}return nF(e,[{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"unbindEventListeners",value:function(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}},{key:"render",value:function(){var r=this,s=this.props.direction,i=s===void 0?"horizontal":s,a=at({default:{hue:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius,boxShadow:this.props.shadow},container:{padding:"0 2px",position:"relative",height:"100%",borderRadius:this.props.radius},pointer:{position:"absolute",left:this.props.hsl.h*100/360+"%"},slider:{marginTop:"1px",width:"4px",borderRadius:"1px",height:"8px",boxShadow:"0 0 2px rgba(0, 0, 0, .6)",background:"#fff",transform:"translateX(-2px)"}},vertical:{pointer:{left:"0px",top:-(this.props.hsl.h*100/360)+100+"%"}}},{vertical:i==="vertical"});return $.createElement("div",{style:a.hue},$.createElement("div",{className:"hue-"+i,style:a.container,ref:function(c){return r.container=c},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},$.createElement("style",null,`
            .hue-horizontal {
              background: linear-gradient(to right, #f00 0%, #ff0 17%, #0f0
                33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
              background: -webkit-linear-gradient(to right, #f00 0%, #ff0
                17%, #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
            }

            .hue-vertical {
              background: linear-gradient(to top, #f00 0%, #ff0 17%, #0f0 33%,
                #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
              background: -webkit-linear-gradient(to top, #f00 0%, #ff0 17%,
                #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
            }
          `),$.createElement("div",{style:a.pointer},this.props.pointer?$.createElement(this.props.pointer,this.props):$.createElement("div",{style:a.slider}))))}}]),e}(R.PureComponent||R.Component),u_={exports:{}},iF="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",oF=iF,aF=oF;function h_(){}function p_(){}p_.resetWarningCache=h_;var lF=function(){function t(r,s,i,a,l,c){if(c!==aF){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:p_,resetWarningCache:h_};return n.PropTypes=n,n};u_.exports=lF();var cF=u_.exports;const Oe=jl(cF);function dF(){this.__data__=[],this.size=0}function Fl(t,e){return t===e||t!==t&&e!==e}function nu(t,e){for(var n=t.length;n--;)if(Fl(t[n][0],e))return n;return-1}var uF=Array.prototype,hF=uF.splice;function pF(t){var e=this.__data__,n=nu(e,t);if(n<0)return!1;var r=e.length-1;return n==r?e.pop():hF.call(e,n,1),--this.size,!0}function fF(t){var e=this.__data__,n=nu(e,t);return n<0?void 0:e[n][1]}function mF(t){return nu(this.__data__,t)>-1}function gF(t,e){var n=this.__data__,r=nu(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this}function xs(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}xs.prototype.clear=dF;xs.prototype.delete=pF;xs.prototype.get=fF;xs.prototype.has=mF;xs.prototype.set=gF;function yF(){this.__data__=new xs,this.size=0}function xF(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}function vF(t){return this.__data__.get(t)}function bF(t){return this.__data__.has(t)}var f_=typeof global=="object"&&global&&global.Object===Object&&global,wF=typeof self=="object"&&self&&self.Object===Object&&self,$r=f_||wF||Function("return this")(),Ys=$r.Symbol,m_=Object.prototype,_F=m_.hasOwnProperty,SF=m_.toString,Pa=Ys?Ys.toStringTag:void 0;function kF(t){var e=_F.call(t,Pa),n=t[Pa];try{t[Pa]=void 0;var r=!0}catch{}var s=SF.call(t);return r&&(e?t[Pa]=n:delete t[Pa]),s}var jF=Object.prototype,CF=jF.toString;function EF(t){return CF.call(t)}var TF="[object Null]",NF="[object Undefined]",Xy=Ys?Ys.toStringTag:void 0;function Ii(t){return t==null?t===void 0?NF:TF:Xy&&Xy in Object(t)?kF(t):EF(t)}function gr(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var PF="[object AsyncFunction]",RF="[object Function]",OF="[object GeneratorFunction]",AF="[object Proxy]";function lm(t){if(!gr(t))return!1;var e=Ii(t);return e==RF||e==OF||e==PF||e==AF}var sh=$r["__core-js_shared__"],Zy=function(){var t=/[^.]+$/.exec(sh&&sh.keys&&sh.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function MF(t){return!!Zy&&Zy in t}var $F=Function.prototype,LF=$F.toString;function zi(t){if(t!=null){try{return LF.call(t)}catch{}try{return t+""}catch{}}return""}var DF=/[\\^$.*+?()[\]{}|]/g,IF=/^\[object .+?Constructor\]$/,zF=Function.prototype,FF=Object.prototype,BF=zF.toString,HF=FF.hasOwnProperty,UF=RegExp("^"+BF.call(HF).replace(DF,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function WF(t){if(!gr(t)||MF(t))return!1;var e=lm(t)?UF:IF;return e.test(zi(t))}function GF(t,e){return t==null?void 0:t[e]}function Fi(t,e){var n=GF(t,e);return WF(n)?n:void 0}var Sl=Fi($r,"Map"),kl=Fi(Object,"create");function VF(){this.__data__=kl?kl(null):{},this.size=0}function YF(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var qF="__lodash_hash_undefined__",XF=Object.prototype,ZF=XF.hasOwnProperty;function KF(t){var e=this.__data__;if(kl){var n=e[t];return n===qF?void 0:n}return ZF.call(e,t)?e[t]:void 0}var JF=Object.prototype,QF=JF.hasOwnProperty;function eB(t){var e=this.__data__;return kl?e[t]!==void 0:QF.call(e,t)}var tB="__lodash_hash_undefined__";function nB(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=kl&&e===void 0?tB:e,this}function Ai(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Ai.prototype.clear=VF;Ai.prototype.delete=YF;Ai.prototype.get=KF;Ai.prototype.has=eB;Ai.prototype.set=nB;function rB(){this.size=0,this.__data__={hash:new Ai,map:new(Sl||xs),string:new Ai}}function sB(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function ru(t,e){var n=t.__data__;return sB(e)?n[typeof e=="string"?"string":"hash"]:n.map}function iB(t){var e=ru(this,t).delete(t);return this.size-=e?1:0,e}function oB(t){return ru(this,t).get(t)}function aB(t){return ru(this,t).has(t)}function lB(t,e){var n=ru(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this}function vs(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}vs.prototype.clear=rB;vs.prototype.delete=iB;vs.prototype.get=oB;vs.prototype.has=aB;vs.prototype.set=lB;var cB=200;function dB(t,e){var n=this.__data__;if(n instanceof xs){var r=n.__data__;if(!Sl||r.length<cB-1)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new vs(r)}return n.set(t,e),this.size=n.size,this}function Yr(t){var e=this.__data__=new xs(t);this.size=e.size}Yr.prototype.clear=yF;Yr.prototype.delete=xF;Yr.prototype.get=vF;Yr.prototype.has=bF;Yr.prototype.set=dB;var _d=function(){try{var t=Fi(Object,"defineProperty");return t({},"",{}),t}catch{}}();function cm(t,e,n){e=="__proto__"&&_d?_d(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function Sp(t,e,n){(n!==void 0&&!Fl(t[e],n)||n===void 0&&!(e in t))&&cm(t,e,n)}function uB(t){return function(e,n,r){for(var s=-1,i=Object(e),a=r(e),l=a.length;l--;){var c=a[++s];if(n(i[c],c,i)===!1)break}return e}}var g_=uB(),y_=typeof Xn=="object"&&Xn&&!Xn.nodeType&&Xn,Ky=y_&&typeof Zn=="object"&&Zn&&!Zn.nodeType&&Zn,hB=Ky&&Ky.exports===y_,Jy=hB?$r.Buffer:void 0;Jy&&Jy.allocUnsafe;function pB(t,e){return t.slice()}var Sd=$r.Uint8Array;function fB(t){var e=new t.constructor(t.byteLength);return new Sd(e).set(new Sd(t)),e}function mB(t,e){var n=fB(t.buffer);return new t.constructor(n,t.byteOffset,t.length)}function gB(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}var Qy=Object.create,yB=function(){function t(){}return function(e){if(!gr(e))return{};if(Qy)return Qy(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();function x_(t,e){return function(n){return t(e(n))}}var v_=x_(Object.getPrototypeOf,Object),xB=Object.prototype;function dm(t){var e=t&&t.constructor,n=typeof e=="function"&&e.prototype||xB;return t===n}function vB(t){return typeof t.constructor=="function"&&!dm(t)?yB(v_(t)):{}}function qs(t){return t!=null&&typeof t=="object"}var bB="[object Arguments]";function ex(t){return qs(t)&&Ii(t)==bB}var b_=Object.prototype,wB=b_.hasOwnProperty,_B=b_.propertyIsEnumerable,kd=ex(function(){return arguments}())?ex:function(t){return qs(t)&&wB.call(t,"callee")&&!_B.call(t,"callee")},Qn=Array.isArray,SB=9007199254740991;function um(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=SB}function fa(t){return t!=null&&um(t.length)&&!lm(t)}function kB(t){return qs(t)&&fa(t)}function jB(){return!1}var w_=typeof Xn=="object"&&Xn&&!Xn.nodeType&&Xn,tx=w_&&typeof Zn=="object"&&Zn&&!Zn.nodeType&&Zn,CB=tx&&tx.exports===w_,nx=CB?$r.Buffer:void 0,EB=nx?nx.isBuffer:void 0,jd=EB||jB,TB="[object Object]",NB=Function.prototype,PB=Object.prototype,__=NB.toString,RB=PB.hasOwnProperty,OB=__.call(Object);function AB(t){if(!qs(t)||Ii(t)!=TB)return!1;var e=v_(t);if(e===null)return!0;var n=RB.call(e,"constructor")&&e.constructor;return typeof n=="function"&&n instanceof n&&__.call(n)==OB}var MB="[object Arguments]",$B="[object Array]",LB="[object Boolean]",DB="[object Date]",IB="[object Error]",zB="[object Function]",FB="[object Map]",BB="[object Number]",HB="[object Object]",UB="[object RegExp]",WB="[object Set]",GB="[object String]",VB="[object WeakMap]",YB="[object ArrayBuffer]",qB="[object DataView]",XB="[object Float32Array]",ZB="[object Float64Array]",KB="[object Int8Array]",JB="[object Int16Array]",QB="[object Int32Array]",eH="[object Uint8Array]",tH="[object Uint8ClampedArray]",nH="[object Uint16Array]",rH="[object Uint32Array]",Lt={};Lt[XB]=Lt[ZB]=Lt[KB]=Lt[JB]=Lt[QB]=Lt[eH]=Lt[tH]=Lt[nH]=Lt[rH]=!0;Lt[MB]=Lt[$B]=Lt[YB]=Lt[LB]=Lt[qB]=Lt[DB]=Lt[IB]=Lt[zB]=Lt[FB]=Lt[BB]=Lt[HB]=Lt[UB]=Lt[WB]=Lt[GB]=Lt[VB]=!1;function sH(t){return qs(t)&&um(t.length)&&!!Lt[Ii(t)]}function iH(t){return function(e){return t(e)}}var S_=typeof Xn=="object"&&Xn&&!Xn.nodeType&&Xn,tl=S_&&typeof Zn=="object"&&Zn&&!Zn.nodeType&&Zn,oH=tl&&tl.exports===S_,ih=oH&&f_.process,rx=function(){try{var t=tl&&tl.require&&tl.require("util").types;return t||ih&&ih.binding&&ih.binding("util")}catch{}}(),sx=rx&&rx.isTypedArray,hm=sx?iH(sx):sH;function kp(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}var aH=Object.prototype,lH=aH.hasOwnProperty;function cH(t,e,n){var r=t[e];(!(lH.call(t,e)&&Fl(r,n))||n===void 0&&!(e in t))&&cm(t,e,n)}function dH(t,e,n,r){var s=!n;n||(n={});for(var i=-1,a=e.length;++i<a;){var l=e[i],c=void 0;c===void 0&&(c=t[l]),s?cm(n,l,c):cH(n,l,c)}return n}function uH(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}var hH=9007199254740991,pH=/^(?:0|[1-9]\d*)$/;function pm(t,e){var n=typeof t;return e=e??hH,!!e&&(n=="number"||n!="symbol"&&pH.test(t))&&t>-1&&t%1==0&&t<e}var fH=Object.prototype,mH=fH.hasOwnProperty;function k_(t,e){var n=Qn(t),r=!n&&kd(t),s=!n&&!r&&jd(t),i=!n&&!r&&!s&&hm(t),a=n||r||s||i,l=a?uH(t.length,String):[],c=l.length;for(var d in t)(e||mH.call(t,d))&&!(a&&(d=="length"||s&&(d=="offset"||d=="parent")||i&&(d=="buffer"||d=="byteLength"||d=="byteOffset")||pm(d,c)))&&l.push(d);return l}function gH(t){var e=[];if(t!=null)for(var n in Object(t))e.push(n);return e}var yH=Object.prototype,xH=yH.hasOwnProperty;function vH(t){if(!gr(t))return gH(t);var e=dm(t),n=[];for(var r in t)r=="constructor"&&(e||!xH.call(t,r))||n.push(r);return n}function j_(t){return fa(t)?k_(t,!0):vH(t)}function bH(t){return dH(t,j_(t))}function wH(t,e,n,r,s,i,a){var l=kp(t,n),c=kp(e,n),d=a.get(c);if(d){Sp(t,n,d);return}var u=i?i(l,c,n+"",t,e,a):void 0,p=u===void 0;if(p){var h=Qn(c),f=!h&&jd(c),m=!h&&!f&&hm(c);u=c,h||f||m?Qn(l)?u=l:kB(l)?u=gB(l):f?(p=!1,u=pB(c)):m?(p=!1,u=mB(c)):u=[]:AB(c)||kd(c)?(u=l,kd(l)?u=bH(l):(!gr(l)||lm(l))&&(u=vB(c))):p=!1}p&&(a.set(c,u),s(u,c,r,i,a),a.delete(c)),Sp(t,n,u)}function C_(t,e,n,r,s){t!==e&&g_(e,function(i,a){if(s||(s=new Yr),gr(i))wH(t,e,a,n,C_,r,s);else{var l=r?r(kp(t,a),i,a+"",t,e,s):void 0;l===void 0&&(l=i),Sp(t,a,l)}},j_)}function su(t){return t}function _H(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}var ix=Math.max;function SH(t,e,n){return e=ix(e===void 0?t.length-1:e,0),function(){for(var r=arguments,s=-1,i=ix(r.length-e,0),a=Array(i);++s<i;)a[s]=r[e+s];s=-1;for(var l=Array(e+1);++s<e;)l[s]=r[s];return l[e]=n(a),_H(t,this,l)}}function kH(t){return function(){return t}}var jH=_d?function(t,e){return _d(t,"toString",{configurable:!0,enumerable:!1,value:kH(e),writable:!0})}:su,CH=800,EH=16,TH=Date.now;function NH(t){var e=0,n=0;return function(){var r=TH(),s=EH-(r-n);if(n=r,s>0){if(++e>=CH)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var PH=NH(jH);function RH(t,e){return PH(SH(t,e,su),t+"")}function OH(t,e,n){if(!gr(n))return!1;var r=typeof e;return(r=="number"?fa(n)&&pm(e,n.length):r=="string"&&e in n)?Fl(n[e],t):!1}function AH(t){return RH(function(e,n){var r=-1,s=n.length,i=s>1?n[s-1]:void 0,a=s>2?n[2]:void 0;for(i=t.length>3&&typeof i=="function"?(s--,i):void 0,a&&OH(n[0],n[1],a)&&(i=s<3?void 0:i,s=1),e=Object(e);++r<s;){var l=n[r];l&&t(e,l,r,i)}return e})}var Fn=AH(function(t,e,n){C_(t,e,n)}),Bl=function(e){var n=e.zDepth,r=e.radius,s=e.background,i=e.children,a=e.styles,l=a===void 0?{}:a,c=at(Fn({default:{wrap:{position:"relative",display:"inline-block"},content:{position:"relative"},bg:{absolute:"0px 0px 0px 0px",boxShadow:"0 "+n+"px "+n*4+"px rgba(0,0,0,.24)",borderRadius:r,background:s}},"zDepth-0":{bg:{boxShadow:"none"}},"zDepth-1":{bg:{boxShadow:"0 2px 10px rgba(0,0,0,.12), 0 2px 5px rgba(0,0,0,.16)"}},"zDepth-2":{bg:{boxShadow:"0 6px 20px rgba(0,0,0,.19), 0 8px 17px rgba(0,0,0,.2)"}},"zDepth-3":{bg:{boxShadow:"0 17px 50px rgba(0,0,0,.19), 0 12px 15px rgba(0,0,0,.24)"}},"zDepth-4":{bg:{boxShadow:"0 25px 55px rgba(0,0,0,.21), 0 16px 28px rgba(0,0,0,.22)"}},"zDepth-5":{bg:{boxShadow:"0 40px 77px rgba(0,0,0,.22), 0 27px 24px rgba(0,0,0,.2)"}},square:{bg:{borderRadius:"0"}},circle:{bg:{borderRadius:"50%"}}},l),{"zDepth-1":n===1});return $.createElement("div",{style:c.wrap},$.createElement("div",{style:c.bg}),$.createElement("div",{style:c.content},i))};Bl.propTypes={background:Oe.string,zDepth:Oe.oneOf([0,1,2,3,4,5]),radius:Oe.number,styles:Oe.object};Bl.defaultProps={background:"#fff",zDepth:1,radius:2,styles:{}};var oh=function(){return $r.Date.now()},MH=/\s/;function $H(t){for(var e=t.length;e--&&MH.test(t.charAt(e)););return e}var LH=/^\s+/;function DH(t){return t&&t.slice(0,$H(t)+1).replace(LH,"")}var IH="[object Symbol]";function iu(t){return typeof t=="symbol"||qs(t)&&Ii(t)==IH}var ox=NaN,zH=/^[-+]0x[0-9a-f]+$/i,FH=/^0b[01]+$/i,BH=/^0o[0-7]+$/i,HH=parseInt;function ax(t){if(typeof t=="number")return t;if(iu(t))return ox;if(gr(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=gr(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=DH(t);var n=FH.test(t);return n||BH.test(t)?HH(t.slice(2),n?2:8):zH.test(t)?ox:+t}var UH="Expected a function",WH=Math.max,GH=Math.min;function E_(t,e,n){var r,s,i,a,l,c,d=0,u=!1,p=!1,h=!0;if(typeof t!="function")throw new TypeError(UH);e=ax(e)||0,gr(n)&&(u=!!n.leading,p="maxWait"in n,i=p?WH(ax(n.maxWait)||0,e):i,h="trailing"in n?!!n.trailing:h);function f(_){var k=r,E=s;return r=s=void 0,d=_,a=t.apply(E,k),a}function m(_){return d=_,l=setTimeout(y,e),u?f(_):a}function g(_){var k=_-c,E=_-d,T=e-k;return p?GH(T,i-E):T}function v(_){var k=_-c,E=_-d;return c===void 0||k>=e||k<0||p&&E>=i}function y(){var _=oh();if(v(_))return x(_);l=setTimeout(y,g(_))}function x(_){return l=void 0,h&&r?f(_):(r=s=void 0,a)}function b(){l!==void 0&&clearTimeout(l),d=0,r=c=s=l=void 0}function w(){return l===void 0?a:x(oh())}function S(){var _=oh(),k=v(_);if(r=arguments,s=this,c=_,k){if(l===void 0)return m(c);if(p)return clearTimeout(l),l=setTimeout(y,e),f(c)}return l===void 0&&(l=setTimeout(y,e)),a}return S.cancel=b,S.flush=w,S}var VH="Expected a function";function YH(t,e,n){var r=!0,s=!0;if(typeof t!="function")throw new TypeError(VH);return gr(n)&&(r="leading"in n?!!n.leading:r,s="trailing"in n?!!n.trailing:s),E_(t,e,{leading:r,maxWait:e,trailing:s})}var qH=function(e,n,r){var s=r.getBoundingClientRect(),i=s.width,a=s.height,l=typeof e.pageX=="number"?e.pageX:e.touches[0].pageX,c=typeof e.pageY=="number"?e.pageY:e.touches[0].pageY,d=l-(r.getBoundingClientRect().left+window.pageXOffset),u=c-(r.getBoundingClientRect().top+window.pageYOffset);d<0?d=0:d>i&&(d=i),u<0?u=0:u>a&&(u=a);var p=d/i,h=1-u/a;return{h:n.h,s:p,v:h,a:n.a,source:"hsv"}},XH=function(){function t(e,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function ZH(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function KH(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function JH(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var ou=function(t){JH(e,t);function e(n){ZH(this,e);var r=KH(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,n));return r.handleChange=function(s){typeof r.props.onChange=="function"&&r.throttle(r.props.onChange,qH(s,r.props.hsl,r.container),s)},r.handleMouseDown=function(s){r.handleChange(s);var i=r.getContainerRenderWindow();i.addEventListener("mousemove",r.handleChange),i.addEventListener("mouseup",r.handleMouseUp)},r.handleMouseUp=function(){r.unbindEventListeners()},r.throttle=YH(function(s,i,a){s(i,a)},50),r}return XH(e,[{key:"componentWillUnmount",value:function(){this.throttle.cancel(),this.unbindEventListeners()}},{key:"getContainerRenderWindow",value:function(){for(var r=this.container,s=window;!s.document.contains(r)&&s.parent!==s;)s=s.parent;return s}},{key:"unbindEventListeners",value:function(){var r=this.getContainerRenderWindow();r.removeEventListener("mousemove",this.handleChange),r.removeEventListener("mouseup",this.handleMouseUp)}},{key:"render",value:function(){var r=this,s=this.props.style||{},i=s.color,a=s.white,l=s.black,c=s.pointer,d=s.circle,u=at({default:{color:{absolute:"0px 0px 0px 0px",background:"hsl("+this.props.hsl.h+",100%, 50%)",borderRadius:this.props.radius},white:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius},black:{absolute:"0px 0px 0px 0px",boxShadow:this.props.shadow,borderRadius:this.props.radius},pointer:{position:"absolute",top:-(this.props.hsv.v*100)+100+"%",left:this.props.hsv.s*100+"%",cursor:"default"},circle:{width:"4px",height:"4px",boxShadow:`0 0 0 1.5px #fff, inset 0 0 1px 1px rgba(0,0,0,.3),
            0 0 1px 2px rgba(0,0,0,.4)`,borderRadius:"50%",cursor:"hand",transform:"translate(-2px, -2px)"}},custom:{color:i,white:a,black:l,pointer:c,circle:d}},{custom:!!this.props.style});return $.createElement("div",{style:u.color,ref:function(h){return r.container=h},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},$.createElement("style",null,`
          .saturation-white {
            background: -webkit-linear-gradient(to right, #fff, rgba(255,255,255,0));
            background: linear-gradient(to right, #fff, rgba(255,255,255,0));
          }
          .saturation-black {
            background: -webkit-linear-gradient(to top, #000, rgba(0,0,0,0));
            background: linear-gradient(to top, #000, rgba(0,0,0,0));
          }
        `),$.createElement("div",{style:u.white,className:"saturation-white"},$.createElement("div",{style:u.black,className:"saturation-black"}),$.createElement("div",{style:u.pointer},this.props.pointer?$.createElement(this.props.pointer,this.props):$.createElement("div",{style:u.circle}))))}}]),e}(R.PureComponent||R.Component);function QH(t,e){for(var n=-1,r=t==null?0:t.length;++n<r&&e(t[n],n,t)!==!1;);return t}var e7=x_(Object.keys,Object),t7=Object.prototype,n7=t7.hasOwnProperty;function r7(t){if(!dm(t))return e7(t);var e=[];for(var n in Object(t))n7.call(t,n)&&n!="constructor"&&e.push(n);return e}function fm(t){return fa(t)?k_(t):r7(t)}function s7(t,e){return t&&g_(t,e,fm)}function i7(t,e){return function(n,r){if(n==null)return n;if(!fa(n))return t(n,r);for(var s=n.length,i=-1,a=Object(n);++i<s&&r(a[i],i,a)!==!1;);return n}}var T_=i7(s7);function o7(t){return typeof t=="function"?t:su}function a7(t,e){var n=Qn(t)?QH:T_;return n(t,o7(e))}function Cd(t){"@babel/helpers - typeof";return Cd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cd(t)}var l7=/^\s+/,c7=/\s+$/;function Ye(t,e){if(t=t||"",e=e||{},t instanceof Ye)return t;if(!(this instanceof Ye))return new Ye(t,e);var n=d7(t);this._originalInput=t,this._r=n.r,this._g=n.g,this._b=n.b,this._a=n.a,this._roundA=Math.round(100*this._a)/100,this._format=e.format||n.format,this._gradientType=e.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=n.ok}Ye.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},getLuminance:function(){var e=this.toRgb(),n,r,s,i,a,l;return n=e.r/255,r=e.g/255,s=e.b/255,n<=.03928?i=n/12.92:i=Math.pow((n+.055)/1.055,2.4),r<=.03928?a=r/12.92:a=Math.pow((r+.055)/1.055,2.4),s<=.03928?l=s/12.92:l=Math.pow((s+.055)/1.055,2.4),.2126*i+.7152*a+.0722*l},setAlpha:function(e){return this._a=N_(e),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var e=cx(this._r,this._g,this._b);return{h:e.h*360,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=cx(this._r,this._g,this._b),n=Math.round(e.h*360),r=Math.round(e.s*100),s=Math.round(e.v*100);return this._a==1?"hsv("+n+", "+r+"%, "+s+"%)":"hsva("+n+", "+r+"%, "+s+"%, "+this._roundA+")"},toHsl:function(){var e=lx(this._r,this._g,this._b);return{h:e.h*360,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=lx(this._r,this._g,this._b),n=Math.round(e.h*360),r=Math.round(e.s*100),s=Math.round(e.l*100);return this._a==1?"hsl("+n+", "+r+"%, "+s+"%)":"hsla("+n+", "+r+"%, "+s+"%, "+this._roundA+")"},toHex:function(e){return dx(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return f7(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(zt(this._r,255)*100)+"%",g:Math.round(zt(this._g,255)*100)+"%",b:Math.round(zt(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(zt(this._r,255)*100)+"%, "+Math.round(zt(this._g,255)*100)+"%, "+Math.round(zt(this._b,255)*100)+"%)":"rgba("+Math.round(zt(this._r,255)*100)+"%, "+Math.round(zt(this._g,255)*100)+"%, "+Math.round(zt(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:C7[dx(this._r,this._g,this._b,!0)]||!1},toFilter:function(e){var n="#"+ux(this._r,this._g,this._b,this._a),r=n,s=this._gradientType?"GradientType = 1, ":"";if(e){var i=Ye(e);r="#"+ux(i._r,i._g,i._b,i._a)}return"progid:DXImageTransform.Microsoft.gradient("+s+"startColorstr="+n+",endColorstr="+r+")"},toString:function(e){var n=!!e;e=e||this._format;var r=!1,s=this._a<1&&this._a>=0,i=!n&&s&&(e==="hex"||e==="hex6"||e==="hex3"||e==="hex4"||e==="hex8"||e==="name");return i?e==="name"&&this._a===0?this.toName():this.toRgbString():(e==="rgb"&&(r=this.toRgbString()),e==="prgb"&&(r=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(r=this.toHexString()),e==="hex3"&&(r=this.toHexString(!0)),e==="hex4"&&(r=this.toHex8String(!0)),e==="hex8"&&(r=this.toHex8String()),e==="name"&&(r=this.toName()),e==="hsl"&&(r=this.toHslString()),e==="hsv"&&(r=this.toHsvString()),r||this.toHexString())},clone:function(){return Ye(this.toString())},_applyModification:function(e,n){var r=e.apply(null,[this].concat([].slice.call(n)));return this._r=r._r,this._g=r._g,this._b=r._b,this.setAlpha(r._a),this},lighten:function(){return this._applyModification(x7,arguments)},brighten:function(){return this._applyModification(v7,arguments)},darken:function(){return this._applyModification(b7,arguments)},desaturate:function(){return this._applyModification(m7,arguments)},saturate:function(){return this._applyModification(g7,arguments)},greyscale:function(){return this._applyModification(y7,arguments)},spin:function(){return this._applyModification(w7,arguments)},_applyCombination:function(e,n){return e.apply(null,[this].concat([].slice.call(n)))},analogous:function(){return this._applyCombination(k7,arguments)},complement:function(){return this._applyCombination(_7,arguments)},monochromatic:function(){return this._applyCombination(j7,arguments)},splitcomplement:function(){return this._applyCombination(S7,arguments)},triad:function(){return this._applyCombination(hx,[3])},tetrad:function(){return this._applyCombination(hx,[4])}};Ye.fromRatio=function(t,e){if(Cd(t)=="object"){var n={};for(var r in t)t.hasOwnProperty(r)&&(r==="a"?n[r]=t[r]:n[r]=Fa(t[r]));t=n}return Ye(t,e)};function d7(t){var e={r:0,g:0,b:0},n=1,r=null,s=null,i=null,a=!1,l=!1;return typeof t=="string"&&(t=P7(t)),Cd(t)=="object"&&(is(t.r)&&is(t.g)&&is(t.b)?(e=u7(t.r,t.g,t.b),a=!0,l=String(t.r).substr(-1)==="%"?"prgb":"rgb"):is(t.h)&&is(t.s)&&is(t.v)?(r=Fa(t.s),s=Fa(t.v),e=p7(t.h,r,s),a=!0,l="hsv"):is(t.h)&&is(t.s)&&is(t.l)&&(r=Fa(t.s),i=Fa(t.l),e=h7(t.h,r,i),a=!0,l="hsl"),t.hasOwnProperty("a")&&(n=t.a)),n=N_(n),{ok:a,format:t.format||l,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:n}}function u7(t,e,n){return{r:zt(t,255)*255,g:zt(e,255)*255,b:zt(n,255)*255}}function lx(t,e,n){t=zt(t,255),e=zt(e,255),n=zt(n,255);var r=Math.max(t,e,n),s=Math.min(t,e,n),i,a,l=(r+s)/2;if(r==s)i=a=0;else{var c=r-s;switch(a=l>.5?c/(2-r-s):c/(r+s),r){case t:i=(e-n)/c+(e<n?6:0);break;case e:i=(n-t)/c+2;break;case n:i=(t-e)/c+4;break}i/=6}return{h:i,s:a,l}}function h7(t,e,n){var r,s,i;t=zt(t,360),e=zt(e,100),n=zt(n,100);function a(d,u,p){return p<0&&(p+=1),p>1&&(p-=1),p<1/6?d+(u-d)*6*p:p<1/2?u:p<2/3?d+(u-d)*(2/3-p)*6:d}if(e===0)r=s=i=n;else{var l=n<.5?n*(1+e):n+e-n*e,c=2*n-l;r=a(c,l,t+1/3),s=a(c,l,t),i=a(c,l,t-1/3)}return{r:r*255,g:s*255,b:i*255}}function cx(t,e,n){t=zt(t,255),e=zt(e,255),n=zt(n,255);var r=Math.max(t,e,n),s=Math.min(t,e,n),i,a,l=r,c=r-s;if(a=r===0?0:c/r,r==s)i=0;else{switch(r){case t:i=(e-n)/c+(e<n?6:0);break;case e:i=(n-t)/c+2;break;case n:i=(t-e)/c+4;break}i/=6}return{h:i,s:a,v:l}}function p7(t,e,n){t=zt(t,360)*6,e=zt(e,100),n=zt(n,100);var r=Math.floor(t),s=t-r,i=n*(1-e),a=n*(1-s*e),l=n*(1-(1-s)*e),c=r%6,d=[n,a,i,i,l,n][c],u=[l,n,n,a,i,i][c],p=[i,i,l,n,n,a][c];return{r:d*255,g:u*255,b:p*255}}function dx(t,e,n,r){var s=[Pr(Math.round(t).toString(16)),Pr(Math.round(e).toString(16)),Pr(Math.round(n).toString(16))];return r&&s[0].charAt(0)==s[0].charAt(1)&&s[1].charAt(0)==s[1].charAt(1)&&s[2].charAt(0)==s[2].charAt(1)?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0):s.join("")}function f7(t,e,n,r,s){var i=[Pr(Math.round(t).toString(16)),Pr(Math.round(e).toString(16)),Pr(Math.round(n).toString(16)),Pr(P_(r))];return s&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)&&i[3].charAt(0)==i[3].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0)+i[3].charAt(0):i.join("")}function ux(t,e,n,r){var s=[Pr(P_(r)),Pr(Math.round(t).toString(16)),Pr(Math.round(e).toString(16)),Pr(Math.round(n).toString(16))];return s.join("")}Ye.equals=function(t,e){return!t||!e?!1:Ye(t).toRgbString()==Ye(e).toRgbString()};Ye.random=function(){return Ye.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function m7(t,e){e=e===0?0:e||10;var n=Ye(t).toHsl();return n.s-=e/100,n.s=au(n.s),Ye(n)}function g7(t,e){e=e===0?0:e||10;var n=Ye(t).toHsl();return n.s+=e/100,n.s=au(n.s),Ye(n)}function y7(t){return Ye(t).desaturate(100)}function x7(t,e){e=e===0?0:e||10;var n=Ye(t).toHsl();return n.l+=e/100,n.l=au(n.l),Ye(n)}function v7(t,e){e=e===0?0:e||10;var n=Ye(t).toRgb();return n.r=Math.max(0,Math.min(255,n.r-Math.round(255*-(e/100)))),n.g=Math.max(0,Math.min(255,n.g-Math.round(255*-(e/100)))),n.b=Math.max(0,Math.min(255,n.b-Math.round(255*-(e/100)))),Ye(n)}function b7(t,e){e=e===0?0:e||10;var n=Ye(t).toHsl();return n.l-=e/100,n.l=au(n.l),Ye(n)}function w7(t,e){var n=Ye(t).toHsl(),r=(n.h+e)%360;return n.h=r<0?360+r:r,Ye(n)}function _7(t){var e=Ye(t).toHsl();return e.h=(e.h+180)%360,Ye(e)}function hx(t,e){if(isNaN(e)||e<=0)throw new Error("Argument to polyad must be a positive number");for(var n=Ye(t).toHsl(),r=[Ye(t)],s=360/e,i=1;i<e;i++)r.push(Ye({h:(n.h+i*s)%360,s:n.s,l:n.l}));return r}function S7(t){var e=Ye(t).toHsl(),n=e.h;return[Ye(t),Ye({h:(n+72)%360,s:e.s,l:e.l}),Ye({h:(n+216)%360,s:e.s,l:e.l})]}function k7(t,e,n){e=e||6,n=n||30;var r=Ye(t).toHsl(),s=360/n,i=[Ye(t)];for(r.h=(r.h-(s*e>>1)+720)%360;--e;)r.h=(r.h+s)%360,i.push(Ye(r));return i}function j7(t,e){e=e||6;for(var n=Ye(t).toHsv(),r=n.h,s=n.s,i=n.v,a=[],l=1/e;e--;)a.push(Ye({h:r,s,v:i})),i=(i+l)%1;return a}Ye.mix=function(t,e,n){n=n===0?0:n||50;var r=Ye(t).toRgb(),s=Ye(e).toRgb(),i=n/100,a={r:(s.r-r.r)*i+r.r,g:(s.g-r.g)*i+r.g,b:(s.b-r.b)*i+r.b,a:(s.a-r.a)*i+r.a};return Ye(a)};Ye.readability=function(t,e){var n=Ye(t),r=Ye(e);return(Math.max(n.getLuminance(),r.getLuminance())+.05)/(Math.min(n.getLuminance(),r.getLuminance())+.05)};Ye.isReadable=function(t,e,n){var r=Ye.readability(t,e),s,i;switch(i=!1,s=R7(n),s.level+s.size){case"AAsmall":case"AAAlarge":i=r>=4.5;break;case"AAlarge":i=r>=3;break;case"AAAsmall":i=r>=7;break}return i};Ye.mostReadable=function(t,e,n){var r=null,s=0,i,a,l,c;n=n||{},a=n.includeFallbackColors,l=n.level,c=n.size;for(var d=0;d<e.length;d++)i=Ye.readability(t,e[d]),i>s&&(s=i,r=Ye(e[d]));return Ye.isReadable(t,r,{level:l,size:c})||!a?r:(n.includeFallbackColors=!1,Ye.mostReadable(t,["#fff","#000"],n))};var jp=Ye.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},C7=Ye.hexNames=E7(jp);function E7(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[t[n]]=n);return e}function N_(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function zt(t,e){T7(t)&&(t="100%");var n=N7(t);return t=Math.min(e,Math.max(0,parseFloat(t))),n&&(t=parseInt(t*e,10)/100),Math.abs(t-e)<1e-6?1:t%e/parseFloat(e)}function au(t){return Math.min(1,Math.max(0,t))}function Wn(t){return parseInt(t,16)}function T7(t){return typeof t=="string"&&t.indexOf(".")!=-1&&parseFloat(t)===1}function N7(t){return typeof t=="string"&&t.indexOf("%")!=-1}function Pr(t){return t.length==1?"0"+t:""+t}function Fa(t){return t<=1&&(t=t*100+"%"),t}function P_(t){return Math.round(parseFloat(t)*255).toString(16)}function px(t){return Wn(t)/255}var Sr=function(){var t="[-\\+]?\\d+%?",e="[-\\+]?\\d*\\.\\d+%?",n="(?:"+e+")|(?:"+t+")",r="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?",s="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?";return{CSS_UNIT:new RegExp(n),rgb:new RegExp("rgb"+r),rgba:new RegExp("rgba"+s),hsl:new RegExp("hsl"+r),hsla:new RegExp("hsla"+s),hsv:new RegExp("hsv"+r),hsva:new RegExp("hsva"+s),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function is(t){return!!Sr.CSS_UNIT.exec(t)}function P7(t){t=t.replace(l7,"").replace(c7,"").toLowerCase();var e=!1;if(jp[t])t=jp[t],e=!0;else if(t=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var n;return(n=Sr.rgb.exec(t))?{r:n[1],g:n[2],b:n[3]}:(n=Sr.rgba.exec(t))?{r:n[1],g:n[2],b:n[3],a:n[4]}:(n=Sr.hsl.exec(t))?{h:n[1],s:n[2],l:n[3]}:(n=Sr.hsla.exec(t))?{h:n[1],s:n[2],l:n[3],a:n[4]}:(n=Sr.hsv.exec(t))?{h:n[1],s:n[2],v:n[3]}:(n=Sr.hsva.exec(t))?{h:n[1],s:n[2],v:n[3],a:n[4]}:(n=Sr.hex8.exec(t))?{r:Wn(n[1]),g:Wn(n[2]),b:Wn(n[3]),a:px(n[4]),format:e?"name":"hex8"}:(n=Sr.hex6.exec(t))?{r:Wn(n[1]),g:Wn(n[2]),b:Wn(n[3]),format:e?"name":"hex"}:(n=Sr.hex4.exec(t))?{r:Wn(n[1]+""+n[1]),g:Wn(n[2]+""+n[2]),b:Wn(n[3]+""+n[3]),a:px(n[4]+""+n[4]),format:e?"name":"hex8"}:(n=Sr.hex3.exec(t))?{r:Wn(n[1]+""+n[1]),g:Wn(n[2]+""+n[2]),b:Wn(n[3]+""+n[3]),format:e?"name":"hex"}:!1}function R7(t){var e,n;return t=t||{level:"AA",size:"small"},e=(t.level||"AA").toUpperCase(),n=(t.size||"small").toLowerCase(),e!=="AA"&&e!=="AAA"&&(e="AA"),n!=="small"&&n!=="large"&&(n="small"),{level:e,size:n}}var fx=function(e){var n=["r","g","b","a","h","s","l","v"],r=0,s=0;return a7(n,function(i){if(e[i]&&(r+=1,isNaN(e[i])||(s+=1),i==="s"||i==="l")){var a=/^\d+%$/;a.test(e[i])&&(s+=1)}}),r===s?e:!1},Ba=function(e,n){var r=e.hex?Ye(e.hex):Ye(e),s=r.toHsl(),i=r.toHsv(),a=r.toRgb(),l=r.toHex();s.s===0&&(s.h=n||0,i.h=n||0);var c=l==="000000"&&a.a===0;return{hsl:s,hex:c?"transparent":"#"+l,rgb:a,hsv:i,oldHue:e.h||n||s.h,source:e.source}},Qs=function(e){if(e==="transparent")return!0;var n=String(e).charAt(0)==="#"?1:0;return e.length!==4+n&&e.length<7+n&&Ye(e).isValid()},mm=function(e){if(!e)return"#fff";var n=Ba(e);if(n.hex==="transparent")return"rgba(0,0,0,0.4)";var r=(n.rgb.r*299+n.rgb.g*587+n.rgb.b*114)/1e3;return r>=128?"#000":"#fff"},ah=function(e,n){var r=e.replace("","");return Ye(n+" ("+r+")")._ok},Ra=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},O7=function(){function t(e,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function A7(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function M7(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function $7(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var Bn=function(e){var n=function(r){$7(s,r);function s(i){A7(this,s);var a=M7(this,(s.__proto__||Object.getPrototypeOf(s)).call(this));return a.handleChange=function(l,c){var d=fx(l);if(d){var u=Ba(l,l.h||a.state.oldHue);a.setState(u),a.props.onChangeComplete&&a.debounce(a.props.onChangeComplete,u,c),a.props.onChange&&a.props.onChange(u,c)}},a.handleSwatchHover=function(l,c){var d=fx(l);if(d){var u=Ba(l,l.h||a.state.oldHue);a.props.onSwatchHover&&a.props.onSwatchHover(u,c)}},a.state=Ra({},Ba(i.color,0)),a.debounce=E_(function(l,c,d){l(c,d)},100),a}return O7(s,[{key:"render",value:function(){var a={};return this.props.onSwatchHover&&(a.onSwatchHover=this.handleSwatchHover),$.createElement(e,Ra({},this.props,this.state,{onChange:this.handleChange},a))}}],[{key:"getDerivedStateFromProps",value:function(a,l){return Ra({},Ba(a.color,l.oldHue))}}]),s}(R.PureComponent||R.Component);return n.propTypes=Ra({},e.propTypes),n.defaultProps=Ra({},e.defaultProps,{color:{h:250,s:.5,l:.2,a:1}}),n},L7=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},D7=function(){function t(e,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function I7(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function mx(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function z7(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var F7=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"span";return function(r){z7(s,r);function s(){var i,a,l,c;I7(this,s);for(var d=arguments.length,u=Array(d),p=0;p<d;p++)u[p]=arguments[p];return c=(a=(l=mx(this,(i=s.__proto__||Object.getPrototypeOf(s)).call.apply(i,[this].concat(u))),l),l.state={focus:!1},l.handleFocus=function(){return l.setState({focus:!0})},l.handleBlur=function(){return l.setState({focus:!1})},a),mx(l,c)}return D7(s,[{key:"render",value:function(){return $.createElement(n,{onFocus:this.handleFocus,onBlur:this.handleBlur},$.createElement(e,L7({},this.props,this.state)))}}]),s}($.Component)},gx=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},B7=13,H7=function(e){var n=e.color,r=e.style,s=e.onClick,i=s===void 0?function(){}:s,a=e.onHover,l=e.title,c=l===void 0?n:l,d=e.children,u=e.focus,p=e.focusStyle,h=p===void 0?{}:p,f=n==="transparent",m=at({default:{swatch:gx({background:n,height:"100%",width:"100%",cursor:"pointer",position:"relative",outline:"none"},r,u?h:{})}}),g=function(w){return i(n,w)},v=function(w){return w.keyCode===B7&&i(n,w)},y=function(w){return a(n,w)},x={};return a&&(x.onMouseOver=y),$.createElement("div",gx({style:m.swatch,onClick:g,title:c,tabIndex:0,onKeyDown:v},x),d,f&&$.createElement(ha,{borderRadius:m.swatch.borderRadius,boxShadow:"inset 0 0 0 1px rgba(0,0,0,0.1)"}))};const Bi=F7(H7);var U7=function(e){var n=e.direction,r=at({default:{picker:{width:"18px",height:"18px",borderRadius:"50%",transform:"translate(-9px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}},vertical:{picker:{transform:"translate(-3px, -9px)"}}},{vertical:n==="vertical"});return $.createElement("div",{style:r.picker})},W7=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},R_=function(e){var n=e.rgb,r=e.hsl,s=e.width,i=e.height,a=e.onChange,l=e.direction,c=e.style,d=e.renderers,u=e.pointer,p=e.className,h=p===void 0?"":p,f=at({default:{picker:{position:"relative",width:s,height:i},alpha:{radius:"2px",style:c}}});return $.createElement("div",{style:f.picker,className:"alpha-picker "+h},$.createElement(am,W7({},f.alpha,{rgb:n,hsl:r,pointer:u,renderers:d,onChange:a,direction:l})))};R_.defaultProps={width:"316px",height:"16px",direction:"horizontal",pointer:U7};Bn(R_);function O_(t,e){for(var n=-1,r=t==null?0:t.length,s=Array(r);++n<r;)s[n]=e(t[n],n,t);return s}var G7="__lodash_hash_undefined__";function V7(t){return this.__data__.set(t,G7),this}function Y7(t){return this.__data__.has(t)}function Ed(t){var e=-1,n=t==null?0:t.length;for(this.__data__=new vs;++e<n;)this.add(t[e])}Ed.prototype.add=Ed.prototype.push=V7;Ed.prototype.has=Y7;function q7(t,e){for(var n=-1,r=t==null?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}function X7(t,e){return t.has(e)}var Z7=1,K7=2;function A_(t,e,n,r,s,i){var a=n&Z7,l=t.length,c=e.length;if(l!=c&&!(a&&c>l))return!1;var d=i.get(t),u=i.get(e);if(d&&u)return d==e&&u==t;var p=-1,h=!0,f=n&K7?new Ed:void 0;for(i.set(t,e),i.set(e,t);++p<l;){var m=t[p],g=e[p];if(r)var v=a?r(g,m,p,e,t,i):r(m,g,p,t,e,i);if(v!==void 0){if(v)continue;h=!1;break}if(f){if(!q7(e,function(y,x){if(!X7(f,x)&&(m===y||s(m,y,n,r,i)))return f.push(x)})){h=!1;break}}else if(!(m===g||s(m,g,n,r,i))){h=!1;break}}return i.delete(t),i.delete(e),h}function J7(t){var e=-1,n=Array(t.size);return t.forEach(function(r,s){n[++e]=[s,r]}),n}function Q7(t){var e=-1,n=Array(t.size);return t.forEach(function(r){n[++e]=r}),n}var eU=1,tU=2,nU="[object Boolean]",rU="[object Date]",sU="[object Error]",iU="[object Map]",oU="[object Number]",aU="[object RegExp]",lU="[object Set]",cU="[object String]",dU="[object Symbol]",uU="[object ArrayBuffer]",hU="[object DataView]",yx=Ys?Ys.prototype:void 0,lh=yx?yx.valueOf:void 0;function pU(t,e,n,r,s,i,a){switch(n){case hU:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case uU:return!(t.byteLength!=e.byteLength||!i(new Sd(t),new Sd(e)));case nU:case rU:case oU:return Fl(+t,+e);case sU:return t.name==e.name&&t.message==e.message;case aU:case cU:return t==e+"";case iU:var l=J7;case lU:var c=r&eU;if(l||(l=Q7),t.size!=e.size&&!c)return!1;var d=a.get(t);if(d)return d==e;r|=tU,a.set(t,e);var u=A_(l(t),l(e),r,s,i,a);return a.delete(t),u;case dU:if(lh)return lh.call(t)==lh.call(e)}return!1}function fU(t,e){for(var n=-1,r=e.length,s=t.length;++n<r;)t[s+n]=e[n];return t}function mU(t,e,n){var r=e(t);return Qn(t)?r:fU(r,n(t))}function gU(t,e){for(var n=-1,r=t==null?0:t.length,s=0,i=[];++n<r;){var a=t[n];e(a,n,t)&&(i[s++]=a)}return i}function yU(){return[]}var xU=Object.prototype,vU=xU.propertyIsEnumerable,xx=Object.getOwnPropertySymbols,bU=xx?function(t){return t==null?[]:(t=Object(t),gU(xx(t),function(e){return vU.call(t,e)}))}:yU;function vx(t){return mU(t,fm,bU)}var wU=1,_U=Object.prototype,SU=_U.hasOwnProperty;function kU(t,e,n,r,s,i){var a=n&wU,l=vx(t),c=l.length,d=vx(e),u=d.length;if(c!=u&&!a)return!1;for(var p=c;p--;){var h=l[p];if(!(a?h in e:SU.call(e,h)))return!1}var f=i.get(t),m=i.get(e);if(f&&m)return f==e&&m==t;var g=!0;i.set(t,e),i.set(e,t);for(var v=a;++p<c;){h=l[p];var y=t[h],x=e[h];if(r)var b=a?r(x,y,h,e,t,i):r(y,x,h,t,e,i);if(!(b===void 0?y===x||s(y,x,n,r,i):b)){g=!1;break}v||(v=h=="constructor")}if(g&&!v){var w=t.constructor,S=e.constructor;w!=S&&"constructor"in t&&"constructor"in e&&!(typeof w=="function"&&w instanceof w&&typeof S=="function"&&S instanceof S)&&(g=!1)}return i.delete(t),i.delete(e),g}var Cp=Fi($r,"DataView"),Ep=Fi($r,"Promise"),Tp=Fi($r,"Set"),Np=Fi($r,"WeakMap"),bx="[object Map]",jU="[object Object]",wx="[object Promise]",_x="[object Set]",Sx="[object WeakMap]",kx="[object DataView]",CU=zi(Cp),EU=zi(Sl),TU=zi(Ep),NU=zi(Tp),PU=zi(Np),Ts=Ii;(Cp&&Ts(new Cp(new ArrayBuffer(1)))!=kx||Sl&&Ts(new Sl)!=bx||Ep&&Ts(Ep.resolve())!=wx||Tp&&Ts(new Tp)!=_x||Np&&Ts(new Np)!=Sx)&&(Ts=function(t){var e=Ii(t),n=e==jU?t.constructor:void 0,r=n?zi(n):"";if(r)switch(r){case CU:return kx;case EU:return bx;case TU:return wx;case NU:return _x;case PU:return Sx}return e});var RU=1,jx="[object Arguments]",Cx="[object Array]",kc="[object Object]",OU=Object.prototype,Ex=OU.hasOwnProperty;function AU(t,e,n,r,s,i){var a=Qn(t),l=Qn(e),c=a?Cx:Ts(t),d=l?Cx:Ts(e);c=c==jx?kc:c,d=d==jx?kc:d;var u=c==kc,p=d==kc,h=c==d;if(h&&jd(t)){if(!jd(e))return!1;a=!0,u=!1}if(h&&!u)return i||(i=new Yr),a||hm(t)?A_(t,e,n,r,s,i):pU(t,e,c,n,r,s,i);if(!(n&RU)){var f=u&&Ex.call(t,"__wrapped__"),m=p&&Ex.call(e,"__wrapped__");if(f||m){var g=f?t.value():t,v=m?e.value():e;return i||(i=new Yr),s(g,v,n,r,i)}}return h?(i||(i=new Yr),kU(t,e,n,r,s,i)):!1}function gm(t,e,n,r,s){return t===e?!0:t==null||e==null||!qs(t)&&!qs(e)?t!==t&&e!==e:AU(t,e,n,r,gm,s)}var MU=1,$U=2;function LU(t,e,n,r){var s=n.length,i=s;if(t==null)return!i;for(t=Object(t);s--;){var a=n[s];if(a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++s<i;){a=n[s];var l=a[0],c=t[l],d=a[1];if(a[2]){if(c===void 0&&!(l in t))return!1}else{var u=new Yr,p;if(!(p===void 0?gm(d,c,MU|$U,r,u):p))return!1}}return!0}function M_(t){return t===t&&!gr(t)}function DU(t){for(var e=fm(t),n=e.length;n--;){var r=e[n],s=t[r];e[n]=[r,s,M_(s)]}return e}function $_(t,e){return function(n){return n==null?!1:n[t]===e&&(e!==void 0||t in Object(n))}}function IU(t){var e=DU(t);return e.length==1&&e[0][2]?$_(e[0][0],e[0][1]):function(n){return n===t||LU(n,t,e)}}var zU=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,FU=/^\w*$/;function ym(t,e){if(Qn(t))return!1;var n=typeof t;return n=="number"||n=="symbol"||n=="boolean"||t==null||iu(t)?!0:FU.test(t)||!zU.test(t)||e!=null&&t in Object(e)}var BU="Expected a function";function xm(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(BU);var n=function(){var r=arguments,s=e?e.apply(this,r):r[0],i=n.cache;if(i.has(s))return i.get(s);var a=t.apply(this,r);return n.cache=i.set(s,a)||i,a};return n.cache=new(xm.Cache||vs),n}xm.Cache=vs;var HU=500;function UU(t){var e=xm(t,function(r){return n.size===HU&&n.clear(),r}),n=e.cache;return e}var WU=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,GU=/\\(\\)?/g,VU=UU(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(WU,function(n,r,s,i){e.push(s?i.replace(GU,"$1"):r||n)}),e}),Tx=Ys?Ys.prototype:void 0,Nx=Tx?Tx.toString:void 0;function L_(t){if(typeof t=="string")return t;if(Qn(t))return O_(t,L_)+"";if(iu(t))return Nx?Nx.call(t):"";var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}function YU(t){return t==null?"":L_(t)}function D_(t,e){return Qn(t)?t:ym(t,e)?[t]:VU(YU(t))}function lu(t){if(typeof t=="string"||iu(t))return t;var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}function I_(t,e){e=D_(e,t);for(var n=0,r=e.length;t!=null&&n<r;)t=t[lu(e[n++])];return n&&n==r?t:void 0}function qU(t,e,n){var r=t==null?void 0:I_(t,e);return r===void 0?n:r}function XU(t,e){return t!=null&&e in Object(t)}function ZU(t,e,n){e=D_(e,t);for(var r=-1,s=e.length,i=!1;++r<s;){var a=lu(e[r]);if(!(i=t!=null&&n(t,a)))break;t=t[a]}return i||++r!=s?i:(s=t==null?0:t.length,!!s&&um(s)&&pm(a,s)&&(Qn(t)||kd(t)))}function KU(t,e){return t!=null&&ZU(t,e,XU)}var JU=1,QU=2;function e9(t,e){return ym(t)&&M_(e)?$_(lu(t),e):function(n){var r=qU(n,t);return r===void 0&&r===e?KU(n,t):gm(e,r,JU|QU)}}function t9(t){return function(e){return e==null?void 0:e[t]}}function n9(t){return function(e){return I_(e,t)}}function r9(t){return ym(t)?t9(lu(t)):n9(t)}function s9(t){return typeof t=="function"?t:t==null?su:typeof t=="object"?Qn(t)?e9(t[0],t[1]):IU(t):r9(t)}function i9(t,e){var n=-1,r=fa(t)?Array(t.length):[];return T_(t,function(s,i,a){r[++n]=e(s,i,a)}),r}function Hi(t,e){var n=Qn(t)?O_:i9;return n(t,s9(e))}var o9=function(e){var n=e.colors,r=e.onClick,s=e.onSwatchHover,i=at({default:{swatches:{marginRight:"-10px"},swatch:{width:"22px",height:"22px",float:"left",marginRight:"10px",marginBottom:"10px",borderRadius:"4px"},clear:{clear:"both"}}});return $.createElement("div",{style:i.swatches},Hi(n,function(a){return $.createElement(Bi,{key:a,color:a,style:i.swatch,onClick:r,onHover:s,focusStyle:{boxShadow:"0 0 4px "+a}})}),$.createElement("div",{style:i.clear}))},vm=function(e){var n=e.onChange,r=e.onSwatchHover,s=e.hex,i=e.colors,a=e.width,l=e.triangle,c=e.styles,d=c===void 0?{}:c,u=e.className,p=u===void 0?"":u,h=s==="transparent",f=function(v,y){Qs(v)&&n({hex:v,source:"hex"},y)},m=at(Fn({default:{card:{width:a,background:"#fff",boxShadow:"0 1px rgba(0,0,0,.1)",borderRadius:"6px",position:"relative"},head:{height:"110px",background:s,borderRadius:"6px 6px 0 0",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},body:{padding:"10px"},label:{fontSize:"18px",color:mm(s),position:"relative"},triangle:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 10px 10px 10px",borderColor:"transparent transparent "+s+" transparent",position:"absolute",top:"-10px",left:"50%",marginLeft:"-10px"},input:{width:"100%",fontSize:"12px",color:"#666",border:"0px",outline:"none",height:"22px",boxShadow:"inset 0 0 0 1px #ddd",borderRadius:"4px",padding:"0 7px",boxSizing:"border-box"}},"hide-triangle":{triangle:{display:"none"}}},d),{"hide-triangle":l==="hide"});return $.createElement("div",{style:m.card,className:"block-picker "+p},$.createElement("div",{style:m.triangle}),$.createElement("div",{style:m.head},h&&$.createElement(ha,{borderRadius:"6px 6px 0 0"}),$.createElement("div",{style:m.label},s)),$.createElement("div",{style:m.body},$.createElement(o9,{colors:i,onClick:f,onSwatchHover:r}),$.createElement(yt,{style:{input:m.input},value:s,onChange:f})))};vm.propTypes={width:Oe.oneOfType([Oe.string,Oe.number]),colors:Oe.arrayOf(Oe.string),triangle:Oe.oneOf(["top","hide"]),styles:Oe.object};vm.defaultProps={width:170,colors:["#D9E3F0","#F47373","#697689","#37D67A","#2CCCE4","#555555","#dce775","#ff8a65","#ba68c8"],triangle:"top",styles:{}};Bn(vm);var ro={100:"#ffcdd2",300:"#e57373",500:"#f44336",700:"#d32f2f",900:"#b71c1c"},so={100:"#f8bbd0",300:"#f06292",500:"#e91e63",700:"#c2185b",900:"#880e4f"},io={100:"#e1bee7",300:"#ba68c8",500:"#9c27b0",700:"#7b1fa2",900:"#4a148c"},oo={100:"#d1c4e9",300:"#9575cd",500:"#673ab7",700:"#512da8",900:"#311b92"},ao={100:"#c5cae9",300:"#7986cb",500:"#3f51b5",700:"#303f9f",900:"#1a237e"},lo={100:"#bbdefb",300:"#64b5f6",500:"#2196f3",700:"#1976d2",900:"#0d47a1"},co={100:"#b3e5fc",300:"#4fc3f7",500:"#03a9f4",700:"#0288d1",900:"#01579b"},uo={100:"#b2ebf2",300:"#4dd0e1",500:"#00bcd4",700:"#0097a7",900:"#006064"},ho={100:"#b2dfdb",300:"#4db6ac",500:"#009688",700:"#00796b",900:"#004d40"},Ha={100:"#c8e6c9",300:"#81c784",500:"#4caf50",700:"#388e3c"},po={100:"#dcedc8",300:"#aed581",500:"#8bc34a",700:"#689f38",900:"#33691e"},fo={100:"#f0f4c3",300:"#dce775",500:"#cddc39",700:"#afb42b",900:"#827717"},mo={100:"#fff9c4",300:"#fff176",500:"#ffeb3b",700:"#fbc02d",900:"#f57f17"},go={100:"#ffecb3",300:"#ffd54f",500:"#ffc107",700:"#ffa000",900:"#ff6f00"},yo={100:"#ffe0b2",300:"#ffb74d",500:"#ff9800",700:"#f57c00",900:"#e65100"},xo={100:"#ffccbc",300:"#ff8a65",500:"#ff5722",700:"#e64a19",900:"#bf360c"},vo={100:"#d7ccc8",300:"#a1887f",500:"#795548",700:"#5d4037",900:"#3e2723"},bo={100:"#cfd8dc",300:"#90a4ae",500:"#607d8b",700:"#455a64",900:"#263238"},z_=function(e){var n=e.color,r=e.onClick,s=e.onSwatchHover,i=e.hover,a=e.active,l=e.circleSize,c=e.circleSpacing,d=at({default:{swatch:{width:l,height:l,marginRight:c,marginBottom:c,transform:"scale(1)",transition:"100ms transform ease"},Swatch:{borderRadius:"50%",background:"transparent",boxShadow:"inset 0 0 0 "+(l/2+1)+"px "+n,transition:"100ms box-shadow ease"}},hover:{swatch:{transform:"scale(1.2)"}},active:{Swatch:{boxShadow:"inset 0 0 0 3px "+n}}},{hover:i,active:a});return $.createElement("div",{style:d.swatch},$.createElement(Bi,{style:d.Swatch,color:n,onClick:r,onHover:s,focusStyle:{boxShadow:d.Swatch.boxShadow+", 0 0 5px "+n}}))};z_.defaultProps={circleSize:28,circleSpacing:14};const a9=om(z_);var bm=function(e){var n=e.width,r=e.onChange,s=e.onSwatchHover,i=e.colors,a=e.hex,l=e.circleSize,c=e.styles,d=c===void 0?{}:c,u=e.circleSpacing,p=e.className,h=p===void 0?"":p,f=at(Fn({default:{card:{width:n,display:"flex",flexWrap:"wrap",marginRight:-u,marginBottom:-u}}},d)),m=function(v,y){return r({hex:v,source:"hex"},y)};return $.createElement("div",{style:f.card,className:"circle-picker "+h},Hi(i,function(g){return $.createElement(a9,{key:g,color:g,onClick:m,onSwatchHover:s,active:a===g.toLowerCase(),circleSize:l,circleSpacing:u})}))};bm.propTypes={width:Oe.oneOfType([Oe.string,Oe.number]),circleSize:Oe.number,circleSpacing:Oe.number,styles:Oe.object};bm.defaultProps={width:252,circleSize:28,circleSpacing:14,colors:[ro[500],so[500],io[500],oo[500],ao[500],lo[500],co[500],uo[500],ho[500],Ha[500],po[500],fo[500],mo[500],go[500],yo[500],xo[500],vo[500],bo[500]],styles:{}};Bn(bm);function Px(t){return t===void 0}var F_={};Object.defineProperty(F_,"__esModule",{value:!0});var Rx=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},l9=R,Ox=c9(l9);function c9(t){return t&&t.__esModule?t:{default:t}}function d9(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}var jc=24,u9=F_.default=function(t){var e=t.fill,n=e===void 0?"currentColor":e,r=t.width,s=r===void 0?jc:r,i=t.height,a=i===void 0?jc:i,l=t.style,c=l===void 0?{}:l,d=d9(t,["fill","width","height","style"]);return Ox.default.createElement("svg",Rx({viewBox:"0 0 "+jc+" "+jc,style:Rx({fill:n,width:s,height:a},c)},d),Ox.default.createElement("path",{d:"M12,18.17L8.83,15L7.42,16.41L12,21L16.59,16.41L15.17,15M12,5.83L15.17,9L16.58,7.59L12,3L7.41,7.59L8.83,9L12,5.83Z"}))},h9=function(){function t(e,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function p9(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function f9(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function m9(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var B_=function(t){m9(e,t);function e(n){p9(this,e);var r=f9(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return r.toggleViews=function(){r.state.view==="hex"?r.setState({view:"rgb"}):r.state.view==="rgb"?r.setState({view:"hsl"}):r.state.view==="hsl"&&(r.props.hsl.a===1?r.setState({view:"hex"}):r.setState({view:"rgb"}))},r.handleChange=function(s,i){s.hex?Qs(s.hex)&&r.props.onChange({hex:s.hex,source:"hex"},i):s.r||s.g||s.b?r.props.onChange({r:s.r||r.props.rgb.r,g:s.g||r.props.rgb.g,b:s.b||r.props.rgb.b,source:"rgb"},i):s.a?(s.a<0?s.a=0:s.a>1&&(s.a=1),r.props.onChange({h:r.props.hsl.h,s:r.props.hsl.s,l:r.props.hsl.l,a:Math.round(s.a*100)/100,source:"rgb"},i)):(s.h||s.s||s.l)&&(typeof s.s=="string"&&s.s.includes("%")&&(s.s=s.s.replace("%","")),typeof s.l=="string"&&s.l.includes("%")&&(s.l=s.l.replace("%","")),s.s==1?s.s=.01:s.l==1&&(s.l=.01),r.props.onChange({h:s.h||r.props.hsl.h,s:Number(Px(s.s)?r.props.hsl.s:s.s),l:Number(Px(s.l)?r.props.hsl.l:s.l),source:"hsl"},i))},r.showHighlight=function(s){s.currentTarget.style.background="#eee"},r.hideHighlight=function(s){s.currentTarget.style.background="transparent"},n.hsl.a!==1&&n.view==="hex"?r.state={view:"rgb"}:r.state={view:n.view},r}return h9(e,[{key:"render",value:function(){var r=this,s=at({default:{wrap:{paddingTop:"16px",display:"flex"},fields:{flex:"1",display:"flex",marginLeft:"-6px"},field:{paddingLeft:"6px",width:"100%"},alpha:{paddingLeft:"6px",width:"100%"},toggle:{width:"32px",textAlign:"right",position:"relative"},icon:{marginRight:"-4px",marginTop:"12px",cursor:"pointer",position:"relative"},iconHighlight:{position:"absolute",width:"24px",height:"28px",background:"#eee",borderRadius:"4px",top:"10px",left:"12px",display:"none"},input:{fontSize:"11px",color:"#333",width:"100%",borderRadius:"2px",border:"none",boxShadow:"inset 0 0 0 1px #dadada",height:"21px",textAlign:"center"},label:{textTransform:"uppercase",fontSize:"11px",lineHeight:"11px",color:"#969696",textAlign:"center",display:"block",marginTop:"12px"},svg:{fill:"#333",width:"24px",height:"24px",border:"1px transparent solid",borderRadius:"5px"}},disableAlpha:{alpha:{display:"none"}}},this.props,this.state),i=void 0;return this.state.view==="hex"?i=$.createElement("div",{style:s.fields,className:"flexbox-fix"},$.createElement("div",{style:s.field},$.createElement(yt,{style:{input:s.input,label:s.label},label:"hex",value:this.props.hex,onChange:this.handleChange}))):this.state.view==="rgb"?i=$.createElement("div",{style:s.fields,className:"flexbox-fix"},$.createElement("div",{style:s.field},$.createElement(yt,{style:{input:s.input,label:s.label},label:"r",value:this.props.rgb.r,onChange:this.handleChange})),$.createElement("div",{style:s.field},$.createElement(yt,{style:{input:s.input,label:s.label},label:"g",value:this.props.rgb.g,onChange:this.handleChange})),$.createElement("div",{style:s.field},$.createElement(yt,{style:{input:s.input,label:s.label},label:"b",value:this.props.rgb.b,onChange:this.handleChange})),$.createElement("div",{style:s.alpha},$.createElement(yt,{style:{input:s.input,label:s.label},label:"a",value:this.props.rgb.a,arrowOffset:.01,onChange:this.handleChange}))):this.state.view==="hsl"&&(i=$.createElement("div",{style:s.fields,className:"flexbox-fix"},$.createElement("div",{style:s.field},$.createElement(yt,{style:{input:s.input,label:s.label},label:"h",value:Math.round(this.props.hsl.h),onChange:this.handleChange})),$.createElement("div",{style:s.field},$.createElement(yt,{style:{input:s.input,label:s.label},label:"s",value:Math.round(this.props.hsl.s*100)+"%",onChange:this.handleChange})),$.createElement("div",{style:s.field},$.createElement(yt,{style:{input:s.input,label:s.label},label:"l",value:Math.round(this.props.hsl.l*100)+"%",onChange:this.handleChange})),$.createElement("div",{style:s.alpha},$.createElement(yt,{style:{input:s.input,label:s.label},label:"a",value:this.props.hsl.a,arrowOffset:.01,onChange:this.handleChange})))),$.createElement("div",{style:s.wrap,className:"flexbox-fix"},i,$.createElement("div",{style:s.toggle},$.createElement("div",{style:s.icon,onClick:this.toggleViews,ref:function(l){return r.icon=l}},$.createElement(u9,{style:s.svg,onMouseOver:this.showHighlight,onMouseEnter:this.showHighlight,onMouseOut:this.hideHighlight}))))}}],[{key:"getDerivedStateFromProps",value:function(r,s){return r.hsl.a!==1&&s.view==="hex"?{view:"rgb"}:null}}]),e}($.Component);B_.defaultProps={view:"hex"};var Ax=function(){var e=at({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",transform:"translate(-6px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}}});return $.createElement("div",{style:e.picker})},g9=function(){var e=at({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",boxShadow:"inset 0 0 0 1px #fff",transform:"translate(-6px, -6px)"}}});return $.createElement("div",{style:e.picker})},wm=function(e){var n=e.width,r=e.onChange,s=e.disableAlpha,i=e.rgb,a=e.hsl,l=e.hsv,c=e.hex,d=e.renderers,u=e.styles,p=u===void 0?{}:u,h=e.className,f=h===void 0?"":h,m=e.defaultView,g=at(Fn({default:{picker:{width:n,background:"#fff",borderRadius:"2px",boxShadow:"0 0 2px rgba(0,0,0,.3), 0 4px 8px rgba(0,0,0,.3)",boxSizing:"initial",fontFamily:"Menlo"},saturation:{width:"100%",paddingBottom:"55%",position:"relative",borderRadius:"2px 2px 0 0",overflow:"hidden"},Saturation:{radius:"2px 2px 0 0"},body:{padding:"16px 16px 12px"},controls:{display:"flex"},color:{width:"32px"},swatch:{marginTop:"6px",width:"16px",height:"16px",borderRadius:"8px",position:"relative",overflow:"hidden"},active:{absolute:"0px 0px 0px 0px",borderRadius:"8px",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.1)",background:"rgba("+i.r+", "+i.g+", "+i.b+", "+i.a+")",zIndex:"2"},toggles:{flex:"1"},hue:{height:"10px",position:"relative",marginBottom:"8px"},Hue:{radius:"2px"},alpha:{height:"10px",position:"relative"},Alpha:{radius:"2px"}},disableAlpha:{color:{width:"22px"},alpha:{display:"none"},hue:{marginBottom:"0px"},swatch:{width:"10px",height:"10px",marginTop:"0px"}}},p),{disableAlpha:s});return $.createElement("div",{style:g.picker,className:"chrome-picker "+f},$.createElement("div",{style:g.saturation},$.createElement(ou,{style:g.Saturation,hsl:a,hsv:l,pointer:g9,onChange:r})),$.createElement("div",{style:g.body},$.createElement("div",{style:g.controls,className:"flexbox-fix"},$.createElement("div",{style:g.color},$.createElement("div",{style:g.swatch},$.createElement("div",{style:g.active}),$.createElement(ha,{renderers:d}))),$.createElement("div",{style:g.toggles},$.createElement("div",{style:g.hue},$.createElement(pa,{style:g.Hue,hsl:a,pointer:Ax,onChange:r})),$.createElement("div",{style:g.alpha},$.createElement(am,{style:g.Alpha,rgb:i,hsl:a,pointer:Ax,renderers:d,onChange:r})))),$.createElement(B_,{rgb:i,hsl:a,hex:c,view:m,onChange:r,disableAlpha:s})))};wm.propTypes={width:Oe.oneOfType([Oe.string,Oe.number]),disableAlpha:Oe.bool,styles:Oe.object,defaultView:Oe.oneOf(["hex","rgb","hsl"])};wm.defaultProps={width:225,disableAlpha:!1,styles:{}};Bn(wm);var y9=function(e){var n=e.color,r=e.onClick,s=r===void 0?function(){}:r,i=e.onSwatchHover,a=e.active,l=at({default:{color:{background:n,width:"15px",height:"15px",float:"left",marginRight:"5px",marginBottom:"5px",position:"relative",cursor:"pointer"},dot:{absolute:"5px 5px 5px 5px",background:mm(n),borderRadius:"50%",opacity:"0"}},active:{dot:{opacity:"1"}},"color-#FFFFFF":{color:{boxShadow:"inset 0 0 0 1px #ddd"},dot:{background:"#000"}},transparent:{dot:{background:"#000"}}},{active:a,"color-#FFFFFF":n==="#FFFFFF",transparent:n==="transparent"});return $.createElement(Bi,{style:l.color,color:n,onClick:s,onHover:i,focusStyle:{boxShadow:"0 0 4px "+n}},$.createElement("div",{style:l.dot}))},x9=function(e){var n=e.hex,r=e.rgb,s=e.onChange,i=at({default:{fields:{display:"flex",paddingBottom:"6px",paddingRight:"5px",position:"relative"},active:{position:"absolute",top:"6px",left:"5px",height:"9px",width:"9px",background:n},HEXwrap:{flex:"6",position:"relative"},HEXinput:{width:"80%",padding:"0px",paddingLeft:"20%",border:"none",outline:"none",background:"none",fontSize:"12px",color:"#333",height:"16px"},HEXlabel:{display:"none"},RGBwrap:{flex:"3",position:"relative"},RGBinput:{width:"70%",padding:"0px",paddingLeft:"30%",border:"none",outline:"none",background:"none",fontSize:"12px",color:"#333",height:"16px"},RGBlabel:{position:"absolute",top:"3px",left:"0px",lineHeight:"16px",textTransform:"uppercase",fontSize:"12px",color:"#999"}}}),a=function(c,d){c.r||c.g||c.b?s({r:c.r||r.r,g:c.g||r.g,b:c.b||r.b,source:"rgb"},d):s({hex:c.hex,source:"hex"},d)};return $.createElement("div",{style:i.fields,className:"flexbox-fix"},$.createElement("div",{style:i.active}),$.createElement(yt,{style:{wrap:i.HEXwrap,input:i.HEXinput,label:i.HEXlabel},label:"hex",value:n,onChange:a}),$.createElement(yt,{style:{wrap:i.RGBwrap,input:i.RGBinput,label:i.RGBlabel},label:"r",value:r.r,onChange:a}),$.createElement(yt,{style:{wrap:i.RGBwrap,input:i.RGBinput,label:i.RGBlabel},label:"g",value:r.g,onChange:a}),$.createElement(yt,{style:{wrap:i.RGBwrap,input:i.RGBinput,label:i.RGBlabel},label:"b",value:r.b,onChange:a}))},_m=function(e){var n=e.onChange,r=e.onSwatchHover,s=e.colors,i=e.hex,a=e.rgb,l=e.styles,c=l===void 0?{}:l,d=e.className,u=d===void 0?"":d,p=at(Fn({default:{Compact:{background:"#f6f6f6",radius:"4px"},compact:{paddingTop:"5px",paddingLeft:"5px",boxSizing:"initial",width:"240px"},clear:{clear:"both"}}},c)),h=function(m,g){m.hex?Qs(m.hex)&&n({hex:m.hex,source:"hex"},g):n(m,g)};return $.createElement(Bl,{style:p.Compact,styles:c},$.createElement("div",{style:p.compact,className:"compact-picker "+u},$.createElement("div",null,Hi(s,function(f){return $.createElement(y9,{key:f,color:f,active:f.toLowerCase()===i,onClick:h,onSwatchHover:r})}),$.createElement("div",{style:p.clear})),$.createElement(x9,{hex:i,rgb:a,onChange:h})))};_m.propTypes={colors:Oe.arrayOf(Oe.string),styles:Oe.object};_m.defaultProps={colors:["#4D4D4D","#999999","#FFFFFF","#F44E3B","#FE9200","#FCDC00","#DBDF00","#A4DD00","#68CCCA","#73D8FF","#AEA1FF","#FDA1FF","#333333","#808080","#cccccc","#D33115","#E27300","#FCC400","#B0BC00","#68BC00","#16A5A5","#009CE0","#7B64FF","#FA28FF","#000000","#666666","#B3B3B3","#9F0500","#C45100","#FB9E00","#808900","#194D33","#0C797D","#0062B1","#653294","#AB149E"],styles:{}};Bn(_m);var v9=function(e){var n=e.hover,r=e.color,s=e.onClick,i=e.onSwatchHover,a={position:"relative",zIndex:"2",outline:"2px solid #fff",boxShadow:"0 0 5px 2px rgba(0,0,0,0.25)"},l=at({default:{swatch:{width:"25px",height:"25px",fontSize:"0"}},hover:{swatch:a}},{hover:n});return $.createElement("div",{style:l.swatch},$.createElement(Bi,{color:r,onClick:s,onHover:i,focusStyle:a}))};const b9=om(v9);var Sm=function(e){var n=e.width,r=e.colors,s=e.onChange,i=e.onSwatchHover,a=e.triangle,l=e.styles,c=l===void 0?{}:l,d=e.className,u=d===void 0?"":d,p=at(Fn({default:{card:{width:n,background:"#fff",border:"1px solid rgba(0,0,0,0.2)",boxShadow:"0 3px 12px rgba(0,0,0,0.15)",borderRadius:"4px",position:"relative",padding:"5px",display:"flex",flexWrap:"wrap"},triangle:{position:"absolute",border:"7px solid transparent",borderBottomColor:"#fff"},triangleShadow:{position:"absolute",border:"8px solid transparent",borderBottomColor:"rgba(0,0,0,0.15)"}},"hide-triangle":{triangle:{display:"none"},triangleShadow:{display:"none"}},"top-left-triangle":{triangle:{top:"-14px",left:"10px"},triangleShadow:{top:"-16px",left:"9px"}},"top-right-triangle":{triangle:{top:"-14px",right:"10px"},triangleShadow:{top:"-16px",right:"9px"}},"bottom-left-triangle":{triangle:{top:"35px",left:"10px",transform:"rotate(180deg)"},triangleShadow:{top:"37px",left:"9px",transform:"rotate(180deg)"}},"bottom-right-triangle":{triangle:{top:"35px",right:"10px",transform:"rotate(180deg)"},triangleShadow:{top:"37px",right:"9px",transform:"rotate(180deg)"}}},c),{"hide-triangle":a==="hide","top-left-triangle":a==="top-left","top-right-triangle":a==="top-right","bottom-left-triangle":a==="bottom-left","bottom-right-triangle":a==="bottom-right"}),h=function(m,g){return s({hex:m,source:"hex"},g)};return $.createElement("div",{style:p.card,className:"github-picker "+u},$.createElement("div",{style:p.triangleShadow}),$.createElement("div",{style:p.triangle}),Hi(r,function(f){return $.createElement(b9,{color:f,key:f,onClick:h,onSwatchHover:i})}))};Sm.propTypes={width:Oe.oneOfType([Oe.string,Oe.number]),colors:Oe.arrayOf(Oe.string),triangle:Oe.oneOf(["hide","top-left","top-right","bottom-left","bottom-right"]),styles:Oe.object};Sm.defaultProps={width:200,colors:["#B80000","#DB3E00","#FCCB00","#008B02","#006B76","#1273DE","#004DCF","#5300EB","#EB9694","#FAD0C3","#FEF3BD","#C1E1C5","#BEDADC","#C4DEF6","#BED3F3","#D4C4FB"],triangle:"top-left",styles:{}};Bn(Sm);var w9=function(e){var n=e.direction,r=at({default:{picker:{width:"18px",height:"18px",borderRadius:"50%",transform:"translate(-9px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}},vertical:{picker:{transform:"translate(-3px, -9px)"}}},{vertical:n==="vertical"});return $.createElement("div",{style:r.picker})},_9=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},km=function(e){var n=e.width,r=e.height,s=e.onChange,i=e.hsl,a=e.direction,l=e.pointer,c=e.styles,d=c===void 0?{}:c,u=e.className,p=u===void 0?"":u,h=at(Fn({default:{picker:{position:"relative",width:n,height:r},hue:{radius:"2px"}}},d)),f=function(g){return s({a:1,h:g.h,l:.5,s:1})};return $.createElement("div",{style:h.picker,className:"hue-picker "+p},$.createElement(pa,_9({},h.hue,{hsl:i,pointer:l,onChange:f,direction:a})))};km.propTypes={styles:Oe.object};km.defaultProps={width:"316px",height:"16px",direction:"horizontal",pointer:w9,styles:{}};Bn(km);var S9=function(e){var n=e.onChange,r=e.hex,s=e.rgb,i=e.styles,a=i===void 0?{}:i,l=e.className,c=l===void 0?"":l,d=at(Fn({default:{material:{width:"98px",height:"98px",padding:"16px",fontFamily:"Roboto"},HEXwrap:{position:"relative"},HEXinput:{width:"100%",marginTop:"12px",fontSize:"15px",color:"#333",padding:"0px",border:"0px",borderBottom:"2px solid "+r,outline:"none",height:"30px"},HEXlabel:{position:"absolute",top:"0px",left:"0px",fontSize:"11px",color:"#999999",textTransform:"capitalize"},Hex:{style:{}},RGBwrap:{position:"relative"},RGBinput:{width:"100%",marginTop:"12px",fontSize:"15px",color:"#333",padding:"0px",border:"0px",borderBottom:"1px solid #eee",outline:"none",height:"30px"},RGBlabel:{position:"absolute",top:"0px",left:"0px",fontSize:"11px",color:"#999999",textTransform:"capitalize"},split:{display:"flex",marginRight:"-10px",paddingTop:"11px"},third:{flex:"1",paddingRight:"10px"}}},a)),u=function(h,f){h.hex?Qs(h.hex)&&n({hex:h.hex,source:"hex"},f):(h.r||h.g||h.b)&&n({r:h.r||s.r,g:h.g||s.g,b:h.b||s.b,source:"rgb"},f)};return $.createElement(Bl,{styles:a},$.createElement("div",{style:d.material,className:"material-picker "+c},$.createElement(yt,{style:{wrap:d.HEXwrap,input:d.HEXinput,label:d.HEXlabel},label:"hex",value:r,onChange:u}),$.createElement("div",{style:d.split,className:"flexbox-fix"},$.createElement("div",{style:d.third},$.createElement(yt,{style:{wrap:d.RGBwrap,input:d.RGBinput,label:d.RGBlabel},label:"r",value:s.r,onChange:u})),$.createElement("div",{style:d.third},$.createElement(yt,{style:{wrap:d.RGBwrap,input:d.RGBinput,label:d.RGBlabel},label:"g",value:s.g,onChange:u})),$.createElement("div",{style:d.third},$.createElement(yt,{style:{wrap:d.RGBwrap,input:d.RGBinput,label:d.RGBlabel},label:"b",value:s.b,onChange:u})))))};Bn(S9);var k9=function(e){var n=e.onChange,r=e.rgb,s=e.hsv,i=e.hex,a=at({default:{fields:{paddingTop:"5px",paddingBottom:"9px",width:"80px",position:"relative"},divider:{height:"5px"},RGBwrap:{position:"relative"},RGBinput:{marginLeft:"40%",width:"40%",height:"18px",border:"1px solid #888888",boxShadow:"inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC",marginBottom:"5px",fontSize:"13px",paddingLeft:"3px",marginRight:"10px"},RGBlabel:{left:"0px",top:"0px",width:"34px",textTransform:"uppercase",fontSize:"13px",height:"18px",lineHeight:"22px",position:"absolute"},HEXwrap:{position:"relative"},HEXinput:{marginLeft:"20%",width:"80%",height:"18px",border:"1px solid #888888",boxShadow:"inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC",marginBottom:"6px",fontSize:"13px",paddingLeft:"3px"},HEXlabel:{position:"absolute",top:"0px",left:"0px",width:"14px",textTransform:"uppercase",fontSize:"13px",height:"18px",lineHeight:"22px"},fieldSymbols:{position:"absolute",top:"5px",right:"-7px",fontSize:"13px"},symbol:{height:"20px",lineHeight:"22px",paddingBottom:"7px"}}}),l=function(d,u){d["#"]?Qs(d["#"])&&n({hex:d["#"],source:"hex"},u):d.r||d.g||d.b?n({r:d.r||r.r,g:d.g||r.g,b:d.b||r.b,source:"rgb"},u):(d.h||d.s||d.v)&&n({h:d.h||s.h,s:d.s||s.s,v:d.v||s.v,source:"hsv"},u)};return $.createElement("div",{style:a.fields},$.createElement(yt,{style:{wrap:a.RGBwrap,input:a.RGBinput,label:a.RGBlabel},label:"h",value:Math.round(s.h),onChange:l}),$.createElement(yt,{style:{wrap:a.RGBwrap,input:a.RGBinput,label:a.RGBlabel},label:"s",value:Math.round(s.s*100),onChange:l}),$.createElement(yt,{style:{wrap:a.RGBwrap,input:a.RGBinput,label:a.RGBlabel},label:"v",value:Math.round(s.v*100),onChange:l}),$.createElement("div",{style:a.divider}),$.createElement(yt,{style:{wrap:a.RGBwrap,input:a.RGBinput,label:a.RGBlabel},label:"r",value:r.r,onChange:l}),$.createElement(yt,{style:{wrap:a.RGBwrap,input:a.RGBinput,label:a.RGBlabel},label:"g",value:r.g,onChange:l}),$.createElement(yt,{style:{wrap:a.RGBwrap,input:a.RGBinput,label:a.RGBlabel},label:"b",value:r.b,onChange:l}),$.createElement("div",{style:a.divider}),$.createElement(yt,{style:{wrap:a.HEXwrap,input:a.HEXinput,label:a.HEXlabel},label:"#",value:i.replace("#",""),onChange:l}),$.createElement("div",{style:a.fieldSymbols},$.createElement("div",{style:a.symbol},""),$.createElement("div",{style:a.symbol},"%"),$.createElement("div",{style:a.symbol},"%")))},j9=function(e){var n=e.hsl,r=at({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",boxShadow:"inset 0 0 0 1px #fff",transform:"translate(-6px, -6px)"}},"black-outline":{picker:{boxShadow:"inset 0 0 0 1px #000"}}},{"black-outline":n.l>.5});return $.createElement("div",{style:r.picker})},C9=function(){var e=at({default:{triangle:{width:0,height:0,borderStyle:"solid",borderWidth:"4px 0 4px 6px",borderColor:"transparent transparent transparent #fff",position:"absolute",top:"1px",left:"1px"},triangleBorder:{width:0,height:0,borderStyle:"solid",borderWidth:"5px 0 5px 8px",borderColor:"transparent transparent transparent #555"},left:{Extend:"triangleBorder",transform:"translate(-13px, -4px)"},leftInside:{Extend:"triangle",transform:"translate(-8px, -5px)"},right:{Extend:"triangleBorder",transform:"translate(20px, -14px) rotate(180deg)"},rightInside:{Extend:"triangle",transform:"translate(-8px, -5px)"}}});return $.createElement("div",{style:e.pointer},$.createElement("div",{style:e.left},$.createElement("div",{style:e.leftInside})),$.createElement("div",{style:e.right},$.createElement("div",{style:e.rightInside})))},Mx=function(e){var n=e.onClick,r=e.label,s=e.children,i=e.active,a=at({default:{button:{backgroundImage:"linear-gradient(-180deg, #FFFFFF 0%, #E6E6E6 100%)",border:"1px solid #878787",borderRadius:"2px",height:"20px",boxShadow:"0 1px 0 0 #EAEAEA",fontSize:"14px",color:"#000",lineHeight:"20px",textAlign:"center",marginBottom:"10px",cursor:"pointer"}},active:{button:{boxShadow:"0 0 0 1px #878787"}}},{active:i});return $.createElement("div",{style:a.button,onClick:n},r||s)},E9=function(e){var n=e.rgb,r=e.currentColor,s=at({default:{swatches:{border:"1px solid #B3B3B3",borderBottom:"1px solid #F0F0F0",marginBottom:"2px",marginTop:"1px"},new:{height:"34px",background:"rgb("+n.r+","+n.g+", "+n.b+")",boxShadow:"inset 1px 0 0 #000, inset -1px 0 0 #000, inset 0 1px 0 #000"},current:{height:"34px",background:r,boxShadow:"inset 1px 0 0 #000, inset -1px 0 0 #000, inset 0 -1px 0 #000"},label:{fontSize:"14px",color:"#000",textAlign:"center"}}});return $.createElement("div",null,$.createElement("div",{style:s.label},"new"),$.createElement("div",{style:s.swatches},$.createElement("div",{style:s.new}),$.createElement("div",{style:s.current})),$.createElement("div",{style:s.label},"current"))},T9=function(){function t(e,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function N9(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function P9(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function R9(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var jm=function(t){R9(e,t);function e(n){N9(this,e);var r=P9(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return r.state={currentColor:n.hex},r}return T9(e,[{key:"render",value:function(){var r=this.props,s=r.styles,i=s===void 0?{}:s,a=r.className,l=a===void 0?"":a,c=at(Fn({default:{picker:{background:"#DCDCDC",borderRadius:"4px",boxShadow:"0 0 0 1px rgba(0,0,0,.25), 0 8px 16px rgba(0,0,0,.15)",boxSizing:"initial",width:"513px"},head:{backgroundImage:"linear-gradient(-180deg, #F0F0F0 0%, #D4D4D4 100%)",borderBottom:"1px solid #B1B1B1",boxShadow:"inset 0 1px 0 0 rgba(255,255,255,.2), inset 0 -1px 0 0 rgba(0,0,0,.02)",height:"23px",lineHeight:"24px",borderRadius:"4px 4px 0 0",fontSize:"13px",color:"#4D4D4D",textAlign:"center"},body:{padding:"15px 15px 0",display:"flex"},saturation:{width:"256px",height:"256px",position:"relative",border:"2px solid #B3B3B3",borderBottom:"2px solid #F0F0F0",overflow:"hidden"},hue:{position:"relative",height:"256px",width:"19px",marginLeft:"10px",border:"2px solid #B3B3B3",borderBottom:"2px solid #F0F0F0"},controls:{width:"180px",marginLeft:"10px"},top:{display:"flex"},previews:{width:"60px"},actions:{flex:"1",marginLeft:"20px"}}},i));return $.createElement("div",{style:c.picker,className:"photoshop-picker "+l},$.createElement("div",{style:c.head},this.props.header),$.createElement("div",{style:c.body,className:"flexbox-fix"},$.createElement("div",{style:c.saturation},$.createElement(ou,{hsl:this.props.hsl,hsv:this.props.hsv,pointer:j9,onChange:this.props.onChange})),$.createElement("div",{style:c.hue},$.createElement(pa,{direction:"vertical",hsl:this.props.hsl,pointer:C9,onChange:this.props.onChange})),$.createElement("div",{style:c.controls},$.createElement("div",{style:c.top,className:"flexbox-fix"},$.createElement("div",{style:c.previews},$.createElement(E9,{rgb:this.props.rgb,currentColor:this.state.currentColor})),$.createElement("div",{style:c.actions},$.createElement(Mx,{label:"OK",onClick:this.props.onAccept,active:!0}),$.createElement(Mx,{label:"Cancel",onClick:this.props.onCancel}),$.createElement(k9,{onChange:this.props.onChange,rgb:this.props.rgb,hsv:this.props.hsv,hex:this.props.hex}))))))}}]),e}($.Component);jm.propTypes={header:Oe.string,styles:Oe.object};jm.defaultProps={header:"Color Picker",styles:{}};Bn(jm);var O9=function(e){var n=e.onChange,r=e.rgb,s=e.hsl,i=e.hex,a=e.disableAlpha,l=at({default:{fields:{display:"flex",paddingTop:"4px"},single:{flex:"1",paddingLeft:"6px"},alpha:{flex:"1",paddingLeft:"6px"},double:{flex:"2"},input:{width:"80%",padding:"4px 10% 3px",border:"none",boxShadow:"inset 0 0 0 1px #ccc",fontSize:"11px"},label:{display:"block",textAlign:"center",fontSize:"11px",color:"#222",paddingTop:"3px",paddingBottom:"4px",textTransform:"capitalize"}},disableAlpha:{alpha:{display:"none"}}},{disableAlpha:a}),c=function(u,p){u.hex?Qs(u.hex)&&n({hex:u.hex,source:"hex"},p):u.r||u.g||u.b?n({r:u.r||r.r,g:u.g||r.g,b:u.b||r.b,a:r.a,source:"rgb"},p):u.a&&(u.a<0?u.a=0:u.a>100&&(u.a=100),u.a/=100,n({h:s.h,s:s.s,l:s.l,a:u.a,source:"rgb"},p))};return $.createElement("div",{style:l.fields,className:"flexbox-fix"},$.createElement("div",{style:l.double},$.createElement(yt,{style:{input:l.input,label:l.label},label:"hex",value:i.replace("#",""),onChange:c})),$.createElement("div",{style:l.single},$.createElement(yt,{style:{input:l.input,label:l.label},label:"r",value:r.r,onChange:c,dragLabel:"true",dragMax:"255"})),$.createElement("div",{style:l.single},$.createElement(yt,{style:{input:l.input,label:l.label},label:"g",value:r.g,onChange:c,dragLabel:"true",dragMax:"255"})),$.createElement("div",{style:l.single},$.createElement(yt,{style:{input:l.input,label:l.label},label:"b",value:r.b,onChange:c,dragLabel:"true",dragMax:"255"})),$.createElement("div",{style:l.alpha},$.createElement(yt,{style:{input:l.input,label:l.label},label:"a",value:Math.round(r.a*100),onChange:c,dragLabel:"true",dragMax:"100"})))},A9=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},H_=function(e){var n=e.colors,r=e.onClick,s=r===void 0?function(){}:r,i=e.onSwatchHover,a=at({default:{colors:{margin:"0 -10px",padding:"10px 0 0 10px",borderTop:"1px solid #eee",display:"flex",flexWrap:"wrap",position:"relative"},swatchWrap:{width:"16px",height:"16px",margin:"0 10px 10px 0"},swatch:{borderRadius:"3px",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15)"}},"no-presets":{colors:{display:"none"}}},{"no-presets":!n||!n.length}),l=function(d,u){s({hex:d,source:"hex"},u)};return $.createElement("div",{style:a.colors,className:"flexbox-fix"},n.map(function(c){var d=typeof c=="string"?{color:c}:c,u=""+d.color+(d.title||"");return $.createElement("div",{key:u,style:a.swatchWrap},$.createElement(Bi,A9({},d,{style:a.swatch,onClick:l,onHover:i,focusStyle:{boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15), 0 0 4px "+d.color}})))}))};H_.propTypes={colors:Oe.arrayOf(Oe.oneOfType([Oe.string,Oe.shape({color:Oe.string,title:Oe.string})])).isRequired};var M9=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Cm=function(e){var n=e.width,r=e.rgb,s=e.hex,i=e.hsv,a=e.hsl,l=e.onChange,c=e.onSwatchHover,d=e.disableAlpha,u=e.presetColors,p=e.renderers,h=e.styles,f=h===void 0?{}:h,m=e.className,g=m===void 0?"":m,v=at(Fn({default:M9({picker:{width:n,padding:"10px 10px 0",boxSizing:"initial",background:"#fff",borderRadius:"4px",boxShadow:"0 0 0 1px rgba(0,0,0,.15), 0 8px 16px rgba(0,0,0,.15)"},saturation:{width:"100%",paddingBottom:"75%",position:"relative",overflow:"hidden"},Saturation:{radius:"3px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},controls:{display:"flex"},sliders:{padding:"4px 0",flex:"1"},color:{width:"24px",height:"24px",position:"relative",marginTop:"4px",marginLeft:"4px",borderRadius:"3px"},activeColor:{absolute:"0px 0px 0px 0px",borderRadius:"2px",background:"rgba("+r.r+","+r.g+","+r.b+","+r.a+")",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},hue:{position:"relative",height:"10px",overflow:"hidden"},Hue:{radius:"2px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},alpha:{position:"relative",height:"10px",marginTop:"4px",overflow:"hidden"},Alpha:{radius:"2px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"}},f),disableAlpha:{color:{height:"10px"},hue:{height:"10px"},alpha:{display:"none"}}},f),{disableAlpha:d});return $.createElement("div",{style:v.picker,className:"sketch-picker "+g},$.createElement("div",{style:v.saturation},$.createElement(ou,{style:v.Saturation,hsl:a,hsv:i,onChange:l})),$.createElement("div",{style:v.controls,className:"flexbox-fix"},$.createElement("div",{style:v.sliders},$.createElement("div",{style:v.hue},$.createElement(pa,{style:v.Hue,hsl:a,onChange:l})),$.createElement("div",{style:v.alpha},$.createElement(am,{style:v.Alpha,rgb:r,hsl:a,renderers:p,onChange:l}))),$.createElement("div",{style:v.color},$.createElement(ha,null),$.createElement("div",{style:v.activeColor}))),$.createElement(O9,{rgb:r,hsl:a,hex:s,onChange:l,disableAlpha:d}),$.createElement(H_,{colors:u,onClick:l,onSwatchHover:c}))};Cm.propTypes={disableAlpha:Oe.bool,width:Oe.oneOfType([Oe.string,Oe.number]),styles:Oe.object};Cm.defaultProps={disableAlpha:!1,width:200,styles:{},presetColors:["#D0021B","#F5A623","#F8E71C","#8B572A","#7ED321","#417505","#BD10E0","#9013FE","#4A90E2","#50E3C2","#B8E986","#000000","#4A4A4A","#9B9B9B","#FFFFFF"]};Bn(Cm);var Oa=function(e){var n=e.hsl,r=e.offset,s=e.onClick,i=s===void 0?function(){}:s,a=e.active,l=e.first,c=e.last,d=at({default:{swatch:{height:"12px",background:"hsl("+n.h+", 50%, "+r*100+"%)",cursor:"pointer"}},first:{swatch:{borderRadius:"2px 0 0 2px"}},last:{swatch:{borderRadius:"0 2px 2px 0"}},active:{swatch:{transform:"scaleY(1.8)",borderRadius:"3.6px/2px"}}},{active:a,first:l,last:c}),u=function(h){return i({h:n.h,s:.5,l:r,source:"hsl"},h)};return $.createElement("div",{style:d.swatch,onClick:u})},$9=function(e){var n=e.onClick,r=e.hsl,s=at({default:{swatches:{marginTop:"20px"},swatch:{boxSizing:"border-box",width:"20%",paddingRight:"1px",float:"left"},clear:{clear:"both"}}}),i=.1;return $.createElement("div",{style:s.swatches},$.createElement("div",{style:s.swatch},$.createElement(Oa,{hsl:r,offset:".80",active:Math.abs(r.l-.8)<i&&Math.abs(r.s-.5)<i,onClick:n,first:!0})),$.createElement("div",{style:s.swatch},$.createElement(Oa,{hsl:r,offset:".65",active:Math.abs(r.l-.65)<i&&Math.abs(r.s-.5)<i,onClick:n})),$.createElement("div",{style:s.swatch},$.createElement(Oa,{hsl:r,offset:".50",active:Math.abs(r.l-.5)<i&&Math.abs(r.s-.5)<i,onClick:n})),$.createElement("div",{style:s.swatch},$.createElement(Oa,{hsl:r,offset:".35",active:Math.abs(r.l-.35)<i&&Math.abs(r.s-.5)<i,onClick:n})),$.createElement("div",{style:s.swatch},$.createElement(Oa,{hsl:r,offset:".20",active:Math.abs(r.l-.2)<i&&Math.abs(r.s-.5)<i,onClick:n,last:!0})),$.createElement("div",{style:s.clear}))},L9=function(){var e=at({default:{picker:{width:"14px",height:"14px",borderRadius:"6px",transform:"translate(-7px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}}});return $.createElement("div",{style:e.picker})},Em=function(e){var n=e.hsl,r=e.onChange,s=e.pointer,i=e.styles,a=i===void 0?{}:i,l=e.className,c=l===void 0?"":l,d=at(Fn({default:{hue:{height:"12px",position:"relative"},Hue:{radius:"2px"}}},a));return $.createElement("div",{style:d.wrap||{},className:"slider-picker "+c},$.createElement("div",{style:d.hue},$.createElement(pa,{style:d.Hue,hsl:n,pointer:s,onChange:r})),$.createElement("div",{style:d.swatches},$.createElement($9,{hsl:n,onClick:r})))};Em.propTypes={styles:Oe.object};Em.defaultProps={pointer:L9,styles:{}};Bn(Em);var U_={};Object.defineProperty(U_,"__esModule",{value:!0});var $x=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},D9=R,Lx=I9(D9);function I9(t){return t&&t.__esModule?t:{default:t}}function z9(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}var Cc=24,F9=U_.default=function(t){var e=t.fill,n=e===void 0?"currentColor":e,r=t.width,s=r===void 0?Cc:r,i=t.height,a=i===void 0?Cc:i,l=t.style,c=l===void 0?{}:l,d=z9(t,["fill","width","height","style"]);return Lx.default.createElement("svg",$x({viewBox:"0 0 "+Cc+" "+Cc,style:$x({fill:n,width:s,height:a},c)},d),Lx.default.createElement("path",{d:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"}))},B9=function(e){var n=e.color,r=e.onClick,s=r===void 0?function(){}:r,i=e.onSwatchHover,a=e.first,l=e.last,c=e.active,d=at({default:{color:{width:"40px",height:"24px",cursor:"pointer",background:n,marginBottom:"1px"},check:{color:mm(n),marginLeft:"8px",display:"none"}},first:{color:{overflow:"hidden",borderRadius:"2px 2px 0 0"}},last:{color:{overflow:"hidden",borderRadius:"0 0 2px 2px"}},active:{check:{display:"block"}},"color-#FFFFFF":{color:{boxShadow:"inset 0 0 0 1px #ddd"},check:{color:"#333"}},transparent:{check:{color:"#333"}}},{first:a,last:l,active:c,"color-#FFFFFF":n==="#FFFFFF",transparent:n==="transparent"});return $.createElement(Bi,{color:n,style:d.color,onClick:s,onHover:i,focusStyle:{boxShadow:"0 0 4px "+n}},$.createElement("div",{style:d.check},$.createElement(F9,null)))},H9=function(e){var n=e.onClick,r=e.onSwatchHover,s=e.group,i=e.active,a=at({default:{group:{paddingBottom:"10px",width:"40px",float:"left",marginRight:"10px"}}});return $.createElement("div",{style:a.group},Hi(s,function(l,c){return $.createElement(B9,{key:l,color:l,active:l.toLowerCase()===i,first:c===0,last:c===s.length-1,onClick:n,onSwatchHover:r})}))},Tm=function(e){var n=e.width,r=e.height,s=e.onChange,i=e.onSwatchHover,a=e.colors,l=e.hex,c=e.styles,d=c===void 0?{}:c,u=e.className,p=u===void 0?"":u,h=at(Fn({default:{picker:{width:n,height:r},overflow:{height:r,overflowY:"scroll"},body:{padding:"16px 0 6px 16px"},clear:{clear:"both"}}},d)),f=function(g,v){return s({hex:g,source:"hex"},v)};return $.createElement("div",{style:h.picker,className:"swatches-picker "+p},$.createElement(Bl,null,$.createElement("div",{style:h.overflow},$.createElement("div",{style:h.body},Hi(a,function(m){return $.createElement(H9,{key:m.toString(),group:m,active:l,onClick:f,onSwatchHover:i})}),$.createElement("div",{style:h.clear})))))};Tm.propTypes={width:Oe.oneOfType([Oe.string,Oe.number]),height:Oe.oneOfType([Oe.string,Oe.number]),colors:Oe.arrayOf(Oe.arrayOf(Oe.string)),styles:Oe.object};Tm.defaultProps={width:320,height:240,colors:[[ro[900],ro[700],ro[500],ro[300],ro[100]],[so[900],so[700],so[500],so[300],so[100]],[io[900],io[700],io[500],io[300],io[100]],[oo[900],oo[700],oo[500],oo[300],oo[100]],[ao[900],ao[700],ao[500],ao[300],ao[100]],[lo[900],lo[700],lo[500],lo[300],lo[100]],[co[900],co[700],co[500],co[300],co[100]],[uo[900],uo[700],uo[500],uo[300],uo[100]],[ho[900],ho[700],ho[500],ho[300],ho[100]],["#194D33",Ha[700],Ha[500],Ha[300],Ha[100]],[po[900],po[700],po[500],po[300],po[100]],[fo[900],fo[700],fo[500],fo[300],fo[100]],[mo[900],mo[700],mo[500],mo[300],mo[100]],[go[900],go[700],go[500],go[300],go[100]],[yo[900],yo[700],yo[500],yo[300],yo[100]],[xo[900],xo[700],xo[500],xo[300],xo[100]],[vo[900],vo[700],vo[500],vo[300],vo[100]],[bo[900],bo[700],bo[500],bo[300],bo[100]],["#000000","#525252","#969696","#D9D9D9","#FFFFFF"]],styles:{}};Bn(Tm);var Nm=function(e){var n=e.onChange,r=e.onSwatchHover,s=e.hex,i=e.colors,a=e.width,l=e.triangle,c=e.styles,d=c===void 0?{}:c,u=e.className,p=u===void 0?"":u,h=at(Fn({default:{card:{width:a,background:"#fff",border:"0 solid rgba(0,0,0,0.25)",boxShadow:"0 1px 4px rgba(0,0,0,0.25)",borderRadius:"4px",position:"relative"},body:{padding:"15px 9px 9px 15px"},label:{fontSize:"18px",color:"#fff"},triangle:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 9px 10px 9px",borderColor:"transparent transparent #fff transparent",position:"absolute"},triangleShadow:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 9px 10px 9px",borderColor:"transparent transparent rgba(0,0,0,.1) transparent",position:"absolute"},hash:{background:"#F0F0F0",height:"30px",width:"30px",borderRadius:"4px 0 0 4px",float:"left",color:"#98A1A4",display:"flex",alignItems:"center",justifyContent:"center"},input:{width:"100px",fontSize:"14px",color:"#666",border:"0px",outline:"none",height:"28px",boxShadow:"inset 0 0 0 1px #F0F0F0",boxSizing:"content-box",borderRadius:"0 4px 4px 0",float:"left",paddingLeft:"8px"},swatch:{width:"30px",height:"30px",float:"left",borderRadius:"4px",margin:"0 6px 6px 0"},clear:{clear:"both"}},"hide-triangle":{triangle:{display:"none"},triangleShadow:{display:"none"}},"top-left-triangle":{triangle:{top:"-10px",left:"12px"},triangleShadow:{top:"-11px",left:"12px"}},"top-right-triangle":{triangle:{top:"-10px",right:"12px"},triangleShadow:{top:"-11px",right:"12px"}}},d),{"hide-triangle":l==="hide","top-left-triangle":l==="top-left","top-right-triangle":l==="top-right"}),f=function(g,v){Qs(g)&&n({hex:g,source:"hex"},v)};return $.createElement("div",{style:h.card,className:"twitter-picker "+p},$.createElement("div",{style:h.triangleShadow}),$.createElement("div",{style:h.triangle}),$.createElement("div",{style:h.body},Hi(i,function(m,g){return $.createElement(Bi,{key:g,color:m,hex:m,style:h.swatch,onClick:f,onHover:r,focusStyle:{boxShadow:"0 0 4px "+m}})}),$.createElement("div",{style:h.hash},"#"),$.createElement(yt,{label:null,style:{input:h.input},value:s.replace("#",""),onChange:f}),$.createElement("div",{style:h.clear})))};Nm.propTypes={width:Oe.oneOfType([Oe.string,Oe.number]),triangle:Oe.oneOf(["hide","top-left","top-right"]),colors:Oe.arrayOf(Oe.string),styles:Oe.object};Nm.defaultProps={width:276,colors:["#FF6900","#FCB900","#7BDCB5","#00D084","#8ED1FC","#0693E3","#ABB8C3","#EB144C","#F78DA7","#9900EF"],triangle:"top-left",styles:{}};Bn(Nm);var Pm=function(e){var n=at({default:{picker:{width:"20px",height:"20px",borderRadius:"22px",border:"2px #fff solid",transform:"translate(-12px, -13px)",background:"hsl("+Math.round(e.hsl.h)+", "+Math.round(e.hsl.s*100)+"%, "+Math.round(e.hsl.l*100)+"%)"}}});return $.createElement("div",{style:n.picker})};Pm.propTypes={hsl:Oe.shape({h:Oe.number,s:Oe.number,l:Oe.number,a:Oe.number})};Pm.defaultProps={hsl:{a:1,h:249.94,l:.2,s:.5}};var Rm=function(e){var n=at({default:{picker:{width:"20px",height:"20px",borderRadius:"22px",transform:"translate(-10px, -7px)",background:"hsl("+Math.round(e.hsl.h)+", 100%, 50%)",border:"2px white solid"}}});return $.createElement("div",{style:n.picker})};Rm.propTypes={hsl:Oe.shape({h:Oe.number,s:Oe.number,l:Oe.number,a:Oe.number})};Rm.defaultProps={hsl:{a:1,h:249.94,l:.2,s:.5}};var U9=function(e){var n=e.onChange,r=e.rgb,s=e.hsl,i=e.hex,a=e.hsv,l=function(f,m){if(f.hex)Qs(f.hex)&&n({hex:f.hex,source:"hex"},m);else if(f.rgb){var g=f.rgb.split(",");ah(f.rgb,"rgb")&&n({r:g[0],g:g[1],b:g[2],a:1,source:"rgb"},m)}else if(f.hsv){var v=f.hsv.split(",");ah(f.hsv,"hsv")&&(v[2]=v[2].replace("%",""),v[1]=v[1].replace("%",""),v[0]=v[0].replace("",""),v[1]==1?v[1]=.01:v[2]==1&&(v[2]=.01),n({h:Number(v[0]),s:Number(v[1]),v:Number(v[2]),source:"hsv"},m))}else if(f.hsl){var y=f.hsl.split(",");ah(f.hsl,"hsl")&&(y[2]=y[2].replace("%",""),y[1]=y[1].replace("%",""),y[0]=y[0].replace("",""),p[1]==1?p[1]=.01:p[2]==1&&(p[2]=.01),n({h:Number(y[0]),s:Number(y[1]),v:Number(y[2]),source:"hsl"},m))}},c=at({default:{wrap:{display:"flex",height:"100px",marginTop:"4px"},fields:{width:"100%"},column:{paddingTop:"10px",display:"flex",justifyContent:"space-between"},double:{padding:"0px 4.4px",boxSizing:"border-box"},input:{width:"100%",height:"38px",boxSizing:"border-box",padding:"4px 10% 3px",textAlign:"center",border:"1px solid #dadce0",fontSize:"11px",textTransform:"lowercase",borderRadius:"5px",outline:"none",fontFamily:"Roboto,Arial,sans-serif"},input2:{height:"38px",width:"100%",border:"1px solid #dadce0",boxSizing:"border-box",fontSize:"11px",textTransform:"lowercase",borderRadius:"5px",outline:"none",paddingLeft:"10px",fontFamily:"Roboto,Arial,sans-serif"},label:{textAlign:"center",fontSize:"12px",background:"#fff",position:"absolute",textTransform:"uppercase",color:"#3c4043",width:"35px",top:"-6px",left:"0",right:"0",marginLeft:"auto",marginRight:"auto",fontFamily:"Roboto,Arial,sans-serif"},label2:{left:"10px",textAlign:"center",fontSize:"12px",background:"#fff",position:"absolute",textTransform:"uppercase",color:"#3c4043",width:"32px",top:"-6px",fontFamily:"Roboto,Arial,sans-serif"},single:{flexGrow:"1",margin:"0px 4.4px"}}}),d=r.r+", "+r.g+", "+r.b,u=Math.round(s.h)+", "+Math.round(s.s*100)+"%, "+Math.round(s.l*100)+"%",p=Math.round(a.h)+", "+Math.round(a.s*100)+"%, "+Math.round(a.v*100)+"%";return $.createElement("div",{style:c.wrap,className:"flexbox-fix"},$.createElement("div",{style:c.fields},$.createElement("div",{style:c.double},$.createElement(yt,{style:{input:c.input,label:c.label},label:"hex",value:i,onChange:l})),$.createElement("div",{style:c.column},$.createElement("div",{style:c.single},$.createElement(yt,{style:{input:c.input2,label:c.label2},label:"rgb",value:d,onChange:l})),$.createElement("div",{style:c.single},$.createElement(yt,{style:{input:c.input2,label:c.label2},label:"hsv",value:p,onChange:l})),$.createElement("div",{style:c.single},$.createElement(yt,{style:{input:c.input2,label:c.label2},label:"hsl",value:u,onChange:l})))))},Om=function(e){var n=e.width,r=e.onChange,s=e.rgb,i=e.hsl,a=e.hsv,l=e.hex,c=e.header,d=e.styles,u=d===void 0?{}:d,p=e.className,h=p===void 0?"":p,f=at(Fn({default:{picker:{width:n,background:"#fff",border:"1px solid #dfe1e5",boxSizing:"initial",display:"flex",flexWrap:"wrap",borderRadius:"8px 8px 0px 0px"},head:{height:"57px",width:"100%",paddingTop:"16px",paddingBottom:"16px",paddingLeft:"16px",fontSize:"20px",boxSizing:"border-box",fontFamily:"Roboto-Regular,HelveticaNeue,Arial,sans-serif"},saturation:{width:"70%",padding:"0px",position:"relative",overflow:"hidden"},swatch:{width:"30%",height:"228px",padding:"0px",background:"rgba("+s.r+", "+s.g+", "+s.b+", 1)",position:"relative",overflow:"hidden"},body:{margin:"auto",width:"95%"},controls:{display:"flex",boxSizing:"border-box",height:"52px",paddingTop:"22px"},color:{width:"32px"},hue:{height:"8px",position:"relative",margin:"0px 16px 0px 16px",width:"100%"},Hue:{radius:"2px"}}},u));return $.createElement("div",{style:f.picker,className:"google-picker "+h},$.createElement("div",{style:f.head},c),$.createElement("div",{style:f.swatch}),$.createElement("div",{style:f.saturation},$.createElement(ou,{hsl:i,hsv:a,pointer:Pm,onChange:r})),$.createElement("div",{style:f.body},$.createElement("div",{style:f.controls,className:"flexbox-fix"},$.createElement("div",{style:f.hue},$.createElement(pa,{style:f.Hue,hsl:i,radius:"4px",pointer:Rm,onChange:r}))),$.createElement(U9,{rgb:s,hsl:i,hex:l,hsv:a,onChange:r})))};Om.propTypes={width:Oe.oneOfType([Oe.string,Oe.number]),styles:Oe.object,header:Oe.string};Om.defaultProps={width:652,styles:{},header:"Color picker"};Bn(Om);function W9({color:t,mode:e="blend",onColorChange:n,onClose:r}){var u;const[s,i]=R.useState((t==null?void 0:t.hex)||"#000000");R.useEffect(()=>{t!=null&&t.hex&&i(t.hex)},[t==null?void 0:t.hex]);const a=()=>{t!=null&&t.originalHex&&(i(t.originalHex),n&&n(t.originalHex))},l=p=>{const h=p.hex;i(h),n&&n(h)},c=()=>{i("transparent"),n&&n("transparent")},d=s==="transparent"||s==="none";return t?o.jsxs("div",{className:"color-editor-panel",children:[o.jsxs("div",{className:"editor-header",children:[o.jsx("h3",{children:"Edit Colour"}),o.jsx("button",{onClick:r,className:"close-button",children:""})]}),o.jsxs("div",{className:"editor-content",children:[o.jsxs("div",{className:"color-info-section",children:[o.jsx("div",{className:"color-display",children:o.jsxs("div",{className:"swatch-pair",children:[o.jsxs("div",{className:"swatch-group",children:[o.jsx("div",{className:"swatch original",style:{backgroundColor:t.originalHex||t.hex},title:"Original colour"}),o.jsx("span",{className:"swatch-label",children:"Original"})]}),o.jsx("span",{className:"arrow",children:""}),o.jsxs("div",{className:"swatch-group",children:[o.jsx("div",{className:`swatch current ${d?"transparent-preview":""}`,style:d?{}:{backgroundColor:s},title:"Current colour"}),o.jsx("span",{className:"swatch-label",children:d?"Transparent":"Current"})]})]})}),o.jsxs("div",{className:"color-details",children:[o.jsxs("div",{className:"detail-row",children:[o.jsx("span",{className:"label",children:"Hex:"}),o.jsx("span",{className:"value",children:s})]}),o.jsxs("div",{className:"detail-row",children:[o.jsx("span",{className:"label",children:"Coverage:"}),o.jsxs("span",{className:"value",children:[((u=t.areaPct)==null?void 0:u.toFixed(1))||0,"%"]})]})]})]}),o.jsxs("div",{className:"transparent-section",children:[o.jsx("h4",{children:"Remove Fill"}),o.jsxs("button",{className:`transparent-option ${d?"selected":""}`,onClick:c,title:"Make this area transparent (remove fill)",children:[o.jsx("div",{className:"transparent-swatch"}),o.jsx("span",{children:"Make Transparent"})]})]}),o.jsxs("div",{className:"tpv-palette-section",children:[o.jsx("h4",{children:"Standard TPV Colours"}),o.jsx("p",{className:"palette-description",children:"Select a pure TPV colour (no blending required)"}),o.jsx("div",{className:"tpv-color-grid",children:pn.map(p=>o.jsxs("div",{className:`tpv-color-item ${s.toLowerCase()===p.hex.toLowerCase()?"selected":""}`,onClick:()=>l(p),title:`${p.code} - ${p.name}`,children:[o.jsx("div",{className:"tpv-color-swatch",style:{backgroundColor:p.hex}}),o.jsx("span",{className:"tpv-color-code",children:p.code})]},p.code))})]}),vi.BLEND_MODE_ENABLED,o.jsxs("div",{className:"solid-mode-info",children:[o.jsx("h4",{children:"Solid Mode Editing"}),o.jsx("p",{className:"info-description",children:"Select from the standard TPV colours above. Only solid TPV colours are available."}),o.jsx("button",{onClick:a,className:"reset-button",children:"Reset to Original Colour"})]})]}),o.jsx("style",{jsx:!0,children:`
        .color-editor-panel {
          position: fixed;
          top: 0;
          right: 0;
          width: 400px;
          height: 100vh;
          background: white;
          box-shadow: -4px 0 12px rgba(0, 0, 0, 0.15);
          z-index: 1000;
          display: flex;
          flex-direction: column;
          overflow: hidden;
        }

        .editor-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 1.5rem;
          border-bottom: 2px solid #1a365d;
          background: #f9f9f9;
        }

        .editor-header h3 {
          font-family: 'Overpass', sans-serif;
          margin: 0;
          color: #1e4a7a;
          font-size: 1.5rem;
          font-weight: 600;
        }

        .close-button {
          background: none;
          border: none;
          font-size: 2rem;
          color: #666;
          cursor: pointer;
          padding: 0;
          width: 32px;
          height: 32px;
          line-height: 1;
          transition: color 0.2s;
        }

        .close-button:hover {
          color: #333;
        }

        .editor-content {
          flex: 1;
          overflow-y: auto;
          padding: 1.5rem;
        }

        /* Color Info Section */
        .color-info-section {
          margin-bottom: 2rem;
          padding: 1rem;
          background: #f9f9f9;
          border-radius: 6px;
        }

        .color-display {
          margin-bottom: 1rem;
        }

        .swatch-pair {
          display: flex;
          align-items: center;
          gap: 1rem;
          justify-content: center;
        }

        .swatch-group {
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 0.5rem;
        }

        .swatch {
          width: 60px;
          height: 60px;
          border-radius: 8px;
          border: 3px solid #ddd;
          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .swatch.original {
          border-color: #999;
        }

        .swatch.current {
          border-color: #ff6b35;
        }

        .swatch.transparent-preview {
          background:
            linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%),
            linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%);
          background-size: 10px 10px;
          background-position: 0 0, 5px 5px;
          background-color: white;
        }

        .swatch-label {
          font-size: 0.85rem;
          color: #666;
          font-weight: 500;
        }

        .arrow {
          font-size: 1.5rem;
          color: #666;
          font-weight: bold;
        }

        .color-details {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .detail-row {
          display: flex;
          justify-content: space-between;
          align-items: center;
          font-size: 0.95rem;
        }

        .detail-row .label {
          font-weight: 600;
          color: #666;
        }

        .detail-row .value {
          font-family: 'Courier New', monospace;
          color: #333;
        }

        /* Transparent Section */
        .transparent-section {
          margin-bottom: 1.5rem;
          padding: 1rem;
          background: #f9f9f9;
          border-radius: 6px;
        }

        .transparent-section h4 {
          margin: 0 0 0.75rem 0;
          color: #1a365d;
          font-size: 1rem;
          font-weight: 600;
        }

        .transparent-option {
          display: flex;
          align-items: center;
          gap: 12px;
          width: 100%;
          padding: 12px 16px;
          background: white;
          border: 2px solid #d1d5db;
          border-radius: 8px;
          cursor: pointer;
          transition: all 0.2s;
          font-size: 0.95rem;
          font-weight: 500;
          color: #374151;
        }

        .transparent-option:hover {
          border-color: #6b7280;
          background: #fafafa;
        }

        .transparent-option.selected {
          border-color: #ff6b35;
          background: #fff5f0;
          box-shadow: 0 0 0 2px rgba(255, 107, 53, 0.2);
        }

        .transparent-swatch {
          width: 32px;
          height: 32px;
          border-radius: 4px;
          border: 1px solid #999;
          background:
            linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%),
            linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%);
          background-size: 8px 8px;
          background-position: 0 0, 4px 4px;
          background-color: white;
        }

        /* TPV Palette Section */
        .tpv-palette-section {
          margin-bottom: 2rem;
          padding: 1rem;
          background: #f9f9f9;
          border-radius: 6px;
        }

        .tpv-palette-section h4 {
          margin: 0 0 0.5rem 0;
          color: #1a365d;
          font-size: 1rem;
          font-weight: 600;
        }

        .palette-description {
          margin: 0 0 1rem 0;
          font-size: 0.85rem;
          color: #666;
        }

        .tpv-color-grid {
          display: grid;
          grid-template-columns: repeat(3, 1fr);
          gap: 0.75rem;
        }

        .tpv-color-item {
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 0.4rem;
          padding: 0.5rem;
          border: 2px solid transparent;
          border-radius: 6px;
          cursor: pointer;
          transition: all 0.2s;
          background: white;
        }

        .tpv-color-item:hover {
          border-color: #ff6b35;
          transform: translateY(-2px);
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .tpv-color-item.selected {
          border-color: #ff6b35;
          background: #fff5f0;
          box-shadow: 0 0 0 2px rgba(255, 107, 53, 0.2);
        }

        .tpv-color-swatch {
          width: 100%;
          height: 50px;
          border-radius: 4px;
          border: 1px solid rgba(0, 0, 0, 0.1);
          box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .tpv-color-code {
          font-size: 0.75rem;
          font-weight: 600;
          color: #1a365d;
          font-family: 'Courier New', monospace;
        }

        /* Picker Section */
        .picker-section {
          margin-bottom: 1rem;
          padding: 1rem;
          background: #f9f9f9;
          border-radius: 6px;
        }

        .picker-section h4 {
          margin: 0 0 0.5rem 0;
          color: #1a365d;
          font-size: 1rem;
          font-weight: 600;
        }

        .picker-description {
          margin: 0 0 1rem 0;
          font-size: 0.85rem;
          color: #666;
        }

        .picker-section :global(.chrome-picker) {
          box-shadow: none !important;
          width: 100% !important;
        }

        .reset-button {
          width: 100%;
          padding: 0.75rem;
          margin-top: 1rem;
          background: #e0e0e0;
          color: #333;
          border: none;
          border-radius: 4px;
          font-weight: 600;
          cursor: pointer;
          transition: background 0.2s;
        }

        .reset-button:hover {
          background: #d0d0d0;
        }

        /* Solid Mode Info */
        .solid-mode-info {
          margin-bottom: 1rem;
          padding: 1rem;
          background: #fff5f0;
          border: 2px solid #ff6b35;
          border-radius: 6px;
        }

        .solid-mode-info h4 {
          margin: 0 0 0.5rem 0;
          color: #1a365d;
          font-size: 1rem;
          font-weight: 600;
        }

        .info-description {
          margin: 0;
          font-size: 0.85rem;
          color: #666;
          line-height: 1.5;
        }

        /* Mobile Responsive - Fullscreen Modal */
        @media (max-width: 768px) {
          .color-editor-panel {
            width: 100%;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 0;
          }

          .editor-header {
            padding: 1rem;
            position: sticky;
            top: 0;
            z-index: 10;
          }

          .editor-header h3 {
            font-size: 1.25rem;
          }

          /* Larger close button for touch */
          .close-button {
            width: 44px;
            height: 44px;
            font-size: 2.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
          }

          .editor-content {
            padding: 1rem;
          }

          /* Color swatches - larger for touch */
          .swatch {
            width: 50px;
            height: 50px;
          }

          .color-info-section {
            padding: 0.75rem;
            margin-bottom: 1.5rem;
          }

          /* TPV color grid - better touch targets */
          .tpv-color-grid {
            grid-template-columns: repeat(4, 1fr);
            gap: 0.5rem;
          }

          .tpv-color-item {
            padding: 0.4rem;
            min-height: 44px;
          }

          .tpv-color-swatch {
            height: 36px;
          }

          .tpv-color-code {
            font-size: 0.65rem;
          }

          .tpv-palette-section {
            padding: 0.75rem;
            margin-bottom: 1.5rem;
          }

          .tpv-palette-section h4 {
            font-size: 0.9rem;
          }

          .palette-description {
            font-size: 0.8rem;
          }

          /* Picker section */
          .picker-section {
            padding: 0.75rem;
          }

          .picker-section h4 {
            font-size: 0.9rem;
          }

          .picker-description {
            font-size: 0.8rem;
          }

          /* Larger reset button for touch */
          .reset-button {
            min-height: 44px;
            font-size: 0.9rem;
          }

          .solid-mode-info {
            padding: 0.75rem;
          }

          .solid-mode-info h4 {
            font-size: 0.9rem;
          }

          .info-description {
            font-size: 0.8rem;
          }
        }

        /* Extra small screens */
        @media (max-width: 400px) {
          .tpv-color-grid {
            grid-template-columns: repeat(3, 1fr);
          }

          .tpv-color-swatch {
            height: 44px;
          }

          .swatch {
            width: 44px;
            height: 44px;
          }

          .swatch-pair {
            gap: 0.5rem;
          }

          .arrow {
            font-size: 1.2rem;
          }
        }
      `})]}):null}const G9=pn;new Map(G9.map((t,e)=>[t.code,e]));function W_(t){const{inputMode:e,prompt:n,selectedFile:r,lengthMM:s,widthMM:i,result:a,viewMode:l,blendRecipes:c,solidRecipes:d,colorMapping:u,solidColorMapping:p,solidEditedColors:h,blendEditedColors:f,blendSvgUrl:m,solidSvgUrl:g,arMapping:v,jobId:y,inSituData:x,regionOverrides:b,originalTaggedSvg:w}=t;console.log("[SERIALIZE] Serializing design with result:",a),console.log("[SERIALIZE] result.svg_url:",a==null?void 0:a.svg_url),console.log("[SERIALIZE] regionOverrides:",b),console.log("[SERIALIZE] regionOverrides size:",b==null?void 0:b.size),console.log("[SERIALIZE] originalTaggedSvg present:",!!w);const S=_=>_?_ instanceof Map?Object.fromEntries(_):_:null;return{input_mode:e,prompt:n||null,uploaded_file_url:(r==null?void 0:r.url)||null,dimensions:{widthMM:i,lengthMM:s},original_svg_url:(a==null?void 0:a.svg_url)||null,original_png_url:(a==null?void 0:a.png_url)||null,thumbnail_url:(a==null?void 0:a.thumb_url)||null,blend_recipes:c||null,solid_recipes:d||null,color_mapping:S(u),solid_color_mapping:S(p),solid_color_edits:S(h),blend_color_edits:S(f),final_blend_svg_url:m||null,final_solid_svg_url:g||null,preferred_view_mode:l||"solid",aspect_ratio_mapping:v||null,job_id:y||null,in_situ:x?{room_photo_url:x.room_photo_url||null,mask_url:x.mask_url||null,floor_dimensions_m:x.floor_dimensions_m||null,preview_url:x.preview_url||null,blend_opacity:x.blend_opacity||20,perspective_corners:x.perspective_corners||null}:null,region_overrides:S(b),original_tagged_svg:w||null}}function Pp(t){var i,a,l,c;console.log("[DESERIALIZE] Incoming savedData keys:",Object.keys(t||{})),console.log("[DESERIALIZE] savedData.region_overrides:",t==null?void 0:t.region_overrides),console.log("[DESERIALIZE] savedData.design_data:",t==null?void 0:t.design_data),console.log("[DESERIALIZE] savedData.design_data?.region_overrides:",(i=t==null?void 0:t.design_data)==null?void 0:i.region_overrides),console.log("[DESERIALIZE] savedData.original_tagged_svg present:",!!(t!=null&&t.original_tagged_svg)),console.log("[DESERIALIZE] savedData.design_data?.original_tagged_svg present:",!!((a=t==null?void 0:t.design_data)!=null&&a.original_tagged_svg));const e=d=>d?d instanceof Map?d:new Map(Object.entries(d)):new Map,n=d=>{var u;return t[d]??((u=t.design_data)==null?void 0:u[d])},r=n("region_overrides"),s=n("original_tagged_svg");return console.log("[DESERIALIZE] Final regionOverridesData:",r),console.log("[DESERIALIZE] Final originalTaggedSvgData present:",!!s),{inputMode:t.input_mode||n("input_mode"),prompt:n("prompt")||"",selectedFile:n("uploaded_file_url")?{url:n("uploaded_file_url"),name:n("uploaded_file_url").split("/").pop()}:null,lengthMM:((l=n("dimensions"))==null?void 0:l.lengthMM)||0,widthMM:((c=n("dimensions"))==null?void 0:c.widthMM)||0,result:{svg_url:n("original_svg_url"),png_url:n("original_png_url"),thumbnail_url:n("thumbnail_url")},blendRecipes:n("blend_recipes")||null,solidRecipes:n("solid_recipes")||null,colorMapping:e(n("color_mapping")),solidColorMapping:e(n("solid_color_mapping")),solidEditedColors:e(n("solid_color_edits")),blendEditedColors:e(n("blend_color_edits")),blendSvgUrl:null,solidSvgUrl:null,viewMode:"solid",arMapping:n("aspect_ratio_mapping"),jobId:n("job_id"),inSituData:n("in_situ")||null,regionOverrides:e(r),originalTaggedSvg:s||null,generating:!1,generatingBlends:!1,showFinalRecipes:!!t.blend_recipes,showSolidSummary:!!t.solid_recipes,colorEditorOpen:!1,selectedColor:null}}function V9(t){var n;const e=[];return t.inputMode||e.push("Input mode is required"),(!(t.widthMM>0)||!(t.lengthMM>0))&&e.push("Surface dimensions are required"),(n=t.result)!=null&&n.svg_url||e.push("No design to save - generate a design first"),{valid:e.length===0,errors:e}}function Y9({currentState:t,existingDesignId:e=null,initialName:n="",onClose:r,onSaved:s}){const[i,a]=R.useState(n),[l,c]=R.useState(""),[d,u]=R.useState(""),[p,h]=R.useState(""),[f,m]=R.useState(!1),[g,v]=R.useState([]),[y,x]=R.useState(!1),[b,w]=R.useState(""),[S,_]=R.useState("#1a365d"),[k,E]=R.useState(!1),[T,O]=R.useState(!1),[q,P]=R.useState(!1),[W,j]=R.useState(null);R.useEffect(()=>{G()},[]);const G=async()=>{try{const{projects:F}=await If();v(F)}catch(F){console.error("Failed to load projects:",F),j("Failed to load projects")}},pe=async()=>{if(!b.trim()){j("Project name is required");return}P(!0),j(null);try{const{project:F}=await w1({name:b.trim(),color:S});v([F,...g]),u(F.id),x(!1),w(""),_("#1a365d")}catch(F){console.error("Failed to create project:",F),j(F.message)}finally{P(!1)}},Z=async(F=!1)=>{if(!i.trim()){j("Design name is required");return}const K=V9(t);if(!K.valid){j(K.errors.join(", "));return}F?O(!0):E(!0),j(null);try{const U=W_(t);console.log("[SAVE-MODAL] Serialized design data:",U),console.log("[SAVE-MODAL] SVG URL from serialized data:",U.original_svg_url);const V={name:i.trim(),description:l.trim()||null,project_id:d||null,tags:p.split(",").map(oe=>oe.trim()).filter(oe=>oe),is_public:f,design_data:U};console.log("[SAVE-MODAL] Full save payload:",V),e&&!F&&(V.id=e);const J=await $f(V);s&&s(J,i.trim()),r()}catch(U){console.error("Failed to save design:",U),j(U.message)}finally{E(!1),O(!1)}},ee=["#1a365d","#ff6b35","#4a90e2","#50c878","#9b59b6","#e74c3c"];return o.jsx("div",{className:"modal-overlay",onClick:r,children:o.jsxs("div",{className:"modal-content save-design-modal",onClick:F=>F.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsx("h2",{children:e?"Update Design":"Save Design"}),o.jsx("button",{onClick:r,className:"close-button",children:""})]}),o.jsxs("div",{className:"modal-body",children:[W&&o.jsx("div",{className:"error-message",children:W}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"design-name",children:"Design Name *"}),o.jsx("input",{id:"design-name",type:"text",value:i,onChange:F=>a(F.target.value),placeholder:"e.g., Playground Design A",autoFocus:!0,disabled:k||T})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"design-description",children:"Description"}),o.jsx("textarea",{id:"design-description",value:l,onChange:F=>c(F.target.value),placeholder:"Optional notes about this design...",rows:3,disabled:k||T})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"design-project",children:"Project"}),y?o.jsxs("div",{className:"new-project-form",children:[o.jsxs("div",{className:"input-row",children:[o.jsx("input",{type:"text",value:b,onChange:F=>w(F.target.value),placeholder:"Project name...",disabled:q}),o.jsx("div",{className:"color-picker-inline",children:ee.map(F=>o.jsx("button",{type:"button",className:`color-swatch ${S===F?"active":""}`,style:{backgroundColor:F},onClick:()=>_(F),disabled:q},F))})]}),o.jsxs("div",{className:"button-row",children:[o.jsx("button",{type:"button",onClick:pe,className:"btn-primary btn-small",disabled:q,children:q?"Creating...":"Create"}),o.jsx("button",{type:"button",onClick:()=>x(!1),className:"btn-secondary btn-small",disabled:q,children:"Cancel"})]})]}):o.jsxs("div",{className:"project-selector",children:[o.jsxs("select",{id:"design-project",value:d,onChange:F=>u(F.target.value),disabled:k||T,children:[o.jsx("option",{value:"",children:"No Project"}),g.map(F=>o.jsxs("option",{value:F.id,children:[F.name," (",F.design_count," designs)"]},F.id))]}),o.jsx("button",{type:"button",onClick:()=>x(!0),className:"btn-secondary btn-small",disabled:k||T,children:"+ New Project"})]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"design-tags",children:"Tags"}),o.jsx("input",{id:"design-tags",type:"text",value:p,onChange:F=>h(F.target.value),placeholder:"e.g., playground, vibrant, geometric (comma-separated)",disabled:k||T}),o.jsx("small",{className:"help-text",children:"Separate tags with commas"})]}),o.jsx("div",{className:"form-group checkbox-group",children:o.jsxs("label",{children:[o.jsx("input",{type:"checkbox",checked:f,onChange:F=>m(F.target.checked),disabled:k||T}),o.jsx("span",{children:"Make this design public (shareable link)"})]})})]}),o.jsxs("div",{className:"modal-footer",children:[o.jsx("button",{onClick:r,className:"btn-secondary",disabled:k||T,children:"Cancel"}),e&&o.jsx("button",{onClick:()=>Z(!0),className:"btn-secondary",disabled:k||T,children:T?"Saving...":"Save as New"}),o.jsx("button",{onClick:()=>Z(!1),className:"btn-primary",disabled:k||T,children:k?"Saving...":e?"Update":"Save Design"})]})]})})}const q9=10*1024*1024,X9=["image/jpeg","image/png","image/jpg"];function Z9({onPhotoUploaded:t,disabled:e=!1}){const[n,r]=R.useState(!1),[s,i]=R.useState(!1),[a,l]=R.useState(null),[c,d]=R.useState(null),u=R.useRef(null),p=x=>{x.preventDefault(),e||r(!0)},h=x=>{x.preventDefault(),r(!1)},f=async x=>{if(x.preventDefault(),r(!1),e)return;const b=x.dataTransfer.files;b.length>0&&await v(b[0])},m=()=>{!e&&u.current&&u.current.click()},g=async x=>{x.target.files.length>0&&await v(x.target.files[0])},v=async x=>{if(l(null),!X9.includes(x.type)){l("Please upload a JPG or PNG image");return}if(x.size>q9){l("Image must be under 10MB");return}const b=URL.createObjectURL(x);d(b),console.log("[IN-SITU-UPLOADER] Loading local file to get dimensions...");const w=await new Promise((S,_)=>{const k=new Image;k.onload=()=>{console.log("[IN-SITU-UPLOADER] Local image loaded, dimensions:",k.naturalWidth,"x",k.naturalHeight),S({width:k.naturalWidth,height:k.naturalHeight})},k.onerror=E=>{console.error("[IN-SITU-UPLOADER] Failed to load local image:",E),_(new Error("Failed to read image dimensions"))},k.src=b});i(!0);try{const _=`in-situ-photos/${`${Date.now()}-${Math.random().toString(36).substr(2,9)}.${x.type.split("/")[1]}`}`,{data:k,error:E}=await an.storage.from("tpv-studio-uploads").upload(_,x,{cacheControl:"3600",upsert:!1});if(E)throw E;const{data:{publicUrl:T}}=an.storage.from("tpv-studio-uploads").getPublicUrl(_);console.log("[IN-SITU-UPLOADER] Photo uploaded:",T),console.log("[IN-SITU-UPLOADER] Using dimensions from local file:",w),console.log("[IN-SITU-UPLOADER] Passing local blob URL for fast preview"),console.log("[IN-SITU-UPLOADER] Calling onPhotoUploaded callback..."),t({url:b,supabaseUrl:T,width:w.width,height:w.height,filename:x.name})}catch(S){console.error("[IN-SITU-UPLOADER] Upload failed:",S),l(S.message||"Upload failed"),URL.revokeObjectURL(b),d(null)}finally{i(!1)}},y=()=>{c&&URL.revokeObjectURL(c),d(null),l(null)};return o.jsxs("div",{className:"in-situ-uploader",children:[c?o.jsxs("div",{className:"preview-container",children:[o.jsx("img",{src:c,alt:"Site preview",className:"preview-image"}),s&&o.jsxs("div",{className:"upload-overlay",children:[o.jsx("div",{className:"upload-spinner"}),o.jsx("p",{children:"Uploading..."})]}),!s&&o.jsx("button",{className:"clear-button",onClick:y,title:"Remove photo",children:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),o.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}):o.jsxs("div",{className:`upload-zone ${n?"dragging":""} ${e?"disabled":""}`,onDragOver:p,onDragLeave:h,onDrop:f,onClick:m,children:[o.jsx("input",{ref:u,type:"file",accept:"image/jpeg,image/png",onChange:g,style:{display:"none"},disabled:e}),o.jsx("div",{className:"upload-icon",children:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),o.jsx("polyline",{points:"17 8 12 3 7 8"}),o.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]})}),o.jsxs("div",{className:"upload-text",children:[o.jsx("p",{className:"primary",children:n?"Drop photo here":"Upload site photo"}),o.jsx("p",{className:"secondary",children:"Drag & drop or click to browse"}),o.jsx("p",{className:"hint",children:"JPG or PNG, max 10MB"})]})]}),a&&o.jsx("div",{className:"error-message",children:a}),o.jsx("style",{children:`
        .in-situ-uploader {
          width: 100%;
        }

        .upload-zone {
          border: 2px dashed #d1d5db;
          border-radius: 8px;
          padding: 2rem;
          text-align: center;
          cursor: pointer;
          transition: all 0.2s;
          background: #f9fafb;
        }

        .upload-zone:hover {
          border-color: #ff6b35;
          background: #fff7f5;
        }

        .upload-zone.dragging {
          border-color: #ff6b35;
          background: #fff7f5;
          border-style: solid;
        }

        .upload-zone.disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .upload-zone.disabled:hover {
          border-color: #d1d5db;
          background: #f9fafb;
        }

        .upload-icon {
          width: 48px;
          height: 48px;
          margin: 0 auto 1rem;
          color: #9ca3af;
        }

        .upload-zone:hover .upload-icon {
          color: #ff6b35;
        }

        .upload-text .primary {
          font-size: 1rem;
          font-weight: 600;
          color: #374151;
          margin: 0 0 0.25rem;
        }

        .upload-text .secondary {
          font-size: 0.875rem;
          color: #6b7280;
          margin: 0 0 0.5rem;
        }

        .upload-text .hint {
          font-size: 0.75rem;
          color: #9ca3af;
          margin: 0;
        }

        .preview-container {
          position: relative;
          border-radius: 8px;
          overflow: hidden;
        }

        .preview-image {
          width: 100%;
          display: block;
          border-radius: 8px;
        }

        .upload-overlay {
          position: absolute;
          inset: 0;
          background: rgba(0, 0, 0, 0.6);
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          color: white;
        }

        .upload-spinner {
          width: 32px;
          height: 32px;
          border: 3px solid rgba(255, 255, 255, 0.3);
          border-top-color: white;
          border-radius: 50%;
          animation: spin 0.8s linear infinite;
          margin-bottom: 0.5rem;
        }

        @keyframes spin {
          to { transform: rotate(360deg); }
        }

        .clear-button {
          position: absolute;
          top: 0.5rem;
          right: 0.5rem;
          width: 32px;
          height: 32px;
          border-radius: 50%;
          background: rgba(0, 0, 0, 0.6);
          border: none;
          cursor: pointer;
          color: white;
          display: flex;
          align-items: center;
          justify-content: center;
          transition: background 0.2s;
        }

        .clear-button:hover {
          background: rgba(0, 0, 0, 0.8);
        }

        .clear-button svg {
          width: 16px;
          height: 16px;
        }

        .error-message {
          margin-top: 0.75rem;
          padding: 0.5rem 0.75rem;
          background: #fef2f2;
          border: 1px solid #fecaca;
          border-radius: 4px;
          color: #dc2626;
          font-size: 0.875rem;
        }
      `})]})}function K9(t,e){const[n,r,s,i,a,l,c,d]=t,[u,p,h,f,m,g,v,y]=e,x=[[n,r,1,0,0,0,-u*n,-u*r],[0,0,0,n,r,1,-p*n,-p*r],[s,i,1,0,0,0,-h*s,-h*i],[0,0,0,s,i,1,-f*s,-f*i],[a,l,1,0,0,0,-m*a,-m*l],[0,0,0,a,l,1,-g*a,-g*l],[c,d,1,0,0,0,-v*c,-v*d],[0,0,0,c,d,1,-y*c,-y*d]],w=J9(x,[u,p,h,f,m,g,v,y]);return function(_,k){const E=w[6]*_+w[7]*k+1,T=(w[0]*_+w[1]*k+w[2])/E,O=(w[3]*_+w[4]*k+w[5])/E;return[T,O]}}function J9(t,e){const n=t.length,r=t.map((i,a)=>[...i,e[a]]);for(let i=0;i<n;i++){let a=i;for(let l=i+1;l<n;l++)Math.abs(r[l][i])>Math.abs(r[a][i])&&(a=l);[r[i],r[a]]=[r[a],r[i]];for(let l=i+1;l<n;l++){const c=r[l][i]/r[i][i];for(let d=i;d<=n;d++)r[l][d]-=c*r[i][d]}}const s=new Array(n);for(let i=n-1;i>=0;i--){s[i]=r[i][n];for(let a=i+1;a<n;a++)s[i]-=r[i][a]*s[a];s[i]/=r[i][i]}return s}function Am(t){return new Promise((e,n)=>{const r=new Image;!t.startsWith("blob:")&&!t.startsWith("data:")?(r.crossOrigin="anonymous",console.log("[LOAD-IMAGE] Loading external URL with CORS:",t.substring(0,50))):console.log("[LOAD-IMAGE] Loading local URL (blob/data):",t.substring(0,50)),r.onload=()=>{console.log("[LOAD-IMAGE] Successfully loaded image:",t.substring(0,50)),e(r)},r.onerror=()=>{console.error("[LOAD-IMAGE] Failed to load image:",t),n(new Error(`Failed to load image: ${t}`))},r.src=t})}async function G_(t,e=1536){console.log("[RASTERIZE-SVG] Starting SVG rasterization:",t.substring(0,50),"maxSize:",e);const n=await Am(t),{naturalWidth:r,naturalHeight:s}=n;console.log("[RASTERIZE-SVG] SVG loaded with dimensions:",r,"x",s);const i=Math.min(1,e/Math.max(r,s)),a=Math.round(r*i),l=Math.round(s*i);console.log("[RASTERIZE-SVG] Scaling to:",a,"x",l,"(scale:",i.toFixed(2),")");const c=document.createElement("canvas");return c.width=a,c.height=l,c.getContext("2d").drawImage(n,0,0,a,l),console.log("[RASTERIZE-SVG] Drew SVG to canvas"),new Promise((u,p)=>{const h=new Image;h.onload=()=>{console.log("[RASTERIZE-SVG] Successfully rasterized SVG to PNG"),u(h)},h.onerror=f=>{console.error("[RASTERIZE-SVG] Failed to convert canvas to image:",f),p(f)},h.src=c.toDataURL("image/png")})}function V_({photoCtx:t,photoImg:e,designImg:n,quad:r,opacity:s,shape:i,lighting:a}){const l=t.canvas;t.clearRect(0,0,l.width,l.height),t.drawImage(e,0,0,l.width,l.height);const c=n.width,d=n.height,u=[0,0,c,0,c,d,0,d],p=[r[0].x,r[0].y,r[1].x,r[1].y,r[2].x,r[2].y,r[3].x,r[3].y],h=K9(u,p),f=10,m=c/f,g=d/f,v=document.createElement("canvas");if(v.width=c,v.height=d,v.getContext("2d").drawImage(n,0,0),t.save(),t.globalAlpha=s,a&&a.enabled){const b=a.strength||.6,w=1+(a.baseBrightness-1)*b,S=1+(a.baseContrast-1)*b;t.filter=`brightness(${w}) contrast(${S})`}const x=i&&i.length>=3?i:r;t.beginPath(),t.moveTo(x[0].x,x[0].y);for(let b=1;b<x.length;b++)t.lineTo(x[b].x,x[b].y);t.closePath(),t.clip();for(let b=0;b<f;b++)for(let w=0;w<f;w++){const S=b*m,_=w*g,k=(b+1)*m,E=(w+1)*g,T=h(S,_),O=h(k,_),q=h(k,E),P=h(S,E);Dx(t,v,S,_,k,_,S,E,T[0],T[1],O[0],O[1],P[0],P[1]),Dx(t,v,k,_,k,E,S,E,O[0],O[1],q[0],q[1],P[0],P[1])}t.restore()}function Dx(t,e,n,r,s,i,a,l,c,d,u,p,h,f){t.save(),t.beginPath(),t.moveTo(c,d),t.lineTo(u,p),t.lineTo(h,f),t.closePath(),t.clip();const m=(n-a)*(i-l)-(s-a)*(r-l);if(Math.abs(m)<.001){t.restore();return}const g=((c-h)*(i-l)-(u-h)*(r-l))/m,v=((d-f)*(i-l)-(p-f)*(r-l))/m,y=((n-a)*(u-h)-(s-a)*(c-h))/m,x=((n-a)*(p-f)-(s-a)*(d-f))/m,b=c-g*n-y*r,w=d-v*n-x*r;t.setTransform(g,v,y,x,b,w),t.drawImage(e,0,0),t.restore()}function Q9(t,e="tpv-in-situ-preview.png"){t.toBlob(n=>{const r=URL.createObjectURL(n),s=document.createElement("a");s.href=r,s.download=e,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(r)},"image/png")}function eW(t,e,n,r){const s=n/r,i=t*.6,a=e*.6;let l,c;s>i/a?(l=i,c=i/s):(c=a,l=a*s);const d=(t-l)/2,u=(e-c)/2;return[{x:d,y:u},{x:d+l,y:u},{x:d+l,y:u+c},{x:d,y:u+c}]}function tW(t,e,n){let r=!1;for(let s=0,i=n.length-1;s<n.length;i=s++){const a=n[s].x,l=n[s].y,c=n[i].x,d=n[i].y;l>e!=d>e&&t<(c-a)*(e-l)/(d-l)+a&&(r=!r)}return r}function nW(t,e,n){t/=255,e/=255,n/=255;const r=Math.max(t,e,n),s=Math.min(t,e,n),i=(r+s)/2;if(r===s)return{h:0,s:0,l:i};const a=r-s,l=i>.5?a/(2-r-s):a/(r+s);let c;switch(r){case t:c=((e-n)/a+(e<n?6:0))/6;break;case e:c=((n-t)/a+2)/6;break;case n:c=((t-e)/a+4)/6;break}return{h:c,s:l,l:i}}function rW(t,e,n=2e3){if(!t||!e||e.length<3)return{avgLightness:.5,avgContrastProxy:.5};const r=Math.floor(Math.min(...e.map(x=>x.x))),s=Math.ceil(Math.max(...e.map(x=>x.x))),i=Math.floor(Math.min(...e.map(x=>x.y))),a=Math.ceil(Math.max(...e.map(x=>x.y))),l=s-r,c=a-i;if(l<=0||c<=0)return{avgLightness:.5,avgContrastProxy:.5};let d;try{d=t.getImageData(r,i,l,c)}catch(x){return console.warn("[LIGHTING] Failed to get image data:",x),{avgLightness:.5,avgContrastProxy:.5}}const u=d.data,p=[];let h=0;const f=n*5;for(;p.length<n&&h<f;){h++;const x=r+Math.random()*l,b=i+Math.random()*c;if(!tW(x,b,e))continue;const w=Math.floor(x-r),_=(Math.floor(b-i)*l+w)*4;if(_<0||_>=u.length-3)continue;const k=u[_],E=u[_+1],T=u[_+2],{l:O}=nW(k,E,T);p.push(O)}if(p.length===0)return{avgLightness:.5,avgContrastProxy:.5};const m=p.reduce((x,b)=>x+b,0)/p.length,g=p.reduce((x,b)=>x+Math.pow(b-m,2),0)/p.length,v=Math.sqrt(g),y=Math.min(1,v/.25);return{avgLightness:m,avgContrastProxy:y}}function sW(t){let e=1,n=1;const s=t.avgLightness-.5;return e+=s*.6,n+=(t.avgContrastProxy-.5)*.4,e=Math.max(.7,Math.min(1.3,e)),n=Math.max(.8,Math.min(1.25,n)),{brightness:e,contrast:n}}const iW=100;function oW({photoUrl:t,svgUrl:e,designSizeMm:n,initialQuad:r,initialShape:s,initialOpacity:i=.8,initialLighting:a,onChange:l}){const[c,d]=R.useState(null),[u,p]=R.useState(null),[h,f]=R.useState(r||null),[m,g]=R.useState(s||null),[v,y]=R.useState(Math.max(.3,Math.min(1,i))),[x,b]=R.useState(a||{enabled:!1,strength:.6,baseBrightness:1,baseContrast:1}),[w,S]=R.useState(!0),[_,k]=R.useState(null),[E,T]=R.useState(1),[O,q]=R.useState("corners"),[P,W]=R.useState(null),[j,G]=R.useState(!1),[pe,Z]=R.useState(null),[ee,F]=R.useState(null),K=R.useRef(null),U=R.useRef(null),V=R.useRef(null),[J,oe]=R.useState([]),me=20;R.useEffect(()=>{je()},[t,e]),R.useEffect(()=>{c&&u&&h&&he()},[c,u,h,m,v,x,O,P,j,ee]),R.useEffect(()=>{if(!c||!h||h.length!==4)return;const M=document.createElement("canvas");M.width=c.naturalWidth,M.height=c.naturalHeight;const ie=M.getContext("2d");ie.drawImage(c,0,0);const fe=rW(ie,h),{brightness:Se,contrast:De}=sW(fe);b(ke=>({...ke,baseBrightness:Se,baseContrast:De}))},[c,JSON.stringify(h)]),R.useEffect(()=>{const M=ie=>{if(O==="shape"&&(ie.key==="Delete"||ie.key==="Backspace")&&ee!==null&&m&&m.length>3){ie.preventDefault();const fe=m.filter((Se,De)=>De!==ee);g(fe),F(null),Me(h,v,fe)}};return window.addEventListener("keydown",M),()=>window.removeEventListener("keydown",M)},[O,ee,m,h,v]);const je=async()=>{var M;console.log("[FOUR-POINT] Starting to load images - photo:",t==null?void 0:t.substring(0,50),"svg:",e==null?void 0:e.substring(0,50)),S(!0),k(null);try{console.log("[FOUR-POINT] Loading photo and rasterizing SVG...");const[ie,fe]=await Promise.all([Am(t),G_(e,1536)]);console.log("[FOUR-POINT] Both images loaded successfully - photo:",ie.naturalWidth,"x",ie.naturalHeight,"design:",fe.naturalWidth,"x",fe.naturalHeight),d(ie),p(fe);const Se=((M=U.current)==null?void 0:M.clientWidth)||800,De=500,ke=Se/ie.naturalWidth,ae=De/ie.naturalHeight,ue=Math.min(1,ke,ae);if(T(ue),console.log("[FOUR-POINT] Display scale set to:",ue.toFixed(3)),r)console.log("[FOUR-POINT] Using provided initial quad");else{const Ge=eW(ie.naturalWidth,ie.naturalHeight,n.width_mm,n.length_mm);f(Ge),console.log("[FOUR-POINT] Initialized default quad")}}catch(ie){console.error("[FOUR-POINT] Failed to load images:",ie),k(ie.message)}finally{S(!1),console.log("[FOUR-POINT] Loading complete")}},he=()=>{const M=K.current;if(!M||!c||!u||!h)return;M.width=c.naturalWidth,M.height=c.naturalHeight;const ie=M.getContext("2d");V_({photoCtx:ie,photoImg:c,designImg:u,quad:h,opacity:v,shape:m,lighting:x}),Ee(ie)},Ee=M=>{if(!h)return;M.setTransform(1,0,0,1,0,0);const ie=Math.max(8,Math.min(15,c.naturalWidth/80));if(O==="corners"){M.strokeStyle="rgba(255, 255, 255, 0.8)",M.lineWidth=2,M.setLineDash([5,5]),M.beginPath(),M.moveTo(h[0].x,h[0].y),M.lineTo(h[1].x,h[1].y),M.lineTo(h[2].x,h[2].y),M.lineTo(h[3].x,h[3].y),M.closePath(),M.stroke(),M.setLineDash([]);const fe=["TL","TR","BR","BL"];h.forEach((Se,De)=>{M.beginPath(),M.arc(Se.x,Se.y,ie,0,Math.PI*2),M.fillStyle=P===De?"#ff6b35":"rgba(255, 107, 53, 0.9)",M.fill(),M.strokeStyle="white",M.lineWidth=2,M.stroke(),M.fillStyle="white",M.font="10px sans-serif",M.textAlign="center",M.textBaseline="middle",M.fillText(fe[De],Se.x,Se.y)})}else{const fe=m||h;M.strokeStyle="rgba(34, 197, 94, 0.8)",M.lineWidth=2,M.setLineDash([]),M.beginPath(),M.moveTo(fe[0].x,fe[0].y);for(let Se=1;Se<fe.length;Se++)M.lineTo(fe[Se].x,fe[Se].y);M.closePath(),M.stroke(),fe.forEach((Se,De)=>{M.beginPath(),M.arc(Se.x,Se.y,ie*.8,0,Math.PI*2),ee===De?M.fillStyle="#22c55e":P===De?M.fillStyle="#16a34a":M.fillStyle="rgba(34, 197, 94, 0.9)",M.fill(),M.strokeStyle="white",M.lineWidth=2,M.stroke()}),M.strokeStyle="rgba(255, 107, 53, 0.3)",M.lineWidth=1,M.setLineDash([3,3]),M.beginPath(),M.moveTo(h[0].x,h[0].y),M.lineTo(h[1].x,h[1].y),M.lineTo(h[2].x,h[2].y),M.lineTo(h[3].x,h[3].y),M.closePath(),M.stroke(),M.setLineDash([])}},Me=R.useCallback((M,ie,fe,Se)=>{V.current&&clearTimeout(V.current),V.current=setTimeout(()=>{l&&l({quad:M,opacity:ie,shape:fe,lighting:Se||x})},iW)},[l,x]),We=R.useCallback(()=>{oe(M=>{const ie=[...M,{quad:[...h],shape:m?[...m]:null,opacity:v,lighting:{...x}}];return ie.length>me?ie.slice(-me):ie})},[h,m,v,x]),Ie=()=>{if(J.length===0)return;const M=J[J.length-1];oe(ie=>ie.slice(0,-1)),f(M.quad),g(M.shape),y(M.opacity),b(M.lighting),Me(M.quad,M.opacity,M.shape,M.lighting)},Je=(M,ie)=>({x:M/E,y:ie/E}),Ue=(M,ie,fe)=>{if(!fe)return-1;const Se=25/E;for(let De=0;De<fe.length;De++){const ke=fe[De].x-M,ae=fe[De].y-ie;if(Math.sqrt(ke*ke+ae*ae)<Se)return De}return-1},C=(M,ie,fe)=>{if(!fe||fe.length<3)return!1;let Se=!1;for(let De=0,ke=fe.length-1;De<fe.length;ke=De++){const ae=fe[De].x,ue=fe[De].y,Ge=fe[ke].x,Qe=fe[ke].y;ue>ie!=Qe>ie&&M<(Ge-ae)*(ie-ue)/(Qe-ue)+ae&&(Se=!Se)}return Se},Q=M=>{if(O!=="shape"||!m||m.length<=3)return;const ie=K.current;if(!ie)return;const fe=ie.getBoundingClientRect(),Se=M.clientX-fe.left,De=M.clientY-fe.top,{x:ke,y:ae}=Je(Se,De),ue=Ue(ke,ae,m);if(ue>=0){We();const Ge=m.filter((et,ht)=>ht!==ue);g(Ge),F(null);const Qe=I(h,Ge);Qe!==h?(f(Qe),Me(Qe,v,Ge)):Me(h,v,Ge)}},ce=M=>{const ie=K.current;if(!ie)return;const fe=ie.getBoundingClientRect(),Se=M.clientX-fe.left,De=M.clientY-fe.top,{x:ke,y:ae}=Je(Se,De);if(O==="corners"){const ue=Ue(ke,ae,h);ue>=0?(We(),W(ue),ie.setPointerCapture(M.pointerId)):C(ke,ae,h)&&(We(),G(!0),Z({x:ke,y:ae}),ie.setPointerCapture(M.pointerId))}else{const ue=m||h,Ge=Ue(ke,ae,ue);if(Ge>=0)We(),W(Ge),F(Ge),ie.setPointerCapture(M.pointerId);else{We();let Qe=0,et=1/0;for(let de=0;de<ue.length;de++){const ne=(de+1)%ue.length,ge=X(ke,ae,ue[de].x,ue[de].y,ue[ne].x,ue[ne].y);ge<et&&(et=ge,Qe=ne)}const ht={x:ke,y:ae},lt=[...ue];lt.splice(Qe,0,ht),g(lt),F(Qe);const Le=I(h,lt);Le!==h?(f(Le),Me(Le,v,lt)):Me(h,v,lt)}}},L=M=>{if(P===null&&!j)return;const ie=K.current;if(!ie)return;const fe=ie.getBoundingClientRect(),Se=M.clientX-fe.left,De=M.clientY-fe.top,{x:ke,y:ae}=Je(Se,De),ue=Math.max(0,Math.min(c.naturalWidth,ke)),Ge=Math.max(0,Math.min(c.naturalHeight,ae));if(O==="corners"){if(j&&pe){const Qe=ue-pe.x,et=Ge-pe.y,ht=h.map(Le=>({x:Math.max(0,Math.min(c.naturalWidth,Le.x+Qe)),y:Math.max(0,Math.min(c.naturalHeight,Le.y+et))}));let lt=m;m&&(lt=m.map(Le=>({x:Math.max(0,Math.min(c.naturalWidth,Le.x+Qe)),y:Math.max(0,Math.min(c.naturalHeight,Le.y+et))})),g(lt)),f(ht),Z({x:ue,y:Ge}),Me(ht,v,lt)}else if(P!==null){const Qe=[...h];Qe[P]={x:ue,y:Ge},f(Qe),Me(Qe,v,m)}}else{const et=[...m||h];et[P]={x:ue,y:Ge},g(et),Me(h,v,et)}},N=M=>{if(P!==null||j){const ie=K.current;if(ie&&ie.releasePointerCapture(M.pointerId),O==="shape"&&m&&P!==null){const fe=I(h,m);fe!==h&&(f(fe),Me(fe,v,m))}W(null),G(!1),Z(null)}},I=(M,ie)=>{if(!ie||ie.length<3||!M)return M;const fe=M.reduce((Le,de)=>Le+de.x,0)/4,Se=M.reduce((Le,de)=>Le+de.y,0)/4,De=ie.reduce((Le,de)=>Le+de.x,0)/ie.length,ke=ie.reduce((Le,de)=>Le+de.y,0)/ie.length;let ae=1;for(const Le of ie){const de=Le.x-fe,ne=Le.y-Se,ge=Math.sqrt(de*de+ne*ne);if(ge<1)continue;const He=H(fe,Se,de,ne,M);if(He>0&&ge>He){const mt=ge/He;ae=Math.max(ae,mt)}}let ue=1/0;for(const Le of ie){const de=Le.x-fe,ne=Le.y-Se,ge=Math.sqrt(de*de+ne*ne);if(ge<1)continue;const He=H(fe,Se,de,ne,M);if(He>0){const mt=ge/He;ue=Math.min(ue,mt)}}let Ge=ae;if(ae<=1&&ue<1/0&&(Ge=ue),Math.abs(Ge-1)<.01)return M;const Qe=M.map(Le=>({x:fe+(Le.x-fe)*Ge,y:Se+(Le.y-Se)*Ge})),et=De-fe,ht=ke-Se;return Qe.map(Le=>({x:Le.x+et,y:Le.y+ht}))},H=(M,ie,fe,Se,De)=>{let ke=1/0;for(let ae=0;ae<4;ae++){const ue=De[ae],Ge=De[(ae+1)%4],Qe=Ge.x-ue.x,et=Ge.y-ue.y,ht=fe*et-Se*Qe;if(Math.abs(ht)<1e-4)continue;const lt=((ue.x-M)*et-(ue.y-ie)*Qe)/ht,Le=((ue.x-M)*Se-(ue.y-ie)*fe)/ht;lt>0&&Le>=0&&Le<=1&&(ke=Math.min(ke,lt*Math.sqrt(fe*fe+Se*Se)))}return ke===1/0?0:ke},X=(M,ie,fe,Se,De,ke)=>{const ae=M-fe,ue=ie-Se,Ge=De-fe,Qe=ke-Se,et=ae*Ge+ue*Qe,ht=Ge*Ge+Qe*Qe;let lt=ht!==0?et/ht:-1,Le,de;return lt<0?(Le=fe,de=Se):lt>1?(Le=De,de=ke):(Le=fe+lt*Ge,de=Se+lt*Qe),Math.sqrt((M-Le)**2+(ie-de)**2)},z=()=>{O==="corners"?(m||g([...h]),q("shape"),F(null)):(q("corners"),F(null))},te=M=>{const ie=Math.max(.3,Math.min(1,parseFloat(M.target.value)/100));y(ie),Me(h,ie,m)},ye=M=>{const ie={...x,enabled:M.target.checked};b(ie),Me(h,v,m,ie)},Y=M=>{const ie={...x,strength:parseFloat(M.target.value)/100};b(ie),Me(h,v,m,ie)};return w?o.jsxs("div",{className:"four-point-editor loading",children:[o.jsx("div",{className:"spinner"}),o.jsx("p",{children:"Loading preview..."})]}):_?o.jsx("div",{className:"four-point-editor error",children:o.jsxs("p",{children:["Failed to load: ",_]})}):o.jsxs("div",{className:"four-point-editor",ref:U,children:[o.jsxs("div",{className:"editor-header",children:[o.jsxs("div",{className:"header-title",children:[o.jsx("h3",{children:"Position Your Design"}),o.jsx(Bf,{content:o.jsxs("div",{children:[o.jsxs("p",{children:[o.jsx("strong",{children:"Corners Mode:"})," Drag the 4 corner handles (TL, TR, BR, BL) to position your design with perspective. You can also drag inside the design to move all corners at once."]}),o.jsxs("p",{style:{marginTop:"0.5rem"},children:[o.jsx("strong",{children:"Refine Shape Mode:"})," Click anywhere to add new vertices for precise shape control. Drag existing vertices to adjust. Double-click or press Delete/Backspace on a vertex to remove it."]}),o.jsxs("p",{style:{marginTop:"0.5rem"},children:[o.jsx("strong",{children:"Overlay Opacity:"})," Adjust transparency to see how the design blends with your photo."]}),o.jsxs("p",{style:{marginTop:"0.5rem"},children:[o.jsx("strong",{children:"Match Floor Lighting:"})," Automatically adjusts design brightness to match your floor's lighting conditions."]})]}),position:"right"})]}),o.jsx("p",{className:"instructions",children:O==="corners"?"Drag the corner handles (TL, TR, BR, BL) to position the design. Drag inside to move all corners.":"Click to add vertices, drag to move them, double-click or press Delete to remove."})]}),o.jsx("div",{className:"canvas-container",children:o.jsx("canvas",{ref:K,onPointerDown:ce,onPointerMove:L,onPointerUp:N,onPointerLeave:N,onDoubleClick:Q,style:{width:`${((c==null?void 0:c.naturalWidth)||800)*E}px`,height:`${((c==null?void 0:c.naturalHeight)||600)*E}px`,cursor:P!==null||j?"grabbing":O==="shape"?"crosshair":"move",touchAction:"none"}})}),o.jsxs("div",{className:"controls",children:[o.jsxs("div",{className:"mode-toggle",children:[o.jsx("button",{className:`toggle-btn ${O==="corners"?"active":""}`,onClick:()=>q("corners"),children:"Corners"}),o.jsx("button",{className:`toggle-btn ${O==="shape"?"active":""}`,onClick:z,children:"Refine Shape"}),o.jsx("button",{className:"toggle-btn undo-btn",onClick:Ie,disabled:J.length===0,title:"Undo last change",children:"Undo"})]}),o.jsxs("div",{className:"opacity-control",children:[o.jsxs("label",{children:["Overlay Opacity",o.jsxs("span",{className:"value",children:[Math.round(v*100),"%"]})]}),o.jsx("input",{type:"range",min:"30",max:"100",value:Math.round(v*100),onChange:te})]}),o.jsxs("div",{className:"lighting-control",children:[o.jsxs("label",{className:"checkbox-label",children:[o.jsx("input",{type:"checkbox",checked:x.enabled,onChange:ye}),"Match floor lighting"]}),x.enabled&&o.jsxs("div",{className:"lighting-slider",children:[o.jsxs("label",{children:["Strength",o.jsxs("span",{className:"value",children:[Math.round(x.strength*100),"%"]})]}),o.jsx("input",{type:"range",min:"0",max:"100",value:Math.round(x.strength*100),onChange:Y})]})]})]}),o.jsx("style",{children:`
        .four-point-editor {
          display: flex;
          flex-direction: column;
          height: 100%;
        }

        .four-point-editor.loading,
        .four-point-editor.error {
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          min-height: 400px;
          color: #6b7280;
        }

        .four-point-editor .spinner {
          width: 40px;
          height: 40px;
          border: 3px solid #e5e7eb;
          border-top-color: #ff6b35;
          border-radius: 50%;
          animation: spin 0.8s linear infinite;
          margin-bottom: 1rem;
        }

        @keyframes spin {
          to { transform: rotate(360deg); }
        }

        .editor-header {
          padding-bottom: 1rem;
          border-bottom: 1px solid #e5e7eb;
          margin-bottom: 1rem;
        }

        .editor-header .header-title {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          margin-bottom: 0.5rem;
        }

        .editor-header h3 {
          margin: 0;
          font-size: 1.125rem;
          color: #1e4a7a;
        }

        .editor-header .instructions {
          margin: 0;
          font-size: 0.875rem;
          color: #6b7280;
        }

        .canvas-container {
          flex: 1;
          display: flex;
          align-items: center;
          justify-content: center;
          background: #f3f4f6;
          border-radius: 8px;
          overflow: hidden;
          min-height: 400px;
        }

        .canvas-container canvas {
          display: block;
        }

        .controls {
          padding-top: 1rem;
          border-top: 1px solid #e5e7eb;
          margin-top: 1rem;
          display: flex;
          flex-direction: column;
          gap: 1rem;
        }

        .mode-toggle {
          display: flex;
          gap: 0.5rem;
        }

        .toggle-btn {
          padding: 0.5rem 1rem;
          border: 1px solid #d1d5db;
          background: white;
          border-radius: 4px;
          font-size: 0.875rem;
          cursor: pointer;
          transition: all 0.2s;
        }

        .toggle-btn:hover {
          background: #f9fafb;
        }

        .toggle-btn.active {
          background: #ff6b35;
          color: white;
          border-color: #ff6b35;
        }

        .toggle-btn:disabled {
          opacity: 0.4;
          cursor: not-allowed;
        }

        .toggle-btn:disabled:hover {
          background: white;
        }

        .opacity-control {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .opacity-control label {
          display: flex;
          justify-content: space-between;
          font-size: 0.875rem;
          font-weight: 500;
          color: #374151;
        }

        .opacity-control .value {
          font-weight: 400;
          color: #6b7280;
        }

        .opacity-control input[type="range"] {
          width: 100%;
          height: 6px;
          border-radius: 3px;
          background: #e5e7eb;
          outline: none;
          -webkit-appearance: none;
        }

        .opacity-control input[type="range"]::-webkit-slider-thumb {
          -webkit-appearance: none;
          width: 16px;
          height: 16px;
          border-radius: 50%;
          background: #ff6b35;
          cursor: pointer;
        }

        .lighting-control {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .checkbox-label {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          font-size: 0.875rem;
          font-weight: 500;
          color: #374151;
          cursor: pointer;
        }

        .checkbox-label input[type="checkbox"] {
          width: 16px;
          height: 16px;
          cursor: pointer;
        }

        .lighting-slider {
          display: flex;
          flex-direction: column;
          gap: 0.25rem;
          padding-left: 1.5rem;
        }

        .lighting-slider label {
          display: flex;
          justify-content: space-between;
          font-size: 0.8rem;
          color: #6b7280;
        }

        .lighting-slider .value {
          font-weight: 400;
        }

        .lighting-slider input[type="range"] {
          width: 100%;
          height: 6px;
          border-radius: 3px;
          background: #e5e7eb;
          outline: none;
          -webkit-appearance: none;
        }

        .lighting-slider input[type="range"]::-webkit-slider-thumb {
          -webkit-appearance: none;
          width: 14px;
          height: 14px;
          border-radius: 50%;
          background: #22c55e;
          cursor: pointer;
        }
      `})]})}const Br={UPLOAD:"upload",POSITION:"position"};function Y_({designUrl:t,designDimensions:e,onClose:n,onSaved:r}){const[s,i]=R.useState(Br.UPLOAD),[a,l]=R.useState(null),[c,d]=R.useState(null),[u,p]=R.useState(null),[h,f]=R.useState(.8),[m,g]=R.useState({enabled:!1,strength:.6,baseBrightness:1,baseContrast:1}),[v,y]=R.useState(!1),x=R.useRef(null);R.useEffect(()=>{if(t){console.log("[IN-SITU-MODAL] Design URL received:",t==null?void 0:t.substring(0,50));const T=new Image;!t.startsWith("blob:")&&!t.startsWith("data:")&&(T.crossOrigin="anonymous"),T.src=t}else console.warn("[IN-SITU-MODAL] No design URL provided")},[t]);const b=T=>{console.log("[IN-SITU-MODAL] Photo uploaded:",T),l(T),console.log("[IN-SITU-MODAL] Advancing to POSITION step, designUrl:",t==null?void 0:t.substring(0,50)),i(Br.POSITION)},w=({quad:T,opacity:O,shape:q,lighting:P})=>{d(T),f(O),p(q),P&&g(P)},S=async()=>{if(!a||!c)return null;try{console.log("[InSitu] Loading design from URL:",t);const[T,O]=await Promise.all([Am(a.url),G_(t,1536)]);console.log("[InSitu] Successfully loaded design image");const q=document.createElement("canvas");q.width=T.naturalWidth,q.height=T.naturalHeight;const P=q.getContext("2d");return V_({photoCtx:P,photoImg:T,designImg:O,quad:c,opacity:h,shape:u,lighting:m}),q}catch(T){return console.error("[InSitu] Failed to generate canvas:",T),alert(`Failed to load design: ${T.message}`),null}},_=async()=>{const T=await S();T&&Q9(T,"tpv-in-situ-preview.png")},k=async()=>{if(!(!c||!a)){y(!0);try{const T=await S();if(!T)throw new Error("Failed to generate preview");const O=await new Promise(G=>T.toBlob(G,"image/png")),P=`in-situ-previews/${`${Date.now()}-${Math.random().toString(36).substr(2,9)}.png`}`,{error:W}=await an.storage.from("tpv-studio-uploads").upload(P,O,{contentType:"image/png",cacheControl:"3600"});if(W)throw W;const{data:{publicUrl:j}}=an.storage.from("tpv-studio-uploads").getPublicUrl(P);r&&r({photo_url:a.supabaseUrl||a.url,quad:c,shape:u,opacity:h,lighting:m,preview_url:j}),n()}catch(T){console.error("[IN-SITU] Save failed:",T),alert("Failed to save preview: "+T.message)}finally{y(!1)}}},E=()=>{switch(s){case Br.UPLOAD:return"Upload Site Photo";case Br.POSITION:return"Position Your Design";default:return"In-Situ Preview"}};return o.jsxs("div",{className:"modal-overlay in-situ-modal-overlay",onClick:n,children:[o.jsxs("div",{className:"modal-content in-situ-modal",onClick:T=>T.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsxs("div",{className:"header-left",children:[o.jsx("h2",{children:E()}),o.jsxs("div",{className:"step-indicator",children:[o.jsx("span",{className:s===Br.UPLOAD?"active":"completed",children:"1. Upload"}),o.jsx("span",{className:s===Br.POSITION?"active":"",children:"2. Position"})]})]}),o.jsx("button",{onClick:n,className:"close-button",children:""})]}),o.jsxs("div",{className:"modal-body",children:[s===Br.UPLOAD&&o.jsxs("div",{className:"upload-step",children:[o.jsx("p",{className:"step-description",children:"Upload a photo of your site to see how your TPV design will look when installed. For best results, use a photo taken from above or at a slight angle showing the floor area clearly."}),o.jsx(Z9,{onPhotoUploaded:b})]}),s===Br.POSITION&&a&&o.jsx(oW,{ref:x,photoUrl:a.url,svgUrl:t,designSizeMm:{width_mm:e.width,length_mm:e.length},initialOpacity:.8,onChange:w})]}),s===Br.POSITION&&o.jsxs("div",{className:"modal-footer",children:[o.jsx("button",{onClick:()=>i(Br.UPLOAD),className:"btn-secondary",children:"Back"}),o.jsxs("div",{className:"footer-actions",children:[o.jsx("button",{onClick:_,disabled:!c,className:"btn-secondary",children:"Download PNG"}),o.jsx("button",{onClick:k,disabled:!c||v,className:"btn-primary",children:v?"Saving...":"Save to Project"})]})]})]}),o.jsx("style",{children:`
        .in-situ-modal-overlay {
          position: fixed;
          inset: 0;
          background: rgba(0, 0, 0, 0.6);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 1000;
          padding: 1rem;
        }

        .in-situ-modal {
          background: white;
          border-radius: 12px;
          width: 100%;
          max-width: 1000px;
          max-height: 90vh;
          display: flex;
          flex-direction: column;
          box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .in-situ-modal .modal-header {
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
          padding: 1.25rem 1.5rem;
          border-bottom: 1px solid #e5e7eb;
        }

        .header-left {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .in-situ-modal .modal-header h2 {
          margin: 0;
          font-size: 1.25rem;
          color: #1e4a7a;
        }

        .step-indicator {
          display: flex;
          gap: 1rem;
          font-size: 0.75rem;
        }

        .step-indicator span {
          color: #9ca3af;
          padding: 0.25rem 0.5rem;
          border-radius: 4px;
        }

        .step-indicator span.active {
          background: #fff7f5;
          color: #ff6b35;
          font-weight: 500;
        }

        .step-indicator span.completed {
          color: #22c55e;
        }

        .close-button {
          background: none;
          border: none;
          font-size: 1.5rem;
          cursor: pointer;
          color: #9ca3af;
          padding: 0;
          line-height: 1;
        }

        .close-button:hover {
          color: #374151;
        }

        .modal-body {
          flex: 1;
          padding: 1.5rem;
          overflow-y: auto;
          min-height: 500px;
        }

        .upload-step {
          display: flex;
          flex-direction: column;
          gap: 1.5rem;
        }

        .step-description {
          margin: 0;
          font-size: 0.875rem;
          color: #6b7280;
          line-height: 1.6;
        }

        .modal-footer {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 1rem 1.5rem;
          border-top: 1px solid #e5e7eb;
          background: #f9fafb;
          border-radius: 0 0 12px 12px;
        }

        .footer-actions {
          display: flex;
          gap: 0.5rem;
        }

        .btn-primary,
        .btn-secondary {
          padding: 0.5rem 1rem;
          border-radius: 4px;
          font-size: 0.875rem;
          font-weight: 500;
          cursor: pointer;
          transition: all 0.2s;
          border: none;
        }

        .btn-primary {
          background: #ff6b35;
          color: white;
        }

        .btn-primary:hover:not(:disabled) {
          background: #e55a2b;
        }

        .btn-primary:disabled {
          background: #d1d5db;
          cursor: not-allowed;
        }

        .btn-secondary {
          background: white;
          color: #374151;
          border: 1px solid #d1d5db;
        }

        .btn-secondary:hover:not(:disabled) {
          background: #f9fafb;
        }

        .btn-secondary:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
          .in-situ-modal {
            max-width: 100%;
            max-height: 100vh;
            border-radius: 0;
          }

          .modal-body {
            padding: 1rem;
          }

          .step-indicator {
            display: none;
          }

          .modal-footer {
            border-radius: 0;
          }
        }
      `})]})}function aW({isOpen:t,onClose:e,onConfirm:n,aspectRatio:r,defaultLongestSide:s=5e3}){const[i,a]=R.useState(s),[l,c]=R.useState(s/1e3),u=(g=>{if(!r||r<=0)return{width:g,length:g};if(r>=1){const v=g,y=Math.round(g/r);return{width:v,length:y}}else{const v=g;return{width:Math.round(g*r),length:v}}})(i),p=r>=1?"landscape":"portrait",h=r>=1?`${r.toFixed(1)}:1`:`1:${(1/r).toFixed(1)}`,f=g=>{const v=parseFloat(g.target.value)||0;c(v),a(Math.round(v*1e3))},m=()=>{n(u.width,u.length),e()};return t?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"dimension-modal-overlay",onClick:e,children:o.jsxs("div",{className:"dimension-modal",onClick:g=>g.stopPropagation(),children:[o.jsxs("div",{className:"dimension-modal-header",children:[o.jsxs("div",{className:"dimension-modal-title",children:[o.jsx("h2",{children:"Set Installation Size"}),o.jsx(Bf,{content:o.jsxs("div",{children:[o.jsx("p",{children:o.jsx("strong",{children:"Why specify dimensions?"})}),o.jsx("p",{style:{marginTop:"0.5rem"},children:"Accurate dimensions are essential for:"}),o.jsxs("ul",{style:{marginTop:"0.5rem",marginBottom:0,paddingLeft:"1.25rem"},children:[o.jsx("li",{children:"Calculating exact material quantities"}),o.jsx("li",{children:"Generating PDF specifications for manufacturers"}),o.jsx("li",{children:"Slicing designs into 1m1m installation tiles"})]}),o.jsxs("p",{style:{marginTop:"0.5rem"},children:[o.jsx("strong",{children:"Tip:"})," Typical playground installations range from 3m to 20m on the longest side."]})]}),position:"bottom"})]}),o.jsx("button",{className:"dimension-modal-close",onClick:e,"aria-label":"Close",children:""})]}),o.jsxs("div",{className:"dimension-modal-body",children:[o.jsx("div",{className:"dimension-info",children:o.jsxs("p",{className:"dimension-aspect",children:["Your design has a ",o.jsxs("strong",{children:[h," ",p]})," aspect ratio"]})}),o.jsxs("div",{className:"dimension-input-group",children:[o.jsx("label",{htmlFor:"longest-dimension",children:"Installation Size (Longest Side)"}),o.jsxs("div",{className:"dimension-input-wrapper",children:[o.jsx("input",{id:"longest-dimension",type:"number",min:"0.1",max:"50",step:"0.1",value:l,onChange:f,className:"dimension-input"}),o.jsx("span",{className:"dimension-unit",children:"meters"})]}),o.jsx("p",{className:"dimension-help",children:"Enter the measurement of the longest side of your installation area. The other dimension will be calculated automatically based on your design's aspect ratio."})]}),o.jsxs("div",{className:"dimension-preview",children:[o.jsx("div",{className:"dimension-preview-title",children:"Calculated Dimensions:"}),o.jsxs("div",{className:"dimension-preview-values",children:[o.jsxs("div",{className:"dimension-preview-item",children:[o.jsx("span",{className:"dimension-preview-label",children:"Width:"}),o.jsxs("span",{className:"dimension-preview-value",children:[(u.width/1e3).toFixed(2),"m"]})]}),o.jsxs("div",{className:"dimension-preview-item",children:[o.jsx("span",{className:"dimension-preview-label",children:"Length:"}),o.jsxs("span",{className:"dimension-preview-value",children:[(u.length/1e3).toFixed(2),"m"]})]}),o.jsxs("div",{className:"dimension-preview-item",children:[o.jsx("span",{className:"dimension-preview-label",children:"Total Area:"}),o.jsxs("span",{className:"dimension-preview-value",children:[(u.width*u.length/1e6).toFixed(2),"m"]})]})]})]}),o.jsxs("div",{className:"dimension-note",children:[o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"8",cy:"8",r:"7"}),o.jsx("line",{x1:"8",y1:"11",x2:"8",y2:"8"}),o.jsx("circle",{cx:"8",cy:"5",r:"0.5",fill:"currentColor"})]}),o.jsx("p",{children:"These dimensions will be used to calculate material quantities for your PDF specification and to slice your design into 1m1m installation tiles."})]})]}),o.jsxs("div",{className:"dimension-modal-footer",children:[o.jsx("button",{className:"dimension-btn dimension-btn-secondary",onClick:e,children:"Cancel"}),o.jsx("button",{className:"dimension-btn dimension-btn-primary",onClick:m,disabled:l<=0,children:"Confirm Size"})]})]})}),o.jsx("style",{children:`
        .dimension-modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.6);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 10000;
        padding: 20px;
        backdrop-filter: blur(4px);
      }

      .dimension-modal {
        background: white;
        border-radius: 16px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        max-width: 500px;
        width: 100%;
        max-height: 90vh;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        animation: dimensionModalSlideIn 0.3s ease-out;
      }

      @keyframes dimensionModalSlideIn {
        from {
          opacity: 0;
          transform: translateY(-20px) scale(0.95);
        }
        to {
          opacity: 1;
          transform: translateY(0) scale(1);
        }
      }

      .dimension-modal-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 24px;
        border-bottom: 1px solid #e5e7eb;
      }

      .dimension-modal-title {
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .dimension-modal-header h2 {
        margin: 0;
        font-size: 1.5rem;
        font-weight: 600;
        color: #111827;
      }

      .dimension-modal-close {
        background: none;
        border: none;
        font-size: 2rem;
        line-height: 1;
        color: #9ca3af;
        cursor: pointer;
        padding: 0;
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 8px;
        transition: all 0.2s;
      }

      .dimension-modal-close:hover {
        background: #f3f4f6;
        color: #111827;
      }

      .dimension-modal-body {
        padding: 24px;
        overflow-y: auto;
        flex: 1;
      }

      .dimension-info {
        background: #f0f9ff;
        border: 1px solid #bae6fd;
        border-radius: 12px;
        padding: 16px;
        margin-bottom: 24px;
      }

      .dimension-aspect {
        margin: 0;
        color: #0c4a6e;
        font-size: 0.95rem;
        line-height: 1.5;
      }

      .dimension-input-group {
        margin-bottom: 24px;
      }

      .dimension-input-group label {
        display: block;
        font-weight: 600;
        color: #374151;
        margin-bottom: 8px;
        font-size: 0.95rem;
      }

      .dimension-input-wrapper {
        position: relative;
        display: flex;
        align-items: center;
      }

      .dimension-input {
        width: 100%;
        padding: 12px 16px;
        padding-right: 70px;
        font-size: 1.1rem;
        border: 2px solid #d1d5db;
        border-radius: 10px;
        transition: all 0.2s;
        font-family: inherit;
      }

      .dimension-input:focus {
        outline: none;
        border-color: #3b82f6;
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
      }

      .dimension-unit {
        position: absolute;
        right: 16px;
        color: #6b7280;
        font-weight: 500;
        pointer-events: none;
      }

      .dimension-help {
        margin: 8px 0 0 0;
        font-size: 0.85rem;
        color: #6b7280;
      }

      .dimension-preview {
        background: #f9fafb;
        border: 1px solid #e5e7eb;
        border-radius: 12px;
        padding: 20px;
        margin-bottom: 24px;
      }

      .dimension-preview-title {
        font-weight: 600;
        color: #374151;
        margin-bottom: 16px;
        font-size: 0.95rem;
      }

      .dimension-preview-values {
        display: flex;
        flex-direction: column;
        gap: 12px;
      }

      .dimension-preview-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 12px;
        background: white;
        border-radius: 8px;
      }

      .dimension-preview-label {
        color: #6b7280;
        font-size: 0.9rem;
      }

      .dimension-preview-value {
        font-weight: 600;
        color: #111827;
        font-size: 1.05rem;
      }

      .dimension-note {
        display: flex;
        gap: 12px;
        padding: 16px;
        background: #fffbeb;
        border: 1px solid #fde68a;
        border-radius: 10px;
      }

      .dimension-note svg {
        flex-shrink: 0;
        margin-top: 2px;
        color: #f59e0b;
      }

      .dimension-note p {
        margin: 0;
        font-size: 0.85rem;
        color: #78350f;
        line-height: 1.5;
      }

      .dimension-modal-footer {
        padding: 20px 24px;
        border-top: 1px solid #e5e7eb;
        display: flex;
        gap: 12px;
        justify-content: flex-end;
      }

      .dimension-btn {
        padding: 10px 24px;
        border-radius: 8px;
        font-weight: 600;
        font-size: 0.95rem;
        cursor: pointer;
        transition: all 0.2s;
        border: none;
        font-family: inherit;
      }

      .dimension-btn-secondary {
        background: white;
        border: 1px solid #d1d5db;
        color: #374151;
      }

      .dimension-btn-secondary:hover {
        background: #f9fafb;
        border-color: #9ca3af;
      }

      .dimension-btn-primary {
        background: #3b82f6;
        color: white;
      }

      .dimension-btn-primary:hover {
        background: #2563eb;
        box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
      }

      .dimension-btn-primary:disabled {
        background: #9ca3af;
        cursor: not-allowed;
        box-shadow: none;
      }

      @media (max-width: 640px) {
        .dimension-modal {
          max-width: none;
          width: 100%;
          margin: 0;
          max-height: 100vh;
          border-radius: 0;
        }

        .dimension-modal-header {
          padding: 20px;
        }

        .dimension-modal-header h2 {
          font-size: 1.25rem;
        }

        .dimension-modal-body {
          padding: 20px;
        }

        .dimension-modal-footer {
          flex-direction: column-reverse;
          padding: 16px 20px;
        }

        .dimension-btn {
          width: 100%;
        }
      }
      `})]}):null}function lW(t,e,n){return"#"+[t,e,n].map(r=>r.toString(16).padStart(2,"0")).join("").toUpperCase()}async function cW(t,e={}){const{canvasSize:n=500,ignoreWhite:r=!0,ignoreTransparent:s=!0}=e;return new Promise((i,a)=>{const l=document.createElement("canvas");l.width=n,l.height=n;const c=l.getContext("2d",{willReadFrequently:!0}),d=new Image,u=new Blob([t],{type:"image/svg+xml"}),p=URL.createObjectURL(u);d.onload=()=>{try{c.clearRect(0,0,n,n);const h=Math.min(n/d.width,n/d.height),f=d.width*h,m=d.height*h,g=(n-f)/2,v=(n-m)/2;c.drawImage(d,g,v,f,m);const x=c.getImageData(0,0,n,n).data,b=new Map;let w=0;for(let _=0;_<x.length;_+=4){const k=x[_],E=x[_+1],T=x[_+2],O=x[_+3];if(s&&O<128||r&&k>250&&E>250&&T>250)continue;const q=lW(k,E,T),P=b.get(q)||0;b.set(q,P+1),w++}const S=new Map;for(const[_,k]of b)S.set(_,{coverage:w>0?k/w*100:0,pixelCount:k});URL.revokeObjectURL(p),i(S)}catch(h){URL.revokeObjectURL(p),a(h)}},d.onerror=h=>{URL.revokeObjectURL(p),a(new Error("Failed to load SVG for coverage analysis"))},d.src=p})}function Ei(t){if(!t)return null;let e=t.replace("#","").toUpperCase();return e.length===3&&(e=e.split("").map(n=>n+n).join("")),"#"+e}function dW(t,e=10){const n=Array.from(t.entries()),r=new Map,s=new Set;for(const[i,a]of n){if(s.has(i))continue;let l=a.coverage,c=a.pixelCount;const d=Ix(i);for(const[u,p]of n){if(i===u||s.has(u))continue;const h=Ix(u);Math.max(Math.abs(d.r-h.r),Math.abs(d.g-h.g),Math.abs(d.b-h.b))<=e&&(l+=p.coverage,c+=p.pixelCount,s.add(u))}s.add(i),r.set(i,{coverage:l,pixelCount:c})}return r}function Ix(t){const e=t.replace("#","");return{r:parseInt(e.substring(0,2),16),g:parseInt(e.substring(2,4),16),b:parseInt(e.substring(4,6),16)}}async function uW(t,e={}){try{const r=await(await fetch(t)).text();return cW(r,e)}catch(n){throw console.error("[CoverageAnalyzer] Failed to fetch SVG from URL:",n),n}}const hW=[{code:"RH01",name:"Standard Red",hex:"#A5362F"},{code:"RH02",name:"Bright Red",hex:"#E21F2F"},{code:"RH10",name:"Standard Green",hex:"#609B63"},{code:"RH11",name:"Bright Green",hex:"#3BB44A"},{code:"RH12",name:"Dark Green",hex:"#006C55"},{code:"RH20",name:"Standard Blue",hex:"#0075BC"},{code:"RH21",name:"Purple",hex:"#493D8C"},{code:"RH22",name:"Light Blue",hex:"#47AFE3"},{code:"RH23",name:"Azure",hex:"#039DC4"},{code:"RH26",name:"Turquoise",hex:"#00A6A3"},{code:"RH30",name:"Standard Beige",hex:"#E4C4AA"},{code:"RH31",name:"Cream",hex:"#E8E3D8"},{code:"RH32",name:"Brown",hex:"#8B5F3C"},{code:"RH90",name:"Funky Pink",hex:"#E8457E"},{code:"RH40",name:"Mustard Yellow",hex:"#E5A144"},{code:"RH41",name:"Bright Yellow",hex:"#FFD833"},{code:"RH50",name:"Orange",hex:"#F15B32"},{code:"RH60",name:"Dark Grey",hex:"#59595B"},{code:"RH61",name:"Light Grey",hex:"#939598"},{code:"RH65",name:"Pale Grey",hex:"#D9D9D6"},{code:"RH70",name:"Black",hex:"#231F20"}];function pW(t){if(!t)return null;const e=Ei(t);return hW.find(n=>Ei(n.hex)===e)||null}function zx(t){const e=t.replace("#","");return{r:parseInt(e.substring(0,2),16),g:parseInt(e.substring(2,4),16),b:parseInt(e.substring(4,6),16)}}function Fx(t,e,n=10){const r=Ei(e);if(!r)return 0;for(const[l,c]of t)if(Ei(l)===r)return c.coverage;const s=zx(r);let i=null,a=1/0;for(const[l,c]of t){const d=zx(Ei(l)),u=Math.max(Math.abs(s.r-d.r),Math.abs(s.g-d.g),Math.abs(s.b-d.b));u<=n&&u<a&&(a=u,i=c)}return i?i.coverage:0}async function Bx(t,e,n,r="solid"){var s,i;if(!t||!e)return e||[];try{const a=await uW(t,{canvasSize:600,ignoreWhite:!0,ignoreTransparent:!0}),l=dW(a,5);console.log("[deriveCurrentColors] Coverage analysis:",l);const c=new Map;n&&n.size>0&&n.forEach(p=>{const h=typeof p=="string"?p:p.hex,f=Ei(h);f&&h!=="transparent"&&h!=="none"&&(!c.has(f)||p.tpvCode)&&c.set(f,{hex:f,tpvCode:p.tpvCode||null,tpvName:p.tpvName||null,editType:p.editType||"unknown",blendComponents:p.blendComponents||null})});const d=new Map;for(const p of e){const h=Ei(((s=p.blendColor)==null?void 0:s.hex)||((i=p.targetColor)==null?void 0:i.hex));if(!h)continue;const f=Fx(l,h,10);f>.1&&d.set(h,{...p,targetColor:{...p.targetColor,areaPct:f}})}for(const[p,h]of c)if(!d.has(p)){const f=Fx(l,p,10);if(f>.1){const m=h.tpvCode?{code:h.tpvCode,name:h.tpvName}:pW(p);d.set(p,{originalColor:{hex:p},targetColor:{hex:p,areaPct:f},blendColor:{hex:p},chosenRecipe:h.blendComponents?{components:h.blendComponents,deltaE:0,quality:"Custom Blend"}:{components:m?[{code:m.code,name:m.name,percentage:100,parts:10}]:[{code:"CUSTOM",name:"Custom Color",percentage:100,parts:10}],deltaE:0,quality:m?"Pure TPV Colour":"Custom"},tpvCode:h.tpvCode||(m==null?void 0:m.code)||null,tpvName:h.tpvName||(m==null?void 0:m.name)||null,isAddedFromEdit:!0})}}const u=Array.from(d.values()).sort((p,h)=>{var f,m;return(((f=h.targetColor)==null?void 0:f.areaPct)||0)-(((m=p.targetColor)==null?void 0:m.areaPct)||0)});return console.log("[deriveCurrentColors] Derived colors:",u.length,"colors"),u}catch(a){return console.error("[deriveCurrentColors] Failed to analyze coverage:",a),e}}function fW(t){if(!t||t.size===0)return!1;for(const e of t.values()){const n=typeof e=="string"?e:e.hex;if(n&&n!=="transparent"&&n!=="none")return!0}return!1}const Hx={landscape:[{name:"1:1",ratio:1,width:1024,height:1024},{name:"4:3",ratio:4/3,width:1024,height:768},{name:"3:2",ratio:3/2,width:1024,height:683},{name:"16:9",ratio:16/9,width:1024,height:576},{name:"2:1",ratio:2,width:1024,height:512},{name:"3:1",ratio:3,width:1024,height:341}],portrait:[{name:"1:1",ratio:1,width:1024,height:1024},{name:"3:4",ratio:3/4,width:768,height:1024},{name:"2:3",ratio:2/3,width:683,height:1024},{name:"9:16",ratio:9/16,width:576,height:1024},{name:"1:2",ratio:1/2,width:512,height:1024},{name:"1:3",ratio:1/3,width:341,height:1024}]},Aa={safeDifference:.3,tilingThreshold:3.5,framingThreshold:2.5};function mW(t,e){return t/e}function gW(t){return t>=.95&&t<=1.05?"square":t>1?"landscape":"portrait"}function yW(t,e){const n=e==="portrait"?Hx.portrait:Hx.landscape;let r=n[0],s=Math.abs(t-r.ratio);for(const i of n){const a=Math.abs(t-i.ratio);a<s&&(s=a,r=i)}return{...r,difference:s}}function xW(t,e,n){return t>=Aa.tilingThreshold||t<=1/Aa.tilingThreshold?{mode:"tiling",reason:"Extreme aspect ratio - design will repeat along length",warning:!0}:n>=Aa.safeDifference||t>=Aa.framingThreshold||t<=1/Aa.framingThreshold?{mode:"framing",reason:"Design panel centered with base color surround",warning:!1}:{mode:"full",reason:"Design fills entire surface",warning:!1}}function vW(t,e){const n=mW(t,e),r=gW(n),s=yW(n,r),i=xW(n,s.ratio,s.difference);return{user:{widthMM:t,heightMM:e,aspectRatio:n,orientation:r,formatted:`${(t/1e3).toFixed(1)}m  ${(e/1e3).toFixed(1)}m`},canonical:{name:s.name,ratio:s.ratio,width:s.width,height:s.height,difference:s.difference},layout:i,recraft:{width:s.width,height:s.height,metadata:{targetWidthMM:t,targetHeightMM:e,layoutMode:i.mode}}}}function bW(t){const{user:e,canonical:n,layout:r}=t;let s=`Generating ${n.name} design panel`;return r.mode==="full"?s+=` (fills ${e.formatted} surface)`:r.mode==="framing"?s+=` (centered in ${e.formatted} surface with base color surround)`:r.mode==="tiling"&&(s+=` (will repeat along ${e.formatted} surface)`),s}function wW(t){return t.layout.warning||t.layout.mode!=="full"}async function _W(t,e="tpv-studio-uploads"){try{const n=Date.now(),r=Math.random().toString(36).substring(7),s=t.name.split(".").pop(),a=`uploads/${`${n}-${r}.${s}`}`;console.log("[Upload] Uploading file:",t.name,"",a);const{data:l,error:c}=await an.storage.from(e).upload(a,t,{cacheControl:"3600",upsert:!1});if(c)return console.error("[Upload] Error:",c),{success:!1,error:c.message||"Failed to upload file"};const{data:{publicUrl:d}}=an.storage.from(e).getPublicUrl(a);return console.log("[Upload] Success:",d),{success:!0,url:d,path:a}}catch(n){return console.error("[Upload] Unexpected error:",n),{success:!1,error:n.message||"Unexpected error during upload"}}}function Ux(t,e={}){const{maxSizeMB:n=10,allowedTypes:r=["image/png","image/jpeg","image/svg+xml"]}=e;if(!t)return{valid:!1,error:"No file selected"};if(!r.includes(t.type))return{valid:!1,error:`Invalid file type. Allowed: ${r.map(a=>a.split("/")[1].toUpperCase()).join(", ")}`};const s=n*1024*1024;return t.size>s?{valid:!1,error:`File too large. Maximum size: ${n}MB`}:{valid:!0}}function SW({onExportSVG:t,onExportPNG:e,onExportPDF:n,onExportTiles:r,onExportDXF:s,onExportCanvasPDF:i,viewMode:a,exporting:l,disabled:c}){const[d,u]=R.useState(!1),p=R.useRef(null);R.useEffect(()=>{const m=g=>{p.current&&!p.current.contains(g.target)&&u(!1)};return d&&document.addEventListener("mousedown",m),()=>document.removeEventListener("mousedown",m)},[d]);const h=a==="solid"?"Solid":"Blend",f=m=>{u(!1),m()};return o.jsxs("div",{className:"playground-export-menu",ref:p,children:[o.jsxs("button",{className:"action-bar__btn action-bar__btn--export",onClick:()=>u(!d),disabled:c||l,children:[o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"}),o.jsx("polyline",{points:"7 10 12 15 17 10"}),o.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),l?"Exporting...":"Export",o.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{marginLeft:"0.25rem"},children:o.jsx("path",{d:d?"M18 15l-6-6-6 6":"M6 9l6 6 6-6"})})]}),d&&o.jsxs("div",{className:"playground-export-menu__dropdown",children:[o.jsxs("button",{className:"playground-export-menu__item",onClick:()=>f(t),children:[o.jsx("span",{className:"playground-export-menu__icon",children:""}),o.jsxs("div",{className:"playground-export-menu__content",children:[o.jsxs("span",{className:"playground-export-menu__title",children:["Download ",h," SVG"]}),o.jsx("span",{className:"playground-export-menu__desc",children:"Vector format for CAD/printing"})]})]}),o.jsxs("button",{className:"playground-export-menu__item",onClick:()=>f(e),children:[o.jsx("span",{className:"playground-export-menu__icon",children:""}),o.jsxs("div",{className:"playground-export-menu__content",children:[o.jsxs("span",{className:"playground-export-menu__title",children:["Download ",h," PNG"]}),o.jsx("span",{className:"playground-export-menu__desc",children:"High-res image for presentations"})]})]}),o.jsxs("button",{className:"playground-export-menu__item",onClick:()=>f(r),children:[o.jsx("span",{className:"playground-export-menu__icon",children:""}),o.jsxs("div",{className:"playground-export-menu__content",children:[o.jsx("span",{className:"playground-export-menu__title",children:"Download Tiles ZIP"}),o.jsx("span",{className:"playground-export-menu__desc",children:"1m1m SVG tiles for large printing"})]})]}),o.jsx("div",{className:"playground-export-menu__divider"}),o.jsxs("button",{className:"playground-export-menu__item",onClick:()=>f(n),children:[o.jsx("span",{className:"playground-export-menu__icon",children:""}),o.jsxs("div",{className:"playground-export-menu__content",children:[o.jsxs("span",{className:"playground-export-menu__title",children:[h," Recipe Report (PDF)"]}),o.jsx("span",{className:"playground-export-menu__desc",children:"TPV quantities & specifications"})]})]}),i&&o.jsxs("button",{className:"playground-export-menu__item",onClick:()=>f(i),children:[o.jsx("span",{className:"playground-export-menu__icon",children:""}),o.jsxs("div",{className:"playground-export-menu__content",children:[o.jsx("span",{className:"playground-export-menu__title",children:"Canvas PDF (1:100)"}),o.jsx("span",{className:"playground-export-menu__desc",children:"Scaled design with dimensions"})]})]}),s&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"playground-export-menu__divider"}),o.jsxs("button",{className:"playground-export-menu__item",onClick:()=>f(s),children:[o.jsx("span",{className:"playground-export-menu__icon",children:""}),o.jsxs("div",{className:"playground-export-menu__content",children:[o.jsx("span",{className:"playground-export-menu__title",children:"Download DXF"}),o.jsx("span",{className:"playground-export-menu__desc",children:"CAD format for AutoCAD/Rhino"})]})]})]})]})]})}function Ma(t){var n;if(!t)return null;if(t.type==="image/svg+xml")return"svg";if(t.type==="image/png"||t.type==="image/jpeg")return"image";const e=(n=t.name.split(".").pop())==null?void 0:n.toLowerCase();return e==="svg"?"svg":["png","jpg","jpeg"].includes(e)?"image":null}function kW({loadedDesign:t,onDesignSaved:e,isEmbedded:n=!1}){const r=yd(),{inputMode:s,prompt:i,lengthMM:a,widthMM:l,arMapping:c,uploadedFileUrl:d,result:u,jobId:p,blendRecipes:h,colorMapping:f,blendSvgUrl:m,blendEditedColors:g,solidRecipes:v,solidColorMapping:y,solidSvgUrl:x,solidEditedColors:b,viewMode:w,showFinalRecipes:S,showSolidSummary:_,regionOverrides:k,originalTaggedSvg:E,regionOverridesHistory:T,historyIndex:O,designName:q,currentDesignId:P,hasUnsavedChanges:W,resetDesign:j}=r,G=r.setInputMode,pe=r.setPrompt,Z=r.setDimensions,ee=r.setArMapping;r.setGenerationResult;const F=r.setResult,K=r.setJobId;r.setBlendState;const U=r.setBlendRecipes,V=r.setColorMapping,J=r.setBlendSvgUrl;r.setSolidState;const oe=r.setSolidRecipes,me=r.setSolidColorMapping,je=r.setSolidSvgUrl;r.updateBlendSvgUrl,r.updateSolidSvgUrl;const he=r.setBlendEditedColors,Ee=r.setSolidEditedColors;r.setViewMode;const Me=r.setShowFinalRecipes,We=r.setShowSolidSummary,Ie=r.setRegionOverrides;r.addRegionOverride;const Je=r.setOriginalTaggedSvg,Ue=r.setRegionOverridesHistory,C=r.setHistoryIndex;r.canUndo,r.canRedo,r.undo,r.redo;const Q=r.setDesignName,ce=r.setCurrentDesignId,L=r.loadDesign,N=re=>Z(re,a),I=re=>Z(l,re),[H,X]=R.useState(null),[z,te]=R.useState(null),[ye,Y]=R.useState(!1),[M,ie]=R.useState(!1),[fe,Se]=R.useState(null),[De,ke]=R.useState(null),[ae,ue]=R.useState(""),[Ge,Qe]=R.useState(null),[et,ht]=R.useState(!1),[lt,Le]=R.useState(null),[de,ne]=R.useState(!1),[ge,He]=R.useState(null),[mt,_e]=R.useState([]),[vt,dt]=R.useState(!1),[Et,Xe]=R.useState(!1),[tn,fn]=R.useState(null),[nr,ft]=R.useState(!1),[Lr,Dr]=R.useState(!1),[jn,kt]=R.useState(!1),[Vt,pt]=R.useState(null),[yr,bt]=R.useState(!1),[Xr,xt]=R.useState(null),[nn,It]=R.useState(null),[Yt,Tt]=R.useState(null),[Ct,rn]=R.useState(null),[_t,Hn]=R.useState(null),[Zr,rr]=R.useState(!1),[bs,Kr]=R.useState(null),Un=R.useRef(null);R.useEffect(()=>{(x||m)&&Un.current&&!Et&&!et&&setTimeout(()=>{var re;(re=Un.current)==null||re.scrollIntoView({behavior:"smooth",block:"start"})},300)},[x,m,Et,et]),R.useEffect(()=>{(async()=>{try{const xe=await md({limit:1,offset:0});Kr(xe.designs.length>0),console.log("[INSPIRE] Existing designs check:",xe.designs.length>0?"User has designs":"No designs found")}catch(xe){console.error("[INSPIRE] Failed to check for existing designs:",xe),Kr(!0)}})()},[]),R.useEffect(()=>{s==="upload"?(Z(null,null),console.log("[DIMENSION] Reset dimensions for upload mode")):s==="prompt"&&(l===null||a===null)&&(Z(5e3,5e3),console.log("[DIMENSION] Restored default dimensions for prompt mode"))},[s,Z]),R.useEffect(()=>()=>{m&&m.startsWith("blob:")&&URL.revokeObjectURL(m),x&&x.startsWith("blob:")&&URL.revokeObjectURL(x)},[]),R.useEffect(()=>{const re=xe=>{xe.key==="Escape"&&de&&(ne(!1),He(null))};return window.addEventListener("keydown",re),()=>window.removeEventListener("keydown",re)},[de]),R.useEffect(()=>{mt.length>0&&!vt&&ar()},[mt,vt]),R.useEffect(()=>{(async()=>{if(!m&&!x){rn(null),Hn(null);return}if(!fW(k)){rn(h),Hn(v);return}rr(!0),console.log("[INSPIRE] Recalculating current recipes from edited SVG...");try{if(m&&h){const xe=await Bx(m,h,k,"blend");rn(xe),console.log("[INSPIRE] Derived blend recipes:",xe.length)}if(x&&v){const xe=await Bx(x,v,k,"solid");Hn(xe),console.log("[INSPIRE] Derived solid recipes:",xe.length)}}catch(xe){console.error("[INSPIRE] Failed to recalculate recipes:",xe),rn(h),Hn(v)}finally{rr(!1)}})()},[m,x,k,h,v]),R.useEffect(()=>{if(t){console.log("[INSPIRE] Loading design data:",t);const re=Pp(t);console.log("[INSPIRE] Restored state:",re),L(re),t.name&&Q(t.name),t.id&&ce(t.id),console.log("[INSPIRE] Loaded design:",t.name),setTimeout(async()=>{var xe;if((xe=re.result)!=null&&xe.svg_url){console.log("[INSPIRE] Regenerating SVGs from loaded design");let we=re.originalTaggedSvg||null;if(we)console.log("[INSPIRE] Using saved tagged SVG with preserved region IDs"),Je(we);else try{const ot=await(await fetch(re.result.svg_url)).text();we=Bo(ot),Je(we),console.log("[INSPIRE] Tagged SVG with region IDs for loaded design")}catch(Ne){console.error("[INSPIRE] Failed to tag SVG regions:",Ne)}try{re.blendRecipes&&re.colorMapping&&await qi(re.result.svg_url,re.colorMapping,re.blendRecipes,re.blendEditedColors,we,re.regionOverrides),re.solidRecipes&&re.solidColorMapping&&await Ss(re.result.svg_url,re.solidColorMapping,re.solidRecipes,re.solidEditedColors,we,re.regionOverrides)}catch(Ne){console.error("[INSPIRE] Failed to regenerate SVGs:",Ne),ke("Failed to restore design preview. Please try reloading.")}}},100)}},[t,L,Q,ce,Je]);const Ir=R.useRef(!1);R.useEffect(()=>{if(t||Ir.current||!((u==null?void 0:u.svg_url)&&!m&&!x&&(h||v)))return;Ir.current=!0,console.log("[INSPIRE] Detected design loaded directly into store, regenerating SVGs..."),(async()=>{let we=E||null;if(we)console.log("[INSPIRE] Using existing tagged SVG with preserved region IDs");else try{const ot=await(await fetch(u.svg_url)).text();we=Bo(ot),Je(we),console.log("[INSPIRE] Tagged SVG with region IDs")}catch(Ne){console.error("[INSPIRE] Failed to tag SVG regions:",Ne)}try{h&&f&&await qi(u.svg_url,f,h,g,we,k),v&&y&&await Ss(u.svg_url,y,v,b,we,k)}catch(Ne){console.error("[INSPIRE] Failed to regenerate SVGs:",Ne),ke("Failed to restore design preview. Please try reloading.")}})()},[u,m,x,h,v,f,y,t,k,E]),R.useEffect(()=>{u||(Ir.current=!1)},[u]);const Jr=re=>{var Ne;const xe=(Ne=re.target.files)==null?void 0:Ne[0];if(!xe){X(null);return}const we=Ux(xe,{maxSizeMB:10,allowedTypes:["image/png","image/jpeg","image/svg+xml"]});if(!we.valid){ke(we.error),X(null);return}X(xe),ke(null)},Ui=re=>{re.preventDefault(),re.stopPropagation(),Y(!0)},ei=re=>{re.preventDefault(),re.stopPropagation(),re.currentTarget===re.target&&Y(!1)},ma=re=>{re.preventDefault(),re.stopPropagation()},ti=re=>{re.preventDefault(),re.stopPropagation(),Y(!1);const xe=re.dataTransfer.files;if(xe&&xe.length>0){const we=xe[0],Ne=Ux(we,{maxSizeMB:10,allowedTypes:["image/png","image/jpeg","image/svg+xml"]});if(!Ne.valid){ke(Ne.error),X(null);return}X(we),ke(null)}},Qr=async()=>{var re,xe;if(s==="prompt"&&!i.trim()){ke("Please enter a design description");return}if(s==="upload"&&!H){ke("Please select a file to upload");return}if(s==="upload"&&H&&!Ma(H)){ke("Unsupported file type. Please upload PNG, JPG, or SVG.");return}ke(null),ie(!0),Se(null),F(null),K(null),ue("Initialising..."),Qe(null);try{let we;if(s==="upload"&&H){const Ce=Ma(H);ue(Ce==="svg"?"Uploading SVG file...":"Uploading image..."),te("Uploading...");const be=await _W(H);if(!be.success)throw new Error(be.error||"Failed to upload file");if(te(null),Ce==="svg"){if(ue("Processing SVG..."),we=await ui.processUploadedSVG({svg_url:be.url}),!we.success)throw new Error(we.error||"Failed to process SVG");K(we.jobId),ue(" SVG uploaded successfully!"),ie(!1);const B=await ui.getRecraftStatus(we.jobId);Se(B),F(B.result),(re=B.result)!=null&&re.svg_url&&await ws(B.result.svg_url,we.jobId);return}else{if(ue("Starting vectorisation..."),we=await ui.vectorizeImage({image_url:be.url}),!we.success)throw new Error(we.error||"Failed to start vectorisation");ue(" AI is vectorising your image...")}}else if(s==="prompt"){const Ce=vW(a,l);if(ee(Ce),console.log("[TPV-STUDIO] AR Mapping:",Ce),console.log("[TPV-STUDIO] Layout:",bW(Ce)),wW(Ce)?ue(`Generating ${Ce.canonical.name} design panel...`):ue("Initialising..."),we=await ui.generateRecraft({prompt:i.trim(),lengthMM:Ce.recraft.height,widthMM:Ce.recraft.width}),!we.success)throw new Error(we.error||"Failed to start generation");ue(" AI is creating your design...")}K(we.jobId),ue("Request submitted, waiting for processing...");let Ne=null,ot=Date.now();await ui.waitForRecraftCompletion(we.jobId,Ce=>{var B,ve;Se(Ce);const be=Math.floor((Date.now()-ot)/1e3);if(Ce.status==="queued"){const Re=[` Preparing your canvas... (${be}s)`,` Warming up the AI brushes... (${be}s)`,` Queueing your masterpiece... (${be}s)`,` Mixing digital paints... (${be}s)`,` AI is contemplating your vision... (${be}s)`,` Selecting the perfect colours... (${be}s)`,` Calculating vector paths... (${be}s)`,` Almost ready to create... (${be}s)`],rt=Math.floor(be/4)%Re.length;ue(Re[rt])}else if(Ce.status==="running")if(Ne!=="running")ue(" AI is creating your design..."),Ne="running";else{const Re=[` Creating vector shapes... (${be}s)`,` Applying colours and patterns... (${be}s)`,` Refining design details... (${be}s)`,` Finalising artwork... (${be}s)`],rt=Math.floor(be/5)%Re.length;ue(Re[rt])}else if(Ce.status==="retrying"){const Re=((B=Ce.recraft)==null?void 0:B.attempt_current)||0,rt=((ve=Ce.recraft)==null?void 0:ve.attempt_max)||3;ue(` Retrying generation (attempt ${Re}/${rt})...`)}});const Ze=await ui.getRecraftStatus(we.jobId);Se(Ze),F(Ze.result),Ze.status==="completed"&&(ue(" Design ready!"),ie(!1),(xe=Ze.result)!=null&&xe.svg_url&&await ws(Ze.result.svg_url,we.jobId))}catch(we){console.error("Generation failed:",we),ke(we.message),ue(""),ie(!1)}},xr=()=>{const re=w==="solid"?x:m,xe=w==="solid"?"tpv-solid":"tpv-blend";if(re){const we=document.createElement("a");we.href=re,we.download=`${xe}-${Date.now()}.svg`,document.body.appendChild(we),we.click(),document.body.removeChild(we)}},Rn=async re=>{try{const we=await(await fetch(re)).text(),Ze=new DOMParser().parseFromString(we,"image/svg+xml").querySelector("svg");if(!Ze)return null;let Ce,be;const B=Ze.getAttribute("viewBox");if(B){const Re=B.split(/\s+/).map(Number);Ce=Re[2],be=Re[3]}else Ce=parseFloat(Ze.getAttribute("width"))||1024,be=parseFloat(Ze.getAttribute("height"))||1024;const ve=Ce/be;return console.log(`[DIMENSION] Detected aspect ratio: ${ve.toFixed(2)} (${Ce}${be})`),ve}catch(xe){return console.error("[DIMENSION] Failed to detect aspect ratio:",xe),null}},es=(re,xe)=>{console.log(`[DIMENSION] User confirmed dimensions: ${re}mm  ${xe}mm`),N(re),I(xe),Tt({width:re,height:xe}),nn==="pdf"?setTimeout(()=>ir(re,xe),100):nn==="tiles"?setTimeout(()=>vr(re,xe),100):nn==="insitu"?setTimeout(()=>kt(!0),100):nn==="save"&&ft(!0),It(null)},ni=async()=>{const re=w==="solid"?x:m;if(s==="upload"&&(!l||!a)){console.log("[DIMENSION] No dimensions set for upload, showing modal...");const xe=await Rn(re);if(xe){xt(xe),It("insitu"),bt(!0);return}else{xt(1),It("insitu"),bt(!0);return}}kt(!0)},ri=()=>{const re=w==="solid"?x:m,xe=w==="solid"?"tpv-solid":"tpv-blend";if(re){const we=new Image;we.onload=()=>{const Ne=document.createElement("canvas");Ne.width=we.naturalWidth||1e3,Ne.height=we.naturalHeight||1e3,Ne.getContext("2d").drawImage(we,0,0),Ne.toBlob(Ze=>{const Ce=URL.createObjectURL(Ze),be=document.createElement("a");be.href=Ce,be.download=`${xe}-${Date.now()}.png`,document.body.appendChild(be),be.click(),document.body.removeChild(be),URL.revokeObjectURL(Ce)})},we.src=re}},zr=()=>{W()&&!window.confirm(`Start a new design?

You have unsaved changes that will be lost.`)||(j(),X(null),ie(!1),Se(null),ke(null),ue(""),Qe(null),ht(!1),Le(null),ne(!1),He(null),Xe(!1),fn(null))},si=async()=>{const re=w==="solid"?x:m,xe=l>0&&a>0;if(s==="upload"&&!xe){console.log("[DIMENSION] No dimensions set for upload, showing modal before save...");const Ne=await Rn(re);if(Ne){xt(Ne),It("save"),bt(!0);return}else{xt(1),It("save"),bt(!0);return}}ft(!0)},[ts,sr]=R.useState(!1),On=async()=>{const re=w==="solid"?x:m;if(s==="upload"&&(!l||!a)){console.log("[DIMENSION] No dimensions set for upload, showing modal...");const xe=await Rn(re);if(xe){xt(xe),It("pdf"),bt(!0);return}else{xt(1),It("pdf"),bt(!0);return}}await ir(l,a)},ir=async(re,xe)=>{const we=w==="solid"?x:m,Ne=w==="solid"?_t||v:Ct||h,ot=w==="solid"?"tpv-solid":"tpv-blend";if(!we||!Ne){ke("Cannot generate PDF: missing SVG or recipes");return}sr(!0),ke(null);try{const Ce=await(await fetch(we)).text(),be=new AbortController,B=setTimeout(()=>be.abort(),3e4),ve=await Nr.getSession(),Re={"Content-Type":"application/json"};ve!=null&&ve.access_token&&(Re.Authorization=`Bearer ${ve.access_token}`);const rt=await fetch("/api/export-pdf",{method:"POST",headers:Re,signal:be.signal,body:JSON.stringify({svgString:Ce,designName:q||i||"TPV Design",projectName:"TPV Studio",dimensions:{widthMM:re,lengthMM:xe},recipes:Ne,mode:w,designId:p||""})});if(clearTimeout(B),!rt.ok){const Zt=rt.headers.get("content-type");if(Zt&&Zt.includes("application/json")){const Mn=await rt.json();throw new Error(Mn.message||"PDF generation failed")}else{const Mn=await rt.text();throw console.error("PDF API error response:",Mn),new Error(`Server error: ${rt.status}`)}}const ct=await rt.blob(),tt=URL.createObjectURL(ct),nt=document.createElement("a");nt.href=tt,nt.download=`${ot}-${Date.now()}.pdf`,document.body.appendChild(nt),nt.click(),document.body.removeChild(nt),URL.revokeObjectURL(tt)}catch(Ze){console.error("PDF download error:",Ze),Ze.name==="AbortError"?ke("PDF generation timed out. Please try again."):ke(`PDF generation failed: ${Ze.message}`)}finally{sr(!1)}},ii=async()=>{const re=w==="solid"?x:m;if(!re){ke("No SVG available to slice");return}if(s==="upload"&&(!l||!a)){console.log("[DIMENSION] No dimensions set for upload, showing modal...");const xe=await Rn(re);if(xe){xt(xe),It("tiles"),bt(!0);return}else{xt(1),It("tiles"),bt(!0);return}}await vr(l,a)},vr=async(re,xe)=>{const we=w==="solid"?x:m;try{await fT(we,{width:re,length:xe},q||"tpv-design")}catch(Ne){console.error("Tile download error:",Ne),ke(`Failed to download tiles: ${Ne.message}`)}},ws=async(re=null,xe=null)=>{const we=re||(u==null?void 0:u.svg_url),Ne=xe||p;if(!we){ke("No SVG available to analyse");return}{console.log("[TPV-STUDIO] Blend mode disabled - skipping blend recipes, generating solid only"),ke(null),ue(" Processing design colours...");let ot=null;try{const Ce=await(await fetch(we)).text();ot=Bo(Ce),Je(ot),console.log("[TPV-STUDIO] Tagged SVG with region IDs")}catch(Ze){console.error("[TPV-STUDIO] Failed to tag SVG regions:",Ze)}await rs(we,Ne,ot);return}},ns=async()=>{ht(!1),Le(null),Xe(!1),fn(null),w==="solid"?Ee(new Map):he(new Map),u!=null&&u.svg_url&&await ws(u.svg_url,p)},_s=async re=>{var xe;if(!q){if(!i||s!=="prompt"){H&&Q(`TPV Design  ${H.name.replace(/\.[^/.]+$/,"")}`);return}Dr(!0);try{const we=(re==null?void 0:re.slice(0,6).map(ot=>{var Ce,be;const Ze=(be=(Ce=ot.chosenRecipe)==null?void 0:Ce.components)==null?void 0:be[0];return(Ze==null?void 0:Ze.name)||null}).filter(Boolean))||[],Ne=await ui.generateDesignName({prompt:i,colors:we,dimensions:{widthMM:l,lengthMM:a}});Ne.success&&((xe=Ne.names)==null?void 0:xe.length)>0?Q(Ne.names[0]):Q(Wi(i))}catch(we){console.error("[TPV-STUDIO] Name generation failed:",we),Q(Wi(i))}finally{Dr(!1)}}},Wi=re=>re?`TPV Design  ${re.split(/[,.]/)[0].trim().slice(0,40)}`:"TPV Playground Design",rs=async(re=null,xe=null,we=null)=>{const Ne=re||(u==null?void 0:u.svg_url),ot=xe||p,Ze=we||E;if(Ne)try{console.log("[TPV-STUDIO] Generating solid color version...");const Ce=await fetch("/api/solid-recipes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({svg_url:Ne,job_id:ot,max_colors:15})}),be=await Ce.json();if(!Ce.ok)throw new Error(be.error||"Failed to generate solid recipes");if(be.success){oe(be.recipes);const B=new Map(Object.entries(be.colorMapping||{}));console.log("[TPV-STUDIO] Using API colorMapping with",B.size,"entries"),me(B);try{const{dataUrl:ve,stats:Re}=await bi(Ne,B,Ze);je(ve),console.log("[TPV-STUDIO] Solid color SVG generated:",Re),Re.colorsNotMapped&&Re.colorsNotMapped.size>0&&console.warn("[TPV-STUDIO] Unmapped colors in solid mode:",Array.from(Re.colorsNotMapped)),_s(be.recipes)}catch(ve){console.error("[TPV-STUDIO] Failed to generate solid SVG:",ve)}}}catch(Ce){console.error("[TPV-STUDIO] Solid generation failed:",Ce)}},An=(re,xe="palette")=>{if(console.log("[TPV-STUDIO] Color clicked:",re,"source:",xe,"in mode:",w),de&&ge&&xe==="palette"){At(ge.regionId,re.hex),ne(!1),He(null);return}xe==="palette"&&(w==="blend"?(fn(re),Xe(!0),Me(!1)):(Le(re),ht(!0),We(!1)))},or=re=>{console.log("[TPV-STUDIO] Region clicked:",re),de?(At(ge.regionId,re.sourceColor),ne(!1),He(null)):(ne(!0),He(re))},At=(re,xe)=>{const we=typeof xe=="string"?{hex:xe,editType:"eyedrop"}:xe;console.log("[TPV-STUDIO] Queuing region recolor:",re,"->",we),_e(Ne=>[...Ne,{regionId:re,colorData:{...we,hex:we.hex.toLowerCase()},viewMode:w}])},ar=async()=>{if(vt||mt.length===0)return;dt(!0);const re=mt[0],xe=re.colorData;console.log("[TPV-STUDIO] Processing queued region recolor:",re.regionId,"->",xe);try{const we=new Map(k);we.set(re.regionId,xe),re.viewMode==="blend"?await Xt(null,null,we):await cn(null,null,we),Ie(we);const Ne=r.historyIndex,Ze=r.regionOverridesHistory.slice(0,Ne+1);Ze.push(new Map(we)),Ze.length>50&&Ze.shift(),Ue(Ze),C(Ze.length-1),console.log("[TPV-STUDIO] Completed region recolor for:",re.regionId)}catch(we){console.error("[TPV-STUDIO] Failed to process region recolor:",we)}finally{_e(we=>we.slice(1)),dt(!1)}},Gi=()=>{console.log("[TPV-STUDIO] Eyedropper cancelled"),ne(!1),He(null)},Vi=()=>{ge&&(console.log("[TPV-STUDIO] Making region transparent:",ge.regionId),At(ge.regionId,"transparent"),ne(!1),He(null))},oi=re=>{if(!ge)return;console.log("[TPV-STUDIO] Selecting TPV color for region:",ge.regionId,re);const xe={hex:re.hex,tpvCode:re.code,tpvName:re.name,originalHex:ge.sourceColor,editType:"solid"};At(ge.regionId,xe),ne(!1),He(null)},Yi=async()=>{if(O<=0)return;const re=O-1,xe=T[re];console.log("[TPV-STUDIO] Undoing region override to index:",re),Ie(new Map(xe)),C(re),w==="blend"?await Xt(null,null,xe):await cn(null,null,xe)},ss=async()=>{if(O>=T.length-1)return;const re=O+1,xe=T[re];console.log("[TPV-STUDIO] Redoing region override to index:",re),Ie(new Map(xe)),C(re),w==="blend"?await Xt(null,null,xe):await cn(null,null,xe)},ga=async re=>{if(lt)if(console.log("[TPV-STUDIO] Color changed:",lt.hex,"->",re,"in mode:",w),w==="solid"){const we=(_t||v).find(Ne=>Ne.targetColor.hex.toLowerCase()===lt.hex.toLowerCase());if(we!=null&&we.isAddedFromEdit){const Ne=lt.hex.toLowerCase(),ot=new Map(k);let Ze=0;const Ce=pn.find(B=>B.hex.toLowerCase()===re.toLowerCase());k.forEach((B,ve)=>{(typeof B=="string"?B:B.hex).toLowerCase()===Ne&&(ot.set(ve,{hex:re,tpvCode:(Ce==null?void 0:Ce.code)||null,tpvName:(Ce==null?void 0:Ce.name)||null,originalHex:B.originalHex||Ne,editType:"solid"}),Ze++)}),console.log("[TPV-STUDIO] Updated",Ze,"region overrides for derived color:",Ne,"->",re);const be=T.slice(0,O+1);be.push(new Map(ot)),be.length>50&&be.shift(),Ie(ot),Ue(be),C(be.length-1),Le({...lt,hex:re,blendHex:re}),await cn(b,re,ot)}else{const Ne=new Map(b),ot=(we==null?void 0:we.mergedOriginalColors)||[lt.originalHex.toLowerCase()];console.log("[TPV-STUDIO] Updating",ot.length,"original colors:",ot),ot.forEach(Ze=>{Ne.set(Ze,{newHex:re.toLowerCase()})}),Ee(Ne),Le({...lt,hex:re,blendHex:re}),await cn(Ne,re)}}else{const xe=new Map(g);xe.set(lt.originalHex.toLowerCase(),{newHex:re.toLowerCase()}),he(xe),Le({...lt,hex:re,blendHex:re}),await Xt(xe,re)}};R.useCallback(async({blendHex:re,parts:xe,recipe:we})=>{if(tn)if(console.log("[TPV-STUDIO] Mixer blend changed:",tn.originalHex,"->",re,"recipe:",we,"isAddedFromEdit:",tn.isAddedFromEdit),tn.isAddedFromEdit){const Ne=tn.hex.toLowerCase(),ot=new Map(k);let Ze=0;k.forEach((be,B)=>{(typeof be=="string"?be:be.hex).toLowerCase()===Ne&&(ot.set(B,{hex:re,originalHex:be.originalHex||Ne,editType:"blend",blendComponents:(we==null?void 0:we.components)||null}),Ze++)}),console.log("[TPV-STUDIO] Updated",Ze,"region overrides for derived blend color:",Ne,"->",re),fn({...tn,hex:re,blendHex:re}),await Xt(g,re,ot);const Ce=T.slice(0,O+1);Ce.push(new Map(ot)),Ce.length>50&&Ce.shift(),Ie(ot),Ue(Ce),C(Ce.length-1)}else{const Ne=new Map(g);Ne.set(tn.originalHex.toLowerCase(),{newHex:re.toLowerCase(),recipe:we,parts:xe}),he(Ne),fn({...tn,hex:re,blendHex:re}),await Xt(Ne,re)}},[tn,g,k,T,O,u,f]);const Xt=async(re=null,xe=null,we=null)=>{if(!(!(u!=null&&u.svg_url)||!f||!h))try{const Ne=new Map(f),ot=re||g;ot.forEach((ct,tt)=>{if(ct.newHex){const nt=tt.toLowerCase();Ne.set(nt,{...Ne.get(nt),blendHex:ct.newHex})}});const Ze=h.map(ct=>{const tt=ot.get(ct.originalColor.hex.toLowerCase());if(tt!=null&&tt.newHex){const nt={...ct,targetColor:{...ct.targetColor,hex:tt.newHex},blendColor:{...ct.blendColor,hex:tt.newHex}};return tt.recipe&&tt.recipe.components&&(nt.chosenRecipe={...ct.chosenRecipe,components:tt.recipe.components,deltaE:0,quality:"Excellent"}),nt}return ct}),{svgText:Ce,stats:be}=await bi(u.svg_url,Ne,E),B=we!==null?we:k,ve=Ao(Ce,B);m&&m.startsWith("blob:")&&(URL.revokeObjectURL(m),console.log("[TPV-STUDIO] Revoked old blend blob URL"));const Re=new Blob([ve],{type:"image/svg+xml"}),rt=URL.createObjectURL(Re);console.log("[TPV-STUDIO] Created new blend blob URL, SVG length:",ve.length),J(rt),V(Ne),U(Ze),console.log("[TPV-STUDIO] Blend SVG regenerated with edits:",be),B.size>0&&console.log("[TPV-STUDIO] Applied",B.size,"region overrides")}catch(Ne){console.error("[TPV-STUDIO] Failed to regenerate blend SVG:",Ne)}},cn=async(re=null,xe=null,we=null)=>{if(!(!(u!=null&&u.svg_url)||!y||!v))try{const Ne=new Map(y),ot=re||b;ot.forEach((ct,tt)=>{if(ct.newHex){const nt=tt.toLowerCase();Ne.set(nt,{...Ne.get(nt),blendHex:ct.newHex})}});const Ze=v.map(ct=>{const tt=ot.get(ct.originalColor.hex.toLowerCase());if(tt!=null&&tt.newHex){const nt=pn.find(Zt=>Zt.hex.toLowerCase()===tt.newHex.toLowerCase());return nt?{...ct,targetColor:{...ct.targetColor,hex:tt.newHex},blendColor:{hex:tt.newHex,rgb:nt.rgb,lab:nt.lab},chosenRecipe:{components:[{code:nt.code,name:nt.name,hex:nt.hex,rgb:nt.rgb,lab:nt.lab,ratio:1}],blendColor:{hex:nt.hex,rgb:nt.rgb,lab:nt.lab},deltaE:0,quality:"Perfect"}}:{...ct,targetColor:{...ct.targetColor,hex:tt.newHex},blendColor:{...ct.blendColor,hex:tt.newHex}}}return ct}),{svgText:Ce,stats:be}=await bi(u.svg_url,Ne,E),B=we!==null?we:k,ve=Ao(Ce,B);x&&x.startsWith("blob:")&&(URL.revokeObjectURL(x),console.log("[TPV-STUDIO] Revoked old solid blob URL"));const Re=new Blob([ve],{type:"image/svg+xml"}),rt=URL.createObjectURL(Re);console.log("[TPV-STUDIO] Created new solid blob URL, SVG length:",ve.length),je(rt),me(Ne),oe(Ze),console.log("[TPV-STUDIO] Solid SVG regenerated with edits:",be),B.size>0&&console.log("[TPV-STUDIO] Applied",B.size,"region overrides")}catch(Ne){console.error("[TPV-STUDIO] Failed to regenerate solid SVG:",Ne)}},ai=re=>{if(!(re!=null&&re.components))return null;const xe={};return re.components.forEach(we=>{we.code&&we.parts&&(xe[we.code]=we.parts)}),Object.keys(xe).length>0?{parts:xe}:null};R.useCallback(re=>{var we;if(!re)return null;const xe=g.get((we=re.originalHex)==null?void 0:we.toLowerCase());return xe!=null&&xe.recipe?xe.recipe:re.isAddedFromEdit&&re.chosenRecipe?ai(re.chosenRecipe):re.recipe||null},[g]);const qi=async(re,xe,we,Ne,ot=null,Ze=null)=>{try{console.log("[INSPIRE] Regenerating blend SVG from state");const Ce=new Map(xe);Ne&&Ne.size>0&&Ne.forEach((ct,tt)=>{const nt=tt.toLowerCase();Ce.has(nt)&&Ce.set(nt,{...Ce.get(nt),blendHex:ct.newHex})});const{dataUrl:be,svgText:B}=await bi(re,Ce,ot);let ve=B;Ze&&Ze.size>0&&(console.log("[INSPIRE] Applying",Ze.size,"region overrides to blend SVG"),ve=Ao(B,Ze));const Re=new Blob([ve],{type:"image/svg+xml"}),rt=URL.createObjectURL(Re);J(rt),console.log("[INSPIRE] Blend SVG regenerated")}catch(Ce){console.error("[INSPIRE] Failed to regenerate blend SVG:",Ce)}},Ss=async(re,xe,we,Ne,ot=null,Ze=null)=>{try{console.log("[INSPIRE] Regenerating solid SVG from state");const Ce=new Map(xe);Ne&&Ne.size>0&&Ne.forEach((ct,tt)=>{const nt=tt.toLowerCase();Ce.has(nt)&&Ce.set(nt,{...Ce.get(nt),blendHex:ct.newHex})});const{dataUrl:be,svgText:B}=await bi(re,Ce,ot);let ve=B;Ze&&Ze.size>0&&(console.log("[INSPIRE] Applying",Ze.size,"region overrides to solid SVG"),ve=Ao(B,Ze));const Re=new Blob([ve],{type:"image/svg+xml"}),rt=URL.createObjectURL(Re);je(rt),console.log("[INSPIRE] Solid SVG regenerated")}catch(Ce){console.error("[INSPIRE] Failed to regenerate solid SVG:",Ce)}};return o.jsxs("div",{className:`inspire-panel-recraft${n?" inspire-panel-recraft--embedded":""}`,children:[!n&&o.jsxs("div",{className:"panel-header",children:[o.jsx("h2",{children:"TPV Studio - Vector AI"}),o.jsx("p",{className:"subtitle",children:"AI-powered vector designs for playground surfacing"})]}),!u&&!M&&bs===!1&&o.jsxs("div",{className:"welcome-guidance",children:[o.jsx("div",{className:"welcome-icon",children:""}),o.jsx("h3",{children:"Create Your First Design"}),o.jsx("p",{children:"Choose how you'd like to create your TPV design below. You can describe what you want, upload an image to convert, or process an existing SVG file. Once generated, you'll be able to edit colours, export PDFs with specifications, and preview designs on-site."})]}),o.jsxs("div",{className:"input-mode-tabs",children:[o.jsxs("button",{className:`input-mode-tab ${s==="prompt"?"active":""}`,onClick:()=>{G("prompt"),X(null),ke(null)},disabled:M,children:[o.jsxs("svg",{className:"mode-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M12 3l1.545 4.635L18.18 9.18l-4.635 1.545L12 15.36l-1.545-4.635L5.82 9.18l4.635-1.545L12 3z"}),o.jsx("path",{d:"M5 21l1.5-4.5L2 15l4.5-1.5L8 9l1.5 4.5L14 15l-4.5 1.5L8 21z",opacity:"0.5"})]}),o.jsx("span",{className:"mode-title",children:"Text Prompt"}),o.jsx("span",{className:"mode-description",children:"Describe your design"})]}),o.jsxs("button",{className:`input-mode-tab ${s==="upload"?"active":""}`,onClick:()=>{G("upload"),pe(""),ke(null)},disabled:M,children:[o.jsxs("svg",{className:"mode-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),o.jsx("polyline",{points:"17 8 12 3 7 8"}),o.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]}),o.jsx("span",{className:"mode-title",children:"Upload Design"}),o.jsx("span",{className:"mode-description",children:"PNG, JPG, or SVG"})]})]}),o.jsxs("div",{className:"form-section",children:[s==="prompt"&&o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"prompt",children:"Design Description"}),o.jsx("textarea",{id:"prompt",value:i,onChange:re=>pe(re.target.value),placeholder:"e.g., calm ocean theme with big fish silhouettes and waves",rows:4,disabled:M,className:"prompt-input"}),o.jsx("p",{className:"helper-text",children:"Describe the design you want to generate. The AI will create a vector illustration based on your description. Perfect for creating completely new designs from scratch - just describe colors, themes, and elements you want."})]}),s==="upload"&&o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"design-upload",children:"Upload Design File"}),o.jsxs("div",{className:`drop-zone ${ye?"dragging":""} ${H?"has-file":""}`,onDragEnter:Ui,onDragLeave:ei,onDragOver:ma,onDrop:ti,children:[o.jsx("input",{id:"design-upload",type:"file",accept:".png,.jpg,.jpeg,.svg,image/png,image/jpeg,image/svg+xml",onChange:Jr,disabled:M,className:"file-input-hidden"}),o.jsx("label",{htmlFor:"design-upload",className:"drop-zone-content",children:H?o.jsxs(o.Fragment,{children:[o.jsxs("svg",{className:"upload-icon success",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),o.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),o.jsx("span",{className:"file-name",children:H.name}),o.jsx("span",{className:"file-type-badge",children:Ma(H)==="svg"?"SVG - will process immediately":"Image - will vectorise with AI"}),o.jsx("span",{className:"drop-hint",children:"Click to change file"})]}):o.jsxs(o.Fragment,{children:[o.jsxs("svg",{className:"upload-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),o.jsx("polyline",{points:"17 8 12 3 7 8"}),o.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]}),o.jsx("span",{className:"drop-text",children:"Drag & drop your design here"}),o.jsx("span",{className:"drop-hint",children:"or click to browse"}),o.jsx("span",{className:"supported-formats",children:"PNG, JPG, or SVG"})]})})]}),o.jsxs("p",{className:"helper-text",children:["Upload your design file. ",o.jsx("strong",{children:"PNG/JPG"})," images will be vectorised with AI (~30 seconds). ",o.jsx("strong",{children:"SVG"})," files are processed immediately for TPV colour matching."]})]}),s==="prompt"&&o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"length",children:"Length (mm)"}),o.jsx("input",{id:"length",type:"number",value:a,onChange:re=>I(parseInt(re.target.value,10)),min:1e3,max:2e4,step:100,disabled:M})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"width",children:"Width (mm)"}),o.jsx("input",{id:"width",type:"number",value:l,onChange:re=>N(parseInt(re.target.value,10)),min:1e3,max:2e4,step:100,disabled:M})]})]}),De&&o.jsxs("div",{className:"error-message",children:[o.jsx("strong",{children:"Error:"})," ",De]}),z&&o.jsx("div",{className:"upload-progress",children:o.jsx("p",{children:z})}),o.jsx("button",{onClick:Qr,disabled:M||s==="prompt"&&!i.trim()||s==="upload"&&!H,className:"generate-button",children:M?s==="upload"&&H&&Ma(H)==="svg"?"Processing...":"Generating...":s==="prompt"?"Generate Vector Design":H&&Ma(H)==="svg"?"Process SVG":"Vectorise & Process"})]}),M&&o.jsxs("div",{className:"progress-section",children:[o.jsx("div",{className:"progress-bar",children:o.jsx("div",{className:"progress-bar-fill"})}),o.jsx("p",{className:"progress-message",children:ae})]}),u&&!M&&o.jsxs("div",{className:"results-section",children:[c&&o.jsxs("div",{className:`ar-info ${c.layout.mode}`,children:[o.jsxs("div",{className:"ar-info-header",children:[o.jsx("strong",{children:"Layout:"})," ",c.layout.reason]}),o.jsxs("div",{className:"ar-info-details",children:[o.jsxs("span",{children:["Requested: ",c.user.formatted]}),o.jsx("span",{children:""}),o.jsxs("span",{children:["Generated: ",c.canonical.name," panel"]}),c.layout.mode==="framing"&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:""}),o.jsx("span",{className:"layout-note",children:"Panel centred with base colour surround"})]}),c.layout.mode==="tiling"&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:""}),o.jsx("span",{className:"layout-note",children:"Pattern will repeat along length"})]})]})]}),vi.BLEND_MODE_ENABLED,vi.BLEND_MODE_ENABLED,w==="solid"&&x&&v&&o.jsx("div",{ref:Un,children:o.jsx(OP,{blendSvgUrl:x,recipes:_t||v,mode:"solid",onColorClick:An,onRegionClick:or,onEyedropperCancel:Gi,onMakeTransparent:Vi,onSelectTPVColor:oi,selectedColor:lt,editedColors:b,onResetAll:ns,designName:q,onNameChange:Q,isNameLoading:Lr,onInSituClick:ni,eyedropperActive:de,eyedropperRegion:ge,onRegionUndo:Yi,onRegionRedo:ss,canUndo:O>0,canRedo:O<T.length-1,regionOverridesCount:k.size})}),vi.BLEND_MODE_ENABLED,(m||x)&&o.jsxs("div",{className:"action-bar",children:[o.jsxs("button",{className:"action-bar__btn action-bar__btn--secondary",onClick:zr,title:"Start a new design",children:[o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M12 5v14M5 12h14"})}),"New"]}),o.jsxs("button",{className:"action-bar__btn action-bar__btn--primary",onClick:si,title:"Save this design to your gallery",children:[o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z"}),o.jsx("polyline",{points:"17 21 17 13 7 13 7 21"}),o.jsx("polyline",{points:"7 3 7 8 15 8"})]}),"Save"]}),o.jsx(SW,{onExportSVG:xr,onExportPNG:ri,onExportPDF:On,onExportTiles:ii,viewMode:w,exporting:ts,disabled:!(m||x)})]})]}),vi.BLEND_MODE_ENABLED,w==="solid"&&x&&v&&!_&&o.jsxs("div",{className:"finalize-section",children:[o.jsx("button",{onClick:()=>We(!0),className:"finalize-button",children:"View TPV Colours Used"}),o.jsx("p",{className:"finalize-hint",children:"See which pure TPV colours are used in this design"})]}),vi.BLEND_MODE_ENABLED,_&&v&&o.jsx(NP,{recipes:_t||v,onClose:()=>{We(!1)},isRecalculating:Zr}),et&&lt&&o.jsx(W9,{color:lt,mode:w,onColorChange:ga,onClose:()=>{ht(!1),Le(null)}}),nr&&o.jsx(Y9,{currentState:{inputMode:s,prompt:i,selectedFile:H,lengthMM:(Yt==null?void 0:Yt.height)||a,widthMM:(Yt==null?void 0:Yt.width)||l,result:u,viewMode:w,blendRecipes:h,solidRecipes:v,colorMapping:f,solidColorMapping:y,solidEditedColors:b,blendEditedColors:g,blendSvgUrl:m,solidSvgUrl:x,arMapping:c,jobId:p,inSituData:Vt,regionOverrides:k,originalTaggedSvg:E},existingDesignId:P,initialName:q,onClose:()=>{ft(!1),Tt(null)},onSaved:(re,xe)=>{ft(!1),Tt(null),Kr(!0),xe&&Q(xe),e&&e(xe),console.log("[INSPIRE] Design saved:",re)}}),jn&&o.jsx(Y_,{designUrl:w==="solid"?x:m,designDimensions:{width:l,length:a},onClose:()=>kt(!1),onSaved:re=>{console.log("[INSPIRE] In-situ preview saved:",re),pt(re),kt(!1)}}),o.jsx(aW,{isOpen:yr,onClose:()=>{bt(!1),It(null)},onConfirm:es,aspectRatio:Xr,defaultLongestSide:5e3}),o.jsx("style",{jsx:!0,children:`
        .inspire-panel-recraft {
          max-width: var(--max-width-xl);
          margin: 0 auto;
          padding: var(--space-4);
        }

        .panel-header {
          text-align: center;
          margin-bottom: var(--space-6);
        }

        .panel-header h2 {
          font-family: var(--font-heading);
          font-size: var(--text-3xl);
          margin: 0 0 var(--space-2) 0;
          color: var(--color-primary);
          font-weight: var(--font-bold);
          letter-spacing: var(--tracking-tight);
        }

        .subtitle {
          color: var(--color-text-secondary);
          font-size: var(--text-base);
          line-height: var(--leading-relaxed);
        }

        /* Welcome Guidance */
        .welcome-guidance {
          background: linear-gradient(135deg, #fff5f0 0%, #fff9f7 100%);
          border: 2px solid #ff6b35;
          border-radius: var(--radius-lg);
          padding: var(--space-6);
          margin-bottom: var(--space-6);
          text-align: center;
        }

        .welcome-icon {
          font-size: 3rem;
          margin-bottom: var(--space-2);
        }

        .welcome-guidance h3 {
          margin: 0 0 var(--space-3);
          font-size: var(--text-xl);
          font-weight: var(--font-bold);
          color: var(--color-primary);
        }

        .welcome-guidance p {
          margin: 0;
          color: var(--color-text-secondary);
          font-size: var(--text-base);
          line-height: var(--leading-relaxed);
          max-width: 600px;
          margin-left: auto;
          margin-right: auto;
        }

        /* Input Mode Tabs - Enhanced cards */
        .input-mode-tabs {
          display: flex;
          gap: var(--space-2);
          margin-bottom: var(--space-3);
          background: var(--color-bg-subtle);
          padding: var(--space-1);
          border-radius: var(--radius-lg);
        }

        .input-mode-tab {
          flex: 1;
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: var(--space-1);
          padding: var(--space-3);
          background: var(--color-bg-card);
          border: 1px solid var(--color-border);
          border-radius: var(--radius-md);
          cursor: pointer;
          transition: all var(--transition-base);
        }

        .input-mode-tab:hover:not(:disabled) {
          border-color: var(--color-primary);
          transform: translateY(-2px);
          box-shadow: var(--shadow-md);
        }

        .input-mode-tab.active {
          background: linear-gradient(135deg, var(--color-bg-subtle) 0%, var(--color-bg-card) 100%);
          border-color: var(--color-primary);
          box-shadow: var(--shadow-glow);
        }

        .input-mode-tab:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .mode-icon {
          width: 28px;
          height: 28px;
          color: var(--color-text-secondary);
          transition: all var(--transition-base);
        }

        .input-mode-tab:hover:not(:disabled) .mode-icon {
          color: var(--color-primary);
          transform: scale(1.1);
        }

        .input-mode-tab.active .mode-icon {
          color: var(--color-primary);
        }

        .input-mode-tab .mode-title {
          font-family: var(--font-heading);
          font-size: var(--text-sm);
          font-weight: var(--font-semibold);
          color: var(--color-text-primary);
          margin-top: 0;
        }

        .input-mode-tab .mode-description {
          display: none; /* Hidden to save space */
        }

        .input-mode-tab.active .mode-title {
          color: var(--color-primary);
          font-weight: var(--font-bold);
        }

        /* Helper text */
        .helper-text {
          margin-top: var(--space-1);
          font-size: var(--text-sm);
          color: var(--color-text-tertiary);
          font-style: normal;
          line-height: var(--leading-snug);
        }

        /* Drag & Drop File Upload */
        .file-input-hidden {
          position: absolute;
          width: 1px;
          height: 1px;
          padding: 0;
          margin: -1px;
          overflow: hidden;
          clip: rect(0, 0, 0, 0);
          white-space: nowrap;
          border: 0;
        }

        .drop-zone {
          position: relative;
          width: 100%;
          min-height: 120px;
          border: 2px dashed var(--color-border);
          border-radius: var(--radius-lg);
          background: var(--color-bg-subtle);
          transition: all var(--transition-base);
        }

        .drop-zone.dragging {
          border-color: var(--color-primary);
          background: var(--color-primary-light);
          background: linear-gradient(135deg, rgba(30, 74, 122, 0.05) 0%, rgba(30, 74, 122, 0.1) 100%);
          box-shadow: var(--shadow-glow);
        }

        .drop-zone.has-file {
          border-color: var(--color-success);
          background: var(--color-success-light);
        }

        .drop-zone-content {
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          gap: var(--space-1);
          padding: var(--space-4);
          cursor: pointer;
          min-height: 120px;
        }

        .upload-icon {
          width: 36px;
          height: 36px;
          color: var(--color-text-secondary);
          transition: all var(--transition-base);
        }

        .upload-icon.success {
          color: var(--color-success);
        }

        .drop-zone:hover .upload-icon {
          color: var(--color-primary);
          transform: scale(1.1);
        }

        .drop-zone.has-file:hover .upload-icon.success {
          color: var(--color-success);
        }

        .drop-text {
          font-size: var(--text-base);
          font-weight: var(--font-semibold);
          color: var(--color-text-primary);
        }

        .file-name {
          font-size: var(--text-base);
          font-weight: var(--font-semibold);
          color: var(--color-success);
          max-width: 100%;
          overflow: hidden;
          text-overflow: ellipsis;
          white-space: nowrap;
        }

        .drop-hint {
          font-size: var(--text-sm);
          color: var(--color-text-tertiary);
        }

        .file-type-badge {
          display: inline-block;
          font-size: var(--text-xs);
          color: var(--color-text-secondary);
          background: var(--color-bg-tertiary);
          padding: var(--space-1) var(--space-2);
          border-radius: var(--radius-sm);
          margin-top: var(--space-1);
        }

        .supported-formats {
          display: block;
          font-size: var(--text-xs);
          color: var(--color-text-tertiary);
          margin-top: var(--space-2);
          font-weight: var(--font-medium);
        }

        .drop-zone.dragging .drop-text,
        .drop-zone.dragging .drop-hint {
          color: var(--color-primary);
        }

        .upload-progress {
          padding: var(--space-2);
          background: var(--color-info-light);
          border: 1px solid var(--color-info);
          border-radius: var(--radius-md);
          color: var(--color-info);
          margin-bottom: var(--space-2);
          text-align: center;
          font-size: var(--text-sm);
        }

        .form-section {
          background: var(--color-bg-card);
          padding: var(--space-3);
          border-radius: var(--radius-lg);
          margin-bottom: var(--space-3);
          border: 1px solid var(--color-border);
          box-shadow: var(--shadow-xs);
        }

        .form-group {
          margin-bottom: var(--space-3);
        }

        .form-group label {
          display: block;
          margin-bottom: var(--space-2);
          font-weight: var(--font-semibold);
          color: var(--color-text-primary);
          font-size: var(--text-sm);
        }

        .prompt-input {
          width: 100%;
          padding: var(--space-3);
          border: 1px solid var(--color-border);
          border-radius: var(--radius-md);
          font-family: inherit;
          font-size: var(--text-base);
          background: var(--color-bg-card);
          color: var(--color-text-primary);
          transition: border-color var(--transition-base);
        }

        .prompt-input:focus {
          outline: none;
          border-color: var(--color-primary);
          box-shadow: var(--shadow-glow);
        }

        .form-row {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: var(--space-3);
        }

        input[type="number"] {
          width: 100%;
          padding: var(--space-2);
          border: 1px solid var(--color-border);
          border-radius: var(--radius-md);
          background: var(--color-bg-card);
          color: var(--color-text-primary);
          font-size: var(--text-base);
          transition: border-color var(--transition-base);
        }

        input[type="number"]:focus {
          outline: none;
          border-color: var(--color-primary);
          box-shadow: var(--shadow-glow);
        }

        .error-message {
          padding: var(--space-3);
          background: var(--color-error-light);
          border: 1px solid var(--color-error);
          border-radius: var(--radius-md);
          color: var(--color-error);
          margin-bottom: var(--space-4);
          font-size: var(--text-sm);
        }

        .generate-button {
          width: 100%;
          padding: var(--space-4);
          background: var(--color-accent);
          color: white;
          border: none;
          border-radius: var(--radius-md);
          font-size: var(--text-lg);
          font-weight: var(--font-semibold);
          cursor: pointer;
          transition: all var(--transition-base);
          box-shadow: var(--shadow-sm);
        }

        .generate-button:hover:not(:disabled) {
          background: var(--color-accent-hover);
          transform: translateY(-2px);
          box-shadow: 0 8px 24px rgba(255, 107, 53, 0.3);
        }

        .generate-button:disabled {
          background: var(--color-bg-subtle);
          color: var(--color-text-tertiary);
          cursor: not-allowed;
          transform: none;
          box-shadow: none;
        }

        .progress-section {
          padding: var(--space-4);
          background: var(--color-info-light);
          border-radius: var(--radius-lg);
          margin-bottom: var(--space-4);
          border: 1px solid var(--color-info);
        }

        .progress-bar {
          height: 4px;
          background: var(--color-border);
          border-radius: var(--radius-full);
          overflow: hidden;
          margin-bottom: var(--space-3);
        }

        .progress-bar-fill {
          height: 100%;
          background: var(--color-accent);
          animation: progress 2s ease-in-out infinite;
        }

        @keyframes progress {
          0% { transform: translateX(-100%); }
          100% { transform: translateX(100%); }
        }

        .progress-message {
          text-align: center;
          color: var(--color-text-secondary);
          font-weight: var(--font-medium);
          font-size: var(--text-base);
        }

        .results-section {
          background: var(--color-bg-card);
          padding: var(--space-4);
          border-radius: var(--radius-lg);
          border: 1px solid var(--color-border);
          box-shadow: var(--shadow-sm);
        }

        .results-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: var(--space-3);
        }

        .results-header h3 {
          font-family: var(--font-heading);
          margin: 0;
          color: var(--color-primary);
          font-size: var(--text-xl);
          font-weight: var(--font-bold);
        }

        /* Aspect Ratio Info */
        .ar-info {
          padding: var(--space-3) var(--space-4);
          border-radius: var(--radius-md);
          margin-bottom: var(--space-3);
          font-size: var(--text-sm);
        }

        .ar-info.full {
          background: var(--color-success-light);
          border: 1px solid var(--color-success);
        }

        .ar-info.framing {
          background: var(--color-warning-light);
          border: 1px solid var(--color-warning);
        }

        .ar-info.tiling {
          background: var(--color-info-light);
          border: 1px solid var(--color-info);
        }

        .ar-info-header {
          color: var(--color-text-primary);
          margin-bottom: var(--space-2);
          font-weight: var(--font-semibold);
        }

        .ar-info-details {
          display: flex;
          flex-wrap: wrap;
          gap: var(--space-2);
          align-items: center;
          color: var(--color-text-secondary);
          font-size: var(--text-sm);
        }

        .ar-info-details span {
          white-space: nowrap;
        }

        .layout-note {
          color: var(--color-accent);
          font-weight: var(--font-medium);
        }

        /* Mode Toggle Tabs */
        .mode-tabs {
          display: flex;
          gap: var(--space-2);
          margin-bottom: var(--space-3);
          background: var(--color-bg-subtle);
          padding: var(--space-1);
          border-radius: var(--radius-lg);
        }

        .mode-tab {
          flex: 1;
          display: flex;
          flex-direction: row;
          align-items: center;
          justify-content: center;
          gap: var(--space-2);
          padding: var(--space-2);
          background: var(--color-bg-card);
          border: 1px solid var(--color-border);
          border-radius: var(--radius-md);
          cursor: pointer;
          transition: all var(--transition-base);
        }

        .mode-tab:hover:not(:disabled) {
          border-color: var(--color-accent);
          transform: translateY(-2px);
          box-shadow: var(--shadow-md);
        }

        .mode-tab.active {
          background: var(--color-accent);
          border-color: var(--color-accent);
          box-shadow: var(--shadow-glow-accent);
        }

        .mode-tab:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .mode-title {
          font-family: var(--font-heading);
          font-size: var(--text-base);
          font-weight: var(--font-semibold);
          color: var(--color-primary);
        }

        .mode-description {
          display: none; /* Hidden to save space */
        }

        .mode-tab.active .mode-title {
          color: white;
          font-weight: var(--font-bold);
        }

        .svg-preview {
          margin: var(--space-2) 0;
          border: 1px solid var(--color-border);
          border-radius: var(--radius-md);
          background: var(--color-bg-subtle);
          padding: var(--space-2);
        }

        .design-preview {
          width: 100%;
          height: auto;
          display: block;
        }

        /* Finalize Section */
        .finalize-section {
          background: var(--color-accent-light);
          border: 2px solid var(--color-accent);
          border-radius: var(--radius-lg);
          padding: var(--space-3);
          margin-top: var(--space-3);
          text-align: center;
        }

        .finalize-button {
          width: 100%;
          max-width: 400px;
          padding: var(--space-3);
          background: var(--color-accent);
          color: white;
          border: none;
          border-radius: var(--radius-md);
          font-size: var(--text-base);
          font-weight: var(--font-semibold);
          cursor: pointer;
          transition: all var(--transition-base);
          box-shadow: var(--shadow-sm);
        }

        .finalize-button:hover {
          background: var(--color-accent-hover);
          transform: translateY(-1px);
          box-shadow: var(--shadow-md);
        }

        .finalize-hint {
          margin: var(--space-2) 0 0 0;
          color: var(--color-text-secondary);
          font-size: var(--text-xs);
        }

        /* Mixer Widget Container Styles */
        .mixer-widget-container {
          margin-top: var(--space-3);
          background: white;
          border-radius: 12px;
          padding: var(--space-3);
          box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        }

        .mixer-widget-header {
          display: flex;
          justify-content: flex-end;
          margin-bottom: var(--space-2);
          padding-bottom: var(--space-2);
          border-bottom: 2px solid var(--color-border);
        }

        .mixer-close-btn {
          padding: var(--space-2) var(--space-4);
          background: var(--color-primary);
          color: white;
          border: none;
          border-radius: 8px;
          font-weight: 600;
          font-size: var(--text-sm);
          cursor: pointer;
          transition: all 0.2s;
        }

        .mixer-close-btn:hover {
          background: #2563eb;
          box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
          transform: translateY(-1px);
        }

        /* Mobile Responsive Styles */
        @media (max-width: 768px) {
          .inspire-panel-recraft {
            padding: var(--space-2);
          }

          .panel-header {
            margin-bottom: var(--space-4);
          }

          .panel-header h2 {
            font-size: var(--text-xl);
          }

          .subtitle {
            font-size: var(--text-sm);
          }

          .welcome-guidance {
            padding: var(--space-4);
            margin-bottom: var(--space-4);
          }

          .welcome-icon {
            font-size: 2rem;
          }

          .welcome-guidance h3 {
            font-size: var(--text-lg);
          }

          .welcome-guidance p {
            font-size: var(--text-sm);
          }

          /* Stack input mode tabs vertically on mobile */
          .input-mode-tabs {
            flex-direction: column;
            gap: var(--space-1);
          }

          .input-mode-tab {
            flex-direction: row;
            justify-content: flex-start;
            padding: var(--space-3);
            min-height: 44px;
          }

          .mode-icon {
            width: 24px;
            height: 24px;
            flex-shrink: 0;
          }

          .input-mode-tab .mode-title {
            font-size: var(--text-sm);
            margin-top: 0;
          }

          .input-mode-tab .mode-description {
            display: none;
          }

          /* Form sections */
          .form-section {
            padding: var(--space-3);
          }

          .form-group label {
            font-size: var(--text-xs);
          }

          /* Stack form rows on mobile */
          .form-row {
            grid-template-columns: 1fr;
            gap: var(--space-2);
          }

          /* Drop zone adjustments */
          .drop-zone {
            min-height: 140px;
          }

          .drop-zone-content {
            padding: var(--space-4);
            min-height: 140px;
          }

          .upload-icon {
            width: 36px;
            height: 36px;
          }

          .drop-text {
            font-size: var(--text-sm);
          }

          /* Generate button */
          .generate-button {
            padding: var(--space-3);
            font-size: var(--text-base);
            min-height: 44px;
          }

          /* Results section - minimal padding for max image width */
          .results-section {
            padding: var(--space-2);
            border-radius: var(--radius-md);
          }

          .results-header h3 {
            font-size: var(--text-lg);
          }

          /* Mode tabs */
          .mode-tabs {
            flex-direction: column;
            gap: var(--space-1);
          }

          .mode-tab {
            flex-direction: row;
            justify-content: flex-start;
            padding: var(--space-3);
            min-height: 44px;
          }

          .mode-title {
            font-size: var(--text-sm);
          }

          .mode-description {
            display: none;
          }

          /* AR info */
          .ar-info {
            padding: var(--space-2) var(--space-3);
          }

          .ar-info-details {
            flex-direction: column;
            align-items: flex-start;
            gap: var(--space-1);
          }

          /* Finalize section */
          .finalize-section {
            padding: var(--space-3);
          }

          .finalize-button {
            padding: var(--space-3);
            font-size: var(--text-base);
          }
        }

        /* Extra small screens */
        @media (max-width: 480px) {
          .inspire-panel-recraft {
            padding: var(--space-1);
          }

          .panel-header h2 {
            font-size: var(--text-lg);
          }

          /* Results section - even less padding */
          .results-section {
            padding: var(--space-1);
            margin: 0 calc(-1 * var(--space-1));
            border-radius: 0;
          }

          .input-mode-tab {
            padding: var(--space-2);
          }

          .mode-tab {
            padding: var(--space-2);
          }
        }
      `})]})}function jW({isOpen:t,onClose:e}){const[n,r]=R.useState(!1),[s,i]=R.useState(!1),[a,l]=R.useState(!1),{addMotif:c}=it(),d=yd(),{currentDesignId:u,blendSvgUrl:p,solidSvgUrl:h,designName:f}=d,m=p||h,g=!!u;R.useEffect(()=>{if(!t)return;const x=b=>{b.key==="Escape"&&e()};return window.addEventListener("keydown",x),()=>window.removeEventListener("keydown",x)},[t,e]),R.useEffect(()=>{t||(l(!1),r(!1),i(!1))},[t]);const v=R.useCallback((x,b)=>{console.log("[EDITOR] Design saved:",x,b),l(!1)},[]),y=async()=>{var x,b;if(!(!m||n)){r(!0);try{const{blendSvgUrl:w,solidSvgUrl:S,widthMM:_,lengthMM:k}=d;let E=null,T=null;if(S)try{E=await(await fetch(S)).text(),console.log("[EDITOR] Fetched solid SVG from blob:",E.length,"chars")}catch(F){console.error("[EDITOR] Failed to fetch solid SVG:",F)}if(w)try{T=await(await fetch(w)).text(),console.log("[EDITOR] Fetched blend SVG from blob:",T.length,"chars")}catch(F){console.error("[EDITOR] Failed to fetch blend SVG:",F)}if(!E&&!T)throw new Error("No SVG content available. Please ensure a design has been generated.");const q=Df(E||T);let P=_||5e3,W=k||5e3;if(q){const F=q.width/q.height;F>1?(P=Math.max(_||5e3,5e3),W=P/F):(W=Math.max(k||5e3,5e3),P=W*F),console.log("[EDITOR] Using SVG aspect ratio:",F,"",P,"x",W,"mm")}i(!0);let j=u;const G=f||`Design ${new Date().toLocaleString("en-GB",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"})}`,pe=W_(d);j=(await $f({id:j||void 0,name:G,description:"",tags:[],design_data:pe,input_mode:d.inputMode})).design_id,d.setCurrentDesignId(j),d.setDesignName(G),i(!1);const ee=((x=d.result)==null?void 0:x.thumb_url)||((b=d.result)==null?void 0:b.png_url)||null;c(j,G,E||T,P,W,ee,{solidSvgContent:E,blendSvgContent:T,hasBothVersions:!!(E&&T)}),l(!0),setTimeout(()=>{e()},600)}catch(w){console.error("[EDITOR] Failed to add to canvas:",w),alert("Failed to add design to canvas: "+w.message),i(!1)}finally{r(!1)}}};return t?o.jsx("div",{className:"design-editor-overlay",children:o.jsxs("div",{className:"design-editor-modal",children:[o.jsxs("div",{className:"design-editor__header",children:[o.jsx("div",{className:"design-editor__title",children:o.jsx("h2",{children:"Design Editor"})}),o.jsx("div",{className:"design-editor__hint",children:"Generate a design with AI or upload your own SVG"}),o.jsx("button",{className:"design-editor__close",onClick:e,title:"Close (Esc)",children:o.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),o.jsx("div",{className:"design-editor__content",children:o.jsx(kW,{onDesignSaved:v,isEmbedded:!0})}),o.jsx("div",{className:`design-editor__footer ${a?"design-editor__footer--success":""}`,children:a?o.jsxs("div",{className:"design-editor__success",children:[o.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M20 6L9 17l-5-5"})}),o.jsx("span",{children:"Added to canvas!"})]}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"design-editor__status",children:m?g?o.jsxs("span",{className:"design-editor__saved-indicator",children:[o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M20 6L9 17l-5-5"})}),"Saved to library"]}):o.jsx("span",{className:"design-editor__unsaved-indicator",children:"Design ready  Will auto-save when added"}):o.jsx("span",{className:"design-editor__no-design",children:"Generate or upload a design to continue"})}),o.jsxs("div",{className:"design-editor__actions",children:[o.jsx("button",{className:"design-editor__btn design-editor__btn--secondary",onClick:e,children:"Cancel"}),o.jsx("button",{className:"design-editor__btn design-editor__btn--primary",onClick:y,disabled:!m||n,children:n?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"design-editor__spinner"}),s?"Saving...":"Adding..."]}):o.jsxs(o.Fragment,{children:[o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),o.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"16"}),o.jsx("line",{x1:"8",y1:"12",x2:"16",y2:"12"})]}),"Add to Canvas"]})})]})]})})]})}):null}function CW(){const{addShape:t,addText:e,addExclusionZone:n,addCompoundBlob:r,standaloneMode:s,startPathDrawing:i}=it(),[a,l]=R.useState(!1),[c,d]=R.useState(!1);if(s)return null;const u=[{preset:"rectangle",icon:"",label:"Shape"},{preset:"blob",icon:"",label:"Blob"},{preset:"path",icon:"",label:"Pen"}],p=Object.entries(gd).map(([v,y])=>({type:v,icon:y.icon,name:y.name,description:y.description})),h=v=>{v==="path"?(i(),l(!1)):t(v)},f=v=>{r(v),d(!1)},m=()=>{e(),l(!1)},g=()=>{n("rectangle")};return o.jsxs("div",{className:`shape-toolbar ${a?"shape-toolbar--expanded":""}`,children:[o.jsxs("button",{className:"shape-toolbar__toggle",onClick:()=>l(!a),title:a?"Collapse elements panel":"Add elements",children:[o.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("polygon",{points:"12 2 2 7 12 12 22 7 12 2"}),o.jsx("polyline",{points:"2 17 12 22 22 17"}),o.jsx("polyline",{points:"2 12 12 17 22 12"})]}),!a&&o.jsx("span",{className:"shape-toolbar__label",children:"Elements"})]}),a&&o.jsxs("div",{className:"shape-toolbar__shapes",children:[o.jsxs("button",{className:"shape-toolbar__btn shape-toolbar__btn--text",onClick:m,title:"Add Text Label",children:[o.jsx("span",{className:"shape-toolbar__icon",children:"T"}),o.jsx("span",{className:"shape-toolbar__name",children:"Text"})]}),o.jsx("div",{className:"shape-toolbar__divider"}),u.map(v=>o.jsxs("button",{className:"shape-toolbar__btn",onClick:()=>h(v.preset),title:`Add ${v.label}`,children:[o.jsx("span",{className:"shape-toolbar__icon",children:v.icon}),o.jsx("span",{className:"shape-toolbar__name",children:v.label})]},v.preset)),o.jsxs("div",{className:"shape-toolbar__compound-wrapper",children:[o.jsxs("button",{className:`shape-toolbar__btn shape-toolbar__btn--compound ${c?"active":""}`,onClick:()=>d(!c),title:"Add Compound Shape (multi-element blobs)",children:[o.jsx("span",{className:"shape-toolbar__icon",children:""}),o.jsx("span",{className:"shape-toolbar__name",children:"Compound"})]}),c&&o.jsx("div",{className:"shape-toolbar__compound-picker",children:p.map(v=>o.jsxs("button",{className:"shape-toolbar__compound-option",onClick:()=>f(v.type),title:v.description,children:[o.jsx("span",{className:"shape-toolbar__compound-icon",children:v.icon}),o.jsx("span",{className:"shape-toolbar__compound-name",children:v.name})]},v.type))})]}),o.jsx("div",{className:"shape-toolbar__divider"}),o.jsxs("button",{className:"shape-toolbar__btn shape-toolbar__btn--exclusion",onClick:g,title:"Add Exclusion Zone (building, planter, obstacle)",children:[o.jsx("span",{className:"shape-toolbar__icon",style:{fontSize:"1rem"},children:""}),o.jsx("span",{className:"shape-toolbar__name",children:"Exclusion"})]})]})]})}function EW({loadedDesign:t}){var te,ye;const[e,n]=R.useState(!1),[r,s]=R.useState(()=>{const Y=it.getState().surface;return Y!=null&&Y.width_mm?String(Y.width_mm/1e3):"50"}),[i,a]=R.useState(()=>{const Y=it.getState().surface;return Y!=null&&Y.length_mm?String(Y.length_mm/1e3):"50"}),[l,c]=R.useState(!1),[d,u]=R.useState(!1),[p,h]=R.useState(!1),[f,m]=R.useState(!1),[g,v]=R.useState(!1),[y,x]=R.useState(null),[b,w]=R.useState(null),[S,_]=R.useState(""),k=R.useRef(null);R.useEffect(()=>{if(t){const Y=t.design_data||{},M=t.input_mode||Y.input_mode||Y.blend_recipes||Y.solid_recipes,ie=Y.courts||Y.surface||Y.tracks;if(console.log("[TPV] Design detection:",{id:t.id,name:t.name,hasDesignData:!!t.design_data,topLevelInputMode:t.input_mode,isPlaygroundDesign:M,isSportsDesign:ie}),M&&!ie){console.log("[TPV] Loading playground design into editor:",t.id,t.name);const fe=Pp(t),Se=yd.getState();Se.loadDesign(fe),t.name&&Se.setDesignName(t.name),Se.setCurrentDesignId(t.id),m(!0)}else t.design_data?(console.log("[SPORTS] Loading design from prop:",t.id,t.name),it.getState().loadDesign(Y),w(t.id),_(t.name||""),n(!1)):console.warn("[TPV] Design has no design_data and is not a playground design:",t.id,t.name)}},[t]);const{surface:E,courts:T,tracks:O,selectedCourtId:q,selectedTrackId:P,selectedMotifId:W,selectedShapeId:j,selectedTextId:G,showCourtLibrary:pe,showPropertiesPanel:Z,toggleCourtLibrary:ee,togglePropertiesPanel:F,setSurfaceDimensions:K,setSurfaceColor:U,setSurfaceBoundaryPreset:V,resetSurfaceBoundary:J,resetDesign:oe,hasUnsavedChanges:me,standaloneMode:je,toggleStandaloneMode:he,mobileLibraryOpen:Ee,mobilePropertiesOpen:Me,mobileColoursOpen:We,mobileActiveTab:Ie,setMobileLibraryOpen:Je,setMobilePropertiesOpen:Ue,setMobileColoursOpen:C,setMobileActiveTab:Q,closeMobileSheets:ce}=it(),L=Y=>{Y.preventDefault();const M=parseFloat(r)*1e3,ie=parseFloat(i)*1e3;M>0&&ie>0&&(K(M,ie),n(!1))},N=Y=>{U({tpv_code:Y.code,hex:Y.hex,name:Y.name}),c(!1)},I=()=>{me()&&!window.confirm(`Start a new design?

You have unsaved changes that will be lost.`)||(oe(),w(null),_(""),s("50"),a("50"))},H=()=>{const Y=k.current||document.querySelector(".court-canvas__svg");if(!Y){alert("Canvas not ready");return}const M=it.getState().exportDesignData(),ie=zf(Y,M),fe=new Blob([ie],{type:"image/svg+xml"}),Se=URL.createObjectURL(fe);y&&URL.revokeObjectURL(y),x(Se),v(!0)},X=()=>{v(!1),y&&(URL.revokeObjectURL(y),x(null))},z=async Y=>{if(!Y){alert("Source design ID not found");return}try{const M=await Ol(Y),ie=(M==null?void 0:M.design)||M;if(!ie)throw new Error("Design not found");const fe=Pp(ie),Se=yd.getState();Se.loadDesign(fe),ie.name&&Se.setDesignName(ie.name),Se.setCurrentDesignId(Y),m(!0),console.log("[TPV] Loaded source design for editing:",ie.name)}catch(M){console.error("[TPV] Failed to load source design:",M),alert("Failed to load design: "+M.message)}};return R.useEffect(()=>{const Y=M=>{const ie=M.target.tagName.toLowerCase();if(ie==="input"||ie==="textarea"||ie==="select")return;const{removeCourt:fe,removeTrack:Se,removeMotif:De,removeShape:ke,removeText:ae,deselectCourt:ue,deselectTrack:Ge,deselectMotif:Qe,deselectShape:et,deselectText:ht,stopEditingText:lt,undo:Le,redo:de,canUndo:ne,canRedo:ge,duplicateCourt:He,duplicateMotif:mt,duplicateShape:_e,duplicateText:vt,updateCourtPosition:dt,updateTrackPosition:Et,updateMotifPosition:Xe,updateShapePosition:tn,updateTextPosition:fn,courts:nr,tracks:ft,motifs:Lr,shapes:Dr,texts:jn,selectedMotifId:kt,selectedShapeId:Vt,selectedTextId:pt,editingTextId:yr,elementOrder:bt,setElementOrder:Xr,toggleSnapToGrid:xt,snapToGrid:nn,addToHistory:It}=it.getState(),Yt=q||P||kt||Vt||pt;if(M.key==="Delete"&&Yt&&!yr&&(M.preventDefault(),q?fe(q):P?Se(P):kt?De(kt):Vt?ke(Vt):pt&&ae(pt)),M.key==="Escape"&&(yr?lt():Yt&&(q?ue():P?Ge():kt?Qe():Vt?et():pt&&ht())),(M.ctrlKey||M.metaKey)&&M.key==="z"&&!M.shiftKey&&(M.preventDefault(),ne()&&Le()),(M.ctrlKey||M.metaKey)&&M.key==="z"&&M.shiftKey&&(M.preventDefault(),ge()&&de()),(M.ctrlKey||M.metaKey)&&M.key==="d"&&Yt&&(M.preventDefault(),q?He(q):kt?mt(kt):Vt?_e(Vt):pt&&vt(pt)),Yt&&!yr&&["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(M.key)){M.preventDefault();const Tt=M.shiftKey?10:100;let Ct=0,rn=0;if(M.key==="ArrowLeft"&&(Ct=-Tt),M.key==="ArrowRight"&&(Ct=Tt),M.key==="ArrowUp"&&(rn=-Tt),M.key==="ArrowDown"&&(rn=Tt),q){const _t=nr[q];_t&&(dt(q,{x:_t.position.x+Ct,y:_t.position.y+rn}),It())}else if(P){const _t=ft[P];_t&&(Et(P,{x:_t.position.x+Ct,y:_t.position.y+rn}),It())}else if(kt){const _t=Lr[kt];_t&&(Xe(kt,{x:_t.position.x+Ct,y:_t.position.y+rn}),It())}else if(Vt){const _t=Dr[Vt];_t&&(tn(Vt,{x:_t.position.x+Ct,y:_t.position.y+rn}),It())}else if(pt){const _t=jn[pt];_t&&(fn(pt,{x:_t.position.x+Ct,y:_t.position.y+rn}),It())}}if(Yt&&(M.key==="["||M.key==="]")){M.preventDefault();const Tt=bt.indexOf(Yt);if(Tt===-1)return;const Ct=[...bt];M.key==="["&&Tt>0?([Ct[Tt],Ct[Tt-1]]=[Ct[Tt-1],Ct[Tt]],Xr(Ct),It()):M.key==="]"&&Tt<bt.length-1&&([Ct[Tt],Ct[Tt+1]]=[Ct[Tt+1],Ct[Tt]],Xr(Ct),It())}(M.key==="g"||M.key==="G")&&(M.preventDefault(),xt()),(M.key==="?"||M.shiftKey&&M.key==="/")&&(M.preventDefault(),h(!0))};return window.addEventListener("keydown",Y),()=>window.removeEventListener("keydown",Y)},[q,P,W,j,G]),o.jsxs("div",{className:"sports-designer",children:[e&&o.jsx("div",{className:"sports-designer__modal-overlay",onClick:()=>n(!1),children:o.jsxs("div",{className:"sports-designer__modal",onClick:Y=>Y.stopPropagation(),children:[o.jsx("h2",{children:"Edit Surface Size"}),o.jsx("p",{children:"Adjust the dimensions of your sports surface"}),o.jsxs("form",{onSubmit:L,children:[o.jsxs("div",{className:"sports-designer__dimension-inputs",children:[o.jsxs("div",{className:"sports-designer__input-group",children:[o.jsx("label",{htmlFor:"width",children:"Width (metres)"}),o.jsx("input",{id:"width",type:"number",min:"5",max:"100",step:"0.5",value:r,onChange:Y=>s(Y.target.value),required:!0,autoFocus:!0})]}),o.jsx("span",{className:"sports-designer__dimension-separator",children:""}),o.jsxs("div",{className:"sports-designer__input-group",children:[o.jsx("label",{htmlFor:"length",children:"Length (metres)"}),o.jsx("input",{id:"length",type:"number",min:"5",max:"100",step:"0.5",value:i,onChange:Y=>a(Y.target.value),required:!0})]})]}),o.jsx("p",{className:"sports-designer__dimension-hint",children:"Common sizes: 37m  34m (tennis), 40m  20m (futsal), 50m  50m (multi-sport)"}),o.jsxs("div",{className:"sports-designer__boundary-section",children:[o.jsx("label",{htmlFor:"boundary-shape",children:"Surface Shape"}),o.jsxs("div",{className:"sports-designer__boundary-options",children:[o.jsxs("select",{id:"boundary-shape",value:((te=E.boundary)==null?void 0:te.type)==="polygon"?E.boundary.preset||"custom":"rectangle",onChange:Y=>{const M=Y.target.value;M==="rectangle"?J():V(M)},className:"sports-designer__select",children:[o.jsx("option",{value:"rectangle",children:"Rectangle (default)"}),o.jsx("option",{value:"l-shape",children:"L-Shape"}),o.jsx("option",{value:"u-shape",children:"U-Shape"}),o.jsx("option",{value:"t-shape",children:"T-Shape"})]}),((ye=E.boundary)==null?void 0:ye.type)==="polygon"&&o.jsx("button",{type:"button",className:"sports-designer__btn-secondary",onClick:J,title:"Reset to rectangle",children:"Reset"})]}),o.jsx("p",{className:"sports-designer__boundary-hint",children:"Non-rectangular shapes are useful for L-shaped buildings or irregular sites"})]}),o.jsx("button",{type:"submit",className:"sports-designer__btn-primary",children:"Update Surface"})]})]})}),o.jsxs(o.Fragment,{children:[o.jsxs("header",{className:"sports-designer__mobile-header",children:[o.jsx("span",{className:"sports-designer__mobile-header-title",children:"TPV Designer"}),o.jsxs("div",{className:"sports-designer__mobile-header-actions",children:[o.jsx("button",{className:"sports-designer__mobile-header-btn",onClick:()=>{s(String(E.width_mm/1e3)),a(String(E.length_mm/1e3)),n(!0)},title:"Surface settings",children:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"12",cy:"12",r:"3"}),o.jsx("path",{d:"M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z"})]})}),o.jsx(ry,{svgRef:k,mobileMode:!0})]})]}),o.jsxs("nav",{className:"sports-designer__mobile-action-bar",children:[o.jsxs("button",{className:`sports-designer__mobile-action-btn ${Ee?"sports-designer__mobile-action-btn--active":""}`,onClick:()=>{ce(),Je(!0)},children:[o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"12",cy:"12",r:"10"}),o.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"16"}),o.jsx("line",{x1:"8",y1:"12",x2:"16",y2:"12"})]}),o.jsx("span",{children:"Add"})]}),o.jsxs("button",{className:"sports-designer__mobile-action-btn",onClick:()=>{ce(),C(!0)},children:[o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"13.5",cy:"6.5",r:"2.5"}),o.jsx("circle",{cx:"17.5",cy:"10.5",r:"2.5"}),o.jsx("circle",{cx:"8.5",cy:"7.5",r:"2.5"}),o.jsx("circle",{cx:"6.5",cy:"12.5",r:"2.5"})]}),o.jsx("span",{children:"Colours"})]}),o.jsxs("button",{className:`sports-designer__mobile-action-btn ${q||P||W||j||G?"":"sports-designer__mobile-action-btn--disabled"}`,onClick:()=>{(q||P||W||j||G)&&(ce(),Ue(!0))},disabled:!q&&!P&&!W&&!j&&!G,children:[o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("line",{x1:"4",y1:"21",x2:"4",y2:"14"}),o.jsx("line",{x1:"4",y1:"10",x2:"4",y2:"3"}),o.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"12"}),o.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"3"}),o.jsx("line",{x1:"20",y1:"21",x2:"20",y2:"16"}),o.jsx("line",{x1:"20",y1:"12",x2:"20",y2:"3"}),o.jsx("line",{x1:"1",y1:"14",x2:"7",y2:"14"}),o.jsx("line",{x1:"9",y1:"8",x2:"15",y2:"8"}),o.jsx("line",{x1:"17",y1:"16",x2:"23",y2:"16"})]}),o.jsx("span",{children:"Properties"})]}),o.jsxs("button",{className:"sports-designer__mobile-action-btn",onClick:()=>u(!0),children:[o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z"}),o.jsx("polyline",{points:"17 21 17 13 7 13 7 21"}),o.jsx("polyline",{points:"7 3 7 8 15 8"})]}),o.jsx("span",{children:"Save"})]})]}),o.jsx("div",{className:`sports-designer__bottom-sheet-overlay ${Ee?"sports-designer__bottom-sheet-overlay--open":""}`,onClick:()=>Je(!1)}),o.jsxs("div",{className:`sports-designer__bottom-sheet ${Ee?"sports-designer__bottom-sheet--open":""}`,children:[o.jsx("div",{className:"sports-designer__bottom-sheet-handle"}),o.jsxs("div",{className:"sports-designer__bottom-sheet-header",children:[o.jsx("h3",{children:"Add Element"}),o.jsx("button",{className:"sports-designer__bottom-sheet-close",onClick:()=>Je(!1),children:o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),o.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),o.jsxs("div",{className:"sports-designer__mobile-tabs",children:[o.jsx("button",{className:`sports-designer__mobile-tab ${Ie==="courts"?"sports-designer__mobile-tab--active":""}`,onClick:()=>Q("courts"),children:"Courts"}),o.jsx("button",{className:`sports-designer__mobile-tab ${Ie==="tracks"?"sports-designer__mobile-tab--active":""}`,onClick:()=>Q("tracks"),children:"Tracks"}),o.jsx("button",{className:`sports-designer__mobile-tab ${Ie==="shapes"?"sports-designer__mobile-tab--active":""}`,onClick:()=>Q("shapes"),children:"Shapes"}),o.jsx("button",{className:`sports-designer__mobile-tab ${Ie==="designs"?"sports-designer__mobile-tab--active":""}`,onClick:()=>Q("designs"),children:"Designs"})]}),o.jsx("div",{className:"sports-designer__bottom-sheet-content",children:o.jsx(V0,{mobileMode:!0,activeTab:Ie,onItemAdded:()=>Je(!1),onOpenGenerator:()=>{Je(!1),m(!0)}})})]}),o.jsx("div",{className:`sports-designer__bottom-sheet-overlay ${We?"sports-designer__bottom-sheet-overlay--open":""}`,onClick:()=>C(!1)}),o.jsxs("div",{className:`sports-designer__bottom-sheet ${We?"sports-designer__bottom-sheet--open":""}`,children:[o.jsx("div",{className:"sports-designer__bottom-sheet-handle"}),o.jsxs("div",{className:"sports-designer__bottom-sheet-header",children:[o.jsx("h3",{children:"Surface Colour"}),o.jsx("button",{className:"sports-designer__bottom-sheet-close",onClick:()=>C(!1),children:o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),o.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),o.jsx("div",{className:"sports-designer__bottom-sheet-content",children:o.jsx("div",{className:"sports-designer__color-grid",children:pn.map(Y=>o.jsx("button",{className:`sports-designer__color-swatch ${E.color.tpv_code===Y.code?"sports-designer__color-swatch--selected":""}`,style:{backgroundColor:Y.hex},onClick:()=>{N(Y),C(!1)},title:`${Y.code} - ${Y.name}`,children:o.jsx("span",{className:"sports-designer__color-code",children:Y.code})},Y.code))})})]}),o.jsx("div",{className:`sports-designer__bottom-sheet-overlay ${Me?"sports-designer__bottom-sheet-overlay--open":""}`,onClick:()=>Ue(!1)}),o.jsxs("div",{className:`sports-designer__bottom-sheet ${Me?"sports-designer__bottom-sheet--open":""}`,children:[o.jsx("div",{className:"sports-designer__bottom-sheet-handle"}),o.jsxs("div",{className:"sports-designer__bottom-sheet-header",children:[o.jsx("h3",{children:"Properties"}),o.jsx("button",{className:"sports-designer__bottom-sheet-close",onClick:()=>Ue(!1),children:o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),o.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),o.jsx("div",{className:"sports-designer__bottom-sheet-content",children:(q||P||W||j||G)&&o.jsx(Y0,{mobileMode:!0,onEditSourceDesign:z})})]}),o.jsxs("div",{className:"sports-designer__content",children:[!je&&o.jsxs("aside",{className:`sports-designer__sidebar ${pe?"":"sports-designer__sidebar--collapsed"}`,children:[o.jsxs("div",{className:"sidebar-content",children:[o.jsx(V0,{onOpenGenerator:()=>m(!0)}),o.jsx(X5,{})]}),o.jsx("button",{className:"sidebar-toggle sidebar-toggle--left",onClick:ee,title:pe?"Collapse library":"Expand library",children:o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:pe?o.jsx("polyline",{points:"15 18 9 12 15 6"}):o.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),o.jsxs("main",{className:"sports-designer__canvas-container",children:[o.jsxs("div",{className:"sports-toolbar",children:[o.jsxs("div",{className:"sports-toolbar__group",children:[o.jsx("button",{className:`sports-toolbar__btn ${pe?"sports-toolbar__btn--active":""}`,onClick:ee,title:"Element Library",disabled:je,children:o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),o.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),o.jsx("rect",{x:"3",y:"14",width:"7",height:"7"}),o.jsx("rect",{x:"14",y:"14",width:"7",height:"7"})]})}),o.jsx("button",{className:`sports-toolbar__btn ${Z&&(q||P||W||j||G)?"sports-toolbar__btn--active":""}`,onClick:F,title:"Properties",disabled:!q&&!P&&!W&&!j&&!G||je,children:o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("line",{x1:"4",y1:"21",x2:"4",y2:"14"}),o.jsx("line",{x1:"4",y1:"10",x2:"4",y2:"3"}),o.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"12"}),o.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"3"}),o.jsx("line",{x1:"20",y1:"21",x2:"20",y2:"16"}),o.jsx("line",{x1:"20",y1:"12",x2:"20",y2:"3"}),o.jsx("line",{x1:"1",y1:"14",x2:"7",y2:"14"}),o.jsx("line",{x1:"9",y1:"8",x2:"15",y2:"8"}),o.jsx("line",{x1:"17",y1:"16",x2:"23",y2:"16"})]})})]}),o.jsx("div",{className:"sports-toolbar__divider"}),o.jsx("div",{className:"sports-toolbar__group",children:o.jsx("button",{className:`sports-toolbar__mode-toggle ${je?"sports-toolbar__mode-toggle--active":""}`,onClick:he,title:je?"Switch to Edit Mode":"Switch to Focus Mode",children:je?o.jsxs(o.Fragment,{children:[o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"})}),o.jsx("span",{children:"Focus"})]}):o.jsxs(o.Fragment,{children:[o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),o.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),o.jsx("rect",{x:"3",y:"14",width:"7",height:"7"}),o.jsx("rect",{x:"14",y:"14",width:"7",height:"7"})]}),o.jsx("span",{children:"Edit"})]})})}),o.jsx("div",{className:"sports-toolbar__divider"}),o.jsxs("div",{className:"sports-toolbar__group",children:[o.jsxs("button",{className:"sports-toolbar__dimensions",onClick:()=>{s(String(E.width_mm/1e3)),a(String(E.length_mm/1e3)),n(!0)},title:"Click to edit surface size",children:[(E.width_mm/1e3).toFixed(0),"m  ",(E.length_mm/1e3).toFixed(0),"m"]}),o.jsx("button",{className:"sports-toolbar__color-swatch",style:{backgroundColor:E.color.hex},onClick:()=>c(!0),title:`${E.color.name} (${E.color.tpv_code}) - Click to change`})]}),o.jsx("div",{className:"sports-toolbar__divider"}),o.jsxs("div",{className:"sports-toolbar__group",children:[o.jsx("button",{className:"sports-toolbar__btn",disabled:!it.getState().canUndo(),onClick:()=>it.getState().undo(),title:"Undo (Ctrl+Z)",children:o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("path",{d:"M3 7v6h6"}),o.jsx("path",{d:"M21 17a9 9 0 00-9-9 9 9 0 00-6 2.3L3 13"})]})}),o.jsx("button",{className:"sports-toolbar__btn",disabled:!it.getState().canRedo(),onClick:()=>it.getState().redo(),title:"Redo (Ctrl+Shift+Z)",children:o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("path",{d:"M21 7v6h-6"}),o.jsx("path",{d:"M3 17a9 9 0 019-9 9 9 0 016 2.3l3 2.7"})]})})]}),o.jsx("div",{className:"sports-toolbar__divider"}),o.jsxs("div",{className:"sports-toolbar__group",children:[o.jsx("button",{className:"sports-toolbar__btn",onClick:I,title:"Start new design",children:o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),o.jsx("polyline",{points:"14 2 14 8 20 8"}),o.jsx("line",{x1:"12",y1:"18",x2:"12",y2:"12"}),o.jsx("line",{x1:"9",y1:"15",x2:"15",y2:"15"})]})}),o.jsx("button",{className:"sports-toolbar__btn",onClick:H,title:"View In-Situ Preview",children:o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),o.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),o.jsx("polyline",{points:"21 15 16 10 5 21"})]})}),o.jsx("button",{className:"sports-toolbar__btn",onClick:()=>h(!0),title:"Keyboard shortcuts (?)",children:o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("circle",{cx:"12",cy:"12",r:"10"}),o.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),o.jsx("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]})}),o.jsx("button",{className:"sports-toolbar__btn-primary",onClick:()=>u(!0),children:"Save"}),o.jsx(ry,{svgRef:k})]})]}),o.jsx(w5,{ref:k}),o.jsx(CW,{})]}),(q||P||W||j||G)&&!je&&o.jsxs("aside",{className:`sports-designer__properties ${Z?"":"sports-designer__properties--collapsed"}`,children:[o.jsx("button",{className:"sidebar-toggle sidebar-toggle--right",onClick:F,title:Z?"Collapse properties":"Expand properties",children:o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:Z?o.jsx("polyline",{points:"9 18 15 12 9 6"}):o.jsx("polyline",{points:"15 18 9 12 15 6"})})}),o.jsx("div",{className:"sidebar-content",children:o.jsx(Y0,{onEditSourceDesign:z})})]})]}),l&&o.jsx("div",{className:"sports-designer__color-modal-overlay",onClick:()=>c(!1),children:o.jsxs("div",{className:"sports-designer__color-modal",onClick:Y=>Y.stopPropagation(),children:[o.jsxs("div",{className:"sports-designer__color-modal-header",children:[o.jsx("h4",{children:"Select Surface Colour"}),o.jsx("button",{onClick:()=>c(!1),children:""})]}),o.jsx("div",{className:"sports-designer__color-grid",children:pn.map(Y=>o.jsx("button",{className:`sports-designer__color-swatch ${E.color.tpv_code===Y.code?"sports-designer__color-swatch--selected":""}`,style:{backgroundColor:Y.hex},onClick:()=>N(Y),title:`${Y.code} - ${Y.name}`,children:o.jsx("span",{className:"sports-designer__color-code",children:Y.code})},Y.code))})]})}),d&&o.jsx(oT,{existingDesignId:b,initialName:S,svgRef:k,onClose:()=>u(!1),onSaved:(Y,M)=>{w(Y.design_id),_(M),console.log("[SPORTS] Design saved:",Y.design_id)}}),o.jsx(EP,{isOpen:p,onClose:()=>h(!1)}),o.jsx(jW,{isOpen:f,onClose:()=>m(!1)}),g&&y&&o.jsx(Y_,{designUrl:y,designDimensions:{width:E.width_mm,length:E.length_mm},onClose:X,onSaved:Y=>{console.log("[TPV] In-situ preview saved:",Y),X()}})]})]})}function TW({onShowDesigns:t,onShowAdmin:e,isAdmin:n,currentDesignName:r}){const[s,i]=R.useState(!1),a=async()=>{confirm("Sign out?")&&(await Nr.signOut(),window.location.reload())};return o.jsx("header",{className:"studio-header",children:o.jsxs("div",{className:"header-content",children:[o.jsxs("div",{className:"header-left",children:[o.jsx("h1",{className:"studio-title",children:"TPV Designer"}),r&&o.jsxs("span",{className:"current-design-indicator",children:[o.jsx("svg",{width:"4",height:"4",viewBox:"0 0 4 4",children:o.jsx("circle",{cx:"2",cy:"2",r:"2",fill:"currentColor"})}),r]})]}),o.jsxs("div",{className:"header-right",children:[o.jsxs("button",{onClick:t,className:"btn-my-designs",children:[o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"}),o.jsx("path",{d:"M9 22V12h6v10"})]}),"My Designs"]}),n&&o.jsxs("button",{onClick:e,className:"btn-admin",children:[o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M12 15a3 3 0 100-6 3 3 0 000 6z"}),o.jsx("path",{d:"M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z"})]}),"Admin"]}),o.jsxs("div",{className:"user-menu",children:[o.jsx("button",{onClick:()=>i(!s),className:"user-menu-button",children:o.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"}),o.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),s&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"user-menu-backdrop",onClick:()=>i(!1)}),o.jsx("div",{className:"user-menu-dropdown",children:o.jsxs("button",{onClick:a,className:"menu-item sign-out",children:[o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4M16 17l5-5-5-5M21 12H9"})}),"Sign Out"]})})]})]})]})]})})}function NW({design:t,onLoad:e,onDelete:n,onUpdateMetadata:r}){var m;const[s,i]=R.useState(!1),[a,l]=R.useState(!1),c=async()=>{if(confirm(`Delete "${t.name}"? This cannot be undone.`)){l(!0);try{await n(t.id)}catch(g){console.error("Failed to delete design:",g),alert(`Failed to delete: ${g.message}`),l(!1)}}},d=g=>{const v=new Date(g),y=new Date,x=y-v,b=Math.floor(x/(1e3*60*60*24));return b===0?"Today":b===1?"Yesterday":b<7?`${b} days ago`:b<30?`${Math.floor(b/7)} weeks ago`:v.toLocaleDateString("en-GB",{day:"numeric",month:"short",year:v.getFullYear()!==y.getFullYear()?"numeric":void 0})},u=t.input_mode==="sports_surface"||((m=t.design_data)==null?void 0:m.type)==="sports_surface",p=t.thumbnail_url||t.original_png_url||t.original_svg_url,f=u?{label:"Surface",icon:"",className:"type-surface"}:{label:"Motif",icon:"",className:"type-motif"};return o.jsxs("div",{className:`design-card ${a?"deleting":""}`,onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),children:[o.jsxs("div",{className:`design-type-badge ${f.className}`,children:[o.jsx("span",{className:"type-icon",children:f.icon}),o.jsx("span",{className:"type-label",children:f.label})]}),o.jsxs("div",{className:"card-thumbnail",onClick:()=>e(t.id),children:[p?o.jsx("img",{src:p,alt:t.name}):o.jsx("div",{className:"no-thumbnail",children:o.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[o.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),o.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),o.jsx("polyline",{points:"21 15 16 10 5 21"})]})}),s&&o.jsx("div",{className:"thumbnail-overlay",children:o.jsx("button",{className:"btn-load",children:"Open"})})]}),o.jsxs("div",{className:"card-info",children:[o.jsx("h3",{className:"design-name",title:t.name,children:t.name}),t.description&&o.jsx("p",{className:"design-description",title:t.description,children:t.description}),o.jsxs("div",{className:"card-meta",children:[t.projects&&o.jsx("span",{className:"project-badge",style:{backgroundColor:t.projects.color||"#1a365d"},title:t.projects.name,children:t.projects.name}),o.jsx("span",{className:"design-date",title:new Date(t.updated_at).toLocaleString(),children:d(t.updated_at)})]}),t.tags&&t.tags.length>0&&o.jsxs("div",{className:"design-tags",children:[t.tags.slice(0,3).map((g,v)=>o.jsx("span",{className:"tag",children:g},v)),t.tags.length>3&&o.jsxs("span",{className:"tag more",children:["+",t.tags.length-3]})]})]}),s&&!a&&o.jsxs("div",{className:"card-actions",children:[o.jsx("button",{onClick:()=>e(t.id),className:"action-btn load-btn",title:"Load design",children:o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),o.jsx("circle",{cx:"12",cy:"12",r:"3"})]})}),o.jsx("button",{onClick:c,className:"action-btn delete-btn",title:"Delete design",children:o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]}),a&&o.jsx("div",{className:"deleting-overlay",children:o.jsx("div",{className:"spinner"})})]})}function PW({onClose:t,onLoadDesign:e}){const[n,r]=R.useState([]),[s,i]=R.useState([]),[a,l]=R.useState(!0),[c,d]=R.useState(null),[u,p]=R.useState(""),[h,f]=R.useState(""),[m,g]=R.useState(!1),[v,y]=R.useState(!1);R.useEffect(()=>{x()},[u,h]);const x=async()=>{l(!0),d(null);try{const[_,k]=await Promise.all([If(),md({project_id:u||void 0,search:h||void 0,limit:12,offset:0})]);i(_.projects),r(k.designs),g(k.pagination.has_more)}catch(_){console.error("Failed to load designs:",_),d(_.message)}finally{l(!1)}},b=async()=>{if(!(v||!m)){y(!0);try{const _=await md({project_id:u||void 0,search:h||void 0,limit:12,offset:n.length});r([...n,..._.designs]),g(_.pagination.has_more)}catch(_){console.error("Failed to load more designs:",_),d(_.message)}finally{y(!1)}}},w=async _=>{try{const{design:k}=await Ol(_);e(k),t()}catch(k){console.error("Failed to load design:",k),alert(`Failed to load design: ${k.message}`)}},S=async _=>{try{await oE(_),r(n.filter(k=>k.id!==_))}catch(k){throw console.error("Failed to delete design:",k),k}};return o.jsx("div",{className:"modal-overlay",onClick:t,children:o.jsxs("div",{className:"modal-content design-gallery-modal",onClick:_=>_.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsx("h2",{children:"My Designs"}),o.jsx("button",{onClick:t,className:"close-button",children:""})]}),o.jsxs("div",{className:"gallery-filters",children:[o.jsx("div",{className:"filter-group",children:o.jsx("input",{type:"text",placeholder:"Search designs...",value:h,onChange:_=>f(_.target.value),className:"search-input"})}),o.jsx("div",{className:"filter-group",children:o.jsxs("select",{value:u,onChange:_=>p(_.target.value),className:"project-filter",children:[o.jsx("option",{value:"",children:"All Projects"}),s.map(_=>o.jsxs("option",{value:_.id,children:[_.name," (",_.design_count,")"]},_.id))]})})]}),o.jsxs("div",{className:"modal-body",children:[c&&o.jsxs("div",{className:"error-message",children:[c,o.jsx("button",{onClick:x,className:"btn-retry",children:"Retry"})]}),a?o.jsxs("div",{className:"loading-state",children:[o.jsx("div",{className:"spinner-large"}),o.jsx("p",{children:"Loading your designs..."})]}):n.length===0?o.jsxs("div",{className:"empty-state",children:[o.jsxs("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[o.jsx("path",{d:"M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z"}),o.jsx("path",{d:"M17 21v-8H7v8M7 3v5h8"})]}),o.jsx("h3",{children:"No designs yet"}),o.jsx("p",{children:h||u?"No designs match your filters. Try adjusting your search.":"Create your first design to see it here!"})]}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"designs-grid",children:n.map(_=>o.jsx(NW,{design:_,onLoad:w,onDelete:S},_.id))}),m&&o.jsx("div",{className:"load-more-section",children:o.jsx("button",{onClick:b,className:"btn-load-more",disabled:v,children:v?"Loading...":"Load More"})})]})]})]})})}function RW(){const[t,e]=R.useState([]),[n,r]=R.useState(0),[s,i]=R.useState(!1),[a,l]=R.useState(null),[c,d]=R.useState("all"),[u,p]=R.useState("all"),[h,f]=R.useState(""),[m,g]=R.useState(0),v=50,y=async()=>{var E,T;const _=await an.auth.getSession();return{"Content-Type":"application/json",Authorization:`Bearer ${(T=(E=_==null?void 0:_.data)==null?void 0:E.session)==null?void 0:T.access_token}`}},x=async()=>{i(!0),l(null);try{const _=await y(),k=new URLSearchParams({limit:v.toString(),offset:m.toString()});c!=="all"&&k.append("status",c),u!=="all"&&k.append("saved_status",u),h&&k.append("search",h);const E=await fetch(`/api/admin/jobs?${k.toString()}`,{headers:_}),T=await E.json();if(!E.ok)throw new Error(T.error||"Failed to fetch jobs");e(T.jobs),r(T.total)}catch(_){console.error("Failed to fetch jobs:",_),l(_.message)}finally{i(!1)}};R.useEffect(()=>{x()},[c,u,h,m]);const b=t.filter(_=>_.status==="completed").length,w=t.filter(_=>!_.is_saved&&_.status==="completed").length,S=t.filter(_=>_.is_saved).length;return o.jsxs("div",{className:"generations-tab",children:[o.jsxs("div",{className:"admin-stats-grid",children:[o.jsxs("div",{className:"admin-stat-card",children:[o.jsx("h3",{children:"Total Generations"}),o.jsx("p",{className:"stat-value",children:n}),o.jsx("span",{className:"stat-label",children:"All time"})]}),o.jsxs("div",{className:"admin-stat-card",children:[o.jsx("h3",{children:"Completed"}),o.jsx("p",{className:"stat-value",children:b}),o.jsx("span",{className:"stat-label",children:"Current page"})]}),o.jsxs("div",{className:"admin-stat-card success",children:[o.jsx("h3",{children:"Saved"}),o.jsx("p",{className:"stat-value",children:S}),o.jsx("span",{className:"stat-label",children:" Linked to designs"})]}),o.jsxs("div",{className:"admin-stat-card warning",children:[o.jsx("h3",{children:"Orphaned"}),o.jsx("p",{className:"stat-value",children:w}),o.jsx("span",{className:"stat-label",children:" Not saved"})]})]}),o.jsxs("div",{className:"admin-filters",children:[o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{children:"Status:"}),o.jsxs("select",{value:c,onChange:_=>d(_.target.value),children:[o.jsx("option",{value:"all",children:"All"}),o.jsx("option",{value:"completed",children:"Completed"}),o.jsx("option",{value:"failed",children:"Failed"}),o.jsx("option",{value:"running",children:"Running"}),o.jsx("option",{value:"queued",children:"Queued"})]})]}),o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{children:"Saved:"}),o.jsxs("select",{value:u,onChange:_=>p(_.target.value),children:[o.jsx("option",{value:"all",children:"All"}),o.jsx("option",{value:"saved",children:"Saved only"}),o.jsx("option",{value:"orphaned",children:"Orphaned only"})]})]}),o.jsxs("div",{className:"filter-group search",children:[o.jsx("label",{children:"Search prompt:"}),o.jsx("input",{type:"text",placeholder:"Search in prompts...",value:h,onChange:_=>f(_.target.value)})]})]}),s&&o.jsxs("div",{className:"admin-loading",children:[o.jsx("div",{className:"spinner"}),o.jsx("p",{children:"Loading jobs..."})]}),a&&o.jsx("div",{className:"admin-error",children:o.jsxs("p",{children:["Error: ",a]})}),!s&&t.length>0&&o.jsx("div",{className:"jobs-table-container",children:o.jsxs("table",{className:"jobs-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Thumbnail"}),o.jsx("th",{children:"Prompt"}),o.jsx("th",{children:"Dimensions"}),o.jsx("th",{children:"Status"}),o.jsx("th",{children:"Saved"}),o.jsx("th",{children:"User"}),o.jsx("th",{children:"Created"})]})}),o.jsx("tbody",{children:t.map(_=>o.jsxs("tr",{className:`job-row ${_.is_saved?"saved":"orphaned"} ${_.status}`,children:[o.jsx("td",{className:"thumbnail-cell",children:_.thumbnail_url?o.jsx("img",{src:_.thumbnail_url,alt:"Design",className:"job-thumbnail"}):o.jsx("div",{className:"thumbnail-placeholder",children:"No image"})}),o.jsx("td",{className:"prompt-cell",children:o.jsx("div",{className:"prompt-text",title:_.prompt,children:_.prompt||o.jsx("em",{children:"No prompt"})})}),o.jsx("td",{className:"dimensions-cell",children:_.width_mm&&_.length_mm?o.jsxs("span",{children:[_.width_mm,"  ",_.length_mm," mm"]}):o.jsx("em",{children:"N/A"})}),o.jsx("td",{className:"status-cell",children:o.jsx("span",{className:`status-badge ${_.status}`,children:_.status})}),o.jsx("td",{className:"saved-cell",children:_.is_saved?o.jsx("span",{className:"saved-badge",children:" Saved"}):o.jsx("span",{className:"orphaned-badge",children:" Orphaned"})}),o.jsx("td",{className:"user-cell",children:_.user_email}),o.jsx("td",{className:"date-cell",children:new Date(_.created_at).toLocaleDateString()})]},_.id))})]})}),!s&&t.length===0&&o.jsx("div",{className:"admin-empty",children:o.jsx("p",{children:"No jobs found matching your filters."})}),n>v&&o.jsxs("div",{className:"admin-pagination",children:[o.jsx("button",{onClick:()=>g(Math.max(0,m-v)),disabled:m===0,children:"Previous"}),o.jsxs("span",{children:["Showing ",m+1," to ",Math.min(m+v,n)," of ",n]}),o.jsx("button",{onClick:()=>g(m+v),disabled:m+v>=n,children:"Next"})]}),o.jsx("style",{children:`
        .jobs-table-container {
          overflow-x: auto;
          background: white;
          border-radius: 8px;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .jobs-table {
          width: 100%;
          border-collapse: collapse;
        }

        .jobs-table th {
          background: #f9fafb;
          padding: 1rem;
          text-align: left;
          font-weight: 600;
          font-size: 0.875rem;
          color: #374151;
          border-bottom: 1px solid #e5e7eb;
        }

        .jobs-table td {
          padding: 1rem;
          border-bottom: 1px solid #e5e7eb;
        }

        .job-row.saved {
          background: rgba(16, 185, 129, 0.03);
        }

        .job-row.orphaned {
          background: rgba(245, 158, 11, 0.03);
        }

        .thumbnail-cell {
          width: 80px;
        }

        .job-thumbnail {
          width: 64px;
          height: 64px;
          object-fit: cover;
          border-radius: 4px;
        }

        .thumbnail-placeholder {
          width: 64px;
          height: 64px;
          background: #f3f4f6;
          border-radius: 4px;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 0.75rem;
          color: #9ca3af;
        }

        .prompt-cell {
          max-width: 300px;
        }

        .prompt-text {
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
        }

        .status-badge {
          display: inline-block;
          padding: 0.25rem 0.75rem;
          border-radius: 9999px;
          font-size: 0.75rem;
          font-weight: 500;
        }

        .status-badge.completed {
          background: #d1fae5;
          color: #065f46;
        }

        .status-badge.failed {
          background: #fee2e2;
          color: #991b1b;
        }

        .status-badge.running {
          background: #dbeafe;
          color: #1e40af;
        }

        .status-badge.queued {
          background: #e0e7ff;
          color: #3730a3;
        }

        .saved-badge {
          color: #059669;
          font-weight: 500;
        }

        .orphaned-badge {
          color: #d97706;
          font-weight: 500;
        }

        .user-cell {
          font-size: 0.875rem;
          color: #6b7280;
        }

        .date-cell {
          font-size: 0.875rem;
          color: #6b7280;
          white-space: nowrap;
        }

        .admin-stat-card.success {
          border-left: 4px solid #10b981;
        }

        .admin-stat-card.warning {
          border-left: 4px solid #f59e0b;
        }
      `})]})}function OW(){const[t,e]=R.useState([]),[n,r]=R.useState(null),[s,i]=R.useState(!1),[a,l]=R.useState(null),[c,d]=R.useState(!1),[u,p]=R.useState(new Set),[h,f]=R.useState("all"),m=async()=>{var _,k;const w=await an.auth.getSession();return{"Content-Type":"application/json",Authorization:`Bearer ${(k=(_=w==null?void 0:w.data)==null?void 0:_.session)==null?void 0:k.access_token}`}},g=async()=>{i(!0),l(null);try{const w=await m(),S=new URLSearchParams;h!=="all"&&S.append("age_filter",h);const _=await fetch(`/api/admin/recovery/orphaned?${S.toString()}`,{headers:w}),k=await _.json();if(!_.ok)throw new Error(k.error||"Failed to fetch orphaned jobs");e(k.orphaned_jobs),r(k.age_buckets)}catch(w){console.error("Failed to fetch orphaned jobs:",w),l(w.message)}finally{i(!1)}};R.useEffect(()=>{g()},[h]);const v=w=>{const S=new Set(u);S.has(w)?S.delete(w):S.add(w),p(S)},y=()=>{p(new Set(t.map(w=>w.id)))},x=()=>{p(new Set)},b=async()=>{if(u.size===0){alert("Please select at least one job to recover");return}if(confirm(`Recover ${u.size} orphaned ${u.size===1?"design":"designs"}?`)){d(!0),l(null);try{const w=await m(),S=await fetch("/api/admin/recovery/create",{method:"POST",headers:w,body:JSON.stringify({job_ids:Array.from(u)})}),_=await S.json();if(!S.ok)throw new Error(_.error||"Failed to recover designs");alert(`Successfully recovered ${_.recovered_count} ${_.recovered_count===1?"design":"designs"}!`),x(),await g()}catch(w){console.error("Failed to recover designs:",w),l(w.message),alert(`Recovery failed: ${w.message}`)}finally{d(!1)}}};return o.jsxs("div",{className:"recovery-tab",children:[o.jsxs("div",{className:"admin-stats-grid",children:[o.jsxs("div",{className:"admin-stat-card warning",children:[o.jsx("h3",{children:"Total Orphaned"}),o.jsx("p",{className:"stat-value",children:t.length}),o.jsx("span",{className:"stat-label",children:"Designs not saved"})]}),n&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"admin-stat-card",children:[o.jsx("h3",{children:"<24 hours"}),o.jsx("p",{className:"stat-value",children:n["<24h"]}),o.jsx("span",{className:"stat-label",children:"Recent"})]}),o.jsxs("div",{className:"admin-stat-card",children:[o.jsx("h3",{children:"1-7 days"}),o.jsx("p",{className:"stat-value",children:n["1-7d"]}),o.jsx("span",{className:"stat-label",children:"This week"})]}),o.jsxs("div",{className:"admin-stat-card",children:[o.jsx("h3",{children:">7 days"}),o.jsx("p",{className:"stat-value",children:n["7-30d"]+n[">30d"]}),o.jsx("span",{className:"stat-label",children:"Older"})]})]})]}),o.jsxs("div",{className:"recovery-controls",children:[o.jsx("div",{className:"admin-filters",children:o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{children:"Age:"}),o.jsxs("select",{value:h,onChange:w=>f(w.target.value),children:[o.jsx("option",{value:"all",children:"All"}),o.jsx("option",{value:"24h",children:"<24 hours"}),o.jsx("option",{value:"7d",children:"<7 days"}),o.jsx("option",{value:"30d",children:"<30 days"})]})]})}),o.jsxs("div",{className:"bulk-actions",children:[o.jsx("button",{onClick:y,className:"btn-secondary",children:"Select All"}),o.jsxs("button",{onClick:x,className:"btn-secondary",children:["Clear (",u.size,")"]}),o.jsx("button",{onClick:b,disabled:u.size===0||c,className:"btn-primary",children:c?"Recovering...":`Recover Selected (${u.size})`})]})]}),s&&o.jsxs("div",{className:"admin-loading",children:[o.jsx("div",{className:"spinner"}),o.jsx("p",{children:"Loading orphaned jobs..."})]}),a&&o.jsx("div",{className:"admin-error",children:o.jsxs("p",{children:["Error: ",a]})}),!s&&t.length>0&&o.jsx("div",{className:"recovery-table-container",children:o.jsxs("table",{className:"recovery-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{style:{width:"40px"},children:o.jsx("input",{type:"checkbox",checked:u.size===t.length,onChange:w=>w.target.checked?y():x()})}),o.jsx("th",{children:"Thumbnail"}),o.jsx("th",{children:"Prompt / Auto-name"}),o.jsx("th",{children:"Dimensions"}),o.jsx("th",{children:"Age"}),o.jsx("th",{children:"User"})]})}),o.jsx("tbody",{children:t.map(w=>o.jsxs("tr",{className:u.has(w.id)?"selected":"",onClick:()=>v(w.id),children:[o.jsx("td",{onClick:S=>S.stopPropagation(),children:o.jsx("input",{type:"checkbox",checked:u.has(w.id),onChange:()=>v(w.id)})}),o.jsx("td",{className:"thumbnail-cell",children:w.thumbnail_url?o.jsx("img",{src:w.thumbnail_url,alt:"Design",className:"job-thumbnail"}):o.jsx("div",{className:"thumbnail-placeholder",children:"No image"})}),o.jsxs("td",{className:"prompt-cell",children:[o.jsx("div",{className:"prompt-text",title:w.prompt,children:w.auto_name}),w.prompt&&w.prompt.length>50&&o.jsx("div",{className:"prompt-full",children:w.prompt})]}),o.jsx("td",{className:"dimensions-cell",children:w.width_mm&&w.length_mm?o.jsxs("span",{children:[w.width_mm,"  ",w.length_mm," mm"]}):o.jsx("em",{children:"N/A"})}),o.jsx("td",{className:"age-cell",children:o.jsxs("span",{className:`age-badge ${w.age_bucket.replace(/[<>]/g,"")}`,children:[w.age_days," ",w.age_days===1?"day":"days"]})}),o.jsx("td",{className:"user-cell",children:w.user_email})]},w.id))})]})}),!s&&t.length===0&&o.jsx("div",{className:"admin-empty",children:o.jsx("p",{children:"No orphaned jobs found. All designs have been saved!"})}),o.jsx("style",{children:`
        .recovery-controls {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 1.5rem;
          flex-wrap: wrap;
          gap: 1rem;
        }

        .bulk-actions {
          display: flex;
          gap: 0.5rem;
        }

        .btn-primary {
          padding: 0.5rem 1rem;
          background: #ff6b35;
          color: white;
          border: none;
          border-radius: 4px;
          font-weight: 500;
          cursor: pointer;
        }

        .btn-primary:hover:not(:disabled) {
          background: #e55a2b;
        }

        .btn-primary:disabled {
          background: #d1d5db;
          cursor: not-allowed;
        }

        .btn-secondary {
          padding: 0.5rem 1rem;
          background: white;
          color: #374151;
          border: 1px solid #d1d5db;
          border-radius: 4px;
          font-weight: 500;
          cursor: pointer;
        }

        .btn-secondary:hover {
          background: #f9fafb;
        }

        .recovery-table-container {
          overflow-x: auto;
          background: white;
          border-radius: 8px;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .recovery-table {
          width: 100%;
          border-collapse: collapse;
        }

        .recovery-table th {
          background: #f9fafb;
          padding: 1rem;
          text-align: left;
          font-weight: 600;
          font-size: 0.875rem;
          color: #374151;
          border-bottom: 1px solid #e5e7eb;
        }

        .recovery-table td {
          padding: 1rem;
          border-bottom: 1px solid #e5e7eb;
        }

        .recovery-table tbody tr {
          cursor: pointer;
          transition: background 0.15s;
        }

        .recovery-table tbody tr:hover {
          background: #f9fafb;
        }

        .recovery-table tbody tr.selected {
          background: #eff6ff;
        }

        .age-badge {
          display: inline-block;
          padding: 0.25rem 0.75rem;
          border-radius: 9999px;
          font-size: 0.75rem;
          font-weight: 500;
        }

        .age-badge.24h {
          background: #fee2e2;
          color: #991b1b;
        }

        .age-badge.1-7d {
          background: #fed7aa;
          color: #92400e;
        }

        .age-badge.7-30d {
          background: #fef3c7;
          color: #78350f;
        }

        .age-badge.30d {
          background: #e5e7eb;
          color: #374151;
        }

        .prompt-full {
          font-size: 0.75rem;
          color: #6b7280;
          margin-top: 0.25rem;
          display: none;
        }

        .recovery-table tbody tr:hover .prompt-full {
          display: block;
        }
      `})]})}function AW({onClose:t}){const[e,n]=R.useState("overview"),[r,s]=R.useState(!0),[i,a]=R.useState(null),[l,c]=R.useState(null),[d,u]=R.useState([]),[p,h]=R.useState([]),[f,m]=R.useState(0),[g,v]=R.useState(null),y=async()=>{var E,T;const _=await an.auth.getSession();return{"Content-Type":"application/json",Authorization:`Bearer ${(T=(E=_==null?void 0:_.data)==null?void 0:E.session)==null?void 0:T.access_token}`}},x=async()=>{try{const _=await y(),k=await fetch("/api/admin/analytics/overview",{headers:_}),E=await k.json();if(!k.ok)throw new Error(E.error||"Failed to fetch overview");c(E.stats)}catch(_){console.error("Failed to fetch overview:",_),a(_.message)}},b=async()=>{try{const _=await y(),k=await fetch("/api/admin/users",{headers:_}),E=await k.json();if(!k.ok)throw new Error(E.error||"Failed to fetch users");u(E.users)}catch(_){console.error("Failed to fetch users:",_),a(_.message)}},w=async()=>{try{const _=await y(),k=await fetch("/api/admin/designs?limit=50",{headers:_}),E=await k.json();if(!k.ok)throw new Error(E.error||"Failed to fetch designs");h(E.designs),m(E.total)}catch(_){console.error("Failed to fetch designs:",_),a(_.message)}},S=async()=>{try{const _=await y(),k=await fetch("/api/admin/analytics/colours",{headers:_}),E=await k.json();if(!k.ok)throw new Error(E.error||"Failed to fetch colour analytics");v(E.analytics)}catch(_){console.error("Failed to fetch colours:",_),a(_.message)}};return R.useEffect(()=>{(async()=>{s(!0),await x(),s(!1)})()},[]),R.useEffect(()=>{e==="users"&&d.length===0?b():e==="designs"&&p.length===0?w():e==="colours"&&!g&&S()},[e]),r?o.jsxs("div",{className:"admin-loading",children:[o.jsx("div",{className:"spinner"}),o.jsx("p",{children:"Loading admin dashboard..."})]}):i?o.jsxs("div",{className:"admin-error",children:[o.jsx("h2",{children:"Access Denied"}),o.jsx("p",{children:i}),o.jsx("p",{children:"You need admin privileges to view this page."})]}):o.jsxs("div",{className:"admin-dashboard",children:[o.jsxs("header",{className:"admin-header",children:[o.jsxs("div",{className:"admin-header-left",children:[o.jsxs("button",{onClick:t,className:"btn-back",children:[o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7"})}),"Back to Studio"]}),o.jsx("h1",{children:"TPV Studio Admin"})]}),o.jsxs("nav",{className:"admin-nav",children:[o.jsx("button",{className:e==="overview"?"active":"",onClick:()=>n("overview"),children:"Overview"}),o.jsx("button",{className:e==="generations"?"active":"",onClick:()=>n("generations"),children:"Generations"}),o.jsx("button",{className:e==="recovery"?"active":"",onClick:()=>n("recovery"),children:"Recovery"}),o.jsx("button",{className:e==="users"?"active":"",onClick:()=>n("users"),children:"Users"}),o.jsx("button",{className:e==="designs"?"active":"",onClick:()=>n("designs"),children:"Designs"}),o.jsx("button",{className:e==="colours"?"active":"",onClick:()=>n("colours"),children:"Colour Analytics"})]})]}),o.jsxs("main",{className:"admin-content",children:[e==="overview"&&l&&o.jsx(MW,{stats:l}),e==="generations"&&o.jsx(RW,{}),e==="recovery"&&o.jsx(OW,{}),e==="users"&&o.jsx($W,{users:d}),e==="designs"&&o.jsx(LW,{designs:p,total:f}),e==="colours"&&g&&o.jsx(DW,{analytics:g})]}),o.jsx("style",{jsx:!0,children:`
        .admin-dashboard {
          min-height: 100vh;
          background: #f8fafc;
        }

        .admin-header {
          background: white;
          border-bottom: 1px solid #e5e7eb;
          padding: 20px 40px;
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
        }

        .admin-header-left {
          display: flex;
          flex-direction: column;
          gap: 8px;
        }

        .btn-back {
          display: inline-flex;
          align-items: center;
          gap: 6px;
          padding: 6px 12px;
          background: #f3f4f6;
          border: 1px solid #e5e7eb;
          border-radius: 6px;
          font-size: 13px;
          color: #6b7280;
          cursor: pointer;
          transition: all 0.2s;
          width: fit-content;
        }

        .btn-back:hover {
          background: #e5e7eb;
          color: #374151;
        }

        .admin-header h1 {
          margin: 0;
          font-size: 24px;
          color: #1e4a7a;
        }

        .admin-nav {
          display: flex;
          gap: 8px;
        }

        .admin-nav button {
          padding: 8px 16px;
          border: 1px solid #e5e7eb;
          background: white;
          border-radius: 6px;
          cursor: pointer;
          font-size: 14px;
          color: #64748b;
          transition: all 0.2s;
        }

        .admin-nav button:hover {
          background: #f8fafc;
          color: #1e4a7a;
        }

        .admin-nav button.active {
          background: #1e4a7a;
          color: white;
          border-color: #1e4a7a;
        }

        .admin-content {
          padding: 24px 40px;
        }

        .admin-loading,
        .admin-error {
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          min-height: 50vh;
          text-align: center;
        }

        .admin-error h2 {
          color: #dc2626;
        }

        .spinner {
          width: 40px;
          height: 40px;
          border: 3px solid #e5e7eb;
          border-top-color: #1e4a7a;
          border-radius: 50%;
          animation: spin 0.8s linear infinite;
          margin-bottom: 16px;
        }

        @keyframes spin {
          to { transform: rotate(360deg); }
        }
      `})]})}function MW({stats:t}){return o.jsxs("div",{className:"overview-panel",children:[o.jsx("h2",{children:"Dashboard Overview"}),o.jsxs("div",{className:"stats-grid",children:[o.jsxs("div",{className:"stat-card",children:[o.jsx("div",{className:"stat-value",children:t.totals.users}),o.jsx("div",{className:"stat-label",children:"Total Users"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("div",{className:"stat-value",children:t.totals.designs}),o.jsx("div",{className:"stat-label",children:"Total Designs"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("div",{className:"stat-value",children:t.totals.projects}),o.jsx("div",{className:"stat-label",children:"Total Projects"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("div",{className:"stat-value",children:t.totals.jobs}),o.jsx("div",{className:"stat-label",children:"AI Jobs Run"})]})]}),o.jsxs("div",{className:"stats-grid",children:[o.jsxs("div",{className:"stat-card highlight",children:[o.jsx("div",{className:"stat-value",children:t.activity.active_users_30d}),o.jsx("div",{className:"stat-label",children:"Active Users (30d)"})]}),o.jsxs("div",{className:"stat-card highlight",children:[o.jsx("div",{className:"stat-value",children:t.activity.designs_7d}),o.jsx("div",{className:"stat-label",children:"Designs This Week"})]}),o.jsxs("div",{className:"stat-card highlight",children:[o.jsx("div",{className:"stat-value",children:t.activity.designs_30d}),o.jsx("div",{className:"stat-label",children:"Designs This Month"})]}),o.jsxs("div",{className:"stat-card highlight",children:[o.jsxs("div",{className:"stat-value",children:[t.activity.job_success_rate,"%"]}),o.jsx("div",{className:"stat-label",children:"Job Success Rate"})]})]}),o.jsx("h3",{children:"Activity Timeline (14 Days)"}),o.jsx("div",{className:"activity-chart",children:t.timeline.map((e,n)=>o.jsxs("div",{className:"bar-container",children:[o.jsx("div",{className:"bar",style:{height:`${Math.max(4,e.count*20)}px`},title:`${e.date}: ${e.count} designs`}),o.jsx("div",{className:"bar-label",children:e.date.split("-")[2]})]},n))}),o.jsxs("div",{className:"breakdowns",children:[o.jsxs("div",{className:"breakdown-card",children:[o.jsx("h4",{children:"Input Mode"}),o.jsxs("div",{className:"breakdown-items",children:[o.jsxs("div",{className:"breakdown-item",children:[o.jsx("span",{children:"Prompt"}),o.jsx("strong",{children:t.breakdowns.input_mode.prompt})]}),o.jsxs("div",{className:"breakdown-item",children:[o.jsx("span",{children:"Image Upload"}),o.jsx("strong",{children:t.breakdowns.input_mode.image})]}),o.jsxs("div",{className:"breakdown-item",children:[o.jsx("span",{children:"SVG Upload"}),o.jsx("strong",{children:t.breakdowns.input_mode.svg})]})]})]}),o.jsxs("div",{className:"breakdown-card",children:[o.jsx("h4",{children:"View Mode Preference"}),o.jsxs("div",{className:"breakdown-items",children:[o.jsxs("div",{className:"breakdown-item",children:[o.jsx("span",{children:"Solid TPV"}),o.jsx("strong",{children:t.breakdowns.view_mode.solid})]}),o.jsxs("div",{className:"breakdown-item",children:[o.jsx("span",{children:"Blend TPV"}),o.jsx("strong",{children:t.breakdowns.view_mode.blend})]})]})]})]}),o.jsx("style",{jsx:!0,children:`
        .overview-panel h2 {
          margin: 0 0 24px 0;
          color: #1a202c;
        }

        .overview-panel h3 {
          margin: 32px 0 16px 0;
          color: #1a202c;
        }

        .stats-grid {
          display: grid;
          grid-template-columns: repeat(4, 1fr);
          gap: 16px;
          margin-bottom: 16px;
        }

        .stat-card {
          background: white;
          padding: 20px;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
        }

        .stat-card.highlight {
          border-color: #1e4a7a;
          border-width: 2px;
        }

        .stat-value {
          font-size: 32px;
          font-weight: 700;
          color: #1e4a7a;
        }

        .stat-label {
          font-size: 14px;
          color: #64748b;
          margin-top: 4px;
        }

        .activity-chart {
          display: flex;
          align-items: flex-end;
          gap: 8px;
          height: 120px;
          padding: 16px;
          background: white;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
        }

        .bar-container {
          flex: 1;
          display: flex;
          flex-direction: column;
          align-items: center;
        }

        .bar {
          width: 100%;
          background: #1e4a7a;
          border-radius: 4px 4px 0 0;
          min-height: 4px;
        }

        .bar-label {
          font-size: 10px;
          color: #64748b;
          margin-top: 4px;
        }

        .breakdowns {
          display: grid;
          grid-template-columns: repeat(2, 1fr);
          gap: 16px;
          margin-top: 24px;
        }

        .breakdown-card {
          background: white;
          padding: 20px;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
        }

        .breakdown-card h4 {
          margin: 0 0 12px 0;
          color: #1a202c;
        }

        .breakdown-item {
          display: flex;
          justify-content: space-between;
          padding: 8px 0;
          border-bottom: 1px solid #f3f4f6;
        }

        .breakdown-item:last-child {
          border-bottom: none;
        }

        .breakdown-item span {
          color: #64748b;
        }

        .breakdown-item strong {
          color: #1a202c;
        }
      `})]})}function $W({users:t}){return o.jsxs("div",{className:"users-panel",children:[o.jsxs("h2",{children:["User Management (",t.length," users)"]}),o.jsxs("table",{className:"users-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Email"}),o.jsx("th",{children:"Role"}),o.jsx("th",{children:"Designs"}),o.jsx("th",{children:"Projects"}),o.jsx("th",{children:"Jobs"}),o.jsx("th",{children:"Last Design"}),o.jsx("th",{children:"Joined"})]})}),o.jsx("tbody",{children:t.map(e=>o.jsxs("tr",{children:[o.jsx("td",{children:e.email}),o.jsx("td",{children:o.jsx("span",{className:`role-badge ${e.role}`,children:e.role})}),o.jsx("td",{children:e.design_count}),o.jsx("td",{children:e.project_count}),o.jsx("td",{children:e.job_count}),o.jsx("td",{children:e.last_design_at?new Date(e.last_design_at).toLocaleDateString():"-"}),o.jsx("td",{children:new Date(e.created_at).toLocaleDateString()})]},e.id))})]}),o.jsx("style",{jsx:!0,children:`
        .users-panel h2 {
          margin: 0 0 24px 0;
          color: #1a202c;
        }

        .users-table {
          width: 100%;
          background: white;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
          border-collapse: collapse;
        }

        .users-table th,
        .users-table td {
          padding: 12px 16px;
          text-align: left;
          border-bottom: 1px solid #e5e7eb;
        }

        .users-table th {
          background: #f8fafc;
          font-weight: 600;
          color: #64748b;
          font-size: 12px;
          text-transform: uppercase;
        }

        .users-table td {
          font-size: 14px;
          color: #1a202c;
        }

        .role-badge {
          padding: 4px 8px;
          border-radius: 4px;
          font-size: 12px;
          font-weight: 500;
        }

        .role-badge.user {
          background: #f3f4f6;
          color: #64748b;
        }

        .role-badge.admin {
          background: #dbeafe;
          color: #1e40af;
        }

        .role-badge.superadmin {
          background: #fef3c7;
          color: #92400e;
        }
      `})]})}function LW({designs:t,total:e}){return o.jsxs("div",{className:"designs-panel",children:[o.jsxs("h2",{children:["All Designs (",e," total)"]}),o.jsx("div",{className:"designs-grid",children:t.map(n=>o.jsxs("div",{className:"design-card",children:[o.jsx("div",{className:"design-thumbnail",children:n.thumbnail_url||n.original_png_url?o.jsx("img",{src:n.thumbnail_url||n.original_png_url,alt:n.name}):o.jsx("div",{className:"no-image",children:"No preview"})}),o.jsxs("div",{className:"design-info",children:[o.jsx("h4",{children:n.name}),o.jsx("p",{className:"design-user",children:n.user_email}),o.jsx("p",{className:"design-date",children:new Date(n.created_at).toLocaleDateString()}),n.project&&o.jsx("span",{className:"project-badge",style:{backgroundColor:n.project.color||"#64748b"},children:n.project.name})]})]},n.id))}),o.jsx("style",{jsx:!0,children:`
        .designs-panel h2 {
          margin: 0 0 24px 0;
          color: #1a202c;
        }

        .designs-grid {
          display: grid;
          grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
          gap: 16px;
        }

        .design-card {
          background: white;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
          overflow: hidden;
        }

        .design-thumbnail {
          aspect-ratio: 1;
          background: #f3f4f6;
          overflow: hidden;
        }

        .design-thumbnail img {
          width: 100%;
          height: 100%;
          object-fit: cover;
        }

        .no-image {
          width: 100%;
          height: 100%;
          display: flex;
          align-items: center;
          justify-content: center;
          color: #9ca3af;
          font-size: 14px;
        }

        .design-info {
          padding: 12px;
        }

        .design-info h4 {
          margin: 0 0 4px 0;
          font-size: 14px;
          color: #1a202c;
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
        }

        .design-user {
          margin: 0;
          font-size: 12px;
          color: #64748b;
        }

        .design-date {
          margin: 4px 0;
          font-size: 12px;
          color: #9ca3af;
        }

        .project-badge {
          display: inline-block;
          padding: 2px 8px;
          border-radius: 10px;
          font-size: 10px;
          color: white;
        }
      `})]})}function DW({analytics:t}){return o.jsxs("div",{className:"colours-panel",children:[o.jsx("h2",{children:"Colour Usage Analytics"}),o.jsxs("div",{className:"colour-stats",children:[o.jsxs("div",{className:"stat-card",children:[o.jsx("div",{className:"stat-value",children:t.totals.designs_analysed}),o.jsx("div",{className:"stat-label",children:"Designs Analysed"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("div",{className:"stat-value",children:t.totals.colour_usages}),o.jsx("div",{className:"stat-label",children:"Total Colour Uses"})]})]}),o.jsx("h3",{children:"Top 10 TPV Colours"}),o.jsx("div",{className:"colour-list",children:t.top_colours.map((e,n)=>o.jsxs("div",{className:"colour-item",children:[o.jsxs("span",{className:"colour-rank",children:["#",n+1]}),o.jsx("div",{className:"colour-swatch",style:{backgroundColor:e.hex}}),o.jsxs("div",{className:"colour-info",children:[o.jsx("strong",{children:e.code}),o.jsx("span",{children:e.name})]}),o.jsxs("div",{className:"colour-count",children:[e.count," uses"]})]},e.code))}),o.jsx("h3",{children:"Colour Family Breakdown"}),o.jsx("div",{className:"family-bars",children:Object.entries(t.families).map(([e,n])=>o.jsxs("div",{className:"family-bar",children:[o.jsx("span",{className:"family-name",children:e}),o.jsx("div",{className:"bar-bg",children:o.jsx("div",{className:"bar-fill",style:{width:`${n/t.totals.colour_usages*100}%`,backgroundColor:IW(e)}})}),o.jsx("span",{className:"family-count",children:n})]},e))}),t.top_blends.length>0&&o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Top Blend Combinations"}),o.jsx("div",{className:"blend-list",children:t.top_blends.map((e,n)=>o.jsxs("div",{className:"blend-item",children:[o.jsx("div",{className:"blend-swatches",children:e.components.map((r,s)=>o.jsx("div",{className:"blend-swatch",style:{backgroundColor:r.hex},title:`${r.code} - ${r.name}`},s))}),o.jsx("div",{className:"blend-codes",children:e.components.map(r=>r.code).join(" + ")}),o.jsxs("div",{className:"blend-count",children:[e.count," uses"]})]},n))})]}),o.jsx("style",{jsx:!0,children:`
        .colours-panel h2 {
          margin: 0 0 24px 0;
          color: #1a202c;
        }

        .colours-panel h3 {
          margin: 32px 0 16px 0;
          color: #1a202c;
        }

        .colour-stats {
          display: grid;
          grid-template-columns: repeat(2, 1fr);
          gap: 16px;
          margin-bottom: 24px;
        }

        .stat-card {
          background: white;
          padding: 20px;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
        }

        .stat-value {
          font-size: 32px;
          font-weight: 700;
          color: #1e4a7a;
        }

        .stat-label {
          font-size: 14px;
          color: #64748b;
          margin-top: 4px;
        }

        .colour-list {
          background: white;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
          overflow: hidden;
        }

        .colour-item {
          display: flex;
          align-items: center;
          gap: 12px;
          padding: 12px 16px;
          border-bottom: 1px solid #f3f4f6;
        }

        .colour-item:last-child {
          border-bottom: none;
        }

        .colour-rank {
          width: 30px;
          font-size: 12px;
          color: #9ca3af;
        }

        .colour-swatch {
          width: 32px;
          height: 32px;
          border-radius: 6px;
          border: 1px solid #e5e7eb;
        }

        .colour-info {
          flex: 1;
        }

        .colour-info strong {
          display: block;
          color: #1a202c;
        }

        .colour-info span {
          font-size: 12px;
          color: #64748b;
        }

        .colour-count {
          font-weight: 600;
          color: #1e4a7a;
        }

        .family-bars {
          background: white;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
          padding: 16px;
        }

        .family-bar {
          display: flex;
          align-items: center;
          gap: 12px;
          margin-bottom: 12px;
        }

        .family-bar:last-child {
          margin-bottom: 0;
        }

        .family-name {
          width: 80px;
          font-size: 14px;
          color: #64748b;
          text-transform: capitalize;
        }

        .bar-bg {
          flex: 1;
          height: 20px;
          background: #f3f4f6;
          border-radius: 4px;
          overflow: hidden;
        }

        .bar-fill {
          height: 100%;
          border-radius: 4px;
        }

        .family-count {
          width: 50px;
          text-align: right;
          font-weight: 600;
          color: #1a202c;
        }

        .blend-list {
          background: white;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
          overflow: hidden;
        }

        .blend-item {
          display: flex;
          align-items: center;
          gap: 12px;
          padding: 12px 16px;
          border-bottom: 1px solid #f3f4f6;
        }

        .blend-item:last-child {
          border-bottom: none;
        }

        .blend-swatches {
          display: flex;
          gap: 4px;
        }

        .blend-swatch {
          width: 24px;
          height: 24px;
          border-radius: 4px;
          border: 1px solid #e5e7eb;
        }

        .blend-codes {
          flex: 1;
          font-size: 14px;
          color: #1a202c;
        }

        .blend-count {
          font-weight: 600;
          color: #1e4a7a;
        }
      `})]})}function IW(t){return{reds:"#dc2626",greens:"#16a34a",blues:"#2563eb",yellows:"#ca8a04",neutrals:"#6b7280"}[t]||"#6b7280"}const ch=[{code:"RH30",name:"Beige",hex:"#E4C4AA"},{code:"RH31",name:"Cream",hex:"#E8E3D8"},{code:"RH41",name:"Bright Yellow",hex:"#FFD833"},{code:"RH40",name:"Mustard",hex:"#E5A144"},{code:"RH50",name:"Orange",hex:"#F15B32"},{code:"RH01",name:"Standard Red",hex:"#A5362F"},{code:"RH02",name:"Bright Red",hex:"#E21F2F"},{code:"RH90",name:"Funky Pink",hex:"#E8457E"},{code:"RH21",name:"Purple",hex:"#493D8C"},{code:"RH20",name:"Standard Blue",hex:"#0075BC"},{code:"RH22",name:"Light Blue",hex:"#47AFE3"},{code:"RH23",name:"Azure",hex:"#039DC4"},{code:"RH26",name:"Turquoise",hex:"#00A6A3"},{code:"RH12",name:"Dark Green",hex:"#006C55"},{code:"RH10",name:"Standard Green",hex:"#609B63"},{code:"RH11",name:"Bright Green",hex:"#3BB44A"},{code:"RH32",name:"Brown",hex:"#8B5F3C"},{code:"RH65",name:"Pale Grey",hex:"#D9D9D6"},{code:"RH61",name:"Light Grey",hex:"#939598"},{code:"RH60",name:"Dark Grey",hex:"#59595B"},{code:"RH70",name:"Black",hex:"#231F20"}],Wx=["ocean theme with dolphins and waves","jungle adventure with parrots","solar system with planets","garden with butterflies and flowers","racing track with cars","underwater coral reef scene","dinosaur footprints trail","rainbow with clouds"],zW=[...Array(60)].map(t=>({delay:`${Math.random()*3}s`,x:`${Math.random()*100}%`,y:`${Math.random()*100}%`,size:`${8+Math.random()*12}px`}));function FW(){const[t,e]=R.useState(""),[n,r]=R.useState(""),[s,i]=R.useState(""),[a,l]=R.useState(!1),[c,d]=R.useState(!1),[u,p]=R.useState(0);R.useEffect(()=>{const m=setInterval(()=>{p(g=>(g+1)%Wx.length)},5e3);return()=>clearInterval(m)},[]);const h=async m=>{m.preventDefault(),i(""),l(!0);try{await Nr.signIn(t,n)}catch(g){i(g.message||"Sign in failed")}finally{l(!1)}},f=m=>{var g;(g=document.getElementById(m))==null||g.scrollIntoView({behavior:"smooth"})};return o.jsxs("div",{className:"landing-page",children:[o.jsxs("nav",{className:"landing-nav",children:[o.jsxs("div",{className:"nav-logo",children:[o.jsxs("div",{className:"logo-main",children:[o.jsxs("span",{className:"logo-text",children:["Rosehill TPV",o.jsx("sup",{children:""})]}),o.jsx("span",{className:"logo-accent",children:"Studio"})]}),o.jsx("span",{className:"logo-byline",children:"by Rosehill Sports & Play"})]}),o.jsxs("div",{className:"nav-links",children:[o.jsx("button",{onClick:()=>f("features"),children:"Features"}),o.jsx("button",{onClick:()=>f("palette"),children:"Colours"}),o.jsx("button",{onClick:()=>d(!0),className:"nav-cta",children:"Sign In"})]})]}),o.jsxs("section",{className:"hero",children:[o.jsx("div",{className:"hero-background",children:o.jsx("div",{className:"granule-field",children:zW.map((m,g)=>o.jsx("div",{className:"granule",style:{"--delay":m.delay,"--x":m.x,"--y":m.y,"--color":ch[g%ch.length].hex,"--size":m.size}},g))})}),o.jsxs("div",{className:"hero-content",children:[o.jsxs("div",{className:"hero-badge",children:["Rosehill TPV",o.jsx("sup",{children:""})," Surface Design Platform"]}),o.jsxs("h1",{children:[o.jsx("span",{className:"hero-line-1",children:"Design Any"}),o.jsxs("span",{className:"hero-line-2",children:["Rosehill TPV",o.jsx("sup",{children:""})," Surface"]})]}),o.jsxs("p",{className:"hero-subtitle",children:["From AI-generated playground art to professional sports courts  one powerful design platform for all your Rosehill TPV",o.jsx("sup",{children:""})," surfaces."]}),o.jsxs("div",{className:"hero-ctas",children:[o.jsxs("button",{onClick:()=>d(!0),className:"cta-primary",children:["Start Designing",o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M5 12h14M12 5l7 7-7 7"})})]}),o.jsx("button",{onClick:()=>f("how-it-works"),className:"cta-secondary",children:"See How It Works"})]})]}),o.jsx("div",{className:"hero-visual",children:o.jsx("div",{className:"mockup-container",children:o.jsxs("div",{className:"mockup-screen",children:[o.jsx("div",{className:"mockup-header",children:o.jsxs("div",{className:"mockup-dots",children:[o.jsx("span",{}),o.jsx("span",{}),o.jsx("span",{})]})}),o.jsxs("div",{className:"mockup-content",children:[o.jsx("div",{className:"mockup-input",children:o.jsx("span",{className:"typing-text",children:Wx[u]},u)}),o.jsxs("div",{className:"mockup-preview",children:[o.jsx("div",{className:"preview-shape shape-1"}),o.jsx("div",{className:"preview-shape shape-2"}),o.jsx("div",{className:"preview-shape shape-3"})]})]})]})})})]}),o.jsxs("section",{className:"unified-showcase",children:[o.jsxs("div",{className:"section-header",children:[o.jsx("span",{className:"section-tag",children:"One Powerful Tool"}),o.jsx("h2",{children:"Design Any Surface"}),o.jsx("p",{className:"section-subtitle",children:"Courts, tracks, playgrounds, and custom graphics  all in one canvas"})]}),o.jsx("div",{className:"showcase-container",children:o.jsxs("div",{className:"showcase-card",children:[o.jsxs("div",{className:"showcase-canvas",children:[o.jsxs("div",{className:"canvas-preview",children:[o.jsx("div",{className:"canvas-grid"}),o.jsxs("div",{className:"canvas-surface",children:[o.jsx("div",{className:"surface-court"}),o.jsx("div",{className:"surface-motif"})]})]}),o.jsxs("div",{className:"capability-pill pill-courts",children:[o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[o.jsx("rect",{x:"2",y:"4",width:"20",height:"16",rx:"2"}),o.jsx("circle",{cx:"12",cy:"12",r:"3"}),o.jsx("path",{d:"M2 12h4M18 12h4"})]}),o.jsx("span",{children:"Courts & Tracks"})]}),o.jsxs("div",{className:"capability-pill pill-ai",children:[o.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:o.jsx("path",{d:"M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2z"})}),o.jsx("span",{children:"AI Artwork"})]}),o.jsxs("div",{className:"capability-pill pill-upload",children:[o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[o.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),o.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),o.jsx("path",{d:"M21 15l-5-5L5 21"})]}),o.jsx("span",{children:"Custom Images"})]}),o.jsxs("div",{className:"capability-pill pill-layers",children:[o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[o.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5z"}),o.jsx("path",{d:"M2 17l10 5 10-5"}),o.jsx("path",{d:"M2 12l10 5 10-5"})]}),o.jsx("span",{children:"Layer & Combine"})]})]}),o.jsx("div",{className:"showcase-tagline",children:"One canvas. Unlimited possibilities."}),o.jsxs("div",{className:"showcase-features",children:[o.jsxs("div",{className:"showcase-feature",children:[o.jsx("div",{className:"feature-badge ai-badge",children:"AI-POWERED"}),o.jsx("span",{children:"Generate motifs from text descriptions"})]}),o.jsxs("div",{className:"showcase-feature",children:[o.jsx("div",{className:"feature-badge template-badge",children:"TEMPLATES"}),o.jsx("span",{children:"15+ professional court layouts"})]}),o.jsxs("div",{className:"showcase-feature",children:[o.jsx("div",{className:"feature-badge compose-badge",children:"COMPOSE"}),o.jsx("span",{children:"Mix courts, tracks & artwork freely"})]})]}),o.jsxs("button",{onClick:()=>d(!0),className:"cta-primary showcase-cta",children:["Start Designing",o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M5 12h14M12 5l7 7-7 7"})})]})]})})]}),o.jsxs("section",{id:"how-it-works",className:"how-it-works",children:[o.jsxs("div",{className:"section-header",children:[o.jsx("span",{className:"section-tag",children:"Process"}),o.jsx("h2",{children:"Three Steps to Production-Ready Designs"})]}),o.jsxs("div",{className:"steps-container",children:[o.jsxs("div",{className:"step",children:[o.jsx("div",{className:"step-number",children:"01"}),o.jsx("div",{className:"step-icon",children:o.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[o.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),o.jsx("path",{d:"M3 9h18M9 21V9"})]})}),o.jsx("h3",{children:"Set Up Your Surface"}),o.jsx("p",{children:"Define your dimensions and choose your base colour. Start with any size from small playgrounds to full athletic facilities."})]}),o.jsx("div",{className:"step-connector",children:o.jsx("svg",{viewBox:"0 0 100 20",preserveAspectRatio:"none",children:o.jsx("path",{d:"M0 10 Q50 10 100 10",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeDasharray:"4 4"})})}),o.jsxs("div",{className:"step",children:[o.jsx("div",{className:"step-number",children:"02"}),o.jsx("div",{className:"step-icon",children:o.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[o.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5z"}),o.jsx("path",{d:"M2 17l10 5 10-5"}),o.jsx("path",{d:"M2 12l10 5 10-5"})]})}),o.jsx("h3",{children:"Add Elements"}),o.jsx("p",{children:"Drop in courts and tracks from the library, generate AI artwork, upload your own designs  layer and combine freely."})]}),o.jsx("div",{className:"step-connector",children:o.jsx("svg",{viewBox:"0 0 100 20",preserveAspectRatio:"none",children:o.jsx("path",{d:"M0 10 Q50 10 100 10",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeDasharray:"4 4"})})}),o.jsxs("div",{className:"step",children:[o.jsx("div",{className:"step-number",children:"03"}),o.jsx("div",{className:"step-icon",children:o.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[o.jsx("path",{d:"M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"}),o.jsx("path",{d:"M14 2v6h6M12 18v-6M9 15l3 3 3-3"})]})}),o.jsx("h3",{children:"Export & Build"}),o.jsx("p",{children:"Generate professional PDFs with material specifications, colour recipes, and exact quantities for installation."})]})]})]}),o.jsxs("section",{id:"features",className:"features",children:[o.jsxs("div",{className:"section-header",children:[o.jsx("span",{className:"section-tag",children:"Capabilities"}),o.jsxs("h2",{children:["Everything You Need to Design Rosehill TPV",o.jsx("sup",{children:""})," Surfaces"]})]}),o.jsxs("div",{className:"features-grid unified-features",children:[o.jsxs("div",{className:"feature-card feature-highlight",children:[o.jsx("div",{className:"feature-icon",children:o.jsx("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:o.jsx("path",{d:"M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2z"})})}),o.jsx("h3",{children:"AI Text-to-Vector"}),o.jsxs("p",{children:["Describe any concept in natural language. Our AI transforms your words into production-ready vector designs optimised for Rosehill TPV",o.jsx("sup",{children:""})," surfaces."]}),o.jsx("div",{className:"feature-example",children:'"vibrant underwater scene with coral reef"'})]}),o.jsxs("div",{className:"feature-card",children:[o.jsx("div",{className:"feature-icon",children:o.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[o.jsx("rect",{x:"2",y:"4",width:"20",height:"16",rx:"2"}),o.jsx("circle",{cx:"12",cy:"12",r:"3"}),o.jsx("path",{d:"M2 12h4M18 12h4"})]})}),o.jsx("h3",{children:"Court & Track Library"}),o.jsx("p",{children:"15+ professional templates including basketball, tennis, netball, futsal, and running tracks."})]}),o.jsxs("div",{className:"feature-card",children:[o.jsx("div",{className:"feature-icon",children:o.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[o.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),o.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),o.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),o.jsx("h3",{children:"Image Vectorisation"}),o.jsxs("p",{children:["Upload any image and convert it to clean vectors optimised for Rosehill TPV",o.jsx("sup",{children:""})," production."]})]}),o.jsxs("div",{className:"feature-card",children:[o.jsx("div",{className:"feature-icon",children:o.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[o.jsx("circle",{cx:"13.5",cy:"6.5",r:"2.5"}),o.jsx("circle",{cx:"17.5",cy:"10.5",r:"2.5"}),o.jsx("circle",{cx:"8.5",cy:"7.5",r:"2.5"}),o.jsx("circle",{cx:"6.5",cy:"12.5",r:"2.5"})]})}),o.jsx("h3",{children:"Colour Matching"}),o.jsxs("p",{children:["Automatic colour matching to the Rosehill TPV",o.jsx("sup",{children:""})," palette with precise specifications."]})]}),o.jsxs("div",{className:"feature-card",children:[o.jsx("div",{className:"feature-icon",children:o.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[o.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5z"}),o.jsx("path",{d:"M2 17l10 5 10-5"}),o.jsx("path",{d:"M2 12l10 5 10-5"})]})}),o.jsx("h3",{children:"Layer Management"}),o.jsx("p",{children:"Combine courts, tracks, and motifs freely. Drag, rotate, and layer with precision controls."})]}),o.jsxs("div",{className:"feature-card",children:[o.jsx("div",{className:"feature-icon",children:o.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[o.jsx("path",{d:"M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"}),o.jsx("path",{d:"M14 2v6h6M12 18v-6M9 15l3 3 3-3"})]})}),o.jsx("h3",{children:"PDF Specifications"}),o.jsx("p",{children:"Export production-ready material specs with colour specifications and installation guides."})]})]})]}),o.jsxs("section",{id:"palette",className:"palette-section",children:[o.jsxs("div",{className:"section-header light",children:[o.jsx("span",{className:"section-tag",children:"Palette"}),o.jsxs("h2",{children:["21 Standard Rosehill TPV",o.jsx("sup",{children:""})," Colours"]}),o.jsxs("p",{className:"section-subtitle",children:["The complete Rosehill TPV",o.jsx("sup",{children:""})," granule palette at your fingertips"]})]}),o.jsx("div",{className:"palette-grid",children:ch.map((m,g)=>o.jsxs("div",{className:"palette-swatch",style:{"--swatch-color":m.hex,"--delay":`${g*.03}s`},children:[o.jsx("div",{className:"swatch-color"}),o.jsxs("div",{className:"swatch-info",children:[o.jsx("span",{className:"swatch-name",children:m.name}),o.jsx("span",{className:"swatch-code",children:m.code})]})]},m.code))})]}),o.jsx("section",{className:"benefits",children:o.jsxs("div",{className:"benefits-grid benefits-grid-4",children:[o.jsxs("div",{className:"benefit",children:[o.jsx("div",{className:"benefit-metric",children:"10x"}),o.jsx("div",{className:"benefit-label",children:"Faster Design"}),o.jsx("p",{children:"What took hours now takes minutes with AI and templates."})]}),o.jsxs("div",{className:"benefit",children:[o.jsx("div",{className:"benefit-metric",children:"100%"}),o.jsx("div",{className:"benefit-label",children:"Production Accurate"}),o.jsxs("p",{children:["Exact Rosehill TPV",o.jsx("sup",{children:""})," granule specs with precise specifications."]})]}),o.jsxs("div",{className:"benefit",children:[o.jsx("div",{className:"benefit-metric infinite-symbol",children:""}),o.jsx("div",{className:"benefit-label",children:"Combinations"}),o.jsx("p",{children:"Mix courts, tracks, and artwork in unlimited configurations."})]}),o.jsxs("div",{className:"benefit",children:[o.jsx("div",{className:"benefit-metric",children:"21"}),o.jsx("div",{className:"benefit-label",children:"Standard Colours"}),o.jsxs("p",{children:["Complete Rosehill TPV",o.jsx("sup",{children:""})," standard colour palette."]})]})]})}),o.jsx("footer",{className:"landing-footer",children:o.jsxs("div",{className:"footer-content",children:[o.jsxs("div",{className:"footer-brand",children:[o.jsxs("span",{className:"footer-logo",children:["Rosehill TPV",o.jsx("sup",{children:""})," Studio"]}),o.jsx("span",{className:"footer-tagline",children:"A web app by Rosehill Sports & Play"}),o.jsx("span",{className:"footer-division",children:"A Division of Rosehill Group"})]}),o.jsxs("div",{className:"footer-links",children:[o.jsx("a",{href:"https://rosehilltpv.com",target:"_blank",rel:"noopener noreferrer",children:"rosehilltpv.com"}),o.jsx("a",{href:"mailto:info@rosehill.group",children:"info@rosehill.group"})]})]})}),o.jsx("section",{className:"cta-footer",children:o.jsxs("div",{className:"cta-content",children:[o.jsx("h2",{children:"Ready to Design Your Surface?"}),o.jsxs("p",{children:["Create playgrounds or sports facilities with production-ready Rosehill TPV",o.jsx("sup",{children:""})," specifications."]}),o.jsxs("button",{onClick:()=>d(!0),className:"cta-primary large",children:["Sign In to Rosehill TPV",o.jsx("sup",{children:""})," Studio",o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M5 12h14M12 5l7 7-7 7"})})]}),o.jsxs("p",{className:"cta-note",children:["Need an account? Contact ",o.jsx("a",{href:"mailto:info@rosehill.group",children:"info@rosehill.group"})]})]})}),c&&o.jsx("div",{className:"modal-overlay",onClick:()=>d(!1),children:o.jsxs("div",{className:"sign-in-modal",onClick:m=>m.stopPropagation(),children:[o.jsx("button",{className:"modal-close",onClick:()=>d(!1),children:o.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})}),o.jsxs("div",{className:"modal-header",children:[o.jsx("h2",{children:"Sign In"}),o.jsxs("p",{children:["Access your Rosehill TPV",o.jsx("sup",{children:""})," Studio account"]})]}),s&&o.jsx("div",{className:"form-error",children:s}),o.jsxs("form",{onSubmit:h,children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Email"}),o.jsx("input",{type:"email",value:t,onChange:m=>e(m.target.value),placeholder:"your.email@company.com",required:!0})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Password"}),o.jsx("input",{type:"password",value:n,onChange:m=>r(m.target.value),required:!0})]}),o.jsx("button",{type:"submit",disabled:a,className:"submit-btn",children:a?"Signing in...":"Sign In"})]}),o.jsx("p",{className:"modal-footer-text",children:"Don't have an account? Contact your administrator."})]})}),o.jsx("style",{jsx:!0,children:`
        /* ============================================
           TPV STUDIO LANDING PAGE
           Aesthetic: Sophisticated Industrial-Creative
           ============================================ */

        @import url('https://fonts.googleapis.com/css2?family=Overpass:wght@300;400;500;600;700&family=Source+Sans+Pro:wght@300;400;600;700&display=swap');

        .landing-page {
          --primary: #1a365d;
          --primary-light: #2a4a73;
          --accent: #ff6b35;
          --accent-hover: #e55a2a;
          --text: #1a202c;
          --text-secondary: #64748b;
          --text-light: #94a3b8;
          --bg: #fafbfc;
          --bg-dark: #0f172a;
          --card: #ffffff;
          --border: #e2e8f0;

          font-family: 'Source Sans Pro', sans-serif;
          background: var(--bg);
          color: var(--text);
          overflow-x: hidden;
        }

        /* Navigation */
        .landing-nav {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          z-index: 1000;
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 1rem 3rem;
          background: rgba(255, 255, 255, 0.9);
          backdrop-filter: blur(12px);
          border-bottom: 1px solid var(--border);
        }

        .nav-logo {
          font-family: 'Overpass', sans-serif;
          font-size: 1.5rem;
          font-weight: 700;
        }

        .logo-text {
          color: var(--primary);
        }

        .logo-accent {
          color: var(--accent);
        }

        .nav-links {
          display: flex;
          align-items: center;
          gap: 2rem;
        }

        .nav-links button {
          background: none;
          border: none;
          font-family: inherit;
          font-size: 0.875rem;
          font-weight: 500;
          color: var(--text-secondary);
          cursor: pointer;
          transition: color 0.2s;
        }

        .nav-links button:hover {
          color: var(--text);
        }

        .nav-cta {
          background: var(--primary) !important;
          color: white !important;
          padding: 0.5rem 1.25rem !important;
          border-radius: 6px !important;
        }

        .nav-cta:hover {
          background: var(--primary-light) !important;
        }

        .logo-main {
          display: flex;
          align-items: baseline;
          gap: 0.25rem;
        }

        .logo-byline {
          display: block;
          font-size: 0.625rem;
          font-weight: 400;
          color: var(--text-light);
          margin-top: 2px;
          letter-spacing: 0.02em;
        }

        .landing-page sup {
          font-size: 0.6em;
          vertical-align: super;
          line-height: 0;
        }

        /* Hero Section */
        .hero {
          min-height: 100vh;
          display: grid;
          grid-template-columns: 1fr 1fr;
          align-items: center;
          padding: 8rem 4rem 4rem;
          position: relative;
          overflow: hidden;
        }

        .hero-background {
          position: absolute;
          inset: 0;
          pointer-events: none;
        }

        .granule-field {
          position: absolute;
          inset: 0;
        }

        .granule {
          position: absolute;
          left: var(--x);
          top: var(--y);
          width: var(--size);
          height: var(--size);
          background: var(--color);
          border-radius: 50%;
          opacity: 0.15;
          animation: float 8s ease-in-out infinite;
          animation-delay: var(--delay);
        }

        @keyframes float {
          0%, 100% { transform: translateY(0) scale(1); }
          50% { transform: translateY(-20px) scale(1.1); }
        }

        .hero-content {
          position: relative;
          z-index: 10;
        }

        .hero-badge {
          display: inline-block;
          padding: 0.5rem 1rem;
          background: rgba(30, 74, 122, 0.1);
          color: var(--primary);
          font-size: 0.75rem;
          font-weight: 600;
          text-transform: uppercase;
          letter-spacing: 0.1em;
          border-radius: 50px;
          margin-bottom: 1.5rem;
        }

        .hero h1 {
          font-family: 'Overpass', sans-serif;
          font-size: 3.5rem;
          font-weight: 700;
          line-height: 1.1;
          margin: 0 0 1.5rem;
        }

        .hero-line-1 {
          display: block;
          color: var(--text-secondary);
        }

        .hero-line-2 {
          display: block;
          color: var(--primary);
        }

        .hero-subtitle {
          font-size: 1.125rem;
          color: var(--text-secondary);
          line-height: 1.7;
          max-width: 480px;
          margin-bottom: 2rem;
        }

        .hero-ctas {
          display: flex;
          gap: 1rem;
        }

        .cta-primary {
          display: inline-flex;
          align-items: center;
          gap: 0.5rem;
          padding: 0.875rem 1.5rem;
          background: var(--accent);
          color: white;
          border: none;
          border-radius: 8px;
          font-family: inherit;
          font-size: 0.9375rem;
          font-weight: 600;
          cursor: pointer;
          transition: all 0.2s;
        }

        .cta-primary:hover {
          background: var(--accent-hover);
          transform: translateY(-2px);
          box-shadow: 0 8px 24px rgba(255, 107, 53, 0.3);
        }

        .cta-primary.large {
          padding: 1rem 2rem;
          font-size: 1rem;
        }

        .cta-secondary {
          padding: 0.875rem 1.5rem;
          background: white;
          color: var(--text);
          border: 2px solid var(--border);
          border-radius: 8px;
          font-family: inherit;
          font-size: 0.9375rem;
          font-weight: 600;
          cursor: pointer;
          transition: all 0.2s;
        }

        .cta-secondary:hover {
          border-color: var(--primary);
          color: var(--primary);
        }

        /* Hero Visual / Mockup */
        .hero-visual {
          position: relative;
          z-index: 10;
          display: flex;
          justify-content: center;
        }

        .mockup-container {
          perspective: 1000px;
        }

        .mockup-screen {
          width: 400px;
          background: white;
          border-radius: 12px;
          box-shadow: 0 24px 80px rgba(0, 0, 0, 0.15);
          overflow: hidden;
          transform: rotateY(-5deg) rotateX(2deg);
          animation: mockupFloat 6s ease-in-out infinite;
        }

        @keyframes mockupFloat {
          0%, 100% { transform: rotateY(-5deg) rotateX(2deg) translateY(0); }
          50% { transform: rotateY(-5deg) rotateX(2deg) translateY(-10px); }
        }

        .mockup-header {
          padding: 0.75rem 1rem;
          background: #f8f8f8;
          border-bottom: 1px solid #eee;
        }

        .mockup-dots {
          display: flex;
          gap: 6px;
        }

        .mockup-dots span {
          width: 10px;
          height: 10px;
          border-radius: 50%;
          background: #ddd;
        }

        .mockup-dots span:nth-child(1) { background: #ff5f56; }
        .mockup-dots span:nth-child(2) { background: #ffbd2e; }
        .mockup-dots span:nth-child(3) { background: #27ca41; }

        .mockup-content {
          padding: 1.5rem;
        }

        .mockup-input {
          background: #f5f5f5;
          padding: 1rem;
          border-radius: 8px;
          font-size: 0.875rem;
          color: var(--text-secondary);
          margin-bottom: 1.5rem;
          display: flex;
          align-items: center;
        }

        .typing-text {
          display: inline-block;
          overflow: hidden;
          white-space: nowrap;
          border-right: 2px solid var(--primary);
          animation: typing 5s steps(40, end) forwards, blink 0.7s step-end infinite;
        }

        @keyframes typing {
          0% { max-width: 0; }
          35% { max-width: 500px; }
          65% { max-width: 500px; }
          100% { max-width: 0; }
        }

        @keyframes blink {
          50% { border-color: transparent; }
        }

        .mockup-preview {
          height: 180px;
          background: linear-gradient(135deg, #e8f4f8, #f0f4ff);
          border-radius: 8px;
          position: relative;
          overflow: hidden;
        }

        .preview-shape {
          position: absolute;
          border-radius: 50%;
          animation: shapeReveal 4s ease-out infinite;
        }

        .shape-1 {
          width: 80px;
          height: 80px;
          background: var(--accent);
          opacity: 0.8;
          top: 20%;
          left: 15%;
          animation-delay: 0s;
        }

        .shape-2 {
          width: 60px;
          height: 60px;
          background: #30D5C8;
          opacity: 0.8;
          top: 40%;
          left: 50%;
          animation-delay: 0.3s;
        }

        .shape-3 {
          width: 100px;
          height: 100px;
          background: var(--primary);
          opacity: 0.8;
          top: 50%;
          right: 10%;
          animation-delay: 0.6s;
        }

        @keyframes shapeReveal {
          0%, 100% { transform: scale(0.8); opacity: 0.4; }
          50% { transform: scale(1); opacity: 0.8; }
        }

        /* Section Headers */
        .section-header {
          text-align: center;
          margin-bottom: 4rem;
        }

        .section-header.light h2,
        .section-header.light .section-subtitle {
          color: white;
        }

        .section-header.light .section-tag {
          background: rgba(255, 255, 255, 0.1);
          color: rgba(255, 255, 255, 0.9);
        }

        .section-tag {
          display: inline-block;
          padding: 0.375rem 0.875rem;
          background: rgba(30, 74, 122, 0.1);
          color: var(--primary);
          font-size: 0.6875rem;
          font-weight: 600;
          text-transform: uppercase;
          letter-spacing: 0.15em;
          border-radius: 50px;
          margin-bottom: 1rem;
        }

        .section-header h2 {
          font-family: 'Overpass', sans-serif;
          font-size: 2.5rem;
          font-weight: 700;
          color: var(--text);
          margin: 0;
        }

        .section-subtitle {
          margin-top: 1rem;
          font-size: 1.125rem;
          color: var(--text-secondary);
        }

        /* How It Works */
        .how-it-works {
          padding: 6rem 4rem;
          background: white;
        }

        .steps-container {
          display: flex;
          align-items: flex-start;
          justify-content: center;
          gap: 1rem;
        }

        .step {
          flex: 1;
          max-width: 280px;
          text-align: center;
          padding: 2rem 1.5rem;
        }

        .step-number {
          font-family: 'Overpass', sans-serif;
          font-size: 3rem;
          font-weight: 700;
          color: rgba(30, 74, 122, 0.1);
          margin-bottom: 1rem;
        }

        .step-icon {
          width: 64px;
          height: 64px;
          margin: 0 auto 1.5rem;
          display: flex;
          align-items: center;
          justify-content: center;
          background: rgba(255, 107, 53, 0.1);
          border-radius: 16px;
          color: var(--accent);
        }

        .step h3 {
          font-family: 'Overpass', sans-serif;
          font-size: 1.25rem;
          font-weight: 600;
          margin: 0 0 0.75rem;
          color: var(--text);
        }

        .step p {
          font-size: 0.9375rem;
          color: var(--text-secondary);
          line-height: 1.6;
          margin: 0;
        }

        .step-connector {
          width: 100px;
          padding-top: 5rem;
          color: var(--border);
        }

        /* Features */
        .features {
          padding: 6rem 4rem;
          background: var(--bg);
        }

        .features-grid {
          display: grid;
          grid-template-columns: repeat(3, 1fr);
          gap: 1.5rem;
          max-width: 1200px;
          margin: 0 auto;
        }

        .feature-card {
          background: white;
          padding: 2rem;
          border-radius: 12px;
          border: 1px solid var(--border);
          transition: all 0.3s;
        }

        .feature-card:hover {
          transform: translateY(-4px);
          box-shadow: 0 12px 40px rgba(0, 0, 0, 0.08);
        }

        .feature-highlight {
          grid-column: span 2;
          background: linear-gradient(135deg, var(--primary), var(--primary-light));
          color: white;
          border: none;
        }

        .feature-highlight .feature-icon {
          background: rgba(255, 255, 255, 0.2);
          color: white;
        }

        .feature-highlight h3 {
          color: white;
        }

        .feature-highlight p {
          color: rgba(255, 255, 255, 0.9);
        }

        .feature-icon {
          width: 56px;
          height: 56px;
          display: flex;
          align-items: center;
          justify-content: center;
          background: rgba(30, 74, 122, 0.1);
          border-radius: 12px;
          color: var(--primary);
          margin-bottom: 1.25rem;
        }

        .feature-card h3 {
          font-family: 'Overpass', sans-serif;
          font-size: 1.125rem;
          font-weight: 600;
          margin: 0 0 0.5rem;
        }

        .feature-card p {
          font-size: 0.875rem;
          color: var(--text-secondary);
          line-height: 1.6;
          margin: 0;
        }

        .feature-example {
          margin-top: 1.5rem;
          padding: 0.875rem 1rem;
          background: rgba(255, 255, 255, 0.1);
          border-radius: 8px;
          font-size: 0.8125rem;
          font-style: italic;
          opacity: 0.9;
        }

        /* Unified Showcase Section */
        .unified-showcase {
          padding: 6rem 4rem;
          background: white;
        }

        .showcase-container {
          max-width: 900px;
          margin: 0 auto;
        }

        .showcase-card {
          background: linear-gradient(135deg, #f8fafc, #f1f5f9);
          border-radius: 24px;
          padding: 3rem;
          border: 1px solid var(--border);
          text-align: center;
        }

        .showcase-canvas {
          position: relative;
          height: 280px;
          margin-bottom: 2rem;
        }

        .canvas-preview {
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 240px;
          height: 160px;
          background: white;
          border-radius: 12px;
          border: 2px solid var(--border);
          box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08);
          overflow: hidden;
        }

        .canvas-grid {
          position: absolute;
          inset: 0;
          background-image:
            linear-gradient(rgba(30, 74, 122, 0.05) 1px, transparent 1px),
            linear-gradient(90deg, rgba(30, 74, 122, 0.05) 1px, transparent 1px);
          background-size: 20px 20px;
        }

        .canvas-surface {
          position: absolute;
          inset: 10px;
          background: #e8f4f8;
          border-radius: 4px;
        }

        .surface-court {
          position: absolute;
          top: 20%;
          left: 15%;
          width: 70%;
          height: 60%;
          border: 2px solid #00a6a3;
          border-radius: 4px;
          opacity: 0.8;
        }

        .surface-court::before {
          content: '';
          position: absolute;
          top: 50%;
          left: 0;
          right: 0;
          height: 2px;
          background: #00a6a3;
        }

        .surface-court::after {
          content: '';
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 20px;
          height: 20px;
          border: 2px solid #00a6a3;
          border-radius: 50%;
        }

        .surface-motif {
          position: absolute;
          bottom: 10%;
          right: 10%;
          width: 35px;
          height: 35px;
          background: var(--accent);
          border-radius: 50%;
          opacity: 0.8;
          animation: motifPulse 3s ease-in-out infinite;
        }

        @keyframes motifPulse {
          0%, 100% { transform: scale(1); opacity: 0.8; }
          50% { transform: scale(1.1); opacity: 1; }
        }

        .capability-pill {
          position: absolute;
          display: flex;
          align-items: center;
          gap: 0.5rem;
          padding: 0.625rem 1rem;
          background: white;
          border-radius: 50px;
          box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
          font-size: 0.8125rem;
          font-weight: 500;
          color: var(--text);
          animation: pillFloat 4s ease-in-out infinite;
        }

        .pill-courts {
          top: 10%;
          left: 5%;
          animation-delay: 0s;
        }

        .pill-courts svg {
          color: #00a6a3;
        }

        .pill-ai {
          top: 5%;
          right: 10%;
          animation-delay: 0.5s;
        }

        .pill-ai svg {
          color: var(--accent);
        }

        .pill-upload {
          bottom: 15%;
          left: 8%;
          animation-delay: 1s;
        }

        .pill-upload svg {
          color: var(--primary);
        }

        .pill-layers {
          bottom: 10%;
          right: 5%;
          animation-delay: 1.5s;
        }

        .pill-layers svg {
          color: #30D5C8;
        }

        @keyframes pillFloat {
          0%, 100% { transform: translateY(0); }
          50% { transform: translateY(-8px); }
        }

        .showcase-tagline {
          font-family: 'Overpass', sans-serif;
          font-size: 1.5rem;
          font-weight: 600;
          color: var(--text);
          margin-bottom: 2rem;
        }

        .showcase-features {
          display: flex;
          justify-content: center;
          gap: 2rem;
          flex-wrap: wrap;
          margin-bottom: 2rem;
        }

        .showcase-feature {
          display: flex;
          align-items: center;
          gap: 0.625rem;
          font-size: 0.875rem;
          color: var(--text-secondary);
        }

        .feature-badge {
          padding: 0.25rem 0.625rem;
          border-radius: 50px;
          font-size: 0.625rem;
          font-weight: 700;
          letter-spacing: 0.05em;
        }

        .ai-badge {
          background: rgba(255, 107, 53, 0.1);
          color: var(--accent);
        }

        .template-badge {
          background: rgba(0, 166, 163, 0.1);
          color: #00a6a3;
        }

        .compose-badge {
          background: rgba(30, 74, 122, 0.1);
          color: var(--primary);
        }

        .showcase-cta {
          margin: 0 auto;
        }

        /* Unified Features Grid */
        .unified-features {
          grid-template-columns: repeat(3, 1fr);
        }

        /* Infinite symbol styling */
        .infinite-symbol {
          font-size: 3.5rem;
          line-height: 1;
        }

        /* Benefits Grid 4 columns */
        .benefits-grid-4 {
          grid-template-columns: repeat(4, 1fr);
        }

        /* Palette Section */
        .palette-section {
          padding: 6rem 4rem;
          background: var(--bg-dark);
        }

        .palette-grid {
          display: grid;
          grid-template-columns: repeat(7, 1fr);
          gap: 1rem;
          max-width: 1000px;
          margin: 0 auto;
        }

        .palette-swatch {
          animation: swatchReveal 0.5s ease-out forwards;
          animation-delay: var(--delay);
          opacity: 0;
          transform: translateY(20px);
        }

        @keyframes swatchReveal {
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        .swatch-color {
          aspect-ratio: 1;
          background: var(--swatch-color);
          border-radius: 8px;
          margin-bottom: 0.5rem;
          transition: transform 0.2s;
        }

        .palette-swatch:hover .swatch-color {
          transform: scale(1.1);
        }

        .swatch-info {
          text-align: center;
        }

        .swatch-name {
          display: block;
          font-size: 0.6875rem;
          font-weight: 500;
          color: white;
        }

        .swatch-code {
          display: block;
          font-size: 0.625rem;
          color: rgba(255, 255, 255, 0.5);
        }

        /* Benefits */
        .benefits {
          padding: 6rem 4rem;
          background: white;
        }

        .benefits-grid {
          display: grid;
          grid-template-columns: repeat(3, 1fr);
          gap: 3rem;
          max-width: 1000px;
          margin: 0 auto;
          text-align: center;
        }

        .benefit-metric {
          font-family: 'Overpass', sans-serif;
          font-size: 4rem;
          font-weight: 700;
          color: var(--accent);
          line-height: 1;
        }

        .benefit-label {
          font-family: 'Overpass', sans-serif;
          font-size: 1.125rem;
          font-weight: 600;
          color: var(--text);
          margin: 0.5rem 0 1rem;
        }

        .benefit p {
          font-size: 0.875rem;
          color: var(--text-secondary);
          line-height: 1.6;
          margin: 0;
        }

        /* Company Footer */
        .landing-footer {
          padding: 3rem 4rem;
          background: var(--bg-dark);
          border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .footer-content {
          max-width: 1200px;
          margin: 0 auto;
          display: flex;
          justify-content: space-between;
          align-items: center;
          flex-wrap: wrap;
          gap: 2rem;
        }

        .footer-brand {
          display: flex;
          flex-direction: column;
          gap: 0.25rem;
        }

        .footer-logo {
          font-family: 'Overpass', sans-serif;
          font-size: 1.25rem;
          font-weight: 600;
          color: white;
        }

        .footer-tagline {
          font-size: 0.875rem;
          color: rgba(255, 255, 255, 0.8);
        }

        .footer-division {
          font-size: 0.75rem;
          color: rgba(255, 255, 255, 0.5);
        }

        .footer-links {
          display: flex;
          gap: 2rem;
        }

        .footer-links a {
          font-size: 0.875rem;
          color: rgba(255, 255, 255, 0.7);
          text-decoration: none;
          transition: color 0.2s;
        }

        .footer-links a:hover {
          color: var(--accent);
        }

        /* CTA Footer */
        .cta-footer {
          padding: 6rem 4rem;
          background: var(--bg);
          text-align: center;
        }

        .cta-content h2 {
          font-family: 'Overpass', sans-serif;
          font-size: 2.5rem;
          font-weight: 700;
          color: var(--text);
          margin: 0 0 1rem;
        }

        .cta-content > p {
          font-size: 1.125rem;
          color: var(--text-secondary);
          margin-bottom: 2rem;
        }

        .cta-note {
          margin-top: 1.5rem;
          font-size: 0.875rem;
          color: var(--text-light);
        }

        .cta-note a {
          color: var(--primary);
          text-decoration: none;
        }

        .cta-note a:hover {
          text-decoration: underline;
        }

        /* Modal */
        .modal-overlay {
          position: fixed;
          inset: 0;
          background: rgba(0, 0, 0, 0.5);
          backdrop-filter: blur(4px);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 2000;
          padding: 2rem;
        }

        .sign-in-modal {
          background: white;
          border-radius: 16px;
          padding: 2.5rem;
          width: 100%;
          max-width: 400px;
          position: relative;
          animation: modalSlide 0.3s ease-out;
        }

        @keyframes modalSlide {
          from {
            opacity: 0;
            transform: translateY(-20px);
          }
        }

        .modal-close {
          position: absolute;
          top: 1rem;
          right: 1rem;
          width: 32px;
          height: 32px;
          display: flex;
          align-items: center;
          justify-content: center;
          background: none;
          border: none;
          color: var(--text-light);
          cursor: pointer;
          border-radius: 6px;
          transition: all 0.2s;
        }

        .modal-close:hover {
          background: var(--bg);
          color: var(--text);
        }

        .modal-header {
          text-align: center;
          margin-bottom: 1.5rem;
        }

        .modal-header h2 {
          font-family: 'Overpass', sans-serif;
          font-size: 1.5rem;
          font-weight: 600;
          margin: 0 0 0.25rem;
        }

        .modal-header p {
          font-size: 0.875rem;
          color: var(--text-secondary);
          margin: 0;
        }

        .form-error {
          padding: 0.75rem 1rem;
          background: #fef2f2;
          color: #dc2626;
          border-radius: 8px;
          font-size: 0.875rem;
          margin-bottom: 1rem;
        }

        .form-group {
          margin-bottom: 1rem;
        }

        .form-group label {
          display: block;
          font-size: 0.875rem;
          font-weight: 500;
          margin-bottom: 0.5rem;
        }

        .form-group input {
          width: 100%;
          padding: 0.75rem 1rem;
          border: 1px solid var(--border);
          border-radius: 8px;
          font-family: inherit;
          font-size: 0.9375rem;
          transition: all 0.2s;
        }

        .form-group input:focus {
          outline: none;
          border-color: var(--primary);
          box-shadow: 0 0 0 3px rgba(30, 74, 122, 0.1);
        }

        .submit-btn {
          width: 100%;
          padding: 0.875rem;
          background: var(--accent);
          color: white;
          border: none;
          border-radius: 8px;
          font-family: inherit;
          font-size: 0.9375rem;
          font-weight: 600;
          cursor: pointer;
          transition: all 0.2s;
        }

        .submit-btn:hover:not(:disabled) {
          background: var(--accent-hover);
        }

        .submit-btn:disabled {
          opacity: 0.6;
          cursor: not-allowed;
        }

        .modal-footer-text {
          text-align: center;
          font-size: 0.8125rem;
          color: var(--text-light);
          margin: 1.5rem 0 0;
        }

        /* Responsive */
        @media (max-width: 1024px) {
          .hero {
            grid-template-columns: 1fr;
            text-align: center;
          }

          .hero-content {
            max-width: 600px;
            margin: 0 auto;
          }

          .hero-subtitle {
            margin-left: auto;
            margin-right: auto;
          }

          .hero-ctas {
            justify-content: center;
          }

          .hero-visual {
            display: none;
          }

          .showcase-canvas {
            height: 240px;
          }

          .capability-pill {
            padding: 0.5rem 0.75rem;
            font-size: 0.75rem;
          }

          .features-grid {
            grid-template-columns: repeat(2, 1fr);
          }

          .unified-features {
            grid-template-columns: repeat(2, 1fr);
          }

          .feature-highlight {
            grid-column: span 2;
          }

          .benefits-grid-4 {
            grid-template-columns: repeat(2, 1fr);
          }

          .palette-grid {
            grid-template-columns: repeat(5, 1fr);
          }
        }

        @media (max-width: 768px) {
          .landing-nav {
            padding: 1rem 1.5rem;
          }

          .nav-links {
            gap: 1rem;
          }

          .hero {
            padding: 6rem 1.5rem 3rem;
          }

          .hero h1 {
            font-size: 2.5rem;
          }

          .steps-container {
            flex-direction: column;
            gap: 0;
          }

          .step-connector {
            display: none;
          }

          .features-grid,
          .unified-features {
            grid-template-columns: 1fr;
          }

          .feature-highlight {
            grid-column: span 1;
          }

          .section-header h2 {
            font-size: 2rem;
          }

          .how-it-works,
          .features,
          .palette-section,
          .benefits,
          .cta-footer,
          .unified-showcase,
          .landing-footer {
            padding: 4rem 1.5rem;
          }

          .footer-content {
            flex-direction: column;
            text-align: center;
          }

          .footer-links {
            flex-direction: column;
            gap: 1rem;
          }

          .logo-byline {
            display: none;
          }

          .showcase-card {
            padding: 2rem 1.5rem;
          }

          .showcase-canvas {
            height: 200px;
          }

          .canvas-preview {
            width: 180px;
            height: 120px;
          }

          .capability-pill {
            display: none;
          }

          .showcase-features {
            flex-direction: column;
            gap: 1rem;
          }

          .showcase-tagline {
            font-size: 1.25rem;
          }

          .benefits-grid,
          .benefits-grid-4 {
            grid-template-columns: 1fr;
            gap: 2rem;
          }

          .palette-grid {
            grid-template-columns: repeat(4, 1fr);
          }
        }

        @media (max-width: 480px) {
          .nav-links button:not(.nav-cta) {
            display: none;
          }

          .hero h1 {
            font-size: 2rem;
          }

          .cta-content h2 {
            font-size: 1.75rem;
          }

          .palette-grid {
            grid-template-columns: repeat(3, 1fr);
          }
        }
      `})]})}function BW({user:t,onPasswordSet:e}){const[n,r]=R.useState(""),[s,i]=R.useState(""),[a,l]=R.useState(!1),[c,d]=R.useState(""),u=async p=>{if(p.preventDefault(),d(""),n.length<8){d("Password must be at least 8 characters long");return}if(!/[A-Z]/.test(n)){d("Password must contain at least one uppercase letter");return}if(!/[a-z]/.test(n)){d("Password must contain at least one lowercase letter");return}if(!/[0-9]/.test(n)){d("Password must contain at least one number");return}if(n!==s){d("Passwords do not match");return}l(!0);try{await Nr.updatePassword(n),e()}catch(h){d(h.message||"Failed to set password. Please try again.")}finally{l(!1)}};return o.jsx("div",{className:"tpv-studio",children:o.jsx("div",{className:"tpv-studio__container",style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh"},children:o.jsxs("div",{style:{maxWidth:"400px",width:"100%",padding:"2rem",background:"#fff",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[o.jsx("h2",{style:{marginBottom:"0.5rem",fontSize:"1.5rem"},children:"Welcome to TPV Studio"}),o.jsxs("p",{style:{marginBottom:"1.5rem",color:"#666",fontSize:"0.9rem"},children:["Please set a password for your account: ",o.jsx("strong",{children:t.email})]}),o.jsxs("form",{onSubmit:u,children:[o.jsxs("div",{style:{marginBottom:"1rem"},children:[o.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.9rem",fontWeight:"500"},children:"New Password"}),o.jsx("input",{type:"password",value:n,onChange:p=>r(p.target.value),placeholder:"Enter your password",required:!0,minLength:8,style:{width:"100%",padding:"0.75rem",border:"1px solid #ddd",borderRadius:"4px",fontSize:"1rem"}}),o.jsx("small",{style:{display:"block",marginTop:"0.25rem",color:"#666"},children:"At least 8 characters with uppercase, lowercase, and a number"})]}),o.jsxs("div",{style:{marginBottom:"1.5rem"},children:[o.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.9rem",fontWeight:"500"},children:"Confirm Password"}),o.jsx("input",{type:"password",value:s,onChange:p=>i(p.target.value),placeholder:"Confirm your password",required:!0,minLength:8,style:{width:"100%",padding:"0.75rem",border:"1px solid #ddd",borderRadius:"4px",fontSize:"1rem"}})]}),c&&o.jsx("div",{style:{padding:"0.75rem",marginBottom:"1rem",background:"#fee",border:"1px solid #fcc",borderRadius:"4px",color:"#c00",fontSize:"0.9rem"},children:c}),o.jsx("button",{type:"submit",disabled:a,style:{width:"100%",padding:"0.75rem",background:a?"#ccc":"#007bff",color:"#fff",border:"none",borderRadius:"4px",fontSize:"1rem",fontWeight:"500",cursor:a?"not-allowed":"pointer"},children:a?"Setting Password...":"Set Password"})]})]})})})}function HW(){const[t,e]=R.useState(null),[n,r]=R.useState(!0),[s,i]=R.useState(!1),[a,l]=R.useState(!1),[c,d]=R.useState(!1),[u,p]=R.useState(!1),[h,f]=R.useState(null),[m,g]=R.useState(null),v=async()=>{try{const w=await Nr.getSession();if(!(w!=null&&w.access_token)){d(!1);return}const S=await fetch("/api/admin/users",{headers:{Authorization:`Bearer ${w.access_token}`}});d(S.ok)}catch{console.error("[APP] Admin check failed"),d(!1)}},y=async w=>{try{console.log("[APP] Loading design from URL:",w);const{design:S}=await Ol(w);if(S){x(S);const _=new URL(window.location);_.searchParams.delete("design"),window.history.replaceState({},"",_)}}catch(S){console.error("[APP] Failed to load design from URL:",S)}};R.useEffect(()=>{Nr.getSession().then(S=>{var k;const _=(S==null?void 0:S.user)||null;if(e(_),r(!1),_){const E=(k=_.user_metadata)==null?void 0:k.password_setup_complete;p(!E),v();const O=new URLSearchParams(window.location.search).get("design");O&&y(O)}});const{data:w}=Nr.onAuthStateChange((S,_)=>{var E;const k=(_==null?void 0:_.user)||null;if(e(k),k){const T=(E=k.user_metadata)==null?void 0:E.password_setup_complete;p(!T),v()}else d(!1),p(!1)});return()=>w==null?void 0:w.unsubscribe()},[]);const x=w=>{f(w),g(w.name)},b=async()=>{p(!1);const w=await Nr.getSession();e((w==null?void 0:w.user)||null)};return n?o.jsx("div",{className:"tpv-studio",children:o.jsx("div",{className:"tpv-studio__container",children:o.jsxs("div",{className:"tpv-studio__empty",children:[o.jsx("div",{className:"tpv-studio__spinner"}),o.jsx("p",{children:"Loading..."})]})})}):t?u?o.jsx(BW,{user:t,onPasswordSet:b}):a?o.jsx("div",{className:"tpv-studio",children:o.jsx(AW,{onClose:()=>l(!1)})}):o.jsx(aE,{children:o.jsxs("div",{className:"tpv-studio",children:[o.jsx(TW,{onShowDesigns:()=>i(!0),onShowAdmin:()=>l(!0),isAdmin:c,currentDesignName:m}),o.jsx("main",{className:"tpv-studio__container tpv-studio__container--full",children:o.jsx(EW,{loadedDesign:h})}),s&&o.jsx(PW,{onClose:()=>i(!1),onLoadDesign:x})]})}):o.jsx(FW,{})}dh.createRoot(document.getElementById("root")).render(o.jsx($.StrictMode,{children:o.jsx(HW,{})}))});export default UW();
//# sourceMappingURL=index-CzttGypy.js.map
