var o_=Object.defineProperty;var s_=(t,e,r)=>e in t?o_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var a_=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var hm=(t,e,r)=>s_(t,typeof e!="symbol"?e+"":e,r);var gU=a_((mr,gr)=>{function l_(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in t)){const o=Object.getOwnPropertyDescriptor(n,i);o&&Object.defineProperty(t,i,o.get?o:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();var Gn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Xc(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function c_(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}),r}var ly={exports:{}},Zc={},cy={exports:{}},Ye={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Da=Symbol.for("react.element"),d_=Symbol.for("react.portal"),u_=Symbol.for("react.fragment"),h_=Symbol.for("react.strict_mode"),f_=Symbol.for("react.profiler"),p_=Symbol.for("react.provider"),m_=Symbol.for("react.context"),g_=Symbol.for("react.forward_ref"),v_=Symbol.for("react.suspense"),y_=Symbol.for("react.memo"),x_=Symbol.for("react.lazy"),fm=Symbol.iterator;function b_(t){return t===null||typeof t!="object"?null:(t=fm&&t[fm]||t["@@iterator"],typeof t=="function"?t:null)}var dy={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},uy=Object.assign,hy={};function hs(t,e,r){this.props=t,this.context=e,this.refs=hy,this.updater=r||dy}hs.prototype.isReactComponent={};hs.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};hs.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function fy(){}fy.prototype=hs.prototype;function lf(t,e,r){this.props=t,this.context=e,this.refs=hy,this.updater=r||dy}var cf=lf.prototype=new fy;cf.constructor=lf;uy(cf,hs.prototype);cf.isPureReactComponent=!0;var pm=Array.isArray,py=Object.prototype.hasOwnProperty,df={current:null},my={key:!0,ref:!0,__self:!0,__source:!0};function gy(t,e,r){var n,i={},o=null,s=null;if(e!=null)for(n in e.ref!==void 0&&(s=e.ref),e.key!==void 0&&(o=""+e.key),e)py.call(e,n)&&!my.hasOwnProperty(n)&&(i[n]=e[n]);var l=arguments.length-2;if(l===1)i.children=r;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];i.children=c}if(t&&t.defaultProps)for(n in l=t.defaultProps,l)i[n]===void 0&&(i[n]=l[n]);return{$$typeof:Da,type:t,key:o,ref:s,props:i,_owner:df.current}}function w_(t,e){return{$$typeof:Da,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function uf(t){return typeof t=="object"&&t!==null&&t.$$typeof===Da}function __(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var mm=/\/+/g;function Ld(t,e){return typeof t=="object"&&t!==null&&t.key!=null?__(""+t.key):e.toString(36)}function Yl(t,e,r,n,i){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var s=!1;if(t===null)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(t.$$typeof){case Da:case d_:s=!0}}if(s)return s=t,i=i(s),t=n===""?"."+Ld(s,0):n,pm(i)?(r="",t!=null&&(r=t.replace(mm,"$&/")+"/"),Yl(i,e,r,"",function(d){return d})):i!=null&&(uf(i)&&(i=w_(i,r+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(mm,"$&/")+"/")+t)),e.push(i)),1;if(s=0,n=n===""?".":n+":",pm(t))for(var l=0;l<t.length;l++){o=t[l];var c=n+Ld(o,l);s+=Yl(o,e,r,c,i)}else if(c=b_(t),typeof c=="function")for(t=c.call(t),l=0;!(o=t.next()).done;)o=o.value,c=n+Ld(o,l++),s+=Yl(o,e,r,c,i);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return s}function fl(t,e,r){if(t==null)return t;var n=[],i=0;return Yl(t,n,"","",function(o){return e.call(r,o,i++)}),n}function S_(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Zt={current:null},Xl={transition:null},k_={ReactCurrentDispatcher:Zt,ReactCurrentBatchConfig:Xl,ReactCurrentOwner:df};function vy(){throw Error("act(...) is not supported in production builds of React.")}Ye.Children={map:fl,forEach:function(t,e,r){fl(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return fl(t,function(){e++}),e},toArray:function(t){return fl(t,function(e){return e})||[]},only:function(t){if(!uf(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ye.Component=hs;Ye.Fragment=u_;Ye.Profiler=f_;Ye.PureComponent=lf;Ye.StrictMode=h_;Ye.Suspense=v_;Ye.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=k_;Ye.act=vy;Ye.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=uy({},t.props),i=t.key,o=t.ref,s=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,s=df.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)py.call(e,c)&&!my.hasOwnProperty(c)&&(n[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];n.children=l}return{$$typeof:Da,type:t.type,key:i,ref:o,props:n,_owner:s}};Ye.createContext=function(t){return t={$$typeof:m_,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:p_,_context:t},t.Consumer=t};Ye.createElement=gy;Ye.createFactory=function(t){var e=gy.bind(null,t);return e.type=t,e};Ye.createRef=function(){return{current:null}};Ye.forwardRef=function(t){return{$$typeof:g_,render:t}};Ye.isValidElement=uf;Ye.lazy=function(t){return{$$typeof:x_,_payload:{_status:-1,_result:t},_init:S_}};Ye.memo=function(t,e){return{$$typeof:y_,type:t,compare:e===void 0?null:e}};Ye.startTransition=function(t){var e=Xl.transition;Xl.transition={};try{t()}finally{Xl.transition=e}};Ye.unstable_act=vy;Ye.useCallback=function(t,e){return Zt.current.useCallback(t,e)};Ye.useContext=function(t){return Zt.current.useContext(t)};Ye.useDebugValue=function(){};Ye.useDeferredValue=function(t){return Zt.current.useDeferredValue(t)};Ye.useEffect=function(t,e){return Zt.current.useEffect(t,e)};Ye.useId=function(){return Zt.current.useId()};Ye.useImperativeHandle=function(t,e,r){return Zt.current.useImperativeHandle(t,e,r)};Ye.useInsertionEffect=function(t,e){return Zt.current.useInsertionEffect(t,e)};Ye.useLayoutEffect=function(t,e){return Zt.current.useLayoutEffect(t,e)};Ye.useMemo=function(t,e){return Zt.current.useMemo(t,e)};Ye.useReducer=function(t,e,r){return Zt.current.useReducer(t,e,r)};Ye.useRef=function(t){return Zt.current.useRef(t)};Ye.useState=function(t){return Zt.current.useState(t)};Ye.useSyncExternalStore=function(t,e,r){return Zt.current.useSyncExternalStore(t,e,r)};Ye.useTransition=function(){return Zt.current.useTransition()};Ye.version="18.3.1";cy.exports=Ye;var A=cy.exports;const $=Xc(A);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var j_=A,C_=Symbol.for("react.element"),E_=Symbol.for("react.fragment"),T_=Object.prototype.hasOwnProperty,R_=j_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,N_={key:!0,ref:!0,__self:!0,__source:!0};function yy(t,e,r){var n,i={},o=null,s=null;r!==void 0&&(o=""+r),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(s=e.ref);for(n in e)T_.call(e,n)&&!N_.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:C_,type:t,key:o,ref:s,props:i,_owner:R_.current}}Zc.Fragment=E_;Zc.jsx=yy;Zc.jsxs=yy;ly.exports=Zc;var a=ly.exports,Bu={},xy={exports:{}},br={},by={exports:{}},wy={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(q,D){var J=q.length;q.push(D);e:for(;0<J;){var U=J-1>>>1,G=q[U];if(0<i(G,D))q[U]=D,q[J]=G,J=U;else break e}}function r(q){return q.length===0?null:q[0]}function n(q){if(q.length===0)return null;var D=q[0],J=q.pop();if(J!==D){q[0]=J;e:for(var U=0,G=q.length,fe=G>>>1;U<fe;){var oe=2*(U+1)-1,ae=q[oe],le=oe+1,ce=q[le];if(0>i(ae,J))le<G&&0>i(ce,ae)?(q[U]=ce,q[le]=J,U=le):(q[U]=ae,q[oe]=J,U=oe);else if(le<G&&0>i(ce,J))q[U]=ce,q[le]=J,U=le;else break e}}return D}function i(q,D){var J=q.sortIndex-D.sortIndex;return J!==0?J:q.id-D.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,l=s.now();t.unstable_now=function(){return s.now()-l}}var c=[],d=[],h=1,f=null,u=3,p=!1,g=!1,m=!1,x=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(q){for(var D=r(d);D!==null;){if(D.callback===null)n(d);else if(D.startTime<=q)n(d),D.sortIndex=D.expirationTime,e(c,D);else break;D=r(d)}}function w(q){if(m=!1,b(q),!g)if(r(c)!==null)g=!0,re(k);else{var D=r(d);D!==null&&I(w,D.startTime-q)}}function k(q,D){g=!1,m&&(m=!1,v(T),T=-1),p=!0;var J=u;try{for(b(D),f=r(c);f!==null&&(!(f.expirationTime>D)||q&&!Y());){var U=f.callback;if(typeof U=="function"){f.callback=null,u=f.priorityLevel;var G=U(f.expirationTime<=D);D=t.unstable_now(),typeof G=="function"?f.callback=G:f===r(c)&&n(c),b(D)}else n(c);f=r(c)}if(f!==null)var fe=!0;else{var oe=r(d);oe!==null&&I(w,oe.startTime-D),fe=!1}return fe}finally{f=null,u=J,p=!1}}var S=!1,C=null,T=-1,R=5,O=-1;function Y(){return!(t.unstable_now()-O<R)}function E(){if(C!==null){var q=t.unstable_now();O=q;var D=!0;try{D=C(!0,q)}finally{D?B():(S=!1,C=null)}}else S=!1}var B;if(typeof y=="function")B=function(){y(E)};else if(typeof MessageChannel<"u"){var _=new MessageChannel,V=_.port2;_.port1.onmessage=E,B=function(){V.postMessage(null)}}else B=function(){x(E,0)};function re(q){C=q,S||(S=!0,B())}function I(q,D){T=x(function(){q(t.unstable_now())},D)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(q){q.callback=null},t.unstable_continueExecution=function(){g||p||(g=!0,re(k))},t.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<q?Math.floor(1e3/q):5},t.unstable_getCurrentPriorityLevel=function(){return u},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(q){switch(u){case 1:case 2:case 3:var D=3;break;default:D=u}var J=u;u=D;try{return q()}finally{u=J}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(q,D){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var J=u;u=q;try{return D()}finally{u=J}},t.unstable_scheduleCallback=function(q,D,J){var U=t.unstable_now();switch(typeof J=="object"&&J!==null?(J=J.delay,J=typeof J=="number"&&0<J?U+J:U):J=U,q){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=J+G,q={id:h++,callback:D,priorityLevel:q,startTime:J,expirationTime:G,sortIndex:-1},J>U?(q.sortIndex=J,e(d,q),r(c)===null&&q===r(d)&&(m?(v(T),T=-1):m=!0,I(w,J-U))):(q.sortIndex=G,e(c,q),g||p||(g=!0,re(k))),q},t.unstable_shouldYield=Y,t.unstable_wrapCallback=function(q){var D=u;return function(){var J=u;u=D;try{return q.apply(this,arguments)}finally{u=J}}}})(wy);by.exports=wy;var P_=by.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var O_=A,yr=P_;function me(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var _y=new Set,ma={};function Wi(t,e){is(t,e),is(t+"Capture",e)}function is(t,e){for(ma[t]=e,t=0;t<e.length;t++)_y.add(e[t])}var xn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Uu=Object.prototype.hasOwnProperty,A_=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,gm={},vm={};function M_(t){return Uu.call(vm,t)?!0:Uu.call(gm,t)?!1:A_.test(t)?vm[t]=!0:(gm[t]=!0,!1)}function $_(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function I_(t,e,r,n){if(e===null||typeof e>"u"||$_(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Jt(t,e,r,n,i,o,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var zt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){zt[t]=new Jt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];zt[e]=new Jt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){zt[t]=new Jt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){zt[t]=new Jt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){zt[t]=new Jt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){zt[t]=new Jt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){zt[t]=new Jt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){zt[t]=new Jt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){zt[t]=new Jt(t,5,!1,t.toLowerCase(),null,!1,!1)});var hf=/[\-:]([a-z])/g;function ff(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(hf,ff);zt[e]=new Jt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(hf,ff);zt[e]=new Jt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(hf,ff);zt[e]=new Jt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){zt[t]=new Jt(t,1,!1,t.toLowerCase(),null,!1,!1)});zt.xlinkHref=new Jt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){zt[t]=new Jt(t,1,!1,t.toLowerCase(),null,!0,!0)});function pf(t,e,r,n){var i=zt.hasOwnProperty(e)?zt[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(I_(e,r,i,n)&&(r=null),n||i===null?M_(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var Sn=O_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,pl=Symbol.for("react.element"),Do=Symbol.for("react.portal"),zo=Symbol.for("react.fragment"),mf=Symbol.for("react.strict_mode"),Hu=Symbol.for("react.profiler"),Sy=Symbol.for("react.provider"),ky=Symbol.for("react.context"),gf=Symbol.for("react.forward_ref"),Wu=Symbol.for("react.suspense"),Gu=Symbol.for("react.suspense_list"),vf=Symbol.for("react.memo"),Dn=Symbol.for("react.lazy"),jy=Symbol.for("react.offscreen"),ym=Symbol.iterator;function Ms(t){return t===null||typeof t!="object"?null:(t=ym&&t[ym]||t["@@iterator"],typeof t=="function"?t:null)}var yt=Object.assign,Dd;function Ks(t){if(Dd===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);Dd=e&&e[1]||""}return`
`+Dd+t}var zd=!1;function Fd(t,e){if(!t||zd)return"";zd=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var n=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){n=d}t.call(e.prototype)}else{try{throw Error()}catch(d){n=d}t()}}catch(d){if(d&&n&&typeof d.stack=="string"){for(var i=d.stack.split(`
`),o=n.stack.split(`
`),s=i.length-1,l=o.length-1;1<=s&&0<=l&&i[s]!==o[l];)l--;for(;1<=s&&0<=l;s--,l--)if(i[s]!==o[l]){if(s!==1||l!==1)do if(s--,l--,0>l||i[s]!==o[l]){var c=`
`+i[s].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=s&&0<=l);break}}}finally{zd=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Ks(t):""}function L_(t){switch(t.tag){case 5:return Ks(t.type);case 16:return Ks("Lazy");case 13:return Ks("Suspense");case 19:return Ks("SuspenseList");case 0:case 2:case 15:return t=Fd(t.type,!1),t;case 11:return t=Fd(t.type.render,!1),t;case 1:return t=Fd(t.type,!0),t;default:return""}}function Vu(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case zo:return"Fragment";case Do:return"Portal";case Hu:return"Profiler";case mf:return"StrictMode";case Wu:return"Suspense";case Gu:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case ky:return(t.displayName||"Context")+".Consumer";case Sy:return(t._context.displayName||"Context")+".Provider";case gf:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case vf:return e=t.displayName||null,e!==null?e:Vu(t.type)||"Memo";case Dn:e=t._payload,t=t._init;try{return Vu(t(e))}catch{}}return null}function D_(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Vu(e);case 8:return e===mf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ri(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Cy(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function z_(t){var e=Cy(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,o=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(s){n=""+s,o.call(this,s)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(s){n=""+s},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function ml(t){t._valueTracker||(t._valueTracker=z_(t))}function Ey(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=Cy(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function lc(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function qu(t,e){var r=e.checked;return yt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function xm(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=ri(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Ty(t,e){e=e.checked,e!=null&&pf(t,"checked",e,!1)}function Ku(t,e){Ty(t,e);var r=ri(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Yu(t,e.type,r):e.hasOwnProperty("defaultValue")&&Yu(t,e.type,ri(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function bm(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function Yu(t,e,r){(e!=="number"||lc(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Ys=Array.isArray;function Zo(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+ri(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Xu(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(me(91));return yt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function wm(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(me(92));if(Ys(r)){if(1<r.length)throw Error(me(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:ri(r)}}function Ry(t,e){var r=ri(e.value),n=ri(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function _m(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Ny(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Zu(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Ny(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var gl,Py=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(gl=gl||document.createElement("div"),gl.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=gl.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ga(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var ra={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},F_=["Webkit","ms","Moz","O"];Object.keys(ra).forEach(function(t){F_.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ra[e]=ra[t]})});function Oy(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||ra.hasOwnProperty(t)&&ra[t]?(""+e).trim():e+"px"}function Ay(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=Oy(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var B_=yt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ju(t,e){if(e){if(B_[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(me(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(me(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(me(61))}if(e.style!=null&&typeof e.style!="object")throw Error(me(62))}}function Qu(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var eh=null;function yf(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var th=null,Jo=null,Qo=null;function Sm(t){if(t=Ba(t)){if(typeof th!="function")throw Error(me(280));var e=t.stateNode;e&&(e=rd(e),th(t.stateNode,t.type,e))}}function My(t){Jo?Qo?Qo.push(t):Qo=[t]:Jo=t}function $y(){if(Jo){var t=Jo,e=Qo;if(Qo=Jo=null,Sm(t),e)for(t=0;t<e.length;t++)Sm(e[t])}}function Iy(t,e){return t(e)}function Ly(){}var Bd=!1;function Dy(t,e,r){if(Bd)return t(e,r);Bd=!0;try{return Iy(t,e,r)}finally{Bd=!1,(Jo!==null||Qo!==null)&&(Ly(),$y())}}function va(t,e){var r=t.stateNode;if(r===null)return null;var n=rd(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(me(231,e,typeof r));return r}var rh=!1;if(xn)try{var $s={};Object.defineProperty($s,"passive",{get:function(){rh=!0}}),window.addEventListener("test",$s,$s),window.removeEventListener("test",$s,$s)}catch{rh=!1}function U_(t,e,r,n,i,o,s,l,c){var d=Array.prototype.slice.call(arguments,3);try{e.apply(r,d)}catch(h){this.onError(h)}}var na=!1,cc=null,dc=!1,nh=null,H_={onError:function(t){na=!0,cc=t}};function W_(t,e,r,n,i,o,s,l,c){na=!1,cc=null,U_.apply(H_,arguments)}function G_(t,e,r,n,i,o,s,l,c){if(W_.apply(this,arguments),na){if(na){var d=cc;na=!1,cc=null}else throw Error(me(198));dc||(dc=!0,nh=d)}}function Gi(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function zy(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function km(t){if(Gi(t)!==t)throw Error(me(188))}function V_(t){var e=t.alternate;if(!e){if(e=Gi(t),e===null)throw Error(me(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var o=i.alternate;if(o===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===r)return km(i),t;if(o===n)return km(i),e;o=o.sibling}throw Error(me(188))}if(r.return!==n.return)r=i,n=o;else{for(var s=!1,l=i.child;l;){if(l===r){s=!0,r=i,n=o;break}if(l===n){s=!0,n=i,r=o;break}l=l.sibling}if(!s){for(l=o.child;l;){if(l===r){s=!0,r=o,n=i;break}if(l===n){s=!0,n=o,r=i;break}l=l.sibling}if(!s)throw Error(me(189))}}if(r.alternate!==n)throw Error(me(190))}if(r.tag!==3)throw Error(me(188));return r.stateNode.current===r?t:e}function Fy(t){return t=V_(t),t!==null?By(t):null}function By(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=By(t);if(e!==null)return e;t=t.sibling}return null}var Uy=yr.unstable_scheduleCallback,jm=yr.unstable_cancelCallback,q_=yr.unstable_shouldYield,K_=yr.unstable_requestPaint,bt=yr.unstable_now,Y_=yr.unstable_getCurrentPriorityLevel,xf=yr.unstable_ImmediatePriority,Hy=yr.unstable_UserBlockingPriority,uc=yr.unstable_NormalPriority,X_=yr.unstable_LowPriority,Wy=yr.unstable_IdlePriority,Jc=null,tn=null;function Z_(t){if(tn&&typeof tn.onCommitFiberRoot=="function")try{tn.onCommitFiberRoot(Jc,t,void 0,(t.current.flags&128)===128)}catch{}}var Hr=Math.clz32?Math.clz32:e2,J_=Math.log,Q_=Math.LN2;function e2(t){return t>>>=0,t===0?32:31-(J_(t)/Q_|0)|0}var vl=64,yl=4194304;function Xs(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function hc(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,o=t.pingedLanes,s=r&268435455;if(s!==0){var l=s&~i;l!==0?n=Xs(l):(o&=s,o!==0&&(n=Xs(o)))}else s=r&~i,s!==0?n=Xs(s):o!==0&&(n=Xs(o));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,o=e&-e,i>=o||i===16&&(o&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-Hr(e),i=1<<r,n|=t[r],e&=~i;return n}function t2(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function r2(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,o=t.pendingLanes;0<o;){var s=31-Hr(o),l=1<<s,c=i[s];c===-1?(!(l&r)||l&n)&&(i[s]=t2(l,e)):c<=e&&(t.expiredLanes|=l),o&=~l}}function ih(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Gy(){var t=vl;return vl<<=1,!(vl&4194240)&&(vl=64),t}function Ud(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function za(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Hr(e),t[e]=r}function n2(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-Hr(r),o=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~o}}function bf(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Hr(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var et=0;function Vy(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var qy,wf,Ky,Yy,Xy,oh=!1,xl=[],Kn=null,Yn=null,Xn=null,ya=new Map,xa=new Map,Un=[],i2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Cm(t,e){switch(t){case"focusin":case"focusout":Kn=null;break;case"dragenter":case"dragleave":Yn=null;break;case"mouseover":case"mouseout":Xn=null;break;case"pointerover":case"pointerout":ya.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":xa.delete(e.pointerId)}}function Is(t,e,r,n,i,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:o,targetContainers:[i]},e!==null&&(e=Ba(e),e!==null&&wf(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function o2(t,e,r,n,i){switch(e){case"focusin":return Kn=Is(Kn,t,e,r,n,i),!0;case"dragenter":return Yn=Is(Yn,t,e,r,n,i),!0;case"mouseover":return Xn=Is(Xn,t,e,r,n,i),!0;case"pointerover":var o=i.pointerId;return ya.set(o,Is(ya.get(o)||null,t,e,r,n,i)),!0;case"gotpointercapture":return o=i.pointerId,xa.set(o,Is(xa.get(o)||null,t,e,r,n,i)),!0}return!1}function Zy(t){var e=Ni(t.target);if(e!==null){var r=Gi(e);if(r!==null){if(e=r.tag,e===13){if(e=zy(r),e!==null){t.blockedOn=e,Xy(t.priority,function(){Ky(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Zl(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=sh(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);eh=n,r.target.dispatchEvent(n),eh=null}else return e=Ba(r),e!==null&&wf(e),t.blockedOn=r,!1;e.shift()}return!0}function Em(t,e,r){Zl(t)&&r.delete(e)}function s2(){oh=!1,Kn!==null&&Zl(Kn)&&(Kn=null),Yn!==null&&Zl(Yn)&&(Yn=null),Xn!==null&&Zl(Xn)&&(Xn=null),ya.forEach(Em),xa.forEach(Em)}function Ls(t,e){t.blockedOn===e&&(t.blockedOn=null,oh||(oh=!0,yr.unstable_scheduleCallback(yr.unstable_NormalPriority,s2)))}function ba(t){function e(i){return Ls(i,t)}if(0<xl.length){Ls(xl[0],t);for(var r=1;r<xl.length;r++){var n=xl[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Kn!==null&&Ls(Kn,t),Yn!==null&&Ls(Yn,t),Xn!==null&&Ls(Xn,t),ya.forEach(e),xa.forEach(e),r=0;r<Un.length;r++)n=Un[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<Un.length&&(r=Un[0],r.blockedOn===null);)Zy(r),r.blockedOn===null&&Un.shift()}var es=Sn.ReactCurrentBatchConfig,fc=!0;function a2(t,e,r,n){var i=et,o=es.transition;es.transition=null;try{et=1,_f(t,e,r,n)}finally{et=i,es.transition=o}}function l2(t,e,r,n){var i=et,o=es.transition;es.transition=null;try{et=4,_f(t,e,r,n)}finally{et=i,es.transition=o}}function _f(t,e,r,n){if(fc){var i=sh(t,e,r,n);if(i===null)Jd(t,e,n,pc,r),Cm(t,n);else if(o2(i,t,e,r,n))n.stopPropagation();else if(Cm(t,n),e&4&&-1<i2.indexOf(t)){for(;i!==null;){var o=Ba(i);if(o!==null&&qy(o),o=sh(t,e,r,n),o===null&&Jd(t,e,n,pc,r),o===i)break;i=o}i!==null&&n.stopPropagation()}else Jd(t,e,n,null,r)}}var pc=null;function sh(t,e,r,n){if(pc=null,t=yf(n),t=Ni(t),t!==null)if(e=Gi(t),e===null)t=null;else if(r=e.tag,r===13){if(t=zy(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return pc=t,null}function Jy(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Y_()){case xf:return 1;case Hy:return 4;case uc:case X_:return 16;case Wy:return 536870912;default:return 16}default:return 16}}var Vn=null,Sf=null,Jl=null;function Qy(){if(Jl)return Jl;var t,e=Sf,r=e.length,n,i="value"in Vn?Vn.value:Vn.textContent,o=i.length;for(t=0;t<r&&e[t]===i[t];t++);var s=r-t;for(n=1;n<=s&&e[r-n]===i[o-n];n++);return Jl=i.slice(t,1<n?1-n:void 0)}function Ql(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function bl(){return!0}function Tm(){return!1}function wr(t){function e(r,n,i,o,s){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(r=t[l],this[l]=r?r(o):o[l]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?bl:Tm,this.isPropagationStopped=Tm,this}return yt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=bl)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=bl)},persist:function(){},isPersistent:bl}),e}var fs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},kf=wr(fs),Fa=yt({},fs,{view:0,detail:0}),c2=wr(Fa),Hd,Wd,Ds,Qc=yt({},Fa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:jf,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ds&&(Ds&&t.type==="mousemove"?(Hd=t.screenX-Ds.screenX,Wd=t.screenY-Ds.screenY):Wd=Hd=0,Ds=t),Hd)},movementY:function(t){return"movementY"in t?t.movementY:Wd}}),Rm=wr(Qc),d2=yt({},Qc,{dataTransfer:0}),u2=wr(d2),h2=yt({},Fa,{relatedTarget:0}),Gd=wr(h2),f2=yt({},fs,{animationName:0,elapsedTime:0,pseudoElement:0}),p2=wr(f2),m2=yt({},fs,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),g2=wr(m2),v2=yt({},fs,{data:0}),Nm=wr(v2),y2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},x2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},b2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function w2(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=b2[t])?!!e[t]:!1}function jf(){return w2}var _2=yt({},Fa,{key:function(t){if(t.key){var e=y2[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Ql(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?x2[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:jf,charCode:function(t){return t.type==="keypress"?Ql(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ql(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),S2=wr(_2),k2=yt({},Qc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Pm=wr(k2),j2=yt({},Fa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:jf}),C2=wr(j2),E2=yt({},fs,{propertyName:0,elapsedTime:0,pseudoElement:0}),T2=wr(E2),R2=yt({},Qc,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),N2=wr(R2),P2=[9,13,27,32],Cf=xn&&"CompositionEvent"in window,ia=null;xn&&"documentMode"in document&&(ia=document.documentMode);var O2=xn&&"TextEvent"in window&&!ia,ex=xn&&(!Cf||ia&&8<ia&&11>=ia),Om=" ",Am=!1;function tx(t,e){switch(t){case"keyup":return P2.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function rx(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Fo=!1;function A2(t,e){switch(t){case"compositionend":return rx(e);case"keypress":return e.which!==32?null:(Am=!0,Om);case"textInput":return t=e.data,t===Om&&Am?null:t;default:return null}}function M2(t,e){if(Fo)return t==="compositionend"||!Cf&&tx(t,e)?(t=Qy(),Jl=Sf=Vn=null,Fo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return ex&&e.locale!=="ko"?null:e.data;default:return null}}var $2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Mm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!$2[t.type]:e==="textarea"}function nx(t,e,r,n){My(n),e=mc(e,"onChange"),0<e.length&&(r=new kf("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var oa=null,wa=null;function I2(t){px(t,0)}function ed(t){var e=Ho(t);if(Ey(e))return t}function L2(t,e){if(t==="change")return e}var ix=!1;if(xn){var Vd;if(xn){var qd="oninput"in document;if(!qd){var $m=document.createElement("div");$m.setAttribute("oninput","return;"),qd=typeof $m.oninput=="function"}Vd=qd}else Vd=!1;ix=Vd&&(!document.documentMode||9<document.documentMode)}function Im(){oa&&(oa.detachEvent("onpropertychange",ox),wa=oa=null)}function ox(t){if(t.propertyName==="value"&&ed(wa)){var e=[];nx(e,wa,t,yf(t)),Dy(I2,e)}}function D2(t,e,r){t==="focusin"?(Im(),oa=e,wa=r,oa.attachEvent("onpropertychange",ox)):t==="focusout"&&Im()}function z2(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return ed(wa)}function F2(t,e){if(t==="click")return ed(e)}function B2(t,e){if(t==="input"||t==="change")return ed(e)}function U2(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Gr=typeof Object.is=="function"?Object.is:U2;function _a(t,e){if(Gr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!Uu.call(e,i)||!Gr(t[i],e[i]))return!1}return!0}function Lm(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Dm(t,e){var r=Lm(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Lm(r)}}function sx(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?sx(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function ax(){for(var t=window,e=lc();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=lc(t.document)}return e}function Ef(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function H2(t){var e=ax(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&sx(r.ownerDocument.documentElement,r)){if(n!==null&&Ef(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,o=Math.min(n.start,i);n=n.end===void 0?o:Math.min(n.end,i),!t.extend&&o>n&&(i=n,n=o,o=i),i=Dm(r,o);var s=Dm(r,n);i&&s&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==s.node||t.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),o>n?(t.addRange(e),t.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var W2=xn&&"documentMode"in document&&11>=document.documentMode,Bo=null,ah=null,sa=null,lh=!1;function zm(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;lh||Bo==null||Bo!==lc(n)||(n=Bo,"selectionStart"in n&&Ef(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),sa&&_a(sa,n)||(sa=n,n=mc(ah,"onSelect"),0<n.length&&(e=new kf("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Bo)))}function wl(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Uo={animationend:wl("Animation","AnimationEnd"),animationiteration:wl("Animation","AnimationIteration"),animationstart:wl("Animation","AnimationStart"),transitionend:wl("Transition","TransitionEnd")},Kd={},lx={};xn&&(lx=document.createElement("div").style,"AnimationEvent"in window||(delete Uo.animationend.animation,delete Uo.animationiteration.animation,delete Uo.animationstart.animation),"TransitionEvent"in window||delete Uo.transitionend.transition);function td(t){if(Kd[t])return Kd[t];if(!Uo[t])return t;var e=Uo[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in lx)return Kd[t]=e[r];return t}var cx=td("animationend"),dx=td("animationiteration"),ux=td("animationstart"),hx=td("transitionend"),fx=new Map,Fm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function si(t,e){fx.set(t,e),Wi(e,[t])}for(var Yd=0;Yd<Fm.length;Yd++){var Xd=Fm[Yd],G2=Xd.toLowerCase(),V2=Xd[0].toUpperCase()+Xd.slice(1);si(G2,"on"+V2)}si(cx,"onAnimationEnd");si(dx,"onAnimationIteration");si(ux,"onAnimationStart");si("dblclick","onDoubleClick");si("focusin","onFocus");si("focusout","onBlur");si(hx,"onTransitionEnd");is("onMouseEnter",["mouseout","mouseover"]);is("onMouseLeave",["mouseout","mouseover"]);is("onPointerEnter",["pointerout","pointerover"]);is("onPointerLeave",["pointerout","pointerover"]);Wi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Wi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Wi("onBeforeInput",["compositionend","keypress","textInput","paste"]);Wi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Wi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Wi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Zs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),q2=new Set("cancel close invalid load scroll toggle".split(" ").concat(Zs));function Bm(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,G_(n,e,void 0,t),t.currentTarget=null}function px(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var o=void 0;if(e)for(var s=n.length-1;0<=s;s--){var l=n[s],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==o&&i.isPropagationStopped())break e;Bm(i,l,d),o=c}else for(s=0;s<n.length;s++){if(l=n[s],c=l.instance,d=l.currentTarget,l=l.listener,c!==o&&i.isPropagationStopped())break e;Bm(i,l,d),o=c}}}if(dc)throw t=nh,dc=!1,nh=null,t}function ot(t,e){var r=e[fh];r===void 0&&(r=e[fh]=new Set);var n=t+"__bubble";r.has(n)||(mx(e,t,2,!1),r.add(n))}function Zd(t,e,r){var n=0;e&&(n|=4),mx(r,t,n,e)}var _l="_reactListening"+Math.random().toString(36).slice(2);function Sa(t){if(!t[_l]){t[_l]=!0,_y.forEach(function(r){r!=="selectionchange"&&(q2.has(r)||Zd(r,!1,t),Zd(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[_l]||(e[_l]=!0,Zd("selectionchange",!1,e))}}function mx(t,e,r,n){switch(Jy(e)){case 1:var i=a2;break;case 4:i=l2;break;default:i=_f}r=i.bind(null,e,r,t),i=void 0,!rh||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function Jd(t,e,r,n,i){var o=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var s=n.tag;if(s===3||s===4){var l=n.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(s===4)for(s=n.return;s!==null;){var c=s.tag;if((c===3||c===4)&&(c=s.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;s=s.return}for(;l!==null;){if(s=Ni(l),s===null)return;if(c=s.tag,c===5||c===6){n=o=s;continue e}l=l.parentNode}}n=n.return}Dy(function(){var d=o,h=yf(r),f=[];e:{var u=fx.get(t);if(u!==void 0){var p=kf,g=t;switch(t){case"keypress":if(Ql(r)===0)break e;case"keydown":case"keyup":p=S2;break;case"focusin":g="focus",p=Gd;break;case"focusout":g="blur",p=Gd;break;case"beforeblur":case"afterblur":p=Gd;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=Rm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=u2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=C2;break;case cx:case dx:case ux:p=p2;break;case hx:p=T2;break;case"scroll":p=c2;break;case"wheel":p=N2;break;case"copy":case"cut":case"paste":p=g2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Pm}var m=(e&4)!==0,x=!m&&t==="scroll",v=m?u!==null?u+"Capture":null:u;m=[];for(var y=d,b;y!==null;){b=y;var w=b.stateNode;if(b.tag===5&&w!==null&&(b=w,v!==null&&(w=va(y,v),w!=null&&m.push(ka(y,w,b)))),x)break;y=y.return}0<m.length&&(u=new p(u,g,null,r,h),f.push({event:u,listeners:m}))}}if(!(e&7)){e:{if(u=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",u&&r!==eh&&(g=r.relatedTarget||r.fromElement)&&(Ni(g)||g[bn]))break e;if((p||u)&&(u=h.window===h?h:(u=h.ownerDocument)?u.defaultView||u.parentWindow:window,p?(g=r.relatedTarget||r.toElement,p=d,g=g?Ni(g):null,g!==null&&(x=Gi(g),g!==x||g.tag!==5&&g.tag!==6)&&(g=null)):(p=null,g=d),p!==g)){if(m=Rm,w="onMouseLeave",v="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(m=Pm,w="onPointerLeave",v="onPointerEnter",y="pointer"),x=p==null?u:Ho(p),b=g==null?u:Ho(g),u=new m(w,y+"leave",p,r,h),u.target=x,u.relatedTarget=b,w=null,Ni(h)===d&&(m=new m(v,y+"enter",g,r,h),m.target=b,m.relatedTarget=x,w=m),x=w,p&&g)t:{for(m=p,v=g,y=0,b=m;b;b=uo(b))y++;for(b=0,w=v;w;w=uo(w))b++;for(;0<y-b;)m=uo(m),y--;for(;0<b-y;)v=uo(v),b--;for(;y--;){if(m===v||v!==null&&m===v.alternate)break t;m=uo(m),v=uo(v)}m=null}else m=null;p!==null&&Um(f,u,p,m,!1),g!==null&&x!==null&&Um(f,x,g,m,!0)}}e:{if(u=d?Ho(d):window,p=u.nodeName&&u.nodeName.toLowerCase(),p==="select"||p==="input"&&u.type==="file")var k=L2;else if(Mm(u))if(ix)k=B2;else{k=z2;var S=D2}else(p=u.nodeName)&&p.toLowerCase()==="input"&&(u.type==="checkbox"||u.type==="radio")&&(k=F2);if(k&&(k=k(t,d))){nx(f,k,r,h);break e}S&&S(t,u,d),t==="focusout"&&(S=u._wrapperState)&&S.controlled&&u.type==="number"&&Yu(u,"number",u.value)}switch(S=d?Ho(d):window,t){case"focusin":(Mm(S)||S.contentEditable==="true")&&(Bo=S,ah=d,sa=null);break;case"focusout":sa=ah=Bo=null;break;case"mousedown":lh=!0;break;case"contextmenu":case"mouseup":case"dragend":lh=!1,zm(f,r,h);break;case"selectionchange":if(W2)break;case"keydown":case"keyup":zm(f,r,h)}var C;if(Cf)e:{switch(t){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else Fo?tx(t,r)&&(T="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(T="onCompositionStart");T&&(ex&&r.locale!=="ko"&&(Fo||T!=="onCompositionStart"?T==="onCompositionEnd"&&Fo&&(C=Qy()):(Vn=h,Sf="value"in Vn?Vn.value:Vn.textContent,Fo=!0)),S=mc(d,T),0<S.length&&(T=new Nm(T,t,null,r,h),f.push({event:T,listeners:S}),C?T.data=C:(C=rx(r),C!==null&&(T.data=C)))),(C=O2?A2(t,r):M2(t,r))&&(d=mc(d,"onBeforeInput"),0<d.length&&(h=new Nm("onBeforeInput","beforeinput",null,r,h),f.push({event:h,listeners:d}),h.data=C))}px(f,e)})}function ka(t,e,r){return{instance:t,listener:e,currentTarget:r}}function mc(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=va(t,r),o!=null&&n.unshift(ka(t,o,i)),o=va(t,e),o!=null&&n.push(ka(t,o,i))),t=t.return}return n}function uo(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Um(t,e,r,n,i){for(var o=e._reactName,s=[];r!==null&&r!==n;){var l=r,c=l.alternate,d=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&d!==null&&(l=d,i?(c=va(r,o),c!=null&&s.unshift(ka(r,c,l))):i||(c=va(r,o),c!=null&&s.push(ka(r,c,l)))),r=r.return}s.length!==0&&t.push({event:e,listeners:s})}var K2=/\r\n?/g,Y2=/\u0000|\uFFFD/g;function Hm(t){return(typeof t=="string"?t:""+t).replace(K2,`
`).replace(Y2,"")}function Sl(t,e,r){if(e=Hm(e),Hm(t)!==e&&r)throw Error(me(425))}function gc(){}var ch=null,dh=null;function uh(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var hh=typeof setTimeout=="function"?setTimeout:void 0,X2=typeof clearTimeout=="function"?clearTimeout:void 0,Wm=typeof Promise=="function"?Promise:void 0,Z2=typeof queueMicrotask=="function"?queueMicrotask:typeof Wm<"u"?function(t){return Wm.resolve(null).then(t).catch(J2)}:hh;function J2(t){setTimeout(function(){throw t})}function Qd(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),ba(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);ba(e)}function Zn(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Gm(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var ps=Math.random().toString(36).slice(2),Jr="__reactFiber$"+ps,ja="__reactProps$"+ps,bn="__reactContainer$"+ps,fh="__reactEvents$"+ps,Q2="__reactListeners$"+ps,eS="__reactHandles$"+ps;function Ni(t){var e=t[Jr];if(e)return e;for(var r=t.parentNode;r;){if(e=r[bn]||r[Jr]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=Gm(t);t!==null;){if(r=t[Jr])return r;t=Gm(t)}return e}t=r,r=t.parentNode}return null}function Ba(t){return t=t[Jr]||t[bn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ho(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(me(33))}function rd(t){return t[ja]||null}var ph=[],Wo=-1;function ai(t){return{current:t}}function lt(t){0>Wo||(t.current=ph[Wo],ph[Wo]=null,Wo--)}function it(t,e){Wo++,ph[Wo]=t.current,t.current=e}var ni={},Vt=ai(ni),ir=ai(!1),Di=ni;function os(t,e){var r=t.type.contextTypes;if(!r)return ni;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in r)i[o]=e[o];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function or(t){return t=t.childContextTypes,t!=null}function vc(){lt(ir),lt(Vt)}function Vm(t,e,r){if(Vt.current!==ni)throw Error(me(168));it(Vt,e),it(ir,r)}function gx(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(me(108,D_(t)||"Unknown",i));return yt({},r,n)}function yc(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ni,Di=Vt.current,it(Vt,t),it(ir,ir.current),!0}function qm(t,e,r){var n=t.stateNode;if(!n)throw Error(me(169));r?(t=gx(t,e,Di),n.__reactInternalMemoizedMergedChildContext=t,lt(ir),lt(Vt),it(Vt,t)):lt(ir),it(ir,r)}var pn=null,nd=!1,eu=!1;function vx(t){pn===null?pn=[t]:pn.push(t)}function tS(t){nd=!0,vx(t)}function li(){if(!eu&&pn!==null){eu=!0;var t=0,e=et;try{var r=pn;for(et=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}pn=null,nd=!1}catch(i){throw pn!==null&&(pn=pn.slice(t+1)),Uy(xf,li),i}finally{et=e,eu=!1}}return null}var Go=[],Vo=0,xc=null,bc=0,kr=[],jr=0,zi=null,mn=1,gn="";function ki(t,e){Go[Vo++]=bc,Go[Vo++]=xc,xc=t,bc=e}function yx(t,e,r){kr[jr++]=mn,kr[jr++]=gn,kr[jr++]=zi,zi=t;var n=mn;t=gn;var i=32-Hr(n)-1;n&=~(1<<i),r+=1;var o=32-Hr(e)+i;if(30<o){var s=i-i%5;o=(n&(1<<s)-1).toString(32),n>>=s,i-=s,mn=1<<32-Hr(e)+i|r<<i|n,gn=o+t}else mn=1<<o|r<<i|n,gn=t}function Tf(t){t.return!==null&&(ki(t,1),yx(t,1,0))}function Rf(t){for(;t===xc;)xc=Go[--Vo],Go[Vo]=null,bc=Go[--Vo],Go[Vo]=null;for(;t===zi;)zi=kr[--jr],kr[jr]=null,gn=kr[--jr],kr[jr]=null,mn=kr[--jr],kr[jr]=null}var vr=null,pr=null,ht=!1,Br=null;function xx(t,e){var r=Er(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function Km(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,vr=t,pr=Zn(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,vr=t,pr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=zi!==null?{id:mn,overflow:gn}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Er(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,vr=t,pr=null,!0):!1;default:return!1}}function mh(t){return(t.mode&1)!==0&&(t.flags&128)===0}function gh(t){if(ht){var e=pr;if(e){var r=e;if(!Km(t,e)){if(mh(t))throw Error(me(418));e=Zn(r.nextSibling);var n=vr;e&&Km(t,e)?xx(n,r):(t.flags=t.flags&-4097|2,ht=!1,vr=t)}}else{if(mh(t))throw Error(me(418));t.flags=t.flags&-4097|2,ht=!1,vr=t}}}function Ym(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;vr=t}function kl(t){if(t!==vr)return!1;if(!ht)return Ym(t),ht=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!uh(t.type,t.memoizedProps)),e&&(e=pr)){if(mh(t))throw bx(),Error(me(418));for(;e;)xx(t,e),e=Zn(e.nextSibling)}if(Ym(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(me(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){pr=Zn(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}pr=null}}else pr=vr?Zn(t.stateNode.nextSibling):null;return!0}function bx(){for(var t=pr;t;)t=Zn(t.nextSibling)}function ss(){pr=vr=null,ht=!1}function Nf(t){Br===null?Br=[t]:Br.push(t)}var rS=Sn.ReactCurrentBatchConfig;function zs(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(me(309));var n=r.stateNode}if(!n)throw Error(me(147,t));var i=n,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(s){var l=i.refs;s===null?delete l[o]:l[o]=s},e._stringRef=o,e)}if(typeof t!="string")throw Error(me(284));if(!r._owner)throw Error(me(290,t))}return t}function jl(t,e){throw t=Object.prototype.toString.call(e),Error(me(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Xm(t){var e=t._init;return e(t._payload)}function wx(t){function e(v,y){if(t){var b=v.deletions;b===null?(v.deletions=[y],v.flags|=16):b.push(y)}}function r(v,y){if(!t)return null;for(;y!==null;)e(v,y),y=y.sibling;return null}function n(v,y){for(v=new Map;y!==null;)y.key!==null?v.set(y.key,y):v.set(y.index,y),y=y.sibling;return v}function i(v,y){return v=ti(v,y),v.index=0,v.sibling=null,v}function o(v,y,b){return v.index=b,t?(b=v.alternate,b!==null?(b=b.index,b<y?(v.flags|=2,y):b):(v.flags|=2,y)):(v.flags|=1048576,y)}function s(v){return t&&v.alternate===null&&(v.flags|=2),v}function l(v,y,b,w){return y===null||y.tag!==6?(y=au(b,v.mode,w),y.return=v,y):(y=i(y,b),y.return=v,y)}function c(v,y,b,w){var k=b.type;return k===zo?h(v,y,b.props.children,w,b.key):y!==null&&(y.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Dn&&Xm(k)===y.type)?(w=i(y,b.props),w.ref=zs(v,y,b),w.return=v,w):(w=sc(b.type,b.key,b.props,null,v.mode,w),w.ref=zs(v,y,b),w.return=v,w)}function d(v,y,b,w){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=lu(b,v.mode,w),y.return=v,y):(y=i(y,b.children||[]),y.return=v,y)}function h(v,y,b,w,k){return y===null||y.tag!==7?(y=Ii(b,v.mode,w,k),y.return=v,y):(y=i(y,b),y.return=v,y)}function f(v,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=au(""+y,v.mode,b),y.return=v,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case pl:return b=sc(y.type,y.key,y.props,null,v.mode,b),b.ref=zs(v,null,y),b.return=v,b;case Do:return y=lu(y,v.mode,b),y.return=v,y;case Dn:var w=y._init;return f(v,w(y._payload),b)}if(Ys(y)||Ms(y))return y=Ii(y,v.mode,b,null),y.return=v,y;jl(v,y)}return null}function u(v,y,b,w){var k=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return k!==null?null:l(v,y,""+b,w);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case pl:return b.key===k?c(v,y,b,w):null;case Do:return b.key===k?d(v,y,b,w):null;case Dn:return k=b._init,u(v,y,k(b._payload),w)}if(Ys(b)||Ms(b))return k!==null?null:h(v,y,b,w,null);jl(v,b)}return null}function p(v,y,b,w,k){if(typeof w=="string"&&w!==""||typeof w=="number")return v=v.get(b)||null,l(y,v,""+w,k);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case pl:return v=v.get(w.key===null?b:w.key)||null,c(y,v,w,k);case Do:return v=v.get(w.key===null?b:w.key)||null,d(y,v,w,k);case Dn:var S=w._init;return p(v,y,b,S(w._payload),k)}if(Ys(w)||Ms(w))return v=v.get(b)||null,h(y,v,w,k,null);jl(y,w)}return null}function g(v,y,b,w){for(var k=null,S=null,C=y,T=y=0,R=null;C!==null&&T<b.length;T++){C.index>T?(R=C,C=null):R=C.sibling;var O=u(v,C,b[T],w);if(O===null){C===null&&(C=R);break}t&&C&&O.alternate===null&&e(v,C),y=o(O,y,T),S===null?k=O:S.sibling=O,S=O,C=R}if(T===b.length)return r(v,C),ht&&ki(v,T),k;if(C===null){for(;T<b.length;T++)C=f(v,b[T],w),C!==null&&(y=o(C,y,T),S===null?k=C:S.sibling=C,S=C);return ht&&ki(v,T),k}for(C=n(v,C);T<b.length;T++)R=p(C,v,T,b[T],w),R!==null&&(t&&R.alternate!==null&&C.delete(R.key===null?T:R.key),y=o(R,y,T),S===null?k=R:S.sibling=R,S=R);return t&&C.forEach(function(Y){return e(v,Y)}),ht&&ki(v,T),k}function m(v,y,b,w){var k=Ms(b);if(typeof k!="function")throw Error(me(150));if(b=k.call(b),b==null)throw Error(me(151));for(var S=k=null,C=y,T=y=0,R=null,O=b.next();C!==null&&!O.done;T++,O=b.next()){C.index>T?(R=C,C=null):R=C.sibling;var Y=u(v,C,O.value,w);if(Y===null){C===null&&(C=R);break}t&&C&&Y.alternate===null&&e(v,C),y=o(Y,y,T),S===null?k=Y:S.sibling=Y,S=Y,C=R}if(O.done)return r(v,C),ht&&ki(v,T),k;if(C===null){for(;!O.done;T++,O=b.next())O=f(v,O.value,w),O!==null&&(y=o(O,y,T),S===null?k=O:S.sibling=O,S=O);return ht&&ki(v,T),k}for(C=n(v,C);!O.done;T++,O=b.next())O=p(C,v,T,O.value,w),O!==null&&(t&&O.alternate!==null&&C.delete(O.key===null?T:O.key),y=o(O,y,T),S===null?k=O:S.sibling=O,S=O);return t&&C.forEach(function(E){return e(v,E)}),ht&&ki(v,T),k}function x(v,y,b,w){if(typeof b=="object"&&b!==null&&b.type===zo&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case pl:e:{for(var k=b.key,S=y;S!==null;){if(S.key===k){if(k=b.type,k===zo){if(S.tag===7){r(v,S.sibling),y=i(S,b.props.children),y.return=v,v=y;break e}}else if(S.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Dn&&Xm(k)===S.type){r(v,S.sibling),y=i(S,b.props),y.ref=zs(v,S,b),y.return=v,v=y;break e}r(v,S);break}else e(v,S);S=S.sibling}b.type===zo?(y=Ii(b.props.children,v.mode,w,b.key),y.return=v,v=y):(w=sc(b.type,b.key,b.props,null,v.mode,w),w.ref=zs(v,y,b),w.return=v,v=w)}return s(v);case Do:e:{for(S=b.key;y!==null;){if(y.key===S)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){r(v,y.sibling),y=i(y,b.children||[]),y.return=v,v=y;break e}else{r(v,y);break}else e(v,y);y=y.sibling}y=lu(b,v.mode,w),y.return=v,v=y}return s(v);case Dn:return S=b._init,x(v,y,S(b._payload),w)}if(Ys(b))return g(v,y,b,w);if(Ms(b))return m(v,y,b,w);jl(v,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(r(v,y.sibling),y=i(y,b),y.return=v,v=y):(r(v,y),y=au(b,v.mode,w),y.return=v,v=y),s(v)):r(v,y)}return x}var as=wx(!0),_x=wx(!1),wc=ai(null),_c=null,qo=null,Pf=null;function Of(){Pf=qo=_c=null}function Af(t){var e=wc.current;lt(wc),t._currentValue=e}function vh(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function ts(t,e){_c=t,Pf=qo=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(nr=!0),t.firstContext=null)}function Rr(t){var e=t._currentValue;if(Pf!==t)if(t={context:t,memoizedValue:e,next:null},qo===null){if(_c===null)throw Error(me(308));qo=t,_c.dependencies={lanes:0,firstContext:t}}else qo=qo.next=t;return e}var Pi=null;function Mf(t){Pi===null?Pi=[t]:Pi.push(t)}function Sx(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,Mf(e)):(r.next=i.next,i.next=r),e.interleaved=r,wn(t,n)}function wn(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var zn=!1;function $f(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function kx(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function vn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Jn(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,Ze&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,wn(t,r)}return i=n.interleaved,i===null?(e.next=e,Mf(n)):(e.next=i.next,i.next=e),n.interleaved=e,wn(t,r)}function ec(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,bf(t,r)}}function Zm(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,o=null;if(r=r.firstBaseUpdate,r!==null){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};o===null?i=o=s:o=o.next=s,r=r.next}while(r!==null);o===null?i=o=e:o=o.next=e}else i=o=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Sc(t,e,r,n){var i=t.updateQueue;zn=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var c=l,d=c.next;c.next=null,s===null?o=d:s.next=d,s=c;var h=t.alternate;h!==null&&(h=h.updateQueue,l=h.lastBaseUpdate,l!==s&&(l===null?h.firstBaseUpdate=d:l.next=d,h.lastBaseUpdate=c))}if(o!==null){var f=i.baseState;s=0,h=d=c=null,l=o;do{var u=l.lane,p=l.eventTime;if((n&u)===u){h!==null&&(h=h.next={eventTime:p,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var g=t,m=l;switch(u=e,p=r,m.tag){case 1:if(g=m.payload,typeof g=="function"){f=g.call(p,f,u);break e}f=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=m.payload,u=typeof g=="function"?g.call(p,f,u):g,u==null)break e;f=yt({},f,u);break e;case 2:zn=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,u=i.effects,u===null?i.effects=[l]:u.push(l))}else p={eventTime:p,lane:u,tag:l.tag,payload:l.payload,callback:l.callback,next:null},h===null?(d=h=p,c=f):h=h.next=p,s|=u;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;u=l,l=u.next,u.next=null,i.lastBaseUpdate=u,i.shared.pending=null}}while(!0);if(h===null&&(c=f),i.baseState=c,i.firstBaseUpdate=d,i.lastBaseUpdate=h,e=i.shared.interleaved,e!==null){i=e;do s|=i.lane,i=i.next;while(i!==e)}else o===null&&(i.shared.lanes=0);Bi|=s,t.lanes=s,t.memoizedState=f}}function Jm(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(me(191,i));i.call(n)}}}var Ua={},rn=ai(Ua),Ca=ai(Ua),Ea=ai(Ua);function Oi(t){if(t===Ua)throw Error(me(174));return t}function If(t,e){switch(it(Ea,e),it(Ca,t),it(rn,Ua),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Zu(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Zu(e,t)}lt(rn),it(rn,e)}function ls(){lt(rn),lt(Ca),lt(Ea)}function jx(t){Oi(Ea.current);var e=Oi(rn.current),r=Zu(e,t.type);e!==r&&(it(Ca,t),it(rn,r))}function Lf(t){Ca.current===t&&(lt(rn),lt(Ca))}var gt=ai(0);function kc(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var tu=[];function Df(){for(var t=0;t<tu.length;t++)tu[t]._workInProgressVersionPrimary=null;tu.length=0}var tc=Sn.ReactCurrentDispatcher,ru=Sn.ReactCurrentBatchConfig,Fi=0,vt=null,Nt=null,At=null,jc=!1,aa=!1,Ta=0,nS=0;function Bt(){throw Error(me(321))}function zf(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Gr(t[r],e[r]))return!1;return!0}function Ff(t,e,r,n,i,o){if(Fi=o,vt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,tc.current=t===null||t.memoizedState===null?aS:lS,t=r(n,i),aa){o=0;do{if(aa=!1,Ta=0,25<=o)throw Error(me(301));o+=1,At=Nt=null,e.updateQueue=null,tc.current=cS,t=r(n,i)}while(aa)}if(tc.current=Cc,e=Nt!==null&&Nt.next!==null,Fi=0,At=Nt=vt=null,jc=!1,e)throw Error(me(300));return t}function Bf(){var t=Ta!==0;return Ta=0,t}function Zr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return At===null?vt.memoizedState=At=t:At=At.next=t,At}function Nr(){if(Nt===null){var t=vt.alternate;t=t!==null?t.memoizedState:null}else t=Nt.next;var e=At===null?vt.memoizedState:At.next;if(e!==null)At=e,Nt=t;else{if(t===null)throw Error(me(310));Nt=t,t={memoizedState:Nt.memoizedState,baseState:Nt.baseState,baseQueue:Nt.baseQueue,queue:Nt.queue,next:null},At===null?vt.memoizedState=At=t:At=At.next=t}return At}function Ra(t,e){return typeof e=="function"?e(t):e}function nu(t){var e=Nr(),r=e.queue;if(r===null)throw Error(me(311));r.lastRenderedReducer=t;var n=Nt,i=n.baseQueue,o=r.pending;if(o!==null){if(i!==null){var s=i.next;i.next=o.next,o.next=s}n.baseQueue=i=o,r.pending=null}if(i!==null){o=i.next,n=n.baseState;var l=s=null,c=null,d=o;do{var h=d.lane;if((Fi&h)===h)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:t(n,d.action);else{var f={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=f,s=n):c=c.next=f,vt.lanes|=h,Bi|=h}d=d.next}while(d!==null&&d!==o);c===null?s=n:c.next=l,Gr(n,e.memoizedState)||(nr=!0),e.memoizedState=n,e.baseState=s,e.baseQueue=c,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do o=i.lane,vt.lanes|=o,Bi|=o,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function iu(t){var e=Nr(),r=e.queue;if(r===null)throw Error(me(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,o=e.memoizedState;if(i!==null){r.pending=null;var s=i=i.next;do o=t(o,s.action),s=s.next;while(s!==i);Gr(o,e.memoizedState)||(nr=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),r.lastRenderedState=o}return[o,n]}function Cx(){}function Ex(t,e){var r=vt,n=Nr(),i=e(),o=!Gr(n.memoizedState,i);if(o&&(n.memoizedState=i,nr=!0),n=n.queue,Uf(Nx.bind(null,r,n,t),[t]),n.getSnapshot!==e||o||At!==null&&At.memoizedState.tag&1){if(r.flags|=2048,Na(9,Rx.bind(null,r,n,i,e),void 0,null),Mt===null)throw Error(me(349));Fi&30||Tx(r,e,i)}return i}function Tx(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=vt.updateQueue,e===null?(e={lastEffect:null,stores:null},vt.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function Rx(t,e,r,n){e.value=r,e.getSnapshot=n,Px(e)&&Ox(t)}function Nx(t,e,r){return r(function(){Px(e)&&Ox(t)})}function Px(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Gr(t,r)}catch{return!0}}function Ox(t){var e=wn(t,1);e!==null&&Wr(e,t,1,-1)}function Qm(t){var e=Zr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ra,lastRenderedState:t},e.queue=t,t=t.dispatch=sS.bind(null,vt,t),[e.memoizedState,t]}function Na(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=vt.updateQueue,e===null?(e={lastEffect:null,stores:null},vt.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function Ax(){return Nr().memoizedState}function rc(t,e,r,n){var i=Zr();vt.flags|=t,i.memoizedState=Na(1|e,r,void 0,n===void 0?null:n)}function id(t,e,r,n){var i=Nr();n=n===void 0?null:n;var o=void 0;if(Nt!==null){var s=Nt.memoizedState;if(o=s.destroy,n!==null&&zf(n,s.deps)){i.memoizedState=Na(e,r,o,n);return}}vt.flags|=t,i.memoizedState=Na(1|e,r,o,n)}function eg(t,e){return rc(8390656,8,t,e)}function Uf(t,e){return id(2048,8,t,e)}function Mx(t,e){return id(4,2,t,e)}function $x(t,e){return id(4,4,t,e)}function Ix(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Lx(t,e,r){return r=r!=null?r.concat([t]):null,id(4,4,Ix.bind(null,e,t),r)}function Hf(){}function Dx(t,e){var r=Nr();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&zf(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function zx(t,e){var r=Nr();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&zf(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function Fx(t,e,r){return Fi&21?(Gr(r,e)||(r=Gy(),vt.lanes|=r,Bi|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,nr=!0),t.memoizedState=r)}function iS(t,e){var r=et;et=r!==0&&4>r?r:4,t(!0);var n=ru.transition;ru.transition={};try{t(!1),e()}finally{et=r,ru.transition=n}}function Bx(){return Nr().memoizedState}function oS(t,e,r){var n=ei(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Ux(t))Hx(e,r);else if(r=Sx(t,e,r,n),r!==null){var i=Xt();Wr(r,t,n,i),Wx(r,e,n)}}function sS(t,e,r){var n=ei(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Ux(t))Hx(e,i);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var s=e.lastRenderedState,l=o(s,r);if(i.hasEagerState=!0,i.eagerState=l,Gr(l,s)){var c=e.interleaved;c===null?(i.next=i,Mf(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}r=Sx(t,e,i,n),r!==null&&(i=Xt(),Wr(r,t,n,i),Wx(r,e,n))}}function Ux(t){var e=t.alternate;return t===vt||e!==null&&e===vt}function Hx(t,e){aa=jc=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function Wx(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,bf(t,r)}}var Cc={readContext:Rr,useCallback:Bt,useContext:Bt,useEffect:Bt,useImperativeHandle:Bt,useInsertionEffect:Bt,useLayoutEffect:Bt,useMemo:Bt,useReducer:Bt,useRef:Bt,useState:Bt,useDebugValue:Bt,useDeferredValue:Bt,useTransition:Bt,useMutableSource:Bt,useSyncExternalStore:Bt,useId:Bt,unstable_isNewReconciler:!1},aS={readContext:Rr,useCallback:function(t,e){return Zr().memoizedState=[t,e===void 0?null:e],t},useContext:Rr,useEffect:eg,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,rc(4194308,4,Ix.bind(null,e,t),r)},useLayoutEffect:function(t,e){return rc(4194308,4,t,e)},useInsertionEffect:function(t,e){return rc(4,2,t,e)},useMemo:function(t,e){var r=Zr();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=Zr();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=oS.bind(null,vt,t),[n.memoizedState,t]},useRef:function(t){var e=Zr();return t={current:t},e.memoizedState=t},useState:Qm,useDebugValue:Hf,useDeferredValue:function(t){return Zr().memoizedState=t},useTransition:function(){var t=Qm(!1),e=t[0];return t=iS.bind(null,t[1]),Zr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=vt,i=Zr();if(ht){if(r===void 0)throw Error(me(407));r=r()}else{if(r=e(),Mt===null)throw Error(me(349));Fi&30||Tx(n,e,r)}i.memoizedState=r;var o={value:r,getSnapshot:e};return i.queue=o,eg(Nx.bind(null,n,o,t),[t]),n.flags|=2048,Na(9,Rx.bind(null,n,o,r,e),void 0,null),r},useId:function(){var t=Zr(),e=Mt.identifierPrefix;if(ht){var r=gn,n=mn;r=(n&~(1<<32-Hr(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Ta++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=nS++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},lS={readContext:Rr,useCallback:Dx,useContext:Rr,useEffect:Uf,useImperativeHandle:Lx,useInsertionEffect:Mx,useLayoutEffect:$x,useMemo:zx,useReducer:nu,useRef:Ax,useState:function(){return nu(Ra)},useDebugValue:Hf,useDeferredValue:function(t){var e=Nr();return Fx(e,Nt.memoizedState,t)},useTransition:function(){var t=nu(Ra)[0],e=Nr().memoizedState;return[t,e]},useMutableSource:Cx,useSyncExternalStore:Ex,useId:Bx,unstable_isNewReconciler:!1},cS={readContext:Rr,useCallback:Dx,useContext:Rr,useEffect:Uf,useImperativeHandle:Lx,useInsertionEffect:Mx,useLayoutEffect:$x,useMemo:zx,useReducer:iu,useRef:Ax,useState:function(){return iu(Ra)},useDebugValue:Hf,useDeferredValue:function(t){var e=Nr();return Nt===null?e.memoizedState=t:Fx(e,Nt.memoizedState,t)},useTransition:function(){var t=iu(Ra)[0],e=Nr().memoizedState;return[t,e]},useMutableSource:Cx,useSyncExternalStore:Ex,useId:Bx,unstable_isNewReconciler:!1};function Lr(t,e){if(t&&t.defaultProps){e=yt({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function yh(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:yt({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var od={isMounted:function(t){return(t=t._reactInternals)?Gi(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Xt(),i=ei(t),o=vn(n,i);o.payload=e,r!=null&&(o.callback=r),e=Jn(t,o,i),e!==null&&(Wr(e,t,i,n),ec(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Xt(),i=ei(t),o=vn(n,i);o.tag=1,o.payload=e,r!=null&&(o.callback=r),e=Jn(t,o,i),e!==null&&(Wr(e,t,i,n),ec(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Xt(),n=ei(t),i=vn(r,n);i.tag=2,e!=null&&(i.callback=e),e=Jn(t,i,n),e!==null&&(Wr(e,t,n,r),ec(e,t,n))}};function tg(t,e,r,n,i,o,s){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,o,s):e.prototype&&e.prototype.isPureReactComponent?!_a(r,n)||!_a(i,o):!0}function Gx(t,e,r){var n=!1,i=ni,o=e.contextType;return typeof o=="object"&&o!==null?o=Rr(o):(i=or(e)?Di:Vt.current,n=e.contextTypes,o=(n=n!=null)?os(t,i):ni),e=new e(r,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=od,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=o),e}function rg(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&od.enqueueReplaceState(e,e.state,null)}function xh(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},$f(t);var o=e.contextType;typeof o=="object"&&o!==null?i.context=Rr(o):(o=or(e)?Di:Vt.current,i.context=os(t,o)),i.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(yh(t,e,o,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&od.enqueueReplaceState(i,i.state,null),Sc(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function cs(t,e){try{var r="",n=e;do r+=L_(n),n=n.return;while(n);var i=r}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:i,digest:null}}function ou(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function bh(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var dS=typeof WeakMap=="function"?WeakMap:Map;function Vx(t,e,r){r=vn(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){Tc||(Tc=!0,Nh=n),bh(t,e)},r}function qx(t,e,r){r=vn(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){bh(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(r.callback=function(){bh(t,e),typeof n!="function"&&(Qn===null?Qn=new Set([this]):Qn.add(this));var s=e.stack;this.componentDidCatch(e.value,{componentStack:s!==null?s:""})}),r}function ng(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new dS;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=kS.bind(null,t,e,r),e.then(t,t))}function ig(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function og(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=vn(-1,1),e.tag=2,Jn(r,e,1))),r.lanes|=1),t)}var uS=Sn.ReactCurrentOwner,nr=!1;function Kt(t,e,r,n){e.child=t===null?_x(e,null,r,n):as(e,t.child,r,n)}function sg(t,e,r,n,i){r=r.render;var o=e.ref;return ts(e,i),n=Ff(t,e,r,n,o,i),r=Bf(),t!==null&&!nr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,_n(t,e,i)):(ht&&r&&Tf(e),e.flags|=1,Kt(t,e,n,i),e.child)}function ag(t,e,r,n,i){if(t===null){var o=r.type;return typeof o=="function"&&!Zf(o)&&o.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=o,Kx(t,e,o,n,i)):(t=sc(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&i)){var s=o.memoizedProps;if(r=r.compare,r=r!==null?r:_a,r(s,n)&&t.ref===e.ref)return _n(t,e,i)}return e.flags|=1,t=ti(o,n),t.ref=e.ref,t.return=e,e.child=t}function Kx(t,e,r,n,i){if(t!==null){var o=t.memoizedProps;if(_a(o,n)&&t.ref===e.ref)if(nr=!1,e.pendingProps=n=o,(t.lanes&i)!==0)t.flags&131072&&(nr=!0);else return e.lanes=t.lanes,_n(t,e,i)}return wh(t,e,r,n,i)}function Yx(t,e,r){var n=e.pendingProps,i=n.children,o=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},it(Yo,ur),ur|=r;else{if(!(r&1073741824))return t=o!==null?o.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,it(Yo,ur),ur|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=o!==null?o.baseLanes:r,it(Yo,ur),ur|=n}else o!==null?(n=o.baseLanes|r,e.memoizedState=null):n=r,it(Yo,ur),ur|=n;return Kt(t,e,i,r),e.child}function Xx(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function wh(t,e,r,n,i){var o=or(r)?Di:Vt.current;return o=os(e,o),ts(e,i),r=Ff(t,e,r,n,o,i),n=Bf(),t!==null&&!nr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,_n(t,e,i)):(ht&&n&&Tf(e),e.flags|=1,Kt(t,e,r,i),e.child)}function lg(t,e,r,n,i){if(or(r)){var o=!0;yc(e)}else o=!1;if(ts(e,i),e.stateNode===null)nc(t,e),Gx(e,r,n),xh(e,r,n,i),n=!0;else if(t===null){var s=e.stateNode,l=e.memoizedProps;s.props=l;var c=s.context,d=r.contextType;typeof d=="object"&&d!==null?d=Rr(d):(d=or(r)?Di:Vt.current,d=os(e,d));var h=r.getDerivedStateFromProps,f=typeof h=="function"||typeof s.getSnapshotBeforeUpdate=="function";f||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(l!==n||c!==d)&&rg(e,s,n,d),zn=!1;var u=e.memoizedState;s.state=u,Sc(e,n,s,i),c=e.memoizedState,l!==n||u!==c||ir.current||zn?(typeof h=="function"&&(yh(e,r,h,n),c=e.memoizedState),(l=zn||tg(e,r,l,n,u,c,d))?(f||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=c),s.props=n,s.state=c,s.context=d,n=l):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{s=e.stateNode,kx(t,e),l=e.memoizedProps,d=e.type===e.elementType?l:Lr(e.type,l),s.props=d,f=e.pendingProps,u=s.context,c=r.contextType,typeof c=="object"&&c!==null?c=Rr(c):(c=or(r)?Di:Vt.current,c=os(e,c));var p=r.getDerivedStateFromProps;(h=typeof p=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(l!==f||u!==c)&&rg(e,s,n,c),zn=!1,u=e.memoizedState,s.state=u,Sc(e,n,s,i);var g=e.memoizedState;l!==f||u!==g||ir.current||zn?(typeof p=="function"&&(yh(e,r,p,n),g=e.memoizedState),(d=zn||tg(e,r,d,n,u,g,c)||!1)?(h||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(n,g,c),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(n,g,c)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||l===t.memoizedProps&&u===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&u===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=g),s.props=n,s.state=g,s.context=c,n=d):(typeof s.componentDidUpdate!="function"||l===t.memoizedProps&&u===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&u===t.memoizedState||(e.flags|=1024),n=!1)}return _h(t,e,r,n,o,i)}function _h(t,e,r,n,i,o){Xx(t,e);var s=(e.flags&128)!==0;if(!n&&!s)return i&&qm(e,r,!1),_n(t,e,o);n=e.stateNode,uS.current=e;var l=s&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&s?(e.child=as(e,t.child,null,o),e.child=as(e,null,l,o)):Kt(t,e,l,o),e.memoizedState=n.state,i&&qm(e,r,!0),e.child}function Zx(t){var e=t.stateNode;e.pendingContext?Vm(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Vm(t,e.context,!1),If(t,e.containerInfo)}function cg(t,e,r,n,i){return ss(),Nf(i),e.flags|=256,Kt(t,e,r,n),e.child}var Sh={dehydrated:null,treeContext:null,retryLane:0};function kh(t){return{baseLanes:t,cachePool:null,transitions:null}}function Jx(t,e,r){var n=e.pendingProps,i=gt.current,o=!1,s=(e.flags&128)!==0,l;if((l=s)||(l=t!==null&&t.memoizedState===null?!1:(i&2)!==0),l?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),it(gt,i&1),t===null)return gh(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(s=n.children,t=n.fallback,o?(n=e.mode,o=e.child,s={mode:"hidden",children:s},!(n&1)&&o!==null?(o.childLanes=0,o.pendingProps=s):o=ld(s,n,0,null),t=Ii(t,n,r,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=kh(r),e.memoizedState=Sh,t):Wf(e,s));if(i=t.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return hS(t,e,s,n,l,i,r);if(o){o=n.fallback,s=e.mode,i=t.child,l=i.sibling;var c={mode:"hidden",children:n.children};return!(s&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=c,e.deletions=null):(n=ti(i,c),n.subtreeFlags=i.subtreeFlags&14680064),l!==null?o=ti(l,o):(o=Ii(o,s,r,null),o.flags|=2),o.return=e,n.return=e,n.sibling=o,e.child=n,n=o,o=e.child,s=t.child.memoizedState,s=s===null?kh(r):{baseLanes:s.baseLanes|r,cachePool:null,transitions:s.transitions},o.memoizedState=s,o.childLanes=t.childLanes&~r,e.memoizedState=Sh,n}return o=t.child,t=o.sibling,n=ti(o,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function Wf(t,e){return e=ld({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Cl(t,e,r,n){return n!==null&&Nf(n),as(e,t.child,null,r),t=Wf(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function hS(t,e,r,n,i,o,s){if(r)return e.flags&256?(e.flags&=-257,n=ou(Error(me(422))),Cl(t,e,s,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=n.fallback,i=e.mode,n=ld({mode:"visible",children:n.children},i,0,null),o=Ii(o,i,s,null),o.flags|=2,n.return=e,o.return=e,n.sibling=o,e.child=n,e.mode&1&&as(e,t.child,null,s),e.child.memoizedState=kh(s),e.memoizedState=Sh,o);if(!(e.mode&1))return Cl(t,e,s,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var l=n.dgst;return n=l,o=Error(me(419)),n=ou(o,n,void 0),Cl(t,e,s,n)}if(l=(s&t.childLanes)!==0,nr||l){if(n=Mt,n!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|s)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,wn(t,i),Wr(n,t,i,-1))}return Xf(),n=ou(Error(me(421))),Cl(t,e,s,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=jS.bind(null,t),i._reactRetry=e,null):(t=o.treeContext,pr=Zn(i.nextSibling),vr=e,ht=!0,Br=null,t!==null&&(kr[jr++]=mn,kr[jr++]=gn,kr[jr++]=zi,mn=t.id,gn=t.overflow,zi=e),e=Wf(e,n.children),e.flags|=4096,e)}function dg(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),vh(t.return,e,r)}function su(t,e,r,n,i){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=n,o.tail=r,o.tailMode=i)}function Qx(t,e,r){var n=e.pendingProps,i=n.revealOrder,o=n.tail;if(Kt(t,e,n.children,r),n=gt.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&dg(t,r,e);else if(t.tag===19)dg(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(it(gt,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&kc(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),su(e,!1,i,r,o);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&kc(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}su(e,!0,r,null,o);break;case"together":su(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function nc(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function _n(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Bi|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(me(153));if(e.child!==null){for(t=e.child,r=ti(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=ti(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function fS(t,e,r){switch(e.tag){case 3:Zx(e),ss();break;case 5:jx(e);break;case 1:or(e.type)&&yc(e);break;case 4:If(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;it(wc,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(it(gt,gt.current&1),e.flags|=128,null):r&e.child.childLanes?Jx(t,e,r):(it(gt,gt.current&1),t=_n(t,e,r),t!==null?t.sibling:null);it(gt,gt.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return Qx(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),it(gt,gt.current),n)break;return null;case 22:case 23:return e.lanes=0,Yx(t,e,r)}return _n(t,e,r)}var eb,jh,tb,rb;eb=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};jh=function(){};tb=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,Oi(rn.current);var o=null;switch(r){case"input":i=qu(t,i),n=qu(t,n),o=[];break;case"select":i=yt({},i,{value:void 0}),n=yt({},n,{value:void 0}),o=[];break;case"textarea":i=Xu(t,i),n=Xu(t,n),o=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=gc)}Ju(r,n);var s;r=null;for(d in i)if(!n.hasOwnProperty(d)&&i.hasOwnProperty(d)&&i[d]!=null)if(d==="style"){var l=i[d];for(s in l)l.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(ma.hasOwnProperty(d)?o||(o=[]):(o=o||[]).push(d,null));for(d in n){var c=n[d];if(l=i!=null?i[d]:void 0,n.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(r||(r={}),r[s]=c[s])}else r||(o||(o=[]),o.push(d,r)),r=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(o=o||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(o=o||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(ma.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&ot("scroll",t),o||l===c||(o=[])):(o=o||[]).push(d,c))}r&&(o=o||[]).push("style",r);var d=o;(e.updateQueue=d)&&(e.flags|=4)}};rb=function(t,e,r,n){r!==n&&(e.flags|=4)};function Fs(t,e){if(!ht)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Ut(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function pS(t,e,r){var n=e.pendingProps;switch(Rf(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ut(e),null;case 1:return or(e.type)&&vc(),Ut(e),null;case 3:return n=e.stateNode,ls(),lt(ir),lt(Vt),Df(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(kl(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Br!==null&&(Ah(Br),Br=null))),jh(t,e),Ut(e),null;case 5:Lf(e);var i=Oi(Ea.current);if(r=e.type,t!==null&&e.stateNode!=null)tb(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(me(166));return Ut(e),null}if(t=Oi(rn.current),kl(e)){n=e.stateNode,r=e.type;var o=e.memoizedProps;switch(n[Jr]=e,n[ja]=o,t=(e.mode&1)!==0,r){case"dialog":ot("cancel",n),ot("close",n);break;case"iframe":case"object":case"embed":ot("load",n);break;case"video":case"audio":for(i=0;i<Zs.length;i++)ot(Zs[i],n);break;case"source":ot("error",n);break;case"img":case"image":case"link":ot("error",n),ot("load",n);break;case"details":ot("toggle",n);break;case"input":xm(n,o),ot("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!o.multiple},ot("invalid",n);break;case"textarea":wm(n,o),ot("invalid",n)}Ju(r,o),i=null;for(var s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="children"?typeof l=="string"?n.textContent!==l&&(o.suppressHydrationWarning!==!0&&Sl(n.textContent,l,t),i=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(o.suppressHydrationWarning!==!0&&Sl(n.textContent,l,t),i=["children",""+l]):ma.hasOwnProperty(s)&&l!=null&&s==="onScroll"&&ot("scroll",n)}switch(r){case"input":ml(n),bm(n,o,!0);break;case"textarea":ml(n),_m(n);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(n.onclick=gc)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Ny(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=s.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=s.createElement(r,{is:n.is}):(t=s.createElement(r),r==="select"&&(s=t,n.multiple?s.multiple=!0:n.size&&(s.size=n.size))):t=s.createElementNS(t,r),t[Jr]=e,t[ja]=n,eb(t,e,!1,!1),e.stateNode=t;e:{switch(s=Qu(r,n),r){case"dialog":ot("cancel",t),ot("close",t),i=n;break;case"iframe":case"object":case"embed":ot("load",t),i=n;break;case"video":case"audio":for(i=0;i<Zs.length;i++)ot(Zs[i],t);i=n;break;case"source":ot("error",t),i=n;break;case"img":case"image":case"link":ot("error",t),ot("load",t),i=n;break;case"details":ot("toggle",t),i=n;break;case"input":xm(t,n),i=qu(t,n),ot("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=yt({},n,{value:void 0}),ot("invalid",t);break;case"textarea":wm(t,n),i=Xu(t,n),ot("invalid",t);break;default:i=n}Ju(r,i),l=i;for(o in l)if(l.hasOwnProperty(o)){var c=l[o];o==="style"?Ay(t,c):o==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Py(t,c)):o==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&ga(t,c):typeof c=="number"&&ga(t,""+c):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(ma.hasOwnProperty(o)?c!=null&&o==="onScroll"&&ot("scroll",t):c!=null&&pf(t,o,c,s))}switch(r){case"input":ml(t),bm(t,n,!1);break;case"textarea":ml(t),_m(t);break;case"option":n.value!=null&&t.setAttribute("value",""+ri(n.value));break;case"select":t.multiple=!!n.multiple,o=n.value,o!=null?Zo(t,!!n.multiple,o,!1):n.defaultValue!=null&&Zo(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=gc)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ut(e),null;case 6:if(t&&e.stateNode!=null)rb(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(me(166));if(r=Oi(Ea.current),Oi(rn.current),kl(e)){if(n=e.stateNode,r=e.memoizedProps,n[Jr]=e,(o=n.nodeValue!==r)&&(t=vr,t!==null))switch(t.tag){case 3:Sl(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Sl(n.nodeValue,r,(t.mode&1)!==0)}o&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Jr]=e,e.stateNode=n}return Ut(e),null;case 13:if(lt(gt),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ht&&pr!==null&&e.mode&1&&!(e.flags&128))bx(),ss(),e.flags|=98560,o=!1;else if(o=kl(e),n!==null&&n.dehydrated!==null){if(t===null){if(!o)throw Error(me(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(me(317));o[Jr]=e}else ss(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ut(e),o=!1}else Br!==null&&(Ah(Br),Br=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||gt.current&1?Ot===0&&(Ot=3):Xf())),e.updateQueue!==null&&(e.flags|=4),Ut(e),null);case 4:return ls(),jh(t,e),t===null&&Sa(e.stateNode.containerInfo),Ut(e),null;case 10:return Af(e.type._context),Ut(e),null;case 17:return or(e.type)&&vc(),Ut(e),null;case 19:if(lt(gt),o=e.memoizedState,o===null)return Ut(e),null;if(n=(e.flags&128)!==0,s=o.rendering,s===null)if(n)Fs(o,!1);else{if(Ot!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(s=kc(t),s!==null){for(e.flags|=128,Fs(o,!1),n=s.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)o=r,t=n,o.flags&=14680066,s=o.alternate,s===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,t=s.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return it(gt,gt.current&1|2),e.child}t=t.sibling}o.tail!==null&&bt()>ds&&(e.flags|=128,n=!0,Fs(o,!1),e.lanes=4194304)}else{if(!n)if(t=kc(s),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Fs(o,!0),o.tail===null&&o.tailMode==="hidden"&&!s.alternate&&!ht)return Ut(e),null}else 2*bt()-o.renderingStartTime>ds&&r!==1073741824&&(e.flags|=128,n=!0,Fs(o,!1),e.lanes=4194304);o.isBackwards?(s.sibling=e.child,e.child=s):(r=o.last,r!==null?r.sibling=s:e.child=s,o.last=s)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=bt(),e.sibling=null,r=gt.current,it(gt,n?r&1|2:r&1),e):(Ut(e),null);case 22:case 23:return Yf(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?ur&1073741824&&(Ut(e),e.subtreeFlags&6&&(e.flags|=8192)):Ut(e),null;case 24:return null;case 25:return null}throw Error(me(156,e.tag))}function mS(t,e){switch(Rf(e),e.tag){case 1:return or(e.type)&&vc(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ls(),lt(ir),lt(Vt),Df(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Lf(e),null;case 13:if(lt(gt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(me(340));ss()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return lt(gt),null;case 4:return ls(),null;case 10:return Af(e.type._context),null;case 22:case 23:return Yf(),null;case 24:return null;default:return null}}var El=!1,Gt=!1,gS=typeof WeakSet=="function"?WeakSet:Set,Ee=null;function Ko(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){xt(t,e,n)}else r.current=null}function Ch(t,e,r){try{r()}catch(n){xt(t,e,n)}}var ug=!1;function vS(t,e){if(ch=fc,t=ax(),Ef(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,o=n.focusNode;n=n.focusOffset;try{r.nodeType,o.nodeType}catch{r=null;break e}var s=0,l=-1,c=-1,d=0,h=0,f=t,u=null;t:for(;;){for(var p;f!==r||i!==0&&f.nodeType!==3||(l=s+i),f!==o||n!==0&&f.nodeType!==3||(c=s+n),f.nodeType===3&&(s+=f.nodeValue.length),(p=f.firstChild)!==null;)u=f,f=p;for(;;){if(f===t)break t;if(u===r&&++d===i&&(l=s),u===o&&++h===n&&(c=s),(p=f.nextSibling)!==null)break;f=u,u=f.parentNode}f=p}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(dh={focusedElem:t,selectionRange:r},fc=!1,Ee=e;Ee!==null;)if(e=Ee,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Ee=t;else for(;Ee!==null;){e=Ee;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var m=g.memoizedProps,x=g.memoizedState,v=e.stateNode,y=v.getSnapshotBeforeUpdate(e.elementType===e.type?m:Lr(e.type,m),x);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(me(163))}}catch(w){xt(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,Ee=t;break}Ee=e.return}return g=ug,ug=!1,g}function la(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var o=i.destroy;i.destroy=void 0,o!==void 0&&Ch(e,r,o)}i=i.next}while(i!==n)}}function sd(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function Eh(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function nb(t){var e=t.alternate;e!==null&&(t.alternate=null,nb(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Jr],delete e[ja],delete e[fh],delete e[Q2],delete e[eS])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function ib(t){return t.tag===5||t.tag===3||t.tag===4}function hg(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||ib(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Th(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=gc));else if(n!==4&&(t=t.child,t!==null))for(Th(t,e,r),t=t.sibling;t!==null;)Th(t,e,r),t=t.sibling}function Rh(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(Rh(t,e,r),t=t.sibling;t!==null;)Rh(t,e,r),t=t.sibling}var Lt=null,zr=!1;function In(t,e,r){for(r=r.child;r!==null;)ob(t,e,r),r=r.sibling}function ob(t,e,r){if(tn&&typeof tn.onCommitFiberUnmount=="function")try{tn.onCommitFiberUnmount(Jc,r)}catch{}switch(r.tag){case 5:Gt||Ko(r,e);case 6:var n=Lt,i=zr;Lt=null,In(t,e,r),Lt=n,zr=i,Lt!==null&&(zr?(t=Lt,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):Lt.removeChild(r.stateNode));break;case 18:Lt!==null&&(zr?(t=Lt,r=r.stateNode,t.nodeType===8?Qd(t.parentNode,r):t.nodeType===1&&Qd(t,r),ba(t)):Qd(Lt,r.stateNode));break;case 4:n=Lt,i=zr,Lt=r.stateNode.containerInfo,zr=!0,In(t,e,r),Lt=n,zr=i;break;case 0:case 11:case 14:case 15:if(!Gt&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var o=i,s=o.destroy;o=o.tag,s!==void 0&&(o&2||o&4)&&Ch(r,e,s),i=i.next}while(i!==n)}In(t,e,r);break;case 1:if(!Gt&&(Ko(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){xt(r,e,l)}In(t,e,r);break;case 21:In(t,e,r);break;case 22:r.mode&1?(Gt=(n=Gt)||r.memoizedState!==null,In(t,e,r),Gt=n):In(t,e,r);break;default:In(t,e,r)}}function fg(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new gS),e.forEach(function(n){var i=CS.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Ar(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var o=t,s=e,l=s;e:for(;l!==null;){switch(l.tag){case 5:Lt=l.stateNode,zr=!1;break e;case 3:Lt=l.stateNode.containerInfo,zr=!0;break e;case 4:Lt=l.stateNode.containerInfo,zr=!0;break e}l=l.return}if(Lt===null)throw Error(me(160));ob(o,s,i),Lt=null,zr=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(d){xt(i,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)sb(e,t),e=e.sibling}function sb(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Ar(e,t),Yr(t),n&4){try{la(3,t,t.return),sd(3,t)}catch(m){xt(t,t.return,m)}try{la(5,t,t.return)}catch(m){xt(t,t.return,m)}}break;case 1:Ar(e,t),Yr(t),n&512&&r!==null&&Ko(r,r.return);break;case 5:if(Ar(e,t),Yr(t),n&512&&r!==null&&Ko(r,r.return),t.flags&32){var i=t.stateNode;try{ga(i,"")}catch(m){xt(t,t.return,m)}}if(n&4&&(i=t.stateNode,i!=null)){var o=t.memoizedProps,s=r!==null?r.memoizedProps:o,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&o.type==="radio"&&o.name!=null&&Ty(i,o),Qu(l,s);var d=Qu(l,o);for(s=0;s<c.length;s+=2){var h=c[s],f=c[s+1];h==="style"?Ay(i,f):h==="dangerouslySetInnerHTML"?Py(i,f):h==="children"?ga(i,f):pf(i,h,f,d)}switch(l){case"input":Ku(i,o);break;case"textarea":Ry(i,o);break;case"select":var u=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var p=o.value;p!=null?Zo(i,!!o.multiple,p,!1):u!==!!o.multiple&&(o.defaultValue!=null?Zo(i,!!o.multiple,o.defaultValue,!0):Zo(i,!!o.multiple,o.multiple?[]:"",!1))}i[ja]=o}catch(m){xt(t,t.return,m)}}break;case 6:if(Ar(e,t),Yr(t),n&4){if(t.stateNode===null)throw Error(me(162));i=t.stateNode,o=t.memoizedProps;try{i.nodeValue=o}catch(m){xt(t,t.return,m)}}break;case 3:if(Ar(e,t),Yr(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{ba(e.containerInfo)}catch(m){xt(t,t.return,m)}break;case 4:Ar(e,t),Yr(t);break;case 13:Ar(e,t),Yr(t),i=t.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(qf=bt())),n&4&&fg(t);break;case 22:if(h=r!==null&&r.memoizedState!==null,t.mode&1?(Gt=(d=Gt)||h,Ar(e,t),Gt=d):Ar(e,t),Yr(t),n&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!h&&t.mode&1)for(Ee=t,h=t.child;h!==null;){for(f=Ee=h;Ee!==null;){switch(u=Ee,p=u.child,u.tag){case 0:case 11:case 14:case 15:la(4,u,u.return);break;case 1:Ko(u,u.return);var g=u.stateNode;if(typeof g.componentWillUnmount=="function"){n=u,r=u.return;try{e=n,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(m){xt(n,r,m)}}break;case 5:Ko(u,u.return);break;case 22:if(u.memoizedState!==null){mg(f);continue}}p!==null?(p.return=u,Ee=p):mg(f)}h=h.sibling}e:for(h=null,f=t;;){if(f.tag===5){if(h===null){h=f;try{i=f.stateNode,d?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(l=f.stateNode,c=f.memoizedProps.style,s=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=Oy("display",s))}catch(m){xt(t,t.return,m)}}}else if(f.tag===6){if(h===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(m){xt(t,t.return,m)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Ar(e,t),Yr(t),n&4&&fg(t);break;case 21:break;default:Ar(e,t),Yr(t)}}function Yr(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(ib(r)){var n=r;break e}r=r.return}throw Error(me(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(ga(i,""),n.flags&=-33);var o=hg(t);Rh(t,o,i);break;case 3:case 4:var s=n.stateNode.containerInfo,l=hg(t);Th(t,l,s);break;default:throw Error(me(161))}}catch(c){xt(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function yS(t,e,r){Ee=t,ab(t)}function ab(t,e,r){for(var n=(t.mode&1)!==0;Ee!==null;){var i=Ee,o=i.child;if(i.tag===22&&n){var s=i.memoizedState!==null||El;if(!s){var l=i.alternate,c=l!==null&&l.memoizedState!==null||Gt;l=El;var d=Gt;if(El=s,(Gt=c)&&!d)for(Ee=i;Ee!==null;)s=Ee,c=s.child,s.tag===22&&s.memoizedState!==null?gg(i):c!==null?(c.return=s,Ee=c):gg(i);for(;o!==null;)Ee=o,ab(o),o=o.sibling;Ee=i,El=l,Gt=d}pg(t)}else i.subtreeFlags&8772&&o!==null?(o.return=i,Ee=o):pg(t)}}function pg(t){for(;Ee!==null;){var e=Ee;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Gt||sd(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Gt)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:Lr(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&Jm(e,o,n);break;case 3:var s=e.updateQueue;if(s!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}Jm(e,s,r)}break;case 5:var l=e.stateNode;if(r===null&&e.flags&4){r=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var f=h.dehydrated;f!==null&&ba(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(me(163))}Gt||e.flags&512&&Eh(e)}catch(u){xt(e,e.return,u)}}if(e===t){Ee=null;break}if(r=e.sibling,r!==null){r.return=e.return,Ee=r;break}Ee=e.return}}function mg(t){for(;Ee!==null;){var e=Ee;if(e===t){Ee=null;break}var r=e.sibling;if(r!==null){r.return=e.return,Ee=r;break}Ee=e.return}}function gg(t){for(;Ee!==null;){var e=Ee;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{sd(4,e)}catch(c){xt(e,r,c)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(c){xt(e,i,c)}}var o=e.return;try{Eh(e)}catch(c){xt(e,o,c)}break;case 5:var s=e.return;try{Eh(e)}catch(c){xt(e,s,c)}}}catch(c){xt(e,e.return,c)}if(e===t){Ee=null;break}var l=e.sibling;if(l!==null){l.return=e.return,Ee=l;break}Ee=e.return}}var xS=Math.ceil,Ec=Sn.ReactCurrentDispatcher,Gf=Sn.ReactCurrentOwner,Tr=Sn.ReactCurrentBatchConfig,Ze=0,Mt=null,jt=null,Dt=0,ur=0,Yo=ai(0),Ot=0,Pa=null,Bi=0,ad=0,Vf=0,ca=null,rr=null,qf=0,ds=1/0,hn=null,Tc=!1,Nh=null,Qn=null,Tl=!1,qn=null,Rc=0,da=0,Ph=null,ic=-1,oc=0;function Xt(){return Ze&6?bt():ic!==-1?ic:ic=bt()}function ei(t){return t.mode&1?Ze&2&&Dt!==0?Dt&-Dt:rS.transition!==null?(oc===0&&(oc=Gy()),oc):(t=et,t!==0||(t=window.event,t=t===void 0?16:Jy(t.type)),t):1}function Wr(t,e,r,n){if(50<da)throw da=0,Ph=null,Error(me(185));za(t,r,n),(!(Ze&2)||t!==Mt)&&(t===Mt&&(!(Ze&2)&&(ad|=r),Ot===4&&Hn(t,Dt)),sr(t,n),r===1&&Ze===0&&!(e.mode&1)&&(ds=bt()+500,nd&&li()))}function sr(t,e){var r=t.callbackNode;r2(t,e);var n=hc(t,t===Mt?Dt:0);if(n===0)r!==null&&jm(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&jm(r),e===1)t.tag===0?tS(vg.bind(null,t)):vx(vg.bind(null,t)),Z2(function(){!(Ze&6)&&li()}),r=null;else{switch(Vy(n)){case 1:r=xf;break;case 4:r=Hy;break;case 16:r=uc;break;case 536870912:r=Wy;break;default:r=uc}r=mb(r,lb.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function lb(t,e){if(ic=-1,oc=0,Ze&6)throw Error(me(327));var r=t.callbackNode;if(rs()&&t.callbackNode!==r)return null;var n=hc(t,t===Mt?Dt:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=Nc(t,n);else{e=n;var i=Ze;Ze|=2;var o=db();(Mt!==t||Dt!==e)&&(hn=null,ds=bt()+500,$i(t,e));do try{_S();break}catch(l){cb(t,l)}while(!0);Of(),Ec.current=o,Ze=i,jt!==null?e=0:(Mt=null,Dt=0,e=Ot)}if(e!==0){if(e===2&&(i=ih(t),i!==0&&(n=i,e=Oh(t,i))),e===1)throw r=Pa,$i(t,0),Hn(t,n),sr(t,bt()),r;if(e===6)Hn(t,n);else{if(i=t.current.alternate,!(n&30)&&!bS(i)&&(e=Nc(t,n),e===2&&(o=ih(t),o!==0&&(n=o,e=Oh(t,o))),e===1))throw r=Pa,$i(t,0),Hn(t,n),sr(t,bt()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(me(345));case 2:ji(t,rr,hn);break;case 3:if(Hn(t,n),(n&130023424)===n&&(e=qf+500-bt(),10<e)){if(hc(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){Xt(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=hh(ji.bind(null,t,rr,hn),e);break}ji(t,rr,hn);break;case 4:if(Hn(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var s=31-Hr(n);o=1<<s,s=e[s],s>i&&(i=s),n&=~o}if(n=i,n=bt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*xS(n/1960))-n,10<n){t.timeoutHandle=hh(ji.bind(null,t,rr,hn),n);break}ji(t,rr,hn);break;case 5:ji(t,rr,hn);break;default:throw Error(me(329))}}}return sr(t,bt()),t.callbackNode===r?lb.bind(null,t):null}function Oh(t,e){var r=ca;return t.current.memoizedState.isDehydrated&&($i(t,e).flags|=256),t=Nc(t,e),t!==2&&(e=rr,rr=r,e!==null&&Ah(e)),t}function Ah(t){rr===null?rr=t:rr.push.apply(rr,t)}function bS(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],o=i.getSnapshot;i=i.value;try{if(!Gr(o(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Hn(t,e){for(e&=~Vf,e&=~ad,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Hr(e),n=1<<r;t[r]=-1,e&=~n}}function vg(t){if(Ze&6)throw Error(me(327));rs();var e=hc(t,0);if(!(e&1))return sr(t,bt()),null;var r=Nc(t,e);if(t.tag!==0&&r===2){var n=ih(t);n!==0&&(e=n,r=Oh(t,n))}if(r===1)throw r=Pa,$i(t,0),Hn(t,e),sr(t,bt()),r;if(r===6)throw Error(me(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ji(t,rr,hn),sr(t,bt()),null}function Kf(t,e){var r=Ze;Ze|=1;try{return t(e)}finally{Ze=r,Ze===0&&(ds=bt()+500,nd&&li())}}function Ui(t){qn!==null&&qn.tag===0&&!(Ze&6)&&rs();var e=Ze;Ze|=1;var r=Tr.transition,n=et;try{if(Tr.transition=null,et=1,t)return t()}finally{et=n,Tr.transition=r,Ze=e,!(Ze&6)&&li()}}function Yf(){ur=Yo.current,lt(Yo)}function $i(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,X2(r)),jt!==null)for(r=jt.return;r!==null;){var n=r;switch(Rf(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&vc();break;case 3:ls(),lt(ir),lt(Vt),Df();break;case 5:Lf(n);break;case 4:ls();break;case 13:lt(gt);break;case 19:lt(gt);break;case 10:Af(n.type._context);break;case 22:case 23:Yf()}r=r.return}if(Mt=t,jt=t=ti(t.current,null),Dt=ur=e,Ot=0,Pa=null,Vf=ad=Bi=0,rr=ca=null,Pi!==null){for(e=0;e<Pi.length;e++)if(r=Pi[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,o=r.pending;if(o!==null){var s=o.next;o.next=i,n.next=s}r.pending=n}Pi=null}return t}function cb(t,e){do{var r=jt;try{if(Of(),tc.current=Cc,jc){for(var n=vt.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}jc=!1}if(Fi=0,At=Nt=vt=null,aa=!1,Ta=0,Gf.current=null,r===null||r.return===null){Ot=1,Pa=e,jt=null;break}e:{var o=t,s=r.return,l=r,c=e;if(e=Dt,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,h=l,f=h.tag;if(!(h.mode&1)&&(f===0||f===11||f===15)){var u=h.alternate;u?(h.updateQueue=u.updateQueue,h.memoizedState=u.memoizedState,h.lanes=u.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=ig(s);if(p!==null){p.flags&=-257,og(p,s,l,o,e),p.mode&1&&ng(o,d,e),e=p,c=d;var g=e.updateQueue;if(g===null){var m=new Set;m.add(c),e.updateQueue=m}else g.add(c);break e}else{if(!(e&1)){ng(o,d,e),Xf();break e}c=Error(me(426))}}else if(ht&&l.mode&1){var x=ig(s);if(x!==null){!(x.flags&65536)&&(x.flags|=256),og(x,s,l,o,e),Nf(cs(c,l));break e}}o=c=cs(c,l),Ot!==4&&(Ot=2),ca===null?ca=[o]:ca.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var v=Vx(o,c,e);Zm(o,v);break e;case 1:l=c;var y=o.type,b=o.stateNode;if(!(o.flags&128)&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Qn===null||!Qn.has(b)))){o.flags|=65536,e&=-e,o.lanes|=e;var w=qx(o,l,e);Zm(o,w);break e}}o=o.return}while(o!==null)}hb(r)}catch(k){e=k,jt===r&&r!==null&&(jt=r=r.return);continue}break}while(!0)}function db(){var t=Ec.current;return Ec.current=Cc,t===null?Cc:t}function Xf(){(Ot===0||Ot===3||Ot===2)&&(Ot=4),Mt===null||!(Bi&268435455)&&!(ad&268435455)||Hn(Mt,Dt)}function Nc(t,e){var r=Ze;Ze|=2;var n=db();(Mt!==t||Dt!==e)&&(hn=null,$i(t,e));do try{wS();break}catch(i){cb(t,i)}while(!0);if(Of(),Ze=r,Ec.current=n,jt!==null)throw Error(me(261));return Mt=null,Dt=0,Ot}function wS(){for(;jt!==null;)ub(jt)}function _S(){for(;jt!==null&&!q_();)ub(jt)}function ub(t){var e=pb(t.alternate,t,ur);t.memoizedProps=t.pendingProps,e===null?hb(t):jt=e,Gf.current=null}function hb(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=mS(r,e),r!==null){r.flags&=32767,jt=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ot=6,jt=null;return}}else if(r=pS(r,e,ur),r!==null){jt=r;return}if(e=e.sibling,e!==null){jt=e;return}jt=e=t}while(e!==null);Ot===0&&(Ot=5)}function ji(t,e,r){var n=et,i=Tr.transition;try{Tr.transition=null,et=1,SS(t,e,r,n)}finally{Tr.transition=i,et=n}return null}function SS(t,e,r,n){do rs();while(qn!==null);if(Ze&6)throw Error(me(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(me(177));t.callbackNode=null,t.callbackPriority=0;var o=r.lanes|r.childLanes;if(n2(t,o),t===Mt&&(jt=Mt=null,Dt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Tl||(Tl=!0,mb(uc,function(){return rs(),null})),o=(r.flags&15990)!==0,r.subtreeFlags&15990||o){o=Tr.transition,Tr.transition=null;var s=et;et=1;var l=Ze;Ze|=4,Gf.current=null,vS(t,r),sb(r,t),H2(dh),fc=!!ch,dh=ch=null,t.current=r,yS(r),K_(),Ze=l,et=s,Tr.transition=o}else t.current=r;if(Tl&&(Tl=!1,qn=t,Rc=i),o=t.pendingLanes,o===0&&(Qn=null),Z_(r.stateNode),sr(t,bt()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Tc)throw Tc=!1,t=Nh,Nh=null,t;return Rc&1&&t.tag!==0&&rs(),o=t.pendingLanes,o&1?t===Ph?da++:(da=0,Ph=t):da=0,li(),null}function rs(){if(qn!==null){var t=Vy(Rc),e=Tr.transition,r=et;try{if(Tr.transition=null,et=16>t?16:t,qn===null)var n=!1;else{if(t=qn,qn=null,Rc=0,Ze&6)throw Error(me(331));var i=Ze;for(Ze|=4,Ee=t.current;Ee!==null;){var o=Ee,s=o.child;if(Ee.flags&16){var l=o.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(Ee=d;Ee!==null;){var h=Ee;switch(h.tag){case 0:case 11:case 15:la(8,h,o)}var f=h.child;if(f!==null)f.return=h,Ee=f;else for(;Ee!==null;){h=Ee;var u=h.sibling,p=h.return;if(nb(h),h===d){Ee=null;break}if(u!==null){u.return=p,Ee=u;break}Ee=p}}}var g=o.alternate;if(g!==null){var m=g.child;if(m!==null){g.child=null;do{var x=m.sibling;m.sibling=null,m=x}while(m!==null)}}Ee=o}}if(o.subtreeFlags&2064&&s!==null)s.return=o,Ee=s;else e:for(;Ee!==null;){if(o=Ee,o.flags&2048)switch(o.tag){case 0:case 11:case 15:la(9,o,o.return)}var v=o.sibling;if(v!==null){v.return=o.return,Ee=v;break e}Ee=o.return}}var y=t.current;for(Ee=y;Ee!==null;){s=Ee;var b=s.child;if(s.subtreeFlags&2064&&b!==null)b.return=s,Ee=b;else e:for(s=y;Ee!==null;){if(l=Ee,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:sd(9,l)}}catch(k){xt(l,l.return,k)}if(l===s){Ee=null;break e}var w=l.sibling;if(w!==null){w.return=l.return,Ee=w;break e}Ee=l.return}}if(Ze=i,li(),tn&&typeof tn.onPostCommitFiberRoot=="function")try{tn.onPostCommitFiberRoot(Jc,t)}catch{}n=!0}return n}finally{et=r,Tr.transition=e}}return!1}function yg(t,e,r){e=cs(r,e),e=Vx(t,e,1),t=Jn(t,e,1),e=Xt(),t!==null&&(za(t,1,e),sr(t,e))}function xt(t,e,r){if(t.tag===3)yg(t,t,r);else for(;e!==null;){if(e.tag===3){yg(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Qn===null||!Qn.has(n))){t=cs(r,t),t=qx(e,t,1),e=Jn(e,t,1),t=Xt(),e!==null&&(za(e,1,t),sr(e,t));break}}e=e.return}}function kS(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Xt(),t.pingedLanes|=t.suspendedLanes&r,Mt===t&&(Dt&r)===r&&(Ot===4||Ot===3&&(Dt&130023424)===Dt&&500>bt()-qf?$i(t,0):Vf|=r),sr(t,e)}function fb(t,e){e===0&&(t.mode&1?(e=yl,yl<<=1,!(yl&130023424)&&(yl=4194304)):e=1);var r=Xt();t=wn(t,e),t!==null&&(za(t,e,r),sr(t,r))}function jS(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),fb(t,r)}function CS(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(me(314))}n!==null&&n.delete(e),fb(t,r)}var pb;pb=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||ir.current)nr=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return nr=!1,fS(t,e,r);nr=!!(t.flags&131072)}else nr=!1,ht&&e.flags&1048576&&yx(e,bc,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;nc(t,e),t=e.pendingProps;var i=os(e,Vt.current);ts(e,r),i=Ff(null,e,n,t,i,r);var o=Bf();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,or(n)?(o=!0,yc(e)):o=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,$f(e),i.updater=od,e.stateNode=i,i._reactInternals=e,xh(e,n,t,r),e=_h(null,e,n,!0,o,r)):(e.tag=0,ht&&o&&Tf(e),Kt(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(nc(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=TS(n),t=Lr(n,t),i){case 0:e=wh(null,e,n,t,r);break e;case 1:e=lg(null,e,n,t,r);break e;case 11:e=sg(null,e,n,t,r);break e;case 14:e=ag(null,e,n,Lr(n.type,t),r);break e}throw Error(me(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Lr(n,i),wh(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Lr(n,i),lg(t,e,n,i,r);case 3:e:{if(Zx(e),t===null)throw Error(me(387));n=e.pendingProps,o=e.memoizedState,i=o.element,kx(t,e),Sc(e,n,null,r);var s=e.memoizedState;if(n=s.element,o.isDehydrated)if(o={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){i=cs(Error(me(423)),e),e=cg(t,e,n,r,i);break e}else if(n!==i){i=cs(Error(me(424)),e),e=cg(t,e,n,r,i);break e}else for(pr=Zn(e.stateNode.containerInfo.firstChild),vr=e,ht=!0,Br=null,r=_x(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(ss(),n===i){e=_n(t,e,r);break e}Kt(t,e,n,r)}e=e.child}return e;case 5:return jx(e),t===null&&gh(e),n=e.type,i=e.pendingProps,o=t!==null?t.memoizedProps:null,s=i.children,uh(n,i)?s=null:o!==null&&uh(n,o)&&(e.flags|=32),Xx(t,e),Kt(t,e,s,r),e.child;case 6:return t===null&&gh(e),null;case 13:return Jx(t,e,r);case 4:return If(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=as(e,null,n,r):Kt(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Lr(n,i),sg(t,e,n,i,r);case 7:return Kt(t,e,e.pendingProps,r),e.child;case 8:return Kt(t,e,e.pendingProps.children,r),e.child;case 12:return Kt(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,o=e.memoizedProps,s=i.value,it(wc,n._currentValue),n._currentValue=s,o!==null)if(Gr(o.value,s)){if(o.children===i.children&&!ir.current){e=_n(t,e,r);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var l=o.dependencies;if(l!==null){s=o.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(o.tag===1){c=vn(-1,r&-r),c.tag=2;var d=o.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?c.next=c:(c.next=h.next,h.next=c),d.pending=c}}o.lanes|=r,c=o.alternate,c!==null&&(c.lanes|=r),vh(o.return,r,e),l.lanes|=r;break}c=c.next}}else if(o.tag===10)s=o.type===e.type?null:o.child;else if(o.tag===18){if(s=o.return,s===null)throw Error(me(341));s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),vh(s,r,e),s=o.sibling}else s=o.child;if(s!==null)s.return=o;else for(s=o;s!==null;){if(s===e){s=null;break}if(o=s.sibling,o!==null){o.return=s.return,s=o;break}s=s.return}o=s}Kt(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,ts(e,r),i=Rr(i),n=n(i),e.flags|=1,Kt(t,e,n,r),e.child;case 14:return n=e.type,i=Lr(n,e.pendingProps),i=Lr(n.type,i),ag(t,e,n,i,r);case 15:return Kx(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Lr(n,i),nc(t,e),e.tag=1,or(n)?(t=!0,yc(e)):t=!1,ts(e,r),Gx(e,n,i),xh(e,n,i,r),_h(null,e,n,!0,t,r);case 19:return Qx(t,e,r);case 22:return Yx(t,e,r)}throw Error(me(156,e.tag))};function mb(t,e){return Uy(t,e)}function ES(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Er(t,e,r,n){return new ES(t,e,r,n)}function Zf(t){return t=t.prototype,!(!t||!t.isReactComponent)}function TS(t){if(typeof t=="function")return Zf(t)?1:0;if(t!=null){if(t=t.$$typeof,t===gf)return 11;if(t===vf)return 14}return 2}function ti(t,e){var r=t.alternate;return r===null?(r=Er(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function sc(t,e,r,n,i,o){var s=2;if(n=t,typeof t=="function")Zf(t)&&(s=1);else if(typeof t=="string")s=5;else e:switch(t){case zo:return Ii(r.children,i,o,e);case mf:s=8,i|=8;break;case Hu:return t=Er(12,r,e,i|2),t.elementType=Hu,t.lanes=o,t;case Wu:return t=Er(13,r,e,i),t.elementType=Wu,t.lanes=o,t;case Gu:return t=Er(19,r,e,i),t.elementType=Gu,t.lanes=o,t;case jy:return ld(r,i,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Sy:s=10;break e;case ky:s=9;break e;case gf:s=11;break e;case vf:s=14;break e;case Dn:s=16,n=null;break e}throw Error(me(130,t==null?t:typeof t,""))}return e=Er(s,r,e,i),e.elementType=t,e.type=n,e.lanes=o,e}function Ii(t,e,r,n){return t=Er(7,t,n,e),t.lanes=r,t}function ld(t,e,r,n){return t=Er(22,t,n,e),t.elementType=jy,t.lanes=r,t.stateNode={isHidden:!1},t}function au(t,e,r){return t=Er(6,t,null,e),t.lanes=r,t}function lu(t,e,r){return e=Er(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function RS(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ud(0),this.expirationTimes=Ud(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ud(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Jf(t,e,r,n,i,o,s,l,c){return t=new RS(t,e,r,l,c),e===1?(e=1,o===!0&&(e|=8)):e=0,o=Er(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},$f(o),t}function NS(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Do,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function gb(t){if(!t)return ni;t=t._reactInternals;e:{if(Gi(t)!==t||t.tag!==1)throw Error(me(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(or(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(me(171))}if(t.tag===1){var r=t.type;if(or(r))return gx(t,r,e)}return e}function vb(t,e,r,n,i,o,s,l,c){return t=Jf(r,n,!0,t,i,o,s,l,c),t.context=gb(null),r=t.current,n=Xt(),i=ei(r),o=vn(n,i),o.callback=e??null,Jn(r,o,i),t.current.lanes=i,za(t,i,n),sr(t,n),t}function cd(t,e,r,n){var i=e.current,o=Xt(),s=ei(i);return r=gb(r),e.context===null?e.context=r:e.pendingContext=r,e=vn(o,s),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Jn(i,e,s),t!==null&&(Wr(t,i,s,o),ec(t,i,s)),s}function Pc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function xg(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function Qf(t,e){xg(t,e),(t=t.alternate)&&xg(t,e)}function PS(){return null}var yb=typeof reportError=="function"?reportError:function(t){console.error(t)};function ep(t){this._internalRoot=t}dd.prototype.render=ep.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(me(409));cd(t,e,null,null)};dd.prototype.unmount=ep.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ui(function(){cd(null,t,null,null)}),e[bn]=null}};function dd(t){this._internalRoot=t}dd.prototype.unstable_scheduleHydration=function(t){if(t){var e=Yy();t={blockedOn:null,target:t,priority:e};for(var r=0;r<Un.length&&e!==0&&e<Un[r].priority;r++);Un.splice(r,0,t),r===0&&Zy(t)}};function tp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function ud(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function bg(){}function OS(t,e,r,n,i){if(i){if(typeof n=="function"){var o=n;n=function(){var d=Pc(s);o.call(d)}}var s=vb(e,n,t,0,null,!1,!1,"",bg);return t._reactRootContainer=s,t[bn]=s.current,Sa(t.nodeType===8?t.parentNode:t),Ui(),s}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var l=n;n=function(){var d=Pc(c);l.call(d)}}var c=Jf(t,0,!1,null,null,!1,!1,"",bg);return t._reactRootContainer=c,t[bn]=c.current,Sa(t.nodeType===8?t.parentNode:t),Ui(function(){cd(e,c,r,n)}),c}function hd(t,e,r,n,i){var o=r._reactRootContainer;if(o){var s=o;if(typeof i=="function"){var l=i;i=function(){var c=Pc(s);l.call(c)}}cd(e,s,t,i)}else s=OS(r,e,t,i,n);return Pc(s)}qy=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Xs(e.pendingLanes);r!==0&&(bf(e,r|1),sr(e,bt()),!(Ze&6)&&(ds=bt()+500,li()))}break;case 13:Ui(function(){var n=wn(t,1);if(n!==null){var i=Xt();Wr(n,t,1,i)}}),Qf(t,1)}};wf=function(t){if(t.tag===13){var e=wn(t,134217728);if(e!==null){var r=Xt();Wr(e,t,134217728,r)}Qf(t,134217728)}};Ky=function(t){if(t.tag===13){var e=ei(t),r=wn(t,e);if(r!==null){var n=Xt();Wr(r,t,e,n)}Qf(t,e)}};Yy=function(){return et};Xy=function(t,e){var r=et;try{return et=t,e()}finally{et=r}};th=function(t,e,r){switch(e){case"input":if(Ku(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=rd(n);if(!i)throw Error(me(90));Ey(n),Ku(n,i)}}}break;case"textarea":Ry(t,r);break;case"select":e=r.value,e!=null&&Zo(t,!!r.multiple,e,!1)}};Iy=Kf;Ly=Ui;var AS={usingClientEntryPoint:!1,Events:[Ba,Ho,rd,My,$y,Kf]},Bs={findFiberByHostInstance:Ni,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},MS={bundleType:Bs.bundleType,version:Bs.version,rendererPackageName:Bs.rendererPackageName,rendererConfig:Bs.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Sn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Fy(t),t===null?null:t.stateNode},findFiberByHostInstance:Bs.findFiberByHostInstance||PS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Rl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Rl.isDisabled&&Rl.supportsFiber)try{Jc=Rl.inject(MS),tn=Rl}catch{}}br.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=AS;br.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!tp(e))throw Error(me(200));return NS(t,e,null,r)};br.createRoot=function(t,e){if(!tp(t))throw Error(me(299));var r=!1,n="",i=yb;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Jf(t,1,!1,null,null,r,!1,n,i),t[bn]=e.current,Sa(t.nodeType===8?t.parentNode:t),new ep(e)};br.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(me(188)):(t=Object.keys(t).join(","),Error(me(268,t)));return t=Fy(e),t=t===null?null:t.stateNode,t};br.flushSync=function(t){return Ui(t)};br.hydrate=function(t,e,r){if(!ud(e))throw Error(me(200));return hd(null,t,e,!0,r)};br.hydrateRoot=function(t,e,r){if(!tp(t))throw Error(me(405));var n=r!=null&&r.hydratedSources||null,i=!1,o="",s=yb;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(o=r.identifierPrefix),r.onRecoverableError!==void 0&&(s=r.onRecoverableError)),e=vb(e,null,t,1,r??null,i,!1,o,s),t[bn]=e.current,Sa(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new dd(e)};br.render=function(t,e,r){if(!ud(e))throw Error(me(200));return hd(null,t,e,!1,r)};br.unmountComponentAtNode=function(t){if(!ud(t))throw Error(me(40));return t._reactRootContainer?(Ui(function(){hd(null,null,t,!1,function(){t._reactRootContainer=null,t[bn]=null})}),!0):!1};br.unstable_batchedUpdates=Kf;br.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!ud(r))throw Error(me(200));if(t==null||t._reactInternals===void 0)throw Error(me(38));return hd(t,e,r,!1,n)};br.version="18.3.1-next-f1338f8080-20240426";function xb(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(xb)}catch(t){console.error(t)}}xb(),xy.exports=br;var $S=xy.exports,wg=$S;Bu.createRoot=wg.createRoot,Bu.hydrateRoot=wg.hydrateRoot;var Mh=function(t,e){return Mh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},Mh(t,e)};function bb(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Mh(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Oc=function(){return Oc=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},Oc.apply(this,arguments)};function ms(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function wb(t,e,r,n){var i=arguments.length,o=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,e,r,n);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(o=(i<3?s(o):i>3?s(e,r,o):s(e,r))||o);return i>3&&o&&Object.defineProperty(e,r,o),o}function _b(t,e){return function(r,n){e(r,n,t)}}function Sb(t,e,r,n,i,o){function s(v){if(v!==void 0&&typeof v!="function")throw new TypeError("Function expected");return v}for(var l=n.kind,c=l==="getter"?"get":l==="setter"?"set":"value",d=!e&&t?n.static?t:t.prototype:null,h=e||(d?Object.getOwnPropertyDescriptor(d,n.name):{}),f,u=!1,p=r.length-1;p>=0;p--){var g={};for(var m in n)g[m]=m==="access"?{}:n[m];for(var m in n.access)g.access[m]=n.access[m];g.addInitializer=function(v){if(u)throw new TypeError("Cannot add initializers after decoration has completed");o.push(s(v||null))};var x=(0,r[p])(l==="accessor"?{get:h.get,set:h.set}:h[c],g);if(l==="accessor"){if(x===void 0)continue;if(x===null||typeof x!="object")throw new TypeError("Object expected");(f=s(x.get))&&(h.get=f),(f=s(x.set))&&(h.set=f),(f=s(x.init))&&i.unshift(f)}else(f=s(x))&&(l==="field"?i.unshift(f):h[c]=f)}d&&Object.defineProperty(d,n.name,h),u=!0}function kb(t,e,r){for(var n=arguments.length>2,i=0;i<e.length;i++)r=n?e[i].call(t,r):e[i].call(t);return n?r:void 0}function jb(t){return typeof t=="symbol"?t:"".concat(t)}function Cb(t,e,r){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(t,"name",{configurable:!0,value:r?"".concat(r," ",e):e})}function Eb(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Pe(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function l(h){try{d(n.next(h))}catch(f){s(f)}}function c(h){try{d(n.throw(h))}catch(f){s(f)}}function d(h){h.done?o(h.value):i(h.value).then(l,c)}d((n=n.apply(t,e||[])).next())})}function Tb(t,e){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return s.next=l(0),s.throw=l(1),s.return=l(2),typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function l(d){return function(h){return c([d,h])}}function c(d){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,d[0]&&(r=0)),r;)try{if(n=1,i&&(o=d[0]&2?i.return:d[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,d[1])).done)return o;switch(i=0,o&&(d=[d[0]&2,o.value]),d[0]){case 0:case 1:o=d;break;case 4:return r.label++,{value:d[1],done:!1};case 5:r.label++,i=d[1],d=[0];continue;case 7:d=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(d[0]===6||d[0]===2)){r=0;continue}if(d[0]===3&&(!o||d[1]>o[0]&&d[1]<o[3])){r.label=d[1];break}if(d[0]===6&&r.label<o[1]){r.label=o[1],o=d;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(d);break}o[2]&&r.ops.pop(),r.trys.pop();continue}d=e.call(t,r)}catch(h){d=[6,h],i=0}finally{n=o=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}var fd=Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]};function Rb(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&fd(e,t,r)}function Ac(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function rp(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,o=[],s;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)o.push(i.value)}catch(l){s={error:l}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(s)throw s.error}}return o}function Nb(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(rp(arguments[e]));return t}function Pb(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var o=arguments[e],s=0,l=o.length;s<l;s++,i++)n[i]=o[s];return n}function Ob(t,e,r){if(r||arguments.length===2)for(var n=0,i=e.length,o;n<i;n++)(o||!(n in e))&&(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return t.concat(o||Array.prototype.slice.call(e))}function us(t){return this instanceof us?(this.v=t,this):new us(t)}function Ab(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,o=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",s),i[Symbol.asyncIterator]=function(){return this},i;function s(p){return function(g){return Promise.resolve(g).then(p,f)}}function l(p,g){n[p]&&(i[p]=function(m){return new Promise(function(x,v){o.push([p,m,x,v])>1||c(p,m)})},g&&(i[p]=g(i[p])))}function c(p,g){try{d(n[p](g))}catch(m){u(o[0][3],m)}}function d(p){p.value instanceof us?Promise.resolve(p.value.v).then(h,f):u(o[0][2],p)}function h(p){c("next",p)}function f(p){c("throw",p)}function u(p,g){p(g),o.shift(),o.length&&c(o[0][0],o[0][1])}}function Mb(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,o){e[i]=t[i]?function(s){return(r=!r)?{value:us(t[i](s)),done:!1}:o?o(s):s}:o}}function $b(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Ac=="function"?Ac(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(o){r[o]=t[o]&&function(s){return new Promise(function(l,c){s=t[o](s),i(l,c,s.done,s.value)})}}function i(o,s,l,c){Promise.resolve(c).then(function(d){o({value:d,done:l})},s)}}function Ib(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}var IS=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e},$h=function(t){return $h=Object.getOwnPropertyNames||function(e){var r=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[r.length]=n);return r},$h(t)};function Lb(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r=$h(t),n=0;n<r.length;n++)r[n]!=="default"&&fd(e,t,r[n]);return IS(e,t),e}function Db(t){return t&&t.__esModule?t:{default:t}}function zb(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)}function Fb(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r}function Bb(t,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof t=="function"?e===t:t.has(e)}function Ub(t,e,r){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var n,i;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=e[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=e[Symbol.dispose],r&&(i=n)}if(typeof n!="function")throw new TypeError("Object not disposable.");i&&(n=function(){try{i.call(this)}catch(o){return Promise.reject(o)}}),t.stack.push({value:e,dispose:n,async:r})}else r&&t.stack.push({async:!0});return e}var LS=typeof SuppressedError=="function"?SuppressedError:function(t,e,r){var n=new Error(r);return n.name="SuppressedError",n.error=t,n.suppressed=e,n};function Hb(t){function e(o){t.error=t.hasError?new LS(o,t.error,"An error was suppressed during disposal."):o,t.hasError=!0}var r,n=0;function i(){for(;r=t.stack.pop();)try{if(!r.async&&n===1)return n=0,t.stack.push(r),Promise.resolve().then(i);if(r.dispose){var o=r.dispose.call(r.value);if(r.async)return n|=2,Promise.resolve(o).then(i,function(s){return e(s),i()})}else n|=1}catch(s){e(s)}if(n===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return i()}function Wb(t,e){return typeof t=="string"&&/^\.\.?\//.test(t)?t.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(r,n,i,o,s){return n?e?".jsx":".js":i&&(!o||!s)?r:i+o+"."+s.toLowerCase()+"js"}):t}const DS={__extends:bb,__assign:Oc,__rest:ms,__decorate:wb,__param:_b,__esDecorate:Sb,__runInitializers:kb,__propKey:jb,__setFunctionName:Cb,__metadata:Eb,__awaiter:Pe,__generator:Tb,__createBinding:fd,__exportStar:Rb,__values:Ac,__read:rp,__spread:Nb,__spreadArrays:Pb,__spreadArray:Ob,__await:us,__asyncGenerator:Ab,__asyncDelegator:Mb,__asyncValues:$b,__makeTemplateObject:Ib,__importStar:Lb,__importDefault:Db,__classPrivateFieldGet:zb,__classPrivateFieldSet:Fb,__classPrivateFieldIn:Bb,__addDisposableResource:Ub,__disposeResources:Hb,__rewriteRelativeImportExtension:Wb},zS=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:Ub,get __assign(){return Oc},__asyncDelegator:Mb,__asyncGenerator:Ab,__asyncValues:$b,__await:us,__awaiter:Pe,__classPrivateFieldGet:zb,__classPrivateFieldIn:Bb,__classPrivateFieldSet:Fb,__createBinding:fd,__decorate:wb,__disposeResources:Hb,__esDecorate:Sb,__exportStar:Rb,__extends:bb,__generator:Tb,__importDefault:Db,__importStar:Lb,__makeTemplateObject:Ib,__metadata:Eb,__param:_b,__propKey:jb,__read:rp,__rest:ms,__rewriteRelativeImportExtension:Wb,__runInitializers:kb,__setFunctionName:Cb,__spread:Nb,__spreadArray:Ob,__spreadArrays:Pb,__values:Ac,default:DS},Symbol.toStringTag,{value:"Module"})),FS=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class np extends Error{constructor(e,r="FunctionsError",n){super(e),this.name=r,this.context=n}}class _g extends np{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Sg extends np{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class kg extends np{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Ih;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Ih||(Ih={}));class BS{constructor(e,{headers:r={},customFetch:n,region:i=Ih.Any}={}){this.url=e,this.headers=r,this.region=i,this.fetch=FS(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return Pe(this,arguments,void 0,function*(r,n={}){var i;try{const{headers:o,method:s,body:l,signal:c}=n;let d={},{region:h}=n;h||(h=this.region);const f=new URL(`${this.url}/${r}`);h&&h!=="any"&&(d["x-region"]=h,f.searchParams.set("forceFunctionRegion",h));let u;l&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)?typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(d["Content-Type"]="application/octet-stream",u=l):typeof l=="string"?(d["Content-Type"]="text/plain",u=l):typeof FormData<"u"&&l instanceof FormData?u=l:(d["Content-Type"]="application/json",u=JSON.stringify(l)):u=l;const p=yield this.fetch(f.toString(),{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},d),this.headers),o),body:u,signal:c}).catch(v=>{throw v.name==="AbortError"?v:new _g(v)}),g=p.headers.get("x-relay-error");if(g&&g==="true")throw new Sg(p);if(!p.ok)throw new kg(p);let m=((i=p.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),x;return m==="application/json"?x=yield p.json():m==="application/octet-stream"||m==="application/pdf"?x=yield p.blob():m==="text/event-stream"?x=p:m==="multipart/form-data"?x=yield p.formData():x=yield p.text(),{data:x,error:null,response:p}}catch(o){return o instanceof Error&&o.name==="AbortError"?{data:null,error:new _g(o)}:{data:null,error:o,response:o instanceof kg||o instanceof Sg?o.context:void 0}}})}}var Yt={};const gs=c_(zS);var Nl={},Pl={},Ol={},Al={},Ml={},$l={},jg;function Gb(){if(jg)return $l;jg=1,Object.defineProperty($l,"__esModule",{value:!0});class t extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return $l.default=t,$l}var Cg;function Vb(){if(Cg)return Ml;Cg=1,Object.defineProperty(Ml,"__esModule",{value:!0});const e=gs.__importDefault(Gb());class r{constructor(i){var o,s;this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=new Headers(i.headers),this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=(o=i.shouldThrowOnError)!==null&&o!==void 0?o:!1,this.signal=i.signal,this.isMaybeSingle=(s=i.isMaybeSingle)!==null&&s!==void 0?s:!1,i.fetch?this.fetch=i.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,o){return this.headers=new Headers(this.headers),this.headers.set(i,o),this}then(i,o){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const s=this.fetch;let l=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var d,h,f,u;let p=null,g=null,m=null,x=c.status,v=c.statusText;if(c.ok){if(this.method!=="HEAD"){const k=await c.text();k===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((d=this.headers.get("Accept"))===null||d===void 0)&&d.includes("application/vnd.pgrst.plan+text"))?g=k:g=JSON.parse(k))}const b=(h=this.headers.get("Prefer"))===null||h===void 0?void 0:h.match(/count=(exact|planned|estimated)/),w=(f=c.headers.get("content-range"))===null||f===void 0?void 0:f.split("/");b&&w&&w.length>1&&(m=parseInt(w[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(g)&&(g.length>1?(p={code:"PGRST116",details:`Results contain ${g.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},g=null,m=null,x=406,v="Not Acceptable"):g.length===1?g=g[0]:g=null)}else{const b=await c.text();try{p=JSON.parse(b),Array.isArray(p)&&c.status===404&&(g=[],p=null,x=200,v="OK")}catch{c.status===404&&b===""?(x=204,v="No Content"):p={message:b}}if(p&&this.isMaybeSingle&&(!((u=p==null?void 0:p.details)===null||u===void 0)&&u.includes("0 rows"))&&(p=null,x=200,v="OK"),p&&this.shouldThrowOnError)throw new e.default(p)}return{error:p,data:g,count:m,status:x,statusText:v}});return this.shouldThrowOnError||(l=l.catch(c=>{var d,h,f;return{error:{message:`${(d=c==null?void 0:c.name)!==null&&d!==void 0?d:"FetchError"}: ${c==null?void 0:c.message}`,details:`${(h=c==null?void 0:c.stack)!==null&&h!==void 0?h:""}`,hint:"",code:`${(f=c==null?void 0:c.code)!==null&&f!==void 0?f:""}`},data:null,count:null,status:0,statusText:""}})),l.then(i,o)}returns(){return this}overrideTypes(){return this}}return Ml.default=r,Ml}var Eg;function qb(){if(Eg)return Al;Eg=1,Object.defineProperty(Al,"__esModule",{value:!0});const e=gs.__importDefault(Vb());class r extends e.default{select(i){let o=!1;const s=(i??"*").split("").map(l=>/\s/.test(l)&&!o?"":(l==='"'&&(o=!o),l)).join("");return this.url.searchParams.set("select",s),this.headers.append("Prefer","return=representation"),this}order(i,{ascending:o=!0,nullsFirst:s,foreignTable:l,referencedTable:c=l}={}){const d=c?`${c}.order`:"order",h=this.url.searchParams.get(d);return this.url.searchParams.set(d,`${h?`${h},`:""}${i}.${o?"asc":"desc"}${s===void 0?"":s?".nullsfirst":".nullslast"}`),this}limit(i,{foreignTable:o,referencedTable:s=o}={}){const l=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(l,`${i}`),this}range(i,o,{foreignTable:s,referencedTable:l=s}={}){const c=typeof l>"u"?"offset":`${l}.offset`,d=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${i}`),this.url.searchParams.set(d,`${o-i+1}`),this}abortSignal(i){return this.signal=i,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:i=!1,verbose:o=!1,settings:s=!1,buffers:l=!1,wal:c=!1,format:d="text"}={}){var h;const f=[i?"analyze":null,o?"verbose":null,s?"settings":null,l?"buffers":null,c?"wal":null].filter(Boolean).join("|"),u=(h=this.headers.get("Accept"))!==null&&h!==void 0?h:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${d}; for="${u}"; options=${f};`),d==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(i){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${i}`),this}}return Al.default=r,Al}var Tg;function ip(){if(Tg)return Ol;Tg=1,Object.defineProperty(Ol,"__esModule",{value:!0});const e=gs.__importDefault(qb()),r=new RegExp("[,()]");class n extends e.default{eq(o,s){return this.url.searchParams.append(o,`eq.${s}`),this}neq(o,s){return this.url.searchParams.append(o,`neq.${s}`),this}gt(o,s){return this.url.searchParams.append(o,`gt.${s}`),this}gte(o,s){return this.url.searchParams.append(o,`gte.${s}`),this}lt(o,s){return this.url.searchParams.append(o,`lt.${s}`),this}lte(o,s){return this.url.searchParams.append(o,`lte.${s}`),this}like(o,s){return this.url.searchParams.append(o,`like.${s}`),this}likeAllOf(o,s){return this.url.searchParams.append(o,`like(all).{${s.join(",")}}`),this}likeAnyOf(o,s){return this.url.searchParams.append(o,`like(any).{${s.join(",")}}`),this}ilike(o,s){return this.url.searchParams.append(o,`ilike.${s}`),this}ilikeAllOf(o,s){return this.url.searchParams.append(o,`ilike(all).{${s.join(",")}}`),this}ilikeAnyOf(o,s){return this.url.searchParams.append(o,`ilike(any).{${s.join(",")}}`),this}is(o,s){return this.url.searchParams.append(o,`is.${s}`),this}in(o,s){const l=Array.from(new Set(s)).map(c=>typeof c=="string"&&r.test(c)?`"${c}"`:`${c}`).join(",");return this.url.searchParams.append(o,`in.(${l})`),this}contains(o,s){return typeof s=="string"?this.url.searchParams.append(o,`cs.${s}`):Array.isArray(s)?this.url.searchParams.append(o,`cs.{${s.join(",")}}`):this.url.searchParams.append(o,`cs.${JSON.stringify(s)}`),this}containedBy(o,s){return typeof s=="string"?this.url.searchParams.append(o,`cd.${s}`):Array.isArray(s)?this.url.searchParams.append(o,`cd.{${s.join(",")}}`):this.url.searchParams.append(o,`cd.${JSON.stringify(s)}`),this}rangeGt(o,s){return this.url.searchParams.append(o,`sr.${s}`),this}rangeGte(o,s){return this.url.searchParams.append(o,`nxl.${s}`),this}rangeLt(o,s){return this.url.searchParams.append(o,`sl.${s}`),this}rangeLte(o,s){return this.url.searchParams.append(o,`nxr.${s}`),this}rangeAdjacent(o,s){return this.url.searchParams.append(o,`adj.${s}`),this}overlaps(o,s){return typeof s=="string"?this.url.searchParams.append(o,`ov.${s}`):this.url.searchParams.append(o,`ov.{${s.join(",")}}`),this}textSearch(o,s,{config:l,type:c}={}){let d="";c==="plain"?d="pl":c==="phrase"?d="ph":c==="websearch"&&(d="w");const h=l===void 0?"":`(${l})`;return this.url.searchParams.append(o,`${d}fts${h}.${s}`),this}match(o){return Object.entries(o).forEach(([s,l])=>{this.url.searchParams.append(s,`eq.${l}`)}),this}not(o,s,l){return this.url.searchParams.append(o,`not.${s}.${l}`),this}or(o,{foreignTable:s,referencedTable:l=s}={}){const c=l?`${l}.or`:"or";return this.url.searchParams.append(c,`(${o})`),this}filter(o,s,l){return this.url.searchParams.append(o,`${s}.${l}`),this}}return Ol.default=n,Ol}var Rg;function Kb(){if(Rg)return Pl;Rg=1,Object.defineProperty(Pl,"__esModule",{value:!0});const e=gs.__importDefault(ip());class r{constructor(i,{headers:o={},schema:s,fetch:l}){this.url=i,this.headers=new Headers(o),this.schema=s,this.fetch=l}select(i,o){const{head:s=!1,count:l}=o??{},c=s?"HEAD":"GET";let d=!1;const h=(i??"*").split("").map(f=>/\s/.test(f)&&!d?"":(f==='"'&&(d=!d),f)).join("");return this.url.searchParams.set("select",h),l&&this.headers.append("Prefer",`count=${l}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(i,{count:o,defaultToNull:s=!0}={}){var l;const c="POST";if(o&&this.headers.append("Prefer",`count=${o}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const d=i.reduce((h,f)=>h.concat(Object.keys(f)),[]);if(d.length>0){const h=[...new Set(d)].map(f=>`"${f}"`);this.url.searchParams.set("columns",h.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}upsert(i,{onConflict:o,ignoreDuplicates:s=!1,count:l,defaultToNull:c=!0}={}){var d;const h="POST";if(this.headers.append("Prefer",`resolution=${s?"ignore":"merge"}-duplicates`),o!==void 0&&this.url.searchParams.set("on_conflict",o),l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const f=i.reduce((u,p)=>u.concat(Object.keys(p)),[]);if(f.length>0){const u=[...new Set(f)].map(p=>`"${p}"`);this.url.searchParams.set("columns",u.join(","))}}return new e.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}update(i,{count:o}={}){var s;const l="PATCH";return o&&this.headers.append("Prefer",`count=${o}`),new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}delete({count:i}={}){var o;const s="DELETE";return i&&this.headers.append("Prefer",`count=${i}`),new e.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}}return Pl.default=r,Pl}var Ng;function US(){if(Ng)return Nl;Ng=1,Object.defineProperty(Nl,"__esModule",{value:!0});const t=gs,e=t.__importDefault(Kb()),r=t.__importDefault(ip());class n{constructor(o,{headers:s={},schema:l,fetch:c}={}){this.url=o,this.headers=new Headers(s),this.schemaName=l,this.fetch=c}from(o){const s=new URL(`${this.url}/${o}`);return new e.default(s,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(o){return new n(this.url,{headers:this.headers,schema:o,fetch:this.fetch})}rpc(o,s={},{head:l=!1,get:c=!1,count:d}={}){var h;let f;const u=new URL(`${this.url}/rpc/${o}`);let p;l||c?(f=l?"HEAD":"GET",Object.entries(s).filter(([m,x])=>x!==void 0).map(([m,x])=>[m,Array.isArray(x)?`{${x.join(",")}}`:`${x}`]).forEach(([m,x])=>{u.searchParams.append(m,x)})):(f="POST",p=s);const g=new Headers(this.headers);return d&&g.set("Prefer",`count=${d}`),new r.default({method:f,url:u,headers:g,schema:this.schemaName,body:p,fetch:(h=this.fetch)!==null&&h!==void 0?h:fetch})}}return Nl.default=n,Nl}Object.defineProperty(Yt,"__esModule",{value:!0});var Yb=Yt.PostgrestError=ow=Yt.PostgrestBuilder=nw=Yt.PostgrestTransformBuilder=tw=Yt.PostgrestFilterBuilder=Qb=Yt.PostgrestQueryBuilder=Zb=Yt.PostgrestClient=void 0;const vs=gs,Xb=vs.__importDefault(US());var Zb=Yt.PostgrestClient=Xb.default;const Jb=vs.__importDefault(Kb());var Qb=Yt.PostgrestQueryBuilder=Jb.default;const ew=vs.__importDefault(ip());var tw=Yt.PostgrestFilterBuilder=ew.default;const rw=vs.__importDefault(qb());var nw=Yt.PostgrestTransformBuilder=rw.default;const iw=vs.__importDefault(Vb());var ow=Yt.PostgrestBuilder=iw.default;const sw=vs.__importDefault(Gb());Yb=Yt.PostgrestError=sw.default;var aw=Yt.default={PostgrestClient:Xb.default,PostgrestQueryBuilder:Jb.default,PostgrestFilterBuilder:ew.default,PostgrestTransformBuilder:rw.default,PostgrestBuilder:iw.default,PostgrestError:sw.default};const HS=l_({__proto__:null,get PostgrestBuilder(){return ow},get PostgrestClient(){return Zb},get PostgrestError(){return Yb},get PostgrestFilterBuilder(){return tw},get PostgrestQueryBuilder(){return Qb},get PostgrestTransformBuilder(){return nw},default:aw},[Yt]),{PostgrestClient:WS,PostgrestQueryBuilder:yU,PostgrestFilterBuilder:xU,PostgrestTransformBuilder:bU,PostgrestBuilder:wU,PostgrestError:_U}=aw||HS;class GS{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,i=parseInt(n.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let r=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(r+=`

Suggested solution: ${e.workaround}`),new Error(r)}static createWebSocket(e,r){const n=this.getWebSocketConstructor();return new n(e,r)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const VS="2.79.0",qS=`realtime-js/${VS}`,KS="1.0.0",Lh=1e4,YS=1e3,XS=100;var ua;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(ua||(ua={}));var Rt;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(Rt||(Rt={}));var Fr;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Fr||(Fr={}));var Dh;(function(t){t.websocket="websocket"})(Dh||(Dh={}));var Ti;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Ti||(Ti={}));class ZS{constructor(){this.HEADER_LENGTH=1}decode(e,r){return e.constructor===ArrayBuffer?r(this._binaryDecode(e)):r(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const r=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,r,n)}_decodeBroadcast(e,r,n){const i=r.getUint8(1),o=r.getUint8(2);let s=this.HEADER_LENGTH+2;const l=n.decode(e.slice(s,s+i));s=s+i;const c=n.decode(e.slice(s,s+o));s=s+o;const d=JSON.parse(n.decode(e.slice(s,e.byteLength)));return{ref:null,topic:l,event:c,payload:d}}}class lw{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var rt;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(rt||(rt={}));const Pg=(t,e,r={})=>{var n;const i=(n=r.skipTypes)!==null&&n!==void 0?n:[];return e?Object.keys(e).reduce((o,s)=>(o[s]=JS(s,t,e,i),o),{}):{}},JS=(t,e,r,n)=>{const i=e.find(l=>l.name===t),o=i==null?void 0:i.type,s=r[t];return o&&!n.includes(o)?cw(o,s):zh(s)},cw=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return rk(e,r)}switch(t){case rt.bool:return QS(e);case rt.float4:case rt.float8:case rt.int2:case rt.int4:case rt.int8:case rt.numeric:case rt.oid:return ek(e);case rt.json:case rt.jsonb:return tk(e);case rt.timestamp:return nk(e);case rt.abstime:case rt.date:case rt.daterange:case rt.int4range:case rt.int8range:case rt.money:case rt.reltime:case rt.text:case rt.time:case rt.timestamptz:case rt.timetz:case rt.tsrange:case rt.tstzrange:return zh(e);default:return zh(e)}},zh=t=>t,QS=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},ek=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},tk=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},rk=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,n=t[r];if(t[0]==="{"&&n==="}"){let o;const s=t.slice(1,r);try{o=JSON.parse("["+s+"]")}catch{o=s?s.split(","):[]}return o.map(l=>cw(e,l))}return t},nk=t=>typeof t=="string"?t.replace(" ","T"):t,dw=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class cu{constructor(e,r,n={},i=Lh){this.channel=e,this.event=r,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var n;return this._hasReceived(e)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Og;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Og||(Og={}));class ha{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:o,onLeave:s,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ha.syncState(this.state,i,o,s),this.pendingDiffs.forEach(c=>{this.state=ha.syncDiff(this.state,c,o,s)}),this.pendingDiffs=[],l()}),this.channel._on(n.diff,{},i=>{const{onJoin:o,onLeave:s,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=ha.syncDiff(this.state,i,o,s),l())}),this.onJoin((i,o,s)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:o,newPresences:s})}),this.onLeave((i,o,s)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:o,leftPresences:s})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,n,i){const o=this.cloneDeep(e),s=this.transformState(r),l={},c={};return this.map(o,(d,h)=>{s[d]||(c[d]=h)}),this.map(s,(d,h)=>{const f=o[d];if(f){const u=h.map(x=>x.presence_ref),p=f.map(x=>x.presence_ref),g=h.filter(x=>p.indexOf(x.presence_ref)<0),m=f.filter(x=>u.indexOf(x.presence_ref)<0);g.length>0&&(l[d]=g),m.length>0&&(c[d]=m)}else l[d]=h}),this.syncDiff(o,{joins:l,leaves:c},n,i)}static syncDiff(e,r,n,i){const{joins:o,leaves:s}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(o,(l,c)=>{var d;const h=(d=e[l])!==null&&d!==void 0?d:[];if(e[l]=this.cloneDeep(c),h.length>0){const f=e[l].map(p=>p.presence_ref),u=h.filter(p=>f.indexOf(p.presence_ref)<0);e[l].unshift(...u)}n(l,h,c)}),this.map(s,(l,c)=>{let d=e[l];if(!d)return;const h=c.map(f=>f.presence_ref);d=d.filter(f=>h.indexOf(f.presence_ref)<0),e[l]=d,i(l,d,c),d.length===0&&delete e[l]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(n=>r(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,n)=>{const i=e[n];return"metas"in i?r[n]=i.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):r[n]=i,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Ag;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Ag||(Ag={}));var fa;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(fa||(fa={}));var fn;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(fn||(fn={}));class op{constructor(e,r={config:{}},n){var i,o;if(this.topic=e,this.params=r,this.socket=n,this.bindings={},this.state=Rt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new cu(this,Fr.join,this.params,this.timeout),this.rejoinTimer=new lw(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Rt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Rt.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=Rt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Rt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=Rt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Fr.reply,{},(s,l)=>{this._trigger(this._replyEventName(l),s)}),this.presence=new ha(this),this.broadcastEndpointURL=dw(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((o=(i=this.params.config)===null||i===void 0?void 0:i.broadcast)===null||o===void 0)&&o.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,r=this.timeout){var n,i,o;if(this.socket.isConnected()||this.socket.connect(),this.state==Rt.closed){const{config:{broadcast:s,presence:l,private:c}}=this.params,d=(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(p=>p.filter))!==null&&i!==void 0?i:[],h=!!this.bindings[fa.PRESENCE]&&this.bindings[fa.PRESENCE].length>0||((o=this.params.config.presence)===null||o===void 0?void 0:o.enabled)===!0,f={},u={broadcast:s,presence:Object.assign(Object.assign({},l),{enabled:h}),postgres_changes:d,private:c};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(p=>e==null?void 0:e(fn.CHANNEL_ERROR,p)),this._onClose(()=>e==null?void 0:e(fn.CLOSED)),this.updateJoinPayload(Object.assign({config:u},f)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:p})=>{var g;if(this.socket.setAuth(),p===void 0){e==null||e(fn.SUBSCRIBED);return}else{const m=this.bindings.postgres_changes,x=(g=m==null?void 0:m.length)!==null&&g!==void 0?g:0,v=[];for(let y=0;y<x;y++){const b=m[y],{filter:{event:w,schema:k,table:S,filter:C}}=b,T=p&&p[y];if(T&&T.event===w&&T.schema===k&&T.table===S&&T.filter===C)v.push(Object.assign(Object.assign({},b),{id:T.id}));else{this.unsubscribe(),this.state=Rt.errored,e==null||e(fn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=v,e&&e(fn.SUBSCRIBED);return}}).receive("error",p=>{this.state=Rt.errored,e==null||e(fn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(fn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,n){return this.state===Rt.joined&&e===fa.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,r,n)}async httpSend(e,r,n={}){var i;const o=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(r==null)return Promise.reject("Payload is required for httpSend()");const s={method:"POST",headers:{Authorization:o,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:r,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,s,(i=n.timeout)!==null&&i!==void 0?i:this.timeout);if(l.status===202)return{success:!0};let c=l.statusText;try{const d=await l.json();c=d.error||d.message||c}catch{}return Promise.reject(new Error(c))}async send(e,r={}){var n,i;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:o,payload:s}=e,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:s,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=d.body)===null||i===void 0?void 0:i.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var s,l,c;const d=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(l=(s=this.params)===null||s===void 0?void 0:s.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&o("ok"),d.receive("ok",()=>o("ok")),d.receive("error",()=>o("error")),d.receive("timeout",()=>o("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Rt.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Fr.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(i=>{n=new cu(this,Fr.leave,{},e),n.receive("ok",()=>{r(),i("ok")}).receive("timeout",()=>{r(),i("timed out")}).receive("error",()=>{i("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Rt.closed,this.bindings={}}async _fetchWithTimeout(e,r,n){const i=new AbortController,o=setTimeout(()=>i.abort(),n),s=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:i.signal}));return clearTimeout(o),s}_push(e,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new cu(this,e,r,n);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>XS){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(e,r,n){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,n){var i,o;const s=e.toLocaleLowerCase(),{close:l,error:c,leave:d,join:h}=Fr;if(n&&[l,c,d,h].indexOf(s)>=0&&n!==this._joinRef())return;let u=this._onMessage(s,r,n);if(r&&!u)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(s)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(p=>{var g,m,x;return((g=p.filter)===null||g===void 0?void 0:g.event)==="*"||((x=(m=p.filter)===null||m===void 0?void 0:m.event)===null||x===void 0?void 0:x.toLocaleLowerCase())===s}).map(p=>p.callback(u,n)):(o=this.bindings[s])===null||o===void 0||o.filter(p=>{var g,m,x,v,y,b;if(["broadcast","presence","postgres_changes"].includes(s))if("id"in p){const w=p.id,k=(g=p.filter)===null||g===void 0?void 0:g.event;return w&&((m=r.ids)===null||m===void 0?void 0:m.includes(w))&&(k==="*"||(k==null?void 0:k.toLocaleLowerCase())===((x=r.data)===null||x===void 0?void 0:x.type.toLocaleLowerCase()))}else{const w=(y=(v=p==null?void 0:p.filter)===null||v===void 0?void 0:v.event)===null||y===void 0?void 0:y.toLocaleLowerCase();return w==="*"||w===((b=r==null?void 0:r.event)===null||b===void 0?void 0:b.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===s}).map(p=>{if(typeof u=="object"&&"ids"in u){const g=u.data,{schema:m,table:x,commit_timestamp:v,type:y,errors:b}=g;u=Object.assign(Object.assign({},{schema:m,table:x,commit_timestamp:v,eventType:y,new:{},old:{},errors:b}),this._getPayloadRecords(g))}p.callback(u,n)})}_isClosed(){return this.state===Rt.closed}_isJoined(){return this.state===Rt.joined}_isJoining(){return this.state===Rt.joining}_isLeaving(){return this.state===Rt.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,n){const i=e.toLocaleLowerCase(),o={type:i,filter:r,callback:n};return this.bindings[i]?this.bindings[i].push(o):this.bindings[i]=[o],this}_off(e,r){const n=e.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(i=>{var o;return!(((o=i.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===n&&op.isEqual(i.filter,r))})),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const n in e)if(e[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Fr.close,{},e)}_onError(e){this._on(Fr.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Rt.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=Pg(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=Pg(e.columns,e.old_record)),r}}const du=()=>{},Il={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},ik=[1e3,2e3,5e3,1e4],ok=1e4,sk=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class ak{constructor(e,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Lh,this.transport=null,this.heartbeatIntervalMs=Il.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=du,this.ref=0,this.reconnectTimer=null,this.logger=du,this.conn=null,this.sendBuffer=[],this.serializer=new ZS,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=i=>i?(...o)=>i(...o):(...o)=>fetch(...o),!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${e}/${Dh.websocket}`,this.httpEndpoint=dw(e),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=GS.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const r=e.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:KS}))}disconnect(e,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},e?this.conn.close(e,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,n){this.logger(e,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case ua.connecting:return Ti.Connecting;case ua.open:return Ti.Open;case ua.closing:return Ti.Closing;default:return Ti.Closed}}isConnected(){return this.connectionState()===Ti.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,r={config:{}}){const n=`realtime:${e}`,i=this.getChannels().find(o=>o.topic===n);if(i)return i;{const o=new op(`realtime:${e}`,r,this);return this.channels.push(o),o}}push(e){const{topic:r,event:n,payload:i,ref:o}=e,s=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${n} (${o})`,i),this.isConnected()?s():this.sendBuffer.push(s)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(YS,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Il.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:i,payload:o,ref:s}=r,l=s?`(${s})`:"",c=o.status||"";this.log("receive",`${c} ${n} ${i} ${l}`.trim(),o),this.channels.filter(d=>d._isMember(n)).forEach(d=>d._trigger(i,o,s)),this._triggerStateCallbacks("message",r)})}_clearTimer(e){var r;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var r;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Fr.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const n=e.match(/\?/)?"&":"?",i=new URLSearchParams(r);return`${e}${n}${i}`}_workerObjectUrl(e){let r;if(e)r=e;else{const n=new Blob([sk],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(e,r=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(e=null){let r;e?r=e:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const i={access_token:r,version:qS};r&&n.updateJoinPayload(i),n.joinedOnce&&n._isJoined()&&n._push(Fr.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${e}`,r)})}_triggerStateCallbacks(e,r){try{this.stateChangeCallbacks[e].forEach(n=>{try{n(r)}catch(i){this.log("error",`error in ${e} callback`,i)}})}catch(n){this.log("error",`error triggering ${e} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new lw(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Il.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var r,n,i,o,s,l,c,d,h;if(this.transport=(r=e==null?void 0:e.transport)!==null&&r!==void 0?r:null,this.timeout=(n=e==null?void 0:e.timeout)!==null&&n!==void 0?n:Lh,this.heartbeatIntervalMs=(i=e==null?void 0:e.heartbeatIntervalMs)!==null&&i!==void 0?i:Il.HEARTBEAT_INTERVAL,this.worker=(o=e==null?void 0:e.worker)!==null&&o!==void 0?o:!1,this.accessToken=(s=e==null?void 0:e.accessToken)!==null&&s!==void 0?s:null,this.heartbeatCallback=(l=e==null?void 0:e.heartbeatCallback)!==null&&l!==void 0?l:du,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=e==null?void 0:e.reconnectAfterMs)!==null&&c!==void 0?c:f=>ik[f-1]||ok,this.encode=(d=e==null?void 0:e.encode)!==null&&d!==void 0?d:(f,u)=>u(JSON.stringify(f)),this.decode=(h=e==null?void 0:e.decode)!==null&&h!==void 0?h:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class sp extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function mt(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class lk extends sp{constructor(e,r,n){super(e),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Fh extends sp{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}}const ap=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),ck=()=>Response,Bh=t=>{if(Array.isArray(t))return t.map(r=>Bh(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,n])=>{const i=r.replace(/([-_][a-z])/gi,o=>o.toUpperCase().replace(/[-_]/g,""));e[i]=Bh(n)}),e},dk=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},uu=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},uk=(t,e,r)=>Pe(void 0,void 0,void 0,function*(){const n=yield ck();t instanceof n&&!(r!=null&&r.noResolveJson)?t.json().then(i=>{const o=t.status||500,s=(i==null?void 0:i.statusCode)||o+"";e(new lk(uu(i),o,s))}).catch(i=>{e(new Fh(uu(i),i))}):e(new Fh(uu(t),t))}),hk=(t,e,r,n)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!n?i:(dk(n)?(i.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),i.body=JSON.stringify(n)):i.body=n,e!=null&&e.duplex&&(i.duplex=e.duplex),Object.assign(Object.assign({},i),r))};function Ha(t,e,r,n,i,o){return Pe(this,void 0,void 0,function*(){return new Promise((s,l)=>{t(r,hk(e,n,i,o)).then(c=>{if(!c.ok)throw c;return n!=null&&n.noResolveJson?c:c.json()}).then(c=>s(c)).catch(c=>uk(c,l,n))})})}function Oa(t,e,r,n){return Pe(this,void 0,void 0,function*(){return Ha(t,"GET",e,r,n)})}function Dr(t,e,r,n,i){return Pe(this,void 0,void 0,function*(){return Ha(t,"POST",e,n,i,r)})}function Uh(t,e,r,n,i){return Pe(this,void 0,void 0,function*(){return Ha(t,"PUT",e,n,i,r)})}function fk(t,e,r,n){return Pe(this,void 0,void 0,function*(){return Ha(t,"HEAD",e,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function lp(t,e,r,n,i){return Pe(this,void 0,void 0,function*(){return Ha(t,"DELETE",e,n,i,r)})}class pk{constructor(e,r){this.downloadFn=e,this.shouldThrowOnError=r}then(e,r){return this.execute().then(e,r)}execute(){return Pe(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(mt(e))return{data:null,error:e};throw e}})}}var uw;class mk{constructor(e,r){this.downloadFn=e,this.shouldThrowOnError=r,this[uw]="BlobDownloadBuilder",this.promise=null}asStream(){return new pk(this.downloadFn,this.shouldThrowOnError)}then(e,r){return this.getPromise().then(e,r)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return Pe(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(mt(e))return{data:null,error:e};throw e}})}}uw=Symbol.toStringTag;const gk={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Mg={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class vk{constructor(e,r={},n,i){this.shouldThrowOnError=!1,this.url=e,this.headers=r,this.bucketId=n,this.fetch=ap(i)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,r,n,i){return Pe(this,void 0,void 0,function*(){try{let o;const s=Object.assign(Object.assign({},Mg),i);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(s.upsert)});const c=s.metadata;typeof Blob<"u"&&n instanceof Blob?(o=new FormData,o.append("cacheControl",s.cacheControl),c&&o.append("metadata",this.encodeMetadata(c)),o.append("",n)):typeof FormData<"u"&&n instanceof FormData?(o=n,o.has("cacheControl")||o.append("cacheControl",s.cacheControl),c&&!o.has("metadata")&&o.append("metadata",this.encodeMetadata(c))):(o=n,l["cache-control"]=`max-age=${s.cacheControl}`,l["content-type"]=s.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c))),(typeof ReadableStream<"u"&&o instanceof ReadableStream||o&&typeof o=="object"&&"pipe"in o&&typeof o.pipe=="function")&&!s.duplex&&(s.duplex="half")),i!=null&&i.headers&&(l=Object.assign(Object.assign({},l),i.headers));const d=this._removeEmptyFolders(r),h=this._getFinalPath(d),f=yield(e=="PUT"?Uh:Dr)(this.fetch,`${this.url}/object/${h}`,o,Object.assign({headers:l},s!=null&&s.duplex?{duplex:s.duplex}:{}));return{data:{path:d,id:f.Id,fullPath:f.Key},error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(mt(o))return{data:null,error:o};throw o}})}upload(e,r,n){return Pe(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,r,n)})}uploadToSignedUrl(e,r,n,i){return Pe(this,void 0,void 0,function*(){const o=this._removeEmptyFolders(e),s=this._getFinalPath(o),l=new URL(this.url+`/object/upload/sign/${s}`);l.searchParams.set("token",r);try{let c;const d=Object.assign({upsert:Mg.upsert},i),h=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",n)):typeof FormData<"u"&&n instanceof FormData?(c=n,c.append("cacheControl",d.cacheControl)):(c=n,h["cache-control"]=`max-age=${d.cacheControl}`,h["content-type"]=d.contentType);const f=yield Uh(this.fetch,l.toString(),c,{headers:h});return{data:{path:o,fullPath:f.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(mt(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,r){return Pe(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const i=Object.assign({},this.headers);r!=null&&r.upsert&&(i["x-upsert"]="true");const o=yield Dr(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:i}),s=new URL(this.url+o.url),l=s.searchParams.get("token");if(!l)throw new sp("No token returned by API");return{data:{signedUrl:s.toString(),path:e,token:l},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(mt(n))return{data:null,error:n};throw n}})}update(e,r,n){return Pe(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,r,n)})}move(e,r,n){return Pe(this,void 0,void 0,function*(){try{return{data:yield Dr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(mt(i))return{data:null,error:i};throw i}})}copy(e,r,n){return Pe(this,void 0,void 0,function*(){try{return{data:{path:(yield Dr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(mt(i))return{data:null,error:i};throw i}})}createSignedUrl(e,r,n){return Pe(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),o=yield Dr(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return o={signedUrl:encodeURI(`${this.url}${o.signedURL}${s}`)},{data:o,error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(mt(i))return{data:null,error:i};throw i}})}createSignedUrls(e,r,n){return Pe(this,void 0,void 0,function*(){try{const i=yield Dr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:i.map(s=>Object.assign(Object.assign({},s),{signedUrl:s.signedURL?encodeURI(`${this.url}${s.signedURL}${o}`):null})),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(mt(i))return{data:null,error:i};throw i}})}download(e,r){const i=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",o=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),s=o?`?${o}`:"",l=this._getFinalPath(e),c=()=>Oa(this.fetch,`${this.url}/${i}/${l}${s}`,{headers:this.headers,noResolveJson:!0});return new mk(c,this.shouldThrowOnError)}info(e){return Pe(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{const n=yield Oa(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Bh(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(mt(n))return{data:null,error:n};throw n}})}exists(e){return Pe(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{return yield fk(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(mt(n)&&n instanceof Fh){const i=n.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,r){const n=this._getFinalPath(e),i=[],o=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";o!==""&&i.push(o);const l=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});c!==""&&i.push(c);let d=i.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${n}${d}`)}}}remove(e){return Pe(this,void 0,void 0,function*(){try{return{data:yield lp(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(mt(r))return{data:null,error:r};throw r}})}list(e,r,n){return Pe(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},gk),r),{prefix:e||""});return{data:yield Dr(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},n),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(mt(i))return{data:null,error:i};throw i}})}listV2(e,r){return Pe(this,void 0,void 0,function*(){try{const n=Object.assign({},e);return{data:yield Dr(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(mt(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}}const hw="2.79.0",fw={"X-Client-Info":`storage-js/${hw}`};class yk{constructor(e,r={},n,i){this.shouldThrowOnError=!1;const o=new URL(e);i!=null&&i.useNewHostname&&/supabase\.(co|in|red)$/.test(o.hostname)&&!o.hostname.includes("storage.supabase.")&&(o.hostname=o.hostname.replace("supabase.","storage.supabase.")),this.url=o.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},fw),r),this.fetch=ap(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(e){return Pe(this,void 0,void 0,function*(){try{const r=this.listBucketOptionsToQueryString(e);return{data:yield Oa(this.fetch,`${this.url}/bucket${r}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(mt(r))return{data:null,error:r};throw r}})}getBucket(e){return Pe(this,void 0,void 0,function*(){try{return{data:yield Oa(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(mt(r))return{data:null,error:r};throw r}})}createBucket(e){return Pe(this,arguments,void 0,function*(r,n={public:!1}){try{return{data:yield Dr(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(mt(i))return{data:null,error:i};throw i}})}updateBucket(e,r){return Pe(this,void 0,void 0,function*(){try{return{data:yield Uh(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(mt(n))return{data:null,error:n};throw n}})}emptyBucket(e){return Pe(this,void 0,void 0,function*(){try{return{data:yield Dr(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(mt(r))return{data:null,error:r};throw r}})}deleteBucket(e){return Pe(this,void 0,void 0,function*(){try{return{data:yield lp(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(mt(r))return{data:null,error:r};throw r}})}listBucketOptionsToQueryString(e){const r={};return e&&("limit"in e&&(r.limit=String(e.limit)),"offset"in e&&(r.offset=String(e.offset)),e.search&&(r.search=e.search),e.sortColumn&&(r.sortColumn=e.sortColumn),e.sortOrder&&(r.sortOrder=e.sortOrder)),Object.keys(r).length>0?"?"+new URLSearchParams(r).toString():""}}class xk{constructor(e,r={},n){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},fw),r),this.fetch=ap(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return Pe(this,void 0,void 0,function*(){try{return{data:yield Dr(this.fetch,`${this.url}/bucket`,{name:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(mt(r))return{data:null,error:r};throw r}})}listBuckets(e){return Pe(this,void 0,void 0,function*(){try{const r=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&r.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&r.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&r.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&r.set("sortOrder",e.sortOrder),e!=null&&e.search&&r.set("search",e.search);const n=r.toString(),i=n?`${this.url}/bucket?${n}`:`${this.url}/bucket`;return{data:yield Oa(this.fetch,i,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(mt(r))return{data:null,error:r};throw r}})}deleteBucket(e){return Pe(this,void 0,void 0,function*(){try{return{data:yield lp(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(mt(r))return{data:null,error:r};throw r}})}}const cp={"X-Client-Info":`storage-js/${hw}`,"Content-Type":"application/json"};class pw extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function hr(t){return typeof t=="object"&&t!==null&&"__isStorageVectorsError"in t}class hu extends pw{constructor(e,r,n){super(e),this.name="StorageVectorsApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class bk extends pw{constructor(e,r){super(e),this.name="StorageVectorsUnknownError",this.originalError=r}}var $g;(function(t){t.InternalError="InternalError",t.S3VectorConflictException="S3VectorConflictException",t.S3VectorNotFoundException="S3VectorNotFoundException",t.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",t.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",t.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})($g||($g={}));const dp=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),wk=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Ig=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),_k=(t,e,r)=>Pe(void 0,void 0,void 0,function*(){if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!(r!=null&&r.noResolveJson)){const i=t.status||500,o=t;if(typeof o.json=="function")o.json().then(s=>{const l=(s==null?void 0:s.statusCode)||(s==null?void 0:s.code)||i+"";e(new hu(Ig(s),i,l))}).catch(()=>{const s=i+"",l=o.statusText||`HTTP ${i} error`;e(new hu(l,i,s))});else{const s=i+"",l=o.statusText||`HTTP ${i} error`;e(new hu(l,i,s))}}else e(new bk(Ig(t),t))}),Sk=(t,e,r,n)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return n?(wk(n)?(i.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),i.body=JSON.stringify(n)):i.body=n,Object.assign(Object.assign({},i),r)):i};function kk(t,e,r,n,i,o){return Pe(this,void 0,void 0,function*(){return new Promise((s,l)=>{t(r,Sk(e,n,i,o)).then(c=>{if(!c.ok)throw c;if(n!=null&&n.noResolveJson)return c;const d=c.headers.get("content-type");return!d||!d.includes("application/json")?{}:c.json()}).then(c=>s(c)).catch(c=>_k(c,l,n))})})}function fr(t,e,r,n,i){return Pe(this,void 0,void 0,function*(){return kk(t,"POST",e,n,i,r)})}class jk{constructor(e,r={},n){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},cp),r),this.fetch=dp(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(e){return Pe(this,void 0,void 0,function*(){try{return{data:(yield fr(this.fetch,`${this.url}/CreateIndex`,e,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(hr(r))return{data:null,error:r};throw r}})}getIndex(e,r){return Pe(this,void 0,void 0,function*(){try{return{data:yield fr(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:e,indexName:r},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(hr(n))return{data:null,error:n};throw n}})}listIndexes(e){return Pe(this,void 0,void 0,function*(){try{return{data:yield fr(this.fetch,`${this.url}/ListIndexes`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(hr(r))return{data:null,error:r};throw r}})}deleteIndex(e,r){return Pe(this,void 0,void 0,function*(){try{return{data:(yield fr(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:e,indexName:r},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(hr(n))return{data:null,error:n};throw n}})}}class Ck{constructor(e,r={},n){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},cp),r),this.fetch=dp(n)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(e){return Pe(this,void 0,void 0,function*(){try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield fr(this.fetch,`${this.url}/PutVectors`,e,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(hr(r))return{data:null,error:r};throw r}})}getVectors(e){return Pe(this,void 0,void 0,function*(){try{return{data:yield fr(this.fetch,`${this.url}/GetVectors`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(hr(r))return{data:null,error:r};throw r}})}listVectors(e){return Pe(this,void 0,void 0,function*(){try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:yield fr(this.fetch,`${this.url}/ListVectors`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(hr(r))return{data:null,error:r};throw r}})}queryVectors(e){return Pe(this,void 0,void 0,function*(){try{return{data:yield fr(this.fetch,`${this.url}/QueryVectors`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(hr(r))return{data:null,error:r};throw r}})}deleteVectors(e){return Pe(this,void 0,void 0,function*(){try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield fr(this.fetch,`${this.url}/DeleteVectors`,e,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(hr(r))return{data:null,error:r};throw r}})}}class Ek{constructor(e,r={},n){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},cp),r),this.fetch=dp(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return Pe(this,void 0,void 0,function*(){try{return{data:(yield fr(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(hr(r))return{data:null,error:r};throw r}})}getBucket(e){return Pe(this,void 0,void 0,function*(){try{return{data:yield fr(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(hr(r))return{data:null,error:r};throw r}})}listBuckets(){return Pe(this,arguments,void 0,function*(e={}){try{return{data:yield fr(this.fetch,`${this.url}/ListVectorBuckets`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(hr(r))return{data:null,error:r};throw r}})}deleteBucket(e){return Pe(this,void 0,void 0,function*(){try{return{data:(yield fr(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(hr(r))return{data:null,error:r};throw r}})}}class Tk extends Ek{constructor(e,r={}){super(e,r.headers||{},r.fetch)}from(e){return new Rk(this.url,this.headers,e,this.fetch)}}class Rk extends jk{constructor(e,r,n,i){super(e,r,i),this.vectorBucketName=n}createIndex(e){const r=Object.create(null,{createIndex:{get:()=>super.createIndex}});return Pe(this,void 0,void 0,function*(){return r.createIndex.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const e=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return Pe(this,arguments,void 0,function*(r={}){return e.listIndexes.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName}))})}getIndex(e){const r=Object.create(null,{getIndex:{get:()=>super.getIndex}});return Pe(this,void 0,void 0,function*(){return r.getIndex.call(this,this.vectorBucketName,e)})}deleteIndex(e){const r=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return Pe(this,void 0,void 0,function*(){return r.deleteIndex.call(this,this.vectorBucketName,e)})}index(e){return new Nk(this.url,this.headers,this.vectorBucketName,e,this.fetch)}}class Nk extends Ck{constructor(e,r,n,i,o){super(e,r,o),this.vectorBucketName=n,this.indexName=i}putVectors(e){const r=Object.create(null,{putVectors:{get:()=>super.putVectors}});return Pe(this,void 0,void 0,function*(){return r.putVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(e){const r=Object.create(null,{getVectors:{get:()=>super.getVectors}});return Pe(this,void 0,void 0,function*(){return r.getVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const e=Object.create(null,{listVectors:{get:()=>super.listVectors}});return Pe(this,arguments,void 0,function*(r={}){return e.listVectors.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(e){const r=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return Pe(this,void 0,void 0,function*(){return r.queryVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(e){const r=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return Pe(this,void 0,void 0,function*(){return r.deleteVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class Pk extends yk{constructor(e,r={},n,i){super(e,r,n,i)}from(e){return new vk(this.url,this.headers,e,this.fetch)}get vectors(){return new Tk(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new xk(this.url+"/iceberg",this.headers,this.fetch)}}const Ok="2.79.0";let Js="";typeof Deno<"u"?Js="deno":typeof document<"u"?Js="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Js="react-native":Js="node";const Ak={"X-Client-Info":`supabase-js-${Js}/${Ok}`},Mk={headers:Ak},$k={schema:"public"},Ik={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Lk={},Dk=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),zk=()=>Headers,Fk=(t,e,r)=>{const n=Dk(r),i=zk();return async(o,s)=>{var l;const c=(l=await e())!==null&&l!==void 0?l:t;let d=new i(s==null?void 0:s.headers);return d.has("apikey")||d.set("apikey",t),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),n(o,Object.assign(Object.assign({},s),{headers:d}))}};function Bk(t){return t.endsWith("/")?t:t+"/"}function Uk(t,e){var r,n;const{db:i,auth:o,realtime:s,global:l}=t,{db:c,auth:d,realtime:h,global:f}=e,u={db:Object.assign(Object.assign({},c),i),auth:Object.assign(Object.assign({},d),o),realtime:Object.assign(Object.assign({},h),s),storage:{},global:Object.assign(Object.assign(Object.assign({},f),l),{headers:Object.assign(Object.assign({},(r=f==null?void 0:f.headers)!==null&&r!==void 0?r:{}),(n=l==null?void 0:l.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return t.accessToken?u.accessToken=t.accessToken:delete u.accessToken,u}function Hk(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Bk(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const mw="2.79.0",xo=30*1e3,Hh=3,fu=Hh*xo,Wk="http://localhost:9999",Gk="supabase.auth.token",Vk={"X-Client-Info":`gotrue-js/${mw}`},Wh="X-Supabase-Api-Version",gw={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},qk=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Kk=10*60*1e3;class Aa extends Error{constructor(e,r,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Me(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class Yk extends Aa{constructor(e,r,n){super(e,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function Xk(t){return Me(t)&&t.name==="AuthApiError"}class Ri extends Aa{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class ci extends Aa{constructor(e,r,n,i){super(e,n,i),this.name=r,this.status=n}}class Mr extends ci{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Zk(t){return Me(t)&&t.name==="AuthSessionMissingError"}class ho extends ci{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Ll extends ci{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Dl extends ci{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Jk(t){return Me(t)&&t.name==="AuthImplicitGrantRedirectError"}class Lg extends ci{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Gh extends ci{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function pu(t){return Me(t)&&t.name==="AuthRetryableFetchError"}class Dg extends ci{constructor(e,r,n){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Vh extends ci{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Mc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),zg=` 	
\r=`.split(""),Qk=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<zg.length;e+=1)t[zg[e].charCodeAt(0)]=-2;for(let e=0;e<Mc.length;e+=1)t[Mc[e].charCodeAt(0)]=e;return t})();function Fg(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(Mc[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(Mc[n]),e.queuedBits-=6}}function vw(t,e,r){const n=Qk[t];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function Bg(t){const e=[],r=s=>{e.push(String.fromCodePoint(s))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},o=s=>{rj(s,n,r)};for(let s=0;s<t.length;s+=1)vw(t.charCodeAt(s),i,o);return e.join("")}function ej(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function tj(t,e){for(let r=0;r<t.length;r+=1){let n=t.charCodeAt(r);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(t.charCodeAt(r+1)-56320&65535|i)+65536,r+=1}ej(n,e)}}function rj(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let n=1;n<6;n+=1)if(!(t>>7-n&1)){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function ns(t){const e=[],r={queue:0,queuedBits:0},n=i=>{e.push(i)};for(let i=0;i<t.length;i+=1)vw(t.charCodeAt(i),r,n);return new Uint8Array(e)}function nj(t){const e=[];return tj(t,r=>e.push(r)),new Uint8Array(e)}function Ai(t){const e=[],r={queue:0,queuedBits:0},n=i=>{e.push(i)};return t.forEach(i=>Fg(i,r,n)),Fg(null,r,n),e.join("")}function ij(t){return Math.round(Date.now()/1e3)+t}function oj(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const Wt=()=>typeof window<"u"&&typeof document<"u",wi={tested:!1,writable:!1},yw=()=>{if(!Wt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(wi.tested)return wi.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),wi.tested=!0,wi.writable=!0}catch{wi.tested=!0,wi.writable=!1}return wi.writable};function sj(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((i,o)=>{e[o]=i})}catch{}return r.searchParams.forEach((n,i)=>{e[i]=n}),e}const xw=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),aj=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",bo=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},_i=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Ln=async(t,e)=>{await t.removeItem(e)};class pd{constructor(){this.promise=new pd.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}pd.promiseConstructor=Promise;function mu(t){const e=t.split(".");if(e.length!==3)throw new Vh("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!qk.test(e[n]))throw new Vh("JWT not in base64url format");return{header:JSON.parse(Bg(e[0])),payload:JSON.parse(Bg(e[1])),signature:ns(e[2]),raw:{header:e[0],payload:e[1]}}}async function lj(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function cj(t,e){return new Promise((n,i)=>{(async()=>{for(let o=0;o<1/0;o++)try{const s=await t(o);if(!e(o,null,s)){n(s);return}}catch(s){if(!e(o,s)){i(s);return}}})()})}function dj(t){return("0"+t.toString(16)).substr(-2)}function uj(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let i="";for(let o=0;o<56;o++)i+=r.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(e),Array.from(e,dj).join("")}async function hj(t){const r=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",r),i=new Uint8Array(n);return Array.from(i).map(o=>String.fromCharCode(o)).join("")}async function fj(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await hj(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function fo(t,e,r=!1){const n=uj();let i=n;r&&(i+="/PASSWORD_RECOVERY"),await bo(t,`${e}-code-verifier`,i);const o=await fj(n);return[o,n===o?"plain":"s256"]}const pj=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function mj(t){const e=t.headers.get(Wh);if(!e||!e.match(pj))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function gj(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function vj(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const yj=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function po(t){if(!yj.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function gu(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function xj(t,e){return new Proxy(t,{get:(r,n,i)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const o=n.toString();if(o==="Symbol(Symbol.toPrimitive)"||o==="Symbol(Symbol.toStringTag)"||o==="Symbol(util.inspect.custom)"||o==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,i)}return!e.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(r,n,i)}})}function Ug(t){return JSON.parse(JSON.stringify(t))}const Ci=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),bj=[502,503,504];async function Hg(t){var e;if(!aj(t))throw new Gh(Ci(t),0);if(bj.includes(t.status))throw new Gh(Ci(t),t.status);let r;try{r=await t.json()}catch(o){throw new Ri(Ci(o),o)}let n;const i=mj(t);if(i&&i.getTime()>=gw["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Dg(Ci(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new Mr}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((o,s)=>o&&typeof s=="string",!0))throw new Dg(Ci(r),t.status,r.weak_password.reasons);throw new Yk(Ci(r),t.status||500,n)}const wj=(t,e,r,n)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};async function Le(t,e,r,n){var i;const o=Object.assign({},n==null?void 0:n.headers);o[Wh]||(o[Wh]=gw["2024-01-01"].name),n!=null&&n.jwt&&(o.Authorization=`Bearer ${n.jwt}`);const s=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(s.redirect_to=n.redirectTo);const l=Object.keys(s).length?"?"+new URLSearchParams(s).toString():"",c=await _j(t,e,r+l,{headers:o,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(c):{data:Object.assign({},c),error:null}}async function _j(t,e,r,n,i,o){const s=wj(e,n,i,o);let l;try{l=await t(r,Object.assign({},s))}catch(c){throw console.error(c),new Gh(Ci(c),0)}if(l.ok||await Hg(l),n!=null&&n.noResolveJson)return l;try{return await l.json()}catch(c){await Hg(c)}}function $r(t){var e;let r=null;jj(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=ij(t.expires_in)));const n=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:n},error:null}}function Wg(t){const e=$r(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Wn(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function Sj(t){return{data:t,error:null}}function kj(t){const{action_link:e,email_otp:r,hashed_token:n,redirect_to:i,verification_type:o}=t,s=ms(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:r,hashed_token:n,redirect_to:i,verification_type:o},c=Object.assign({},s);return{data:{properties:l,user:c},error:null}}function Gg(t){return t}function jj(t){return t.access_token&&t.refresh_token&&t.expires_in}const vu=["global","local","others"];class Cj{constructor({url:e="",headers:r={},fetch:n}){this.url=e,this.headers=r,this.fetch=xw(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,r=vu[0]){if(vu.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${vu.join(", ")}`);try{return await Le(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Me(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,r={}){try{return await Le(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Wn})}catch(n){if(Me(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:r}=e,n=ms(e,["options"]),i=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),await Le(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:kj,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Me(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await Le(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Wn})}catch(r){if(Me(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,n,i,o,s,l,c;try{const d={nextPage:null,lastPage:0,total:0},h=await Le(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(o=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&o!==void 0?o:""},xform:Gg});if(h.error)throw h.error;const f=await h.json(),u=(s=h.headers.get("x-total-count"))!==null&&s!==void 0?s:0,p=(c=(l=h.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return p.length>0&&(p.forEach(g=>{const m=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(g.split(";")[1].split("=")[1]);d[`${x}Page`]=m}),d.total=parseInt(u)),{data:Object.assign(Object.assign({},f),d),error:null}}catch(d){if(Me(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){po(e);try{return await Le(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Wn})}catch(r){if(Me(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){po(e);try{return await Le(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:Wn})}catch(n){if(Me(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,r=!1){po(e);try{return await Le(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:Wn})}catch(n){if(Me(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){po(e.userId);try{const{data:r,error:n}=await Le(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:r,error:n}}catch(r){if(Me(r))return{data:null,error:r};throw r}}async _deleteFactor(e){po(e.userId),po(e.id);try{return{data:await Le(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(Me(r))return{data:null,error:r};throw r}}async _listOAuthClients(e){var r,n,i,o,s,l,c;try{const d={nextPage:null,lastPage:0,total:0},h=await Le(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(o=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&o!==void 0?o:""},xform:Gg});if(h.error)throw h.error;const f=await h.json(),u=(s=h.headers.get("x-total-count"))!==null&&s!==void 0?s:0,p=(c=(l=h.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return p.length>0&&(p.forEach(g=>{const m=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(g.split(";")[1].split("=")[1]);d[`${x}Page`]=m}),d.total=parseInt(u)),{data:Object.assign(Object.assign({},f),d),error:null}}catch(d){if(Me(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(e){try{return await Le(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Me(r))return{data:null,error:r};throw r}}async _getOAuthClient(e){try{return await Le(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Me(r))return{data:null,error:r};throw r}}async _updateOAuthClient(e,r){try{return await Le(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Me(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(e){try{return await Le(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Me(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(e){try{return await Le(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Me(r))return{data:null,error:r};throw r}}}function Vg(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}const mo={debug:!!(globalThis&&yw()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class bw extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Ej extends bw{}async function Tj(t,e,r){mo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),mo.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){mo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,i.name);try{return await r()}finally{mo.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,i.name)}}else{if(e===0)throw mo.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new Ej(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(mo.debug)try{const o=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function Rj(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function ww(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function Nj(t){return parseInt(t,16)}function Pj(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,n=>n.toString(16).padStart(2,"0")).join("")}function Oj(t){var e;const{chainId:r,domain:n,expirationTime:i,issuedAt:o=new Date,nonce:s,notBefore:l,requestId:c,resources:d,scheme:h,uri:f,version:u}=t;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(s&&s.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${s}`);if(!f)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(u!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${u}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const p=ww(t.address),g=h?`${h}://${n}`:n,m=t.statement?`${t.statement}
`:"",x=`${g} wants you to sign in with your Ethereum account:
${p}

${m}`;let v=`URI: ${f}
Version: ${u}
Chain ID: ${r}${s?`
Nonce: ${s}`:""}
Issued At: ${o.toISOString()}`;if(i&&(v+=`
Expiration Time: ${i.toISOString()}`),l&&(v+=`
Not Before: ${l.toISOString()}`),c&&(v+=`
Request ID: ${c}`),d){let y=`
Resources:`;for(const b of d){if(!b||typeof b!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${b}`);y+=`
- ${b}`}v+=y}return`${x}
${v}`}class kt extends Error{constructor({message:e,code:r,cause:n,name:i}){var o;super(e,{cause:n}),this.__isWebAuthnError=!0,this.name=(o=i??(n instanceof Error?n.name:void 0))!==null&&o!==void 0?o:"Unknown Error",this.code=r}}class $c extends kt{constructor(e,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:e}),this.name="WebAuthnUnknownError",this.originalError=r}}function Aj({error:t,options:e}){var r,n,i;const{publicKey:o}=e;if(!o)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new kt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((r=o.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new kt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((n=o.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new kt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((i=o.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new kt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new kt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new kt({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return o.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new kt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new kt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const s=window.location.hostname;if(_w(s)){if(o.rp.id!==s)return new kt({message:`The RP ID "${o.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new kt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(o.user.id.byteLength<1||o.user.id.byteLength>64)return new kt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new kt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new kt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function Mj({error:t,options:e}){const{publicKey:r}=e;if(!r)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new kt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new kt({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const n=window.location.hostname;if(_w(n)){if(r.rpId!==n)return new kt({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new kt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new kt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new kt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class $j{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const Ij=new $j;function Lj(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:r,excludeCredentials:n}=t,i=ms(t,["challenge","user","excludeCredentials"]),o=ns(e).buffer,s=Object.assign(Object.assign({},r),{id:ns(r.id).buffer}),l=Object.assign(Object.assign({},i),{challenge:o,user:s});if(n&&n.length>0){l.excludeCredentials=new Array(n.length);for(let c=0;c<n.length;c++){const d=n[c];l.excludeCredentials[c]=Object.assign(Object.assign({},d),{id:ns(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return l}function Dj(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:r}=t,n=ms(t,["challenge","allowCredentials"]),i=ns(e).buffer,o=Object.assign(Object.assign({},n),{challenge:i});if(r&&r.length>0){o.allowCredentials=new Array(r.length);for(let s=0;s<r.length;s++){const l=r[s];o.allowCredentials[s]=Object.assign(Object.assign({},l),{id:ns(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return o}function zj(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t;return{id:t.id,rawId:t.id,response:{attestationObject:Ai(new Uint8Array(t.response.attestationObject)),clientDataJSON:Ai(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function Fj(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t,n=t.getClientExtensionResults(),i=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:Ai(new Uint8Array(i.authenticatorData)),clientDataJSON:Ai(new Uint8Array(i.clientDataJSON)),signature:Ai(new Uint8Array(i.signature)),userHandle:i.userHandle?Ai(new Uint8Array(i.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function _w(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function qg(){var t,e;return!!(Wt()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function Bj(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new $c("Browser returned unexpected credential type",e)}:{data:null,error:new $c("Empty credential response",e)}}catch(e){return{data:null,error:Aj({error:e,options:t})}}}async function Uj(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new $c("Browser returned unexpected credential type",e)}:{data:null,error:new $c("Empty credential response",e)}}catch(e){return{data:null,error:Mj({error:e,options:t})}}}const Hj={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},Wj={userVerification:"preferred",hints:["security-key"]};function Ic(...t){const e=i=>i!==null&&typeof i=="object"&&!Array.isArray(i),r=i=>i instanceof ArrayBuffer||ArrayBuffer.isView(i),n={};for(const i of t)if(i)for(const o in i){const s=i[o];if(s!==void 0)if(Array.isArray(s))n[o]=s;else if(r(s))n[o]=s;else if(e(s)){const l=n[o];e(l)?n[o]=Ic(l,s):n[o]=Ic(s)}else n[o]=s}return n}function Gj(t,e){return Ic(Hj,t,e||{})}function Vj(t,e){return Ic(Wj,t,e||{})}class qj{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:r,friendlyName:n,signal:i},o){try{const{data:s,error:l}=await this.client.mfa.challenge({factorId:e,webauthn:r});if(!s)return{data:null,error:l};const c=i??Ij.createNewAbortSignal();if(s.webauthn.type==="create"){const{user:d}=s.webauthn.credential_options.publicKey;d.name||(d.name=`${d.id}:${n}`),d.displayName||(d.displayName=d.name)}switch(s.webauthn.type){case"create":{const d=Gj(s.webauthn.credential_options.publicKey,o==null?void 0:o.create),{data:h,error:f}=await Bj({publicKey:d,signal:c});return h?{data:{factorId:e,challengeId:s.id,webauthn:{type:s.webauthn.type,credential_response:h}},error:null}:{data:null,error:f}}case"request":{const d=Vj(s.webauthn.credential_options.publicKey,o==null?void 0:o.request),{data:h,error:f}=await Uj(Object.assign(Object.assign({},s.webauthn.credential_options),{publicKey:d,signal:c}));return h?{data:{factorId:e,challengeId:s.id,webauthn:{type:s.webauthn.type,credential_response:h}},error:null}:{data:null,error:f}}}}catch(s){return Me(s)?{data:null,error:s}:{data:null,error:new Ri("Unexpected error in challenge",s)}}}async _verify({challengeId:e,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:e,webauthn:n})}async _authenticate({factorId:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}},o){if(!r)return{data:null,error:new Aa("rpId is required for WebAuthn authentication")};try{if(!qg())return{data:null,error:new Ri("Browser does not support WebAuthn",null)};const{data:s,error:l}=await this.challenge({factorId:e,webauthn:{rpId:r,rpOrigins:n},signal:i},{request:o});if(!s)return{data:null,error:l};const{webauthn:c}=s;return this._verify({factorId:e,challengeId:s.challengeId,webauthn:{type:c.type,rpId:r,rpOrigins:n,credential_response:c.credential_response}})}catch(s){return Me(s)?{data:null,error:s}:{data:null,error:new Ri("Unexpected error in authenticate",s)}}}async _register({friendlyName:e,rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i},o){if(!r)return{data:null,error:new Aa("rpId is required for WebAuthn registration")};try{if(!qg())return{data:null,error:new Ri("Browser does not support WebAuthn",null)};const{data:s,error:l}=await this._enroll({friendlyName:e});if(!s)return await this.client.mfa.listFactors().then(h=>{var f;return(f=h.data)===null||f===void 0?void 0:f.all.find(u=>u.factor_type==="webauthn"&&u.friendly_name===e&&u.status!=="unverified")}).then(h=>h?this.client.mfa.unenroll({factorId:h==null?void 0:h.id}):void 0),{data:null,error:l};const{data:c,error:d}=await this._challenge({factorId:s.id,friendlyName:s.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:i},{create:o});return c?this._verify({factorId:s.id,challengeId:c.challengeId,webauthn:{rpId:r,rpOrigins:n,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:d}}catch(s){return Me(s)?{data:null,error:s}:{data:null,error:new Ri("Unexpected error in register",s)}}}}Rj();const Kj={url:Wk,storageKey:Gk,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Vk,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function Kg(t,e,r){return await r()}const go={};class Ma{get jwks(){var e,r;return(r=(e=go[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){go[this.storageKey]=Object.assign(Object.assign({},go[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=go[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){go[this.storageKey]=Object.assign(Object.assign({},go[this.storageKey]),{cachedAt:e})}constructor(e){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Ma.nextInstanceID,Ma.nextInstanceID+=1,this.instanceID>0&&Wt()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},Kj),e);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new Cj({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=xw(i.fetch),this.lock=i.lock||Kg,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,i.lock?this.lock=i.lock:Wt()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=Tj:this.lock=Kg,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new qj(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:yw()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Vg(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=Vg(this.memoryStorage)),Wt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${mw}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let r={},n="none";if(Wt()&&(r=sj(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),Wt()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:o}=await this._getSessionFromURL(r,n);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),Jk(o)){const c=(e=o.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:o}}return await this._removeSession(),{error:o}}const{session:s,redirectType:l}=i;return this._debug("#_initialize()","detected session in URL",s,"redirect type",l),await this._saveSession(s),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Me(r)?this._returnResult({error:r}):this._returnResult({error:new Ri("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,n,i;try{const o=await Le(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=e==null?void 0:e.options)===null||i===void 0?void 0:i.captchaToken}},xform:$r}),{data:s,error:l}=o;if(l||!s)return this._returnResult({data:{user:null,session:null},error:l});const c=s.session,d=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(o){if(Me(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async signUp(e){var r,n,i;try{let o;if("email"in e){const{email:h,password:f,options:u}=e;let p=null,g=null;this.flowType==="pkce"&&([p,g]=await fo(this.storage,this.storageKey)),o=await Le(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:u==null?void 0:u.emailRedirectTo,body:{email:h,password:f,data:(r=u==null?void 0:u.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},code_challenge:p,code_challenge_method:g},xform:$r})}else if("phone"in e){const{phone:h,password:f,options:u}=e;o=await Le(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:h,password:f,data:(n=u==null?void 0:u.data)!==null&&n!==void 0?n:{},channel:(i=u==null?void 0:u.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken}},xform:$r})}else throw new Ll("You must provide either an email or phone number and a password");const{data:s,error:l}=o;if(l||!s)return this._returnResult({data:{user:null,session:null},error:l});const c=s.session,d=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(o){if(Me(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async signInWithPassword(e){try{let r;if("email"in e){const{email:o,password:s,options:l}=e;r=await Le(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:s,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Wg})}else if("phone"in e){const{phone:o,password:s,options:l}=e;r=await Le(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:s,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Wg})}else throw new Ll("You must provide either an email or phone number and a password");const{data:n,error:i}=r;if(i)return this._returnResult({data:{user:null,session:null},error:i});if(!n||!n.session||!n.user){const o=new ho;return this._returnResult({data:{user:null,session:null},error:o})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(r){if(Me(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(e){var r,n,i,o;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(o=e.options)===null||o===void 0?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;switch(r){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(e){var r,n,i,o,s,l,c,d,h,f,u;let p,g;if("message"in e)p=e.message,g=e.signature;else{const{chain:m,wallet:x,statement:v,options:y}=e;let b;if(Wt())if(typeof x=="object")b=x;else{const R=window;if("ethereum"in R&&typeof R.ethereum=="object"&&"request"in R.ethereum&&typeof R.ethereum.request=="function")b=R.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(y!=null&&y.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");b=x}const w=new URL((r=y==null?void 0:y.url)!==null&&r!==void 0?r:window.location.href),k=await b.request({method:"eth_requestAccounts"}).then(R=>R).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!k||k.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const S=ww(k[0]);let C=(n=y==null?void 0:y.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!C){const R=await b.request({method:"eth_chainId"});C=Nj(R)}const T={domain:w.host,address:S,statement:v,uri:w.href,version:"1",chainId:C,nonce:(i=y==null?void 0:y.signInWithEthereum)===null||i===void 0?void 0:i.nonce,issuedAt:(s=(o=y==null?void 0:y.signInWithEthereum)===null||o===void 0?void 0:o.issuedAt)!==null&&s!==void 0?s:new Date,expirationTime:(l=y==null?void 0:y.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=y==null?void 0:y.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(d=y==null?void 0:y.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(h=y==null?void 0:y.signInWithEthereum)===null||h===void 0?void 0:h.resources};p=Oj(T),g=await b.request({method:"personal_sign",params:[Pj(p),S]})}try{const{data:m,error:x}=await Le(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:p,signature:g},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(u=e.options)===null||u===void 0?void 0:u.captchaToken}}:null),xform:$r});if(x)throw x;if(!m||!m.session||!m.user){const v=new ho;return this._returnResult({data:{user:null,session:null},error:v})}return m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),this._returnResult({data:Object.assign({},m),error:x})}catch(m){if(Me(m))return this._returnResult({data:{user:null,session:null},error:m});throw m}}async signInWithSolana(e){var r,n,i,o,s,l,c,d,h,f,u,p;let g,m;if("message"in e)g=e.message,m=e.signature;else{const{chain:x,wallet:v,statement:y,options:b}=e;let w;if(Wt())if(typeof v=="object")w=v;else{const S=window;if("solana"in S&&typeof S.solana=="object"&&("signIn"in S.solana&&typeof S.solana.signIn=="function"||"signMessage"in S.solana&&typeof S.solana.signMessage=="function"))w=S.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof v!="object"||!(b!=null&&b.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=v}const k=new URL((r=b==null?void 0:b.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in w&&w.signIn){const S=await w.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},b==null?void 0:b.signInWithSolana),{version:"1",domain:k.host,uri:k.href}),y?{statement:y}:null));let C;if(Array.isArray(S)&&S[0]&&typeof S[0]=="object")C=S[0];else if(S&&typeof S=="object"&&"signedMessage"in S&&"signature"in S)C=S;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in C&&"signature"in C&&(typeof C.signedMessage=="string"||C.signedMessage instanceof Uint8Array)&&C.signature instanceof Uint8Array)g=typeof C.signedMessage=="string"?C.signedMessage:new TextDecoder().decode(C.signedMessage),m=C.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in w)||typeof w.signMessage!="function"||!("publicKey"in w)||typeof w!="object"||!w.publicKey||!("toBase58"in w.publicKey)||typeof w.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");g=[`${k.host} wants you to sign in with your Solana account:`,w.publicKey.toBase58(),...y?["",y,""]:[""],"Version: 1",`URI: ${k.href}`,`Issued At: ${(i=(n=b==null?void 0:b.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((o=b==null?void 0:b.signInWithSolana)===null||o===void 0)&&o.notBefore?[`Not Before: ${b.signInWithSolana.notBefore}`]:[],...!((s=b==null?void 0:b.signInWithSolana)===null||s===void 0)&&s.expirationTime?[`Expiration Time: ${b.signInWithSolana.expirationTime}`]:[],...!((l=b==null?void 0:b.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${b.signInWithSolana.chainId}`]:[],...!((c=b==null?void 0:b.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${b.signInWithSolana.nonce}`]:[],...!((d=b==null?void 0:b.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${b.signInWithSolana.requestId}`]:[],...!((f=(h=b==null?void 0:b.signInWithSolana)===null||h===void 0?void 0:h.resources)===null||f===void 0)&&f.length?["Resources",...b.signInWithSolana.resources.map(C=>`- ${C}`)]:[]].join(`
`);const S=await w.signMessage(new TextEncoder().encode(g),"utf8");if(!S||!(S instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=S}}try{const{data:x,error:v}=await Le(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:g,signature:Ai(m)},!((u=e.options)===null||u===void 0)&&u.captchaToken?{gotrue_meta_security:{captcha_token:(p=e.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:$r});if(v)throw v;if(!x||!x.session||!x.user){const y=new ho;return this._returnResult({data:{user:null,session:null},error:y})}return x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",x.session)),this._returnResult({data:Object.assign({},x),error:v})}catch(x){if(Me(x))return this._returnResult({data:{user:null,session:null},error:x});throw x}}async _exchangeCodeForSession(e){const r=await _i(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(r??"").split("/");try{const{data:o,error:s}=await Le(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:$r});if(await Ln(this.storage,`${this.storageKey}-code-verifier`),s)throw s;if(!o||!o.session||!o.user){const l=new ho;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),this._returnResult({data:Object.assign(Object.assign({},o),{redirectType:i??null}),error:s})}catch(o){if(Me(o))return this._returnResult({data:{user:null,session:null,redirectType:null},error:o});throw o}}async signInWithIdToken(e){try{const{options:r,provider:n,token:i,access_token:o,nonce:s}=e,l=await Le(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:o,nonce:s,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:$r}),{data:c,error:d}=l;if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!c||!c.session||!c.user){const h=new ho;return this._returnResult({data:{user:null,session:null},error:h})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:d})}catch(r){if(Me(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(e){var r,n,i,o,s;try{if("email"in e){const{email:l,options:c}=e;let d=null,h=null;this.flowType==="pkce"&&([d,h]=await fo(this.storage,this.storageKey));const{error:f}=await Le(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(n=c==null?void 0:c.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:d,code_challenge_method:h},redirectTo:c==null?void 0:c.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:f})}if("phone"in e){const{phone:l,options:c}=e,{data:d,error:h}=await Le(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(i=c==null?void 0:c.data)!==null&&i!==void 0?i:{},create_user:(o=c==null?void 0:c.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(s=c==null?void 0:c.channel)!==null&&s!==void 0?s:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:h})}throw new Ll("You must provide either an email or phone number.")}catch(l){if(Me(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(e){var r,n;try{let i,o;"options"in e&&(i=(r=e.options)===null||r===void 0?void 0:r.redirectTo,o=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:s,error:l}=await Le(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:o}}),redirectTo:i,xform:$r});if(l)throw l;if(!s)throw new Error("An error occurred on token verification.");const c=s.session,d=s.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(i){if(Me(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithSSO(e){var r,n,i;try{let o=null,s=null;this.flowType==="pkce"&&([o,s]=await fo(this.storage,this.storageKey));const l=await Le(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=e==null?void 0:e.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:s}),headers:this.headers,xform:Sj});return this._returnResult(l)}catch(o){if(Me(o))return this._returnResult({data:null,error:o});throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:n}=e;if(n)throw n;if(!r)throw new Mr;const{error:i}=await Le(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:i})})}catch(e){if(Me(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:n,type:i,options:o}=e,{error:s}=await Le(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},redirectTo:o==null?void 0:o.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:s})}else if("phone"in e){const{phone:n,type:i,options:o}=e,{data:s,error:l}=await Le(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:s==null?void 0:s.message_id},error:l})}throw new Ll("You must provide either an email or phone number and a type")}catch(r){if(Me(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await _i(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<fu:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.userStorage){const s=await _i(this.userStorage,this.storageKey+"-user");s!=null&&s.user?e.user=s.user:e.user=gu()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const s={value:this.suppressGetSessionWarning};e.user=xj(e.user,s),s.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:i,error:o}=await this._callRefreshToken(e.refresh_token);return o?this._returnResult({data:{session:null},error:o}):this._returnResult({data:{session:i},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Le(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Wn}):await this._useSession(async r=>{var n,i,o;const{data:s,error:l}=r;if(l)throw l;return!(!((n=s.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Mr}:await Le(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(i=s.session)===null||i===void 0?void 0:i.access_token)!==null&&o!==void 0?o:void 0,xform:Wn})})}catch(r){if(Me(r))return Zk(r)&&(await this._removeSession(),await Ln(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async n=>{const{data:i,error:o}=n;if(o)throw o;if(!i.session)throw new Mr;const s=i.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await fo(this.storage,this.storageKey));const{data:d,error:h}=await Le(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:s.access_token,xform:Wn});if(h)throw h;return s.user=d.user,await this._saveSession(s),await this._notifyAllSubscribers("USER_UPDATED",s),this._returnResult({data:{user:s.user},error:null})})}catch(n){if(Me(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Mr;const r=Date.now()/1e3;let n=r,i=!0,o=null;const{payload:s}=mu(e.access_token);if(s.exp&&(n=s.exp,i=n<=r),i){const{data:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l)return{data:{user:null,session:null},error:null};o=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)throw c;o={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return this._returnResult({data:{user:o.user,session:o},error:null})}catch(r){if(Me(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var n;if(!e){const{data:s,error:l}=r;if(l)throw l;e=(n=s.session)!==null&&n!==void 0?n:void 0}if(!(e!=null&&e.refresh_token))throw new Mr;const{data:i,error:o}=await this._callRefreshToken(e.refresh_token);return o?this._returnResult({data:{user:null,session:null},error:o}):i?this._returnResult({data:{user:i.user,session:i},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(Me(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(e,r){try{if(!Wt())throw new Dl("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Dl(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Lg("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Dl("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Lg("No code detected.");const{data:y,error:b}=await this._exchangeCodeForSession(e.code);if(b)throw b;const w=new URL(window.location.href);return w.searchParams.delete("code"),window.history.replaceState(window.history.state,"",w.toString()),{data:{session:y.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:o,refresh_token:s,expires_in:l,expires_at:c,token_type:d}=e;if(!o||!l||!s||!d)throw new Dl("No session defined in URL");const h=Math.round(Date.now()/1e3),f=parseInt(l);let u=h+f;c&&(u=parseInt(c));const p=u-h;p*1e3<=xo&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${f}s`);const g=u-f;h-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,u,h):h-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,u,h);const{data:m,error:x}=await this._getUser(o);if(x)throw x;const v={provider_token:n,provider_refresh_token:i,access_token:o,expires_in:f,expires_at:u,refresh_token:s,token_type:d,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:v,redirectType:e.type},error:null})}catch(n){if(Me(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await _i(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:i,error:o}=r;if(o)return this._returnResult({error:o});const s=(n=i.session)===null||n===void 0?void 0:n.access_token;if(s){const{error:l}=await this.admin.signOut(s,e);if(l&&!(Xk(l)&&(l.status===404||l.status===401||l.status===403)))return this._returnResult({error:l})}return e!=="others"&&(await this._removeSession(),await Ln(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const r=oj(),n={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async r=>{var n,i;try{const{data:{session:o},error:s}=r;if(s)throw s;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",o)),this._debug("INITIAL_SESSION","callback id",e,"session",o)}catch(o){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",o),console.error(o)}})}async resetPasswordForEmail(e,r={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await fo(this.storage,this.storageKey,!0));try{return await Le(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(o){if(Me(o))return this._returnResult({data:null,error:o});throw o}}async getUserIdentities(){var e;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(r){if(Me(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var r;try{const{data:n,error:i}=await this._useSession(async o=>{var s,l,c,d,h;const{data:f,error:u}=o;if(u)throw u;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(s=e.options)===null||s===void 0?void 0:s.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await Le(this.fetch,"GET",p,{headers:this.headers,jwt:(h=(d=f.session)===null||d===void 0?void 0:d.access_token)!==null&&h!==void 0?h:void 0})});if(i)throw i;return Wt()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:e.provider,url:n==null?void 0:n.url},error:null})}catch(n){if(Me(n))return this._returnResult({data:{provider:e.provider,url:null},error:n});throw n}}async linkIdentityIdToken(e){return await this._useSession(async r=>{var n;try{const{error:i,data:{session:o}}=r;if(i)throw i;const{options:s,provider:l,token:c,access_token:d,nonce:h}=e,f=await Le(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=o==null?void 0:o.access_token)!==null&&n!==void 0?n:void 0,body:{provider:l,id_token:c,access_token:d,nonce:h,link_identity:!0,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},xform:$r}),{data:u,error:p}=f;return p?this._returnResult({data:{user:null,session:null},error:p}):!u||!u.session||!u.user?this._returnResult({data:{user:null,session:null},error:new ho}):(u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("USER_UPDATED",u.session)),this._returnResult({data:u,error:p}))}catch(i){if(Me(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}})}async unlinkIdentity(e){try{return await this._useSession(async r=>{var n,i;const{data:o,error:s}=r;if(s)throw s;return await Le(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(n=o.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(r){if(Me(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await cj(async i=>(i>0&&await lj(200*Math.pow(2,i-1)),this._debug(r,"refreshing attempt",i),await Le(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:$r})),(i,o)=>{const s=200*Math.pow(2,i);return o&&pu(o)&&Date.now()+s-n<xo})}catch(n){if(this._debug(r,"error",n),Me(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",n),Wt()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const i=await _i(this.storage,this.storageKey);if(i&&this.userStorage){let s=await _i(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!s&&(s={user:i.user},await bo(this.userStorage,this.storageKey+"-user",s)),i.user=(e=s==null?void 0:s.user)!==null&&e!==void 0?e:gu()}else if(i&&!i.user&&!i.user){const s=await _i(this.storage,this.storageKey+"-user");s&&(s!=null&&s.user)?(i.user=s.user,await Ln(this.storage,this.storageKey+"-user"),await bo(this.storage,this.storageKey,i)):i.user=gu()}if(this._debug(n,"session from storage",i),!this._isValidSession(i)){this._debug(n,"session is not valid"),i!==null&&await this._removeSession();return}const o=((r=i.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<fu;if(this._debug(n,`session has${o?"":" not"} expired with margin of ${fu}s`),o){if(this.autoRefreshToken&&i.refresh_token){const{error:s}=await this._callRefreshToken(i.refresh_token);s&&(console.error(s),pu(s)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",s),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:s,error:l}=await this._getUser(i.access_token);!l&&(s!=null&&s.user)?(i.user=s.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(s){console.error("Error getting user data:",s),this._debug(n,"error getting user data, skipping SIGNED_IN notification",s)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(n,"error",i),console.error(i);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var r,n;if(!e)throw new Mr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new pd;const{data:o,error:s}=await this._refreshAccessToken(e);if(s)throw s;if(!o.session)throw new Mr;await this._saveSession(o.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);const l={data:o.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(o){if(this._debug(i,"error",o),Me(o)){const s={data:null,error:o};return pu(o)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(s),s}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(o),o}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,r,n=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:r});const o=[],s=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,r)}catch(c){o.push(c)}});if(await Promise.all(s),o.length>0){for(let l=0;l<o.length;l+=1)console.error(o[l]);throw o[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const r=Object.assign({},e),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await bo(this.userStorage,this.storageKey+"-user",{user:r.user});const i=Object.assign({},r);delete i.user;const o=Ug(i);await bo(this.storage,this.storageKey,o)}else{const i=Ug(r);await bo(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),await Ln(this.storage,this.storageKey),await Ln(this.storage,this.storageKey+"-code-verifier"),await Ln(this.storage,this.storageKey+"-user"),this.userStorage&&await Ln(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Wt()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),xo);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-e)/xo);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${xo}ms, refresh threshold is ${Hh} ticks`),i<=Hh&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof bw)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Wt()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,n){const i=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[o,s]=await fo(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(s)}`});i.push(l.toString())}if(n!=null&&n.queryParams){const o=new URLSearchParams(n.queryParams);i.push(o.toString())}return n!=null&&n.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var n;const{data:i,error:o}=r;return o?this._returnResult({data:null,error:o}):await Le(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Me(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(e){try{return await this._useSession(async r=>{var n,i;const{data:o,error:s}=r;if(s)return this._returnResult({data:null,error:s});const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:c,error:d}=await Le(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=o==null?void 0:o.session)===null||n===void 0?void 0:n.access_token});return d?this._returnResult({data:null,error:d}):(e.factorType==="totp"&&c.type==="totp"&&(!((i=c==null?void 0:c.totp)===null||i===void 0)&&i.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(r){if(Me(r))return this._returnResult({data:null,error:r});throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:o}=r;if(o)return this._returnResult({data:null,error:o});const s=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?zj(e.webauthn.credential_response):Fj(e.webauthn.credential_response)})}:{code:e.code}),{data:l,error:c}=await Le(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:s,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:c}))})}catch(r){if(Me(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:o}=r;if(o)return this._returnResult({data:null,error:o});const s=await Le(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});if(s.error)return s;const{data:l}=s;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:Lj(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:Dj(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Me(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(e){const{data:r,error:n}=await this._challenge({factorId:e.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){var e;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const i={all:[],phone:[],totp:[],webauthn:[]};for(const o of(e=r==null?void 0:r.factors)!==null&&e!==void 0?e:[])i.all.push(o),o.status==="verified"&&i[o.factor_type].push(o);return{data:i,error:null}}async _getAuthenticatorAssuranceLevel(){var e,r;const{data:{session:n},error:i}=await this.getSession();if(i)return this._returnResult({data:null,error:i});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=mu(n.access_token);let s=null;o.aal&&(s=o.aal);let l=s;((r=(e=n.user.factors)===null||e===void 0?void 0:e.filter(h=>h.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const d=o.amr||[];return{data:{currentLevel:s,nextLevel:l,currentAuthenticationMethods:d},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async r=>{const{data:{session:n},error:i}=r;return i?this._returnResult({data:null,error:i}):n?await Le(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:n.access_token,xform:o=>({data:o,error:null})}):this._returnResult({data:null,error:new Mr})})}catch(r){if(Me(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(e,r){try{return await this._useSession(async n=>{const{data:{session:i},error:o}=n;if(o)return this._returnResult({data:null,error:o});if(!i)return this._returnResult({data:null,error:new Mr});const s=await Le(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return s.data&&s.data.redirect_url&&Wt()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(s.data.redirect_url),s})}catch(n){if(Me(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(e,r){try{return await this._useSession(async n=>{const{data:{session:i},error:o}=n;if(o)return this._returnResult({data:null,error:o});if(!i)return this._returnResult({data:null,error:new Mr});const s=await Le(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return s.data&&s.data.redirect_url&&Wt()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(s.data.redirect_url),s})}catch(n){if(Me(n))return this._returnResult({data:null,error:n});throw n}}async fetchJwk(e,r={keys:[]}){let n=r.keys.find(l=>l.kid===e);if(n)return n;const i=Date.now();if(n=this.jwks.keys.find(l=>l.kid===e),n&&this.jwks_cached_at+Kk>i)return n;const{data:o,error:s}=await Le(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(s)throw s;return!o.keys||o.keys.length===0||(this.jwks=o,this.jwks_cached_at=i,n=o.keys.find(l=>l.kid===e),!n)?null:n}async getClaims(e,r={}){try{let n=e;if(!n){const{data:p,error:g}=await this.getSession();if(g||!p.session)return this._returnResult({data:null,error:g});n=p.session.access_token}const{header:i,payload:o,signature:s,raw:{header:l,payload:c}}=mu(n);r!=null&&r.allowExpired||gj(o.exp);const d=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!d){const{error:p}=await this.getUser(n);if(p)throw p;return{data:{claims:o,header:i,signature:s},error:null}}const h=vj(i.alg),f=await crypto.subtle.importKey("jwk",d,h,!0,["verify"]);if(!await crypto.subtle.verify(h,f,s,nj(`${l}.${c}`)))throw new Vh("Invalid JWT signature");return{data:{claims:o,header:i,signature:s},error:null}}catch(n){if(Me(n))return this._returnResult({data:null,error:n});throw n}}}Ma.nextInstanceID=0;const Yj=Ma;class Xj extends Yj{constructor(e){super(e)}}class Zj{constructor(e,r,n){var i,o,s;this.supabaseUrl=e,this.supabaseKey=r;const l=Hk(e);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,d={db:$k,realtime:Lk,auth:Object.assign(Object.assign({},Ik),{storageKey:c}),global:Mk},h=Uk(n??{},d);this.storageKey=(i=h.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(o=h.global.headers)!==null&&o!==void 0?o:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(f,u)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(u)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((s=h.auth)!==null&&s!==void 0?s:{},this.headers,h.global.fetch),this.fetch=Fk(r,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new WS(new URL("rest/v1",l).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),this.storage=new Pk(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new BS(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,r,n)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,r;if(this.accessToken)return await this.accessToken();const{data:n}=await this.auth.getSession();return(r=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:i,userStorage:o,storageKey:s,flowType:l,lock:c,debug:d,throwOnError:h},f,u){const p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Xj({url:this.authUrl.href,headers:Object.assign(Object.assign({},p),f),storageKey:s,autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:i,userStorage:o,flowType:l,lock:c,debug:d,throwOnError:h,fetch:u,hasCustomAuthorizationHeader:Object.keys(this.headers).some(g=>g.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new ak(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(e,r,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Jj=(t,e,r)=>new Zj(t,e,r);function Qj(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}Qj()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Yg={DRAFTIFY:"/api/studio-draftify",GEOMETRIC_GENERATE:"/api/studio-generate-geometric"},Xg={URL:"https://okakomwfikxmwllvliva.supabase.co",ANON_KEY:""},Zg={AUTH_SESSION:"studio_auth_session"},Pt=Jj(Xg.URL,Xg.ANON_KEY),Qr={async signIn(t,e){const{data:r,error:n}=await Pt.auth.signInWithPassword({email:t,password:e});if(n)throw n;return localStorage.setItem(Zg.AUTH_SESSION,JSON.stringify(r.session)),r},async signOut(){await Pt.auth.signOut(),localStorage.removeItem(Zg.AUTH_SESSION)},async getSession(){const{data:t}=await Pt.auth.getSession();return t.session},async updatePassword(t){const{data:e,error:r}=await Pt.auth.updateUser({password:t});if(r)throw r;return await Pt.auth.updateUser({data:{password_setup_complete:!0}}),e},onAuthStateChange(t){return Pt.auth.onAuthStateChange(t)}};async function md(){var r,n;const t=await Pt.auth.getSession(),e=(n=(r=t==null?void 0:t.data)==null?void 0:r.session)==null?void 0:n.access_token;if(!e)throw new Error("Not authenticated");return{"Content-Type":"application/json",Authorization:`Bearer ${e}`}}async function up(t){const e=await md(),r=await fetch("/api/designs/save",{method:"POST",headers:e,body:JSON.stringify(t)});if(!r.ok){const n=await r.json();throw new Error(n.error||"Unable to save your design. Please check your connection and try again.")}return r.json()}async function Lc({project_id:t,limit:e=50,offset:r=0,search:n}={}){const i=await md(),o=new URLSearchParams;t&&o.append("project_id",t),o.append("limit",e),o.append("offset",r),n&&o.append("search",n);const s=await fetch(`/api/designs/list?${o}`,{method:"GET",headers:i});if(!s.ok){const l=await s.json();throw new Error(l.error||"Unable to load your designs. Please refresh the page and try again.")}return s.json()}async function Wa(t){const e=await md(),r=await fetch(`/api/designs/by-id?id=${t}`,{method:"GET",headers:e});if(!r.ok){const n=await r.json();throw new Error(n.error||"Unable to open this design. It may have been deleted or you may not have permission to view it.")}return r.json()}async function eC(t){const e=await md(),r=await fetch(`/api/designs/by-id?id=${t}`,{method:"DELETE",headers:e});if(!r.ok){const n=await r.json();throw new Error(n.error||"Unable to delete this design. Please check your connection and try again.")}return r.json()}class tC extends $.Component{constructor(r){super(r);hm(this,"handleReset",()=>{this.setState({hasError:!1,error:null,errorInfo:null})});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(r){return{hasError:!0}}componentDidCatch(r,n){console.error("[ErrorBoundary] Caught error:",r,n),this.setState({error:r,errorInfo:n})}render(){return this.state.hasError?a.jsxs("div",{className:"error-boundary",children:[a.jsxs("div",{className:"error-content",children:[a.jsx("h1",{children:"Something went wrong"}),a.jsx("p",{children:"We're sorry, but something unexpected happened. Please try refreshing the page."}),a.jsxs("div",{className:"error-actions",children:[a.jsx("button",{onClick:this.handleReset,className:"btn-primary",children:"Try Again"}),a.jsx("button",{onClick:()=>window.location.reload(),className:"btn-secondary",children:"Refresh Page"})]}),!1]}),a.jsx("style",{jsx:!0,children:`
            .error-boundary {
              min-height: 100vh;
              display: flex;
              align-items: center;
              justify-content: center;
              padding: 2rem;
              background: #f9fafb;
            }

            .error-content {
              max-width: 500px;
              text-align: center;
              background: white;
              padding: 3rem;
              border-radius: 12px;
              box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            }

            h1 {
              color: #1e4a7a;
              margin: 0 0 1rem 0;
              font-size: 1.75rem;
            }

            p {
              color: #6b7280;
              margin: 0 0 2rem 0;
              line-height: 1.6;
            }

            .error-actions {
              display: flex;
              gap: 1rem;
              justify-content: center;
            }

            .btn-primary,
            .btn-secondary {
              padding: 0.75rem 1.5rem;
              border-radius: 6px;
              font-weight: 500;
              cursor: pointer;
              transition: all 0.2s;
              border: none;
            }

            .btn-primary {
              background: #ff6b35;
              color: white;
            }

            .btn-primary:hover {
              background: #e55a2b;
              transform: translateY(-1px);
            }

            .btn-secondary {
              background: white;
              color: #374151;
              border: 1px solid #d1d5db;
            }

            .btn-secondary:hover {
              background: #f9fafb;
            }

            .error-details {
              margin-top: 2rem;
              text-align: left;
              font-size: 0.875rem;
            }

            .error-details summary {
              cursor: pointer;
              color: #6b7280;
              margin-bottom: 0.5rem;
            }

            .error-details pre {
              background: #f3f4f6;
              padding: 1rem;
              border-radius: 4px;
              overflow-x: auto;
              font-size: 0.75rem;
              color: #dc2626;
            }
          `})]}):this.props.children}}const rC="modulepreload",nC=function(t){return"/"+t},Jg={},iC=function(e,r,n){let i=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),l=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));i=Promise.allSettled(r.map(c=>{if(c=nC(c),c in Jg)return;Jg[c]=!0;const d=c.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${h}`))return;const f=document.createElement("link");if(f.rel=d?"stylesheet":rC,d||(f.as="script"),f.crossOrigin="",f.href=c,l&&f.setAttribute("nonce",l),document.head.appendChild(f),d)return new Promise((u,p)=>{f.addEventListener("load",u),f.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function o(s){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=s,window.dispatchEvent(l),!l.defaultPrevented)throw s}return i.then(s=>{for(const l of s||[])l.status==="rejected"&&o(l.reason);return e().catch(o)})},Qg=t=>{let e;const r=new Set,n=(d,h)=>{const f=typeof d=="function"?d(e):d;if(!Object.is(f,e)){const u=e;e=h??(typeof f!="object"||f===null)?f:Object.assign({},e,f),r.forEach(p=>p(e,u))}},i=()=>e,l={setState:n,getState:i,getInitialState:()=>c,subscribe:d=>(r.add(d),()=>r.delete(d))},c=e=t(n,i,l);return l},oC=t=>t?Qg(t):Qg,sC=t=>t;function aC(t,e=sC){const r=$.useSyncExternalStore(t.subscribe,$.useCallback(()=>e(t.getState()),[t,e]),$.useCallback(()=>e(t.getInitialState()),[t,e]));return $.useDebugValue(r),r}const e0=t=>{const e=oC(t),r=n=>aC(e,n);return Object.assign(r,e),r},Sw=t=>t?e0(t):e0,t0={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},$a=new Map,zl=t=>{const e=$a.get(t);return e?Object.fromEntries(Object.entries(e.stores).map(([r,n])=>[r,n.getState()])):{}},lC=(t,e,r)=>{if(t===void 0)return{type:"untracked",connection:e.connect(r)};const n=$a.get(r.name);if(n)return{type:"tracked",store:t,...n};const i={connection:e.connect(r),stores:{}};return $a.set(r.name,i),{type:"tracked",store:t,...i}},cC=(t,e)=>{if(e===void 0)return;const r=$a.get(t);r&&(delete r.stores[e],Object.keys(r.stores).length===0&&$a.delete(t))},dC=t=>{var e,r;if(!t)return;const n=t.split(`
`),i=n.findIndex(s=>s.includes("api.setState"));if(i<0)return;const o=((e=n[i+1])==null?void 0:e.trim())||"";return(r=/.+ (.+) .+/.exec(o))==null?void 0:r[1]},uC=(t,e={})=>(r,n,i)=>{const{enabled:o,anonymousActionType:s,store:l,...c}=e;let d;try{d=(o??(t0?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!d)return t(r,n,i);const{connection:h,...f}=lC(l,d,c);let u=!0;i.setState=(m,x,v)=>{const y=r(m,x);if(!u)return y;const b=v===void 0?{type:s||dC(new Error().stack)||"anonymous"}:typeof v=="string"?{type:v}:v;return l===void 0?(h==null||h.send(b,n()),y):(h==null||h.send({...b,type:`${l}/${b.type}`},{...zl(c.name),[l]:i.getState()}),y)},i.devtools={cleanup:()=>{h&&typeof h.unsubscribe=="function"&&h.unsubscribe(),cC(c.name,l)}};const p=(...m)=>{const x=u;u=!1,r(...m),u=x},g=t(i.setState,n,i);if(f.type==="untracked"?h==null||h.init(g):(f.stores[f.store]=i,h==null||h.init(Object.fromEntries(Object.entries(f.stores).map(([m,x])=>[m,m===f.store?g:x.getState()])))),i.dispatchFromDevtools&&typeof i.dispatch=="function"){let m=!1;const x=i.dispatch;i.dispatch=(...v)=>{(t0?"production":void 0)!=="production"&&v[0].type==="__setState"&&!m&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),m=!0),x(...v)}}return h.subscribe(m=>{var x;switch(m.type){case"ACTION":if(typeof m.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return yu(m.payload,v=>{if(v.type==="__setState"){if(l===void 0){p(v.state);return}Object.keys(v.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format.
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const y=v.state[l];if(y==null)return;JSON.stringify(i.getState())!==JSON.stringify(y)&&p(y);return}i.dispatchFromDevtools&&typeof i.dispatch=="function"&&i.dispatch(v)});case"DISPATCH":switch(m.payload.type){case"RESET":return p(g),l===void 0?h==null?void 0:h.init(i.getState()):h==null?void 0:h.init(zl(c.name));case"COMMIT":if(l===void 0){h==null||h.init(i.getState());return}return h==null?void 0:h.init(zl(c.name));case"ROLLBACK":return yu(m.state,v=>{if(l===void 0){p(v),h==null||h.init(i.getState());return}p(v[l]),h==null||h.init(zl(c.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return yu(m.state,v=>{if(l===void 0){p(v);return}JSON.stringify(i.getState())!==JSON.stringify(v[l])&&p(v[l])});case"IMPORT_STATE":{const{nextLiftedState:v}=m.payload,y=(x=v.computedStates.slice(-1)[0])==null?void 0:x.state;if(!y)return;p(l===void 0?y:y[l]),h==null||h.send(null,v);return}case"PAUSE_RECORDING":return u=!u}return}}),g},kw=uC,yu=(t,e)=>{let r;try{r=JSON.parse(t)}catch(n){console.error("[zustand devtools middleware] Could not parse the received json",n)}r!==void 0&&e(r)},xu={surface:{width_mm:5e4,length_mm:5e4,color:{tpv_code:"RH12",hex:"#006C55",name:"Dark Green"}},courts:{},selectedCourtId:null,tracks:{},selectedTrackId:null,motifs:{},selectedMotifId:null,elementOrder:[],customMarkings:[],backgroundZones:[],designName:"Untitled Design",designDescription:"",designTags:[],history:[],historyIndex:-1,maxHistory:50,showCourtLibrary:!0,showPropertiesPanel:!0,propertiesPanelUserClosed:!1,showColorEditor:!1,snapToGrid:!0,gridSize_mm:100,standaloneMode:!1,standaloneDesignId:null,isSaving:!1,lastSaved:null},Qe=Sw(kw((t,e)=>({...xu,setSurfaceDimensions:(r,n)=>{t(i=>({surface:{...i.surface,width_mm:r,length_mm:n}})),e().addToHistory()},setSurfaceColor:r=>{t(n=>({surface:{...n.surface,color:r}})),e().addToHistory()},addCourt:(r,n)=>{const i=`court-${Date.now()}`,o=h=>({RH01:{tpv_code:"RH01",hex:"#A5362F",name:"Standard Red"},RH02:{tpv_code:"RH02",hex:"#E21F2F",name:"Bright Red"},RH10:{tpv_code:"RH10",hex:"#609B63",name:"Standard Green"},RH11:{tpv_code:"RH11",hex:"#3BB44A",name:"Bright Green"},RH12:{tpv_code:"RH12",hex:"#006C55",name:"Dark Green"},RH20:{tpv_code:"RH20",hex:"#0075BC",name:"Standard Blue"},RH21:{tpv_code:"RH21",hex:"#493D8C",name:"Purple"},RH22:{tpv_code:"RH22",hex:"#47AFE3",name:"Light Blue"},RH23:{tpv_code:"RH23",hex:"#039DC4",name:"Azure"},RH26:{tpv_code:"RH26",hex:"#00A6A3",name:"Turquoise"},RH30:{tpv_code:"RH30",hex:"#E4C4AA",name:"Standard Beige"},RH31:{tpv_code:"RH31",hex:"#E8E3D8",name:"Cream"},RH32:{tpv_code:"RH32",hex:"#8B5F3C",name:"Brown"},RH40:{tpv_code:"RH40",hex:"#E5A144",name:"Mustard Yellow"},RH41:{tpv_code:"RH41",hex:"#FFD833",name:"Bright Yellow"},RH50:{tpv_code:"RH50",hex:"#F15B32",name:"Orange"},RH60:{tpv_code:"RH60",hex:"#59595B",name:"Dark Grey"},RH61:{tpv_code:"RH61",hex:"#939598",name:"Light Grey"},RH65:{tpv_code:"RH65",hex:"#D9D9D6",name:"Pale Grey"},RH70:{tpv_code:"RH70",hex:"#231F20",name:"Black"},RH90:{tpv_code:"RH90",hex:"#E8457E",name:"Funky Pink"}})[h]||{tpv_code:"RH31",hex:"#E8E3D8",name:"Cream"},s={};if(n.defaultLineColor){const h=o(n.defaultLineColor);n.markings.forEach(f=>{s[f.id]=h})}const l={};if(n.defaultLineColor&&n.zones){const h=o(n.defaultLineColor);n.zones.forEach(f=>{l[f.id]=h})}const c=n.defaultSurfaceColor?o(n.defaultSurfaceColor):null,d={id:i,templateId:r,template:n,position:{x:e().surface.width_mm/2-n.dimensions.width_mm/2,y:e().surface.length_mm/2-n.dimensions.length_mm/2},rotation:0,scale:1,lineColorOverrides:s,zoneColorOverrides:l,courtSurfaceColor:c};t(h=>({courts:{...h.courts,[i]:d},elementOrder:[...h.elementOrder,i],selectedCourtId:i,selectedTrackId:null})),e().addToHistory()},removeCourt:r=>{const{[r]:n,...i}=e().courts;t(o=>({courts:i,elementOrder:o.elementOrder.filter(s=>s!==r),selectedCourtId:o.selectedCourtId===r?null:o.selectedCourtId})),e().addToHistory()},updateCourtPosition:(r,n)=>{t(i=>({courts:{...i.courts,[r]:{...i.courts[r],position:n}}}))},updateCourtRotation:(r,n)=>{t(i=>({courts:{...i.courts,[r]:{...i.courts[r],rotation:n}}}))},updateCourtScale:(r,n)=>{t(i=>({courts:{...i.courts,[r]:{...i.courts[r],scale:n}}}))},duplicateCourt:r=>{const n=e().courts[r];if(!n)return;const i=`court-${Date.now()}`,o={...n,id:i,position:{x:n.position.x+500,y:n.position.y+500}};t(s=>({courts:{...s.courts,[i]:o},elementOrder:[...s.elementOrder,i],selectedCourtId:i,selectedTrackId:null})),e().addToHistory()},duplicateTrack:r=>{const n=e().tracks[r];if(!n)return;const i=`track-${Date.now()}`,o={...n,id:i,position:{x:n.position.x+500,y:n.position.y+500}};t(s=>({tracks:{...s.tracks,[i]:o},elementOrder:[...s.elementOrder,i],selectedTrackId:i,selectedCourtId:null})),e().addToHistory()},renameElement:(r,n)=>{r.startsWith("court-")?t(i=>({courts:{...i.courts,[r]:{...i.courts[r],customName:n}}})):r.startsWith("track-")?t(i=>({tracks:{...i.tracks,[r]:{...i.tracks[r],customName:n}}})):r.startsWith("motif-")&&t(i=>({motifs:{...i.motifs,[r]:{...i.motifs[r],customName:n}}})),e().addToHistory()},toggleElementLock:r=>{r.startsWith("court-")?t(n=>{var i;return{courts:{...n.courts,[r]:{...n.courts[r],locked:!((i=n.courts[r])!=null&&i.locked)}}}}):r.startsWith("track-")?t(n=>{var i;return{tracks:{...n.tracks,[r]:{...n.tracks[r],locked:!((i=n.tracks[r])!=null&&i.locked)}}}}):r.startsWith("motif-")&&t(n=>{var i;return{motifs:{...n.motifs,[r]:{...n.motifs[r],locked:!((i=n.motifs[r])!=null&&i.locked)}}}}),e().addToHistory()},toggleElementVisibility:r=>{r.startsWith("court-")?t(n=>{var i;return{courts:{...n.courts,[r]:{...n.courts[r],visible:((i=n.courts[r])==null?void 0:i.visible)===!1}}}}):r.startsWith("track-")?t(n=>{var i;return{tracks:{...n.tracks,[r]:{...n.tracks[r],visible:((i=n.tracks[r])==null?void 0:i.visible)===!1}}}}):r.startsWith("motif-")&&t(n=>{var i;return{motifs:{...n.motifs,[r]:{...n.motifs[r],visible:((i=n.motifs[r])==null?void 0:i.visible)===!1}}}}),e().addToHistory()},setLineColor:(r,n,i)=>{t(o=>({courts:{...o.courts,[r]:{...o.courts[r],lineColorOverrides:{...o.courts[r].lineColorOverrides,[n]:i}}}})),e().addToHistory()},setZoneColor:(r,n,i)=>{t(o=>({courts:{...o.courts,[r]:{...o.courts[r],zoneColorOverrides:{...o.courts[r].zoneColorOverrides,[n]:i}}}})),e().addToHistory()},resetCourtColors:r=>{t(n=>({courts:{...n.courts,[r]:{...n.courts[r],lineColorOverrides:{},zoneColorOverrides:{}}}})),e().addToHistory()},setCourtSurfaceColor:(r,n)=>{t(i=>({courts:{...i.courts,[r]:{...i.courts[r],courtSurfaceColor:n}}})),e().addToHistory()},selectCourt:r=>{const{propertiesPanelUserClosed:n}=e();t(n?{selectedCourtId:r,selectedTrackId:null}:{selectedCourtId:r,selectedTrackId:null,showPropertiesPanel:!0})},deselectCourt:()=>{t({selectedCourtId:null,showPropertiesPanel:!1,propertiesPanelUserClosed:!0})},setElementOrder:r=>{t({elementOrder:r})},moveElementUp:r=>{const{elementOrder:n}=e(),i=n.indexOf(r);if(i<n.length-1){const o=[...n];[o[i],o[i+1]]=[o[i+1],o[i]],t({elementOrder:o}),e().addToHistory()}},moveElementDown:r=>{const{elementOrder:n}=e(),i=n.indexOf(r);if(i>0){const o=[...n];[o[i],o[i-1]]=[o[i-1],o[i]],t({elementOrder:o}),e().addToHistory()}},bringToFront:r=>{const{elementOrder:n}=e(),i=n.filter(o=>o!==r);i.push(r),t({elementOrder:i}),e().addToHistory()},sendToBack:r=>{const{elementOrder:n}=e(),i=n.filter(o=>o!==r);i.unshift(r),t({elementOrder:i}),e().addToHistory()},addTrack:(r,n)=>{const i=`track-${Date.now()}`,o=e().surface,s=o.width_mm,l=o.length_mm,c=x=>({RH01:{tpv_code:"RH01",hex:"#A5362F",name:"Standard Red"},RH31:{tpv_code:"RH31",hex:"#E8E3D8",name:"Cream"},RH30:{tpv_code:"RH30",hex:"#E4C4AA",name:"Standard Beige"},RH20:{tpv_code:"RH20",hex:"#0075BC",name:"Standard Blue"},RH12:{tpv_code:"RH12",hex:"#006C55",name:"Dark Green"}})[x]||{tpv_code:x,hex:"#A5362F",name:"Standard Red"},d=n.defaultTrackSurfaceColor?c(n.defaultTrackSurfaceColor):c("RH01"),h=n.trackType==="straight";let f,u,p;const g={enabled:!1,depth_mm:500,style:"staggered",direction:"counterclockwise",startPosition:0};if(h){const x=n.parameters.numLanes,v=n.parameters.laneWidth_mm,y=x*v,b=Math.max(s,l)*.9,w=n.parameters.height_mm||1e5,k=Math.min(w,b);f={...n.parameters,width_mm:y,height_mm:k,cornerRadius:{topLeft:0,topRight:0,bottomLeft:0,bottomRight:0},laneWidth_mm:v,startingBoxes:{...g,...n.parameters.startingBoxes}},p=90,u={x:s/2-y/2,y:l/2-k/2}}else{const x=s*.9,v=l*.9,y=n.parameters.width_mm||25e3,b=n.parameters.height_mm||15e3,w=x/y,k=v/b,S=Math.min(w,k),C=n.parameters.cornerRadius||{topLeft:3e3,topRight:3e3,bottomLeft:3e3,bottomRight:3e3},T={topLeft:C.topLeft*S,topRight:C.topRight*S,bottomLeft:C.bottomLeft*S,bottomRight:C.bottomRight*S};f={...n.parameters,width_mm:x,height_mm:v,cornerRadius:T,laneWidth_mm:n.parameters.laneWidth_mm,startingBoxes:{...g,...n.parameters.startingBoxes}},p=0,u={x:s/2-x/2,y:l/2-v/2}}const m={id:i,templateId:r,template:n,position:u,rotation:p,parameters:f,trackSurfaceColor:d};t(x=>({tracks:{...x.tracks,[i]:m},elementOrder:[...x.elementOrder,i],selectedTrackId:i,selectedCourtId:null})),e().addToHistory()},removeTrack:r=>{const{[r]:n,...i}=e().tracks;t(o=>({tracks:i,elementOrder:o.elementOrder.filter(s=>s!==r),selectedTrackId:o.selectedTrackId===r?null:o.selectedTrackId})),e().addToHistory()},updateTrackParameters:(r,n)=>{t(i=>{var h;const o=i.tracks[r];if(!o)return i;const s=o.parameters,l={...s,...n},c=((h=o.template)==null?void 0:h.trackType)==="straight";let d=o.position;if(c&&n.numLanes!==void 0&&n.numLanes!==s.numLanes){const f=s.laneWidth_mm,u=s.numLanes*f,p=n.numLanes*f;l.width_mm=p;const g=o.position.x+u/2,m=o.position.y+s.height_mm/2;d={x:g-p/2,y:m-l.height_mm/2}}return{tracks:{...i.tracks,[r]:{...o,parameters:l,position:d}}}}),e().addToHistory()},updateTrackPosition:(r,n)=>{t(i=>({tracks:{...i.tracks,[r]:{...i.tracks[r],position:n}}}))},updateTrackRotation:(r,n)=>{t(i=>({tracks:{...i.tracks,[r]:{...i.tracks[r],rotation:n}}}))},setTrackSurfaceColor:(r,n)=>{t(i=>({tracks:{...i.tracks,[r]:{...i.tracks[r],trackSurfaceColor:n}}})),e().addToHistory()},selectTrack:r=>{const{propertiesPanelUserClosed:n}=e();t(n?{selectedTrackId:r,selectedCourtId:null}:{selectedTrackId:r,selectedCourtId:null,showPropertiesPanel:!0})},deselectTrack:()=>{t({selectedTrackId:null,showPropertiesPanel:!1,propertiesPanelUserClosed:!0})},addMotif:(r,n,i,o,s,l=null,c={})=>{const d=`motif-${Date.now()}`,h=e().surface,f={id:d,type:"motif",sourceDesignId:r,sourceDesignName:n,sourceThumbnailUrl:l,solidSvgContent:c.solidSvgContent||i,blendSvgContent:c.blendSvgContent||null,hasBothVersions:c.hasBothVersions||!1,viewMode:"solid",svgContent:c.solidSvgContent||i,originalWidth_mm:o,originalHeight_mm:s,position:{x:h.width_mm/2-o/2,y:h.length_mm/2-s/2},rotation:0,scale:1};t(u=>({motifs:{...u.motifs,[d]:f},elementOrder:[...u.elementOrder,d],selectedMotifId:d,selectedCourtId:null,selectedTrackId:null})),e().addToHistory()},removeMotif:r=>{const{[r]:n,...i}=e().motifs;t(o=>({motifs:i,elementOrder:o.elementOrder.filter(s=>s!==r),selectedMotifId:o.selectedMotifId===r?null:o.selectedMotifId})),e().addToHistory()},updateMotifPosition:(r,n)=>{t(i=>({motifs:{...i.motifs,[r]:{...i.motifs[r],position:n}}}))},updateMotifRotation:(r,n)=>{t(i=>({motifs:{...i.motifs,[r]:{...i.motifs[r],rotation:n}}}))},updateMotifScale:(r,n)=>{t(i=>({motifs:{...i.motifs,[r]:{...i.motifs[r],scale:n}}}))},setMotifViewMode:(r,n)=>{const i=e().motifs[r];if(!i)return;const o=n==="blend"?i.blendSvgContent||i.solidSvgContent:i.solidSvgContent||i.blendSvgContent;t(s=>({motifs:{...s.motifs,[r]:{...s.motifs[r],viewMode:n,svgContent:o}}})),e().addToHistory()},duplicateMotif:r=>{const n=e().motifs[r];if(!n)return;const i=`motif-${Date.now()}`,o={...n,id:i,position:{x:n.position.x+500,y:n.position.y+500}};t(s=>({motifs:{...s.motifs,[i]:o},elementOrder:[...s.elementOrder,i],selectedMotifId:i,selectedCourtId:null,selectedTrackId:null})),e().addToHistory()},refreshMotif:async r=>{const n=e().motifs[r];if(!n)return{success:!1,error:"Motif not found"};try{const{fetchMotifFromDesign:i}=await iC(async()=>{const{fetchMotifFromDesign:c}=await Promise.resolve().then(()=>eE);return{fetchMotifFromDesign:c}},void 0),o=await i(n.sourceDesignId),l=(n.viewMode||"solid")==="blend"?o.blendSvgContent||o.solidSvgContent:o.solidSvgContent||o.blendSvgContent;return t(c=>({motifs:{...c.motifs,[r]:{...c.motifs[r],solidSvgContent:o.solidSvgContent,blendSvgContent:o.blendSvgContent,hasBothVersions:o.hasBothVersions,svgContent:l,sourceThumbnailUrl:o.sourceThumbnailUrl,sourceDesignName:o.sourceDesignName,originalWidth_mm:o.originalWidth_mm,originalHeight_mm:o.originalHeight_mm}},lastModified:Date.now()})),e().addToHistory(),{success:!0}}catch(i){return console.error("[MOTIF] Failed to refresh:",i),{success:!1,error:i.message}}},selectMotif:r=>{const{propertiesPanelUserClosed:n}=e();t(n?{selectedMotifId:r,selectedCourtId:null,selectedTrackId:null}:{selectedMotifId:r,selectedCourtId:null,selectedTrackId:null,showPropertiesPanel:!0})},deselectMotif:()=>{t({selectedMotifId:null,showPropertiesPanel:!1,propertiesPanelUserClosed:!0})},addCustomMarking:r=>{t(n=>({customMarkings:[...n.customMarkings,{...r,id:`custom-${Date.now()}`}]})),e().addToHistory()},removeCustomMarking:r=>{t(n=>({customMarkings:n.customMarkings.filter(i=>i.id!==r)})),e().addToHistory()},addBackgroundZone:r=>{t(n=>({backgroundZones:[...n.backgroundZones,{...r,id:`zone-${Date.now()}`}]})),e().addToHistory()},removeBackgroundZone:r=>{t(n=>({backgroundZones:n.backgroundZones.filter(i=>i.id!==r)})),e().addToHistory()},setDesignName:r=>{t({designName:r})},setDesignDescription:r=>{t({designDescription:r})},setDesignTags:r=>{t({designTags:r})},addToHistory:()=>{const r=e(),n={surface:r.surface,courts:r.courts,tracks:r.tracks,motifs:r.motifs,elementOrder:r.elementOrder,customMarkings:r.customMarkings,backgroundZones:r.backgroundZones};t(i=>{const o=i.history.slice(0,i.historyIndex+1);return o.push(n),o.length>i.maxHistory&&o.shift(),{history:o,historyIndex:o.length-1}})},undo:()=>{const{history:r,historyIndex:n}=e();if(n>0){const i=r[n-1];t({...i,historyIndex:n-1})}},redo:()=>{const{history:r,historyIndex:n}=e();if(n<r.length-1){const i=r[n+1];t({...i,historyIndex:n+1})}},canUndo:()=>e().historyIndex>0,canRedo:()=>e().historyIndex<e().history.length-1,toggleCourtLibrary:()=>{t(r=>({showCourtLibrary:!r.showCourtLibrary}))},togglePropertiesPanel:()=>{t(r=>({showPropertiesPanel:!r.showPropertiesPanel,propertiesPanelUserClosed:!!r.showPropertiesPanel}))},toggleColorEditor:()=>{t(r=>({showColorEditor:!r.showColorEditor}))},toggleSnapToGrid:()=>{t(r=>({snapToGrid:!r.snapToGrid}))},setGridSize:r=>{t({gridSize_mm:r})},toggleStandaloneMode:()=>{t(r=>({standaloneMode:!r.standaloneMode}))},setStandaloneMode:(r,n=null)=>{t({standaloneMode:r,standaloneDesignId:n})},setSaving:r=>{t({isSaving:r})},setLastSaved:r=>{t({lastSaved:r})},loadDesign:r=>{let n=r.elementOrder;!n&&(r.courtOrder||r.trackOrder)&&(n=[...r.trackOrder||[],...r.courtOrder||[]]),t({surface:r.surface||xu.surface,courts:r.courts||{},tracks:r.tracks||{},motifs:r.motifs||{},elementOrder:n||[],customMarkings:r.customMarkings||[],backgroundZones:r.backgroundZones||[],designName:r.name||"Untitled Design",designDescription:r.description||"",designTags:r.tags||[],selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,history:[],historyIndex:-1}),e().addToHistory()},exportDesignData:()=>{const r=e();return{surface:r.surface,courts:r.courts,tracks:r.tracks,motifs:r.motifs,elementOrder:r.elementOrder,customMarkings:r.customMarkings,backgroundZones:r.backgroundZones,name:r.designName,description:r.designDescription,tags:r.designTags}},resetDesign:()=>{t(xu)},hasUnsavedChanges:()=>{const r=e();return Object.keys(r.courts).length>0||Object.keys(r.tracks).length>0||Object.keys(r.motifs).length>0}}),{name:"SportsDesignStore"})),r0={inputMode:"prompt",prompt:"",lengthMM:5e3,widthMM:5e3,selectedFileName:null,uploadedFileUrl:null,arMapping:null,result:null,jobId:null,blendRecipes:null,blendSvgUrl:null,colorMapping:null,blendEditedColors:new Map,solidRecipes:null,solidSvgUrl:null,solidColorMapping:null,solidEditedColors:new Map,viewMode:"solid",showFinalRecipes:!1,showSolidSummary:!1,regionOverrides:new Map,originalTaggedSvg:null,regionOverridesHistory:[new Map],historyIndex:0,designName:"",currentDesignId:null,hasGeneratedContent:!1,lastModified:null},Dc=Sw(kw((t,e)=>({...r0,setInputMode:r=>t({inputMode:r}),setPrompt:r=>t({prompt:r,lastModified:Date.now()}),setDimensions:(r,n)=>t({widthMM:r,lengthMM:n,lastModified:Date.now()}),setArMapping:r=>t({arMapping:r}),setSelectedFile:(r,n)=>t({selectedFileName:r,uploadedFileUrl:n,lastModified:Date.now()}),clearSelectedFile:()=>t({selectedFileName:null,uploadedFileUrl:null}),setGenerationResult:(r,n)=>t({result:r,jobId:n,hasGeneratedContent:!0,lastModified:Date.now()}),setResult:r=>t({result:r,hasGeneratedContent:!!r,lastModified:Date.now()}),setJobId:r=>t({jobId:r}),setBlendState:(r,n,i)=>t({blendRecipes:r,colorMapping:n,blendSvgUrl:i,lastModified:Date.now()}),setBlendRecipes:r=>t({blendRecipes:r,lastModified:Date.now()}),setColorMapping:r=>t({colorMapping:r,lastModified:Date.now()}),setBlendSvgUrl:r=>t({blendSvgUrl:r}),setBlendEditedColors:r=>t({blendEditedColors:r,lastModified:Date.now()}),updateBlendSvgUrl:r=>t({blendSvgUrl:r}),setSolidState:(r,n,i)=>t({solidRecipes:r,solidColorMapping:n,solidSvgUrl:i,lastModified:Date.now()}),setSolidRecipes:r=>t({solidRecipes:r,lastModified:Date.now()}),setSolidColorMapping:r=>t({solidColorMapping:r,lastModified:Date.now()}),setSolidSvgUrl:r=>t({solidSvgUrl:r}),setSolidEditedColors:r=>t({solidEditedColors:r,lastModified:Date.now()}),updateSolidSvgUrl:r=>t({solidSvgUrl:r}),setViewMode:r=>t({viewMode:r}),setShowFinalRecipes:r=>t({showFinalRecipes:r}),setShowSolidSummary:r=>t({showSolidSummary:r}),setOriginalTaggedSvg:r=>t({originalTaggedSvg:r}),setRegionOverrides:r=>t({regionOverrides:r,lastModified:Date.now()}),addRegionOverride:(r,n)=>{const i=new Map(e().regionOverrides);i.set(r,n);const o=e().regionOverridesHistory,s=e().historyIndex,l=o.slice(0,s+1);l.push(new Map(i)),l.length>50&&l.shift(),t({regionOverrides:i,regionOverridesHistory:l,historyIndex:l.length-1,lastModified:Date.now()})},setRegionOverridesHistory:r=>{t(typeof r=="function"?{regionOverridesHistory:r(e().regionOverridesHistory)}:{regionOverridesHistory:r})},setHistoryIndex:r=>{t(typeof r=="function"?{historyIndex:r(e().historyIndex)}:{historyIndex:r})},canUndo:()=>e().historyIndex>0,canRedo:()=>e().historyIndex<e().regionOverridesHistory.length-1,undo:()=>{const{historyIndex:r,regionOverridesHistory:n}=e();if(r>0){const i=r-1;t({historyIndex:i,regionOverrides:new Map(n[i])})}},redo:()=>{const{historyIndex:r,regionOverridesHistory:n}=e();if(r<n.length-1){const i=r+1;t({historyIndex:i,regionOverrides:new Map(n[i])})}},setRegionOverridesHistory:(r,n)=>t({regionOverridesHistory:r,historyIndex:n}),setDesignName:r=>t({designName:r}),setCurrentDesignId:r=>t({currentDesignId:r}),loadDesign:r=>{t({inputMode:r.inputMode||"prompt",prompt:r.prompt||"",lengthMM:r.lengthMM||5e3,widthMM:r.widthMM||5e3,uploadedFileUrl:r.selectedFile||null,result:r.result||null,blendRecipes:r.blendRecipes||null,solidRecipes:r.solidRecipes||null,colorMapping:r.colorMapping||null,solidColorMapping:r.solidColorMapping||null,solidEditedColors:r.solidEditedColors||new Map,blendEditedColors:r.blendEditedColors||new Map,blendSvgUrl:r.blendSvgUrl||null,solidSvgUrl:r.solidSvgUrl||null,viewMode:r.viewMode||"solid",arMapping:r.arMapping||null,jobId:r.jobId||null,showFinalRecipes:r.showFinalRecipes||!1,showSolidSummary:r.showSolidSummary||!1,hasGeneratedContent:!!r.result,lastModified:Date.now()})},exportDesignData:()=>{const r=e();return{inputMode:r.inputMode,prompt:r.prompt,lengthMM:r.lengthMM,widthMM:r.widthMM,uploadedFileUrl:r.uploadedFileUrl,result:r.result,blendRecipes:r.blendRecipes,solidRecipes:r.solidRecipes,colorMapping:r.colorMapping,solidColorMapping:r.solidColorMapping,solidEditedColors:r.solidEditedColors,blendEditedColors:r.blendEditedColors,viewMode:r.viewMode,arMapping:r.arMapping,jobId:r.jobId,showFinalRecipes:r.showFinalRecipes,showSolidSummary:r.showSolidSummary,regionOverrides:r.regionOverrides,designName:r.designName,currentDesignId:r.currentDesignId}},resetDesign:()=>{const{blendSvgUrl:r,solidSvgUrl:n}=e();r&&r.startsWith("blob:")&&URL.revokeObjectURL(r),n&&n.startsWith("blob:")&&URL.revokeObjectURL(n),t({...r0,blendEditedColors:new Map,solidEditedColors:new Map,regionOverrides:new Map,regionOverridesHistory:[new Map]})},hasUnsavedChanges:()=>{const r=e();return r.hasGeneratedContent||r.prompt.trim()!==""||r.selectedFileName!==null}}),{name:"PlaygroundDesignStore"})),jw={"basketball-full":{id:"basketball-full",name:"Basketball (Full Court)",sport:"basketball",standard:"FIBA 2020",category:"court",description:"Official FIBA standard full basketball court with all markings",dimensions:{length_mm:28e3,width_mm:15e3,min_surround_mm:2e3},defaultSurfaceColor:"RH20",defaultLineColor:"RH31",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:15e3,height:28e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"center-line",name:"Center Line",type:"line",params:{x1:0,y1:14e3,x2:15e3,y2:14e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-circle",name:"Center Circle",type:"circle",params:{cx:7500,cy:14e3,radius:1800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"three-point-arc-top",name:"Three-Point Arc (Top)",type:"arc",params:{cx:7500,cy:26425,radius:6750,startAngle:192,endAngle:348},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"three-point-arc-bottom",name:"Three-Point Arc (Bottom)",type:"arc",params:{cx:7500,cy:1575,radius:6750,startAngle:12,endAngle:168},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"three-point-line-bottom-left",name:"Three-Point Line Bottom Left",type:"line",params:{x1:900,y1:0,x2:900,y2:2990},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"three-point-line-bottom-right",name:"Three-Point Line Bottom Right",type:"line",params:{x1:14100,y1:0,x2:14100,y2:2990},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"three-point-line-top-left",name:"Three-Point Line Top Left",type:"line",params:{x1:900,y1:25010,x2:900,y2:28e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"three-point-line-top-right",name:"Three-Point Line Top Right",type:"line",params:{x1:14100,y1:25010,x2:14100,y2:28e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"free-throw-line-top",name:"Free Throw Line (Top)",type:"line",params:{x1:5050,y1:22200,x2:9950,y2:22200},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"free-throw-line-bottom",name:"Free Throw Line (Bottom)",type:"line",params:{x1:5050,y1:5800,x2:9950,y2:5800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"free-throw-circle-top",name:"Free Throw Circle (Top)",type:"circle",params:{cx:7500,cy:22200,radius:1800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"free-throw-circle-bottom",name:"Free Throw Circle (Bottom)",type:"circle",params:{cx:7500,cy:5800,radius:1800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"key-lane-top",name:"Key Lane (Top)",type:"rectangle",params:{x:5050,y:22200,width:4900,height:5800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"key-lane-bottom",name:"Key Lane (Bottom)",type:"rectangle",params:{x:5050,y:0,width:4900,height:5800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"restricted-area-top",name:"Restricted Area (Top)",type:"arc",params:{cx:7500,cy:28e3,radius:1250,startAngle:180,endAngle:360},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"restricted-area-bottom",name:"Restricted Area (Bottom)",type:"arc",params:{cx:7500,cy:0,radius:1250,startAngle:0,endAngle:180},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[{id:"key-area-top",name:"Key Area (Top)",type:"rectangle",params:{x:5050,y:22200,width:4900,height:5800},defaultColor:"RH20",paintable:!0,area_m2:28.42},{id:"key-area-bottom",name:"Key Area (Bottom)",type:"rectangle",params:{x:5050,y:0,width:4900,height:5800},defaultColor:"RH20",paintable:!0,area_m2:28.42}]},"netball-full":{id:"netball-full",name:"Netball (Full Court)",sport:"netball",standard:"World Netball 2020",category:"court",description:"Official World Netball standard court with goal circles and thirds",dimensions:{length_mm:30500,width_mm:15250,min_surround_mm:3050},defaultSurfaceColor:"RH01",defaultLineColor:"RH31",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:15250,height:30500},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"transverse-line-1",name:"Transverse Line 1",type:"line",params:{x1:0,y1:10167,x2:15250,y2:10167},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"transverse-line-2",name:"Transverse Line 2",type:"line",params:{x1:0,y1:20333,x2:15250,y2:20333},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-circle",name:"Center Circle",type:"circle",params:{cx:7625,cy:15250,radius:450},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"goal-circle-bottom",name:"Goal Circle (Bottom)",type:"arc",params:{cx:7625,cy:0,radius:4900,startAngle:0,endAngle:180},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"goal-circle-top",name:"Goal Circle (Top)",type:"arc",params:{cx:7625,cy:30500,radius:4900,startAngle:180,endAngle:360},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"tennis-doubles":{id:"tennis-doubles",name:"Tennis (Doubles)",sport:"tennis",standard:"ITF 2020",category:"court",description:"Official ITF standard doubles tennis court with all service boxes",dimensions:{length_mm:23770,width_mm:10970,min_surround_mm:3660},defaultSurfaceColor:"RH22",defaultLineColor:"RH29",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:10970,height:23770},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"singles-sideline-left",name:"Singles Sideline (Left)",type:"line",params:{x1:1370,y1:0,x2:1370,y2:23770},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"singles-sideline-right",name:"Singles Sideline (Right)",type:"line",params:{x1:9600,y1:0,x2:9600,y2:23770},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"service-line-bottom",name:"Service Line (Bottom)",type:"line",params:{x1:0,y1:6400,x2:10970,y2:6400},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"service-line-top",name:"Service Line (Top)",type:"line",params:{x1:0,y1:17370,x2:10970,y2:17370},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-service-line",name:"Center Service Line",type:"line",params:{x1:5485,y1:6400,x2:5485,y2:17370},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-mark-bottom",name:"Center Mark (Bottom)",type:"line",params:{x1:5485,y1:0,x2:5485,y2:100},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-mark-top",name:"Center Mark (Top)",type:"line",params:{x1:5485,y1:23670,x2:5485,y2:23770},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"futsal-standard":{id:"futsal-standard",name:"Futsal (5-a-side)",sport:"futsal",standard:"FIFA 2020",category:"court",description:"Official FIFA standard futsal court for international matches",dimensions:{length_mm:4e4,width_mm:2e4,min_surround_mm:1e3},defaultSurfaceColor:"RH50",defaultLineColor:"RH30",defaultLineWidth_mm:80,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:2e4,height:4e4},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"boundary"},{id:"center-line",name:"Center Line",type:"line",params:{x1:0,y1:2e4,x2:2e4,y2:2e4},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"center-circle",name:"Center Circle",type:"circle",params:{cx:1e4,cy:2e4,radius:3e3},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"center-spot",name:"Center Spot",type:"circle",params:{cx:1e4,cy:2e4,radius:100},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"penalty-area-bottom",name:"Penalty Area (Bottom)",type:"arc",params:{cx:1e4,cy:0,radius:6e3,startAngle:0,endAngle:180},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"penalty-area-top",name:"Penalty Area (Top)",type:"arc",params:{cx:1e4,cy:4e4,radius:6e3,startAngle:180,endAngle:360},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"penalty-mark-bottom",name:"Penalty Mark (Bottom)",type:"circle",params:{cx:1e4,cy:6e3,radius:100},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"penalty-mark-top",name:"Penalty Mark (Top)",type:"circle",params:{cx:1e4,cy:34e3,radius:100},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"second-penalty-mark-bottom",name:"Second Penalty Mark (Bottom)",type:"circle",params:{cx:1e4,cy:1e4,radius:100},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"second-penalty-mark-top",name:"Second Penalty Mark (Top)",type:"circle",params:{cx:1e4,cy:3e4,radius:100},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"corner-arc-bl",name:"Corner Arc (Bottom Left)",type:"arc",params:{cx:0,cy:0,radius:250,startAngle:0,endAngle:90},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"corner-arc-br",name:"Corner Arc (Bottom Right)",type:"arc",params:{cx:2e4,cy:0,radius:250,startAngle:90,endAngle:180},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"corner-arc-tl",name:"Corner Arc (Top Left)",type:"arc",params:{cx:0,cy:4e4,radius:250,startAngle:270,endAngle:360},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"corner-arc-tr",name:"Corner Arc (Top Right)",type:"arc",params:{cx:2e4,cy:4e4,radius:250,startAngle:180,endAngle:270},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"}],zones:[]},"volleyball-indoor":{id:"volleyball-indoor",name:"Volleyball (Indoor)",sport:"volleyball",standard:"FIVB",category:"court",description:"Official FIVB standard indoor volleyball court with attack lines",dimensions:{length_mm:18e3,width_mm:9e3,min_surround_mm:3e3},defaultSurfaceColor:"RH40",defaultLineColor:"RH29",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:9e3,height:18e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"center-line",name:"Center Line",type:"line",params:{x1:0,y1:9e3,x2:9e3,y2:9e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"attack-line-bottom",name:"Attack Line (Bottom)",type:"line",params:{x1:0,y1:6e3,x2:9e3,y2:6e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"attack-line-top",name:"Attack Line (Top)",type:"line",params:{x1:0,y1:12e3,x2:9e3,y2:12e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"badminton-full":{id:"badminton-full",name:"Badminton (Full Court)",sport:"badminton",standard:"BWF",category:"court",description:"Official BWF standard full badminton court with singles and doubles lines",dimensions:{length_mm:13400,width_mm:6100,min_surround_mm:1e3},defaultSurfaceColor:"RH26",defaultLineColor:"RH12",defaultLineWidth_mm:40,markings:[{id:"boundary",name:"Boundary Lines (Doubles)",type:"rectangle",params:{x:0,y:0,width:6100,height:13400},defaultColor:"RH31",lineWidth_mm:40,required:!0,category:"boundary"},{id:"singles-sideline-left",name:"Singles Sideline (Left)",type:"line",params:{x1:460,y1:0,x2:460,y2:13400},defaultColor:"RH31",lineWidth_mm:40,required:!0,category:"court-marking"},{id:"singles-sideline-right",name:"Singles Sideline (Right)",type:"line",params:{x1:5640,y1:0,x2:5640,y2:13400},defaultColor:"RH31",lineWidth_mm:40,required:!0,category:"court-marking"},{id:"short-service-line-bottom",name:"Short Service Line (Bottom)",type:"line",params:{x1:0,y1:1980,x2:6100,y2:1980},defaultColor:"RH31",lineWidth_mm:40,required:!0,category:"court-marking"},{id:"short-service-line-top",name:"Short Service Line (Top)",type:"line",params:{x1:0,y1:11420,x2:6100,y2:11420},defaultColor:"RH31",lineWidth_mm:40,required:!0,category:"court-marking"},{id:"doubles-long-service-line-bottom",name:"Doubles Long Service Line (Bottom)",type:"line",params:{x1:0,y1:760,x2:6100,y2:760},defaultColor:"RH31",lineWidth_mm:40,required:!0,category:"court-marking"},{id:"doubles-long-service-line-top",name:"Doubles Long Service Line (Top)",type:"line",params:{x1:0,y1:12640,x2:6100,y2:12640},defaultColor:"RH31",lineWidth_mm:40,required:!0,category:"court-marking"},{id:"center-service-line",name:"Center Service Line",type:"line",params:{x1:3050,y1:1980,x2:3050,y2:11420},defaultColor:"RH31",lineWidth_mm:40,required:!0,category:"court-marking"}],zones:[]},"pickleball-standard":{id:"pickleball-standard",name:"Pickleball",sport:"pickleball",standard:"USA Pickleball",category:"court",description:"Official USA Pickleball standard court with non-volley zone (kitchen)",dimensions:{length_mm:13410,width_mm:6100,min_surround_mm:1e3},defaultSurfaceColor:"RH11",defaultLineColor:"RH31",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:6100,height:13410},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"non-volley-zone-line-bottom",name:"Non-Volley Zone Line (Bottom)",type:"line",params:{x1:0,y1:2130,x2:6100,y2:2130},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"non-volley-zone-line-top",name:"Non-Volley Zone Line (Top)",type:"line",params:{x1:0,y1:11280,x2:6100,y2:11280},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-line",name:"Center Line (Net)",type:"line",params:{x1:0,y1:6705,x2:6100,y2:6705},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-service-line",name:"Center Service Line",type:"line",params:{x1:3050,y1:0,x2:3050,y2:13410},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"basketball-half":{id:"basketball-half",name:"Basketball (Half Court / 3x3)",sport:"basketball",standard:"FIBA 3x3",category:"court",description:"Half-court basketball for 3x3 games, practice, or space-constrained areas",dimensions:{length_mm:11e3,width_mm:15e3,min_surround_mm:2e3},defaultSurfaceColor:"RH20",defaultLineColor:"RH31",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:15e3,height:11e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"three-point-arc",name:"Three-Point Arc",type:"arc",params:{cx:7500,cy:1575,radius:6750,startAngle:12,endAngle:168},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"three-point-line-left",name:"Three-Point Line (Left)",type:"line",params:{x1:900,y1:0,x2:900,y2:2990},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"three-point-line-right",name:"Three-Point Line (Right)",type:"line",params:{x1:14100,y1:0,x2:14100,y2:2990},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"free-throw-line",name:"Free Throw Line",type:"line",params:{x1:5050,y1:5800,x2:9950,y2:5800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"free-throw-circle",name:"Free Throw Circle",type:"circle",params:{cx:7500,cy:5800,radius:1800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"key-lane",name:"Key Lane",type:"rectangle",params:{x:5050,y:0,width:4900,height:5800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"restricted-area",name:"Restricted Area",type:"arc",params:{cx:7500,cy:0,radius:1250,startAngle:0,endAngle:180},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[{id:"key-area",name:"Key Area",type:"rectangle",params:{x:5050,y:0,width:4900,height:5800},defaultColor:"RH20",paintable:!0,area_m2:28.42}]},"tennis-singles":{id:"tennis-singles",name:"Tennis (Singles)",sport:"tennis",standard:"ITF",category:"court",description:"Singles-only tennis court without doubles alleys",dimensions:{length_mm:23770,width_mm:8230,min_surround_mm:3660},defaultSurfaceColor:"RH22",defaultLineColor:"RH29",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:8230,height:23770},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"service-line-bottom",name:"Service Line (Bottom)",type:"line",params:{x1:0,y1:6400,x2:8230,y2:6400},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"service-line-top",name:"Service Line (Top)",type:"line",params:{x1:0,y1:17370,x2:8230,y2:17370},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-service-line",name:"Center Service Line",type:"line",params:{x1:4115,y1:6400,x2:4115,y2:17370},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-mark-bottom",name:"Center Mark (Bottom)",type:"line",params:{x1:4115,y1:0,x2:4115,y2:100},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-mark-top",name:"Center Mark (Top)",type:"line",params:{x1:4115,y1:23670,x2:4115,y2:23770},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"mini-tennis-red":{id:"mini-tennis-red",name:"Mini Tennis (Red Court)",sport:"tennis",standard:"ITF Play+Stay",category:"court",description:"Beginner/youth court for red stage tennis coaching (36ft)",dimensions:{length_mm:10970,width_mm:5490,min_surround_mm:2e3},defaultSurfaceColor:"RH02",defaultLineColor:"RH29",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:5490,height:10970},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"net-line",name:"Net Line",type:"line",params:{x1:0,y1:5485,x2:5490,y2:5485},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"service-line-bottom",name:"Service Line (Bottom)",type:"line",params:{x1:0,y1:2745,x2:5490,y2:2745},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"service-line-top",name:"Service Line (Top)",type:"line",params:{x1:0,y1:8225,x2:5490,y2:8225},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-service-line",name:"Center Service Line",type:"line",params:{x1:2745,y1:2745,x2:2745,y2:8225},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"padel-standard":{id:"padel-standard",name:"Padel",sport:"padel",standard:"FIP",category:"court",description:"Official FIP padel court with service boxes",dimensions:{length_mm:2e4,width_mm:1e4,min_surround_mm:0},defaultSurfaceColor:"RH60",defaultLineColor:"RH29",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:1e4,height:2e4},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"net-line",name:"Net Line",type:"line",params:{x1:0,y1:1e4,x2:1e4,y2:1e4},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"service-line-bottom",name:"Service Line (Bottom)",type:"line",params:{x1:0,y1:3e3,x2:1e4,y2:3e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"service-line-top",name:"Service Line (Top)",type:"line",params:{x1:0,y1:17e3,x2:1e4,y2:17e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-service-line-bottom",name:"Center Service Line (Bottom)",type:"line",params:{x1:5e3,y1:0,x2:5e3,y2:3e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-service-line-top",name:"Center Service Line (Top)",type:"line",params:{x1:5e3,y1:17e3,x2:5e3,y2:2e4},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-line",name:"Center Line",type:"line",params:{x1:5e3,y1:3e3,x2:5e3,y2:17e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"handball-standard":{id:"handball-standard",name:"Handball",sport:"handball",standard:"IHF",category:"court",description:"Official IHF handball court with goal areas and penalty lines",dimensions:{length_mm:4e4,width_mm:2e4,min_surround_mm:1e3},defaultSurfaceColor:"RH10",defaultLineColor:"RH31",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:2e4,height:4e4},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"center-line",name:"Center Line",type:"line",params:{x1:0,y1:2e4,x2:2e4,y2:2e4},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"goal-area-bottom",name:"Goal Area (Bottom)",type:"arc",params:{cx:1e4,cy:0,radius:6e3,startAngle:0,endAngle:180},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"goal-area-top",name:"Goal Area (Top)",type:"arc",params:{cx:1e4,cy:4e4,radius:6e3,startAngle:180,endAngle:360},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"free-throw-line-bottom",name:"Free-Throw Line (Bottom)",type:"arc",params:{cx:1e4,cy:0,radius:9e3,startAngle:0,endAngle:180,dashed:!0,dashPattern:"300 150"},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"free-throw-line-top",name:"Free-Throw Line (Top)",type:"arc",params:{cx:1e4,cy:4e4,radius:9e3,startAngle:180,endAngle:360,dashed:!0,dashPattern:"300 150"},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"7m-line-bottom",name:"7m Penalty Line (Bottom)",type:"line",params:{x1:9e3,y1:7e3,x2:11e3,y2:7e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"7m-line-top",name:"7m Penalty Line (Top)",type:"line",params:{x1:9e3,y1:33e3,x2:11e3,y2:33e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"goalkeeper-line-bottom",name:"Goalkeeper Restriction Line (Bottom)",type:"line",params:{x1:9500,y1:4e3,x2:10500,y2:4e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"goalkeeper-line-top",name:"Goalkeeper Restriction Line (Top)",type:"line",params:{x1:9500,y1:36e3,x2:10500,y2:36e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"hockey-d":{id:"hockey-d",name:"Field Hockey D",sport:"hockey",standard:"FIH",category:"overlay",description:"Hockey shooting circle (D) for overlay on sports surfaces",dimensions:{length_mm:14630,width_mm:29260,min_surround_mm:0},defaultSurfaceColor:"RH23",defaultLineColor:"RH29",defaultLineWidth_mm:50,markings:[{id:"shooting-circle",name:"Shooting Circle (D)",type:"arc",params:{cx:14630,cy:0,radius:14630,startAngle:0,endAngle:180},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"goal-line",name:"Goal Line",type:"line",params:{x1:0,y1:0,x2:29260,y2:0},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"penalty-spot",name:"Penalty Spot",type:"circle",params:{cx:14630,cy:6400,radius:150},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"hockey-5s":{id:"hockey-5s",name:"Hockey 5s",sport:"hockey",standard:"England Hockey",category:"court",description:"Scaled-down hockey pitch for 5-a-side games",dimensions:{length_mm:55e3,width_mm:41100,min_surround_mm:2e3},defaultSurfaceColor:"RH23",defaultLineColor:"RH29",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:41100,height:55e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"center-line",name:"Center Line",type:"line",params:{x1:0,y1:27500,x2:41100,y2:27500},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-spot",name:"Center Spot",type:"circle",params:{cx:20550,cy:27500,radius:150},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"shooting-circle-bottom",name:"Shooting Circle (Bottom)",type:"arc",params:{cx:20550,cy:0,radius:9e3,startAngle:0,endAngle:180},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"shooting-circle-top",name:"Shooting Circle (Top)",type:"arc",params:{cx:20550,cy:55e3,radius:9e3,startAngle:180,endAngle:360},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"penalty-spot-bottom",name:"Penalty Spot (Bottom)",type:"circle",params:{cx:20550,cy:6400,radius:150},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"penalty-spot-top",name:"Penalty Spot (Top)",type:"circle",params:{cx:20550,cy:48600,radius:150},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]}},nn=[{code:"RH01",name:"Standard Red",hex:"#A5362F",R:165,G:54,B:47,L:39.4,a:58.5,b:29},{code:"RH02",name:"Bright Red",hex:"#E21F2F",R:226,G:31,B:47,L:47.4,a:70.1,b:44},{code:"RH10",name:"Standard Green",hex:"#609B63",R:96,G:155,B:99,L:40.5,a:-42.2,b:17.9},{code:"RH11",name:"Bright Green",hex:"#3BB44A",R:59,G:180,B:74,L:62.1,a:-47.7,b:47.2},{code:"RH12",name:"Dark Green",hex:"#006C55",R:0,G:108,B:85,L:39.6,a:-38.3,b:13.1},{code:"RH20",name:"Standard Blue",hex:"#0075BC",R:0,G:117,B:188,L:36.4,a:14.2,b:-46.7},{code:"RH21",name:"Purple",hex:"#493D8C",R:73,G:61,B:140,L:31.5,a:41.9,b:-40.9},{code:"RH22",name:"Light Blue",hex:"#47AFE3",R:71,G:175,B:227,L:55.3,a:-19.1,b:-37.3},{code:"RH23",name:"Azure",hex:"#039DC4",R:3,G:157,B:196,L:47.7,a:-4.8,b:-34.8},{code:"RH26",name:"Turquoise",hex:"#00A6A3",R:0,G:166,B:163,L:58.8,a:-38.4,b:-3},{code:"RH30",name:"Standard Beige",hex:"#E4C4AA",R:228,G:196,B:170,L:75.2,a:3.8,b:24.8},{code:"RH31",name:"Cream",hex:"#E8E3D8",R:232,G:227,B:216,L:91.8,a:-.5,b:12.5},{code:"RH32",name:"Brown",hex:"#8B5F3C",R:139,G:95,B:60,L:40,a:15.9,b:27.1},{code:"RH90",name:"Funky Pink",hex:"#E8457E",R:232,G:69,B:126,L:55,a:66.1,b:4.9},{code:"RH40",name:"Mustard Yellow",hex:"#E5A144",R:229,G:161,B:68,L:66,a:8.4,b:56.3},{code:"RH41",name:"Bright Yellow",hex:"#FFD833",R:255,G:216,B:51,L:86.9,a:-1,b:90.6},{code:"RH50",name:"Orange",hex:"#F15B32",R:241,G:91,B:50,L:63.2,a:49.8,b:60.2},{code:"RH60",name:"Dark Grey",hex:"#59595B",R:89,G:89,B:91,L:34.1,a:-.4,b:-2.4},{code:"RH61",name:"Light Grey",hex:"#939598",R:147,G:149,B:152,L:69,a:-.5,b:-1},{code:"RH65",name:"Pale Grey",hex:"#D9D9D6",R:217,G:217,B:214,L:87.6,a:-.2,b:-.7},{code:"RH70",name:"Black",hex:"#231F20",R:35,G:31,B:32,L:9.1,a:-.3,b:-6.3}];function hC(){return Object.values(jw)}function fC(t){return jw[t]||null}function pC(t,e,r){const{type:n,params:i}=t;switch(n){case"line":return gC(i,e,r);case"rectangle":return vC(i,e,r);case"circle":return yC(i,e,r);case"arc":return xC(i,e,r);case"polyline":return bC(i,e,r);default:return console.warn(`Unknown marking type: ${n}`),null}}function mC(t,e){const{type:r,params:n}=t;switch(r){case"rectangle":return{type:"rect",x:n.x,y:n.y,width:n.width,height:n.height,fill:e};case"circle":return{type:"circle",cx:n.cx,cy:n.cy,r:n.radius,fill:e};case"polygon":return{type:"polygon",points:n.points,fill:e};default:return console.warn(`Unknown zone type: ${r}`),null}}function gC(t,e,r){const n={type:"line",x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,stroke:e,strokeWidth:r};return t.dashed&&(n.strokeDasharray=t.dashPattern||"200 100"),n}function vC(t,e,r){return{type:"rect",x:t.x,y:t.y,width:t.width,height:t.height,stroke:e,strokeWidth:r,fill:"none"}}function yC(t,e,r){return{type:"circle",cx:t.cx,cy:t.cy,r:t.radius,stroke:e,strokeWidth:r,fill:"none"}}function xC(t,e,r){const{cx:n,cy:i,radius:o,startAngle:s,endAngle:l}=t,c=s*Math.PI/180,d=l*Math.PI/180,h=n+o*Math.cos(c),f=i+o*Math.sin(c),u=n+o*Math.cos(d),p=i+o*Math.sin(d),g=l-s>180?1:0,x={type:"path",d:`M ${h} ${f} A ${o} ${o} 0 ${g} 1 ${u} ${p}`,stroke:e,strokeWidth:r,fill:"none"};return t.dashed&&(x.strokeDasharray=t.dashPattern||"200 100"),x}function bC(t,e,r){return{type:"polyline",points:t.points.map(i=>`${i[0]},${i[1]}`).join(" "),stroke:e,strokeWidth:r,fill:"none"}}function n0(t){if(t&&t.startsWith("#"))return t;const e=nn.find(r=>r.code===t);return e?e.hex:"#000000"}function wC(t){var s;const{template:e,lineColorOverrides:r,zoneColorOverrides:n}=t;if(!e)return console.error("No template provided for court"),{markings:[],zones:[]};const i=e.markings.map(l=>{var f;const c=((f=r[l.id])==null?void 0:f.hex)||e.defaultLineColor,d=n0(c),h=l.lineWidth_mm||e.defaultLineWidth_mm;return{id:l.id,name:l.name,...pC(l,d,h)}}).filter(Boolean),o=((s=e.zones)==null?void 0:s.map(l=>{var h;const c=((h=n[l.id])==null?void 0:h.hex)||l.defaultColor,d=n0(c);return{id:l.id,name:l.name,...mC(l,d)}}).filter(Boolean))||[];return{markings:i,zones:o}}function i0(t,e){return Math.round(t/e)*e}function _C(t,e){return{x:i0(t.x,e),y:i0(t.y,e)}}function Cw(t){let e=t%360;return e<0&&(e+=360),e}function o0(t,e,r){const{width_mm:n,length_mm:i}=e,{width_mm:o,length_mm:s}=r,l=500,c=-(n-l),d=o-l,h=-(i-l),f=s-l;return{x:Math.max(c,Math.min(t.x,d)),y:Math.max(h,Math.min(t.y,f))}}function SC(t){const{position:e,rotation:r,scale:n,template:i}=t,o=i.dimensions.width_mm/2,s=i.dimensions.length_mm/2;return`translate(${e.x}, ${e.y}) scale(${n}) rotate(${r}, ${o}, ${s})`}function kC({court:t,svgRef:e}){const{updateCourtRotation:r,updateCourtScale:n,updateCourtPosition:i,addToHistory:o}=Qe(),[s,l]=A.useState(!1),[c,d]=A.useState(!1),[h,f]=A.useState(null),[u,p]=A.useState(null),{template:g,position:m,rotation:x,scale:v}=t,y=g.dimensions.width_mm*v,b=g.dimensions.length_mm*v,w=m.x+g.dimensions.width_mm*v/2,k=m.y+g.dimensions.length_mm*v/2,S=g.dimensions.width_mm/2,C=-1e3,T=(_,V)=>{if(!e.current)return{x:0,y:0};const re=e.current.createSVGPoint();re.x=_,re.y=V;const I=re.matrixTransform(e.current.getScreenCTM().inverse());return{x:I.x,y:I.y}},R=_=>{_.stopPropagation(),l(!0),p({x:_.clientX,y:_.clientY})},O=(_,V)=>{_.stopPropagation(),d(!0),f(V),p({x:_.clientX,y:_.clientY,initialScale:v,initialWidth:y,initialHeight:b,initialPosition:{...m}})};A.useEffect(()=>{if(!s&&!c)return;const _=re=>{if(s){const I=T(re.clientX,re.clientY),q=I.x-w,D=I.y-k;let J=Math.atan2(D,q)*(180/Math.PI)+90;J=Cw(J),re.shiftKey&&(J=Math.round(J/15)*15),r(t.id,J)}else if(c&&u){const I=T(re.clientX,re.clientY),q=T(u.x,u.y),D=I.x-q.x,J=I.y-q.y;let U=u.initialScale,G={...m};switch(h){case"se":U=Math.max(.3,u.initialScale+D/g.dimensions.width_mm);break;case"nw":U=Math.max(.3,u.initialScale-D/g.dimensions.width_mm),G.x=u.initialPosition.x+(u.initialWidth-g.dimensions.width_mm*U),G.y=u.initialPosition.y+(u.initialHeight-g.dimensions.length_mm*U);break;case"ne":U=Math.max(.3,u.initialScale+D/g.dimensions.width_mm),G.y=u.initialPosition.y+(u.initialHeight-g.dimensions.length_mm*U);break;case"sw":U=Math.max(.3,u.initialScale-D/g.dimensions.width_mm),G.x=u.initialPosition.x+(u.initialWidth-g.dimensions.width_mm*U);break;case"e":U=Math.max(.3,u.initialScale+D/g.dimensions.width_mm);break;case"w":U=Math.max(.3,u.initialScale-D/g.dimensions.width_mm),G.x=u.initialPosition.x+(u.initialWidth-g.dimensions.width_mm*U);break;case"n":U=Math.max(.3,u.initialScale-J/g.dimensions.length_mm),G.y=u.initialPosition.y+(u.initialHeight-g.dimensions.length_mm*U);break;case"s":U=Math.max(.3,u.initialScale+J/g.dimensions.length_mm);break}U=Math.min(3,Math.max(.3,U)),n(t.id,U),(G.x!==m.x||G.y!==m.y)&&i(t.id,G)}},V=()=>{(s||c)&&o(),l(!1),d(!1),f(null),p(null)};return window.addEventListener("mousemove",_),window.addEventListener("mouseup",V),()=>{window.removeEventListener("mousemove",_),window.removeEventListener("mouseup",V)}},[s,c,u,w,k,t.id,m,v,h]);const Y=[{type:"nw",x:0,y:0,cursor:"nwse-resize"},{type:"n",x:g.dimensions.width_mm/2,y:0,cursor:"ns-resize"},{type:"ne",x:g.dimensions.width_mm,y:0,cursor:"nesw-resize"},{type:"e",x:g.dimensions.width_mm,y:g.dimensions.length_mm/2,cursor:"ew-resize"},{type:"se",x:g.dimensions.width_mm,y:g.dimensions.length_mm,cursor:"nwse-resize"},{type:"s",x:g.dimensions.width_mm/2,y:g.dimensions.length_mm,cursor:"ns-resize"},{type:"sw",x:0,y:g.dimensions.length_mm,cursor:"nesw-resize"},{type:"w",x:0,y:g.dimensions.length_mm/2,cursor:"ew-resize"}],E=300,B=250;return a.jsxs("g",{className:"transform-handles",children:[a.jsxs("g",{className:"rotation-handle",onMouseDown:R,style:{cursor:s?"grabbing":"grab"},children:[a.jsx("line",{x1:S,y1:0,x2:S,y2:C+B,stroke:"#007bff",strokeWidth:30,strokeDasharray:"100 50"}),a.jsx("circle",{cx:S,cy:C,r:B,fill:"white",stroke:"#007bff",strokeWidth:40}),a.jsx("path",{d:`M ${S-B*.4} ${C}
              A ${B*.5} ${B*.5} 0 1 1 ${S+B*.4} ${C}`,fill:"none",stroke:"#007bff",strokeWidth:30,strokeLinecap:"round"}),a.jsx("path",{d:`M ${S+B*.4} ${C}
              L ${S+B*.6} ${C-B*.2}
              M ${S+B*.4} ${C}
              L ${S+B*.6} ${C+B*.2}`,fill:"none",stroke:"#007bff",strokeWidth:30,strokeLinecap:"round"})]}),Y.map(_=>a.jsx("rect",{className:`scale-handle scale-handle--${_.type}`,x:_.x-E/2,y:_.y-E/2,width:E,height:E,fill:"white",stroke:"#007bff",strokeWidth:40,rx:30,ry:30,style:{cursor:c&&h===_.type?"grabbing":_.cursor,pointerEvents:"all"},onMouseDown:V=>O(V,_.type)},_.type)),s&&a.jsxs("text",{x:g.dimensions.width_mm/2,y:-1e3-B-200,textAnchor:"middle",fontSize:400,fill:"#007bff",fontWeight:"bold",style:{pointerEvents:"none"},children:[Math.round(x),""]}),c&&a.jsxs("text",{x:g.dimensions.width_mm/2,y:g.dimensions.length_mm+600,textAnchor:"middle",fontSize:400,fill:"#007bff",fontWeight:"bold",style:{pointerEvents:"none"},children:[(v*100).toFixed(0),"%"]})]})}function Ew(t){const{width_mm:e,height_mm:r,numLanes:n,laneWidth_mm:i,cornerRadius:o={topLeft:3e3,topRight:3e3,bottomLeft:3e3,bottomRight:3e3},lineWidth_mm:s=50}=t,l=[];if(o.topLeft===0&&o.topRight===0&&o.bottomLeft===0&&o.bottomRight===0){const d=n*i;for(let h=0;h<n;h++){const f=h*i;l.push({laneNumber:h+1,innerPath:null,outerPath:jC(i,r,h),perimeter:2*r/1e3,isParallel:!0,laneX:f,laneWidth:i})}return{lanes:l,totalWidth:d,totalLength:r,usableWidth:d,usableHeight:r,isStraightTrack:!0}}else for(let d=0;d<n;d++){const h=d*i,f=(d+1)*i,u=Math.max(0,e-f*2),p=Math.max(0,r-f*2),g=Math.max(0,e-h*2),m=Math.max(0,r-h*2),x={topLeft:Math.max(0,o.topLeft-f),topRight:Math.max(0,o.topRight-f),bottomLeft:Math.max(0,o.bottomLeft-f),bottomRight:Math.max(0,o.bottomRight-f)},v={topLeft:Math.max(0,o.topLeft-h),topRight:Math.max(0,o.topRight-h),bottomLeft:Math.max(0,o.bottomLeft-h),bottomRight:Math.max(0,o.bottomRight-h)};l.push({laneNumber:d+1,innerPath:s0(u,p,x,f),outerPath:s0(g,m,v,h),perimeter:CC(g,m,v),isParallel:!1})}return{lanes:l,totalWidth:e,totalLength:r,usableWidth:e-n*i*2,usableHeight:r-n*i*2}}function s0(t,e,r,n=0){if(t<=0||e<=0)return`M ${n} ${n} L ${n} ${n}`;const i=Math.min(t/2,e/2),o=Math.min(r.topLeft,i),s=Math.min(r.topRight,i),l=Math.min(r.bottomRight,i),c=Math.min(r.bottomLeft,i),d=n,h=n+t,f=n,u=n+e;return`
    M ${d+o} ${f}
    L ${h-s} ${f}
    ${s>0?`A ${s} ${s} 0 0 1 ${h} ${f+s}`:""}
    L ${h} ${u-l}
    ${l>0?`A ${l} ${l} 0 0 1 ${h-l} ${u}`:""}
    L ${d+c} ${u}
    ${c>0?`A ${c} ${c} 0 0 1 ${d} ${u-c}`:""}
    L ${d} ${f+o}
    ${o>0?`A ${o} ${o} 0 0 1 ${d+o} ${f}`:""}
    Z
  `.trim().replace(/\s+/g," ")}function jC(t,e,r){const n=r*t;return`M ${n} 0 L ${n+t} 0 L ${n+t} ${e} L ${n} ${e} Z`}function CC(t,e,r){if(t<=0||e<=0)return 0;const n=Math.min(t/2,e/2),i=Math.min(r.topLeft,n),o=Math.min(r.topRight,n),s=Math.min(r.bottomRight,n),l=Math.min(r.bottomLeft,n),c=t-i-o,d=e-o-s,h=t-s-l,f=e-l-i,u=Math.PI*i/2,p=Math.PI*o/2,g=Math.PI*s/2,m=Math.PI*l/2;return(c+d+h+f+u+p+g+m)/1e3}function Tw(t){if(!t||!t.lanes||t.lanes.length===0)return[];const e=t.lanes.length-1,r=t.lanes[e].perimeter;return t.lanes.map((n,i)=>n.perimeter-r)}function a0(t,e,r){const{width_mm:n,height_mm:i,laneWidth_mm:o,cornerRadius:s={topLeft:3e3,topRight:3e3,bottomLeft:3e3,bottomRight:3e3}}=r,l=t*o,c=Math.max(0,n-l*2),d=Math.max(0,i-l*2),h=Math.min(c/2,d/2),f=Math.min(Math.max(0,s.topLeft-l),h),u=Math.min(Math.max(0,s.topRight-l),h),p=Math.min(Math.max(0,s.bottomRight-l),h),g=Math.min(Math.max(0,s.bottomLeft-l),h),m=l,x=l+c,v=l,y=l+d,b=[{type:"arc",length:Math.PI*g/2,radius:g,corner:"bottomLeft"},{type:"straight",length:d-g-f,dir:"up"},{type:"arc",length:Math.PI*f/2,radius:f,corner:"topLeft"},{type:"straight",length:c-f-u,dir:"right"},{type:"arc",length:Math.PI*u/2,radius:u,corner:"topRight"},{type:"straight",length:d-u-p,dir:"down"},{type:"arc",length:Math.PI*p/2,radius:p,corner:"bottomRight"},{type:"straight",length:c-p-g,dir:"left"}];let w=e;const k=b.reduce((C,T)=>C+T.length,0);for(;w<0;)w+=k;for(;w>=k;)w-=k;let S=0;for(const C of b){if(w<=S+C.length){const T=w-S,R=C.length>0?T/C.length:0;return C.type==="arc"?EC(C,R,{left:m,right:x,top:v,bottom:y,tl:f,tr:u,br:p,bl:g}):TC(C,R,{left:m,right:x,top:v,bottom:y,tl:f,tr:u,br:p,bl:g})}S+=C.length}return{x:m,y:y-g,angle:-Math.PI/2}}function EC(t,e,r){const{left:n,right:i,top:o,bottom:s,tl:l,tr:c,br:d,bl:h}=r,f=e*(Math.PI/2);switch(t.corner){case"bottomLeft":{const u=n+h,p=s-h,m=Math.PI/2+f;return{x:u+h*Math.cos(m),y:p+h*Math.sin(m),angle:m+Math.PI/2}}case"topLeft":{const u=n+l,p=o+l,m=Math.PI+f;return{x:u+l*Math.cos(m),y:p+l*Math.sin(m),angle:m+Math.PI/2}}case"topRight":{const u=i-c,p=o+c,m=-Math.PI/2+f;return{x:u+c*Math.cos(m),y:p+c*Math.sin(m),angle:m+Math.PI/2}}case"bottomRight":{const u=i-d,p=s-d,m=0+f;return{x:u+d*Math.cos(m),y:p+d*Math.sin(m),angle:m+Math.PI/2}}default:return{x:n,y:o,angle:0}}}function TC(t,e,r){const{left:n,right:i,top:o,bottom:s,tl:l,tr:c,br:d,bl:h}=r;switch(t.dir){case"up":{const f=s-h,u=o+l;return{x:n,y:f+e*(u-f),angle:-Math.PI/2}}case"right":{const f=n+l,u=i-c;return{x:f+e*(u-f),y:o,angle:0}}case"down":{const f=o+c,u=s-d;return{x:i,y:f+e*(u-f),angle:Math.PI/2}}case"left":{const f=i-d,u=n+h;return{x:f+e*(u-f),y:s,angle:Math.PI}}default:return{x:n,y:o,angle:0}}}function bu(t,e,r){const n=a0(t,e,r),i=a0(t+1,e,r);return{x:(n.x+i.x)/2,y:(n.y+i.y)/2,angle:n.angle,innerX:i.x,innerY:i.y,outerX:n.x,outerY:n.y}}function l0(t,e,r){const{width_mm:n,height_mm:i,laneWidth_mm:o,cornerRadius:s={topLeft:3e3,topRight:3e3,bottomLeft:3e3,bottomRight:3e3}}=r,l=t*o,c=Math.max(0,n-l*2),d=Math.max(0,i-l*2),h=Math.min(c/2,d/2),f=Math.min(Math.max(0,s.topLeft-l),h),u=Math.min(Math.max(0,s.topRight-l),h),p=Math.min(Math.max(0,s.bottomRight-l),h),g=Math.min(Math.max(0,s.bottomLeft-l),h),m=[{type:"arc",length:Math.PI*g/2,corner:"bottomLeft"},{type:"straight",length:d-g-f,dir:"up"},{type:"arc",length:Math.PI*f/2,corner:"topLeft"},{type:"straight",length:c-f-u,dir:"right"},{type:"arc",length:Math.PI*u/2,corner:"topRight"},{type:"straight",length:d-u-p,dir:"down"},{type:"arc",length:Math.PI*p/2,corner:"bottomRight"},{type:"straight",length:c-p-g,dir:"left"}],x=m.reduce((b,w)=>b+w.length,0);let v=e;for(;v<0;)v+=x;for(;v>=x;)v-=x;let y=0;for(let b=0;b<m.length;b++){if(v<=y+m[b].length){const w=v-y,k=m[b].length>0?w/m[b].length:0;return{segmentIndex:b,t:k,segments:m,totalPerimeter:x}}y+=m[b].length}return{segmentIndex:0,t:0,segments:m,totalPerimeter:x}}function c0(t,e,r,n){const i=l0(r,e,n),o=l0(t,0,n);let s=0;for(let d=0;d<i.segmentIndex;d++)s+=o.segments[d].length;const l=o.segments[i.segmentIndex].length;return s+i.t*l}function RC({track:t,svgRef:e}){const{updateTrackParameters:r,updateTrackPosition:n,updateTrackRotation:i,addToHistory:o}=Qe(),[s,l]=A.useState(!1),[c,d]=A.useState(!1),[h,f]=A.useState(null),[u,p]=A.useState(null),{parameters:g,position:m,rotation:x}=t,v=g.width_mm,y=g.height_mm,b=m.x+v/2,w=m.y+y/2,k=v/2,S=-1e3,C=(E,B)=>{if(!e.current)return{x:0,y:0};const _=e.current.createSVGPoint();_.x=E,_.y=B;const V=_.matrixTransform(e.current.getScreenCTM().inverse());return{x:V.x,y:V.y}},T=E=>{E.stopPropagation(),d(!0),p({x:E.clientX,y:E.clientY})},R=(E,B)=>{E.stopPropagation(),l(!0),f(B);const _=C(E.clientX,E.clientY);p({screenX:E.clientX,screenY:E.clientY,svgX:_.x,svgY:_.y,initialWidth:v,initialHeight:y,initialPosition:{...m},initialCornerRadius:{...g.cornerRadius}})};A.useEffect(()=>{if(!s&&!c)return;const E=_=>{if(c){const oe=C(_.clientX,_.clientY),ae=oe.x-b,le=oe.y-w;let ce=Math.atan2(le,ae)*(180/Math.PI)+90;ce=Cw(ce),_.shiftKey&&(ce=Math.round(ce/15)*15),i(t.id,ce);return}if(!u)return;const V=C(_.clientX,_.clientY),re=V.x-u.svgX,I=V.y-u.svgY;let q=u.initialWidth,D=u.initialHeight,J={...m},U={...u.initialCornerRadius};const G=3e3;switch(h){case"se":q=Math.max(G,u.initialWidth+re),D=Math.max(G,u.initialHeight+I);const oe=Math.min(q/u.initialWidth,D/u.initialHeight);U={topLeft:u.initialCornerRadius.topLeft*oe,topRight:u.initialCornerRadius.topRight*oe,bottomLeft:u.initialCornerRadius.bottomLeft*oe,bottomRight:u.initialCornerRadius.bottomRight*oe};break;case"nw":q=Math.max(G,u.initialWidth-re),D=Math.max(G,u.initialHeight-I),J.x=u.initialPosition.x+(u.initialWidth-q),J.y=u.initialPosition.y+(u.initialHeight-D);const ae=Math.min(q/u.initialWidth,D/u.initialHeight);U={topLeft:u.initialCornerRadius.topLeft*ae,topRight:u.initialCornerRadius.topRight*ae,bottomLeft:u.initialCornerRadius.bottomLeft*ae,bottomRight:u.initialCornerRadius.bottomRight*ae};break;case"ne":q=Math.max(G,u.initialWidth+re),D=Math.max(G,u.initialHeight-I),J.y=u.initialPosition.y+(u.initialHeight-D);const le=Math.min(q/u.initialWidth,D/u.initialHeight);U={topLeft:u.initialCornerRadius.topLeft*le,topRight:u.initialCornerRadius.topRight*le,bottomLeft:u.initialCornerRadius.bottomLeft*le,bottomRight:u.initialCornerRadius.bottomRight*le};break;case"sw":q=Math.max(G,u.initialWidth-re),D=Math.max(G,u.initialHeight+I),J.x=u.initialPosition.x+(u.initialWidth-q);const ce=Math.min(q/u.initialWidth,D/u.initialHeight);U={topLeft:u.initialCornerRadius.topLeft*ce,topRight:u.initialCornerRadius.topRight*ce,bottomLeft:u.initialCornerRadius.bottomLeft*ce,bottomRight:u.initialCornerRadius.bottomRight*ce};break;case"e":q=Math.max(G,u.initialWidth+re);const be=q/u.initialWidth;U={topLeft:u.initialCornerRadius.topLeft*be,topRight:u.initialCornerRadius.topRight*be,bottomLeft:u.initialCornerRadius.bottomLeft*be,bottomRight:u.initialCornerRadius.bottomRight*be};break;case"w":q=Math.max(G,u.initialWidth-re),J.x=u.initialPosition.x+(u.initialWidth-q);const Ce=q/u.initialWidth;U={topLeft:u.initialCornerRadius.topLeft*Ce,topRight:u.initialCornerRadius.topRight*Ce,bottomLeft:u.initialCornerRadius.bottomLeft*Ce,bottomRight:u.initialCornerRadius.bottomRight*Ce};break;case"n":D=Math.max(G,u.initialHeight-I),J.y=u.initialPosition.y+(u.initialHeight-D);const ue=D/u.initialHeight;U={topLeft:u.initialCornerRadius.topLeft*ue,topRight:u.initialCornerRadius.topRight*ue,bottomLeft:u.initialCornerRadius.bottomLeft*ue,bottomRight:u.initialCornerRadius.bottomRight*ue};break;case"s":D=Math.max(G,u.initialHeight+I);const de=D/u.initialHeight;U={topLeft:u.initialCornerRadius.topLeft*de,topRight:u.initialCornerRadius.topRight*de,bottomLeft:u.initialCornerRadius.bottomLeft*de,bottomRight:u.initialCornerRadius.bottomRight*de};break}const fe=Math.min(q,D)/2;U={topLeft:Math.min(U.topLeft,fe),topRight:Math.min(U.topRight,fe),bottomLeft:Math.min(U.bottomLeft,fe),bottomRight:Math.min(U.bottomRight,fe)},r(t.id,{width_mm:q,height_mm:D,cornerRadius:U}),(J.x!==m.x||J.y!==m.y)&&n(t.id,J)},B=()=>{(s||c)&&o(),l(!1),d(!1),f(null),p(null)};return window.addEventListener("mousemove",E),window.addEventListener("mouseup",B),()=>{window.removeEventListener("mousemove",E),window.removeEventListener("mouseup",B)}},[s,u,h,t.id,m,g,r,n,o]);const O=[{type:"nw",x:0,y:0,cursor:"nwse-resize"},{type:"n",x:v/2,y:0,cursor:"ns-resize"},{type:"ne",x:v,y:0,cursor:"nesw-resize"},{type:"e",x:v,y:y/2,cursor:"ew-resize"},{type:"se",x:v,y,cursor:"nwse-resize"},{type:"s",x:v/2,y,cursor:"ns-resize"},{type:"sw",x:0,y,cursor:"nesw-resize"},{type:"w",x:0,y:y/2,cursor:"ew-resize"}],Y=400;return a.jsxs("g",{className:"track-resize-handles",children:[a.jsxs("g",{className:"rotation-handle-group",children:[a.jsx("line",{x1:k,y1:0,x2:k,y2:S,stroke:"#0066CC",strokeWidth:30,strokeDasharray:"100 100",opacity:.5,style:{pointerEvents:"none"}}),a.jsx("circle",{className:"rotation-handle",cx:k,cy:S,r:Y/2,fill:"white",stroke:"#0066CC",strokeWidth:50,style:{cursor:c?"grabbing":"grab",pointerEvents:"all"},onMouseDown:T}),a.jsx("path",{d:`M ${k-100} ${S-50}
              A 100 100 0 1 1 ${k+100} ${S-50}`,fill:"none",stroke:"#0066CC",strokeWidth:40,strokeLinecap:"round",style:{pointerEvents:"none"}}),a.jsx("path",{d:`M ${k+100} ${S-50}
              L ${k+80} ${S-120}
              L ${k+150} ${S-80}
              Z`,fill:"#0066CC",style:{pointerEvents:"none"}})]}),O.map(E=>a.jsx("rect",{className:`resize-handle resize-handle--${E.type}`,x:E.x-Y/2,y:E.y-Y/2,width:Y,height:Y,fill:"white",stroke:"#0066CC",strokeWidth:50,rx:40,ry:40,style:{cursor:s&&h===E.type?"grabbing":E.cursor,pointerEvents:"all"},onMouseDown:B=>R(B,E.type)},E.type)),s&&a.jsxs("text",{x:v/2,y:y+800,textAnchor:"middle",fontSize:400,fill:"#0066CC",fontWeight:"bold",style:{pointerEvents:"none"},children:[(v/1e3).toFixed(1),"m  ",(y/1e3).toFixed(1),"m"]}),c&&a.jsxs("text",{x:v/2,y:-1500,textAnchor:"middle",fontSize:400,fill:"#0066CC",fontWeight:"bold",style:{pointerEvents:"none"},children:[x.toFixed(0),""]})]})}function NC({geometry:t,parameters:e,boxConfig:r,surfaceColor:n,isStraightTrack:i}){if(!r||!r.enabled)return null;const{depth_mm:o=400,lineWidth_mm:s=50,perLaneOffsets:l=[],style:c="staggered",direction:d="counterclockwise",startPosition:h=0}=r,f=n||"#A5362F",u="#FFFFFF",p=c==="staggered"||c==="both",g=c==="straight"||c==="both";return a.jsx("g",{className:"starting-boxes",children:t.lanes.map((m,x)=>{const v=x+1;return i?PC(x,v,e,t,o,s,f,u,p,g,l,d):OC(x,v,e,t,o,s,f,u,p,g,l,d,h)})})}function PC(t,e,r,n,i,o,s,l,c,d,h,f){const u=t*r.laneWidth_mm,p=r.laneWidth_mm,g=f==="clockwise",m=g?n.totalLength-i:0,x=g?0:n.totalLength-i,v=(h[t]||0)*1e3,y=[];if(c&&!d){const b=g?m-v:m+v;y.push(a.jsx(Fl,{x:u,y:b,width:p,height:i,laneNumber:e,boxFillColor:s,lineColor:l,lineWidth:o,flipLine:g},`stagger-${e}`))}else if(d&&!c)y.push(a.jsx(Fl,{x:u,y:m,width:p,height:i,laneNumber:e,boxFillColor:s,lineColor:l,lineWidth:o,flipLine:g},`straight-${e}`));else if(c&&d){const b=g?m-v:m+v;y.push(a.jsx(Fl,{x:u,y:b,width:p,height:i,laneNumber:e,boxFillColor:s,lineColor:l,lineWidth:o,flipLine:g},`stagger-${e}`)),y.push(a.jsx(Fl,{x:u,y:x,width:p,height:i,laneNumber:e,boxFillColor:s,lineColor:l,lineWidth:o,flipLine:!g},`straight-${e}`))}return a.jsx("g",{children:y},`lane-boxes-${e}`)}function Fl({x:t,y:e,width:r,height:n,laneNumber:i,boxFillColor:o,lineColor:s,lineWidth:l,flipLine:c}){const d=c?e+n:e;return a.jsxs("g",{children:[a.jsx("rect",{x:t,y:e,width:r,height:n,fill:o,stroke:"none",pointerEvents:"none"}),a.jsx("line",{x1:t,y1:d,x2:t+r,y2:d,stroke:s,strokeWidth:l,strokeLinecap:"butt",pointerEvents:"none"}),a.jsx("text",{x:t+r/2,y:e+n/2,fontSize:Math.min(r*.4,r*.5),fill:s,textAnchor:"middle",dominantBaseline:"middle",fontWeight:"bold",pointerEvents:"none",opacity:"0.8",children:i})]})}function OC(t,e,r,n,i,o,s,l,c,d,h,f,u=0){var C,T;const p=f==="clockwise",g=n.lanes.length-1,m=(((C=n.lanes[g])==null?void 0:C.perimeter)||0)*1e3,x=m/2,v=u/100*m,y=c0(t,v,g,r),w=(((T=n.lanes[t])==null?void 0:T.perimeter)||0)*1e3/2,k=(h[t]||0)*1e3,S=[];if(c&&!d){const R=p?y+w+k:y+k;S.push(a.jsx(Bl,{index:t,laneNumber:e,distance:R,depth_mm:i,parameters:r,boxFillColor:s,lineColor:l,lineWidth:o},`stagger-${e}`))}else if(d&&!c){const R=p?y+w:y;S.push(a.jsx(Bl,{index:t,laneNumber:e,distance:R,depth_mm:i,parameters:r,boxFillColor:s,lineColor:l,lineWidth:o},`straight-${e}`))}else if(c&&d){const R=p?y+w+k:y+k,O=p?v:v+x,Y=c0(t,O,g,r),E=Y;S.push(a.jsx(Bl,{index:t,laneNumber:e,distance:R,depth_mm:i,parameters:r,boxFillColor:s,lineColor:l,lineWidth:o},`stagger-${e}`)),S.push(a.jsx(Bl,{index:t,laneNumber:e,distance:E,depth_mm:i,parameters:r,boxFillColor:s,lineColor:l,lineWidth:o},`straight-${e}`))}return a.jsx("g",{children:S},`lane-boxes-${e}`)}function Bl({index:t,laneNumber:e,distance:r,depth_mm:n,parameters:i,boxFillColor:o,lineColor:s,lineWidth:l}){const c=bu(t,r,i),d=c.angle+Math.PI/2,h=i.laneWidth_mm/2,f=c.x+Math.cos(d)*h,u=c.y+Math.sin(d)*h,p=c.x-Math.cos(d)*h,g=c.y-Math.sin(d)*h,m=bu(t,r+n,i),x=m.angle+Math.PI/2,v=m.x+Math.cos(x)*h,y=m.y+Math.sin(x)*h,b=m.x-Math.cos(x)*h,w=m.y-Math.sin(x)*h,k=bu(t,r+n/2,i),S=`
    M ${f} ${u}
    L ${p} ${g}
    L ${b} ${w}
    L ${v} ${y}
    Z
  `.trim().replace(/\s+/g," ");return a.jsxs("g",{children:[a.jsx("path",{d:S,fill:o,stroke:"none",pointerEvents:"none"}),a.jsx("line",{x1:f,y1:u,x2:p,y2:g,stroke:s,strokeWidth:l,strokeLinecap:"butt",pointerEvents:"none"}),a.jsx("text",{x:k.x,y:k.y,fontSize:i.laneWidth_mm*.5,fill:s,textAnchor:"middle",dominantBaseline:"middle",fontWeight:"bold",pointerEvents:"none",opacity:"0.8",transform:`rotate(${k.angle*180/Math.PI+90}, ${k.x}, ${k.y})`,children:e})]})}function AC({track:t,isSelected:e,onMouseDown:r,onDoubleClick:n,svgRef:i}){var b,w,k;const{parameters:o,position:s,rotation:l,trackSurfaceColor:c}=t,d=Ew(o),h=d.lanes.length>0&&d.lanes[0].isParallel===!0,f=d.totalWidth,u=d.totalLength,p=f/2,g=u/2,m=`translate(${s.x}, ${s.y}) rotate(${l}, ${p}, ${g})`,x=(c==null?void 0:c.hex)||"#A5362F",v="#FFFFFF",y=o.lineWidth_mm||50;return console.log("TrackRenderer - trackSurfaceColor:",c),console.log("TrackRenderer - surfaceColor:",x),console.log("TrackRenderer - geometry.lanes.length:",d.lanes.length),a.jsxs("g",{className:`track-element ${e?"track-element--selected":""}`,transform:m,style:{cursor:"move"},children:[a.jsx("rect",{x:"0",y:"0",width:f,height:u,fill:"none",pointerEvents:"all",onMouseDown:r,onDoubleClick:n,style:{cursor:"move"}}),h?d.lanes.map(S=>a.jsx("path",{d:S.outerPath,fill:x,stroke:"none",pointerEvents:"none"},`lane-fill-${S.laneNumber}`)):a.jsx("path",{d:`${d.lanes[0].outerPath} ${d.lanes[d.lanes.length-1].innerPath}`,fill:x,fillRule:"evenodd",stroke:"none",pointerEvents:"none"}),d.lanes.map((S,C)=>a.jsx(MC,{lane:S,lineColor:v,lineWidth:y,isLastLane:C===d.lanes.length-1,isStraightTrack:h,geometry:d},`stroke-${S.laneNumber}`)),((b=o.startingBoxes)==null?void 0:b.enabled)&&a.jsx(NC,{geometry:d,parameters:o,boxConfig:{...o.startingBoxes,perLaneOffsets:((w=t.template)==null?void 0:w.trackType)==="curved"?Tw(d):[]},surfaceColor:x,isStraightTrack:((k=t.template)==null?void 0:k.trackType)==="straight"}),e&&a.jsxs(a.Fragment,{children:[a.jsx("rect",{x:"-10",y:"-10",width:f+20,height:u+20,fill:"none",stroke:"#0066CC",strokeWidth:"80",strokeDasharray:"400 400",opacity:"0.5",pointerEvents:"none"}),a.jsx(RC,{track:t,svgRef:i})]})]})}function MC({lane:t,lineColor:e,lineWidth:r,isLastLane:n,isStraightTrack:i,geometry:o}){const{innerPath:s,outerPath:l}=t,c=50;return i?a.jsxs("g",{className:"track-lane-stroke",children:[t.laneNumber===1&&a.jsx("line",{x1:t.laneX,y1:0,x2:t.laneX,y2:o.totalLength,stroke:e,strokeWidth:c,pointerEvents:"none"}),a.jsx("line",{x1:t.laneX+t.laneWidth,y1:0,x2:t.laneX+t.laneWidth,y2:o.totalLength,stroke:e,strokeWidth:c,pointerEvents:"none"})]}):a.jsxs("g",{className:"track-lane-stroke",children:[a.jsx("path",{d:l,fill:"none",stroke:e,strokeWidth:c,pointerEvents:"none"}),n&&a.jsx("path",{d:s,fill:"none",stroke:e,strokeWidth:c,pointerEvents:"none"})]})}function $C({motif:t,isSelected:e,onMouseDown:r,onDoubleClick:n,onScaleStart:i,onRotateStart:o}){const{svgContent:s,originalWidth_mm:l,originalHeight_mm:c,position:d,rotation:h,scale:f}=t,u=A.useMemo(()=>{if(!s)return null;const k=s.match(/viewBox=["']([^"']+)["']/i);if(k){const T=k[1].split(/\s+/).map(Number);if(T.length>=4)return{width:T[2],height:T[3]}}const S=s.match(/\bwidth=["']?(\d+(?:\.\d+)?)/i),C=s.match(/\bheight=["']?(\d+(?:\.\d+)?)/i);return S&&C?{width:parseFloat(S[1]),height:parseFloat(C[1])}:null},[s]),p=A.useMemo(()=>{if(!u)return{width:l,height:c};const k=u.width/u.height,S=l/c,C=k>=1,T=S>=1;if(C!==T){console.warn("[MOTIF] Orientation mismatch detected - using SVG viewBox aspect ratio"),console.log("[MOTIF] SVG viewBox:",u,"AR:",k.toFixed(2)),console.log("[MOTIF] Physical dims:",l,"",c,"AR:",S.toFixed(2));const R=l*c,O=Math.sqrt(R*k),Y=O/k;return{width:O,height:Y}}return{width:l,height:c}},[u,l,c]),g=p.width*(f||1),m=p.height*(f||1),x=g/2,v=m/2,y=`translate(${d.x}, ${d.y}) rotate(${h||0}, ${x}, ${v})`,b=A.useMemo(()=>{if(!s)return null;try{let k=s;return k=k.replace(/\s+(width|height)=["'][^"']*["']/gi,""),k.includes("viewBox")||(k=k.replace("<svg",`<svg viewBox="0 0 ${p.width} ${p.height}"`)),k}catch(k){return console.error("[MOTIF] Error processing SVG:",k),s}},[s,p]),w=A.useMemo(()=>{if(!b)return null;try{return`data:image/svg+xml,${encodeURIComponent(b).replace(/'/g,"%27").replace(/"/g,"%22")}`}catch(k){return console.error("[MOTIF] Error creating data URL:",k),null}},[b]);return w?a.jsxs("g",{className:`motif-element ${e?"motif-element--selected":""}`,transform:y,style:{cursor:"move"},children:[a.jsx("image",{href:w,x:"0",y:"0",width:g,height:m,preserveAspectRatio:"xMidYMid meet",pointerEvents:"none"}),a.jsx("rect",{x:"0",y:"0",width:g,height:m,fill:"transparent",pointerEvents:"all",onMouseDown:r,onDoubleClick:n,style:{cursor:"move"}}),e&&a.jsx("rect",{x:"-10",y:"-10",width:g+20,height:m+20,fill:"none",stroke:"#9333EA",strokeWidth:"80",strokeDasharray:"400 400",opacity:"0.7",pointerEvents:"none"}),e&&a.jsx(IC,{width:g,height:m,onScaleStart:i,onRotateStart:o})]}):a.jsxs("g",{transform:y,children:[a.jsx("rect",{x:"0",y:"0",width:g,height:m,fill:"#f0f0f0",stroke:"#ccc",strokeWidth:"50",strokeDasharray:"200 200"}),a.jsx("text",{x:g/2,y:m/2,textAnchor:"middle",dominantBaseline:"middle",fontSize:Math.min(g,m)/10,fill:"#999",children:"Motif Error"})]})}function IC({width:t,height:e,onScaleStart:r,onRotateStart:n}){const i=Math.min(t,e)*.08,l=Math.max(150,Math.min(400,i)),c=[{x:-l/2,y:-l/2,corner:"nw",cursor:"nwse-resize"},{x:t-l/2,y:-l/2,corner:"ne",cursor:"nesw-resize"},{x:-l/2,y:e-l/2,corner:"sw",cursor:"nesw-resize"},{x:t-l/2,y:e-l/2,corner:"se",cursor:"nwse-resize"}],d=l*2.5,h=l*.8;return a.jsxs("g",{className:"motif-handles",children:[c.map(f=>a.jsx("rect",{x:f.x,y:f.y,width:l,height:l,fill:"#9333EA",stroke:"#fff",strokeWidth:"20",rx:l/4,style:{cursor:f.cursor},pointerEvents:"all",onMouseDown:u=>{u.stopPropagation(),r==null||r(u,f.corner)}},f.corner)),a.jsx("line",{x1:t/2,y1:0,x2:t/2,y2:-d+h/2,stroke:"#9333EA",strokeWidth:"30",pointerEvents:"none"}),a.jsx("circle",{cx:t/2,cy:-d,r:h,fill:"#9333EA",stroke:"#fff",strokeWidth:"20",style:{cursor:"grab"},pointerEvents:"all",onMouseDown:f=>{f.stopPropagation(),n==null||n(f)}}),a.jsx("path",{d:`M ${t/2-h*.4} ${-d}
            A ${h*.4} ${h*.4} 0 1 1
            ${t/2+h*.4} ${-d}`,fill:"none",stroke:"#fff",strokeWidth:"25",strokeLinecap:"round",pointerEvents:"none"}),a.jsx("polygon",{points:`${t/2+h*.4},${-d-h*.25}
                 ${t/2+h*.4},${-d+h*.25}
                 ${t/2+h*.65},${-d}`,fill:"#fff",pointerEvents:"none"})]})}const LC=A.forwardRef(function(e,r){const n=A.useRef(null);A.useImperativeHandle(r,()=>n.current);const[i,o]=A.useState(!1),[s,l]=A.useState(null),[c,d]=A.useState(null),[h,f]=A.useState(null),[u,p]=A.useState(null),[g,m]=A.useState(!1),[x,v]=A.useState(null),[y,b]=A.useState(null),[w,k]=A.useState(!1),[S,C]=A.useState(null),[T,R]=A.useState(null),{surface:O,courts:Y,tracks:E,motifs:B,elementOrder:_,selectedCourtId:V,selectedTrackId:re,selectedMotifId:I,snapToGrid:q,gridSize_mm:D,selectCourt:J,deselectCourt:U,selectTrack:G,deselectTrack:fe,selectMotif:oe,deselectMotif:ae,updateCourtPosition:le,updateTrackPosition:ce,updateMotifPosition:be,updateMotifScale:Ce,updateMotifRotation:ue}=Qe(),de=(K,L)=>{const H=n.current,Z=H.createSVGPoint();Z.x=K,Z.y=L;const ee=Z.matrixTransform(H.getScreenCTM().inverse());return{x:ee.x,y:ee.y}},ze=(K,L)=>{K.stopPropagation(),J(L);const H=Y[L];if(H!=null&&H.locked)return;const Z=de(K.clientX,K.clientY);l({x:Z.x-H.position.x,y:Z.y-H.position.y}),d(L),o(!0)},Ge=(K,L)=>{K.stopPropagation(),J(L),Qe.setState({showPropertiesPanel:!0,propertiesPanelUserClosed:!1})},j=(K,L)=>{K.stopPropagation(),G(L);const H=E[L];if(H!=null&&H.locked)return;const Z=de(K.clientX,K.clientY);l({x:Z.x-H.position.x,y:Z.y-H.position.y}),f(L),o(!0)},ie=(K,L)=>{K.stopPropagation(),G(L),Qe.setState({showPropertiesPanel:!0,propertiesPanelUserClosed:!1})},M=(K,L)=>{K.stopPropagation(),oe(L);const H=B[L];if(H!=null&&H.locked)return;const Z=de(K.clientX,K.clientY);l({x:Z.x-H.position.x,y:Z.y-H.position.y}),p(L),o(!0)},N=(K,L)=>{K.stopPropagation(),oe(L),Qe.setState({showPropertiesPanel:!0,propertiesPanelUserClosed:!1})},P=(K,L,H)=>{K.stopPropagation();const Z=B[L];if(!Z||Z.locked)return;const ee=de(K.clientX,K.clientY),z=Z.originalWidth_mm*(Z.scale||1),Q=Z.originalHeight_mm*(Z.scale||1),ne={x:Z.position.x+z/2,y:Z.position.y+Q/2},ge=Math.sqrt(Math.pow(ee.x-ne.x,2)+Math.pow(ee.y-ne.y,2));b({initialDistance:ge,originalScale:Z.scale||1,corner:H,motifCenter:ne}),v(L),m(!0)},F=(K,L)=>{K.stopPropagation();const H=B[L];if(!H||H.locked)return;const Z=de(K.clientX,K.clientY),ee=H.originalWidth_mm*(H.scale||1),z=H.originalHeight_mm*(H.scale||1),Q={x:H.position.x+ee/2,y:H.position.y+z/2},ne=Math.atan2(Z.y-Q.y,Z.x-Q.x)*(180/Math.PI);R({initialAngle:ne,originalRotation:H.rotation||0,motifCenter:Q}),C(L),k(!0)};A.useEffect(()=>{o(!1),d(null),f(null),p(null),l(null)},[O.width_mm,O.length_mm]),A.useEffect(()=>{if(!i||!c&&!h&&!u)return;const K=H=>{const Z=de(H.clientX,H.clientY);let ee={x:Z.x-s.x,y:Z.y-s.y};if(q&&(ee=_C(ee,D)),c){const z=Y[c],Q={width_mm:z.template.dimensions.width_mm*z.scale,length_mm:z.template.dimensions.length_mm*z.scale};ee=o0(ee,Q,O),le(c,ee)}else if(h)ce(h,ee);else if(u){const z=B[u],Q={width_mm:z.originalWidth_mm*(z.scale||1),length_mm:z.originalHeight_mm*(z.scale||1)};ee=o0(ee,Q,O),be(u,ee)}},L=()=>{if(c||h||u){const{addToHistory:H}=Qe.getState();H()}o(!1),d(null),f(null),p(null),l(null)};return window.addEventListener("mousemove",K),window.addEventListener("mouseup",L),()=>{window.removeEventListener("mousemove",K),window.removeEventListener("mouseup",L)}},[i,c,h,u,s,Y,E,B,q,D,O,le,ce,be]),A.useEffect(()=>{if(!g||!x||!y)return;const K=H=>{const Z=de(H.clientX,H.clientY);if(!B[x])return;const Q=Math.sqrt(Math.pow(Z.x-y.motifCenter.x,2)+Math.pow(Z.y-y.motifCenter.y,2))/y.initialDistance;let ne=y.originalScale*Q;ne=Math.max(.1,ne),ne=Math.round(ne*100)/100,Ce(x,ne)},L=()=>{const{addToHistory:H}=Qe.getState();H(),m(!1),v(null),b(null)};return window.addEventListener("mousemove",K),window.addEventListener("mouseup",L),()=>{window.removeEventListener("mousemove",K),window.removeEventListener("mouseup",L)}},[g,x,y,B,Ce]),A.useEffect(()=>{if(!w||!S||!T)return;const K=H=>{const Z=de(H.clientX,H.clientY),z=Math.atan2(Z.y-T.motifCenter.y,Z.x-T.motifCenter.x)*(180/Math.PI)-T.initialAngle;let Q=T.originalRotation+z;Q=(Q%360+360)%360,H.shiftKey&&(Q=Math.round(Q/15)*15),Q=Math.round(Q*10)/10,ue(S,Q)},L=()=>{const{addToHistory:H}=Qe.getState();H(),k(!1),C(null),R(null)};return window.addEventListener("mousemove",K),window.addEventListener("mouseup",L),()=>{window.removeEventListener("mousemove",K),window.removeEventListener("mouseup",L)}},[w,S,T,ue]);const X=K=>{K.target===K.currentTarget&&(U(),fe(),ae())};return a.jsxs("div",{className:"court-canvas",onClick:X,children:[a.jsxs("svg",{ref:n,className:"court-canvas__svg",viewBox:`0 0 ${O.width_mm} ${O.length_mm}`,preserveAspectRatio:"xMidYMid meet",children:[a.jsx("rect",{x:"0",y:"0",width:O.width_mm,height:O.length_mm,fill:O.color.hex,className:"court-canvas__surface"}),_.map(K=>{if(K.startsWith("court-")){const L=Y[K];return!L||L.visible===!1?null:a.jsx(DC,{court:L,isSelected:K===V,onMouseDown:H=>ze(H,K),onDoubleClick:H=>Ge(H,K),svgRef:n},K)}if(K.startsWith("track-")){const L=E[K];return!L||L.visible===!1?null:a.jsx(AC,{track:L,isSelected:K===re,onMouseDown:H=>j(H,K),onDoubleClick:H=>ie(H,K),svgRef:n},K)}if(K.startsWith("motif-")){const L=B[K];return!L||L.visible===!1?null:a.jsx($C,{motif:L,isSelected:K===I,onMouseDown:H=>M(H,K),onDoubleClick:H=>N(H,K),onScaleStart:(H,Z)=>P(H,K,Z),onRotateStart:H=>F(H,K)},K)}return null})]}),a.jsxs("div",{className:"court-canvas__info",children:[a.jsxs("span",{children:[(O.width_mm/1e3).toFixed(1),"m  ",(O.length_mm/1e3).toFixed(1),"m"]}),q&&a.jsxs("span",{className:"court-canvas__grid-indicator",children:["Grid: ",D,"mm"]})]}),_.length===0&&a.jsxs("div",{className:"court-canvas__empty-state",children:[a.jsx("div",{className:"court-canvas__empty-icon",children:a.jsxs("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"16"}),a.jsx("line",{x1:"8",y1:"12",x2:"16",y2:"12"})]})}),a.jsx("h3",{className:"court-canvas__empty-title",children:"Your canvas is ready"}),a.jsx("p",{className:"court-canvas__empty-text",children:"Add courts, tracks or designs from the sidebar to get started."}),a.jsxs("div",{className:"court-canvas__empty-hints",children:[a.jsxs("div",{className:"court-canvas__hint",children:[a.jsx("span",{className:"court-canvas__hint-icon",children:"1"}),a.jsxs("span",{children:["Browse ",a.jsx("strong",{children:"Courts"})," or ",a.jsx("strong",{children:"Tracks"})," in the sidebar"]})]}),a.jsxs("div",{className:"court-canvas__hint",children:[a.jsx("span",{className:"court-canvas__hint-icon",children:"2"}),a.jsx("span",{children:"Click to add elements to the canvas"})]}),a.jsxs("div",{className:"court-canvas__hint",children:[a.jsx("span",{className:"court-canvas__hint-icon",children:"3"}),a.jsx("span",{children:"Drag to position, double-click to edit"})]})]})]})]})});function DC({court:t,isSelected:e,onMouseDown:r,onDoubleClick:n,svgRef:i}){var c;const{markings:o,zones:s}=wC(t),l=((c=t.courtSurfaceColor)==null?void 0:c.hex)||null;return a.jsxs("g",{className:`court-canvas__court ${e?"court-canvas__court--selected":""}`,transform:SC(t),style:{cursor:"move"},children:[l&&a.jsx("rect",{x:"0",y:"0",width:t.template.dimensions.width_mm,height:t.template.dimensions.length_mm,fill:l,className:"court-canvas__court-surface"}),a.jsx("rect",{x:"0",y:"0",width:t.template.dimensions.width_mm,height:t.template.dimensions.length_mm,fill:"none",pointerEvents:"all",onMouseDown:r,onDoubleClick:n,style:{cursor:"move"}}),s.map(d=>a.jsx(zC,{zone:d},d.id)),o.map(d=>a.jsx(FC,{marking:d},d.id)),e&&a.jsxs(a.Fragment,{children:[a.jsx("rect",{x:"0",y:"0",width:t.template.dimensions.width_mm,height:t.template.dimensions.length_mm,fill:"none",stroke:"#007bff",strokeWidth:"100",strokeDasharray:"400 400",className:"court-canvas__selection-outline"}),a.jsx(kC,{court:t,svgRef:i})]})]})}function zC({zone:t}){switch(t.type){case"rect":return a.jsx("rect",{x:t.x,y:t.y,width:t.width,height:t.height,fill:t.fill});case"circle":return a.jsx("circle",{cx:t.cx,cy:t.cy,r:t.r,fill:t.fill});case"polygon":return a.jsx("polygon",{points:t.points,fill:t.fill});default:return null}}function FC({marking:t}){switch(t.type){case"line":return a.jsx("line",{x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,stroke:t.stroke,strokeWidth:t.strokeWidth});case"rect":return a.jsx("rect",{x:t.x,y:t.y,width:t.width,height:t.height,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill});case"circle":return a.jsx("circle",{cx:t.cx,cy:t.cy,r:t.r,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill});case"path":return a.jsx("path",{d:t.d,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill});case"polyline":return a.jsx("polyline",{points:t.points,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill});default:return null}}const Rw={"track-flexible":{id:"track-flexible",name:"Running Track",type:"running-track",trackType:"curved",standard:"Flexible Design",category:"track",description:"Flexible running track - adjust size, lanes, and corner radius to fit your surface",parameters:{numLanes:4,laneWidth_mm:1220,width_mm:25e3,height_mm:15e3,cornerRadius:{topLeft:3e3,topRight:3e3,bottomLeft:3e3,bottomRight:3e3},lineWidth_mm:50,startingBoxes:{enabled:!1,depth_mm:400,lineWidth_mm:50}},defaultLineColor:"RH31",defaultTrackSurfaceColor:"RH01",calculatedDimensions:{totalWidth_mm:25e3,totalLength_mm:15e3}},"track-straight":{id:"track-straight",name:"Straight Track",type:"running-track",trackType:"straight",standard:"Sprint Track",category:"track",description:"Straight sprint track - perfect for 60m, 100m, or custom length sprints",parameters:{numLanes:6,laneWidth_mm:1220,width_mm:7320,height_mm:1e5,cornerRadius:{topLeft:0,topRight:0,bottomLeft:0,bottomRight:0},lineWidth_mm:50,startingBoxes:{enabled:!1,depth_mm:400,lineWidth_mm:50}},defaultLineColor:"RH31",defaultTrackSurfaceColor:"RH01",calculatedDimensions:{totalWidth_mm:7320,totalLength_mm:1e5}}};function BC(){return Object.values(Rw)}function UC(t){return Rw[t]||null}/*! @license DOMPurify 3.3.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.0/LICENSE */var wu,d0;function u0(){if(d0)return wu;d0=1;const{entries:t,setPrototypeOf:e,isFrozen:r,getPrototypeOf:n,getOwnPropertyDescriptor:i}=Object;let{freeze:o,seal:s,create:l}=Object,{apply:c,construct:d}=typeof Reflect<"u"&&Reflect;o||(o=function(H){return H}),s||(s=function(H){return H}),c||(c=function(H,Z){for(var ee=arguments.length,z=new Array(ee>2?ee-2:0),Q=2;Q<ee;Q++)z[Q-2]=arguments[Q];return H.apply(Z,z)}),d||(d=function(H){for(var Z=arguments.length,ee=new Array(Z>1?Z-1:0),z=1;z<Z;z++)ee[z-1]=arguments[z];return new H(...ee)});const h=T(Array.prototype.forEach),f=T(Array.prototype.lastIndexOf),u=T(Array.prototype.pop),p=T(Array.prototype.push),g=T(Array.prototype.splice),m=T(String.prototype.toLowerCase),x=T(String.prototype.toString),v=T(String.prototype.match),y=T(String.prototype.replace),b=T(String.prototype.indexOf),w=T(String.prototype.trim),k=T(Object.prototype.hasOwnProperty),S=T(RegExp.prototype.test),C=R(TypeError);function T(L){return function(H){H instanceof RegExp&&(H.lastIndex=0);for(var Z=arguments.length,ee=new Array(Z>1?Z-1:0),z=1;z<Z;z++)ee[z-1]=arguments[z];return c(L,H,ee)}}function R(L){return function(){for(var H=arguments.length,Z=new Array(H),ee=0;ee<H;ee++)Z[ee]=arguments[ee];return d(L,Z)}}function O(L,H){let Z=arguments.length>2&&arguments[2]!==void 0?arguments[2]:m;e&&e(L,null);let ee=H.length;for(;ee--;){let z=H[ee];if(typeof z=="string"){const Q=Z(z);Q!==z&&(r(H)||(H[ee]=Q),z=Q)}L[z]=!0}return L}function Y(L){for(let H=0;H<L.length;H++)k(L,H)||(L[H]=null);return L}function E(L){const H=l(null);for(const[Z,ee]of t(L))k(L,Z)&&(Array.isArray(ee)?H[Z]=Y(ee):ee&&typeof ee=="object"&&ee.constructor===Object?H[Z]=E(ee):H[Z]=ee);return H}function B(L,H){for(;L!==null;){const ee=i(L,H);if(ee){if(ee.get)return T(ee.get);if(typeof ee.value=="function")return T(ee.value)}L=n(L)}function Z(){return null}return Z}const _=o(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),V=o(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),re=o(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),I=o(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),q=o(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),D=o(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),J=o(["#text"]),U=o(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),G=o(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),fe=o(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),oe=o(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),ae=s(/\{\{[\w\W]*|[\w\W]*\}\}/gm),le=s(/<%[\w\W]*|[\w\W]*%>/gm),ce=s(/\$\{[\w\W]*/gm),be=s(/^data-[\-\w.\u00B7-\uFFFF]+$/),Ce=s(/^aria-[\-\w]+$/),ue=s(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),de=s(/^(?:\w+script|data):/i),ze=s(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Ge=s(/^html$/i),j=s(/^[a-z][.\w]*(-[.\w]+)+$/i);var ie=Object.freeze({__proto__:null,ARIA_ATTR:Ce,ATTR_WHITESPACE:ze,CUSTOM_ELEMENT:j,DATA_ATTR:be,DOCTYPE_NAME:Ge,ERB_EXPR:le,IS_ALLOWED_URI:ue,IS_SCRIPT_OR_DATA:de,MUSTACHE_EXPR:ae,TMPLIT_EXPR:ce});const M={element:1,text:3,progressingInstruction:7,comment:8,document:9},N=function(){return typeof window>"u"?null:window},P=function(H,Z){if(typeof H!="object"||typeof H.createPolicy!="function")return null;let ee=null;const z="data-tt-policy-suffix";Z&&Z.hasAttribute(z)&&(ee=Z.getAttribute(z));const Q="dompurify"+(ee?"#"+ee:"");try{return H.createPolicy(Q,{createHTML(ne){return ne},createScriptURL(ne){return ne}})}catch{return console.warn("TrustedTypes policy "+Q+" could not be created."),null}},F=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function X(){let L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:N();const H=ve=>X(ve);if(H.version="3.3.0",H.removed=[],!L||!L.document||L.document.nodeType!==M.document||!L.Element)return H.isSupported=!1,H;let{document:Z}=L;const ee=Z,z=ee.currentScript,{DocumentFragment:Q,HTMLTemplateElement:ne,Node:ge,Element:Se,NodeFilter:we,NamedNodeMap:ke=L.NamedNodeMap||L.MozNamedAttrMap,HTMLFormElement:_e,DOMParser:Te,trustedTypes:We}=L,Ue=Se.prototype,Je=B(Ue,"cloneNode"),Fe=B(Ue,"remove"),je=B(Ue,"nextSibling"),Be=B(Ue,"childNodes"),Ve=B(Ue,"parentNode");if(typeof ne=="function"){const ve=Z.createElement("template");ve.content&&ve.content.ownerDocument&&(Z=ve.content.ownerDocument)}let qe,ft="";const{implementation:Qt,createNodeIterator:Qi,createDocumentFragment:tl,getElementsByTagName:Ts}=Z,{importNode:rl}=ee;let Ct=F();H.isSupported=typeof t=="function"&&typeof Ve=="function"&&Qt&&Qt.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:En,ERB_EXPR:cr,TMPLIT_EXPR:an,DATA_ATTR:Od,ARIA_ATTR:eo,IS_SCRIPT_OR_DATA:nl,ATTR_WHITESPACE:Rs,CUSTOM_ELEMENT:Ad}=ie;let{IS_ALLOWED_URI:ui}=ie,wt=null;const il=O({},[..._,...V,...re,...q,...J]);let Et=null;const _r=O({},[...U,...G,...fe,...oe]);let pt=Object.seal(l(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),er=null,Tn=null;const $t=Object.seal(l(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let ln=!0,hi=!0,ol=!1,to=!0,Or=!1,Rn=!0,Kr=!1,ro=!1,no=!1,cn=!1,fi=!1,io=!1,sl=!0,pi=!1;const Md="user-content-";let oo=!0,mi=!1,Nn={},Pn=null;const al=O({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Ns=null;const ll=O({},["audio","video","img","source","image","track"]);let so=null;const cl=O({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),gi="http://www.w3.org/1998/Math/MathML",On="http://www.w3.org/2000/svg",Sr="http://www.w3.org/1999/xhtml";let An=Sr,ao=!1,Ps=null;const dl=O({},[gi,On,Sr],x);let vi=O({},["mi","mo","mn","ms","mtext"]),yi=O({},["annotation-xml"]);const $d=O({},["title","style","font","a","script"]);let Mn=null;const ul=["application/xhtml+xml","text/html"],hl="text/html";let _t=null,$n=null;const xi=Z.createElement("form"),bi=function(W){return W instanceof RegExp||W instanceof Function},lo=function(){let W=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!($n&&$n===W)){if((!W||typeof W!="object")&&(W={}),W=E(W),Mn=ul.indexOf(W.PARSER_MEDIA_TYPE)===-1?hl:W.PARSER_MEDIA_TYPE,_t=Mn==="application/xhtml+xml"?x:m,wt=k(W,"ALLOWED_TAGS")?O({},W.ALLOWED_TAGS,_t):il,Et=k(W,"ALLOWED_ATTR")?O({},W.ALLOWED_ATTR,_t):_r,Ps=k(W,"ALLOWED_NAMESPACES")?O({},W.ALLOWED_NAMESPACES,x):dl,so=k(W,"ADD_URI_SAFE_ATTR")?O(E(cl),W.ADD_URI_SAFE_ATTR,_t):cl,Ns=k(W,"ADD_DATA_URI_TAGS")?O(E(ll),W.ADD_DATA_URI_TAGS,_t):ll,Pn=k(W,"FORBID_CONTENTS")?O({},W.FORBID_CONTENTS,_t):al,er=k(W,"FORBID_TAGS")?O({},W.FORBID_TAGS,_t):E({}),Tn=k(W,"FORBID_ATTR")?O({},W.FORBID_ATTR,_t):E({}),Nn=k(W,"USE_PROFILES")?W.USE_PROFILES:!1,ln=W.ALLOW_ARIA_ATTR!==!1,hi=W.ALLOW_DATA_ATTR!==!1,ol=W.ALLOW_UNKNOWN_PROTOCOLS||!1,to=W.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Or=W.SAFE_FOR_TEMPLATES||!1,Rn=W.SAFE_FOR_XML!==!1,Kr=W.WHOLE_DOCUMENT||!1,cn=W.RETURN_DOM||!1,fi=W.RETURN_DOM_FRAGMENT||!1,io=W.RETURN_TRUSTED_TYPE||!1,no=W.FORCE_BODY||!1,sl=W.SANITIZE_DOM!==!1,pi=W.SANITIZE_NAMED_PROPS||!1,oo=W.KEEP_CONTENT!==!1,mi=W.IN_PLACE||!1,ui=W.ALLOWED_URI_REGEXP||ue,An=W.NAMESPACE||Sr,vi=W.MATHML_TEXT_INTEGRATION_POINTS||vi,yi=W.HTML_INTEGRATION_POINTS||yi,pt=W.CUSTOM_ELEMENT_HANDLING||{},W.CUSTOM_ELEMENT_HANDLING&&bi(W.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(pt.tagNameCheck=W.CUSTOM_ELEMENT_HANDLING.tagNameCheck),W.CUSTOM_ELEMENT_HANDLING&&bi(W.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(pt.attributeNameCheck=W.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),W.CUSTOM_ELEMENT_HANDLING&&typeof W.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(pt.allowCustomizedBuiltInElements=W.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Or&&(hi=!1),fi&&(cn=!0),Nn&&(wt=O({},J),Et=[],Nn.html===!0&&(O(wt,_),O(Et,U)),Nn.svg===!0&&(O(wt,V),O(Et,G),O(Et,oe)),Nn.svgFilters===!0&&(O(wt,re),O(Et,G),O(Et,oe)),Nn.mathMl===!0&&(O(wt,q),O(Et,fe),O(Et,oe))),W.ADD_TAGS&&(typeof W.ADD_TAGS=="function"?$t.tagCheck=W.ADD_TAGS:(wt===il&&(wt=E(wt)),O(wt,W.ADD_TAGS,_t))),W.ADD_ATTR&&(typeof W.ADD_ATTR=="function"?$t.attributeCheck=W.ADD_ATTR:(Et===_r&&(Et=E(Et)),O(Et,W.ADD_ATTR,_t))),W.ADD_URI_SAFE_ATTR&&O(so,W.ADD_URI_SAFE_ATTR,_t),W.FORBID_CONTENTS&&(Pn===al&&(Pn=E(Pn)),O(Pn,W.FORBID_CONTENTS,_t)),oo&&(wt["#text"]=!0),Kr&&O(wt,["html","head","body"]),wt.table&&(O(wt,["tbody"]),delete er.tbody),W.TRUSTED_TYPES_POLICY){if(typeof W.TRUSTED_TYPES_POLICY.createHTML!="function")throw C('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof W.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw C('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');qe=W.TRUSTED_TYPES_POLICY,ft=qe.createHTML("")}else qe===void 0&&(qe=P(We,z)),qe!==null&&typeof ft=="string"&&(ft=qe.createHTML(""));o&&o(W),$n=W}},Os=O({},[...V,...re,...I]),As=O({},[...q,...D]),te=function(W){let he=Ve(W);(!he||!he.tagName)&&(he={namespaceURI:An,tagName:"template"});const Ne=m(W.tagName),dt=m(he.tagName);return Ps[W.namespaceURI]?W.namespaceURI===On?he.namespaceURI===Sr?Ne==="svg":he.namespaceURI===gi?Ne==="svg"&&(dt==="annotation-xml"||vi[dt]):!!Os[Ne]:W.namespaceURI===gi?he.namespaceURI===Sr?Ne==="math":he.namespaceURI===On?Ne==="math"&&yi[dt]:!!As[Ne]:W.namespaceURI===Sr?he.namespaceURI===On&&!yi[dt]||he.namespaceURI===gi&&!vi[dt]?!1:!As[Ne]&&($d[Ne]||!Os[Ne]):!!(Mn==="application/xhtml+xml"&&Ps[W.namespaceURI]):!1},se=function(W){p(H.removed,{element:W});try{Ve(W).removeChild(W)}catch{Fe(W)}},pe=function(W,he){try{p(H.removed,{attribute:he.getAttributeNode(W),from:he})}catch{p(H.removed,{attribute:null,from:he})}if(he.removeAttribute(W),W==="is")if(cn||fi)try{se(he)}catch{}else try{he.setAttribute(W,"")}catch{}},xe=function(W){let he=null,Ne=null;if(no)W="<remove></remove>"+W;else{const St=v(W,/^[\r\n\t ]+/);Ne=St&&St[0]}Mn==="application/xhtml+xml"&&An===Sr&&(W='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+W+"</body></html>");const dt=qe?qe.createHTML(W):W;if(An===Sr)try{he=new Te().parseFromString(dt,Mn)}catch{}if(!he||!he.documentElement){he=Qt.createDocument(An,"template",null);try{he.documentElement.innerHTML=ao?ft:dt}catch{}}const Ft=he.body||he.documentElement;return W&&Ne&&Ft.insertBefore(Z.createTextNode(Ne),Ft.childNodes[0]||null),An===Sr?Ts.call(he,Kr?"html":"body")[0]:Kr?he.documentElement:Ft},Ie=function(W){return Qi.call(W.ownerDocument||W,W,we.SHOW_ELEMENT|we.SHOW_COMMENT|we.SHOW_TEXT|we.SHOW_PROCESSING_INSTRUCTION|we.SHOW_CDATA_SECTION,null)},$e=function(W){return W instanceof _e&&(typeof W.nodeName!="string"||typeof W.textContent!="string"||typeof W.removeChild!="function"||!(W.attributes instanceof ke)||typeof W.removeAttribute!="function"||typeof W.setAttribute!="function"||typeof W.namespaceURI!="string"||typeof W.insertBefore!="function"||typeof W.hasChildNodes!="function")},Ae=function(W){return typeof ge=="function"&&W instanceof ge};function Re(ve,W,he){h(ve,Ne=>{Ne.call(H,W,he,$n)})}const Ke=function(W){let he=null;if(Re(Ct.beforeSanitizeElements,W,null),$e(W))return se(W),!0;const Ne=_t(W.nodeName);if(Re(Ct.uponSanitizeElement,W,{tagName:Ne,allowedTags:wt}),Rn&&W.hasChildNodes()&&!Ae(W.firstElementChild)&&S(/<[/\w!]/g,W.innerHTML)&&S(/<[/\w!]/g,W.textContent)||W.nodeType===M.progressingInstruction||Rn&&W.nodeType===M.comment&&S(/<[/\w]/g,W.data))return se(W),!0;if(!($t.tagCheck instanceof Function&&$t.tagCheck(Ne))&&(!wt[Ne]||er[Ne])){if(!er[Ne]&&tt(Ne)&&(pt.tagNameCheck instanceof RegExp&&S(pt.tagNameCheck,Ne)||pt.tagNameCheck instanceof Function&&pt.tagNameCheck(Ne)))return!1;if(oo&&!Pn[Ne]){const dt=Ve(W)||W.parentNode,Ft=Be(W)||W.childNodes;if(Ft&&dt){const St=Ft.length;for(let tr=St-1;tr>=0;--tr){const dn=Je(Ft[tr],!0);dn.__removalCount=(W.__removalCount||0)+1,dt.insertBefore(dn,je(W))}}}return se(W),!0}return W instanceof Se&&!te(W)||(Ne==="noscript"||Ne==="noembed"||Ne==="noframes")&&S(/<\/no(script|embed|frames)/i,W.innerHTML)?(se(W),!0):(Or&&W.nodeType===M.text&&(he=W.textContent,h([En,cr,an],dt=>{he=y(he,dt," ")}),W.textContent!==he&&(p(H.removed,{element:W.cloneNode()}),W.textContent=he)),Re(Ct.afterSanitizeElements,W,null),!1)},He=function(W,he,Ne){if(sl&&(he==="id"||he==="name")&&(Ne in Z||Ne in xi))return!1;if(!(hi&&!Tn[he]&&S(Od,he))){if(!(ln&&S(eo,he))){if(!($t.attributeCheck instanceof Function&&$t.attributeCheck(he,W))){if(!Et[he]||Tn[he]){if(!(tt(W)&&(pt.tagNameCheck instanceof RegExp&&S(pt.tagNameCheck,W)||pt.tagNameCheck instanceof Function&&pt.tagNameCheck(W))&&(pt.attributeNameCheck instanceof RegExp&&S(pt.attributeNameCheck,he)||pt.attributeNameCheck instanceof Function&&pt.attributeNameCheck(he,W))||he==="is"&&pt.allowCustomizedBuiltInElements&&(pt.tagNameCheck instanceof RegExp&&S(pt.tagNameCheck,Ne)||pt.tagNameCheck instanceof Function&&pt.tagNameCheck(Ne))))return!1}else if(!so[he]){if(!S(ui,y(Ne,Rs,""))){if(!((he==="src"||he==="xlink:href"||he==="href")&&W!=="script"&&b(Ne,"data:")===0&&Ns[W])){if(!(ol&&!S(nl,y(Ne,Rs,"")))){if(Ne)return!1}}}}}}}return!0},tt=function(W){return W!=="annotation-xml"&&v(W,Ad)},Tt=function(W){Re(Ct.beforeSanitizeAttributes,W,null);const{attributes:he}=W;if(!he||$e(W))return;const Ne={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Et,forceKeepAttr:void 0};let dt=he.length;for(;dt--;){const Ft=he[dt],{name:St,namespaceURI:tr,value:dn}=Ft,co=_t(St),Id=dn;let It=St==="value"?Id:w(Id);if(Ne.attrName=co,Ne.attrValue=It,Ne.keepAttr=!0,Ne.forceKeepAttr=void 0,Re(Ct.uponSanitizeAttribute,W,Ne),It=Ne.attrValue,pi&&(co==="id"||co==="name")&&(pe(St,W),It=Md+It),Rn&&S(/((--!?|])>)|<\/(style|title|textarea)/i,It)){pe(St,W);continue}if(co==="attributename"&&v(It,"href")){pe(St,W);continue}if(Ne.forceKeepAttr)continue;if(!Ne.keepAttr){pe(St,W);continue}if(!to&&S(/\/>/i,It)){pe(St,W);continue}Or&&h([En,cr,an],um=>{It=y(It,um," ")});const dm=_t(W.nodeName);if(!He(dm,co,It)){pe(St,W);continue}if(qe&&typeof We=="object"&&typeof We.getAttributeType=="function"&&!tr)switch(We.getAttributeType(dm,co)){case"TrustedHTML":{It=qe.createHTML(It);break}case"TrustedScriptURL":{It=qe.createScriptURL(It);break}}if(It!==Id)try{tr?W.setAttributeNS(tr,St,It):W.setAttribute(St,It),$e(W)?se(W):u(H.removed)}catch{pe(St,W)}}Re(Ct.afterSanitizeAttributes,W,null)},ct=function ve(W){let he=null;const Ne=Ie(W);for(Re(Ct.beforeSanitizeShadowDOM,W,null);he=Ne.nextNode();)Re(Ct.uponSanitizeShadowNode,he,null),Ke(he),Tt(he),he.content instanceof Q&&ve(he.content);Re(Ct.afterSanitizeShadowDOM,W,null)};return H.sanitize=function(ve){let W=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},he=null,Ne=null,dt=null,Ft=null;if(ao=!ve,ao&&(ve="<!-->"),typeof ve!="string"&&!Ae(ve))if(typeof ve.toString=="function"){if(ve=ve.toString(),typeof ve!="string")throw C("dirty is not a string, aborting")}else throw C("toString is not a function");if(!H.isSupported)return ve;if(ro||lo(W),H.removed=[],typeof ve=="string"&&(mi=!1),mi){if(ve.nodeName){const dn=_t(ve.nodeName);if(!wt[dn]||er[dn])throw C("root node is forbidden and cannot be sanitized in-place")}}else if(ve instanceof ge)he=xe("<!---->"),Ne=he.ownerDocument.importNode(ve,!0),Ne.nodeType===M.element&&Ne.nodeName==="BODY"||Ne.nodeName==="HTML"?he=Ne:he.appendChild(Ne);else{if(!cn&&!Or&&!Kr&&ve.indexOf("<")===-1)return qe&&io?qe.createHTML(ve):ve;if(he=xe(ve),!he)return cn?null:io?ft:""}he&&no&&se(he.firstChild);const St=Ie(mi?ve:he);for(;dt=St.nextNode();)Ke(dt),Tt(dt),dt.content instanceof Q&&ct(dt.content);if(mi)return ve;if(cn){if(fi)for(Ft=tl.call(he.ownerDocument);he.firstChild;)Ft.appendChild(he.firstChild);else Ft=he;return(Et.shadowroot||Et.shadowrootmode)&&(Ft=rl.call(ee,Ft,!0)),Ft}let tr=Kr?he.outerHTML:he.innerHTML;return Kr&&wt["!doctype"]&&he.ownerDocument&&he.ownerDocument.doctype&&he.ownerDocument.doctype.name&&S(Ge,he.ownerDocument.doctype.name)&&(tr="<!DOCTYPE "+he.ownerDocument.doctype.name+`>
`+tr),Or&&h([En,cr,an],dn=>{tr=y(tr,dn," ")}),qe&&io?qe.createHTML(tr):tr},H.setConfig=function(){let ve=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};lo(ve),ro=!0},H.clearConfig=function(){$n=null,ro=!1},H.isValidAttribute=function(ve,W,he){$n||lo({});const Ne=_t(ve),dt=_t(W);return He(Ne,dt,he)},H.addHook=function(ve,W){typeof W=="function"&&p(Ct[ve],W)},H.removeHook=function(ve,W){if(W!==void 0){const he=f(Ct[ve],W);return he===-1?void 0:g(Ct[ve],he,1)[0]}return u(Ct[ve])},H.removeHooks=function(ve){Ct[ve]=[]},H.removeAllHooks=function(){Ct=F()},H}var K=X();return wu=K,wu}var HC=self.DOMPurify||(self.DOMPurify=u0().default||u0());const WC=Xc(HC);function hp(t,e={}){if(!t||typeof t!="string")return console.warn("[SVG-SANITIZE] Invalid input:",typeof t),"";const r={USE_PROFILES:{svg:!0,svgFilters:!0},FORBID_TAGS:["script","foreignObject","iframe","embed"],FORBID_ATTR:["onload","onerror","onclick","onmouseover","onmouseout","onmouseenter","onmouseleave","onmousemove","onmousedown","onmouseup","onfocus","onblur","onkeydown","onkeyup","onkeypress","onsubmit","onreset","onselect","onchange","oninput","onanimationstart","onanimationend","onanimationiteration","ontransitionend","ontransitionrun","ontransitionstart","ontransitioncancel","xlink:href",...e.additionalForbiddenAttrs||[]],ALLOW_DATA_ATTR:!0,ALLOW_COMMENTS:!1,RETURN_DOM:!1,RETURN_DOM_FRAGMENT:!1,ALLOWED_URI_REGEXP:/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,HOOKS:{afterSanitizeAttributes:n=>{if(n.hasAttribute("href")){const i=n.getAttribute("href");i&&i.toLowerCase().trim().startsWith("javascript:")&&(n.removeAttribute("href"),console.warn("[SVG-SANITIZE] Removed javascript: href"))}if(n.hasAttribute("xlink:href")){const i=n.getAttribute("xlink:href");i&&(i.toLowerCase().trim().startsWith("javascript:")||i.toLowerCase().trim().startsWith("data:text/html"))&&(n.removeAttribute("xlink:href"),console.warn("[SVG-SANITIZE] Removed dangerous xlink:href"))}}},...e};try{const n=WC.sanitize(t,r);if(!n||!n.includes("<svg"))return console.error("[SVG-SANITIZE] Sanitization removed SVG content - input may be malicious"),"";const i=t.length,o=n.length,s=(i-o)/i*100;return s>10&&console.warn(`[SVG-SANITIZE] Removed ${s.toFixed(1)}% of content (${i-o} chars) - possible malicious SVG detected`),n}catch(n){return console.error("[SVG-SANITIZE] Sanitization failed:",n),""}}function GC(t){if(!t||typeof t!="string")return!1;const e=t.toLowerCase(),r=["<script","javascript:","onload=","onerror=","onclick=","onmouseover=","<foreignobject","<iframe","<embed","data:text/html"];for(const n of r)if(e.includes(n))return console.warn(`[SVG-VALIDATE] Dangerous pattern detected: ${n}`),!1;return e.includes("<svg")?!0:(console.warn("[SVG-VALIDATE] Content does not appear to be valid SVG (no <svg> tag found)"),!1)}function VC(t){const e=new Map;for(const r of t){const n=r.originalColor.hex.toLowerCase(),i=r.targetColor.hex.toLowerCase(),o=r.chosenRecipe.id,s=r.chosenRecipe.deltaE,l=r.targetColor.areaPct;e.set(n,{blendHex:i,recipeId:o,deltaE:s,coverage:l,quality:r.chosenRecipe.quality,components:r.chosenRecipe.components})}return e}function qC(t){return t.replace("#","").toLowerCase()}async function Fn(t,e,r=null){try{let n;if(r)n=r,console.log(`[SVG-RECOLOR] Using provided SVG text (${n.length} chars)`);else{console.log("[SVG-RECOLOR] Fetching SVG from:",t);const g=await fetch(t);if(!g.ok)throw new Error(`Failed to fetch SVG: ${g.status} ${g.statusText}`);n=await g.text(),console.log(`[SVG-RECOLOR] Fetched SVG (${n.length} chars)`)}console.log("[SVG-RECOLOR] Sanitizing SVG...");const i=hp(n);if(!i)throw new Error("SVG sanitization failed - content rejected");const s=new DOMParser().parseFromString(i,"image/svg+xml"),l=s.querySelector("parsererror");if(l)throw new Error(`SVG parse error: ${l.textContent}`);const c=s.documentElement;if(c.tagName!=="svg")throw new Error("Invalid SVG: root element is not <svg>");const d=KC(c,e);console.log("[SVG-RECOLOR] Recoloring complete:",d);const f=new XMLSerializer().serializeToString(s),u=new Blob([f],{type:"image/svg+xml"});return{dataUrl:URL.createObjectURL(u),svgText:f,stats:d}}catch(n){throw console.error("[SVG-RECOLOR] Error:",n),n}}function KC(t,e){const r={totalElements:0,fillsReplaced:0,strokesReplaced:0,stopColorsReplaced:0,stylesProcessed:0,colorsNotMapped:new Set},n=t.querySelectorAll("*");r.totalElements=n.length;for(const s of n){const l=s.getAttribute("fill");if(l&&l!=="none"){const f=en(l,e,r.colorsNotMapped);f!==l&&(s.setAttribute("fill",f),r.fillsReplaced++)}const c=s.getAttribute("stroke");if(c&&c!=="none"){const f=en(c,e,r.colorsNotMapped);f!==c&&(s.setAttribute("stroke",f),r.strokesReplaced++)}const d=s.getAttribute("stop-color");if(d&&d!=="none"){const f=en(d,e,r.colorsNotMapped);f!==d&&(s.setAttribute("stop-color",f),r.stopColorsReplaced++)}const h=s.getAttribute("style");if(h){const f=p0(h,e,r);f!==h&&(s.setAttribute("style",f),r.stylesProcessed++)}}const i=t.querySelectorAll("style");for(const s of i){const l=s.textContent,c=XC(l,e,r);c!==l&&(s.textContent=c,r.stylesProcessed++)}const o=t.querySelectorAll("stop");for(const s of o){const l=s.getAttribute("stop-color");if(l&&l!=="none"){const d=en(l,e,r.colorsNotMapped);d!==l&&(s.setAttribute("stop-color",d),r.stopColorsReplaced++)}const c=s.getAttribute("style");if(c&&c.includes("stop-color")){const d=p0(c,e,r);d!==c&&(s.setAttribute("style",d),r.stylesProcessed++)}}return r}function en(t,e,r){const n=ZC(t);if(!n)return t;const i=`#${n}`,o=e.get(i);if(o)return o.blendHex;const s=h0(n);if(!s)return t;const l=f0(s);let c=null,d=1/0;for(const[h,f]of e.entries()){const u=h0(h.replace("#",""));if(!u)continue;const p=f0(u),g=YC(l,p);if(g<d&&(d=g,c=f),g<=9)return console.log(`[SVG-RECOLOR] Tolerance match: ${i}  ${h} (E=${g.toFixed(2)})`),f.blendHex}return c?(console.log(`[SVG-RECOLOR] Fallback to nearest: ${i}  ${c.blendHex} (E=${d.toFixed(2)})`),r&&r.add(t),c.blendHex):(console.warn(`[SVG-RECOLOR] No mapping found: ${i}`),t)}function h0(t){if(t.length!==6)return null;const e=parseInt(t.substring(0,2),16),r=parseInt(t.substring(2,4),16),n=parseInt(t.substring(4,6),16);return isNaN(e)||isNaN(r)||isNaN(n)?null:{r:e,g:r,b:n}}function f0(t){let e=t.r/255,r=t.g/255,n=t.b/255;e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92,r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92,n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92;const i=(e*.4124+r*.3576+n*.1805)*100,o=(e*.2126+r*.7152+n*.0722)*100,s=(e*.0193+r*.1192+n*.9505)*100,l=95.047,c=100,d=108.883;let h=i/l,f=o/c,u=s/d;return h=h>.008856?Math.pow(h,1/3):7.787*h+16/116,f=f>.008856?Math.pow(f,1/3):7.787*f+16/116,u=u>.008856?Math.pow(u,1/3):7.787*u+16/116,{L:116*f-16,a:500*(h-f),b:200*(f-u)}}function YC(t,e){const o=Math.PI*2,s=Math.PI,l=(t.L+e.L)/2,c=Math.sqrt(t.a*t.a+t.b*t.b),d=Math.sqrt(e.a*e.a+e.b*e.b),h=(c+d)/2,f=.5*(1-Math.sqrt(Math.pow(h,7)/(Math.pow(h,7)+Math.pow(25,7)))),u=t.a*(1+f),p=e.a*(1+f),g=Math.sqrt(u*u+t.b*t.b),m=Math.sqrt(p*p+e.b*e.b),x=(g+m)/2;let v=Math.atan2(t.b,u);v<0&&(v+=o);let y=Math.atan2(e.b,p);y<0&&(y+=o);const b=Math.abs(v-y)>s?(v+y+o)/2:(v+y)/2,w=1-.17*Math.cos(b-Math.PI/6)+.24*Math.cos(2*b)+.32*Math.cos(3*b+Math.PI/30)-.2*Math.cos(4*b-63*Math.PI/180);let k=y-v;Math.abs(k)>s&&(k=k>0?k-o:k+o);const S=e.L-t.L,C=m-g,T=2*Math.sqrt(g*m)*Math.sin(k/2),R=1+.015*Math.pow(l-50,2)/Math.sqrt(20+Math.pow(l-50,2)),O=1+.045*x,Y=1+.015*x*w,E=30*Math.PI/180*Math.exp(-Math.pow((b-275*Math.PI/180)/(25*Math.PI/180),2)),_=-(2*Math.sqrt(Math.pow(x,7)/(Math.pow(x,7)+Math.pow(25,7))))*Math.sin(2*E);return Math.sqrt(Math.pow(S/(1*R),2)+Math.pow(C/(1*O),2)+Math.pow(T/(1*Y),2)+_*(C/(1*O))*(T/(1*Y)))}function p0(t,e,r){let n=t;return n=n.replace(/fill:\s*([^;]+)/gi,(i,o)=>`fill: ${en(o.trim(),e,r.colorsNotMapped)}`),n=n.replace(/stroke:\s*([^;]+)/gi,(i,o)=>`stroke: ${en(o.trim(),e,r.colorsNotMapped)}`),n=n.replace(/stop-color:\s*([^;]+)/gi,(i,o)=>`stop-color: ${en(o.trim(),e,r.colorsNotMapped)}`),n}function XC(t,e,r){let n=t,i=0;return n=n.replace(/fill:\s*([^;}\s]+)/gi,(o,s)=>{const l=s.trim(),c=en(l,e,r.colorsNotMapped);return c!==l&&(i++,console.log(`[SVG-RECOLOR-CSS] Replaced fill: ${l}  ${c}`)),`fill: ${c}`}),n=n.replace(/stroke:\s*([^;}\s]+)/gi,(o,s)=>{const l=s.trim(),c=en(l,e,r.colorsNotMapped);return c!==l&&(i++,console.log(`[SVG-RECOLOR-CSS] Replaced stroke: ${l}  ${c}`)),`stroke: ${c}`}),n=n.replace(/stop-color:\s*([^;}\s]+)/gi,(o,s)=>{const l=s.trim(),c=en(l,e,r.colorsNotMapped);return c!==l&&(i++,console.log(`[SVG-RECOLOR-CSS] Replaced stop-color: ${l}  ${c}`)),`stop-color: ${c}`}),i>0&&console.log(`[SVG-RECOLOR-CSS] Total CSS color replacements: ${i}`),n}function ZC(t){const e=t.trim().toLowerCase();if(e.match(/^#?[0-9a-f]{6}$/))return qC(e);const r=e.match(/^#?([0-9a-f]{3})$/);if(r)return r[1].split("").map(s=>s+s).join("");const n=e.match(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/);if(n){const o=parseInt(n[1],10),s=parseInt(n[2],10),l=parseInt(n[3],10);return JC(o,s,l)}const i={white:"ffffff",black:"000000",red:"ff0000",green:"008000",blue:"0000ff",yellow:"ffff00",cyan:"00ffff",magenta:"ff00ff",gray:"808080",grey:"808080",orange:"ffa500",purple:"800080"};return i[e]?i[e]:null}function JC(t,e,r){const n=i=>Math.max(0,Math.min(255,i)).toString(16).padStart(2,"0");return`${n(t)}${n(e)}${n(r)}`}async function fp(t){const e=await Wa(t),r=(e==null?void 0:e.design)||e;if(!r)throw new Error("Design not found");if(r.input_mode==="sports_surface")throw new Error("Cannot use a sports surface design as a motif");const n=r.original_svg_url;if(!n||n.startsWith("blob:"))throw new Error("Design does not have a valid original SVG. Please ensure the design was saved after generation.");if(!r.solid_color_mapping&&!r.color_mapping)throw new Error("Design does not have color mappings. Please ensure the design was saved after color mapping.");console.log("[MOTIF] Fetching original SVG from:",n);const i=await QC(n);if(!i)throw new Error("Failed to load or sanitize the original SVG.");console.log("[MOTIF] Original SVG loaded, regenerating recolored versions...");let o=null,s=null;if(r.solid_color_mapping&&Object.keys(r.solid_color_mapping).length>0)try{const u=m0(r.solid_color_mapping);console.log("[MOTIF] Solid mapping has",u.size,"colors");const{svgText:p}=await Fn(null,u,i);o=p,console.log("[MOTIF] Generated solid SVG:",o.length,"chars")}catch(u){console.error("[MOTIF] Failed to generate solid SVG:",u)}if(r.color_mapping&&Object.keys(r.color_mapping).length>0)try{const u=m0(r.color_mapping);console.log("[MOTIF] Blend mapping has",u.size,"colors");const{svgText:p}=await Fn(null,u,i);s=p,console.log("[MOTIF] Generated blend SVG:",s.length,"chars")}catch(u){console.error("[MOTIF] Failed to generate blend SVG:",u)}if(!o&&!s)throw new Error("Failed to regenerate TPV-recolored SVG versions.");const l=r.dimensions||{},c=l.widthMM||l.width_mm||5e3,d=l.lengthMM||l.length_mm||5e3,h=r.thumbnail_url||r.original_png_url||null,f=o&&s;return{sourceDesignId:t,sourceDesignName:r.name||"Unnamed Design",sourceThumbnailUrl:h,solidSvgContent:o,blendSvgContent:s,svgContent:o||s,hasBothVersions:f,originalWidth_mm:c,originalHeight_mm:d}}function m0(t){const e=new Map;if(!t||typeof t!="object")return e;for(const[r,n]of Object.entries(t)){const i=r.startsWith("#")?r:`#${r}`;e.set(i,n)}return e}async function QC(t){try{console.log("[MOTIF] Fetching SVG from:",t);const e=await fetch(t);if(!e.ok)return console.error("[MOTIF] Failed to fetch SVG:",e.status,e.statusText),null;const r=await e.text();if(console.log("[MOTIF] Fetched content length:",r.length,"chars"),console.log("[MOTIF] Content starts with:",r.substring(0,100)),!GC(r))return console.error("[MOTIF] SVG failed quick validation"),null;const n=hp(r);return n?(console.log("[MOTIF] Sanitized SVG length:",n.length,"chars"),n):(console.error("[MOTIF] SVG sanitization failed"),null)}catch(e){return console.error("[MOTIF] Error fetching SVG:",e),null}}async function Nw(t={}){const e=await Lc(t);return{designs:(e.designs||[]).filter(n=>n.input_mode==="sports_surface"?!1:n.thumbnail_url||n.original_svg_url||n.original_png_url),pagination:e.pagination}}const eE=Object.freeze(Object.defineProperty({__proto__:null,fetchMotifFromDesign:fp,listPlaygroundDesigns:Nw},Symbol.toStringTag,{value:"Module"}));function tE({onOpenGenerator:t}){const[e,r]=A.useState(null),[n,i]=A.useState("courts"),[o,s]=A.useState([]),[l,c]=A.useState(!1),[d,h]=A.useState(null),[f,u]=A.useState(null),{addCourt:p,addTrack:g,addMotif:m,courts:x,tracks:v,motifs:y}=Qe(),b=Object.keys(x).length,w=Object.keys(v).length,k=Object.keys(y).length,S=hC(),C=BC();A.useEffect(()=>{n==="designs"&&o.length===0&&!l&&T()},[n]);const T=async()=>{c(!0),h(null);try{const _=await Nw({limit:50});s(_.designs||[])}catch(_){console.error("[MOTIFS] Failed to load designs:",_),h(_.message||"Failed to load designs")}finally{c(!1)}},R=_=>{const V=fC(_);V&&p(_,V)},O=_=>{const V=UC(_);V&&g(_,V)},Y=async _=>{if(!f){u(_);try{const V=await fp(_);m(V.sourceDesignId,V.sourceDesignName,V.svgContent,V.originalWidth_mm,V.originalHeight_mm,V.sourceThumbnailUrl,{solidSvgContent:V.solidSvgContent,blendSvgContent:V.blendSvgContent,hasBothVersions:V.hasBothVersions})}catch(V){console.error("[MOTIFS] Failed to add motif:",V),alert(`Failed to add motif: ${V.message}`)}finally{u(null)}}},B=(()=>{switch(n){case"courts":return{title:"Courts",count:b,hint:"Select a court to add"};case"tracks":return{title:"Tracks",count:w,hint:"Select a track to add"};case"designs":return{title:"Designs",count:k,hint:"Add your saved designs as motifs"};default:return{title:"Library",count:0,hint:""}}})();return a.jsxs("div",{className:"court-library",children:[a.jsxs("div",{className:"court-library__header",children:[a.jsxs("div",{className:"court-library__header-row",children:[a.jsx("h2",{children:B.title}),a.jsxs("span",{className:"court-library__count",children:[B.count," on canvas"]})]}),a.jsx("p",{children:B.hint})]}),a.jsxs("div",{className:"court-library__tabs",children:[a.jsx("button",{className:`court-library__tab ${n==="courts"?"court-library__tab--active":""}`,onClick:()=>{i("courts"),r(null)},children:"Courts"}),a.jsx("button",{className:`court-library__tab ${n==="tracks"?"court-library__tab--active":""}`,onClick:()=>{i("tracks"),r(null)},children:"Tracks"}),a.jsx("button",{className:`court-library__tab ${n==="designs"?"court-library__tab--active":""}`,onClick:()=>{i("designs"),r(null)},children:"Designs"})]}),a.jsxs("div",{className:"court-library__list",children:[n==="courts"&&S.map(_=>a.jsxs("div",{className:`court-library__item ${e===_.id?"court-library__item--selected":""}`,onClick:()=>r(_.id),onDoubleClick:()=>R(_.id),children:[a.jsx("div",{className:"court-library__preview",children:a.jsx(rE,{template:_})}),a.jsxs("div",{className:"court-library__info",children:[a.jsx("div",{className:"court-library__name",children:_.name}),a.jsxs("div",{className:"court-library__dimensions",children:[(_.dimensions.width_mm/1e3).toFixed(1),"m  ",(_.dimensions.length_mm/1e3).toFixed(1),"m"]}),a.jsx("div",{className:"court-library__standard",children:_.standard})]}),e===_.id&&a.jsx("button",{className:"court-library__add-btn",onClick:V=>{V.stopPropagation(),R(_.id)},children:"+ ADD"})]},_.id)),n==="tracks"&&C.map(_=>a.jsxs("div",{className:`court-library__item ${e===_.id?"court-library__item--selected":""}`,onClick:()=>r(_.id),onDoubleClick:()=>O(_.id),children:[a.jsx("div",{className:"court-library__preview",children:a.jsx(iE,{template:_})}),a.jsxs("div",{className:"court-library__info",children:[a.jsx("div",{className:"court-library__name",children:_.name}),a.jsxs("div",{className:"court-library__standard",children:[_.parameters.numLanes," Lanes  ",_.standard]}),a.jsx("div",{className:"court-library__note",children:"Scales to fit canvas"})]}),e===_.id&&a.jsx("button",{className:"court-library__add-btn",onClick:V=>{V.stopPropagation(),O(_.id)},children:"+ ADD"})]},_.id)),n==="designs"&&a.jsxs(a.Fragment,{children:[l&&a.jsxs("div",{className:"court-library__loading",children:[a.jsx("div",{className:"court-library__spinner"}),a.jsx("p",{children:"Loading your designs..."})]}),d&&a.jsxs("div",{className:"court-library__error",children:[a.jsx("p",{children:d}),a.jsx("button",{onClick:T,children:"Try Again"})]}),!l&&!d&&o.length===0&&a.jsxs("div",{className:"court-library__empty",children:[a.jsx("p",{children:"No designs found."}),a.jsx("p",{className:"court-library__empty-hint",children:"Generate new designs or save them to use as motifs."})]}),!l&&o.map(_=>{var V,re;return a.jsxs("div",{className:`court-library__item ${e===_.id?"court-library__item--selected":""} ${f===_.id?"court-library__item--loading":""}`,onClick:()=>r(_.id),onDoubleClick:()=>Y(_.id),children:[a.jsx("div",{className:"court-library__preview",children:a.jsx(oE,{design:_})}),a.jsxs("div",{className:"court-library__info",children:[a.jsx("div",{className:"court-library__name",children:_.name||"Unnamed Design"}),a.jsxs("div",{className:"court-library__dimensions",children:[((((V=_.design_data)==null?void 0:V.widthMM)||5e3)/1e3).toFixed(1),"m  ",((((re=_.design_data)==null?void 0:re.lengthMM)||5e3)/1e3).toFixed(1),"m"]}),a.jsx("div",{className:"court-library__note",children:"Playground Design"})]}),e===_.id&&a.jsx("button",{className:"court-library__add-btn",onClick:I=>{I.stopPropagation(),Y(_.id)},disabled:f===_.id,children:f===_.id?"Adding...":"+ ADD"})]},_.id)})]})]}),a.jsx("div",{className:"court-library__generate",children:a.jsxs("button",{className:"court-library__generate-btn",onClick:t,children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 5v14M5 12h14"})}),"Generate New Design"]})}),a.jsx("div",{className:"court-library__footer",children:a.jsxs("p",{className:"court-library__hint",children:[n==="courts"&&"Double-click a court to add it instantly",n==="tracks"&&"Double-click a track to add it instantly",n==="designs"&&"Double-click a design to add it as a motif"]})})]})}function rE({template:t}){const e=t.dimensions.width_mm,r=t.dimensions.length_mm,n=Math.min(62/e,62/r),i=e*n,o=r*n;return a.jsxs("svg",{width:"62",height:"62",viewBox:"0 0 62 62",className:"court-library__svg-preview",children:[a.jsx("rect",{x:(62-i)/2,y:(62-o)/2,width:i,height:o,fill:"#e5e7eb",stroke:"#9ca3af",strokeWidth:"1.5"}),t.markings.map((s,l)=>a.jsx(nE,{marking:s,scale:n,offsetX:(62-i)/2,offsetY:(62-o)/2},l))]})}function nE({marking:t,scale:e,offsetX:r,offsetY:n}){const{type:i,params:o}=t;switch(i){case"line":return a.jsx("line",{x1:o.x1*e+r,y1:o.y1*e+n,x2:o.x2*e+r,y2:o.y2*e+n,stroke:"#1e293b",strokeWidth:"1.5"});case"rectangle":return a.jsx("rect",{x:o.x*e+r,y:o.y*e+n,width:o.width*e,height:o.height*e,stroke:"#1e293b",strokeWidth:"1.5",fill:"none"});case"circle":return a.jsx("circle",{cx:o.cx*e+r,cy:o.cy*e+n,r:o.radius*e,stroke:"#1e293b",strokeWidth:"1.5",fill:"none"});case"arc":{const{cx:s,cy:l,radius:c,startAngle:d,endAngle:h}=o,f=d*Math.PI/180,u=h*Math.PI/180,p=(s+c*Math.cos(f))*e+r,g=(l+c*Math.sin(f))*e+n,m=(s+c*Math.cos(u))*e+r,x=(l+c*Math.sin(u))*e+n,v=h-d>180?1:0,y=`M ${p} ${g} A ${c*e} ${c*e} 0 ${v} 1 ${m} ${x}`;return a.jsx("path",{d:y,stroke:"#1e293b",strokeWidth:"1.5",fill:"none"})}default:return null}}function iE({template:t}){const{parameters:e}=t,r=e.width_mm,n=e.height_mm,i=Math.min(58/r,58/n),o=r*i,s=n*i,l=e.numLanes,c=e.laneWidth_mm*i,d=e.cornerRadius,f=(d.topLeft+d.topRight+d.bottomLeft+d.bottomRight)/4*i,u=(62-o)/2,p=(62-s)/2;return a.jsxs("svg",{width:"62",height:"62",viewBox:"0 0 62 62",className:"court-library__svg-preview",children:[a.jsx("rect",{x:u,y:p,width:o,height:s,rx:f,fill:"#e5e7eb"}),Array.from({length:l}).map((g,m)=>{const x=m*c,v=Math.max(0,f-x);return a.jsx("rect",{x:u+x,y:p+x,width:Math.max(0,o-x*2),height:Math.max(0,s-x*2),rx:v,stroke:"#1e293b",strokeWidth:"1",fill:"none"},m)})]})}function oE({design:t}){const e=t.thumbnail_url||t.original_png_url;return e?a.jsx("img",{src:e,alt:t.name||"Design preview",className:"court-library__motif-img",style:{width:"62px",height:"62px",objectFit:"contain",borderRadius:"4px",backgroundColor:"#f3f4f6"},onError:r=>{r.target.style.display="none",r.target.nextSibling&&(r.target.nextSibling.style.display="flex")}}):a.jsx("div",{className:"court-library__motif-placeholder",style:{width:"62px",height:"62px",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#e5e7eb",borderRadius:"4px",color:"#9ca3af",fontSize:"10px",textAlign:"center"},children:"No Preview"})}function sE({onEditSourceDesign:t}){var oe,ae;const{courts:e,tracks:r,motifs:n,selectedCourtId:i,selectedTrackId:o,selectedMotifId:s,updateCourtPosition:l,updateCourtRotation:c,updateCourtScale:d,setLineColor:h,setZoneColor:f,setCourtSurfaceColor:u,resetCourtColors:p,removeCourt:g,removeTrack:m,removeMotif:x,updateMotifPosition:v,updateMotifRotation:y,updateMotifScale:b,updateTrackParameters:w,addToHistory:k}=Qe(),[S,C]=A.useState("transform"),[T,R]=A.useState(null);if(s){const le=n[s];return le?a.jsx(lE,{motif:le,motifId:s,onEditSourceDesign:t}):null}if(o){const le=r[o];return le?a.jsx(aE,{track:le,trackId:o}):null}if(!i)return a.jsx("div",{className:"properties-panel properties-panel--empty",children:a.jsxs("div",{className:"properties-panel__empty-state",children:[a.jsx("p",{children:"No element selected"}),a.jsx("span",{className:"properties-panel__hint",children:"Click on a court, track, or motif to view and edit its properties"})]})});const O=e[i];if(!O)return null;const{position:Y,rotation:E,scale:B,template:_,lineColorOverrides:V,zoneColorOverrides:re}=O,I=(le,ce)=>{const be=parseFloat(ce);isNaN(be)||l(i,{...Y,[le]:be})},q=le=>{const ce=parseFloat(le);isNaN(ce)||c(i,ce)},D=le=>{const ce=parseFloat(le);isNaN(ce)||ce<=0||d(i,ce)},J=()=>{window.confirm(`Delete ${_.name}? This action cannot be undone.`)&&g(i)},U=le=>{if(!T)return;if(T.type==="courtSurface"&&le===null){u(i,null),R(null);return}if(!le)return;const ce={tpv_code:le.code,hex:le.hex,name:le.name};T.type==="line"?h(i,T.id,ce):T.type==="zone"?f(i,T.id,ce):T.type==="courtSurface"?u(i,ce):T.type==="allLines"&&_.markings.forEach(be=>{h(i,be.id,ce)}),R(null)},G=le=>{const ce=V[le.id];if(ce)return{code:ce.tpv_code,hex:ce.hex,name:ce.name};const be=nn.find(Ce=>Ce.code===_.defaultLineColor);return be?{code:be.code,hex:be.hex,name:be.name}:null},fe=le=>{const ce=re[le.id];if(ce)return{code:ce.tpv_code,hex:ce.hex,name:ce.name};const be=nn.find(Ce=>Ce.code===le.defaultColor);return be?{code:be.code,hex:be.hex,name:be.name}:null};return a.jsxs("div",{className:"properties-panel",children:[a.jsxs("div",{className:"properties-panel__header",children:[a.jsx("h3",{children:"Properties"}),a.jsxs("div",{className:"properties-panel__court-info",children:[a.jsx("span",{className:"court-name",children:_.name}),a.jsx("span",{className:"court-standard",children:_.standard})]})]}),a.jsxs("div",{className:"properties-panel__tabs",children:[a.jsx("button",{className:`tab ${S==="transform"?"tab--active":""}`,onClick:()=>C("transform"),children:"Transform"}),a.jsx("button",{className:`tab ${S==="lines"?"tab--active":""}`,onClick:()=>C("lines"),children:"Lines"}),a.jsx("button",{className:`tab ${S==="zones"?"tab--active":""}`,onClick:()=>C("zones"),children:"Zones"})]}),a.jsxs("div",{className:"properties-panel__content",children:[S==="transform"&&a.jsxs("div",{className:"properties-section",children:[a.jsx("div",{className:"properties-section__header",children:a.jsx("h4",{children:"Transform"})}),a.jsxs("div",{className:"property-group",children:[a.jsx("label",{children:"Position"}),a.jsxs("div",{className:"property-input-row",children:[a.jsxs("div",{className:"property-input-group",children:[a.jsx("span",{className:"property-label",children:"X"}),a.jsx("input",{type:"number",value:Math.round(Y.x),onChange:le=>I("x",le.target.value),step:"100"}),a.jsx("span",{className:"property-unit",children:"mm"})]}),a.jsxs("div",{className:"property-input-group",children:[a.jsx("span",{className:"property-label",children:"Y"}),a.jsx("input",{type:"number",value:Math.round(Y.y),onChange:le=>I("y",le.target.value),step:"100"}),a.jsx("span",{className:"property-unit",children:"mm"})]})]})]}),a.jsxs("div",{className:"property-group",children:[a.jsx("label",{children:"Rotation"}),a.jsxs("div",{className:"property-input-row",children:[a.jsx("input",{type:"range",min:"0",max:"360",value:E,onChange:le=>q(le.target.value),className:"property-slider"}),a.jsxs("div",{className:"property-input-group property-input-group--compact",children:[a.jsx("input",{type:"number",value:Math.round(E),onChange:le=>q(le.target.value),min:"0",max:"360"}),a.jsx("span",{className:"property-unit",children:""})]})]})]}),a.jsxs("div",{className:"property-group",children:[a.jsx("label",{children:"Scale"}),a.jsxs("div",{className:"property-input-row",children:[a.jsx("input",{type:"range",min:"0.5",max:"2.0",step:"0.1",value:B,onChange:le=>D(le.target.value),className:"property-slider"}),a.jsxs("div",{className:"property-input-group property-input-group--compact",children:[a.jsx("input",{type:"number",value:B.toFixed(2),onChange:le=>D(le.target.value),min:"0.5",max:"2.0",step:"0.1"}),a.jsx("span",{className:"property-unit",children:""})]})]})]}),a.jsxs("div",{className:"property-group property-group--info",children:[a.jsx("label",{children:"Dimensions"}),a.jsx("div",{className:"property-info",children:a.jsxs("span",{children:[(_.dimensions.width_mm*B/1e3).toFixed(1),"m  ",(_.dimensions.length_mm*B/1e3).toFixed(1),"m"]})})]}),a.jsx("div",{className:"property-group property-group--actions",children:a.jsx("button",{className:"btn-delete",onClick:J,title:"Delete court (Delete key)",children:" Delete Court"})})]}),S==="lines"&&a.jsxs("div",{className:"properties-section",children:[a.jsxs("div",{className:"properties-section__header",children:[a.jsx("h4",{children:"Line Markings"}),a.jsx("button",{className:"btn-reset",onClick:()=>p(i),title:"Reset all colours to defaults",children:"Reset"})]}),a.jsxs("div",{className:"color-item color-item--all-lines",children:[a.jsxs("div",{className:"color-item__info",children:[a.jsx("span",{className:"color-item__name",children:"Change All Lines"}),a.jsx("span",{className:"color-item__hint",children:"Set all lines to same colour"})]}),a.jsx("button",{className:"color-item__swatch color-item__swatch--all",onClick:()=>R({type:"allLines"}),title:"Change all line colours at once",children:a.jsx("span",{style:{fontSize:"1rem"},children:""})})]}),a.jsx("div",{className:"color-list",children:_.markings.map(le=>{const ce=G(le);return a.jsxs("div",{className:"color-item",children:[a.jsxs("div",{className:"color-item__info",children:[a.jsx("span",{className:"color-item__name",children:le.name}),ce&&a.jsx("span",{className:"color-item__code",children:ce.code})]}),a.jsx("button",{className:"color-item__swatch",style:{backgroundColor:(ce==null?void 0:ce.hex)||"#000"},onClick:()=>R({type:"line",id:le.id}),title:(ce==null?void 0:ce.name)||"Select colour"})]},le.id)})})]}),S==="zones"&&a.jsxs("div",{className:"properties-section",children:[a.jsx("div",{className:"properties-section__header",children:a.jsx("h4",{children:"Fill Colours"})}),a.jsxs("div",{className:"color-item color-item--surface-fill",children:[a.jsxs("div",{className:"color-item__info",children:[a.jsx("span",{className:"color-item__name",children:"Court Surface"}),a.jsx("span",{className:"color-item__hint",children:O.courtSurfaceColor?O.courtSurfaceColor.name:"No Fill (transparent)"}),O.courtSurfaceColor&&a.jsx("span",{className:"color-item__code",children:O.courtSurfaceColor.tpv_code})]}),a.jsx("button",{className:`color-item__swatch ${O.courtSurfaceColor?"":"color-item__swatch--no-fill"}`,style:{backgroundColor:((oe=O.courtSurfaceColor)==null?void 0:oe.hex)||"transparent"},onClick:()=>R({type:"courtSurface"}),title:((ae=O.courtSurfaceColor)==null?void 0:ae.name)||"No Fill - Click to select colour"})]}),_.zones&&_.zones.length>0&&a.jsx("div",{className:"properties-section__divider",children:a.jsx("span",{children:"Paint Zones"})}),_.zones&&_.zones.length>0&&a.jsx("div",{className:"color-list",children:_.zones.map(le=>{var be;const ce=fe(le);return a.jsxs("div",{className:"color-item",children:[a.jsxs("div",{className:"color-item__info",children:[a.jsx("span",{className:"color-item__name",children:le.name}),a.jsxs("span",{className:"color-item__area",children:[((be=le.area_m2)==null?void 0:be.toFixed(1))||0," m"]}),ce&&a.jsx("span",{className:"color-item__code",children:ce.code})]}),a.jsx("button",{className:"color-item__swatch",style:{backgroundColor:(ce==null?void 0:ce.hex)||"#000"},onClick:()=>R({type:"zone",id:le.id}),title:(ce==null?void 0:ce.name)||"Select colour"})]},le.id)})})]})]}),T&&a.jsx("div",{className:"color-picker-modal",onClick:()=>R(null),children:a.jsxs("div",{className:"color-picker-modal__content",onClick:le=>le.stopPropagation(),children:[a.jsxs("div",{className:"color-picker-modal__header",children:[a.jsx("h4",{children:T.type==="allLines"?"Change All Line Colours":T.type==="courtSurface"?"Select Court Fill Colour":"Select TPV Colour"}),a.jsx("button",{onClick:()=>R(null),children:""})]}),a.jsxs("div",{className:"color-picker-grid",children:[T.type==="courtSurface"&&a.jsx("button",{className:"color-picker-swatch color-picker-swatch--no-fill",onClick:()=>U(null),title:"No Fill (transparent)",children:a.jsx("span",{className:"color-picker-swatch__code",children:"None"})}),nn.map(le=>a.jsx("button",{className:"color-picker-swatch",style:{backgroundColor:le.hex},onClick:()=>U(le),title:`${le.code} - ${le.name}`,children:a.jsx("span",{className:"color-picker-swatch__code",children:le.code})},le.code))]})]})})]})}function aE({track:t,trackId:e}){var _,V,re;const{updateTrackParameters:r,removeTrack:n,setTrackSurfaceColor:i}=Qe(),{parameters:o,template:s,trackSurfaceColor:l}=t,[c,d]=$.useState(!0),[h,f]=$.useState(!1),u=s.trackType==="straight",p=Ew(o),g=((_=p.lanes[0])==null?void 0:_.perimeter)||0,m=p.lanes[p.lanes.length-1],x=(m==null?void 0:m.perimeter)||0,v=u?[]:Tw(p),y=I=>{const q=parseInt(I);if(!(isNaN(q)||q<1||q>8))if(u){const D=q*o.laneWidth_mm;r(e,{numLanes:q,width_mm:D})}else r(e,{numLanes:q})},b=I=>{const q=parseFloat(I)*1e3;isNaN(q)||q<3e3||r(e,{width_mm:q})},w=I=>{const q=parseFloat(I)*1e3;isNaN(q)||q<3e3||r(e,{height_mm:q})},k=(I,q)=>{const D=parseFloat(q)*1e3;if(isNaN(D)||D<0)return;const J=Math.min(o.width_mm,o.height_mm)/2,U=Math.min(D,J);c?r(e,{cornerRadius:{topLeft:U,topRight:U,bottomLeft:U,bottomRight:U}}):r(e,{cornerRadius:{...o.cornerRadius,[I]:U}})},S=()=>{window.confirm(`Delete ${s.name}? This action cannot be undone.`)&&n(e)},C=I=>{i(e,{tpv_code:I.code,hex:I.hex,name:I.name}),f(!1)},T=I=>{r(e,{startingBoxes:{...o.startingBoxes,enabled:I}})},R=I=>{const q=parseFloat(I)*1e3;isNaN(q)||q<100||r(e,{startingBoxes:{...o.startingBoxes,depth_mm:q}})},O=I=>{r(e,{startingBoxes:{...o.startingBoxes,style:I}})},Y=I=>{r(e,{startingBoxes:{...o.startingBoxes,direction:I}})},E=I=>{const q=parseFloat(I);isNaN(q)||q<0||q>100||r(e,{startingBoxes:{...o.startingBoxes,startPosition:q}})},B=(o.cornerRadius.topLeft+o.cornerRadius.topRight+o.cornerRadius.bottomLeft+o.cornerRadius.bottomRight)/4;return a.jsxs("div",{className:"properties-panel",children:[a.jsxs("div",{className:"properties-panel__header",children:[a.jsx("h3",{children:"Track Properties"}),a.jsxs("div",{className:"properties-panel__court-info",children:[a.jsx("span",{className:"court-name",children:s.name}),a.jsx("span",{className:"court-standard",children:s.standard})]})]}),a.jsx("div",{className:"properties-panel__content",children:a.jsxs("div",{className:"properties-section",children:[a.jsx("div",{className:"properties-section__header",children:a.jsx("h4",{children:"Track Parameters"})}),a.jsxs("div",{className:"property-group",children:[a.jsx("label",{children:"Number of Lanes"}),a.jsxs("div",{className:"property-input-row",children:[a.jsx("input",{type:"range",min:"1",max:"8",value:o.numLanes,onChange:I=>y(I.target.value),className:"property-slider"}),a.jsxs("div",{className:"property-input-group property-input-group--compact",children:[a.jsx("input",{type:"number",value:o.numLanes,onChange:I=>y(I.target.value),min:"1",max:"8"}),a.jsx("span",{className:"property-unit",children:"lanes"})]})]})]}),u?a.jsxs("div",{className:"property-group property-group--info",children:[a.jsx("label",{children:"Track Width"}),a.jsx("div",{className:"property-info",children:a.jsxs("span",{children:[(o.width_mm/1e3).toFixed(1),"m (Auto-calculated from lanes)"]})})]}):a.jsxs("div",{className:"property-group",children:[a.jsx("label",{children:"Track Width"}),a.jsxs("div",{className:"property-input-group",children:[a.jsx("input",{type:"number",value:(o.width_mm/1e3).toFixed(1),onChange:I=>b(I.target.value),min:"3",max:"100",step:"0.5"}),a.jsx("span",{className:"property-unit",children:"m"})]})]}),a.jsxs("div",{className:"property-group",children:[a.jsx("label",{children:u?"Track Length":"Track Height"}),a.jsxs("div",{className:"property-input-group",children:[a.jsx("input",{type:"number",value:(o.height_mm/1e3).toFixed(1),onChange:I=>w(I.target.value),min:"3",max:"100",step:"0.5"}),a.jsx("span",{className:"property-unit",children:"m"})]})]}),!u&&a.jsxs("div",{className:"property-group",children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[a.jsx("label",{children:"Corner Radius"}),a.jsx("button",{className:"btn-toggle",onClick:()=>d(!c),style:{padding:"0.25rem 0.5rem",fontSize:"0.75rem",background:c?"#0066CC":"#6b7280",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},title:c?"Click to edit corners independently":"Click to lock all corners together",children:c?" Locked":" Independent"})]}),c?a.jsxs("div",{className:"property-input-group",children:[a.jsx("input",{type:"number",defaultValue:(B/1e3).toFixed(2),onBlur:I=>k("topLeft",I.target.value),onKeyDown:I=>I.key==="Enter"&&I.target.blur(),min:"0",max:(Math.min(o.width_mm,o.height_mm)/2e3).toFixed(0),step:"0.5"},`locked-${B}`),a.jsx("span",{className:"property-unit",children:"m"})]}):a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs("div",{children:[a.jsx("label",{style:{fontSize:"0.75rem",color:"#64748b"},children:"Top Left"}),a.jsxs("div",{className:"property-input-group",children:[a.jsx("input",{type:"number",defaultValue:(o.cornerRadius.topLeft/1e3).toFixed(2),onBlur:I=>k("topLeft",I.target.value),onKeyDown:I=>I.key==="Enter"&&I.target.blur(),min:"0",max:(Math.min(o.width_mm,o.height_mm)/2e3).toFixed(0),step:"0.5"},`tl-${o.cornerRadius.topLeft}`),a.jsx("span",{className:"property-unit",children:"m"})]})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontSize:"0.75rem",color:"#64748b"},children:"Top Right"}),a.jsxs("div",{className:"property-input-group",children:[a.jsx("input",{type:"number",defaultValue:(o.cornerRadius.topRight/1e3).toFixed(2),onBlur:I=>k("topRight",I.target.value),onKeyDown:I=>I.key==="Enter"&&I.target.blur(),min:"0",max:(Math.min(o.width_mm,o.height_mm)/2e3).toFixed(0),step:"0.5"},`tr-${o.cornerRadius.topRight}`),a.jsx("span",{className:"property-unit",children:"m"})]})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontSize:"0.75rem",color:"#64748b"},children:"Bottom Left"}),a.jsxs("div",{className:"property-input-group",children:[a.jsx("input",{type:"number",defaultValue:(o.cornerRadius.bottomLeft/1e3).toFixed(2),onBlur:I=>k("bottomLeft",I.target.value),onKeyDown:I=>I.key==="Enter"&&I.target.blur(),min:"0",max:(Math.min(o.width_mm,o.height_mm)/2e3).toFixed(0),step:"0.5"},`bl-${o.cornerRadius.bottomLeft}`),a.jsx("span",{className:"property-unit",children:"m"})]})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontSize:"0.75rem",color:"#64748b"},children:"Bottom Right"}),a.jsxs("div",{className:"property-input-group",children:[a.jsx("input",{type:"number",defaultValue:(o.cornerRadius.bottomRight/1e3).toFixed(2),onBlur:I=>k("bottomRight",I.target.value),onKeyDown:I=>I.key==="Enter"&&I.target.blur(),min:"0",max:(Math.min(o.width_mm,o.height_mm)/2e3).toFixed(0),step:"0.5"},`br-${o.cornerRadius.bottomRight}`),a.jsx("span",{className:"property-unit",children:"m"})]})]})]})]}),a.jsxs("div",{className:"property-group property-group--info",children:[a.jsx("label",{children:"Lane Width"}),a.jsx("div",{className:"property-info",children:a.jsxs("span",{children:[(o.laneWidth_mm/1e3).toFixed(2),"m (Fixed)"]})})]}),a.jsxs("div",{className:"property-group",children:[a.jsx("label",{children:"Track Surface Colour"}),a.jsxs("div",{className:"color-item",children:[a.jsxs("div",{className:"color-item__info",children:[a.jsx("span",{className:"color-item__name",children:(l==null?void 0:l.name)||"Select Colour"}),l&&a.jsx("span",{className:"color-item__code",children:l.tpv_code})]}),a.jsx("button",{className:"color-item__swatch",style:{backgroundColor:(l==null?void 0:l.hex)||"#A5362F"},onClick:()=>f(!0),title:(l==null?void 0:l.name)||"Select colour"})]})]}),a.jsxs("div",{className:"property-group",children:[a.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[a.jsx("input",{type:"checkbox",checked:((V=o.startingBoxes)==null?void 0:V.enabled)||!1,onChange:I=>T(I.target.checked)}),"Show Starting Boxes"]}),((re=o.startingBoxes)==null?void 0:re.enabled)&&a.jsxs("div",{style:{marginTop:"0.75rem"},children:[a.jsxs("div",{className:"property-input-group",style:{marginBottom:"0.75rem"},children:[a.jsx("span",{className:"property-label",style:{fontSize:"0.875rem"},children:"Depth"}),a.jsx("input",{type:"number",value:(o.startingBoxes.depth_mm/1e3).toFixed(2),onChange:I=>R(I.target.value),min:"0.1",max:"1.0",step:"0.05"}),a.jsx("span",{className:"property-unit",children:"m"})]}),!u&&a.jsxs("div",{style:{marginBottom:"0.75rem"},children:[a.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#64748b",marginBottom:"0.375rem"},children:"Start Style"}),a.jsxs("select",{value:o.startingBoxes.style||"staggered",onChange:I=>O(I.target.value),style:{width:"100%",padding:"0.5rem",border:"1px solid #e4e9f0",borderRadius:"6px",fontSize:"0.875rem",fontFamily:"inherit",background:"white"},children:[a.jsx("option",{value:"straight",children:"Straight Start"}),a.jsx("option",{value:"staggered",children:"Staggered Start"}),a.jsx("option",{value:"both",children:"Both (opposite ends)"})]})]}),a.jsxs("div",{style:{marginBottom:"0.75rem"},children:[a.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#64748b",marginBottom:"0.375rem"},children:"Direction of Travel"}),a.jsxs("select",{value:o.startingBoxes.direction||"counterclockwise",onChange:I=>Y(I.target.value),style:{width:"100%",padding:"0.5rem",border:"1px solid #e4e9f0",borderRadius:"6px",fontSize:"0.875rem",fontFamily:"inherit",background:"white"},children:[a.jsx("option",{value:"counterclockwise",children:"Counterclockwise (Standard)"}),a.jsx("option",{value:"clockwise",children:"Clockwise"})]})]}),!u&&a.jsxs("div",{style:{marginBottom:"0.75rem"},children:[a.jsxs("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#64748b",marginBottom:"0.375rem"},children:["Start Position (",o.startingBoxes.startPosition||0,"%)"]}),a.jsx("input",{type:"range",min:"0",max:"100",step:"1",value:o.startingBoxes.startPosition||0,onChange:I=>E(I.target.value),className:"property-slider",style:{width:"100%"}}),a.jsx("div",{style:{fontSize:"0.7rem",color:"#94a3b8",marginTop:"0.25rem"},children:"Slide to adjust where the start line appears around the track"})]}),a.jsx("div",{className:"property-info",style:{fontSize:"0.75rem",color:"#64748b",marginTop:"0.5rem"},children:"Boxes use track surface colour with white starting line and lane numbers"}),!u&&v.length>0&&(o.startingBoxes.style==="staggered"||o.startingBoxes.style==="both")&&a.jsxs("div",{style:{marginTop:"0.75rem",padding:"0.5rem",background:"#f8fafc",borderRadius:"4px"},children:[a.jsx("div",{style:{fontSize:"0.75rem",fontWeight:"600",color:"#1e293b",marginBottom:"0.25rem"},children:"Auto-Calculated Staggers:"}),a.jsx("div",{style:{fontSize:"0.7rem",color:"#64748b",lineHeight:"1.4"},children:v.map((I,q)=>a.jsxs("div",{children:["Lane ",q+1,": ",(I/1e3).toFixed(2),"m"]},q))}),a.jsx("div",{style:{fontSize:"0.65rem",color:"#64748b",marginTop:"0.25rem",fontStyle:"italic"},children:"Outer lanes start ahead to equalize distance"})]})]})]}),a.jsx("div",{className:"property-divider"}),a.jsx("div",{className:"properties-section__header",children:a.jsx("h4",{children:"Calculated Dimensions"})}),a.jsxs("div",{className:"property-group property-group--info",children:[a.jsx("label",{children:"Usable Infield"}),a.jsx("div",{className:"property-info",children:a.jsxs("span",{children:[(p.usableWidth/1e3).toFixed(1),"m  ",(p.usableHeight/1e3).toFixed(1),"m"]})})]}),a.jsxs("div",{className:"property-group property-group--info",children:[a.jsx("label",{children:"Lane 1 Perimeter"}),a.jsx("div",{className:"property-info",children:a.jsxs("span",{children:[g.toFixed(2),"m"]})})]}),o.numLanes>1&&a.jsxs("div",{className:"property-group property-group--info",children:[a.jsxs("label",{children:["Lane ",o.numLanes," Perimeter"]}),a.jsx("div",{className:"property-info",children:a.jsxs("span",{children:[x.toFixed(2),"m"]})})]}),a.jsx("div",{className:"property-group",children:a.jsx("div",{className:"property-hint",style:{fontStyle:"normal",color:"#64748b",fontSize:"0.75rem",marginTop:"1rem"},children:" Tip: Use drag handles on the canvas or edit values here. Corner radius auto-adjusts when locked."})}),a.jsx("div",{className:"property-group property-group--actions",children:a.jsx("button",{className:"btn-delete",onClick:S,title:"Delete track (Delete key)",children:" Delete Track"})})]})}),h&&a.jsx("div",{className:"color-picker-modal",onClick:()=>f(!1),children:a.jsxs("div",{className:"color-picker-modal__content",onClick:I=>I.stopPropagation(),children:[a.jsxs("div",{className:"color-picker-modal__header",children:[a.jsx("h4",{children:"Select Track Surface Colour"}),a.jsx("button",{onClick:()=>f(!1),children:""})]}),a.jsx("div",{className:"color-picker-grid",children:nn.map(I=>a.jsx("button",{className:"color-picker-swatch",style:{backgroundColor:I.hex},onClick:()=>C(I),title:`${I.code} - ${I.name}`,children:a.jsx("span",{className:"color-picker-swatch__code",children:I.code})},I.code))})]})})]})}function lE({motif:t,motifId:e,onEditSourceDesign:r}){const{updateMotifPosition:n,updateMotifRotation:i,updateMotifScale:o,removeMotif:s,duplicateMotif:l,refreshMotif:c,setMotifViewMode:d}=Qe(),{position:h,rotation:f,scale:u,sourceDesignName:p,sourceDesignId:g,originalWidth_mm:m,originalHeight_mm:x,sourceThumbnailUrl:v,viewMode:y,hasBothVersions:b}=t,[w,k]=$.useState(!1),[S,C]=$.useState(null),T=(I,q)=>{const D=parseFloat(q);isNaN(D)||n(e,{...h,[I]:D})},R=I=>{const q=parseFloat(I);isNaN(q)||i(e,q)},O=I=>{const q=parseFloat(I);isNaN(q)||q<=0||o(e,q)},Y=()=>{window.confirm("Delete this motif? This action cannot be undone.")&&s(e)},E=()=>{l(e)},B=()=>{if(r)r(g);else{if(!g){alert("Source design ID not found");return}window.open(`/studio/?design=${g}`,"_blank")}},_=async()=>{if(!w){k(!0),C(null);try{const I=await c(e);I.success||C(I.error||"Failed to refresh")}catch(I){C(I.message||"Failed to refresh")}finally{k(!1)}}},V=m*(u||1)/1e3,re=x*(u||1)/1e3;return a.jsxs("div",{className:"properties-panel",children:[a.jsxs("div",{className:"properties-panel__header",children:[a.jsx("h3",{children:"Motif Properties"}),a.jsxs("div",{className:"properties-panel__court-info",children:[a.jsx("span",{className:"court-name",children:p||"Unnamed Motif"}),a.jsx("span",{className:"court-standard",children:"Playground Design"})]})]}),a.jsx("div",{className:"properties-panel__content",children:a.jsxs("div",{className:"properties-section",children:[v&&a.jsxs("div",{className:"property-group",children:[a.jsx("label",{children:"Preview"}),a.jsx("div",{style:{width:"100%",height:"80px",background:"#f3f4f6",borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden"},children:a.jsx("img",{src:v,alt:p,style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})})]}),b&&a.jsxs("div",{className:"property-group",children:[a.jsx("label",{children:"Colour Style"}),a.jsxs("div",{className:"property-toggle-buttons",children:[a.jsx("button",{className:`toggle-btn ${y==="solid"?"toggle-btn--active":""}`,onClick:()=>d(e,"solid"),children:"Solid"}),a.jsx("button",{className:`toggle-btn ${y==="blend"?"toggle-btn--active":""}`,onClick:()=>d(e,"blend"),children:"Blend"})]})]}),a.jsx("div",{className:"properties-section__header",children:a.jsx("h4",{children:"Transform"})}),a.jsxs("div",{className:"property-group",children:[a.jsx("label",{children:"Position"}),a.jsxs("div",{className:"property-input-row",children:[a.jsxs("div",{className:"property-input-group",children:[a.jsx("span",{className:"property-label",children:"X"}),a.jsx("input",{type:"number",value:Math.round(h.x),onChange:I=>T("x",I.target.value),step:"100"}),a.jsx("span",{className:"property-unit",children:"mm"})]}),a.jsxs("div",{className:"property-input-group",children:[a.jsx("span",{className:"property-label",children:"Y"}),a.jsx("input",{type:"number",value:Math.round(h.y),onChange:I=>T("y",I.target.value),step:"100"}),a.jsx("span",{className:"property-unit",children:"mm"})]})]})]}),a.jsxs("div",{className:"property-group",children:[a.jsx("label",{children:"Rotation"}),a.jsxs("div",{className:"property-input-row",children:[a.jsx("input",{type:"range",min:"0",max:"360",value:f||0,onChange:I=>R(I.target.value),className:"property-slider"}),a.jsxs("div",{className:"property-input-group property-input-group--compact",children:[a.jsx("input",{type:"number",value:Math.round(f||0),onChange:I=>R(I.target.value),min:"0",max:"360"}),a.jsx("span",{className:"property-unit",children:""})]})]})]}),a.jsxs("div",{className:"property-group",children:[a.jsxs("label",{children:["Scale",a.jsx("span",{style:{fontSize:"0.7rem",color:"#64748b",marginLeft:"0.5rem"},children:"(aspect locked)"})]}),a.jsxs("div",{className:"property-input-row",children:[a.jsx("input",{type:"range",min:"0.1",max:"10",step:"0.1",value:Math.min(u||1,10),onChange:I=>O(I.target.value),className:"property-slider"}),a.jsxs("div",{className:"property-input-group property-input-group--compact",children:[a.jsx("input",{type:"number",value:(u||1).toFixed(2),onChange:I=>O(I.target.value),min:"0.1",step:"0.1"}),a.jsx("span",{className:"property-unit",children:""})]})]})]}),a.jsxs("div",{className:"property-group property-group--info",children:[a.jsx("label",{children:"Current Size"}),a.jsx("div",{className:"property-info",children:a.jsxs("span",{children:[V.toFixed(2),"m  ",re.toFixed(2),"m"]})})]}),a.jsxs("div",{className:"property-group property-group--info",children:[a.jsx("label",{children:"Original Size"}),a.jsx("div",{className:"property-info",children:a.jsxs("span",{children:[(m/1e3).toFixed(2),"m  ",(x/1e3).toFixed(2),"m"]})})]}),a.jsx("div",{className:"properties-section__divider",style:{margin:"1rem 0"},children:a.jsx("span",{children:"Source Design"})}),a.jsx("div",{className:"property-group property-group--actions",children:a.jsx("button",{className:"btn-primary",onClick:B,title:"Edit the source playground design in a new tab",style:{width:"100%",padding:"0.5rem",background:"var(--color-primary, #1e4a7a)",color:"white",border:"none",borderRadius:"6px",fontSize:"0.875rem",fontFamily:"inherit",cursor:"pointer",marginBottom:"0.5rem",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem"},children:" Edit Source Design"})}),a.jsxs("div",{className:"property-group property-group--actions",children:[a.jsx("button",{className:"btn-secondary",onClick:_,disabled:w,title:"Refresh this motif with the latest version from the source design",style:{width:"100%",padding:"0.5rem",background:w?"#e5e7eb":"#f3f4f6",border:"1px solid #e4e9f0",borderRadius:"6px",fontSize:"0.875rem",fontFamily:"inherit",cursor:w?"not-allowed":"pointer",marginBottom:"0.5rem",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem"},children:w?" Refreshing...":" Refresh from Source"}),S&&a.jsx("div",{style:{fontSize:"0.75rem",color:"#dc2626",marginTop:"0.25rem"},children:S}),a.jsx("div",{style:{fontSize:"0.7rem",color:"#64748b",marginTop:"0.25rem"},children:"Click after editing the source design to update this motif"})]}),a.jsx("div",{className:"properties-section__divider",style:{margin:"1rem 0"},children:a.jsx("span",{children:"Actions"})}),a.jsx("div",{className:"property-group property-group--actions",children:a.jsx("button",{className:"btn-secondary",onClick:E,title:"Duplicate motif (Ctrl+D)",style:{width:"100%",padding:"0.5rem",background:"#f3f4f6",border:"1px solid #e4e9f0",borderRadius:"6px",fontSize:"0.875rem",fontFamily:"inherit",cursor:"pointer",marginBottom:"0.5rem"},children:" Duplicate Motif"})}),a.jsx("div",{className:"property-group property-group--actions",children:a.jsx("button",{className:"btn-delete",onClick:Y,title:"Delete motif (Delete key)",children:" Delete Motif"})}),a.jsx("div",{className:"property-group",children:a.jsx("div",{className:"property-hint",style:{fontStyle:"normal",color:"#64748b",fontSize:"0.75rem",marginTop:"1rem"},children:' Tip: Drag the motif on the canvas to reposition. Edit the source design and click "Refresh" to update.'})})]})})]})}function cE(){const{courts:t,tracks:e,motifs:r,elementOrder:n,selectedCourtId:i,selectedTrackId:o,selectedMotifId:s,setElementOrder:l,selectCourt:c,selectTrack:d,selectMotif:h,bringToFront:f,sendToBack:u,duplicateCourt:p,duplicateTrack:g,duplicateMotif:m,removeCourt:x,removeTrack:v,removeMotif:y,renameElement:b,toggleElementLock:w,toggleElementVisibility:k,addToHistory:S}=Qe(),[C,T]=A.useState(null),[R,O]=A.useState(null),[Y,E]=A.useState(null),[B,_]=A.useState(null),[V,re]=A.useState("");A.useEffect(()=>{const M=()=>E(null);if(Y)return document.addEventListener("click",M),()=>document.removeEventListener("click",M)},[Y]);const I=[...n].reverse(),q=M=>{var N,P,F;if(M.startsWith("court-")){const X=t[M];return{type:"court",name:(X==null?void 0:X.customName)||((N=X==null?void 0:X.template)==null?void 0:N.name)||"Unknown Court",icon:"",sport:((P=X==null?void 0:X.template)==null?void 0:P.sport)||"",locked:(X==null?void 0:X.locked)||!1,visible:(X==null?void 0:X.visible)!==!1}}else if(M.startsWith("track-")){const X=e[M];return{type:"track",name:(X==null?void 0:X.customName)||((F=X==null?void 0:X.template)==null?void 0:F.name)||"Unknown Track",icon:"",sport:"athletics",locked:(X==null?void 0:X.locked)||!1,visible:(X==null?void 0:X.visible)!==!1}}else if(M.startsWith("motif-")){const X=r[M];return{type:"motif",name:(X==null?void 0:X.customName)||(X==null?void 0:X.sourceDesignName)||"Unknown Motif",icon:"",sport:"playground",locked:(X==null?void 0:X.locked)||!1,visible:(X==null?void 0:X.visible)!==!1}}return{type:"unknown",name:"Unknown",icon:"",sport:"",locked:!1,visible:!0}},D=M=>M===i||M===o||M===s,J=M=>{M.startsWith("court-")?c(M):M.startsWith("track-")?d(M):M.startsWith("motif-")&&h(M)},U=(M,N)=>{T(N),M.dataTransfer.effectAllowed="move",M.dataTransfer.setData("text/plain",N),setTimeout(()=>{M.target.classList.add("layer-item--dragging")},0)},G=M=>{M.target.classList.remove("layer-item--dragging"),T(null),O(null)},fe=(M,N)=>{M.preventDefault(),M.dataTransfer.dropEffect="move",N!==C&&O(N)},oe=()=>{O(null)},ae=(M,N)=>{if(M.preventDefault(),!C||C===N){T(null),O(null);return}const P=[...n],F=P.indexOf(C),X=P.indexOf(N);if(F===-1||X===-1)return;P.splice(F,1);const K=I.indexOf(C),L=I.indexOf(N);K<L,P.splice(X,0,C),l(P),S(),T(null),O(null)},le=(M,N)=>{M.stopPropagation(),f(N),E(null)},ce=(M,N)=>{M.stopPropagation(),u(N),E(null)},be=(M,N)=>{M.stopPropagation(),N.startsWith("court-")?p(N):N.startsWith("track-")?g(N):N.startsWith("motif-")&&m(N),E(null)},Ce=(M,N)=>{M.stopPropagation();const P=q(N);confirm(`Delete "${P.name}"?`)&&(N.startsWith("court-")?x(N):N.startsWith("track-")?v(N):N.startsWith("motif-")&&y(N)),E(null)},ue=(M,N)=>{M.stopPropagation();const P=q(N);_(N),re(P.name),E(null)},de=M=>{V.trim()&&b(M,V.trim()),_(null),re("")},ze=(M,N)=>{M.key==="Enter"?de(N):M.key==="Escape"&&(_(null),re(""))},Ge=(M,N)=>{M.stopPropagation(),w(N),E(null)},j=(M,N)=>{M.stopPropagation(),k(N),E(null)},ie=(M,N)=>{M.stopPropagation(),E(Y===N?null:N)};return n.length===0?a.jsx("div",{className:"layers-panel layers-panel--empty",children:a.jsxs("div",{className:"layers-panel__empty-state",children:[a.jsx("span",{className:"layers-panel__empty-icon",children:""}),a.jsx("p",{children:"No elements yet"}),a.jsx("span",{className:"layers-panel__empty-hint",children:"Add courts, tracks, or motifs from the library"})]})}):a.jsxs("div",{className:"layers-panel",children:[a.jsxs("div",{className:"layers-panel__header",children:[a.jsx("h4",{children:"Layers"}),a.jsx("span",{className:"layers-panel__count",children:n.length})]}),a.jsx("div",{className:"layers-panel__hint",children:"Drag to reorder layers. Top = front, bottom = back."}),a.jsx("div",{className:"layers-panel__list",children:I.map((M,N)=>{const P=q(M),F=D(M),X=M===R,K=N===0,L=N===I.length-1,H=B===M;return a.jsxs("div",{className:`layer-item ${F?"layer-item--selected":""} ${X?"layer-item--drag-over":""} ${P.locked?"layer-item--locked":""} ${P.visible?"":"layer-item--hidden"}`,draggable:!P.locked&&!H,onDragStart:Z=>U(Z,M),onDragEnd:G,onDragOver:Z=>fe(Z,M),onDragLeave:oe,onDrop:Z=>ae(Z,M),onClick:()=>!H&&J(M),children:[a.jsx("span",{className:`layer-item__handle ${P.locked?"layer-item__handle--disabled":""}`,title:P.locked?"Locked":"Drag to reorder",children:P.locked?"":""}),H?a.jsx("input",{type:"text",className:"layer-item__rename-input",value:V,onChange:Z=>re(Z.target.value),onBlur:()=>de(M),onKeyDown:Z=>ze(Z,M),autoFocus:!0,onClick:Z=>Z.stopPropagation()}):a.jsx("span",{className:`layer-item__name ${P.visible?"":"layer-item__name--hidden"}`,children:P.name}),a.jsx("div",{className:"layer-item__indicators",children:!P.visible&&a.jsx("span",{className:"layer-item__indicator",title:"Hidden",children:""})}),a.jsxs("div",{className:"layer-item__actions",children:[a.jsx("button",{className:"layer-item__menu-btn",onClick:Z=>ie(Z,M),title:"More actions",children:""}),Y===M&&a.jsxs("div",{className:"layer-item__menu",children:[a.jsx("button",{onClick:Z=>le(Z,M),disabled:K,children:" Bring to Front"}),a.jsx("button",{onClick:Z=>ce(Z,M),disabled:L,children:" Send to Back"}),a.jsx("div",{className:"layer-item__menu-divider"}),a.jsx("button",{onClick:Z=>be(Z,M),children:" Duplicate"}),a.jsx("button",{onClick:Z=>ue(Z,M),children:" Rename"}),a.jsx("div",{className:"layer-item__menu-divider"}),a.jsx("button",{onClick:Z=>Ge(Z,M),children:P.locked?" Unlock":" Lock"}),a.jsx("button",{onClick:Z=>j(Z,M),children:P.visible?" Hide":" Show"}),a.jsx("div",{className:"layer-item__menu-divider"}),a.jsx("button",{onClick:Z=>Ce(Z,M),className:"layer-item__menu-delete",children:" Delete"})]})]})]},M)})}),a.jsx("div",{className:"layers-panel__footer",children:a.jsx("span",{className:"layers-panel__shortcut-hint",children:"Tip: Use [ and ] keys to reorder selected element"})})]})}async function Pw(){var r,n;const t=await Pt.auth.getSession(),e=(n=(r=t==null?void 0:t.data)==null?void 0:r.session)==null?void 0:n.access_token;if(!e)throw new Error("Not authenticated");return{"Content-Type":"application/json",Authorization:`Bearer ${e}`}}async function Ow(t){const e=await Pw(),r=await fetch("/api/projects/create",{method:"POST",headers:e,body:JSON.stringify(t)});if(!r.ok){const n=await r.json();throw new Error(n.error||"Unable to create project. Please check your connection and try again.")}return r.json()}async function pp(){const t=await Pw(),e=await fetch("/api/projects/list",{method:"GET",headers:t});if(!e.ok){const r=await e.json();throw new Error(r.error||"Unable to load your projects. Please refresh the page and try again.")}return e.json()}function dE(t,e={}){var r,n;return{type:"sports_surface",version:"1.0",name:e.name||t.name||"Untitled Design",description:e.description||t.description||"",tags:e.tags||t.tags||[],surface:t.surface,courts:uE(t.courts),tracks:hE(t.tracks),motifs:fE(t.motifs),elementOrder:t.elementOrder||[],customMarkings:t.customMarkings||[],backgroundZones:t.backgroundZones||[],dimensions:{width_mm:((r=t.surface)==null?void 0:r.width_mm)||5e4,length_mm:((n=t.surface)==null?void 0:n.length_mm)||5e4}}}function uE(t){return t?Object.fromEntries(Object.entries(t).map(([e,r])=>[e,{id:r.id,templateId:r.templateId,template:r.template,position:r.position,rotation:r.rotation,scale:r.scale,lineColorOverrides:r.lineColorOverrides||{},zoneColorOverrides:r.zoneColorOverrides||{},courtSurfaceColor:r.courtSurfaceColor}])):{}}function hE(t){return t?Object.fromEntries(Object.entries(t).map(([e,r])=>[e,{id:r.id,templateId:r.templateId,template:r.template,position:r.position,rotation:r.rotation,parameters:r.parameters,trackSurfaceColor:r.trackSurfaceColor}])):{}}function fE(t){return t?Object.fromEntries(Object.entries(t).map(([e,r])=>[e,{id:r.id,type:"motif",sourceDesignId:r.sourceDesignId,sourceDesignName:r.sourceDesignName,sourceThumbnailUrl:r.sourceThumbnailUrl,svgContent:r.svgContent,originalWidth_mm:r.originalWidth_mm,originalHeight_mm:r.originalHeight_mm,position:r.position,rotation:r.rotation,scale:r.scale}])):{}}function pE(t){var n,i;const e=[];return t.surface||e.push("Surface configuration is required"),(!((n=t.surface)!=null&&n.width_mm)||!((i=t.surface)!=null&&i.length_mm))&&e.push("Surface dimensions are required"),t.courts&&Object.keys(t.courts).length>0||t.tracks&&Object.keys(t.tracks).length>0||t.motifs&&Object.keys(t.motifs).length>0||e.push("Add at least one court, track, or motif to save"),{valid:e.length===0,errors:e}}async function mE(t,e=400){return new Promise((r,n)=>{try{const i=t.cloneNode(!0);i.querySelectorAll(".court-canvas__court--selected, .transform-handles").forEach(g=>{g.classList.remove("court-canvas__court--selected")}),i.querySelectorAll(".transform-handles").forEach(g=>g.remove());const o=t.getAttribute("viewBox").split(" ").map(Number),s=o[2],l=o[3];let c,d;s>l?(c=e,d=Math.round(l/s*e)):(d=e,c=Math.round(s/l*e)),i.setAttribute("width",c),i.setAttribute("height",d);const h=new XMLSerializer().serializeToString(i),f=new Blob([h],{type:"image/svg+xml;charset=utf-8"}),u=URL.createObjectURL(f),p=new Image;p.onload=()=>{const g=document.createElement("canvas");g.width=c,g.height=d;const m=g.getContext("2d");m.fillStyle="#ffffff",m.fillRect(0,0,c,d),m.drawImage(p,0,0,c,d),g.toBlob(x=>{URL.revokeObjectURL(u),r(x)},"image/png",.9)},p.onerror=g=>{URL.revokeObjectURL(u),n(new Error("Failed to load SVG for thumbnail"))},p.src=u}catch(i){n(i)}})}async function gE(t){const r=`thumbnails/sports/${`sports-${Date.now()}-${Math.random().toString(36).substr(2,9)}.png`}`,{data:n,error:i}=await Pt.storage.from("tpv-studio-uploads").upload(r,t,{cacheControl:"3600",contentType:"image/png",upsert:!1});if(i)throw i;const{data:{publicUrl:o}}=Pt.storage.from("tpv-studio-uploads").getPublicUrl(r);return o}function vE({existingDesignId:t=null,initialName:e="",svgRef:r=null,onClose:n,onSaved:i}){const o=Qe(J=>J.exportDesignData),[s,l]=A.useState(e),[c,d]=A.useState(""),[h,f]=A.useState(""),[u,p]=A.useState(""),[g,m]=A.useState(!1),[x,v]=A.useState([]),[y,b]=A.useState(!1),[w,k]=A.useState(""),[S,C]=A.useState("#1a365d"),[T,R]=A.useState(!1),[O,Y]=A.useState(!1),[E,B]=A.useState(!1),[_,V]=A.useState(null);A.useEffect(()=>{re()},[]);const re=async()=>{try{const{projects:J}=await pp();v(J)}catch(J){console.error("Failed to load projects:",J),V("Failed to load projects")}},I=async()=>{if(!w.trim()){V("Project name is required");return}B(!0),V(null);try{const{project:J}=await Ow({name:w.trim(),color:S});v([J,...x]),f(J.id),b(!1),k(""),C("#1a365d")}catch(J){console.error("Failed to create project:",J),V(J.message)}finally{B(!1)}},q=async(J=!1)=>{if(!s.trim()){V("Design name is required");return}const U=o(),G=pE(U);if(!G.valid){V(G.errors.join(", "));return}J?Y(!0):R(!0),V(null);try{let fe=null;if(r!=null&&r.current)try{console.log("[SPORTS-SAVE] Generating thumbnail...");const ce=await mE(r.current);console.log("[SPORTS-SAVE] Uploading thumbnail..."),fe=await gE(ce),console.log("[SPORTS-SAVE] Thumbnail uploaded:",fe)}catch(ce){console.warn("[SPORTS-SAVE] Thumbnail generation failed, continuing without:",ce)}const oe=dE(U,{name:s.trim(),description:c.trim()||"",tags:u.split(",").map(ce=>ce.trim()).filter(ce=>ce)});console.log("[SPORTS-SAVE] Serialized design data:",oe);const ae={name:s.trim(),description:c.trim()||null,project_id:h||null,tags:u.split(",").map(ce=>ce.trim()).filter(ce=>ce),is_public:g,design_data:oe,thumbnail_url:fe};t&&!J&&(ae.id=t);const le=await up(ae);i&&i(le,s.trim()),n()}catch(fe){console.error("Failed to save design:",fe),V(fe.message)}finally{R(!1),Y(!1)}},D=["#1a365d","#ff6b35","#4a90e2","#50c878","#9b59b6","#e74c3c"];return a.jsx("div",{className:"modal-overlay",onClick:n,children:a.jsxs("div",{className:"modal-content save-design-modal",onClick:J=>J.stopPropagation(),children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h2",{children:t?"Update Design":"Save Design"}),a.jsx("button",{onClick:n,className:"close-button",children:""})]}),a.jsxs("div",{className:"modal-body",children:[_&&a.jsx("div",{className:"error-message",children:_}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"design-name",children:"Design Name *"}),a.jsx("input",{id:"design-name",type:"text",value:s,onChange:J=>l(J.target.value),placeholder:"e.g., Multi-Sport Court Design",autoFocus:!0,disabled:T||O})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"design-description",children:"Description"}),a.jsx("textarea",{id:"design-description",value:c,onChange:J=>d(J.target.value),placeholder:"Optional notes about this sports surface design...",rows:3,disabled:T||O})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"design-project",children:"Project"}),y?a.jsxs("div",{className:"new-project-form",children:[a.jsxs("div",{className:"input-row",children:[a.jsx("input",{type:"text",value:w,onChange:J=>k(J.target.value),placeholder:"Project name...",disabled:E}),a.jsx("div",{className:"color-picker-inline",children:D.map(J=>a.jsx("button",{type:"button",className:`color-swatch ${S===J?"active":""}`,style:{backgroundColor:J},onClick:()=>C(J),disabled:E},J))})]}),a.jsxs("div",{className:"button-row",children:[a.jsx("button",{type:"button",onClick:I,className:"btn-primary btn-small",disabled:E,children:E?"Creating...":"Create"}),a.jsx("button",{type:"button",onClick:()=>b(!1),className:"btn-secondary btn-small",disabled:E,children:"Cancel"})]})]}):a.jsxs("div",{className:"project-selector",children:[a.jsxs("select",{id:"design-project",value:h,onChange:J=>f(J.target.value),disabled:T||O,children:[a.jsx("option",{value:"",children:"No Project"}),x.map(J=>a.jsxs("option",{value:J.id,children:[J.name," (",J.design_count," designs)"]},J.id))]}),a.jsx("button",{type:"button",onClick:()=>b(!0),className:"btn-secondary btn-small",disabled:T||O,children:"+ New Project"})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"design-tags",children:"Tags"}),a.jsx("input",{id:"design-tags",type:"text",value:u,onChange:J=>p(J.target.value),placeholder:"e.g., tennis, multi-sport, school (comma-separated)",disabled:T||O}),a.jsx("small",{className:"help-text",children:"Separate tags with commas"})]}),a.jsx("div",{className:"form-group checkbox-group",children:a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:g,onChange:J=>m(J.target.checked),disabled:T||O}),a.jsx("span",{children:"Make this design public (shareable link)"})]})})]}),a.jsxs("div",{className:"modal-footer",children:[a.jsx("button",{onClick:n,className:"btn-secondary",disabled:T||O,children:"Cancel"}),t&&a.jsx("button",{onClick:()=>q(!0),className:"btn-secondary",disabled:T||O,children:O?"Saving...":"Save as New"}),a.jsx("button",{onClick:()=>q(!1),className:"btn-primary",disabled:T||O,children:T?"Saving...":t?"Update":"Save Design"})]})]})})}function mp(t,e){var f,u,p,g;if(!t)throw new Error("SVG element not found");const r=t.cloneNode(!0);r.querySelectorAll('.court-canvas__selection-outline, .transform-handles, [class*="selection"], [class*="handle"]').forEach(m=>m.remove()),r.querySelectorAll("[stroke-dasharray]").forEach(m=>{m.getAttribute("stroke-dasharray")&&m.remove()});const o=document.createElementNS("http://www.w3.org/2000/svg","title");o.textContent=(e==null?void 0:e.name)||"Sports Surface Design",r.insertBefore(o,r.firstChild);const s=document.createElementNS("http://www.w3.org/2000/svg","desc");s.textContent=`Generated by TPV Designer. Dimensions: ${(((f=e==null?void 0:e.surface)==null?void 0:f.width_mm)/1e3).toFixed(1)}m  ${(((u=e==null?void 0:e.surface)==null?void 0:u.length_mm)/1e3).toFixed(1)}m`,r.insertBefore(s,r.firstChild.nextSibling),r.setAttribute("xmlns","http://www.w3.org/2000/svg"),r.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");const l=((p=e==null?void 0:e.surface)==null?void 0:p.width_mm)||5e4,c=((g=e==null?void 0:e.surface)==null?void 0:g.length_mm)||5e4;r.setAttribute("width",`${l}mm`),r.setAttribute("height",`${c}mm`),r.setAttribute("data-tpv-studio","1.0"),r.setAttribute("data-design-type","sports_surface");let h=new XMLSerializer().serializeToString(r);return h=`<?xml version="1.0" encoding="UTF-8"?>
`+h,h}function yE(t,e="sports-surface.svg"){const r=new Blob([t],{type:"image/svg+xml"}),n=URL.createObjectURL(r),i=document.createElement("a");i.href=n,i.download=e,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(n)}async function xE(t,e,r="sports-surface.png",n=2){return new Promise((i,o)=>{try{const s=mp(t,e),l=document.createElement("canvas"),c=l.getContext("2d"),d=t.getAttribute("viewBox");let h=1200,f=1200;if(d){const[,,m,x]=d.split(" ").map(Number),v=2400,y=x/m;h=Math.min(m/10,v),f=h*y}l.width=h*n,l.height=f*n;const u=new Image,p=new Blob([s],{type:"image/svg+xml;charset=utf-8"}),g=URL.createObjectURL(p);u.onload=()=>{c.fillStyle="#ffffff",c.fillRect(0,0,l.width,l.height),c.drawImage(u,0,0,l.width,l.height),l.toBlob(m=>{if(!m){o(new Error("Failed to create PNG blob"));return}const x=URL.createObjectURL(m),v=document.createElement("a");v.href=x,v.download=r,document.body.appendChild(v),v.click(),document.body.removeChild(v),URL.revokeObjectURL(g),URL.revokeObjectURL(x),i()},"image/png",.95)},u.onerror=m=>{URL.revokeObjectURL(g),o(new Error("Failed to load SVG for PNG conversion"))},u.src=g}catch(s){o(s)}})}function _u(t,e){const r=(t||"sports-surface").toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"").substring(0,50),n=new Date().toISOString().split("T")[0];return`${r}_${n}.${e}`}function Ul(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Aw={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(t,e){(function(r){t.exports=r()})(function(){return function r(n,i,o){function s(d,h){if(!i[d]){if(!n[d]){var f=typeof Ul=="function"&&Ul;if(!h&&f)return f(d,!0);if(l)return l(d,!0);var u=new Error("Cannot find module '"+d+"'");throw u.code="MODULE_NOT_FOUND",u}var p=i[d]={exports:{}};n[d][0].call(p.exports,function(g){var m=n[d][1][g];return s(m||g)},p,p.exports,r,n,i,o)}return i[d].exports}for(var l=typeof Ul=="function"&&Ul,c=0;c<o.length;c++)s(o[c]);return s}({1:[function(r,n,i){var o=r("./utils"),s=r("./support"),l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(c){for(var d,h,f,u,p,g,m,x=[],v=0,y=c.length,b=y,w=o.getTypeOf(c)!=="string";v<c.length;)b=y-v,f=w?(d=c[v++],h=v<y?c[v++]:0,v<y?c[v++]:0):(d=c.charCodeAt(v++),h=v<y?c.charCodeAt(v++):0,v<y?c.charCodeAt(v++):0),u=d>>2,p=(3&d)<<4|h>>4,g=1<b?(15&h)<<2|f>>6:64,m=2<b?63&f:64,x.push(l.charAt(u)+l.charAt(p)+l.charAt(g)+l.charAt(m));return x.join("")},i.decode=function(c){var d,h,f,u,p,g,m=0,x=0,v="data:";if(c.substr(0,v.length)===v)throw new Error("Invalid base64 input, it looks like a data url.");var y,b=3*(c=c.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(c.charAt(c.length-1)===l.charAt(64)&&b--,c.charAt(c.length-2)===l.charAt(64)&&b--,b%1!=0)throw new Error("Invalid base64 input, bad content length.");for(y=s.uint8array?new Uint8Array(0|b):new Array(0|b);m<c.length;)d=l.indexOf(c.charAt(m++))<<2|(u=l.indexOf(c.charAt(m++)))>>4,h=(15&u)<<4|(p=l.indexOf(c.charAt(m++)))>>2,f=(3&p)<<6|(g=l.indexOf(c.charAt(m++))),y[x++]=d,p!==64&&(y[x++]=h),g!==64&&(y[x++]=f);return y}},{"./support":30,"./utils":32}],2:[function(r,n,i){var o=r("./external"),s=r("./stream/DataWorker"),l=r("./stream/Crc32Probe"),c=r("./stream/DataLengthProbe");function d(h,f,u,p,g){this.compressedSize=h,this.uncompressedSize=f,this.crc32=u,this.compression=p,this.compressedContent=g}d.prototype={getContentWorker:function(){var h=new s(o.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new c("data_length")),f=this;return h.on("end",function(){if(this.streamInfo.data_length!==f.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),h},getCompressedWorker:function(){return new s(o.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},d.createWorkerFrom=function(h,f,u){return h.pipe(new l).pipe(new c("uncompressedSize")).pipe(f.compressWorker(u)).pipe(new c("compressedSize")).withStreamInfo("compression",f)},n.exports=d},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(r,n,i){var o=r("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new o("STORE compression")},uncompressWorker:function(){return new o("STORE decompression")}},i.DEFLATE=r("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(r,n,i){var o=r("./utils"),s=function(){for(var l,c=[],d=0;d<256;d++){l=d;for(var h=0;h<8;h++)l=1&l?3988292384^l>>>1:l>>>1;c[d]=l}return c}();n.exports=function(l,c){return l!==void 0&&l.length?o.getTypeOf(l)!=="string"?function(d,h,f,u){var p=s,g=u+f;d^=-1;for(var m=u;m<g;m++)d=d>>>8^p[255&(d^h[m])];return-1^d}(0|c,l,l.length,0):function(d,h,f,u){var p=s,g=u+f;d^=-1;for(var m=u;m<g;m++)d=d>>>8^p[255&(d^h.charCodeAt(m))];return-1^d}(0|c,l,l.length,0):0}},{"./utils":32}],5:[function(r,n,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(r,n,i){var o=null;o=typeof Promise<"u"?Promise:r("lie"),n.exports={Promise:o}},{lie:37}],7:[function(r,n,i){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",s=r("pako"),l=r("./utils"),c=r("./stream/GenericWorker"),d=o?"uint8array":"array";function h(f,u){c.call(this,"FlateWorker/"+f),this._pako=null,this._pakoAction=f,this._pakoOptions=u,this.meta={}}i.magic="\b\0",l.inherits(h,c),h.prototype.processChunk=function(f){this.meta=f.meta,this._pako===null&&this._createPako(),this._pako.push(l.transformTo(d,f.data),!1)},h.prototype.flush=function(){c.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},h.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this._pako=null},h.prototype._createPako=function(){this._pako=new s[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var f=this;this._pako.onData=function(u){f.push({data:u,meta:f.meta})}},i.compressWorker=function(f){return new h("Deflate",f)},i.uncompressWorker=function(){return new h("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(r,n,i){function o(p,g){var m,x="";for(m=0;m<g;m++)x+=String.fromCharCode(255&p),p>>>=8;return x}function s(p,g,m,x,v,y){var b,w,k=p.file,S=p.compression,C=y!==d.utf8encode,T=l.transformTo("string",y(k.name)),R=l.transformTo("string",d.utf8encode(k.name)),O=k.comment,Y=l.transformTo("string",y(O)),E=l.transformTo("string",d.utf8encode(O)),B=R.length!==k.name.length,_=E.length!==O.length,V="",re="",I="",q=k.dir,D=k.date,J={crc32:0,compressedSize:0,uncompressedSize:0};g&&!m||(J.crc32=p.crc32,J.compressedSize=p.compressedSize,J.uncompressedSize=p.uncompressedSize);var U=0;g&&(U|=8),C||!B&&!_||(U|=2048);var G=0,fe=0;q&&(G|=16),v==="UNIX"?(fe=798,G|=function(ae,le){var ce=ae;return ae||(ce=le?16893:33204),(65535&ce)<<16}(k.unixPermissions,q)):(fe=20,G|=function(ae){return 63&(ae||0)}(k.dosPermissions)),b=D.getUTCHours(),b<<=6,b|=D.getUTCMinutes(),b<<=5,b|=D.getUTCSeconds()/2,w=D.getUTCFullYear()-1980,w<<=4,w|=D.getUTCMonth()+1,w<<=5,w|=D.getUTCDate(),B&&(re=o(1,1)+o(h(T),4)+R,V+="up"+o(re.length,2)+re),_&&(I=o(1,1)+o(h(Y),4)+E,V+="uc"+o(I.length,2)+I);var oe="";return oe+=`
\0`,oe+=o(U,2),oe+=S.magic,oe+=o(b,2),oe+=o(w,2),oe+=o(J.crc32,4),oe+=o(J.compressedSize,4),oe+=o(J.uncompressedSize,4),oe+=o(T.length,2),oe+=o(V.length,2),{fileRecord:f.LOCAL_FILE_HEADER+oe+T+V,dirRecord:f.CENTRAL_FILE_HEADER+o(fe,2)+oe+o(Y.length,2)+"\0\0\0\0"+o(G,4)+o(x,4)+T+V+Y}}var l=r("../utils"),c=r("../stream/GenericWorker"),d=r("../utf8"),h=r("../crc32"),f=r("../signature");function u(p,g,m,x){c.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=g,this.zipPlatform=m,this.encodeFileName=x,this.streamFiles=p,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}l.inherits(u,c),u.prototype.push=function(p){var g=p.meta.percent||0,m=this.entriesCount,x=this._sources.length;this.accumulate?this.contentBuffer.push(p):(this.bytesWritten+=p.data.length,c.prototype.push.call(this,{data:p.data,meta:{currentFile:this.currentFile,percent:m?(g+100*(m-x-1))/m:100}}))},u.prototype.openedSource=function(p){this.currentSourceOffset=this.bytesWritten,this.currentFile=p.file.name;var g=this.streamFiles&&!p.file.dir;if(g){var m=s(p,g,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:m.fileRecord,meta:{percent:0}})}else this.accumulate=!0},u.prototype.closedSource=function(p){this.accumulate=!1;var g=this.streamFiles&&!p.file.dir,m=s(p,g,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(m.dirRecord),g)this.push({data:function(x){return f.DATA_DESCRIPTOR+o(x.crc32,4)+o(x.compressedSize,4)+o(x.uncompressedSize,4)}(p),meta:{percent:100}});else for(this.push({data:m.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},u.prototype.flush=function(){for(var p=this.bytesWritten,g=0;g<this.dirRecords.length;g++)this.push({data:this.dirRecords[g],meta:{percent:100}});var m=this.bytesWritten-p,x=function(v,y,b,w,k){var S=l.transformTo("string",k(w));return f.CENTRAL_DIRECTORY_END+"\0\0\0\0"+o(v,2)+o(v,2)+o(y,4)+o(b,4)+o(S.length,2)+S}(this.dirRecords.length,m,p,this.zipComment,this.encodeFileName);this.push({data:x,meta:{percent:100}})},u.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},u.prototype.registerPrevious=function(p){this._sources.push(p);var g=this;return p.on("data",function(m){g.processChunk(m)}),p.on("end",function(){g.closedSource(g.previous.streamInfo),g._sources.length?g.prepareNextSource():g.end()}),p.on("error",function(m){g.error(m)}),this},u.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},u.prototype.error=function(p){var g=this._sources;if(!c.prototype.error.call(this,p))return!1;for(var m=0;m<g.length;m++)try{g[m].error(p)}catch{}return!0},u.prototype.lock=function(){c.prototype.lock.call(this);for(var p=this._sources,g=0;g<p.length;g++)p[g].lock()},n.exports=u},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(r,n,i){var o=r("../compressions"),s=r("./ZipFileWorker");i.generateWorker=function(l,c,d){var h=new s(c.streamFiles,d,c.platform,c.encodeFileName),f=0;try{l.forEach(function(u,p){f++;var g=function(y,b){var w=y||b,k=o[w];if(!k)throw new Error(w+" is not a valid compression method !");return k}(p.options.compression,c.compression),m=p.options.compressionOptions||c.compressionOptions||{},x=p.dir,v=p.date;p._compressWorker(g,m).withStreamInfo("file",{name:u,dir:x,date:v,comment:p.comment||"",unixPermissions:p.unixPermissions,dosPermissions:p.dosPermissions}).pipe(h)}),h.entriesCount=f}catch(u){h.error(u)}return h}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(r,n,i){function o(){if(!(this instanceof o))return new o;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var s=new o;for(var l in this)typeof this[l]!="function"&&(s[l]=this[l]);return s}}(o.prototype=r("./object")).loadAsync=r("./load"),o.support=r("./support"),o.defaults=r("./defaults"),o.version="3.10.1",o.loadAsync=function(s,l){return new o().loadAsync(s,l)},o.external=r("./external"),n.exports=o},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(r,n,i){var o=r("./utils"),s=r("./external"),l=r("./utf8"),c=r("./zipEntries"),d=r("./stream/Crc32Probe"),h=r("./nodejsUtils");function f(u){return new s.Promise(function(p,g){var m=u.decompressed.getContentWorker().pipe(new d);m.on("error",function(x){g(x)}).on("end",function(){m.streamInfo.crc32!==u.decompressed.crc32?g(new Error("Corrupted zip : CRC32 mismatch")):p()}).resume()})}n.exports=function(u,p){var g=this;return p=o.extend(p||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:l.utf8decode}),h.isNode&&h.isStream(u)?s.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):o.prepareContent("the loaded zip file",u,!0,p.optimizedBinaryString,p.base64).then(function(m){var x=new c(p);return x.load(m),x}).then(function(m){var x=[s.Promise.resolve(m)],v=m.files;if(p.checkCRC32)for(var y=0;y<v.length;y++)x.push(f(v[y]));return s.Promise.all(x)}).then(function(m){for(var x=m.shift(),v=x.files,y=0;y<v.length;y++){var b=v[y],w=b.fileNameStr,k=o.resolve(b.fileNameStr);g.file(k,b.decompressed,{binary:!0,optimizedBinaryString:!0,date:b.date,dir:b.dir,comment:b.fileCommentStr.length?b.fileCommentStr:null,unixPermissions:b.unixPermissions,dosPermissions:b.dosPermissions,createFolders:p.createFolders}),b.dir||(g.file(k).unsafeOriginalName=w)}return x.zipComment.length&&(g.comment=x.zipComment),g})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(r,n,i){var o=r("../utils"),s=r("../stream/GenericWorker");function l(c,d){s.call(this,"Nodejs stream input adapter for "+c),this._upstreamEnded=!1,this._bindStream(d)}o.inherits(l,s),l.prototype._bindStream=function(c){var d=this;(this._stream=c).pause(),c.on("data",function(h){d.push({data:h,meta:{percent:0}})}).on("error",function(h){d.isPaused?this.generatedError=h:d.error(h)}).on("end",function(){d.isPaused?d._upstreamEnded=!0:d.end()})},l.prototype.pause=function(){return!!s.prototype.pause.call(this)&&(this._stream.pause(),!0)},l.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=l},{"../stream/GenericWorker":28,"../utils":32}],13:[function(r,n,i){var o=r("readable-stream").Readable;function s(l,c,d){o.call(this,c),this._helper=l;var h=this;l.on("data",function(f,u){h.push(f)||h._helper.pause(),d&&d(u)}).on("error",function(f){h.emit("error",f)}).on("end",function(){h.push(null)})}r("../utils").inherits(s,o),s.prototype._read=function(){this._helper.resume()},n.exports=s},{"../utils":32,"readable-stream":16}],14:[function(r,n,i){n.exports={isNode:typeof Buffer<"u",newBufferFrom:function(o,s){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(o,s);if(typeof o=="number")throw new Error('The "data" argument must not be a number');return new Buffer(o,s)},allocBuffer:function(o){if(Buffer.alloc)return Buffer.alloc(o);var s=new Buffer(o);return s.fill(0),s},isBuffer:function(o){return Buffer.isBuffer(o)},isStream:function(o){return o&&typeof o.on=="function"&&typeof o.pause=="function"&&typeof o.resume=="function"}}},{}],15:[function(r,n,i){function o(k,S,C){var T,R=l.getTypeOf(S),O=l.extend(C||{},h);O.date=O.date||new Date,O.compression!==null&&(O.compression=O.compression.toUpperCase()),typeof O.unixPermissions=="string"&&(O.unixPermissions=parseInt(O.unixPermissions,8)),O.unixPermissions&&16384&O.unixPermissions&&(O.dir=!0),O.dosPermissions&&16&O.dosPermissions&&(O.dir=!0),O.dir&&(k=v(k)),O.createFolders&&(T=x(k))&&y.call(this,T,!0);var Y=R==="string"&&O.binary===!1&&O.base64===!1;C&&C.binary!==void 0||(O.binary=!Y),(S instanceof f&&S.uncompressedSize===0||O.dir||!S||S.length===0)&&(O.base64=!1,O.binary=!0,S="",O.compression="STORE",R="string");var E=null;E=S instanceof f||S instanceof c?S:g.isNode&&g.isStream(S)?new m(k,S):l.prepareContent(k,S,O.binary,O.optimizedBinaryString,O.base64);var B=new u(k,E,O);this.files[k]=B}var s=r("./utf8"),l=r("./utils"),c=r("./stream/GenericWorker"),d=r("./stream/StreamHelper"),h=r("./defaults"),f=r("./compressedObject"),u=r("./zipObject"),p=r("./generate"),g=r("./nodejsUtils"),m=r("./nodejs/NodejsStreamInputAdapter"),x=function(k){k.slice(-1)==="/"&&(k=k.substring(0,k.length-1));var S=k.lastIndexOf("/");return 0<S?k.substring(0,S):""},v=function(k){return k.slice(-1)!=="/"&&(k+="/"),k},y=function(k,S){return S=S!==void 0?S:h.createFolders,k=v(k),this.files[k]||o.call(this,k,null,{dir:!0,createFolders:S}),this.files[k]};function b(k){return Object.prototype.toString.call(k)==="[object RegExp]"}var w={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(k){var S,C,T;for(S in this.files)T=this.files[S],(C=S.slice(this.root.length,S.length))&&S.slice(0,this.root.length)===this.root&&k(C,T)},filter:function(k){var S=[];return this.forEach(function(C,T){k(C,T)&&S.push(T)}),S},file:function(k,S,C){if(arguments.length!==1)return k=this.root+k,o.call(this,k,S,C),this;if(b(k)){var T=k;return this.filter(function(O,Y){return!Y.dir&&T.test(O)})}var R=this.files[this.root+k];return R&&!R.dir?R:null},folder:function(k){if(!k)return this;if(b(k))return this.filter(function(R,O){return O.dir&&k.test(R)});var S=this.root+k,C=y.call(this,S),T=this.clone();return T.root=C.name,T},remove:function(k){k=this.root+k;var S=this.files[k];if(S||(k.slice(-1)!=="/"&&(k+="/"),S=this.files[k]),S&&!S.dir)delete this.files[k];else for(var C=this.filter(function(R,O){return O.name.slice(0,k.length)===k}),T=0;T<C.length;T++)delete this.files[C[T].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(k){var S,C={};try{if((C=l.extend(k||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:s.utf8encode})).type=C.type.toLowerCase(),C.compression=C.compression.toUpperCase(),C.type==="binarystring"&&(C.type="string"),!C.type)throw new Error("No output type specified.");l.checkSupport(C.type),C.platform!=="darwin"&&C.platform!=="freebsd"&&C.platform!=="linux"&&C.platform!=="sunos"||(C.platform="UNIX"),C.platform==="win32"&&(C.platform="DOS");var T=C.comment||this.comment||"";S=p.generateWorker(this,C,T)}catch(R){(S=new c("error")).error(R)}return new d(S,C.type||"string",C.mimeType)},generateAsync:function(k,S){return this.generateInternalStream(k).accumulate(S)},generateNodeStream:function(k,S){return(k=k||{}).type||(k.type="nodebuffer"),this.generateInternalStream(k).toNodejsStream(S)}};n.exports=w},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(r,n,i){n.exports=r("stream")},{stream:void 0}],17:[function(r,n,i){var o=r("./DataReader");function s(l){o.call(this,l);for(var c=0;c<this.data.length;c++)l[c]=255&l[c]}r("../utils").inherits(s,o),s.prototype.byteAt=function(l){return this.data[this.zero+l]},s.prototype.lastIndexOfSignature=function(l){for(var c=l.charCodeAt(0),d=l.charCodeAt(1),h=l.charCodeAt(2),f=l.charCodeAt(3),u=this.length-4;0<=u;--u)if(this.data[u]===c&&this.data[u+1]===d&&this.data[u+2]===h&&this.data[u+3]===f)return u-this.zero;return-1},s.prototype.readAndCheckSignature=function(l){var c=l.charCodeAt(0),d=l.charCodeAt(1),h=l.charCodeAt(2),f=l.charCodeAt(3),u=this.readData(4);return c===u[0]&&d===u[1]&&h===u[2]&&f===u[3]},s.prototype.readData=function(l){if(this.checkOffset(l),l===0)return[];var c=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},n.exports=s},{"../utils":32,"./DataReader":18}],18:[function(r,n,i){var o=r("../utils");function s(l){this.data=l,this.length=l.length,this.index=0,this.zero=0}s.prototype={checkOffset:function(l){this.checkIndex(this.index+l)},checkIndex:function(l){if(this.length<this.zero+l||l<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+l+"). Corrupted zip ?")},setIndex:function(l){this.checkIndex(l),this.index=l},skip:function(l){this.setIndex(this.index+l)},byteAt:function(){},readInt:function(l){var c,d=0;for(this.checkOffset(l),c=this.index+l-1;c>=this.index;c--)d=(d<<8)+this.byteAt(c);return this.index+=l,d},readString:function(l){return o.transformTo("string",this.readData(l))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var l=this.readInt(4);return new Date(Date.UTC(1980+(l>>25&127),(l>>21&15)-1,l>>16&31,l>>11&31,l>>5&63,(31&l)<<1))}},n.exports=s},{"../utils":32}],19:[function(r,n,i){var o=r("./Uint8ArrayReader");function s(l){o.call(this,l)}r("../utils").inherits(s,o),s.prototype.readData=function(l){this.checkOffset(l);var c=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},n.exports=s},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(r,n,i){var o=r("./DataReader");function s(l){o.call(this,l)}r("../utils").inherits(s,o),s.prototype.byteAt=function(l){return this.data.charCodeAt(this.zero+l)},s.prototype.lastIndexOfSignature=function(l){return this.data.lastIndexOf(l)-this.zero},s.prototype.readAndCheckSignature=function(l){return l===this.readData(4)},s.prototype.readData=function(l){this.checkOffset(l);var c=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},n.exports=s},{"../utils":32,"./DataReader":18}],21:[function(r,n,i){var o=r("./ArrayReader");function s(l){o.call(this,l)}r("../utils").inherits(s,o),s.prototype.readData=function(l){if(this.checkOffset(l),l===0)return new Uint8Array(0);var c=this.data.subarray(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},n.exports=s},{"../utils":32,"./ArrayReader":17}],22:[function(r,n,i){var o=r("../utils"),s=r("../support"),l=r("./ArrayReader"),c=r("./StringReader"),d=r("./NodeBufferReader"),h=r("./Uint8ArrayReader");n.exports=function(f){var u=o.getTypeOf(f);return o.checkSupport(u),u!=="string"||s.uint8array?u==="nodebuffer"?new d(f):s.uint8array?new h(o.transformTo("uint8array",f)):new l(o.transformTo("array",f)):new c(f)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(r,n,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(r,n,i){var o=r("./GenericWorker"),s=r("../utils");function l(c){o.call(this,"ConvertWorker to "+c),this.destType=c}s.inherits(l,o),l.prototype.processChunk=function(c){this.push({data:s.transformTo(this.destType,c.data),meta:c.meta})},n.exports=l},{"../utils":32,"./GenericWorker":28}],25:[function(r,n,i){var o=r("./GenericWorker"),s=r("../crc32");function l(){o.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}r("../utils").inherits(l,o),l.prototype.processChunk=function(c){this.streamInfo.crc32=s(c.data,this.streamInfo.crc32||0),this.push(c)},n.exports=l},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(r,n,i){var o=r("../utils"),s=r("./GenericWorker");function l(c){s.call(this,"DataLengthProbe for "+c),this.propName=c,this.withStreamInfo(c,0)}o.inherits(l,s),l.prototype.processChunk=function(c){if(c){var d=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=d+c.data.length}s.prototype.processChunk.call(this,c)},n.exports=l},{"../utils":32,"./GenericWorker":28}],27:[function(r,n,i){var o=r("../utils"),s=r("./GenericWorker");function l(c){s.call(this,"DataWorker");var d=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,c.then(function(h){d.dataIsReady=!0,d.data=h,d.max=h&&h.length||0,d.type=o.getTypeOf(h),d.isPaused||d._tickAndRepeat()},function(h){d.error(h)})}o.inherits(l,s),l.prototype.cleanUp=function(){s.prototype.cleanUp.call(this),this.data=null},l.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,o.delay(this._tickAndRepeat,[],this)),!0)},l.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(o.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},l.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var c=null,d=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":c=this.data.substring(this.index,d);break;case"uint8array":c=this.data.subarray(this.index,d);break;case"array":case"nodebuffer":c=this.data.slice(this.index,d)}return this.index=d,this.push({data:c,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=l},{"../utils":32,"./GenericWorker":28}],28:[function(r,n,i){function o(s){this.name=s||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}o.prototype={push:function(s){this.emit("data",s)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(s){this.emit("error",s)}return!0},error:function(s){return!this.isFinished&&(this.isPaused?this.generatedError=s:(this.isFinished=!0,this.emit("error",s),this.previous&&this.previous.error(s),this.cleanUp()),!0)},on:function(s,l){return this._listeners[s].push(l),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(s,l){if(this._listeners[s])for(var c=0;c<this._listeners[s].length;c++)this._listeners[s][c].call(this,l)},pipe:function(s){return s.registerPrevious(this)},registerPrevious:function(s){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=s.streamInfo,this.mergeStreamInfo(),this.previous=s;var l=this;return s.on("data",function(c){l.processChunk(c)}),s.on("end",function(){l.end()}),s.on("error",function(c){l.error(c)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var s=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),s=!0),this.previous&&this.previous.resume(),!s},flush:function(){},processChunk:function(s){this.push(s)},withStreamInfo:function(s,l){return this.extraStreamInfo[s]=l,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var s in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,s)&&(this.streamInfo[s]=this.extraStreamInfo[s])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var s="Worker "+this.name;return this.previous?this.previous+" -> "+s:s}},n.exports=o},{}],29:[function(r,n,i){var o=r("../utils"),s=r("./ConvertWorker"),l=r("./GenericWorker"),c=r("../base64"),d=r("../support"),h=r("../external"),f=null;if(d.nodestream)try{f=r("../nodejs/NodejsStreamOutputAdapter")}catch{}function u(g,m){return new h.Promise(function(x,v){var y=[],b=g._internalType,w=g._outputType,k=g._mimeType;g.on("data",function(S,C){y.push(S),m&&m(C)}).on("error",function(S){y=[],v(S)}).on("end",function(){try{var S=function(C,T,R){switch(C){case"blob":return o.newBlob(o.transformTo("arraybuffer",T),R);case"base64":return c.encode(T);default:return o.transformTo(C,T)}}(w,function(C,T){var R,O=0,Y=null,E=0;for(R=0;R<T.length;R++)E+=T[R].length;switch(C){case"string":return T.join("");case"array":return Array.prototype.concat.apply([],T);case"uint8array":for(Y=new Uint8Array(E),R=0;R<T.length;R++)Y.set(T[R],O),O+=T[R].length;return Y;case"nodebuffer":return Buffer.concat(T);default:throw new Error("concat : unsupported type '"+C+"'")}}(b,y),k);x(S)}catch(C){v(C)}y=[]}).resume()})}function p(g,m,x){var v=m;switch(m){case"blob":case"arraybuffer":v="uint8array";break;case"base64":v="string"}try{this._internalType=v,this._outputType=m,this._mimeType=x,o.checkSupport(v),this._worker=g.pipe(new s(v)),g.lock()}catch(y){this._worker=new l("error"),this._worker.error(y)}}p.prototype={accumulate:function(g){return u(this,g)},on:function(g,m){var x=this;return g==="data"?this._worker.on(g,function(v){m.call(x,v.data,v.meta)}):this._worker.on(g,function(){o.delay(m,arguments,x)}),this},resume:function(){return o.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(g){if(o.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new f(this,{objectMode:this._outputType!=="nodebuffer"},g)}},n.exports=p},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(r,n,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof Buffer<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var o=new ArrayBuffer(0);try{i.blob=new Blob([o],{type:"application/zip"}).size===0}catch{try{var s=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);s.append(o),i.blob=s.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!r("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(r,n,i){for(var o=r("./utils"),s=r("./support"),l=r("./nodejsUtils"),c=r("./stream/GenericWorker"),d=new Array(256),h=0;h<256;h++)d[h]=252<=h?6:248<=h?5:240<=h?4:224<=h?3:192<=h?2:1;d[254]=d[254]=1;function f(){c.call(this,"utf-8 decode"),this.leftOver=null}function u(){c.call(this,"utf-8 encode")}i.utf8encode=function(p){return s.nodebuffer?l.newBufferFrom(p,"utf-8"):function(g){var m,x,v,y,b,w=g.length,k=0;for(y=0;y<w;y++)(64512&(x=g.charCodeAt(y)))==55296&&y+1<w&&(64512&(v=g.charCodeAt(y+1)))==56320&&(x=65536+(x-55296<<10)+(v-56320),y++),k+=x<128?1:x<2048?2:x<65536?3:4;for(m=s.uint8array?new Uint8Array(k):new Array(k),y=b=0;b<k;y++)(64512&(x=g.charCodeAt(y)))==55296&&y+1<w&&(64512&(v=g.charCodeAt(y+1)))==56320&&(x=65536+(x-55296<<10)+(v-56320),y++),x<128?m[b++]=x:(x<2048?m[b++]=192|x>>>6:(x<65536?m[b++]=224|x>>>12:(m[b++]=240|x>>>18,m[b++]=128|x>>>12&63),m[b++]=128|x>>>6&63),m[b++]=128|63&x);return m}(p)},i.utf8decode=function(p){return s.nodebuffer?o.transformTo("nodebuffer",p).toString("utf-8"):function(g){var m,x,v,y,b=g.length,w=new Array(2*b);for(m=x=0;m<b;)if((v=g[m++])<128)w[x++]=v;else if(4<(y=d[v]))w[x++]=65533,m+=y-1;else{for(v&=y===2?31:y===3?15:7;1<y&&m<b;)v=v<<6|63&g[m++],y--;1<y?w[x++]=65533:v<65536?w[x++]=v:(v-=65536,w[x++]=55296|v>>10&1023,w[x++]=56320|1023&v)}return w.length!==x&&(w.subarray?w=w.subarray(0,x):w.length=x),o.applyFromCharCode(w)}(p=o.transformTo(s.uint8array?"uint8array":"array",p))},o.inherits(f,c),f.prototype.processChunk=function(p){var g=o.transformTo(s.uint8array?"uint8array":"array",p.data);if(this.leftOver&&this.leftOver.length){if(s.uint8array){var m=g;(g=new Uint8Array(m.length+this.leftOver.length)).set(this.leftOver,0),g.set(m,this.leftOver.length)}else g=this.leftOver.concat(g);this.leftOver=null}var x=function(y,b){var w;for((b=b||y.length)>y.length&&(b=y.length),w=b-1;0<=w&&(192&y[w])==128;)w--;return w<0||w===0?b:w+d[y[w]]>b?w:b}(g),v=g;x!==g.length&&(s.uint8array?(v=g.subarray(0,x),this.leftOver=g.subarray(x,g.length)):(v=g.slice(0,x),this.leftOver=g.slice(x,g.length))),this.push({data:i.utf8decode(v),meta:p.meta})},f.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=f,o.inherits(u,c),u.prototype.processChunk=function(p){this.push({data:i.utf8encode(p.data),meta:p.meta})},i.Utf8EncodeWorker=u},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(r,n,i){var o=r("./support"),s=r("./base64"),l=r("./nodejsUtils"),c=r("./external");function d(m){return m}function h(m,x){for(var v=0;v<m.length;++v)x[v]=255&m.charCodeAt(v);return x}r("setimmediate"),i.newBlob=function(m,x){i.checkSupport("blob");try{return new Blob([m],{type:x})}catch{try{var v=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return v.append(m),v.getBlob(x)}catch{throw new Error("Bug : can't construct the Blob.")}}};var f={stringifyByChunk:function(m,x,v){var y=[],b=0,w=m.length;if(w<=v)return String.fromCharCode.apply(null,m);for(;b<w;)x==="array"||x==="nodebuffer"?y.push(String.fromCharCode.apply(null,m.slice(b,Math.min(b+v,w)))):y.push(String.fromCharCode.apply(null,m.subarray(b,Math.min(b+v,w)))),b+=v;return y.join("")},stringifyByChar:function(m){for(var x="",v=0;v<m.length;v++)x+=String.fromCharCode(m[v]);return x},applyCanBeUsed:{uint8array:function(){try{return o.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return o.nodebuffer&&String.fromCharCode.apply(null,l.allocBuffer(1)).length===1}catch{return!1}}()}};function u(m){var x=65536,v=i.getTypeOf(m),y=!0;if(v==="uint8array"?y=f.applyCanBeUsed.uint8array:v==="nodebuffer"&&(y=f.applyCanBeUsed.nodebuffer),y)for(;1<x;)try{return f.stringifyByChunk(m,v,x)}catch{x=Math.floor(x/2)}return f.stringifyByChar(m)}function p(m,x){for(var v=0;v<m.length;v++)x[v]=m[v];return x}i.applyFromCharCode=u;var g={};g.string={string:d,array:function(m){return h(m,new Array(m.length))},arraybuffer:function(m){return g.string.uint8array(m).buffer},uint8array:function(m){return h(m,new Uint8Array(m.length))},nodebuffer:function(m){return h(m,l.allocBuffer(m.length))}},g.array={string:u,array:d,arraybuffer:function(m){return new Uint8Array(m).buffer},uint8array:function(m){return new Uint8Array(m)},nodebuffer:function(m){return l.newBufferFrom(m)}},g.arraybuffer={string:function(m){return u(new Uint8Array(m))},array:function(m){return p(new Uint8Array(m),new Array(m.byteLength))},arraybuffer:d,uint8array:function(m){return new Uint8Array(m)},nodebuffer:function(m){return l.newBufferFrom(new Uint8Array(m))}},g.uint8array={string:u,array:function(m){return p(m,new Array(m.length))},arraybuffer:function(m){return m.buffer},uint8array:d,nodebuffer:function(m){return l.newBufferFrom(m)}},g.nodebuffer={string:u,array:function(m){return p(m,new Array(m.length))},arraybuffer:function(m){return g.nodebuffer.uint8array(m).buffer},uint8array:function(m){return p(m,new Uint8Array(m.length))},nodebuffer:d},i.transformTo=function(m,x){if(x=x||"",!m)return x;i.checkSupport(m);var v=i.getTypeOf(x);return g[v][m](x)},i.resolve=function(m){for(var x=m.split("/"),v=[],y=0;y<x.length;y++){var b=x[y];b==="."||b===""&&y!==0&&y!==x.length-1||(b===".."?v.pop():v.push(b))}return v.join("/")},i.getTypeOf=function(m){return typeof m=="string"?"string":Object.prototype.toString.call(m)==="[object Array]"?"array":o.nodebuffer&&l.isBuffer(m)?"nodebuffer":o.uint8array&&m instanceof Uint8Array?"uint8array":o.arraybuffer&&m instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(m){if(!o[m.toLowerCase()])throw new Error(m+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(m){var x,v,y="";for(v=0;v<(m||"").length;v++)y+="\\x"+((x=m.charCodeAt(v))<16?"0":"")+x.toString(16).toUpperCase();return y},i.delay=function(m,x,v){setImmediate(function(){m.apply(v||null,x||[])})},i.inherits=function(m,x){function v(){}v.prototype=x.prototype,m.prototype=new v},i.extend=function(){var m,x,v={};for(m=0;m<arguments.length;m++)for(x in arguments[m])Object.prototype.hasOwnProperty.call(arguments[m],x)&&v[x]===void 0&&(v[x]=arguments[m][x]);return v},i.prepareContent=function(m,x,v,y,b){return c.Promise.resolve(x).then(function(w){return o.blob&&(w instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(w))!==-1)&&typeof FileReader<"u"?new c.Promise(function(k,S){var C=new FileReader;C.onload=function(T){k(T.target.result)},C.onerror=function(T){S(T.target.error)},C.readAsArrayBuffer(w)}):w}).then(function(w){var k=i.getTypeOf(w);return k?(k==="arraybuffer"?w=i.transformTo("uint8array",w):k==="string"&&(b?w=s.decode(w):v&&y!==!0&&(w=function(S){return h(S,o.uint8array?new Uint8Array(S.length):new Array(S.length))}(w))),w):c.Promise.reject(new Error("Can't read the data of '"+m+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(r,n,i){var o=r("./reader/readerFor"),s=r("./utils"),l=r("./signature"),c=r("./zipEntry"),d=r("./support");function h(f){this.files=[],this.loadOptions=f}h.prototype={checkSignature:function(f){if(!this.reader.readAndCheckSignature(f)){this.reader.index-=4;var u=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+s.pretty(u)+", expected "+s.pretty(f)+")")}},isSignature:function(f,u){var p=this.reader.index;this.reader.setIndex(f);var g=this.reader.readString(4)===u;return this.reader.setIndex(p),g},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var f=this.reader.readData(this.zipCommentLength),u=d.uint8array?"uint8array":"array",p=s.transformTo(u,f);this.zipComment=this.loadOptions.decodeFileName(p)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var f,u,p,g=this.zip64EndOfCentralSize-44;0<g;)f=this.reader.readInt(2),u=this.reader.readInt(4),p=this.reader.readData(u),this.zip64ExtensibleData[f]={id:f,length:u,value:p}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var f,u;for(f=0;f<this.files.length;f++)u=this.files[f],this.reader.setIndex(u.localHeaderOffset),this.checkSignature(l.LOCAL_FILE_HEADER),u.readLocalPart(this.reader),u.handleUTF8(),u.processAttributes()},readCentralDir:function(){var f;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(l.CENTRAL_FILE_HEADER);)(f=new c({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(f);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var f=this.reader.lastIndexOfSignature(l.CENTRAL_DIRECTORY_END);if(f<0)throw this.isSignature(0,l.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(f);var u=f;if(this.checkSignature(l.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===s.MAX_VALUE_16BITS||this.diskWithCentralDirStart===s.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===s.MAX_VALUE_16BITS||this.centralDirRecords===s.MAX_VALUE_16BITS||this.centralDirSize===s.MAX_VALUE_32BITS||this.centralDirOffset===s.MAX_VALUE_32BITS){if(this.zip64=!0,(f=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(f),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,l.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var p=this.centralDirOffset+this.centralDirSize;this.zip64&&(p+=20,p+=12+this.zip64EndOfCentralSize);var g=u-p;if(0<g)this.isSignature(u,l.CENTRAL_FILE_HEADER)||(this.reader.zero=g);else if(g<0)throw new Error("Corrupted zip: missing "+Math.abs(g)+" bytes.")},prepareReader:function(f){this.reader=o(f)},load:function(f){this.prepareReader(f),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=h},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(r,n,i){var o=r("./reader/readerFor"),s=r("./utils"),l=r("./compressedObject"),c=r("./crc32"),d=r("./utf8"),h=r("./compressions"),f=r("./support");function u(p,g){this.options=p,this.loadOptions=g}u.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(p){var g,m;if(p.skip(22),this.fileNameLength=p.readInt(2),m=p.readInt(2),this.fileName=p.readData(this.fileNameLength),p.skip(m),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((g=function(x){for(var v in h)if(Object.prototype.hasOwnProperty.call(h,v)&&h[v].magic===x)return h[v];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+s.pretty(this.compressionMethod)+" unknown (inner file : "+s.transformTo("string",this.fileName)+")");this.decompressed=new l(this.compressedSize,this.uncompressedSize,this.crc32,g,p.readData(this.compressedSize))},readCentralPart:function(p){this.versionMadeBy=p.readInt(2),p.skip(2),this.bitFlag=p.readInt(2),this.compressionMethod=p.readString(2),this.date=p.readDate(),this.crc32=p.readInt(4),this.compressedSize=p.readInt(4),this.uncompressedSize=p.readInt(4);var g=p.readInt(2);if(this.extraFieldsLength=p.readInt(2),this.fileCommentLength=p.readInt(2),this.diskNumberStart=p.readInt(2),this.internalFileAttributes=p.readInt(2),this.externalFileAttributes=p.readInt(4),this.localHeaderOffset=p.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");p.skip(g),this.readExtraFields(p),this.parseZIP64ExtraField(p),this.fileComment=p.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var p=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),p==0&&(this.dosPermissions=63&this.externalFileAttributes),p==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var p=o(this.extraFields[1].value);this.uncompressedSize===s.MAX_VALUE_32BITS&&(this.uncompressedSize=p.readInt(8)),this.compressedSize===s.MAX_VALUE_32BITS&&(this.compressedSize=p.readInt(8)),this.localHeaderOffset===s.MAX_VALUE_32BITS&&(this.localHeaderOffset=p.readInt(8)),this.diskNumberStart===s.MAX_VALUE_32BITS&&(this.diskNumberStart=p.readInt(4))}},readExtraFields:function(p){var g,m,x,v=p.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});p.index+4<v;)g=p.readInt(2),m=p.readInt(2),x=p.readData(m),this.extraFields[g]={id:g,length:m,value:x};p.setIndex(v)},handleUTF8:function(){var p=f.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=d.utf8decode(this.fileName),this.fileCommentStr=d.utf8decode(this.fileComment);else{var g=this.findExtraFieldUnicodePath();if(g!==null)this.fileNameStr=g;else{var m=s.transformTo(p,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(m)}var x=this.findExtraFieldUnicodeComment();if(x!==null)this.fileCommentStr=x;else{var v=s.transformTo(p,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(v)}}},findExtraFieldUnicodePath:function(){var p=this.extraFields[28789];if(p){var g=o(p.value);return g.readInt(1)!==1||c(this.fileName)!==g.readInt(4)?null:d.utf8decode(g.readData(p.length-5))}return null},findExtraFieldUnicodeComment:function(){var p=this.extraFields[25461];if(p){var g=o(p.value);return g.readInt(1)!==1||c(this.fileComment)!==g.readInt(4)?null:d.utf8decode(g.readData(p.length-5))}return null}},n.exports=u},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(r,n,i){function o(g,m,x){this.name=g,this.dir=x.dir,this.date=x.date,this.comment=x.comment,this.unixPermissions=x.unixPermissions,this.dosPermissions=x.dosPermissions,this._data=m,this._dataBinary=x.binary,this.options={compression:x.compression,compressionOptions:x.compressionOptions}}var s=r("./stream/StreamHelper"),l=r("./stream/DataWorker"),c=r("./utf8"),d=r("./compressedObject"),h=r("./stream/GenericWorker");o.prototype={internalStream:function(g){var m=null,x="string";try{if(!g)throw new Error("No output type specified.");var v=(x=g.toLowerCase())==="string"||x==="text";x!=="binarystring"&&x!=="text"||(x="string"),m=this._decompressWorker();var y=!this._dataBinary;y&&!v&&(m=m.pipe(new c.Utf8EncodeWorker)),!y&&v&&(m=m.pipe(new c.Utf8DecodeWorker))}catch(b){(m=new h("error")).error(b)}return new s(m,x,"")},async:function(g,m){return this.internalStream(g).accumulate(m)},nodeStream:function(g,m){return this.internalStream(g||"nodebuffer").toNodejsStream(m)},_compressWorker:function(g,m){if(this._data instanceof d&&this._data.compression.magic===g.magic)return this._data.getCompressedWorker();var x=this._decompressWorker();return this._dataBinary||(x=x.pipe(new c.Utf8EncodeWorker)),d.createWorkerFrom(x,g,m)},_decompressWorker:function(){return this._data instanceof d?this._data.getContentWorker():this._data instanceof h?this._data:new l(this._data)}};for(var f=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],u=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},p=0;p<f.length;p++)o.prototype[f[p]]=u;n.exports=o},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(r,n,i){(function(o){var s,l,c=o.MutationObserver||o.WebKitMutationObserver;if(c){var d=0,h=new c(g),f=o.document.createTextNode("");h.observe(f,{characterData:!0}),s=function(){f.data=d=++d%2}}else if(o.setImmediate||o.MessageChannel===void 0)s="document"in o&&"onreadystatechange"in o.document.createElement("script")?function(){var m=o.document.createElement("script");m.onreadystatechange=function(){g(),m.onreadystatechange=null,m.parentNode.removeChild(m),m=null},o.document.documentElement.appendChild(m)}:function(){setTimeout(g,0)};else{var u=new o.MessageChannel;u.port1.onmessage=g,s=function(){u.port2.postMessage(0)}}var p=[];function g(){var m,x;l=!0;for(var v=p.length;v;){for(x=p,p=[],m=-1;++m<v;)x[m]();v=p.length}l=!1}n.exports=function(m){p.push(m)!==1||l||s()}}).call(this,typeof Gn<"u"?Gn:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(r,n,i){var o=r("immediate");function s(){}var l={},c=["REJECTED"],d=["FULFILLED"],h=["PENDING"];function f(v){if(typeof v!="function")throw new TypeError("resolver must be a function");this.state=h,this.queue=[],this.outcome=void 0,v!==s&&m(this,v)}function u(v,y,b){this.promise=v,typeof y=="function"&&(this.onFulfilled=y,this.callFulfilled=this.otherCallFulfilled),typeof b=="function"&&(this.onRejected=b,this.callRejected=this.otherCallRejected)}function p(v,y,b){o(function(){var w;try{w=y(b)}catch(k){return l.reject(v,k)}w===v?l.reject(v,new TypeError("Cannot resolve promise with itself")):l.resolve(v,w)})}function g(v){var y=v&&v.then;if(v&&(typeof v=="object"||typeof v=="function")&&typeof y=="function")return function(){y.apply(v,arguments)}}function m(v,y){var b=!1;function w(C){b||(b=!0,l.reject(v,C))}function k(C){b||(b=!0,l.resolve(v,C))}var S=x(function(){y(k,w)});S.status==="error"&&w(S.value)}function x(v,y){var b={};try{b.value=v(y),b.status="success"}catch(w){b.status="error",b.value=w}return b}(n.exports=f).prototype.finally=function(v){if(typeof v!="function")return this;var y=this.constructor;return this.then(function(b){return y.resolve(v()).then(function(){return b})},function(b){return y.resolve(v()).then(function(){throw b})})},f.prototype.catch=function(v){return this.then(null,v)},f.prototype.then=function(v,y){if(typeof v!="function"&&this.state===d||typeof y!="function"&&this.state===c)return this;var b=new this.constructor(s);return this.state!==h?p(b,this.state===d?v:y,this.outcome):this.queue.push(new u(b,v,y)),b},u.prototype.callFulfilled=function(v){l.resolve(this.promise,v)},u.prototype.otherCallFulfilled=function(v){p(this.promise,this.onFulfilled,v)},u.prototype.callRejected=function(v){l.reject(this.promise,v)},u.prototype.otherCallRejected=function(v){p(this.promise,this.onRejected,v)},l.resolve=function(v,y){var b=x(g,y);if(b.status==="error")return l.reject(v,b.value);var w=b.value;if(w)m(v,w);else{v.state=d,v.outcome=y;for(var k=-1,S=v.queue.length;++k<S;)v.queue[k].callFulfilled(y)}return v},l.reject=function(v,y){v.state=c,v.outcome=y;for(var b=-1,w=v.queue.length;++b<w;)v.queue[b].callRejected(y);return v},f.resolve=function(v){return v instanceof this?v:l.resolve(new this(s),v)},f.reject=function(v){var y=new this(s);return l.reject(y,v)},f.all=function(v){var y=this;if(Object.prototype.toString.call(v)!=="[object Array]")return this.reject(new TypeError("must be an array"));var b=v.length,w=!1;if(!b)return this.resolve([]);for(var k=new Array(b),S=0,C=-1,T=new this(s);++C<b;)R(v[C],C);return T;function R(O,Y){y.resolve(O).then(function(E){k[Y]=E,++S!==b||w||(w=!0,l.resolve(T,k))},function(E){w||(w=!0,l.reject(T,E))})}},f.race=function(v){var y=this;if(Object.prototype.toString.call(v)!=="[object Array]")return this.reject(new TypeError("must be an array"));var b=v.length,w=!1;if(!b)return this.resolve([]);for(var k=-1,S=new this(s);++k<b;)C=v[k],y.resolve(C).then(function(T){w||(w=!0,l.resolve(S,T))},function(T){w||(w=!0,l.reject(S,T))});var C;return S}},{immediate:36}],38:[function(r,n,i){var o={};(0,r("./lib/utils/common").assign)(o,r("./lib/deflate"),r("./lib/inflate"),r("./lib/zlib/constants")),n.exports=o},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(r,n,i){var o=r("./zlib/deflate"),s=r("./utils/common"),l=r("./utils/strings"),c=r("./zlib/messages"),d=r("./zlib/zstream"),h=Object.prototype.toString,f=0,u=-1,p=0,g=8;function m(v){if(!(this instanceof m))return new m(v);this.options=s.assign({level:u,method:g,chunkSize:16384,windowBits:15,memLevel:8,strategy:p,to:""},v||{});var y=this.options;y.raw&&0<y.windowBits?y.windowBits=-y.windowBits:y.gzip&&0<y.windowBits&&y.windowBits<16&&(y.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var b=o.deflateInit2(this.strm,y.level,y.method,y.windowBits,y.memLevel,y.strategy);if(b!==f)throw new Error(c[b]);if(y.header&&o.deflateSetHeader(this.strm,y.header),y.dictionary){var w;if(w=typeof y.dictionary=="string"?l.string2buf(y.dictionary):h.call(y.dictionary)==="[object ArrayBuffer]"?new Uint8Array(y.dictionary):y.dictionary,(b=o.deflateSetDictionary(this.strm,w))!==f)throw new Error(c[b]);this._dict_set=!0}}function x(v,y){var b=new m(y);if(b.push(v,!0),b.err)throw b.msg||c[b.err];return b.result}m.prototype.push=function(v,y){var b,w,k=this.strm,S=this.options.chunkSize;if(this.ended)return!1;w=y===~~y?y:y===!0?4:0,typeof v=="string"?k.input=l.string2buf(v):h.call(v)==="[object ArrayBuffer]"?k.input=new Uint8Array(v):k.input=v,k.next_in=0,k.avail_in=k.input.length;do{if(k.avail_out===0&&(k.output=new s.Buf8(S),k.next_out=0,k.avail_out=S),(b=o.deflate(k,w))!==1&&b!==f)return this.onEnd(b),!(this.ended=!0);k.avail_out!==0&&(k.avail_in!==0||w!==4&&w!==2)||(this.options.to==="string"?this.onData(l.buf2binstring(s.shrinkBuf(k.output,k.next_out))):this.onData(s.shrinkBuf(k.output,k.next_out)))}while((0<k.avail_in||k.avail_out===0)&&b!==1);return w===4?(b=o.deflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===f):w!==2||(this.onEnd(f),!(k.avail_out=0))},m.prototype.onData=function(v){this.chunks.push(v)},m.prototype.onEnd=function(v){v===f&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=v,this.msg=this.strm.msg},i.Deflate=m,i.deflate=x,i.deflateRaw=function(v,y){return(y=y||{}).raw=!0,x(v,y)},i.gzip=function(v,y){return(y=y||{}).gzip=!0,x(v,y)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(r,n,i){var o=r("./zlib/inflate"),s=r("./utils/common"),l=r("./utils/strings"),c=r("./zlib/constants"),d=r("./zlib/messages"),h=r("./zlib/zstream"),f=r("./zlib/gzheader"),u=Object.prototype.toString;function p(m){if(!(this instanceof p))return new p(m);this.options=s.assign({chunkSize:16384,windowBits:0,to:""},m||{});var x=this.options;x.raw&&0<=x.windowBits&&x.windowBits<16&&(x.windowBits=-x.windowBits,x.windowBits===0&&(x.windowBits=-15)),!(0<=x.windowBits&&x.windowBits<16)||m&&m.windowBits||(x.windowBits+=32),15<x.windowBits&&x.windowBits<48&&!(15&x.windowBits)&&(x.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var v=o.inflateInit2(this.strm,x.windowBits);if(v!==c.Z_OK)throw new Error(d[v]);this.header=new f,o.inflateGetHeader(this.strm,this.header)}function g(m,x){var v=new p(x);if(v.push(m,!0),v.err)throw v.msg||d[v.err];return v.result}p.prototype.push=function(m,x){var v,y,b,w,k,S,C=this.strm,T=this.options.chunkSize,R=this.options.dictionary,O=!1;if(this.ended)return!1;y=x===~~x?x:x===!0?c.Z_FINISH:c.Z_NO_FLUSH,typeof m=="string"?C.input=l.binstring2buf(m):u.call(m)==="[object ArrayBuffer]"?C.input=new Uint8Array(m):C.input=m,C.next_in=0,C.avail_in=C.input.length;do{if(C.avail_out===0&&(C.output=new s.Buf8(T),C.next_out=0,C.avail_out=T),(v=o.inflate(C,c.Z_NO_FLUSH))===c.Z_NEED_DICT&&R&&(S=typeof R=="string"?l.string2buf(R):u.call(R)==="[object ArrayBuffer]"?new Uint8Array(R):R,v=o.inflateSetDictionary(this.strm,S)),v===c.Z_BUF_ERROR&&O===!0&&(v=c.Z_OK,O=!1),v!==c.Z_STREAM_END&&v!==c.Z_OK)return this.onEnd(v),!(this.ended=!0);C.next_out&&(C.avail_out!==0&&v!==c.Z_STREAM_END&&(C.avail_in!==0||y!==c.Z_FINISH&&y!==c.Z_SYNC_FLUSH)||(this.options.to==="string"?(b=l.utf8border(C.output,C.next_out),w=C.next_out-b,k=l.buf2string(C.output,b),C.next_out=w,C.avail_out=T-w,w&&s.arraySet(C.output,C.output,b,w,0),this.onData(k)):this.onData(s.shrinkBuf(C.output,C.next_out)))),C.avail_in===0&&C.avail_out===0&&(O=!0)}while((0<C.avail_in||C.avail_out===0)&&v!==c.Z_STREAM_END);return v===c.Z_STREAM_END&&(y=c.Z_FINISH),y===c.Z_FINISH?(v=o.inflateEnd(this.strm),this.onEnd(v),this.ended=!0,v===c.Z_OK):y!==c.Z_SYNC_FLUSH||(this.onEnd(c.Z_OK),!(C.avail_out=0))},p.prototype.onData=function(m){this.chunks.push(m)},p.prototype.onEnd=function(m){m===c.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=m,this.msg=this.strm.msg},i.Inflate=p,i.inflate=g,i.inflateRaw=function(m,x){return(x=x||{}).raw=!0,g(m,x)},i.ungzip=g},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(r,n,i){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(c){for(var d=Array.prototype.slice.call(arguments,1);d.length;){var h=d.shift();if(h){if(typeof h!="object")throw new TypeError(h+"must be non-object");for(var f in h)h.hasOwnProperty(f)&&(c[f]=h[f])}}return c},i.shrinkBuf=function(c,d){return c.length===d?c:c.subarray?c.subarray(0,d):(c.length=d,c)};var s={arraySet:function(c,d,h,f,u){if(d.subarray&&c.subarray)c.set(d.subarray(h,h+f),u);else for(var p=0;p<f;p++)c[u+p]=d[h+p]},flattenChunks:function(c){var d,h,f,u,p,g;for(d=f=0,h=c.length;d<h;d++)f+=c[d].length;for(g=new Uint8Array(f),d=u=0,h=c.length;d<h;d++)p=c[d],g.set(p,u),u+=p.length;return g}},l={arraySet:function(c,d,h,f,u){for(var p=0;p<f;p++)c[u+p]=d[h+p]},flattenChunks:function(c){return[].concat.apply([],c)}};i.setTyped=function(c){c?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,s)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,l))},i.setTyped(o)},{}],42:[function(r,n,i){var o=r("./common"),s=!0,l=!0;try{String.fromCharCode.apply(null,[0])}catch{s=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{l=!1}for(var c=new o.Buf8(256),d=0;d<256;d++)c[d]=252<=d?6:248<=d?5:240<=d?4:224<=d?3:192<=d?2:1;function h(f,u){if(u<65537&&(f.subarray&&l||!f.subarray&&s))return String.fromCharCode.apply(null,o.shrinkBuf(f,u));for(var p="",g=0;g<u;g++)p+=String.fromCharCode(f[g]);return p}c[254]=c[254]=1,i.string2buf=function(f){var u,p,g,m,x,v=f.length,y=0;for(m=0;m<v;m++)(64512&(p=f.charCodeAt(m)))==55296&&m+1<v&&(64512&(g=f.charCodeAt(m+1)))==56320&&(p=65536+(p-55296<<10)+(g-56320),m++),y+=p<128?1:p<2048?2:p<65536?3:4;for(u=new o.Buf8(y),m=x=0;x<y;m++)(64512&(p=f.charCodeAt(m)))==55296&&m+1<v&&(64512&(g=f.charCodeAt(m+1)))==56320&&(p=65536+(p-55296<<10)+(g-56320),m++),p<128?u[x++]=p:(p<2048?u[x++]=192|p>>>6:(p<65536?u[x++]=224|p>>>12:(u[x++]=240|p>>>18,u[x++]=128|p>>>12&63),u[x++]=128|p>>>6&63),u[x++]=128|63&p);return u},i.buf2binstring=function(f){return h(f,f.length)},i.binstring2buf=function(f){for(var u=new o.Buf8(f.length),p=0,g=u.length;p<g;p++)u[p]=f.charCodeAt(p);return u},i.buf2string=function(f,u){var p,g,m,x,v=u||f.length,y=new Array(2*v);for(p=g=0;p<v;)if((m=f[p++])<128)y[g++]=m;else if(4<(x=c[m]))y[g++]=65533,p+=x-1;else{for(m&=x===2?31:x===3?15:7;1<x&&p<v;)m=m<<6|63&f[p++],x--;1<x?y[g++]=65533:m<65536?y[g++]=m:(m-=65536,y[g++]=55296|m>>10&1023,y[g++]=56320|1023&m)}return h(y,g)},i.utf8border=function(f,u){var p;for((u=u||f.length)>f.length&&(u=f.length),p=u-1;0<=p&&(192&f[p])==128;)p--;return p<0||p===0?u:p+c[f[p]]>u?p:u}},{"./common":41}],43:[function(r,n,i){n.exports=function(o,s,l,c){for(var d=65535&o|0,h=o>>>16&65535|0,f=0;l!==0;){for(l-=f=2e3<l?2e3:l;h=h+(d=d+s[c++]|0)|0,--f;);d%=65521,h%=65521}return d|h<<16|0}},{}],44:[function(r,n,i){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(r,n,i){var o=function(){for(var s,l=[],c=0;c<256;c++){s=c;for(var d=0;d<8;d++)s=1&s?3988292384^s>>>1:s>>>1;l[c]=s}return l}();n.exports=function(s,l,c,d){var h=o,f=d+c;s^=-1;for(var u=d;u<f;u++)s=s>>>8^h[255&(s^l[u])];return-1^s}},{}],46:[function(r,n,i){var o,s=r("../utils/common"),l=r("./trees"),c=r("./adler32"),d=r("./crc32"),h=r("./messages"),f=0,u=4,p=0,g=-2,m=-1,x=4,v=2,y=8,b=9,w=286,k=30,S=19,C=2*w+1,T=15,R=3,O=258,Y=O+R+1,E=42,B=113,_=1,V=2,re=3,I=4;function q(j,ie){return j.msg=h[ie],ie}function D(j){return(j<<1)-(4<j?9:0)}function J(j){for(var ie=j.length;0<=--ie;)j[ie]=0}function U(j){var ie=j.state,M=ie.pending;M>j.avail_out&&(M=j.avail_out),M!==0&&(s.arraySet(j.output,ie.pending_buf,ie.pending_out,M,j.next_out),j.next_out+=M,ie.pending_out+=M,j.total_out+=M,j.avail_out-=M,ie.pending-=M,ie.pending===0&&(ie.pending_out=0))}function G(j,ie){l._tr_flush_block(j,0<=j.block_start?j.block_start:-1,j.strstart-j.block_start,ie),j.block_start=j.strstart,U(j.strm)}function fe(j,ie){j.pending_buf[j.pending++]=ie}function oe(j,ie){j.pending_buf[j.pending++]=ie>>>8&255,j.pending_buf[j.pending++]=255&ie}function ae(j,ie){var M,N,P=j.max_chain_length,F=j.strstart,X=j.prev_length,K=j.nice_match,L=j.strstart>j.w_size-Y?j.strstart-(j.w_size-Y):0,H=j.window,Z=j.w_mask,ee=j.prev,z=j.strstart+O,Q=H[F+X-1],ne=H[F+X];j.prev_length>=j.good_match&&(P>>=2),K>j.lookahead&&(K=j.lookahead);do if(H[(M=ie)+X]===ne&&H[M+X-1]===Q&&H[M]===H[F]&&H[++M]===H[F+1]){F+=2,M++;do;while(H[++F]===H[++M]&&H[++F]===H[++M]&&H[++F]===H[++M]&&H[++F]===H[++M]&&H[++F]===H[++M]&&H[++F]===H[++M]&&H[++F]===H[++M]&&H[++F]===H[++M]&&F<z);if(N=O-(z-F),F=z-O,X<N){if(j.match_start=ie,K<=(X=N))break;Q=H[F+X-1],ne=H[F+X]}}while((ie=ee[ie&Z])>L&&--P!=0);return X<=j.lookahead?X:j.lookahead}function le(j){var ie,M,N,P,F,X,K,L,H,Z,ee=j.w_size;do{if(P=j.window_size-j.lookahead-j.strstart,j.strstart>=ee+(ee-Y)){for(s.arraySet(j.window,j.window,ee,ee,0),j.match_start-=ee,j.strstart-=ee,j.block_start-=ee,ie=M=j.hash_size;N=j.head[--ie],j.head[ie]=ee<=N?N-ee:0,--M;);for(ie=M=ee;N=j.prev[--ie],j.prev[ie]=ee<=N?N-ee:0,--M;);P+=ee}if(j.strm.avail_in===0)break;if(X=j.strm,K=j.window,L=j.strstart+j.lookahead,H=P,Z=void 0,Z=X.avail_in,H<Z&&(Z=H),M=Z===0?0:(X.avail_in-=Z,s.arraySet(K,X.input,X.next_in,Z,L),X.state.wrap===1?X.adler=c(X.adler,K,Z,L):X.state.wrap===2&&(X.adler=d(X.adler,K,Z,L)),X.next_in+=Z,X.total_in+=Z,Z),j.lookahead+=M,j.lookahead+j.insert>=R)for(F=j.strstart-j.insert,j.ins_h=j.window[F],j.ins_h=(j.ins_h<<j.hash_shift^j.window[F+1])&j.hash_mask;j.insert&&(j.ins_h=(j.ins_h<<j.hash_shift^j.window[F+R-1])&j.hash_mask,j.prev[F&j.w_mask]=j.head[j.ins_h],j.head[j.ins_h]=F,F++,j.insert--,!(j.lookahead+j.insert<R)););}while(j.lookahead<Y&&j.strm.avail_in!==0)}function ce(j,ie){for(var M,N;;){if(j.lookahead<Y){if(le(j),j.lookahead<Y&&ie===f)return _;if(j.lookahead===0)break}if(M=0,j.lookahead>=R&&(j.ins_h=(j.ins_h<<j.hash_shift^j.window[j.strstart+R-1])&j.hash_mask,M=j.prev[j.strstart&j.w_mask]=j.head[j.ins_h],j.head[j.ins_h]=j.strstart),M!==0&&j.strstart-M<=j.w_size-Y&&(j.match_length=ae(j,M)),j.match_length>=R)if(N=l._tr_tally(j,j.strstart-j.match_start,j.match_length-R),j.lookahead-=j.match_length,j.match_length<=j.max_lazy_match&&j.lookahead>=R){for(j.match_length--;j.strstart++,j.ins_h=(j.ins_h<<j.hash_shift^j.window[j.strstart+R-1])&j.hash_mask,M=j.prev[j.strstart&j.w_mask]=j.head[j.ins_h],j.head[j.ins_h]=j.strstart,--j.match_length!=0;);j.strstart++}else j.strstart+=j.match_length,j.match_length=0,j.ins_h=j.window[j.strstart],j.ins_h=(j.ins_h<<j.hash_shift^j.window[j.strstart+1])&j.hash_mask;else N=l._tr_tally(j,0,j.window[j.strstart]),j.lookahead--,j.strstart++;if(N&&(G(j,!1),j.strm.avail_out===0))return _}return j.insert=j.strstart<R-1?j.strstart:R-1,ie===u?(G(j,!0),j.strm.avail_out===0?re:I):j.last_lit&&(G(j,!1),j.strm.avail_out===0)?_:V}function be(j,ie){for(var M,N,P;;){if(j.lookahead<Y){if(le(j),j.lookahead<Y&&ie===f)return _;if(j.lookahead===0)break}if(M=0,j.lookahead>=R&&(j.ins_h=(j.ins_h<<j.hash_shift^j.window[j.strstart+R-1])&j.hash_mask,M=j.prev[j.strstart&j.w_mask]=j.head[j.ins_h],j.head[j.ins_h]=j.strstart),j.prev_length=j.match_length,j.prev_match=j.match_start,j.match_length=R-1,M!==0&&j.prev_length<j.max_lazy_match&&j.strstart-M<=j.w_size-Y&&(j.match_length=ae(j,M),j.match_length<=5&&(j.strategy===1||j.match_length===R&&4096<j.strstart-j.match_start)&&(j.match_length=R-1)),j.prev_length>=R&&j.match_length<=j.prev_length){for(P=j.strstart+j.lookahead-R,N=l._tr_tally(j,j.strstart-1-j.prev_match,j.prev_length-R),j.lookahead-=j.prev_length-1,j.prev_length-=2;++j.strstart<=P&&(j.ins_h=(j.ins_h<<j.hash_shift^j.window[j.strstart+R-1])&j.hash_mask,M=j.prev[j.strstart&j.w_mask]=j.head[j.ins_h],j.head[j.ins_h]=j.strstart),--j.prev_length!=0;);if(j.match_available=0,j.match_length=R-1,j.strstart++,N&&(G(j,!1),j.strm.avail_out===0))return _}else if(j.match_available){if((N=l._tr_tally(j,0,j.window[j.strstart-1]))&&G(j,!1),j.strstart++,j.lookahead--,j.strm.avail_out===0)return _}else j.match_available=1,j.strstart++,j.lookahead--}return j.match_available&&(N=l._tr_tally(j,0,j.window[j.strstart-1]),j.match_available=0),j.insert=j.strstart<R-1?j.strstart:R-1,ie===u?(G(j,!0),j.strm.avail_out===0?re:I):j.last_lit&&(G(j,!1),j.strm.avail_out===0)?_:V}function Ce(j,ie,M,N,P){this.good_length=j,this.max_lazy=ie,this.nice_length=M,this.max_chain=N,this.func=P}function ue(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=y,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new s.Buf16(2*C),this.dyn_dtree=new s.Buf16(2*(2*k+1)),this.bl_tree=new s.Buf16(2*(2*S+1)),J(this.dyn_ltree),J(this.dyn_dtree),J(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new s.Buf16(T+1),this.heap=new s.Buf16(2*w+1),J(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new s.Buf16(2*w+1),J(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function de(j){var ie;return j&&j.state?(j.total_in=j.total_out=0,j.data_type=v,(ie=j.state).pending=0,ie.pending_out=0,ie.wrap<0&&(ie.wrap=-ie.wrap),ie.status=ie.wrap?E:B,j.adler=ie.wrap===2?0:1,ie.last_flush=f,l._tr_init(ie),p):q(j,g)}function ze(j){var ie=de(j);return ie===p&&function(M){M.window_size=2*M.w_size,J(M.head),M.max_lazy_match=o[M.level].max_lazy,M.good_match=o[M.level].good_length,M.nice_match=o[M.level].nice_length,M.max_chain_length=o[M.level].max_chain,M.strstart=0,M.block_start=0,M.lookahead=0,M.insert=0,M.match_length=M.prev_length=R-1,M.match_available=0,M.ins_h=0}(j.state),ie}function Ge(j,ie,M,N,P,F){if(!j)return g;var X=1;if(ie===m&&(ie=6),N<0?(X=0,N=-N):15<N&&(X=2,N-=16),P<1||b<P||M!==y||N<8||15<N||ie<0||9<ie||F<0||x<F)return q(j,g);N===8&&(N=9);var K=new ue;return(j.state=K).strm=j,K.wrap=X,K.gzhead=null,K.w_bits=N,K.w_size=1<<K.w_bits,K.w_mask=K.w_size-1,K.hash_bits=P+7,K.hash_size=1<<K.hash_bits,K.hash_mask=K.hash_size-1,K.hash_shift=~~((K.hash_bits+R-1)/R),K.window=new s.Buf8(2*K.w_size),K.head=new s.Buf16(K.hash_size),K.prev=new s.Buf16(K.w_size),K.lit_bufsize=1<<P+6,K.pending_buf_size=4*K.lit_bufsize,K.pending_buf=new s.Buf8(K.pending_buf_size),K.d_buf=1*K.lit_bufsize,K.l_buf=3*K.lit_bufsize,K.level=ie,K.strategy=F,K.method=M,ze(j)}o=[new Ce(0,0,0,0,function(j,ie){var M=65535;for(M>j.pending_buf_size-5&&(M=j.pending_buf_size-5);;){if(j.lookahead<=1){if(le(j),j.lookahead===0&&ie===f)return _;if(j.lookahead===0)break}j.strstart+=j.lookahead,j.lookahead=0;var N=j.block_start+M;if((j.strstart===0||j.strstart>=N)&&(j.lookahead=j.strstart-N,j.strstart=N,G(j,!1),j.strm.avail_out===0)||j.strstart-j.block_start>=j.w_size-Y&&(G(j,!1),j.strm.avail_out===0))return _}return j.insert=0,ie===u?(G(j,!0),j.strm.avail_out===0?re:I):(j.strstart>j.block_start&&(G(j,!1),j.strm.avail_out),_)}),new Ce(4,4,8,4,ce),new Ce(4,5,16,8,ce),new Ce(4,6,32,32,ce),new Ce(4,4,16,16,be),new Ce(8,16,32,32,be),new Ce(8,16,128,128,be),new Ce(8,32,128,256,be),new Ce(32,128,258,1024,be),new Ce(32,258,258,4096,be)],i.deflateInit=function(j,ie){return Ge(j,ie,y,15,8,0)},i.deflateInit2=Ge,i.deflateReset=ze,i.deflateResetKeep=de,i.deflateSetHeader=function(j,ie){return j&&j.state?j.state.wrap!==2?g:(j.state.gzhead=ie,p):g},i.deflate=function(j,ie){var M,N,P,F;if(!j||!j.state||5<ie||ie<0)return j?q(j,g):g;if(N=j.state,!j.output||!j.input&&j.avail_in!==0||N.status===666&&ie!==u)return q(j,j.avail_out===0?-5:g);if(N.strm=j,M=N.last_flush,N.last_flush=ie,N.status===E)if(N.wrap===2)j.adler=0,fe(N,31),fe(N,139),fe(N,8),N.gzhead?(fe(N,(N.gzhead.text?1:0)+(N.gzhead.hcrc?2:0)+(N.gzhead.extra?4:0)+(N.gzhead.name?8:0)+(N.gzhead.comment?16:0)),fe(N,255&N.gzhead.time),fe(N,N.gzhead.time>>8&255),fe(N,N.gzhead.time>>16&255),fe(N,N.gzhead.time>>24&255),fe(N,N.level===9?2:2<=N.strategy||N.level<2?4:0),fe(N,255&N.gzhead.os),N.gzhead.extra&&N.gzhead.extra.length&&(fe(N,255&N.gzhead.extra.length),fe(N,N.gzhead.extra.length>>8&255)),N.gzhead.hcrc&&(j.adler=d(j.adler,N.pending_buf,N.pending,0)),N.gzindex=0,N.status=69):(fe(N,0),fe(N,0),fe(N,0),fe(N,0),fe(N,0),fe(N,N.level===9?2:2<=N.strategy||N.level<2?4:0),fe(N,3),N.status=B);else{var X=y+(N.w_bits-8<<4)<<8;X|=(2<=N.strategy||N.level<2?0:N.level<6?1:N.level===6?2:3)<<6,N.strstart!==0&&(X|=32),X+=31-X%31,N.status=B,oe(N,X),N.strstart!==0&&(oe(N,j.adler>>>16),oe(N,65535&j.adler)),j.adler=1}if(N.status===69)if(N.gzhead.extra){for(P=N.pending;N.gzindex<(65535&N.gzhead.extra.length)&&(N.pending!==N.pending_buf_size||(N.gzhead.hcrc&&N.pending>P&&(j.adler=d(j.adler,N.pending_buf,N.pending-P,P)),U(j),P=N.pending,N.pending!==N.pending_buf_size));)fe(N,255&N.gzhead.extra[N.gzindex]),N.gzindex++;N.gzhead.hcrc&&N.pending>P&&(j.adler=d(j.adler,N.pending_buf,N.pending-P,P)),N.gzindex===N.gzhead.extra.length&&(N.gzindex=0,N.status=73)}else N.status=73;if(N.status===73)if(N.gzhead.name){P=N.pending;do{if(N.pending===N.pending_buf_size&&(N.gzhead.hcrc&&N.pending>P&&(j.adler=d(j.adler,N.pending_buf,N.pending-P,P)),U(j),P=N.pending,N.pending===N.pending_buf_size)){F=1;break}F=N.gzindex<N.gzhead.name.length?255&N.gzhead.name.charCodeAt(N.gzindex++):0,fe(N,F)}while(F!==0);N.gzhead.hcrc&&N.pending>P&&(j.adler=d(j.adler,N.pending_buf,N.pending-P,P)),F===0&&(N.gzindex=0,N.status=91)}else N.status=91;if(N.status===91)if(N.gzhead.comment){P=N.pending;do{if(N.pending===N.pending_buf_size&&(N.gzhead.hcrc&&N.pending>P&&(j.adler=d(j.adler,N.pending_buf,N.pending-P,P)),U(j),P=N.pending,N.pending===N.pending_buf_size)){F=1;break}F=N.gzindex<N.gzhead.comment.length?255&N.gzhead.comment.charCodeAt(N.gzindex++):0,fe(N,F)}while(F!==0);N.gzhead.hcrc&&N.pending>P&&(j.adler=d(j.adler,N.pending_buf,N.pending-P,P)),F===0&&(N.status=103)}else N.status=103;if(N.status===103&&(N.gzhead.hcrc?(N.pending+2>N.pending_buf_size&&U(j),N.pending+2<=N.pending_buf_size&&(fe(N,255&j.adler),fe(N,j.adler>>8&255),j.adler=0,N.status=B)):N.status=B),N.pending!==0){if(U(j),j.avail_out===0)return N.last_flush=-1,p}else if(j.avail_in===0&&D(ie)<=D(M)&&ie!==u)return q(j,-5);if(N.status===666&&j.avail_in!==0)return q(j,-5);if(j.avail_in!==0||N.lookahead!==0||ie!==f&&N.status!==666){var K=N.strategy===2?function(L,H){for(var Z;;){if(L.lookahead===0&&(le(L),L.lookahead===0)){if(H===f)return _;break}if(L.match_length=0,Z=l._tr_tally(L,0,L.window[L.strstart]),L.lookahead--,L.strstart++,Z&&(G(L,!1),L.strm.avail_out===0))return _}return L.insert=0,H===u?(G(L,!0),L.strm.avail_out===0?re:I):L.last_lit&&(G(L,!1),L.strm.avail_out===0)?_:V}(N,ie):N.strategy===3?function(L,H){for(var Z,ee,z,Q,ne=L.window;;){if(L.lookahead<=O){if(le(L),L.lookahead<=O&&H===f)return _;if(L.lookahead===0)break}if(L.match_length=0,L.lookahead>=R&&0<L.strstart&&(ee=ne[z=L.strstart-1])===ne[++z]&&ee===ne[++z]&&ee===ne[++z]){Q=L.strstart+O;do;while(ee===ne[++z]&&ee===ne[++z]&&ee===ne[++z]&&ee===ne[++z]&&ee===ne[++z]&&ee===ne[++z]&&ee===ne[++z]&&ee===ne[++z]&&z<Q);L.match_length=O-(Q-z),L.match_length>L.lookahead&&(L.match_length=L.lookahead)}if(L.match_length>=R?(Z=l._tr_tally(L,1,L.match_length-R),L.lookahead-=L.match_length,L.strstart+=L.match_length,L.match_length=0):(Z=l._tr_tally(L,0,L.window[L.strstart]),L.lookahead--,L.strstart++),Z&&(G(L,!1),L.strm.avail_out===0))return _}return L.insert=0,H===u?(G(L,!0),L.strm.avail_out===0?re:I):L.last_lit&&(G(L,!1),L.strm.avail_out===0)?_:V}(N,ie):o[N.level].func(N,ie);if(K!==re&&K!==I||(N.status=666),K===_||K===re)return j.avail_out===0&&(N.last_flush=-1),p;if(K===V&&(ie===1?l._tr_align(N):ie!==5&&(l._tr_stored_block(N,0,0,!1),ie===3&&(J(N.head),N.lookahead===0&&(N.strstart=0,N.block_start=0,N.insert=0))),U(j),j.avail_out===0))return N.last_flush=-1,p}return ie!==u?p:N.wrap<=0?1:(N.wrap===2?(fe(N,255&j.adler),fe(N,j.adler>>8&255),fe(N,j.adler>>16&255),fe(N,j.adler>>24&255),fe(N,255&j.total_in),fe(N,j.total_in>>8&255),fe(N,j.total_in>>16&255),fe(N,j.total_in>>24&255)):(oe(N,j.adler>>>16),oe(N,65535&j.adler)),U(j),0<N.wrap&&(N.wrap=-N.wrap),N.pending!==0?p:1)},i.deflateEnd=function(j){var ie;return j&&j.state?(ie=j.state.status)!==E&&ie!==69&&ie!==73&&ie!==91&&ie!==103&&ie!==B&&ie!==666?q(j,g):(j.state=null,ie===B?q(j,-3):p):g},i.deflateSetDictionary=function(j,ie){var M,N,P,F,X,K,L,H,Z=ie.length;if(!j||!j.state||(F=(M=j.state).wrap)===2||F===1&&M.status!==E||M.lookahead)return g;for(F===1&&(j.adler=c(j.adler,ie,Z,0)),M.wrap=0,Z>=M.w_size&&(F===0&&(J(M.head),M.strstart=0,M.block_start=0,M.insert=0),H=new s.Buf8(M.w_size),s.arraySet(H,ie,Z-M.w_size,M.w_size,0),ie=H,Z=M.w_size),X=j.avail_in,K=j.next_in,L=j.input,j.avail_in=Z,j.next_in=0,j.input=ie,le(M);M.lookahead>=R;){for(N=M.strstart,P=M.lookahead-(R-1);M.ins_h=(M.ins_h<<M.hash_shift^M.window[N+R-1])&M.hash_mask,M.prev[N&M.w_mask]=M.head[M.ins_h],M.head[M.ins_h]=N,N++,--P;);M.strstart=N,M.lookahead=R-1,le(M)}return M.strstart+=M.lookahead,M.block_start=M.strstart,M.insert=M.lookahead,M.lookahead=0,M.match_length=M.prev_length=R-1,M.match_available=0,j.next_in=K,j.input=L,j.avail_in=X,M.wrap=F,p},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(r,n,i){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(r,n,i){n.exports=function(o,s){var l,c,d,h,f,u,p,g,m,x,v,y,b,w,k,S,C,T,R,O,Y,E,B,_,V;l=o.state,c=o.next_in,_=o.input,d=c+(o.avail_in-5),h=o.next_out,V=o.output,f=h-(s-o.avail_out),u=h+(o.avail_out-257),p=l.dmax,g=l.wsize,m=l.whave,x=l.wnext,v=l.window,y=l.hold,b=l.bits,w=l.lencode,k=l.distcode,S=(1<<l.lenbits)-1,C=(1<<l.distbits)-1;e:do{b<15&&(y+=_[c++]<<b,b+=8,y+=_[c++]<<b,b+=8),T=w[y&S];t:for(;;){if(y>>>=R=T>>>24,b-=R,(R=T>>>16&255)===0)V[h++]=65535&T;else{if(!(16&R)){if(!(64&R)){T=w[(65535&T)+(y&(1<<R)-1)];continue t}if(32&R){l.mode=12;break e}o.msg="invalid literal/length code",l.mode=30;break e}O=65535&T,(R&=15)&&(b<R&&(y+=_[c++]<<b,b+=8),O+=y&(1<<R)-1,y>>>=R,b-=R),b<15&&(y+=_[c++]<<b,b+=8,y+=_[c++]<<b,b+=8),T=k[y&C];r:for(;;){if(y>>>=R=T>>>24,b-=R,!(16&(R=T>>>16&255))){if(!(64&R)){T=k[(65535&T)+(y&(1<<R)-1)];continue r}o.msg="invalid distance code",l.mode=30;break e}if(Y=65535&T,b<(R&=15)&&(y+=_[c++]<<b,(b+=8)<R&&(y+=_[c++]<<b,b+=8)),p<(Y+=y&(1<<R)-1)){o.msg="invalid distance too far back",l.mode=30;break e}if(y>>>=R,b-=R,(R=h-f)<Y){if(m<(R=Y-R)&&l.sane){o.msg="invalid distance too far back",l.mode=30;break e}if(B=v,(E=0)===x){if(E+=g-R,R<O){for(O-=R;V[h++]=v[E++],--R;);E=h-Y,B=V}}else if(x<R){if(E+=g+x-R,(R-=x)<O){for(O-=R;V[h++]=v[E++],--R;);if(E=0,x<O){for(O-=R=x;V[h++]=v[E++],--R;);E=h-Y,B=V}}}else if(E+=x-R,R<O){for(O-=R;V[h++]=v[E++],--R;);E=h-Y,B=V}for(;2<O;)V[h++]=B[E++],V[h++]=B[E++],V[h++]=B[E++],O-=3;O&&(V[h++]=B[E++],1<O&&(V[h++]=B[E++]))}else{for(E=h-Y;V[h++]=V[E++],V[h++]=V[E++],V[h++]=V[E++],2<(O-=3););O&&(V[h++]=V[E++],1<O&&(V[h++]=V[E++]))}break}}break}}while(c<d&&h<u);c-=O=b>>3,y&=(1<<(b-=O<<3))-1,o.next_in=c,o.next_out=h,o.avail_in=c<d?d-c+5:5-(c-d),o.avail_out=h<u?u-h+257:257-(h-u),l.hold=y,l.bits=b}},{}],49:[function(r,n,i){var o=r("../utils/common"),s=r("./adler32"),l=r("./crc32"),c=r("./inffast"),d=r("./inftrees"),h=1,f=2,u=0,p=-2,g=1,m=852,x=592;function v(E){return(E>>>24&255)+(E>>>8&65280)+((65280&E)<<8)+((255&E)<<24)}function y(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new o.Buf16(320),this.work=new o.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function b(E){var B;return E&&E.state?(B=E.state,E.total_in=E.total_out=B.total=0,E.msg="",B.wrap&&(E.adler=1&B.wrap),B.mode=g,B.last=0,B.havedict=0,B.dmax=32768,B.head=null,B.hold=0,B.bits=0,B.lencode=B.lendyn=new o.Buf32(m),B.distcode=B.distdyn=new o.Buf32(x),B.sane=1,B.back=-1,u):p}function w(E){var B;return E&&E.state?((B=E.state).wsize=0,B.whave=0,B.wnext=0,b(E)):p}function k(E,B){var _,V;return E&&E.state?(V=E.state,B<0?(_=0,B=-B):(_=1+(B>>4),B<48&&(B&=15)),B&&(B<8||15<B)?p:(V.window!==null&&V.wbits!==B&&(V.window=null),V.wrap=_,V.wbits=B,w(E))):p}function S(E,B){var _,V;return E?(V=new y,(E.state=V).window=null,(_=k(E,B))!==u&&(E.state=null),_):p}var C,T,R=!0;function O(E){if(R){var B;for(C=new o.Buf32(512),T=new o.Buf32(32),B=0;B<144;)E.lens[B++]=8;for(;B<256;)E.lens[B++]=9;for(;B<280;)E.lens[B++]=7;for(;B<288;)E.lens[B++]=8;for(d(h,E.lens,0,288,C,0,E.work,{bits:9}),B=0;B<32;)E.lens[B++]=5;d(f,E.lens,0,32,T,0,E.work,{bits:5}),R=!1}E.lencode=C,E.lenbits=9,E.distcode=T,E.distbits=5}function Y(E,B,_,V){var re,I=E.state;return I.window===null&&(I.wsize=1<<I.wbits,I.wnext=0,I.whave=0,I.window=new o.Buf8(I.wsize)),V>=I.wsize?(o.arraySet(I.window,B,_-I.wsize,I.wsize,0),I.wnext=0,I.whave=I.wsize):(V<(re=I.wsize-I.wnext)&&(re=V),o.arraySet(I.window,B,_-V,re,I.wnext),(V-=re)?(o.arraySet(I.window,B,_-V,V,0),I.wnext=V,I.whave=I.wsize):(I.wnext+=re,I.wnext===I.wsize&&(I.wnext=0),I.whave<I.wsize&&(I.whave+=re))),0}i.inflateReset=w,i.inflateReset2=k,i.inflateResetKeep=b,i.inflateInit=function(E){return S(E,15)},i.inflateInit2=S,i.inflate=function(E,B){var _,V,re,I,q,D,J,U,G,fe,oe,ae,le,ce,be,Ce,ue,de,ze,Ge,j,ie,M,N,P=0,F=new o.Buf8(4),X=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!E||!E.state||!E.output||!E.input&&E.avail_in!==0)return p;(_=E.state).mode===12&&(_.mode=13),q=E.next_out,re=E.output,J=E.avail_out,I=E.next_in,V=E.input,D=E.avail_in,U=_.hold,G=_.bits,fe=D,oe=J,ie=u;e:for(;;)switch(_.mode){case g:if(_.wrap===0){_.mode=13;break}for(;G<16;){if(D===0)break e;D--,U+=V[I++]<<G,G+=8}if(2&_.wrap&&U===35615){F[_.check=0]=255&U,F[1]=U>>>8&255,_.check=l(_.check,F,2,0),G=U=0,_.mode=2;break}if(_.flags=0,_.head&&(_.head.done=!1),!(1&_.wrap)||(((255&U)<<8)+(U>>8))%31){E.msg="incorrect header check",_.mode=30;break}if((15&U)!=8){E.msg="unknown compression method",_.mode=30;break}if(G-=4,j=8+(15&(U>>>=4)),_.wbits===0)_.wbits=j;else if(j>_.wbits){E.msg="invalid window size",_.mode=30;break}_.dmax=1<<j,E.adler=_.check=1,_.mode=512&U?10:12,G=U=0;break;case 2:for(;G<16;){if(D===0)break e;D--,U+=V[I++]<<G,G+=8}if(_.flags=U,(255&_.flags)!=8){E.msg="unknown compression method",_.mode=30;break}if(57344&_.flags){E.msg="unknown header flags set",_.mode=30;break}_.head&&(_.head.text=U>>8&1),512&_.flags&&(F[0]=255&U,F[1]=U>>>8&255,_.check=l(_.check,F,2,0)),G=U=0,_.mode=3;case 3:for(;G<32;){if(D===0)break e;D--,U+=V[I++]<<G,G+=8}_.head&&(_.head.time=U),512&_.flags&&(F[0]=255&U,F[1]=U>>>8&255,F[2]=U>>>16&255,F[3]=U>>>24&255,_.check=l(_.check,F,4,0)),G=U=0,_.mode=4;case 4:for(;G<16;){if(D===0)break e;D--,U+=V[I++]<<G,G+=8}_.head&&(_.head.xflags=255&U,_.head.os=U>>8),512&_.flags&&(F[0]=255&U,F[1]=U>>>8&255,_.check=l(_.check,F,2,0)),G=U=0,_.mode=5;case 5:if(1024&_.flags){for(;G<16;){if(D===0)break e;D--,U+=V[I++]<<G,G+=8}_.length=U,_.head&&(_.head.extra_len=U),512&_.flags&&(F[0]=255&U,F[1]=U>>>8&255,_.check=l(_.check,F,2,0)),G=U=0}else _.head&&(_.head.extra=null);_.mode=6;case 6:if(1024&_.flags&&(D<(ae=_.length)&&(ae=D),ae&&(_.head&&(j=_.head.extra_len-_.length,_.head.extra||(_.head.extra=new Array(_.head.extra_len)),o.arraySet(_.head.extra,V,I,ae,j)),512&_.flags&&(_.check=l(_.check,V,ae,I)),D-=ae,I+=ae,_.length-=ae),_.length))break e;_.length=0,_.mode=7;case 7:if(2048&_.flags){if(D===0)break e;for(ae=0;j=V[I+ae++],_.head&&j&&_.length<65536&&(_.head.name+=String.fromCharCode(j)),j&&ae<D;);if(512&_.flags&&(_.check=l(_.check,V,ae,I)),D-=ae,I+=ae,j)break e}else _.head&&(_.head.name=null);_.length=0,_.mode=8;case 8:if(4096&_.flags){if(D===0)break e;for(ae=0;j=V[I+ae++],_.head&&j&&_.length<65536&&(_.head.comment+=String.fromCharCode(j)),j&&ae<D;);if(512&_.flags&&(_.check=l(_.check,V,ae,I)),D-=ae,I+=ae,j)break e}else _.head&&(_.head.comment=null);_.mode=9;case 9:if(512&_.flags){for(;G<16;){if(D===0)break e;D--,U+=V[I++]<<G,G+=8}if(U!==(65535&_.check)){E.msg="header crc mismatch",_.mode=30;break}G=U=0}_.head&&(_.head.hcrc=_.flags>>9&1,_.head.done=!0),E.adler=_.check=0,_.mode=12;break;case 10:for(;G<32;){if(D===0)break e;D--,U+=V[I++]<<G,G+=8}E.adler=_.check=v(U),G=U=0,_.mode=11;case 11:if(_.havedict===0)return E.next_out=q,E.avail_out=J,E.next_in=I,E.avail_in=D,_.hold=U,_.bits=G,2;E.adler=_.check=1,_.mode=12;case 12:if(B===5||B===6)break e;case 13:if(_.last){U>>>=7&G,G-=7&G,_.mode=27;break}for(;G<3;){if(D===0)break e;D--,U+=V[I++]<<G,G+=8}switch(_.last=1&U,G-=1,3&(U>>>=1)){case 0:_.mode=14;break;case 1:if(O(_),_.mode=20,B!==6)break;U>>>=2,G-=2;break e;case 2:_.mode=17;break;case 3:E.msg="invalid block type",_.mode=30}U>>>=2,G-=2;break;case 14:for(U>>>=7&G,G-=7&G;G<32;){if(D===0)break e;D--,U+=V[I++]<<G,G+=8}if((65535&U)!=(U>>>16^65535)){E.msg="invalid stored block lengths",_.mode=30;break}if(_.length=65535&U,G=U=0,_.mode=15,B===6)break e;case 15:_.mode=16;case 16:if(ae=_.length){if(D<ae&&(ae=D),J<ae&&(ae=J),ae===0)break e;o.arraySet(re,V,I,ae,q),D-=ae,I+=ae,J-=ae,q+=ae,_.length-=ae;break}_.mode=12;break;case 17:for(;G<14;){if(D===0)break e;D--,U+=V[I++]<<G,G+=8}if(_.nlen=257+(31&U),U>>>=5,G-=5,_.ndist=1+(31&U),U>>>=5,G-=5,_.ncode=4+(15&U),U>>>=4,G-=4,286<_.nlen||30<_.ndist){E.msg="too many length or distance symbols",_.mode=30;break}_.have=0,_.mode=18;case 18:for(;_.have<_.ncode;){for(;G<3;){if(D===0)break e;D--,U+=V[I++]<<G,G+=8}_.lens[X[_.have++]]=7&U,U>>>=3,G-=3}for(;_.have<19;)_.lens[X[_.have++]]=0;if(_.lencode=_.lendyn,_.lenbits=7,M={bits:_.lenbits},ie=d(0,_.lens,0,19,_.lencode,0,_.work,M),_.lenbits=M.bits,ie){E.msg="invalid code lengths set",_.mode=30;break}_.have=0,_.mode=19;case 19:for(;_.have<_.nlen+_.ndist;){for(;Ce=(P=_.lencode[U&(1<<_.lenbits)-1])>>>16&255,ue=65535&P,!((be=P>>>24)<=G);){if(D===0)break e;D--,U+=V[I++]<<G,G+=8}if(ue<16)U>>>=be,G-=be,_.lens[_.have++]=ue;else{if(ue===16){for(N=be+2;G<N;){if(D===0)break e;D--,U+=V[I++]<<G,G+=8}if(U>>>=be,G-=be,_.have===0){E.msg="invalid bit length repeat",_.mode=30;break}j=_.lens[_.have-1],ae=3+(3&U),U>>>=2,G-=2}else if(ue===17){for(N=be+3;G<N;){if(D===0)break e;D--,U+=V[I++]<<G,G+=8}G-=be,j=0,ae=3+(7&(U>>>=be)),U>>>=3,G-=3}else{for(N=be+7;G<N;){if(D===0)break e;D--,U+=V[I++]<<G,G+=8}G-=be,j=0,ae=11+(127&(U>>>=be)),U>>>=7,G-=7}if(_.have+ae>_.nlen+_.ndist){E.msg="invalid bit length repeat",_.mode=30;break}for(;ae--;)_.lens[_.have++]=j}}if(_.mode===30)break;if(_.lens[256]===0){E.msg="invalid code -- missing end-of-block",_.mode=30;break}if(_.lenbits=9,M={bits:_.lenbits},ie=d(h,_.lens,0,_.nlen,_.lencode,0,_.work,M),_.lenbits=M.bits,ie){E.msg="invalid literal/lengths set",_.mode=30;break}if(_.distbits=6,_.distcode=_.distdyn,M={bits:_.distbits},ie=d(f,_.lens,_.nlen,_.ndist,_.distcode,0,_.work,M),_.distbits=M.bits,ie){E.msg="invalid distances set",_.mode=30;break}if(_.mode=20,B===6)break e;case 20:_.mode=21;case 21:if(6<=D&&258<=J){E.next_out=q,E.avail_out=J,E.next_in=I,E.avail_in=D,_.hold=U,_.bits=G,c(E,oe),q=E.next_out,re=E.output,J=E.avail_out,I=E.next_in,V=E.input,D=E.avail_in,U=_.hold,G=_.bits,_.mode===12&&(_.back=-1);break}for(_.back=0;Ce=(P=_.lencode[U&(1<<_.lenbits)-1])>>>16&255,ue=65535&P,!((be=P>>>24)<=G);){if(D===0)break e;D--,U+=V[I++]<<G,G+=8}if(Ce&&!(240&Ce)){for(de=be,ze=Ce,Ge=ue;Ce=(P=_.lencode[Ge+((U&(1<<de+ze)-1)>>de)])>>>16&255,ue=65535&P,!(de+(be=P>>>24)<=G);){if(D===0)break e;D--,U+=V[I++]<<G,G+=8}U>>>=de,G-=de,_.back+=de}if(U>>>=be,G-=be,_.back+=be,_.length=ue,Ce===0){_.mode=26;break}if(32&Ce){_.back=-1,_.mode=12;break}if(64&Ce){E.msg="invalid literal/length code",_.mode=30;break}_.extra=15&Ce,_.mode=22;case 22:if(_.extra){for(N=_.extra;G<N;){if(D===0)break e;D--,U+=V[I++]<<G,G+=8}_.length+=U&(1<<_.extra)-1,U>>>=_.extra,G-=_.extra,_.back+=_.extra}_.was=_.length,_.mode=23;case 23:for(;Ce=(P=_.distcode[U&(1<<_.distbits)-1])>>>16&255,ue=65535&P,!((be=P>>>24)<=G);){if(D===0)break e;D--,U+=V[I++]<<G,G+=8}if(!(240&Ce)){for(de=be,ze=Ce,Ge=ue;Ce=(P=_.distcode[Ge+((U&(1<<de+ze)-1)>>de)])>>>16&255,ue=65535&P,!(de+(be=P>>>24)<=G);){if(D===0)break e;D--,U+=V[I++]<<G,G+=8}U>>>=de,G-=de,_.back+=de}if(U>>>=be,G-=be,_.back+=be,64&Ce){E.msg="invalid distance code",_.mode=30;break}_.offset=ue,_.extra=15&Ce,_.mode=24;case 24:if(_.extra){for(N=_.extra;G<N;){if(D===0)break e;D--,U+=V[I++]<<G,G+=8}_.offset+=U&(1<<_.extra)-1,U>>>=_.extra,G-=_.extra,_.back+=_.extra}if(_.offset>_.dmax){E.msg="invalid distance too far back",_.mode=30;break}_.mode=25;case 25:if(J===0)break e;if(ae=oe-J,_.offset>ae){if((ae=_.offset-ae)>_.whave&&_.sane){E.msg="invalid distance too far back",_.mode=30;break}le=ae>_.wnext?(ae-=_.wnext,_.wsize-ae):_.wnext-ae,ae>_.length&&(ae=_.length),ce=_.window}else ce=re,le=q-_.offset,ae=_.length;for(J<ae&&(ae=J),J-=ae,_.length-=ae;re[q++]=ce[le++],--ae;);_.length===0&&(_.mode=21);break;case 26:if(J===0)break e;re[q++]=_.length,J--,_.mode=21;break;case 27:if(_.wrap){for(;G<32;){if(D===0)break e;D--,U|=V[I++]<<G,G+=8}if(oe-=J,E.total_out+=oe,_.total+=oe,oe&&(E.adler=_.check=_.flags?l(_.check,re,oe,q-oe):s(_.check,re,oe,q-oe)),oe=J,(_.flags?U:v(U))!==_.check){E.msg="incorrect data check",_.mode=30;break}G=U=0}_.mode=28;case 28:if(_.wrap&&_.flags){for(;G<32;){if(D===0)break e;D--,U+=V[I++]<<G,G+=8}if(U!==(4294967295&_.total)){E.msg="incorrect length check",_.mode=30;break}G=U=0}_.mode=29;case 29:ie=1;break e;case 30:ie=-3;break e;case 31:return-4;case 32:default:return p}return E.next_out=q,E.avail_out=J,E.next_in=I,E.avail_in=D,_.hold=U,_.bits=G,(_.wsize||oe!==E.avail_out&&_.mode<30&&(_.mode<27||B!==4))&&Y(E,E.output,E.next_out,oe-E.avail_out)?(_.mode=31,-4):(fe-=E.avail_in,oe-=E.avail_out,E.total_in+=fe,E.total_out+=oe,_.total+=oe,_.wrap&&oe&&(E.adler=_.check=_.flags?l(_.check,re,oe,E.next_out-oe):s(_.check,re,oe,E.next_out-oe)),E.data_type=_.bits+(_.last?64:0)+(_.mode===12?128:0)+(_.mode===20||_.mode===15?256:0),(fe==0&&oe===0||B===4)&&ie===u&&(ie=-5),ie)},i.inflateEnd=function(E){if(!E||!E.state)return p;var B=E.state;return B.window&&(B.window=null),E.state=null,u},i.inflateGetHeader=function(E,B){var _;return E&&E.state&&2&(_=E.state).wrap?((_.head=B).done=!1,u):p},i.inflateSetDictionary=function(E,B){var _,V=B.length;return E&&E.state?(_=E.state).wrap!==0&&_.mode!==11?p:_.mode===11&&s(1,B,V,0)!==_.check?-3:Y(E,B,V,V)?(_.mode=31,-4):(_.havedict=1,u):p},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(r,n,i){var o=r("../utils/common"),s=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],d=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(h,f,u,p,g,m,x,v){var y,b,w,k,S,C,T,R,O,Y=v.bits,E=0,B=0,_=0,V=0,re=0,I=0,q=0,D=0,J=0,U=0,G=null,fe=0,oe=new o.Buf16(16),ae=new o.Buf16(16),le=null,ce=0;for(E=0;E<=15;E++)oe[E]=0;for(B=0;B<p;B++)oe[f[u+B]]++;for(re=Y,V=15;1<=V&&oe[V]===0;V--);if(V<re&&(re=V),V===0)return g[m++]=20971520,g[m++]=20971520,v.bits=1,0;for(_=1;_<V&&oe[_]===0;_++);for(re<_&&(re=_),E=D=1;E<=15;E++)if(D<<=1,(D-=oe[E])<0)return-1;if(0<D&&(h===0||V!==1))return-1;for(ae[1]=0,E=1;E<15;E++)ae[E+1]=ae[E]+oe[E];for(B=0;B<p;B++)f[u+B]!==0&&(x[ae[f[u+B]]++]=B);if(C=h===0?(G=le=x,19):h===1?(G=s,fe-=257,le=l,ce-=257,256):(G=c,le=d,-1),E=_,S=m,q=B=U=0,w=-1,k=(J=1<<(I=re))-1,h===1&&852<J||h===2&&592<J)return 1;for(;;){for(T=E-q,O=x[B]<C?(R=0,x[B]):x[B]>C?(R=le[ce+x[B]],G[fe+x[B]]):(R=96,0),y=1<<E-q,_=b=1<<I;g[S+(U>>q)+(b-=y)]=T<<24|R<<16|O|0,b!==0;);for(y=1<<E-1;U&y;)y>>=1;if(y!==0?(U&=y-1,U+=y):U=0,B++,--oe[E]==0){if(E===V)break;E=f[u+x[B]]}if(re<E&&(U&k)!==w){for(q===0&&(q=re),S+=_,D=1<<(I=E-q);I+q<V&&!((D-=oe[I+q])<=0);)I++,D<<=1;if(J+=1<<I,h===1&&852<J||h===2&&592<J)return 1;g[w=U&k]=re<<24|I<<16|S-m|0}}return U!==0&&(g[S+U]=E-q<<24|64<<16|0),v.bits=re,0}},{"../utils/common":41}],51:[function(r,n,i){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(r,n,i){var o=r("../utils/common"),s=0,l=1;function c(P){for(var F=P.length;0<=--F;)P[F]=0}var d=0,h=29,f=256,u=f+1+h,p=30,g=19,m=2*u+1,x=15,v=16,y=7,b=256,w=16,k=17,S=18,C=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],T=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],R=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Y=new Array(2*(u+2));c(Y);var E=new Array(2*p);c(E);var B=new Array(512);c(B);var _=new Array(256);c(_);var V=new Array(h);c(V);var re,I,q,D=new Array(p);function J(P,F,X,K,L){this.static_tree=P,this.extra_bits=F,this.extra_base=X,this.elems=K,this.max_length=L,this.has_stree=P&&P.length}function U(P,F){this.dyn_tree=P,this.max_code=0,this.stat_desc=F}function G(P){return P<256?B[P]:B[256+(P>>>7)]}function fe(P,F){P.pending_buf[P.pending++]=255&F,P.pending_buf[P.pending++]=F>>>8&255}function oe(P,F,X){P.bi_valid>v-X?(P.bi_buf|=F<<P.bi_valid&65535,fe(P,P.bi_buf),P.bi_buf=F>>v-P.bi_valid,P.bi_valid+=X-v):(P.bi_buf|=F<<P.bi_valid&65535,P.bi_valid+=X)}function ae(P,F,X){oe(P,X[2*F],X[2*F+1])}function le(P,F){for(var X=0;X|=1&P,P>>>=1,X<<=1,0<--F;);return X>>>1}function ce(P,F,X){var K,L,H=new Array(x+1),Z=0;for(K=1;K<=x;K++)H[K]=Z=Z+X[K-1]<<1;for(L=0;L<=F;L++){var ee=P[2*L+1];ee!==0&&(P[2*L]=le(H[ee]++,ee))}}function be(P){var F;for(F=0;F<u;F++)P.dyn_ltree[2*F]=0;for(F=0;F<p;F++)P.dyn_dtree[2*F]=0;for(F=0;F<g;F++)P.bl_tree[2*F]=0;P.dyn_ltree[2*b]=1,P.opt_len=P.static_len=0,P.last_lit=P.matches=0}function Ce(P){8<P.bi_valid?fe(P,P.bi_buf):0<P.bi_valid&&(P.pending_buf[P.pending++]=P.bi_buf),P.bi_buf=0,P.bi_valid=0}function ue(P,F,X,K){var L=2*F,H=2*X;return P[L]<P[H]||P[L]===P[H]&&K[F]<=K[X]}function de(P,F,X){for(var K=P.heap[X],L=X<<1;L<=P.heap_len&&(L<P.heap_len&&ue(F,P.heap[L+1],P.heap[L],P.depth)&&L++,!ue(F,K,P.heap[L],P.depth));)P.heap[X]=P.heap[L],X=L,L<<=1;P.heap[X]=K}function ze(P,F,X){var K,L,H,Z,ee=0;if(P.last_lit!==0)for(;K=P.pending_buf[P.d_buf+2*ee]<<8|P.pending_buf[P.d_buf+2*ee+1],L=P.pending_buf[P.l_buf+ee],ee++,K===0?ae(P,L,F):(ae(P,(H=_[L])+f+1,F),(Z=C[H])!==0&&oe(P,L-=V[H],Z),ae(P,H=G(--K),X),(Z=T[H])!==0&&oe(P,K-=D[H],Z)),ee<P.last_lit;);ae(P,b,F)}function Ge(P,F){var X,K,L,H=F.dyn_tree,Z=F.stat_desc.static_tree,ee=F.stat_desc.has_stree,z=F.stat_desc.elems,Q=-1;for(P.heap_len=0,P.heap_max=m,X=0;X<z;X++)H[2*X]!==0?(P.heap[++P.heap_len]=Q=X,P.depth[X]=0):H[2*X+1]=0;for(;P.heap_len<2;)H[2*(L=P.heap[++P.heap_len]=Q<2?++Q:0)]=1,P.depth[L]=0,P.opt_len--,ee&&(P.static_len-=Z[2*L+1]);for(F.max_code=Q,X=P.heap_len>>1;1<=X;X--)de(P,H,X);for(L=z;X=P.heap[1],P.heap[1]=P.heap[P.heap_len--],de(P,H,1),K=P.heap[1],P.heap[--P.heap_max]=X,P.heap[--P.heap_max]=K,H[2*L]=H[2*X]+H[2*K],P.depth[L]=(P.depth[X]>=P.depth[K]?P.depth[X]:P.depth[K])+1,H[2*X+1]=H[2*K+1]=L,P.heap[1]=L++,de(P,H,1),2<=P.heap_len;);P.heap[--P.heap_max]=P.heap[1],function(ne,ge){var Se,we,ke,_e,Te,We,Ue=ge.dyn_tree,Je=ge.max_code,Fe=ge.stat_desc.static_tree,je=ge.stat_desc.has_stree,Be=ge.stat_desc.extra_bits,Ve=ge.stat_desc.extra_base,qe=ge.stat_desc.max_length,ft=0;for(_e=0;_e<=x;_e++)ne.bl_count[_e]=0;for(Ue[2*ne.heap[ne.heap_max]+1]=0,Se=ne.heap_max+1;Se<m;Se++)qe<(_e=Ue[2*Ue[2*(we=ne.heap[Se])+1]+1]+1)&&(_e=qe,ft++),Ue[2*we+1]=_e,Je<we||(ne.bl_count[_e]++,Te=0,Ve<=we&&(Te=Be[we-Ve]),We=Ue[2*we],ne.opt_len+=We*(_e+Te),je&&(ne.static_len+=We*(Fe[2*we+1]+Te)));if(ft!==0){do{for(_e=qe-1;ne.bl_count[_e]===0;)_e--;ne.bl_count[_e]--,ne.bl_count[_e+1]+=2,ne.bl_count[qe]--,ft-=2}while(0<ft);for(_e=qe;_e!==0;_e--)for(we=ne.bl_count[_e];we!==0;)Je<(ke=ne.heap[--Se])||(Ue[2*ke+1]!==_e&&(ne.opt_len+=(_e-Ue[2*ke+1])*Ue[2*ke],Ue[2*ke+1]=_e),we--)}}(P,F),ce(H,Q,P.bl_count)}function j(P,F,X){var K,L,H=-1,Z=F[1],ee=0,z=7,Q=4;for(Z===0&&(z=138,Q=3),F[2*(X+1)+1]=65535,K=0;K<=X;K++)L=Z,Z=F[2*(K+1)+1],++ee<z&&L===Z||(ee<Q?P.bl_tree[2*L]+=ee:L!==0?(L!==H&&P.bl_tree[2*L]++,P.bl_tree[2*w]++):ee<=10?P.bl_tree[2*k]++:P.bl_tree[2*S]++,H=L,Q=(ee=0)===Z?(z=138,3):L===Z?(z=6,3):(z=7,4))}function ie(P,F,X){var K,L,H=-1,Z=F[1],ee=0,z=7,Q=4;for(Z===0&&(z=138,Q=3),K=0;K<=X;K++)if(L=Z,Z=F[2*(K+1)+1],!(++ee<z&&L===Z)){if(ee<Q)for(;ae(P,L,P.bl_tree),--ee!=0;);else L!==0?(L!==H&&(ae(P,L,P.bl_tree),ee--),ae(P,w,P.bl_tree),oe(P,ee-3,2)):ee<=10?(ae(P,k,P.bl_tree),oe(P,ee-3,3)):(ae(P,S,P.bl_tree),oe(P,ee-11,7));H=L,Q=(ee=0)===Z?(z=138,3):L===Z?(z=6,3):(z=7,4)}}c(D);var M=!1;function N(P,F,X,K){oe(P,(d<<1)+(K?1:0),3),function(L,H,Z,ee){Ce(L),fe(L,Z),fe(L,~Z),o.arraySet(L.pending_buf,L.window,H,Z,L.pending),L.pending+=Z}(P,F,X)}i._tr_init=function(P){M||(function(){var F,X,K,L,H,Z=new Array(x+1);for(L=K=0;L<h-1;L++)for(V[L]=K,F=0;F<1<<C[L];F++)_[K++]=L;for(_[K-1]=L,L=H=0;L<16;L++)for(D[L]=H,F=0;F<1<<T[L];F++)B[H++]=L;for(H>>=7;L<p;L++)for(D[L]=H<<7,F=0;F<1<<T[L]-7;F++)B[256+H++]=L;for(X=0;X<=x;X++)Z[X]=0;for(F=0;F<=143;)Y[2*F+1]=8,F++,Z[8]++;for(;F<=255;)Y[2*F+1]=9,F++,Z[9]++;for(;F<=279;)Y[2*F+1]=7,F++,Z[7]++;for(;F<=287;)Y[2*F+1]=8,F++,Z[8]++;for(ce(Y,u+1,Z),F=0;F<p;F++)E[2*F+1]=5,E[2*F]=le(F,5);re=new J(Y,C,f+1,u,x),I=new J(E,T,0,p,x),q=new J(new Array(0),R,0,g,y)}(),M=!0),P.l_desc=new U(P.dyn_ltree,re),P.d_desc=new U(P.dyn_dtree,I),P.bl_desc=new U(P.bl_tree,q),P.bi_buf=0,P.bi_valid=0,be(P)},i._tr_stored_block=N,i._tr_flush_block=function(P,F,X,K){var L,H,Z=0;0<P.level?(P.strm.data_type===2&&(P.strm.data_type=function(ee){var z,Q=4093624447;for(z=0;z<=31;z++,Q>>>=1)if(1&Q&&ee.dyn_ltree[2*z]!==0)return s;if(ee.dyn_ltree[18]!==0||ee.dyn_ltree[20]!==0||ee.dyn_ltree[26]!==0)return l;for(z=32;z<f;z++)if(ee.dyn_ltree[2*z]!==0)return l;return s}(P)),Ge(P,P.l_desc),Ge(P,P.d_desc),Z=function(ee){var z;for(j(ee,ee.dyn_ltree,ee.l_desc.max_code),j(ee,ee.dyn_dtree,ee.d_desc.max_code),Ge(ee,ee.bl_desc),z=g-1;3<=z&&ee.bl_tree[2*O[z]+1]===0;z--);return ee.opt_len+=3*(z+1)+5+5+4,z}(P),L=P.opt_len+3+7>>>3,(H=P.static_len+3+7>>>3)<=L&&(L=H)):L=H=X+5,X+4<=L&&F!==-1?N(P,F,X,K):P.strategy===4||H===L?(oe(P,2+(K?1:0),3),ze(P,Y,E)):(oe(P,4+(K?1:0),3),function(ee,z,Q,ne){var ge;for(oe(ee,z-257,5),oe(ee,Q-1,5),oe(ee,ne-4,4),ge=0;ge<ne;ge++)oe(ee,ee.bl_tree[2*O[ge]+1],3);ie(ee,ee.dyn_ltree,z-1),ie(ee,ee.dyn_dtree,Q-1)}(P,P.l_desc.max_code+1,P.d_desc.max_code+1,Z+1),ze(P,P.dyn_ltree,P.dyn_dtree)),be(P),K&&Ce(P)},i._tr_tally=function(P,F,X){return P.pending_buf[P.d_buf+2*P.last_lit]=F>>>8&255,P.pending_buf[P.d_buf+2*P.last_lit+1]=255&F,P.pending_buf[P.l_buf+P.last_lit]=255&X,P.last_lit++,F===0?P.dyn_ltree[2*X]++:(P.matches++,F--,P.dyn_ltree[2*(_[X]+f+1)]++,P.dyn_dtree[2*G(F)]++),P.last_lit===P.lit_bufsize-1},i._tr_align=function(P){oe(P,2,3),ae(P,b,Y),function(F){F.bi_valid===16?(fe(F,F.bi_buf),F.bi_buf=0,F.bi_valid=0):8<=F.bi_valid&&(F.pending_buf[F.pending++]=255&F.bi_buf,F.bi_buf>>=8,F.bi_valid-=8)}(P)}},{"../utils/common":41}],53:[function(r,n,i){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(r,n,i){(function(o){(function(s,l){if(!s.setImmediate){var c,d,h,f,u=1,p={},g=!1,m=s.document,x=Object.getPrototypeOf&&Object.getPrototypeOf(s);x=x&&x.setTimeout?x:s,c={}.toString.call(s.process)==="[object process]"?function(w){process.nextTick(function(){y(w)})}:function(){if(s.postMessage&&!s.importScripts){var w=!0,k=s.onmessage;return s.onmessage=function(){w=!1},s.postMessage("","*"),s.onmessage=k,w}}()?(f="setImmediate$"+Math.random()+"$",s.addEventListener?s.addEventListener("message",b,!1):s.attachEvent("onmessage",b),function(w){s.postMessage(f+w,"*")}):s.MessageChannel?((h=new MessageChannel).port1.onmessage=function(w){y(w.data)},function(w){h.port2.postMessage(w)}):m&&"onreadystatechange"in m.createElement("script")?(d=m.documentElement,function(w){var k=m.createElement("script");k.onreadystatechange=function(){y(w),k.onreadystatechange=null,d.removeChild(k),k=null},d.appendChild(k)}):function(w){setTimeout(y,0,w)},x.setImmediate=function(w){typeof w!="function"&&(w=new Function(""+w));for(var k=new Array(arguments.length-1),S=0;S<k.length;S++)k[S]=arguments[S+1];var C={callback:w,args:k};return p[u]=C,c(u),u++},x.clearImmediate=v}function v(w){delete p[w]}function y(w){if(g)setTimeout(y,0,w);else{var k=p[w];if(k){g=!0;try{(function(S){var C=S.callback,T=S.args;switch(T.length){case 0:C();break;case 1:C(T[0]);break;case 2:C(T[0],T[1]);break;case 3:C(T[0],T[1],T[2]);break;default:C.apply(l,T)}})(k)}finally{v(w),g=!1}}}}function b(w){w.source===s&&typeof w.data=="string"&&w.data.indexOf(f)===0&&y(+w.data.slice(f.length))}})(typeof self>"u"?o===void 0?this:o:self)}).call(this,typeof Gn<"u"?Gn:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(Aw);var bE=Aw.exports;const wE=Xc(bE);function _E(t){let e="",r=t;for(;r>=0;)e=String.fromCharCode(r%26+65)+e,r=Math.floor(r/26)-1;return e}function SE(t,e){return`${_E(t)}${e+1}`}async function Mw(t,e,r="design"){const i=Math.ceil(e.width/1e3),o=Math.ceil(e.length/1e3);console.log(`[SLICER] Creating ${i}${o} grid (${i*o} tiles) for ${e.width}mm  ${e.length}mm design`);const c=new DOMParser().parseFromString(t,"image/svg+xml").querySelector("svg");if(!c)throw new Error("Invalid SVG content");const d=c.getAttribute("viewBox");let h,f;if(d){const C=d.split(/\s+/).map(Number);h=C[2],f=C[3]}else h=parseFloat(c.getAttribute("width"))||1024,f=parseFloat(c.getAttribute("height"))||1024;console.log(`[SLICER] SVG internal dimensions: ${h}  ${f}`);const u=h/e.width,p=f/e.length,g=1e3*u,m=1e3*p;console.log(`[SLICER] Tile size in SVG units: ${g}  ${m}`);const x=c.innerHTML,v=c.getAttribute("xmlns")||"http://www.w3.org/2000/svg",y=new wE,b=y.folder("tiles"),w=[];for(let C=0;C<o;C++){const T=[];for(let R=0;R<i;R++){const O=SE(R,C);T.push(O);const Y=R*g,E=C*m,B=`${Y} ${E} ${g} ${m}`,_=`<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="${v}" viewBox="${B}" width="1000mm" height="1000mm">
  <defs>
    <clipPath id="tile-clip">
      <rect x="${Y}" y="${E}" width="${g}" height="${m}"/>
    </clipPath>
  </defs>
  <g clip-path="url(#tile-clip)">
${x}
  </g>
</svg>`,V=`${$w(r)}_${O}.svg`;b.file(V,_)}w.push(T)}const k=kE(w,e,r);y.file("layout-guide.txt",k);const S=await y.generateAsync({type:"blob"});return console.log(`[SLICER] Created ZIP with ${i*o} tiles`),S}function kE(t,e,r){const n=t.length,i=t[0].length;let o=`TPV Studio - Tile Layout Guide
================================

Design: ${r}
Total Size: ${e.width}mm  ${e.length}mm (${e.width/1e3}m  ${e.length/1e3}m)
Tile Size: 1000mm  1000mm (1m  1m)
Grid: ${i} columns  ${n} rows (${i*n} tiles)

Layout (view from above):
-------------------------

`;const s=6;o+=""+("".repeat(s)+"").repeat(i-1)+"".repeat(s)+`
`;for(let l=0;l<n;l++){o+="";for(let c=0;c<i;c++){const d=t[l][c],h=s-d.length,f=Math.floor(h/2),u=h-f;o+=" ".repeat(f)+d+" ".repeat(u)+""}o+=`
`,l<n-1?o+=""+("".repeat(s)+"").repeat(i-1)+"".repeat(s)+`
`:o+=""+("".repeat(s)+"").repeat(i-1)+"".repeat(s)+`
`}return o+=`
Installation Notes:
-------------------
- Each tile is exactly 1m  1m
- Tiles are named by column (A-Z) and row (1-${n})
- Start from top-left corner (A1) when laying out
- Tiles align perfectly when placed edge-to-edge
- Edge tiles may contain partial content if design isn't exactly divisible by 1m

Generated by TPV Studio
`,o}function $w(t){return t.replace(/[<>:"/\\|?*]/g,"_").replace(/\s+/g,"-").substring(0,50)}function Iw(t,e){const r=URL.createObjectURL(t),n=document.createElement("a");n.href=r,n.download=e,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(r)}async function jE(t,e,r="design"){try{const n=await fetch(t);if(!n.ok)throw new Error(`Failed to fetch SVG: ${n.statusText}`);const i=await n.text(),o=await Mw(i,e,r),s=`${$w(r)}-tiles-1mx1m.zip`;return Iw(o,s),console.log(`[SLICER] Downloaded ${s}`),!0}catch(n){throw console.error("[SLICER] Failed to download tiles:",n),n}}async function CE(t){const e=Object.values(t||{});return e.length===0?[]:(await Promise.all(e.map(async n=>{try{const i=await Wa(n.sourceDesignId),o=(i==null?void 0:i.design)||i;if(!o)return console.warn(`[EXPORT] Could not fetch design for motif ${n.id}`),null;console.log("[EXPORT] Loaded design for motif:",o.name),console.log("[EXPORT] Design has solid_recipes:",!!o.solid_recipes),console.log("[EXPORT] Design has blend_recipes:",!!o.blend_recipes);const s=n.scale||1,l=n.originalWidth_mm*s/1e3,c=n.originalHeight_mm*s/1e3,d=l*c,h=n.viewMode||"solid",f=h==="blend"?o.blend_recipes:o.solid_recipes;return console.log(`[EXPORT] Using ${h} recipes:`,(f==null?void 0:f.length)||0,"recipes"),{id:n.id,name:n.customName||n.sourceDesignName||o.name||"Motif",areaM2:d,viewMode:h,widthM:l,heightM:c,recipes:f||[]}}catch(i){return console.error(`[EXPORT] Error processing motif ${n.id}:`,i),null}}))).filter(Boolean)}function EE({svgRef:t}){const[e,r]=A.useState(!1),[n,i]=A.useState(null),o=A.useRef(null),s=Qe(m=>m.exportDesignData),l=Qe(m=>m.surface),c=Qe(m=>m.designName),d=Qe(m=>m.motifs);A.useEffect(()=>{const m=x=>{o.current&&!o.current.contains(x.target)&&r(!1)};return e&&document.addEventListener("mousedown",m),()=>{document.removeEventListener("mousedown",m)}},[e]);const h=()=>t!=null&&t.current?t.current:document.querySelector(".court-canvas__svg"),f=async()=>{i("svg");try{const m=h();if(!m)throw new Error("Canvas not found");const x=s(),v=mp(m,x),y=_u(x.name,"svg");yE(v,y)}catch(m){console.error("SVG export failed:",m),alert("Failed to export SVG: "+m.message)}finally{i(null),r(!1)}},u=async()=>{i("png");try{const m=h();if(!m)throw new Error("Canvas not found");const x=s(),v=_u(x.name,"png");await xE(m,x,v,2)}catch(m){console.error("PNG export failed:",m),alert("Failed to export PNG: "+m.message)}finally{i(null),r(!1)}},p=async()=>{i("pdf"),r(!1);try{const m=h();if(!m)throw new Error("Canvas not found");const x=await Qr.getSession();if(!(x!=null&&x.access_token))throw new Error("Authentication required for PDF export");const v=s(),y=v.name||"TPV Design",b=m.cloneNode(!0);b.querySelectorAll('[class*="selected"], .transform-handles, .track-resize-handles, .court-canvas__selection-outline, [class*="selection"], [class*="handle"], [stroke-dasharray]').forEach(O=>O.remove()),b.setAttribute("xmlns","http://www.w3.org/2000/svg"),b.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");const w=new XMLSerializer().serializeToString(b);console.log("[EXPORT] Generating PDF report via API...");const k=await CE(d);console.log("[EXPORT] Motifs for PDF:",k.length);const S=await fetch("/api/export-sports-pdf",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${x.access_token}`},body:JSON.stringify({svgString:w,designName:y,surface:v.surface,courts:v.courts,tracks:v.tracks,motifs:k,dimensions:{widthMM:v.surface.width_mm,lengthMM:v.surface.length_mm}})});if(!S.ok){const O=await S.json().catch(()=>({error:"Unknown error"}));throw new Error(O.error||`Server error: ${S.status}`)}const C=await S.blob(),T=_u(y,"pdf"),R=document.createElement("a");R.href=URL.createObjectURL(C),R.download=T,document.body.appendChild(R),R.click(),document.body.removeChild(R),URL.revokeObjectURL(R.href),console.log("[EXPORT] PDF downloaded:",T)}catch(m){console.error("PDF export failed:",m),alert("Failed to export PDF: "+m.message)}finally{i(null)}},g=async()=>{i("tiles"),r(!1);try{const m=h();if(!m)throw new Error("Canvas not found");const v=new XMLSerializer().serializeToString(m),y={width:l.width_mm,length:l.length_mm},b=c||"sports-surface",w=await Mw(v,y,b),k=`${b.replace(/[^a-zA-Z0-9-_]/g,"-")}-tiles-1mx1m.zip`;Iw(w,k),console.log("[EXPORT] Tiles ZIP downloaded:",k)}catch(m){console.error("Tiles export failed:",m),alert("Failed to export tiles: "+m.message)}finally{i(null)}};return a.jsxs("div",{className:"export-menu",ref:o,children:[a.jsxs("button",{className:"sports-toolbar__btn-export",onClick:()=>r(!e),title:"Export Design",children:["Export",a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:e?"M18 15l-6-6-6 6":"M6 9l6 6 6-6"})})]}),e&&a.jsxs("div",{className:"export-menu__dropdown",children:[a.jsxs("button",{className:"export-menu__item",onClick:f,disabled:n!==null,children:[a.jsx("span",{className:"export-menu__icon",children:""}),a.jsxs("div",{className:"export-menu__item-content",children:[a.jsx("span",{className:"export-menu__item-title",children:n==="svg"?"Exporting...":"Download SVG"}),a.jsx("span",{className:"export-menu__item-desc",children:"Vector format for CAD/printing"})]})]}),a.jsxs("button",{className:"export-menu__item",onClick:u,disabled:n!==null,children:[a.jsx("span",{className:"export-menu__icon",children:""}),a.jsxs("div",{className:"export-menu__item-content",children:[a.jsx("span",{className:"export-menu__item-title",children:n==="png"?"Exporting...":"Download PNG"}),a.jsx("span",{className:"export-menu__item-desc",children:"High-res image for presentations"})]})]}),a.jsxs("button",{className:"export-menu__item",onClick:g,disabled:n!==null,children:[a.jsx("span",{className:"export-menu__icon",children:""}),a.jsxs("div",{className:"export-menu__item-content",children:[a.jsx("span",{className:"export-menu__item-title",children:n==="tiles"?"Generating...":"Download Tiles ZIP"}),a.jsx("span",{className:"export-menu__item-desc",children:"1m1m SVG tiles for large-format printing"})]})]}),a.jsx("div",{className:"export-menu__divider"}),a.jsxs("button",{className:"export-menu__item",onClick:p,disabled:n!==null,children:[a.jsx("span",{className:"export-menu__icon",children:""}),a.jsxs("div",{className:"export-menu__item-content",children:[a.jsx("span",{className:"export-menu__item-title",children:n==="pdf"?"Generating...":"Materials Report (PDF)"}),a.jsx("span",{className:"export-menu__item-desc",children:"TPV quantities & specifications"})]})]})]})]})}function TE({isOpen:t,onClose:e}){if(!t)return null;const r=[{category:"Selection",items:[{keys:["Delete"],description:"Remove selected element"},{keys:["Escape"],description:"Deselect element"}]},{category:"Edit",items:[{keys:["Ctrl","Z"],description:"Undo"},{keys:["Ctrl","Shift","Z"],description:"Redo"},{keys:["Ctrl","D"],description:"Duplicate selected"}]},{category:"Move",items:[{keys:["Arrow Keys"],description:"Nudge element (10mm)"},{keys:["Shift","Arrow Keys"],description:"Large nudge (100mm)"}]},{category:"Layers",items:[{keys:["["],description:"Send backward"},{keys:["]"],description:"Bring forward"}]},{category:"View",items:[{keys:["G"],description:"Toggle snap to grid"},{keys:["?"],description:"Show this help"}]}],i=navigator.platform.toUpperCase().indexOf("MAC")>=0?"":"Ctrl";return a.jsx("div",{className:"keyboard-shortcuts-overlay",onClick:e,style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},children:a.jsxs("div",{className:"keyboard-shortcuts-modal",onClick:o=>o.stopPropagation(),style:{background:"#fff",borderRadius:"8px",padding:"24px",maxWidth:"480px",width:"90%",maxHeight:"80vh",overflow:"auto",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.2)"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[a.jsx("h2",{style:{margin:0,fontSize:"1.25rem",fontWeight:600},children:"Keyboard Shortcuts"}),a.jsx("button",{onClick:e,style:{background:"none",border:"none",fontSize:"1.5rem",cursor:"pointer",padding:"4px 8px",color:"#666"},"aria-label":"Close",children:""})]}),r.map(o=>a.jsxs("div",{style:{marginBottom:"20px"},children:[a.jsx("h3",{style:{fontSize:"0.75rem",fontWeight:600,textTransform:"uppercase",color:"#666",marginBottom:"8px",letterSpacing:"0.5px"},children:o.category}),a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:o.items.map((s,l)=>a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 0"},children:[a.jsx("span",{style:{color:"#333",fontSize:"0.9rem"},children:s.description}),a.jsx("div",{style:{display:"flex",gap:"4px"},children:s.keys.map((c,d)=>a.jsx("kbd",{style:{display:"inline-block",padding:"4px 8px",fontSize:"0.75rem",fontFamily:"system-ui, -apple-system, sans-serif",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:"4px",boxShadow:"0 1px 2px rgba(0,0,0,0.1)",minWidth:"24px",textAlign:"center"},children:c==="Ctrl"?i:c},d))})]},l))})]},o.category)),a.jsxs("p",{style:{fontSize:"0.8rem",color:"#888",marginTop:"16px",paddingTop:"16px",borderTop:"1px solid #eee",marginBottom:0},children:["Press ",a.jsx("kbd",{style:{padding:"2px 6px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:"3px",fontSize:"0.75rem"},children:"?"})," at any time to show this help"]})]})})}class RE{async _getAuthHeaders(){const e=await Qr.getSession(),r={"Content-Type":"application/json"};return e!=null&&e.access_token&&(r.Authorization=`Bearer ${e.access_token}`),r}async generateRecraft(e){const r={prompt:e.prompt,width_mm:e.widthMM||5e3,length_mm:e.lengthMM||5e3,max_colours:e.maxColours||6,seed:e.seed||null},n=await this._getAuthHeaders(),i=await fetch("/api/recraft-generate",{method:"POST",headers:n,body:JSON.stringify(r)});if(!i.ok){const o=await i.json();throw new Error(o.error||"Recraft generation failed")}return i.json()}async vectorizeImage(e){const r={image_url:e.image_url,width_mm:e.width_mm||5e3,length_mm:e.length_mm||5e3,seed:e.seed||null},n=await this._getAuthHeaders(),i=await fetch("/api/recraft-vectorize",{method:"POST",headers:n,body:JSON.stringify(r)});if(!i.ok){const o=await i.json();throw new Error(o.error||"Vectorization failed")}return i.json()}async processUploadedSVG(e){const r={svg_url:e.svg_url,width_mm:e.width_mm||5e3,length_mm:e.length_mm||5e3},n=await this._getAuthHeaders(),i=await fetch("/api/process-uploaded-svg",{method:"POST",headers:n,body:JSON.stringify(r)});if(!i.ok){const o=await i.json();throw new Error(o.error||"SVG processing failed")}return i.json()}async getRecraftStatus(e){const r=await this._getAuthHeaders(),n=await fetch(`/api/studio-job-status?jobId=${e}`,{headers:r});if(!n.ok){const i=await n.json();throw new Error(i.error||"Status fetch failed")}return n.json()}async waitForRecraftCompletion(e,r=null,n=2e3){return new Promise((i,o)=>{const s=async()=>{var l,c,d,h;try{const f=await this.getRecraftStatus(e);r&&r(f),f.status==="completed"?((l=f.result)==null?void 0:l.svg_url)?(console.log("[API] Recraft job complete with SVG output"),i(f)):(console.error("[API] Recraft job completed but no SVG output"),o(new Error("Job completed but no output received"))):f.status==="failed"?(c=f.result)!=null&&c.svg_url?(console.warn("[API] Job failed compliance but has output (non-compliant)"),i(f)):o(new Error(f.error||"Job failed")):(f.status==="retrying"&&console.log(`[API] Retrying: ${(d=f.recraft)==null?void 0:d.attempt_current}/${(h=f.recraft)==null?void 0:h.attempt_max}`),setTimeout(s,n))}catch(f){o(f)}};s()})}async matchColor(e,r=2){const n=await fetch("/api/match-color",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({hex:e,max_components:r})});if(!n.ok){const i=await n.json();throw new Error(i.error||"Color matching failed")}return n.json()}async generateDesignName(e){const r={prompt:e.prompt,colors:e.colors||[],dimensions:e.dimensions||{}},n=await this._getAuthHeaders(),i=await fetch("/api/generate-design-name",{method:"POST",headers:n,body:JSON.stringify(r)});if(!i.ok){const o=await i.json();throw new Error(o.error||"Name generation failed")}return i.json()}async inspireSimpleCreateJob(e){const r={prompt:e.prompt,surface:{width_mm:e.lengthMM||5e3,height_mm:e.widthMM||5e3},max_colours:e.maxColours||6,try_simpler:e.trySimpler||!1};e.seed&&(r.seed=e.seed);const n=await fetch("/api/studio-inspire-simple",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!n.ok){const i=await n.json();throw new Error(i.message||"Unable to start design generation. Please check your connection and try again.")}return n.json()}async inspireSimpleGetStatus(e){const r=await this._getAuthHeaders(),n=await fetch(`/api/studio-job-status?jobId=${e}`,{headers:r});if(!n.ok){const i=await n.json();throw new Error(i.message||"Unable to check generation status. Please try again.")}return n.json()}async inspireSimpleWaitForCompletion(e,r=null,n=2e3){return new Promise((i,o)=>{const s=async()=>{var l;try{const c=await this.inspireSimpleGetStatus(e);r&&r(c),c.status==="completed"?((l=c.result)==null?void 0:l.final_url)?(console.log("[API] Job complete with JPG output, resolving"),i(c)):(console.log("[API] Job completed but no output received"),o(new Error("Job completed but no output received"))):c.status==="failed"?o(new Error(c.error||"Job failed")):setTimeout(s,n)}catch(c){o(c)}};s()})}async draftify(e){const r=await fetch(Yg.DRAFTIFY,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!r.ok){const n=await r.json();throw new Error(n.message||"Unable to convert image to vector format. Please try a different image.")}return r.json()}async generateGeometric(e){const r={brief:e.prompt||e.brief,canvas:{width_mm:e.lengthMM||5e3,height_mm:e.widthMM||5e3},options:{mood:e.mood||"playful",composition:e.composition||"mixed",colorCount:e.maxColours||e.colorCount||5,seed:e.seed},validate:!0},n=await fetch(Yg.GEOMETRIC_GENERATE,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!n.ok){const i=await n.json();throw new Error(i.message||"Unable to generate design. Please try a different prompt or settings.")}return n.json()}}const Si=new RE;function NE({recipes:t,onClose:e}){return!t||t.length===0?a.jsxs("div",{className:"blend-recipes-empty",children:[a.jsx("p",{children:"No colours extracted from design."}),a.jsx("button",{onClick:e,className:"close-button",children:"Close"})]}):a.jsxs("div",{className:"blend-recipes-display",children:[a.jsxs("div",{className:"recipes-header",children:[a.jsx("h3",{children:"TPV Blend Recipes"}),a.jsx("button",{onClick:e,className:"close-button-icon",children:""})]}),a.jsx("div",{className:"recipes-grid",children:t.map((r,n)=>{const i=r.chosenRecipe;return a.jsxs("div",{className:"recipe-card",children:[a.jsxs("div",{className:"card-top",children:[a.jsx("div",{className:"swatch-section",children:a.jsx("div",{className:"color-swatch",style:{backgroundColor:r.blendColor.hex},title:`TPV blend: ${r.blendColor.hex}`})}),a.jsxs("div",{className:"card-meta",children:[a.jsxs("div",{className:"meta-row",children:[a.jsx("span",{className:"meta-label",children:"Hex:"}),a.jsx("span",{className:"hex-value",children:r.blendColor.hex})]}),a.jsxs("div",{className:"meta-row",children:[a.jsx("span",{className:"meta-label",children:"Coverage:"}),a.jsxs("span",{className:"coverage-value",children:[r.targetColor.areaPct.toFixed(1),"%"]})]})]})]}),a.jsxs("div",{className:"card-formula",children:[a.jsx("div",{className:"formula-label",children:i.components.length===1?"Pure TPV Colour":"TPV Blend Formula"}),a.jsx("div",{className:"formula-content",children:i.components.length===1?a.jsxs("span",{className:"formula-component solid",children:[a.jsx("strong",{className:"parts",children:"100%"}),a.jsx("span",{className:"comp-code",children:i.components[0].code}),a.jsxs("span",{className:"comp-name",children:["(",i.components[0].name,")"]})]}):i.components.map((o,s)=>a.jsxs("span",{className:"formula-component",children:[a.jsx("strong",{className:"parts",children:o.parts||(o.weight*100).toFixed(0)+"%"}),a.jsx("span",{className:"comp-code",children:o.code}),a.jsxs("span",{className:"comp-name",children:["(",o.name,")"]}),s<i.components.length-1&&a.jsx("span",{className:"separator",children:"+"})]},s))})]})]},n)})}),a.jsx("style",{jsx:!0,children:`
        .blend-recipes-display {
          background: #fff;
          border-radius: 8px;
          border: 1px solid #ddd;
          padding: 2rem;
          margin-top: 1.5rem;
        }

        .blend-recipes-empty {
          text-align: center;
          padding: 2rem;
          background: #f9f9f9;
          border-radius: 8px;
        }

        .recipes-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 1.5rem;
          padding-bottom: 1rem;
          border-bottom: 2px solid #1a365d;
        }

        .recipes-header h3 {
          font-family: 'Space Grotesk', sans-serif;
          margin: 0;
          color: #1e4a7a;
          font-size: 1.5rem;
          font-weight: 600;
        }

        .close-button-icon {
          background: none;
          border: none;
          font-size: 2rem;
          color: #666;
          cursor: pointer;
          padding: 0;
          width: 32px;
          height: 32px;
          line-height: 1;
        }

        .close-button-icon:hover {
          color: #333;
        }

        /* Card Grid Layout */
        .recipes-grid {
          display: grid;
          grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
          gap: 1.5rem;
        }

        .recipe-card {
          background: white;
          border: 2px solid #e0e0e0;
          border-radius: 12px;
          overflow: hidden;
          transition: all 0.3s;
        }

        .recipe-card:hover {
          border-color: #ff6b35;
          transform: translateY(-2px);
          box-shadow: 0 8px 24px rgba(255, 107, 53, 0.15);
        }

        /* Card Top Section */
        .card-top {
          display: flex;
          gap: 1.5rem;
          padding: 1.5rem;
          background: #f9f9f9;
          border-bottom: 2px solid #e8e8e8;
          align-items: center;
        }

        .swatch-section {
          display: flex;
          align-items: center;
          justify-content: center;
        }

        .color-swatch {
          width: 80px;
          height: 80px;
          border-radius: 12px;
          border: 3px solid #ff6b35;
          flex-shrink: 0;
          box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }

        .card-meta {
          flex: 1;
          display: flex;
          flex-direction: column;
          gap: 0.75rem;
          justify-content: center;
        }

        .meta-row {
          display: flex;
          align-items: center;
          gap: 0.75rem;
        }

        .meta-label {
          font-size: 0.85rem;
          font-weight: 600;
          color: #666;
          min-width: 80px;
        }

        .hex-value {
          font-family: 'Courier New', monospace;
          font-size: 1.1rem;
          color: #333;
          font-weight: 700;
          letter-spacing: 0.5px;
        }

        .coverage-value {
          font-size: 1.1rem;
          color: #1a365d;
          font-weight: 700;
        }

        /* Card Formula Section */
        .card-formula {
          padding: 1.5rem;
          background: white;
        }

        .formula-label {
          font-size: 0.85rem;
          font-weight: 700;
          color: #1a365d;
          text-transform: uppercase;
          letter-spacing: 1px;
          margin-bottom: 1rem;
        }

        .formula-content {
          display: flex;
          flex-wrap: wrap;
          gap: 0.75rem;
          align-items: center;
          line-height: 1.8;
        }

        .formula-component {
          display: inline-flex;
          align-items: center;
          gap: 0.4rem;
        }

        .parts {
          color: #333;
          font-size: 1rem;
        }

        .comp-code {
          color: #1a365d;
          font-weight: 700;
          font-size: 1.05rem;
        }

        .comp-name {
          color: #666;
          font-size: 0.9rem;
        }

        .separator {
          color: #ff6b35;
          font-weight: bold;
          font-size: 1rem;
          margin: 0 0.35rem;
        }

        .formula-component.solid {
          background: #fff5f0;
          padding: 0.5rem 0.75rem;
          border-radius: 4px;
          border: 1px solid #ff6b35;
        }

        .close-button {
          padding: 0.75rem 1.5rem;
          background: #e0e0e0;
          color: #333;
          border: none;
          border-radius: 4px;
          font-weight: 600;
          cursor: pointer;
          margin-top: 1rem;
        }

        .close-button:hover {
          background: #d0d0d0;
        }

        @media (max-width: 768px) {
          .blend-recipes-display {
            padding: 1rem;
          }

          .recipes-grid {
            grid-template-columns: 1fr;
          }

          .card-top {
            flex-direction: column;
            gap: 1rem;
            padding: 1rem;
          }

          .color-swatch {
            width: 60px;
            height: 60px;
          }

          .card-meta {
            width: 100%;
          }

          .meta-label {
            min-width: 70px;
          }

          .card-formula {
            padding: 1rem;
          }

          .formula-label {
            font-size: 0.75rem;
          }
        }
      `})]})}function PE({recipes:t,onClose:e}){if(!t||t.length===0)return a.jsxs("div",{className:"solid-summary-empty",children:[a.jsx("p",{children:"No colours in design."}),a.jsx("button",{onClick:e,className:"close-button",children:"Close"})]});const r=t.reduce((n,i)=>n+i.targetColor.areaPct,0);return a.jsxs("div",{className:"solid-color-summary",children:[a.jsxs("div",{className:"summary-header",children:[a.jsx("h3",{children:"TPV Colours Used"}),a.jsx("button",{onClick:e,className:"close-button-icon",children:""})]}),a.jsx("div",{className:"summary-info",children:a.jsxs("p",{className:"summary-description",children:["This design uses ",a.jsx("strong",{children:t.length})," pure TPV colour",t.length!==1?"s":""," (no blending required)"]})}),a.jsx("div",{className:"colors-list",children:t.map((n,i)=>{const o=n.chosenRecipe.components[0],s=n.targetColor.areaPct;return a.jsxs("div",{className:"color-item",children:[a.jsx("div",{className:"color-swatch",style:{backgroundColor:n.blendColor.hex},title:`${o.code} - ${o.name}`}),a.jsxs("div",{className:"color-details",children:[a.jsxs("div",{className:"color-primary",children:[a.jsx("span",{className:"color-code",children:o.code}),a.jsx("span",{className:"color-name",children:o.name})]}),a.jsxs("div",{className:"color-secondary",children:[a.jsx("span",{className:"hex-value",children:n.blendColor.hex}),a.jsxs("span",{className:"coverage-badge",children:[s.toFixed(1),"%"]})]})]})]},i)})}),a.jsxs("div",{className:"summary-footer",children:[a.jsxs("div",{className:"footer-stat",children:[a.jsx("span",{className:"stat-label",children:"Total Coverage:"}),a.jsxs("span",{className:"stat-value",children:[r.toFixed(1),"%"]})]}),a.jsxs("div",{className:"footer-stat",children:[a.jsx("span",{className:"stat-label",children:"TPV Colours:"}),a.jsx("span",{className:"stat-value",children:t.length})]})]}),a.jsx("style",{jsx:!0,children:`
        .solid-color-summary {
          background: #fff;
          border-radius: 8px;
          border: 1px solid #ddd;
          padding: 2rem;
          max-width: 800px;
          margin: 2rem auto;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .solid-summary-empty {
          background: #fff;
          border-radius: 8px;
          padding: 2rem;
          text-align: center;
        }

        .summary-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 1.5rem;
          padding-bottom: 1rem;
          border-bottom: 2px solid #1a365d;
        }

        .summary-header h3 {
          margin: 0;
          color: #1a365d;
          font-size: 1.8rem;
        }

        .close-button-icon {
          background: none;
          border: none;
          font-size: 2rem;
          color: #666;
          cursor: pointer;
          padding: 0;
          width: 32px;
          height: 32px;
          line-height: 1;
          transition: color 0.2s;
        }

        .close-button-icon:hover {
          color: #333;
        }

        .summary-info {
          background: #f9f9f9;
          padding: 1rem;
          border-radius: 6px;
          margin-bottom: 1.5rem;
        }

        .summary-description {
          margin: 0;
          color: #333;
          font-size: 1rem;
          line-height: 1.5;
        }

        /* Colors List */
        .colors-list {
          display: flex;
          flex-direction: column;
          gap: 1rem;
          margin-bottom: 1.5rem;
        }

        .color-item {
          display: flex;
          align-items: center;
          gap: 1rem;
          padding: 1rem;
          background: #f9f9f9;
          border-radius: 6px;
          border: 1px solid #e0e0e0;
          transition: all 0.2s;
        }

        .color-item:hover {
          border-color: #ff6b35;
          box-shadow: 0 2px 8px rgba(255, 107, 53, 0.15);
        }

        .color-swatch {
          width: 60px;
          height: 60px;
          border-radius: 8px;
          border: 2px solid #ddd;
          flex-shrink: 0;
          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .color-details {
          flex: 1;
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .color-primary {
          display: flex;
          align-items: baseline;
          gap: 0.5rem;
        }

        .color-code {
          font-family: 'Courier New', monospace;
          font-weight: 700;
          font-size: 1.2rem;
          color: #1a365d;
        }

        .color-name {
          font-size: 1.1rem;
          color: #333;
          font-weight: 500;
        }

        .color-secondary {
          display: flex;
          align-items: center;
          gap: 1rem;
        }

        .hex-value {
          font-family: 'Courier New', monospace;
          font-size: 0.9rem;
          color: #666;
        }

        .coverage-badge {
          background: #ff6b35;
          color: white;
          padding: 0.25rem 0.75rem;
          border-radius: 12px;
          font-weight: 600;
          font-size: 0.9rem;
        }

        /* Summary Footer */
        .summary-footer {
          display: flex;
          justify-content: space-around;
          padding: 1.5rem;
          background: #f9f9f9;
          border-radius: 6px;
          border: 2px solid #ff6b35;
        }

        .footer-stat {
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 0.5rem;
        }

        .stat-label {
          font-size: 0.9rem;
          color: #666;
          font-weight: 500;
        }

        .stat-value {
          font-size: 1.5rem;
          font-weight: 700;
          color: #1a365d;
        }

        .close-button {
          padding: 0.75rem 1.5rem;
          background: #ff6b35;
          color: white;
          border: none;
          border-radius: 4px;
          font-weight: 600;
          cursor: pointer;
          transition: background 0.2s;
        }

        .close-button:hover {
          background: #e55a25;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
          .solid-color-summary {
            padding: 1rem;
          }

          .summary-header h3 {
            font-size: 1.4rem;
          }

          .color-item {
            flex-direction: column;
            align-items: flex-start;
          }

          .color-swatch {
            width: 100%;
            height: 50px;
          }

          .summary-footer {
            flex-direction: column;
            gap: 1rem;
          }
        }
      `})]})}function gp({content:t,position:e="top"}){const[r,n]=A.useState(!1);return a.jsxs("div",{className:"help-icon-container",children:[a.jsx("button",{className:"help-icon",onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1),onClick:i=>{i.preventDefault(),i.stopPropagation(),n(!r)},type:"button","aria-label":"Help",children:"?"}),r&&a.jsx("div",{className:`help-tooltip help-tooltip-${e}`,children:t}),a.jsx("style",{children:`
        .help-icon-container {
          position: relative;
          display: inline-block;
        }

        .help-icon {
          display: inline-flex;
          align-items: center;
          justify-content: center;
          width: 18px;
          height: 18px;
          border-radius: 50%;
          background: #6b7280;
          color: white;
          border: none;
          font-size: 12px;
          font-weight: 600;
          cursor: help;
          transition: all 0.2s;
          padding: 0;
          line-height: 1;
        }

        .help-icon:hover {
          background: #374151;
          transform: scale(1.1);
        }

        .help-tooltip {
          position: absolute;
          z-index: 1000;
          background: #1f2937;
          color: white;
          padding: 0.75rem 1rem;
          border-radius: 6px;
          font-size: 0.875rem;
          line-height: 1.5;
          max-width: 300px;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
          pointer-events: none;
          white-space: normal;
        }

        .help-tooltip-top {
          bottom: calc(100% + 8px);
          left: 50%;
          transform: translateX(-50%);
        }

        .help-tooltip-top::after {
          content: '';
          position: absolute;
          top: 100%;
          left: 50%;
          transform: translateX(-50%);
          border: 6px solid transparent;
          border-top-color: #1f2937;
        }

        .help-tooltip-bottom {
          top: calc(100% + 8px);
          left: 50%;
          transform: translateX(-50%);
        }

        .help-tooltip-bottom::after {
          content: '';
          position: absolute;
          bottom: 100%;
          left: 50%;
          transform: translateX(-50%);
          border: 6px solid transparent;
          border-bottom-color: #1f2937;
        }

        .help-tooltip-right {
          left: calc(100% + 8px);
          top: 50%;
          transform: translateY(-50%);
        }

        .help-tooltip-right::after {
          content: '';
          position: absolute;
          right: 100%;
          top: 50%;
          transform: translateY(-50%);
          border: 6px solid transparent;
          border-right-color: #1f2937;
        }

        .help-tooltip-left {
          right: calc(100% + 8px);
          top: 50%;
          transform: translateY(-50%);
        }

        .help-tooltip-left::after {
          content: '';
          position: absolute;
          left: 100%;
          top: 50%;
          transform: translateY(-50%);
          border: 6px solid transparent;
          border-left-color: #1f2937;
        }

        @media (max-width: 768px) {
          .help-tooltip {
            max-width: 250px;
            font-size: 0.8125rem;
            padding: 0.625rem 0.875rem;
          }
        }
      `})]})}function OE({recipes:t,mode:e="blend",onColorClick:r,selectedColor:n,editedColors:i,onResetAll:o}){if(!t||t.length===0)return null;const s=f=>!i||i.size===0?!1:i.has(f.originalColor.hex.toLowerCase()),l=i&&i.size>0,c=f=>{const u=f.toLowerCase();return nn.find(p=>p.hex.toLowerCase()===u)},d=f=>{if(e==="solid"){const u=c(f.blendColor.hex);if(u)return`${u.code} - ${u.name}`}return f.blendColor.hex},h=f=>{if(!n)return!1;const u=n.blendHex||n.hex;return f.blendColor.hex===u||f.targetColor.hex===u};return a.jsxs("div",{className:"color-legend",children:[a.jsxs("div",{className:"legend-header",children:[a.jsxs("div",{className:"legend-header-left",children:[a.jsx("span",{className:"legend-title",children:"Colours"}),a.jsx(gp,{content:"Click any colour to edit all instances of that colour across the design. Changes apply to every region using that colour.",position:"right"}),r&&a.jsx("span",{className:"edit-hint",children:"(click to edit)"})]}),l&&o&&a.jsx("button",{onClick:o,className:"reset-all-btn",title:"Reset all colours to original",children:"Reset All"})]}),a.jsx("div",{className:"legend-colors",children:t.map((f,u)=>a.jsxs("div",{className:`color-item ${r?"clickable":""} ${h(f)?"selected":""}`,onClick:()=>{r&&r({hex:f.targetColor.hex,originalHex:f.originalColor.hex,blendHex:f.blendColor.hex,areaPct:f.targetColor.areaPct,recipe:f.chosenRecipe,targetColor:f.targetColor},"palette")},title:r?"Click to edit this colour":"",children:[a.jsxs("div",{className:"color-swatch-wrapper",children:[a.jsx("div",{className:"color-swatch",style:{backgroundColor:f.blendColor.hex}}),s(f)&&a.jsx("span",{className:"edit-indicator",title:"Colour has been modified",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"12",height:"12",children:a.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"})})})]}),a.jsxs("div",{className:"color-info",children:[a.jsx("span",{className:e==="solid"?"tpv-label":"hex-value",children:d(f)}),a.jsxs("span",{className:"coverage",children:[f.targetColor.areaPct.toFixed(1),"%"]})]})]},u))}),a.jsx("style",{jsx:!0,children:`
        .color-legend {
          background: rgba(255, 255, 255, 0.95);
          border: 1px solid #ddd;
          border-radius: 8px;
          padding: 1rem;
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
          width: 100%;
        }

        .legend-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          gap: 0.5rem;
          margin-bottom: 0.75rem;
          padding-bottom: 0.5rem;
          border-bottom: 1px solid #e0e0e0;
        }

        .legend-header-left {
          display: flex;
          align-items: center;
          gap: 0.5rem;
        }

        .legend-title {
          font-weight: 600;
          color: #1a365d;
          font-size: 0.95rem;
        }

        .edit-hint {
          font-size: 0.75rem;
          color: #ff6b35;
          font-weight: normal;
        }

        .reset-all-btn {
          padding: 0.25rem 0.5rem;
          font-size: 0.7rem;
          font-weight: 600;
          color: #ff6b35;
          background: #fff5f0;
          border: 1px solid #ff6b35;
          border-radius: 4px;
          cursor: pointer;
          transition: all 0.2s;
        }

        .reset-all-btn:hover {
          background: #ff6b35;
          color: white;
        }

        .legend-colors {
          display: grid;
          grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
          gap: 0.75rem;
        }

        .color-item {
          display: flex;
          align-items: center;
          gap: 0.75rem;
          padding: 0.5rem;
          border-radius: 4px;
          background: white;
          border: 1px solid #e8e8e8;
          transition: all 0.2s;
        }

        .color-item.clickable {
          cursor: pointer;
        }

        .color-item.clickable:hover {
          border-color: #ff6b35;
          background: #fff9f7;
          box-shadow: 0 2px 4px rgba(255, 107, 53, 0.15);
          transform: translateY(-2px);
        }

        .color-item.selected {
          border-color: #ff6b35;
          border-width: 2px;
          background: #fff9f7;
          box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.2);
          transform: translateY(-2px);
        }

        .color-swatch-wrapper {
          position: relative;
          flex-shrink: 0;
        }

        .color-swatch {
          width: 40px;
          height: 40px;
          border-radius: 4px;
          border: 2px solid #ddd;
        }

        .edit-indicator {
          position: absolute;
          top: -4px;
          right: -4px;
          width: 16px;
          height: 16px;
          background: #ff6b35;
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          color: white;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }

        .edit-indicator svg {
          width: 10px;
          height: 10px;
        }

        .color-info {
          display: flex;
          flex-direction: column;
          gap: 0.25rem;
          font-size: 0.85rem;
        }

        .hex-value {
          font-family: 'Courier New', monospace;
          font-weight: 600;
          color: #333;
        }

        .tpv-label {
          font-weight: 600;
          color: #1a365d;
          font-size: 0.9rem;
        }

        .coverage {
          color: #666;
          font-size: 0.8rem;
        }

        /* Mobile - compact horizontal grid of swatches */
        @media (max-width: 768px) {
          .color-legend {
            padding: 0.75rem;
          }

          .legend-header {
            margin-bottom: 0.5rem;
            padding-bottom: 0.5rem;
          }

          .legend-title {
            font-size: 0.85rem;
          }

          .edit-hint {
            font-size: 0.7rem;
          }

          .reset-all-btn {
            font-size: 0.65rem;
            padding: 0.2rem 0.4rem;
            min-height: 28px;
          }

          /* Horizontal scrolling grid of swatches */
          .legend-colors {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            justify-content: flex-start;
          }

          .color-item {
            flex-direction: column;
            padding: 0.25rem;
            border-radius: 6px;
            width: auto;
            min-width: 44px;
          }

          /* Hide text info on mobile - just show swatches */
          .color-info {
            display: none;
          }

          .color-swatch {
            width: 44px;
            height: 44px;
            border-radius: 6px;
          }

          .color-item.selected {
            transform: none;
            box-shadow: 0 0 0 2px rgba(255, 107, 53, 0.4);
          }

          .color-item.clickable:hover {
            transform: none;
          }

          .edit-indicator {
            top: -2px;
            right: -2px;
            width: 14px;
            height: 14px;
          }

          .edit-indicator svg {
            width: 8px;
            height: 8px;
          }
        }

        @media (max-width: 480px) {
          .color-legend {
            padding: 0.5rem;
          }

          .legend-colors {
            gap: 0.35rem;
          }

          .color-swatch {
            width: 40px;
            height: 40px;
          }

          .color-item {
            min-width: 40px;
          }
        }
      `})]})}function g0({blendSvgUrl:t,recipes:e,mode:r="blend",onColorClick:n,onRegionClick:i,onEyedropperCancel:o,selectedColor:s,editedColors:l,onResetAll:c,designName:d="",onNameChange:h,isNameLoading:f=!1,onInSituClick:u,eyedropperActive:p=!1,eyedropperRegion:g=null,onRegionUndo:m,onRegionRedo:x,canUndo:v=!1,canRedo:y=!1,regionOverridesCount:b=0}){const[w,k]=A.useState(null),[S,C]=A.useState(null),T=A.useRef(null),R=A.useRef(null);A.useRef(null);const[O,Y]=A.useState(1),[E,B]=A.useState({x:0,y:0}),[_,V]=A.useState(!1),[re,I]=A.useState({x:0,y:0}),q=A.useRef(null),D=A.useRef(!1),[J,U]=A.useState(()=>localStorage.getItem("tpv_color_editing_tip_dismissed")!=="true"),G=()=>{U(!1),localStorage.setItem("tpv_color_editing_tip_dismissed","true")};A.useEffect(()=>{if(!t){C(null);return}(async()=>{try{const P=await(await fetch(t)).text();C(P);const F=P.includes("data-region-id"),X=(P.match(/data-region-id/g)||[]).length;console.log("[SVGPreview] Fetched inline SVG content - length:",P.length,"hasRegionTags:",F,"regionCount:",X)}catch(N){console.error("[SVGPreview] Failed to fetch SVG content:",N),C(null)}})()},[t]);const fe=A.useMemo(()=>{if(!S)return null;console.log("[SVGPreview] Sanitizing SVG content...");const M=hp(S);return M?(console.log("[SVGPreview] SVG sanitization complete - length:",M.length),console.log("[SVGPreview] Sanitized content preview:",M.substring(0,200)),M.includes("<svg")?M.replace(/<svg([^>]*)>/i,(P,F)=>(F.includes("width=")||(F+=' width="100%"'),F.includes("height=")||(F+=' height="100%"'),`<svg${F}>`)):(console.error("[SVGPreview] Sanitized SVG does not contain <svg> tag!"),null)):(console.error("[SVGPreview] SVG sanitization failed - content rejected"),null)},[S]);A.useEffect(()=>{if(!s||!t){k(null);return}(async()=>{try{console.log("[SVGPreview] Creating highlight for color:",s);const N=new Image;N.crossOrigin="anonymous";const P=new Promise((ge,Se)=>{N.onload=()=>{console.log("[SVGPreview] Image loaded:",N.width,"x",N.height),ge()},N.onerror=we=>{console.error("[SVGPreview] Image load error:",we),Se(we)}});N.src=t,await P;const F=document.createElement("canvas");F.width=N.naturalWidth||N.width||1e3,F.height=N.naturalHeight||N.height||1e3;const X=F.getContext("2d");X.drawImage(N,0,0);const L=X.getImageData(0,0,F.width,F.height).data,H=s.hex,Z=oe(H);console.log("[SVGPreview] Target color:",H,Z);const ee=new Set;let z=0;for(let ge=0;ge<F.height;ge++)for(let Se=0;Se<F.width;Se++){const we=(ge*F.width+Se)*4,ke=L[we],_e=L[we+1],Te=L[we+2];L[we+3]>0&&ae(ke,_e,Te,Z)&&(ee.add(`${Se},${ge}`),z++)}if(console.log("[SVGPreview] Matched pixels:",z),z===0){console.warn("[SVGPreview] No pixels matched the target color"),k(null);return}const Q=X.createImageData(F.width,F.height);for(let ge=0;ge<F.height;ge++)for(let Se=0;Se<F.width;Se++){const we=(ge*F.width+Se)*4;ee.has(`${Se},${ge}`)&&(!ee.has(`${Se-1},${ge}`)||!ee.has(`${Se+1},${ge}`)||!ee.has(`${Se},${ge-1}`)||!ee.has(`${Se},${ge+1}`))&&(Q.data[we]=255,Q.data[we+1]=0,Q.data[we+2]=255,Q.data[we+3]=255)}X.clearRect(0,0,F.width,F.height),X.putImageData(Q,0,0);const ne=F.toDataURL();console.log("[SVGPreview] Highlight mask created"),k(ne)}catch(N){console.error("[SVGPreview] Failed to create highlight mask:",N),k(null)}})()},[s,t]);const oe=M=>{const N=M.replace("#","");return{r:parseInt(N.substring(0,2),16),g:parseInt(N.substring(2,4),16),b:parseInt(N.substring(4,6),16)}},ae=(M,N,P,F)=>Math.abs(M-F.r)<=50&&Math.abs(N-F.g)<=50&&Math.abs(P-F.b)<=50,le=async(M,N)=>{try{if(!T.current||!t)return null;const P=new Image;P.crossOrigin="anonymous";const F=new Promise((ge,Se)=>{P.onload=ge,P.onerror=Se});P.src=t,await F;const X=document.createElement("canvas");X.width=P.naturalWidth||P.width||1e3,X.height=P.naturalHeight||P.height||1e3;const K=X.getContext("2d");K.drawImage(P,0,0);const L=T.current.getBoundingClientRect(),H=X.width/L.width,Z=X.height/L.height,ee=Math.floor(M*H),z=Math.floor(N*Z),ne=K.getImageData(ee,z,1,1).data;return{r:ne[0],g:ne[1],b:ne[2],a:ne[3]}}catch(P){return console.error("[SVGPreview] Failed to get color at position:",P),null}},ce=()=>{Y(M=>Math.min(M*1.5,5))},be=()=>{Y(M=>Math.max(M/1.5,.5))},Ce=()=>{Y(1),B({x:0,y:0})},ue=M=>{M.preventDefault();const N=M.deltaY*-.001;Y(P=>Math.min(Math.max(P+N,.5),5))},de=M=>{M.button===0&&(V(!0),I({x:M.clientX-E.x,y:M.clientY-E.y}),D.current=!1)},ze=M=>{if(!_)return;const N=Math.abs(M.clientX-(re.x+E.x)),P=Math.abs(M.clientY-(re.y+E.y));(N>5||P>5)&&(D.current=!0),B({x:M.clientX-re.x,y:M.clientY-re.y})},Ge=()=>{V(!1)};A.useEffect(()=>{if(_)return document.addEventListener("mousemove",ze),document.addEventListener("mouseup",Ge),()=>{document.removeEventListener("mousemove",ze),document.removeEventListener("mouseup",Ge)}},[_,re,E]);const j=M=>{let N=M;for(;N&&N!==R.current;){if(N.hasAttribute&&N.hasAttribute("data-region-id"))return N;N=N.parentElement}return null},ie=async M=>{var H,Z;if(D.current){console.log("[SVGPreview] Click ignored - was dragging");return}if(console.log("[SVGPreview] Click detected - onRegionClick:",!!i,"inlineSvgContent:",!!S,"target:",M.target.tagName),i&&S){console.log("[SVGPreview] Attempting region detection on target:",M.target);const ee=j(M.target);if(console.log("[SVGPreview] Found region element:",ee),ee){const z=ee.getAttribute("data-region-id"),Q=ee.getAttribute("fill")||((Z=(H=ee.getAttribute("style"))==null?void 0:H.match(/fill:\s*([^;]+)/))==null?void 0:Z[1]);console.log("[SVGPreview] Region clicked:",z,"fill:",Q),i({regionId:z,sourceColor:Q,element:ee});return}else console.log("[SVGPreview] No region element found from target")}else console.log("[SVGPreview] Region detection skipped - onRegionClick:",!!i,"inlineSvgContent:",!!S);if(!n||!e||e.length===0)return;const N=M.currentTarget.getBoundingClientRect(),P=M.clientX-N.left,F=M.clientY-N.top;console.log("[SVGPreview] Clicked at:",P,F);const X=await le(P,F);if(!X||X.a===0){console.log("[SVGPreview] Clicked on transparent area");return}console.log("[SVGPreview] Clicked color:",X);let K=null,L=1/0;for(const ee of e){const z=ee.targetColor.hex,Q=oe(z);if(ae(X.r,X.g,X.b,Q)){const ne=Math.sqrt(Math.pow(X.r-Q.r,2)+Math.pow(X.g-Q.g,2)+Math.pow(X.b-Q.b,2));ne<L&&(L=ne,K=ee)}}K?(console.log("[SVGPreview] Matched recipe:",K.targetColor.hex),n({hex:K.targetColor.hex,originalHex:K.originalColor.hex,blendHex:K.blendColor.hex,areaPct:K.targetColor.areaPct,recipe:K.chosenRecipe,targetColor:K.targetColor})):console.log("[SVGPreview] No matching recipe found for clicked color")};return t?a.jsxs("div",{className:"svg-preview",children:[a.jsxs("div",{className:"preview-header",children:[a.jsxs("div",{className:"design-name-container",children:[h?a.jsx("input",{type:"text",className:"design-name-input",value:d,onChange:M=>h(M.target.value),placeholder:f?"Generating name...":"Enter project name"}):a.jsx("h3",{children:d||"TPV Blend Design"}),f&&a.jsx("span",{className:"name-loading",children:"Generating..."})]}),s&&a.jsxs("span",{className:"editing-hint",children:["Editing: ",s.hex||s.blendHex]})]}),J&&n&&a.jsxs("div",{className:"color-editing-tip",children:[a.jsx("div",{className:"tip-icon",children:""}),a.jsxs("div",{className:"tip-content",children:[a.jsx("strong",{children:"Tip:"})," Click colours in the legend below to edit all instances, or click directly on the design to edit individual regions."]}),a.jsx("button",{onClick:G,className:"tip-close",title:"Dismiss tip",children:""})]}),a.jsxs("div",{className:"svg-display-container",children:[a.jsxs("div",{className:"svg-panel",children:[a.jsxs("div",{className:"zoom-controls",children:[a.jsx("button",{onClick:ce,className:"zoom-btn",title:"Zoom In",children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"11",y1:"8",x2:"11",y2:"14"}),a.jsx("line",{x1:"8",y1:"11",x2:"14",y2:"11"}),a.jsx("path",{d:"m21 21-4.35-4.35"})]})}),a.jsx("button",{onClick:be,className:"zoom-btn",title:"Zoom Out",children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"8",y1:"11",x2:"14",y2:"11"}),a.jsx("path",{d:"m21 21-4.35-4.35"})]})}),a.jsx("button",{onClick:Ce,className:"zoom-btn",title:"Reset View",children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M1 4v6h6"}),a.jsx("path",{d:"M23 20v-6h-6"}),a.jsx("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})]})}),a.jsxs("span",{className:"zoom-level",children:[Math.round(O*100),"%"]})]}),b>0&&a.jsxs("div",{className:"undo-redo-controls",children:[a.jsx("button",{onClick:m,className:"undo-redo-btn",title:"Undo (Ctrl+Z)",disabled:!v,children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 7v6h6"}),a.jsx("path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13"})]})}),a.jsx("button",{onClick:x,className:"undo-redo-btn",title:"Redo (Ctrl+Y)",disabled:!y,children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M21 7v6h-6"}),a.jsx("path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7"})]})})]}),u&&a.jsxs("button",{onClick:u,className:"in-situ-btn",title:"Upload a photo of your installation site and see how this design will look in place with realistic perspective",children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"m21 15-5-5L5 21"})]}),a.jsx("span",{children:"Preview In-Situ"})]}),a.jsx("div",{ref:q,className:"svg-wrapper",onWheel:ue,children:a.jsxs("div",{className:"svg-image-container",onClick:ie,onMouseDown:de,style:{transform:`translate(${E.x}px, ${E.y}px) scale(${O})`,cursor:_?"grabbing":O>1?"grab":p?"crosshair":n?"pointer":"default"},children:[fe?a.jsx("div",{ref:R,className:"svg-inline-container",style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},dangerouslySetInnerHTML:{__html:fe}}):a.jsx("img",{ref:T,src:t,alt:"TPV blend design",className:"svg-image"}),w&&a.jsx("img",{src:w,alt:"Colour highlight",className:"svg-highlight-mask"})]})}),p&&g&&a.jsx("div",{className:"eyedropper-overlay",children:a.jsxs("div",{className:"eyedropper-content",children:[a.jsxs("div",{className:"eyedropper-color-indicator",children:[a.jsx("div",{className:"eyedropper-color-swatch",style:{backgroundColor:g.sourceColor}}),a.jsx("span",{children:"Click another area to copy its colour"})]}),a.jsx("button",{className:"eyedropper-cancel",onClick:M=>{M.stopPropagation(),o&&o()},children:"Cancel (Esc)"})]})})]}),e&&e.length>0&&a.jsx("div",{className:"legend-sidebar",children:a.jsx(OE,{recipes:e,mode:r,onColorClick:n,selectedColor:s,editedColors:l,onResetAll:c})})]}),a.jsx("style",{jsx:!0,children:`
        .svg-preview {
          background: #fff;
          border-radius: 8px;
          border: 1px solid #ddd;
          padding: 1.5rem;
          margin-top: 1.5rem;
        }

        .preview-header {
          margin-bottom: 1.5rem;
          display: flex;
          align-items: center;
          justify-content: space-between;
          flex-wrap: wrap;
          gap: 0.5rem;
        }

        .design-name-container {
          display: flex;
          align-items: center;
          gap: 0.75rem;
          flex: 1;
        }

        .preview-header h3 {
          margin: 0;
          color: #1a365d;
          font-size: 1.5rem;
        }

        .design-name-input {
          font-family: var(--font-heading), 'Space Grotesk', sans-serif;
          font-size: 1.5rem;
          font-weight: 600;
          color: #1a365d;
          border: none;
          border-bottom: 2px solid transparent;
          background: transparent;
          padding: 0.25rem 0;
          width: 100%;
          max-width: 400px;
          transition: border-color 0.2s;
        }

        .design-name-input:hover {
          border-bottom-color: #e5e7eb;
        }

        .design-name-input:focus {
          outline: none;
          border-bottom-color: #ff6b35;
        }

        .design-name-input::placeholder {
          color: #9ca3af;
          font-weight: normal;
        }

        .name-loading {
          font-size: 0.75rem;
          color: #9ca3af;
          font-style: italic;
        }

        /* Color Editing Tip Banner */
        .color-editing-tip {
          display: flex;
          align-items: center;
          gap: 0.75rem;
          padding: 0.875rem 1rem;
          background: linear-gradient(to right, #fff7ed, #fffbeb);
          border: 1px solid #fed7aa;
          border-radius: 6px;
          margin-bottom: 1rem;
          font-size: 0.875rem;
          line-height: 1.5;
        }

        .tip-icon {
          font-size: 1.25rem;
          flex-shrink: 0;
        }

        .tip-content {
          flex: 1;
          color: #78350f;
        }

        .tip-content strong {
          color: #92400e;
        }

        .tip-close {
          background: none;
          border: none;
          font-size: 1.5rem;
          color: #92400e;
          cursor: pointer;
          padding: 0;
          line-height: 1;
          opacity: 0.6;
          transition: opacity 0.2s;
          flex-shrink: 0;
        }

        .tip-close:hover {
          opacity: 1;
        }

        /* SVG Display */
        .svg-display-container {
          display: flex;
          flex-direction: column;
          gap: 1.5rem;
          align-items: stretch;
        }

        .svg-panel {
          position: relative;
          flex: 1;
          border: 1px solid #e0e0e0;
          border-radius: 6px;
          overflow: hidden;
          background: #fafafa;
        }

        /* Zoom Controls */
        .zoom-controls {
          position: absolute;
          top: 1rem;
          right: 1rem;
          display: flex;
          gap: 0.5rem;
          background: white;
          border-radius: 8px;
          padding: 0.5rem;
          box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
          z-index: 10;
          align-items: center;
        }

        .zoom-btn {
          display: flex;
          align-items: center;
          justify-content: center;
          width: 36px;
          height: 36px;
          padding: 0;
          background: white;
          border: 1px solid #e0e0e0;
          border-radius: 6px;
          cursor: pointer;
          color: #1a365d;
          transition: all 0.2s ease;
        }

        .zoom-btn:hover {
          background: #f8fafc;
          border-color: #1e4a7a;
          transform: translateY(-1px);
          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .zoom-btn:active {
          transform: translateY(0);
        }

        .zoom-btn svg {
          width: 20px;
          height: 20px;
        }

        .zoom-level {
          font-size: 0.875rem;
          font-weight: 600;
          color: #1a365d;
          min-width: 50px;
          text-align: center;
          padding: 0 0.5rem;
        }

        /* Undo/Redo Controls */
        .undo-redo-controls {
          position: absolute;
          top: 5rem;
          right: 1rem;
          display: flex;
          gap: 0.5rem;
          background: white;
          border-radius: 8px;
          padding: 0.5rem;
          box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
          z-index: 10;
        }

        .undo-redo-btn {
          display: flex;
          align-items: center;
          justify-content: center;
          width: 36px;
          height: 36px;
          padding: 0;
          background: white;
          border: 1px solid #e0e0e0;
          border-radius: 6px;
          cursor: pointer;
          color: #1a365d;
          transition: all 0.2s ease;
        }

        .undo-redo-btn:hover:not(:disabled) {
          background: #f8fafc;
          border-color: #1e4a7a;
          transform: translateY(-1px);
          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .undo-redo-btn:active:not(:disabled) {
          transform: translateY(0);
        }

        .undo-redo-btn:disabled {
          opacity: 0.4;
          cursor: not-allowed;
        }

        .undo-redo-btn svg {
          width: 20px;
          height: 20px;
        }

        .in-situ-btn {
          position: absolute;
          top: 1rem;
          left: 1rem;
          display: flex;
          align-items: center;
          gap: 0.5rem;
          padding: 0.5rem 1rem;
          background: #ff6b35;
          color: white;
          border: none;
          border-radius: 6px;
          font-size: 0.875rem;
          font-weight: 500;
          cursor: pointer;
          box-shadow: 0 2px 12px rgba(255, 107, 53, 0.3);
          z-index: 10;
          transition: all 0.2s ease;
        }

        .in-situ-btn:hover {
          background: #e55a2b;
          transform: translateY(-1px);
          box-shadow: 0 4px 16px rgba(255, 107, 53, 0.4);
        }

        .in-situ-btn:active {
          transform: translateY(0);
        }

        .in-situ-btn svg {
          width: 18px;
          height: 18px;
        }

        .svg-wrapper {
          padding: 2rem;
          background: white;
          min-height: 400px;
          display: flex;
          align-items: center;
          justify-content: center;
          overflow: hidden;
          position: relative;
        }

        .svg-image-container {
          position: relative;
          display: inline-block;
          user-select: none;
          transition: transform 0.1s ease-out;
          transform-origin: center center;
        }

        .svg-image {
          max-width: 100%;
          height: auto;
          display: block;
          border-radius: 4px;
          pointer-events: ${n?"auto":"none"};
        }

        .svg-inline-container {
          max-width: 100%;
          display: block;
          border-radius: 4px;
        }

        .svg-inline-container svg {
          max-width: 100%;
          height: auto;
          display: block;
        }

        .svg-highlight-mask {
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          pointer-events: none;
          border-radius: 4px;
          filter: drop-shadow(0 0 3px rgba(255, 0, 255, 0.8)) drop-shadow(0 0 1px rgba(0, 0, 0, 0.6));
          animation: pulse 2s ease-in-out infinite;
        }

        .eyedropper-overlay {
          position: absolute;
          top: 20px;
          left: 50%;
          transform: translateX(-50%);
          z-index: 100;
        }

        .eyedropper-content {
          background: white;
          border-radius: 12px;
          padding: 16px 20px;
          box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
          display: flex;
          align-items: center;
          gap: 16px;
          border: 2px solid #3b82f6;
        }

        .eyedropper-color-indicator {
          display: flex;
          align-items: center;
          gap: 12px;
          font-size: 0.95rem;
          font-weight: 500;
          color: #111827;
        }

        .eyedropper-color-swatch {
          width: 32px;
          height: 32px;
          border-radius: 6px;
          border: 2px solid #d1d5db;
          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .eyedropper-cancel {
          padding: 8px 16px;
          background: #ef4444;
          color: white;
          border: none;
          border-radius: 6px;
          font-size: 0.9rem;
          font-weight: 500;
          cursor: pointer;
          transition: all 0.2s;
          white-space: nowrap;
        }

        .eyedropper-cancel:hover {
          background: #dc2626;
          box-shadow: 0 2px 6px rgba(239, 68, 68, 0.3);
        }

        @keyframes pulse {
          0%, 100% {
            opacity: 0.8;
          }
          50% {
            opacity: 1;
          }
        }

        .editing-hint {
          font-size: 0.9rem;
          color: #ff6b35;
          font-weight: 500;
          margin-left: 1rem;
        }

        .legend-sidebar {
          width: 100%;
        }

        @media (max-width: 768px) {
          .svg-preview {
            padding: 0.5rem;
            margin-top: 0.75rem;
            border-radius: 6px;
          }

          .preview-header {
            flex-direction: column;
            align-items: flex-start;
            gap: 0.25rem;
            margin-bottom: 0.5rem;
          }

          .preview-header h3 {
            font-size: 1.1rem;
          }

          .design-name-input {
            font-size: 1.1rem;
            max-width: 100%;
          }

          .editing-hint {
            margin-left: 0;
            font-size: 0.75rem;
          }

          .svg-panel {
            border: none;
            border-radius: 0;
          }

          .svg-wrapper {
            padding: 0;
            min-height: auto;
          }

          /* Position zoom controls at bottom-right on mobile */
          .zoom-controls {
            position: fixed;
            bottom: 1rem;
            right: 1rem;
            top: auto;
            flex-direction: column;
            gap: 0.25rem;
            padding: 0.25rem;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(8px);
            z-index: 50;
          }

          /* Position undo/redo controls above zoom on mobile */
          .undo-redo-controls {
            position: fixed;
            bottom: 12rem;
            right: 1rem;
            top: auto;
            gap: 0.25rem;
            padding: 0.25rem;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(8px);
            z-index: 50;
          }

          /* Make buttons circular and compact on mobile */
          .zoom-btn,
          .undo-redo-btn {
            width: 44px;
            height: 44px;
            padding: 0;
            border-radius: 50%;
            min-width: unset;
            font-size: 1.1rem;
          }

          /* Hide text labels on mobile */
          .zoom-btn span {
            display: none;
          }

          /* In-situ button - compact on mobile */
          .in-situ-btn {
            padding: 0.4rem;
            font-size: 0;
            top: 0.5rem;
            left: 0.5rem;
            border-radius: 50%;
            width: 36px;
            height: 36px;
          }

          .in-situ-btn span {
            display: none;
          }

          .in-situ-btn svg {
            width: 18px;
            height: 18px;
          }

          .svg-image-container {
            /* Allow zoom on mobile via buttons */
            cursor: default !important;
          }
        }

        /* Extra small screens */
        @media (max-width: 480px) {
          .svg-preview {
            padding: 0.25rem;
            margin-top: 0.5rem;
          }

          .preview-header {
            padding: 0 0.25rem;
          }

          .preview-header h3 {
            font-size: 1rem;
          }

          .design-name-input {
            font-size: 1rem;
          }
        }
      `})]}):null}var Cr={},Ga={},AE=typeof Gn=="object"&&Gn&&Gn.Object===Object&&Gn,Lw=AE,ME=Lw,$E=typeof self=="object"&&self&&self.Object===Object&&self,IE=ME||$E||Function("return this")(),sn=IE,LE=sn,DE=LE.Symbol,Va=DE,v0=Va,Dw=Object.prototype,zE=Dw.hasOwnProperty,FE=Dw.toString,Us=v0?v0.toStringTag:void 0;function BE(t){var e=zE.call(t,Us),r=t[Us];try{t[Us]=void 0;var n=!0}catch{}var i=FE.call(t);return n&&(e?t[Us]=r:delete t[Us]),i}var UE=BE,HE=Object.prototype,WE=HE.toString;function GE(t){return WE.call(t)}var VE=GE,y0=Va,qE=UE,KE=VE,YE="[object Null]",XE="[object Undefined]",x0=y0?y0.toStringTag:void 0;function ZE(t){return t==null?t===void 0?XE:YE:x0&&x0 in Object(t)?qE(t):KE(t)}var Vi=ZE,JE=Array.isArray,Vr=JE;function QE(t){return t!=null&&typeof t=="object"}var kn=QE,e5=Vi,t5=Vr,r5=kn,n5="[object String]";function i5(t){return typeof t=="string"||!t5(t)&&r5(t)&&e5(t)==n5}var o5=i5;function s5(t){return function(e,r,n){for(var i=-1,o=Object(e),s=n(e),l=s.length;l--;){var c=s[t?l:++i];if(r(o[c],c,o)===!1)break}return e}}var a5=s5,l5=a5,c5=l5(),d5=c5;function u5(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}var h5=u5,f5=Vi,p5=kn,m5="[object Arguments]";function g5(t){return p5(t)&&f5(t)==m5}var v5=g5,b0=v5,y5=kn,zw=Object.prototype,x5=zw.hasOwnProperty,b5=zw.propertyIsEnumerable,w5=b0(function(){return arguments}())?b0:function(t){return y5(t)&&x5.call(t,"callee")&&!b5.call(t,"callee")},Fw=w5,zc={exports:{}};function _5(){return!1}var S5=_5;zc.exports;(function(t,e){var r=sn,n=S5,i=e&&!e.nodeType&&e,o=i&&!0&&t&&!t.nodeType&&t,s=o&&o.exports===i,l=s?r.Buffer:void 0,c=l?l.isBuffer:void 0,d=c||n;t.exports=d})(zc,zc.exports);var vp=zc.exports,k5=9007199254740991,j5=/^(?:0|[1-9]\d*)$/;function C5(t,e){var r=typeof t;return e=e??k5,!!e&&(r=="number"||r!="symbol"&&j5.test(t))&&t>-1&&t%1==0&&t<e}var Bw=C5,E5=9007199254740991;function T5(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=E5}var yp=T5,R5=Vi,N5=yp,P5=kn,O5="[object Arguments]",A5="[object Array]",M5="[object Boolean]",$5="[object Date]",I5="[object Error]",L5="[object Function]",D5="[object Map]",z5="[object Number]",F5="[object Object]",B5="[object RegExp]",U5="[object Set]",H5="[object String]",W5="[object WeakMap]",G5="[object ArrayBuffer]",V5="[object DataView]",q5="[object Float32Array]",K5="[object Float64Array]",Y5="[object Int8Array]",X5="[object Int16Array]",Z5="[object Int32Array]",J5="[object Uint8Array]",Q5="[object Uint8ClampedArray]",eT="[object Uint16Array]",tT="[object Uint32Array]",st={};st[q5]=st[K5]=st[Y5]=st[X5]=st[Z5]=st[J5]=st[Q5]=st[eT]=st[tT]=!0;st[O5]=st[A5]=st[G5]=st[M5]=st[V5]=st[$5]=st[I5]=st[L5]=st[D5]=st[z5]=st[F5]=st[B5]=st[U5]=st[H5]=st[W5]=!1;function rT(t){return P5(t)&&N5(t.length)&&!!st[R5(t)]}var nT=rT;function iT(t){return function(e){return t(e)}}var xp=iT,Fc={exports:{}};Fc.exports;(function(t,e){var r=Lw,n=e&&!e.nodeType&&e,i=n&&!0&&t&&!t.nodeType&&t,o=i&&i.exports===n,s=o&&r.process,l=function(){try{var c=i&&i.require&&i.require("util").types;return c||s&&s.binding&&s.binding("util")}catch{}}();t.exports=l})(Fc,Fc.exports);var bp=Fc.exports,oT=nT,sT=xp,w0=bp,_0=w0&&w0.isTypedArray,aT=_0?sT(_0):oT,Uw=aT,lT=h5,cT=Fw,dT=Vr,uT=vp,hT=Bw,fT=Uw,pT=Object.prototype,mT=pT.hasOwnProperty;function gT(t,e){var r=dT(t),n=!r&&cT(t),i=!r&&!n&&uT(t),o=!r&&!n&&!i&&fT(t),s=r||n||i||o,l=s?lT(t.length,String):[],c=l.length;for(var d in t)(e||mT.call(t,d))&&!(s&&(d=="length"||i&&(d=="offset"||d=="parent")||o&&(d=="buffer"||d=="byteLength"||d=="byteOffset")||hT(d,c)))&&l.push(d);return l}var Hw=gT,vT=Object.prototype;function yT(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||vT;return t===r}var wp=yT;function xT(t,e){return function(r){return t(e(r))}}var Ww=xT,bT=Ww,wT=bT(Object.keys,Object),_T=wT,ST=wp,kT=_T,jT=Object.prototype,CT=jT.hasOwnProperty;function ET(t){if(!ST(t))return kT(t);var e=[];for(var r in Object(t))CT.call(t,r)&&r!="constructor"&&e.push(r);return e}var TT=ET;function RT(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var ys=RT,NT=Vi,PT=ys,OT="[object AsyncFunction]",AT="[object Function]",MT="[object GeneratorFunction]",$T="[object Proxy]";function IT(t){if(!PT(t))return!1;var e=NT(t);return e==AT||e==MT||e==OT||e==$T}var Gw=IT,LT=Gw,DT=yp;function zT(t){return t!=null&&DT(t.length)&&!LT(t)}var gd=zT,FT=Hw,BT=TT,UT=gd;function HT(t){return UT(t)?FT(t):BT(t)}var qa=HT,WT=d5,GT=qa;function VT(t,e){return t&&WT(t,e,GT)}var Vw=VT;function qT(t){return t}var qw=qT,KT=qw;function YT(t){return typeof t=="function"?t:KT}var XT=YT,ZT=Vw,JT=XT;function QT(t,e){return t&&ZT(t,JT(e))}var _p=QT,e3=Ww,t3=e3(Object.getPrototypeOf,Object),Sp=t3,r3=Vi,n3=Sp,i3=kn,o3="[object Object]",s3=Function.prototype,a3=Object.prototype,Kw=s3.toString,l3=a3.hasOwnProperty,c3=Kw.call(Object);function d3(t){if(!i3(t)||r3(t)!=o3)return!1;var e=n3(t);if(e===null)return!0;var r=l3.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&Kw.call(r)==c3}var u3=d3;function h3(t,e){for(var r=-1,n=t==null?0:t.length,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i}var Yw=h3;function f3(){this.__data__=[],this.size=0}var p3=f3;function m3(t,e){return t===e||t!==t&&e!==e}var kp=m3,g3=kp;function v3(t,e){for(var r=t.length;r--;)if(g3(t[r][0],e))return r;return-1}var vd=v3,y3=vd,x3=Array.prototype,b3=x3.splice;function w3(t){var e=this.__data__,r=y3(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():b3.call(e,r,1),--this.size,!0}var _3=w3,S3=vd;function k3(t){var e=this.__data__,r=S3(e,t);return r<0?void 0:e[r][1]}var j3=k3,C3=vd;function E3(t){return C3(this.__data__,t)>-1}var T3=E3,R3=vd;function N3(t,e){var r=this.__data__,n=R3(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}var P3=N3,O3=p3,A3=_3,M3=j3,$3=T3,I3=P3;function xs(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}xs.prototype.clear=O3;xs.prototype.delete=A3;xs.prototype.get=M3;xs.prototype.has=$3;xs.prototype.set=I3;var yd=xs,L3=yd;function D3(){this.__data__=new L3,this.size=0}var z3=D3;function F3(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}var B3=F3;function U3(t){return this.__data__.get(t)}var H3=U3;function W3(t){return this.__data__.has(t)}var G3=W3,V3=sn,q3=V3["__core-js_shared__"],K3=q3,Su=K3,S0=function(){var t=/[^.]+$/.exec(Su&&Su.keys&&Su.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function Y3(t){return!!S0&&S0 in t}var X3=Y3,Z3=Function.prototype,J3=Z3.toString;function Q3(t){if(t!=null){try{return J3.call(t)}catch{}try{return t+""}catch{}}return""}var Xw=Q3,eR=Gw,tR=X3,rR=ys,nR=Xw,iR=/[\\^$.*+?()[\]{}|]/g,oR=/^\[object .+?Constructor\]$/,sR=Function.prototype,aR=Object.prototype,lR=sR.toString,cR=aR.hasOwnProperty,dR=RegExp("^"+lR.call(cR).replace(iR,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function uR(t){if(!rR(t)||tR(t))return!1;var e=eR(t)?dR:oR;return e.test(nR(t))}var hR=uR;function fR(t,e){return t==null?void 0:t[e]}var pR=fR,mR=hR,gR=pR;function vR(t,e){var r=gR(t,e);return mR(r)?r:void 0}var qi=vR,yR=qi,xR=sn,bR=yR(xR,"Map"),jp=bR,wR=qi,_R=wR(Object,"create"),xd=_R,k0=xd;function SR(){this.__data__=k0?k0(null):{},this.size=0}var kR=SR;function jR(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var CR=jR,ER=xd,TR="__lodash_hash_undefined__",RR=Object.prototype,NR=RR.hasOwnProperty;function PR(t){var e=this.__data__;if(ER){var r=e[t];return r===TR?void 0:r}return NR.call(e,t)?e[t]:void 0}var OR=PR,AR=xd,MR=Object.prototype,$R=MR.hasOwnProperty;function IR(t){var e=this.__data__;return AR?e[t]!==void 0:$R.call(e,t)}var LR=IR,DR=xd,zR="__lodash_hash_undefined__";function FR(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=DR&&e===void 0?zR:e,this}var BR=FR,UR=kR,HR=CR,WR=OR,GR=LR,VR=BR;function bs(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}bs.prototype.clear=UR;bs.prototype.delete=HR;bs.prototype.get=WR;bs.prototype.has=GR;bs.prototype.set=VR;var qR=bs,j0=qR,KR=yd,YR=jp;function XR(){this.size=0,this.__data__={hash:new j0,map:new(YR||KR),string:new j0}}var ZR=XR;function JR(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var QR=JR,eN=QR;function tN(t,e){var r=t.__data__;return eN(e)?r[typeof e=="string"?"string":"hash"]:r.map}var bd=tN,rN=bd;function nN(t){var e=rN(this,t).delete(t);return this.size-=e?1:0,e}var iN=nN,oN=bd;function sN(t){return oN(this,t).get(t)}var aN=sN,lN=bd;function cN(t){return lN(this,t).has(t)}var dN=cN,uN=bd;function hN(t,e){var r=uN(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}var fN=hN,pN=ZR,mN=iN,gN=aN,vN=dN,yN=fN;function ws(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}ws.prototype.clear=pN;ws.prototype.delete=mN;ws.prototype.get=gN;ws.prototype.has=vN;ws.prototype.set=yN;var Cp=ws,xN=yd,bN=jp,wN=Cp,_N=200;function SN(t,e){var r=this.__data__;if(r instanceof xN){var n=r.__data__;if(!bN||n.length<_N-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new wN(n)}return r.set(t,e),this.size=r.size,this}var kN=SN,jN=yd,CN=z3,EN=B3,TN=H3,RN=G3,NN=kN;function _s(t){var e=this.__data__=new jN(t);this.size=e.size}_s.prototype.clear=CN;_s.prototype.delete=EN;_s.prototype.get=TN;_s.prototype.has=RN;_s.prototype.set=NN;var Ep=_s,PN="__lodash_hash_undefined__";function ON(t){return this.__data__.set(t,PN),this}var AN=ON;function MN(t){return this.__data__.has(t)}var $N=MN,IN=Cp,LN=AN,DN=$N;function Bc(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new IN;++e<r;)this.add(t[e])}Bc.prototype.add=Bc.prototype.push=LN;Bc.prototype.has=DN;var zN=Bc;function FN(t,e){for(var r=-1,n=t==null?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}var BN=FN;function UN(t,e){return t.has(e)}var HN=UN,WN=zN,GN=BN,VN=HN,qN=1,KN=2;function YN(t,e,r,n,i,o){var s=r&qN,l=t.length,c=e.length;if(l!=c&&!(s&&c>l))return!1;var d=o.get(t),h=o.get(e);if(d&&h)return d==e&&h==t;var f=-1,u=!0,p=r&KN?new WN:void 0;for(o.set(t,e),o.set(e,t);++f<l;){var g=t[f],m=e[f];if(n)var x=s?n(m,g,f,e,t,o):n(g,m,f,t,e,o);if(x!==void 0){if(x)continue;u=!1;break}if(p){if(!GN(e,function(v,y){if(!VN(p,y)&&(g===v||i(g,v,r,n,o)))return p.push(y)})){u=!1;break}}else if(!(g===m||i(g,m,r,n,o))){u=!1;break}}return o.delete(t),o.delete(e),u}var Zw=YN,XN=sn,ZN=XN.Uint8Array,Jw=ZN;function JN(t){var e=-1,r=Array(t.size);return t.forEach(function(n,i){r[++e]=[i,n]}),r}var QN=JN;function eP(t){var e=-1,r=Array(t.size);return t.forEach(function(n){r[++e]=n}),r}var tP=eP,C0=Va,E0=Jw,rP=kp,nP=Zw,iP=QN,oP=tP,sP=1,aP=2,lP="[object Boolean]",cP="[object Date]",dP="[object Error]",uP="[object Map]",hP="[object Number]",fP="[object RegExp]",pP="[object Set]",mP="[object String]",gP="[object Symbol]",vP="[object ArrayBuffer]",yP="[object DataView]",T0=C0?C0.prototype:void 0,ku=T0?T0.valueOf:void 0;function xP(t,e,r,n,i,o,s){switch(r){case yP:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case vP:return!(t.byteLength!=e.byteLength||!o(new E0(t),new E0(e)));case lP:case cP:case hP:return rP(+t,+e);case dP:return t.name==e.name&&t.message==e.message;case fP:case mP:return t==e+"";case uP:var l=iP;case pP:var c=n&sP;if(l||(l=oP),t.size!=e.size&&!c)return!1;var d=s.get(t);if(d)return d==e;n|=aP,s.set(t,e);var h=nP(l(t),l(e),n,i,o,s);return s.delete(t),h;case gP:if(ku)return ku.call(t)==ku.call(e)}return!1}var bP=xP;function wP(t,e){for(var r=-1,n=e.length,i=t.length;++r<n;)t[i+r]=e[r];return t}var Qw=wP,_P=Qw,SP=Vr;function kP(t,e,r){var n=e(t);return SP(t)?n:_P(n,r(t))}var e1=kP;function jP(t,e){for(var r=-1,n=t==null?0:t.length,i=0,o=[];++r<n;){var s=t[r];e(s,r,t)&&(o[i++]=s)}return o}var CP=jP;function EP(){return[]}var t1=EP,TP=CP,RP=t1,NP=Object.prototype,PP=NP.propertyIsEnumerable,R0=Object.getOwnPropertySymbols,OP=R0?function(t){return t==null?[]:(t=Object(t),TP(R0(t),function(e){return PP.call(t,e)}))}:RP,Tp=OP,AP=e1,MP=Tp,$P=qa;function IP(t){return AP(t,$P,MP)}var r1=IP,N0=r1,LP=1,DP=Object.prototype,zP=DP.hasOwnProperty;function FP(t,e,r,n,i,o){var s=r&LP,l=N0(t),c=l.length,d=N0(e),h=d.length;if(c!=h&&!s)return!1;for(var f=c;f--;){var u=l[f];if(!(s?u in e:zP.call(e,u)))return!1}var p=o.get(t),g=o.get(e);if(p&&g)return p==e&&g==t;var m=!0;o.set(t,e),o.set(e,t);for(var x=s;++f<c;){u=l[f];var v=t[u],y=e[u];if(n)var b=s?n(y,v,u,e,t,o):n(v,y,u,t,e,o);if(!(b===void 0?v===y||i(v,y,r,n,o):b)){m=!1;break}x||(x=u=="constructor")}if(m&&!x){var w=t.constructor,k=e.constructor;w!=k&&"constructor"in t&&"constructor"in e&&!(typeof w=="function"&&w instanceof w&&typeof k=="function"&&k instanceof k)&&(m=!1)}return o.delete(t),o.delete(e),m}var BP=FP,UP=qi,HP=sn,WP=UP(HP,"DataView"),GP=WP,VP=qi,qP=sn,KP=VP(qP,"Promise"),YP=KP,XP=qi,ZP=sn,JP=XP(ZP,"Set"),QP=JP,eO=qi,tO=sn,rO=eO(tO,"WeakMap"),nO=rO,qh=GP,Kh=jp,Yh=YP,Xh=QP,Zh=nO,n1=Vi,Ss=Xw,P0="[object Map]",iO="[object Object]",O0="[object Promise]",A0="[object Set]",M0="[object WeakMap]",$0="[object DataView]",oO=Ss(qh),sO=Ss(Kh),aO=Ss(Yh),lO=Ss(Xh),cO=Ss(Zh),Ei=n1;(qh&&Ei(new qh(new ArrayBuffer(1)))!=$0||Kh&&Ei(new Kh)!=P0||Yh&&Ei(Yh.resolve())!=O0||Xh&&Ei(new Xh)!=A0||Zh&&Ei(new Zh)!=M0)&&(Ei=function(t){var e=n1(t),r=e==iO?t.constructor:void 0,n=r?Ss(r):"";if(n)switch(n){case oO:return $0;case sO:return P0;case aO:return O0;case lO:return A0;case cO:return M0}return e});var wd=Ei,ju=Ep,dO=Zw,uO=bP,hO=BP,I0=wd,L0=Vr,D0=vp,fO=Uw,pO=1,z0="[object Arguments]",F0="[object Array]",Hl="[object Object]",mO=Object.prototype,B0=mO.hasOwnProperty;function gO(t,e,r,n,i,o){var s=L0(t),l=L0(e),c=s?F0:I0(t),d=l?F0:I0(e);c=c==z0?Hl:c,d=d==z0?Hl:d;var h=c==Hl,f=d==Hl,u=c==d;if(u&&D0(t)){if(!D0(e))return!1;s=!0,h=!1}if(u&&!h)return o||(o=new ju),s||fO(t)?dO(t,e,r,n,i,o):uO(t,e,c,r,n,i,o);if(!(r&pO)){var p=h&&B0.call(t,"__wrapped__"),g=f&&B0.call(e,"__wrapped__");if(p||g){var m=p?t.value():t,x=g?e.value():e;return o||(o=new ju),i(m,x,r,n,o)}}return u?(o||(o=new ju),hO(t,e,r,n,i,o)):!1}var vO=gO,yO=vO,U0=kn;function i1(t,e,r,n,i){return t===e?!0:t==null||e==null||!U0(t)&&!U0(e)?t!==t&&e!==e:yO(t,e,r,n,i1,i)}var o1=i1,xO=Ep,bO=o1,wO=1,_O=2;function SO(t,e,r,n){var i=r.length,o=i,s=!n;if(t==null)return!o;for(t=Object(t);i--;){var l=r[i];if(s&&l[2]?l[1]!==t[l[0]]:!(l[0]in t))return!1}for(;++i<o;){l=r[i];var c=l[0],d=t[c],h=l[1];if(s&&l[2]){if(d===void 0&&!(c in t))return!1}else{var f=new xO;if(n)var u=n(d,h,c,t,e,f);if(!(u===void 0?bO(h,d,wO|_O,n,f):u))return!1}}return!0}var kO=SO,jO=ys;function CO(t){return t===t&&!jO(t)}var s1=CO,EO=s1,TO=qa;function RO(t){for(var e=TO(t),r=e.length;r--;){var n=e[r],i=t[n];e[r]=[n,i,EO(i)]}return e}var NO=RO;function PO(t,e){return function(r){return r==null?!1:r[t]===e&&(e!==void 0||t in Object(r))}}var a1=PO,OO=kO,AO=NO,MO=a1;function $O(t){var e=AO(t);return e.length==1&&e[0][2]?MO(e[0][0],e[0][1]):function(r){return r===t||OO(r,t,e)}}var IO=$O,LO=Vi,DO=kn,zO="[object Symbol]";function FO(t){return typeof t=="symbol"||DO(t)&&LO(t)==zO}var Rp=FO,BO=Vr,UO=Rp,HO=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,WO=/^\w*$/;function GO(t,e){if(BO(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||UO(t)?!0:WO.test(t)||!HO.test(t)||e!=null&&t in Object(e)}var Np=GO,l1=Cp,VO="Expected a function";function Pp(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(VO);var r=function(){var n=arguments,i=e?e.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var s=t.apply(this,n);return r.cache=o.set(i,s)||o,s};return r.cache=new(Pp.Cache||l1),r}Pp.Cache=l1;var qO=Pp,KO=qO,YO=500;function XO(t){var e=KO(t,function(n){return r.size===YO&&r.clear(),n}),r=e.cache;return e}var ZO=XO,JO=ZO,QO=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,eA=/\\(\\)?/g,tA=JO(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(QO,function(r,n,i,o){e.push(i?o.replace(eA,"$1"):n||r)}),e}),rA=tA,H0=Va,nA=Yw,iA=Vr,oA=Rp,W0=H0?H0.prototype:void 0,G0=W0?W0.toString:void 0;function c1(t){if(typeof t=="string")return t;if(iA(t))return nA(t,c1)+"";if(oA(t))return G0?G0.call(t):"";var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}var sA=c1,aA=sA;function lA(t){return t==null?"":aA(t)}var cA=lA,dA=Vr,uA=Np,hA=rA,fA=cA;function pA(t,e){return dA(t)?t:uA(t,e)?[t]:hA(fA(t))}var d1=pA,mA=Rp;function gA(t){if(typeof t=="string"||mA(t))return t;var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}var _d=gA,vA=d1,yA=_d;function xA(t,e){e=vA(e,t);for(var r=0,n=e.length;t!=null&&r<n;)t=t[yA(e[r++])];return r&&r==n?t:void 0}var u1=xA,bA=u1;function wA(t,e,r){var n=t==null?void 0:bA(t,e);return n===void 0?r:n}var _A=wA;function SA(t,e){return t!=null&&e in Object(t)}var kA=SA,jA=d1,CA=Fw,EA=Vr,TA=Bw,RA=yp,NA=_d;function PA(t,e,r){e=jA(e,t);for(var n=-1,i=e.length,o=!1;++n<i;){var s=NA(e[n]);if(!(o=t!=null&&r(t,s)))break;t=t[s]}return o||++n!=i?o:(i=t==null?0:t.length,!!i&&RA(i)&&TA(s,i)&&(EA(t)||CA(t)))}var OA=PA,AA=kA,MA=OA;function $A(t,e){return t!=null&&MA(t,e,AA)}var IA=$A,LA=o1,DA=_A,zA=IA,FA=Np,BA=s1,UA=a1,HA=_d,WA=1,GA=2;function VA(t,e){return FA(t)&&BA(e)?UA(HA(t),e):function(r){var n=DA(r,t);return n===void 0&&n===e?zA(r,t):LA(e,n,WA|GA)}}var qA=VA;function KA(t){return function(e){return e==null?void 0:e[t]}}var YA=KA,XA=u1;function ZA(t){return function(e){return XA(e,t)}}var JA=ZA,QA=YA,e4=JA,t4=Np,r4=_d;function n4(t){return t4(t)?QA(r4(t)):e4(t)}var i4=n4,o4=IO,s4=qA,a4=qw,l4=Vr,c4=i4;function d4(t){return typeof t=="function"?t:t==null?a4:typeof t=="object"?l4(t)?s4(t[0],t[1]):o4(t):c4(t)}var u4=d4,h4=gd;function f4(t,e){return function(r,n){if(r==null)return r;if(!h4(r))return t(r,n);for(var i=r.length,o=e?i:-1,s=Object(r);(e?o--:++o<i)&&n(s[o],o,s)!==!1;);return r}}var p4=f4,m4=Vw,g4=p4,v4=g4(m4),y4=v4,x4=y4,b4=gd;function w4(t,e){var r=-1,n=b4(t)?Array(t.length):[];return x4(t,function(i,o,s){n[++r]=e(i,o,s)}),n}var _4=w4,S4=Yw,k4=u4,j4=_4,C4=Vr;function E4(t,e){var r=C4(t)?S4:j4;return r(t,k4(e))}var T4=E4;Object.defineProperty(Ga,"__esModule",{value:!0});Ga.flattenNames=void 0;var R4=o5,N4=Sd(R4),P4=_p,O4=Sd(P4),A4=u3,M4=Sd(A4),$4=T4,I4=Sd($4);function Sd(t){return t&&t.__esModule?t:{default:t}}var L4=Ga.flattenNames=function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=[];return(0,I4.default)(e,function(n){Array.isArray(n)?t(n).map(function(i){return r.push(i)}):(0,M4.default)(n)?(0,O4.default)(n,function(i,o){i===!0&&r.push(o),r.push(o+"-"+i)}):(0,N4.default)(n)&&r.push(n)}),r};Ga.default=L4;var Ka={};function D4(t,e){for(var r=-1,n=t==null?0:t.length;++r<n&&e(t[r],r,t)!==!1;);return t}var z4=D4,F4=qi,B4=function(){try{var t=F4(Object,"defineProperty");return t({},"",{}),t}catch{}}(),U4=B4,V0=U4;function H4(t,e,r){e=="__proto__"&&V0?V0(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}var h1=H4,W4=h1,G4=kp,V4=Object.prototype,q4=V4.hasOwnProperty;function K4(t,e,r){var n=t[e];(!(q4.call(t,e)&&G4(n,r))||r===void 0&&!(e in t))&&W4(t,e,r)}var f1=K4,Y4=f1,X4=h1;function Z4(t,e,r,n){var i=!r;r||(r={});for(var o=-1,s=e.length;++o<s;){var l=e[o],c=n?n(r[l],t[l],l,r,t):void 0;c===void 0&&(c=t[l]),i?X4(r,l,c):Y4(r,l,c)}return r}var kd=Z4,J4=kd,Q4=qa;function eM(t,e){return t&&J4(e,Q4(e),t)}var tM=eM;function rM(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}var nM=rM,iM=ys,oM=wp,sM=nM,aM=Object.prototype,lM=aM.hasOwnProperty;function cM(t){if(!iM(t))return sM(t);var e=oM(t),r=[];for(var n in t)n=="constructor"&&(e||!lM.call(t,n))||r.push(n);return r}var dM=cM,uM=Hw,hM=dM,fM=gd;function pM(t){return fM(t)?uM(t,!0):hM(t)}var Op=pM,mM=kd,gM=Op;function vM(t,e){return t&&mM(e,gM(e),t)}var yM=vM,Uc={exports:{}};Uc.exports;(function(t,e){var r=sn,n=e&&!e.nodeType&&e,i=n&&!0&&t&&!t.nodeType&&t,o=i&&i.exports===n,s=o?r.Buffer:void 0,l=s?s.allocUnsafe:void 0;function c(d,h){if(h)return d.slice();var f=d.length,u=l?l(f):new d.constructor(f);return d.copy(u),u}t.exports=c})(Uc,Uc.exports);var xM=Uc.exports;function bM(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}var wM=bM,_M=kd,SM=Tp;function kM(t,e){return _M(t,SM(t),e)}var jM=kM,CM=Qw,EM=Sp,TM=Tp,RM=t1,NM=Object.getOwnPropertySymbols,PM=NM?function(t){for(var e=[];t;)CM(e,TM(t)),t=EM(t);return e}:RM,p1=PM,OM=kd,AM=p1;function MM(t,e){return OM(t,AM(t),e)}var $M=MM,IM=e1,LM=p1,DM=Op;function zM(t){return IM(t,DM,LM)}var FM=zM,BM=Object.prototype,UM=BM.hasOwnProperty;function HM(t){var e=t.length,r=new t.constructor(e);return e&&typeof t[0]=="string"&&UM.call(t,"index")&&(r.index=t.index,r.input=t.input),r}var WM=HM,q0=Jw;function GM(t){var e=new t.constructor(t.byteLength);return new q0(e).set(new q0(t)),e}var Ap=GM,VM=Ap;function qM(t,e){var r=e?VM(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}var KM=qM,YM=/\w*$/;function XM(t){var e=new t.constructor(t.source,YM.exec(t));return e.lastIndex=t.lastIndex,e}var ZM=XM,K0=Va,Y0=K0?K0.prototype:void 0,X0=Y0?Y0.valueOf:void 0;function JM(t){return X0?Object(X0.call(t)):{}}var QM=JM,e6=Ap;function t6(t,e){var r=e?e6(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}var r6=t6,n6=Ap,i6=KM,o6=ZM,s6=QM,a6=r6,l6="[object Boolean]",c6="[object Date]",d6="[object Map]",u6="[object Number]",h6="[object RegExp]",f6="[object Set]",p6="[object String]",m6="[object Symbol]",g6="[object ArrayBuffer]",v6="[object DataView]",y6="[object Float32Array]",x6="[object Float64Array]",b6="[object Int8Array]",w6="[object Int16Array]",_6="[object Int32Array]",S6="[object Uint8Array]",k6="[object Uint8ClampedArray]",j6="[object Uint16Array]",C6="[object Uint32Array]";function E6(t,e,r){var n=t.constructor;switch(e){case g6:return n6(t);case l6:case c6:return new n(+t);case v6:return i6(t,r);case y6:case x6:case b6:case w6:case _6:case S6:case k6:case j6:case C6:return a6(t,r);case d6:return new n;case u6:case p6:return new n(t);case h6:return o6(t);case f6:return new n;case m6:return s6(t)}}var T6=E6,R6=ys,Z0=Object.create,N6=function(){function t(){}return function(e){if(!R6(e))return{};if(Z0)return Z0(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}(),P6=N6,O6=P6,A6=Sp,M6=wp;function $6(t){return typeof t.constructor=="function"&&!M6(t)?O6(A6(t)):{}}var I6=$6,L6=wd,D6=kn,z6="[object Map]";function F6(t){return D6(t)&&L6(t)==z6}var B6=F6,U6=B6,H6=xp,J0=bp,Q0=J0&&J0.isMap,W6=Q0?H6(Q0):U6,G6=W6,V6=wd,q6=kn,K6="[object Set]";function Y6(t){return q6(t)&&V6(t)==K6}var X6=Y6,Z6=X6,J6=xp,ev=bp,tv=ev&&ev.isSet,Q6=tv?J6(tv):Z6,e$=Q6,t$=Ep,r$=z4,n$=f1,i$=tM,o$=yM,s$=xM,a$=wM,l$=jM,c$=$M,d$=r1,u$=FM,h$=wd,f$=WM,p$=T6,m$=I6,g$=Vr,v$=vp,y$=G6,x$=ys,b$=e$,w$=qa,_$=Op,S$=1,k$=2,j$=4,m1="[object Arguments]",C$="[object Array]",E$="[object Boolean]",T$="[object Date]",R$="[object Error]",g1="[object Function]",N$="[object GeneratorFunction]",P$="[object Map]",O$="[object Number]",v1="[object Object]",A$="[object RegExp]",M$="[object Set]",$$="[object String]",I$="[object Symbol]",L$="[object WeakMap]",D$="[object ArrayBuffer]",z$="[object DataView]",F$="[object Float32Array]",B$="[object Float64Array]",U$="[object Int8Array]",H$="[object Int16Array]",W$="[object Int32Array]",G$="[object Uint8Array]",V$="[object Uint8ClampedArray]",q$="[object Uint16Array]",K$="[object Uint32Array]",nt={};nt[m1]=nt[C$]=nt[D$]=nt[z$]=nt[E$]=nt[T$]=nt[F$]=nt[B$]=nt[U$]=nt[H$]=nt[W$]=nt[P$]=nt[O$]=nt[v1]=nt[A$]=nt[M$]=nt[$$]=nt[I$]=nt[G$]=nt[V$]=nt[q$]=nt[K$]=!0;nt[R$]=nt[g1]=nt[L$]=!1;function ac(t,e,r,n,i,o){var s,l=e&S$,c=e&k$,d=e&j$;if(r&&(s=i?r(t,n,i,o):r(t)),s!==void 0)return s;if(!x$(t))return t;var h=g$(t);if(h){if(s=f$(t),!l)return a$(t,s)}else{var f=h$(t),u=f==g1||f==N$;if(v$(t))return s$(t,l);if(f==v1||f==m1||u&&!i){if(s=c||u?{}:m$(t),!l)return c?c$(t,o$(s,t)):l$(t,i$(s,t))}else{if(!nt[f])return i?t:{};s=p$(t,f,l)}}o||(o=new t$);var p=o.get(t);if(p)return p;o.set(t,s),b$(t)?t.forEach(function(x){s.add(ac(x,e,r,x,t,o))}):y$(t)&&t.forEach(function(x,v){s.set(v,ac(x,e,r,v,t,o))});var g=d?c?u$:d$:c?_$:w$,m=h?void 0:g(t);return r$(m||t,function(x,v){m&&(v=x,x=t[v]),n$(s,v,ac(x,e,r,v,t,o))}),s}var Y$=ac,X$=Y$,Z$=1,J$=4;function Q$(t){return X$(t,Z$|J$)}var eI=Q$;Object.defineProperty(Ka,"__esModule",{value:!0});Ka.mergeClasses=void 0;var tI=_p,rI=y1(tI),nI=eI,iI=y1(nI),oI=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t};function y1(t){return t&&t.__esModule?t:{default:t}}var sI=Ka.mergeClasses=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=e.default&&(0,iI.default)(e.default)||{};return r.map(function(i){var o=e[i];return o&&(0,rI.default)(o,function(s,l){n[l]||(n[l]={}),n[l]=oI({},n[l],o[l])}),i}),n};Ka.default=sI;var Ya={};Object.defineProperty(Ya,"__esModule",{value:!0});Ya.autoprefix=void 0;var aI=_p,rv=cI(aI),lI=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t};function cI(t){return t&&t.__esModule?t:{default:t}}var dI={borderRadius:function(e){return{msBorderRadius:e,MozBorderRadius:e,OBorderRadius:e,WebkitBorderRadius:e,borderRadius:e}},boxShadow:function(e){return{msBoxShadow:e,MozBoxShadow:e,OBoxShadow:e,WebkitBoxShadow:e,boxShadow:e}},userSelect:function(e){return{WebkitTouchCallout:e,KhtmlUserSelect:e,MozUserSelect:e,msUserSelect:e,WebkitUserSelect:e,userSelect:e}},flex:function(e){return{WebkitBoxFlex:e,MozBoxFlex:e,WebkitFlex:e,msFlex:e,flex:e}},flexBasis:function(e){return{WebkitFlexBasis:e,flexBasis:e}},justifyContent:function(e){return{WebkitJustifyContent:e,justifyContent:e}},transition:function(e){return{msTransition:e,MozTransition:e,OTransition:e,WebkitTransition:e,transition:e}},transform:function(e){return{msTransform:e,MozTransform:e,OTransform:e,WebkitTransform:e,transform:e}},absolute:function(e){var r=e&&e.split(" ");return{position:"absolute",top:r&&r[0],right:r&&r[1],bottom:r&&r[2],left:r&&r[3]}},extend:function(e,r){var n=r[e];return n||{extend:e}}},uI=Ya.autoprefix=function(e){var r={};return(0,rv.default)(e,function(n,i){var o={};(0,rv.default)(n,function(s,l){var c=dI[l];c?o=lI({},o,c(s)):o[l]=s}),r[i]=o}),r};Ya.default=uI;var Xa={};Object.defineProperty(Xa,"__esModule",{value:!0});Xa.hover=void 0;var hI=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},fI=A,Cu=pI(fI);function pI(t){return t&&t.__esModule?t:{default:t}}function mI(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function nv(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function gI(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var vI=Xa.hover=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"span";return function(n){gI(i,n);function i(){var o,s,l,c;mI(this,i);for(var d=arguments.length,h=Array(d),f=0;f<d;f++)h[f]=arguments[f];return c=(s=(l=nv(this,(o=i.__proto__||Object.getPrototypeOf(i)).call.apply(o,[this].concat(h))),l),l.state={hover:!1},l.handleMouseOver=function(){return l.setState({hover:!0})},l.handleMouseOut=function(){return l.setState({hover:!1})},l.render=function(){return Cu.default.createElement(r,{onMouseOver:l.handleMouseOver,onMouseOut:l.handleMouseOut},Cu.default.createElement(e,hI({},l.props,l.state)))},s),nv(l,c)}return i}(Cu.default.Component)};Xa.default=vI;var Za={};Object.defineProperty(Za,"__esModule",{value:!0});Za.active=void 0;var yI=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},xI=A,Eu=bI(xI);function bI(t){return t&&t.__esModule?t:{default:t}}function wI(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function iv(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function _I(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var SI=Za.active=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"span";return function(n){_I(i,n);function i(){var o,s,l,c;wI(this,i);for(var d=arguments.length,h=Array(d),f=0;f<d;f++)h[f]=arguments[f];return c=(s=(l=iv(this,(o=i.__proto__||Object.getPrototypeOf(i)).call.apply(o,[this].concat(h))),l),l.state={active:!1},l.handleMouseDown=function(){return l.setState({active:!0})},l.handleMouseUp=function(){return l.setState({active:!1})},l.render=function(){return Eu.default.createElement(r,{onMouseDown:l.handleMouseDown,onMouseUp:l.handleMouseUp},Eu.default.createElement(e,yI({},l.props,l.state)))},s),iv(l,c)}return i}(Eu.default.Component)};Za.default=SI;var Mp={};Object.defineProperty(Mp,"__esModule",{value:!0});var kI=function(e,r){var n={},i=function(s){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;n[s]=l};return e===0&&i("first-child"),e===r-1&&i("last-child"),(e===0||e%2===0)&&i("even"),Math.abs(e%2)===1&&i("odd"),i("nth-child",e),n};Mp.default=kI;Object.defineProperty(Cr,"__esModule",{value:!0});Cr.ReactCSS=Cr.loop=Cr.handleActive=$p=Cr.handleHover=Cr.hover=void 0;var jI=Ga,CI=ks(jI),EI=Ka,TI=ks(EI),RI=Ya,NI=ks(RI),PI=Xa,x1=ks(PI),OI=Za,AI=ks(OI),MI=Mp,$I=ks(MI);function ks(t){return t&&t.__esModule?t:{default:t}}Cr.hover=x1.default;var $p=Cr.handleHover=x1.default;Cr.handleActive=AI.default;Cr.loop=$I.default;var II=Cr.ReactCSS=function(e){for(var r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];var o=(0,CI.default)(n),s=(0,TI.default)(e,o);return(0,NI.default)(s)},De=Cr.default=II,LI=function(e,r,n,i,o){var s=o.clientWidth,l=o.clientHeight,c=typeof e.pageX=="number"?e.pageX:e.touches[0].pageX,d=typeof e.pageY=="number"?e.pageY:e.touches[0].pageY,h=c-(o.getBoundingClientRect().left+window.pageXOffset),f=d-(o.getBoundingClientRect().top+window.pageYOffset);if(n==="vertical"){var u=void 0;if(f<0?u=0:f>l?u=1:u=Math.round(f*100/l)/100,r.a!==u)return{h:r.h,s:r.s,l:r.l,a:u,source:"rgb"}}else{var p=void 0;if(h<0?p=0:h>s?p=1:p=Math.round(h*100/s)/100,i!==p)return{h:r.h,s:r.s,l:r.l,a:p,source:"rgb"}}return null},Tu={},DI=function(e,r,n,i){if(typeof document>"u"&&!i)return null;var o=i?new i:document.createElement("canvas");o.width=n*2,o.height=n*2;var s=o.getContext("2d");return s?(s.fillStyle=e,s.fillRect(0,0,o.width,o.height),s.fillStyle=r,s.fillRect(0,0,n,n),s.translate(n,n),s.fillRect(0,0,n,n),o.toDataURL()):null},zI=function(e,r,n,i){var o=e+"-"+r+"-"+n+(i?"-server":"");if(Tu[o])return Tu[o];var s=DI(e,r,n,i);return Tu[o]=s,s},ov=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},js=function(e){var r=e.white,n=e.grey,i=e.size,o=e.renderers,s=e.borderRadius,l=e.boxShadow,c=e.children,d=De({default:{grid:{borderRadius:s,boxShadow:l,absolute:"0px 0px 0px 0px",background:"url("+zI(r,n,i,o.canvas)+") center left"}}});return A.isValidElement(c)?$.cloneElement(c,ov({},c.props,{style:ov({},c.props.style,d.grid)})):$.createElement("div",{style:d.grid})};js.defaultProps={size:8,white:"transparent",grey:"rgba(0,0,0,.08)",renderers:{}};var FI=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},BI=function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();function UI(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function sv(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function HI(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var Ip=function(t){HI(e,t);function e(){var r,n,i,o;UI(this,e);for(var s=arguments.length,l=Array(s),c=0;c<s;c++)l[c]=arguments[c];return o=(n=(i=sv(this,(r=e.__proto__||Object.getPrototypeOf(e)).call.apply(r,[this].concat(l))),i),i.handleChange=function(d){var h=LI(d,i.props.hsl,i.props.direction,i.props.a,i.container);h&&typeof i.props.onChange=="function"&&i.props.onChange(h,d)},i.handleMouseDown=function(d){i.handleChange(d),window.addEventListener("mousemove",i.handleChange),window.addEventListener("mouseup",i.handleMouseUp)},i.handleMouseUp=function(){i.unbindEventListeners()},i.unbindEventListeners=function(){window.removeEventListener("mousemove",i.handleChange),window.removeEventListener("mouseup",i.handleMouseUp)},n),sv(i,o)}return BI(e,[{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"render",value:function(){var n=this,i=this.props.rgb,o=De({default:{alpha:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius},checkboard:{absolute:"0px 0px 0px 0px",overflow:"hidden",borderRadius:this.props.radius},gradient:{absolute:"0px 0px 0px 0px",background:"linear-gradient(to right, rgba("+i.r+","+i.g+","+i.b+`, 0) 0%,
           rgba(`+i.r+","+i.g+","+i.b+", 1) 100%)",boxShadow:this.props.shadow,borderRadius:this.props.radius},container:{position:"relative",height:"100%",margin:"0 3px"},pointer:{position:"absolute",left:i.a*100+"%"},slider:{width:"4px",borderRadius:"1px",height:"8px",boxShadow:"0 0 2px rgba(0, 0, 0, .6)",background:"#fff",marginTop:"1px",transform:"translateX(-2px)"}},vertical:{gradient:{background:"linear-gradient(to bottom, rgba("+i.r+","+i.g+","+i.b+`, 0) 0%,
           rgba(`+i.r+","+i.g+","+i.b+", 1) 100%)"},pointer:{left:0,top:i.a*100+"%"}},overwrite:FI({},this.props.style)},{vertical:this.props.direction==="vertical",overwrite:!0});return $.createElement("div",{style:o.alpha},$.createElement("div",{style:o.checkboard},$.createElement(js,{renderers:this.props.renderers})),$.createElement("div",{style:o.gradient}),$.createElement("div",{style:o.container,ref:function(l){return n.container=l},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},$.createElement("div",{style:o.pointer},this.props.pointer?$.createElement(this.props.pointer,this.props):$.createElement("div",{style:o.slider}))))}}]),e}(A.PureComponent||A.Component),WI=function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();function GI(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function VI(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function qI(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function KI(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var YI=1,b1=38,XI=40,ZI=[b1,XI],JI=function(e){return ZI.indexOf(e)>-1},QI=function(e){return Number(String(e).replace(/%/g,""))},eL=1,Xe=function(t){KI(e,t);function e(r){VI(this,e);var n=qI(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.handleBlur=function(){n.state.blurValue&&n.setState({value:n.state.blurValue,blurValue:null})},n.handleChange=function(i){n.setUpdatedValue(i.target.value,i)},n.handleKeyDown=function(i){var o=QI(i.target.value);if(!isNaN(o)&&JI(i.keyCode)){var s=n.getArrowOffset(),l=i.keyCode===b1?o+s:o-s;n.setUpdatedValue(l,i)}},n.handleDrag=function(i){if(n.props.dragLabel){var o=Math.round(n.props.value+i.movementX);o>=0&&o<=n.props.dragMax&&n.props.onChange&&n.props.onChange(n.getValueObjectWithLabel(o),i)}},n.handleMouseDown=function(i){n.props.dragLabel&&(i.preventDefault(),n.handleDrag(i),window.addEventListener("mousemove",n.handleDrag),window.addEventListener("mouseup",n.handleMouseUp))},n.handleMouseUp=function(){n.unbindEventListeners()},n.unbindEventListeners=function(){window.removeEventListener("mousemove",n.handleDrag),window.removeEventListener("mouseup",n.handleMouseUp)},n.state={value:String(r.value).toUpperCase(),blurValue:String(r.value).toUpperCase()},n.inputId="rc-editable-input-"+eL++,n}return WI(e,[{key:"componentDidUpdate",value:function(n,i){this.props.value!==this.state.value&&(n.value!==this.props.value||i.value!==this.state.value)&&(this.input===document.activeElement?this.setState({blurValue:String(this.props.value).toUpperCase()}):this.setState({value:String(this.props.value).toUpperCase(),blurValue:!this.state.blurValue&&String(this.props.value).toUpperCase()}))}},{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"getValueObjectWithLabel",value:function(n){return GI({},this.props.label,n)}},{key:"getArrowOffset",value:function(){return this.props.arrowOffset||YI}},{key:"setUpdatedValue",value:function(n,i){var o=this.props.label?this.getValueObjectWithLabel(n):n;this.props.onChange&&this.props.onChange(o,i),this.setState({value:n})}},{key:"render",value:function(){var n=this,i=De({default:{wrap:{position:"relative"}},"user-override":{wrap:this.props.style&&this.props.style.wrap?this.props.style.wrap:{},input:this.props.style&&this.props.style.input?this.props.style.input:{},label:this.props.style&&this.props.style.label?this.props.style.label:{}},"dragLabel-true":{label:{cursor:"ew-resize"}}},{"user-override":!0},this.props);return $.createElement("div",{style:i.wrap},$.createElement("input",{id:this.inputId,style:i.input,ref:function(s){return n.input=s},value:this.state.value,onKeyDown:this.handleKeyDown,onChange:this.handleChange,onBlur:this.handleBlur,placeholder:this.props.placeholder,spellCheck:"false"}),this.props.label&&!this.props.hideLabel?$.createElement("label",{htmlFor:this.inputId,style:i.label,onMouseDown:this.handleMouseDown},this.props.label):null)}}]),e}(A.PureComponent||A.Component),tL=function(e,r,n,i){var o=i.clientWidth,s=i.clientHeight,l=typeof e.pageX=="number"?e.pageX:e.touches[0].pageX,c=typeof e.pageY=="number"?e.pageY:e.touches[0].pageY,d=l-(i.getBoundingClientRect().left+window.pageXOffset),h=c-(i.getBoundingClientRect().top+window.pageYOffset);if(r==="vertical"){var f=void 0;if(h<0)f=359;else if(h>s)f=0;else{var u=-(h*100/s)+100;f=360*u/100}if(n.h!==f)return{h:f,s:n.s,l:n.l,a:n.a,source:"hsl"}}else{var p=void 0;if(d<0)p=0;else if(d>o)p=359;else{var g=d*100/o;p=360*g/100}if(n.h!==p)return{h:p,s:n.s,l:n.l,a:n.a,source:"hsl"}}return null},rL=function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();function nL(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function av(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function iL(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var Cs=function(t){iL(e,t);function e(){var r,n,i,o;nL(this,e);for(var s=arguments.length,l=Array(s),c=0;c<s;c++)l[c]=arguments[c];return o=(n=(i=av(this,(r=e.__proto__||Object.getPrototypeOf(e)).call.apply(r,[this].concat(l))),i),i.handleChange=function(d){var h=tL(d,i.props.direction,i.props.hsl,i.container);h&&typeof i.props.onChange=="function"&&i.props.onChange(h,d)},i.handleMouseDown=function(d){i.handleChange(d),window.addEventListener("mousemove",i.handleChange),window.addEventListener("mouseup",i.handleMouseUp)},i.handleMouseUp=function(){i.unbindEventListeners()},n),av(i,o)}return rL(e,[{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"unbindEventListeners",value:function(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}},{key:"render",value:function(){var n=this,i=this.props.direction,o=i===void 0?"horizontal":i,s=De({default:{hue:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius,boxShadow:this.props.shadow},container:{padding:"0 2px",position:"relative",height:"100%",borderRadius:this.props.radius},pointer:{position:"absolute",left:this.props.hsl.h*100/360+"%"},slider:{marginTop:"1px",width:"4px",borderRadius:"1px",height:"8px",boxShadow:"0 0 2px rgba(0, 0, 0, .6)",background:"#fff",transform:"translateX(-2px)"}},vertical:{pointer:{left:"0px",top:-(this.props.hsl.h*100/360)+100+"%"}}},{vertical:o==="vertical"});return $.createElement("div",{style:s.hue},$.createElement("div",{className:"hue-"+o,style:s.container,ref:function(c){return n.container=c},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},$.createElement("style",null,`
            .hue-horizontal {
              background: linear-gradient(to right, #f00 0%, #ff0 17%, #0f0
                33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
              background: -webkit-linear-gradient(to right, #f00 0%, #ff0
                17%, #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
            }

            .hue-vertical {
              background: linear-gradient(to top, #f00 0%, #ff0 17%, #0f0 33%,
                #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
              background: -webkit-linear-gradient(to top, #f00 0%, #ff0 17%,
                #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
            }
          `),$.createElement("div",{style:s.pointer},this.props.pointer?$.createElement(this.props.pointer,this.props):$.createElement("div",{style:s.slider}))))}}]),e}(A.PureComponent||A.Component),w1={exports:{}},oL="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",sL=oL,aL=sL;function _1(){}function S1(){}S1.resetWarningCache=_1;var lL=function(){function t(n,i,o,s,l,c){if(c!==aL){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}t.isRequired=t;function e(){return t}var r={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:S1,resetWarningCache:_1};return r.PropTypes=r,r};w1.exports=lL();var cL=w1.exports;const ye=Xc(cL);function dL(){this.__data__=[],this.size=0}function Ja(t,e){return t===e||t!==t&&e!==e}function jd(t,e){for(var r=t.length;r--;)if(Ja(t[r][0],e))return r;return-1}var uL=Array.prototype,hL=uL.splice;function fL(t){var e=this.__data__,r=jd(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():hL.call(e,r,1),--this.size,!0}function pL(t){var e=this.__data__,r=jd(e,t);return r<0?void 0:e[r][1]}function mL(t){return jd(this.__data__,t)>-1}function gL(t,e){var r=this.__data__,n=jd(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}function jn(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}jn.prototype.clear=dL;jn.prototype.delete=fL;jn.prototype.get=pL;jn.prototype.has=mL;jn.prototype.set=gL;function vL(){this.__data__=new jn,this.size=0}function yL(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}function xL(t){return this.__data__.get(t)}function bL(t){return this.__data__.has(t)}var k1=typeof global=="object"&&global&&global.Object===Object&&global,wL=typeof self=="object"&&self&&self.Object===Object&&self,qr=k1||wL||Function("return this")(),ii=qr.Symbol,j1=Object.prototype,_L=j1.hasOwnProperty,SL=j1.toString,Hs=ii?ii.toStringTag:void 0;function kL(t){var e=_L.call(t,Hs),r=t[Hs];try{t[Hs]=void 0;var n=!0}catch{}var i=SL.call(t);return n&&(e?t[Hs]=r:delete t[Hs]),i}var jL=Object.prototype,CL=jL.toString;function EL(t){return CL.call(t)}var TL="[object Null]",RL="[object Undefined]",lv=ii?ii.toStringTag:void 0;function Ki(t){return t==null?t===void 0?RL:TL:lv&&lv in Object(t)?kL(t):EL(t)}function Pr(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var NL="[object AsyncFunction]",PL="[object Function]",OL="[object GeneratorFunction]",AL="[object Proxy]";function Lp(t){if(!Pr(t))return!1;var e=Ki(t);return e==PL||e==OL||e==NL||e==AL}var Ru=qr["__core-js_shared__"],cv=function(){var t=/[^.]+$/.exec(Ru&&Ru.keys&&Ru.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function ML(t){return!!cv&&cv in t}var $L=Function.prototype,IL=$L.toString;function Yi(t){if(t!=null){try{return IL.call(t)}catch{}try{return t+""}catch{}}return""}var LL=/[\\^$.*+?()[\]{}|]/g,DL=/^\[object .+?Constructor\]$/,zL=Function.prototype,FL=Object.prototype,BL=zL.toString,UL=FL.hasOwnProperty,HL=RegExp("^"+BL.call(UL).replace(LL,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function WL(t){if(!Pr(t)||ML(t))return!1;var e=Lp(t)?HL:DL;return e.test(Yi(t))}function GL(t,e){return t==null?void 0:t[e]}function Xi(t,e){var r=GL(t,e);return WL(r)?r:void 0}var Ia=Xi(qr,"Map"),La=Xi(Object,"create");function VL(){this.__data__=La?La(null):{},this.size=0}function qL(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var KL="__lodash_hash_undefined__",YL=Object.prototype,XL=YL.hasOwnProperty;function ZL(t){var e=this.__data__;if(La){var r=e[t];return r===KL?void 0:r}return XL.call(e,t)?e[t]:void 0}var JL=Object.prototype,QL=JL.hasOwnProperty;function eD(t){var e=this.__data__;return La?e[t]!==void 0:QL.call(e,t)}var tD="__lodash_hash_undefined__";function rD(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=La&&e===void 0?tD:e,this}function Hi(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Hi.prototype.clear=VL;Hi.prototype.delete=qL;Hi.prototype.get=ZL;Hi.prototype.has=eD;Hi.prototype.set=rD;function nD(){this.size=0,this.__data__={hash:new Hi,map:new(Ia||jn),string:new Hi}}function iD(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function Cd(t,e){var r=t.__data__;return iD(e)?r[typeof e=="string"?"string":"hash"]:r.map}function oD(t){var e=Cd(this,t).delete(t);return this.size-=e?1:0,e}function sD(t){return Cd(this,t).get(t)}function aD(t){return Cd(this,t).has(t)}function lD(t,e){var r=Cd(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}function Cn(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Cn.prototype.clear=nD;Cn.prototype.delete=oD;Cn.prototype.get=sD;Cn.prototype.has=aD;Cn.prototype.set=lD;var cD=200;function dD(t,e){var r=this.__data__;if(r instanceof jn){var n=r.__data__;if(!Ia||n.length<cD-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new Cn(n)}return r.set(t,e),this.size=r.size,this}function on(t){var e=this.__data__=new jn(t);this.size=e.size}on.prototype.clear=vL;on.prototype.delete=yL;on.prototype.get=xL;on.prototype.has=bL;on.prototype.set=dD;var Hc=function(){try{var t=Xi(Object,"defineProperty");return t({},"",{}),t}catch{}}();function Dp(t,e,r){e=="__proto__"&&Hc?Hc(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}function Jh(t,e,r){(r!==void 0&&!Ja(t[e],r)||r===void 0&&!(e in t))&&Dp(t,e,r)}function uD(t){return function(e,r,n){for(var i=-1,o=Object(e),s=n(e),l=s.length;l--;){var c=s[++i];if(r(o[c],c,o)===!1)break}return e}}var C1=uD(),E1=typeof mr=="object"&&mr&&!mr.nodeType&&mr,dv=E1&&typeof gr=="object"&&gr&&!gr.nodeType&&gr,hD=dv&&dv.exports===E1,uv=hD?qr.Buffer:void 0;uv&&uv.allocUnsafe;function fD(t,e){return t.slice()}var Wc=qr.Uint8Array;function pD(t){var e=new t.constructor(t.byteLength);return new Wc(e).set(new Wc(t)),e}function mD(t,e){var r=pD(t.buffer);return new t.constructor(r,t.byteOffset,t.length)}function gD(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}var hv=Object.create,vD=function(){function t(){}return function(e){if(!Pr(e))return{};if(hv)return hv(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}();function T1(t,e){return function(r){return t(e(r))}}var R1=T1(Object.getPrototypeOf,Object),yD=Object.prototype;function zp(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||yD;return t===r}function xD(t){return typeof t.constructor=="function"&&!zp(t)?vD(R1(t)):{}}function oi(t){return t!=null&&typeof t=="object"}var bD="[object Arguments]";function fv(t){return oi(t)&&Ki(t)==bD}var N1=Object.prototype,wD=N1.hasOwnProperty,_D=N1.propertyIsEnumerable,Gc=fv(function(){return arguments}())?fv:function(t){return oi(t)&&wD.call(t,"callee")&&!_D.call(t,"callee")},xr=Array.isArray,SD=9007199254740991;function Fp(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=SD}function Es(t){return t!=null&&Fp(t.length)&&!Lp(t)}function kD(t){return oi(t)&&Es(t)}function jD(){return!1}var P1=typeof mr=="object"&&mr&&!mr.nodeType&&mr,pv=P1&&typeof gr=="object"&&gr&&!gr.nodeType&&gr,CD=pv&&pv.exports===P1,mv=CD?qr.Buffer:void 0,ED=mv?mv.isBuffer:void 0,Vc=ED||jD,TD="[object Object]",RD=Function.prototype,ND=Object.prototype,O1=RD.toString,PD=ND.hasOwnProperty,OD=O1.call(Object);function AD(t){if(!oi(t)||Ki(t)!=TD)return!1;var e=R1(t);if(e===null)return!0;var r=PD.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&O1.call(r)==OD}var MD="[object Arguments]",$D="[object Array]",ID="[object Boolean]",LD="[object Date]",DD="[object Error]",zD="[object Function]",FD="[object Map]",BD="[object Number]",UD="[object Object]",HD="[object RegExp]",WD="[object Set]",GD="[object String]",VD="[object WeakMap]",qD="[object ArrayBuffer]",KD="[object DataView]",YD="[object Float32Array]",XD="[object Float64Array]",ZD="[object Int8Array]",JD="[object Int16Array]",QD="[object Int32Array]",e8="[object Uint8Array]",t8="[object Uint8ClampedArray]",r8="[object Uint16Array]",n8="[object Uint32Array]",at={};at[YD]=at[XD]=at[ZD]=at[JD]=at[QD]=at[e8]=at[t8]=at[r8]=at[n8]=!0;at[MD]=at[$D]=at[qD]=at[ID]=at[KD]=at[LD]=at[DD]=at[zD]=at[FD]=at[BD]=at[UD]=at[HD]=at[WD]=at[GD]=at[VD]=!1;function i8(t){return oi(t)&&Fp(t.length)&&!!at[Ki(t)]}function o8(t){return function(e){return t(e)}}var A1=typeof mr=="object"&&mr&&!mr.nodeType&&mr,pa=A1&&typeof gr=="object"&&gr&&!gr.nodeType&&gr,s8=pa&&pa.exports===A1,Nu=s8&&k1.process,gv=function(){try{var t=pa&&pa.require&&pa.require("util").types;return t||Nu&&Nu.binding&&Nu.binding("util")}catch{}}(),vv=gv&&gv.isTypedArray,Bp=vv?o8(vv):i8;function Qh(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}var a8=Object.prototype,l8=a8.hasOwnProperty;function c8(t,e,r){var n=t[e];(!(l8.call(t,e)&&Ja(n,r))||r===void 0&&!(e in t))&&Dp(t,e,r)}function d8(t,e,r,n){var i=!r;r||(r={});for(var o=-1,s=e.length;++o<s;){var l=e[o],c=void 0;c===void 0&&(c=t[l]),i?Dp(r,l,c):c8(r,l,c)}return r}function u8(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}var h8=9007199254740991,f8=/^(?:0|[1-9]\d*)$/;function Up(t,e){var r=typeof t;return e=e??h8,!!e&&(r=="number"||r!="symbol"&&f8.test(t))&&t>-1&&t%1==0&&t<e}var p8=Object.prototype,m8=p8.hasOwnProperty;function M1(t,e){var r=xr(t),n=!r&&Gc(t),i=!r&&!n&&Vc(t),o=!r&&!n&&!i&&Bp(t),s=r||n||i||o,l=s?u8(t.length,String):[],c=l.length;for(var d in t)(e||m8.call(t,d))&&!(s&&(d=="length"||i&&(d=="offset"||d=="parent")||o&&(d=="buffer"||d=="byteLength"||d=="byteOffset")||Up(d,c)))&&l.push(d);return l}function g8(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}var v8=Object.prototype,y8=v8.hasOwnProperty;function x8(t){if(!Pr(t))return g8(t);var e=zp(t),r=[];for(var n in t)n=="constructor"&&(e||!y8.call(t,n))||r.push(n);return r}function $1(t){return Es(t)?M1(t,!0):x8(t)}function b8(t){return d8(t,$1(t))}function w8(t,e,r,n,i,o,s){var l=Qh(t,r),c=Qh(e,r),d=s.get(c);if(d){Jh(t,r,d);return}var h=o?o(l,c,r+"",t,e,s):void 0,f=h===void 0;if(f){var u=xr(c),p=!u&&Vc(c),g=!u&&!p&&Bp(c);h=c,u||p||g?xr(l)?h=l:kD(l)?h=gD(l):p?(f=!1,h=fD(c)):g?(f=!1,h=mD(c)):h=[]:AD(c)||Gc(c)?(h=l,Gc(l)?h=b8(l):(!Pr(l)||Lp(l))&&(h=xD(c))):f=!1}f&&(s.set(c,h),i(h,c,n,o,s),s.delete(c)),Jh(t,r,h)}function I1(t,e,r,n,i){t!==e&&C1(e,function(o,s){if(i||(i=new on),Pr(o))w8(t,e,s,r,I1,n,i);else{var l=n?n(Qh(t,s),o,s+"",t,e,i):void 0;l===void 0&&(l=o),Jh(t,s,l)}},$1)}function Ed(t){return t}function _8(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}var yv=Math.max;function S8(t,e,r){return e=yv(e===void 0?t.length-1:e,0),function(){for(var n=arguments,i=-1,o=yv(n.length-e,0),s=Array(o);++i<o;)s[i]=n[e+i];i=-1;for(var l=Array(e+1);++i<e;)l[i]=n[i];return l[e]=r(s),_8(t,this,l)}}function k8(t){return function(){return t}}var j8=Hc?function(t,e){return Hc(t,"toString",{configurable:!0,enumerable:!1,value:k8(e),writable:!0})}:Ed,C8=800,E8=16,T8=Date.now;function R8(t){var e=0,r=0;return function(){var n=T8(),i=E8-(n-r);if(r=n,i>0){if(++e>=C8)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var N8=R8(j8);function P8(t,e){return N8(S8(t,e,Ed),t+"")}function O8(t,e,r){if(!Pr(r))return!1;var n=typeof e;return(n=="number"?Es(r)&&Up(e,r.length):n=="string"&&e in r)?Ja(r[e],t):!1}function A8(t){return P8(function(e,r){var n=-1,i=r.length,o=i>1?r[i-1]:void 0,s=i>2?r[2]:void 0;for(o=t.length>3&&typeof o=="function"?(i--,o):void 0,s&&O8(r[0],r[1],s)&&(o=i<3?void 0:o,i=1),e=Object(e);++n<i;){var l=r[n];l&&t(e,l,n,o)}return e})}var ar=A8(function(t,e,r){I1(t,e,r)}),Qa=function(e){var r=e.zDepth,n=e.radius,i=e.background,o=e.children,s=e.styles,l=s===void 0?{}:s,c=De(ar({default:{wrap:{position:"relative",display:"inline-block"},content:{position:"relative"},bg:{absolute:"0px 0px 0px 0px",boxShadow:"0 "+r+"px "+r*4+"px rgba(0,0,0,.24)",borderRadius:n,background:i}},"zDepth-0":{bg:{boxShadow:"none"}},"zDepth-1":{bg:{boxShadow:"0 2px 10px rgba(0,0,0,.12), 0 2px 5px rgba(0,0,0,.16)"}},"zDepth-2":{bg:{boxShadow:"0 6px 20px rgba(0,0,0,.19), 0 8px 17px rgba(0,0,0,.2)"}},"zDepth-3":{bg:{boxShadow:"0 17px 50px rgba(0,0,0,.19), 0 12px 15px rgba(0,0,0,.24)"}},"zDepth-4":{bg:{boxShadow:"0 25px 55px rgba(0,0,0,.21), 0 16px 28px rgba(0,0,0,.22)"}},"zDepth-5":{bg:{boxShadow:"0 40px 77px rgba(0,0,0,.22), 0 27px 24px rgba(0,0,0,.2)"}},square:{bg:{borderRadius:"0"}},circle:{bg:{borderRadius:"50%"}}},l),{"zDepth-1":r===1});return $.createElement("div",{style:c.wrap},$.createElement("div",{style:c.bg}),$.createElement("div",{style:c.content},o))};Qa.propTypes={background:ye.string,zDepth:ye.oneOf([0,1,2,3,4,5]),radius:ye.number,styles:ye.object};Qa.defaultProps={background:"#fff",zDepth:1,radius:2,styles:{}};var Pu=function(){return qr.Date.now()},M8=/\s/;function $8(t){for(var e=t.length;e--&&M8.test(t.charAt(e)););return e}var I8=/^\s+/;function L8(t){return t&&t.slice(0,$8(t)+1).replace(I8,"")}var D8="[object Symbol]";function Td(t){return typeof t=="symbol"||oi(t)&&Ki(t)==D8}var xv=NaN,z8=/^[-+]0x[0-9a-f]+$/i,F8=/^0b[01]+$/i,B8=/^0o[0-7]+$/i,U8=parseInt;function bv(t){if(typeof t=="number")return t;if(Td(t))return xv;if(Pr(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=Pr(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=L8(t);var r=F8.test(t);return r||B8.test(t)?U8(t.slice(2),r?2:8):z8.test(t)?xv:+t}var H8="Expected a function",W8=Math.max,G8=Math.min;function L1(t,e,r){var n,i,o,s,l,c,d=0,h=!1,f=!1,u=!0;if(typeof t!="function")throw new TypeError(H8);e=bv(e)||0,Pr(r)&&(h=!!r.leading,f="maxWait"in r,o=f?W8(bv(r.maxWait)||0,e):o,u="trailing"in r?!!r.trailing:u);function p(S){var C=n,T=i;return n=i=void 0,d=S,s=t.apply(T,C),s}function g(S){return d=S,l=setTimeout(v,e),h?p(S):s}function m(S){var C=S-c,T=S-d,R=e-C;return f?G8(R,o-T):R}function x(S){var C=S-c,T=S-d;return c===void 0||C>=e||C<0||f&&T>=o}function v(){var S=Pu();if(x(S))return y(S);l=setTimeout(v,m(S))}function y(S){return l=void 0,u&&n?p(S):(n=i=void 0,s)}function b(){l!==void 0&&clearTimeout(l),d=0,n=c=i=l=void 0}function w(){return l===void 0?s:y(Pu())}function k(){var S=Pu(),C=x(S);if(n=arguments,i=this,c=S,C){if(l===void 0)return g(c);if(f)return clearTimeout(l),l=setTimeout(v,e),p(c)}return l===void 0&&(l=setTimeout(v,e)),s}return k.cancel=b,k.flush=w,k}var V8="Expected a function";function q8(t,e,r){var n=!0,i=!0;if(typeof t!="function")throw new TypeError(V8);return Pr(r)&&(n="leading"in r?!!r.leading:n,i="trailing"in r?!!r.trailing:i),L1(t,e,{leading:n,maxWait:e,trailing:i})}var K8=function(e,r,n){var i=n.getBoundingClientRect(),o=i.width,s=i.height,l=typeof e.pageX=="number"?e.pageX:e.touches[0].pageX,c=typeof e.pageY=="number"?e.pageY:e.touches[0].pageY,d=l-(n.getBoundingClientRect().left+window.pageXOffset),h=c-(n.getBoundingClientRect().top+window.pageYOffset);d<0?d=0:d>o&&(d=o),h<0?h=0:h>s&&(h=s);var f=d/o,u=1-h/s;return{h:r.h,s:f,v:u,a:r.a,source:"hsv"}},Y8=function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();function X8(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Z8(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function J8(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var Rd=function(t){J8(e,t);function e(r){X8(this,e);var n=Z8(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,r));return n.handleChange=function(i){typeof n.props.onChange=="function"&&n.throttle(n.props.onChange,K8(i,n.props.hsl,n.container),i)},n.handleMouseDown=function(i){n.handleChange(i);var o=n.getContainerRenderWindow();o.addEventListener("mousemove",n.handleChange),o.addEventListener("mouseup",n.handleMouseUp)},n.handleMouseUp=function(){n.unbindEventListeners()},n.throttle=q8(function(i,o,s){i(o,s)},50),n}return Y8(e,[{key:"componentWillUnmount",value:function(){this.throttle.cancel(),this.unbindEventListeners()}},{key:"getContainerRenderWindow",value:function(){for(var n=this.container,i=window;!i.document.contains(n)&&i.parent!==i;)i=i.parent;return i}},{key:"unbindEventListeners",value:function(){var n=this.getContainerRenderWindow();n.removeEventListener("mousemove",this.handleChange),n.removeEventListener("mouseup",this.handleMouseUp)}},{key:"render",value:function(){var n=this,i=this.props.style||{},o=i.color,s=i.white,l=i.black,c=i.pointer,d=i.circle,h=De({default:{color:{absolute:"0px 0px 0px 0px",background:"hsl("+this.props.hsl.h+",100%, 50%)",borderRadius:this.props.radius},white:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius},black:{absolute:"0px 0px 0px 0px",boxShadow:this.props.shadow,borderRadius:this.props.radius},pointer:{position:"absolute",top:-(this.props.hsv.v*100)+100+"%",left:this.props.hsv.s*100+"%",cursor:"default"},circle:{width:"4px",height:"4px",boxShadow:`0 0 0 1.5px #fff, inset 0 0 1px 1px rgba(0,0,0,.3),
            0 0 1px 2px rgba(0,0,0,.4)`,borderRadius:"50%",cursor:"hand",transform:"translate(-2px, -2px)"}},custom:{color:o,white:s,black:l,pointer:c,circle:d}},{custom:!!this.props.style});return $.createElement("div",{style:h.color,ref:function(u){return n.container=u},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},$.createElement("style",null,`
          .saturation-white {
            background: -webkit-linear-gradient(to right, #fff, rgba(255,255,255,0));
            background: linear-gradient(to right, #fff, rgba(255,255,255,0));
          }
          .saturation-black {
            background: -webkit-linear-gradient(to top, #000, rgba(0,0,0,0));
            background: linear-gradient(to top, #000, rgba(0,0,0,0));
          }
        `),$.createElement("div",{style:h.white,className:"saturation-white"},$.createElement("div",{style:h.black,className:"saturation-black"}),$.createElement("div",{style:h.pointer},this.props.pointer?$.createElement(this.props.pointer,this.props):$.createElement("div",{style:h.circle}))))}}]),e}(A.PureComponent||A.Component);function Q8(t,e){for(var r=-1,n=t==null?0:t.length;++r<n&&e(t[r],r,t)!==!1;);return t}var ez=T1(Object.keys,Object),tz=Object.prototype,rz=tz.hasOwnProperty;function nz(t){if(!zp(t))return ez(t);var e=[];for(var r in Object(t))rz.call(t,r)&&r!="constructor"&&e.push(r);return e}function Hp(t){return Es(t)?M1(t):nz(t)}function iz(t,e){return t&&C1(t,e,Hp)}function oz(t,e){return function(r,n){if(r==null)return r;if(!Es(r))return t(r,n);for(var i=r.length,o=-1,s=Object(r);++o<i&&n(s[o],o,s)!==!1;);return r}}var D1=oz(iz);function sz(t){return typeof t=="function"?t:Ed}function az(t,e){var r=xr(t)?Q8:D1;return r(t,sz(e))}function qc(t){"@babel/helpers - typeof";return qc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qc(t)}var lz=/^\s+/,cz=/\s+$/;function Oe(t,e){if(t=t||"",e=e||{},t instanceof Oe)return t;if(!(this instanceof Oe))return new Oe(t,e);var r=dz(t);this._originalInput=t,this._r=r.r,this._g=r.g,this._b=r.b,this._a=r.a,this._roundA=Math.round(100*this._a)/100,this._format=e.format||r.format,this._gradientType=e.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=r.ok}Oe.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},getLuminance:function(){var e=this.toRgb(),r,n,i,o,s,l;return r=e.r/255,n=e.g/255,i=e.b/255,r<=.03928?o=r/12.92:o=Math.pow((r+.055)/1.055,2.4),n<=.03928?s=n/12.92:s=Math.pow((n+.055)/1.055,2.4),i<=.03928?l=i/12.92:l=Math.pow((i+.055)/1.055,2.4),.2126*o+.7152*s+.0722*l},setAlpha:function(e){return this._a=z1(e),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var e=_v(this._r,this._g,this._b);return{h:e.h*360,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=_v(this._r,this._g,this._b),r=Math.round(e.h*360),n=Math.round(e.s*100),i=Math.round(e.v*100);return this._a==1?"hsv("+r+", "+n+"%, "+i+"%)":"hsva("+r+", "+n+"%, "+i+"%, "+this._roundA+")"},toHsl:function(){var e=wv(this._r,this._g,this._b);return{h:e.h*360,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=wv(this._r,this._g,this._b),r=Math.round(e.h*360),n=Math.round(e.s*100),i=Math.round(e.l*100);return this._a==1?"hsl("+r+", "+n+"%, "+i+"%)":"hsla("+r+", "+n+"%, "+i+"%, "+this._roundA+")"},toHex:function(e){return Sv(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return pz(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(ut(this._r,255)*100)+"%",g:Math.round(ut(this._g,255)*100)+"%",b:Math.round(ut(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(ut(this._r,255)*100)+"%, "+Math.round(ut(this._g,255)*100)+"%, "+Math.round(ut(this._b,255)*100)+"%)":"rgba("+Math.round(ut(this._r,255)*100)+"%, "+Math.round(ut(this._g,255)*100)+"%, "+Math.round(ut(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:Cz[Sv(this._r,this._g,this._b,!0)]||!1},toFilter:function(e){var r="#"+kv(this._r,this._g,this._b,this._a),n=r,i=this._gradientType?"GradientType = 1, ":"";if(e){var o=Oe(e);n="#"+kv(o._r,o._g,o._b,o._a)}return"progid:DXImageTransform.Microsoft.gradient("+i+"startColorstr="+r+",endColorstr="+n+")"},toString:function(e){var r=!!e;e=e||this._format;var n=!1,i=this._a<1&&this._a>=0,o=!r&&i&&(e==="hex"||e==="hex6"||e==="hex3"||e==="hex4"||e==="hex8"||e==="name");return o?e==="name"&&this._a===0?this.toName():this.toRgbString():(e==="rgb"&&(n=this.toRgbString()),e==="prgb"&&(n=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(n=this.toHexString()),e==="hex3"&&(n=this.toHexString(!0)),e==="hex4"&&(n=this.toHex8String(!0)),e==="hex8"&&(n=this.toHex8String()),e==="name"&&(n=this.toName()),e==="hsl"&&(n=this.toHslString()),e==="hsv"&&(n=this.toHsvString()),n||this.toHexString())},clone:function(){return Oe(this.toString())},_applyModification:function(e,r){var n=e.apply(null,[this].concat([].slice.call(r)));return this._r=n._r,this._g=n._g,this._b=n._b,this.setAlpha(n._a),this},lighten:function(){return this._applyModification(yz,arguments)},brighten:function(){return this._applyModification(xz,arguments)},darken:function(){return this._applyModification(bz,arguments)},desaturate:function(){return this._applyModification(mz,arguments)},saturate:function(){return this._applyModification(gz,arguments)},greyscale:function(){return this._applyModification(vz,arguments)},spin:function(){return this._applyModification(wz,arguments)},_applyCombination:function(e,r){return e.apply(null,[this].concat([].slice.call(r)))},analogous:function(){return this._applyCombination(kz,arguments)},complement:function(){return this._applyCombination(_z,arguments)},monochromatic:function(){return this._applyCombination(jz,arguments)},splitcomplement:function(){return this._applyCombination(Sz,arguments)},triad:function(){return this._applyCombination(jv,[3])},tetrad:function(){return this._applyCombination(jv,[4])}};Oe.fromRatio=function(t,e){if(qc(t)=="object"){var r={};for(var n in t)t.hasOwnProperty(n)&&(n==="a"?r[n]=t[n]:r[n]=Qs(t[n]));t=r}return Oe(t,e)};function dz(t){var e={r:0,g:0,b:0},r=1,n=null,i=null,o=null,s=!1,l=!1;return typeof t=="string"&&(t=Nz(t)),qc(t)=="object"&&(un(t.r)&&un(t.g)&&un(t.b)?(e=uz(t.r,t.g,t.b),s=!0,l=String(t.r).substr(-1)==="%"?"prgb":"rgb"):un(t.h)&&un(t.s)&&un(t.v)?(n=Qs(t.s),i=Qs(t.v),e=fz(t.h,n,i),s=!0,l="hsv"):un(t.h)&&un(t.s)&&un(t.l)&&(n=Qs(t.s),o=Qs(t.l),e=hz(t.h,n,o),s=!0,l="hsl"),t.hasOwnProperty("a")&&(r=t.a)),r=z1(r),{ok:s,format:t.format||l,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:r}}function uz(t,e,r){return{r:ut(t,255)*255,g:ut(e,255)*255,b:ut(r,255)*255}}function wv(t,e,r){t=ut(t,255),e=ut(e,255),r=ut(r,255);var n=Math.max(t,e,r),i=Math.min(t,e,r),o,s,l=(n+i)/2;if(n==i)o=s=0;else{var c=n-i;switch(s=l>.5?c/(2-n-i):c/(n+i),n){case t:o=(e-r)/c+(e<r?6:0);break;case e:o=(r-t)/c+2;break;case r:o=(t-e)/c+4;break}o/=6}return{h:o,s,l}}function hz(t,e,r){var n,i,o;t=ut(t,360),e=ut(e,100),r=ut(r,100);function s(d,h,f){return f<0&&(f+=1),f>1&&(f-=1),f<1/6?d+(h-d)*6*f:f<1/2?h:f<2/3?d+(h-d)*(2/3-f)*6:d}if(e===0)n=i=o=r;else{var l=r<.5?r*(1+e):r+e-r*e,c=2*r-l;n=s(c,l,t+1/3),i=s(c,l,t),o=s(c,l,t-1/3)}return{r:n*255,g:i*255,b:o*255}}function _v(t,e,r){t=ut(t,255),e=ut(e,255),r=ut(r,255);var n=Math.max(t,e,r),i=Math.min(t,e,r),o,s,l=n,c=n-i;if(s=n===0?0:c/n,n==i)o=0;else{switch(n){case t:o=(e-r)/c+(e<r?6:0);break;case e:o=(r-t)/c+2;break;case r:o=(t-e)/c+4;break}o/=6}return{h:o,s,v:l}}function fz(t,e,r){t=ut(t,360)*6,e=ut(e,100),r=ut(r,100);var n=Math.floor(t),i=t-n,o=r*(1-e),s=r*(1-i*e),l=r*(1-(1-i)*e),c=n%6,d=[r,s,o,o,l,r][c],h=[l,r,r,s,o,o][c],f=[o,o,l,r,r,s][c];return{r:d*255,g:h*255,b:f*255}}function Sv(t,e,r,n){var i=[Ur(Math.round(t).toString(16)),Ur(Math.round(e).toString(16)),Ur(Math.round(r).toString(16))];return n&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function pz(t,e,r,n,i){var o=[Ur(Math.round(t).toString(16)),Ur(Math.round(e).toString(16)),Ur(Math.round(r).toString(16)),Ur(F1(n))];return i&&o[0].charAt(0)==o[0].charAt(1)&&o[1].charAt(0)==o[1].charAt(1)&&o[2].charAt(0)==o[2].charAt(1)&&o[3].charAt(0)==o[3].charAt(1)?o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0)+o[3].charAt(0):o.join("")}function kv(t,e,r,n){var i=[Ur(F1(n)),Ur(Math.round(t).toString(16)),Ur(Math.round(e).toString(16)),Ur(Math.round(r).toString(16))];return i.join("")}Oe.equals=function(t,e){return!t||!e?!1:Oe(t).toRgbString()==Oe(e).toRgbString()};Oe.random=function(){return Oe.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function mz(t,e){e=e===0?0:e||10;var r=Oe(t).toHsl();return r.s-=e/100,r.s=Nd(r.s),Oe(r)}function gz(t,e){e=e===0?0:e||10;var r=Oe(t).toHsl();return r.s+=e/100,r.s=Nd(r.s),Oe(r)}function vz(t){return Oe(t).desaturate(100)}function yz(t,e){e=e===0?0:e||10;var r=Oe(t).toHsl();return r.l+=e/100,r.l=Nd(r.l),Oe(r)}function xz(t,e){e=e===0?0:e||10;var r=Oe(t).toRgb();return r.r=Math.max(0,Math.min(255,r.r-Math.round(255*-(e/100)))),r.g=Math.max(0,Math.min(255,r.g-Math.round(255*-(e/100)))),r.b=Math.max(0,Math.min(255,r.b-Math.round(255*-(e/100)))),Oe(r)}function bz(t,e){e=e===0?0:e||10;var r=Oe(t).toHsl();return r.l-=e/100,r.l=Nd(r.l),Oe(r)}function wz(t,e){var r=Oe(t).toHsl(),n=(r.h+e)%360;return r.h=n<0?360+n:n,Oe(r)}function _z(t){var e=Oe(t).toHsl();return e.h=(e.h+180)%360,Oe(e)}function jv(t,e){if(isNaN(e)||e<=0)throw new Error("Argument to polyad must be a positive number");for(var r=Oe(t).toHsl(),n=[Oe(t)],i=360/e,o=1;o<e;o++)n.push(Oe({h:(r.h+o*i)%360,s:r.s,l:r.l}));return n}function Sz(t){var e=Oe(t).toHsl(),r=e.h;return[Oe(t),Oe({h:(r+72)%360,s:e.s,l:e.l}),Oe({h:(r+216)%360,s:e.s,l:e.l})]}function kz(t,e,r){e=e||6,r=r||30;var n=Oe(t).toHsl(),i=360/r,o=[Oe(t)];for(n.h=(n.h-(i*e>>1)+720)%360;--e;)n.h=(n.h+i)%360,o.push(Oe(n));return o}function jz(t,e){e=e||6;for(var r=Oe(t).toHsv(),n=r.h,i=r.s,o=r.v,s=[],l=1/e;e--;)s.push(Oe({h:n,s:i,v:o})),o=(o+l)%1;return s}Oe.mix=function(t,e,r){r=r===0?0:r||50;var n=Oe(t).toRgb(),i=Oe(e).toRgb(),o=r/100,s={r:(i.r-n.r)*o+n.r,g:(i.g-n.g)*o+n.g,b:(i.b-n.b)*o+n.b,a:(i.a-n.a)*o+n.a};return Oe(s)};Oe.readability=function(t,e){var r=Oe(t),n=Oe(e);return(Math.max(r.getLuminance(),n.getLuminance())+.05)/(Math.min(r.getLuminance(),n.getLuminance())+.05)};Oe.isReadable=function(t,e,r){var n=Oe.readability(t,e),i,o;switch(o=!1,i=Pz(r),i.level+i.size){case"AAsmall":case"AAAlarge":o=n>=4.5;break;case"AAlarge":o=n>=3;break;case"AAAsmall":o=n>=7;break}return o};Oe.mostReadable=function(t,e,r){var n=null,i=0,o,s,l,c;r=r||{},s=r.includeFallbackColors,l=r.level,c=r.size;for(var d=0;d<e.length;d++)o=Oe.readability(t,e[d]),o>i&&(i=o,n=Oe(e[d]));return Oe.isReadable(t,n,{level:l,size:c})||!s?n:(r.includeFallbackColors=!1,Oe.mostReadable(t,["#fff","#000"],r))};var ef=Oe.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},Cz=Oe.hexNames=Ez(ef);function Ez(t){var e={};for(var r in t)t.hasOwnProperty(r)&&(e[t[r]]=r);return e}function z1(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function ut(t,e){Tz(t)&&(t="100%");var r=Rz(t);return t=Math.min(e,Math.max(0,parseFloat(t))),r&&(t=parseInt(t*e,10)/100),Math.abs(t-e)<1e-6?1:t%e/parseFloat(e)}function Nd(t){return Math.min(1,Math.max(0,t))}function dr(t){return parseInt(t,16)}function Tz(t){return typeof t=="string"&&t.indexOf(".")!=-1&&parseFloat(t)===1}function Rz(t){return typeof t=="string"&&t.indexOf("%")!=-1}function Ur(t){return t.length==1?"0"+t:""+t}function Qs(t){return t<=1&&(t=t*100+"%"),t}function F1(t){return Math.round(parseFloat(t)*255).toString(16)}function Cv(t){return dr(t)/255}var Ir=function(){var t="[-\\+]?\\d+%?",e="[-\\+]?\\d*\\.\\d+%?",r="(?:"+e+")|(?:"+t+")",n="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?",i="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?";return{CSS_UNIT:new RegExp(r),rgb:new RegExp("rgb"+n),rgba:new RegExp("rgba"+i),hsl:new RegExp("hsl"+n),hsla:new RegExp("hsla"+i),hsv:new RegExp("hsv"+n),hsva:new RegExp("hsva"+i),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function un(t){return!!Ir.CSS_UNIT.exec(t)}function Nz(t){t=t.replace(lz,"").replace(cz,"").toLowerCase();var e=!1;if(ef[t])t=ef[t],e=!0;else if(t=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var r;return(r=Ir.rgb.exec(t))?{r:r[1],g:r[2],b:r[3]}:(r=Ir.rgba.exec(t))?{r:r[1],g:r[2],b:r[3],a:r[4]}:(r=Ir.hsl.exec(t))?{h:r[1],s:r[2],l:r[3]}:(r=Ir.hsla.exec(t))?{h:r[1],s:r[2],l:r[3],a:r[4]}:(r=Ir.hsv.exec(t))?{h:r[1],s:r[2],v:r[3]}:(r=Ir.hsva.exec(t))?{h:r[1],s:r[2],v:r[3],a:r[4]}:(r=Ir.hex8.exec(t))?{r:dr(r[1]),g:dr(r[2]),b:dr(r[3]),a:Cv(r[4]),format:e?"name":"hex8"}:(r=Ir.hex6.exec(t))?{r:dr(r[1]),g:dr(r[2]),b:dr(r[3]),format:e?"name":"hex"}:(r=Ir.hex4.exec(t))?{r:dr(r[1]+""+r[1]),g:dr(r[2]+""+r[2]),b:dr(r[3]+""+r[3]),a:Cv(r[4]+""+r[4]),format:e?"name":"hex8"}:(r=Ir.hex3.exec(t))?{r:dr(r[1]+""+r[1]),g:dr(r[2]+""+r[2]),b:dr(r[3]+""+r[3]),format:e?"name":"hex"}:!1}function Pz(t){var e,r;return t=t||{level:"AA",size:"small"},e=(t.level||"AA").toUpperCase(),r=(t.size||"small").toLowerCase(),e!=="AA"&&e!=="AAA"&&(e="AA"),r!=="small"&&r!=="large"&&(r="small"),{level:e,size:r}}var Ev=function(e){var r=["r","g","b","a","h","s","l","v"],n=0,i=0;return az(r,function(o){if(e[o]&&(n+=1,isNaN(e[o])||(i+=1),o==="s"||o==="l")){var s=/^\d+%$/;s.test(e[o])&&(i+=1)}}),n===i?e:!1},ea=function(e,r){var n=e.hex?Oe(e.hex):Oe(e),i=n.toHsl(),o=n.toHsv(),s=n.toRgb(),l=n.toHex();i.s===0&&(i.h=r||0,o.h=r||0);var c=l==="000000"&&s.a===0;return{hsl:i,hex:c?"transparent":"#"+l,rgb:s,hsv:o,oldHue:e.h||r||i.h,source:e.source}},di=function(e){if(e==="transparent")return!0;var r=String(e).charAt(0)==="#"?1:0;return e.length!==4+r&&e.length<7+r&&Oe(e).isValid()},Wp=function(e){if(!e)return"#fff";var r=ea(e);if(r.hex==="transparent")return"rgba(0,0,0,0.4)";var n=(r.rgb.r*299+r.rgb.g*587+r.rgb.b*114)/1e3;return n>=128?"#000":"#fff"},Ou=function(e,r){var n=e.replace("","");return Oe(r+" ("+n+")")._ok},Ws=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Oz=function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();function Az(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Mz(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function $z(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var lr=function(e){var r=function(n){$z(i,n);function i(o){Az(this,i);var s=Mz(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return s.handleChange=function(l,c){var d=Ev(l);if(d){var h=ea(l,l.h||s.state.oldHue);s.setState(h),s.props.onChangeComplete&&s.debounce(s.props.onChangeComplete,h,c),s.props.onChange&&s.props.onChange(h,c)}},s.handleSwatchHover=function(l,c){var d=Ev(l);if(d){var h=ea(l,l.h||s.state.oldHue);s.props.onSwatchHover&&s.props.onSwatchHover(h,c)}},s.state=Ws({},ea(o.color,0)),s.debounce=L1(function(l,c,d){l(c,d)},100),s}return Oz(i,[{key:"render",value:function(){var s={};return this.props.onSwatchHover&&(s.onSwatchHover=this.handleSwatchHover),$.createElement(e,Ws({},this.props,this.state,{onChange:this.handleChange},s))}}],[{key:"getDerivedStateFromProps",value:function(s,l){return Ws({},ea(s.color,l.oldHue))}}]),i}(A.PureComponent||A.Component);return r.propTypes=Ws({},e.propTypes),r.defaultProps=Ws({},e.defaultProps,{color:{h:250,s:.5,l:.2,a:1}}),r},Iz=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Lz=function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();function Dz(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Tv(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function zz(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var Fz=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"span";return function(n){zz(i,n);function i(){var o,s,l,c;Dz(this,i);for(var d=arguments.length,h=Array(d),f=0;f<d;f++)h[f]=arguments[f];return c=(s=(l=Tv(this,(o=i.__proto__||Object.getPrototypeOf(i)).call.apply(o,[this].concat(h))),l),l.state={focus:!1},l.handleFocus=function(){return l.setState({focus:!0})},l.handleBlur=function(){return l.setState({focus:!1})},s),Tv(l,c)}return Lz(i,[{key:"render",value:function(){return $.createElement(r,{onFocus:this.handleFocus,onBlur:this.handleBlur},$.createElement(e,Iz({},this.props,this.state)))}}]),i}($.Component)},Rv=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Bz=13,Uz=function(e){var r=e.color,n=e.style,i=e.onClick,o=i===void 0?function(){}:i,s=e.onHover,l=e.title,c=l===void 0?r:l,d=e.children,h=e.focus,f=e.focusStyle,u=f===void 0?{}:f,p=r==="transparent",g=De({default:{swatch:Rv({background:r,height:"100%",width:"100%",cursor:"pointer",position:"relative",outline:"none"},n,h?u:{})}}),m=function(w){return o(r,w)},x=function(w){return w.keyCode===Bz&&o(r,w)},v=function(w){return s(r,w)},y={};return s&&(y.onMouseOver=v),$.createElement("div",Rv({style:g.swatch,onClick:m,title:c,tabIndex:0,onKeyDown:x},y),d,p&&$.createElement(js,{borderRadius:g.swatch.borderRadius,boxShadow:"inset 0 0 0 1px rgba(0,0,0,0.1)"}))};const Zi=Fz(Uz);var Hz=function(e){var r=e.direction,n=De({default:{picker:{width:"18px",height:"18px",borderRadius:"50%",transform:"translate(-9px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}},vertical:{picker:{transform:"translate(-3px, -9px)"}}},{vertical:r==="vertical"});return $.createElement("div",{style:n.picker})},Wz=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},B1=function(e){var r=e.rgb,n=e.hsl,i=e.width,o=e.height,s=e.onChange,l=e.direction,c=e.style,d=e.renderers,h=e.pointer,f=e.className,u=f===void 0?"":f,p=De({default:{picker:{position:"relative",width:i,height:o},alpha:{radius:"2px",style:c}}});return $.createElement("div",{style:p.picker,className:"alpha-picker "+u},$.createElement(Ip,Wz({},p.alpha,{rgb:r,hsl:n,pointer:h,renderers:d,onChange:s,direction:l})))};B1.defaultProps={width:"316px",height:"16px",direction:"horizontal",pointer:Hz};lr(B1);function U1(t,e){for(var r=-1,n=t==null?0:t.length,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i}var Gz="__lodash_hash_undefined__";function Vz(t){return this.__data__.set(t,Gz),this}function qz(t){return this.__data__.has(t)}function Kc(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new Cn;++e<r;)this.add(t[e])}Kc.prototype.add=Kc.prototype.push=Vz;Kc.prototype.has=qz;function Kz(t,e){for(var r=-1,n=t==null?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}function Yz(t,e){return t.has(e)}var Xz=1,Zz=2;function H1(t,e,r,n,i,o){var s=r&Xz,l=t.length,c=e.length;if(l!=c&&!(s&&c>l))return!1;var d=o.get(t),h=o.get(e);if(d&&h)return d==e&&h==t;var f=-1,u=!0,p=r&Zz?new Kc:void 0;for(o.set(t,e),o.set(e,t);++f<l;){var g=t[f],m=e[f];if(n)var x=s?n(m,g,f,e,t,o):n(g,m,f,t,e,o);if(x!==void 0){if(x)continue;u=!1;break}if(p){if(!Kz(e,function(v,y){if(!Yz(p,y)&&(g===v||i(g,v,r,n,o)))return p.push(y)})){u=!1;break}}else if(!(g===m||i(g,m,r,n,o))){u=!1;break}}return o.delete(t),o.delete(e),u}function Jz(t){var e=-1,r=Array(t.size);return t.forEach(function(n,i){r[++e]=[i,n]}),r}function Qz(t){var e=-1,r=Array(t.size);return t.forEach(function(n){r[++e]=n}),r}var eF=1,tF=2,rF="[object Boolean]",nF="[object Date]",iF="[object Error]",oF="[object Map]",sF="[object Number]",aF="[object RegExp]",lF="[object Set]",cF="[object String]",dF="[object Symbol]",uF="[object ArrayBuffer]",hF="[object DataView]",Nv=ii?ii.prototype:void 0,Au=Nv?Nv.valueOf:void 0;function fF(t,e,r,n,i,o,s){switch(r){case hF:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case uF:return!(t.byteLength!=e.byteLength||!o(new Wc(t),new Wc(e)));case rF:case nF:case sF:return Ja(+t,+e);case iF:return t.name==e.name&&t.message==e.message;case aF:case cF:return t==e+"";case oF:var l=Jz;case lF:var c=n&eF;if(l||(l=Qz),t.size!=e.size&&!c)return!1;var d=s.get(t);if(d)return d==e;n|=tF,s.set(t,e);var h=H1(l(t),l(e),n,i,o,s);return s.delete(t),h;case dF:if(Au)return Au.call(t)==Au.call(e)}return!1}function pF(t,e){for(var r=-1,n=e.length,i=t.length;++r<n;)t[i+r]=e[r];return t}function mF(t,e,r){var n=e(t);return xr(t)?n:pF(n,r(t))}function gF(t,e){for(var r=-1,n=t==null?0:t.length,i=0,o=[];++r<n;){var s=t[r];e(s,r,t)&&(o[i++]=s)}return o}function vF(){return[]}var yF=Object.prototype,xF=yF.propertyIsEnumerable,Pv=Object.getOwnPropertySymbols,bF=Pv?function(t){return t==null?[]:(t=Object(t),gF(Pv(t),function(e){return xF.call(t,e)}))}:vF;function Ov(t){return mF(t,Hp,bF)}var wF=1,_F=Object.prototype,SF=_F.hasOwnProperty;function kF(t,e,r,n,i,o){var s=r&wF,l=Ov(t),c=l.length,d=Ov(e),h=d.length;if(c!=h&&!s)return!1;for(var f=c;f--;){var u=l[f];if(!(s?u in e:SF.call(e,u)))return!1}var p=o.get(t),g=o.get(e);if(p&&g)return p==e&&g==t;var m=!0;o.set(t,e),o.set(e,t);for(var x=s;++f<c;){u=l[f];var v=t[u],y=e[u];if(n)var b=s?n(y,v,u,e,t,o):n(v,y,u,t,e,o);if(!(b===void 0?v===y||i(v,y,r,n,o):b)){m=!1;break}x||(x=u=="constructor")}if(m&&!x){var w=t.constructor,k=e.constructor;w!=k&&"constructor"in t&&"constructor"in e&&!(typeof w=="function"&&w instanceof w&&typeof k=="function"&&k instanceof k)&&(m=!1)}return o.delete(t),o.delete(e),m}var tf=Xi(qr,"DataView"),rf=Xi(qr,"Promise"),nf=Xi(qr,"Set"),of=Xi(qr,"WeakMap"),Av="[object Map]",jF="[object Object]",Mv="[object Promise]",$v="[object Set]",Iv="[object WeakMap]",Lv="[object DataView]",CF=Yi(tf),EF=Yi(Ia),TF=Yi(rf),RF=Yi(nf),NF=Yi(of),Bn=Ki;(tf&&Bn(new tf(new ArrayBuffer(1)))!=Lv||Ia&&Bn(new Ia)!=Av||rf&&Bn(rf.resolve())!=Mv||nf&&Bn(new nf)!=$v||of&&Bn(new of)!=Iv)&&(Bn=function(t){var e=Ki(t),r=e==jF?t.constructor:void 0,n=r?Yi(r):"";if(n)switch(n){case CF:return Lv;case EF:return Av;case TF:return Mv;case RF:return $v;case NF:return Iv}return e});var PF=1,Dv="[object Arguments]",zv="[object Array]",Wl="[object Object]",OF=Object.prototype,Fv=OF.hasOwnProperty;function AF(t,e,r,n,i,o){var s=xr(t),l=xr(e),c=s?zv:Bn(t),d=l?zv:Bn(e);c=c==Dv?Wl:c,d=d==Dv?Wl:d;var h=c==Wl,f=d==Wl,u=c==d;if(u&&Vc(t)){if(!Vc(e))return!1;s=!0,h=!1}if(u&&!h)return o||(o=new on),s||Bp(t)?H1(t,e,r,n,i,o):fF(t,e,c,r,n,i,o);if(!(r&PF)){var p=h&&Fv.call(t,"__wrapped__"),g=f&&Fv.call(e,"__wrapped__");if(p||g){var m=p?t.value():t,x=g?e.value():e;return o||(o=new on),i(m,x,r,n,o)}}return u?(o||(o=new on),kF(t,e,r,n,i,o)):!1}function Gp(t,e,r,n,i){return t===e?!0:t==null||e==null||!oi(t)&&!oi(e)?t!==t&&e!==e:AF(t,e,r,n,Gp,i)}var MF=1,$F=2;function IF(t,e,r,n){var i=r.length,o=i;if(t==null)return!o;for(t=Object(t);i--;){var s=r[i];if(s[2]?s[1]!==t[s[0]]:!(s[0]in t))return!1}for(;++i<o;){s=r[i];var l=s[0],c=t[l],d=s[1];if(s[2]){if(c===void 0&&!(l in t))return!1}else{var h=new on,f;if(!(f===void 0?Gp(d,c,MF|$F,n,h):f))return!1}}return!0}function W1(t){return t===t&&!Pr(t)}function LF(t){for(var e=Hp(t),r=e.length;r--;){var n=e[r],i=t[n];e[r]=[n,i,W1(i)]}return e}function G1(t,e){return function(r){return r==null?!1:r[t]===e&&(e!==void 0||t in Object(r))}}function DF(t){var e=LF(t);return e.length==1&&e[0][2]?G1(e[0][0],e[0][1]):function(r){return r===t||IF(r,t,e)}}var zF=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,FF=/^\w*$/;function Vp(t,e){if(xr(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||Td(t)?!0:FF.test(t)||!zF.test(t)||e!=null&&t in Object(e)}var BF="Expected a function";function qp(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(BF);var r=function(){var n=arguments,i=e?e.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var s=t.apply(this,n);return r.cache=o.set(i,s)||o,s};return r.cache=new(qp.Cache||Cn),r}qp.Cache=Cn;var UF=500;function HF(t){var e=qp(t,function(n){return r.size===UF&&r.clear(),n}),r=e.cache;return e}var WF=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,GF=/\\(\\)?/g,VF=HF(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(WF,function(r,n,i,o){e.push(i?o.replace(GF,"$1"):n||r)}),e}),Bv=ii?ii.prototype:void 0,Uv=Bv?Bv.toString:void 0;function V1(t){if(typeof t=="string")return t;if(xr(t))return U1(t,V1)+"";if(Td(t))return Uv?Uv.call(t):"";var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}function qF(t){return t==null?"":V1(t)}function q1(t,e){return xr(t)?t:Vp(t,e)?[t]:VF(qF(t))}function Pd(t){if(typeof t=="string"||Td(t))return t;var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}function K1(t,e){e=q1(e,t);for(var r=0,n=e.length;t!=null&&r<n;)t=t[Pd(e[r++])];return r&&r==n?t:void 0}function KF(t,e,r){var n=t==null?void 0:K1(t,e);return n===void 0?r:n}function YF(t,e){return t!=null&&e in Object(t)}function XF(t,e,r){e=q1(e,t);for(var n=-1,i=e.length,o=!1;++n<i;){var s=Pd(e[n]);if(!(o=t!=null&&r(t,s)))break;t=t[s]}return o||++n!=i?o:(i=t==null?0:t.length,!!i&&Fp(i)&&Up(s,i)&&(xr(t)||Gc(t)))}function ZF(t,e){return t!=null&&XF(t,e,YF)}var JF=1,QF=2;function eB(t,e){return Vp(t)&&W1(e)?G1(Pd(t),e):function(r){var n=KF(r,t);return n===void 0&&n===e?ZF(r,t):Gp(e,n,JF|QF)}}function tB(t){return function(e){return e==null?void 0:e[t]}}function rB(t){return function(e){return K1(e,t)}}function nB(t){return Vp(t)?tB(Pd(t)):rB(t)}function iB(t){return typeof t=="function"?t:t==null?Ed:typeof t=="object"?xr(t)?eB(t[0],t[1]):DF(t):nB(t)}function oB(t,e){var r=-1,n=Es(t)?Array(t.length):[];return D1(t,function(i,o,s){n[++r]=e(i,o,s)}),n}function Ji(t,e){var r=xr(t)?U1:oB;return r(t,iB(e))}var sB=function(e){var r=e.colors,n=e.onClick,i=e.onSwatchHover,o=De({default:{swatches:{marginRight:"-10px"},swatch:{width:"22px",height:"22px",float:"left",marginRight:"10px",marginBottom:"10px",borderRadius:"4px"},clear:{clear:"both"}}});return $.createElement("div",{style:o.swatches},Ji(r,function(s){return $.createElement(Zi,{key:s,color:s,style:o.swatch,onClick:n,onHover:i,focusStyle:{boxShadow:"0 0 4px "+s}})}),$.createElement("div",{style:o.clear}))},Kp=function(e){var r=e.onChange,n=e.onSwatchHover,i=e.hex,o=e.colors,s=e.width,l=e.triangle,c=e.styles,d=c===void 0?{}:c,h=e.className,f=h===void 0?"":h,u=i==="transparent",p=function(x,v){di(x)&&r({hex:x,source:"hex"},v)},g=De(ar({default:{card:{width:s,background:"#fff",boxShadow:"0 1px rgba(0,0,0,.1)",borderRadius:"6px",position:"relative"},head:{height:"110px",background:i,borderRadius:"6px 6px 0 0",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},body:{padding:"10px"},label:{fontSize:"18px",color:Wp(i),position:"relative"},triangle:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 10px 10px 10px",borderColor:"transparent transparent "+i+" transparent",position:"absolute",top:"-10px",left:"50%",marginLeft:"-10px"},input:{width:"100%",fontSize:"12px",color:"#666",border:"0px",outline:"none",height:"22px",boxShadow:"inset 0 0 0 1px #ddd",borderRadius:"4px",padding:"0 7px",boxSizing:"border-box"}},"hide-triangle":{triangle:{display:"none"}}},d),{"hide-triangle":l==="hide"});return $.createElement("div",{style:g.card,className:"block-picker "+f},$.createElement("div",{style:g.triangle}),$.createElement("div",{style:g.head},u&&$.createElement(js,{borderRadius:"6px 6px 0 0"}),$.createElement("div",{style:g.label},i)),$.createElement("div",{style:g.body},$.createElement(sB,{colors:o,onClick:p,onSwatchHover:n}),$.createElement(Xe,{style:{input:g.input},value:i,onChange:p})))};Kp.propTypes={width:ye.oneOfType([ye.string,ye.number]),colors:ye.arrayOf(ye.string),triangle:ye.oneOf(["top","hide"]),styles:ye.object};Kp.defaultProps={width:170,colors:["#D9E3F0","#F47373","#697689","#37D67A","#2CCCE4","#555555","#dce775","#ff8a65","#ba68c8"],triangle:"top",styles:{}};lr(Kp);var wo={100:"#ffcdd2",300:"#e57373",500:"#f44336",700:"#d32f2f",900:"#b71c1c"},_o={100:"#f8bbd0",300:"#f06292",500:"#e91e63",700:"#c2185b",900:"#880e4f"},So={100:"#e1bee7",300:"#ba68c8",500:"#9c27b0",700:"#7b1fa2",900:"#4a148c"},ko={100:"#d1c4e9",300:"#9575cd",500:"#673ab7",700:"#512da8",900:"#311b92"},jo={100:"#c5cae9",300:"#7986cb",500:"#3f51b5",700:"#303f9f",900:"#1a237e"},Co={100:"#bbdefb",300:"#64b5f6",500:"#2196f3",700:"#1976d2",900:"#0d47a1"},Eo={100:"#b3e5fc",300:"#4fc3f7",500:"#03a9f4",700:"#0288d1",900:"#01579b"},To={100:"#b2ebf2",300:"#4dd0e1",500:"#00bcd4",700:"#0097a7",900:"#006064"},Ro={100:"#b2dfdb",300:"#4db6ac",500:"#009688",700:"#00796b",900:"#004d40"},ta={100:"#c8e6c9",300:"#81c784",500:"#4caf50",700:"#388e3c"},No={100:"#dcedc8",300:"#aed581",500:"#8bc34a",700:"#689f38",900:"#33691e"},Po={100:"#f0f4c3",300:"#dce775",500:"#cddc39",700:"#afb42b",900:"#827717"},Oo={100:"#fff9c4",300:"#fff176",500:"#ffeb3b",700:"#fbc02d",900:"#f57f17"},Ao={100:"#ffecb3",300:"#ffd54f",500:"#ffc107",700:"#ffa000",900:"#ff6f00"},Mo={100:"#ffe0b2",300:"#ffb74d",500:"#ff9800",700:"#f57c00",900:"#e65100"},$o={100:"#ffccbc",300:"#ff8a65",500:"#ff5722",700:"#e64a19",900:"#bf360c"},Io={100:"#d7ccc8",300:"#a1887f",500:"#795548",700:"#5d4037",900:"#3e2723"},Lo={100:"#cfd8dc",300:"#90a4ae",500:"#607d8b",700:"#455a64",900:"#263238"},Y1=function(e){var r=e.color,n=e.onClick,i=e.onSwatchHover,o=e.hover,s=e.active,l=e.circleSize,c=e.circleSpacing,d=De({default:{swatch:{width:l,height:l,marginRight:c,marginBottom:c,transform:"scale(1)",transition:"100ms transform ease"},Swatch:{borderRadius:"50%",background:"transparent",boxShadow:"inset 0 0 0 "+(l/2+1)+"px "+r,transition:"100ms box-shadow ease"}},hover:{swatch:{transform:"scale(1.2)"}},active:{Swatch:{boxShadow:"inset 0 0 0 3px "+r}}},{hover:o,active:s});return $.createElement("div",{style:d.swatch},$.createElement(Zi,{style:d.Swatch,color:r,onClick:n,onHover:i,focusStyle:{boxShadow:d.Swatch.boxShadow+", 0 0 5px "+r}}))};Y1.defaultProps={circleSize:28,circleSpacing:14};const aB=$p(Y1);var Yp=function(e){var r=e.width,n=e.onChange,i=e.onSwatchHover,o=e.colors,s=e.hex,l=e.circleSize,c=e.styles,d=c===void 0?{}:c,h=e.circleSpacing,f=e.className,u=f===void 0?"":f,p=De(ar({default:{card:{width:r,display:"flex",flexWrap:"wrap",marginRight:-h,marginBottom:-h}}},d)),g=function(x,v){return n({hex:x,source:"hex"},v)};return $.createElement("div",{style:p.card,className:"circle-picker "+u},Ji(o,function(m){return $.createElement(aB,{key:m,color:m,onClick:g,onSwatchHover:i,active:s===m.toLowerCase(),circleSize:l,circleSpacing:h})}))};Yp.propTypes={width:ye.oneOfType([ye.string,ye.number]),circleSize:ye.number,circleSpacing:ye.number,styles:ye.object};Yp.defaultProps={width:252,circleSize:28,circleSpacing:14,colors:[wo[500],_o[500],So[500],ko[500],jo[500],Co[500],Eo[500],To[500],Ro[500],ta[500],No[500],Po[500],Oo[500],Ao[500],Mo[500],$o[500],Io[500],Lo[500]],styles:{}};lr(Yp);function Hv(t){return t===void 0}var X1={};Object.defineProperty(X1,"__esModule",{value:!0});var Wv=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},lB=A,Gv=cB(lB);function cB(t){return t&&t.__esModule?t:{default:t}}function dB(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}var Gl=24,uB=X1.default=function(t){var e=t.fill,r=e===void 0?"currentColor":e,n=t.width,i=n===void 0?Gl:n,o=t.height,s=o===void 0?Gl:o,l=t.style,c=l===void 0?{}:l,d=dB(t,["fill","width","height","style"]);return Gv.default.createElement("svg",Wv({viewBox:"0 0 "+Gl+" "+Gl,style:Wv({fill:r,width:i,height:s},c)},d),Gv.default.createElement("path",{d:"M12,18.17L8.83,15L7.42,16.41L12,21L16.59,16.41L15.17,15M12,5.83L15.17,9L16.58,7.59L12,3L7.41,7.59L8.83,9L12,5.83Z"}))},hB=function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();function fB(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function pB(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function mB(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var Z1=function(t){mB(e,t);function e(r){fB(this,e);var n=pB(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.toggleViews=function(){n.state.view==="hex"?n.setState({view:"rgb"}):n.state.view==="rgb"?n.setState({view:"hsl"}):n.state.view==="hsl"&&(n.props.hsl.a===1?n.setState({view:"hex"}):n.setState({view:"rgb"}))},n.handleChange=function(i,o){i.hex?di(i.hex)&&n.props.onChange({hex:i.hex,source:"hex"},o):i.r||i.g||i.b?n.props.onChange({r:i.r||n.props.rgb.r,g:i.g||n.props.rgb.g,b:i.b||n.props.rgb.b,source:"rgb"},o):i.a?(i.a<0?i.a=0:i.a>1&&(i.a=1),n.props.onChange({h:n.props.hsl.h,s:n.props.hsl.s,l:n.props.hsl.l,a:Math.round(i.a*100)/100,source:"rgb"},o)):(i.h||i.s||i.l)&&(typeof i.s=="string"&&i.s.includes("%")&&(i.s=i.s.replace("%","")),typeof i.l=="string"&&i.l.includes("%")&&(i.l=i.l.replace("%","")),i.s==1?i.s=.01:i.l==1&&(i.l=.01),n.props.onChange({h:i.h||n.props.hsl.h,s:Number(Hv(i.s)?n.props.hsl.s:i.s),l:Number(Hv(i.l)?n.props.hsl.l:i.l),source:"hsl"},o))},n.showHighlight=function(i){i.currentTarget.style.background="#eee"},n.hideHighlight=function(i){i.currentTarget.style.background="transparent"},r.hsl.a!==1&&r.view==="hex"?n.state={view:"rgb"}:n.state={view:r.view},n}return hB(e,[{key:"render",value:function(){var n=this,i=De({default:{wrap:{paddingTop:"16px",display:"flex"},fields:{flex:"1",display:"flex",marginLeft:"-6px"},field:{paddingLeft:"6px",width:"100%"},alpha:{paddingLeft:"6px",width:"100%"},toggle:{width:"32px",textAlign:"right",position:"relative"},icon:{marginRight:"-4px",marginTop:"12px",cursor:"pointer",position:"relative"},iconHighlight:{position:"absolute",width:"24px",height:"28px",background:"#eee",borderRadius:"4px",top:"10px",left:"12px",display:"none"},input:{fontSize:"11px",color:"#333",width:"100%",borderRadius:"2px",border:"none",boxShadow:"inset 0 0 0 1px #dadada",height:"21px",textAlign:"center"},label:{textTransform:"uppercase",fontSize:"11px",lineHeight:"11px",color:"#969696",textAlign:"center",display:"block",marginTop:"12px"},svg:{fill:"#333",width:"24px",height:"24px",border:"1px transparent solid",borderRadius:"5px"}},disableAlpha:{alpha:{display:"none"}}},this.props,this.state),o=void 0;return this.state.view==="hex"?o=$.createElement("div",{style:i.fields,className:"flexbox-fix"},$.createElement("div",{style:i.field},$.createElement(Xe,{style:{input:i.input,label:i.label},label:"hex",value:this.props.hex,onChange:this.handleChange}))):this.state.view==="rgb"?o=$.createElement("div",{style:i.fields,className:"flexbox-fix"},$.createElement("div",{style:i.field},$.createElement(Xe,{style:{input:i.input,label:i.label},label:"r",value:this.props.rgb.r,onChange:this.handleChange})),$.createElement("div",{style:i.field},$.createElement(Xe,{style:{input:i.input,label:i.label},label:"g",value:this.props.rgb.g,onChange:this.handleChange})),$.createElement("div",{style:i.field},$.createElement(Xe,{style:{input:i.input,label:i.label},label:"b",value:this.props.rgb.b,onChange:this.handleChange})),$.createElement("div",{style:i.alpha},$.createElement(Xe,{style:{input:i.input,label:i.label},label:"a",value:this.props.rgb.a,arrowOffset:.01,onChange:this.handleChange}))):this.state.view==="hsl"&&(o=$.createElement("div",{style:i.fields,className:"flexbox-fix"},$.createElement("div",{style:i.field},$.createElement(Xe,{style:{input:i.input,label:i.label},label:"h",value:Math.round(this.props.hsl.h),onChange:this.handleChange})),$.createElement("div",{style:i.field},$.createElement(Xe,{style:{input:i.input,label:i.label},label:"s",value:Math.round(this.props.hsl.s*100)+"%",onChange:this.handleChange})),$.createElement("div",{style:i.field},$.createElement(Xe,{style:{input:i.input,label:i.label},label:"l",value:Math.round(this.props.hsl.l*100)+"%",onChange:this.handleChange})),$.createElement("div",{style:i.alpha},$.createElement(Xe,{style:{input:i.input,label:i.label},label:"a",value:this.props.hsl.a,arrowOffset:.01,onChange:this.handleChange})))),$.createElement("div",{style:i.wrap,className:"flexbox-fix"},o,$.createElement("div",{style:i.toggle},$.createElement("div",{style:i.icon,onClick:this.toggleViews,ref:function(l){return n.icon=l}},$.createElement(uB,{style:i.svg,onMouseOver:this.showHighlight,onMouseEnter:this.showHighlight,onMouseOut:this.hideHighlight}))))}}],[{key:"getDerivedStateFromProps",value:function(n,i){return n.hsl.a!==1&&i.view==="hex"?{view:"rgb"}:null}}]),e}($.Component);Z1.defaultProps={view:"hex"};var Vv=function(){var e=De({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",transform:"translate(-6px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}}});return $.createElement("div",{style:e.picker})},gB=function(){var e=De({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",boxShadow:"inset 0 0 0 1px #fff",transform:"translate(-6px, -6px)"}}});return $.createElement("div",{style:e.picker})},Xp=function(e){var r=e.width,n=e.onChange,i=e.disableAlpha,o=e.rgb,s=e.hsl,l=e.hsv,c=e.hex,d=e.renderers,h=e.styles,f=h===void 0?{}:h,u=e.className,p=u===void 0?"":u,g=e.defaultView,m=De(ar({default:{picker:{width:r,background:"#fff",borderRadius:"2px",boxShadow:"0 0 2px rgba(0,0,0,.3), 0 4px 8px rgba(0,0,0,.3)",boxSizing:"initial",fontFamily:"Menlo"},saturation:{width:"100%",paddingBottom:"55%",position:"relative",borderRadius:"2px 2px 0 0",overflow:"hidden"},Saturation:{radius:"2px 2px 0 0"},body:{padding:"16px 16px 12px"},controls:{display:"flex"},color:{width:"32px"},swatch:{marginTop:"6px",width:"16px",height:"16px",borderRadius:"8px",position:"relative",overflow:"hidden"},active:{absolute:"0px 0px 0px 0px",borderRadius:"8px",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.1)",background:"rgba("+o.r+", "+o.g+", "+o.b+", "+o.a+")",zIndex:"2"},toggles:{flex:"1"},hue:{height:"10px",position:"relative",marginBottom:"8px"},Hue:{radius:"2px"},alpha:{height:"10px",position:"relative"},Alpha:{radius:"2px"}},disableAlpha:{color:{width:"22px"},alpha:{display:"none"},hue:{marginBottom:"0px"},swatch:{width:"10px",height:"10px",marginTop:"0px"}}},f),{disableAlpha:i});return $.createElement("div",{style:m.picker,className:"chrome-picker "+p},$.createElement("div",{style:m.saturation},$.createElement(Rd,{style:m.Saturation,hsl:s,hsv:l,pointer:gB,onChange:n})),$.createElement("div",{style:m.body},$.createElement("div",{style:m.controls,className:"flexbox-fix"},$.createElement("div",{style:m.color},$.createElement("div",{style:m.swatch},$.createElement("div",{style:m.active}),$.createElement(js,{renderers:d}))),$.createElement("div",{style:m.toggles},$.createElement("div",{style:m.hue},$.createElement(Cs,{style:m.Hue,hsl:s,pointer:Vv,onChange:n})),$.createElement("div",{style:m.alpha},$.createElement(Ip,{style:m.Alpha,rgb:o,hsl:s,pointer:Vv,renderers:d,onChange:n})))),$.createElement(Z1,{rgb:o,hsl:s,hex:c,view:g,onChange:n,disableAlpha:i})))};Xp.propTypes={width:ye.oneOfType([ye.string,ye.number]),disableAlpha:ye.bool,styles:ye.object,defaultView:ye.oneOf(["hex","rgb","hsl"])};Xp.defaultProps={width:225,disableAlpha:!1,styles:{}};const vB=lr(Xp);var yB=function(e){var r=e.color,n=e.onClick,i=n===void 0?function(){}:n,o=e.onSwatchHover,s=e.active,l=De({default:{color:{background:r,width:"15px",height:"15px",float:"left",marginRight:"5px",marginBottom:"5px",position:"relative",cursor:"pointer"},dot:{absolute:"5px 5px 5px 5px",background:Wp(r),borderRadius:"50%",opacity:"0"}},active:{dot:{opacity:"1"}},"color-#FFFFFF":{color:{boxShadow:"inset 0 0 0 1px #ddd"},dot:{background:"#000"}},transparent:{dot:{background:"#000"}}},{active:s,"color-#FFFFFF":r==="#FFFFFF",transparent:r==="transparent"});return $.createElement(Zi,{style:l.color,color:r,onClick:i,onHover:o,focusStyle:{boxShadow:"0 0 4px "+r}},$.createElement("div",{style:l.dot}))},xB=function(e){var r=e.hex,n=e.rgb,i=e.onChange,o=De({default:{fields:{display:"flex",paddingBottom:"6px",paddingRight:"5px",position:"relative"},active:{position:"absolute",top:"6px",left:"5px",height:"9px",width:"9px",background:r},HEXwrap:{flex:"6",position:"relative"},HEXinput:{width:"80%",padding:"0px",paddingLeft:"20%",border:"none",outline:"none",background:"none",fontSize:"12px",color:"#333",height:"16px"},HEXlabel:{display:"none"},RGBwrap:{flex:"3",position:"relative"},RGBinput:{width:"70%",padding:"0px",paddingLeft:"30%",border:"none",outline:"none",background:"none",fontSize:"12px",color:"#333",height:"16px"},RGBlabel:{position:"absolute",top:"3px",left:"0px",lineHeight:"16px",textTransform:"uppercase",fontSize:"12px",color:"#999"}}}),s=function(c,d){c.r||c.g||c.b?i({r:c.r||n.r,g:c.g||n.g,b:c.b||n.b,source:"rgb"},d):i({hex:c.hex,source:"hex"},d)};return $.createElement("div",{style:o.fields,className:"flexbox-fix"},$.createElement("div",{style:o.active}),$.createElement(Xe,{style:{wrap:o.HEXwrap,input:o.HEXinput,label:o.HEXlabel},label:"hex",value:r,onChange:s}),$.createElement(Xe,{style:{wrap:o.RGBwrap,input:o.RGBinput,label:o.RGBlabel},label:"r",value:n.r,onChange:s}),$.createElement(Xe,{style:{wrap:o.RGBwrap,input:o.RGBinput,label:o.RGBlabel},label:"g",value:n.g,onChange:s}),$.createElement(Xe,{style:{wrap:o.RGBwrap,input:o.RGBinput,label:o.RGBlabel},label:"b",value:n.b,onChange:s}))},Zp=function(e){var r=e.onChange,n=e.onSwatchHover,i=e.colors,o=e.hex,s=e.rgb,l=e.styles,c=l===void 0?{}:l,d=e.className,h=d===void 0?"":d,f=De(ar({default:{Compact:{background:"#f6f6f6",radius:"4px"},compact:{paddingTop:"5px",paddingLeft:"5px",boxSizing:"initial",width:"240px"},clear:{clear:"both"}}},c)),u=function(g,m){g.hex?di(g.hex)&&r({hex:g.hex,source:"hex"},m):r(g,m)};return $.createElement(Qa,{style:f.Compact,styles:c},$.createElement("div",{style:f.compact,className:"compact-picker "+h},$.createElement("div",null,Ji(i,function(p){return $.createElement(yB,{key:p,color:p,active:p.toLowerCase()===o,onClick:u,onSwatchHover:n})}),$.createElement("div",{style:f.clear})),$.createElement(xB,{hex:o,rgb:s,onChange:u})))};Zp.propTypes={colors:ye.arrayOf(ye.string),styles:ye.object};Zp.defaultProps={colors:["#4D4D4D","#999999","#FFFFFF","#F44E3B","#FE9200","#FCDC00","#DBDF00","#A4DD00","#68CCCA","#73D8FF","#AEA1FF","#FDA1FF","#333333","#808080","#cccccc","#D33115","#E27300","#FCC400","#B0BC00","#68BC00","#16A5A5","#009CE0","#7B64FF","#FA28FF","#000000","#666666","#B3B3B3","#9F0500","#C45100","#FB9E00","#808900","#194D33","#0C797D","#0062B1","#653294","#AB149E"],styles:{}};lr(Zp);var bB=function(e){var r=e.hover,n=e.color,i=e.onClick,o=e.onSwatchHover,s={position:"relative",zIndex:"2",outline:"2px solid #fff",boxShadow:"0 0 5px 2px rgba(0,0,0,0.25)"},l=De({default:{swatch:{width:"25px",height:"25px",fontSize:"0"}},hover:{swatch:s}},{hover:r});return $.createElement("div",{style:l.swatch},$.createElement(Zi,{color:n,onClick:i,onHover:o,focusStyle:s}))};const wB=$p(bB);var Jp=function(e){var r=e.width,n=e.colors,i=e.onChange,o=e.onSwatchHover,s=e.triangle,l=e.styles,c=l===void 0?{}:l,d=e.className,h=d===void 0?"":d,f=De(ar({default:{card:{width:r,background:"#fff",border:"1px solid rgba(0,0,0,0.2)",boxShadow:"0 3px 12px rgba(0,0,0,0.15)",borderRadius:"4px",position:"relative",padding:"5px",display:"flex",flexWrap:"wrap"},triangle:{position:"absolute",border:"7px solid transparent",borderBottomColor:"#fff"},triangleShadow:{position:"absolute",border:"8px solid transparent",borderBottomColor:"rgba(0,0,0,0.15)"}},"hide-triangle":{triangle:{display:"none"},triangleShadow:{display:"none"}},"top-left-triangle":{triangle:{top:"-14px",left:"10px"},triangleShadow:{top:"-16px",left:"9px"}},"top-right-triangle":{triangle:{top:"-14px",right:"10px"},triangleShadow:{top:"-16px",right:"9px"}},"bottom-left-triangle":{triangle:{top:"35px",left:"10px",transform:"rotate(180deg)"},triangleShadow:{top:"37px",left:"9px",transform:"rotate(180deg)"}},"bottom-right-triangle":{triangle:{top:"35px",right:"10px",transform:"rotate(180deg)"},triangleShadow:{top:"37px",right:"9px",transform:"rotate(180deg)"}}},c),{"hide-triangle":s==="hide","top-left-triangle":s==="top-left","top-right-triangle":s==="top-right","bottom-left-triangle":s==="bottom-left","bottom-right-triangle":s==="bottom-right"}),u=function(g,m){return i({hex:g,source:"hex"},m)};return $.createElement("div",{style:f.card,className:"github-picker "+h},$.createElement("div",{style:f.triangleShadow}),$.createElement("div",{style:f.triangle}),Ji(n,function(p){return $.createElement(wB,{color:p,key:p,onClick:u,onSwatchHover:o})}))};Jp.propTypes={width:ye.oneOfType([ye.string,ye.number]),colors:ye.arrayOf(ye.string),triangle:ye.oneOf(["hide","top-left","top-right","bottom-left","bottom-right"]),styles:ye.object};Jp.defaultProps={width:200,colors:["#B80000","#DB3E00","#FCCB00","#008B02","#006B76","#1273DE","#004DCF","#5300EB","#EB9694","#FAD0C3","#FEF3BD","#C1E1C5","#BEDADC","#C4DEF6","#BED3F3","#D4C4FB"],triangle:"top-left",styles:{}};lr(Jp);var _B=function(e){var r=e.direction,n=De({default:{picker:{width:"18px",height:"18px",borderRadius:"50%",transform:"translate(-9px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}},vertical:{picker:{transform:"translate(-3px, -9px)"}}},{vertical:r==="vertical"});return $.createElement("div",{style:n.picker})},SB=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Qp=function(e){var r=e.width,n=e.height,i=e.onChange,o=e.hsl,s=e.direction,l=e.pointer,c=e.styles,d=c===void 0?{}:c,h=e.className,f=h===void 0?"":h,u=De(ar({default:{picker:{position:"relative",width:r,height:n},hue:{radius:"2px"}}},d)),p=function(m){return i({a:1,h:m.h,l:.5,s:1})};return $.createElement("div",{style:u.picker,className:"hue-picker "+f},$.createElement(Cs,SB({},u.hue,{hsl:o,pointer:l,onChange:p,direction:s})))};Qp.propTypes={styles:ye.object};Qp.defaultProps={width:"316px",height:"16px",direction:"horizontal",pointer:_B,styles:{}};lr(Qp);var kB=function(e){var r=e.onChange,n=e.hex,i=e.rgb,o=e.styles,s=o===void 0?{}:o,l=e.className,c=l===void 0?"":l,d=De(ar({default:{material:{width:"98px",height:"98px",padding:"16px",fontFamily:"Roboto"},HEXwrap:{position:"relative"},HEXinput:{width:"100%",marginTop:"12px",fontSize:"15px",color:"#333",padding:"0px",border:"0px",borderBottom:"2px solid "+n,outline:"none",height:"30px"},HEXlabel:{position:"absolute",top:"0px",left:"0px",fontSize:"11px",color:"#999999",textTransform:"capitalize"},Hex:{style:{}},RGBwrap:{position:"relative"},RGBinput:{width:"100%",marginTop:"12px",fontSize:"15px",color:"#333",padding:"0px",border:"0px",borderBottom:"1px solid #eee",outline:"none",height:"30px"},RGBlabel:{position:"absolute",top:"0px",left:"0px",fontSize:"11px",color:"#999999",textTransform:"capitalize"},split:{display:"flex",marginRight:"-10px",paddingTop:"11px"},third:{flex:"1",paddingRight:"10px"}}},s)),h=function(u,p){u.hex?di(u.hex)&&r({hex:u.hex,source:"hex"},p):(u.r||u.g||u.b)&&r({r:u.r||i.r,g:u.g||i.g,b:u.b||i.b,source:"rgb"},p)};return $.createElement(Qa,{styles:s},$.createElement("div",{style:d.material,className:"material-picker "+c},$.createElement(Xe,{style:{wrap:d.HEXwrap,input:d.HEXinput,label:d.HEXlabel},label:"hex",value:n,onChange:h}),$.createElement("div",{style:d.split,className:"flexbox-fix"},$.createElement("div",{style:d.third},$.createElement(Xe,{style:{wrap:d.RGBwrap,input:d.RGBinput,label:d.RGBlabel},label:"r",value:i.r,onChange:h})),$.createElement("div",{style:d.third},$.createElement(Xe,{style:{wrap:d.RGBwrap,input:d.RGBinput,label:d.RGBlabel},label:"g",value:i.g,onChange:h})),$.createElement("div",{style:d.third},$.createElement(Xe,{style:{wrap:d.RGBwrap,input:d.RGBinput,label:d.RGBlabel},label:"b",value:i.b,onChange:h})))))};lr(kB);var jB=function(e){var r=e.onChange,n=e.rgb,i=e.hsv,o=e.hex,s=De({default:{fields:{paddingTop:"5px",paddingBottom:"9px",width:"80px",position:"relative"},divider:{height:"5px"},RGBwrap:{position:"relative"},RGBinput:{marginLeft:"40%",width:"40%",height:"18px",border:"1px solid #888888",boxShadow:"inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC",marginBottom:"5px",fontSize:"13px",paddingLeft:"3px",marginRight:"10px"},RGBlabel:{left:"0px",top:"0px",width:"34px",textTransform:"uppercase",fontSize:"13px",height:"18px",lineHeight:"22px",position:"absolute"},HEXwrap:{position:"relative"},HEXinput:{marginLeft:"20%",width:"80%",height:"18px",border:"1px solid #888888",boxShadow:"inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC",marginBottom:"6px",fontSize:"13px",paddingLeft:"3px"},HEXlabel:{position:"absolute",top:"0px",left:"0px",width:"14px",textTransform:"uppercase",fontSize:"13px",height:"18px",lineHeight:"22px"},fieldSymbols:{position:"absolute",top:"5px",right:"-7px",fontSize:"13px"},symbol:{height:"20px",lineHeight:"22px",paddingBottom:"7px"}}}),l=function(d,h){d["#"]?di(d["#"])&&r({hex:d["#"],source:"hex"},h):d.r||d.g||d.b?r({r:d.r||n.r,g:d.g||n.g,b:d.b||n.b,source:"rgb"},h):(d.h||d.s||d.v)&&r({h:d.h||i.h,s:d.s||i.s,v:d.v||i.v,source:"hsv"},h)};return $.createElement("div",{style:s.fields},$.createElement(Xe,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"h",value:Math.round(i.h),onChange:l}),$.createElement(Xe,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"s",value:Math.round(i.s*100),onChange:l}),$.createElement(Xe,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"v",value:Math.round(i.v*100),onChange:l}),$.createElement("div",{style:s.divider}),$.createElement(Xe,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"r",value:n.r,onChange:l}),$.createElement(Xe,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"g",value:n.g,onChange:l}),$.createElement(Xe,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"b",value:n.b,onChange:l}),$.createElement("div",{style:s.divider}),$.createElement(Xe,{style:{wrap:s.HEXwrap,input:s.HEXinput,label:s.HEXlabel},label:"#",value:o.replace("#",""),onChange:l}),$.createElement("div",{style:s.fieldSymbols},$.createElement("div",{style:s.symbol},""),$.createElement("div",{style:s.symbol},"%"),$.createElement("div",{style:s.symbol},"%")))},CB=function(e){var r=e.hsl,n=De({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",boxShadow:"inset 0 0 0 1px #fff",transform:"translate(-6px, -6px)"}},"black-outline":{picker:{boxShadow:"inset 0 0 0 1px #000"}}},{"black-outline":r.l>.5});return $.createElement("div",{style:n.picker})},EB=function(){var e=De({default:{triangle:{width:0,height:0,borderStyle:"solid",borderWidth:"4px 0 4px 6px",borderColor:"transparent transparent transparent #fff",position:"absolute",top:"1px",left:"1px"},triangleBorder:{width:0,height:0,borderStyle:"solid",borderWidth:"5px 0 5px 8px",borderColor:"transparent transparent transparent #555"},left:{Extend:"triangleBorder",transform:"translate(-13px, -4px)"},leftInside:{Extend:"triangle",transform:"translate(-8px, -5px)"},right:{Extend:"triangleBorder",transform:"translate(20px, -14px) rotate(180deg)"},rightInside:{Extend:"triangle",transform:"translate(-8px, -5px)"}}});return $.createElement("div",{style:e.pointer},$.createElement("div",{style:e.left},$.createElement("div",{style:e.leftInside})),$.createElement("div",{style:e.right},$.createElement("div",{style:e.rightInside})))},qv=function(e){var r=e.onClick,n=e.label,i=e.children,o=e.active,s=De({default:{button:{backgroundImage:"linear-gradient(-180deg, #FFFFFF 0%, #E6E6E6 100%)",border:"1px solid #878787",borderRadius:"2px",height:"20px",boxShadow:"0 1px 0 0 #EAEAEA",fontSize:"14px",color:"#000",lineHeight:"20px",textAlign:"center",marginBottom:"10px",cursor:"pointer"}},active:{button:{boxShadow:"0 0 0 1px #878787"}}},{active:o});return $.createElement("div",{style:s.button,onClick:r},n||i)},TB=function(e){var r=e.rgb,n=e.currentColor,i=De({default:{swatches:{border:"1px solid #B3B3B3",borderBottom:"1px solid #F0F0F0",marginBottom:"2px",marginTop:"1px"},new:{height:"34px",background:"rgb("+r.r+","+r.g+", "+r.b+")",boxShadow:"inset 1px 0 0 #000, inset -1px 0 0 #000, inset 0 1px 0 #000"},current:{height:"34px",background:n,boxShadow:"inset 1px 0 0 #000, inset -1px 0 0 #000, inset 0 -1px 0 #000"},label:{fontSize:"14px",color:"#000",textAlign:"center"}}});return $.createElement("div",null,$.createElement("div",{style:i.label},"new"),$.createElement("div",{style:i.swatches},$.createElement("div",{style:i.new}),$.createElement("div",{style:i.current})),$.createElement("div",{style:i.label},"current"))},RB=function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();function NB(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function PB(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function OB(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var em=function(t){OB(e,t);function e(r){NB(this,e);var n=PB(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.state={currentColor:r.hex},n}return RB(e,[{key:"render",value:function(){var n=this.props,i=n.styles,o=i===void 0?{}:i,s=n.className,l=s===void 0?"":s,c=De(ar({default:{picker:{background:"#DCDCDC",borderRadius:"4px",boxShadow:"0 0 0 1px rgba(0,0,0,.25), 0 8px 16px rgba(0,0,0,.15)",boxSizing:"initial",width:"513px"},head:{backgroundImage:"linear-gradient(-180deg, #F0F0F0 0%, #D4D4D4 100%)",borderBottom:"1px solid #B1B1B1",boxShadow:"inset 0 1px 0 0 rgba(255,255,255,.2), inset 0 -1px 0 0 rgba(0,0,0,.02)",height:"23px",lineHeight:"24px",borderRadius:"4px 4px 0 0",fontSize:"13px",color:"#4D4D4D",textAlign:"center"},body:{padding:"15px 15px 0",display:"flex"},saturation:{width:"256px",height:"256px",position:"relative",border:"2px solid #B3B3B3",borderBottom:"2px solid #F0F0F0",overflow:"hidden"},hue:{position:"relative",height:"256px",width:"19px",marginLeft:"10px",border:"2px solid #B3B3B3",borderBottom:"2px solid #F0F0F0"},controls:{width:"180px",marginLeft:"10px"},top:{display:"flex"},previews:{width:"60px"},actions:{flex:"1",marginLeft:"20px"}}},o));return $.createElement("div",{style:c.picker,className:"photoshop-picker "+l},$.createElement("div",{style:c.head},this.props.header),$.createElement("div",{style:c.body,className:"flexbox-fix"},$.createElement("div",{style:c.saturation},$.createElement(Rd,{hsl:this.props.hsl,hsv:this.props.hsv,pointer:CB,onChange:this.props.onChange})),$.createElement("div",{style:c.hue},$.createElement(Cs,{direction:"vertical",hsl:this.props.hsl,pointer:EB,onChange:this.props.onChange})),$.createElement("div",{style:c.controls},$.createElement("div",{style:c.top,className:"flexbox-fix"},$.createElement("div",{style:c.previews},$.createElement(TB,{rgb:this.props.rgb,currentColor:this.state.currentColor})),$.createElement("div",{style:c.actions},$.createElement(qv,{label:"OK",onClick:this.props.onAccept,active:!0}),$.createElement(qv,{label:"Cancel",onClick:this.props.onCancel}),$.createElement(jB,{onChange:this.props.onChange,rgb:this.props.rgb,hsv:this.props.hsv,hex:this.props.hex}))))))}}]),e}($.Component);em.propTypes={header:ye.string,styles:ye.object};em.defaultProps={header:"Color Picker",styles:{}};lr(em);var AB=function(e){var r=e.onChange,n=e.rgb,i=e.hsl,o=e.hex,s=e.disableAlpha,l=De({default:{fields:{display:"flex",paddingTop:"4px"},single:{flex:"1",paddingLeft:"6px"},alpha:{flex:"1",paddingLeft:"6px"},double:{flex:"2"},input:{width:"80%",padding:"4px 10% 3px",border:"none",boxShadow:"inset 0 0 0 1px #ccc",fontSize:"11px"},label:{display:"block",textAlign:"center",fontSize:"11px",color:"#222",paddingTop:"3px",paddingBottom:"4px",textTransform:"capitalize"}},disableAlpha:{alpha:{display:"none"}}},{disableAlpha:s}),c=function(h,f){h.hex?di(h.hex)&&r({hex:h.hex,source:"hex"},f):h.r||h.g||h.b?r({r:h.r||n.r,g:h.g||n.g,b:h.b||n.b,a:n.a,source:"rgb"},f):h.a&&(h.a<0?h.a=0:h.a>100&&(h.a=100),h.a/=100,r({h:i.h,s:i.s,l:i.l,a:h.a,source:"rgb"},f))};return $.createElement("div",{style:l.fields,className:"flexbox-fix"},$.createElement("div",{style:l.double},$.createElement(Xe,{style:{input:l.input,label:l.label},label:"hex",value:o.replace("#",""),onChange:c})),$.createElement("div",{style:l.single},$.createElement(Xe,{style:{input:l.input,label:l.label},label:"r",value:n.r,onChange:c,dragLabel:"true",dragMax:"255"})),$.createElement("div",{style:l.single},$.createElement(Xe,{style:{input:l.input,label:l.label},label:"g",value:n.g,onChange:c,dragLabel:"true",dragMax:"255"})),$.createElement("div",{style:l.single},$.createElement(Xe,{style:{input:l.input,label:l.label},label:"b",value:n.b,onChange:c,dragLabel:"true",dragMax:"255"})),$.createElement("div",{style:l.alpha},$.createElement(Xe,{style:{input:l.input,label:l.label},label:"a",value:Math.round(n.a*100),onChange:c,dragLabel:"true",dragMax:"100"})))},MB=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},J1=function(e){var r=e.colors,n=e.onClick,i=n===void 0?function(){}:n,o=e.onSwatchHover,s=De({default:{colors:{margin:"0 -10px",padding:"10px 0 0 10px",borderTop:"1px solid #eee",display:"flex",flexWrap:"wrap",position:"relative"},swatchWrap:{width:"16px",height:"16px",margin:"0 10px 10px 0"},swatch:{borderRadius:"3px",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15)"}},"no-presets":{colors:{display:"none"}}},{"no-presets":!r||!r.length}),l=function(d,h){i({hex:d,source:"hex"},h)};return $.createElement("div",{style:s.colors,className:"flexbox-fix"},r.map(function(c){var d=typeof c=="string"?{color:c}:c,h=""+d.color+(d.title||"");return $.createElement("div",{key:h,style:s.swatchWrap},$.createElement(Zi,MB({},d,{style:s.swatch,onClick:l,onHover:o,focusStyle:{boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15), 0 0 4px "+d.color}})))}))};J1.propTypes={colors:ye.arrayOf(ye.oneOfType([ye.string,ye.shape({color:ye.string,title:ye.string})])).isRequired};var $B=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},tm=function(e){var r=e.width,n=e.rgb,i=e.hex,o=e.hsv,s=e.hsl,l=e.onChange,c=e.onSwatchHover,d=e.disableAlpha,h=e.presetColors,f=e.renderers,u=e.styles,p=u===void 0?{}:u,g=e.className,m=g===void 0?"":g,x=De(ar({default:$B({picker:{width:r,padding:"10px 10px 0",boxSizing:"initial",background:"#fff",borderRadius:"4px",boxShadow:"0 0 0 1px rgba(0,0,0,.15), 0 8px 16px rgba(0,0,0,.15)"},saturation:{width:"100%",paddingBottom:"75%",position:"relative",overflow:"hidden"},Saturation:{radius:"3px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},controls:{display:"flex"},sliders:{padding:"4px 0",flex:"1"},color:{width:"24px",height:"24px",position:"relative",marginTop:"4px",marginLeft:"4px",borderRadius:"3px"},activeColor:{absolute:"0px 0px 0px 0px",borderRadius:"2px",background:"rgba("+n.r+","+n.g+","+n.b+","+n.a+")",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},hue:{position:"relative",height:"10px",overflow:"hidden"},Hue:{radius:"2px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},alpha:{position:"relative",height:"10px",marginTop:"4px",overflow:"hidden"},Alpha:{radius:"2px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"}},p),disableAlpha:{color:{height:"10px"},hue:{height:"10px"},alpha:{display:"none"}}},p),{disableAlpha:d});return $.createElement("div",{style:x.picker,className:"sketch-picker "+m},$.createElement("div",{style:x.saturation},$.createElement(Rd,{style:x.Saturation,hsl:s,hsv:o,onChange:l})),$.createElement("div",{style:x.controls,className:"flexbox-fix"},$.createElement("div",{style:x.sliders},$.createElement("div",{style:x.hue},$.createElement(Cs,{style:x.Hue,hsl:s,onChange:l})),$.createElement("div",{style:x.alpha},$.createElement(Ip,{style:x.Alpha,rgb:n,hsl:s,renderers:f,onChange:l}))),$.createElement("div",{style:x.color},$.createElement(js,null),$.createElement("div",{style:x.activeColor}))),$.createElement(AB,{rgb:n,hsl:s,hex:i,onChange:l,disableAlpha:d}),$.createElement(J1,{colors:h,onClick:l,onSwatchHover:c}))};tm.propTypes={disableAlpha:ye.bool,width:ye.oneOfType([ye.string,ye.number]),styles:ye.object};tm.defaultProps={disableAlpha:!1,width:200,styles:{},presetColors:["#D0021B","#F5A623","#F8E71C","#8B572A","#7ED321","#417505","#BD10E0","#9013FE","#4A90E2","#50E3C2","#B8E986","#000000","#4A4A4A","#9B9B9B","#FFFFFF"]};lr(tm);var Gs=function(e){var r=e.hsl,n=e.offset,i=e.onClick,o=i===void 0?function(){}:i,s=e.active,l=e.first,c=e.last,d=De({default:{swatch:{height:"12px",background:"hsl("+r.h+", 50%, "+n*100+"%)",cursor:"pointer"}},first:{swatch:{borderRadius:"2px 0 0 2px"}},last:{swatch:{borderRadius:"0 2px 2px 0"}},active:{swatch:{transform:"scaleY(1.8)",borderRadius:"3.6px/2px"}}},{active:s,first:l,last:c}),h=function(u){return o({h:r.h,s:.5,l:n,source:"hsl"},u)};return $.createElement("div",{style:d.swatch,onClick:h})},IB=function(e){var r=e.onClick,n=e.hsl,i=De({default:{swatches:{marginTop:"20px"},swatch:{boxSizing:"border-box",width:"20%",paddingRight:"1px",float:"left"},clear:{clear:"both"}}}),o=.1;return $.createElement("div",{style:i.swatches},$.createElement("div",{style:i.swatch},$.createElement(Gs,{hsl:n,offset:".80",active:Math.abs(n.l-.8)<o&&Math.abs(n.s-.5)<o,onClick:r,first:!0})),$.createElement("div",{style:i.swatch},$.createElement(Gs,{hsl:n,offset:".65",active:Math.abs(n.l-.65)<o&&Math.abs(n.s-.5)<o,onClick:r})),$.createElement("div",{style:i.swatch},$.createElement(Gs,{hsl:n,offset:".50",active:Math.abs(n.l-.5)<o&&Math.abs(n.s-.5)<o,onClick:r})),$.createElement("div",{style:i.swatch},$.createElement(Gs,{hsl:n,offset:".35",active:Math.abs(n.l-.35)<o&&Math.abs(n.s-.5)<o,onClick:r})),$.createElement("div",{style:i.swatch},$.createElement(Gs,{hsl:n,offset:".20",active:Math.abs(n.l-.2)<o&&Math.abs(n.s-.5)<o,onClick:r,last:!0})),$.createElement("div",{style:i.clear}))},LB=function(){var e=De({default:{picker:{width:"14px",height:"14px",borderRadius:"6px",transform:"translate(-7px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}}});return $.createElement("div",{style:e.picker})},rm=function(e){var r=e.hsl,n=e.onChange,i=e.pointer,o=e.styles,s=o===void 0?{}:o,l=e.className,c=l===void 0?"":l,d=De(ar({default:{hue:{height:"12px",position:"relative"},Hue:{radius:"2px"}}},s));return $.createElement("div",{style:d.wrap||{},className:"slider-picker "+c},$.createElement("div",{style:d.hue},$.createElement(Cs,{style:d.Hue,hsl:r,pointer:i,onChange:n})),$.createElement("div",{style:d.swatches},$.createElement(IB,{hsl:r,onClick:n})))};rm.propTypes={styles:ye.object};rm.defaultProps={pointer:LB,styles:{}};lr(rm);var Q1={};Object.defineProperty(Q1,"__esModule",{value:!0});var Kv=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},DB=A,Yv=zB(DB);function zB(t){return t&&t.__esModule?t:{default:t}}function FB(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}var Vl=24,BB=Q1.default=function(t){var e=t.fill,r=e===void 0?"currentColor":e,n=t.width,i=n===void 0?Vl:n,o=t.height,s=o===void 0?Vl:o,l=t.style,c=l===void 0?{}:l,d=FB(t,["fill","width","height","style"]);return Yv.default.createElement("svg",Kv({viewBox:"0 0 "+Vl+" "+Vl,style:Kv({fill:r,width:i,height:s},c)},d),Yv.default.createElement("path",{d:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"}))},UB=function(e){var r=e.color,n=e.onClick,i=n===void 0?function(){}:n,o=e.onSwatchHover,s=e.first,l=e.last,c=e.active,d=De({default:{color:{width:"40px",height:"24px",cursor:"pointer",background:r,marginBottom:"1px"},check:{color:Wp(r),marginLeft:"8px",display:"none"}},first:{color:{overflow:"hidden",borderRadius:"2px 2px 0 0"}},last:{color:{overflow:"hidden",borderRadius:"0 0 2px 2px"}},active:{check:{display:"block"}},"color-#FFFFFF":{color:{boxShadow:"inset 0 0 0 1px #ddd"},check:{color:"#333"}},transparent:{check:{color:"#333"}}},{first:s,last:l,active:c,"color-#FFFFFF":r==="#FFFFFF",transparent:r==="transparent"});return $.createElement(Zi,{color:r,style:d.color,onClick:i,onHover:o,focusStyle:{boxShadow:"0 0 4px "+r}},$.createElement("div",{style:d.check},$.createElement(BB,null)))},HB=function(e){var r=e.onClick,n=e.onSwatchHover,i=e.group,o=e.active,s=De({default:{group:{paddingBottom:"10px",width:"40px",float:"left",marginRight:"10px"}}});return $.createElement("div",{style:s.group},Ji(i,function(l,c){return $.createElement(UB,{key:l,color:l,active:l.toLowerCase()===o,first:c===0,last:c===i.length-1,onClick:r,onSwatchHover:n})}))},nm=function(e){var r=e.width,n=e.height,i=e.onChange,o=e.onSwatchHover,s=e.colors,l=e.hex,c=e.styles,d=c===void 0?{}:c,h=e.className,f=h===void 0?"":h,u=De(ar({default:{picker:{width:r,height:n},overflow:{height:n,overflowY:"scroll"},body:{padding:"16px 0 6px 16px"},clear:{clear:"both"}}},d)),p=function(m,x){return i({hex:m,source:"hex"},x)};return $.createElement("div",{style:u.picker,className:"swatches-picker "+f},$.createElement(Qa,null,$.createElement("div",{style:u.overflow},$.createElement("div",{style:u.body},Ji(s,function(g){return $.createElement(HB,{key:g.toString(),group:g,active:l,onClick:p,onSwatchHover:o})}),$.createElement("div",{style:u.clear})))))};nm.propTypes={width:ye.oneOfType([ye.string,ye.number]),height:ye.oneOfType([ye.string,ye.number]),colors:ye.arrayOf(ye.arrayOf(ye.string)),styles:ye.object};nm.defaultProps={width:320,height:240,colors:[[wo[900],wo[700],wo[500],wo[300],wo[100]],[_o[900],_o[700],_o[500],_o[300],_o[100]],[So[900],So[700],So[500],So[300],So[100]],[ko[900],ko[700],ko[500],ko[300],ko[100]],[jo[900],jo[700],jo[500],jo[300],jo[100]],[Co[900],Co[700],Co[500],Co[300],Co[100]],[Eo[900],Eo[700],Eo[500],Eo[300],Eo[100]],[To[900],To[700],To[500],To[300],To[100]],[Ro[900],Ro[700],Ro[500],Ro[300],Ro[100]],["#194D33",ta[700],ta[500],ta[300],ta[100]],[No[900],No[700],No[500],No[300],No[100]],[Po[900],Po[700],Po[500],Po[300],Po[100]],[Oo[900],Oo[700],Oo[500],Oo[300],Oo[100]],[Ao[900],Ao[700],Ao[500],Ao[300],Ao[100]],[Mo[900],Mo[700],Mo[500],Mo[300],Mo[100]],[$o[900],$o[700],$o[500],$o[300],$o[100]],[Io[900],Io[700],Io[500],Io[300],Io[100]],[Lo[900],Lo[700],Lo[500],Lo[300],Lo[100]],["#000000","#525252","#969696","#D9D9D9","#FFFFFF"]],styles:{}};lr(nm);var im=function(e){var r=e.onChange,n=e.onSwatchHover,i=e.hex,o=e.colors,s=e.width,l=e.triangle,c=e.styles,d=c===void 0?{}:c,h=e.className,f=h===void 0?"":h,u=De(ar({default:{card:{width:s,background:"#fff",border:"0 solid rgba(0,0,0,0.25)",boxShadow:"0 1px 4px rgba(0,0,0,0.25)",borderRadius:"4px",position:"relative"},body:{padding:"15px 9px 9px 15px"},label:{fontSize:"18px",color:"#fff"},triangle:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 9px 10px 9px",borderColor:"transparent transparent #fff transparent",position:"absolute"},triangleShadow:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 9px 10px 9px",borderColor:"transparent transparent rgba(0,0,0,.1) transparent",position:"absolute"},hash:{background:"#F0F0F0",height:"30px",width:"30px",borderRadius:"4px 0 0 4px",float:"left",color:"#98A1A4",display:"flex",alignItems:"center",justifyContent:"center"},input:{width:"100px",fontSize:"14px",color:"#666",border:"0px",outline:"none",height:"28px",boxShadow:"inset 0 0 0 1px #F0F0F0",boxSizing:"content-box",borderRadius:"0 4px 4px 0",float:"left",paddingLeft:"8px"},swatch:{width:"30px",height:"30px",float:"left",borderRadius:"4px",margin:"0 6px 6px 0"},clear:{clear:"both"}},"hide-triangle":{triangle:{display:"none"},triangleShadow:{display:"none"}},"top-left-triangle":{triangle:{top:"-10px",left:"12px"},triangleShadow:{top:"-11px",left:"12px"}},"top-right-triangle":{triangle:{top:"-10px",right:"12px"},triangleShadow:{top:"-11px",right:"12px"}}},d),{"hide-triangle":l==="hide","top-left-triangle":l==="top-left","top-right-triangle":l==="top-right"}),p=function(m,x){di(m)&&r({hex:m,source:"hex"},x)};return $.createElement("div",{style:u.card,className:"twitter-picker "+f},$.createElement("div",{style:u.triangleShadow}),$.createElement("div",{style:u.triangle}),$.createElement("div",{style:u.body},Ji(o,function(g,m){return $.createElement(Zi,{key:m,color:g,hex:g,style:u.swatch,onClick:p,onHover:n,focusStyle:{boxShadow:"0 0 4px "+g}})}),$.createElement("div",{style:u.hash},"#"),$.createElement(Xe,{label:null,style:{input:u.input},value:i.replace("#",""),onChange:p}),$.createElement("div",{style:u.clear})))};im.propTypes={width:ye.oneOfType([ye.string,ye.number]),triangle:ye.oneOf(["hide","top-left","top-right"]),colors:ye.arrayOf(ye.string),styles:ye.object};im.defaultProps={width:276,colors:["#FF6900","#FCB900","#7BDCB5","#00D084","#8ED1FC","#0693E3","#ABB8C3","#EB144C","#F78DA7","#9900EF"],triangle:"top-left",styles:{}};lr(im);var om=function(e){var r=De({default:{picker:{width:"20px",height:"20px",borderRadius:"22px",border:"2px #fff solid",transform:"translate(-12px, -13px)",background:"hsl("+Math.round(e.hsl.h)+", "+Math.round(e.hsl.s*100)+"%, "+Math.round(e.hsl.l*100)+"%)"}}});return $.createElement("div",{style:r.picker})};om.propTypes={hsl:ye.shape({h:ye.number,s:ye.number,l:ye.number,a:ye.number})};om.defaultProps={hsl:{a:1,h:249.94,l:.2,s:.5}};var sm=function(e){var r=De({default:{picker:{width:"20px",height:"20px",borderRadius:"22px",transform:"translate(-10px, -7px)",background:"hsl("+Math.round(e.hsl.h)+", 100%, 50%)",border:"2px white solid"}}});return $.createElement("div",{style:r.picker})};sm.propTypes={hsl:ye.shape({h:ye.number,s:ye.number,l:ye.number,a:ye.number})};sm.defaultProps={hsl:{a:1,h:249.94,l:.2,s:.5}};var WB=function(e){var r=e.onChange,n=e.rgb,i=e.hsl,o=e.hex,s=e.hsv,l=function(p,g){if(p.hex)di(p.hex)&&r({hex:p.hex,source:"hex"},g);else if(p.rgb){var m=p.rgb.split(",");Ou(p.rgb,"rgb")&&r({r:m[0],g:m[1],b:m[2],a:1,source:"rgb"},g)}else if(p.hsv){var x=p.hsv.split(",");Ou(p.hsv,"hsv")&&(x[2]=x[2].replace("%",""),x[1]=x[1].replace("%",""),x[0]=x[0].replace("",""),x[1]==1?x[1]=.01:x[2]==1&&(x[2]=.01),r({h:Number(x[0]),s:Number(x[1]),v:Number(x[2]),source:"hsv"},g))}else if(p.hsl){var v=p.hsl.split(",");Ou(p.hsl,"hsl")&&(v[2]=v[2].replace("%",""),v[1]=v[1].replace("%",""),v[0]=v[0].replace("",""),f[1]==1?f[1]=.01:f[2]==1&&(f[2]=.01),r({h:Number(v[0]),s:Number(v[1]),v:Number(v[2]),source:"hsl"},g))}},c=De({default:{wrap:{display:"flex",height:"100px",marginTop:"4px"},fields:{width:"100%"},column:{paddingTop:"10px",display:"flex",justifyContent:"space-between"},double:{padding:"0px 4.4px",boxSizing:"border-box"},input:{width:"100%",height:"38px",boxSizing:"border-box",padding:"4px 10% 3px",textAlign:"center",border:"1px solid #dadce0",fontSize:"11px",textTransform:"lowercase",borderRadius:"5px",outline:"none",fontFamily:"Roboto,Arial,sans-serif"},input2:{height:"38px",width:"100%",border:"1px solid #dadce0",boxSizing:"border-box",fontSize:"11px",textTransform:"lowercase",borderRadius:"5px",outline:"none",paddingLeft:"10px",fontFamily:"Roboto,Arial,sans-serif"},label:{textAlign:"center",fontSize:"12px",background:"#fff",position:"absolute",textTransform:"uppercase",color:"#3c4043",width:"35px",top:"-6px",left:"0",right:"0",marginLeft:"auto",marginRight:"auto",fontFamily:"Roboto,Arial,sans-serif"},label2:{left:"10px",textAlign:"center",fontSize:"12px",background:"#fff",position:"absolute",textTransform:"uppercase",color:"#3c4043",width:"32px",top:"-6px",fontFamily:"Roboto,Arial,sans-serif"},single:{flexGrow:"1",margin:"0px 4.4px"}}}),d=n.r+", "+n.g+", "+n.b,h=Math.round(i.h)+", "+Math.round(i.s*100)+"%, "+Math.round(i.l*100)+"%",f=Math.round(s.h)+", "+Math.round(s.s*100)+"%, "+Math.round(s.v*100)+"%";return $.createElement("div",{style:c.wrap,className:"flexbox-fix"},$.createElement("div",{style:c.fields},$.createElement("div",{style:c.double},$.createElement(Xe,{style:{input:c.input,label:c.label},label:"hex",value:o,onChange:l})),$.createElement("div",{style:c.column},$.createElement("div",{style:c.single},$.createElement(Xe,{style:{input:c.input2,label:c.label2},label:"rgb",value:d,onChange:l})),$.createElement("div",{style:c.single},$.createElement(Xe,{style:{input:c.input2,label:c.label2},label:"hsv",value:f,onChange:l})),$.createElement("div",{style:c.single},$.createElement(Xe,{style:{input:c.input2,label:c.label2},label:"hsl",value:h,onChange:l})))))},am=function(e){var r=e.width,n=e.onChange,i=e.rgb,o=e.hsl,s=e.hsv,l=e.hex,c=e.header,d=e.styles,h=d===void 0?{}:d,f=e.className,u=f===void 0?"":f,p=De(ar({default:{picker:{width:r,background:"#fff",border:"1px solid #dfe1e5",boxSizing:"initial",display:"flex",flexWrap:"wrap",borderRadius:"8px 8px 0px 0px"},head:{height:"57px",width:"100%",paddingTop:"16px",paddingBottom:"16px",paddingLeft:"16px",fontSize:"20px",boxSizing:"border-box",fontFamily:"Roboto-Regular,HelveticaNeue,Arial,sans-serif"},saturation:{width:"70%",padding:"0px",position:"relative",overflow:"hidden"},swatch:{width:"30%",height:"228px",padding:"0px",background:"rgba("+i.r+", "+i.g+", "+i.b+", 1)",position:"relative",overflow:"hidden"},body:{margin:"auto",width:"95%"},controls:{display:"flex",boxSizing:"border-box",height:"52px",paddingTop:"22px"},color:{width:"32px"},hue:{height:"8px",position:"relative",margin:"0px 16px 0px 16px",width:"100%"},Hue:{radius:"2px"}}},h));return $.createElement("div",{style:p.picker,className:"google-picker "+u},$.createElement("div",{style:p.head},c),$.createElement("div",{style:p.swatch}),$.createElement("div",{style:p.saturation},$.createElement(Rd,{hsl:o,hsv:s,pointer:om,onChange:n})),$.createElement("div",{style:p.body},$.createElement("div",{style:p.controls,className:"flexbox-fix"},$.createElement("div",{style:p.hue},$.createElement(Cs,{style:p.Hue,hsl:o,radius:"4px",pointer:sm,onChange:n}))),$.createElement(WB,{rgb:i,hsl:o,hex:l,hsv:s,onChange:n})))};am.propTypes={width:ye.oneOfType([ye.string,ye.number]),styles:ye.object,header:ye.string};am.defaultProps={width:652,styles:{},header:"Color picker"};lr(am);function GB({color:t,mode:e="blend",onColorChange:r,onClose:n}){var d;const[i,o]=A.useState((t==null?void 0:t.hex)||"#000000");A.useEffect(()=>{t!=null&&t.hex&&o(t.hex)},[t==null?void 0:t.hex]);const s=h=>{const f=h.hex;o(f),r&&r(f)},l=()=>{t!=null&&t.originalHex&&(o(t.originalHex),r&&r(t.originalHex))},c=h=>{const f=h.hex;o(f),r&&r(f)};return t?a.jsxs("div",{className:"color-editor-panel",children:[a.jsxs("div",{className:"editor-header",children:[a.jsx("h3",{children:"Edit Colour"}),a.jsx("button",{onClick:n,className:"close-button",children:""})]}),a.jsxs("div",{className:"editor-content",children:[a.jsxs("div",{className:"color-info-section",children:[a.jsx("div",{className:"color-display",children:a.jsxs("div",{className:"swatch-pair",children:[a.jsxs("div",{className:"swatch-group",children:[a.jsx("div",{className:"swatch original",style:{backgroundColor:t.originalHex||t.hex},title:"Original colour"}),a.jsx("span",{className:"swatch-label",children:"Original"})]}),a.jsx("span",{className:"arrow",children:""}),a.jsxs("div",{className:"swatch-group",children:[a.jsx("div",{className:"swatch current",style:{backgroundColor:i},title:"Current colour"}),a.jsx("span",{className:"swatch-label",children:"Current"})]})]})}),a.jsxs("div",{className:"color-details",children:[a.jsxs("div",{className:"detail-row",children:[a.jsx("span",{className:"label",children:"Hex:"}),a.jsx("span",{className:"value",children:i})]}),a.jsxs("div",{className:"detail-row",children:[a.jsx("span",{className:"label",children:"Coverage:"}),a.jsxs("span",{className:"value",children:[((d=t.areaPct)==null?void 0:d.toFixed(1))||0,"%"]})]})]})]}),a.jsxs("div",{className:"tpv-palette-section",children:[a.jsx("h4",{children:"Standard TPV Colours"}),a.jsx("p",{className:"palette-description",children:"Select a pure TPV colour (no blending required)"}),a.jsx("div",{className:"tpv-color-grid",children:nn.map(h=>a.jsxs("div",{className:`tpv-color-item ${i.toLowerCase()===h.hex.toLowerCase()?"selected":""}`,onClick:()=>c(h),title:`${h.code} - ${h.name}`,children:[a.jsx("div",{className:"tpv-color-swatch",style:{backgroundColor:h.hex}}),a.jsx("span",{className:"tpv-color-code",children:h.code})]},h.code))})]}),e==="blend"&&a.jsxs("div",{className:"picker-section",children:[a.jsx("h4",{children:"Custom Colour"}),a.jsx("p",{className:"picker-description",children:"Choose any colour (may require blending)"}),a.jsx(vB,{color:i,onChange:s,disableAlpha:!0}),a.jsx("button",{onClick:l,className:"reset-button",children:"Reset to Original Colour"})]}),e==="solid"&&a.jsxs("div",{className:"solid-mode-info",children:[a.jsx("h4",{children:"Solid Mode Editing"}),a.jsx("p",{className:"info-description",children:"In solid mode, you can only select from the standard TPV colours above. Custom colours require blending - switch to Blend Mode for full colour customisation."}),a.jsx("button",{onClick:l,className:"reset-button",children:"Reset to Original Colour"})]})]}),a.jsx("style",{jsx:!0,children:`
        .color-editor-panel {
          position: fixed;
          top: 0;
          right: 0;
          width: 400px;
          height: 100vh;
          background: white;
          box-shadow: -4px 0 12px rgba(0, 0, 0, 0.15);
          z-index: 1000;
          display: flex;
          flex-direction: column;
          overflow: hidden;
        }

        .editor-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 1.5rem;
          border-bottom: 2px solid #1a365d;
          background: #f9f9f9;
        }

        .editor-header h3 {
          font-family: 'Space Grotesk', sans-serif;
          margin: 0;
          color: #1e4a7a;
          font-size: 1.5rem;
          font-weight: 600;
        }

        .close-button {
          background: none;
          border: none;
          font-size: 2rem;
          color: #666;
          cursor: pointer;
          padding: 0;
          width: 32px;
          height: 32px;
          line-height: 1;
          transition: color 0.2s;
        }

        .close-button:hover {
          color: #333;
        }

        .editor-content {
          flex: 1;
          overflow-y: auto;
          padding: 1.5rem;
        }

        /* Color Info Section */
        .color-info-section {
          margin-bottom: 2rem;
          padding: 1rem;
          background: #f9f9f9;
          border-radius: 6px;
        }

        .color-display {
          margin-bottom: 1rem;
        }

        .swatch-pair {
          display: flex;
          align-items: center;
          gap: 1rem;
          justify-content: center;
        }

        .swatch-group {
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 0.5rem;
        }

        .swatch {
          width: 60px;
          height: 60px;
          border-radius: 8px;
          border: 3px solid #ddd;
          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .swatch.original {
          border-color: #999;
        }

        .swatch.current {
          border-color: #ff6b35;
        }

        .swatch-label {
          font-size: 0.85rem;
          color: #666;
          font-weight: 500;
        }

        .arrow {
          font-size: 1.5rem;
          color: #666;
          font-weight: bold;
        }

        .color-details {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .detail-row {
          display: flex;
          justify-content: space-between;
          align-items: center;
          font-size: 0.95rem;
        }

        .detail-row .label {
          font-weight: 600;
          color: #666;
        }

        .detail-row .value {
          font-family: 'Courier New', monospace;
          color: #333;
        }

        /* TPV Palette Section */
        .tpv-palette-section {
          margin-bottom: 2rem;
          padding: 1rem;
          background: #f9f9f9;
          border-radius: 6px;
        }

        .tpv-palette-section h4 {
          margin: 0 0 0.5rem 0;
          color: #1a365d;
          font-size: 1rem;
          font-weight: 600;
        }

        .palette-description {
          margin: 0 0 1rem 0;
          font-size: 0.85rem;
          color: #666;
        }

        .tpv-color-grid {
          display: grid;
          grid-template-columns: repeat(3, 1fr);
          gap: 0.75rem;
        }

        .tpv-color-item {
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 0.4rem;
          padding: 0.5rem;
          border: 2px solid transparent;
          border-radius: 6px;
          cursor: pointer;
          transition: all 0.2s;
          background: white;
        }

        .tpv-color-item:hover {
          border-color: #ff6b35;
          transform: translateY(-2px);
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .tpv-color-item.selected {
          border-color: #ff6b35;
          background: #fff5f0;
          box-shadow: 0 0 0 2px rgba(255, 107, 53, 0.2);
        }

        .tpv-color-swatch {
          width: 100%;
          height: 50px;
          border-radius: 4px;
          border: 1px solid rgba(0, 0, 0, 0.1);
          box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .tpv-color-code {
          font-size: 0.75rem;
          font-weight: 600;
          color: #1a365d;
          font-family: 'Courier New', monospace;
        }

        /* Picker Section */
        .picker-section {
          margin-bottom: 1rem;
          padding: 1rem;
          background: #f9f9f9;
          border-radius: 6px;
        }

        .picker-section h4 {
          margin: 0 0 0.5rem 0;
          color: #1a365d;
          font-size: 1rem;
          font-weight: 600;
        }

        .picker-description {
          margin: 0 0 1rem 0;
          font-size: 0.85rem;
          color: #666;
        }

        .picker-section :global(.chrome-picker) {
          box-shadow: none !important;
          width: 100% !important;
        }

        .reset-button {
          width: 100%;
          padding: 0.75rem;
          margin-top: 1rem;
          background: #e0e0e0;
          color: #333;
          border: none;
          border-radius: 4px;
          font-weight: 600;
          cursor: pointer;
          transition: background 0.2s;
        }

        .reset-button:hover {
          background: #d0d0d0;
        }

        /* Solid Mode Info */
        .solid-mode-info {
          margin-bottom: 1rem;
          padding: 1rem;
          background: #fff5f0;
          border: 2px solid #ff6b35;
          border-radius: 6px;
        }

        .solid-mode-info h4 {
          margin: 0 0 0.5rem 0;
          color: #1a365d;
          font-size: 1rem;
          font-weight: 600;
        }

        .info-description {
          margin: 0;
          font-size: 0.85rem;
          color: #666;
          line-height: 1.5;
        }

        /* Mobile Responsive - Fullscreen Modal */
        @media (max-width: 768px) {
          .color-editor-panel {
            width: 100%;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 0;
          }

          .editor-header {
            padding: 1rem;
            position: sticky;
            top: 0;
            z-index: 10;
          }

          .editor-header h3 {
            font-size: 1.25rem;
          }

          /* Larger close button for touch */
          .close-button {
            width: 44px;
            height: 44px;
            font-size: 2.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
          }

          .editor-content {
            padding: 1rem;
          }

          /* Color swatches - larger for touch */
          .swatch {
            width: 50px;
            height: 50px;
          }

          .color-info-section {
            padding: 0.75rem;
            margin-bottom: 1.5rem;
          }

          /* TPV color grid - better touch targets */
          .tpv-color-grid {
            grid-template-columns: repeat(4, 1fr);
            gap: 0.5rem;
          }

          .tpv-color-item {
            padding: 0.4rem;
            min-height: 44px;
          }

          .tpv-color-swatch {
            height: 36px;
          }

          .tpv-color-code {
            font-size: 0.65rem;
          }

          .tpv-palette-section {
            padding: 0.75rem;
            margin-bottom: 1.5rem;
          }

          .tpv-palette-section h4 {
            font-size: 0.9rem;
          }

          .palette-description {
            font-size: 0.8rem;
          }

          /* Picker section */
          .picker-section {
            padding: 0.75rem;
          }

          .picker-section h4 {
            font-size: 0.9rem;
          }

          .picker-description {
            font-size: 0.8rem;
          }

          /* Larger reset button for touch */
          .reset-button {
            min-height: 44px;
            font-size: 0.9rem;
          }

          .solid-mode-info {
            padding: 0.75rem;
          }

          .solid-mode-info h4 {
            font-size: 0.9rem;
          }

          .info-description {
            font-size: 0.8rem;
          }
        }

        /* Extra small screens */
        @media (max-width: 400px) {
          .tpv-color-grid {
            grid-template-columns: repeat(3, 1fr);
          }

          .tpv-color-swatch {
            height: 44px;
          }

          .swatch {
            width: 44px;
            height: 44px;
          }

          .swatch-pair {
            gap: 0.5rem;
          }

          .arrow {
            font-size: 1.2rem;
          }
        }
      `})]}):null}const yn=11102230246251565e-32,Ht=134217729,VB=(3+8*yn)*yn;function Mu(t,e,r,n,i){let o,s,l,c,d=e[0],h=n[0],f=0,u=0;h>d==h>-d?(o=d,d=e[++f]):(o=h,h=n[++u]);let p=0;if(f<t&&u<r)for(h>d==h>-d?(s=d+o,l=o-(s-d),d=e[++f]):(s=h+o,l=o-(s-h),h=n[++u]),o=s,l!==0&&(i[p++]=l);f<t&&u<r;)h>d==h>-d?(s=o+d,c=s-o,l=o-(s-c)+(d-c),d=e[++f]):(s=o+h,c=s-o,l=o-(s-c)+(h-c),h=n[++u]),o=s,l!==0&&(i[p++]=l);for(;f<t;)s=o+d,c=s-o,l=o-(s-c)+(d-c),d=e[++f],o=s,l!==0&&(i[p++]=l);for(;u<r;)s=o+h,c=s-o,l=o-(s-c)+(h-c),h=n[++u],o=s,l!==0&&(i[p++]=l);return(o!==0||p===0)&&(i[p++]=o),p}function qB(t,e){let r=e[0];for(let n=1;n<t;n++)r+=e[n];return r}function el(t){return new Float64Array(t)}const KB=(3+16*yn)*yn,YB=(2+12*yn)*yn,XB=(9+64*yn)*yn*yn,vo=el(4),Xv=el(8),Zv=el(12),Jv=el(16),qt=el(4);function ZB(t,e,r,n,i,o,s){let l,c,d,h,f,u,p,g,m,x,v,y,b,w,k,S,C,T;const R=t-i,O=r-i,Y=e-o,E=n-o;w=R*E,u=Ht*R,p=u-(u-R),g=R-p,u=Ht*E,m=u-(u-E),x=E-m,k=g*x-(w-p*m-g*m-p*x),S=Y*O,u=Ht*Y,p=u-(u-Y),g=Y-p,u=Ht*O,m=u-(u-O),x=O-m,C=g*x-(S-p*m-g*m-p*x),v=k-C,f=k-v,vo[0]=k-(v+f)+(f-C),y=w+v,f=y-w,b=w-(y-f)+(v-f),v=b-S,f=b-v,vo[1]=b-(v+f)+(f-S),T=y+v,f=T-y,vo[2]=y-(T-f)+(v-f),vo[3]=T;let B=qB(4,vo),_=YB*s;if(B>=_||-B>=_||(f=t-R,l=t-(R+f)+(f-i),f=r-O,d=r-(O+f)+(f-i),f=e-Y,c=e-(Y+f)+(f-o),f=n-E,h=n-(E+f)+(f-o),l===0&&c===0&&d===0&&h===0)||(_=XB*s+VB*Math.abs(B),B+=R*h+E*l-(Y*d+O*c),B>=_||-B>=_))return B;w=l*E,u=Ht*l,p=u-(u-l),g=l-p,u=Ht*E,m=u-(u-E),x=E-m,k=g*x-(w-p*m-g*m-p*x),S=c*O,u=Ht*c,p=u-(u-c),g=c-p,u=Ht*O,m=u-(u-O),x=O-m,C=g*x-(S-p*m-g*m-p*x),v=k-C,f=k-v,qt[0]=k-(v+f)+(f-C),y=w+v,f=y-w,b=w-(y-f)+(v-f),v=b-S,f=b-v,qt[1]=b-(v+f)+(f-S),T=y+v,f=T-y,qt[2]=y-(T-f)+(v-f),qt[3]=T;const V=Mu(4,vo,4,qt,Xv);w=R*h,u=Ht*R,p=u-(u-R),g=R-p,u=Ht*h,m=u-(u-h),x=h-m,k=g*x-(w-p*m-g*m-p*x),S=Y*d,u=Ht*Y,p=u-(u-Y),g=Y-p,u=Ht*d,m=u-(u-d),x=d-m,C=g*x-(S-p*m-g*m-p*x),v=k-C,f=k-v,qt[0]=k-(v+f)+(f-C),y=w+v,f=y-w,b=w-(y-f)+(v-f),v=b-S,f=b-v,qt[1]=b-(v+f)+(f-S),T=y+v,f=T-y,qt[2]=y-(T-f)+(v-f),qt[3]=T;const re=Mu(V,Xv,4,qt,Zv);w=l*h,u=Ht*l,p=u-(u-l),g=l-p,u=Ht*h,m=u-(u-h),x=h-m,k=g*x-(w-p*m-g*m-p*x),S=c*d,u=Ht*c,p=u-(u-c),g=c-p,u=Ht*d,m=u-(u-d),x=d-m,C=g*x-(S-p*m-g*m-p*x),v=k-C,f=k-v,qt[0]=k-(v+f)+(f-C),y=w+v,f=y-w,b=w-(y-f)+(v-f),v=b-S,f=b-v,qt[1]=b-(v+f)+(f-S),T=y+v,f=T-y,qt[2]=y-(T-f)+(v-f),qt[3]=T;const I=Mu(re,Zv,4,qt,Jv);return Jv[I-1]}function ql(t,e,r,n,i,o){const s=(e-o)*(r-i),l=(t-i)*(n-o),c=s-l,d=Math.abs(s+l);return Math.abs(c)>=KB*d?c:-ZB(t,e,r,n,i,o,d)}const Qv=Math.pow(2,-52),Kl=new Uint32Array(512);class Yc{static from(e,r=r7,n=n7){const i=e.length,o=new Float64Array(i*2);for(let s=0;s<i;s++){const l=e[s];o[2*s]=r(l),o[2*s+1]=n(l)}return new Yc(o)}constructor(e){const r=e.length>>1;if(r>0&&typeof e[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=e;const n=Math.max(2*r-5,0);this._triangles=new Uint32Array(n*3),this._halfedges=new Int32Array(n*3),this._hashSize=Math.ceil(Math.sqrt(r)),this._hullPrev=new Uint32Array(r),this._hullNext=new Uint32Array(r),this._hullTri=new Uint32Array(r),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(r),this._dists=new Float64Array(r),this.update()}update(){const{coords:e,_hullPrev:r,_hullNext:n,_hullTri:i,_hullHash:o}=this,s=e.length>>1;let l=1/0,c=1/0,d=-1/0,h=-1/0;for(let R=0;R<s;R++){const O=e[2*R],Y=e[2*R+1];O<l&&(l=O),Y<c&&(c=Y),O>d&&(d=O),Y>h&&(h=Y),this._ids[R]=R}const f=(l+d)/2,u=(c+h)/2;let p,g,m;for(let R=0,O=1/0;R<s;R++){const Y=$u(f,u,e[2*R],e[2*R+1]);Y<O&&(p=R,O=Y)}const x=e[2*p],v=e[2*p+1];for(let R=0,O=1/0;R<s;R++){if(R===p)continue;const Y=$u(x,v,e[2*R],e[2*R+1]);Y<O&&Y>0&&(g=R,O=Y)}let y=e[2*g],b=e[2*g+1],w=1/0;for(let R=0;R<s;R++){if(R===p||R===g)continue;const O=e7(x,v,y,b,e[2*R],e[2*R+1]);O<w&&(m=R,w=O)}let k=e[2*m],S=e[2*m+1];if(w===1/0){for(let Y=0;Y<s;Y++)this._dists[Y]=e[2*Y]-e[0]||e[2*Y+1]-e[1];Xo(this._ids,this._dists,0,s-1);const R=new Uint32Array(s);let O=0;for(let Y=0,E=-1/0;Y<s;Y++){const B=this._ids[Y],_=this._dists[B];_>E&&(R[O++]=B,E=_)}this.hull=R.subarray(0,O),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(ql(x,v,y,b,k,S)<0){const R=g,O=y,Y=b;g=m,y=k,b=S,m=R,k=O,S=Y}const C=t7(x,v,y,b,k,S);this._cx=C.x,this._cy=C.y;for(let R=0;R<s;R++)this._dists[R]=$u(e[2*R],e[2*R+1],C.x,C.y);Xo(this._ids,this._dists,0,s-1),this._hullStart=p;let T=3;n[p]=r[m]=g,n[g]=r[p]=m,n[m]=r[g]=p,i[p]=0,i[g]=1,i[m]=2,o.fill(-1),o[this._hashKey(x,v)]=p,o[this._hashKey(y,b)]=g,o[this._hashKey(k,S)]=m,this.trianglesLen=0,this._addTriangle(p,g,m,-1,-1,-1);for(let R=0,O,Y;R<this._ids.length;R++){const E=this._ids[R],B=e[2*E],_=e[2*E+1];if(R>0&&Math.abs(B-O)<=Qv&&Math.abs(_-Y)<=Qv||(O=B,Y=_,E===p||E===g||E===m))continue;let V=0;for(let J=0,U=this._hashKey(B,_);J<this._hashSize&&(V=o[(U+J)%this._hashSize],!(V!==-1&&V!==n[V]));J++);V=r[V];let re=V,I;for(;I=n[re],ql(B,_,e[2*re],e[2*re+1],e[2*I],e[2*I+1])>=0;)if(re=I,re===V){re=-1;break}if(re===-1)continue;let q=this._addTriangle(re,E,n[re],-1,-1,i[re]);i[E]=this._legalize(q+2),i[re]=q,T++;let D=n[re];for(;I=n[D],ql(B,_,e[2*D],e[2*D+1],e[2*I],e[2*I+1])<0;)q=this._addTriangle(D,E,I,i[E],-1,i[D]),i[E]=this._legalize(q+2),n[D]=D,T--,D=I;if(re===V)for(;I=r[re],ql(B,_,e[2*I],e[2*I+1],e[2*re],e[2*re+1])<0;)q=this._addTriangle(I,E,re,-1,i[re],i[I]),this._legalize(q+2),i[I]=q,n[re]=re,T--,re=I;this._hullStart=r[E]=re,n[re]=r[D]=E,n[E]=D,o[this._hashKey(B,_)]=E,o[this._hashKey(e[2*re],e[2*re+1])]=re}this.hull=new Uint32Array(T);for(let R=0,O=this._hullStart;R<T;R++)this.hull[R]=O,O=n[O];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(e,r){return Math.floor(JB(e-this._cx,r-this._cy)*this._hashSize)%this._hashSize}_legalize(e){const{_triangles:r,_halfedges:n,coords:i}=this;let o=0,s=0;for(;;){const l=n[e],c=e-e%3;if(s=c+(e+2)%3,l===-1){if(o===0)break;e=Kl[--o];continue}const d=l-l%3,h=c+(e+1)%3,f=d+(l+2)%3,u=r[s],p=r[e],g=r[h],m=r[f];if(QB(i[2*u],i[2*u+1],i[2*p],i[2*p+1],i[2*g],i[2*g+1],i[2*m],i[2*m+1])){r[e]=m,r[l]=u;const v=n[f];if(v===-1){let b=this._hullStart;do{if(this._hullTri[b]===f){this._hullTri[b]=e;break}b=this._hullPrev[b]}while(b!==this._hullStart)}this._link(e,v),this._link(l,n[s]),this._link(s,f);const y=d+(l+1)%3;o<Kl.length&&(Kl[o++]=y)}else{if(o===0)break;e=Kl[--o]}}return s}_link(e,r){this._halfedges[e]=r,r!==-1&&(this._halfedges[r]=e)}_addTriangle(e,r,n,i,o,s){const l=this.trianglesLen;return this._triangles[l]=e,this._triangles[l+1]=r,this._triangles[l+2]=n,this._link(l,i),this._link(l+1,o),this._link(l+2,s),this.trianglesLen+=3,l}}function JB(t,e){const r=t/(Math.abs(t)+Math.abs(e));return(e>0?3-r:1+r)/4}function $u(t,e,r,n){const i=t-r,o=e-n;return i*i+o*o}function QB(t,e,r,n,i,o,s,l){const c=t-s,d=e-l,h=r-s,f=n-l,u=i-s,p=o-l,g=c*c+d*d,m=h*h+f*f,x=u*u+p*p;return c*(f*x-m*p)-d*(h*x-m*u)+g*(h*p-f*u)<0}function e7(t,e,r,n,i,o){const s=r-t,l=n-e,c=i-t,d=o-e,h=s*s+l*l,f=c*c+d*d,u=.5/(s*d-l*c),p=(d*h-l*f)*u,g=(s*f-c*h)*u;return p*p+g*g}function t7(t,e,r,n,i,o){const s=r-t,l=n-e,c=i-t,d=o-e,h=s*s+l*l,f=c*c+d*d,u=.5/(s*d-l*c),p=t+(d*h-l*f)*u,g=e+(s*f-c*h)*u;return{x:p,y:g}}function Xo(t,e,r,n){if(n-r<=20)for(let i=r+1;i<=n;i++){const o=t[i],s=e[o];let l=i-1;for(;l>=r&&e[t[l]]>s;)t[l+1]=t[l--];t[l+1]=o}else{const i=r+n>>1;let o=r+1,s=n;Vs(t,i,o),e[t[r]]>e[t[n]]&&Vs(t,r,n),e[t[o]]>e[t[n]]&&Vs(t,o,n),e[t[r]]>e[t[o]]&&Vs(t,r,o);const l=t[o],c=e[l];for(;;){do o++;while(e[t[o]]<c);do s--;while(e[t[s]]>c);if(s<o)break;Vs(t,o,s)}t[r+1]=t[s],t[s]=l,n-o+1>=s-r?(Xo(t,e,o,n),Xo(t,e,r,s-1)):(Xo(t,e,r,s-1),Xo(t,e,o,n))}}function Vs(t,e,r){const n=t[e];t[e]=t[r],t[r]=n}function r7(t){return t[0]}function n7(t){return t[1]}const ey=1e-6;class Mi{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(e,r){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(e,r){this._+=`L${this._x1=+e},${this._y1=+r}`}arc(e,r,n){e=+e,r=+r,n=+n;const i=e+n,o=r;if(n<0)throw new Error("negative radius");this._x1===null?this._+=`M${i},${o}`:(Math.abs(this._x1-i)>ey||Math.abs(this._y1-o)>ey)&&(this._+="L"+i+","+o),n&&(this._+=`A${n},${n},0,1,1,${e-n},${r}A${n},${n},0,1,1,${this._x1=i},${this._y1=o}`)}rect(e,r,n,i){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}h${+n}v${+i}h${-n}Z`}value(){return this._||null}}class sf{constructor(){this._=[]}moveTo(e,r){this._.push([e,r])}closePath(){this._.push(this._[0].slice())}lineTo(e,r){this._.push([e,r])}value(){return this._.length?this._:null}}class i7{constructor(e,[r,n,i,o]=[0,0,960,500]){if(!((i=+i)>=(r=+r))||!((o=+o)>=(n=+n)))throw new Error("invalid bounds");this.delaunay=e,this._circumcenters=new Float64Array(e.points.length*2),this.vectors=new Float64Array(e.points.length*2),this.xmax=i,this.xmin=r,this.ymax=o,this.ymin=n,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:e,hull:r,triangles:n},vectors:i}=this;let o,s;const l=this.circumcenters=this._circumcenters.subarray(0,n.length/3*2);for(let m=0,x=0,v=n.length,y,b;m<v;m+=3,x+=2){const w=n[m]*2,k=n[m+1]*2,S=n[m+2]*2,C=e[w],T=e[w+1],R=e[k],O=e[k+1],Y=e[S],E=e[S+1],B=R-C,_=O-T,V=Y-C,re=E-T,I=(B*re-_*V)*2;if(Math.abs(I)<1e-9){if(o===void 0){o=s=0;for(const D of r)o+=e[D*2],s+=e[D*2+1];o/=r.length,s/=r.length}const q=1e9*Math.sign((o-C)*re-(s-T)*V);y=(C+Y)/2-q*re,b=(T+E)/2+q*V}else{const q=1/I,D=B*B+_*_,J=V*V+re*re;y=C+(re*D-_*J)*q,b=T+(B*J-V*D)*q}l[x]=y,l[x+1]=b}let c=r[r.length-1],d,h=c*4,f,u=e[2*c],p,g=e[2*c+1];i.fill(0);for(let m=0;m<r.length;++m)c=r[m],d=h,f=u,p=g,h=c*4,u=e[2*c],g=e[2*c+1],i[d+2]=i[h]=p-g,i[d+3]=i[h+1]=u-f}render(e){const r=e==null?e=new Mi:void 0,{delaunay:{halfedges:n,inedges:i,hull:o},circumcenters:s,vectors:l}=this;if(o.length<=1)return null;for(let h=0,f=n.length;h<f;++h){const u=n[h];if(u<h)continue;const p=Math.floor(h/3)*2,g=Math.floor(u/3)*2,m=s[p],x=s[p+1],v=s[g],y=s[g+1];this._renderSegment(m,x,v,y,e)}let c,d=o[o.length-1];for(let h=0;h<o.length;++h){c=d,d=o[h];const f=Math.floor(i[d]/3)*2,u=s[f],p=s[f+1],g=c*4,m=this._project(u,p,l[g+2],l[g+3]);m&&this._renderSegment(u,p,m[0],m[1],e)}return r&&r.value()}renderBounds(e){const r=e==null?e=new Mi:void 0;return e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),r&&r.value()}renderCell(e,r){const n=r==null?r=new Mi:void 0,i=this._clip(e);if(i===null||!i.length)return;r.moveTo(i[0],i[1]);let o=i.length;for(;i[0]===i[o-2]&&i[1]===i[o-1]&&o>1;)o-=2;for(let s=2;s<o;s+=2)(i[s]!==i[s-2]||i[s+1]!==i[s-1])&&r.lineTo(i[s],i[s+1]);return r.closePath(),n&&n.value()}*cellPolygons(){const{delaunay:{points:e}}=this;for(let r=0,n=e.length/2;r<n;++r){const i=this.cellPolygon(r);i&&(i.index=r,yield i)}}cellPolygon(e){const r=new sf;return this.renderCell(e,r),r.value()}_renderSegment(e,r,n,i,o){let s;const l=this._regioncode(e,r),c=this._regioncode(n,i);l===0&&c===0?(o.moveTo(e,r),o.lineTo(n,i)):(s=this._clipSegment(e,r,n,i,l,c))&&(o.moveTo(s[0],s[1]),o.lineTo(s[2],s[3]))}contains(e,r,n){return r=+r,r!==r||(n=+n,n!==n)?!1:this.delaunay._step(e,r,n)===e}*neighbors(e){const r=this._clip(e);if(r)for(const n of this.delaunay.neighbors(e)){const i=this._clip(n);if(i){e:for(let o=0,s=r.length;o<s;o+=2)for(let l=0,c=i.length;l<c;l+=2)if(r[o]===i[l]&&r[o+1]===i[l+1]&&r[(o+2)%s]===i[(l+c-2)%c]&&r[(o+3)%s]===i[(l+c-1)%c]){yield n;break e}}}}_cell(e){const{circumcenters:r,delaunay:{inedges:n,halfedges:i,triangles:o}}=this,s=n[e];if(s===-1)return null;const l=[];let c=s;do{const d=Math.floor(c/3);if(l.push(r[d*2],r[d*2+1]),c=c%3===2?c-2:c+1,o[c]!==e)break;c=i[c]}while(c!==s&&c!==-1);return l}_clip(e){if(e===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const r=this._cell(e);if(r===null)return null;const{vectors:n}=this,i=e*4;return this._simplify(n[i]||n[i+1]?this._clipInfinite(e,r,n[i],n[i+1],n[i+2],n[i+3]):this._clipFinite(e,r))}_clipFinite(e,r){const n=r.length;let i=null,o,s,l=r[n-2],c=r[n-1],d,h=this._regioncode(l,c),f,u=0;for(let p=0;p<n;p+=2)if(o=l,s=c,l=r[p],c=r[p+1],d=h,h=this._regioncode(l,c),d===0&&h===0)f=u,u=0,i?i.push(l,c):i=[l,c];else{let g,m,x,v,y;if(d===0){if((g=this._clipSegment(o,s,l,c,d,h))===null)continue;[m,x,v,y]=g}else{if((g=this._clipSegment(l,c,o,s,h,d))===null)continue;[v,y,m,x]=g,f=u,u=this._edgecode(m,x),f&&u&&this._edge(e,f,u,i,i.length),i?i.push(m,x):i=[m,x]}f=u,u=this._edgecode(v,y),f&&u&&this._edge(e,f,u,i,i.length),i?i.push(v,y):i=[v,y]}if(i)f=u,u=this._edgecode(i[0],i[1]),f&&u&&this._edge(e,f,u,i,i.length);else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return i}_clipSegment(e,r,n,i,o,s){const l=o<s;for(l&&([e,r,n,i,o,s]=[n,i,e,r,s,o]);;){if(o===0&&s===0)return l?[n,i,e,r]:[e,r,n,i];if(o&s)return null;let c,d,h=o||s;h&8?(c=e+(n-e)*(this.ymax-r)/(i-r),d=this.ymax):h&4?(c=e+(n-e)*(this.ymin-r)/(i-r),d=this.ymin):h&2?(d=r+(i-r)*(this.xmax-e)/(n-e),c=this.xmax):(d=r+(i-r)*(this.xmin-e)/(n-e),c=this.xmin),o?(e=c,r=d,o=this._regioncode(e,r)):(n=c,i=d,s=this._regioncode(n,i))}}_clipInfinite(e,r,n,i,o,s){let l=Array.from(r),c;if((c=this._project(l[0],l[1],n,i))&&l.unshift(c[0],c[1]),(c=this._project(l[l.length-2],l[l.length-1],o,s))&&l.push(c[0],c[1]),l=this._clipFinite(e,l))for(let d=0,h=l.length,f,u=this._edgecode(l[h-2],l[h-1]);d<h;d+=2)f=u,u=this._edgecode(l[d],l[d+1]),f&&u&&(d=this._edge(e,f,u,l,d),h=l.length);else this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(l=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return l}_edge(e,r,n,i,o){for(;r!==n;){let s,l;switch(r){case 5:r=4;continue;case 4:r=6,s=this.xmax,l=this.ymin;break;case 6:r=2;continue;case 2:r=10,s=this.xmax,l=this.ymax;break;case 10:r=8;continue;case 8:r=9,s=this.xmin,l=this.ymax;break;case 9:r=1;continue;case 1:r=5,s=this.xmin,l=this.ymin;break}(i[o]!==s||i[o+1]!==l)&&this.contains(e,s,l)&&(i.splice(o,0,s,l),o+=2)}return o}_project(e,r,n,i){let o=1/0,s,l,c;if(i<0){if(r<=this.ymin)return null;(s=(this.ymin-r)/i)<o&&(c=this.ymin,l=e+(o=s)*n)}else if(i>0){if(r>=this.ymax)return null;(s=(this.ymax-r)/i)<o&&(c=this.ymax,l=e+(o=s)*n)}if(n>0){if(e>=this.xmax)return null;(s=(this.xmax-e)/n)<o&&(l=this.xmax,c=r+(o=s)*i)}else if(n<0){if(e<=this.xmin)return null;(s=(this.xmin-e)/n)<o&&(l=this.xmin,c=r+(o=s)*i)}return[l,c]}_edgecode(e,r){return(e===this.xmin?1:e===this.xmax?2:0)|(r===this.ymin?4:r===this.ymax?8:0)}_regioncode(e,r){return(e<this.xmin?1:e>this.xmax?2:0)|(r<this.ymin?4:r>this.ymax?8:0)}_simplify(e){if(e&&e.length>4){for(let r=0;r<e.length;r+=2){const n=(r+2)%e.length,i=(r+4)%e.length;(e[r]===e[n]&&e[n]===e[i]||e[r+1]===e[n+1]&&e[n+1]===e[i+1])&&(e.splice(n,2),r-=2)}e.length||(e=null)}return e}}const o7=2*Math.PI,yo=Math.pow;function s7(t){return t[0]}function a7(t){return t[1]}function l7(t){const{triangles:e,coords:r}=t;for(let n=0;n<e.length;n+=3){const i=2*e[n],o=2*e[n+1],s=2*e[n+2];if((r[s]-r[i])*(r[o+1]-r[i+1])-(r[o]-r[i])*(r[s+1]-r[i+1])>1e-10)return!1}return!0}function c7(t,e,r){return[t+Math.sin(t+e)*r,e+Math.cos(t-e)*r]}class lm{static from(e,r=s7,n=a7,i){return new lm("length"in e?d7(e,r,n,i):Float64Array.from(u7(e,r,n,i)))}constructor(e){this._delaunator=new Yc(e),this.inedges=new Int32Array(e.length/2),this._hullIndex=new Int32Array(e.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const e=this._delaunator,r=this.points;if(e.hull&&e.hull.length>2&&l7(e)){this.collinear=Int32Array.from({length:r.length/2},(u,p)=>p).sort((u,p)=>r[2*u]-r[2*p]||r[2*u+1]-r[2*p+1]);const c=this.collinear[0],d=this.collinear[this.collinear.length-1],h=[r[2*c],r[2*c+1],r[2*d],r[2*d+1]],f=1e-8*Math.hypot(h[3]-h[1],h[2]-h[0]);for(let u=0,p=r.length/2;u<p;++u){const g=c7(r[2*u],r[2*u+1],f);r[2*u]=g[0],r[2*u+1]=g[1]}this._delaunator=new Yc(r)}else delete this.collinear;const n=this.halfedges=this._delaunator.halfedges,i=this.hull=this._delaunator.hull,o=this.triangles=this._delaunator.triangles,s=this.inedges.fill(-1),l=this._hullIndex.fill(-1);for(let c=0,d=n.length;c<d;++c){const h=o[c%3===2?c-2:c+1];(n[c]===-1||s[h]===-1)&&(s[h]=c)}for(let c=0,d=i.length;c<d;++c)l[i[c]]=c;i.length<=2&&i.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=i[0],s[i[0]]=1,i.length===2&&(s[i[1]]=0,this.triangles[1]=i[1],this.triangles[2]=i[1]))}voronoi(e){return new i7(this,e)}*neighbors(e){const{inedges:r,hull:n,_hullIndex:i,halfedges:o,triangles:s,collinear:l}=this;if(l){const f=l.indexOf(e);f>0&&(yield l[f-1]),f<l.length-1&&(yield l[f+1]);return}const c=r[e];if(c===-1)return;let d=c,h=-1;do{if(yield h=s[d],d=d%3===2?d-2:d+1,s[d]!==e)return;if(d=o[d],d===-1){const f=n[(i[e]+1)%n.length];f!==h&&(yield f);return}}while(d!==c)}find(e,r,n=0){if(e=+e,e!==e||(r=+r,r!==r))return-1;const i=n;let o;for(;(o=this._step(n,e,r))>=0&&o!==n&&o!==i;)n=o;return o}_step(e,r,n){const{inedges:i,hull:o,_hullIndex:s,halfedges:l,triangles:c,points:d}=this;if(i[e]===-1||!d.length)return(e+1)%(d.length>>1);let h=e,f=yo(r-d[e*2],2)+yo(n-d[e*2+1],2);const u=i[e];let p=u;do{let g=c[p];const m=yo(r-d[g*2],2)+yo(n-d[g*2+1],2);if(m<f&&(f=m,h=g),p=p%3===2?p-2:p+1,c[p]!==e)break;if(p=l[p],p===-1){if(p=o[(s[e]+1)%o.length],p!==g&&yo(r-d[p*2],2)+yo(n-d[p*2+1],2)<f)return p;break}}while(p!==u);return h}render(e){const r=e==null?e=new Mi:void 0,{points:n,halfedges:i,triangles:o}=this;for(let s=0,l=i.length;s<l;++s){const c=i[s];if(c<s)continue;const d=o[s]*2,h=o[c]*2;e.moveTo(n[d],n[d+1]),e.lineTo(n[h],n[h+1])}return this.renderHull(e),r&&r.value()}renderPoints(e,r){r===void 0&&(!e||typeof e.moveTo!="function")&&(r=e,e=null),r=r==null?2:+r;const n=e==null?e=new Mi:void 0,{points:i}=this;for(let o=0,s=i.length;o<s;o+=2){const l=i[o],c=i[o+1];e.moveTo(l+r,c),e.arc(l,c,r,0,o7)}return n&&n.value()}renderHull(e){const r=e==null?e=new Mi:void 0,{hull:n,points:i}=this,o=n[0]*2,s=n.length;e.moveTo(i[o],i[o+1]);for(let l=1;l<s;++l){const c=2*n[l];e.lineTo(i[c],i[c+1])}return e.closePath(),r&&r.value()}hullPolygon(){const e=new sf;return this.renderHull(e),e.value()}renderTriangle(e,r){const n=r==null?r=new Mi:void 0,{points:i,triangles:o}=this,s=o[e*=3]*2,l=o[e+1]*2,c=o[e+2]*2;return r.moveTo(i[s],i[s+1]),r.lineTo(i[l],i[l+1]),r.lineTo(i[c],i[c+1]),r.closePath(),n&&n.value()}*trianglePolygons(){const{triangles:e}=this;for(let r=0,n=e.length/3;r<n;++r)yield this.trianglePolygon(r)}trianglePolygon(e){const r=new sf;return this.renderTriangle(e,r),r.value()}}function d7(t,e,r,n){const i=t.length,o=new Float64Array(i*2);for(let s=0;s<i;++s){const l=t[s];o[s*2]=e.call(n,l,s,t),o[s*2+1]=r.call(n,l,s,t)}return o}function*u7(t,e,r,n){let i=0;for(const o of t)yield e.call(n,o,i,t),yield r.call(n,o,i,t),++i}const Li=nn,h7=new Map(Li.map((t,e)=>[t.code,e]));function e_(t){return function(){let e=t+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}}function f7(t,e,r,n=30,i=Math.random){const o=r/Math.sqrt(2),s=Math.ceil(t/o),l=Math.ceil(e/o),c=new Array(s*l).fill(-1),d=[],h=[];function f(p,g){const m=[p,g];d.push(m);const x=Math.floor(p/o),v=Math.floor(g/o);return c[v*s+x]=d.length-1,h.push(d.length-1),m}function u(p,g){const m=Math.floor(p/o),x=Math.floor(g/o);for(let v=Math.max(0,m-2);v<=Math.min(s-1,m+2);v++)for(let y=Math.max(0,x-2);y<=Math.min(l-1,x+2);y++){const b=c[y*s+v];if(b!==-1){const w=p-d[b][0],k=g-d[b][1];if(w*w+k*k<r*r)return!0}}return!1}for(f(t*i(),e*i());h.length>0;){const p=Math.floor(i()*h.length),g=h[p],m=d[g];let x=!1;for(let v=0;v<n;v++){const y=2*Math.PI*i(),b=r+r*i(),w=m[0]+b*Math.cos(y),k=m[1]+b*Math.sin(y);if(w>=0&&w<t&&k>=0&&k<e&&!u(w,k)){f(w,k),x=!0;break}}x||h.splice(p,1)}return d}const Iu={Xn:.95047,Yn:1,Zn:1.08883},p7=[[3.2404542,-1.5371385,-.4985314],[-.969266,1.8760108,.041556],[.0556434,-.2040259,1.0572252]];function Lu(t){return t<=.0031308?t*12.92:1.055*Math.pow(t,1/2.4)-.055}function m7(t){return{R:Math.round(Lu(t.R)*255),G:Math.round(Lu(t.G)*255),B:Math.round(Lu(t.B)*255)}}function g7(t){const[e,r,n]=p7;return{R:e[0]*t.X+e[1]*t.Y+e[2]*t.Z,G:r[0]*t.X+r[1]*t.Y+r[2]*t.Z,B:n[0]*t.X+n[1]*t.Y+n[2]*t.Z}}function Du(t){const e=.20689655172413793;return t>e?Math.pow(t,3):3*e*e*(t-4/29)}function v7(t){const e=(t.L+16)/116,r=t.a/500+e,n=e-t.b/200;return{X:Iu.Xn*Du(r),Y:Iu.Yn*Du(e),Z:Iu.Zn*Du(n)}}function y7(t){const e=v7(t),r=g7(e);return m7(r)}function x7(t){let e=0;if(t.forEach(c=>e+=c),e===0)return"#FFFFFF";let r=0,n=0,i=0;t.forEach((c,d)=>{const h=Li[d],f=c/e;r+=h.L*f,n+=h.a*f,i+=h.b*f});const s=y7({L:r,a:n,b:i}),l=c=>Math.round(Math.max(0,Math.min(255,c))).toString(16).padStart(2,"0");return`#${l(s.R)}${l(s.G)}${l(s.B)}`}function b7(t){const e=parseInt(t.slice(1,3),16),r=parseInt(t.slice(3,5),16),n=parseInt(t.slice(5,7),16);return{r:e,g:r,b:n}}function w7(t){const{r:e,g:r,b:n}=b7(t);return(e*299+r*587+n*114)/1e3>128?"#000000":"#FFFFFF"}function _7(t){let e=0;const r={},n=[];return t.forEach((i,o)=>{const s=Li[o];e+=i,r[s.code]=i,n.push({code:s.code,name:s.name,weight:0,parts:i})}),n.forEach(i=>{i.weight=i.parts/e}),{parts:r,components:n,total:e}}function ty(t){const e=new Map;return!t||!t.parts||Object.entries(t.parts).forEach(([r,n])=>{const i=h7.get(r);i!==void 0&&e.set(i,n)}),e}function S7(t,e,r,n=12345){const i=e_(n),o=t*e,s=Math.sqrt(o/r)*.8;return f7(t,e,s,30,i)}function k7({parts:t,width:e=400,height:r=400,cellCount:n=1e4,seed:i=12345}){const o=A.useRef(null),[s,l]=A.useState(null),[c,d]=A.useState(!0);return A.useEffect(()=>{(async()=>{d(!0);const f=S7(e,r,n,i),p=lm.from(f).voronoi([0,0,e,r]);l({points:f,voronoi:p,cellCount:f.length}),d(!1)})()},[i,e,r,n]),A.useEffect(()=>{if(!s||!o.current)return;const h=o.current,f=h.getContext("2d");h.width=e,h.height=r,f.fillStyle="#FAFAFA",f.fillRect(0,0,e,r);let u=0;t.forEach(g=>u+=g);const p=j7(s.cellCount,t,u,i);for(let g=0;g<s.cellCount;g++){const m=p[g],x=m===-1?"#FAFAFA":Li[m].hex,v=s.voronoi.cellPolygon(g);if(!(!v||v.length<3)){f.beginPath(),f.moveTo(v[0][0],v[0][1]);for(let y=1;y<v.length;y++)f.lineTo(v[y][0],v[y][1]);f.closePath(),f.fillStyle=x,f.fill()}}f.strokeStyle="rgba(0, 0, 0, 0.05)",f.lineWidth=.5;for(let g=0;g<s.cellCount;g++){const m=s.voronoi.cellPolygon(g);if(!(!m||m.length<3)){f.beginPath(),f.moveTo(m[0][0],m[0][1]);for(let x=1;x<m.length;x++)f.lineTo(m[x][0],m[x][1]);f.closePath(),f.stroke()}}},[s,t,i,e,r]),a.jsxs("div",{style:{position:"relative",width:e,height:r},children:[a.jsx("canvas",{ref:o,style:{width:"100%",height:"100%",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"}}),c&&a.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(255,255,255,0.9)",borderRadius:"8px"},children:a.jsx("div",{style:{textAlign:"center",color:"#666"},children:"Generating granules..."})})]})}function j7(t,e,r,n){const i=new Array(t).fill(-1);if(r===0)return i;const o=n+r,s=e_(o),l=Array.from({length:t},(d,h)=>h);for(let d=l.length-1;d>0;d--){const h=Math.floor(s()*(d+1));[l[d],l[h]]=[l[h],l[d]]}let c=0;return e.forEach((d,h)=>{const f=Math.round(d/r*t);for(let u=0;u<f&&c<t;u++)i[l[c]]=h,c++}),i}function C7({initialRecipe:t=null,onBlendChange:e=null,originalColor:r=null}){const[n,i]=A.useState(new Map),o=A.useRef(!0),s=A.useRef(null);A.useEffect(()=>{if(t){const u=JSON.stringify(t);if(u!==s.current){s.current=u,o.current=!0;const p=ty(t);i(p)}}},[t]);const l=Array.from(n.values()).reduce((u,p)=>u+p,0),c=x7(n);A.useEffect(()=>{if(o.current){o.current=!1;return}if(e){const u=n.size>0?_7(n):null;e({blendHex:c,parts:n,recipe:u})}},[n,c]);const d=A.useCallback(u=>{i(p=>{const g=p.get(u)||0,m=Array.from(p.values()).reduce((v,y)=>v+y,0);if(g>=4||m>=12)return p;const x=new Map(p);return x.set(u,g+1),x})},[]),h=A.useCallback(u=>{const p=n.get(u)||0;p>0&&i(g=>{const m=new Map(g);return p===1?m.delete(u):m.set(u,p-1),m})},[n]),f=A.useCallback(()=>{i(new Map)},[]);return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"mini-mixer-widget",children:[r&&a.jsxs("div",{className:"mixer-header",children:[a.jsx("div",{className:"mixer-title",children:"Customise Blend Recipe"}),a.jsxs("div",{className:"original-color-ref",children:[a.jsx("span",{className:"label",children:"Original:"}),a.jsx("div",{className:"color-swatch",style:{backgroundColor:r,cursor:"pointer"},title:`${r} - Click to reset to original recipe`,onClick:()=>{t&&i(ty(t))}})]})]}),a.jsx("div",{className:"mixer-canvas-section",children:a.jsx(k7,{parts:n,width:700,height:350,cellCount:5e3,seed:12345})}),a.jsx("div",{className:"mix-proportion-bar",children:l===0?a.jsx("div",{className:"proportion-bar-empty"}):Array.from(n.entries()).map(([u,p])=>{const g=p/l*100;return a.jsx("div",{className:"proportion-segment",style:{backgroundColor:Li[u].hex,flexBasis:`${g}%`},title:`${Li[u].name}: ${Math.round(g)}%`},u)})}),a.jsxs("div",{className:"blend-preview",children:[a.jsx("div",{className:"blend-preview-label",children:"Blended Result:"}),a.jsxs("div",{className:"blend-preview-color",children:[a.jsx("div",{className:"blend-swatch",style:{backgroundColor:c,color:w7(c)},children:c}),a.jsxs("div",{className:"blend-parts-count",children:[l," ",l===1?"part":"parts"]})]})]}),a.jsxs("div",{className:"mixer-palette-section",children:[a.jsxs("div",{className:"mixer-palette-header",children:[a.jsx("h3",{children:"TPV Color Palette"}),l>0&&a.jsx("button",{className:"clear-btn",onClick:f,children:"Clear All"})]}),a.jsx("div",{className:"mixer-palette-grid",children:Li.map((u,p)=>{const g=n.get(p)||0;return a.jsxs("div",{className:"mixer-color-item",children:[a.jsx("button",{className:`mixer-color-swatch ${g>0?"has-parts":""}`,style:{backgroundColor:u.hex},onClick:()=>d(p),title:`${u.name} (${u.code})`}),a.jsxs("div",{className:"mixer-color-info",children:[a.jsx("div",{className:"mixer-color-name",children:u.name}),a.jsx("div",{className:"mixer-color-code",children:u.code})]}),a.jsxs("div",{className:"mixer-parts-controls",children:[a.jsx("button",{className:"mixer-parts-btn",onClick:()=>h(p),disabled:g===0,children:""}),a.jsx("div",{className:"mixer-parts-count",children:g}),a.jsx("button",{className:"mixer-parts-btn",onClick:()=>d(p),disabled:g>=4||l>=12,title:g>=4?"Max 4 parts per color":l>=12?"Max 12 total parts":"",children:"+"})]})]},p)})})]}),l===0?a.jsx("div",{className:"mixer-instructions",children:"Click colors above to add parts to your blend. The preview updates in real-time."}):l>=12?a.jsx("div",{className:"mixer-instructions",style:{background:"#fef3c7",borderColor:"#fbbf24"},children:"Maximum of 12 parts reached. Remove parts to adjust your blend."}):null]}),a.jsx("style",{children:`
        .mini-mixer-widget {
          background: white;
          border-radius: 12px;
          padding: 20px;
          margin-top: 20px;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .mixer-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 20px;
          padding-bottom: 16px;
          border-bottom: 2px solid #e5e7eb;
        }

        .mixer-title {
          font-size: 1.25rem;
          font-weight: 600;
          color: #111827;
        }

        .original-color-ref {
          display: flex;
          align-items: center;
          gap: 8px;
          font-size: 0.9rem;
          color: #6b7280;
        }

        .original-color-ref .color-swatch {
          width: 32px;
          height: 32px;
          border-radius: 6px;
          border: 2px solid #d1d5db;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
          cursor: pointer;
          transition: all 0.2s;
        }

        .original-color-ref .color-swatch:hover {
          transform: scale(1.1);
          border-color: #3b82f6;
          box-shadow: 0 2px 6px rgba(59, 130, 246, 0.3);
        }

        .mixer-canvas-section {
          margin-bottom: 20px;
          display: flex;
          justify-content: center;
        }

        .mix-proportion-bar {
          height: 24px;
          border-radius: 12px;
          overflow: hidden;
          display: flex;
          box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
          margin: 16px 0;
          background: #e5e7eb;
        }

        .proportion-segment {
          transition: all 0.2s ease;
        }

        .proportion-segment:hover {
          filter: brightness(1.1);
          cursor: pointer;
        }

        .proportion-bar-empty {
          width: 100%;
          height: 100%;
          background: linear-gradient(90deg, #f3f4f6 0%, #e5e7eb 50%, #f3f4f6 100%);
        }

        .blend-preview {
          margin-bottom: 24px;
          padding: 16px;
          background: #f9fafb;
          border-radius: 10px;
          border: 1px solid #e5e7eb;
        }

        .blend-preview-label {
          font-weight: 600;
          color: #374151;
          margin-bottom: 12px;
          font-size: 0.95rem;
        }

        .blend-preview-color {
          display: flex;
          align-items: center;
          gap: 16px;
        }

        .blend-swatch {
          flex: 1;
          padding: 16px;
          border-radius: 8px;
          text-align: center;
          font-weight: 600;
          font-family: 'Courier New', monospace;
          font-size: 1.1rem;
          border: 2px solid #d1d5db;
          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .blend-parts-count {
          font-size: 0.9rem;
          color: #6b7280;
          font-weight: 500;
          white-space: nowrap;
        }

        .mixer-palette-section {
          margin-bottom: 16px;
        }

        .mixer-palette-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 16px;
        }

        .mixer-palette-header h3 {
          margin: 0;
          font-size: 1.1rem;
          font-weight: 600;
          color: #111827;
        }

        .clear-btn {
          padding: 6px 12px;
          background: #ef4444;
          color: white;
          border: none;
          border-radius: 6px;
          font-size: 0.85rem;
          font-weight: 500;
          cursor: pointer;
          transition: all 0.2s;
        }

        .clear-btn:hover {
          background: #dc2626;
          box-shadow: 0 2px 6px rgba(239, 68, 68, 0.3);
        }

        .mixer-palette-grid {
          display: grid;
          grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
          gap: 12px;
          max-height: 400px;
          overflow-y: auto;
          padding: 4px;
        }

        .mixer-color-item {
          display: flex;
          flex-direction: column;
          gap: 8px;
          padding: 8px;
          background: #f9fafb;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
          transition: all 0.2s;
        }

        .mixer-color-item:hover {
          border-color: #3b82f6;
          box-shadow: 0 2px 6px rgba(59, 130, 246, 0.2);
        }

        .mixer-color-swatch {
          width: 100%;
          height: 48px;
          border-radius: 6px;
          border: 2px solid #d1d5db;
          cursor: pointer;
          transition: all 0.2s;
        }

        .mixer-color-swatch:hover {
          transform: scale(1.05);
          box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .mixer-color-swatch.has-parts {
          border-color: #3b82f6;
          border-width: 3px;
          box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .mixer-color-info {
          text-align: center;
        }

        .mixer-color-name {
          font-size: 0.85rem;
          font-weight: 500;
          color: #374151;
          line-height: 1.2;
        }

        .mixer-color-code {
          font-size: 0.75rem;
          color: #9ca3af;
          font-family: 'Courier New', monospace;
        }

        .mixer-parts-controls {
          display: flex;
          align-items: center;
          justify-content: center;
          gap: 8px;
        }

        .mixer-parts-btn {
          width: 28px;
          height: 28px;
          border-radius: 6px;
          border: 1px solid #d1d5db;
          background: white;
          color: #374151;
          font-size: 1.2rem;
          line-height: 1;
          display: flex;
          align-items: center;
          justify-content: center;
          cursor: pointer;
          transition: all 0.2s;
        }

        .mixer-parts-btn:hover:not(:disabled) {
          background: #f3f4f6;
          border-color: #3b82f6;
          color: #3b82f6;
        }

        .mixer-parts-btn:active:not(:disabled) {
          transform: scale(0.95);
        }

        .mixer-parts-btn:disabled {
          opacity: 0.3;
          cursor: not-allowed;
        }

        .mixer-parts-count {
          min-width: 24px;
          text-align: center;
          font-weight: 600;
          color: #111827;
          font-size: 0.9rem;
        }

        .mixer-instructions {
          text-align: center;
          color: #6b7280;
          font-size: 0.9rem;
          padding: 16px;
          background: #fffbeb;
          border-radius: 8px;
          border: 1px solid #fde68a;
        }

        @media (max-width: 768px) {
          .mini-mixer-widget {
            padding: 16px;
          }

          .mixer-canvas-section canvas {
            max-width: 100%;
            height: auto !important;
          }

          .mixer-palette-grid {
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 8px;
          }

          .blend-preview-color {
            flex-direction: column;
            gap: 12px;
          }

          .blend-swatch {
            width: 100%;
          }
        }
      `})]})}function t_(t){const{inputMode:e,prompt:r,selectedFile:n,lengthMM:i,widthMM:o,result:s,viewMode:l,blendRecipes:c,solidRecipes:d,colorMapping:h,solidColorMapping:f,solidEditedColors:u,blendEditedColors:p,blendSvgUrl:g,solidSvgUrl:m,arMapping:x,jobId:v,inSituData:y}=t;console.log("[SERIALIZE] Serializing design with result:",s),console.log("[SERIALIZE] result.svg_url:",s==null?void 0:s.svg_url),console.log("[SERIALIZE] result.png_url:",s==null?void 0:s.png_url),console.log("[SERIALIZE] result.thumbnail_url:",s==null?void 0:s.thumbnail_url);const b=w=>w?w instanceof Map?Object.fromEntries(w):w:null;return{input_mode:e,prompt:r||null,uploaded_file_url:(n==null?void 0:n.url)||null,dimensions:{widthMM:o,lengthMM:i},original_svg_url:(s==null?void 0:s.svg_url)||null,original_png_url:(s==null?void 0:s.png_url)||null,thumbnail_url:(s==null?void 0:s.thumb_url)||null,blend_recipes:c||null,solid_recipes:d||null,color_mapping:b(h),solid_color_mapping:b(f),solid_color_edits:b(u),blend_color_edits:b(p),final_blend_svg_url:g||null,final_solid_svg_url:m||null,preferred_view_mode:l||"solid",aspect_ratio_mapping:x||null,job_id:v||null,in_situ:y?{room_photo_url:y.room_photo_url||null,mask_url:y.mask_url||null,floor_dimensions_m:y.floor_dimensions_m||null,preview_url:y.preview_url||null,blend_opacity:y.blend_opacity||20,perspective_corners:y.perspective_corners||null}:null}}function af(t){var r,n;const e=i=>i?i instanceof Map?i:new Map(Object.entries(i)):new Map;return{inputMode:t.input_mode,prompt:t.prompt||"",selectedFile:t.uploaded_file_url?{url:t.uploaded_file_url,name:t.uploaded_file_url.split("/").pop()}:null,lengthMM:((r=t.dimensions)==null?void 0:r.lengthMM)||0,widthMM:((n=t.dimensions)==null?void 0:n.widthMM)||0,result:{svg_url:t.original_svg_url,png_url:t.original_png_url,thumbnail_url:t.thumbnail_url},blendRecipes:t.blend_recipes||null,solidRecipes:t.solid_recipes||null,colorMapping:e(t.color_mapping),solidColorMapping:e(t.solid_color_mapping),solidEditedColors:e(t.solid_color_edits),blendEditedColors:e(t.blend_color_edits),blendSvgUrl:null,solidSvgUrl:null,viewMode:t.preferred_view_mode||"solid",arMapping:t.aspect_ratio_mapping,jobId:t.job_id,inSituData:t.in_situ||null,generating:!1,generatingBlends:!1,showFinalRecipes:!!t.blend_recipes,showSolidSummary:!!t.solid_recipes,colorEditorOpen:!1,selectedColor:null}}function E7(t){var r;const e=[];return t.inputMode||e.push("Input mode is required"),(!(t.widthMM>0)||!(t.lengthMM>0))&&e.push("Surface dimensions are required"),(r=t.result)!=null&&r.svg_url||e.push("No design to save - generate a design first"),{valid:e.length===0,errors:e}}function T7({currentState:t,existingDesignId:e=null,initialName:r="",onClose:n,onSaved:i}){const[o,s]=A.useState(r),[l,c]=A.useState(""),[d,h]=A.useState(""),[f,u]=A.useState(""),[p,g]=A.useState(!1),[m,x]=A.useState([]),[v,y]=A.useState(!1),[b,w]=A.useState(""),[k,S]=A.useState("#1a365d"),[C,T]=A.useState(!1),[R,O]=A.useState(!1),[Y,E]=A.useState(!1),[B,_]=A.useState(null);A.useEffect(()=>{V()},[]);const V=async()=>{try{const{projects:D}=await pp();x(D)}catch(D){console.error("Failed to load projects:",D),_("Failed to load projects")}},re=async()=>{if(!b.trim()){_("Project name is required");return}E(!0),_(null);try{const{project:D}=await Ow({name:b.trim(),color:k});x([D,...m]),h(D.id),y(!1),w(""),S("#1a365d")}catch(D){console.error("Failed to create project:",D),_(D.message)}finally{E(!1)}},I=async(D=!1)=>{if(!o.trim()){_("Design name is required");return}const J=E7(t);if(!J.valid){_(J.errors.join(", "));return}D?O(!0):T(!0),_(null);try{const U=t_(t);console.log("[SAVE-MODAL] Serialized design data:",U),console.log("[SAVE-MODAL] SVG URL from serialized data:",U.original_svg_url);const G={name:o.trim(),description:l.trim()||null,project_id:d||null,tags:f.split(",").map(oe=>oe.trim()).filter(oe=>oe),is_public:p,design_data:U};console.log("[SAVE-MODAL] Full save payload:",G),e&&!D&&(G.id=e);const fe=await up(G);i&&i(fe,o.trim()),n()}catch(U){console.error("Failed to save design:",U),_(U.message)}finally{T(!1),O(!1)}},q=["#1a365d","#ff6b35","#4a90e2","#50c878","#9b59b6","#e74c3c"];return a.jsx("div",{className:"modal-overlay",onClick:n,children:a.jsxs("div",{className:"modal-content save-design-modal",onClick:D=>D.stopPropagation(),children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h2",{children:e?"Update Design":"Save Design"}),a.jsx("button",{onClick:n,className:"close-button",children:""})]}),a.jsxs("div",{className:"modal-body",children:[B&&a.jsx("div",{className:"error-message",children:B}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"design-name",children:"Design Name *"}),a.jsx("input",{id:"design-name",type:"text",value:o,onChange:D=>s(D.target.value),placeholder:"e.g., Playground Design A",autoFocus:!0,disabled:C||R})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"design-description",children:"Description"}),a.jsx("textarea",{id:"design-description",value:l,onChange:D=>c(D.target.value),placeholder:"Optional notes about this design...",rows:3,disabled:C||R})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"design-project",children:"Project"}),v?a.jsxs("div",{className:"new-project-form",children:[a.jsxs("div",{className:"input-row",children:[a.jsx("input",{type:"text",value:b,onChange:D=>w(D.target.value),placeholder:"Project name...",disabled:Y}),a.jsx("div",{className:"color-picker-inline",children:q.map(D=>a.jsx("button",{type:"button",className:`color-swatch ${k===D?"active":""}`,style:{backgroundColor:D},onClick:()=>S(D),disabled:Y},D))})]}),a.jsxs("div",{className:"button-row",children:[a.jsx("button",{type:"button",onClick:re,className:"btn-primary btn-small",disabled:Y,children:Y?"Creating...":"Create"}),a.jsx("button",{type:"button",onClick:()=>y(!1),className:"btn-secondary btn-small",disabled:Y,children:"Cancel"})]})]}):a.jsxs("div",{className:"project-selector",children:[a.jsxs("select",{id:"design-project",value:d,onChange:D=>h(D.target.value),disabled:C||R,children:[a.jsx("option",{value:"",children:"No Project"}),m.map(D=>a.jsxs("option",{value:D.id,children:[D.name," (",D.design_count," designs)"]},D.id))]}),a.jsx("button",{type:"button",onClick:()=>y(!0),className:"btn-secondary btn-small",disabled:C||R,children:"+ New Project"})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"design-tags",children:"Tags"}),a.jsx("input",{id:"design-tags",type:"text",value:f,onChange:D=>u(D.target.value),placeholder:"e.g., playground, vibrant, geometric (comma-separated)",disabled:C||R}),a.jsx("small",{className:"help-text",children:"Separate tags with commas"})]}),a.jsx("div",{className:"form-group checkbox-group",children:a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:p,onChange:D=>g(D.target.checked),disabled:C||R}),a.jsx("span",{children:"Make this design public (shareable link)"})]})})]}),a.jsxs("div",{className:"modal-footer",children:[a.jsx("button",{onClick:n,className:"btn-secondary",disabled:C||R,children:"Cancel"}),e&&a.jsx("button",{onClick:()=>I(!0),className:"btn-secondary",disabled:C||R,children:R?"Saving...":"Save as New"}),a.jsx("button",{onClick:()=>I(!1),className:"btn-primary",disabled:C||R,children:C?"Saving...":e?"Update":"Save Design"})]})]})})}const R7=10*1024*1024,N7=["image/jpeg","image/png","image/jpg"];function P7({onPhotoUploaded:t,disabled:e=!1}){const[r,n]=A.useState(!1),[i,o]=A.useState(!1),[s,l]=A.useState(null),[c,d]=A.useState(null),h=A.useRef(null),f=y=>{y.preventDefault(),e||n(!0)},u=y=>{y.preventDefault(),n(!1)},p=async y=>{if(y.preventDefault(),n(!1),e)return;const b=y.dataTransfer.files;b.length>0&&await x(b[0])},g=()=>{!e&&h.current&&h.current.click()},m=async y=>{y.target.files.length>0&&await x(y.target.files[0])},x=async y=>{if(l(null),!N7.includes(y.type)){l("Please upload a JPG or PNG image");return}if(y.size>R7){l("Image must be under 10MB");return}const b=URL.createObjectURL(y);d(b),console.log("[IN-SITU-UPLOADER] Loading local file to get dimensions...");const w=await new Promise((k,S)=>{const C=new Image;C.onload=()=>{console.log("[IN-SITU-UPLOADER] Local image loaded, dimensions:",C.naturalWidth,"x",C.naturalHeight),k({width:C.naturalWidth,height:C.naturalHeight})},C.onerror=T=>{console.error("[IN-SITU-UPLOADER] Failed to load local image:",T),S(new Error("Failed to read image dimensions"))},C.src=b});o(!0);try{const S=`in-situ-photos/${`${Date.now()}-${Math.random().toString(36).substr(2,9)}.${y.type.split("/")[1]}`}`,{data:C,error:T}=await Pt.storage.from("tpv-studio-uploads").upload(S,y,{cacheControl:"3600",upsert:!1});if(T)throw T;const{data:{publicUrl:R}}=Pt.storage.from("tpv-studio-uploads").getPublicUrl(S);console.log("[IN-SITU-UPLOADER] Photo uploaded:",R),console.log("[IN-SITU-UPLOADER] Using dimensions from local file:",w),console.log("[IN-SITU-UPLOADER] Passing local blob URL for fast preview"),console.log("[IN-SITU-UPLOADER] Calling onPhotoUploaded callback..."),t({url:b,supabaseUrl:R,width:w.width,height:w.height,filename:y.name})}catch(k){console.error("[IN-SITU-UPLOADER] Upload failed:",k),l(k.message||"Upload failed"),URL.revokeObjectURL(b),d(null)}finally{o(!1)}},v=()=>{c&&URL.revokeObjectURL(c),d(null),l(null)};return a.jsxs("div",{className:"in-situ-uploader",children:[c?a.jsxs("div",{className:"preview-container",children:[a.jsx("img",{src:c,alt:"Site preview",className:"preview-image"}),i&&a.jsxs("div",{className:"upload-overlay",children:[a.jsx("div",{className:"upload-spinner"}),a.jsx("p",{children:"Uploading..."})]}),!i&&a.jsx("button",{className:"clear-button",onClick:v,title:"Remove photo",children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}):a.jsxs("div",{className:`upload-zone ${r?"dragging":""} ${e?"disabled":""}`,onDragOver:f,onDragLeave:u,onDrop:p,onClick:g,children:[a.jsx("input",{ref:h,type:"file",accept:"image/jpeg,image/png",onChange:m,style:{display:"none"},disabled:e}),a.jsx("div",{className:"upload-icon",children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),a.jsx("polyline",{points:"17 8 12 3 7 8"}),a.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]})}),a.jsxs("div",{className:"upload-text",children:[a.jsx("p",{className:"primary",children:r?"Drop photo here":"Upload site photo"}),a.jsx("p",{className:"secondary",children:"Drag & drop or click to browse"}),a.jsx("p",{className:"hint",children:"JPG or PNG, max 10MB"})]})]}),s&&a.jsx("div",{className:"error-message",children:s}),a.jsx("style",{children:`
        .in-situ-uploader {
          width: 100%;
        }

        .upload-zone {
          border: 2px dashed #d1d5db;
          border-radius: 8px;
          padding: 2rem;
          text-align: center;
          cursor: pointer;
          transition: all 0.2s;
          background: #f9fafb;
        }

        .upload-zone:hover {
          border-color: #ff6b35;
          background: #fff7f5;
        }

        .upload-zone.dragging {
          border-color: #ff6b35;
          background: #fff7f5;
          border-style: solid;
        }

        .upload-zone.disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .upload-zone.disabled:hover {
          border-color: #d1d5db;
          background: #f9fafb;
        }

        .upload-icon {
          width: 48px;
          height: 48px;
          margin: 0 auto 1rem;
          color: #9ca3af;
        }

        .upload-zone:hover .upload-icon {
          color: #ff6b35;
        }

        .upload-text .primary {
          font-size: 1rem;
          font-weight: 600;
          color: #374151;
          margin: 0 0 0.25rem;
        }

        .upload-text .secondary {
          font-size: 0.875rem;
          color: #6b7280;
          margin: 0 0 0.5rem;
        }

        .upload-text .hint {
          font-size: 0.75rem;
          color: #9ca3af;
          margin: 0;
        }

        .preview-container {
          position: relative;
          border-radius: 8px;
          overflow: hidden;
        }

        .preview-image {
          width: 100%;
          display: block;
          border-radius: 8px;
        }

        .upload-overlay {
          position: absolute;
          inset: 0;
          background: rgba(0, 0, 0, 0.6);
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          color: white;
        }

        .upload-spinner {
          width: 32px;
          height: 32px;
          border: 3px solid rgba(255, 255, 255, 0.3);
          border-top-color: white;
          border-radius: 50%;
          animation: spin 0.8s linear infinite;
          margin-bottom: 0.5rem;
        }

        @keyframes spin {
          to { transform: rotate(360deg); }
        }

        .clear-button {
          position: absolute;
          top: 0.5rem;
          right: 0.5rem;
          width: 32px;
          height: 32px;
          border-radius: 50%;
          background: rgba(0, 0, 0, 0.6);
          border: none;
          cursor: pointer;
          color: white;
          display: flex;
          align-items: center;
          justify-content: center;
          transition: background 0.2s;
        }

        .clear-button:hover {
          background: rgba(0, 0, 0, 0.8);
        }

        .clear-button svg {
          width: 16px;
          height: 16px;
        }

        .error-message {
          margin-top: 0.75rem;
          padding: 0.5rem 0.75rem;
          background: #fef2f2;
          border: 1px solid #fecaca;
          border-radius: 4px;
          color: #dc2626;
          font-size: 0.875rem;
        }
      `})]})}function O7(t,e){const[r,n,i,o,s,l,c,d]=t,[h,f,u,p,g,m,x,v]=e,y=[[r,n,1,0,0,0,-h*r,-h*n],[0,0,0,r,n,1,-f*r,-f*n],[i,o,1,0,0,0,-u*i,-u*o],[0,0,0,i,o,1,-p*i,-p*o],[s,l,1,0,0,0,-g*s,-g*l],[0,0,0,s,l,1,-m*s,-m*l],[c,d,1,0,0,0,-x*c,-x*d],[0,0,0,c,d,1,-v*c,-v*d]],w=A7(y,[h,f,u,p,g,m,x,v]);return function(S,C){const T=w[6]*S+w[7]*C+1,R=(w[0]*S+w[1]*C+w[2])/T,O=(w[3]*S+w[4]*C+w[5])/T;return[R,O]}}function A7(t,e){const r=t.length,n=t.map((o,s)=>[...o,e[s]]);for(let o=0;o<r;o++){let s=o;for(let l=o+1;l<r;l++)Math.abs(n[l][o])>Math.abs(n[s][o])&&(s=l);[n[o],n[s]]=[n[s],n[o]];for(let l=o+1;l<r;l++){const c=n[l][o]/n[o][o];for(let d=o;d<=r;d++)n[l][d]-=c*n[o][d]}}const i=new Array(r);for(let o=r-1;o>=0;o--){i[o]=n[o][r];for(let s=o+1;s<r;s++)i[o]-=n[o][s]*i[s];i[o]/=n[o][o]}return i}function cm(t){return new Promise((e,r)=>{const n=new Image;!t.startsWith("blob:")&&!t.startsWith("data:")?(n.crossOrigin="anonymous",console.log("[LOAD-IMAGE] Loading external URL with CORS:",t.substring(0,50))):console.log("[LOAD-IMAGE] Loading local URL (blob/data):",t.substring(0,50)),n.onload=()=>{console.log("[LOAD-IMAGE] Successfully loaded image:",t.substring(0,50)),e(n)},n.onerror=()=>{console.error("[LOAD-IMAGE] Failed to load image:",t),r(new Error(`Failed to load image: ${t}`))},n.src=t})}async function r_(t,e=1536){console.log("[RASTERIZE-SVG] Starting SVG rasterization:",t.substring(0,50),"maxSize:",e);const r=await cm(t),{naturalWidth:n,naturalHeight:i}=r;console.log("[RASTERIZE-SVG] SVG loaded with dimensions:",n,"x",i);const o=Math.min(1,e/Math.max(n,i)),s=Math.round(n*o),l=Math.round(i*o);console.log("[RASTERIZE-SVG] Scaling to:",s,"x",l,"(scale:",o.toFixed(2),")");const c=document.createElement("canvas");return c.width=s,c.height=l,c.getContext("2d").drawImage(r,0,0,s,l),console.log("[RASTERIZE-SVG] Drew SVG to canvas"),new Promise((h,f)=>{const u=new Image;u.onload=()=>{console.log("[RASTERIZE-SVG] Successfully rasterized SVG to PNG"),h(u)},u.onerror=p=>{console.error("[RASTERIZE-SVG] Failed to convert canvas to image:",p),f(p)},u.src=c.toDataURL("image/png")})}function n_({photoCtx:t,photoImg:e,designImg:r,quad:n,opacity:i,shape:o,lighting:s}){const l=t.canvas;t.clearRect(0,0,l.width,l.height),t.drawImage(e,0,0,l.width,l.height);const c=r.width,d=r.height,h=[0,0,c,0,c,d,0,d],f=[n[0].x,n[0].y,n[1].x,n[1].y,n[2].x,n[2].y,n[3].x,n[3].y],u=O7(h,f),p=10,g=c/p,m=d/p,x=document.createElement("canvas");if(x.width=c,x.height=d,x.getContext("2d").drawImage(r,0,0),t.save(),t.globalAlpha=i,s&&s.enabled){const b=s.strength||.6,w=1+(s.baseBrightness-1)*b,k=1+(s.baseContrast-1)*b;t.filter=`brightness(${w}) contrast(${k})`}const y=o&&o.length>=3?o:n;t.beginPath(),t.moveTo(y[0].x,y[0].y);for(let b=1;b<y.length;b++)t.lineTo(y[b].x,y[b].y);t.closePath(),t.clip();for(let b=0;b<p;b++)for(let w=0;w<p;w++){const k=b*g,S=w*m,C=(b+1)*g,T=(w+1)*m,R=u(k,S),O=u(C,S),Y=u(C,T),E=u(k,T);ry(t,x,k,S,C,S,k,T,R[0],R[1],O[0],O[1],E[0],E[1]),ry(t,x,C,S,C,T,k,T,O[0],O[1],Y[0],Y[1],E[0],E[1])}t.restore()}function ry(t,e,r,n,i,o,s,l,c,d,h,f,u,p){t.save(),t.beginPath(),t.moveTo(c,d),t.lineTo(h,f),t.lineTo(u,p),t.closePath(),t.clip();const g=(r-s)*(o-l)-(i-s)*(n-l);if(Math.abs(g)<.001){t.restore();return}const m=((c-u)*(o-l)-(h-u)*(n-l))/g,x=((d-p)*(o-l)-(f-p)*(n-l))/g,v=((r-s)*(h-u)-(i-s)*(c-u))/g,y=((r-s)*(f-p)-(i-s)*(d-p))/g,b=c-m*r-v*n,w=d-x*r-y*n;t.setTransform(m,x,v,y,b,w),t.drawImage(e,0,0),t.restore()}function M7(t,e="tpv-in-situ-preview.png"){t.toBlob(r=>{const n=URL.createObjectURL(r),i=document.createElement("a");i.href=n,i.download=e,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(n)},"image/png")}function $7(t,e,r,n){const i=r/n,o=t*.6,s=e*.6;let l,c;i>o/s?(l=o,c=o/i):(c=s,l=s*i);const d=(t-l)/2,h=(e-c)/2;return[{x:d,y:h},{x:d+l,y:h},{x:d+l,y:h+c},{x:d,y:h+c}]}function I7(t,e,r){let n=!1;for(let i=0,o=r.length-1;i<r.length;o=i++){const s=r[i].x,l=r[i].y,c=r[o].x,d=r[o].y;l>e!=d>e&&t<(c-s)*(e-l)/(d-l)+s&&(n=!n)}return n}function L7(t,e,r){t/=255,e/=255,r/=255;const n=Math.max(t,e,r),i=Math.min(t,e,r),o=(n+i)/2;if(n===i)return{h:0,s:0,l:o};const s=n-i,l=o>.5?s/(2-n-i):s/(n+i);let c;switch(n){case t:c=((e-r)/s+(e<r?6:0))/6;break;case e:c=((r-t)/s+2)/6;break;case r:c=((t-e)/s+4)/6;break}return{h:c,s:l,l:o}}function D7(t,e,r=2e3){if(!t||!e||e.length<3)return{avgLightness:.5,avgContrastProxy:.5};const n=Math.floor(Math.min(...e.map(y=>y.x))),i=Math.ceil(Math.max(...e.map(y=>y.x))),o=Math.floor(Math.min(...e.map(y=>y.y))),s=Math.ceil(Math.max(...e.map(y=>y.y))),l=i-n,c=s-o;if(l<=0||c<=0)return{avgLightness:.5,avgContrastProxy:.5};let d;try{d=t.getImageData(n,o,l,c)}catch(y){return console.warn("[LIGHTING] Failed to get image data:",y),{avgLightness:.5,avgContrastProxy:.5}}const h=d.data,f=[];let u=0;const p=r*5;for(;f.length<r&&u<p;){u++;const y=n+Math.random()*l,b=o+Math.random()*c;if(!I7(y,b,e))continue;const w=Math.floor(y-n),S=(Math.floor(b-o)*l+w)*4;if(S<0||S>=h.length-3)continue;const C=h[S],T=h[S+1],R=h[S+2],{l:O}=L7(C,T,R);f.push(O)}if(f.length===0)return{avgLightness:.5,avgContrastProxy:.5};const g=f.reduce((y,b)=>y+b,0)/f.length,m=f.reduce((y,b)=>y+Math.pow(b-g,2),0)/f.length,x=Math.sqrt(m),v=Math.min(1,x/.25);return{avgLightness:g,avgContrastProxy:v}}function z7(t){let e=1,r=1;const i=t.avgLightness-.5;return e+=i*.6,r+=(t.avgContrastProxy-.5)*.4,e=Math.max(.7,Math.min(1.3,e)),r=Math.max(.8,Math.min(1.25,r)),{brightness:e,contrast:r}}const F7=100;function B7({photoUrl:t,svgUrl:e,designSizeMm:r,initialQuad:n,initialShape:i,initialOpacity:o=.8,initialLighting:s,onChange:l}){const[c,d]=A.useState(null),[h,f]=A.useState(null),[u,p]=A.useState(n||null),[g,m]=A.useState(i||null),[x,v]=A.useState(Math.max(.3,Math.min(1,o))),[y,b]=A.useState(s||{enabled:!1,strength:.6,baseBrightness:1,baseContrast:1}),[w,k]=A.useState(!0),[S,C]=A.useState(null),[T,R]=A.useState(1),[O,Y]=A.useState("corners"),[E,B]=A.useState(null),[_,V]=A.useState(!1),[re,I]=A.useState(null),[q,D]=A.useState(null),J=A.useRef(null),U=A.useRef(null),G=A.useRef(null),[fe,oe]=A.useState([]),ae=20;A.useEffect(()=>{le()},[t,e]),A.useEffect(()=>{c&&h&&u&&ce()},[c,h,u,g,x,y,O,E,_,q]),A.useEffect(()=>{if(!c||!u||u.length!==4)return;const z=document.createElement("canvas");z.width=c.naturalWidth,z.height=c.naturalHeight;const Q=z.getContext("2d");Q.drawImage(c,0,0);const ne=D7(Q,u),{brightness:ge,contrast:Se}=z7(ne);b(we=>({...we,baseBrightness:ge,baseContrast:Se}))},[c,JSON.stringify(u)]),A.useEffect(()=>{const z=Q=>{if(O==="shape"&&(Q.key==="Delete"||Q.key==="Backspace")&&q!==null&&g&&g.length>3){Q.preventDefault();const ne=g.filter((ge,Se)=>Se!==q);m(ne),D(null),Ce(u,x,ne)}};return window.addEventListener("keydown",z),()=>window.removeEventListener("keydown",z)},[O,q,g,u,x]);const le=async()=>{var z;console.log("[FOUR-POINT] Starting to load images - photo:",t==null?void 0:t.substring(0,50),"svg:",e==null?void 0:e.substring(0,50)),k(!0),C(null);try{console.log("[FOUR-POINT] Loading photo and rasterizing SVG...");const[Q,ne]=await Promise.all([cm(t),r_(e,1536)]);console.log("[FOUR-POINT] Both images loaded successfully - photo:",Q.naturalWidth,"x",Q.naturalHeight,"design:",ne.naturalWidth,"x",ne.naturalHeight),d(Q),f(ne);const ge=((z=U.current)==null?void 0:z.clientWidth)||800,Se=500,we=ge/Q.naturalWidth,ke=Se/Q.naturalHeight,_e=Math.min(1,we,ke);if(R(_e),console.log("[FOUR-POINT] Display scale set to:",_e.toFixed(3)),n)console.log("[FOUR-POINT] Using provided initial quad");else{const Te=$7(Q.naturalWidth,Q.naturalHeight,r.width_mm,r.length_mm);p(Te),console.log("[FOUR-POINT] Initialized default quad")}}catch(Q){console.error("[FOUR-POINT] Failed to load images:",Q),C(Q.message)}finally{k(!1),console.log("[FOUR-POINT] Loading complete")}},ce=()=>{const z=J.current;if(!z||!c||!h||!u)return;z.width=c.naturalWidth,z.height=c.naturalHeight;const Q=z.getContext("2d");n_({photoCtx:Q,photoImg:c,designImg:h,quad:u,opacity:x,shape:g,lighting:y}),be(Q)},be=z=>{if(!u)return;z.setTransform(1,0,0,1,0,0);const Q=Math.max(8,Math.min(15,c.naturalWidth/80));if(O==="corners"){z.strokeStyle="rgba(255, 255, 255, 0.8)",z.lineWidth=2,z.setLineDash([5,5]),z.beginPath(),z.moveTo(u[0].x,u[0].y),z.lineTo(u[1].x,u[1].y),z.lineTo(u[2].x,u[2].y),z.lineTo(u[3].x,u[3].y),z.closePath(),z.stroke(),z.setLineDash([]);const ne=["TL","TR","BR","BL"];u.forEach((ge,Se)=>{z.beginPath(),z.arc(ge.x,ge.y,Q,0,Math.PI*2),z.fillStyle=E===Se?"#ff6b35":"rgba(255, 107, 53, 0.9)",z.fill(),z.strokeStyle="white",z.lineWidth=2,z.stroke(),z.fillStyle="white",z.font="10px sans-serif",z.textAlign="center",z.textBaseline="middle",z.fillText(ne[Se],ge.x,ge.y)})}else{const ne=g||u;z.strokeStyle="rgba(34, 197, 94, 0.8)",z.lineWidth=2,z.setLineDash([]),z.beginPath(),z.moveTo(ne[0].x,ne[0].y);for(let ge=1;ge<ne.length;ge++)z.lineTo(ne[ge].x,ne[ge].y);z.closePath(),z.stroke(),ne.forEach((ge,Se)=>{z.beginPath(),z.arc(ge.x,ge.y,Q*.8,0,Math.PI*2),q===Se?z.fillStyle="#22c55e":E===Se?z.fillStyle="#16a34a":z.fillStyle="rgba(34, 197, 94, 0.9)",z.fill(),z.strokeStyle="white",z.lineWidth=2,z.stroke()}),z.strokeStyle="rgba(255, 107, 53, 0.3)",z.lineWidth=1,z.setLineDash([3,3]),z.beginPath(),z.moveTo(u[0].x,u[0].y),z.lineTo(u[1].x,u[1].y),z.lineTo(u[2].x,u[2].y),z.lineTo(u[3].x,u[3].y),z.closePath(),z.stroke(),z.setLineDash([])}},Ce=A.useCallback((z,Q,ne,ge)=>{G.current&&clearTimeout(G.current),G.current=setTimeout(()=>{l&&l({quad:z,opacity:Q,shape:ne,lighting:ge||y})},F7)},[l,y]),ue=A.useCallback(()=>{oe(z=>{const Q=[...z,{quad:[...u],shape:g?[...g]:null,opacity:x,lighting:{...y}}];return Q.length>ae?Q.slice(-ae):Q})},[u,g,x,y]),de=()=>{if(fe.length===0)return;const z=fe[fe.length-1];oe(Q=>Q.slice(0,-1)),p(z.quad),m(z.shape),v(z.opacity),b(z.lighting),Ce(z.quad,z.opacity,z.shape,z.lighting)},ze=(z,Q)=>({x:z/T,y:Q/T}),Ge=(z,Q,ne)=>{if(!ne)return-1;const ge=25/T;for(let Se=0;Se<ne.length;Se++){const we=ne[Se].x-z,ke=ne[Se].y-Q;if(Math.sqrt(we*we+ke*ke)<ge)return Se}return-1},j=(z,Q,ne)=>{if(!ne||ne.length<3)return!1;let ge=!1;for(let Se=0,we=ne.length-1;Se<ne.length;we=Se++){const ke=ne[Se].x,_e=ne[Se].y,Te=ne[we].x,We=ne[we].y;_e>Q!=We>Q&&z<(Te-ke)*(Q-_e)/(We-_e)+ke&&(ge=!ge)}return ge},ie=z=>{if(O!=="shape"||!g||g.length<=3)return;const Q=J.current;if(!Q)return;const ne=Q.getBoundingClientRect(),ge=z.clientX-ne.left,Se=z.clientY-ne.top,{x:we,y:ke}=ze(ge,Se),_e=Ge(we,ke,g);if(_e>=0){ue();const Te=g.filter((Ue,Je)=>Je!==_e);m(Te),D(null);const We=F(u,Te);We!==u?(p(We),Ce(We,x,Te)):Ce(u,x,Te)}},M=z=>{const Q=J.current;if(!Q)return;const ne=Q.getBoundingClientRect(),ge=z.clientX-ne.left,Se=z.clientY-ne.top,{x:we,y:ke}=ze(ge,Se);if(O==="corners"){const _e=Ge(we,ke,u);_e>=0?(ue(),B(_e),Q.setPointerCapture(z.pointerId)):j(we,ke,u)&&(ue(),V(!0),I({x:we,y:ke}),Q.setPointerCapture(z.pointerId))}else{const _e=g||u,Te=Ge(we,ke,_e);if(Te>=0)ue(),B(Te),D(Te),Q.setPointerCapture(z.pointerId);else{ue();let We=0,Ue=1/0;for(let Be=0;Be<_e.length;Be++){const Ve=(Be+1)%_e.length,qe=K(we,ke,_e[Be].x,_e[Be].y,_e[Ve].x,_e[Ve].y);qe<Ue&&(Ue=qe,We=Ve)}const Je={x:we,y:ke},Fe=[..._e];Fe.splice(We,0,Je),m(Fe),D(We);const je=F(u,Fe);je!==u?(p(je),Ce(je,x,Fe)):Ce(u,x,Fe)}}},N=z=>{if(E===null&&!_)return;const Q=J.current;if(!Q)return;const ne=Q.getBoundingClientRect(),ge=z.clientX-ne.left,Se=z.clientY-ne.top,{x:we,y:ke}=ze(ge,Se),_e=Math.max(0,Math.min(c.naturalWidth,we)),Te=Math.max(0,Math.min(c.naturalHeight,ke));if(O==="corners"){if(_&&re){const We=_e-re.x,Ue=Te-re.y,Je=u.map(je=>({x:Math.max(0,Math.min(c.naturalWidth,je.x+We)),y:Math.max(0,Math.min(c.naturalHeight,je.y+Ue))}));let Fe=g;g&&(Fe=g.map(je=>({x:Math.max(0,Math.min(c.naturalWidth,je.x+We)),y:Math.max(0,Math.min(c.naturalHeight,je.y+Ue))})),m(Fe)),p(Je),I({x:_e,y:Te}),Ce(Je,x,Fe)}else if(E!==null){const We=[...u];We[E]={x:_e,y:Te},p(We),Ce(We,x,g)}}else{const Ue=[...g||u];Ue[E]={x:_e,y:Te},m(Ue),Ce(u,x,Ue)}},P=z=>{if(E!==null||_){const Q=J.current;if(Q&&Q.releasePointerCapture(z.pointerId),O==="shape"&&g&&E!==null){const ne=F(u,g);ne!==u&&(p(ne),Ce(ne,x,g))}B(null),V(!1),I(null)}},F=(z,Q)=>{if(!Q||Q.length<3||!z)return z;const ne=z.reduce((je,Be)=>je+Be.x,0)/4,ge=z.reduce((je,Be)=>je+Be.y,0)/4,Se=Q.reduce((je,Be)=>je+Be.x,0)/Q.length,we=Q.reduce((je,Be)=>je+Be.y,0)/Q.length;let ke=1;for(const je of Q){const Be=je.x-ne,Ve=je.y-ge,qe=Math.sqrt(Be*Be+Ve*Ve);if(qe<1)continue;const ft=X(ne,ge,Be,Ve,z);if(ft>0&&qe>ft){const Qt=qe/ft;ke=Math.max(ke,Qt)}}let _e=1/0;for(const je of Q){const Be=je.x-ne,Ve=je.y-ge,qe=Math.sqrt(Be*Be+Ve*Ve);if(qe<1)continue;const ft=X(ne,ge,Be,Ve,z);if(ft>0){const Qt=qe/ft;_e=Math.min(_e,Qt)}}let Te=ke;if(ke<=1&&_e<1/0&&(Te=_e),Math.abs(Te-1)<.01)return z;const We=z.map(je=>({x:ne+(je.x-ne)*Te,y:ge+(je.y-ge)*Te})),Ue=Se-ne,Je=we-ge;return We.map(je=>({x:je.x+Ue,y:je.y+Je}))},X=(z,Q,ne,ge,Se)=>{let we=1/0;for(let ke=0;ke<4;ke++){const _e=Se[ke],Te=Se[(ke+1)%4],We=Te.x-_e.x,Ue=Te.y-_e.y,Je=ne*Ue-ge*We;if(Math.abs(Je)<1e-4)continue;const Fe=((_e.x-z)*Ue-(_e.y-Q)*We)/Je,je=((_e.x-z)*ge-(_e.y-Q)*ne)/Je;Fe>0&&je>=0&&je<=1&&(we=Math.min(we,Fe*Math.sqrt(ne*ne+ge*ge)))}return we===1/0?0:we},K=(z,Q,ne,ge,Se,we)=>{const ke=z-ne,_e=Q-ge,Te=Se-ne,We=we-ge,Ue=ke*Te+_e*We,Je=Te*Te+We*We;let Fe=Je!==0?Ue/Je:-1,je,Be;return Fe<0?(je=ne,Be=ge):Fe>1?(je=Se,Be=we):(je=ne+Fe*Te,Be=ge+Fe*We),Math.sqrt((z-je)**2+(Q-Be)**2)},L=()=>{O==="corners"?(g||m([...u]),Y("shape"),D(null)):(Y("corners"),D(null))},H=z=>{const Q=Math.max(.3,Math.min(1,parseFloat(z.target.value)/100));v(Q),Ce(u,Q,g)},Z=z=>{const Q={...y,enabled:z.target.checked};b(Q),Ce(u,x,g,Q)},ee=z=>{const Q={...y,strength:parseFloat(z.target.value)/100};b(Q),Ce(u,x,g,Q)};return w?a.jsxs("div",{className:"four-point-editor loading",children:[a.jsx("div",{className:"spinner"}),a.jsx("p",{children:"Loading preview..."})]}):S?a.jsx("div",{className:"four-point-editor error",children:a.jsxs("p",{children:["Failed to load: ",S]})}):a.jsxs("div",{className:"four-point-editor",ref:U,children:[a.jsxs("div",{className:"editor-header",children:[a.jsxs("div",{className:"header-title",children:[a.jsx("h3",{children:"Position Your Design"}),a.jsx(gp,{content:a.jsxs("div",{children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Corners Mode:"})," Drag the 4 corner handles (TL, TR, BR, BL) to position your design with perspective. You can also drag inside the design to move all corners at once."]}),a.jsxs("p",{style:{marginTop:"0.5rem"},children:[a.jsx("strong",{children:"Refine Shape Mode:"})," Click anywhere to add new vertices for precise shape control. Drag existing vertices to adjust. Double-click or press Delete/Backspace on a vertex to remove it."]}),a.jsxs("p",{style:{marginTop:"0.5rem"},children:[a.jsx("strong",{children:"Overlay Opacity:"})," Adjust transparency to see how the design blends with your photo."]}),a.jsxs("p",{style:{marginTop:"0.5rem"},children:[a.jsx("strong",{children:"Match Floor Lighting:"})," Automatically adjusts design brightness to match your floor's lighting conditions."]})]}),position:"right"})]}),a.jsx("p",{className:"instructions",children:O==="corners"?"Drag the corner handles (TL, TR, BR, BL) to position the design. Drag inside to move all corners.":"Click to add vertices, drag to move them, double-click or press Delete to remove."})]}),a.jsx("div",{className:"canvas-container",children:a.jsx("canvas",{ref:J,onPointerDown:M,onPointerMove:N,onPointerUp:P,onPointerLeave:P,onDoubleClick:ie,style:{width:`${((c==null?void 0:c.naturalWidth)||800)*T}px`,height:`${((c==null?void 0:c.naturalHeight)||600)*T}px`,cursor:E!==null||_?"grabbing":O==="shape"?"crosshair":"move",touchAction:"none"}})}),a.jsxs("div",{className:"controls",children:[a.jsxs("div",{className:"mode-toggle",children:[a.jsx("button",{className:`toggle-btn ${O==="corners"?"active":""}`,onClick:()=>Y("corners"),children:"Corners"}),a.jsx("button",{className:`toggle-btn ${O==="shape"?"active":""}`,onClick:L,children:"Refine Shape"}),a.jsx("button",{className:"toggle-btn undo-btn",onClick:de,disabled:fe.length===0,title:"Undo last change",children:"Undo"})]}),a.jsxs("div",{className:"opacity-control",children:[a.jsxs("label",{children:["Overlay Opacity",a.jsxs("span",{className:"value",children:[Math.round(x*100),"%"]})]}),a.jsx("input",{type:"range",min:"30",max:"100",value:Math.round(x*100),onChange:H})]}),a.jsxs("div",{className:"lighting-control",children:[a.jsxs("label",{className:"checkbox-label",children:[a.jsx("input",{type:"checkbox",checked:y.enabled,onChange:Z}),"Match floor lighting"]}),y.enabled&&a.jsxs("div",{className:"lighting-slider",children:[a.jsxs("label",{children:["Strength",a.jsxs("span",{className:"value",children:[Math.round(y.strength*100),"%"]})]}),a.jsx("input",{type:"range",min:"0",max:"100",value:Math.round(y.strength*100),onChange:ee})]})]})]}),a.jsx("style",{children:`
        .four-point-editor {
          display: flex;
          flex-direction: column;
          height: 100%;
        }

        .four-point-editor.loading,
        .four-point-editor.error {
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          min-height: 400px;
          color: #6b7280;
        }

        .four-point-editor .spinner {
          width: 40px;
          height: 40px;
          border: 3px solid #e5e7eb;
          border-top-color: #ff6b35;
          border-radius: 50%;
          animation: spin 0.8s linear infinite;
          margin-bottom: 1rem;
        }

        @keyframes spin {
          to { transform: rotate(360deg); }
        }

        .editor-header {
          padding-bottom: 1rem;
          border-bottom: 1px solid #e5e7eb;
          margin-bottom: 1rem;
        }

        .editor-header .header-title {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          margin-bottom: 0.5rem;
        }

        .editor-header h3 {
          margin: 0;
          font-size: 1.125rem;
          color: #1e4a7a;
        }

        .editor-header .instructions {
          margin: 0;
          font-size: 0.875rem;
          color: #6b7280;
        }

        .canvas-container {
          flex: 1;
          display: flex;
          align-items: center;
          justify-content: center;
          background: #f3f4f6;
          border-radius: 8px;
          overflow: hidden;
          min-height: 400px;
        }

        .canvas-container canvas {
          display: block;
        }

        .controls {
          padding-top: 1rem;
          border-top: 1px solid #e5e7eb;
          margin-top: 1rem;
          display: flex;
          flex-direction: column;
          gap: 1rem;
        }

        .mode-toggle {
          display: flex;
          gap: 0.5rem;
        }

        .toggle-btn {
          padding: 0.5rem 1rem;
          border: 1px solid #d1d5db;
          background: white;
          border-radius: 4px;
          font-size: 0.875rem;
          cursor: pointer;
          transition: all 0.2s;
        }

        .toggle-btn:hover {
          background: #f9fafb;
        }

        .toggle-btn.active {
          background: #ff6b35;
          color: white;
          border-color: #ff6b35;
        }

        .toggle-btn:disabled {
          opacity: 0.4;
          cursor: not-allowed;
        }

        .toggle-btn:disabled:hover {
          background: white;
        }

        .opacity-control {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .opacity-control label {
          display: flex;
          justify-content: space-between;
          font-size: 0.875rem;
          font-weight: 500;
          color: #374151;
        }

        .opacity-control .value {
          font-weight: 400;
          color: #6b7280;
        }

        .opacity-control input[type="range"] {
          width: 100%;
          height: 6px;
          border-radius: 3px;
          background: #e5e7eb;
          outline: none;
          -webkit-appearance: none;
        }

        .opacity-control input[type="range"]::-webkit-slider-thumb {
          -webkit-appearance: none;
          width: 16px;
          height: 16px;
          border-radius: 50%;
          background: #ff6b35;
          cursor: pointer;
        }

        .lighting-control {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .checkbox-label {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          font-size: 0.875rem;
          font-weight: 500;
          color: #374151;
          cursor: pointer;
        }

        .checkbox-label input[type="checkbox"] {
          width: 16px;
          height: 16px;
          cursor: pointer;
        }

        .lighting-slider {
          display: flex;
          flex-direction: column;
          gap: 0.25rem;
          padding-left: 1.5rem;
        }

        .lighting-slider label {
          display: flex;
          justify-content: space-between;
          font-size: 0.8rem;
          color: #6b7280;
        }

        .lighting-slider .value {
          font-weight: 400;
        }

        .lighting-slider input[type="range"] {
          width: 100%;
          height: 6px;
          border-radius: 3px;
          background: #e5e7eb;
          outline: none;
          -webkit-appearance: none;
        }

        .lighting-slider input[type="range"]::-webkit-slider-thumb {
          -webkit-appearance: none;
          width: 14px;
          height: 14px;
          border-radius: 50%;
          background: #22c55e;
          cursor: pointer;
        }
      `})]})}const Xr={UPLOAD:"upload",POSITION:"position"};function i_({designUrl:t,designDimensions:e,onClose:r,onSaved:n}){const[i,o]=A.useState(Xr.UPLOAD),[s,l]=A.useState(null),[c,d]=A.useState(null),[h,f]=A.useState(null),[u,p]=A.useState(.8),[g,m]=A.useState({enabled:!1,strength:.6,baseBrightness:1,baseContrast:1}),[x,v]=A.useState(!1),y=A.useRef(null);A.useEffect(()=>{if(t){console.log("[IN-SITU-MODAL] Design URL received:",t==null?void 0:t.substring(0,50));const R=new Image;!t.startsWith("blob:")&&!t.startsWith("data:")&&(R.crossOrigin="anonymous"),R.src=t}else console.warn("[IN-SITU-MODAL] No design URL provided")},[t]);const b=R=>{console.log("[IN-SITU-MODAL] Photo uploaded:",R),l(R),console.log("[IN-SITU-MODAL] Advancing to POSITION step, designUrl:",t==null?void 0:t.substring(0,50)),o(Xr.POSITION)},w=({quad:R,opacity:O,shape:Y,lighting:E})=>{d(R),p(O),f(Y),E&&m(E)},k=async()=>{if(!s||!c)return null;try{console.log("[InSitu] Loading design from URL:",t);const[R,O]=await Promise.all([cm(s.url),r_(t,1536)]);console.log("[InSitu] Successfully loaded design image");const Y=document.createElement("canvas");Y.width=R.naturalWidth,Y.height=R.naturalHeight;const E=Y.getContext("2d");return n_({photoCtx:E,photoImg:R,designImg:O,quad:c,opacity:u,shape:h,lighting:g}),Y}catch(R){return console.error("[InSitu] Failed to generate canvas:",R),alert(`Failed to load design: ${R.message}`),null}},S=async()=>{const R=await k();R&&M7(R,"tpv-in-situ-preview.png")},C=async()=>{if(!(!c||!s)){v(!0);try{const R=await k();if(!R)throw new Error("Failed to generate preview");const O=await new Promise(V=>R.toBlob(V,"image/png")),E=`in-situ-previews/${`${Date.now()}-${Math.random().toString(36).substr(2,9)}.png`}`,{error:B}=await Pt.storage.from("tpv-studio-uploads").upload(E,O,{contentType:"image/png",cacheControl:"3600"});if(B)throw B;const{data:{publicUrl:_}}=Pt.storage.from("tpv-studio-uploads").getPublicUrl(E);n&&n({photo_url:s.supabaseUrl||s.url,quad:c,shape:h,opacity:u,lighting:g,preview_url:_}),r()}catch(R){console.error("[IN-SITU] Save failed:",R),alert("Failed to save preview: "+R.message)}finally{v(!1)}}},T=()=>{switch(i){case Xr.UPLOAD:return"Upload Site Photo";case Xr.POSITION:return"Position Your Design";default:return"In-Situ Preview"}};return a.jsxs("div",{className:"modal-overlay in-situ-modal-overlay",onClick:r,children:[a.jsxs("div",{className:"modal-content in-situ-modal",onClick:R=>R.stopPropagation(),children:[a.jsxs("div",{className:"modal-header",children:[a.jsxs("div",{className:"header-left",children:[a.jsx("h2",{children:T()}),a.jsxs("div",{className:"step-indicator",children:[a.jsx("span",{className:i===Xr.UPLOAD?"active":"completed",children:"1. Upload"}),a.jsx("span",{className:i===Xr.POSITION?"active":"",children:"2. Position"})]})]}),a.jsx("button",{onClick:r,className:"close-button",children:""})]}),a.jsxs("div",{className:"modal-body",children:[i===Xr.UPLOAD&&a.jsxs("div",{className:"upload-step",children:[a.jsx("p",{className:"step-description",children:"Upload a photo of your site to see how your TPV design will look when installed. For best results, use a photo taken from above or at a slight angle showing the floor area clearly."}),a.jsx(P7,{onPhotoUploaded:b})]}),i===Xr.POSITION&&s&&a.jsx(B7,{ref:y,photoUrl:s.url,svgUrl:t,designSizeMm:{width_mm:e.width,length_mm:e.length},initialOpacity:.8,onChange:w})]}),i===Xr.POSITION&&a.jsxs("div",{className:"modal-footer",children:[a.jsx("button",{onClick:()=>o(Xr.UPLOAD),className:"btn-secondary",children:"Back"}),a.jsxs("div",{className:"footer-actions",children:[a.jsx("button",{onClick:S,disabled:!c,className:"btn-secondary",children:"Download PNG"}),a.jsx("button",{onClick:C,disabled:!c||x,className:"btn-primary",children:x?"Saving...":"Save to Project"})]})]})]}),a.jsx("style",{children:`
        .in-situ-modal-overlay {
          position: fixed;
          inset: 0;
          background: rgba(0, 0, 0, 0.6);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 1000;
          padding: 1rem;
        }

        .in-situ-modal {
          background: white;
          border-radius: 12px;
          width: 100%;
          max-width: 1000px;
          max-height: 90vh;
          display: flex;
          flex-direction: column;
          box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .in-situ-modal .modal-header {
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
          padding: 1.25rem 1.5rem;
          border-bottom: 1px solid #e5e7eb;
        }

        .header-left {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .in-situ-modal .modal-header h2 {
          margin: 0;
          font-size: 1.25rem;
          color: #1e4a7a;
        }

        .step-indicator {
          display: flex;
          gap: 1rem;
          font-size: 0.75rem;
        }

        .step-indicator span {
          color: #9ca3af;
          padding: 0.25rem 0.5rem;
          border-radius: 4px;
        }

        .step-indicator span.active {
          background: #fff7f5;
          color: #ff6b35;
          font-weight: 500;
        }

        .step-indicator span.completed {
          color: #22c55e;
        }

        .close-button {
          background: none;
          border: none;
          font-size: 1.5rem;
          cursor: pointer;
          color: #9ca3af;
          padding: 0;
          line-height: 1;
        }

        .close-button:hover {
          color: #374151;
        }

        .modal-body {
          flex: 1;
          padding: 1.5rem;
          overflow-y: auto;
          min-height: 500px;
        }

        .upload-step {
          display: flex;
          flex-direction: column;
          gap: 1.5rem;
        }

        .step-description {
          margin: 0;
          font-size: 0.875rem;
          color: #6b7280;
          line-height: 1.6;
        }

        .modal-footer {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 1rem 1.5rem;
          border-top: 1px solid #e5e7eb;
          background: #f9fafb;
          border-radius: 0 0 12px 12px;
        }

        .footer-actions {
          display: flex;
          gap: 0.5rem;
        }

        .btn-primary,
        .btn-secondary {
          padding: 0.5rem 1rem;
          border-radius: 4px;
          font-size: 0.875rem;
          font-weight: 500;
          cursor: pointer;
          transition: all 0.2s;
          border: none;
        }

        .btn-primary {
          background: #ff6b35;
          color: white;
        }

        .btn-primary:hover:not(:disabled) {
          background: #e55a2b;
        }

        .btn-primary:disabled {
          background: #d1d5db;
          cursor: not-allowed;
        }

        .btn-secondary {
          background: white;
          color: #374151;
          border: 1px solid #d1d5db;
        }

        .btn-secondary:hover:not(:disabled) {
          background: #f9fafb;
        }

        .btn-secondary:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
          .in-situ-modal {
            max-width: 100%;
            max-height: 100vh;
            border-radius: 0;
          }

          .modal-body {
            padding: 1rem;
          }

          .step-indicator {
            display: none;
          }

          .modal-footer {
            border-radius: 0;
          }
        }
      `})]})}function U7({isOpen:t,onClose:e,onConfirm:r,aspectRatio:n,defaultLongestSide:i=5e3}){const[o,s]=A.useState(i),[l,c]=A.useState(i/1e3),h=(m=>{if(!n||n<=0)return{width:m,length:m};if(n>=1){const x=m,v=Math.round(m/n);return{width:x,length:v}}else{const x=m;return{width:Math.round(m*n),length:x}}})(o),f=n>=1?"landscape":"portrait",u=n>=1?`${n.toFixed(1)}:1`:`1:${(1/n).toFixed(1)}`,p=m=>{const x=parseFloat(m.target.value)||0;c(x),s(Math.round(x*1e3))},g=()=>{r(h.width,h.length),e()};return t?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"dimension-modal-overlay",onClick:e,children:a.jsxs("div",{className:"dimension-modal",onClick:m=>m.stopPropagation(),children:[a.jsxs("div",{className:"dimension-modal-header",children:[a.jsxs("div",{className:"dimension-modal-title",children:[a.jsx("h2",{children:"Set Installation Size"}),a.jsx(gp,{content:a.jsxs("div",{children:[a.jsx("p",{children:a.jsx("strong",{children:"Why specify dimensions?"})}),a.jsx("p",{style:{marginTop:"0.5rem"},children:"Accurate dimensions are essential for:"}),a.jsxs("ul",{style:{marginTop:"0.5rem",marginBottom:0,paddingLeft:"1.25rem"},children:[a.jsx("li",{children:"Calculating exact material quantities"}),a.jsx("li",{children:"Generating PDF specifications for manufacturers"}),a.jsx("li",{children:"Slicing designs into 1m1m installation tiles"})]}),a.jsxs("p",{style:{marginTop:"0.5rem"},children:[a.jsx("strong",{children:"Tip:"})," Typical playground installations range from 3m to 20m on the longest side."]})]}),position:"bottom"})]}),a.jsx("button",{className:"dimension-modal-close",onClick:e,"aria-label":"Close",children:""})]}),a.jsxs("div",{className:"dimension-modal-body",children:[a.jsx("div",{className:"dimension-info",children:a.jsxs("p",{className:"dimension-aspect",children:["Your design has a ",a.jsxs("strong",{children:[u," ",f]})," aspect ratio"]})}),a.jsxs("div",{className:"dimension-input-group",children:[a.jsx("label",{htmlFor:"longest-dimension",children:"Installation Size (Longest Side)"}),a.jsxs("div",{className:"dimension-input-wrapper",children:[a.jsx("input",{id:"longest-dimension",type:"number",min:"0.1",max:"50",step:"0.1",value:l,onChange:p,className:"dimension-input"}),a.jsx("span",{className:"dimension-unit",children:"meters"})]}),a.jsx("p",{className:"dimension-help",children:"Enter the measurement of the longest side of your installation area. The other dimension will be calculated automatically based on your design's aspect ratio."})]}),a.jsxs("div",{className:"dimension-preview",children:[a.jsx("div",{className:"dimension-preview-title",children:"Calculated Dimensions:"}),a.jsxs("div",{className:"dimension-preview-values",children:[a.jsxs("div",{className:"dimension-preview-item",children:[a.jsx("span",{className:"dimension-preview-label",children:"Width:"}),a.jsxs("span",{className:"dimension-preview-value",children:[(h.width/1e3).toFixed(2),"m"]})]}),a.jsxs("div",{className:"dimension-preview-item",children:[a.jsx("span",{className:"dimension-preview-label",children:"Length:"}),a.jsxs("span",{className:"dimension-preview-value",children:[(h.length/1e3).toFixed(2),"m"]})]}),a.jsxs("div",{className:"dimension-preview-item",children:[a.jsx("span",{className:"dimension-preview-label",children:"Total Area:"}),a.jsxs("span",{className:"dimension-preview-value",children:[(h.width*h.length/1e6).toFixed(2),"m"]})]})]})]}),a.jsxs("div",{className:"dimension-note",children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"8",cy:"8",r:"7"}),a.jsx("line",{x1:"8",y1:"11",x2:"8",y2:"8"}),a.jsx("circle",{cx:"8",cy:"5",r:"0.5",fill:"currentColor"})]}),a.jsx("p",{children:"These dimensions will be used to calculate material quantities for your PDF specification and to slice your design into 1m1m installation tiles."})]})]}),a.jsxs("div",{className:"dimension-modal-footer",children:[a.jsx("button",{className:"dimension-btn dimension-btn-secondary",onClick:e,children:"Cancel"}),a.jsx("button",{className:"dimension-btn dimension-btn-primary",onClick:g,disabled:l<=0,children:"Confirm Size"})]})]})}),a.jsx("style",{children:`
        .dimension-modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.6);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 10000;
        padding: 20px;
        backdrop-filter: blur(4px);
      }

      .dimension-modal {
        background: white;
        border-radius: 16px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        max-width: 500px;
        width: 100%;
        max-height: 90vh;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        animation: dimensionModalSlideIn 0.3s ease-out;
      }

      @keyframes dimensionModalSlideIn {
        from {
          opacity: 0;
          transform: translateY(-20px) scale(0.95);
        }
        to {
          opacity: 1;
          transform: translateY(0) scale(1);
        }
      }

      .dimension-modal-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 24px;
        border-bottom: 1px solid #e5e7eb;
      }

      .dimension-modal-title {
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .dimension-modal-header h2 {
        margin: 0;
        font-size: 1.5rem;
        font-weight: 600;
        color: #111827;
      }

      .dimension-modal-close {
        background: none;
        border: none;
        font-size: 2rem;
        line-height: 1;
        color: #9ca3af;
        cursor: pointer;
        padding: 0;
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 8px;
        transition: all 0.2s;
      }

      .dimension-modal-close:hover {
        background: #f3f4f6;
        color: #111827;
      }

      .dimension-modal-body {
        padding: 24px;
        overflow-y: auto;
        flex: 1;
      }

      .dimension-info {
        background: #f0f9ff;
        border: 1px solid #bae6fd;
        border-radius: 12px;
        padding: 16px;
        margin-bottom: 24px;
      }

      .dimension-aspect {
        margin: 0;
        color: #0c4a6e;
        font-size: 0.95rem;
        line-height: 1.5;
      }

      .dimension-input-group {
        margin-bottom: 24px;
      }

      .dimension-input-group label {
        display: block;
        font-weight: 600;
        color: #374151;
        margin-bottom: 8px;
        font-size: 0.95rem;
      }

      .dimension-input-wrapper {
        position: relative;
        display: flex;
        align-items: center;
      }

      .dimension-input {
        width: 100%;
        padding: 12px 16px;
        padding-right: 70px;
        font-size: 1.1rem;
        border: 2px solid #d1d5db;
        border-radius: 10px;
        transition: all 0.2s;
        font-family: inherit;
      }

      .dimension-input:focus {
        outline: none;
        border-color: #3b82f6;
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
      }

      .dimension-unit {
        position: absolute;
        right: 16px;
        color: #6b7280;
        font-weight: 500;
        pointer-events: none;
      }

      .dimension-help {
        margin: 8px 0 0 0;
        font-size: 0.85rem;
        color: #6b7280;
      }

      .dimension-preview {
        background: #f9fafb;
        border: 1px solid #e5e7eb;
        border-radius: 12px;
        padding: 20px;
        margin-bottom: 24px;
      }

      .dimension-preview-title {
        font-weight: 600;
        color: #374151;
        margin-bottom: 16px;
        font-size: 0.95rem;
      }

      .dimension-preview-values {
        display: flex;
        flex-direction: column;
        gap: 12px;
      }

      .dimension-preview-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 12px;
        background: white;
        border-radius: 8px;
      }

      .dimension-preview-label {
        color: #6b7280;
        font-size: 0.9rem;
      }

      .dimension-preview-value {
        font-weight: 600;
        color: #111827;
        font-size: 1.05rem;
      }

      .dimension-note {
        display: flex;
        gap: 12px;
        padding: 16px;
        background: #fffbeb;
        border: 1px solid #fde68a;
        border-radius: 10px;
      }

      .dimension-note svg {
        flex-shrink: 0;
        margin-top: 2px;
        color: #f59e0b;
      }

      .dimension-note p {
        margin: 0;
        font-size: 0.85rem;
        color: #78350f;
        line-height: 1.5;
      }

      .dimension-modal-footer {
        padding: 20px 24px;
        border-top: 1px solid #e5e7eb;
        display: flex;
        gap: 12px;
        justify-content: flex-end;
      }

      .dimension-btn {
        padding: 10px 24px;
        border-radius: 8px;
        font-weight: 600;
        font-size: 0.95rem;
        cursor: pointer;
        transition: all 0.2s;
        border: none;
        font-family: inherit;
      }

      .dimension-btn-secondary {
        background: white;
        border: 1px solid #d1d5db;
        color: #374151;
      }

      .dimension-btn-secondary:hover {
        background: #f9fafb;
        border-color: #9ca3af;
      }

      .dimension-btn-primary {
        background: #3b82f6;
        color: white;
      }

      .dimension-btn-primary:hover {
        background: #2563eb;
        box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
      }

      .dimension-btn-primary:disabled {
        background: #9ca3af;
        cursor: not-allowed;
        box-shadow: none;
      }

      @media (max-width: 640px) {
        .dimension-modal {
          max-width: none;
          width: 100%;
          margin: 0;
          max-height: 100vh;
          border-radius: 0;
        }

        .dimension-modal-header {
          padding: 20px;
        }

        .dimension-modal-header h2 {
          font-size: 1.25rem;
        }

        .dimension-modal-body {
          padding: 20px;
        }

        .dimension-modal-footer {
          flex-direction: column-reverse;
          padding: 16px 20px;
        }

        .dimension-btn {
          width: 100%;
        }
      }
      `})]}):null}function zu(t){const r=new DOMParser().parseFromString(t,"image/svg+xml"),n=r.querySelector("parsererror");if(n)return console.error("[SVG-REGION-TAGGER] Parse error:",n.textContent),t;const i=r.documentElement;if(!i.hasAttribute("viewBox")){const l=i.getAttribute("width"),c=i.getAttribute("height");if(l&&c){const d=parseFloat(l),h=parseFloat(c);!isNaN(d)&&!isNaN(h)&&(i.setAttribute("viewBox",`0 0 ${d} ${h}`),console.log(`[SVG-REGION-TAGGER] Added viewBox from dimensions: 0 0 ${d} ${h}`))}else{const d=H7(r);d&&(i.setAttribute("viewBox",`${d.x} ${d.y} ${d.width} ${d.height}`),console.log(`[SVG-REGION-TAGGER] Added viewBox from content bounds: ${d.x} ${d.y} ${d.width} ${d.height}`))}}let o=0;return r.querySelectorAll("path, rect, circle, ellipse, polygon, polyline, line").forEach(l=>{l.hasAttribute("data-region-id")||l.setAttribute("data-region-id",`region-${o++}`)}),console.log(`[SVG-REGION-TAGGER] Tagged ${o} regions`),new XMLSerializer().serializeToString(r)}function H7(t){try{const e=t.documentElement.cloneNode(!0),r=document.createElement("div");r.style.position="absolute",r.style.visibility="hidden",document.body.appendChild(r),r.appendChild(e);const n=e.getBBox();if(document.body.removeChild(r),n.width>0&&n.height>0)return{x:Math.floor(n.x),y:Math.floor(n.y),width:Math.ceil(n.width),height:Math.ceil(n.height)}}catch(e){console.warn("[SVG-REGION-TAGGER] Could not calculate content bounds:",e)}return null}function ny(t,e){if(!e||e.size===0)return t;const n=new DOMParser().parseFromString(t,"image/svg+xml"),i=n.querySelector("parsererror");if(i)return console.error("[SVG-REGION-OVERRIDES] Parse error:",i.textContent),t;let o=0;return e.forEach((s,l)=>{const c=n.querySelector(`[data-region-id="${l}"]`);if(c){if(c.hasAttribute("fill")&&(c.setAttribute("fill",s),o++),c.hasAttribute("stroke")&&c.getAttribute("stroke")!=="none"){const h=c.getAttribute("stroke");h&&h!=="#000"&&h!=="#000000"&&h!=="#fff"&&h!=="#ffffff"&&c.setAttribute("stroke",s)}const d=c.getAttribute("style");if(d&&d.includes("fill:")){const h=d.replace(/fill:\s*[^;]+/,`fill: ${s}`);c.setAttribute("style",h)}}else console.warn(`[SVG-REGION-OVERRIDES] Region not found: ${l}`)}),console.log(`[SVG-REGION-OVERRIDES] Applied ${o} region overrides`),new XMLSerializer().serializeToString(n)}const iy={landscape:[{name:"1:1",ratio:1,width:1024,height:1024},{name:"4:3",ratio:4/3,width:1024,height:768},{name:"3:2",ratio:3/2,width:1024,height:683},{name:"16:9",ratio:16/9,width:1024,height:576},{name:"2:1",ratio:2,width:1024,height:512},{name:"3:1",ratio:3,width:1024,height:341}],portrait:[{name:"1:1",ratio:1,width:1024,height:1024},{name:"3:4",ratio:3/4,width:768,height:1024},{name:"2:3",ratio:2/3,width:683,height:1024},{name:"9:16",ratio:9/16,width:576,height:1024},{name:"1:2",ratio:1/2,width:512,height:1024},{name:"1:3",ratio:1/3,width:341,height:1024}]},qs={safeDifference:.3,tilingThreshold:3.5,framingThreshold:2.5};function W7(t,e){return t/e}function G7(t){return t>=.95&&t<=1.05?"square":t>1?"landscape":"portrait"}function V7(t,e){const r=e==="portrait"?iy.portrait:iy.landscape;let n=r[0],i=Math.abs(t-n.ratio);for(const o of r){const s=Math.abs(t-o.ratio);s<i&&(i=s,n=o)}return{...n,difference:i}}function q7(t,e,r){return t>=qs.tilingThreshold||t<=1/qs.tilingThreshold?{mode:"tiling",reason:"Extreme aspect ratio - design will repeat along length",warning:!0}:r>=qs.safeDifference||t>=qs.framingThreshold||t<=1/qs.framingThreshold?{mode:"framing",reason:"Design panel centered with base color surround",warning:!1}:{mode:"full",reason:"Design fills entire surface",warning:!1}}function K7(t,e){const r=W7(t,e),n=G7(r),i=V7(r,n),o=q7(r,i.ratio,i.difference);return{user:{widthMM:t,heightMM:e,aspectRatio:r,orientation:n,formatted:`${(t/1e3).toFixed(1)}m  ${(e/1e3).toFixed(1)}m`},canonical:{name:i.name,ratio:i.ratio,width:i.width,height:i.height,difference:i.difference},layout:o,recraft:{width:i.width,height:i.height,metadata:{targetWidthMM:t,targetHeightMM:e,layoutMode:o.mode}}}}function Y7(t){const{user:e,canonical:r,layout:n}=t;let i=`Generating ${r.name} design panel`;return n.mode==="full"?i+=` (fills ${e.formatted} surface)`:n.mode==="framing"?i+=` (centered in ${e.formatted} surface with base color surround)`:n.mode==="tiling"&&(i+=` (will repeat along ${e.formatted} surface)`),i}function X7(t){return t.layout.warning||t.layout.mode!=="full"}async function oy(t,e="tpv-studio-uploads"){try{const r=Date.now(),n=Math.random().toString(36).substring(7),i=t.name.split(".").pop(),s=`uploads/${`${r}-${n}.${i}`}`;console.log("[Upload] Uploading file:",t.name,"",s);const{data:l,error:c}=await Pt.storage.from(e).upload(s,t,{cacheControl:"3600",upsert:!1});if(c)return console.error("[Upload] Error:",c),{success:!1,error:c.message||"Failed to upload file"};const{data:{publicUrl:d}}=Pt.storage.from(e).getPublicUrl(s);return console.log("[Upload] Success:",d),{success:!0,url:d,path:s}}catch(r){return console.error("[Upload] Unexpected error:",r),{success:!1,error:r.message||"Unexpected error during upload"}}}function sy(t,e={}){const{maxSizeMB:r=10,allowedTypes:n=["image/png","image/jpeg","image/svg+xml"]}=e;if(!t)return{valid:!1,error:"No file selected"};if(!n.includes(t.type))return{valid:!1,error:`Invalid file type. Allowed: ${n.map(s=>s.split("/")[1].toUpperCase()).join(", ")}`};const i=r*1024*1024;return t.size>i?{valid:!1,error:`File too large. Maximum size: ${r}MB`}:{valid:!0}}function Z7({onExportSVG:t,onExportPNG:e,onExportPDF:r,onExportTiles:n,viewMode:i,exporting:o,disabled:s}){const[l,c]=A.useState(!1),d=A.useRef(null);A.useEffect(()=>{const u=p=>{d.current&&!d.current.contains(p.target)&&c(!1)};return l&&document.addEventListener("mousedown",u),()=>document.removeEventListener("mousedown",u)},[l]);const h=i==="solid"?"Solid":"Blend",f=u=>{c(!1),u()};return a.jsxs("div",{className:"playground-export-menu",ref:d,children:[a.jsxs("button",{className:"action-bar__btn action-bar__btn--export",onClick:()=>c(!l),disabled:s||o,children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"}),a.jsx("polyline",{points:"7 10 12 15 17 10"}),a.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),o?"Exporting...":"Export",a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{marginLeft:"0.25rem"},children:a.jsx("path",{d:l?"M18 15l-6-6-6 6":"M6 9l6 6 6-6"})})]}),l&&a.jsxs("div",{className:"playground-export-menu__dropdown",children:[a.jsxs("button",{className:"playground-export-menu__item",onClick:()=>f(t),children:[a.jsx("span",{className:"playground-export-menu__icon",children:""}),a.jsxs("div",{className:"playground-export-menu__content",children:[a.jsxs("span",{className:"playground-export-menu__title",children:["Download ",h," SVG"]}),a.jsx("span",{className:"playground-export-menu__desc",children:"Vector format for CAD/printing"})]})]}),a.jsxs("button",{className:"playground-export-menu__item",onClick:()=>f(e),children:[a.jsx("span",{className:"playground-export-menu__icon",children:""}),a.jsxs("div",{className:"playground-export-menu__content",children:[a.jsxs("span",{className:"playground-export-menu__title",children:["Download ",h," PNG"]}),a.jsx("span",{className:"playground-export-menu__desc",children:"High-res image for presentations"})]})]}),a.jsxs("button",{className:"playground-export-menu__item",onClick:()=>f(n),children:[a.jsx("span",{className:"playground-export-menu__icon",children:""}),a.jsxs("div",{className:"playground-export-menu__content",children:[a.jsx("span",{className:"playground-export-menu__title",children:"Download Tiles ZIP"}),a.jsx("span",{className:"playground-export-menu__desc",children:"1m1m SVG tiles for large printing"})]})]}),a.jsx("div",{className:"playground-export-menu__divider"}),a.jsxs("button",{className:"playground-export-menu__item",onClick:()=>f(r),children:[a.jsx("span",{className:"playground-export-menu__icon",children:""}),a.jsxs("div",{className:"playground-export-menu__content",children:[a.jsxs("span",{className:"playground-export-menu__title",children:[h," Recipe Report (PDF)"]}),a.jsx("span",{className:"playground-export-menu__desc",children:"TPV quantities & specifications"})]})]})]})]})}function J7({loadedDesign:t,onDesignSaved:e,isEmbedded:r=!1}){var As;const n=Dc(),{inputMode:i,prompt:o,lengthMM:s,widthMM:l,arMapping:c,uploadedFileUrl:d,result:h,jobId:f,blendRecipes:u,colorMapping:p,blendSvgUrl:g,blendEditedColors:m,solidRecipes:x,solidColorMapping:v,solidSvgUrl:y,solidEditedColors:b,viewMode:w,showFinalRecipes:k,showSolidSummary:S,regionOverrides:C,originalTaggedSvg:T,regionOverridesHistory:R,historyIndex:O,designName:Y,currentDesignId:E,hasUnsavedChanges:B,resetDesign:_}=n,V=n.setInputMode,re=n.setPrompt,I=n.setDimensions,q=n.setArMapping;n.setGenerationResult;const D=n.setResult,J=n.setJobId;n.setBlendState;const U=n.setBlendRecipes,G=n.setColorMapping,fe=n.setBlendSvgUrl;n.setSolidState;const oe=n.setSolidRecipes,ae=n.setSolidColorMapping,le=n.setSolidSvgUrl;n.updateBlendSvgUrl,n.updateSolidSvgUrl;const ce=n.setBlendEditedColors,be=n.setSolidEditedColors,Ce=n.setViewMode,ue=n.setShowFinalRecipes,de=n.setShowSolidSummary,ze=n.setRegionOverrides;n.addRegionOverride;const Ge=n.setOriginalTaggedSvg,j=n.setRegionOverridesHistory,ie=n.setHistoryIndex;n.canUndo,n.canRedo,n.undo,n.redo;const M=n.setDesignName,N=n.setCurrentDesignId,P=n.loadDesign,F=te=>I(te,s),X=te=>I(l,te),[K,L]=A.useState(null),[H,Z]=A.useState(null),[ee,z]=A.useState(!1),[Q,ne]=A.useState(!1),[ge,Se]=A.useState(null),[we,ke]=A.useState(null),[_e,Te]=A.useState(""),[We,Ue]=A.useState(null),[Je,Fe]=A.useState(!1),[je,Be]=A.useState(null),[Ve,qe]=A.useState(!1),[ft,Qt]=A.useState(null),[Qi,tl]=A.useState([]),[Ts,rl]=A.useState(!1),[Ct,En]=A.useState(!1),[cr,an]=A.useState(null),[Od,eo]=A.useState(!1),[nl,Rs]=A.useState(!1),[Ad,ui]=A.useState(!1),[wt,il]=A.useState(null),[Et,_r]=A.useState(!1),[pt,er]=A.useState(null),[Tn,$t]=A.useState(null),[ln,hi]=A.useState(null),[ol,to]=A.useState(null),Or=A.useRef(null);A.useEffect(()=>{(y||g)&&Or.current&&!Ct&&!Je&&setTimeout(()=>{var te;(te=Or.current)==null||te.scrollIntoView({behavior:"smooth",block:"start"})},300)},[y,g,Ct,Je]),A.useEffect(()=>{(async()=>{try{const se=await Lc({limit:1,offset:0});to(se.designs.length>0),console.log("[INSPIRE] Existing designs check:",se.designs.length>0?"User has designs":"No designs found")}catch(se){console.error("[INSPIRE] Failed to check for existing designs:",se),to(!0)}})()},[]),A.useEffect(()=>{i==="image"||i==="svg"?(I(null,null),console.log("[DIMENSION] Reset dimensions for upload mode:",i)):i==="prompt"&&(l===null||s===null)&&(I(5e3,5e3),console.log("[DIMENSION] Restored default dimensions for prompt mode"))},[i,I]),A.useEffect(()=>()=>{g&&g.startsWith("blob:")&&URL.revokeObjectURL(g),y&&y.startsWith("blob:")&&URL.revokeObjectURL(y)},[]),A.useEffect(()=>{const te=se=>{se.key==="Escape"&&Ve&&(qe(!1),Qt(null))};return window.addEventListener("keydown",te),()=>window.removeEventListener("keydown",te)},[Ve]),A.useEffect(()=>{Qi.length>0&&!Ts&&$d()},[Qi,Ts]),A.useEffect(()=>{if(t){console.log("[INSPIRE] Loading design data:",t);const te=af(t);console.log("[INSPIRE] Restored state:",te),P(te),t.name&&M(t.name),t.id&&N(t.id),console.log("[INSPIRE] Loaded design:",t.name),setTimeout(async()=>{var se;if((se=te.result)!=null&&se.svg_url){console.log("[INSPIRE] Regenerating SVGs from loaded design");let pe=null;try{const Ie=await(await fetch(te.result.svg_url)).text();pe=zu(Ie),Ge(pe),console.log("[INSPIRE] Tagged SVG with region IDs for loaded design")}catch(xe){console.error("[INSPIRE] Failed to tag SVG regions:",xe)}try{te.blendRecipes&&te.colorMapping&&await lo(te.result.svg_url,te.colorMapping,te.blendRecipes,te.blendEditedColors,pe),te.solidRecipes&&te.solidColorMapping&&await Os(te.result.svg_url,te.solidColorMapping,te.solidRecipes,te.solidEditedColors,pe)}catch(xe){console.error("[INSPIRE] Failed to regenerate SVGs:",xe),ke("Failed to restore design preview. Please try reloading.")}}},100)}},[t,P,M,N,Ge]);const Rn=A.useRef(!1);A.useEffect(()=>{if(t||Rn.current||!((h==null?void 0:h.svg_url)&&!g&&!y&&(u||x)))return;Rn.current=!0,console.log("[INSPIRE] Detected design loaded directly into store, regenerating SVGs..."),(async()=>{let pe=null;try{const Ie=await(await fetch(h.svg_url)).text();pe=zu(Ie),Ge(pe),console.log("[INSPIRE] Tagged SVG with region IDs")}catch(xe){console.error("[INSPIRE] Failed to tag SVG regions:",xe)}try{u&&p&&await lo(h.svg_url,p,u,m,pe),x&&v&&await Os(h.svg_url,v,x,b,pe)}catch(xe){console.error("[INSPIRE] Failed to regenerate SVGs:",xe),ke("Failed to restore design preview. Please try reloading.")}})()},[h,g,y,u,x,p,v,t]),A.useEffect(()=>{h||(Rn.current=!1)},[h]);const Kr=te=>{var Ie;const se=(Ie=te.target.files)==null?void 0:Ie[0];if(!se){L(null);return}const xe=sy(se,{maxSizeMB:10,allowedTypes:i==="image"?["image/png","image/jpeg"]:["image/svg+xml"]});if(!xe.valid){ke(xe.error),L(null);return}L(se),ke(null)},ro=te=>{te.preventDefault(),te.stopPropagation(),z(!0)},no=te=>{te.preventDefault(),te.stopPropagation(),te.currentTarget===te.target&&z(!1)},cn=te=>{te.preventDefault(),te.stopPropagation()},fi=te=>{te.preventDefault(),te.stopPropagation(),z(!1);const se=te.dataTransfer.files;if(se&&se.length>0){const pe=se[0],Ie=sy(pe,{maxSizeMB:10,allowedTypes:i==="image"?["image/png","image/jpeg"]:["image/svg+xml"]});if(!Ie.valid){ke(Ie.error),L(null);return}L(pe),ke(null)}},io=async()=>{var te,se;if(i==="prompt"&&!o.trim()){ke("Please enter a design description");return}if((i==="image"||i==="svg")&&!K){ke("Please select a file to upload");return}ke(null),ne(!0),Se(null),D(null),J(null),Te("Initialising..."),Ue(null);try{let pe;if(i==="svg"){Te("Uploading SVG file..."),Z("Uploading...");const Ae=await oy(K);if(!Ae.success)throw new Error(Ae.error||"Failed to upload file");if(Te("Processing SVG..."),Z(null),pe=await Si.processUploadedSVG({svg_url:Ae.url}),!pe.success)throw new Error(pe.error||"Failed to process SVG");J(pe.jobId),Te(" SVG uploaded successfully!"),ne(!1);const Re=await Si.getRecraftStatus(pe.jobId);Se(Re),D(Re.result),(te=Re.result)!=null&&te.svg_url&&await On(Re.result.svg_url,pe.jobId);return}if(i==="image"){Te("Uploading image..."),Z("Uploading...");const Ae=await oy(K);if(!Ae.success)throw new Error(Ae.error||"Failed to upload file");if(Te("Starting vectorisation..."),Z(null),pe=await Si.vectorizeImage({image_url:Ae.url}),!pe.success)throw new Error(pe.error||"Failed to start vectorisation");Te(" AI is vectorising your image...")}else{const Ae=K7(s,l);if(q(Ae),console.log("[TPV-STUDIO] AR Mapping:",Ae),console.log("[TPV-STUDIO] Layout:",Y7(Ae)),X7(Ae)?Te(`Generating ${Ae.canonical.name} design panel...`):Te("Initialising..."),pe=await Si.generateRecraft({prompt:o.trim(),lengthMM:Ae.recraft.height,widthMM:Ae.recraft.width}),!pe.success)throw new Error(pe.error||"Failed to start generation");Te(" AI is creating your design...")}J(pe.jobId),Te("Request submitted, waiting for processing...");let xe=null,Ie=Date.now();await Si.waitForRecraftCompletion(pe.jobId,Ae=>{var Ke,He;Se(Ae);const Re=Math.floor((Date.now()-Ie)/1e3);if(Ae.status==="queued"){const tt=[` Preparing your canvas... (${Re}s)`,` Warming up the AI brushes... (${Re}s)`,` Queueing your masterpiece... (${Re}s)`,` Mixing digital paints... (${Re}s)`,` AI is contemplating your vision... (${Re}s)`,` Selecting the perfect colours... (${Re}s)`,` Calculating vector paths... (${Re}s)`,` Almost ready to create... (${Re}s)`],Tt=Math.floor(Re/4)%tt.length;Te(tt[Tt])}else if(Ae.status==="running")if(xe!=="running")Te(" AI is creating your design..."),xe="running";else{const tt=[` Creating vector shapes... (${Re}s)`,` Applying colours and patterns... (${Re}s)`,` Refining design details... (${Re}s)`,` Finalising artwork... (${Re}s)`],Tt=Math.floor(Re/5)%tt.length;Te(tt[Tt])}else if(Ae.status==="retrying"){const tt=((Ke=Ae.recraft)==null?void 0:Ke.attempt_current)||0,Tt=((He=Ae.recraft)==null?void 0:He.attempt_max)||3;Te(` Retrying generation (attempt ${tt}/${Tt})...`)}});const $e=await Si.getRecraftStatus(pe.jobId);Se($e),D($e.result),$e.status==="completed"&&(Te(" Design ready!"),ne(!1),(se=$e.result)!=null&&se.svg_url&&await On($e.result.svg_url,pe.jobId))}catch(pe){console.error("Generation failed:",pe),ke(pe.message),Te(""),ne(!1)}},sl=()=>{const te=w==="solid"?y:g,se=w==="solid"?"tpv-solid":"tpv-blend";if(te){const pe=document.createElement("a");pe.href=te,pe.download=`${se}-${Date.now()}.svg`,document.body.appendChild(pe),pe.click(),document.body.removeChild(pe)}},pi=async te=>{try{const pe=await(await fetch(te)).text(),$e=new DOMParser().parseFromString(pe,"image/svg+xml").querySelector("svg");if(!$e)return null;let Ae,Re;const Ke=$e.getAttribute("viewBox");if(Ke){const tt=Ke.split(/\s+/).map(Number);Ae=tt[2],Re=tt[3]}else Ae=parseFloat($e.getAttribute("width"))||1024,Re=parseFloat($e.getAttribute("height"))||1024;const He=Ae/Re;return console.log(`[DIMENSION] Detected aspect ratio: ${He.toFixed(2)} (${Ae}${Re})`),He}catch(se){return console.error("[DIMENSION] Failed to detect aspect ratio:",se),null}},Md=(te,se)=>{console.log(`[DIMENSION] User confirmed dimensions: ${te}mm  ${se}mm`),F(te),X(se),hi({width:te,height:se}),Tn==="pdf"?setTimeout(()=>so(te,se),100):Tn==="tiles"?setTimeout(()=>gi(te,se),100):Tn==="insitu"?setTimeout(()=>ui(!0),100):Tn==="save"&&eo(!0),$t(null)},oo=async()=>{const te=w==="solid"?y:g;if((i==="image"||i==="svg")&&(!l||!s)){console.log("[DIMENSION] No dimensions set for image/SVG upload, showing modal...");const se=await pi(te);if(se){er(se),$t("insitu"),_r(!0);return}else{er(1),$t("insitu"),_r(!0);return}}ui(!0)},mi=()=>{const te=w==="solid"?y:g,se=w==="solid"?"tpv-solid":"tpv-blend";if(te){const pe=new Image;pe.onload=()=>{const xe=document.createElement("canvas");xe.width=pe.naturalWidth||1e3,xe.height=pe.naturalHeight||1e3,xe.getContext("2d").drawImage(pe,0,0),xe.toBlob($e=>{const Ae=URL.createObjectURL($e),Re=document.createElement("a");Re.href=Ae,Re.download=`${se}-${Date.now()}.png`,document.body.appendChild(Re),Re.click(),document.body.removeChild(Re),URL.revokeObjectURL(Ae)})},pe.src=te}},Nn=()=>{B()&&!window.confirm(`Start a new design?

You have unsaved changes that will be lost.`)||(_(),L(null),ne(!1),Se(null),ke(null),Te(""),Ue(null),Fe(!1),Be(null),qe(!1),Qt(null),En(!1),an(null))},Pn=async()=>{const te=w==="solid"?y:g,se=l>0&&s>0;if((i==="image"||i==="svg")&&!se){console.log("[DIMENSION] No dimensions set for image/SVG upload, showing modal before save...");const xe=await pi(te);if(xe){er(xe),$t("save"),_r(!0);return}else{er(1),$t("save"),_r(!0);return}}eo(!0)},[al,Ns]=A.useState(!1),ll=async()=>{const te=w==="solid"?y:g;if((i==="image"||i==="svg")&&(!l||!s)){console.log("[DIMENSION] No dimensions set for image/SVG upload, showing modal...");const se=await pi(te);if(se){er(se),$t("pdf"),_r(!0);return}else{er(1),$t("pdf"),_r(!0);return}}await so(l,s)},so=async(te,se)=>{const pe=w==="solid"?y:g,xe=w==="solid"?x:u,Ie=w==="solid"?"tpv-solid":"tpv-blend";if(!pe||!xe){ke("Cannot generate PDF: missing SVG or recipes");return}Ns(!0),ke(null);try{const Ae=await(await fetch(pe)).text(),Re=new AbortController,Ke=setTimeout(()=>Re.abort(),3e4),He=await Qr.getSession(),tt={"Content-Type":"application/json"};He!=null&&He.access_token&&(tt.Authorization=`Bearer ${He.access_token}`);const Tt=await fetch("/api/export-pdf",{method:"POST",headers:tt,signal:Re.signal,body:JSON.stringify({svgString:Ae,designName:Y||o||"TPV Design",projectName:"TPV Studio",dimensions:{widthMM:te,lengthMM:se},recipes:xe,mode:w,designId:f||""})});if(clearTimeout(Ke),!Tt.ok){const he=Tt.headers.get("content-type");if(he&&he.includes("application/json")){const Ne=await Tt.json();throw new Error(Ne.message||"PDF generation failed")}else{const Ne=await Tt.text();throw console.error("PDF API error response:",Ne),new Error(`Server error: ${Tt.status}`)}}const ct=await Tt.blob(),ve=URL.createObjectURL(ct),W=document.createElement("a");W.href=ve,W.download=`${Ie}-${Date.now()}.pdf`,document.body.appendChild(W),W.click(),document.body.removeChild(W),URL.revokeObjectURL(ve)}catch($e){console.error("PDF download error:",$e),$e.name==="AbortError"?ke("PDF generation timed out. Please try again."):ke(`PDF generation failed: ${$e.message}`)}finally{Ns(!1)}},cl=async()=>{const te=w==="solid"?y:g;if(!te){ke("No SVG available to slice");return}if((i==="image"||i==="svg")&&(!l||!s)){console.log("[DIMENSION] No dimensions set for image/SVG upload, showing modal...");const se=await pi(te);if(se){er(se),$t("tiles"),_r(!0);return}else{er(1),$t("tiles"),_r(!0);return}}await gi(l,s)},gi=async(te,se)=>{const pe=w==="solid"?y:g;try{await jE(pe,{width:te,length:se},Y||"tpv-design")}catch(xe){console.error("Tile download error:",xe),ke(`Failed to download tiles: ${xe.message}`)}},On=async(te=null,se=null)=>{const pe=te||(h==null?void 0:h.svg_url),xe=se||f;if(!pe){ke("No SVG available to analyse");return}fe(null),U(null),G(null),console.log("[TPV-STUDIO] Cleared old blend state, starting new blend generation"),ke(null),Te(" Extracting colours from design..."),await new Promise(Ie=>setTimeout(Ie,100));try{const Ie=await fetch("/api/blend-recipes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({svg_url:pe,job_id:xe,max_colors:15,max_components:2})}),$e=await Ie.json();if(!Ie.ok)throw new Error($e.error||"Failed to generate blend recipes");if($e.success){Te(" Matching TPV granule colours..."),await new Promise(Ke=>setTimeout(Ke,300)),U($e.recipes);const Ae=VC($e.recipes);console.log("[TPV-STUDIO] Color mapping built with",Ae.size,"entries:"),Array.from(Ae.entries()).forEach(([Ke,He])=>{console.log(`  ${Ke} -> ${He.blendHex}`)}),G(Ae);let Re=null;try{const He=await(await fetch(pe)).text();Re=zu(He),Ge(Re),console.log("[TPV-STUDIO] Tagged SVG with region IDs for per-element editing")}catch(Ke){console.error("[TPV-STUDIO] Failed to tag SVG regions:",Ke)}try{Te(" Generating TPV blend preview..."),await new Promise(tt=>setTimeout(tt,200)),console.log("[TPV-STUDIO] Generating recoloured SVG from:",pe),console.log("[TPV-STUDIO] Using mapping with",Ae.size,"colors");const{dataUrl:Ke,stats:He}=await Fn(pe,Ae,Re);fe(Ke),Te(" TPV blend ready!"),console.log("[TPV-STUDIO] Recolour stats:",{totalColors:He.totalColors,colorsReplaced:He.colorsReplaced,colorsNotMapped:Array.from(He.colorsNotMapped)}),He.colorsNotMapped.size>0&&console.warn("[TPV-STUDIO] Some colors were not mapped:",Array.from(He.colorsNotMapped)),Ps(pe,xe,Re)}catch(Ke){console.error("[TPV-STUDIO] Failed to generate recoloured SVG:",Ke),ke(`Recipes generated successfully, but SVG recolouring failed: ${Ke.message}`)}}else throw new Error($e.error||"Unknown error generating recipes")}catch(Ie){console.error("Blend generation failed:",Ie),ke(Ie.message),Te("")}},Sr=async()=>{Fe(!1),Be(null),En(!1),an(null),w==="solid"?be(new Map):ce(new Map),h!=null&&h.svg_url&&await On(h.svg_url,f)},An=async te=>{var se;if(!Y){if(!o||i!=="prompt"){K&&M(`TPV Design  ${K.name.replace(/\.[^/.]+$/,"")}`);return}Rs(!0);try{const pe=(te==null?void 0:te.slice(0,6).map(Ie=>{var Ae,Re;const $e=(Re=(Ae=Ie.chosenRecipe)==null?void 0:Ae.components)==null?void 0:Re[0];return($e==null?void 0:$e.name)||null}).filter(Boolean))||[],xe=await Si.generateDesignName({prompt:o,colors:pe,dimensions:{widthMM:l,lengthMM:s}});xe.success&&((se=xe.names)==null?void 0:se.length)>0?M(xe.names[0]):M(ao(o))}catch(pe){console.error("[TPV-STUDIO] Name generation failed:",pe),M(ao(o))}finally{Rs(!1)}}},ao=te=>te?`TPV Design  ${te.split(/[,.]/)[0].trim().slice(0,40)}`:"TPV Playground Design",Ps=async(te=null,se=null,pe=null)=>{const xe=te||(h==null?void 0:h.svg_url),Ie=se||f,$e=pe||T;if(xe)try{console.log("[TPV-STUDIO] Generating solid color version...");const Ae=await fetch("/api/solid-recipes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({svg_url:xe,job_id:Ie,max_colors:15})}),Re=await Ae.json();if(!Ae.ok)throw new Error(Re.error||"Failed to generate solid recipes");if(Re.success){oe(Re.recipes);const Ke=new Map(Object.entries(Re.colorMapping||{}));console.log("[TPV-STUDIO] Using API colorMapping with",Ke.size,"entries"),ae(Ke);try{const{dataUrl:He,stats:tt}=await Fn(xe,Ke,$e);le(He),console.log("[TPV-STUDIO] Solid color SVG generated:",tt),tt.colorsNotMapped&&tt.colorsNotMapped.size>0&&console.warn("[TPV-STUDIO] Unmapped colors in solid mode:",Array.from(tt.colorsNotMapped)),An(Re.recipes)}catch(He){console.error("[TPV-STUDIO] Failed to generate solid SVG:",He)}}}catch(Ae){console.error("[TPV-STUDIO] Solid generation failed:",Ae)}},dl=(te,se="palette")=>{if(console.log("[TPV-STUDIO] Color clicked:",te,"source:",se,"in mode:",w),Ve&&ft&&se==="palette"){yi(ft.regionId,te.hex),qe(!1),Qt(null);return}se==="palette"&&(w==="blend"?(an(te),En(!0),ue(!1)):(Be(te),Fe(!0),de(!1)))},vi=te=>{console.log("[TPV-STUDIO] Region clicked:",te),Ve?(yi(ft.regionId,te.sourceColor),qe(!1),Qt(null)):(qe(!0),Qt(te))},yi=(te,se)=>{console.log("[TPV-STUDIO] Queuing region recolor:",te,"->",se),tl(pe=>[...pe,{regionId:te,newHex:se.toLowerCase(),viewMode:w}])},$d=async()=>{if(Ts||Qi.length===0)return;rl(!0);const te=Qi[0];console.log("[TPV-STUDIO] Processing queued region recolor:",te.regionId,"->",te.newHex);try{const se=new Map(C);se.set(te.regionId,te.newHex),te.viewMode==="blend"?await xi(null,null,se):await bi(null,null,se),ze(se);const pe=n.historyIndex,Ie=n.regionOverridesHistory.slice(0,pe+1);Ie.push(new Map(se)),Ie.length>50&&Ie.shift(),j(Ie),ie(Ie.length-1),console.log("[TPV-STUDIO] Completed region recolor for:",te.regionId)}catch(se){console.error("[TPV-STUDIO] Failed to process region recolor:",se)}finally{tl(se=>se.slice(1)),rl(!1)}},Mn=()=>{console.log("[TPV-STUDIO] Eyedropper cancelled"),qe(!1),Qt(null)},ul=async()=>{if(O<=0)return;const te=O-1,se=R[te];console.log("[TPV-STUDIO] Undoing region override to index:",te),ze(new Map(se)),ie(te),w==="blend"?await xi(null,null,se):await bi(null,null,se)},hl=async()=>{if(O>=R.length-1)return;const te=O+1,se=R[te];console.log("[TPV-STUDIO] Redoing region override to index:",te),ze(new Map(se)),ie(te),w==="blend"?await xi(null,null,se):await bi(null,null,se)},_t=async te=>{if(je)if(console.log("[TPV-STUDIO] Color changed:",je.hex,"->",te,"in mode:",w),w==="solid"){const se=new Map(b),pe=x.find(Ie=>Ie.targetColor.hex.toLowerCase()===je.hex.toLowerCase()),xe=(pe==null?void 0:pe.mergedOriginalColors)||[je.originalHex.toLowerCase()];console.log("[TPV-STUDIO] Updating",xe.length,"merged colors:",xe),xe.forEach(Ie=>{se.set(Ie,{newHex:te.toLowerCase()})}),be(se),Be({...je,hex:te,blendHex:te}),await bi(se,te)}else{const se=new Map(m);se.set(je.originalHex.toLowerCase(),{newHex:te.toLowerCase()}),ce(se),Be({...je,hex:te,blendHex:te}),await xi(se,te)}},$n=A.useCallback(async({blendHex:te,parts:se,recipe:pe})=>{if(!cr)return;console.log("[TPV-STUDIO] Mixer blend changed:",cr.originalHex,"->",te,"recipe:",pe);const xe=new Map(m);xe.set(cr.originalHex.toLowerCase(),{newHex:te.toLowerCase(),recipe:pe,parts:se}),ce(xe),an({...cr,hex:te,blendHex:te}),await xi(xe,te)},[cr,m,h,p]),xi=async(te=null,se=null,pe=null)=>{if(!(!(h!=null&&h.svg_url)||!p||!u))try{const xe=new Map(p),Ie=te||m;Ie.forEach((ct,ve)=>{if(ct.newHex){const W=ve.toLowerCase();xe.set(W,{...xe.get(W),blendHex:ct.newHex})}});const $e=u.map(ct=>{const ve=Ie.get(ct.originalColor.hex.toLowerCase());if(ve!=null&&ve.newHex){const W={...ct,targetColor:{...ct.targetColor,hex:ve.newHex},blendColor:{...ct.blendColor,hex:ve.newHex}};return ve.recipe&&ve.recipe.components&&(W.chosenRecipe={...ct.chosenRecipe,components:ve.recipe.components,deltaE:0,quality:"Excellent"}),W}return ct}),{svgText:Ae,stats:Re}=await Fn(h.svg_url,xe,T),Ke=pe!==null?pe:C,He=ny(Ae,Ke);g&&g.startsWith("blob:")&&(URL.revokeObjectURL(g),console.log("[TPV-STUDIO] Revoked old blend blob URL"));const tt=new Blob([He],{type:"image/svg+xml"}),Tt=URL.createObjectURL(tt);console.log("[TPV-STUDIO] Created new blend blob URL, SVG length:",He.length),fe(Tt),G(xe),U($e),console.log("[TPV-STUDIO] Blend SVG regenerated with edits:",Re),Ke.size>0&&console.log("[TPV-STUDIO] Applied",Ke.size,"region overrides")}catch(xe){console.error("[TPV-STUDIO] Failed to regenerate blend SVG:",xe)}},bi=async(te=null,se=null,pe=null)=>{if(!(!(h!=null&&h.svg_url)||!v||!x))try{const xe=new Map(v),Ie=te||b;Ie.forEach((ct,ve)=>{if(ct.newHex){const W=ve.toLowerCase();xe.set(W,{...xe.get(W),blendHex:ct.newHex})}});const $e=x.map(ct=>{const ve=Ie.get(ct.originalColor.hex.toLowerCase());if(ve!=null&&ve.newHex){const W=nn.find(he=>he.hex.toLowerCase()===ve.newHex.toLowerCase());return W?{...ct,targetColor:{...ct.targetColor,hex:ve.newHex},blendColor:{hex:ve.newHex,rgb:W.rgb,lab:W.lab},chosenRecipe:{components:[{code:W.code,name:W.name,hex:W.hex,rgb:W.rgb,lab:W.lab,ratio:1}],blendColor:{hex:W.hex,rgb:W.rgb,lab:W.lab},deltaE:0,quality:"Perfect"}}:{...ct,targetColor:{...ct.targetColor,hex:ve.newHex},blendColor:{...ct.blendColor,hex:ve.newHex}}}return ct}),{svgText:Ae,stats:Re}=await Fn(h.svg_url,xe,T),Ke=pe!==null?pe:C,He=ny(Ae,Ke);y&&y.startsWith("blob:")&&(URL.revokeObjectURL(y),console.log("[TPV-STUDIO] Revoked old solid blob URL"));const tt=new Blob([He],{type:"image/svg+xml"}),Tt=URL.createObjectURL(tt);console.log("[TPV-STUDIO] Created new solid blob URL, SVG length:",He.length),le(Tt),ae(xe),oe($e),console.log("[TPV-STUDIO] Solid SVG regenerated with edits:",Re),Ke.size>0&&console.log("[TPV-STUDIO] Applied",Ke.size,"region overrides")}catch(xe){console.error("[TPV-STUDIO] Failed to regenerate solid SVG:",xe)}},lo=async(te,se,pe,xe,Ie=null)=>{try{console.log("[INSPIRE] Regenerating blend SVG from state");const $e=new Map(se);xe&&xe.size>0&&xe.forEach((Re,Ke)=>{const He=Ke.toLowerCase();$e.has(He)&&$e.set(He,{...$e.get(He),blendHex:Re.newHex})});const{dataUrl:Ae}=await Fn(te,$e,Ie);fe(Ae),console.log("[INSPIRE] Blend SVG regenerated")}catch($e){console.error("[INSPIRE] Failed to regenerate blend SVG:",$e)}},Os=async(te,se,pe,xe,Ie=null)=>{try{console.log("[INSPIRE] Regenerating solid SVG from state");const $e=new Map(se);xe&&xe.size>0&&xe.forEach((Re,Ke)=>{const He=Ke.toLowerCase();$e.has(He)&&$e.set(He,{...$e.get(He),blendHex:Re.newHex})});const{dataUrl:Ae}=await Fn(te,$e,Ie);le(Ae),console.log("[INSPIRE] Solid SVG regenerated")}catch($e){console.error("[INSPIRE] Failed to regenerate solid SVG:",$e)}};return a.jsxs("div",{className:`inspire-panel-recraft${r?" inspire-panel-recraft--embedded":""}`,children:[!r&&a.jsxs("div",{className:"panel-header",children:[a.jsx("h2",{children:"TPV Studio - Vector AI"}),a.jsx("p",{className:"subtitle",children:"AI-powered vector designs for playground surfacing"})]}),!h&&!Q&&ol===!1&&a.jsxs("div",{className:"welcome-guidance",children:[a.jsx("div",{className:"welcome-icon",children:""}),a.jsx("h3",{children:"Create Your First Design"}),a.jsx("p",{children:"Choose how you'd like to create your TPV design below. You can describe what you want, upload an image to convert, or process an existing SVG file. Once generated, you'll be able to edit colours, export PDFs with specifications, and preview designs on-site."})]}),a.jsxs("div",{className:"input-mode-tabs",children:[a.jsxs("button",{className:`input-mode-tab ${i==="prompt"?"active":""}`,onClick:()=>{V("prompt"),L(null),ke(null)},disabled:Q,children:[a.jsxs("svg",{className:"mode-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M12 3l1.545 4.635L18.18 9.18l-4.635 1.545L12 15.36l-1.545-4.635L5.82 9.18l4.635-1.545L12 3z"}),a.jsx("path",{d:"M5 21l1.5-4.5L2 15l4.5-1.5L8 9l1.5 4.5L14 15l-4.5 1.5L8 21z",opacity:"0.5"})]}),a.jsx("span",{className:"mode-title",children:"Text Prompt"}),a.jsx("span",{className:"mode-description",children:"Describe your design"})]}),a.jsxs("button",{className:`input-mode-tab ${i==="image"?"active":""}`,onClick:()=>{V("image"),re(""),ke(null)},disabled:Q,children:[a.jsxs("svg",{className:"mode-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]}),a.jsx("span",{className:"mode-title",children:"Upload Image"}),a.jsx("span",{className:"mode-description",children:"Vectorise PNG/JPG"})]}),a.jsxs("button",{className:`input-mode-tab ${i==="svg"?"active":""}`,onClick:()=>{V("svg"),re(""),ke(null)},disabled:Q,children:[a.jsx("svg",{className:"mode-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),a.jsx("span",{className:"mode-title",children:"Upload SVG"}),a.jsx("span",{className:"mode-description",children:"Process existing vector"})]})]}),a.jsxs("div",{className:"form-section",children:[i==="prompt"&&a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"prompt",children:"Design Description"}),a.jsx("textarea",{id:"prompt",value:o,onChange:te=>re(te.target.value),placeholder:"e.g., calm ocean theme with big fish silhouettes and waves",rows:4,disabled:Q,className:"prompt-input"}),a.jsx("p",{className:"helper-text",children:"Describe the design you want to generate. The AI will create a vector illustration based on your description. Perfect for creating completely new designs from scratch - just describe colors, themes, and elements you want."})]}),i==="image"&&a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"image-upload",children:"Upload Image (PNG/JPG)"}),a.jsxs("div",{className:`drop-zone ${ee?"dragging":""} ${K?"has-file":""}`,onDragEnter:ro,onDragLeave:no,onDragOver:cn,onDrop:fi,children:[a.jsx("input",{id:"image-upload",type:"file",accept:"image/png,image/jpeg",onChange:Kr,disabled:Q,className:"file-input-hidden"}),a.jsx("label",{htmlFor:"image-upload",className:"drop-zone-content",children:K?a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"upload-icon success",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),a.jsx("span",{className:"file-name",children:K.name}),a.jsx("span",{className:"drop-hint",children:"Click to change file"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"upload-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),a.jsx("polyline",{points:"17 8 12 3 7 8"}),a.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]}),a.jsx("span",{className:"drop-text",children:"Drag & drop your image here"}),a.jsx("span",{className:"drop-hint",children:"or click to browse"})]})})]}),a.jsx("p",{className:"helper-text",children:"Upload a raster image (PNG or JPG). The AI will convert it to vector format (SVG) suitable for TPV surfacing. Best for converting photos, logos, or artwork into clean vectors that can be manufactured with TPV granules."})]}),i==="svg"&&a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"svg-upload",children:"Upload SVG File"}),a.jsxs("div",{className:`drop-zone ${ee?"dragging":""} ${K?"has-file":""}`,onDragEnter:ro,onDragLeave:no,onDragOver:cn,onDrop:fi,children:[a.jsx("input",{id:"svg-upload",type:"file",accept:"image/svg+xml",onChange:Kr,disabled:Q,className:"file-input-hidden"}),a.jsx("label",{htmlFor:"svg-upload",className:"drop-zone-content",children:K?a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"upload-icon success",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),a.jsx("span",{className:"file-name",children:K.name}),a.jsx("span",{className:"drop-hint",children:"Click to change file"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"upload-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),a.jsx("polyline",{points:"17 8 12 3 7 8"}),a.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]}),a.jsx("span",{className:"drop-text",children:"Drag & drop your SVG here"}),a.jsx("span",{className:"drop-hint",children:"or click to browse"})]})})]}),a.jsx("p",{className:"helper-text",children:"Upload an existing SVG vector file. It will be processed immediately for TPV colour matching - no AI generation needed. Ideal when you already have a vector design and just need to match colors to available TPV granules."})]}),i==="prompt"&&a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"length",children:"Length (mm)"}),a.jsx("input",{id:"length",type:"number",value:s,onChange:te=>X(parseInt(te.target.value,10)),min:1e3,max:2e4,step:100,disabled:Q})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"width",children:"Width (mm)"}),a.jsx("input",{id:"width",type:"number",value:l,onChange:te=>F(parseInt(te.target.value,10)),min:1e3,max:2e4,step:100,disabled:Q})]})]}),we&&a.jsxs("div",{className:"error-message",children:[a.jsx("strong",{children:"Error:"})," ",we]}),H&&a.jsx("div",{className:"upload-progress",children:a.jsx("p",{children:H})}),a.jsx("button",{onClick:io,disabled:Q||i==="prompt"&&!o.trim()||(i==="image"||i==="svg")&&!K,className:"generate-button",children:Q?i==="svg"?"Processing...":"Generating...":i==="prompt"?"Generate Vector Design":i==="image"?"Vectorise & Process":"Process SVG"})]}),Q&&a.jsxs("div",{className:"progress-section",children:[a.jsx("div",{className:"progress-bar",children:a.jsx("div",{className:"progress-bar-fill"})}),a.jsx("p",{className:"progress-message",children:_e})]}),h&&!Q&&a.jsxs("div",{className:"results-section",children:[c&&a.jsxs("div",{className:`ar-info ${c.layout.mode}`,children:[a.jsxs("div",{className:"ar-info-header",children:[a.jsx("strong",{children:"Layout:"})," ",c.layout.reason]}),a.jsxs("div",{className:"ar-info-details",children:[a.jsxs("span",{children:["Requested: ",c.user.formatted]}),a.jsx("span",{children:""}),a.jsxs("span",{children:["Generated: ",c.canonical.name," panel"]}),c.layout.mode==="framing"&&a.jsxs(a.Fragment,{children:[a.jsx("span",{children:""}),a.jsx("span",{className:"layout-note",children:"Panel centred with base colour surround"})]}),c.layout.mode==="tiling"&&a.jsxs(a.Fragment,{children:[a.jsx("span",{children:""}),a.jsx("span",{className:"layout-note",children:"Pattern will repeat along length"})]})]})]}),g&&u&&a.jsxs("div",{className:"mode-tabs",children:[a.jsxs("button",{className:`mode-tab ${w==="solid"?"active":""}`,onClick:()=>Ce("solid"),disabled:!y,children:[a.jsx("span",{className:"mode-title",children:"Solid Mode"}),a.jsx("span",{className:"mode-description",children:y?"Single TPV colours only":"Generating..."})]}),a.jsxs("button",{className:`mode-tab ${w==="blend"?"active":""}`,onClick:()=>Ce("blend"),children:[a.jsx("span",{className:"mode-title",children:"Blend Mode"}),a.jsx("span",{className:"mode-description",children:"Advanced: Mixed granules"})]})]}),w==="blend"&&g&&u&&a.jsx("div",{ref:Or,children:a.jsx(g0,{blendSvgUrl:g,recipes:u,mode:"blend",onColorClick:dl,onRegionClick:vi,onEyedropperCancel:Mn,selectedColor:je,editedColors:m,onResetAll:Sr,designName:Y,onNameChange:M,isNameLoading:nl,onInSituClick:oo,eyedropperActive:Ve,eyedropperRegion:ft,onRegionUndo:ul,onRegionRedo:hl,canUndo:O>0,canRedo:O<R.length-1,regionOverridesCount:C.size})}),w==="solid"&&y&&x&&a.jsx("div",{ref:Or,children:a.jsx(g0,{blendSvgUrl:y,recipes:x,mode:"solid",onColorClick:dl,onRegionClick:vi,onEyedropperCancel:Mn,selectedColor:je,editedColors:b,onResetAll:Sr,designName:Y,onNameChange:M,isNameLoading:nl,onInSituClick:oo,eyedropperActive:Ve,eyedropperRegion:ft,onRegionUndo:ul,onRegionRedo:hl,canUndo:O>0,canRedo:O<R.length-1,regionOverridesCount:C.size})}),Ct&&cr&&a.jsxs("div",{className:"mixer-widget-container",children:[a.jsx("div",{className:"mixer-widget-header",children:a.jsx("button",{className:"mixer-close-btn",onClick:()=>{En(!1),an(null)},children:"Close Mixer"})}),a.jsx(C7,{initialRecipe:((As=m.get(cr.originalHex.toLowerCase()))==null?void 0:As.recipe)||cr.recipe||null,onBlendChange:$n,originalColor:cr.originalHex})]}),g&&a.jsxs("div",{className:"action-bar",children:[a.jsxs("button",{className:"action-bar__btn action-bar__btn--secondary",onClick:Nn,title:"Start a new design",children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 5v14M5 12h14"})}),"New"]}),a.jsxs("button",{className:"action-bar__btn action-bar__btn--primary",onClick:Pn,title:"Save this design to your gallery",children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z"}),a.jsx("polyline",{points:"17 21 17 13 7 13 7 21"}),a.jsx("polyline",{points:"7 3 7 8 15 8"})]}),"Save"]}),a.jsx(Z7,{onExportSVG:sl,onExportPNG:mi,onExportPDF:ll,onExportTiles:cl,viewMode:w,exporting:al,disabled:!g})]})]}),w==="blend"&&g&&u&&!k&&a.jsxs("div",{className:"finalize-section",children:[a.jsx("button",{onClick:()=>ue(!0),className:"finalize-button",children:"View Recipe Details"}),a.jsx("p",{className:"finalize-hint",children:"Click to see detailed blend formulas and quality metrics"})]}),w==="solid"&&y&&x&&!S&&a.jsxs("div",{className:"finalize-section",children:[a.jsx("button",{onClick:()=>de(!0),className:"finalize-button",children:"View TPV Colours Used"}),a.jsx("p",{className:"finalize-hint",children:"See which pure TPV colours are used in this design"})]}),k&&u&&a.jsx(NE,{recipes:u,onClose:()=>{ue(!1)}}),S&&x&&a.jsx(PE,{recipes:x,onClose:()=>{de(!1)}}),Je&&je&&a.jsx(GB,{color:je,mode:w,onColorChange:_t,onClose:()=>{Fe(!1),Be(null)}}),Od&&a.jsx(T7,{currentState:{inputMode:i,prompt:o,selectedFile:K,lengthMM:(ln==null?void 0:ln.height)||s,widthMM:(ln==null?void 0:ln.width)||l,result:h,viewMode:w,blendRecipes:u,solidRecipes:x,colorMapping:p,solidColorMapping:v,solidEditedColors:b,blendEditedColors:m,blendSvgUrl:g,solidSvgUrl:y,arMapping:c,jobId:f,inSituData:wt},existingDesignId:E,initialName:Y,onClose:()=>{eo(!1),hi(null)},onSaved:(te,se)=>{eo(!1),hi(null),to(!0),se&&M(se),e&&e(se),console.log("[INSPIRE] Design saved:",te)}}),Ad&&a.jsx(i_,{designUrl:w==="solid"?y:g,designDimensions:{width:l,length:s},onClose:()=>ui(!1),onSaved:te=>{console.log("[INSPIRE] In-situ preview saved:",te),il(te),ui(!1)}}),a.jsx(U7,{isOpen:Et,onClose:()=>{_r(!1),$t(null)},onConfirm:Md,aspectRatio:pt,defaultLongestSide:5e3}),a.jsx("style",{jsx:!0,children:`
        .inspire-panel-recraft {
          max-width: var(--max-width-xl);
          margin: 0 auto;
          padding: var(--space-4);
        }

        .panel-header {
          text-align: center;
          margin-bottom: var(--space-6);
        }

        .panel-header h2 {
          font-family: var(--font-heading);
          font-size: var(--text-3xl);
          margin: 0 0 var(--space-2) 0;
          color: var(--color-primary);
          font-weight: var(--font-bold);
          letter-spacing: var(--tracking-tight);
        }

        .subtitle {
          color: var(--color-text-secondary);
          font-size: var(--text-base);
          line-height: var(--leading-relaxed);
        }

        /* Welcome Guidance */
        .welcome-guidance {
          background: linear-gradient(135deg, #fff5f0 0%, #fff9f7 100%);
          border: 2px solid #ff6b35;
          border-radius: var(--radius-lg);
          padding: var(--space-6);
          margin-bottom: var(--space-6);
          text-align: center;
        }

        .welcome-icon {
          font-size: 3rem;
          margin-bottom: var(--space-2);
        }

        .welcome-guidance h3 {
          margin: 0 0 var(--space-3);
          font-size: var(--text-xl);
          font-weight: var(--font-bold);
          color: var(--color-primary);
        }

        .welcome-guidance p {
          margin: 0;
          color: var(--color-text-secondary);
          font-size: var(--text-base);
          line-height: var(--leading-relaxed);
          max-width: 600px;
          margin-left: auto;
          margin-right: auto;
        }

        /* Input Mode Tabs - Enhanced cards */
        .input-mode-tabs {
          display: flex;
          gap: var(--space-2);
          margin-bottom: var(--space-4);
          background: var(--color-bg-subtle);
          padding: var(--space-1);
          border-radius: var(--radius-lg);
        }

        .input-mode-tab {
          flex: 1;
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: var(--space-2);
          padding: var(--space-4);
          background: var(--color-bg-card);
          border: 1px solid var(--color-border);
          border-radius: var(--radius-md);
          cursor: pointer;
          transition: all var(--transition-base);
        }

        .input-mode-tab:hover:not(:disabled) {
          border-color: var(--color-primary);
          transform: translateY(-2px);
          box-shadow: var(--shadow-md);
        }

        .input-mode-tab.active {
          background: linear-gradient(135deg, var(--color-bg-subtle) 0%, var(--color-bg-card) 100%);
          border-color: var(--color-primary);
          box-shadow: var(--shadow-glow);
        }

        .input-mode-tab:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .mode-icon {
          width: 32px;
          height: 32px;
          color: var(--color-text-secondary);
          transition: all var(--transition-base);
        }

        .input-mode-tab:hover:not(:disabled) .mode-icon {
          color: var(--color-primary);
          transform: scale(1.1);
        }

        .input-mode-tab.active .mode-icon {
          color: var(--color-primary);
        }

        .input-mode-tab .mode-title {
          font-family: var(--font-heading);
          font-size: var(--text-base);
          font-weight: var(--font-semibold);
          color: var(--color-text-primary);
          margin-top: var(--space-1);
        }

        .input-mode-tab .mode-description {
          font-size: var(--text-sm);
          color: var(--color-text-secondary);
          text-align: center;
          line-height: var(--leading-snug);
        }

        .input-mode-tab.active .mode-title {
          color: var(--color-primary);
          font-weight: var(--font-bold);
        }

        /* Helper text */
        .helper-text {
          margin-top: var(--space-1);
          font-size: var(--text-sm);
          color: var(--color-text-tertiary);
          font-style: normal;
          line-height: var(--leading-snug);
        }

        /* Drag & Drop File Upload */
        .file-input-hidden {
          position: absolute;
          width: 1px;
          height: 1px;
          padding: 0;
          margin: -1px;
          overflow: hidden;
          clip: rect(0, 0, 0, 0);
          white-space: nowrap;
          border: 0;
        }

        .drop-zone {
          position: relative;
          width: 100%;
          min-height: 180px;
          border: 2px dashed var(--color-border);
          border-radius: var(--radius-lg);
          background: var(--color-bg-subtle);
          transition: all var(--transition-base);
        }

        .drop-zone.dragging {
          border-color: var(--color-primary);
          background: var(--color-primary-light);
          background: linear-gradient(135deg, rgba(30, 74, 122, 0.05) 0%, rgba(30, 74, 122, 0.1) 100%);
          box-shadow: var(--shadow-glow);
        }

        .drop-zone.has-file {
          border-color: var(--color-success);
          background: var(--color-success-light);
        }

        .drop-zone-content {
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          gap: var(--space-2);
          padding: var(--space-6);
          cursor: pointer;
          min-height: 180px;
        }

        .upload-icon {
          width: 48px;
          height: 48px;
          color: var(--color-text-secondary);
          transition: all var(--transition-base);
        }

        .upload-icon.success {
          color: var(--color-success);
        }

        .drop-zone:hover .upload-icon {
          color: var(--color-primary);
          transform: scale(1.1);
        }

        .drop-zone.has-file:hover .upload-icon.success {
          color: var(--color-success);
        }

        .drop-text {
          font-size: var(--text-base);
          font-weight: var(--font-semibold);
          color: var(--color-text-primary);
        }

        .file-name {
          font-size: var(--text-base);
          font-weight: var(--font-semibold);
          color: var(--color-success);
          max-width: 100%;
          overflow: hidden;
          text-overflow: ellipsis;
          white-space: nowrap;
        }

        .drop-hint {
          font-size: var(--text-sm);
          color: var(--color-text-tertiary);
        }

        .drop-zone.dragging .drop-text,
        .drop-zone.dragging .drop-hint {
          color: var(--color-primary);
        }

        .upload-progress {
          padding: var(--space-2);
          background: var(--color-info-light);
          border: 1px solid var(--color-info);
          border-radius: var(--radius-md);
          color: var(--color-info);
          margin-bottom: var(--space-2);
          text-align: center;
          font-size: var(--text-sm);
        }

        .form-section {
          background: var(--color-bg-card);
          padding: var(--space-4);
          border-radius: var(--radius-lg);
          margin-bottom: var(--space-4);
          border: 1px solid var(--color-border);
          box-shadow: var(--shadow-xs);
        }

        .form-group {
          margin-bottom: var(--space-4);
        }

        .form-group label {
          display: block;
          margin-bottom: var(--space-2);
          font-weight: var(--font-semibold);
          color: var(--color-text-primary);
          font-size: var(--text-sm);
        }

        .prompt-input {
          width: 100%;
          padding: var(--space-3);
          border: 1px solid var(--color-border);
          border-radius: var(--radius-md);
          font-family: inherit;
          font-size: var(--text-base);
          background: var(--color-bg-card);
          color: var(--color-text-primary);
          transition: border-color var(--transition-base);
        }

        .prompt-input:focus {
          outline: none;
          border-color: var(--color-primary);
          box-shadow: var(--shadow-glow);
        }

        .form-row {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: var(--space-3);
        }

        input[type="number"] {
          width: 100%;
          padding: var(--space-2);
          border: 1px solid var(--color-border);
          border-radius: var(--radius-md);
          background: var(--color-bg-card);
          color: var(--color-text-primary);
          font-size: var(--text-base);
          transition: border-color var(--transition-base);
        }

        input[type="number"]:focus {
          outline: none;
          border-color: var(--color-primary);
          box-shadow: var(--shadow-glow);
        }

        .error-message {
          padding: var(--space-3);
          background: var(--color-error-light);
          border: 1px solid var(--color-error);
          border-radius: var(--radius-md);
          color: var(--color-error);
          margin-bottom: var(--space-4);
          font-size: var(--text-sm);
        }

        .generate-button {
          width: 100%;
          padding: var(--space-4);
          background: var(--color-accent);
          color: white;
          border: none;
          border-radius: var(--radius-md);
          font-size: var(--text-lg);
          font-weight: var(--font-semibold);
          cursor: pointer;
          transition: all var(--transition-base);
          box-shadow: var(--shadow-sm);
        }

        .generate-button:hover:not(:disabled) {
          background: var(--color-accent-hover);
          transform: translateY(-2px);
          box-shadow: 0 8px 24px rgba(255, 107, 53, 0.3);
        }

        .generate-button:disabled {
          background: var(--color-bg-subtle);
          color: var(--color-text-tertiary);
          cursor: not-allowed;
          transform: none;
          box-shadow: none;
        }

        .progress-section {
          padding: var(--space-4);
          background: var(--color-info-light);
          border-radius: var(--radius-lg);
          margin-bottom: var(--space-4);
          border: 1px solid var(--color-info);
        }

        .progress-bar {
          height: 4px;
          background: var(--color-border);
          border-radius: var(--radius-full);
          overflow: hidden;
          margin-bottom: var(--space-3);
        }

        .progress-bar-fill {
          height: 100%;
          background: var(--color-accent);
          animation: progress 2s ease-in-out infinite;
        }

        @keyframes progress {
          0% { transform: translateX(-100%); }
          100% { transform: translateX(100%); }
        }

        .progress-message {
          text-align: center;
          color: var(--color-text-secondary);
          font-weight: var(--font-medium);
          font-size: var(--text-base);
        }

        .results-section {
          background: var(--color-bg-card);
          padding: var(--space-4);
          border-radius: var(--radius-lg);
          border: 1px solid var(--color-border);
          box-shadow: var(--shadow-sm);
        }

        .results-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: var(--space-3);
        }

        .results-header h3 {
          font-family: var(--font-heading);
          margin: 0;
          color: var(--color-primary);
          font-size: var(--text-xl);
          font-weight: var(--font-bold);
        }

        /* Aspect Ratio Info */
        .ar-info {
          padding: var(--space-3) var(--space-4);
          border-radius: var(--radius-md);
          margin-bottom: var(--space-3);
          font-size: var(--text-sm);
        }

        .ar-info.full {
          background: var(--color-success-light);
          border: 1px solid var(--color-success);
        }

        .ar-info.framing {
          background: var(--color-warning-light);
          border: 1px solid var(--color-warning);
        }

        .ar-info.tiling {
          background: var(--color-info-light);
          border: 1px solid var(--color-info);
        }

        .ar-info-header {
          color: var(--color-text-primary);
          margin-bottom: var(--space-2);
          font-weight: var(--font-semibold);
        }

        .ar-info-details {
          display: flex;
          flex-wrap: wrap;
          gap: var(--space-2);
          align-items: center;
          color: var(--color-text-secondary);
          font-size: var(--text-sm);
        }

        .ar-info-details span {
          white-space: nowrap;
        }

        .layout-note {
          color: var(--color-accent);
          font-weight: var(--font-medium);
        }

        /* Mode Toggle Tabs */
        .mode-tabs {
          display: flex;
          gap: var(--space-2);
          margin-bottom: var(--space-4);
          background: var(--color-bg-subtle);
          padding: var(--space-1);
          border-radius: var(--radius-lg);
        }

        .mode-tab {
          flex: 1;
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: var(--space-1);
          padding: var(--space-3);
          background: var(--color-bg-card);
          border: 1px solid var(--color-border);
          border-radius: var(--radius-md);
          cursor: pointer;
          transition: all var(--transition-base);
        }

        .mode-tab:hover:not(:disabled) {
          border-color: var(--color-accent);
          transform: translateY(-2px);
          box-shadow: var(--shadow-md);
        }

        .mode-tab.active {
          background: var(--color-accent);
          border-color: var(--color-accent);
          box-shadow: var(--shadow-glow-accent);
        }

        .mode-tab:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .mode-title {
          font-family: var(--font-heading);
          font-size: var(--text-base);
          font-weight: var(--font-semibold);
          color: var(--color-primary);
        }

        .mode-description {
          font-size: var(--text-sm);
          color: var(--color-text-secondary);
          text-align: center;
        }

        .mode-tab.active .mode-title {
          color: white;
          font-weight: var(--font-bold);
        }

        .mode-tab.active .mode-description {
          color: rgba(255, 255, 255, 0.9);
        }

        .svg-preview {
          margin: var(--space-3) 0;
          border: 1px solid var(--color-border);
          border-radius: var(--radius-md);
          background: var(--color-bg-subtle);
          padding: var(--space-3);
        }

        .design-preview {
          width: 100%;
          height: auto;
          display: block;
        }

        /* Finalize Section */
        .finalize-section {
          background: var(--color-accent-light);
          border: 2px solid var(--color-accent);
          border-radius: var(--radius-lg);
          padding: var(--space-4);
          margin-top: var(--space-4);
          text-align: center;
        }

        .finalize-button {
          width: 100%;
          max-width: 400px;
          padding: var(--space-4);
          background: var(--color-accent);
          color: white;
          border: none;
          border-radius: var(--radius-md);
          font-size: var(--text-lg);
          font-weight: var(--font-semibold);
          cursor: pointer;
          transition: all var(--transition-base);
          box-shadow: var(--shadow-sm);
        }

        .finalize-button:hover {
          background: var(--color-accent-hover);
          transform: translateY(-1px);
          box-shadow: var(--shadow-md);
        }

        .finalize-hint {
          margin: var(--space-3) 0 0 0;
          color: var(--color-text-secondary);
          font-size: var(--text-sm);
        }

        /* Mixer Widget Container Styles */
        .mixer-widget-container {
          margin-top: var(--space-4);
          background: white;
          border-radius: 12px;
          padding: var(--space-4);
          box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        }

        .mixer-widget-header {
          display: flex;
          justify-content: flex-end;
          margin-bottom: var(--space-3);
          padding-bottom: var(--space-3);
          border-bottom: 2px solid var(--color-border);
        }

        .mixer-close-btn {
          padding: var(--space-2) var(--space-4);
          background: var(--color-primary);
          color: white;
          border: none;
          border-radius: 8px;
          font-weight: 600;
          font-size: var(--text-sm);
          cursor: pointer;
          transition: all 0.2s;
        }

        .mixer-close-btn:hover {
          background: #2563eb;
          box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
          transform: translateY(-1px);
        }

        /* Mobile Responsive Styles */
        @media (max-width: 768px) {
          .inspire-panel-recraft {
            padding: var(--space-2);
          }

          .panel-header {
            margin-bottom: var(--space-4);
          }

          .panel-header h2 {
            font-size: var(--text-xl);
          }

          .subtitle {
            font-size: var(--text-sm);
          }

          .welcome-guidance {
            padding: var(--space-4);
            margin-bottom: var(--space-4);
          }

          .welcome-icon {
            font-size: 2rem;
          }

          .welcome-guidance h3 {
            font-size: var(--text-lg);
          }

          .welcome-guidance p {
            font-size: var(--text-sm);
          }

          /* Stack input mode tabs vertically on mobile */
          .input-mode-tabs {
            flex-direction: column;
            gap: var(--space-1);
          }

          .input-mode-tab {
            flex-direction: row;
            justify-content: flex-start;
            padding: var(--space-3);
            min-height: 44px;
          }

          .mode-icon {
            width: 24px;
            height: 24px;
            flex-shrink: 0;
          }

          .input-mode-tab .mode-title {
            font-size: var(--text-sm);
            margin-top: 0;
          }

          .input-mode-tab .mode-description {
            display: none;
          }

          /* Form sections */
          .form-section {
            padding: var(--space-3);
          }

          .form-group label {
            font-size: var(--text-xs);
          }

          /* Stack form rows on mobile */
          .form-row {
            grid-template-columns: 1fr;
            gap: var(--space-2);
          }

          /* Drop zone adjustments */
          .drop-zone {
            min-height: 140px;
          }

          .drop-zone-content {
            padding: var(--space-4);
            min-height: 140px;
          }

          .upload-icon {
            width: 36px;
            height: 36px;
          }

          .drop-text {
            font-size: var(--text-sm);
          }

          /* Generate button */
          .generate-button {
            padding: var(--space-3);
            font-size: var(--text-base);
            min-height: 44px;
          }

          /* Results section - minimal padding for max image width */
          .results-section {
            padding: var(--space-2);
            border-radius: var(--radius-md);
          }

          .results-header h3 {
            font-size: var(--text-lg);
          }

          /* Mode tabs */
          .mode-tabs {
            flex-direction: column;
            gap: var(--space-1);
          }

          .mode-tab {
            flex-direction: row;
            justify-content: flex-start;
            padding: var(--space-3);
            min-height: 44px;
          }

          .mode-title {
            font-size: var(--text-sm);
          }

          .mode-description {
            display: none;
          }

          /* AR info */
          .ar-info {
            padding: var(--space-2) var(--space-3);
          }

          .ar-info-details {
            flex-direction: column;
            align-items: flex-start;
            gap: var(--space-1);
          }

          /* Finalize section */
          .finalize-section {
            padding: var(--space-3);
          }

          .finalize-button {
            padding: var(--space-3);
            font-size: var(--text-base);
          }
        }

        /* Extra small screens */
        @media (max-width: 480px) {
          .inspire-panel-recraft {
            padding: var(--space-1);
          }

          .panel-header h2 {
            font-size: var(--text-lg);
          }

          /* Results section - even less padding */
          .results-section {
            padding: var(--space-1);
            margin: 0 calc(-1 * var(--space-1));
            border-radius: 0;
          }

          .input-mode-tab {
            padding: var(--space-2);
          }

          .mode-tab {
            padding: var(--space-2);
          }
        }
      `})]})}function Q7({isOpen:t,onClose:e}){const[r,n]=A.useState(!1),[i,o]=A.useState(!1),[s,l]=A.useState(!1),{addMotif:c}=Qe(),d=Dc(),{currentDesignId:h,blendSvgUrl:f,solidSvgUrl:u,designName:p}=d,g=f||u,m=!!h;A.useEffect(()=>{if(!t)return;const y=b=>{b.key==="Escape"&&e()};return window.addEventListener("keydown",y),()=>window.removeEventListener("keydown",y)},[t,e]),A.useEffect(()=>{t||(l(!1),n(!1),o(!1))},[t]);const x=A.useCallback((y,b)=>{console.log("[EDITOR] Design saved:",y,b),l(!1)},[]),v=async()=>{if(!(!g||r)){n(!0);try{let y=h;if(!y){o(!0);const w=p||`Design ${new Date().toLocaleString("en-GB",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"})}`,k=t_(d);y=(await up({name:w,description:"",tags:[],design_data:k,input_mode:d.inputMode})).id,d.setCurrentDesignId(y),d.setDesignName(w),o(!1)}const b=await fp(y);c(b.sourceDesignId,b.sourceDesignName,b.svgContent,b.originalWidth_mm,b.originalHeight_mm,b.sourceThumbnailUrl,{solidSvgContent:b.solidSvgContent,blendSvgContent:b.blendSvgContent,hasBothVersions:b.hasBothVersions}),l(!0),setTimeout(()=>{e()},600)}catch(y){console.error("[EDITOR] Failed to add to canvas:",y),alert("Failed to add design to canvas: "+y.message),o(!1)}finally{n(!1)}}};return t?a.jsx("div",{className:"design-editor-overlay",children:a.jsxs("div",{className:"design-editor-modal",children:[a.jsxs("div",{className:"design-editor__header",children:[a.jsxs("div",{className:"design-editor__title",children:[a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polygon",{points:"12 2 2 7 12 12 22 7 12 2"}),a.jsx("polyline",{points:"2 17 12 22 22 17"}),a.jsx("polyline",{points:"2 12 12 17 22 12"})]}),a.jsx("h2",{children:"Design Editor"})]}),a.jsx("div",{className:"design-editor__hint",children:"Generate a design with AI or upload your own SVG"}),a.jsx("button",{className:"design-editor__close",onClick:e,title:"Close (Esc)",children:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),a.jsx("div",{className:"design-editor__content",children:a.jsx(J7,{onDesignSaved:x,isEmbedded:!0})}),a.jsx("div",{className:`design-editor__footer ${s?"design-editor__footer--success":""}`,children:s?a.jsxs("div",{className:"design-editor__success",children:[a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}),a.jsx("span",{children:"Added to canvas!"})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"design-editor__status",children:g?m?a.jsxs("span",{className:"design-editor__saved-indicator",children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}),"Saved to library"]}):a.jsx("span",{className:"design-editor__unsaved-indicator",children:"Design ready  Will auto-save when added"}):a.jsx("span",{className:"design-editor__no-design",children:"Generate or upload a design to continue"})}),a.jsxs("div",{className:"design-editor__actions",children:[a.jsx("button",{className:"design-editor__btn design-editor__btn--secondary",onClick:e,children:"Cancel"}),a.jsx("button",{className:"design-editor__btn design-editor__btn--primary",onClick:v,disabled:!g||r,children:r?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"design-editor__spinner"}),i?"Saving...":"Adding..."]}):a.jsxs(a.Fragment,{children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"16"}),a.jsx("line",{x1:"8",y1:"12",x2:"16",y2:"12"})]}),"Add to Canvas"]})})]})]})})]})}):null}function eU({loadedDesign:t}){const[e,r]=A.useState(!1),[n,i]=A.useState(()=>{const ue=Qe.getState().surface;return ue!=null&&ue.width_mm?String(ue.width_mm/1e3):"50"}),[o,s]=A.useState(()=>{const ue=Qe.getState().surface;return ue!=null&&ue.length_mm?String(ue.length_mm/1e3):"50"}),[l,c]=A.useState(!1),[d,h]=A.useState(!1),[f,u]=A.useState(!1),[p,g]=A.useState(!1),[m,x]=A.useState(!1),[v,y]=A.useState(null),[b,w]=A.useState(null),[k,S]=A.useState(""),C=A.useRef(null);A.useEffect(()=>{if(t&&t.design_data){const ue=t.design_data,de=ue.input_mode||ue.blend_recipes||ue.solid_recipes,ze=ue.courts||ue.surface||ue.tracks;if(de&&!ze){console.log("[TPV] Loading playground design into editor:",t.id,t.name);const Ge=af(t),j=Dc.getState();j.loadDesign(Ge),t.name&&j.setDesignName(t.name),j.setCurrentDesignId(t.id),g(!0)}else console.log("[SPORTS] Loading design from prop:",t.id,t.name),Qe.getState().loadDesign(ue),w(t.id),S(t.name||""),r(!1)}},[t]);const{surface:T,courts:R,tracks:O,selectedCourtId:Y,selectedTrackId:E,selectedMotifId:B,showCourtLibrary:_,showPropertiesPanel:V,toggleCourtLibrary:re,togglePropertiesPanel:I,setSurfaceDimensions:q,setSurfaceColor:D,resetDesign:J,hasUnsavedChanges:U,standaloneMode:G,toggleStandaloneMode:fe}=Qe(),oe=ue=>{ue.preventDefault();const de=parseFloat(n)*1e3,ze=parseFloat(o)*1e3;de>0&&ze>0&&(q(de,ze),r(!1))},ae=ue=>{D({tpv_code:ue.code,hex:ue.hex,name:ue.name}),c(!1)},le=()=>{U()&&!window.confirm(`Start a new design?

You have unsaved changes that will be lost.`)||(J(),w(null),S(""),i("50"),s("50"))},ce=()=>{const ue=C.current||document.querySelector(".court-canvas__svg");if(!ue){alert("Canvas not ready");return}const de=Qe.getState().exportDesignData(),ze=mp(ue,de),Ge=new Blob([ze],{type:"image/svg+xml"}),j=URL.createObjectURL(Ge);v&&URL.revokeObjectURL(v),y(j),x(!0)},be=()=>{x(!1),v&&(URL.revokeObjectURL(v),y(null))},Ce=async ue=>{if(!ue){alert("Source design ID not found");return}try{const de=await Wa(ue),ze=(de==null?void 0:de.design)||de;if(!ze)throw new Error("Design not found");const Ge=af(ze),j=Dc.getState();j.loadDesign(Ge),ze.name&&j.setDesignName(ze.name),j.setCurrentDesignId(ue),g(!0),console.log("[TPV] Loaded source design for editing:",ze.name)}catch(de){console.error("[TPV] Failed to load source design:",de),alert("Failed to load design: "+de.message)}};return A.useEffect(()=>{const ue=de=>{const ze=de.target.tagName.toLowerCase();if(ze==="input"||ze==="textarea"||ze==="select")return;const{removeCourt:Ge,removeTrack:j,removeMotif:ie,deselectCourt:M,deselectTrack:N,deselectMotif:P,undo:F,redo:X,canUndo:K,canRedo:L,duplicateCourt:H,duplicateMotif:Z,updateCourtPosition:ee,updateTrackPosition:z,updateMotifPosition:Q,courts:ne,tracks:ge,motifs:Se,selectedMotifId:we,elementOrder:ke,setElementOrder:_e,toggleSnapToGrid:Te,snapToGrid:We,addToHistory:Ue}=Qe.getState(),Je=Y||E||we;if(de.key==="Delete"&&Je&&(de.preventDefault(),Y?Ge(Y):E?j(E):we&&ie(we)),de.key==="Escape"&&Je&&(Y?M():E?N():we&&P()),(de.ctrlKey||de.metaKey)&&de.key==="z"&&!de.shiftKey&&(de.preventDefault(),K()&&F()),(de.ctrlKey||de.metaKey)&&de.key==="z"&&de.shiftKey&&(de.preventDefault(),L()&&X()),(de.ctrlKey||de.metaKey)&&de.key==="d"&&Je&&(de.preventDefault(),Y?H(Y):we&&Z(we)),Je&&["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(de.key)){de.preventDefault();const Fe=de.shiftKey?10:100;let je=0,Be=0;if(de.key==="ArrowLeft"&&(je=-Fe),de.key==="ArrowRight"&&(je=Fe),de.key==="ArrowUp"&&(Be=-Fe),de.key==="ArrowDown"&&(Be=Fe),Y){const Ve=ne[Y];Ve&&(ee(Y,{x:Ve.position.x+je,y:Ve.position.y+Be}),Ue())}else if(E){const Ve=ge[E];Ve&&(z(E,{x:Ve.position.x+je,y:Ve.position.y+Be}),Ue())}else if(we){const Ve=Se[we];Ve&&(Q(we,{x:Ve.position.x+je,y:Ve.position.y+Be}),Ue())}}if(Je&&(de.key==="["||de.key==="]")){de.preventDefault();const Fe=ke.indexOf(Je);if(Fe===-1)return;const je=[...ke];de.key==="["&&Fe>0?([je[Fe],je[Fe-1]]=[je[Fe-1],je[Fe]],_e(je),Ue()):de.key==="]"&&Fe<ke.length-1&&([je[Fe],je[Fe+1]]=[je[Fe+1],je[Fe]],_e(je),Ue())}(de.key==="g"||de.key==="G")&&(de.preventDefault(),Te()),(de.key==="?"||de.shiftKey&&de.key==="/")&&(de.preventDefault(),u(!0))};return window.addEventListener("keydown",ue),()=>window.removeEventListener("keydown",ue)},[Y,E,B]),a.jsxs("div",{className:"sports-designer",children:[e&&a.jsx("div",{className:"sports-designer__modal-overlay",onClick:()=>r(!1),children:a.jsxs("div",{className:"sports-designer__modal",onClick:ue=>ue.stopPropagation(),children:[a.jsx("h2",{children:"Edit Surface Size"}),a.jsx("p",{children:"Adjust the dimensions of your sports surface"}),a.jsxs("form",{onSubmit:oe,children:[a.jsxs("div",{className:"sports-designer__dimension-inputs",children:[a.jsxs("div",{className:"sports-designer__input-group",children:[a.jsx("label",{htmlFor:"width",children:"Width (metres)"}),a.jsx("input",{id:"width",type:"number",min:"5",max:"100",step:"0.5",value:n,onChange:ue=>i(ue.target.value),required:!0,autoFocus:!0})]}),a.jsx("span",{className:"sports-designer__dimension-separator",children:""}),a.jsxs("div",{className:"sports-designer__input-group",children:[a.jsx("label",{htmlFor:"length",children:"Length (metres)"}),a.jsx("input",{id:"length",type:"number",min:"5",max:"100",step:"0.5",value:o,onChange:ue=>s(ue.target.value),required:!0})]})]}),a.jsx("p",{className:"sports-designer__dimension-hint",children:"Common sizes: 37m  34m (tennis), 40m  20m (futsal), 50m  50m (multi-sport)"}),a.jsx("button",{type:"submit",className:"sports-designer__btn-primary",children:"Update Surface"})]})]})}),a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"sports-designer__content",children:[_&&!G&&a.jsxs("aside",{className:"sports-designer__sidebar",children:[a.jsx(tE,{onOpenGenerator:()=>g(!0)}),a.jsx(cE,{})]}),a.jsxs("main",{className:"sports-designer__canvas-container",children:[a.jsxs("div",{className:"sports-toolbar",children:[a.jsxs("div",{className:"sports-toolbar__group",children:[a.jsx("button",{className:`sports-toolbar__btn ${_?"sports-toolbar__btn--active":""}`,onClick:re,title:"Element Library",disabled:G,children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"3",y:"14",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"14",width:"7",height:"7"})]})}),a.jsx("button",{className:`sports-toolbar__btn ${V&&(Y||E||B)?"sports-toolbar__btn--active":""}`,onClick:I,title:"Properties",disabled:!Y&&!E&&!B||G,children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("line",{x1:"4",y1:"21",x2:"4",y2:"14"}),a.jsx("line",{x1:"4",y1:"10",x2:"4",y2:"3"}),a.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"12"}),a.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"3"}),a.jsx("line",{x1:"20",y1:"21",x2:"20",y2:"16"}),a.jsx("line",{x1:"20",y1:"12",x2:"20",y2:"3"}),a.jsx("line",{x1:"1",y1:"14",x2:"7",y2:"14"}),a.jsx("line",{x1:"9",y1:"8",x2:"15",y2:"8"}),a.jsx("line",{x1:"17",y1:"16",x2:"23",y2:"16"})]})})]}),a.jsx("div",{className:"sports-toolbar__divider"}),a.jsx("div",{className:"sports-toolbar__group",children:a.jsx("button",{className:`sports-toolbar__mode-toggle ${G?"sports-toolbar__mode-toggle--active":""}`,onClick:fe,title:G?"Switch to Multi-Element Mode":"Switch to Standalone Mode",children:G?a.jsxs(a.Fragment,{children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"})}),a.jsx("span",{children:"Standalone"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"3",y:"14",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"14",width:"7",height:"7"})]}),a.jsx("span",{children:"Multi-Element"})]})})}),a.jsx("div",{className:"sports-toolbar__divider"}),a.jsxs("div",{className:"sports-toolbar__group",children:[a.jsxs("button",{className:"sports-toolbar__dimensions",onClick:()=>{i(String(T.width_mm/1e3)),s(String(T.length_mm/1e3)),r(!0)},title:"Click to edit surface size",children:[(T.width_mm/1e3).toFixed(0),"m  ",(T.length_mm/1e3).toFixed(0),"m"]}),a.jsx("button",{className:"sports-toolbar__color-swatch",style:{backgroundColor:T.color.hex},onClick:()=>c(!0),title:`${T.color.name} (${T.color.tpv_code}) - Click to change`})]}),a.jsx("div",{className:"sports-toolbar__divider"}),a.jsxs("div",{className:"sports-toolbar__group",children:[a.jsx("button",{className:"sports-toolbar__btn",disabled:!Qe.getState().canUndo(),onClick:()=>Qe.getState().undo(),title:"Undo (Ctrl+Z)",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M3 7v6h6"}),a.jsx("path",{d:"M21 17a9 9 0 00-9-9 9 9 0 00-6 2.3L3 13"})]})}),a.jsx("button",{className:"sports-toolbar__btn",disabled:!Qe.getState().canRedo(),onClick:()=>Qe.getState().redo(),title:"Redo (Ctrl+Shift+Z)",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M21 7v6h-6"}),a.jsx("path",{d:"M3 17a9 9 0 019-9 9 9 0 016 2.3l3 2.7"})]})})]}),a.jsx("div",{className:"sports-toolbar__divider"}),a.jsxs("div",{className:"sports-toolbar__group",children:[a.jsx("button",{className:"sports-toolbar__btn",onClick:le,title:"Start new design",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),a.jsx("polyline",{points:"14 2 14 8 20 8"}),a.jsx("line",{x1:"12",y1:"18",x2:"12",y2:"12"}),a.jsx("line",{x1:"9",y1:"15",x2:"15",y2:"15"})]})}),a.jsx("button",{className:"sports-toolbar__btn",onClick:ce,title:"View In-Situ Preview",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("polyline",{points:"21 15 16 10 5 21"})]})}),a.jsx("button",{className:"sports-toolbar__btn",onClick:()=>u(!0),title:"Keyboard shortcuts (?)",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),a.jsx("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]})}),a.jsx("button",{className:"sports-toolbar__btn-primary",onClick:()=>h(!0),children:"Save"}),a.jsx(EE,{svgRef:C})]})]}),a.jsx(LC,{ref:C})]}),(Y||E||B)&&V&&!G&&a.jsx("aside",{className:"sports-designer__properties",children:a.jsx(sE,{onEditSourceDesign:Ce})})]}),l&&a.jsx("div",{className:"sports-designer__color-modal-overlay",onClick:()=>c(!1),children:a.jsxs("div",{className:"sports-designer__color-modal",onClick:ue=>ue.stopPropagation(),children:[a.jsxs("div",{className:"sports-designer__color-modal-header",children:[a.jsx("h4",{children:"Select Surface Colour"}),a.jsx("button",{onClick:()=>c(!1),children:""})]}),a.jsx("div",{className:"sports-designer__color-grid",children:nn.map(ue=>a.jsx("button",{className:`sports-designer__color-swatch ${T.color.tpv_code===ue.code?"sports-designer__color-swatch--selected":""}`,style:{backgroundColor:ue.hex},onClick:()=>ae(ue),title:`${ue.code} - ${ue.name}`,children:a.jsx("span",{className:"sports-designer__color-code",children:ue.code})},ue.code))})]})}),d&&a.jsx(vE,{existingDesignId:b,initialName:k,svgRef:C,onClose:()=>h(!1),onSaved:(ue,de)=>{w(ue.design_id),S(de),console.log("[SPORTS] Design saved:",ue.design_id)}}),a.jsx(TE,{isOpen:f,onClose:()=>u(!1)}),a.jsx(Q7,{isOpen:p,onClose:()=>g(!1)}),m&&v&&a.jsx(i_,{designUrl:v,designDimensions:{width:T.width_mm,length:T.length_mm},onClose:be,onSaved:ue=>{console.log("[TPV] In-situ preview saved:",ue),be()}})]})]})}function tU({onShowDesigns:t,onShowAdmin:e,isAdmin:r,currentDesignName:n}){const[i,o]=A.useState(!1),s=async()=>{confirm("Sign out?")&&(await Qr.signOut(),window.location.reload())};return a.jsx("header",{className:"studio-header",children:a.jsxs("div",{className:"header-content",children:[a.jsxs("div",{className:"header-left",children:[a.jsx("h1",{className:"studio-title",children:"TPV Designer"}),n&&a.jsxs("span",{className:"current-design-indicator",children:[a.jsx("svg",{width:"4",height:"4",viewBox:"0 0 4 4",children:a.jsx("circle",{cx:"2",cy:"2",r:"2",fill:"currentColor"})}),n]})]}),a.jsxs("div",{className:"header-right",children:[a.jsxs("button",{onClick:t,className:"btn-my-designs",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"}),a.jsx("path",{d:"M9 22V12h6v10"})]}),"My Designs"]}),r&&a.jsxs("button",{onClick:e,className:"btn-admin",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M12 15a3 3 0 100-6 3 3 0 000 6z"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z"})]}),"Admin"]}),a.jsxs("div",{className:"user-menu",children:[a.jsx("button",{onClick:()=>o(!i),className:"user-menu-button",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),i&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"user-menu-backdrop",onClick:()=>o(!1)}),a.jsx("div",{className:"user-menu-dropdown",children:a.jsxs("button",{onClick:s,className:"menu-item sign-out",children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4M16 17l5-5-5-5M21 12H9"})}),"Sign Out"]})})]})]})]})]})})}function rU({design:t,onLoad:e,onDelete:r,onUpdateMetadata:n}){var g;const[i,o]=A.useState(!1),[s,l]=A.useState(!1),c=async()=>{if(confirm(`Delete "${t.name}"? This cannot be undone.`)){l(!0);try{await r(t.id)}catch(m){console.error("Failed to delete design:",m),alert(`Failed to delete: ${m.message}`),l(!1)}}},d=m=>{const x=new Date(m),v=new Date,y=v-x,b=Math.floor(y/(1e3*60*60*24));return b===0?"Today":b===1?"Yesterday":b<7?`${b} days ago`:b<30?`${Math.floor(b/7)} weeks ago`:x.toLocaleDateString("en-GB",{day:"numeric",month:"short",year:x.getFullYear()!==v.getFullYear()?"numeric":void 0})},h=t.input_mode==="sports_surface"||((g=t.design_data)==null?void 0:g.type)==="sports_surface",f=t.thumbnail_url||t.original_png_url||t.original_svg_url,p=h?{label:"Surface",icon:"",className:"type-surface"}:{label:"Motif",icon:"",className:"type-motif"};return a.jsxs("div",{className:`design-card ${s?"deleting":""}`,onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),children:[a.jsxs("div",{className:`design-type-badge ${p.className}`,children:[a.jsx("span",{className:"type-icon",children:p.icon}),a.jsx("span",{className:"type-label",children:p.label})]}),a.jsxs("div",{className:"card-thumbnail",onClick:()=>e(t.id),children:[f?a.jsx("img",{src:f,alt:t.name}):a.jsx("div",{className:"no-thumbnail",children:a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("polyline",{points:"21 15 16 10 5 21"})]})}),i&&a.jsx("div",{className:"thumbnail-overlay",children:a.jsx("button",{className:"btn-load",children:"Open"})})]}),a.jsxs("div",{className:"card-info",children:[a.jsx("h3",{className:"design-name",title:t.name,children:t.name}),t.description&&a.jsx("p",{className:"design-description",title:t.description,children:t.description}),a.jsxs("div",{className:"card-meta",children:[t.projects&&a.jsx("span",{className:"project-badge",style:{backgroundColor:t.projects.color||"#1a365d"},title:t.projects.name,children:t.projects.name}),a.jsx("span",{className:"design-date",title:new Date(t.updated_at).toLocaleString(),children:d(t.updated_at)})]}),t.tags&&t.tags.length>0&&a.jsxs("div",{className:"design-tags",children:[t.tags.slice(0,3).map((m,x)=>a.jsx("span",{className:"tag",children:m},x)),t.tags.length>3&&a.jsxs("span",{className:"tag more",children:["+",t.tags.length-3]})]})]}),i&&!s&&a.jsxs("div",{className:"card-actions",children:[a.jsx("button",{onClick:()=>e(t.id),className:"action-btn load-btn",title:"Load design",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),a.jsx("circle",{cx:"12",cy:"12",r:"3"})]})}),a.jsx("button",{onClick:c,className:"action-btn delete-btn",title:"Delete design",children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]}),s&&a.jsx("div",{className:"deleting-overlay",children:a.jsx("div",{className:"spinner"})})]})}function nU({onClose:t,onLoadDesign:e}){const[r,n]=A.useState([]),[i,o]=A.useState([]),[s,l]=A.useState(!0),[c,d]=A.useState(null),[h,f]=A.useState(""),[u,p]=A.useState(""),[g,m]=A.useState(!1),[x,v]=A.useState(!1);A.useEffect(()=>{y()},[h,u]);const y=async()=>{l(!0),d(null);try{const[S,C]=await Promise.all([pp(),Lc({project_id:h||void 0,search:u||void 0,limit:12,offset:0})]);o(S.projects),n(C.designs),m(C.pagination.has_more)}catch(S){console.error("Failed to load designs:",S),d(S.message)}finally{l(!1)}},b=async()=>{if(!(x||!g)){v(!0);try{const S=await Lc({project_id:h||void 0,search:u||void 0,limit:12,offset:r.length});n([...r,...S.designs]),m(S.pagination.has_more)}catch(S){console.error("Failed to load more designs:",S),d(S.message)}finally{v(!1)}}},w=async S=>{try{const{design:C}=await Wa(S);e(C),t()}catch(C){console.error("Failed to load design:",C),alert(`Failed to load design: ${C.message}`)}},k=async S=>{try{await eC(S),n(r.filter(C=>C.id!==S))}catch(C){throw console.error("Failed to delete design:",C),C}};return a.jsx("div",{className:"modal-overlay",onClick:t,children:a.jsxs("div",{className:"modal-content design-gallery-modal",onClick:S=>S.stopPropagation(),children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h2",{children:"My Designs"}),a.jsx("button",{onClick:t,className:"close-button",children:""})]}),a.jsxs("div",{className:"gallery-filters",children:[a.jsx("div",{className:"filter-group",children:a.jsx("input",{type:"text",placeholder:"Search designs...",value:u,onChange:S=>p(S.target.value),className:"search-input"})}),a.jsx("div",{className:"filter-group",children:a.jsxs("select",{value:h,onChange:S=>f(S.target.value),className:"project-filter",children:[a.jsx("option",{value:"",children:"All Projects"}),i.map(S=>a.jsxs("option",{value:S.id,children:[S.name," (",S.design_count,")"]},S.id))]})})]}),a.jsxs("div",{className:"modal-body",children:[c&&a.jsxs("div",{className:"error-message",children:[c,a.jsx("button",{onClick:y,className:"btn-retry",children:"Retry"})]}),s?a.jsxs("div",{className:"loading-state",children:[a.jsx("div",{className:"spinner-large"}),a.jsx("p",{children:"Loading your designs..."})]}):r.length===0?a.jsxs("div",{className:"empty-state",children:[a.jsxs("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("path",{d:"M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z"}),a.jsx("path",{d:"M17 21v-8H7v8M7 3v5h8"})]}),a.jsx("h3",{children:"No designs yet"}),a.jsx("p",{children:u||h?"No designs match your filters. Try adjusting your search.":"Create your first design to see it here!"})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"designs-grid",children:r.map(S=>a.jsx(rU,{design:S,onLoad:w,onDelete:k},S.id))}),g&&a.jsx("div",{className:"load-more-section",children:a.jsx("button",{onClick:b,className:"btn-load-more",disabled:x,children:x?"Loading...":"Load More"})})]})]})]})})}function iU(){const[t,e]=A.useState([]),[r,n]=A.useState(0),[i,o]=A.useState(!1),[s,l]=A.useState(null),[c,d]=A.useState("all"),[h,f]=A.useState("all"),[u,p]=A.useState(""),[g,m]=A.useState(0),x=50,v=async()=>{var T,R;const S=await Pt.auth.getSession();return{"Content-Type":"application/json",Authorization:`Bearer ${(R=(T=S==null?void 0:S.data)==null?void 0:T.session)==null?void 0:R.access_token}`}},y=async()=>{o(!0),l(null);try{const S=await v(),C=new URLSearchParams({limit:x.toString(),offset:g.toString()});c!=="all"&&C.append("status",c),h!=="all"&&C.append("saved_status",h),u&&C.append("search",u);const T=await fetch(`/api/admin/jobs?${C.toString()}`,{headers:S}),R=await T.json();if(!T.ok)throw new Error(R.error||"Failed to fetch jobs");e(R.jobs),n(R.total)}catch(S){console.error("Failed to fetch jobs:",S),l(S.message)}finally{o(!1)}};A.useEffect(()=>{y()},[c,h,u,g]);const b=t.filter(S=>S.status==="completed").length,w=t.filter(S=>!S.is_saved&&S.status==="completed").length,k=t.filter(S=>S.is_saved).length;return a.jsxs("div",{className:"generations-tab",children:[a.jsxs("div",{className:"admin-stats-grid",children:[a.jsxs("div",{className:"admin-stat-card",children:[a.jsx("h3",{children:"Total Generations"}),a.jsx("p",{className:"stat-value",children:r}),a.jsx("span",{className:"stat-label",children:"All time"})]}),a.jsxs("div",{className:"admin-stat-card",children:[a.jsx("h3",{children:"Completed"}),a.jsx("p",{className:"stat-value",children:b}),a.jsx("span",{className:"stat-label",children:"Current page"})]}),a.jsxs("div",{className:"admin-stat-card success",children:[a.jsx("h3",{children:"Saved"}),a.jsx("p",{className:"stat-value",children:k}),a.jsx("span",{className:"stat-label",children:" Linked to designs"})]}),a.jsxs("div",{className:"admin-stat-card warning",children:[a.jsx("h3",{children:"Orphaned"}),a.jsx("p",{className:"stat-value",children:w}),a.jsx("span",{className:"stat-label",children:" Not saved"})]})]}),a.jsxs("div",{className:"admin-filters",children:[a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Status:"}),a.jsxs("select",{value:c,onChange:S=>d(S.target.value),children:[a.jsx("option",{value:"all",children:"All"}),a.jsx("option",{value:"completed",children:"Completed"}),a.jsx("option",{value:"failed",children:"Failed"}),a.jsx("option",{value:"running",children:"Running"}),a.jsx("option",{value:"queued",children:"Queued"})]})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Saved:"}),a.jsxs("select",{value:h,onChange:S=>f(S.target.value),children:[a.jsx("option",{value:"all",children:"All"}),a.jsx("option",{value:"saved",children:"Saved only"}),a.jsx("option",{value:"orphaned",children:"Orphaned only"})]})]}),a.jsxs("div",{className:"filter-group search",children:[a.jsx("label",{children:"Search prompt:"}),a.jsx("input",{type:"text",placeholder:"Search in prompts...",value:u,onChange:S=>p(S.target.value)})]})]}),i&&a.jsxs("div",{className:"admin-loading",children:[a.jsx("div",{className:"spinner"}),a.jsx("p",{children:"Loading jobs..."})]}),s&&a.jsx("div",{className:"admin-error",children:a.jsxs("p",{children:["Error: ",s]})}),!i&&t.length>0&&a.jsx("div",{className:"jobs-table-container",children:a.jsxs("table",{className:"jobs-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Thumbnail"}),a.jsx("th",{children:"Prompt"}),a.jsx("th",{children:"Dimensions"}),a.jsx("th",{children:"Status"}),a.jsx("th",{children:"Saved"}),a.jsx("th",{children:"User"}),a.jsx("th",{children:"Created"})]})}),a.jsx("tbody",{children:t.map(S=>a.jsxs("tr",{className:`job-row ${S.is_saved?"saved":"orphaned"} ${S.status}`,children:[a.jsx("td",{className:"thumbnail-cell",children:S.thumbnail_url?a.jsx("img",{src:S.thumbnail_url,alt:"Design",className:"job-thumbnail"}):a.jsx("div",{className:"thumbnail-placeholder",children:"No image"})}),a.jsx("td",{className:"prompt-cell",children:a.jsx("div",{className:"prompt-text",title:S.prompt,children:S.prompt||a.jsx("em",{children:"No prompt"})})}),a.jsx("td",{className:"dimensions-cell",children:S.width_mm&&S.length_mm?a.jsxs("span",{children:[S.width_mm,"  ",S.length_mm," mm"]}):a.jsx("em",{children:"N/A"})}),a.jsx("td",{className:"status-cell",children:a.jsx("span",{className:`status-badge ${S.status}`,children:S.status})}),a.jsx("td",{className:"saved-cell",children:S.is_saved?a.jsx("span",{className:"saved-badge",children:" Saved"}):a.jsx("span",{className:"orphaned-badge",children:" Orphaned"})}),a.jsx("td",{className:"user-cell",children:S.user_email}),a.jsx("td",{className:"date-cell",children:new Date(S.created_at).toLocaleDateString()})]},S.id))})]})}),!i&&t.length===0&&a.jsx("div",{className:"admin-empty",children:a.jsx("p",{children:"No jobs found matching your filters."})}),r>x&&a.jsxs("div",{className:"admin-pagination",children:[a.jsx("button",{onClick:()=>m(Math.max(0,g-x)),disabled:g===0,children:"Previous"}),a.jsxs("span",{children:["Showing ",g+1," to ",Math.min(g+x,r)," of ",r]}),a.jsx("button",{onClick:()=>m(g+x),disabled:g+x>=r,children:"Next"})]}),a.jsx("style",{children:`
        .jobs-table-container {
          overflow-x: auto;
          background: white;
          border-radius: 8px;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .jobs-table {
          width: 100%;
          border-collapse: collapse;
        }

        .jobs-table th {
          background: #f9fafb;
          padding: 1rem;
          text-align: left;
          font-weight: 600;
          font-size: 0.875rem;
          color: #374151;
          border-bottom: 1px solid #e5e7eb;
        }

        .jobs-table td {
          padding: 1rem;
          border-bottom: 1px solid #e5e7eb;
        }

        .job-row.saved {
          background: rgba(16, 185, 129, 0.03);
        }

        .job-row.orphaned {
          background: rgba(245, 158, 11, 0.03);
        }

        .thumbnail-cell {
          width: 80px;
        }

        .job-thumbnail {
          width: 64px;
          height: 64px;
          object-fit: cover;
          border-radius: 4px;
        }

        .thumbnail-placeholder {
          width: 64px;
          height: 64px;
          background: #f3f4f6;
          border-radius: 4px;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 0.75rem;
          color: #9ca3af;
        }

        .prompt-cell {
          max-width: 300px;
        }

        .prompt-text {
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
        }

        .status-badge {
          display: inline-block;
          padding: 0.25rem 0.75rem;
          border-radius: 9999px;
          font-size: 0.75rem;
          font-weight: 500;
        }

        .status-badge.completed {
          background: #d1fae5;
          color: #065f46;
        }

        .status-badge.failed {
          background: #fee2e2;
          color: #991b1b;
        }

        .status-badge.running {
          background: #dbeafe;
          color: #1e40af;
        }

        .status-badge.queued {
          background: #e0e7ff;
          color: #3730a3;
        }

        .saved-badge {
          color: #059669;
          font-weight: 500;
        }

        .orphaned-badge {
          color: #d97706;
          font-weight: 500;
        }

        .user-cell {
          font-size: 0.875rem;
          color: #6b7280;
        }

        .date-cell {
          font-size: 0.875rem;
          color: #6b7280;
          white-space: nowrap;
        }

        .admin-stat-card.success {
          border-left: 4px solid #10b981;
        }

        .admin-stat-card.warning {
          border-left: 4px solid #f59e0b;
        }
      `})]})}function oU(){const[t,e]=A.useState([]),[r,n]=A.useState(null),[i,o]=A.useState(!1),[s,l]=A.useState(null),[c,d]=A.useState(!1),[h,f]=A.useState(new Set),[u,p]=A.useState("all"),g=async()=>{var S,C;const w=await Pt.auth.getSession();return{"Content-Type":"application/json",Authorization:`Bearer ${(C=(S=w==null?void 0:w.data)==null?void 0:S.session)==null?void 0:C.access_token}`}},m=async()=>{o(!0),l(null);try{const w=await g(),k=new URLSearchParams;u!=="all"&&k.append("age_filter",u);const S=await fetch(`/api/admin/recovery/orphaned?${k.toString()}`,{headers:w}),C=await S.json();if(!S.ok)throw new Error(C.error||"Failed to fetch orphaned jobs");e(C.orphaned_jobs),n(C.age_buckets)}catch(w){console.error("Failed to fetch orphaned jobs:",w),l(w.message)}finally{o(!1)}};A.useEffect(()=>{m()},[u]);const x=w=>{const k=new Set(h);k.has(w)?k.delete(w):k.add(w),f(k)},v=()=>{f(new Set(t.map(w=>w.id)))},y=()=>{f(new Set)},b=async()=>{if(h.size===0){alert("Please select at least one job to recover");return}if(confirm(`Recover ${h.size} orphaned ${h.size===1?"design":"designs"}?`)){d(!0),l(null);try{const w=await g(),k=await fetch("/api/admin/recovery/create",{method:"POST",headers:w,body:JSON.stringify({job_ids:Array.from(h)})}),S=await k.json();if(!k.ok)throw new Error(S.error||"Failed to recover designs");alert(`Successfully recovered ${S.recovered_count} ${S.recovered_count===1?"design":"designs"}!`),y(),await m()}catch(w){console.error("Failed to recover designs:",w),l(w.message),alert(`Recovery failed: ${w.message}`)}finally{d(!1)}}};return a.jsxs("div",{className:"recovery-tab",children:[a.jsxs("div",{className:"admin-stats-grid",children:[a.jsxs("div",{className:"admin-stat-card warning",children:[a.jsx("h3",{children:"Total Orphaned"}),a.jsx("p",{className:"stat-value",children:t.length}),a.jsx("span",{className:"stat-label",children:"Designs not saved"})]}),r&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"admin-stat-card",children:[a.jsx("h3",{children:"<24 hours"}),a.jsx("p",{className:"stat-value",children:r["<24h"]}),a.jsx("span",{className:"stat-label",children:"Recent"})]}),a.jsxs("div",{className:"admin-stat-card",children:[a.jsx("h3",{children:"1-7 days"}),a.jsx("p",{className:"stat-value",children:r["1-7d"]}),a.jsx("span",{className:"stat-label",children:"This week"})]}),a.jsxs("div",{className:"admin-stat-card",children:[a.jsx("h3",{children:">7 days"}),a.jsx("p",{className:"stat-value",children:r["7-30d"]+r[">30d"]}),a.jsx("span",{className:"stat-label",children:"Older"})]})]})]}),a.jsxs("div",{className:"recovery-controls",children:[a.jsx("div",{className:"admin-filters",children:a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Age:"}),a.jsxs("select",{value:u,onChange:w=>p(w.target.value),children:[a.jsx("option",{value:"all",children:"All"}),a.jsx("option",{value:"24h",children:"<24 hours"}),a.jsx("option",{value:"7d",children:"<7 days"}),a.jsx("option",{value:"30d",children:"<30 days"})]})]})}),a.jsxs("div",{className:"bulk-actions",children:[a.jsx("button",{onClick:v,className:"btn-secondary",children:"Select All"}),a.jsxs("button",{onClick:y,className:"btn-secondary",children:["Clear (",h.size,")"]}),a.jsx("button",{onClick:b,disabled:h.size===0||c,className:"btn-primary",children:c?"Recovering...":`Recover Selected (${h.size})`})]})]}),i&&a.jsxs("div",{className:"admin-loading",children:[a.jsx("div",{className:"spinner"}),a.jsx("p",{children:"Loading orphaned jobs..."})]}),s&&a.jsx("div",{className:"admin-error",children:a.jsxs("p",{children:["Error: ",s]})}),!i&&t.length>0&&a.jsx("div",{className:"recovery-table-container",children:a.jsxs("table",{className:"recovery-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{width:"40px"},children:a.jsx("input",{type:"checkbox",checked:h.size===t.length,onChange:w=>w.target.checked?v():y()})}),a.jsx("th",{children:"Thumbnail"}),a.jsx("th",{children:"Prompt / Auto-name"}),a.jsx("th",{children:"Dimensions"}),a.jsx("th",{children:"Age"}),a.jsx("th",{children:"User"})]})}),a.jsx("tbody",{children:t.map(w=>a.jsxs("tr",{className:h.has(w.id)?"selected":"",onClick:()=>x(w.id),children:[a.jsx("td",{onClick:k=>k.stopPropagation(),children:a.jsx("input",{type:"checkbox",checked:h.has(w.id),onChange:()=>x(w.id)})}),a.jsx("td",{className:"thumbnail-cell",children:w.thumbnail_url?a.jsx("img",{src:w.thumbnail_url,alt:"Design",className:"job-thumbnail"}):a.jsx("div",{className:"thumbnail-placeholder",children:"No image"})}),a.jsxs("td",{className:"prompt-cell",children:[a.jsx("div",{className:"prompt-text",title:w.prompt,children:w.auto_name}),w.prompt&&w.prompt.length>50&&a.jsx("div",{className:"prompt-full",children:w.prompt})]}),a.jsx("td",{className:"dimensions-cell",children:w.width_mm&&w.length_mm?a.jsxs("span",{children:[w.width_mm,"  ",w.length_mm," mm"]}):a.jsx("em",{children:"N/A"})}),a.jsx("td",{className:"age-cell",children:a.jsxs("span",{className:`age-badge ${w.age_bucket.replace(/[<>]/g,"")}`,children:[w.age_days," ",w.age_days===1?"day":"days"]})}),a.jsx("td",{className:"user-cell",children:w.user_email})]},w.id))})]})}),!i&&t.length===0&&a.jsx("div",{className:"admin-empty",children:a.jsx("p",{children:"No orphaned jobs found. All designs have been saved!"})}),a.jsx("style",{children:`
        .recovery-controls {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 1.5rem;
          flex-wrap: wrap;
          gap: 1rem;
        }

        .bulk-actions {
          display: flex;
          gap: 0.5rem;
        }

        .btn-primary {
          padding: 0.5rem 1rem;
          background: #ff6b35;
          color: white;
          border: none;
          border-radius: 4px;
          font-weight: 500;
          cursor: pointer;
        }

        .btn-primary:hover:not(:disabled) {
          background: #e55a2b;
        }

        .btn-primary:disabled {
          background: #d1d5db;
          cursor: not-allowed;
        }

        .btn-secondary {
          padding: 0.5rem 1rem;
          background: white;
          color: #374151;
          border: 1px solid #d1d5db;
          border-radius: 4px;
          font-weight: 500;
          cursor: pointer;
        }

        .btn-secondary:hover {
          background: #f9fafb;
        }

        .recovery-table-container {
          overflow-x: auto;
          background: white;
          border-radius: 8px;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .recovery-table {
          width: 100%;
          border-collapse: collapse;
        }

        .recovery-table th {
          background: #f9fafb;
          padding: 1rem;
          text-align: left;
          font-weight: 600;
          font-size: 0.875rem;
          color: #374151;
          border-bottom: 1px solid #e5e7eb;
        }

        .recovery-table td {
          padding: 1rem;
          border-bottom: 1px solid #e5e7eb;
        }

        .recovery-table tbody tr {
          cursor: pointer;
          transition: background 0.15s;
        }

        .recovery-table tbody tr:hover {
          background: #f9fafb;
        }

        .recovery-table tbody tr.selected {
          background: #eff6ff;
        }

        .age-badge {
          display: inline-block;
          padding: 0.25rem 0.75rem;
          border-radius: 9999px;
          font-size: 0.75rem;
          font-weight: 500;
        }

        .age-badge.24h {
          background: #fee2e2;
          color: #991b1b;
        }

        .age-badge.1-7d {
          background: #fed7aa;
          color: #92400e;
        }

        .age-badge.7-30d {
          background: #fef3c7;
          color: #78350f;
        }

        .age-badge.30d {
          background: #e5e7eb;
          color: #374151;
        }

        .prompt-full {
          font-size: 0.75rem;
          color: #6b7280;
          margin-top: 0.25rem;
          display: none;
        }

        .recovery-table tbody tr:hover .prompt-full {
          display: block;
        }
      `})]})}function sU({onClose:t}){const[e,r]=A.useState("overview"),[n,i]=A.useState(!0),[o,s]=A.useState(null),[l,c]=A.useState(null),[d,h]=A.useState([]),[f,u]=A.useState([]),[p,g]=A.useState(0),[m,x]=A.useState(null),v=async()=>{var T,R;const S=await Pt.auth.getSession();return{"Content-Type":"application/json",Authorization:`Bearer ${(R=(T=S==null?void 0:S.data)==null?void 0:T.session)==null?void 0:R.access_token}`}},y=async()=>{try{const S=await v(),C=await fetch("/api/admin/analytics/overview",{headers:S}),T=await C.json();if(!C.ok)throw new Error(T.error||"Failed to fetch overview");c(T.stats)}catch(S){console.error("Failed to fetch overview:",S),s(S.message)}},b=async()=>{try{const S=await v(),C=await fetch("/api/admin/users",{headers:S}),T=await C.json();if(!C.ok)throw new Error(T.error||"Failed to fetch users");h(T.users)}catch(S){console.error("Failed to fetch users:",S),s(S.message)}},w=async()=>{try{const S=await v(),C=await fetch("/api/admin/designs?limit=50",{headers:S}),T=await C.json();if(!C.ok)throw new Error(T.error||"Failed to fetch designs");u(T.designs),g(T.total)}catch(S){console.error("Failed to fetch designs:",S),s(S.message)}},k=async()=>{try{const S=await v(),C=await fetch("/api/admin/analytics/colours",{headers:S}),T=await C.json();if(!C.ok)throw new Error(T.error||"Failed to fetch colour analytics");x(T.analytics)}catch(S){console.error("Failed to fetch colours:",S),s(S.message)}};return A.useEffect(()=>{(async()=>{i(!0),await y(),i(!1)})()},[]),A.useEffect(()=>{e==="users"&&d.length===0?b():e==="designs"&&f.length===0?w():e==="colours"&&!m&&k()},[e]),n?a.jsxs("div",{className:"admin-loading",children:[a.jsx("div",{className:"spinner"}),a.jsx("p",{children:"Loading admin dashboard..."})]}):o?a.jsxs("div",{className:"admin-error",children:[a.jsx("h2",{children:"Access Denied"}),a.jsx("p",{children:o}),a.jsx("p",{children:"You need admin privileges to view this page."})]}):a.jsxs("div",{className:"admin-dashboard",children:[a.jsxs("header",{className:"admin-header",children:[a.jsxs("div",{className:"admin-header-left",children:[a.jsxs("button",{onClick:t,className:"btn-back",children:[a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7"})}),"Back to Studio"]}),a.jsx("h1",{children:"TPV Studio Admin"})]}),a.jsxs("nav",{className:"admin-nav",children:[a.jsx("button",{className:e==="overview"?"active":"",onClick:()=>r("overview"),children:"Overview"}),a.jsx("button",{className:e==="generations"?"active":"",onClick:()=>r("generations"),children:"Generations"}),a.jsx("button",{className:e==="recovery"?"active":"",onClick:()=>r("recovery"),children:"Recovery"}),a.jsx("button",{className:e==="users"?"active":"",onClick:()=>r("users"),children:"Users"}),a.jsx("button",{className:e==="designs"?"active":"",onClick:()=>r("designs"),children:"Designs"}),a.jsx("button",{className:e==="colours"?"active":"",onClick:()=>r("colours"),children:"Colour Analytics"})]})]}),a.jsxs("main",{className:"admin-content",children:[e==="overview"&&l&&a.jsx(aU,{stats:l}),e==="generations"&&a.jsx(iU,{}),e==="recovery"&&a.jsx(oU,{}),e==="users"&&a.jsx(lU,{users:d}),e==="designs"&&a.jsx(cU,{designs:f,total:p}),e==="colours"&&m&&a.jsx(dU,{analytics:m})]}),a.jsx("style",{jsx:!0,children:`
        .admin-dashboard {
          min-height: 100vh;
          background: #f8fafc;
        }

        .admin-header {
          background: white;
          border-bottom: 1px solid #e5e7eb;
          padding: 20px 40px;
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
        }

        .admin-header-left {
          display: flex;
          flex-direction: column;
          gap: 8px;
        }

        .btn-back {
          display: inline-flex;
          align-items: center;
          gap: 6px;
          padding: 6px 12px;
          background: #f3f4f6;
          border: 1px solid #e5e7eb;
          border-radius: 6px;
          font-size: 13px;
          color: #6b7280;
          cursor: pointer;
          transition: all 0.2s;
          width: fit-content;
        }

        .btn-back:hover {
          background: #e5e7eb;
          color: #374151;
        }

        .admin-header h1 {
          margin: 0;
          font-size: 24px;
          color: #1e4a7a;
        }

        .admin-nav {
          display: flex;
          gap: 8px;
        }

        .admin-nav button {
          padding: 8px 16px;
          border: 1px solid #e5e7eb;
          background: white;
          border-radius: 6px;
          cursor: pointer;
          font-size: 14px;
          color: #64748b;
          transition: all 0.2s;
        }

        .admin-nav button:hover {
          background: #f8fafc;
          color: #1e4a7a;
        }

        .admin-nav button.active {
          background: #1e4a7a;
          color: white;
          border-color: #1e4a7a;
        }

        .admin-content {
          padding: 24px 40px;
        }

        .admin-loading,
        .admin-error {
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          min-height: 50vh;
          text-align: center;
        }

        .admin-error h2 {
          color: #dc2626;
        }

        .spinner {
          width: 40px;
          height: 40px;
          border: 3px solid #e5e7eb;
          border-top-color: #1e4a7a;
          border-radius: 50%;
          animation: spin 0.8s linear infinite;
          margin-bottom: 16px;
        }

        @keyframes spin {
          to { transform: rotate(360deg); }
        }
      `})]})}function aU({stats:t}){return a.jsxs("div",{className:"overview-panel",children:[a.jsx("h2",{children:"Dashboard Overview"}),a.jsxs("div",{className:"stats-grid",children:[a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-value",children:t.totals.users}),a.jsx("div",{className:"stat-label",children:"Total Users"})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-value",children:t.totals.designs}),a.jsx("div",{className:"stat-label",children:"Total Designs"})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-value",children:t.totals.projects}),a.jsx("div",{className:"stat-label",children:"Total Projects"})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-value",children:t.totals.jobs}),a.jsx("div",{className:"stat-label",children:"AI Jobs Run"})]})]}),a.jsxs("div",{className:"stats-grid",children:[a.jsxs("div",{className:"stat-card highlight",children:[a.jsx("div",{className:"stat-value",children:t.activity.active_users_30d}),a.jsx("div",{className:"stat-label",children:"Active Users (30d)"})]}),a.jsxs("div",{className:"stat-card highlight",children:[a.jsx("div",{className:"stat-value",children:t.activity.designs_7d}),a.jsx("div",{className:"stat-label",children:"Designs This Week"})]}),a.jsxs("div",{className:"stat-card highlight",children:[a.jsx("div",{className:"stat-value",children:t.activity.designs_30d}),a.jsx("div",{className:"stat-label",children:"Designs This Month"})]}),a.jsxs("div",{className:"stat-card highlight",children:[a.jsxs("div",{className:"stat-value",children:[t.activity.job_success_rate,"%"]}),a.jsx("div",{className:"stat-label",children:"Job Success Rate"})]})]}),a.jsx("h3",{children:"Activity Timeline (14 Days)"}),a.jsx("div",{className:"activity-chart",children:t.timeline.map((e,r)=>a.jsxs("div",{className:"bar-container",children:[a.jsx("div",{className:"bar",style:{height:`${Math.max(4,e.count*20)}px`},title:`${e.date}: ${e.count} designs`}),a.jsx("div",{className:"bar-label",children:e.date.split("-")[2]})]},r))}),a.jsxs("div",{className:"breakdowns",children:[a.jsxs("div",{className:"breakdown-card",children:[a.jsx("h4",{children:"Input Mode"}),a.jsxs("div",{className:"breakdown-items",children:[a.jsxs("div",{className:"breakdown-item",children:[a.jsx("span",{children:"Prompt"}),a.jsx("strong",{children:t.breakdowns.input_mode.prompt})]}),a.jsxs("div",{className:"breakdown-item",children:[a.jsx("span",{children:"Image Upload"}),a.jsx("strong",{children:t.breakdowns.input_mode.image})]}),a.jsxs("div",{className:"breakdown-item",children:[a.jsx("span",{children:"SVG Upload"}),a.jsx("strong",{children:t.breakdowns.input_mode.svg})]})]})]}),a.jsxs("div",{className:"breakdown-card",children:[a.jsx("h4",{children:"View Mode Preference"}),a.jsxs("div",{className:"breakdown-items",children:[a.jsxs("div",{className:"breakdown-item",children:[a.jsx("span",{children:"Solid TPV"}),a.jsx("strong",{children:t.breakdowns.view_mode.solid})]}),a.jsxs("div",{className:"breakdown-item",children:[a.jsx("span",{children:"Blend TPV"}),a.jsx("strong",{children:t.breakdowns.view_mode.blend})]})]})]})]}),a.jsx("style",{jsx:!0,children:`
        .overview-panel h2 {
          margin: 0 0 24px 0;
          color: #1a202c;
        }

        .overview-panel h3 {
          margin: 32px 0 16px 0;
          color: #1a202c;
        }

        .stats-grid {
          display: grid;
          grid-template-columns: repeat(4, 1fr);
          gap: 16px;
          margin-bottom: 16px;
        }

        .stat-card {
          background: white;
          padding: 20px;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
        }

        .stat-card.highlight {
          border-color: #1e4a7a;
          border-width: 2px;
        }

        .stat-value {
          font-size: 32px;
          font-weight: 700;
          color: #1e4a7a;
        }

        .stat-label {
          font-size: 14px;
          color: #64748b;
          margin-top: 4px;
        }

        .activity-chart {
          display: flex;
          align-items: flex-end;
          gap: 8px;
          height: 120px;
          padding: 16px;
          background: white;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
        }

        .bar-container {
          flex: 1;
          display: flex;
          flex-direction: column;
          align-items: center;
        }

        .bar {
          width: 100%;
          background: #1e4a7a;
          border-radius: 4px 4px 0 0;
          min-height: 4px;
        }

        .bar-label {
          font-size: 10px;
          color: #64748b;
          margin-top: 4px;
        }

        .breakdowns {
          display: grid;
          grid-template-columns: repeat(2, 1fr);
          gap: 16px;
          margin-top: 24px;
        }

        .breakdown-card {
          background: white;
          padding: 20px;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
        }

        .breakdown-card h4 {
          margin: 0 0 12px 0;
          color: #1a202c;
        }

        .breakdown-item {
          display: flex;
          justify-content: space-between;
          padding: 8px 0;
          border-bottom: 1px solid #f3f4f6;
        }

        .breakdown-item:last-child {
          border-bottom: none;
        }

        .breakdown-item span {
          color: #64748b;
        }

        .breakdown-item strong {
          color: #1a202c;
        }
      `})]})}function lU({users:t}){return a.jsxs("div",{className:"users-panel",children:[a.jsxs("h2",{children:["User Management (",t.length," users)"]}),a.jsxs("table",{className:"users-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Email"}),a.jsx("th",{children:"Role"}),a.jsx("th",{children:"Designs"}),a.jsx("th",{children:"Projects"}),a.jsx("th",{children:"Jobs"}),a.jsx("th",{children:"Last Design"}),a.jsx("th",{children:"Joined"})]})}),a.jsx("tbody",{children:t.map(e=>a.jsxs("tr",{children:[a.jsx("td",{children:e.email}),a.jsx("td",{children:a.jsx("span",{className:`role-badge ${e.role}`,children:e.role})}),a.jsx("td",{children:e.design_count}),a.jsx("td",{children:e.project_count}),a.jsx("td",{children:e.job_count}),a.jsx("td",{children:e.last_design_at?new Date(e.last_design_at).toLocaleDateString():"-"}),a.jsx("td",{children:new Date(e.created_at).toLocaleDateString()})]},e.id))})]}),a.jsx("style",{jsx:!0,children:`
        .users-panel h2 {
          margin: 0 0 24px 0;
          color: #1a202c;
        }

        .users-table {
          width: 100%;
          background: white;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
          border-collapse: collapse;
        }

        .users-table th,
        .users-table td {
          padding: 12px 16px;
          text-align: left;
          border-bottom: 1px solid #e5e7eb;
        }

        .users-table th {
          background: #f8fafc;
          font-weight: 600;
          color: #64748b;
          font-size: 12px;
          text-transform: uppercase;
        }

        .users-table td {
          font-size: 14px;
          color: #1a202c;
        }

        .role-badge {
          padding: 4px 8px;
          border-radius: 4px;
          font-size: 12px;
          font-weight: 500;
        }

        .role-badge.user {
          background: #f3f4f6;
          color: #64748b;
        }

        .role-badge.admin {
          background: #dbeafe;
          color: #1e40af;
        }

        .role-badge.superadmin {
          background: #fef3c7;
          color: #92400e;
        }
      `})]})}function cU({designs:t,total:e}){return a.jsxs("div",{className:"designs-panel",children:[a.jsxs("h2",{children:["All Designs (",e," total)"]}),a.jsx("div",{className:"designs-grid",children:t.map(r=>a.jsxs("div",{className:"design-card",children:[a.jsx("div",{className:"design-thumbnail",children:r.thumbnail_url||r.original_png_url?a.jsx("img",{src:r.thumbnail_url||r.original_png_url,alt:r.name}):a.jsx("div",{className:"no-image",children:"No preview"})}),a.jsxs("div",{className:"design-info",children:[a.jsx("h4",{children:r.name}),a.jsx("p",{className:"design-user",children:r.user_email}),a.jsx("p",{className:"design-date",children:new Date(r.created_at).toLocaleDateString()}),r.project&&a.jsx("span",{className:"project-badge",style:{backgroundColor:r.project.color||"#64748b"},children:r.project.name})]})]},r.id))}),a.jsx("style",{jsx:!0,children:`
        .designs-panel h2 {
          margin: 0 0 24px 0;
          color: #1a202c;
        }

        .designs-grid {
          display: grid;
          grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
          gap: 16px;
        }

        .design-card {
          background: white;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
          overflow: hidden;
        }

        .design-thumbnail {
          aspect-ratio: 1;
          background: #f3f4f6;
          overflow: hidden;
        }

        .design-thumbnail img {
          width: 100%;
          height: 100%;
          object-fit: cover;
        }

        .no-image {
          width: 100%;
          height: 100%;
          display: flex;
          align-items: center;
          justify-content: center;
          color: #9ca3af;
          font-size: 14px;
        }

        .design-info {
          padding: 12px;
        }

        .design-info h4 {
          margin: 0 0 4px 0;
          font-size: 14px;
          color: #1a202c;
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
        }

        .design-user {
          margin: 0;
          font-size: 12px;
          color: #64748b;
        }

        .design-date {
          margin: 4px 0;
          font-size: 12px;
          color: #9ca3af;
        }

        .project-badge {
          display: inline-block;
          padding: 2px 8px;
          border-radius: 10px;
          font-size: 10px;
          color: white;
        }
      `})]})}function dU({analytics:t}){return a.jsxs("div",{className:"colours-panel",children:[a.jsx("h2",{children:"Colour Usage Analytics"}),a.jsxs("div",{className:"colour-stats",children:[a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-value",children:t.totals.designs_analysed}),a.jsx("div",{className:"stat-label",children:"Designs Analysed"})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-value",children:t.totals.colour_usages}),a.jsx("div",{className:"stat-label",children:"Total Colour Uses"})]})]}),a.jsx("h3",{children:"Top 10 TPV Colours"}),a.jsx("div",{className:"colour-list",children:t.top_colours.map((e,r)=>a.jsxs("div",{className:"colour-item",children:[a.jsxs("span",{className:"colour-rank",children:["#",r+1]}),a.jsx("div",{className:"colour-swatch",style:{backgroundColor:e.hex}}),a.jsxs("div",{className:"colour-info",children:[a.jsx("strong",{children:e.code}),a.jsx("span",{children:e.name})]}),a.jsxs("div",{className:"colour-count",children:[e.count," uses"]})]},e.code))}),a.jsx("h3",{children:"Colour Family Breakdown"}),a.jsx("div",{className:"family-bars",children:Object.entries(t.families).map(([e,r])=>a.jsxs("div",{className:"family-bar",children:[a.jsx("span",{className:"family-name",children:e}),a.jsx("div",{className:"bar-bg",children:a.jsx("div",{className:"bar-fill",style:{width:`${r/t.totals.colour_usages*100}%`,backgroundColor:uU(e)}})}),a.jsx("span",{className:"family-count",children:r})]},e))}),t.top_blends.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{children:"Top Blend Combinations"}),a.jsx("div",{className:"blend-list",children:t.top_blends.map((e,r)=>a.jsxs("div",{className:"blend-item",children:[a.jsx("div",{className:"blend-swatches",children:e.components.map((n,i)=>a.jsx("div",{className:"blend-swatch",style:{backgroundColor:n.hex},title:`${n.code} - ${n.name}`},i))}),a.jsx("div",{className:"blend-codes",children:e.components.map(n=>n.code).join(" + ")}),a.jsxs("div",{className:"blend-count",children:[e.count," uses"]})]},r))})]}),a.jsx("style",{jsx:!0,children:`
        .colours-panel h2 {
          margin: 0 0 24px 0;
          color: #1a202c;
        }

        .colours-panel h3 {
          margin: 32px 0 16px 0;
          color: #1a202c;
        }

        .colour-stats {
          display: grid;
          grid-template-columns: repeat(2, 1fr);
          gap: 16px;
          margin-bottom: 24px;
        }

        .stat-card {
          background: white;
          padding: 20px;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
        }

        .stat-value {
          font-size: 32px;
          font-weight: 700;
          color: #1e4a7a;
        }

        .stat-label {
          font-size: 14px;
          color: #64748b;
          margin-top: 4px;
        }

        .colour-list {
          background: white;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
          overflow: hidden;
        }

        .colour-item {
          display: flex;
          align-items: center;
          gap: 12px;
          padding: 12px 16px;
          border-bottom: 1px solid #f3f4f6;
        }

        .colour-item:last-child {
          border-bottom: none;
        }

        .colour-rank {
          width: 30px;
          font-size: 12px;
          color: #9ca3af;
        }

        .colour-swatch {
          width: 32px;
          height: 32px;
          border-radius: 6px;
          border: 1px solid #e5e7eb;
        }

        .colour-info {
          flex: 1;
        }

        .colour-info strong {
          display: block;
          color: #1a202c;
        }

        .colour-info span {
          font-size: 12px;
          color: #64748b;
        }

        .colour-count {
          font-weight: 600;
          color: #1e4a7a;
        }

        .family-bars {
          background: white;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
          padding: 16px;
        }

        .family-bar {
          display: flex;
          align-items: center;
          gap: 12px;
          margin-bottom: 12px;
        }

        .family-bar:last-child {
          margin-bottom: 0;
        }

        .family-name {
          width: 80px;
          font-size: 14px;
          color: #64748b;
          text-transform: capitalize;
        }

        .bar-bg {
          flex: 1;
          height: 20px;
          background: #f3f4f6;
          border-radius: 4px;
          overflow: hidden;
        }

        .bar-fill {
          height: 100%;
          border-radius: 4px;
        }

        .family-count {
          width: 50px;
          text-align: right;
          font-weight: 600;
          color: #1a202c;
        }

        .blend-list {
          background: white;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
          overflow: hidden;
        }

        .blend-item {
          display: flex;
          align-items: center;
          gap: 12px;
          padding: 12px 16px;
          border-bottom: 1px solid #f3f4f6;
        }

        .blend-item:last-child {
          border-bottom: none;
        }

        .blend-swatches {
          display: flex;
          gap: 4px;
        }

        .blend-swatch {
          width: 24px;
          height: 24px;
          border-radius: 4px;
          border: 1px solid #e5e7eb;
        }

        .blend-codes {
          flex: 1;
          font-size: 14px;
          color: #1a202c;
        }

        .blend-count {
          font-weight: 600;
          color: #1e4a7a;
        }
      `})]})}function uU(t){return{reds:"#dc2626",greens:"#16a34a",blues:"#2563eb",yellows:"#ca8a04",neutrals:"#6b7280"}[t]||"#6b7280"}const Fu=[{code:"RH30",name:"Beige",hex:"#E4C4AA"},{code:"RH31",name:"Cream",hex:"#E8E3D8"},{code:"RH41",name:"Bright Yellow",hex:"#FFD833"},{code:"RH40",name:"Mustard",hex:"#E5A144"},{code:"RH50",name:"Orange",hex:"#F15B32"},{code:"RH01",name:"Standard Red",hex:"#A5362F"},{code:"RH02",name:"Bright Red",hex:"#E21F2F"},{code:"RH90",name:"Funky Pink",hex:"#E8457E"},{code:"RH21",name:"Purple",hex:"#493D8C"},{code:"RH20",name:"Standard Blue",hex:"#0075BC"},{code:"RH22",name:"Light Blue",hex:"#47AFE3"},{code:"RH23",name:"Azure",hex:"#039DC4"},{code:"RH26",name:"Turquoise",hex:"#00A6A3"},{code:"RH12",name:"Dark Green",hex:"#006C55"},{code:"RH10",name:"Standard Green",hex:"#609B63"},{code:"RH11",name:"Bright Green",hex:"#3BB44A"},{code:"RH32",name:"Brown",hex:"#8B5F3C"},{code:"RH65",name:"Pale Grey",hex:"#D9D9D6"},{code:"RH61",name:"Light Grey",hex:"#939598"},{code:"RH60",name:"Dark Grey",hex:"#59595B"},{code:"RH70",name:"Black",hex:"#231F20"}],ay=["ocean theme with dolphins and waves","jungle adventure with parrots","solar system with planets","garden with butterflies and flowers","racing track with cars","underwater coral reef scene","dinosaur footprints trail","rainbow with clouds"],hU=[...Array(60)].map(t=>({delay:`${Math.random()*3}s`,x:`${Math.random()*100}%`,y:`${Math.random()*100}%`,size:`${8+Math.random()*12}px`}));function fU(){const[t,e]=A.useState(""),[r,n]=A.useState(""),[i,o]=A.useState(""),[s,l]=A.useState(!1),[c,d]=A.useState(!1),[h,f]=A.useState(0);A.useEffect(()=>{const g=setInterval(()=>{f(m=>(m+1)%ay.length)},5e3);return()=>clearInterval(g)},[]);const u=async g=>{g.preventDefault(),o(""),l(!0);try{await Qr.signIn(t,r)}catch(m){o(m.message||"Sign in failed")}finally{l(!1)}},p=g=>{var m;(m=document.getElementById(g))==null||m.scrollIntoView({behavior:"smooth"})};return a.jsxs("div",{className:"landing-page",children:[a.jsxs("nav",{className:"landing-nav",children:[a.jsxs("div",{className:"nav-logo",children:[a.jsx("span",{className:"logo-text",children:"TPV"}),a.jsx("span",{className:"logo-accent",children:"Studio"})]}),a.jsxs("div",{className:"nav-links",children:[a.jsx("button",{onClick:()=>p("features"),children:"Features"}),a.jsx("button",{onClick:()=>p("palette"),children:"Colours"}),a.jsx("button",{onClick:()=>d(!0),className:"nav-cta",children:"Sign In"})]})]}),a.jsxs("section",{className:"hero",children:[a.jsx("div",{className:"hero-background",children:a.jsx("div",{className:"granule-field",children:hU.map((g,m)=>a.jsx("div",{className:"granule",style:{"--delay":g.delay,"--x":g.x,"--y":g.y,"--color":Fu[m%Fu.length].hex,"--size":g.size}},m))})}),a.jsxs("div",{className:"hero-content",children:[a.jsx("div",{className:"hero-badge",children:"TPV Surface Design Platform"}),a.jsxs("h1",{children:[a.jsx("span",{className:"hero-line-1",children:"Design Any"}),a.jsx("span",{className:"hero-line-2",children:"TPV Surface"})]}),a.jsx("p",{className:"hero-subtitle",children:"From AI-powered playgrounds to professional sports facilities  get production-ready TPV specifications in minutes."}),a.jsxs("div",{className:"hero-ctas",children:[a.jsxs("button",{onClick:()=>d(!0),className:"cta-primary",children:["Start Designing",a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M5 12h14M12 5l7 7-7 7"})})]}),a.jsx("button",{onClick:()=>p("how-it-works"),className:"cta-secondary",children:"See How It Works"})]})]}),a.jsx("div",{className:"hero-visual",children:a.jsx("div",{className:"mockup-container",children:a.jsxs("div",{className:"mockup-screen",children:[a.jsx("div",{className:"mockup-header",children:a.jsxs("div",{className:"mockup-dots",children:[a.jsx("span",{}),a.jsx("span",{}),a.jsx("span",{})]})}),a.jsxs("div",{className:"mockup-content",children:[a.jsx("div",{className:"mockup-input",children:a.jsx("span",{className:"typing-text",children:ay[h]},h)}),a.jsxs("div",{className:"mockup-preview",children:[a.jsx("div",{className:"preview-shape shape-1"}),a.jsx("div",{className:"preview-shape shape-2"}),a.jsx("div",{className:"preview-shape shape-3"})]})]})]})})})]}),a.jsxs("section",{className:"choose-designer",children:[a.jsxs("div",{className:"section-header",children:[a.jsx("span",{className:"section-tag",children:"Two Powerful Tools"}),a.jsx("h2",{children:"Choose Your Designer"})]}),a.jsxs("div",{className:"designer-cards",children:[a.jsxs("div",{className:"designer-card playground-card",children:[a.jsx("div",{className:"card-icon",children:a.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2z"})})}),a.jsx("div",{className:"card-badge",children:"AI-Powered"}),a.jsx("h3",{children:"Playground Designer"}),a.jsx("p",{className:"card-tagline",children:"Creative Design with AI"}),a.jsx("p",{className:"card-description",children:"Describe your vision in words or upload an image. Our AI generates production-ready vector designs with automatic TPV colour matching."}),a.jsxs("ul",{className:"card-features",children:[a.jsxs("li",{children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}),"Text-to-vector AI generation"]}),a.jsxs("li",{children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}),"Image & SVG upload"]}),a.jsxs("li",{children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}),"Automatic colour matching"]}),a.jsxs("li",{children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}),"Click-to-edit regions"]})]}),a.jsxs("div",{className:"card-visual playground-visual",children:[a.jsx("div",{className:"visual-shape v-shape-1"}),a.jsx("div",{className:"visual-shape v-shape-2"}),a.jsx("div",{className:"visual-shape v-shape-3"})]})]}),a.jsxs("div",{className:"designer-card sports-card",children:[a.jsx("div",{className:"card-icon",children:a.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"3",y:"14",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"14",width:"7",height:"7"})]})}),a.jsx("div",{className:"card-badge sports-badge",children:"Precision Tools"}),a.jsx("h3",{children:"Sports Designer"}),a.jsx("p",{className:"card-tagline",children:"Professional Sports Surfaces"}),a.jsx("p",{className:"card-description",children:"Build multi-sport facilities with precision. Drag-and-drop courts, running tracks, and custom layouts on any surface size."}),a.jsxs("ul",{className:"card-features",children:[a.jsxs("li",{children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}),"15+ court templates"]}),a.jsxs("li",{children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}),"Running track builder"]}),a.jsxs("li",{children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}),"Multi-sport layouts"]}),a.jsxs("li",{children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}),"Layer management"]})]}),a.jsx("div",{className:"card-visual sports-visual",children:a.jsxs("div",{className:"court-outline",children:[a.jsx("div",{className:"court-line court-line-h"}),a.jsx("div",{className:"court-line court-line-v"}),a.jsx("div",{className:"court-circle"})]})})]})]})]}),a.jsxs("section",{id:"how-it-works",className:"how-it-works",children:[a.jsxs("div",{className:"section-header",children:[a.jsx("span",{className:"section-tag",children:"Process"}),a.jsx("h2",{children:"Three Steps to Production-Ready Designs"})]}),a.jsxs("div",{className:"steps-container",children:[a.jsxs("div",{className:"step",children:[a.jsx("div",{className:"step-number",children:"01"}),a.jsx("div",{className:"step-icon",children:a.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("path",{d:"M3 9h18M9 21V9"})]})}),a.jsx("h3",{children:"Configure Your Canvas"}),a.jsx("p",{children:"Set your surface dimensions and choose your approach  AI generation, image upload, or template-based design."})]}),a.jsx("div",{className:"step-connector",children:a.jsx("svg",{viewBox:"0 0 100 20",preserveAspectRatio:"none",children:a.jsx("path",{d:"M0 10 Q50 10 100 10",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeDasharray:"4 4"})})}),a.jsxs("div",{className:"step",children:[a.jsx("div",{className:"step-number",children:"02"}),a.jsx("div",{className:"step-icon",children:a.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("circle",{cx:"13.5",cy:"6.5",r:"2.5"}),a.jsx("circle",{cx:"6.5",cy:"12.5",r:"2.5"}),a.jsx("circle",{cx:"17.5",cy:"17.5",r:"2.5"}),a.jsx("path",{d:"M13.5 9v3M9 12.5h3M15 17.5h-3"})]})}),a.jsx("h3",{children:"Design & Customise"}),a.jsx("p",{children:"Refine colours, adjust regions, add elements. Real-time preview shows your exact TPV granule appearance."})]}),a.jsx("div",{className:"step-connector",children:a.jsx("svg",{viewBox:"0 0 100 20",preserveAspectRatio:"none",children:a.jsx("path",{d:"M0 10 Q50 10 100 10",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeDasharray:"4 4"})})}),a.jsxs("div",{className:"step",children:[a.jsx("div",{className:"step-number",children:"03"}),a.jsx("div",{className:"step-icon",children:a.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("path",{d:"M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"}),a.jsx("path",{d:"M14 2v6h6M12 18v-6M9 15l3 3 3-3"})]})}),a.jsx("h3",{children:"Export Production Specs"}),a.jsx("p",{children:"Download PDF specifications with granule recipes, blend ratios, and installation-ready tile layouts."})]})]})]}),a.jsxs("section",{id:"features",className:"features",children:[a.jsxs("div",{className:"section-header",children:[a.jsx("span",{className:"section-tag",children:"Capabilities"}),a.jsx("h2",{children:"Everything You Need to Design TPV Surfaces"})]}),a.jsxs("div",{className:"features-grid",children:[a.jsxs("div",{className:"feature-card feature-highlight",children:[a.jsx("div",{className:"feature-icon",children:a.jsx("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2z"})})}),a.jsx("h3",{children:"AI Text-to-Vector"}),a.jsx("p",{children:"Describe any concept in natural language. Our AI transforms your words into production-ready vector designs optimised for TPV surfaces."}),a.jsx("div",{className:"feature-example",children:'"vibrant underwater scene with coral reef"'})]}),a.jsxs("div",{className:"feature-card",children:[a.jsx("div",{className:"feature-icon",children:a.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),a.jsx("h3",{children:"Image Vectorisation"}),a.jsx("p",{children:"Upload any PNG or JPG image and convert it to clean SVG vectors optimised for TPV production."})]}),a.jsxs("div",{className:"feature-card",children:[a.jsx("div",{className:"feature-icon",children:a.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("circle",{cx:"13.5",cy:"6.5",r:"2.5"}),a.jsx("circle",{cx:"17.5",cy:"10.5",r:"2.5"}),a.jsx("circle",{cx:"8.5",cy:"7.5",r:"2.5"}),a.jsx("circle",{cx:"6.5",cy:"12.5",r:"2.5"})]})}),a.jsx("h3",{children:"Auto Colour Matching"}),a.jsx("p",{children:"Automatic extraction and matching to the 21-colour TPV palette with optimal blend recipes."})]}),a.jsxs("div",{className:"feature-card",children:[a.jsx("div",{className:"feature-icon",children:a.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("path",{d:"M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"}),a.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"})]})}),a.jsx("h3",{children:"Region Editor"}),a.jsx("p",{children:"Click any colour region to customise. Real-time preview updates as you design."})]}),a.jsxs("div",{className:"feature-card",children:[a.jsx("div",{className:"feature-icon",children:a.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("path",{d:"M12 3v18M3 12h18"}),a.jsx("circle",{cx:"12",cy:"12",r:"9"})]})}),a.jsx("h3",{children:"Solid & Blend Modes"}),a.jsx("p",{children:"Choose between single-colour purity or multi-granule blends for precise colour accuracy."})]})]}),a.jsx("div",{className:"sports-features-header",children:a.jsx("span",{className:"section-tag sports-tag",children:"Sports Surface Tools"})}),a.jsxs("div",{className:"features-grid sports-features-grid",children:[a.jsxs("div",{className:"feature-card sports-feature",children:[a.jsx("div",{className:"feature-icon sports-icon",children:a.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("rect",{x:"2",y:"4",width:"20",height:"16",rx:"2"}),a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M2 12h4M18 12h4"})]})}),a.jsx("h3",{children:"Court Library"}),a.jsx("p",{children:"15+ professional court templates including basketball, tennis, netball, futsal, and more."})]}),a.jsxs("div",{className:"feature-card sports-feature",children:[a.jsx("div",{className:"feature-icon sports-icon",children:a.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("ellipse",{cx:"12",cy:"12",rx:"10",ry:"8"}),a.jsx("ellipse",{cx:"12",cy:"12",rx:"6",ry:"4"}),a.jsx("path",{d:"M12 4v2M12 18v2"})]})}),a.jsx("h3",{children:"Track Builder"}),a.jsx("p",{children:"Create running tracks with configurable lanes, staggered starts, and regulation dimensions."})]}),a.jsxs("div",{className:"feature-card sports-feature",children:[a.jsx("div",{className:"feature-icon sports-icon",children:a.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("path",{d:"M3 9h18M3 15h18M9 3v18M15 3v18"})]})}),a.jsx("h3",{children:"Multi-Sport Layouts"}),a.jsx("p",{children:"Combine multiple courts and tracks on a single surface with automatic alignment."})]}),a.jsxs("div",{className:"feature-card sports-feature",children:[a.jsx("div",{className:"feature-icon sports-icon",children:a.jsx("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"})})}),a.jsx("h3",{children:"Layer Management"}),a.jsx("p",{children:"Drag, rotate, and layer courts with precision controls and snap-to-grid alignment."})]})]}),a.jsx("div",{className:"sports-features-header",children:a.jsx("span",{className:"section-tag",children:"Shared Tools"})}),a.jsxs("div",{className:"features-grid shared-features-grid",children:[a.jsxs("div",{className:"feature-card",children:[a.jsx("div",{className:"feature-icon",children:a.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("path",{d:"M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"}),a.jsx("path",{d:"M14 2v6h6M12 18v-6M9 15l3 3 3-3"})]})}),a.jsx("h3",{children:"PDF Specifications"}),a.jsx("p",{children:"Export professional specification sheets with design preview, dimensions, and all recipes."})]}),a.jsxs("div",{className:"feature-card",children:[a.jsx("div",{className:"feature-icon",children:a.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("path",{d:"M23 19a2 2 0 01-2 2H3a2 2 0 01-2-2V8a2 2 0 012-2h4l2-3h6l2 3h4a2 2 0 012 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),a.jsx("h3",{children:"In-Situ Preview"}),a.jsx("p",{children:"Upload a site photo and see your design in context with realistic perspective adjustments."})]}),a.jsxs("div",{className:"feature-card",children:[a.jsx("div",{className:"feature-icon",children:a.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"3",y:"14",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"14",width:"7",height:"7"})]})}),a.jsx("h3",{children:"Installation Tiles"}),a.jsx("p",{children:"Download your design as 1m1m tiles in a ZIP file. Named A1, B2... for easy on-site layout."})]})]})]}),a.jsxs("section",{id:"palette",className:"palette-section",children:[a.jsxs("div",{className:"section-header light",children:[a.jsx("span",{className:"section-tag",children:"Palette"}),a.jsx("h2",{children:"21 Standard TPV Colours"}),a.jsx("p",{className:"section-subtitle",children:"The complete Rosehill TPV granule palette at your fingertips"})]}),a.jsx("div",{className:"palette-grid",children:Fu.map((g,m)=>a.jsxs("div",{className:"palette-swatch",style:{"--swatch-color":g.hex,"--delay":`${m*.03}s`},children:[a.jsx("div",{className:"swatch-color"}),a.jsxs("div",{className:"swatch-info",children:[a.jsx("span",{className:"swatch-name",children:g.name}),a.jsx("span",{className:"swatch-code",children:g.code})]})]},g.code))})]}),a.jsx("section",{className:"benefits",children:a.jsxs("div",{className:"benefits-grid benefits-grid-4",children:[a.jsxs("div",{className:"benefit",children:[a.jsx("div",{className:"benefit-metric",children:"10x"}),a.jsx("div",{className:"benefit-label",children:"Faster Design"}),a.jsx("p",{children:"What took hours now takes minutes with AI and templates."})]}),a.jsxs("div",{className:"benefit",children:[a.jsx("div",{className:"benefit-metric",children:"100%"}),a.jsx("div",{className:"benefit-label",children:"Production Accurate"}),a.jsx("p",{children:"Exact TPV granule specs with precise ratio specifications."})]}),a.jsxs("div",{className:"benefit",children:[a.jsx("div",{className:"benefit-metric",children:"15+"}),a.jsx("div",{className:"benefit-label",children:"Court Templates"}),a.jsx("p",{children:"Professional sports court and track templates ready to use."})]}),a.jsxs("div",{className:"benefit",children:[a.jsx("div",{className:"benefit-metric",children:"21"}),a.jsx("div",{className:"benefit-label",children:"Standard Colours"}),a.jsx("p",{children:"Complete Rosehill TPV palette with blend combinations."})]})]})}),a.jsx("section",{className:"cta-footer",children:a.jsxs("div",{className:"cta-content",children:[a.jsx("h2",{children:"Ready to Design Your Surface?"}),a.jsx("p",{children:"Create playgrounds or sports facilities with production-ready TPV specifications."}),a.jsxs("button",{onClick:()=>d(!0),className:"cta-primary large",children:["Sign In to TPV Studio",a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M5 12h14M12 5l7 7-7 7"})})]}),a.jsxs("p",{className:"cta-note",children:["Need an account? Contact ",a.jsx("a",{href:"mailto:info@rosehill.group",children:"info@rosehill.group"})]})]})}),c&&a.jsx("div",{className:"modal-overlay",onClick:()=>d(!1),children:a.jsxs("div",{className:"sign-in-modal",onClick:g=>g.stopPropagation(),children:[a.jsx("button",{className:"modal-close",onClick:()=>d(!1),children:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})}),a.jsxs("div",{className:"modal-header",children:[a.jsx("h2",{children:"Sign In"}),a.jsx("p",{children:"Access your TPV Studio account"})]}),i&&a.jsx("div",{className:"form-error",children:i}),a.jsxs("form",{onSubmit:u,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Email"}),a.jsx("input",{type:"email",value:t,onChange:g=>e(g.target.value),placeholder:"your.email@company.com",required:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Password"}),a.jsx("input",{type:"password",value:r,onChange:g=>n(g.target.value),required:!0})]}),a.jsx("button",{type:"submit",disabled:s,className:"submit-btn",children:s?"Signing in...":"Sign In"})]}),a.jsx("p",{className:"modal-footer-text",children:"Don't have an account? Contact your administrator."})]})}),a.jsx("style",{jsx:!0,children:`
        /* ============================================
           TPV STUDIO LANDING PAGE
           Aesthetic: Sophisticated Industrial-Creative
           ============================================ */

        @import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=DM+Sans:wght@400;500;600&display=swap');

        .landing-page {
          --primary: #1e4a7a;
          --primary-light: #2a5a8e;
          --accent: #ff6b35;
          --accent-hover: #e55a2a;
          --text: #1a202c;
          --text-secondary: #64748b;
          --text-light: #94a3b8;
          --bg: #fafbfc;
          --bg-dark: #0f172a;
          --card: #ffffff;
          --border: #e2e8f0;

          font-family: 'DM Sans', sans-serif;
          background: var(--bg);
          color: var(--text);
          overflow-x: hidden;
        }

        /* Navigation */
        .landing-nav {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          z-index: 1000;
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 1rem 3rem;
          background: rgba(255, 255, 255, 0.9);
          backdrop-filter: blur(12px);
          border-bottom: 1px solid var(--border);
        }

        .nav-logo {
          font-family: 'Space Grotesk', sans-serif;
          font-size: 1.5rem;
          font-weight: 700;
        }

        .logo-text {
          color: var(--primary);
        }

        .logo-accent {
          color: var(--accent);
        }

        .nav-links {
          display: flex;
          align-items: center;
          gap: 2rem;
        }

        .nav-links button {
          background: none;
          border: none;
          font-family: inherit;
          font-size: 0.875rem;
          font-weight: 500;
          color: var(--text-secondary);
          cursor: pointer;
          transition: color 0.2s;
        }

        .nav-links button:hover {
          color: var(--text);
        }

        .nav-cta {
          background: var(--primary) !important;
          color: white !important;
          padding: 0.5rem 1.25rem !important;
          border-radius: 6px !important;
        }

        .nav-cta:hover {
          background: var(--primary-light) !important;
        }

        /* Hero Section */
        .hero {
          min-height: 100vh;
          display: grid;
          grid-template-columns: 1fr 1fr;
          align-items: center;
          padding: 8rem 4rem 4rem;
          position: relative;
          overflow: hidden;
        }

        .hero-background {
          position: absolute;
          inset: 0;
          pointer-events: none;
        }

        .granule-field {
          position: absolute;
          inset: 0;
        }

        .granule {
          position: absolute;
          left: var(--x);
          top: var(--y);
          width: var(--size);
          height: var(--size);
          background: var(--color);
          border-radius: 50%;
          opacity: 0.15;
          animation: float 8s ease-in-out infinite;
          animation-delay: var(--delay);
        }

        @keyframes float {
          0%, 100% { transform: translateY(0) scale(1); }
          50% { transform: translateY(-20px) scale(1.1); }
        }

        .hero-content {
          position: relative;
          z-index: 10;
        }

        .hero-badge {
          display: inline-block;
          padding: 0.5rem 1rem;
          background: rgba(30, 74, 122, 0.1);
          color: var(--primary);
          font-size: 0.75rem;
          font-weight: 600;
          text-transform: uppercase;
          letter-spacing: 0.1em;
          border-radius: 50px;
          margin-bottom: 1.5rem;
        }

        .hero h1 {
          font-family: 'Space Grotesk', sans-serif;
          font-size: 3.5rem;
          font-weight: 700;
          line-height: 1.1;
          margin: 0 0 1.5rem;
        }

        .hero-line-1 {
          display: block;
          color: var(--text-secondary);
        }

        .hero-line-2 {
          display: block;
          color: var(--primary);
        }

        .hero-subtitle {
          font-size: 1.125rem;
          color: var(--text-secondary);
          line-height: 1.7;
          max-width: 480px;
          margin-bottom: 2rem;
        }

        .hero-ctas {
          display: flex;
          gap: 1rem;
        }

        .cta-primary {
          display: inline-flex;
          align-items: center;
          gap: 0.5rem;
          padding: 0.875rem 1.5rem;
          background: var(--accent);
          color: white;
          border: none;
          border-radius: 8px;
          font-family: inherit;
          font-size: 0.9375rem;
          font-weight: 600;
          cursor: pointer;
          transition: all 0.2s;
        }

        .cta-primary:hover {
          background: var(--accent-hover);
          transform: translateY(-2px);
          box-shadow: 0 8px 24px rgba(255, 107, 53, 0.3);
        }

        .cta-primary.large {
          padding: 1rem 2rem;
          font-size: 1rem;
        }

        .cta-secondary {
          padding: 0.875rem 1.5rem;
          background: white;
          color: var(--text);
          border: 2px solid var(--border);
          border-radius: 8px;
          font-family: inherit;
          font-size: 0.9375rem;
          font-weight: 600;
          cursor: pointer;
          transition: all 0.2s;
        }

        .cta-secondary:hover {
          border-color: var(--primary);
          color: var(--primary);
        }

        /* Hero Visual / Mockup */
        .hero-visual {
          position: relative;
          z-index: 10;
          display: flex;
          justify-content: center;
        }

        .mockup-container {
          perspective: 1000px;
        }

        .mockup-screen {
          width: 400px;
          background: white;
          border-radius: 12px;
          box-shadow: 0 24px 80px rgba(0, 0, 0, 0.15);
          overflow: hidden;
          transform: rotateY(-5deg) rotateX(2deg);
          animation: mockupFloat 6s ease-in-out infinite;
        }

        @keyframes mockupFloat {
          0%, 100% { transform: rotateY(-5deg) rotateX(2deg) translateY(0); }
          50% { transform: rotateY(-5deg) rotateX(2deg) translateY(-10px); }
        }

        .mockup-header {
          padding: 0.75rem 1rem;
          background: #f8f8f8;
          border-bottom: 1px solid #eee;
        }

        .mockup-dots {
          display: flex;
          gap: 6px;
        }

        .mockup-dots span {
          width: 10px;
          height: 10px;
          border-radius: 50%;
          background: #ddd;
        }

        .mockup-dots span:nth-child(1) { background: #ff5f56; }
        .mockup-dots span:nth-child(2) { background: #ffbd2e; }
        .mockup-dots span:nth-child(3) { background: #27ca41; }

        .mockup-content {
          padding: 1.5rem;
        }

        .mockup-input {
          background: #f5f5f5;
          padding: 1rem;
          border-radius: 8px;
          font-size: 0.875rem;
          color: var(--text-secondary);
          margin-bottom: 1.5rem;
          display: flex;
          align-items: center;
        }

        .typing-text {
          display: inline-block;
          overflow: hidden;
          white-space: nowrap;
          border-right: 2px solid var(--primary);
          animation: typing 5s steps(40, end) forwards, blink 0.7s step-end infinite;
        }

        @keyframes typing {
          0% { max-width: 0; }
          35% { max-width: 500px; }
          65% { max-width: 500px; }
          100% { max-width: 0; }
        }

        @keyframes blink {
          50% { border-color: transparent; }
        }

        .mockup-preview {
          height: 180px;
          background: linear-gradient(135deg, #e8f4f8, #f0f4ff);
          border-radius: 8px;
          position: relative;
          overflow: hidden;
        }

        .preview-shape {
          position: absolute;
          border-radius: 50%;
          animation: shapeReveal 4s ease-out infinite;
        }

        .shape-1 {
          width: 80px;
          height: 80px;
          background: var(--accent);
          opacity: 0.8;
          top: 20%;
          left: 15%;
          animation-delay: 0s;
        }

        .shape-2 {
          width: 60px;
          height: 60px;
          background: #30D5C8;
          opacity: 0.8;
          top: 40%;
          left: 50%;
          animation-delay: 0.3s;
        }

        .shape-3 {
          width: 100px;
          height: 100px;
          background: var(--primary);
          opacity: 0.8;
          top: 50%;
          right: 10%;
          animation-delay: 0.6s;
        }

        @keyframes shapeReveal {
          0%, 100% { transform: scale(0.8); opacity: 0.4; }
          50% { transform: scale(1); opacity: 0.8; }
        }

        /* Section Headers */
        .section-header {
          text-align: center;
          margin-bottom: 4rem;
        }

        .section-header.light h2,
        .section-header.light .section-subtitle {
          color: white;
        }

        .section-header.light .section-tag {
          background: rgba(255, 255, 255, 0.1);
          color: rgba(255, 255, 255, 0.9);
        }

        .section-tag {
          display: inline-block;
          padding: 0.375rem 0.875rem;
          background: rgba(30, 74, 122, 0.1);
          color: var(--primary);
          font-size: 0.6875rem;
          font-weight: 600;
          text-transform: uppercase;
          letter-spacing: 0.15em;
          border-radius: 50px;
          margin-bottom: 1rem;
        }

        .section-header h2 {
          font-family: 'Space Grotesk', sans-serif;
          font-size: 2.5rem;
          font-weight: 700;
          color: var(--text);
          margin: 0;
        }

        .section-subtitle {
          margin-top: 1rem;
          font-size: 1.125rem;
          color: var(--text-secondary);
        }

        /* How It Works */
        .how-it-works {
          padding: 6rem 4rem;
          background: white;
        }

        .steps-container {
          display: flex;
          align-items: flex-start;
          justify-content: center;
          gap: 1rem;
        }

        .step {
          flex: 1;
          max-width: 280px;
          text-align: center;
          padding: 2rem 1.5rem;
        }

        .step-number {
          font-family: 'Space Grotesk', sans-serif;
          font-size: 3rem;
          font-weight: 700;
          color: rgba(30, 74, 122, 0.1);
          margin-bottom: 1rem;
        }

        .step-icon {
          width: 64px;
          height: 64px;
          margin: 0 auto 1.5rem;
          display: flex;
          align-items: center;
          justify-content: center;
          background: rgba(255, 107, 53, 0.1);
          border-radius: 16px;
          color: var(--accent);
        }

        .step h3 {
          font-family: 'Space Grotesk', sans-serif;
          font-size: 1.25rem;
          font-weight: 600;
          margin: 0 0 0.75rem;
          color: var(--text);
        }

        .step p {
          font-size: 0.9375rem;
          color: var(--text-secondary);
          line-height: 1.6;
          margin: 0;
        }

        .step-connector {
          width: 100px;
          padding-top: 5rem;
          color: var(--border);
        }

        /* Features */
        .features {
          padding: 6rem 4rem;
          background: var(--bg);
        }

        .features-grid {
          display: grid;
          grid-template-columns: repeat(3, 1fr);
          gap: 1.5rem;
          max-width: 1200px;
          margin: 0 auto;
        }

        .feature-card {
          background: white;
          padding: 2rem;
          border-radius: 12px;
          border: 1px solid var(--border);
          transition: all 0.3s;
        }

        .feature-card:hover {
          transform: translateY(-4px);
          box-shadow: 0 12px 40px rgba(0, 0, 0, 0.08);
        }

        .feature-highlight {
          grid-column: span 2;
          background: linear-gradient(135deg, var(--primary), var(--primary-light));
          color: white;
          border: none;
        }

        .feature-highlight .feature-icon {
          background: rgba(255, 255, 255, 0.2);
          color: white;
        }

        .feature-highlight h3 {
          color: white;
        }

        .feature-highlight p {
          color: rgba(255, 255, 255, 0.9);
        }

        .feature-icon {
          width: 56px;
          height: 56px;
          display: flex;
          align-items: center;
          justify-content: center;
          background: rgba(30, 74, 122, 0.1);
          border-radius: 12px;
          color: var(--primary);
          margin-bottom: 1.25rem;
        }

        .feature-card h3 {
          font-family: 'Space Grotesk', sans-serif;
          font-size: 1.125rem;
          font-weight: 600;
          margin: 0 0 0.5rem;
        }

        .feature-card p {
          font-size: 0.875rem;
          color: var(--text-secondary);
          line-height: 1.6;
          margin: 0;
        }

        .feature-example {
          margin-top: 1.5rem;
          padding: 0.875rem 1rem;
          background: rgba(255, 255, 255, 0.1);
          border-radius: 8px;
          font-size: 0.8125rem;
          font-style: italic;
          opacity: 0.9;
        }

        /* Choose Your Designer Section */
        .choose-designer {
          padding: 6rem 4rem;
          background: white;
        }

        .designer-cards {
          display: grid;
          grid-template-columns: 1.1fr 0.9fr;
          gap: 2rem;
          max-width: 1100px;
          margin: 0 auto;
        }

        .designer-card {
          background: white;
          border-radius: 16px;
          padding: 2.5rem;
          border: 2px solid var(--border);
          transition: all 0.3s ease;
          position: relative;
          overflow: hidden;
        }

        .designer-card:hover {
          transform: translateY(-4px);
          box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
        }

        .playground-card:hover {
          border-color: var(--accent);
        }

        .sports-card:hover {
          border-color: #00a6a3;
        }

        .card-icon {
          width: 56px;
          height: 56px;
          display: flex;
          align-items: center;
          justify-content: center;
          background: rgba(255, 107, 53, 0.1);
          border-radius: 12px;
          color: var(--accent);
          margin-bottom: 1.25rem;
        }

        .sports-card .card-icon {
          background: rgba(0, 166, 163, 0.1);
          color: #00a6a3;
        }

        .card-badge {
          display: inline-block;
          padding: 0.25rem 0.75rem;
          background: rgba(255, 107, 53, 0.1);
          color: var(--accent);
          font-size: 0.6875rem;
          font-weight: 600;
          text-transform: uppercase;
          letter-spacing: 0.1em;
          border-radius: 50px;
          margin-bottom: 0.75rem;
        }

        .sports-badge {
          background: rgba(0, 166, 163, 0.1);
          color: #00a6a3;
        }

        .designer-card h3 {
          font-family: 'Space Grotesk', sans-serif;
          font-size: 1.5rem;
          font-weight: 700;
          color: var(--text);
          margin: 0 0 0.25rem;
        }

        .card-tagline {
          font-size: 1rem;
          font-weight: 500;
          color: var(--text-secondary);
          margin: 0 0 1rem;
        }

        .card-description {
          font-size: 0.9375rem;
          color: var(--text-secondary);
          line-height: 1.6;
          margin: 0 0 1.5rem;
        }

        .card-features {
          list-style: none;
          padding: 0;
          margin: 0 0 1.5rem;
        }

        .card-features li {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          font-size: 0.875rem;
          color: var(--text);
          padding: 0.375rem 0;
        }

        .card-features li svg {
          color: var(--accent);
          flex-shrink: 0;
        }

        .sports-card .card-features li svg {
          color: #00a6a3;
        }

        .card-visual {
          height: 120px;
          border-radius: 8px;
          position: relative;
          overflow: hidden;
        }

        .playground-visual {
          background: linear-gradient(135deg, #fef3ef, #fff5f0);
        }

        .sports-visual {
          background: linear-gradient(135deg, #e6f7f7, #f0fafa);
        }

        .visual-shape {
          position: absolute;
          border-radius: 50%;
          animation: floatShape 4s ease-in-out infinite;
        }

        .v-shape-1 {
          width: 50px;
          height: 50px;
          background: var(--accent);
          opacity: 0.7;
          top: 20%;
          left: 10%;
          animation-delay: 0s;
        }

        .v-shape-2 {
          width: 35px;
          height: 35px;
          background: #30D5C8;
          opacity: 0.7;
          top: 50%;
          left: 40%;
          animation-delay: 0.3s;
        }

        .v-shape-3 {
          width: 60px;
          height: 60px;
          background: var(--primary);
          opacity: 0.7;
          top: 30%;
          right: 15%;
          animation-delay: 0.6s;
        }

        @keyframes floatShape {
          0%, 100% { transform: translateY(0) scale(1); }
          50% { transform: translateY(-8px) scale(1.05); }
        }

        .court-outline {
          position: absolute;
          inset: 15%;
          border: 2px solid #00a6a3;
          border-radius: 4px;
          opacity: 0.6;
        }

        .court-line {
          position: absolute;
          background: #00a6a3;
        }

        .court-line-h {
          width: 100%;
          height: 2px;
          top: 50%;
          left: 0;
        }

        .court-line-v {
          width: 2px;
          height: 100%;
          left: 50%;
          top: 0;
        }

        .court-circle {
          position: absolute;
          width: 30px;
          height: 30px;
          border: 2px solid #00a6a3;
          border-radius: 50%;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
        }

        /* Sports Features Styling */
        .sports-features-header {
          text-align: center;
          margin: 3rem 0 2rem;
        }

        .sports-tag {
          background: rgba(0, 166, 163, 0.1);
          color: #00a6a3;
        }

        .sports-features-grid {
          grid-template-columns: repeat(4, 1fr);
        }

        .sports-feature {
          border-color: rgba(0, 166, 163, 0.2);
        }

        .sports-feature:hover {
          border-color: #00a6a3;
        }

        .sports-icon {
          background: rgba(0, 166, 163, 0.1);
          color: #00a6a3;
        }

        /* Shared Features Grid 3 columns */
        .shared-features-grid {
          grid-template-columns: repeat(3, 1fr);
        }

        /* Benefits Grid 4 columns */
        .benefits-grid-4 {
          grid-template-columns: repeat(4, 1fr);
        }

        /* Palette Section */
        .palette-section {
          padding: 6rem 4rem;
          background: var(--bg-dark);
        }

        .palette-grid {
          display: grid;
          grid-template-columns: repeat(7, 1fr);
          gap: 1rem;
          max-width: 1000px;
          margin: 0 auto;
        }

        .palette-swatch {
          animation: swatchReveal 0.5s ease-out forwards;
          animation-delay: var(--delay);
          opacity: 0;
          transform: translateY(20px);
        }

        @keyframes swatchReveal {
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        .swatch-color {
          aspect-ratio: 1;
          background: var(--swatch-color);
          border-radius: 8px;
          margin-bottom: 0.5rem;
          transition: transform 0.2s;
        }

        .palette-swatch:hover .swatch-color {
          transform: scale(1.1);
        }

        .swatch-info {
          text-align: center;
        }

        .swatch-name {
          display: block;
          font-size: 0.6875rem;
          font-weight: 500;
          color: white;
        }

        .swatch-code {
          display: block;
          font-size: 0.625rem;
          color: rgba(255, 255, 255, 0.5);
        }

        /* Benefits */
        .benefits {
          padding: 6rem 4rem;
          background: white;
        }

        .benefits-grid {
          display: grid;
          grid-template-columns: repeat(3, 1fr);
          gap: 3rem;
          max-width: 1000px;
          margin: 0 auto;
          text-align: center;
        }

        .benefit-metric {
          font-family: 'Space Grotesk', sans-serif;
          font-size: 4rem;
          font-weight: 700;
          color: var(--accent);
          line-height: 1;
        }

        .benefit-label {
          font-family: 'Space Grotesk', sans-serif;
          font-size: 1.125rem;
          font-weight: 600;
          color: var(--text);
          margin: 0.5rem 0 1rem;
        }

        .benefit p {
          font-size: 0.875rem;
          color: var(--text-secondary);
          line-height: 1.6;
          margin: 0;
        }

        /* CTA Footer */
        .cta-footer {
          padding: 6rem 4rem;
          background: var(--bg);
          text-align: center;
        }

        .cta-content h2 {
          font-family: 'Space Grotesk', sans-serif;
          font-size: 2.5rem;
          font-weight: 700;
          color: var(--text);
          margin: 0 0 1rem;
        }

        .cta-content > p {
          font-size: 1.125rem;
          color: var(--text-secondary);
          margin-bottom: 2rem;
        }

        .cta-note {
          margin-top: 1.5rem;
          font-size: 0.875rem;
          color: var(--text-light);
        }

        .cta-note a {
          color: var(--primary);
          text-decoration: none;
        }

        .cta-note a:hover {
          text-decoration: underline;
        }

        /* Modal */
        .modal-overlay {
          position: fixed;
          inset: 0;
          background: rgba(0, 0, 0, 0.5);
          backdrop-filter: blur(4px);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 2000;
          padding: 2rem;
        }

        .sign-in-modal {
          background: white;
          border-radius: 16px;
          padding: 2.5rem;
          width: 100%;
          max-width: 400px;
          position: relative;
          animation: modalSlide 0.3s ease-out;
        }

        @keyframes modalSlide {
          from {
            opacity: 0;
            transform: translateY(-20px);
          }
        }

        .modal-close {
          position: absolute;
          top: 1rem;
          right: 1rem;
          width: 32px;
          height: 32px;
          display: flex;
          align-items: center;
          justify-content: center;
          background: none;
          border: none;
          color: var(--text-light);
          cursor: pointer;
          border-radius: 6px;
          transition: all 0.2s;
        }

        .modal-close:hover {
          background: var(--bg);
          color: var(--text);
        }

        .modal-header {
          text-align: center;
          margin-bottom: 1.5rem;
        }

        .modal-header h2 {
          font-family: 'Space Grotesk', sans-serif;
          font-size: 1.5rem;
          font-weight: 600;
          margin: 0 0 0.25rem;
        }

        .modal-header p {
          font-size: 0.875rem;
          color: var(--text-secondary);
          margin: 0;
        }

        .form-error {
          padding: 0.75rem 1rem;
          background: #fef2f2;
          color: #dc2626;
          border-radius: 8px;
          font-size: 0.875rem;
          margin-bottom: 1rem;
        }

        .form-group {
          margin-bottom: 1rem;
        }

        .form-group label {
          display: block;
          font-size: 0.875rem;
          font-weight: 500;
          margin-bottom: 0.5rem;
        }

        .form-group input {
          width: 100%;
          padding: 0.75rem 1rem;
          border: 1px solid var(--border);
          border-radius: 8px;
          font-family: inherit;
          font-size: 0.9375rem;
          transition: all 0.2s;
        }

        .form-group input:focus {
          outline: none;
          border-color: var(--primary);
          box-shadow: 0 0 0 3px rgba(30, 74, 122, 0.1);
        }

        .submit-btn {
          width: 100%;
          padding: 0.875rem;
          background: var(--accent);
          color: white;
          border: none;
          border-radius: 8px;
          font-family: inherit;
          font-size: 0.9375rem;
          font-weight: 600;
          cursor: pointer;
          transition: all 0.2s;
        }

        .submit-btn:hover:not(:disabled) {
          background: var(--accent-hover);
        }

        .submit-btn:disabled {
          opacity: 0.6;
          cursor: not-allowed;
        }

        .modal-footer-text {
          text-align: center;
          font-size: 0.8125rem;
          color: var(--text-light);
          margin: 1.5rem 0 0;
        }

        /* Responsive */
        @media (max-width: 1024px) {
          .hero {
            grid-template-columns: 1fr;
            text-align: center;
          }

          .hero-content {
            max-width: 600px;
            margin: 0 auto;
          }

          .hero-subtitle {
            margin-left: auto;
            margin-right: auto;
          }

          .hero-ctas {
            justify-content: center;
          }

          .hero-visual {
            display: none;
          }

          .designer-cards {
            grid-template-columns: 1fr;
          }

          .features-grid {
            grid-template-columns: repeat(2, 1fr);
          }

          .sports-features-grid {
            grid-template-columns: repeat(2, 1fr);
          }

          .shared-features-grid {
            grid-template-columns: repeat(3, 1fr);
          }

          .feature-highlight {
            grid-column: span 2;
          }

          .benefits-grid-4 {
            grid-template-columns: repeat(2, 1fr);
          }

          .palette-grid {
            grid-template-columns: repeat(5, 1fr);
          }
        }

        @media (max-width: 768px) {
          .landing-nav {
            padding: 1rem 1.5rem;
          }

          .nav-links {
            gap: 1rem;
          }

          .hero {
            padding: 6rem 1.5rem 3rem;
          }

          .hero h1 {
            font-size: 2.5rem;
          }

          .steps-container {
            flex-direction: column;
            gap: 0;
          }

          .step-connector {
            display: none;
          }

          .features-grid {
            grid-template-columns: 1fr;
          }

          .feature-highlight {
            grid-column: span 1;
          }

          .section-header h2 {
            font-size: 2rem;
          }

          .how-it-works,
          .features,
          .palette-section,
          .benefits,
          .cta-footer,
          .choose-designer {
            padding: 4rem 1.5rem;
          }

          .sports-features-grid,
          .shared-features-grid {
            grid-template-columns: 1fr;
          }

          .benefits-grid,
          .benefits-grid-4 {
            grid-template-columns: 1fr;
            gap: 2rem;
          }

          .palette-grid {
            grid-template-columns: repeat(4, 1fr);
          }
        }

        @media (max-width: 480px) {
          .nav-links button:not(.nav-cta) {
            display: none;
          }

          .hero h1 {
            font-size: 2rem;
          }

          .cta-content h2 {
            font-size: 1.75rem;
          }

          .palette-grid {
            grid-template-columns: repeat(3, 1fr);
          }
        }
      `})]})}function pU({user:t,onPasswordSet:e}){const[r,n]=A.useState(""),[i,o]=A.useState(""),[s,l]=A.useState(!1),[c,d]=A.useState(""),h=async f=>{if(f.preventDefault(),d(""),r.length<8){d("Password must be at least 8 characters long");return}if(!/[A-Z]/.test(r)){d("Password must contain at least one uppercase letter");return}if(!/[a-z]/.test(r)){d("Password must contain at least one lowercase letter");return}if(!/[0-9]/.test(r)){d("Password must contain at least one number");return}if(r!==i){d("Passwords do not match");return}l(!0);try{await Qr.updatePassword(r),e()}catch(u){d(u.message||"Failed to set password. Please try again.")}finally{l(!1)}};return a.jsx("div",{className:"tpv-studio",children:a.jsx("div",{className:"tpv-studio__container",style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh"},children:a.jsxs("div",{style:{maxWidth:"400px",width:"100%",padding:"2rem",background:"#fff",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[a.jsx("h2",{style:{marginBottom:"0.5rem",fontSize:"1.5rem"},children:"Welcome to TPV Studio"}),a.jsxs("p",{style:{marginBottom:"1.5rem",color:"#666",fontSize:"0.9rem"},children:["Please set a password for your account: ",a.jsx("strong",{children:t.email})]}),a.jsxs("form",{onSubmit:h,children:[a.jsxs("div",{style:{marginBottom:"1rem"},children:[a.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.9rem",fontWeight:"500"},children:"New Password"}),a.jsx("input",{type:"password",value:r,onChange:f=>n(f.target.value),placeholder:"Enter your password",required:!0,minLength:8,style:{width:"100%",padding:"0.75rem",border:"1px solid #ddd",borderRadius:"4px",fontSize:"1rem"}}),a.jsx("small",{style:{display:"block",marginTop:"0.25rem",color:"#666"},children:"At least 8 characters with uppercase, lowercase, and a number"})]}),a.jsxs("div",{style:{marginBottom:"1.5rem"},children:[a.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.9rem",fontWeight:"500"},children:"Confirm Password"}),a.jsx("input",{type:"password",value:i,onChange:f=>o(f.target.value),placeholder:"Confirm your password",required:!0,minLength:8,style:{width:"100%",padding:"0.75rem",border:"1px solid #ddd",borderRadius:"4px",fontSize:"1rem"}})]}),c&&a.jsx("div",{style:{padding:"0.75rem",marginBottom:"1rem",background:"#fee",border:"1px solid #fcc",borderRadius:"4px",color:"#c00",fontSize:"0.9rem"},children:c}),a.jsx("button",{type:"submit",disabled:s,style:{width:"100%",padding:"0.75rem",background:s?"#ccc":"#007bff",color:"#fff",border:"none",borderRadius:"4px",fontSize:"1rem",fontWeight:"500",cursor:s?"not-allowed":"pointer"},children:s?"Setting Password...":"Set Password"})]})]})})})}function mU(){const[t,e]=A.useState(null),[r,n]=A.useState(!0),[i,o]=A.useState(!1),[s,l]=A.useState(!1),[c,d]=A.useState(!1),[h,f]=A.useState(!1),[u,p]=A.useState(null),[g,m]=A.useState(null),x=async()=>{try{const w=await Qr.getSession();if(!(w!=null&&w.access_token)){d(!1);return}const k=await fetch("/api/admin/users",{headers:{Authorization:`Bearer ${w.access_token}`}});d(k.ok)}catch{console.error("[APP] Admin check failed"),d(!1)}},v=async w=>{try{console.log("[APP] Loading design from URL:",w);const{design:k}=await Wa(w);if(k){y(k);const S=new URL(window.location);S.searchParams.delete("design"),window.history.replaceState({},"",S)}}catch(k){console.error("[APP] Failed to load design from URL:",k)}};A.useEffect(()=>{Qr.getSession().then(k=>{var C;const S=(k==null?void 0:k.user)||null;if(e(S),n(!1),S){const T=(C=S.user_metadata)==null?void 0:C.password_setup_complete;f(!T),x();const O=new URLSearchParams(window.location.search).get("design");O&&v(O)}});const{data:w}=Qr.onAuthStateChange((k,S)=>{var T;const C=(S==null?void 0:S.user)||null;if(e(C),C){const R=(T=C.user_metadata)==null?void 0:T.password_setup_complete;f(!R),x()}else d(!1),f(!1)});return()=>w==null?void 0:w.unsubscribe()},[]);const y=w=>{p(w),m(w.name)},b=async()=>{f(!1);const w=await Qr.getSession();e((w==null?void 0:w.user)||null)};return r?a.jsx("div",{className:"tpv-studio",children:a.jsx("div",{className:"tpv-studio__container",children:a.jsxs("div",{className:"tpv-studio__empty",children:[a.jsx("div",{className:"tpv-studio__spinner"}),a.jsx("p",{children:"Loading..."})]})})}):t?h?a.jsx(pU,{user:t,onPasswordSet:b}):s?a.jsx("div",{className:"tpv-studio",children:a.jsx(sU,{onClose:()=>l(!1)})}):a.jsx(tC,{children:a.jsxs("div",{className:"tpv-studio",children:[a.jsx(tU,{onShowDesigns:()=>o(!0),onShowAdmin:()=>l(!0),isAdmin:c,currentDesignName:g}),a.jsx("main",{className:"tpv-studio__container tpv-studio__container--full",children:a.jsx(eU,{loadedDesign:u})}),i&&a.jsx(nU,{onClose:()=>o(!1),onLoadDesign:y})]})}):a.jsx(fU,{})}Bu.createRoot(document.getElementById("root")).render(a.jsx($.StrictMode,{children:a.jsx(mU,{})}))});export default gU();
//# sourceMappingURL=index-CI-gTL7d.js.map
