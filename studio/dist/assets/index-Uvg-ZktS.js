var J1=Object.defineProperty;var Q1=(e,t,r)=>t in e?J1(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var e_=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var im=(e,t,r)=>Q1(e,typeof t!="symbol"?t+"":t,r);var a7=e_((Pr,Rr)=>{function t_(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in e)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(e,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var wi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Qc(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function r_(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),r}var Jv={exports:{}},ed={},Qv={exports:{}},nt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rl=Symbol.for("react.element"),n_=Symbol.for("react.portal"),i_=Symbol.for("react.fragment"),s_=Symbol.for("react.strict_mode"),o_=Symbol.for("react.profiler"),a_=Symbol.for("react.provider"),l_=Symbol.for("react.context"),c_=Symbol.for("react.forward_ref"),d_=Symbol.for("react.suspense"),u_=Symbol.for("react.memo"),h_=Symbol.for("react.lazy"),sm=Symbol.iterator;function f_(e){return e===null||typeof e!="object"?null:(e=sm&&e[sm]||e["@@iterator"],typeof e=="function"?e:null)}var ey={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ty=Object.assign,ry={};function Po(e,t,r){this.props=e,this.context=t,this.refs=ry,this.updater=r||ey}Po.prototype.isReactComponent={};Po.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Po.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function ny(){}ny.prototype=Po.prototype;function rf(e,t,r){this.props=e,this.context=t,this.refs=ry,this.updater=r||ey}var nf=rf.prototype=new ny;nf.constructor=rf;ty(nf,Po.prototype);nf.isPureReactComponent=!0;var om=Array.isArray,iy=Object.prototype.hasOwnProperty,sf={current:null},sy={key:!0,ref:!0,__self:!0,__source:!0};function oy(e,t,r){var n,i={},s=null,a=null;if(t!=null)for(n in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(s=""+t.key),t)iy.call(t,n)&&!sy.hasOwnProperty(n)&&(i[n]=t[n]);var l=arguments.length-2;if(l===1)i.children=r;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];i.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)i[n]===void 0&&(i[n]=l[n]);return{$$typeof:rl,type:e,key:s,ref:a,props:i,_owner:sf.current}}function p_(e,t){return{$$typeof:rl,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function of(e){return typeof e=="object"&&e!==null&&e.$$typeof===rl}function m_(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var am=/\/+/g;function $d(e,t){return typeof e=="object"&&e!==null&&e.key!=null?m_(""+e.key):t.toString(36)}function Jl(e,t,r,n,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case rl:case n_:a=!0}}if(a)return a=e,i=i(a),e=n===""?"."+$d(a,0):n,om(i)?(r="",e!=null&&(r=e.replace(am,"$&/")+"/"),Jl(i,t,r,"",function(d){return d})):i!=null&&(of(i)&&(i=p_(i,r+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(am,"$&/")+"/")+e)),t.push(i)),1;if(a=0,n=n===""?".":n+":",om(e))for(var l=0;l<e.length;l++){s=e[l];var c=n+$d(s,l);a+=Jl(s,t,r,c,i)}else if(c=f_(e),typeof c=="function")for(e=c.call(e),l=0;!(s=e.next()).done;)s=s.value,c=n+$d(s,l++),a+=Jl(s,t,r,c,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function yl(e,t,r){if(e==null)return e;var n=[],i=0;return Jl(e,n,"","",function(s){return t.call(r,s,i++)}),n}function g_(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var dr={current:null},Ql={transition:null},v_={ReactCurrentDispatcher:dr,ReactCurrentBatchConfig:Ql,ReactCurrentOwner:sf};function ay(){throw Error("act(...) is not supported in production builds of React.")}nt.Children={map:yl,forEach:function(e,t,r){yl(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return yl(e,function(){t++}),t},toArray:function(e){return yl(e,function(t){return t})||[]},only:function(e){if(!of(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};nt.Component=Po;nt.Fragment=i_;nt.Profiler=o_;nt.PureComponent=rf;nt.StrictMode=s_;nt.Suspense=d_;nt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=v_;nt.act=ay;nt.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=ty({},e.props),i=e.key,s=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,a=sf.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)iy.call(t,c)&&!sy.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];n.children=l}return{$$typeof:rl,type:e.type,key:i,ref:s,props:n,_owner:a}};nt.createContext=function(e){return e={$$typeof:l_,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:a_,_context:e},e.Consumer=e};nt.createElement=oy;nt.createFactory=function(e){var t=oy.bind(null,e);return t.type=e,t};nt.createRef=function(){return{current:null}};nt.forwardRef=function(e){return{$$typeof:c_,render:e}};nt.isValidElement=of;nt.lazy=function(e){return{$$typeof:h_,_payload:{_status:-1,_result:e},_init:g_}};nt.memo=function(e,t){return{$$typeof:u_,type:e,compare:t===void 0?null:t}};nt.startTransition=function(e){var t=Ql.transition;Ql.transition={};try{e()}finally{Ql.transition=t}};nt.unstable_act=ay;nt.useCallback=function(e,t){return dr.current.useCallback(e,t)};nt.useContext=function(e){return dr.current.useContext(e)};nt.useDebugValue=function(){};nt.useDeferredValue=function(e){return dr.current.useDeferredValue(e)};nt.useEffect=function(e,t){return dr.current.useEffect(e,t)};nt.useId=function(){return dr.current.useId()};nt.useImperativeHandle=function(e,t,r){return dr.current.useImperativeHandle(e,t,r)};nt.useInsertionEffect=function(e,t){return dr.current.useInsertionEffect(e,t)};nt.useLayoutEffect=function(e,t){return dr.current.useLayoutEffect(e,t)};nt.useMemo=function(e,t){return dr.current.useMemo(e,t)};nt.useReducer=function(e,t,r){return dr.current.useReducer(e,t,r)};nt.useRef=function(e){return dr.current.useRef(e)};nt.useState=function(e){return dr.current.useState(e)};nt.useSyncExternalStore=function(e,t,r){return dr.current.useSyncExternalStore(e,t,r)};nt.useTransition=function(){return dr.current.useTransition()};nt.version="18.3.1";Qv.exports=nt;var A=Qv.exports;const D=Qc(A);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var y_=A,x_=Symbol.for("react.element"),b_=Symbol.for("react.fragment"),w_=Object.prototype.hasOwnProperty,__=y_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,S_={key:!0,ref:!0,__self:!0,__source:!0};function ly(e,t,r){var n,i={},s=null,a=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(a=t.ref);for(n in t)w_.call(t,n)&&!S_.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:x_,type:e,key:s,ref:a,props:i,_owner:__.current}}ed.Fragment=b_;ed.jsx=ly;ed.jsxs=ly;Jv.exports=ed;var o=Jv.exports,Iu={},cy={exports:{}},$r={},dy={exports:{}},uy={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(z,H){var Q=z.length;z.push(H);e:for(;0<Q;){var W=Q-1>>>1,q=z[W];if(0<i(q,H))z[W]=H,z[Q]=q,Q=W;else break e}}function r(z){return z.length===0?null:z[0]}function n(z){if(z.length===0)return null;var H=z[0],Q=z.pop();if(Q!==H){z[0]=Q;e:for(var W=0,q=z.length,re=q>>>1;W<re;){var oe=2*(W+1)-1,pe=z[oe],Pe=oe+1,Re=z[Pe];if(0>i(pe,Q))Pe<q&&0>i(Re,pe)?(z[W]=Re,z[Pe]=Q,W=Pe):(z[W]=pe,z[oe]=Q,W=oe);else if(Pe<q&&0>i(Re,Q))z[W]=Re,z[Pe]=Q,W=Pe;else break e}}return H}function i(z,H){var Q=z.sortIndex-H.sortIndex;return Q!==0?Q:z.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var a=Date,l=a.now();e.unstable_now=function(){return a.now()-l}}var c=[],d=[],u=1,f=null,h=3,p=!1,g=!1,m=!1,x=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(z){for(var H=r(d);H!==null;){if(H.callback===null)n(d);else if(H.startTime<=z)n(d),H.sortIndex=H.expirationTime,t(c,H);else break;H=r(d)}}function w(z){if(m=!1,b(z),!g)if(r(c)!==null)g=!0,fe(j);else{var H=r(d);H!==null&&U(w,H.startTime-z)}}function j(z,H){g=!1,m&&(m=!1,v(N),N=-1),p=!0;var Q=h;try{for(b(H),f=r(c);f!==null&&(!(f.expirationTime>H)||z&&!te());){var W=f.callback;if(typeof W=="function"){f.callback=null,h=f.priorityLevel;var q=W(f.expirationTime<=H);H=e.unstable_now(),typeof q=="function"?f.callback=q:f===r(c)&&n(c),b(H)}else n(c);f=r(c)}if(f!==null)var re=!0;else{var oe=r(d);oe!==null&&U(w,oe.startTime-H),re=!1}return re}finally{f=null,h=Q,p=!1}}var _=!1,E=null,N=-1,O=5,I=-1;function te(){return!(e.unstable_now()-I<O)}function T(){if(E!==null){var z=e.unstable_now();I=z;var H=!0;try{H=E(!0,z)}finally{H?V():(_=!1,E=null)}}else _=!1}var V;if(typeof y=="function")V=function(){y(T)};else if(typeof MessageChannel<"u"){var S=new MessageChannel,K=S.port2;S.port1.onmessage=T,V=function(){K.postMessage(null)}}else V=function(){x(T,0)};function fe(z){E=z,_||(_=!0,V())}function U(z,H){N=x(function(){z(e.unstable_now())},H)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(z){z.callback=null},e.unstable_continueExecution=function(){g||p||(g=!0,fe(j))},e.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<z?Math.floor(1e3/z):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(z){switch(h){case 1:case 2:case 3:var H=3;break;default:H=h}var Q=h;h=H;try{return z()}finally{h=Q}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(z,H){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var Q=h;h=z;try{return H()}finally{h=Q}},e.unstable_scheduleCallback=function(z,H,Q){var W=e.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?W+Q:W):Q=W,z){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=Q+q,z={id:u++,callback:H,priorityLevel:z,startTime:Q,expirationTime:q,sortIndex:-1},Q>W?(z.sortIndex=Q,t(d,z),r(c)===null&&z===r(d)&&(m?(v(N),N=-1):m=!0,U(w,Q-W))):(z.sortIndex=q,t(c,z),g||p||(g=!0,fe(j))),z},e.unstable_shouldYield=te,e.unstable_wrapCallback=function(z){var H=h;return function(){var Q=h;h=H;try{return z.apply(this,arguments)}finally{h=Q}}}})(uy);dy.exports=uy;var k_=dy.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var j_=A,Ar=k_;function ke(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var hy=new Set,Aa={};function ms(e,t){_o(e,t),_o(e+"Capture",t)}function _o(e,t){for(Aa[e]=t,e=0;e<t.length;e++)hy.add(t[e])}var Yn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Du=Object.prototype.hasOwnProperty,C_=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,lm={},cm={};function E_(e){return Du.call(cm,e)?!0:Du.call(lm,e)?!1:C_.test(e)?cm[e]=!0:(lm[e]=!0,!1)}function T_(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function N_(e,t,r,n){if(t===null||typeof t>"u"||T_(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function ur(e,t,r,n,i,s,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=a}var Vt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Vt[e]=new ur(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Vt[t]=new ur(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Vt[e]=new ur(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Vt[e]=new ur(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Vt[e]=new ur(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Vt[e]=new ur(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Vt[e]=new ur(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Vt[e]=new ur(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Vt[e]=new ur(e,5,!1,e.toLowerCase(),null,!1,!1)});var af=/[\-:]([a-z])/g;function lf(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(af,lf);Vt[t]=new ur(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(af,lf);Vt[t]=new ur(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(af,lf);Vt[t]=new ur(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Vt[e]=new ur(e,1,!1,e.toLowerCase(),null,!1,!1)});Vt.xlinkHref=new ur("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Vt[e]=new ur(e,1,!1,e.toLowerCase(),null,!0,!0)});function cf(e,t,r,n){var i=Vt.hasOwnProperty(t)?Vt[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(N_(t,r,i,n)&&(r=null),n||i===null?E_(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Jn=j_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,xl=Symbol.for("react.element"),eo=Symbol.for("react.portal"),to=Symbol.for("react.fragment"),df=Symbol.for("react.strict_mode"),zu=Symbol.for("react.profiler"),fy=Symbol.for("react.provider"),py=Symbol.for("react.context"),uf=Symbol.for("react.forward_ref"),Fu=Symbol.for("react.suspense"),Bu=Symbol.for("react.suspense_list"),hf=Symbol.for("react.memo"),pi=Symbol.for("react.lazy"),my=Symbol.for("react.offscreen"),dm=Symbol.iterator;function Jo(e){return e===null||typeof e!="object"?null:(e=dm&&e[dm]||e["@@iterator"],typeof e=="function"?e:null)}var Tt=Object.assign,Ld;function ha(e){if(Ld===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Ld=t&&t[1]||""}return`
`+Ld+e}var Id=!1;function Dd(e,t){if(!e||Id)return"";Id=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var n=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){n=d}e.call(t.prototype)}else{try{throw Error()}catch(d){n=d}e()}}catch(d){if(d&&n&&typeof d.stack=="string"){for(var i=d.stack.split(`
`),s=n.stack.split(`
`),a=i.length-1,l=s.length-1;1<=a&&0<=l&&i[a]!==s[l];)l--;for(;1<=a&&0<=l;a--,l--)if(i[a]!==s[l]){if(a!==1||l!==1)do if(a--,l--,0>l||i[a]!==s[l]){var c=`
`+i[a].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=a&&0<=l);break}}}finally{Id=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?ha(e):""}function P_(e){switch(e.tag){case 5:return ha(e.type);case 16:return ha("Lazy");case 13:return ha("Suspense");case 19:return ha("SuspenseList");case 0:case 2:case 15:return e=Dd(e.type,!1),e;case 11:return e=Dd(e.type.render,!1),e;case 1:return e=Dd(e.type,!0),e;default:return""}}function Hu(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case to:return"Fragment";case eo:return"Portal";case zu:return"Profiler";case df:return"StrictMode";case Fu:return"Suspense";case Bu:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case py:return(e.displayName||"Context")+".Consumer";case fy:return(e._context.displayName||"Context")+".Provider";case uf:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case hf:return t=e.displayName||null,t!==null?t:Hu(e.type)||"Memo";case pi:t=e._payload,e=e._init;try{return Hu(e(t))}catch{}}return null}function R_(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Hu(t);case 8:return t===df?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Oi(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function gy(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function O_(e){var t=gy(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function bl(e){e._valueTracker||(e._valueTracker=O_(e))}function vy(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=gy(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function uc(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Uu(e,t){var r=t.checked;return Tt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function um(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Oi(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function yy(e,t){t=t.checked,t!=null&&cf(e,"checked",t,!1)}function Wu(e,t){yy(e,t);var r=Oi(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Gu(e,t.type,r):t.hasOwnProperty("defaultValue")&&Gu(e,t.type,Oi(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function hm(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Gu(e,t,r){(t!=="number"||uc(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var fa=Array.isArray;function po(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Oi(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function Vu(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ke(91));return Tt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function fm(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(ke(92));if(fa(r)){if(1<r.length)throw Error(ke(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Oi(r)}}function xy(e,t){var r=Oi(t.value),n=Oi(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function pm(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function by(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function qu(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?by(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var wl,wy=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(wl=wl||document.createElement("div"),wl.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=wl.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Ma(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var ba={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},A_=["Webkit","ms","Moz","O"];Object.keys(ba).forEach(function(e){A_.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ba[t]=ba[e]})});function _y(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||ba.hasOwnProperty(e)&&ba[e]?(""+t).trim():t+"px"}function Sy(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=_y(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var M_=Tt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Yu(e,t){if(t){if(M_[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ke(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ke(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ke(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ke(62))}}function Xu(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ku=null;function ff(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Zu=null,mo=null,go=null;function mm(e){if(e=sl(e)){if(typeof Zu!="function")throw Error(ke(280));var t=e.stateNode;t&&(t=sd(t),Zu(e.stateNode,e.type,t))}}function ky(e){mo?go?go.push(e):go=[e]:mo=e}function jy(){if(mo){var e=mo,t=go;if(go=mo=null,mm(e),t)for(e=0;e<t.length;e++)mm(t[e])}}function Cy(e,t){return e(t)}function Ey(){}var zd=!1;function Ty(e,t,r){if(zd)return e(t,r);zd=!0;try{return Cy(e,t,r)}finally{zd=!1,(mo!==null||go!==null)&&(Ey(),jy())}}function $a(e,t){var r=e.stateNode;if(r===null)return null;var n=sd(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(ke(231,t,typeof r));return r}var Ju=!1;if(Yn)try{var Qo={};Object.defineProperty(Qo,"passive",{get:function(){Ju=!0}}),window.addEventListener("test",Qo,Qo),window.removeEventListener("test",Qo,Qo)}catch{Ju=!1}function $_(e,t,r,n,i,s,a,l,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(r,d)}catch(u){this.onError(u)}}var wa=!1,hc=null,fc=!1,Qu=null,L_={onError:function(e){wa=!0,hc=e}};function I_(e,t,r,n,i,s,a,l,c){wa=!1,hc=null,$_.apply(L_,arguments)}function D_(e,t,r,n,i,s,a,l,c){if(I_.apply(this,arguments),wa){if(wa){var d=hc;wa=!1,hc=null}else throw Error(ke(198));fc||(fc=!0,Qu=d)}}function gs(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Ny(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function gm(e){if(gs(e)!==e)throw Error(ke(188))}function z_(e){var t=e.alternate;if(!t){if(t=gs(e),t===null)throw Error(ke(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return gm(i),e;if(s===n)return gm(i),t;s=s.sibling}throw Error(ke(188))}if(r.return!==n.return)r=i,n=s;else{for(var a=!1,l=i.child;l;){if(l===r){a=!0,r=i,n=s;break}if(l===n){a=!0,n=i,r=s;break}l=l.sibling}if(!a){for(l=s.child;l;){if(l===r){a=!0,r=s,n=i;break}if(l===n){a=!0,n=s,r=i;break}l=l.sibling}if(!a)throw Error(ke(189))}}if(r.alternate!==n)throw Error(ke(190))}if(r.tag!==3)throw Error(ke(188));return r.stateNode.current===r?e:t}function Py(e){return e=z_(e),e!==null?Ry(e):null}function Ry(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Ry(e);if(t!==null)return t;e=e.sibling}return null}var Oy=Ar.unstable_scheduleCallback,vm=Ar.unstable_cancelCallback,F_=Ar.unstable_shouldYield,B_=Ar.unstable_requestPaint,Rt=Ar.unstable_now,H_=Ar.unstable_getCurrentPriorityLevel,pf=Ar.unstable_ImmediatePriority,Ay=Ar.unstable_UserBlockingPriority,pc=Ar.unstable_NormalPriority,U_=Ar.unstable_LowPriority,My=Ar.unstable_IdlePriority,td=null,Pn=null;function W_(e){if(Pn&&typeof Pn.onCommitFiberRoot=="function")try{Pn.onCommitFiberRoot(td,e,void 0,(e.current.flags&128)===128)}catch{}}var cn=Math.clz32?Math.clz32:q_,G_=Math.log,V_=Math.LN2;function q_(e){return e>>>=0,e===0?32:31-(G_(e)/V_|0)|0}var _l=64,Sl=4194304;function pa(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function mc(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,s=e.pingedLanes,a=r&268435455;if(a!==0){var l=a&~i;l!==0?n=pa(l):(s&=a,s!==0&&(n=pa(s)))}else a=r&~i,a!==0?n=pa(a):s!==0&&(n=pa(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-cn(t),i=1<<r,n|=e[r],t&=~i;return n}function Y_(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function X_(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var a=31-cn(s),l=1<<a,c=i[a];c===-1?(!(l&r)||l&n)&&(i[a]=Y_(l,t)):c<=t&&(e.expiredLanes|=l),s&=~l}}function eh(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function $y(){var e=_l;return _l<<=1,!(_l&4194240)&&(_l=64),e}function Fd(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function nl(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-cn(t),e[t]=r}function K_(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-cn(r),s=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~s}}function mf(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-cn(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var ct=0;function Ly(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Iy,gf,Dy,zy,Fy,th=!1,kl=[],ki=null,ji=null,Ci=null,La=new Map,Ia=new Map,vi=[],Z_="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ym(e,t){switch(e){case"focusin":case"focusout":ki=null;break;case"dragenter":case"dragleave":ji=null;break;case"mouseover":case"mouseout":Ci=null;break;case"pointerover":case"pointerout":La.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ia.delete(t.pointerId)}}function ea(e,t,r,n,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},t!==null&&(t=sl(t),t!==null&&gf(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function J_(e,t,r,n,i){switch(t){case"focusin":return ki=ea(ki,e,t,r,n,i),!0;case"dragenter":return ji=ea(ji,e,t,r,n,i),!0;case"mouseover":return Ci=ea(Ci,e,t,r,n,i),!0;case"pointerover":var s=i.pointerId;return La.set(s,ea(La.get(s)||null,e,t,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,Ia.set(s,ea(Ia.get(s)||null,e,t,r,n,i)),!0}return!1}function By(e){var t=rs(e.target);if(t!==null){var r=gs(t);if(r!==null){if(t=r.tag,t===13){if(t=Ny(r),t!==null){e.blockedOn=t,Fy(e.priority,function(){Dy(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function ec(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=rh(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Ku=n,r.target.dispatchEvent(n),Ku=null}else return t=sl(r),t!==null&&gf(t),e.blockedOn=r,!1;t.shift()}return!0}function xm(e,t,r){ec(e)&&r.delete(t)}function Q_(){th=!1,ki!==null&&ec(ki)&&(ki=null),ji!==null&&ec(ji)&&(ji=null),Ci!==null&&ec(Ci)&&(Ci=null),La.forEach(xm),Ia.forEach(xm)}function ta(e,t){e.blockedOn===t&&(e.blockedOn=null,th||(th=!0,Ar.unstable_scheduleCallback(Ar.unstable_NormalPriority,Q_)))}function Da(e){function t(i){return ta(i,e)}if(0<kl.length){ta(kl[0],e);for(var r=1;r<kl.length;r++){var n=kl[r];n.blockedOn===e&&(n.blockedOn=null)}}for(ki!==null&&ta(ki,e),ji!==null&&ta(ji,e),Ci!==null&&ta(Ci,e),La.forEach(t),Ia.forEach(t),r=0;r<vi.length;r++)n=vi[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<vi.length&&(r=vi[0],r.blockedOn===null);)By(r),r.blockedOn===null&&vi.shift()}var vo=Jn.ReactCurrentBatchConfig,gc=!0;function e2(e,t,r,n){var i=ct,s=vo.transition;vo.transition=null;try{ct=1,vf(e,t,r,n)}finally{ct=i,vo.transition=s}}function t2(e,t,r,n){var i=ct,s=vo.transition;vo.transition=null;try{ct=4,vf(e,t,r,n)}finally{ct=i,vo.transition=s}}function vf(e,t,r,n){if(gc){var i=rh(e,t,r,n);if(i===null)Kd(e,t,n,vc,r),ym(e,n);else if(J_(i,e,t,r,n))n.stopPropagation();else if(ym(e,n),t&4&&-1<Z_.indexOf(e)){for(;i!==null;){var s=sl(i);if(s!==null&&Iy(s),s=rh(e,t,r,n),s===null&&Kd(e,t,n,vc,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else Kd(e,t,n,null,r)}}var vc=null;function rh(e,t,r,n){if(vc=null,e=ff(n),e=rs(e),e!==null)if(t=gs(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Ny(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return vc=e,null}function Hy(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(H_()){case pf:return 1;case Ay:return 4;case pc:case U_:return 16;case My:return 536870912;default:return 16}default:return 16}}var _i=null,yf=null,tc=null;function Uy(){if(tc)return tc;var e,t=yf,r=t.length,n,i="value"in _i?_i.value:_i.textContent,s=i.length;for(e=0;e<r&&t[e]===i[e];e++);var a=r-e;for(n=1;n<=a&&t[r-n]===i[s-n];n++);return tc=i.slice(e,1<n?1-n:void 0)}function rc(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function jl(){return!0}function bm(){return!1}function Lr(e){function t(r,n,i,s,a){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?jl:bm,this.isPropagationStopped=bm,this}return Tt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=jl)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=jl)},persist:function(){},isPersistent:jl}),t}var Ro={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},xf=Lr(Ro),il=Tt({},Ro,{view:0,detail:0}),r2=Lr(il),Bd,Hd,ra,rd=Tt({},il,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:bf,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ra&&(ra&&e.type==="mousemove"?(Bd=e.screenX-ra.screenX,Hd=e.screenY-ra.screenY):Hd=Bd=0,ra=e),Bd)},movementY:function(e){return"movementY"in e?e.movementY:Hd}}),wm=Lr(rd),n2=Tt({},rd,{dataTransfer:0}),i2=Lr(n2),s2=Tt({},il,{relatedTarget:0}),Ud=Lr(s2),o2=Tt({},Ro,{animationName:0,elapsedTime:0,pseudoElement:0}),a2=Lr(o2),l2=Tt({},Ro,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),c2=Lr(l2),d2=Tt({},Ro,{data:0}),_m=Lr(d2),u2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},h2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},f2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function p2(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=f2[e])?!!t[e]:!1}function bf(){return p2}var m2=Tt({},il,{key:function(e){if(e.key){var t=u2[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=rc(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?h2[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:bf,charCode:function(e){return e.type==="keypress"?rc(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?rc(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),g2=Lr(m2),v2=Tt({},rd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Sm=Lr(v2),y2=Tt({},il,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:bf}),x2=Lr(y2),b2=Tt({},Ro,{propertyName:0,elapsedTime:0,pseudoElement:0}),w2=Lr(b2),_2=Tt({},rd,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),S2=Lr(_2),k2=[9,13,27,32],wf=Yn&&"CompositionEvent"in window,_a=null;Yn&&"documentMode"in document&&(_a=document.documentMode);var j2=Yn&&"TextEvent"in window&&!_a,Wy=Yn&&(!wf||_a&&8<_a&&11>=_a),km=" ",jm=!1;function Gy(e,t){switch(e){case"keyup":return k2.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vy(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ro=!1;function C2(e,t){switch(e){case"compositionend":return Vy(t);case"keypress":return t.which!==32?null:(jm=!0,km);case"textInput":return e=t.data,e===km&&jm?null:e;default:return null}}function E2(e,t){if(ro)return e==="compositionend"||!wf&&Gy(e,t)?(e=Uy(),tc=yf=_i=null,ro=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Wy&&t.locale!=="ko"?null:t.data;default:return null}}var T2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Cm(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!T2[e.type]:t==="textarea"}function qy(e,t,r,n){ky(n),t=yc(t,"onChange"),0<t.length&&(r=new xf("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Sa=null,za=null;function N2(e){ix(e,0)}function nd(e){var t=so(e);if(vy(t))return e}function P2(e,t){if(e==="change")return t}var Yy=!1;if(Yn){var Wd;if(Yn){var Gd="oninput"in document;if(!Gd){var Em=document.createElement("div");Em.setAttribute("oninput","return;"),Gd=typeof Em.oninput=="function"}Wd=Gd}else Wd=!1;Yy=Wd&&(!document.documentMode||9<document.documentMode)}function Tm(){Sa&&(Sa.detachEvent("onpropertychange",Xy),za=Sa=null)}function Xy(e){if(e.propertyName==="value"&&nd(za)){var t=[];qy(t,za,e,ff(e)),Ty(N2,t)}}function R2(e,t,r){e==="focusin"?(Tm(),Sa=t,za=r,Sa.attachEvent("onpropertychange",Xy)):e==="focusout"&&Tm()}function O2(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return nd(za)}function A2(e,t){if(e==="click")return nd(t)}function M2(e,t){if(e==="input"||e==="change")return nd(t)}function $2(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var un=typeof Object.is=="function"?Object.is:$2;function Fa(e,t){if(un(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!Du.call(t,i)||!un(e[i],t[i]))return!1}return!0}function Nm(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Pm(e,t){var r=Nm(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Nm(r)}}function Ky(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Ky(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Zy(){for(var e=window,t=uc();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=uc(e.document)}return t}function _f(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function L2(e){var t=Zy(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Ky(r.ownerDocument.documentElement,r)){if(n!==null&&_f(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!e.extend&&s>n&&(i=n,n=s,s=i),i=Pm(r,s);var a=Pm(r,n);i&&a&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var I2=Yn&&"documentMode"in document&&11>=document.documentMode,no=null,nh=null,ka=null,ih=!1;function Rm(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;ih||no==null||no!==uc(n)||(n=no,"selectionStart"in n&&_f(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),ka&&Fa(ka,n)||(ka=n,n=yc(nh,"onSelect"),0<n.length&&(t=new xf("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=no)))}function Cl(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var io={animationend:Cl("Animation","AnimationEnd"),animationiteration:Cl("Animation","AnimationIteration"),animationstart:Cl("Animation","AnimationStart"),transitionend:Cl("Transition","TransitionEnd")},Vd={},Jy={};Yn&&(Jy=document.createElement("div").style,"AnimationEvent"in window||(delete io.animationend.animation,delete io.animationiteration.animation,delete io.animationstart.animation),"TransitionEvent"in window||delete io.transitionend.transition);function id(e){if(Vd[e])return Vd[e];if(!io[e])return e;var t=io[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Jy)return Vd[e]=t[r];return e}var Qy=id("animationend"),ex=id("animationiteration"),tx=id("animationstart"),rx=id("transitionend"),nx=new Map,Om="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Li(e,t){nx.set(e,t),ms(t,[e])}for(var qd=0;qd<Om.length;qd++){var Yd=Om[qd],D2=Yd.toLowerCase(),z2=Yd[0].toUpperCase()+Yd.slice(1);Li(D2,"on"+z2)}Li(Qy,"onAnimationEnd");Li(ex,"onAnimationIteration");Li(tx,"onAnimationStart");Li("dblclick","onDoubleClick");Li("focusin","onFocus");Li("focusout","onBlur");Li(rx,"onTransitionEnd");_o("onMouseEnter",["mouseout","mouseover"]);_o("onMouseLeave",["mouseout","mouseover"]);_o("onPointerEnter",["pointerout","pointerover"]);_o("onPointerLeave",["pointerout","pointerover"]);ms("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ms("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ms("onBeforeInput",["compositionend","keypress","textInput","paste"]);ms("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ms("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ms("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ma="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),F2=new Set("cancel close invalid load scroll toggle".split(" ").concat(ma));function Am(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,D_(n,t,void 0,e),e.currentTarget=null}function ix(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var a=n.length-1;0<=a;a--){var l=n[a],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==s&&i.isPropagationStopped())break e;Am(i,l,d),s=c}else for(a=0;a<n.length;a++){if(l=n[a],c=l.instance,d=l.currentTarget,l=l.listener,c!==s&&i.isPropagationStopped())break e;Am(i,l,d),s=c}}}if(fc)throw e=Qu,fc=!1,Qu=null,e}function vt(e,t){var r=t[ch];r===void 0&&(r=t[ch]=new Set);var n=e+"__bubble";r.has(n)||(sx(t,e,2,!1),r.add(n))}function Xd(e,t,r){var n=0;t&&(n|=4),sx(r,e,n,t)}var El="_reactListening"+Math.random().toString(36).slice(2);function Ba(e){if(!e[El]){e[El]=!0,hy.forEach(function(r){r!=="selectionchange"&&(F2.has(r)||Xd(r,!1,e),Xd(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[El]||(t[El]=!0,Xd("selectionchange",!1,t))}}function sx(e,t,r,n){switch(Hy(t)){case 1:var i=e2;break;case 4:i=t2;break;default:i=vf}r=i.bind(null,t,r,e),i=void 0,!Ju||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function Kd(e,t,r,n,i){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var l=n.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(a===4)for(a=n.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;a=a.return}for(;l!==null;){if(a=rs(l),a===null)return;if(c=a.tag,c===5||c===6){n=s=a;continue e}l=l.parentNode}}n=n.return}Ty(function(){var d=s,u=ff(r),f=[];e:{var h=nx.get(e);if(h!==void 0){var p=xf,g=e;switch(e){case"keypress":if(rc(r)===0)break e;case"keydown":case"keyup":p=g2;break;case"focusin":g="focus",p=Ud;break;case"focusout":g="blur",p=Ud;break;case"beforeblur":case"afterblur":p=Ud;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=wm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=i2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=x2;break;case Qy:case ex:case tx:p=a2;break;case rx:p=w2;break;case"scroll":p=r2;break;case"wheel":p=S2;break;case"copy":case"cut":case"paste":p=c2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Sm}var m=(t&4)!==0,x=!m&&e==="scroll",v=m?h!==null?h+"Capture":null:h;m=[];for(var y=d,b;y!==null;){b=y;var w=b.stateNode;if(b.tag===5&&w!==null&&(b=w,v!==null&&(w=$a(y,v),w!=null&&m.push(Ha(y,w,b)))),x)break;y=y.return}0<m.length&&(h=new p(h,g,null,r,u),f.push({event:h,listeners:m}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",h&&r!==Ku&&(g=r.relatedTarget||r.fromElement)&&(rs(g)||g[Xn]))break e;if((p||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,p?(g=r.relatedTarget||r.toElement,p=d,g=g?rs(g):null,g!==null&&(x=gs(g),g!==x||g.tag!==5&&g.tag!==6)&&(g=null)):(p=null,g=d),p!==g)){if(m=wm,w="onMouseLeave",v="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(m=Sm,w="onPointerLeave",v="onPointerEnter",y="pointer"),x=p==null?h:so(p),b=g==null?h:so(g),h=new m(w,y+"leave",p,r,u),h.target=x,h.relatedTarget=b,w=null,rs(u)===d&&(m=new m(v,y+"enter",g,r,u),m.target=b,m.relatedTarget=x,w=m),x=w,p&&g)t:{for(m=p,v=g,y=0,b=m;b;b=Ns(b))y++;for(b=0,w=v;w;w=Ns(w))b++;for(;0<y-b;)m=Ns(m),y--;for(;0<b-y;)v=Ns(v),b--;for(;y--;){if(m===v||v!==null&&m===v.alternate)break t;m=Ns(m),v=Ns(v)}m=null}else m=null;p!==null&&Mm(f,h,p,m,!1),g!==null&&x!==null&&Mm(f,x,g,m,!0)}}e:{if(h=d?so(d):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var j=P2;else if(Cm(h))if(Yy)j=M2;else{j=O2;var _=R2}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(j=A2);if(j&&(j=j(e,d))){qy(f,j,r,u);break e}_&&_(e,h,d),e==="focusout"&&(_=h._wrapperState)&&_.controlled&&h.type==="number"&&Gu(h,"number",h.value)}switch(_=d?so(d):window,e){case"focusin":(Cm(_)||_.contentEditable==="true")&&(no=_,nh=d,ka=null);break;case"focusout":ka=nh=no=null;break;case"mousedown":ih=!0;break;case"contextmenu":case"mouseup":case"dragend":ih=!1,Rm(f,r,u);break;case"selectionchange":if(I2)break;case"keydown":case"keyup":Rm(f,r,u)}var E;if(wf)e:{switch(e){case"compositionstart":var N="onCompositionStart";break e;case"compositionend":N="onCompositionEnd";break e;case"compositionupdate":N="onCompositionUpdate";break e}N=void 0}else ro?Gy(e,r)&&(N="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(N="onCompositionStart");N&&(Wy&&r.locale!=="ko"&&(ro||N!=="onCompositionStart"?N==="onCompositionEnd"&&ro&&(E=Uy()):(_i=u,yf="value"in _i?_i.value:_i.textContent,ro=!0)),_=yc(d,N),0<_.length&&(N=new _m(N,e,null,r,u),f.push({event:N,listeners:_}),E?N.data=E:(E=Vy(r),E!==null&&(N.data=E)))),(E=j2?C2(e,r):E2(e,r))&&(d=yc(d,"onBeforeInput"),0<d.length&&(u=new _m("onBeforeInput","beforeinput",null,r,u),f.push({event:u,listeners:d}),u.data=E))}ix(f,t)})}function Ha(e,t,r){return{instance:e,listener:t,currentTarget:r}}function yc(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=$a(e,r),s!=null&&n.unshift(Ha(e,s,i)),s=$a(e,t),s!=null&&n.push(Ha(e,s,i))),e=e.return}return n}function Ns(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Mm(e,t,r,n,i){for(var s=t._reactName,a=[];r!==null&&r!==n;){var l=r,c=l.alternate,d=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&d!==null&&(l=d,i?(c=$a(r,s),c!=null&&a.unshift(Ha(r,c,l))):i||(c=$a(r,s),c!=null&&a.push(Ha(r,c,l)))),r=r.return}a.length!==0&&e.push({event:t,listeners:a})}var B2=/\r\n?/g,H2=/\u0000|\uFFFD/g;function $m(e){return(typeof e=="string"?e:""+e).replace(B2,`
`).replace(H2,"")}function Tl(e,t,r){if(t=$m(t),$m(e)!==t&&r)throw Error(ke(425))}function xc(){}var sh=null,oh=null;function ah(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var lh=typeof setTimeout=="function"?setTimeout:void 0,U2=typeof clearTimeout=="function"?clearTimeout:void 0,Lm=typeof Promise=="function"?Promise:void 0,W2=typeof queueMicrotask=="function"?queueMicrotask:typeof Lm<"u"?function(e){return Lm.resolve(null).then(e).catch(G2)}:lh;function G2(e){setTimeout(function(){throw e})}function Zd(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),Da(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Da(t)}function Ei(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Im(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Oo=Math.random().toString(36).slice(2),En="__reactFiber$"+Oo,Ua="__reactProps$"+Oo,Xn="__reactContainer$"+Oo,ch="__reactEvents$"+Oo,V2="__reactListeners$"+Oo,q2="__reactHandles$"+Oo;function rs(e){var t=e[En];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Xn]||r[En]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Im(e);e!==null;){if(r=e[En])return r;e=Im(e)}return t}e=r,r=e.parentNode}return null}function sl(e){return e=e[En]||e[Xn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function so(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ke(33))}function sd(e){return e[Ua]||null}var dh=[],oo=-1;function Ii(e){return{current:e}}function bt(e){0>oo||(e.current=dh[oo],dh[oo]=null,oo--)}function ft(e,t){oo++,dh[oo]=e.current,e.current=t}var Ai={},rr=Ii(Ai),gr=Ii(!1),cs=Ai;function So(e,t){var r=e.type.contextTypes;if(!r)return Ai;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function vr(e){return e=e.childContextTypes,e!=null}function bc(){bt(gr),bt(rr)}function Dm(e,t,r){if(rr.current!==Ai)throw Error(ke(168));ft(rr,t),ft(gr,r)}function ox(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(ke(108,R_(e)||"Unknown",i));return Tt({},r,n)}function wc(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ai,cs=rr.current,ft(rr,e),ft(gr,gr.current),!0}function zm(e,t,r){var n=e.stateNode;if(!n)throw Error(ke(169));r?(e=ox(e,t,cs),n.__reactInternalMemoizedMergedChildContext=e,bt(gr),bt(rr),ft(rr,e)):bt(gr),ft(gr,r)}var Wn=null,od=!1,Jd=!1;function ax(e){Wn===null?Wn=[e]:Wn.push(e)}function Y2(e){od=!0,ax(e)}function Di(){if(!Jd&&Wn!==null){Jd=!0;var e=0,t=ct;try{var r=Wn;for(ct=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Wn=null,od=!1}catch(i){throw Wn!==null&&(Wn=Wn.slice(e+1)),Oy(pf,Di),i}finally{ct=t,Jd=!1}}return null}var ao=[],lo=0,_c=null,Sc=0,Br=[],Hr=0,ds=null,Gn=1,Vn="";function Yi(e,t){ao[lo++]=Sc,ao[lo++]=_c,_c=e,Sc=t}function lx(e,t,r){Br[Hr++]=Gn,Br[Hr++]=Vn,Br[Hr++]=ds,ds=e;var n=Gn;e=Vn;var i=32-cn(n)-1;n&=~(1<<i),r+=1;var s=32-cn(t)+i;if(30<s){var a=i-i%5;s=(n&(1<<a)-1).toString(32),n>>=a,i-=a,Gn=1<<32-cn(t)+i|r<<i|n,Vn=s+e}else Gn=1<<s|r<<i|n,Vn=e}function Sf(e){e.return!==null&&(Yi(e,1),lx(e,1,0))}function kf(e){for(;e===_c;)_c=ao[--lo],ao[lo]=null,Sc=ao[--lo],ao[lo]=null;for(;e===ds;)ds=Br[--Hr],Br[Hr]=null,Vn=Br[--Hr],Br[Hr]=null,Gn=Br[--Hr],Br[Hr]=null}var Or=null,Nr=null,kt=!1,an=null;function cx(e,t){var r=Wr(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Fm(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Or=e,Nr=Ei(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Or=e,Nr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=ds!==null?{id:Gn,overflow:Vn}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Wr(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Or=e,Nr=null,!0):!1;default:return!1}}function uh(e){return(e.mode&1)!==0&&(e.flags&128)===0}function hh(e){if(kt){var t=Nr;if(t){var r=t;if(!Fm(e,t)){if(uh(e))throw Error(ke(418));t=Ei(r.nextSibling);var n=Or;t&&Fm(e,t)?cx(n,r):(e.flags=e.flags&-4097|2,kt=!1,Or=e)}}else{if(uh(e))throw Error(ke(418));e.flags=e.flags&-4097|2,kt=!1,Or=e}}}function Bm(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Or=e}function Nl(e){if(e!==Or)return!1;if(!kt)return Bm(e),kt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!ah(e.type,e.memoizedProps)),t&&(t=Nr)){if(uh(e))throw dx(),Error(ke(418));for(;t;)cx(e,t),t=Ei(t.nextSibling)}if(Bm(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ke(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Nr=Ei(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Nr=null}}else Nr=Or?Ei(e.stateNode.nextSibling):null;return!0}function dx(){for(var e=Nr;e;)e=Ei(e.nextSibling)}function ko(){Nr=Or=null,kt=!1}function jf(e){an===null?an=[e]:an.push(e)}var X2=Jn.ReactCurrentBatchConfig;function na(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ke(309));var n=r.stateNode}if(!n)throw Error(ke(147,e));var i=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(a){var l=i.refs;a===null?delete l[s]:l[s]=a},t._stringRef=s,t)}if(typeof e!="string")throw Error(ke(284));if(!r._owner)throw Error(ke(290,e))}return e}function Pl(e,t){throw e=Object.prototype.toString.call(t),Error(ke(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Hm(e){var t=e._init;return t(e._payload)}function ux(e){function t(v,y){if(e){var b=v.deletions;b===null?(v.deletions=[y],v.flags|=16):b.push(y)}}function r(v,y){if(!e)return null;for(;y!==null;)t(v,y),y=y.sibling;return null}function n(v,y){for(v=new Map;y!==null;)y.key!==null?v.set(y.key,y):v.set(y.index,y),y=y.sibling;return v}function i(v,y){return v=Ri(v,y),v.index=0,v.sibling=null,v}function s(v,y,b){return v.index=b,e?(b=v.alternate,b!==null?(b=b.index,b<y?(v.flags|=2,y):b):(v.flags|=2,y)):(v.flags|=1048576,y)}function a(v){return e&&v.alternate===null&&(v.flags|=2),v}function l(v,y,b,w){return y===null||y.tag!==6?(y=su(b,v.mode,w),y.return=v,y):(y=i(y,b),y.return=v,y)}function c(v,y,b,w){var j=b.type;return j===to?u(v,y,b.props.children,w,b.key):y!==null&&(y.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===pi&&Hm(j)===y.type)?(w=i(y,b.props),w.ref=na(v,y,b),w.return=v,w):(w=cc(b.type,b.key,b.props,null,v.mode,w),w.ref=na(v,y,b),w.return=v,w)}function d(v,y,b,w){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=ou(b,v.mode,w),y.return=v,y):(y=i(y,b.children||[]),y.return=v,y)}function u(v,y,b,w,j){return y===null||y.tag!==7?(y=as(b,v.mode,w,j),y.return=v,y):(y=i(y,b),y.return=v,y)}function f(v,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=su(""+y,v.mode,b),y.return=v,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case xl:return b=cc(y.type,y.key,y.props,null,v.mode,b),b.ref=na(v,null,y),b.return=v,b;case eo:return y=ou(y,v.mode,b),y.return=v,y;case pi:var w=y._init;return f(v,w(y._payload),b)}if(fa(y)||Jo(y))return y=as(y,v.mode,b,null),y.return=v,y;Pl(v,y)}return null}function h(v,y,b,w){var j=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return j!==null?null:l(v,y,""+b,w);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case xl:return b.key===j?c(v,y,b,w):null;case eo:return b.key===j?d(v,y,b,w):null;case pi:return j=b._init,h(v,y,j(b._payload),w)}if(fa(b)||Jo(b))return j!==null?null:u(v,y,b,w,null);Pl(v,b)}return null}function p(v,y,b,w,j){if(typeof w=="string"&&w!==""||typeof w=="number")return v=v.get(b)||null,l(y,v,""+w,j);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case xl:return v=v.get(w.key===null?b:w.key)||null,c(y,v,w,j);case eo:return v=v.get(w.key===null?b:w.key)||null,d(y,v,w,j);case pi:var _=w._init;return p(v,y,b,_(w._payload),j)}if(fa(w)||Jo(w))return v=v.get(b)||null,u(y,v,w,j,null);Pl(y,w)}return null}function g(v,y,b,w){for(var j=null,_=null,E=y,N=y=0,O=null;E!==null&&N<b.length;N++){E.index>N?(O=E,E=null):O=E.sibling;var I=h(v,E,b[N],w);if(I===null){E===null&&(E=O);break}e&&E&&I.alternate===null&&t(v,E),y=s(I,y,N),_===null?j=I:_.sibling=I,_=I,E=O}if(N===b.length)return r(v,E),kt&&Yi(v,N),j;if(E===null){for(;N<b.length;N++)E=f(v,b[N],w),E!==null&&(y=s(E,y,N),_===null?j=E:_.sibling=E,_=E);return kt&&Yi(v,N),j}for(E=n(v,E);N<b.length;N++)O=p(E,v,N,b[N],w),O!==null&&(e&&O.alternate!==null&&E.delete(O.key===null?N:O.key),y=s(O,y,N),_===null?j=O:_.sibling=O,_=O);return e&&E.forEach(function(te){return t(v,te)}),kt&&Yi(v,N),j}function m(v,y,b,w){var j=Jo(b);if(typeof j!="function")throw Error(ke(150));if(b=j.call(b),b==null)throw Error(ke(151));for(var _=j=null,E=y,N=y=0,O=null,I=b.next();E!==null&&!I.done;N++,I=b.next()){E.index>N?(O=E,E=null):O=E.sibling;var te=h(v,E,I.value,w);if(te===null){E===null&&(E=O);break}e&&E&&te.alternate===null&&t(v,E),y=s(te,y,N),_===null?j=te:_.sibling=te,_=te,E=O}if(I.done)return r(v,E),kt&&Yi(v,N),j;if(E===null){for(;!I.done;N++,I=b.next())I=f(v,I.value,w),I!==null&&(y=s(I,y,N),_===null?j=I:_.sibling=I,_=I);return kt&&Yi(v,N),j}for(E=n(v,E);!I.done;N++,I=b.next())I=p(E,v,N,I.value,w),I!==null&&(e&&I.alternate!==null&&E.delete(I.key===null?N:I.key),y=s(I,y,N),_===null?j=I:_.sibling=I,_=I);return e&&E.forEach(function(T){return t(v,T)}),kt&&Yi(v,N),j}function x(v,y,b,w){if(typeof b=="object"&&b!==null&&b.type===to&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case xl:e:{for(var j=b.key,_=y;_!==null;){if(_.key===j){if(j=b.type,j===to){if(_.tag===7){r(v,_.sibling),y=i(_,b.props.children),y.return=v,v=y;break e}}else if(_.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===pi&&Hm(j)===_.type){r(v,_.sibling),y=i(_,b.props),y.ref=na(v,_,b),y.return=v,v=y;break e}r(v,_);break}else t(v,_);_=_.sibling}b.type===to?(y=as(b.props.children,v.mode,w,b.key),y.return=v,v=y):(w=cc(b.type,b.key,b.props,null,v.mode,w),w.ref=na(v,y,b),w.return=v,v=w)}return a(v);case eo:e:{for(_=b.key;y!==null;){if(y.key===_)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){r(v,y.sibling),y=i(y,b.children||[]),y.return=v,v=y;break e}else{r(v,y);break}else t(v,y);y=y.sibling}y=ou(b,v.mode,w),y.return=v,v=y}return a(v);case pi:return _=b._init,x(v,y,_(b._payload),w)}if(fa(b))return g(v,y,b,w);if(Jo(b))return m(v,y,b,w);Pl(v,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(r(v,y.sibling),y=i(y,b),y.return=v,v=y):(r(v,y),y=su(b,v.mode,w),y.return=v,v=y),a(v)):r(v,y)}return x}var jo=ux(!0),hx=ux(!1),kc=Ii(null),jc=null,co=null,Cf=null;function Ef(){Cf=co=jc=null}function Tf(e){var t=kc.current;bt(kc),e._currentValue=t}function fh(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function yo(e,t){jc=e,Cf=co=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(mr=!0),e.firstContext=null)}function Vr(e){var t=e._currentValue;if(Cf!==e)if(e={context:e,memoizedValue:t,next:null},co===null){if(jc===null)throw Error(ke(308));co=e,jc.dependencies={lanes:0,firstContext:e}}else co=co.next=e;return t}var ns=null;function Nf(e){ns===null?ns=[e]:ns.push(e)}function fx(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,Nf(t)):(r.next=i.next,i.next=r),t.interleaved=r,Kn(e,n)}function Kn(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var mi=!1;function Pf(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function px(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function qn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ti(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,st&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,Kn(e,r)}return i=n.interleaved,i===null?(t.next=t,Nf(n)):(t.next=i.next,i.next=t),n.interleaved=t,Kn(e,r)}function nc(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,mf(e,r)}}function Um(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?i=s=t:s=s.next=t}else i=s=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Cc(e,t,r,n){var i=e.updateQueue;mi=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var c=l,d=c.next;c.next=null,a===null?s=d:a.next=d,a=c;var u=e.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==a&&(l===null?u.firstBaseUpdate=d:l.next=d,u.lastBaseUpdate=c))}if(s!==null){var f=i.baseState;a=0,u=d=c=null,l=s;do{var h=l.lane,p=l.eventTime;if((n&h)===h){u!==null&&(u=u.next={eventTime:p,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var g=e,m=l;switch(h=t,p=r,m.tag){case 1:if(g=m.payload,typeof g=="function"){f=g.call(p,f,h);break e}f=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=m.payload,h=typeof g=="function"?g.call(p,f,h):g,h==null)break e;f=Tt({},f,h);break e;case 2:mi=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,h=i.effects,h===null?i.effects=[l]:h.push(l))}else p={eventTime:p,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(d=u=p,c=f):u=u.next=p,a|=h;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;h=l,l=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(u===null&&(c=f),i.baseState=c,i.firstBaseUpdate=d,i.lastBaseUpdate=u,t=i.shared.interleaved,t!==null){i=t;do a|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);hs|=a,e.lanes=a,e.memoizedState=f}}function Wm(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(ke(191,i));i.call(n)}}}var ol={},Rn=Ii(ol),Wa=Ii(ol),Ga=Ii(ol);function is(e){if(e===ol)throw Error(ke(174));return e}function Rf(e,t){switch(ft(Ga,t),ft(Wa,e),ft(Rn,ol),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:qu(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=qu(t,e)}bt(Rn),ft(Rn,t)}function Co(){bt(Rn),bt(Wa),bt(Ga)}function mx(e){is(Ga.current);var t=is(Rn.current),r=qu(t,e.type);t!==r&&(ft(Wa,e),ft(Rn,r))}function Of(e){Wa.current===e&&(bt(Rn),bt(Wa))}var Ct=Ii(0);function Ec(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Qd=[];function Af(){for(var e=0;e<Qd.length;e++)Qd[e]._workInProgressVersionPrimary=null;Qd.length=0}var ic=Jn.ReactCurrentDispatcher,eu=Jn.ReactCurrentBatchConfig,us=0,Et=null,It=null,Bt=null,Tc=!1,ja=!1,Va=0,K2=0;function Jt(){throw Error(ke(321))}function Mf(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!un(e[r],t[r]))return!1;return!0}function $f(e,t,r,n,i,s){if(us=s,Et=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ic.current=e===null||e.memoizedState===null?eS:tS,e=r(n,i),ja){s=0;do{if(ja=!1,Va=0,25<=s)throw Error(ke(301));s+=1,Bt=It=null,t.updateQueue=null,ic.current=rS,e=r(n,i)}while(ja)}if(ic.current=Nc,t=It!==null&&It.next!==null,us=0,Bt=It=Et=null,Tc=!1,t)throw Error(ke(300));return e}function Lf(){var e=Va!==0;return Va=0,e}function Cn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Bt===null?Et.memoizedState=Bt=e:Bt=Bt.next=e,Bt}function qr(){if(It===null){var e=Et.alternate;e=e!==null?e.memoizedState:null}else e=It.next;var t=Bt===null?Et.memoizedState:Bt.next;if(t!==null)Bt=t,It=e;else{if(e===null)throw Error(ke(310));It=e,e={memoizedState:It.memoizedState,baseState:It.baseState,baseQueue:It.baseQueue,queue:It.queue,next:null},Bt===null?Et.memoizedState=Bt=e:Bt=Bt.next=e}return Bt}function qa(e,t){return typeof t=="function"?t(e):t}function tu(e){var t=qr(),r=t.queue;if(r===null)throw Error(ke(311));r.lastRenderedReducer=e;var n=It,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var l=a=null,c=null,d=s;do{var u=d.lane;if((us&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:e(n,d.action);else{var f={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=f,a=n):c=c.next=f,Et.lanes|=u,hs|=u}d=d.next}while(d!==null&&d!==s);c===null?a=n:c.next=l,un(n,t.memoizedState)||(mr=!0),t.memoizedState=n,t.baseState=a,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do s=i.lane,Et.lanes|=s,hs|=s,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function ru(e){var t=qr(),r=t.queue;if(r===null)throw Error(ke(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(i!==null){r.pending=null;var a=i=i.next;do s=e(s,a.action),a=a.next;while(a!==i);un(s,t.memoizedState)||(mr=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function gx(){}function vx(e,t){var r=Et,n=qr(),i=t(),s=!un(n.memoizedState,i);if(s&&(n.memoizedState=i,mr=!0),n=n.queue,If(bx.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||Bt!==null&&Bt.memoizedState.tag&1){if(r.flags|=2048,Ya(9,xx.bind(null,r,n,i,t),void 0,null),Ht===null)throw Error(ke(349));us&30||yx(r,t,i)}return i}function yx(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Et.updateQueue,t===null?(t={lastEffect:null,stores:null},Et.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function xx(e,t,r,n){t.value=r,t.getSnapshot=n,wx(t)&&_x(e)}function bx(e,t,r){return r(function(){wx(t)&&_x(e)})}function wx(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!un(e,r)}catch{return!0}}function _x(e){var t=Kn(e,1);t!==null&&dn(t,e,1,-1)}function Gm(e){var t=Cn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:qa,lastRenderedState:e},t.queue=e,e=e.dispatch=Q2.bind(null,Et,e),[t.memoizedState,e]}function Ya(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Et.updateQueue,t===null?(t={lastEffect:null,stores:null},Et.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function Sx(){return qr().memoizedState}function sc(e,t,r,n){var i=Cn();Et.flags|=e,i.memoizedState=Ya(1|t,r,void 0,n===void 0?null:n)}function ad(e,t,r,n){var i=qr();n=n===void 0?null:n;var s=void 0;if(It!==null){var a=It.memoizedState;if(s=a.destroy,n!==null&&Mf(n,a.deps)){i.memoizedState=Ya(t,r,s,n);return}}Et.flags|=e,i.memoizedState=Ya(1|t,r,s,n)}function Vm(e,t){return sc(8390656,8,e,t)}function If(e,t){return ad(2048,8,e,t)}function kx(e,t){return ad(4,2,e,t)}function jx(e,t){return ad(4,4,e,t)}function Cx(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Ex(e,t,r){return r=r!=null?r.concat([e]):null,ad(4,4,Cx.bind(null,t,e),r)}function Df(){}function Tx(e,t){var r=qr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Mf(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Nx(e,t){var r=qr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Mf(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Px(e,t,r){return us&21?(un(r,t)||(r=$y(),Et.lanes|=r,hs|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,mr=!0),e.memoizedState=r)}function Z2(e,t){var r=ct;ct=r!==0&&4>r?r:4,e(!0);var n=eu.transition;eu.transition={};try{e(!1),t()}finally{ct=r,eu.transition=n}}function Rx(){return qr().memoizedState}function J2(e,t,r){var n=Pi(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Ox(e))Ax(t,r);else if(r=fx(e,t,r,n),r!==null){var i=lr();dn(r,e,n,i),Mx(r,t,n)}}function Q2(e,t,r){var n=Pi(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Ox(e))Ax(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var a=t.lastRenderedState,l=s(a,r);if(i.hasEagerState=!0,i.eagerState=l,un(l,a)){var c=t.interleaved;c===null?(i.next=i,Nf(t)):(i.next=c.next,c.next=i),t.interleaved=i;return}}catch{}finally{}r=fx(e,t,i,n),r!==null&&(i=lr(),dn(r,e,n,i),Mx(r,t,n))}}function Ox(e){var t=e.alternate;return e===Et||t!==null&&t===Et}function Ax(e,t){ja=Tc=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Mx(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,mf(e,r)}}var Nc={readContext:Vr,useCallback:Jt,useContext:Jt,useEffect:Jt,useImperativeHandle:Jt,useInsertionEffect:Jt,useLayoutEffect:Jt,useMemo:Jt,useReducer:Jt,useRef:Jt,useState:Jt,useDebugValue:Jt,useDeferredValue:Jt,useTransition:Jt,useMutableSource:Jt,useSyncExternalStore:Jt,useId:Jt,unstable_isNewReconciler:!1},eS={readContext:Vr,useCallback:function(e,t){return Cn().memoizedState=[e,t===void 0?null:t],e},useContext:Vr,useEffect:Vm,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,sc(4194308,4,Cx.bind(null,t,e),r)},useLayoutEffect:function(e,t){return sc(4194308,4,e,t)},useInsertionEffect:function(e,t){return sc(4,2,e,t)},useMemo:function(e,t){var r=Cn();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Cn();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=J2.bind(null,Et,e),[n.memoizedState,e]},useRef:function(e){var t=Cn();return e={current:e},t.memoizedState=e},useState:Gm,useDebugValue:Df,useDeferredValue:function(e){return Cn().memoizedState=e},useTransition:function(){var e=Gm(!1),t=e[0];return e=Z2.bind(null,e[1]),Cn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Et,i=Cn();if(kt){if(r===void 0)throw Error(ke(407));r=r()}else{if(r=t(),Ht===null)throw Error(ke(349));us&30||yx(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,Vm(bx.bind(null,n,s,e),[e]),n.flags|=2048,Ya(9,xx.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=Cn(),t=Ht.identifierPrefix;if(kt){var r=Vn,n=Gn;r=(n&~(1<<32-cn(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Va++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=K2++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},tS={readContext:Vr,useCallback:Tx,useContext:Vr,useEffect:If,useImperativeHandle:Ex,useInsertionEffect:kx,useLayoutEffect:jx,useMemo:Nx,useReducer:tu,useRef:Sx,useState:function(){return tu(qa)},useDebugValue:Df,useDeferredValue:function(e){var t=qr();return Px(t,It.memoizedState,e)},useTransition:function(){var e=tu(qa)[0],t=qr().memoizedState;return[e,t]},useMutableSource:gx,useSyncExternalStore:vx,useId:Rx,unstable_isNewReconciler:!1},rS={readContext:Vr,useCallback:Tx,useContext:Vr,useEffect:If,useImperativeHandle:Ex,useInsertionEffect:kx,useLayoutEffect:jx,useMemo:Nx,useReducer:ru,useRef:Sx,useState:function(){return ru(qa)},useDebugValue:Df,useDeferredValue:function(e){var t=qr();return It===null?t.memoizedState=e:Px(t,It.memoizedState,e)},useTransition:function(){var e=ru(qa)[0],t=qr().memoizedState;return[e,t]},useMutableSource:gx,useSyncExternalStore:vx,useId:Rx,unstable_isNewReconciler:!1};function rn(e,t){if(e&&e.defaultProps){t=Tt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function ph(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Tt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var ld={isMounted:function(e){return(e=e._reactInternals)?gs(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=lr(),i=Pi(e),s=qn(n,i);s.payload=t,r!=null&&(s.callback=r),t=Ti(e,s,i),t!==null&&(dn(t,e,i,n),nc(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=lr(),i=Pi(e),s=qn(n,i);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=Ti(e,s,i),t!==null&&(dn(t,e,i,n),nc(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=lr(),n=Pi(e),i=qn(r,n);i.tag=2,t!=null&&(i.callback=t),t=Ti(e,i,n),t!==null&&(dn(t,e,n,r),nc(t,e,n))}};function qm(e,t,r,n,i,s,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,a):t.prototype&&t.prototype.isPureReactComponent?!Fa(r,n)||!Fa(i,s):!0}function $x(e,t,r){var n=!1,i=Ai,s=t.contextType;return typeof s=="object"&&s!==null?s=Vr(s):(i=vr(t)?cs:rr.current,n=t.contextTypes,s=(n=n!=null)?So(e,i):Ai),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=ld,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function Ym(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&ld.enqueueReplaceState(t,t.state,null)}function mh(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},Pf(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=Vr(s):(s=vr(t)?cs:rr.current,i.context=So(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(ph(e,t,s,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&ld.enqueueReplaceState(i,i.state,null),Cc(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function Eo(e,t){try{var r="",n=t;do r+=P_(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function nu(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function gh(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var nS=typeof WeakMap=="function"?WeakMap:Map;function Lx(e,t,r){r=qn(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Rc||(Rc=!0,Ch=n),gh(e,t)},r}function Ix(e,t,r){r=qn(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){gh(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){gh(e,t),typeof n!="function"&&(Ni===null?Ni=new Set([this]):Ni.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),r}function Xm(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new nS;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=vS.bind(null,e,t,r),t.then(e,e))}function Km(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Zm(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=qn(-1,1),t.tag=2,Ti(r,t,1))),r.lanes|=1),e)}var iS=Jn.ReactCurrentOwner,mr=!1;function or(e,t,r,n){t.child=e===null?hx(t,null,r,n):jo(t,e.child,r,n)}function Jm(e,t,r,n,i){r=r.render;var s=t.ref;return yo(t,i),n=$f(e,t,r,n,s,i),r=Lf(),e!==null&&!mr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Zn(e,t,i)):(kt&&r&&Sf(t),t.flags|=1,or(e,t,n,i),t.child)}function Qm(e,t,r,n,i){if(e===null){var s=r.type;return typeof s=="function"&&!Vf(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,Dx(e,t,s,n,i)):(e=cc(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:Fa,r(a,n)&&e.ref===t.ref)return Zn(e,t,i)}return t.flags|=1,e=Ri(s,n),e.ref=t.ref,e.return=t,t.child=e}function Dx(e,t,r,n,i){if(e!==null){var s=e.memoizedProps;if(Fa(s,n)&&e.ref===t.ref)if(mr=!1,t.pendingProps=n=s,(e.lanes&i)!==0)e.flags&131072&&(mr=!0);else return t.lanes=e.lanes,Zn(e,t,i)}return vh(e,t,r,n,i)}function zx(e,t,r){var n=t.pendingProps,i=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ft(ho,Cr),Cr|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ft(ho,Cr),Cr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,ft(ho,Cr),Cr|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,ft(ho,Cr),Cr|=n;return or(e,t,i,r),t.child}function Fx(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function vh(e,t,r,n,i){var s=vr(r)?cs:rr.current;return s=So(t,s),yo(t,i),r=$f(e,t,r,n,s,i),n=Lf(),e!==null&&!mr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Zn(e,t,i)):(kt&&n&&Sf(t),t.flags|=1,or(e,t,r,i),t.child)}function eg(e,t,r,n,i){if(vr(r)){var s=!0;wc(t)}else s=!1;if(yo(t,i),t.stateNode===null)oc(e,t),$x(t,r,n),mh(t,r,n,i),n=!0;else if(e===null){var a=t.stateNode,l=t.memoizedProps;a.props=l;var c=a.context,d=r.contextType;typeof d=="object"&&d!==null?d=Vr(d):(d=vr(r)?cs:rr.current,d=So(t,d));var u=r.getDerivedStateFromProps,f=typeof u=="function"||typeof a.getSnapshotBeforeUpdate=="function";f||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==n||c!==d)&&Ym(t,a,n,d),mi=!1;var h=t.memoizedState;a.state=h,Cc(t,n,a,i),c=t.memoizedState,l!==n||h!==c||gr.current||mi?(typeof u=="function"&&(ph(t,r,u,n),c=t.memoizedState),(l=mi||qm(t,r,l,n,h,c,d))?(f||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),a.props=n,a.state=c,a.context=d,n=l):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{a=t.stateNode,px(e,t),l=t.memoizedProps,d=t.type===t.elementType?l:rn(t.type,l),a.props=d,f=t.pendingProps,h=a.context,c=r.contextType,typeof c=="object"&&c!==null?c=Vr(c):(c=vr(r)?cs:rr.current,c=So(t,c));var p=r.getDerivedStateFromProps;(u=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==f||h!==c)&&Ym(t,a,n,c),mi=!1,h=t.memoizedState,a.state=h,Cc(t,n,a,i);var g=t.memoizedState;l!==f||h!==g||gr.current||mi?(typeof p=="function"&&(ph(t,r,p,n),g=t.memoizedState),(d=mi||qm(t,r,d,n,h,g,c)||!1)?(u||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,g,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,g,c)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=g),a.props=n,a.state=g,a.context=c,n=d):(typeof a.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return yh(e,t,r,n,s,i)}function yh(e,t,r,n,i,s){Fx(e,t);var a=(t.flags&128)!==0;if(!n&&!a)return i&&zm(t,r,!1),Zn(e,t,s);n=t.stateNode,iS.current=t;var l=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&a?(t.child=jo(t,e.child,null,s),t.child=jo(t,null,l,s)):or(e,t,l,s),t.memoizedState=n.state,i&&zm(t,r,!0),t.child}function Bx(e){var t=e.stateNode;t.pendingContext?Dm(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Dm(e,t.context,!1),Rf(e,t.containerInfo)}function tg(e,t,r,n,i){return ko(),jf(i),t.flags|=256,or(e,t,r,n),t.child}var xh={dehydrated:null,treeContext:null,retryLane:0};function bh(e){return{baseLanes:e,cachePool:null,transitions:null}}function Hx(e,t,r){var n=t.pendingProps,i=Ct.current,s=!1,a=(t.flags&128)!==0,l;if((l=a)||(l=e!==null&&e.memoizedState===null?!1:(i&2)!==0),l?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),ft(Ct,i&1),e===null)return hh(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=n.children,e=n.fallback,s?(n=t.mode,s=t.child,a={mode:"hidden",children:a},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=ud(a,n,0,null),e=as(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=bh(r),t.memoizedState=xh,e):zf(t,a));if(i=e.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return sS(e,t,a,n,l,i,r);if(s){s=n.fallback,a=t.mode,i=e.child,l=i.sibling;var c={mode:"hidden",children:n.children};return!(a&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=Ri(i,c),n.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=Ri(l,s):(s=as(s,a,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,a=e.child.memoizedState,a=a===null?bh(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=e.childLanes&~r,t.memoizedState=xh,n}return s=e.child,e=s.sibling,n=Ri(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function zf(e,t){return t=ud({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Rl(e,t,r,n){return n!==null&&jf(n),jo(t,e.child,null,r),e=zf(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function sS(e,t,r,n,i,s,a){if(r)return t.flags&256?(t.flags&=-257,n=nu(Error(ke(422))),Rl(e,t,a,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,i=t.mode,n=ud({mode:"visible",children:n.children},i,0,null),s=as(s,i,a,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&jo(t,e.child,null,a),t.child.memoizedState=bh(a),t.memoizedState=xh,s);if(!(t.mode&1))return Rl(e,t,a,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var l=n.dgst;return n=l,s=Error(ke(419)),n=nu(s,n,void 0),Rl(e,t,a,n)}if(l=(a&e.childLanes)!==0,mr||l){if(n=Ht,n!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Kn(e,i),dn(n,e,i,-1))}return Gf(),n=nu(Error(ke(421))),Rl(e,t,a,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=yS.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,Nr=Ei(i.nextSibling),Or=t,kt=!0,an=null,e!==null&&(Br[Hr++]=Gn,Br[Hr++]=Vn,Br[Hr++]=ds,Gn=e.id,Vn=e.overflow,ds=t),t=zf(t,n.children),t.flags|=4096,t)}function rg(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),fh(e.return,t,r)}function iu(e,t,r,n,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function Ux(e,t,r){var n=t.pendingProps,i=n.revealOrder,s=n.tail;if(or(e,t,n.children,r),n=Ct.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&rg(e,r,t);else if(e.tag===19)rg(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(ft(Ct,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&Ec(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),iu(t,!1,i,r,s);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&Ec(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}iu(t,!0,r,null,s);break;case"together":iu(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function oc(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Zn(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),hs|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ke(153));if(t.child!==null){for(e=t.child,r=Ri(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Ri(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function oS(e,t,r){switch(t.tag){case 3:Bx(t),ko();break;case 5:mx(t);break;case 1:vr(t.type)&&wc(t);break;case 4:Rf(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;ft(kc,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(ft(Ct,Ct.current&1),t.flags|=128,null):r&t.child.childLanes?Hx(e,t,r):(ft(Ct,Ct.current&1),e=Zn(e,t,r),e!==null?e.sibling:null);ft(Ct,Ct.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return Ux(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),ft(Ct,Ct.current),n)break;return null;case 22:case 23:return t.lanes=0,zx(e,t,r)}return Zn(e,t,r)}var Wx,wh,Gx,Vx;Wx=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};wh=function(){};Gx=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,is(Rn.current);var s=null;switch(r){case"input":i=Uu(e,i),n=Uu(e,n),s=[];break;case"select":i=Tt({},i,{value:void 0}),n=Tt({},n,{value:void 0}),s=[];break;case"textarea":i=Vu(e,i),n=Vu(e,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=xc)}Yu(r,n);var a;r=null;for(d in i)if(!n.hasOwnProperty(d)&&i.hasOwnProperty(d)&&i[d]!=null)if(d==="style"){var l=i[d];for(a in l)l.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Aa.hasOwnProperty(d)?s||(s=[]):(s=s||[]).push(d,null));for(d in n){var c=n[d];if(l=i!=null?i[d]:void 0,n.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(r||(r={}),r[a]=c[a])}else r||(s||(s=[]),s.push(d,r)),r=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(s=s||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Aa.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&vt("scroll",e),s||l===c||(s=[])):(s=s||[]).push(d,c))}r&&(s=s||[]).push("style",r);var d=s;(t.updateQueue=d)&&(t.flags|=4)}};Vx=function(e,t,r,n){r!==n&&(t.flags|=4)};function ia(e,t){if(!kt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Qt(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function aS(e,t,r){var n=t.pendingProps;switch(kf(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qt(t),null;case 1:return vr(t.type)&&bc(),Qt(t),null;case 3:return n=t.stateNode,Co(),bt(gr),bt(rr),Af(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Nl(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,an!==null&&(Nh(an),an=null))),wh(e,t),Qt(t),null;case 5:Of(t);var i=is(Ga.current);if(r=t.type,e!==null&&t.stateNode!=null)Gx(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(ke(166));return Qt(t),null}if(e=is(Rn.current),Nl(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[En]=t,n[Ua]=s,e=(t.mode&1)!==0,r){case"dialog":vt("cancel",n),vt("close",n);break;case"iframe":case"object":case"embed":vt("load",n);break;case"video":case"audio":for(i=0;i<ma.length;i++)vt(ma[i],n);break;case"source":vt("error",n);break;case"img":case"image":case"link":vt("error",n),vt("load",n);break;case"details":vt("toggle",n);break;case"input":um(n,s),vt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},vt("invalid",n);break;case"textarea":fm(n,s),vt("invalid",n)}Yu(r,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var l=s[a];a==="children"?typeof l=="string"?n.textContent!==l&&(s.suppressHydrationWarning!==!0&&Tl(n.textContent,l,e),i=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&Tl(n.textContent,l,e),i=["children",""+l]):Aa.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&vt("scroll",n)}switch(r){case"input":bl(n),hm(n,s,!0);break;case"textarea":bl(n),pm(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=xc)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=by(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=a.createElement(r,{is:n.is}):(e=a.createElement(r),r==="select"&&(a=e,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):e=a.createElementNS(e,r),e[En]=t,e[Ua]=n,Wx(e,t,!1,!1),t.stateNode=e;e:{switch(a=Xu(r,n),r){case"dialog":vt("cancel",e),vt("close",e),i=n;break;case"iframe":case"object":case"embed":vt("load",e),i=n;break;case"video":case"audio":for(i=0;i<ma.length;i++)vt(ma[i],e);i=n;break;case"source":vt("error",e),i=n;break;case"img":case"image":case"link":vt("error",e),vt("load",e),i=n;break;case"details":vt("toggle",e),i=n;break;case"input":um(e,n),i=Uu(e,n),vt("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=Tt({},n,{value:void 0}),vt("invalid",e);break;case"textarea":fm(e,n),i=Vu(e,n),vt("invalid",e);break;default:i=n}Yu(r,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var c=l[s];s==="style"?Sy(e,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&wy(e,c)):s==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Ma(e,c):typeof c=="number"&&Ma(e,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Aa.hasOwnProperty(s)?c!=null&&s==="onScroll"&&vt("scroll",e):c!=null&&cf(e,s,c,a))}switch(r){case"input":bl(e),hm(e,n,!1);break;case"textarea":bl(e),pm(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Oi(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?po(e,!!n.multiple,s,!1):n.defaultValue!=null&&po(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=xc)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Qt(t),null;case 6:if(e&&t.stateNode!=null)Vx(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(ke(166));if(r=is(Ga.current),is(Rn.current),Nl(t)){if(n=t.stateNode,r=t.memoizedProps,n[En]=t,(s=n.nodeValue!==r)&&(e=Or,e!==null))switch(e.tag){case 3:Tl(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Tl(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[En]=t,t.stateNode=n}return Qt(t),null;case 13:if(bt(Ct),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(kt&&Nr!==null&&t.mode&1&&!(t.flags&128))dx(),ko(),t.flags|=98560,s=!1;else if(s=Nl(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(ke(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ke(317));s[En]=t}else ko(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Qt(t),s=!1}else an!==null&&(Nh(an),an=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Ct.current&1?zt===0&&(zt=3):Gf())),t.updateQueue!==null&&(t.flags|=4),Qt(t),null);case 4:return Co(),wh(e,t),e===null&&Ba(t.stateNode.containerInfo),Qt(t),null;case 10:return Tf(t.type._context),Qt(t),null;case 17:return vr(t.type)&&bc(),Qt(t),null;case 19:if(bt(Ct),s=t.memoizedState,s===null)return Qt(t),null;if(n=(t.flags&128)!==0,a=s.rendering,a===null)if(n)ia(s,!1);else{if(zt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=Ec(e),a!==null){for(t.flags|=128,ia(s,!1),n=a.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,e=a.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return ft(Ct,Ct.current&1|2),t.child}e=e.sibling}s.tail!==null&&Rt()>To&&(t.flags|=128,n=!0,ia(s,!1),t.lanes=4194304)}else{if(!n)if(e=Ec(a),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),ia(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!kt)return Qt(t),null}else 2*Rt()-s.renderingStartTime>To&&r!==1073741824&&(t.flags|=128,n=!0,ia(s,!1),t.lanes=4194304);s.isBackwards?(a.sibling=t.child,t.child=a):(r=s.last,r!==null?r.sibling=a:t.child=a,s.last=a)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Rt(),t.sibling=null,r=Ct.current,ft(Ct,n?r&1|2:r&1),t):(Qt(t),null);case 22:case 23:return Wf(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Cr&1073741824&&(Qt(t),t.subtreeFlags&6&&(t.flags|=8192)):Qt(t),null;case 24:return null;case 25:return null}throw Error(ke(156,t.tag))}function lS(e,t){switch(kf(t),t.tag){case 1:return vr(t.type)&&bc(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Co(),bt(gr),bt(rr),Af(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Of(t),null;case 13:if(bt(Ct),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ke(340));ko()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return bt(Ct),null;case 4:return Co(),null;case 10:return Tf(t.type._context),null;case 22:case 23:return Wf(),null;case 24:return null;default:return null}}var Ol=!1,tr=!1,cS=typeof WeakSet=="function"?WeakSet:Set,Me=null;function uo(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Pt(e,t,n)}else r.current=null}function _h(e,t,r){try{r()}catch(n){Pt(e,t,n)}}var ng=!1;function dS(e,t){if(sh=gc,e=Zy(),_f(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,l=-1,c=-1,d=0,u=0,f=e,h=null;t:for(;;){for(var p;f!==r||i!==0&&f.nodeType!==3||(l=a+i),f!==s||n!==0&&f.nodeType!==3||(c=a+n),f.nodeType===3&&(a+=f.nodeValue.length),(p=f.firstChild)!==null;)h=f,f=p;for(;;){if(f===e)break t;if(h===r&&++d===i&&(l=a),h===s&&++u===n&&(c=a),(p=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=p}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(oh={focusedElem:e,selectionRange:r},gc=!1,Me=t;Me!==null;)if(t=Me,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Me=e;else for(;Me!==null;){t=Me;try{var g=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var m=g.memoizedProps,x=g.memoizedState,v=t.stateNode,y=v.getSnapshotBeforeUpdate(t.elementType===t.type?m:rn(t.type,m),x);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ke(163))}}catch(w){Pt(t,t.return,w)}if(e=t.sibling,e!==null){e.return=t.return,Me=e;break}Me=t.return}return g=ng,ng=!1,g}function Ca(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&_h(t,r,s)}i=i.next}while(i!==n)}}function cd(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Sh(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function qx(e){var t=e.alternate;t!==null&&(e.alternate=null,qx(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[En],delete t[Ua],delete t[ch],delete t[V2],delete t[q2])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Yx(e){return e.tag===5||e.tag===3||e.tag===4}function ig(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Yx(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function kh(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=xc));else if(n!==4&&(e=e.child,e!==null))for(kh(e,t,r),e=e.sibling;e!==null;)kh(e,t,r),e=e.sibling}function jh(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(jh(e,t,r),e=e.sibling;e!==null;)jh(e,t,r),e=e.sibling}var Wt=null,sn=!1;function hi(e,t,r){for(r=r.child;r!==null;)Xx(e,t,r),r=r.sibling}function Xx(e,t,r){if(Pn&&typeof Pn.onCommitFiberUnmount=="function")try{Pn.onCommitFiberUnmount(td,r)}catch{}switch(r.tag){case 5:tr||uo(r,t);case 6:var n=Wt,i=sn;Wt=null,hi(e,t,r),Wt=n,sn=i,Wt!==null&&(sn?(e=Wt,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Wt.removeChild(r.stateNode));break;case 18:Wt!==null&&(sn?(e=Wt,r=r.stateNode,e.nodeType===8?Zd(e.parentNode,r):e.nodeType===1&&Zd(e,r),Da(e)):Zd(Wt,r.stateNode));break;case 4:n=Wt,i=sn,Wt=r.stateNode.containerInfo,sn=!0,hi(e,t,r),Wt=n,sn=i;break;case 0:case 11:case 14:case 15:if(!tr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&_h(r,t,a),i=i.next}while(i!==n)}hi(e,t,r);break;case 1:if(!tr&&(uo(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){Pt(r,t,l)}hi(e,t,r);break;case 21:hi(e,t,r);break;case 22:r.mode&1?(tr=(n=tr)||r.memoizedState!==null,hi(e,t,r),tr=n):hi(e,t,r);break;default:hi(e,t,r)}}function sg(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new cS),t.forEach(function(n){var i=xS.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Jr(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=e,a=t,l=a;e:for(;l!==null;){switch(l.tag){case 5:Wt=l.stateNode,sn=!1;break e;case 3:Wt=l.stateNode.containerInfo,sn=!0;break e;case 4:Wt=l.stateNode.containerInfo,sn=!0;break e}l=l.return}if(Wt===null)throw Error(ke(160));Xx(s,a,i),Wt=null,sn=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(d){Pt(i,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Kx(t,e),t=t.sibling}function Kx(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Jr(t,e),kn(e),n&4){try{Ca(3,e,e.return),cd(3,e)}catch(m){Pt(e,e.return,m)}try{Ca(5,e,e.return)}catch(m){Pt(e,e.return,m)}}break;case 1:Jr(t,e),kn(e),n&512&&r!==null&&uo(r,r.return);break;case 5:if(Jr(t,e),kn(e),n&512&&r!==null&&uo(r,r.return),e.flags&32){var i=e.stateNode;try{Ma(i,"")}catch(m){Pt(e,e.return,m)}}if(n&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,a=r!==null?r.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&yy(i,s),Xu(l,a);var d=Xu(l,s);for(a=0;a<c.length;a+=2){var u=c[a],f=c[a+1];u==="style"?Sy(i,f):u==="dangerouslySetInnerHTML"?wy(i,f):u==="children"?Ma(i,f):cf(i,u,f,d)}switch(l){case"input":Wu(i,s);break;case"textarea":xy(i,s);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?po(i,!!s.multiple,p,!1):h!==!!s.multiple&&(s.defaultValue!=null?po(i,!!s.multiple,s.defaultValue,!0):po(i,!!s.multiple,s.multiple?[]:"",!1))}i[Ua]=s}catch(m){Pt(e,e.return,m)}}break;case 6:if(Jr(t,e),kn(e),n&4){if(e.stateNode===null)throw Error(ke(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(m){Pt(e,e.return,m)}}break;case 3:if(Jr(t,e),kn(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Da(t.containerInfo)}catch(m){Pt(e,e.return,m)}break;case 4:Jr(t,e),kn(e);break;case 13:Jr(t,e),kn(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Hf=Rt())),n&4&&sg(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(tr=(d=tr)||u,Jr(t,e),tr=d):Jr(t,e),kn(e),n&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!u&&e.mode&1)for(Me=e,u=e.child;u!==null;){for(f=Me=u;Me!==null;){switch(h=Me,p=h.child,h.tag){case 0:case 11:case 14:case 15:Ca(4,h,h.return);break;case 1:uo(h,h.return);var g=h.stateNode;if(typeof g.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(m){Pt(n,r,m)}}break;case 5:uo(h,h.return);break;case 22:if(h.memoizedState!==null){ag(f);continue}}p!==null?(p.return=h,Me=p):ag(f)}u=u.sibling}e:for(u=null,f=e;;){if(f.tag===5){if(u===null){u=f;try{i=f.stateNode,d?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=f.stateNode,c=f.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=_y("display",a))}catch(m){Pt(e,e.return,m)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(m){Pt(e,e.return,m)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Jr(t,e),kn(e),n&4&&sg(e);break;case 21:break;default:Jr(t,e),kn(e)}}function kn(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(Yx(r)){var n=r;break e}r=r.return}throw Error(ke(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Ma(i,""),n.flags&=-33);var s=ig(e);jh(e,s,i);break;case 3:case 4:var a=n.stateNode.containerInfo,l=ig(e);kh(e,l,a);break;default:throw Error(ke(161))}}catch(c){Pt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function uS(e,t,r){Me=e,Zx(e)}function Zx(e,t,r){for(var n=(e.mode&1)!==0;Me!==null;){var i=Me,s=i.child;if(i.tag===22&&n){var a=i.memoizedState!==null||Ol;if(!a){var l=i.alternate,c=l!==null&&l.memoizedState!==null||tr;l=Ol;var d=tr;if(Ol=a,(tr=c)&&!d)for(Me=i;Me!==null;)a=Me,c=a.child,a.tag===22&&a.memoizedState!==null?lg(i):c!==null?(c.return=a,Me=c):lg(i);for(;s!==null;)Me=s,Zx(s),s=s.sibling;Me=i,Ol=l,tr=d}og(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Me=s):og(e)}}function og(e){for(;Me!==null;){var t=Me;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:tr||cd(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!tr)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:rn(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&Wm(t,s,n);break;case 3:var a=t.updateQueue;if(a!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Wm(t,a,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&Da(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ke(163))}tr||t.flags&512&&Sh(t)}catch(h){Pt(t,t.return,h)}}if(t===e){Me=null;break}if(r=t.sibling,r!==null){r.return=t.return,Me=r;break}Me=t.return}}function ag(e){for(;Me!==null;){var t=Me;if(t===e){Me=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Me=r;break}Me=t.return}}function lg(e){for(;Me!==null;){var t=Me;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{cd(4,t)}catch(c){Pt(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(c){Pt(t,i,c)}}var s=t.return;try{Sh(t)}catch(c){Pt(t,s,c)}break;case 5:var a=t.return;try{Sh(t)}catch(c){Pt(t,a,c)}}}catch(c){Pt(t,t.return,c)}if(t===e){Me=null;break}var l=t.sibling;if(l!==null){l.return=t.return,Me=l;break}Me=t.return}}var hS=Math.ceil,Pc=Jn.ReactCurrentDispatcher,Ff=Jn.ReactCurrentOwner,Gr=Jn.ReactCurrentBatchConfig,st=0,Ht=null,At=null,Gt=0,Cr=0,ho=Ii(0),zt=0,Xa=null,hs=0,dd=0,Bf=0,Ea=null,pr=null,Hf=0,To=1/0,Hn=null,Rc=!1,Ch=null,Ni=null,Al=!1,Si=null,Oc=0,Ta=0,Eh=null,ac=-1,lc=0;function lr(){return st&6?Rt():ac!==-1?ac:ac=Rt()}function Pi(e){return e.mode&1?st&2&&Gt!==0?Gt&-Gt:X2.transition!==null?(lc===0&&(lc=$y()),lc):(e=ct,e!==0||(e=window.event,e=e===void 0?16:Hy(e.type)),e):1}function dn(e,t,r,n){if(50<Ta)throw Ta=0,Eh=null,Error(ke(185));nl(e,r,n),(!(st&2)||e!==Ht)&&(e===Ht&&(!(st&2)&&(dd|=r),zt===4&&yi(e,Gt)),yr(e,n),r===1&&st===0&&!(t.mode&1)&&(To=Rt()+500,od&&Di()))}function yr(e,t){var r=e.callbackNode;X_(e,t);var n=mc(e,e===Ht?Gt:0);if(n===0)r!==null&&vm(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&vm(r),t===1)e.tag===0?Y2(cg.bind(null,e)):ax(cg.bind(null,e)),W2(function(){!(st&6)&&Di()}),r=null;else{switch(Ly(n)){case 1:r=pf;break;case 4:r=Ay;break;case 16:r=pc;break;case 536870912:r=My;break;default:r=pc}r=sb(r,Jx.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function Jx(e,t){if(ac=-1,lc=0,st&6)throw Error(ke(327));var r=e.callbackNode;if(xo()&&e.callbackNode!==r)return null;var n=mc(e,e===Ht?Gt:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Ac(e,n);else{t=n;var i=st;st|=2;var s=eb();(Ht!==e||Gt!==t)&&(Hn=null,To=Rt()+500,os(e,t));do try{mS();break}catch(l){Qx(e,l)}while(!0);Ef(),Pc.current=s,st=i,At!==null?t=0:(Ht=null,Gt=0,t=zt)}if(t!==0){if(t===2&&(i=eh(e),i!==0&&(n=i,t=Th(e,i))),t===1)throw r=Xa,os(e,0),yi(e,n),yr(e,Rt()),r;if(t===6)yi(e,n);else{if(i=e.current.alternate,!(n&30)&&!fS(i)&&(t=Ac(e,n),t===2&&(s=eh(e),s!==0&&(n=s,t=Th(e,s))),t===1))throw r=Xa,os(e,0),yi(e,n),yr(e,Rt()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(ke(345));case 2:Xi(e,pr,Hn);break;case 3:if(yi(e,n),(n&130023424)===n&&(t=Hf+500-Rt(),10<t)){if(mc(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){lr(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=lh(Xi.bind(null,e,pr,Hn),t);break}Xi(e,pr,Hn);break;case 4:if(yi(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var a=31-cn(n);s=1<<a,a=t[a],a>i&&(i=a),n&=~s}if(n=i,n=Rt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*hS(n/1960))-n,10<n){e.timeoutHandle=lh(Xi.bind(null,e,pr,Hn),n);break}Xi(e,pr,Hn);break;case 5:Xi(e,pr,Hn);break;default:throw Error(ke(329))}}}return yr(e,Rt()),e.callbackNode===r?Jx.bind(null,e):null}function Th(e,t){var r=Ea;return e.current.memoizedState.isDehydrated&&(os(e,t).flags|=256),e=Ac(e,t),e!==2&&(t=pr,pr=r,t!==null&&Nh(t)),e}function Nh(e){pr===null?pr=e:pr.push.apply(pr,e)}function fS(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!un(s(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function yi(e,t){for(t&=~Bf,t&=~dd,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-cn(t),n=1<<r;e[r]=-1,t&=~n}}function cg(e){if(st&6)throw Error(ke(327));xo();var t=mc(e,0);if(!(t&1))return yr(e,Rt()),null;var r=Ac(e,t);if(e.tag!==0&&r===2){var n=eh(e);n!==0&&(t=n,r=Th(e,n))}if(r===1)throw r=Xa,os(e,0),yi(e,t),yr(e,Rt()),r;if(r===6)throw Error(ke(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Xi(e,pr,Hn),yr(e,Rt()),null}function Uf(e,t){var r=st;st|=1;try{return e(t)}finally{st=r,st===0&&(To=Rt()+500,od&&Di())}}function fs(e){Si!==null&&Si.tag===0&&!(st&6)&&xo();var t=st;st|=1;var r=Gr.transition,n=ct;try{if(Gr.transition=null,ct=1,e)return e()}finally{ct=n,Gr.transition=r,st=t,!(st&6)&&Di()}}function Wf(){Cr=ho.current,bt(ho)}function os(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,U2(r)),At!==null)for(r=At.return;r!==null;){var n=r;switch(kf(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&bc();break;case 3:Co(),bt(gr),bt(rr),Af();break;case 5:Of(n);break;case 4:Co();break;case 13:bt(Ct);break;case 19:bt(Ct);break;case 10:Tf(n.type._context);break;case 22:case 23:Wf()}r=r.return}if(Ht=e,At=e=Ri(e.current,null),Gt=Cr=t,zt=0,Xa=null,Bf=dd=hs=0,pr=Ea=null,ns!==null){for(t=0;t<ns.length;t++)if(r=ns[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var a=s.next;s.next=i,n.next=a}r.pending=n}ns=null}return e}function Qx(e,t){do{var r=At;try{if(Ef(),ic.current=Nc,Tc){for(var n=Et.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Tc=!1}if(us=0,Bt=It=Et=null,ja=!1,Va=0,Ff.current=null,r===null||r.return===null){zt=1,Xa=t,At=null;break}e:{var s=e,a=r.return,l=r,c=t;if(t=Gt,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=l,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=Km(a);if(p!==null){p.flags&=-257,Zm(p,a,l,s,t),p.mode&1&&Xm(s,d,t),t=p,c=d;var g=t.updateQueue;if(g===null){var m=new Set;m.add(c),t.updateQueue=m}else g.add(c);break e}else{if(!(t&1)){Xm(s,d,t),Gf();break e}c=Error(ke(426))}}else if(kt&&l.mode&1){var x=Km(a);if(x!==null){!(x.flags&65536)&&(x.flags|=256),Zm(x,a,l,s,t),jf(Eo(c,l));break e}}s=c=Eo(c,l),zt!==4&&(zt=2),Ea===null?Ea=[s]:Ea.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var v=Lx(s,c,t);Um(s,v);break e;case 1:l=c;var y=s.type,b=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Ni===null||!Ni.has(b)))){s.flags|=65536,t&=-t,s.lanes|=t;var w=Ix(s,l,t);Um(s,w);break e}}s=s.return}while(s!==null)}rb(r)}catch(j){t=j,At===r&&r!==null&&(At=r=r.return);continue}break}while(!0)}function eb(){var e=Pc.current;return Pc.current=Nc,e===null?Nc:e}function Gf(){(zt===0||zt===3||zt===2)&&(zt=4),Ht===null||!(hs&268435455)&&!(dd&268435455)||yi(Ht,Gt)}function Ac(e,t){var r=st;st|=2;var n=eb();(Ht!==e||Gt!==t)&&(Hn=null,os(e,t));do try{pS();break}catch(i){Qx(e,i)}while(!0);if(Ef(),st=r,Pc.current=n,At!==null)throw Error(ke(261));return Ht=null,Gt=0,zt}function pS(){for(;At!==null;)tb(At)}function mS(){for(;At!==null&&!F_();)tb(At)}function tb(e){var t=ib(e.alternate,e,Cr);e.memoizedProps=e.pendingProps,t===null?rb(e):At=t,Ff.current=null}function rb(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=lS(r,t),r!==null){r.flags&=32767,At=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{zt=6,At=null;return}}else if(r=aS(r,t,Cr),r!==null){At=r;return}if(t=t.sibling,t!==null){At=t;return}At=t=e}while(t!==null);zt===0&&(zt=5)}function Xi(e,t,r){var n=ct,i=Gr.transition;try{Gr.transition=null,ct=1,gS(e,t,r,n)}finally{Gr.transition=i,ct=n}return null}function gS(e,t,r,n){do xo();while(Si!==null);if(st&6)throw Error(ke(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(ke(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(K_(e,s),e===Ht&&(At=Ht=null,Gt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Al||(Al=!0,sb(pc,function(){return xo(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Gr.transition,Gr.transition=null;var a=ct;ct=1;var l=st;st|=4,Ff.current=null,dS(e,r),Kx(r,e),L2(oh),gc=!!sh,oh=sh=null,e.current=r,uS(r),B_(),st=l,ct=a,Gr.transition=s}else e.current=r;if(Al&&(Al=!1,Si=e,Oc=i),s=e.pendingLanes,s===0&&(Ni=null),W_(r.stateNode),yr(e,Rt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Rc)throw Rc=!1,e=Ch,Ch=null,e;return Oc&1&&e.tag!==0&&xo(),s=e.pendingLanes,s&1?e===Eh?Ta++:(Ta=0,Eh=e):Ta=0,Di(),null}function xo(){if(Si!==null){var e=Ly(Oc),t=Gr.transition,r=ct;try{if(Gr.transition=null,ct=16>e?16:e,Si===null)var n=!1;else{if(e=Si,Si=null,Oc=0,st&6)throw Error(ke(331));var i=st;for(st|=4,Me=e.current;Me!==null;){var s=Me,a=s.child;if(Me.flags&16){var l=s.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(Me=d;Me!==null;){var u=Me;switch(u.tag){case 0:case 11:case 15:Ca(8,u,s)}var f=u.child;if(f!==null)f.return=u,Me=f;else for(;Me!==null;){u=Me;var h=u.sibling,p=u.return;if(qx(u),u===d){Me=null;break}if(h!==null){h.return=p,Me=h;break}Me=p}}}var g=s.alternate;if(g!==null){var m=g.child;if(m!==null){g.child=null;do{var x=m.sibling;m.sibling=null,m=x}while(m!==null)}}Me=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,Me=a;else e:for(;Me!==null;){if(s=Me,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Ca(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,Me=v;break e}Me=s.return}}var y=e.current;for(Me=y;Me!==null;){a=Me;var b=a.child;if(a.subtreeFlags&2064&&b!==null)b.return=a,Me=b;else e:for(a=y;Me!==null;){if(l=Me,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:cd(9,l)}}catch(j){Pt(l,l.return,j)}if(l===a){Me=null;break e}var w=l.sibling;if(w!==null){w.return=l.return,Me=w;break e}Me=l.return}}if(st=i,Di(),Pn&&typeof Pn.onPostCommitFiberRoot=="function")try{Pn.onPostCommitFiberRoot(td,e)}catch{}n=!0}return n}finally{ct=r,Gr.transition=t}}return!1}function dg(e,t,r){t=Eo(r,t),t=Lx(e,t,1),e=Ti(e,t,1),t=lr(),e!==null&&(nl(e,1,t),yr(e,t))}function Pt(e,t,r){if(e.tag===3)dg(e,e,r);else for(;t!==null;){if(t.tag===3){dg(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Ni===null||!Ni.has(n))){e=Eo(r,e),e=Ix(t,e,1),t=Ti(t,e,1),e=lr(),t!==null&&(nl(t,1,e),yr(t,e));break}}t=t.return}}function vS(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=lr(),e.pingedLanes|=e.suspendedLanes&r,Ht===e&&(Gt&r)===r&&(zt===4||zt===3&&(Gt&130023424)===Gt&&500>Rt()-Hf?os(e,0):Bf|=r),yr(e,t)}function nb(e,t){t===0&&(e.mode&1?(t=Sl,Sl<<=1,!(Sl&130023424)&&(Sl=4194304)):t=1);var r=lr();e=Kn(e,t),e!==null&&(nl(e,t,r),yr(e,r))}function yS(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),nb(e,r)}function xS(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(ke(314))}n!==null&&n.delete(t),nb(e,r)}var ib;ib=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||gr.current)mr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return mr=!1,oS(e,t,r);mr=!!(e.flags&131072)}else mr=!1,kt&&t.flags&1048576&&lx(t,Sc,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;oc(e,t),e=t.pendingProps;var i=So(t,rr.current);yo(t,r),i=$f(null,t,n,e,i,r);var s=Lf();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,vr(n)?(s=!0,wc(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Pf(t),i.updater=ld,t.stateNode=i,i._reactInternals=t,mh(t,n,e,r),t=yh(null,t,n,!0,s,r)):(t.tag=0,kt&&s&&Sf(t),or(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(oc(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=wS(n),e=rn(n,e),i){case 0:t=vh(null,t,n,e,r);break e;case 1:t=eg(null,t,n,e,r);break e;case 11:t=Jm(null,t,n,e,r);break e;case 14:t=Qm(null,t,n,rn(n.type,e),r);break e}throw Error(ke(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:rn(n,i),vh(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:rn(n,i),eg(e,t,n,i,r);case 3:e:{if(Bx(t),e===null)throw Error(ke(387));n=t.pendingProps,s=t.memoizedState,i=s.element,px(e,t),Cc(t,n,null,r);var a=t.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=Eo(Error(ke(423)),t),t=tg(e,t,n,r,i);break e}else if(n!==i){i=Eo(Error(ke(424)),t),t=tg(e,t,n,r,i);break e}else for(Nr=Ei(t.stateNode.containerInfo.firstChild),Or=t,kt=!0,an=null,r=hx(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(ko(),n===i){t=Zn(e,t,r);break e}or(e,t,n,r)}t=t.child}return t;case 5:return mx(t),e===null&&hh(t),n=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,a=i.children,ah(n,i)?a=null:s!==null&&ah(n,s)&&(t.flags|=32),Fx(e,t),or(e,t,a,r),t.child;case 6:return e===null&&hh(t),null;case 13:return Hx(e,t,r);case 4:return Rf(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=jo(t,null,n,r):or(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:rn(n,i),Jm(e,t,n,i,r);case 7:return or(e,t,t.pendingProps,r),t.child;case 8:return or(e,t,t.pendingProps.children,r),t.child;case 12:return or(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,s=t.memoizedProps,a=i.value,ft(kc,n._currentValue),n._currentValue=a,s!==null)if(un(s.value,a)){if(s.children===i.children&&!gr.current){t=Zn(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var l=s.dependencies;if(l!==null){a=s.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(s.tag===1){c=qn(-1,r&-r),c.tag=2;var d=s.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}s.lanes|=r,c=s.alternate,c!==null&&(c.lanes|=r),fh(s.return,r,t),l.lanes|=r;break}c=c.next}}else if(s.tag===10)a=s.type===t.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(ke(341));a.lanes|=r,l=a.alternate,l!==null&&(l.lanes|=r),fh(a,r,t),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===t){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}or(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,yo(t,r),i=Vr(i),n=n(i),t.flags|=1,or(e,t,n,r),t.child;case 14:return n=t.type,i=rn(n,t.pendingProps),i=rn(n.type,i),Qm(e,t,n,i,r);case 15:return Dx(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:rn(n,i),oc(e,t),t.tag=1,vr(n)?(e=!0,wc(t)):e=!1,yo(t,r),$x(t,n,i),mh(t,n,i,r),yh(null,t,n,!0,e,r);case 19:return Ux(e,t,r);case 22:return zx(e,t,r)}throw Error(ke(156,t.tag))};function sb(e,t){return Oy(e,t)}function bS(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Wr(e,t,r,n){return new bS(e,t,r,n)}function Vf(e){return e=e.prototype,!(!e||!e.isReactComponent)}function wS(e){if(typeof e=="function")return Vf(e)?1:0;if(e!=null){if(e=e.$$typeof,e===uf)return 11;if(e===hf)return 14}return 2}function Ri(e,t){var r=e.alternate;return r===null?(r=Wr(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function cc(e,t,r,n,i,s){var a=2;if(n=e,typeof e=="function")Vf(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case to:return as(r.children,i,s,t);case df:a=8,i|=8;break;case zu:return e=Wr(12,r,t,i|2),e.elementType=zu,e.lanes=s,e;case Fu:return e=Wr(13,r,t,i),e.elementType=Fu,e.lanes=s,e;case Bu:return e=Wr(19,r,t,i),e.elementType=Bu,e.lanes=s,e;case my:return ud(r,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case fy:a=10;break e;case py:a=9;break e;case uf:a=11;break e;case hf:a=14;break e;case pi:a=16,n=null;break e}throw Error(ke(130,e==null?e:typeof e,""))}return t=Wr(a,r,t,i),t.elementType=e,t.type=n,t.lanes=s,t}function as(e,t,r,n){return e=Wr(7,e,n,t),e.lanes=r,e}function ud(e,t,r,n){return e=Wr(22,e,n,t),e.elementType=my,e.lanes=r,e.stateNode={isHidden:!1},e}function su(e,t,r){return e=Wr(6,e,null,t),e.lanes=r,e}function ou(e,t,r){return t=Wr(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function _S(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Fd(0),this.expirationTimes=Fd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Fd(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function qf(e,t,r,n,i,s,a,l,c){return e=new _S(e,t,r,l,c),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Wr(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Pf(s),e}function SS(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:eo,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function ob(e){if(!e)return Ai;e=e._reactInternals;e:{if(gs(e)!==e||e.tag!==1)throw Error(ke(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(vr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ke(171))}if(e.tag===1){var r=e.type;if(vr(r))return ox(e,r,t)}return t}function ab(e,t,r,n,i,s,a,l,c){return e=qf(r,n,!0,e,i,s,a,l,c),e.context=ob(null),r=e.current,n=lr(),i=Pi(r),s=qn(n,i),s.callback=t??null,Ti(r,s,i),e.current.lanes=i,nl(e,i,n),yr(e,n),e}function hd(e,t,r,n){var i=t.current,s=lr(),a=Pi(i);return r=ob(r),t.context===null?t.context=r:t.pendingContext=r,t=qn(s,a),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Ti(i,t,a),e!==null&&(dn(e,i,a,s),nc(e,i,a)),a}function Mc(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function ug(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Yf(e,t){ug(e,t),(e=e.alternate)&&ug(e,t)}function kS(){return null}var lb=typeof reportError=="function"?reportError:function(e){console.error(e)};function Xf(e){this._internalRoot=e}fd.prototype.render=Xf.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ke(409));hd(e,t,null,null)};fd.prototype.unmount=Xf.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;fs(function(){hd(null,e,null,null)}),t[Xn]=null}};function fd(e){this._internalRoot=e}fd.prototype.unstable_scheduleHydration=function(e){if(e){var t=zy();e={blockedOn:null,target:e,priority:t};for(var r=0;r<vi.length&&t!==0&&t<vi[r].priority;r++);vi.splice(r,0,e),r===0&&By(e)}};function Kf(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function pd(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function hg(){}function jS(e,t,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var d=Mc(a);s.call(d)}}var a=ab(t,n,e,0,null,!1,!1,"",hg);return e._reactRootContainer=a,e[Xn]=a.current,Ba(e.nodeType===8?e.parentNode:e),fs(),a}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var l=n;n=function(){var d=Mc(c);l.call(d)}}var c=qf(e,0,!1,null,null,!1,!1,"",hg);return e._reactRootContainer=c,e[Xn]=c.current,Ba(e.nodeType===8?e.parentNode:e),fs(function(){hd(t,c,r,n)}),c}function md(e,t,r,n,i){var s=r._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var l=i;i=function(){var c=Mc(a);l.call(c)}}hd(t,a,e,i)}else a=jS(r,t,e,i,n);return Mc(a)}Iy=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=pa(t.pendingLanes);r!==0&&(mf(t,r|1),yr(t,Rt()),!(st&6)&&(To=Rt()+500,Di()))}break;case 13:fs(function(){var n=Kn(e,1);if(n!==null){var i=lr();dn(n,e,1,i)}}),Yf(e,1)}};gf=function(e){if(e.tag===13){var t=Kn(e,134217728);if(t!==null){var r=lr();dn(t,e,134217728,r)}Yf(e,134217728)}};Dy=function(e){if(e.tag===13){var t=Pi(e),r=Kn(e,t);if(r!==null){var n=lr();dn(r,e,t,n)}Yf(e,t)}};zy=function(){return ct};Fy=function(e,t){var r=ct;try{return ct=e,t()}finally{ct=r}};Zu=function(e,t,r){switch(t){case"input":if(Wu(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=sd(n);if(!i)throw Error(ke(90));vy(n),Wu(n,i)}}}break;case"textarea":xy(e,r);break;case"select":t=r.value,t!=null&&po(e,!!r.multiple,t,!1)}};Cy=Uf;Ey=fs;var CS={usingClientEntryPoint:!1,Events:[sl,so,sd,ky,jy,Uf]},sa={findFiberByHostInstance:rs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ES={bundleType:sa.bundleType,version:sa.version,rendererPackageName:sa.rendererPackageName,rendererConfig:sa.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Jn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Py(e),e===null?null:e.stateNode},findFiberByHostInstance:sa.findFiberByHostInstance||kS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ml=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ml.isDisabled&&Ml.supportsFiber)try{td=Ml.inject(ES),Pn=Ml}catch{}}$r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=CS;$r.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Kf(t))throw Error(ke(200));return SS(e,t,null,r)};$r.createRoot=function(e,t){if(!Kf(e))throw Error(ke(299));var r=!1,n="",i=lb;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=qf(e,1,!1,null,null,r,!1,n,i),e[Xn]=t.current,Ba(e.nodeType===8?e.parentNode:e),new Xf(t)};$r.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ke(188)):(e=Object.keys(e).join(","),Error(ke(268,e)));return e=Py(t),e=e===null?null:e.stateNode,e};$r.flushSync=function(e){return fs(e)};$r.hydrate=function(e,t,r){if(!pd(t))throw Error(ke(200));return md(null,e,t,!0,r)};$r.hydrateRoot=function(e,t,r){if(!Kf(e))throw Error(ke(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",a=lb;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),t=ab(t,null,e,1,r??null,i,!1,s,a),e[Xn]=t.current,Ba(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new fd(t)};$r.render=function(e,t,r){if(!pd(t))throw Error(ke(200));return md(null,e,t,!1,r)};$r.unmountComponentAtNode=function(e){if(!pd(e))throw Error(ke(40));return e._reactRootContainer?(fs(function(){md(null,null,e,!1,function(){e._reactRootContainer=null,e[Xn]=null})}),!0):!1};$r.unstable_batchedUpdates=Uf;$r.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!pd(r))throw Error(ke(200));if(e==null||e._reactInternals===void 0)throw Error(ke(38));return md(e,t,r,!1,n)};$r.version="18.3.1-next-f1338f8080-20240426";function cb(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(cb)}catch(e){console.error(e)}}cb(),cy.exports=$r;var TS=cy.exports,fg=TS;Iu.createRoot=fg.createRoot,Iu.hydrateRoot=fg.hydrateRoot;var Ph=function(e,t){return Ph=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},Ph(e,t)};function db(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Ph(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var $c=function(){return $c=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},$c.apply(this,arguments)};function Ao(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function ub(e,t,r,n){var i=arguments.length,s=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(s=(i<3?a(s):i>3?a(t,r,s):a(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}function hb(e,t){return function(r,n){t(r,n,e)}}function fb(e,t,r,n,i,s){function a(v){if(v!==void 0&&typeof v!="function")throw new TypeError("Function expected");return v}for(var l=n.kind,c=l==="getter"?"get":l==="setter"?"set":"value",d=!t&&e?n.static?e:e.prototype:null,u=t||(d?Object.getOwnPropertyDescriptor(d,n.name):{}),f,h=!1,p=r.length-1;p>=0;p--){var g={};for(var m in n)g[m]=m==="access"?{}:n[m];for(var m in n.access)g.access[m]=n.access[m];g.addInitializer=function(v){if(h)throw new TypeError("Cannot add initializers after decoration has completed");s.push(a(v||null))};var x=(0,r[p])(l==="accessor"?{get:u.get,set:u.set}:u[c],g);if(l==="accessor"){if(x===void 0)continue;if(x===null||typeof x!="object")throw new TypeError("Object expected");(f=a(x.get))&&(u.get=f),(f=a(x.set))&&(u.set=f),(f=a(x.init))&&i.unshift(f)}else(f=a(x))&&(l==="field"?i.unshift(f):u[c]=f)}d&&Object.defineProperty(d,n.name,u),h=!0}function pb(e,t,r){for(var n=arguments.length>2,i=0;i<t.length;i++)r=n?t[i].call(e,r):t[i].call(e);return n?r:void 0}function mb(e){return typeof e=="symbol"?e:"".concat(e)}function gb(e,t,r){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function vb(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function Le(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function l(u){try{d(n.next(u))}catch(f){a(f)}}function c(u){try{d(n.throw(u))}catch(f){a(f)}}function d(u){u.done?s(u.value):i(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})}function yb(e,t){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return a.next=l(0),a.throw=l(1),a.return=l(2),typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function l(d){return function(u){return c([d,u])}}function c(d){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,d[0]&&(r=0)),r;)try{if(n=1,i&&(s=d[0]&2?i.return:d[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,d[1])).done)return s;switch(i=0,s&&(d=[d[0]&2,s.value]),d[0]){case 0:case 1:s=d;break;case 4:return r.label++,{value:d[1],done:!1};case 5:r.label++,i=d[1],d=[0];continue;case 7:d=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(d[0]===6||d[0]===2)){r=0;continue}if(d[0]===3&&(!s||d[1]>s[0]&&d[1]<s[3])){r.label=d[1];break}if(d[0]===6&&r.label<s[1]){r.label=s[1],s=d;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(d);break}s[2]&&r.ops.pop(),r.trys.pop();continue}d=t.call(e,r)}catch(u){d=[6,u],i=0}finally{n=s=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}var gd=Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]};function xb(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&gd(t,e,r)}function Lc(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Zf(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,s=[],a;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(l){a={error:l}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s}function bb(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Zf(arguments[t]));return e}function wb(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var s=arguments[t],a=0,l=s.length;a<l;a++,i++)n[i]=s[a];return n}function _b(e,t,r){if(r||arguments.length===2)for(var n=0,i=t.length,s;n<i;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))}function No(e){return this instanceof No?(this.v=e,this):new No(e)}function Sb(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",a),i[Symbol.asyncIterator]=function(){return this},i;function a(p){return function(g){return Promise.resolve(g).then(p,f)}}function l(p,g){n[p]&&(i[p]=function(m){return new Promise(function(x,v){s.push([p,m,x,v])>1||c(p,m)})},g&&(i[p]=g(i[p])))}function c(p,g){try{d(n[p](g))}catch(m){h(s[0][3],m)}}function d(p){p.value instanceof No?Promise.resolve(p.value.v).then(u,f):h(s[0][2],p)}function u(p){c("next",p)}function f(p){c("throw",p)}function h(p,g){p(g),s.shift(),s.length&&c(s[0][0],s[0][1])}}function kb(e){var t,r;return t={},n("next"),n("throw",function(i){throw i}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(i,s){t[i]=e[i]?function(a){return(r=!r)?{value:No(e[i](a)),done:!1}:s?s(a):a}:s}}function jb(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof Lc=="function"?Lc(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=e[s]&&function(a){return new Promise(function(l,c){a=e[s](a),i(l,c,a.done,a.value)})}}function i(s,a,l,c){Promise.resolve(c).then(function(d){s({value:d,done:l})},a)}}function Cb(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var NS=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},Rh=function(e){return Rh=Object.getOwnPropertyNames||function(t){var r=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[r.length]=n);return r},Rh(e)};function Eb(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r=Rh(e),n=0;n<r.length;n++)r[n]!=="default"&&gd(t,e,r[n]);return NS(t,e),t}function Tb(e){return e&&e.__esModule?e:{default:e}}function Nb(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)}function Pb(e,t,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(e,r):i?i.value=r:t.set(e,r),r}function Rb(e,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof e=="function"?t===e:e.has(t)}function Ob(e,t,r){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var n,i;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose],r&&(i=n)}if(typeof n!="function")throw new TypeError("Object not disposable.");i&&(n=function(){try{i.call(this)}catch(s){return Promise.reject(s)}}),e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t}var PS=typeof SuppressedError=="function"?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};function Ab(e){function t(s){e.error=e.hasError?new PS(s,e.error,"An error was suppressed during disposal."):s,e.hasError=!0}var r,n=0;function i(){for(;r=e.stack.pop();)try{if(!r.async&&n===1)return n=0,e.stack.push(r),Promise.resolve().then(i);if(r.dispose){var s=r.dispose.call(r.value);if(r.async)return n|=2,Promise.resolve(s).then(i,function(a){return t(a),i()})}else n|=1}catch(a){t(a)}if(n===1)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}return i()}function Mb(e,t){return typeof e=="string"&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(r,n,i,s,a){return n?t?".jsx":".js":i&&(!s||!a)?r:i+s+"."+a.toLowerCase()+"js"}):e}const RS={__extends:db,__assign:$c,__rest:Ao,__decorate:ub,__param:hb,__esDecorate:fb,__runInitializers:pb,__propKey:mb,__setFunctionName:gb,__metadata:vb,__awaiter:Le,__generator:yb,__createBinding:gd,__exportStar:xb,__values:Lc,__read:Zf,__spread:bb,__spreadArrays:wb,__spreadArray:_b,__await:No,__asyncGenerator:Sb,__asyncDelegator:kb,__asyncValues:jb,__makeTemplateObject:Cb,__importStar:Eb,__importDefault:Tb,__classPrivateFieldGet:Nb,__classPrivateFieldSet:Pb,__classPrivateFieldIn:Rb,__addDisposableResource:Ob,__disposeResources:Ab,__rewriteRelativeImportExtension:Mb},OS=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:Ob,get __assign(){return $c},__asyncDelegator:kb,__asyncGenerator:Sb,__asyncValues:jb,__await:No,__awaiter:Le,__classPrivateFieldGet:Nb,__classPrivateFieldIn:Rb,__classPrivateFieldSet:Pb,__createBinding:gd,__decorate:ub,__disposeResources:Ab,__esDecorate:fb,__exportStar:xb,__extends:db,__generator:yb,__importDefault:Tb,__importStar:Eb,__makeTemplateObject:Cb,__metadata:vb,__param:hb,__propKey:mb,__read:Zf,__rest:Ao,__rewriteRelativeImportExtension:Mb,__runInitializers:pb,__setFunctionName:gb,__spread:bb,__spreadArray:_b,__spreadArrays:wb,__values:Lc,default:RS},Symbol.toStringTag,{value:"Module"})),AS=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class Jf extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class pg extends Jf{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class mg extends Jf{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class gg extends Jf{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Oh;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Oh||(Oh={}));class MS{constructor(t,{headers:r={},customFetch:n,region:i=Oh.Any}={}){this.url=t,this.headers=r,this.region=i,this.fetch=AS(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return Le(this,arguments,void 0,function*(r,n={}){var i;try{const{headers:s,method:a,body:l,signal:c}=n;let d={},{region:u}=n;u||(u=this.region);const f=new URL(`${this.url}/${r}`);u&&u!=="any"&&(d["x-region"]=u,f.searchParams.set("forceFunctionRegion",u));let h;l&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)?typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(d["Content-Type"]="application/octet-stream",h=l):typeof l=="string"?(d["Content-Type"]="text/plain",h=l):typeof FormData<"u"&&l instanceof FormData?h=l:(d["Content-Type"]="application/json",h=JSON.stringify(l)):h=l;const p=yield this.fetch(f.toString(),{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},d),this.headers),s),body:h,signal:c}).catch(v=>{throw v.name==="AbortError"?v:new pg(v)}),g=p.headers.get("x-relay-error");if(g&&g==="true")throw new mg(p);if(!p.ok)throw new gg(p);let m=((i=p.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),x;return m==="application/json"?x=yield p.json():m==="application/octet-stream"||m==="application/pdf"?x=yield p.blob():m==="text/event-stream"?x=p:m==="multipart/form-data"?x=yield p.formData():x=yield p.text(),{data:x,error:null,response:p}}catch(s){return s instanceof Error&&s.name==="AbortError"?{data:null,error:new pg(s)}:{data:null,error:s,response:s instanceof gg||s instanceof mg?s.context:void 0}}})}}var ar={};const Mo=r_(OS);var $l={},Ll={},Il={},Dl={},zl={},Fl={},vg;function $b(){if(vg)return Fl;vg=1,Object.defineProperty(Fl,"__esModule",{value:!0});class e extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return Fl.default=e,Fl}var yg;function Lb(){if(yg)return zl;yg=1,Object.defineProperty(zl,"__esModule",{value:!0});const t=Mo.__importDefault($b());class r{constructor(i){var s,a;this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=new Headers(i.headers),this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=(s=i.shouldThrowOnError)!==null&&s!==void 0?s:!1,this.signal=i.signal,this.isMaybeSingle=(a=i.isMaybeSingle)!==null&&a!==void 0?a:!1,i.fetch?this.fetch=i.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,s){return this.headers=new Headers(this.headers),this.headers.set(i,s),this}then(i,s){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const a=this.fetch;let l=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var d,u,f,h;let p=null,g=null,m=null,x=c.status,v=c.statusText;if(c.ok){if(this.method!=="HEAD"){const j=await c.text();j===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((d=this.headers.get("Accept"))===null||d===void 0)&&d.includes("application/vnd.pgrst.plan+text"))?g=j:g=JSON.parse(j))}const b=(u=this.headers.get("Prefer"))===null||u===void 0?void 0:u.match(/count=(exact|planned|estimated)/),w=(f=c.headers.get("content-range"))===null||f===void 0?void 0:f.split("/");b&&w&&w.length>1&&(m=parseInt(w[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(g)&&(g.length>1?(p={code:"PGRST116",details:`Results contain ${g.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},g=null,m=null,x=406,v="Not Acceptable"):g.length===1?g=g[0]:g=null)}else{const b=await c.text();try{p=JSON.parse(b),Array.isArray(p)&&c.status===404&&(g=[],p=null,x=200,v="OK")}catch{c.status===404&&b===""?(x=204,v="No Content"):p={message:b}}if(p&&this.isMaybeSingle&&(!((h=p==null?void 0:p.details)===null||h===void 0)&&h.includes("0 rows"))&&(p=null,x=200,v="OK"),p&&this.shouldThrowOnError)throw new t.default(p)}return{error:p,data:g,count:m,status:x,statusText:v}});return this.shouldThrowOnError||(l=l.catch(c=>{var d,u,f;return{error:{message:`${(d=c==null?void 0:c.name)!==null&&d!==void 0?d:"FetchError"}: ${c==null?void 0:c.message}`,details:`${(u=c==null?void 0:c.stack)!==null&&u!==void 0?u:""}`,hint:"",code:`${(f=c==null?void 0:c.code)!==null&&f!==void 0?f:""}`},data:null,count:null,status:0,statusText:""}})),l.then(i,s)}returns(){return this}overrideTypes(){return this}}return zl.default=r,zl}var xg;function Ib(){if(xg)return Dl;xg=1,Object.defineProperty(Dl,"__esModule",{value:!0});const t=Mo.__importDefault(Lb());class r extends t.default{select(i){let s=!1;const a=(i??"*").split("").map(l=>/\s/.test(l)&&!s?"":(l==='"'&&(s=!s),l)).join("");return this.url.searchParams.set("select",a),this.headers.append("Prefer","return=representation"),this}order(i,{ascending:s=!0,nullsFirst:a,foreignTable:l,referencedTable:c=l}={}){const d=c?`${c}.order`:"order",u=this.url.searchParams.get(d);return this.url.searchParams.set(d,`${u?`${u},`:""}${i}.${s?"asc":"desc"}${a===void 0?"":a?".nullsfirst":".nullslast"}`),this}limit(i,{foreignTable:s,referencedTable:a=s}={}){const l=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(l,`${i}`),this}range(i,s,{foreignTable:a,referencedTable:l=a}={}){const c=typeof l>"u"?"offset":`${l}.offset`,d=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${i}`),this.url.searchParams.set(d,`${s-i+1}`),this}abortSignal(i){return this.signal=i,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:i=!1,verbose:s=!1,settings:a=!1,buffers:l=!1,wal:c=!1,format:d="text"}={}){var u;const f=[i?"analyze":null,s?"verbose":null,a?"settings":null,l?"buffers":null,c?"wal":null].filter(Boolean).join("|"),h=(u=this.headers.get("Accept"))!==null&&u!==void 0?u:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${d}; for="${h}"; options=${f};`),d==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(i){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${i}`),this}}return Dl.default=r,Dl}var bg;function Qf(){if(bg)return Il;bg=1,Object.defineProperty(Il,"__esModule",{value:!0});const t=Mo.__importDefault(Ib()),r=new RegExp("[,()]");class n extends t.default{eq(s,a){return this.url.searchParams.append(s,`eq.${a}`),this}neq(s,a){return this.url.searchParams.append(s,`neq.${a}`),this}gt(s,a){return this.url.searchParams.append(s,`gt.${a}`),this}gte(s,a){return this.url.searchParams.append(s,`gte.${a}`),this}lt(s,a){return this.url.searchParams.append(s,`lt.${a}`),this}lte(s,a){return this.url.searchParams.append(s,`lte.${a}`),this}like(s,a){return this.url.searchParams.append(s,`like.${a}`),this}likeAllOf(s,a){return this.url.searchParams.append(s,`like(all).{${a.join(",")}}`),this}likeAnyOf(s,a){return this.url.searchParams.append(s,`like(any).{${a.join(",")}}`),this}ilike(s,a){return this.url.searchParams.append(s,`ilike.${a}`),this}ilikeAllOf(s,a){return this.url.searchParams.append(s,`ilike(all).{${a.join(",")}}`),this}ilikeAnyOf(s,a){return this.url.searchParams.append(s,`ilike(any).{${a.join(",")}}`),this}is(s,a){return this.url.searchParams.append(s,`is.${a}`),this}in(s,a){const l=Array.from(new Set(a)).map(c=>typeof c=="string"&&r.test(c)?`"${c}"`:`${c}`).join(",");return this.url.searchParams.append(s,`in.(${l})`),this}contains(s,a){return typeof a=="string"?this.url.searchParams.append(s,`cs.${a}`):Array.isArray(a)?this.url.searchParams.append(s,`cs.{${a.join(",")}}`):this.url.searchParams.append(s,`cs.${JSON.stringify(a)}`),this}containedBy(s,a){return typeof a=="string"?this.url.searchParams.append(s,`cd.${a}`):Array.isArray(a)?this.url.searchParams.append(s,`cd.{${a.join(",")}}`):this.url.searchParams.append(s,`cd.${JSON.stringify(a)}`),this}rangeGt(s,a){return this.url.searchParams.append(s,`sr.${a}`),this}rangeGte(s,a){return this.url.searchParams.append(s,`nxl.${a}`),this}rangeLt(s,a){return this.url.searchParams.append(s,`sl.${a}`),this}rangeLte(s,a){return this.url.searchParams.append(s,`nxr.${a}`),this}rangeAdjacent(s,a){return this.url.searchParams.append(s,`adj.${a}`),this}overlaps(s,a){return typeof a=="string"?this.url.searchParams.append(s,`ov.${a}`):this.url.searchParams.append(s,`ov.{${a.join(",")}}`),this}textSearch(s,a,{config:l,type:c}={}){let d="";c==="plain"?d="pl":c==="phrase"?d="ph":c==="websearch"&&(d="w");const u=l===void 0?"":`(${l})`;return this.url.searchParams.append(s,`${d}fts${u}.${a}`),this}match(s){return Object.entries(s).forEach(([a,l])=>{this.url.searchParams.append(a,`eq.${l}`)}),this}not(s,a,l){return this.url.searchParams.append(s,`not.${a}.${l}`),this}or(s,{foreignTable:a,referencedTable:l=a}={}){const c=l?`${l}.or`:"or";return this.url.searchParams.append(c,`(${s})`),this}filter(s,a,l){return this.url.searchParams.append(s,`${a}.${l}`),this}}return Il.default=n,Il}var wg;function Db(){if(wg)return Ll;wg=1,Object.defineProperty(Ll,"__esModule",{value:!0});const t=Mo.__importDefault(Qf());class r{constructor(i,{headers:s={},schema:a,fetch:l}){this.url=i,this.headers=new Headers(s),this.schema=a,this.fetch=l}select(i,s){const{head:a=!1,count:l}=s??{},c=a?"HEAD":"GET";let d=!1;const u=(i??"*").split("").map(f=>/\s/.test(f)&&!d?"":(f==='"'&&(d=!d),f)).join("");return this.url.searchParams.set("select",u),l&&this.headers.append("Prefer",`count=${l}`),new t.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(i,{count:s,defaultToNull:a=!0}={}){var l;const c="POST";if(s&&this.headers.append("Prefer",`count=${s}`),a||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const d=i.reduce((u,f)=>u.concat(Object.keys(f)),[]);if(d.length>0){const u=[...new Set(d)].map(f=>`"${f}"`);this.url.searchParams.set("columns",u.join(","))}}return new t.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}upsert(i,{onConflict:s,ignoreDuplicates:a=!1,count:l,defaultToNull:c=!0}={}){var d;const u="POST";if(this.headers.append("Prefer",`resolution=${a?"ignore":"merge"}-duplicates`),s!==void 0&&this.url.searchParams.set("on_conflict",s),l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const f=i.reduce((h,p)=>h.concat(Object.keys(p)),[]);if(f.length>0){const h=[...new Set(f)].map(p=>`"${p}"`);this.url.searchParams.set("columns",h.join(","))}}return new t.default({method:u,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}update(i,{count:s}={}){var a;const l="PATCH";return s&&this.headers.append("Prefer",`count=${s}`),new t.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}delete({count:i}={}){var s;const a="DELETE";return i&&this.headers.append("Prefer",`count=${i}`),new t.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}}return Ll.default=r,Ll}var _g;function $S(){if(_g)return $l;_g=1,Object.defineProperty($l,"__esModule",{value:!0});const e=Mo,t=e.__importDefault(Db()),r=e.__importDefault(Qf());class n{constructor(s,{headers:a={},schema:l,fetch:c}={}){this.url=s,this.headers=new Headers(a),this.schemaName=l,this.fetch=c}from(s){const a=new URL(`${this.url}/${s}`);return new t.default(a,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(s){return new n(this.url,{headers:this.headers,schema:s,fetch:this.fetch})}rpc(s,a={},{head:l=!1,get:c=!1,count:d}={}){var u;let f;const h=new URL(`${this.url}/rpc/${s}`);let p;l||c?(f=l?"HEAD":"GET",Object.entries(a).filter(([m,x])=>x!==void 0).map(([m,x])=>[m,Array.isArray(x)?`{${x.join(",")}}`:`${x}`]).forEach(([m,x])=>{h.searchParams.append(m,x)})):(f="POST",p=a);const g=new Headers(this.headers);return d&&g.set("Prefer",`count=${d}`),new r.default({method:f,url:h,headers:g,schema:this.schemaName,body:p,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}}return $l.default=n,$l}Object.defineProperty(ar,"__esModule",{value:!0});var zb=ar.PostgrestError=Xb=ar.PostgrestBuilder=qb=ar.PostgrestTransformBuilder=Gb=ar.PostgrestFilterBuilder=Ub=ar.PostgrestQueryBuilder=Bb=ar.PostgrestClient=void 0;const $o=Mo,Fb=$o.__importDefault($S());var Bb=ar.PostgrestClient=Fb.default;const Hb=$o.__importDefault(Db());var Ub=ar.PostgrestQueryBuilder=Hb.default;const Wb=$o.__importDefault(Qf());var Gb=ar.PostgrestFilterBuilder=Wb.default;const Vb=$o.__importDefault(Ib());var qb=ar.PostgrestTransformBuilder=Vb.default;const Yb=$o.__importDefault(Lb());var Xb=ar.PostgrestBuilder=Yb.default;const Kb=$o.__importDefault($b());zb=ar.PostgrestError=Kb.default;var Zb=ar.default={PostgrestClient:Fb.default,PostgrestQueryBuilder:Hb.default,PostgrestFilterBuilder:Wb.default,PostgrestTransformBuilder:Vb.default,PostgrestBuilder:Yb.default,PostgrestError:Kb.default};const LS=t_({__proto__:null,get PostgrestBuilder(){return Xb},get PostgrestClient(){return Bb},get PostgrestError(){return zb},get PostgrestFilterBuilder(){return Gb},get PostgrestQueryBuilder(){return Ub},get PostgrestTransformBuilder(){return qb},default:Zb},[ar]),{PostgrestClient:IS,PostgrestQueryBuilder:u7,PostgrestFilterBuilder:h7,PostgrestTransformBuilder:f7,PostgrestBuilder:p7,PostgrestError:m7}=Zb||LS;class DS{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,i=parseInt(n.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const zS="2.79.0",FS=`realtime-js/${zS}`,BS="1.0.0",Ah=1e4,HS=1e3,US=100;var Na;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Na||(Na={}));var Lt;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Lt||(Lt={}));var on;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(on||(on={}));var Mh;(function(e){e.websocket="websocket"})(Mh||(Mh={}));var Ji;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Ji||(Ji={}));class WS{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const i=r.getUint8(1),s=r.getUint8(2);let a=this.HEADER_LENGTH+2;const l=n.decode(t.slice(a,a+i));a=a+i;const c=n.decode(t.slice(a,a+s));a=a+s;const d=JSON.parse(n.decode(t.slice(a,t.byteLength)));return{ref:null,topic:l,event:c,payload:d}}}class Jb{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var ut;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(ut||(ut={}));const Sg=(e,t,r={})=>{var n;const i=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((s,a)=>(s[a]=GS(a,e,t,i),s),{}):{}},GS=(e,t,r,n)=>{const i=t.find(l=>l.name===e),s=i==null?void 0:i.type,a=r[e];return s&&!n.includes(s)?Qb(s,a):$h(a)},Qb=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return XS(t,r)}switch(e){case ut.bool:return VS(t);case ut.float4:case ut.float8:case ut.int2:case ut.int4:case ut.int8:case ut.numeric:case ut.oid:return qS(t);case ut.json:case ut.jsonb:return YS(t);case ut.timestamp:return KS(t);case ut.abstime:case ut.date:case ut.daterange:case ut.int4range:case ut.int8range:case ut.money:case ut.reltime:case ut.text:case ut.time:case ut.timestamptz:case ut.timetz:case ut.tsrange:case ut.tstzrange:return $h(t);default:return $h(t)}},$h=e=>e,VS=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},qS=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},YS=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},XS=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let s;const a=e.slice(1,r);try{s=JSON.parse("["+a+"]")}catch{s=a?a.split(","):[]}return s.map(l=>Qb(t,l))}return e},KS=e=>typeof e=="string"?e.replace(" ","T"):e,ew=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class au{constructor(t,r,n={},i=Ah){this.channel=t,this.event=r,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var kg;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(kg||(kg={}));class Pa{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:s,onLeave:a,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Pa.syncState(this.state,i,s,a),this.pendingDiffs.forEach(c=>{this.state=Pa.syncDiff(this.state,c,s,a)}),this.pendingDiffs=[],l()}),this.channel._on(n.diff,{},i=>{const{onJoin:s,onLeave:a,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=Pa.syncDiff(this.state,i,s,a),l())}),this.onJoin((i,s,a)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:s,newPresences:a})}),this.onLeave((i,s,a)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:s,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,i){const s=this.cloneDeep(t),a=this.transformState(r),l={},c={};return this.map(s,(d,u)=>{a[d]||(c[d]=u)}),this.map(a,(d,u)=>{const f=s[d];if(f){const h=u.map(x=>x.presence_ref),p=f.map(x=>x.presence_ref),g=u.filter(x=>p.indexOf(x.presence_ref)<0),m=f.filter(x=>h.indexOf(x.presence_ref)<0);g.length>0&&(l[d]=g),m.length>0&&(c[d]=m)}else l[d]=u}),this.syncDiff(s,{joins:l,leaves:c},n,i)}static syncDiff(t,r,n,i){const{joins:s,leaves:a}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(s,(l,c)=>{var d;const u=(d=t[l])!==null&&d!==void 0?d:[];if(t[l]=this.cloneDeep(c),u.length>0){const f=t[l].map(p=>p.presence_ref),h=u.filter(p=>f.indexOf(p.presence_ref)<0);t[l].unshift(...h)}n(l,u,c)}),this.map(a,(l,c)=>{let d=t[l];if(!d)return;const u=c.map(f=>f.presence_ref);d=d.filter(f=>u.indexOf(f.presence_ref)<0),t[l]=d,i(l,d,c),d.length===0&&delete t[l]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const i=t[n];return"metas"in i?r[n]=i.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=i,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var jg;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(jg||(jg={}));var Ra;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Ra||(Ra={}));var Un;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Un||(Un={}));class ep{constructor(t,r={config:{}},n){var i,s;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Lt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new au(this,on.join,this.params,this.timeout),this.rejoinTimer=new Jb(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Lt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Lt.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Lt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Lt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Lt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(on.reply,{},(a,l)=>{this._trigger(this._replyEventName(l),a)}),this.presence=new Pa(this),this.broadcastEndpointURL=ew(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((s=(i=this.params.config)===null||i===void 0?void 0:i.broadcast)===null||s===void 0)&&s.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,i,s;if(this.socket.isConnected()||this.socket.connect(),this.state==Lt.closed){const{config:{broadcast:a,presence:l,private:c}}=this.params,d=(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(p=>p.filter))!==null&&i!==void 0?i:[],u=!!this.bindings[Ra.PRESENCE]&&this.bindings[Ra.PRESENCE].length>0||((s=this.params.config.presence)===null||s===void 0?void 0:s.enabled)===!0,f={},h={broadcast:a,presence:Object.assign(Object.assign({},l),{enabled:u}),postgres_changes:d,private:c};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(p=>t==null?void 0:t(Un.CHANNEL_ERROR,p)),this._onClose(()=>t==null?void 0:t(Un.CLOSED)),this.updateJoinPayload(Object.assign({config:h},f)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:p})=>{var g;if(this.socket.setAuth(),p===void 0){t==null||t(Un.SUBSCRIBED);return}else{const m=this.bindings.postgres_changes,x=(g=m==null?void 0:m.length)!==null&&g!==void 0?g:0,v=[];for(let y=0;y<x;y++){const b=m[y],{filter:{event:w,schema:j,table:_,filter:E}}=b,N=p&&p[y];if(N&&N.event===w&&N.schema===j&&N.table===_&&N.filter===E)v.push(Object.assign(Object.assign({},b),{id:N.id}));else{this.unsubscribe(),this.state=Lt.errored,t==null||t(Un.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=v,t&&t(Un.SUBSCRIBED);return}}).receive("error",p=>{this.state=Lt.errored,t==null||t(Un.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Un.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===Lt.joined&&t===Ra.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,n)}async httpSend(t,r,n={}){var i;const s=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(r==null)return Promise.reject("Payload is required for httpSend()");const a={method:"POST",headers:{Authorization:s,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,a,(i=n.timeout)!==null&&i!==void 0?i:this.timeout);if(l.status===202)return{success:!0};let c=l.statusText;try{const d=await l.json();c=d.error||d.message||c}catch{}return Promise.reject(new Error(c))}async send(t,r={}){var n,i;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:s,payload:a}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:a,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=d.body)===null||i===void 0?void 0:i.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var a,l,c;const d=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(l=(a=this.params)===null||a===void 0?void 0:a.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&s("ok"),d.receive("ok",()=>s("ok")),d.receive("error",()=>s("error")),d.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Lt.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(on.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(i=>{n=new au(this,on.leave,{},t),n.receive("ok",()=>{r(),i("ok")}).receive("timeout",()=>{r(),i("timed out")}).receive("error",()=>{i("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Lt.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const i=new AbortController,s=setTimeout(()=>i.abort(),n),a=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:i.signal}));return clearTimeout(s),a}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new au(this,t,r,n);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>US){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var i,s;const a=t.toLocaleLowerCase(),{close:l,error:c,leave:d,join:u}=on;if(n&&[l,c,d,u].indexOf(a)>=0&&n!==this._joinRef())return;let h=this._onMessage(a,r,n);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(p=>{var g,m,x;return((g=p.filter)===null||g===void 0?void 0:g.event)==="*"||((x=(m=p.filter)===null||m===void 0?void 0:m.event)===null||x===void 0?void 0:x.toLocaleLowerCase())===a}).map(p=>p.callback(h,n)):(s=this.bindings[a])===null||s===void 0||s.filter(p=>{var g,m,x,v,y,b;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in p){const w=p.id,j=(g=p.filter)===null||g===void 0?void 0:g.event;return w&&((m=r.ids)===null||m===void 0?void 0:m.includes(w))&&(j==="*"||(j==null?void 0:j.toLocaleLowerCase())===((x=r.data)===null||x===void 0?void 0:x.type.toLocaleLowerCase()))}else{const w=(y=(v=p==null?void 0:p.filter)===null||v===void 0?void 0:v.event)===null||y===void 0?void 0:y.toLocaleLowerCase();return w==="*"||w===((b=r==null?void 0:r.event)===null||b===void 0?void 0:b.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===a}).map(p=>{if(typeof h=="object"&&"ids"in h){const g=h.data,{schema:m,table:x,commit_timestamp:v,type:y,errors:b}=g;h=Object.assign(Object.assign({},{schema:m,table:x,commit_timestamp:v,eventType:y,new:{},old:{},errors:b}),this._getPayloadRecords(g))}p.callback(h,n)})}_isClosed(){return this.state===Lt.closed}_isJoined(){return this.state===Lt.joined}_isJoining(){return this.state===Lt.joining}_isLeaving(){return this.state===Lt.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const i=t.toLocaleLowerCase(),s={type:i,filter:r,callback:n};return this.bindings[i]?this.bindings[i].push(s):this.bindings[i]=[s],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(i=>{var s;return!(((s=i.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&ep.isEqual(i.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(on.close,{},t)}_onError(t){this._on(on.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Lt.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Sg(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Sg(t.columns,t.old_record)),r}}const lu=()=>{},Bl={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},ZS=[1e3,2e3,5e3,1e4],JS=1e4,QS=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class ek{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Ah,this.transport=null,this.heartbeatIntervalMs=Bl.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=lu,this.ref=0,this.reconnectTimer=null,this.logger=lu,this.conn=null,this.sendBuffer=[],this.serializer=new WS,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=i=>i?(...s)=>i(...s):(...s)=>fetch(...s),!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${Mh.websocket}`,this.httpEndpoint=ew(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=DS.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:BS}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},t?this.conn.close(t,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Na.connecting:return Ji.Connecting;case Na.open:return Ji.Open;case Na.closing:return Ji.Closing;default:return Ji.Closed}}isConnected(){return this.connectionState()===Ji.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,i=this.getChannels().find(s=>s.topic===n);if(i)return i;{const s=new ep(`realtime:${t}`,r,this);return this.channels.push(s),s}}push(t){const{topic:r,event:n,payload:i,ref:s}=t,a=()=>{this.encode(t,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${n} (${s})`,i),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(HS,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Bl.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:i,payload:s,ref:a}=r,l=a?`(${a})`:"",c=s.status||"";this.log("receive",`${c} ${n} ${i} ${l}`.trim(),s),this.channels.filter(d=>d._isMember(n)).forEach(d=>d._trigger(i,s,a)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(on.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",i=new URLSearchParams(r);return`${t}${n}${i}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([QS],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const i={access_token:r,version:FS};r&&n.updateJoinPayload(i),n.joinedOnce&&n._isJoined()&&n._push(on.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(i){this.log("error",`error in ${t} callback`,i)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new Jb(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Bl.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,i,s,a,l,c,d,u;if(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:Ah,this.heartbeatIntervalMs=(i=t==null?void 0:t.heartbeatIntervalMs)!==null&&i!==void 0?i:Bl.HEARTBEAT_INTERVAL,this.worker=(s=t==null?void 0:t.worker)!==null&&s!==void 0?s:!1,this.accessToken=(a=t==null?void 0:t.accessToken)!==null&&a!==void 0?a:null,this.heartbeatCallback=(l=t==null?void 0:t.heartbeatCallback)!==null&&l!==void 0?l:lu,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t==null?void 0:t.reconnectAfterMs)!==null&&c!==void 0?c:f=>ZS[f-1]||JS,this.encode=(d=t==null?void 0:t.encode)!==null&&d!==void 0?d:(f,h)=>h(JSON.stringify(f)),this.decode=(u=t==null?void 0:t.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class tp extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function jt(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class tk extends tp{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Lh extends tp{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}const rp=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),rk=()=>Response,Ih=e=>{if(Array.isArray(e))return e.map(r=>Ih(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const i=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[i]=Ih(n)}),t},nk=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},cu=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},ik=(e,t,r)=>Le(void 0,void 0,void 0,function*(){const n=yield rk();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(i=>{const s=e.status||500,a=(i==null?void 0:i.statusCode)||s+"";t(new tk(cu(i),s,a))}).catch(i=>{t(new Lh(cu(i),i))}):t(new Lh(cu(e),e))}),sk=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?i:(nk(n)?(i.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),i.body=JSON.stringify(n)):i.body=n,t!=null&&t.duplex&&(i.duplex=t.duplex),Object.assign(Object.assign({},i),r))};function al(e,t,r,n,i,s){return Le(this,void 0,void 0,function*(){return new Promise((a,l)=>{e(r,sk(t,n,i,s)).then(c=>{if(!c.ok)throw c;return n!=null&&n.noResolveJson?c:c.json()}).then(c=>a(c)).catch(c=>ik(c,l,n))})})}function Ka(e,t,r,n){return Le(this,void 0,void 0,function*(){return al(e,"GET",t,r,n)})}function nn(e,t,r,n,i){return Le(this,void 0,void 0,function*(){return al(e,"POST",t,n,i,r)})}function Dh(e,t,r,n,i){return Le(this,void 0,void 0,function*(){return al(e,"PUT",t,n,i,r)})}function ok(e,t,r,n){return Le(this,void 0,void 0,function*(){return al(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function np(e,t,r,n,i){return Le(this,void 0,void 0,function*(){return al(e,"DELETE",t,n,i,r)})}class ak{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r}then(t,r){return this.execute().then(t,r)}execute(){return Le(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(jt(t))return{data:null,error:t};throw t}})}}var tw;class lk{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r,this[tw]="BlobDownloadBuilder",this.promise=null}asStream(){return new ak(this.downloadFn,this.shouldThrowOnError)}then(t,r){return this.getPromise().then(t,r)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return Le(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(jt(t))return{data:null,error:t};throw t}})}}tw=Symbol.toStringTag;const ck={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Cg={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class dk{constructor(t,r={},n,i){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=n,this.fetch=rp(i)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,n,i){return Le(this,void 0,void 0,function*(){try{let s;const a=Object.assign(Object.assign({},Cg),i);let l=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(a.upsert)});const c=a.metadata;typeof Blob<"u"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",a.cacheControl),c&&s.append("metadata",this.encodeMetadata(c)),s.append("",n)):typeof FormData<"u"&&n instanceof FormData?(s=n,s.has("cacheControl")||s.append("cacheControl",a.cacheControl),c&&!s.has("metadata")&&s.append("metadata",this.encodeMetadata(c))):(s=n,l["cache-control"]=`max-age=${a.cacheControl}`,l["content-type"]=a.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c))),(typeof ReadableStream<"u"&&s instanceof ReadableStream||s&&typeof s=="object"&&"pipe"in s&&typeof s.pipe=="function")&&!a.duplex&&(a.duplex="half")),i!=null&&i.headers&&(l=Object.assign(Object.assign({},l),i.headers));const d=this._removeEmptyFolders(r),u=this._getFinalPath(d),f=yield(t=="PUT"?Dh:nn)(this.fetch,`${this.url}/object/${u}`,s,Object.assign({headers:l},a!=null&&a.duplex?{duplex:a.duplex}:{}));return{data:{path:d,id:f.Id,fullPath:f.Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(jt(s))return{data:null,error:s};throw s}})}upload(t,r,n){return Le(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,i){return Le(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(t),a=this._getFinalPath(s),l=new URL(this.url+`/object/upload/sign/${a}`);l.searchParams.set("token",r);try{let c;const d=Object.assign({upsert:Cg.upsert},i),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",n)):typeof FormData<"u"&&n instanceof FormData?(c=n,c.append("cacheControl",d.cacheControl)):(c=n,u["cache-control"]=`max-age=${d.cacheControl}`,u["content-type"]=d.contentType);const f=yield Dh(this.fetch,l.toString(),c,{headers:u});return{data:{path:s,fullPath:f.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(jt(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,r){return Le(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const i=Object.assign({},this.headers);r!=null&&r.upsert&&(i["x-upsert"]="true");const s=yield nn(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:i}),a=new URL(this.url+s.url),l=a.searchParams.get("token");if(!l)throw new tp("No token returned by API");return{data:{signedUrl:a.toString(),path:t,token:l},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(jt(n))return{data:null,error:n};throw n}})}update(t,r,n){return Le(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return Le(this,void 0,void 0,function*(){try{return{data:yield nn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(jt(i))return{data:null,error:i};throw i}})}copy(t,r,n){return Le(this,void 0,void 0,function*(){try{return{data:{path:(yield nn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(jt(i))return{data:null,error:i};throw i}})}createSignedUrl(t,r,n){return Le(this,void 0,void 0,function*(){try{let i=this._getFinalPath(t),s=yield nn(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const a=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${a}`)},{data:s,error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(jt(i))return{data:null,error:i};throw i}})}createSignedUrls(t,r,n){return Le(this,void 0,void 0,function*(){try{const i=yield nn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:i.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${s}`):null})),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(jt(i))return{data:null,error:i};throw i}})}download(t,r){const i=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),a=s?`?${s}`:"",l=this._getFinalPath(t),c=()=>Ka(this.fetch,`${this.url}/${i}/${l}${a}`,{headers:this.headers,noResolveJson:!0});return new lk(c,this.shouldThrowOnError)}info(t){return Le(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield Ka(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Ih(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(jt(n))return{data:null,error:n};throw n}})}exists(t){return Le(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield ok(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(jt(n)&&n instanceof Lh){const i=n.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),i=[],s=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";s!==""&&i.push(s);const l=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});c!==""&&i.push(c);let d=i.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${n}${d}`)}}}remove(t){return Le(this,void 0,void 0,function*(){try{return{data:yield np(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(jt(r))return{data:null,error:r};throw r}})}list(t,r,n){return Le(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},ck),r),{prefix:t||""});return{data:yield nn(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},n),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(jt(i))return{data:null,error:i};throw i}})}listV2(t,r){return Le(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield nn(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(jt(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const rw="2.79.0",nw={"X-Client-Info":`storage-js/${rw}`};class uk{constructor(t,r={},n,i){this.shouldThrowOnError=!1;const s=new URL(t);i!=null&&i.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},nw),r),this.fetch=rp(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(t){return Le(this,void 0,void 0,function*(){try{const r=this.listBucketOptionsToQueryString(t);return{data:yield Ka(this.fetch,`${this.url}/bucket${r}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(jt(r))return{data:null,error:r};throw r}})}getBucket(t){return Le(this,void 0,void 0,function*(){try{return{data:yield Ka(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(jt(r))return{data:null,error:r};throw r}})}createBucket(t){return Le(this,arguments,void 0,function*(r,n={public:!1}){try{return{data:yield nn(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(jt(i))return{data:null,error:i};throw i}})}updateBucket(t,r){return Le(this,void 0,void 0,function*(){try{return{data:yield Dh(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(jt(n))return{data:null,error:n};throw n}})}emptyBucket(t){return Le(this,void 0,void 0,function*(){try{return{data:yield nn(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(jt(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Le(this,void 0,void 0,function*(){try{return{data:yield np(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(jt(r))return{data:null,error:r};throw r}})}listBucketOptionsToQueryString(t){const r={};return t&&("limit"in t&&(r.limit=String(t.limit)),"offset"in t&&(r.offset=String(t.offset)),t.search&&(r.search=t.search),t.sortColumn&&(r.sortColumn=t.sortColumn),t.sortOrder&&(r.sortOrder=t.sortOrder)),Object.keys(r).length>0?"?"+new URLSearchParams(r).toString():""}}class hk{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},nw),r),this.fetch=rp(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return Le(this,void 0,void 0,function*(){try{return{data:yield nn(this.fetch,`${this.url}/bucket`,{name:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(jt(r))return{data:null,error:r};throw r}})}listBuckets(t){return Le(this,void 0,void 0,function*(){try{const r=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&r.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&r.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&r.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&r.set("sortOrder",t.sortOrder),t!=null&&t.search&&r.set("search",t.search);const n=r.toString(),i=n?`${this.url}/bucket?${n}`:`${this.url}/bucket`;return{data:yield Ka(this.fetch,i,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(jt(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Le(this,void 0,void 0,function*(){try{return{data:yield np(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(jt(r))return{data:null,error:r};throw r}})}}const ip={"X-Client-Info":`storage-js/${rw}`,"Content-Type":"application/json"};class iw extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function Er(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}class du extends iw{constructor(t,r,n){super(t),this.name="StorageVectorsApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class fk extends iw{constructor(t,r){super(t),this.name="StorageVectorsUnknownError",this.originalError=r}}var Eg;(function(e){e.InternalError="InternalError",e.S3VectorConflictException="S3VectorConflictException",e.S3VectorNotFoundException="S3VectorNotFoundException",e.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",e.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",e.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(Eg||(Eg={}));const sp=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),pk=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},Tg=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),mk=(e,t,r)=>Le(void 0,void 0,void 0,function*(){if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(r!=null&&r.noResolveJson)){const i=e.status||500,s=e;if(typeof s.json=="function")s.json().then(a=>{const l=(a==null?void 0:a.statusCode)||(a==null?void 0:a.code)||i+"";t(new du(Tg(a),i,l))}).catch(()=>{const a=i+"",l=s.statusText||`HTTP ${i} error`;t(new du(l,i,a))});else{const a=i+"",l=s.statusText||`HTTP ${i} error`;t(new du(l,i,a))}}else t(new fk(Tg(e),e))}),gk=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return n?(pk(n)?(i.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),i.body=JSON.stringify(n)):i.body=n,Object.assign(Object.assign({},i),r)):i};function vk(e,t,r,n,i,s){return Le(this,void 0,void 0,function*(){return new Promise((a,l)=>{e(r,gk(t,n,i,s)).then(c=>{if(!c.ok)throw c;if(n!=null&&n.noResolveJson)return c;const d=c.headers.get("content-type");return!d||!d.includes("application/json")?{}:c.json()}).then(c=>a(c)).catch(c=>mk(c,l,n))})})}function Tr(e,t,r,n,i){return Le(this,void 0,void 0,function*(){return vk(e,"POST",t,n,i,r)})}class yk{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},ip),r),this.fetch=sp(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(t){return Le(this,void 0,void 0,function*(){try{return{data:(yield Tr(this.fetch,`${this.url}/CreateIndex`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Er(r))return{data:null,error:r};throw r}})}getIndex(t,r){return Le(this,void 0,void 0,function*(){try{return{data:yield Tr(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:t,indexName:r},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Er(n))return{data:null,error:n};throw n}})}listIndexes(t){return Le(this,void 0,void 0,function*(){try{return{data:yield Tr(this.fetch,`${this.url}/ListIndexes`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Er(r))return{data:null,error:r};throw r}})}deleteIndex(t,r){return Le(this,void 0,void 0,function*(){try{return{data:(yield Tr(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:t,indexName:r},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Er(n))return{data:null,error:n};throw n}})}}class xk{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},ip),r),this.fetch=sp(n)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(t){return Le(this,void 0,void 0,function*(){try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield Tr(this.fetch,`${this.url}/PutVectors`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Er(r))return{data:null,error:r};throw r}})}getVectors(t){return Le(this,void 0,void 0,function*(){try{return{data:yield Tr(this.fetch,`${this.url}/GetVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Er(r))return{data:null,error:r};throw r}})}listVectors(t){return Le(this,void 0,void 0,function*(){try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:yield Tr(this.fetch,`${this.url}/ListVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Er(r))return{data:null,error:r};throw r}})}queryVectors(t){return Le(this,void 0,void 0,function*(){try{return{data:yield Tr(this.fetch,`${this.url}/QueryVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Er(r))return{data:null,error:r};throw r}})}deleteVectors(t){return Le(this,void 0,void 0,function*(){try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield Tr(this.fetch,`${this.url}/DeleteVectors`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Er(r))return{data:null,error:r};throw r}})}}class bk{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},ip),r),this.fetch=sp(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return Le(this,void 0,void 0,function*(){try{return{data:(yield Tr(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Er(r))return{data:null,error:r};throw r}})}getBucket(t){return Le(this,void 0,void 0,function*(){try{return{data:yield Tr(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Er(r))return{data:null,error:r};throw r}})}listBuckets(){return Le(this,arguments,void 0,function*(t={}){try{return{data:yield Tr(this.fetch,`${this.url}/ListVectorBuckets`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Er(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Le(this,void 0,void 0,function*(){try{return{data:(yield Tr(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Er(r))return{data:null,error:r};throw r}})}}class wk extends bk{constructor(t,r={}){super(t,r.headers||{},r.fetch)}from(t){return new _k(this.url,this.headers,t,this.fetch)}}class _k extends yk{constructor(t,r,n,i){super(t,r,i),this.vectorBucketName=n}createIndex(t){const r=Object.create(null,{createIndex:{get:()=>super.createIndex}});return Le(this,void 0,void 0,function*(){return r.createIndex.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const t=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return Le(this,arguments,void 0,function*(r={}){return t.listIndexes.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName}))})}getIndex(t){const r=Object.create(null,{getIndex:{get:()=>super.getIndex}});return Le(this,void 0,void 0,function*(){return r.getIndex.call(this,this.vectorBucketName,t)})}deleteIndex(t){const r=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return Le(this,void 0,void 0,function*(){return r.deleteIndex.call(this,this.vectorBucketName,t)})}index(t){return new Sk(this.url,this.headers,this.vectorBucketName,t,this.fetch)}}class Sk extends xk{constructor(t,r,n,i,s){super(t,r,s),this.vectorBucketName=n,this.indexName=i}putVectors(t){const r=Object.create(null,{putVectors:{get:()=>super.putVectors}});return Le(this,void 0,void 0,function*(){return r.putVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(t){const r=Object.create(null,{getVectors:{get:()=>super.getVectors}});return Le(this,void 0,void 0,function*(){return r.getVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const t=Object.create(null,{listVectors:{get:()=>super.listVectors}});return Le(this,arguments,void 0,function*(r={}){return t.listVectors.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(t){const r=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return Le(this,void 0,void 0,function*(){return r.queryVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(t){const r=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return Le(this,void 0,void 0,function*(){return r.deleteVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class kk extends uk{constructor(t,r={},n,i){super(t,r,n,i)}from(t){return new dk(this.url,this.headers,t,this.fetch)}get vectors(){return new wk(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new hk(this.url+"/iceberg",this.headers,this.fetch)}}const jk="2.79.0";let ga="";typeof Deno<"u"?ga="deno":typeof document<"u"?ga="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ga="react-native":ga="node";const Ck={"X-Client-Info":`supabase-js-${ga}/${jk}`},Ek={headers:Ck},Tk={schema:"public"},Nk={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Pk={},Rk=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),Ok=()=>Headers,Ak=(e,t,r)=>{const n=Rk(r),i=Ok();return async(s,a)=>{var l;const c=(l=await t())!==null&&l!==void 0?l:e;let d=new i(a==null?void 0:a.headers);return d.has("apikey")||d.set("apikey",e),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),n(s,Object.assign(Object.assign({},a),{headers:d}))}};function Mk(e){return e.endsWith("/")?e:e+"/"}function $k(e,t){var r,n;const{db:i,auth:s,realtime:a,global:l}=e,{db:c,auth:d,realtime:u,global:f}=t,h={db:Object.assign(Object.assign({},c),i),auth:Object.assign(Object.assign({},d),s),realtime:Object.assign(Object.assign({},u),a),storage:{},global:Object.assign(Object.assign(Object.assign({},f),l),{headers:Object.assign(Object.assign({},(r=f==null?void 0:f.headers)!==null&&r!==void 0?r:{}),(n=l==null?void 0:l.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}function Lk(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Mk(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const sw="2.79.0",$s=30*1e3,zh=3,uu=zh*$s,Ik="http://localhost:9999",Dk="supabase.auth.token",zk={"X-Client-Info":`gotrue-js/${sw}`},Fh="X-Supabase-Api-Version",ow={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Fk=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Bk=10*60*1e3;class Za extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function ze(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class Hk extends Za{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function Uk(e){return ze(e)&&e.name==="AuthApiError"}class Qi extends Za{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class zi extends Za{constructor(t,r,n,i){super(t,n,i),this.name=r,this.status=n}}class Qr extends zi{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Wk(e){return ze(e)&&e.name==="AuthSessionMissingError"}class Ps extends zi{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Hl extends zi{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Ul extends zi{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Gk(e){return ze(e)&&e.name==="AuthImplicitGrantRedirectError"}class Ng extends zi{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Bh extends zi{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function hu(e){return ze(e)&&e.name==="AuthRetryableFetchError"}class Pg extends zi{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Hh extends zi{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ic="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Rg=` 	
\r=`.split(""),Vk=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Rg.length;t+=1)e[Rg[t].charCodeAt(0)]=-2;for(let t=0;t<Ic.length;t+=1)e[Ic[t].charCodeAt(0)]=t;return e})();function Og(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Ic[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Ic[n]),t.queuedBits-=6}}function aw(e,t,r){const n=Vk[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Ag(e){const t=[],r=a=>{t.push(String.fromCodePoint(a))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},s=a=>{Xk(a,n,r)};for(let a=0;a<e.length;a+=1)aw(e.charCodeAt(a),i,s);return t.join("")}function qk(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function Yk(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|i)+65536,r+=1}qk(n,t)}}function Xk(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function bo(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};for(let i=0;i<e.length;i+=1)aw(e.charCodeAt(i),r,n);return new Uint8Array(t)}function Kk(e){const t=[];return Yk(e,r=>t.push(r)),new Uint8Array(t)}function ss(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};return e.forEach(i=>Og(i,r,n)),Og(null,r,n),t.join("")}function Zk(e){return Math.round(Date.now()/1e3)+e}function Jk(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const er=()=>typeof window<"u"&&typeof document<"u",Gi={tested:!1,writable:!1},lw=()=>{if(!er())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Gi.tested)return Gi.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Gi.tested=!0,Gi.writable=!0}catch{Gi.tested=!0,Gi.writable=!1}return Gi.writable};function Qk(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((i,s)=>{t[s]=i})}catch{}return r.searchParams.forEach((n,i)=>{t[i]=n}),t}const cw=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),ej=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Ls=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Vi=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},fi=async(e,t)=>{await e.removeItem(t)};class vd{constructor(){this.promise=new vd.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}vd.promiseConstructor=Promise;function fu(e){const t=e.split(".");if(t.length!==3)throw new Hh("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!Fk.test(t[n]))throw new Hh("JWT not in base64url format");return{header:JSON.parse(Ag(t[0])),payload:JSON.parse(Ag(t[1])),signature:bo(t[2]),raw:{header:t[0],payload:t[1]}}}async function tj(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function rj(e,t){return new Promise((n,i)=>{(async()=>{for(let s=0;s<1/0;s++)try{const a=await e(s);if(!t(s,null,a)){n(a);return}}catch(a){if(!t(s,a)){i(a);return}}})()})}function nj(e){return("0"+e.toString(16)).substr(-2)}function ij(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let i="";for(let s=0;s<56;s++)i+=r.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(t),Array.from(t,nj).join("")}async function sj(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),i=new Uint8Array(n);return Array.from(i).map(s=>String.fromCharCode(s)).join("")}async function oj(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await sj(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Rs(e,t,r=!1){const n=ij();let i=n;r&&(i+="/PASSWORD_RECOVERY"),await Ls(e,`${t}-code-verifier`,i);const s=await oj(n);return[s,n===s?"plain":"s256"]}const aj=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function lj(e){const t=e.headers.get(Fh);if(!t||!t.match(aj))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function cj(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function dj(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const uj=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Os(e){if(!uj.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function pu(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function hj(e,t){return new Proxy(e,{get:(r,n,i)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const s=n.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)"||s==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,i)}return!t.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,n,i)}})}function Mg(e){return JSON.parse(JSON.stringify(e))}const Ki=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),fj=[502,503,504];async function $g(e){var t;if(!ej(e))throw new Bh(Ki(e),0);if(fj.includes(e.status))throw new Bh(Ki(e),e.status);let r;try{r=await e.json()}catch(s){throw new Qi(Ki(s),s)}let n;const i=lj(e);if(i&&i.getTime()>=ow["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Pg(Ki(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Qr}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,a)=>s&&typeof a=="string",!0))throw new Pg(Ki(r),e.status,r.weak_password.reasons);throw new Hk(Ki(r),e.status||500,n)}const pj=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};async function Ge(e,t,r,n){var i;const s=Object.assign({},n==null?void 0:n.headers);s[Fh]||(s[Fh]=ow["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const a=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(a.redirect_to=n.redirectTo);const l=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",c=await mj(e,t,r+l,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(c):{data:Object.assign({},c),error:null}}async function mj(e,t,r,n,i,s){const a=pj(t,n,i,s);let l;try{l=await e(r,Object.assign({},a))}catch(c){throw console.error(c),new Bh(Ki(c),0)}if(l.ok||await $g(l),n!=null&&n.noResolveJson)return l;try{return await l.json()}catch(c){await $g(c)}}function en(e){var t;let r=null;yj(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=Zk(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function Lg(e){const t=en(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function xi(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function gj(e){return{data:e,error:null}}function vj(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s}=e,a=Ao(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s},c=Object.assign({},a);return{data:{properties:l,user:c},error:null}}function Ig(e){return e}function yj(e){return e.access_token&&e.refresh_token&&e.expires_in}const mu=["global","local","others"];class xj{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=cw(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=mu[0]){if(mu.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${mu.join(", ")}`);try{return await Ge(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(ze(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Ge(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:xi})}catch(n){if(ze(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=Ao(t,["options"]),i=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),await Ge(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:vj,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(ze(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Ge(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:xi})}catch(r){if(ze(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,i,s,a,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await Ge(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:Ig});if(u.error)throw u.error;const f=await u.json(),h=(a=u.headers.get("x-total-count"))!==null&&a!==void 0?a:0,p=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return p.length>0&&(p.forEach(g=>{const m=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(g.split(";")[1].split("=")[1]);d[`${x}Page`]=m}),d.total=parseInt(h)),{data:Object.assign(Object.assign({},f),d),error:null}}catch(d){if(ze(d))return{data:{users:[]},error:d};throw d}}async getUserById(t){Os(t);try{return await Ge(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:xi})}catch(r){if(ze(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Os(t);try{return await Ge(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:xi})}catch(n){if(ze(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){Os(t);try{return await Ge(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:xi})}catch(n){if(ze(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){Os(t.userId);try{const{data:r,error:n}=await Ge(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:r,error:n}}catch(r){if(ze(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Os(t.userId),Os(t.id);try{return{data:await Ge(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(ze(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,i,s,a,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await Ge(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:Ig});if(u.error)throw u.error;const f=await u.json(),h=(a=u.headers.get("x-total-count"))!==null&&a!==void 0?a:0,p=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return p.length>0&&(p.forEach(g=>{const m=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(g.split(";")[1].split("=")[1]);d[`${x}Page`]=m}),d.total=parseInt(h)),{data:Object.assign(Object.assign({},f),d),error:null}}catch(d){if(ze(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(t){try{return await Ge(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(ze(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await Ge(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(ze(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await Ge(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(ze(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await Ge(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(ze(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await Ge(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(ze(r))return{data:null,error:r};throw r}}}function Dg(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const As={debug:!!(globalThis&&lw()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class dw extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class bj extends dw{}async function wj(e,t,r){As.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),As.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){As.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,i.name);try{return await r()}finally{As.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,i.name)}}else{if(t===0)throw As.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new bj(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(As.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function _j(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function uw(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function Sj(e){return parseInt(e,16)}function kj(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function jj(e){var t;const{chainId:r,domain:n,expirationTime:i,issuedAt:s=new Date,nonce:a,notBefore:l,requestId:c,resources:d,scheme:u,uri:f,version:h}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(a&&a.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${a}`);if(!f)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(h!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${h}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const p=uw(e.address),g=u?`${u}://${n}`:n,m=e.statement?`${e.statement}
`:"",x=`${g} wants you to sign in with your Ethereum account:
${p}

${m}`;let v=`URI: ${f}
Version: ${h}
Chain ID: ${r}${a?`
Nonce: ${a}`:""}
Issued At: ${s.toISOString()}`;if(i&&(v+=`
Expiration Time: ${i.toISOString()}`),l&&(v+=`
Not Before: ${l.toISOString()}`),c&&(v+=`
Request ID: ${c}`),d){let y=`
Resources:`;for(const b of d){if(!b||typeof b!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${b}`);y+=`
- ${b}`}v+=y}return`${x}
${v}`}class Ot extends Error{constructor({message:t,code:r,cause:n,name:i}){var s;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(s=i??(n instanceof Error?n.name:void 0))!==null&&s!==void 0?s:"Unknown Error",this.code=r}}class Dc extends Ot{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function Cj({error:e,options:t}){var r,n,i;const{publicKey:s}=t;if(!s)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Ot({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=s.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Ot({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=s.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Ot({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((i=s.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new Ot({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new Ot({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new Ot({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return s.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new Ot({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new Ot({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const a=window.location.hostname;if(hw(a)){if(s.rp.id!==a)return new Ot({message:`The RP ID "${s.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Ot({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(s.user.id.byteLength<1||s.user.id.byteLength>64)return new Ot({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new Ot({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Ot({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function Ej({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Ot({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new Ot({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(hw(n)){if(r.rpId!==n)return new Ot({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Ot({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new Ot({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Ot({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class Tj{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const Nj=new Tj;function Pj(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,i=Ao(e,["challenge","user","excludeCredentials"]),s=bo(t).buffer,a=Object.assign(Object.assign({},r),{id:bo(r.id).buffer}),l=Object.assign(Object.assign({},i),{challenge:s,user:a});if(n&&n.length>0){l.excludeCredentials=new Array(n.length);for(let c=0;c<n.length;c++){const d=n[c];l.excludeCredentials[c]=Object.assign(Object.assign({},d),{id:bo(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return l}function Rj(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=Ao(e,["challenge","allowCredentials"]),i=bo(t).buffer,s=Object.assign(Object.assign({},n),{challenge:i});if(r&&r.length>0){s.allowCredentials=new Array(r.length);for(let a=0;a<r.length;a++){const l=r[a];s.allowCredentials[a]=Object.assign(Object.assign({},l),{id:bo(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return s}function Oj(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:ss(new Uint8Array(e.response.attestationObject)),clientDataJSON:ss(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function Aj(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),i=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:ss(new Uint8Array(i.authenticatorData)),clientDataJSON:ss(new Uint8Array(i.clientDataJSON)),signature:ss(new Uint8Array(i.signature)),userHandle:i.userHandle?ss(new Uint8Array(i.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function hw(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function zg(){var e,t;return!!(er()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function Mj(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Dc("Browser returned unexpected credential type",t)}:{data:null,error:new Dc("Empty credential response",t)}}catch(t){return{data:null,error:Cj({error:t,options:e})}}}async function $j(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Dc("Browser returned unexpected credential type",t)}:{data:null,error:new Dc("Empty credential response",t)}}catch(t){return{data:null,error:Ej({error:t,options:e})}}}const Lj={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},Ij={userVerification:"preferred",hints:["security-key"]};function zc(...e){const t=i=>i!==null&&typeof i=="object"&&!Array.isArray(i),r=i=>i instanceof ArrayBuffer||ArrayBuffer.isView(i),n={};for(const i of e)if(i)for(const s in i){const a=i[s];if(a!==void 0)if(Array.isArray(a))n[s]=a;else if(r(a))n[s]=a;else if(t(a)){const l=n[s];t(l)?n[s]=zc(l,a):n[s]=zc(a)}else n[s]=a}return n}function Dj(e,t){return zc(Lj,e,t||{})}function zj(e,t){return zc(Ij,e,t||{})}class Fj{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:i},s){try{const{data:a,error:l}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!a)return{data:null,error:l};const c=i??Nj.createNewAbortSignal();if(a.webauthn.type==="create"){const{user:d}=a.webauthn.credential_options.publicKey;d.name||(d.name=`${d.id}:${n}`),d.displayName||(d.displayName=d.name)}switch(a.webauthn.type){case"create":{const d=Dj(a.webauthn.credential_options.publicKey,s==null?void 0:s.create),{data:u,error:f}=await Mj({publicKey:d,signal:c});return u?{data:{factorId:t,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:u}},error:null}:{data:null,error:f}}case"request":{const d=zj(a.webauthn.credential_options.publicKey,s==null?void 0:s.request),{data:u,error:f}=await $j(Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:d,signal:c}));return u?{data:{factorId:t,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:u}},error:null}:{data:null,error:f}}}}catch(a){return ze(a)?{data:null,error:a}:{data:null,error:new Qi("Unexpected error in challenge",a)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}},s){if(!r)return{data:null,error:new Za("rpId is required for WebAuthn authentication")};try{if(!zg())return{data:null,error:new Qi("Browser does not support WebAuthn",null)};const{data:a,error:l}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:i},{request:s});if(!a)return{data:null,error:l};const{webauthn:c}=a;return this._verify({factorId:t,challengeId:a.challengeId,webauthn:{type:c.type,rpId:r,rpOrigins:n,credential_response:c.credential_response}})}catch(a){return ze(a)?{data:null,error:a}:{data:null,error:new Qi("Unexpected error in authenticate",a)}}}async _register({friendlyName:t,rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i},s){if(!r)return{data:null,error:new Za("rpId is required for WebAuthn registration")};try{if(!zg())return{data:null,error:new Qi("Browser does not support WebAuthn",null)};const{data:a,error:l}=await this._enroll({friendlyName:t});if(!a)return await this.client.mfa.listFactors().then(u=>{var f;return(f=u.data)===null||f===void 0?void 0:f.all.find(h=>h.factor_type==="webauthn"&&h.friendly_name===t&&h.status!=="unverified")}).then(u=>u?this.client.mfa.unenroll({factorId:u==null?void 0:u.id}):void 0),{data:null,error:l};const{data:c,error:d}=await this._challenge({factorId:a.id,friendlyName:a.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:i},{create:s});return c?this._verify({factorId:a.id,challengeId:c.challengeId,webauthn:{rpId:r,rpOrigins:n,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:d}}catch(a){return ze(a)?{data:null,error:a}:{data:null,error:new Qi("Unexpected error in register",a)}}}}_j();const Bj={url:Ik,storageKey:Dk,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:zk,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function Fg(e,t,r){return await r()}const Ms={};class Ja{get jwks(){var t,r;return(r=(t=Ms[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Ms[this.storageKey]=Object.assign(Object.assign({},Ms[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Ms[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Ms[this.storageKey]=Object.assign(Object.assign({},Ms[this.storageKey]),{cachedAt:t})}constructor(t){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Ja.nextInstanceID,Ja.nextInstanceID+=1,this.instanceID>0&&er()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},Bj),t);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new xj({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=cw(i.fetch),this.lock=i.lock||Fg,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,i.lock?this.lock=i.lock:er()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=wj:this.lock=Fg,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new Fj(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:lw()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Dg(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=Dg(this.memoryStorage)),er()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${sw}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},n="none";if(er()&&(r=Qk(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),er()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),Gk(s)){const c=(t=s.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:a,redirectType:l}=i;return this._debug("#_initialize()","detected session in URL",a,"redirect type",l),await this._saveSession(a),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return ze(r)?this._returnResult({error:r}):this._returnResult({error:new Qi("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,i;try{const s=await Ge(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=t==null?void 0:t.options)===null||i===void 0?void 0:i.captchaToken}},xform:en}),{data:a,error:l}=s;if(l||!a)return this._returnResult({data:{user:null,session:null},error:l});const c=a.session,d=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(s){if(ze(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signUp(t){var r,n,i;try{let s;if("email"in t){const{email:u,password:f,options:h}=t;let p=null,g=null;this.flowType==="pkce"&&([p,g]=await Rs(this.storage,this.storageKey)),s=await Ge(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:u,password:f,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:p,code_challenge_method:g},xform:en})}else if("phone"in t){const{phone:u,password:f,options:h}=t;s=await Ge(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:f,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},channel:(i=h==null?void 0:h.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:en})}else throw new Hl("You must provide either an email or phone number and a password");const{data:a,error:l}=s;if(l||!a)return this._returnResult({data:{user:null,session:null},error:l});const c=a.session,d=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(s){if(ze(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithPassword(t){try{let r;if("email"in t){const{email:s,password:a,options:l}=t;r=await Ge(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Lg})}else if("phone"in t){const{phone:s,password:a,options:l}=t;r=await Ge(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Lg})}else throw new Hl("You must provide either an email or phone number and a password");const{data:n,error:i}=r;if(i)return this._returnResult({data:{user:null,session:null},error:i});if(!n||!n.session||!n.user){const s=new Ps;return this._returnResult({data:{user:null,session:null},error:s})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(r){if(ze(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,n,i,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=t.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,i,s,a,l,c,d,u,f,h;let p,g;if("message"in t)p=t.message,g=t.signature;else{const{chain:m,wallet:x,statement:v,options:y}=t;let b;if(er())if(typeof x=="object")b=x;else{const O=window;if("ethereum"in O&&typeof O.ethereum=="object"&&"request"in O.ethereum&&typeof O.ethereum.request=="function")b=O.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(y!=null&&y.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");b=x}const w=new URL((r=y==null?void 0:y.url)!==null&&r!==void 0?r:window.location.href),j=await b.request({method:"eth_requestAccounts"}).then(O=>O).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!j||j.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const _=uw(j[0]);let E=(n=y==null?void 0:y.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!E){const O=await b.request({method:"eth_chainId"});E=Sj(O)}const N={domain:w.host,address:_,statement:v,uri:w.href,version:"1",chainId:E,nonce:(i=y==null?void 0:y.signInWithEthereum)===null||i===void 0?void 0:i.nonce,issuedAt:(a=(s=y==null?void 0:y.signInWithEthereum)===null||s===void 0?void 0:s.issuedAt)!==null&&a!==void 0?a:new Date,expirationTime:(l=y==null?void 0:y.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=y==null?void 0:y.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(d=y==null?void 0:y.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(u=y==null?void 0:y.signInWithEthereum)===null||u===void 0?void 0:u.resources};p=jj(N),g=await b.request({method:"personal_sign",params:[kj(p),_]})}try{const{data:m,error:x}=await Ge(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:p,signature:g},!((f=t.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(h=t.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:en});if(x)throw x;if(!m||!m.session||!m.user){const v=new Ps;return this._returnResult({data:{user:null,session:null},error:v})}return m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),this._returnResult({data:Object.assign({},m),error:x})}catch(m){if(ze(m))return this._returnResult({data:{user:null,session:null},error:m});throw m}}async signInWithSolana(t){var r,n,i,s,a,l,c,d,u,f,h,p;let g,m;if("message"in t)g=t.message,m=t.signature;else{const{chain:x,wallet:v,statement:y,options:b}=t;let w;if(er())if(typeof v=="object")w=v;else{const _=window;if("solana"in _&&typeof _.solana=="object"&&("signIn"in _.solana&&typeof _.solana.signIn=="function"||"signMessage"in _.solana&&typeof _.solana.signMessage=="function"))w=_.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof v!="object"||!(b!=null&&b.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=v}const j=new URL((r=b==null?void 0:b.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in w&&w.signIn){const _=await w.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},b==null?void 0:b.signInWithSolana),{version:"1",domain:j.host,uri:j.href}),y?{statement:y}:null));let E;if(Array.isArray(_)&&_[0]&&typeof _[0]=="object")E=_[0];else if(_&&typeof _=="object"&&"signedMessage"in _&&"signature"in _)E=_;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in E&&"signature"in E&&(typeof E.signedMessage=="string"||E.signedMessage instanceof Uint8Array)&&E.signature instanceof Uint8Array)g=typeof E.signedMessage=="string"?E.signedMessage:new TextDecoder().decode(E.signedMessage),m=E.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in w)||typeof w.signMessage!="function"||!("publicKey"in w)||typeof w!="object"||!w.publicKey||!("toBase58"in w.publicKey)||typeof w.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");g=[`${j.host} wants you to sign in with your Solana account:`,w.publicKey.toBase58(),...y?["",y,""]:[""],"Version: 1",`URI: ${j.href}`,`Issued At: ${(i=(n=b==null?void 0:b.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((s=b==null?void 0:b.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${b.signInWithSolana.notBefore}`]:[],...!((a=b==null?void 0:b.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${b.signInWithSolana.expirationTime}`]:[],...!((l=b==null?void 0:b.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${b.signInWithSolana.chainId}`]:[],...!((c=b==null?void 0:b.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${b.signInWithSolana.nonce}`]:[],...!((d=b==null?void 0:b.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${b.signInWithSolana.requestId}`]:[],...!((f=(u=b==null?void 0:b.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||f===void 0)&&f.length?["Resources",...b.signInWithSolana.resources.map(E=>`- ${E}`)]:[]].join(`
`);const _=await w.signMessage(new TextEncoder().encode(g),"utf8");if(!_||!(_ instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=_}}try{const{data:x,error:v}=await Ge(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:g,signature:ss(m)},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(p=t.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:en});if(v)throw v;if(!x||!x.session||!x.user){const y=new Ps;return this._returnResult({data:{user:null,session:null},error:y})}return x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",x.session)),this._returnResult({data:Object.assign({},x),error:v})}catch(x){if(ze(x))return this._returnResult({data:{user:null,session:null},error:x});throw x}}async _exchangeCodeForSession(t){const r=await Vi(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(r??"").split("/");try{const{data:s,error:a}=await Ge(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:en});if(await fi(this.storage,`${this.storageKey}-code-verifier`),a)throw a;if(!s||!s.session||!s.user){const l=new Ps;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign(Object.assign({},s),{redirectType:i??null}),error:a})}catch(s){if(ze(s))return this._returnResult({data:{user:null,session:null,redirectType:null},error:s});throw s}}async signInWithIdToken(t){try{const{options:r,provider:n,token:i,access_token:s,nonce:a}=t,l=await Ge(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:s,nonce:a,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:en}),{data:c,error:d}=l;if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!c||!c.session||!c.user){const u=new Ps;return this._returnResult({data:{user:null,session:null},error:u})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:d})}catch(r){if(ze(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,n,i,s,a;try{if("email"in t){const{email:l,options:c}=t;let d=null,u=null;this.flowType==="pkce"&&([d,u]=await Rs(this.storage,this.storageKey));const{error:f}=await Ge(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(n=c==null?void 0:c.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:d,code_challenge_method:u},redirectTo:c==null?void 0:c.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:f})}if("phone"in t){const{phone:l,options:c}=t,{data:d,error:u}=await Ge(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(i=c==null?void 0:c.data)!==null&&i!==void 0?i:{},create_user:(s=c==null?void 0:c.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(a=c==null?void 0:c.channel)!==null&&a!==void 0?a:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:u})}throw new Hl("You must provide either an email or phone number.")}catch(l){if(ze(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(t){var r,n;try{let i,s;"options"in t&&(i=(r=t.options)===null||r===void 0?void 0:r.redirectTo,s=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:a,error:l}=await Ge(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:i,xform:en});if(l)throw l;if(!a)throw new Error("An error occurred on token verification.");const c=a.session,d=a.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(i){if(ze(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithSSO(t){var r,n,i;try{let s=null,a=null;this.flowType==="pkce"&&([s,a]=await Rs(this.storage,this.storageKey));const l=await Ge(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=t==null?void 0:t.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:a}),headers:this.headers,xform:gj});return this._returnResult(l)}catch(s){if(ze(s))return this._returnResult({data:null,error:s});throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Qr;const{error:i}=await Ge(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:i})})}catch(t){if(ze(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:i,options:s}=t,{error:a}=await Ge(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:a})}else if("phone"in t){const{phone:n,type:i,options:s}=t,{data:a,error:l}=await Ge(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:l})}throw new Hl("You must provide either an email or phone number and a type")}catch(r){if(ze(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Vi(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<uu:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const a=await Vi(this.userStorage,this.storageKey+"-user");a!=null&&a.user?t.user=a.user:t.user=pu()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const a={value:this.suppressGetSessionWarning};t.user=hj(t.user,a),a.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:i,error:s}=await this._callRefreshToken(t.refresh_token);return s?this._returnResult({data:{session:null},error:s}):this._returnResult({data:{session:i},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Ge(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:xi}):await this._useSession(async r=>{var n,i,s;const{data:a,error:l}=r;if(l)throw l;return!(!((n=a.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Qr}:await Ge(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(i=a.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0,xform:xi})})}catch(r){if(ze(r))return Wk(r)&&(await this._removeSession(),await fi(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:i,error:s}=n;if(s)throw s;if(!i.session)throw new Qr;const a=i.session;let l=null,c=null;this.flowType==="pkce"&&t.email!=null&&([l,c]=await Rs(this.storage,this.storageKey));const{data:d,error:u}=await Ge(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:c}),jwt:a.access_token,xform:xi});if(u)throw u;return a.user=d.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),this._returnResult({data:{user:a.user},error:null})})}catch(n){if(ze(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Qr;const r=Date.now()/1e3;let n=r,i=!0,s=null;const{payload:a}=fu(t.access_token);if(a.exp&&(n=a.exp,i=n<=r),i){const{data:l,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l)return{data:{user:null,session:null},error:null};s=l}else{const{data:l,error:c}=await this._getUser(t.access_token);if(c)throw c;s={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return this._returnResult({data:{user:s.user,session:s},error:null})}catch(r){if(ze(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:a,error:l}=r;if(l)throw l;t=(n=a.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Qr;const{data:i,error:s}=await this._callRefreshToken(t.refresh_token);return s?this._returnResult({data:{user:null,session:null},error:s}):i?this._returnResult({data:{user:i.user,session:i},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(ze(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!er())throw new Ul("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Ul(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Ng("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ul("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Ng("No code detected.");const{data:y,error:b}=await this._exchangeCodeForSession(t.code);if(b)throw b;const w=new URL(window.location.href);return w.searchParams.delete("code"),window.history.replaceState(window.history.state,"",w.toString()),{data:{session:y.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:s,refresh_token:a,expires_in:l,expires_at:c,token_type:d}=t;if(!s||!l||!a||!d)throw new Ul("No session defined in URL");const u=Math.round(Date.now()/1e3),f=parseInt(l);let h=u+f;c&&(h=parseInt(c));const p=h-u;p*1e3<=$s&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${f}s`);const g=h-f;u-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,h,u):u-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,h,u);const{data:m,error:x}=await this._getUser(s);if(x)throw x;const v={provider_token:n,provider_refresh_token:i,access_token:s,expires_in:f,expires_at:h,refresh_token:a,token_type:d,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:v,redirectType:t.type},error:null})}catch(n){if(ze(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Vi(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return this._returnResult({error:s});const a=(n=i.session)===null||n===void 0?void 0:n.access_token;if(a){const{error:l}=await this.admin.signOut(a,t);if(l&&!(Uk(l)&&(l.status===404||l.status===401||l.status===403)))return this._returnResult({error:l})}return t!=="others"&&(await this._removeSession(),await fi(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=Jk(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,i;try{const{data:{session:s},error:a}=r;if(a)throw a;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,r={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await Rs(this.storage,this.storageKey,!0));try{return await Ge(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(ze(s))return this._returnResult({data:null,error:s});throw s}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(ze(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:i}=await this._useSession(async s=>{var a,l,c,d,u;const{data:f,error:h}=s;if(h)throw h;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(a=t.options)===null||a===void 0?void 0:a.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await Ge(this.fetch,"GET",p,{headers:this.headers,jwt:(u=(d=f.session)===null||d===void 0?void 0:d.access_token)!==null&&u!==void 0?u:void 0})});if(i)throw i;return er()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:t.provider,url:n==null?void 0:n.url},error:null})}catch(n){if(ze(n))return this._returnResult({data:{provider:t.provider,url:null},error:n});throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:i,data:{session:s}}=r;if(i)throw i;const{options:a,provider:l,token:c,access_token:d,nonce:u}=t,f=await Ge(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=s==null?void 0:s.access_token)!==null&&n!==void 0?n:void 0,body:{provider:l,id_token:c,access_token:d,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:en}),{data:h,error:p}=f;return p?this._returnResult({data:{user:null,session:null},error:p}):!h||!h.session||!h.user?this._returnResult({data:{user:null,session:null},error:new Ps}):(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("USER_UPDATED",h.session)),this._returnResult({data:h,error:p}))}catch(i){if(ze(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,i;const{data:s,error:a}=r;if(a)throw a;return await Ge(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(i=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(r){if(ze(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await rj(async i=>(i>0&&await tj(200*Math.pow(2,i-1)),this._debug(r,"refreshing attempt",i),await Ge(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:en})),(i,s)=>{const a=200*Math.pow(2,i);return s&&hu(s)&&Date.now()+a-n<$s})}catch(n){if(this._debug(r,"error",n),ze(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),er()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const i=await Vi(this.storage,this.storageKey);if(i&&this.userStorage){let a=await Vi(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:i.user},await Ls(this.userStorage,this.storageKey+"-user",a)),i.user=(t=a==null?void 0:a.user)!==null&&t!==void 0?t:pu()}else if(i&&!i.user&&!i.user){const a=await Vi(this.storage,this.storageKey+"-user");a&&(a!=null&&a.user)?(i.user=a.user,await fi(this.storage,this.storageKey+"-user"),await Ls(this.storage,this.storageKey,i)):i.user=pu()}if(this._debug(n,"session from storage",i),!this._isValidSession(i)){this._debug(n,"session is not valid"),i!==null&&await this._removeSession();return}const s=((r=i.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<uu;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${uu}s`),s){if(this.autoRefreshToken&&i.refresh_token){const{error:a}=await this._callRefreshToken(i.refresh_token);a&&(console.error(a),hu(a)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:l}=await this._getUser(i.access_token);!l&&(a!=null&&a.user)?(i.user=a.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(n,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(n,"error",i),console.error(i);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Qr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new vd;const{data:s,error:a}=await this._refreshAccessToken(t);if(a)throw a;if(!s.session)throw new Qr;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const l={data:s.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(s){if(this._debug(i,"error",s),ze(s)){const a={data:null,error:s};return hu(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(a),a}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(t,r,n=!0){const i=`#_notifyAllSubscribers(${t})`;this._debug(i,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const s=[],a=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,r)}catch(c){s.push(c)}});if(await Promise.all(a),s.length>0){for(let l=0;l<s.length;l+=1)console.error(s[l]);throw s[0]}}finally{this._debug(i,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await Ls(this.userStorage,this.storageKey+"-user",{user:r.user});const i=Object.assign({},r);delete i.user;const s=Mg(i);await Ls(this.storage,this.storageKey,s)}else{const i=Mg(r);await Ls(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),await fi(this.storage,this.storageKey),await fi(this.storage,this.storageKey+"-code-verifier"),await fi(this.storage,this.storageKey+"-user"),this.userStorage&&await fi(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&er()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),$s);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-t)/$s);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${$s}ms, refresh threshold is ${zh} ticks`),i<=zh&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof dw)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!er()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const i=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,a]=await Rs(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(a)}`});i.push(l.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);i.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${i.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;return s?this._returnResult({data:null,error:s}):await Ge(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(ze(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,i;const{data:s,error:a}=r;if(a)return this._returnResult({data:null,error:a});const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:c,error:d}=await Ge(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return d?this._returnResult({data:null,error:d}):(t.factorType==="totp"&&c.type==="totp"&&(!((i=c==null?void 0:c.totp)===null||i===void 0)&&i.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(r){if(ze(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return this._returnResult({data:null,error:s});const a=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?Oj(t.webauthn.credential_response):Aj(t.webauthn.credential_response)})}:{code:t.code}),{data:l,error:c}=await Ge(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:a,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:c}))})}catch(r){if(ze(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return this._returnResult({data:null,error:s});const a=await Ge(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});if(a.error)return a;const{data:l}=a;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:Pj(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:Rj(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(ze(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const i={all:[],phone:[],totp:[],webauthn:[]};for(const s of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])i.all.push(s),s.status==="verified"&&i[s.factor_type].push(s);return{data:i,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:n},error:i}=await this.getSession();if(i)return this._returnResult({data:null,error:i});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:s}=fu(n.access_token);let a=null;s.aal&&(a=s.aal);let l=a;((r=(t=n.user.factors)===null||t===void 0?void 0:t.filter(u=>u.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const d=s.amr||[];return{data:{currentLevel:a,nextLevel:l,currentAuthenticationMethods:d},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:n},error:i}=r;return i?this._returnResult({data:null,error:i}):n?await Ge(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:n.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new Qr})})}catch(r){if(ze(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:i},error:s}=n;if(s)return this._returnResult({data:null,error:s});if(!i)return this._returnResult({data:null,error:new Qr});const a=await Ge(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return a.data&&a.data.redirect_url&&er()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(a.data.redirect_url),a})}catch(n){if(ze(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:i},error:s}=n;if(s)return this._returnResult({data:null,error:s});if(!i)return this._returnResult({data:null,error:new Qr});const a=await Ge(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return a.data&&a.data.redirect_url&&er()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(a.data.redirect_url),a})}catch(n){if(ze(n))return this._returnResult({data:null,error:n});throw n}}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(l=>l.kid===t);if(n)return n;const i=Date.now();if(n=this.jwks.keys.find(l=>l.kid===t),n&&this.jwks_cached_at+Bk>i)return n;const{data:s,error:a}=await Ge(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=i,n=s.keys.find(l=>l.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:p,error:g}=await this.getSession();if(g||!p.session)return this._returnResult({data:null,error:g});n=p.session.access_token}const{header:i,payload:s,signature:a,raw:{header:l,payload:c}}=fu(n);r!=null&&r.allowExpired||cj(s.exp);const d=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!d){const{error:p}=await this.getUser(n);if(p)throw p;return{data:{claims:s,header:i,signature:a},error:null}}const u=dj(i.alg),f=await crypto.subtle.importKey("jwk",d,u,!0,["verify"]);if(!await crypto.subtle.verify(u,f,a,Kk(`${l}.${c}`)))throw new Hh("Invalid JWT signature");return{data:{claims:s,header:i,signature:a},error:null}}catch(n){if(ze(n))return this._returnResult({data:null,error:n});throw n}}}Ja.nextInstanceID=0;const Hj=Ja;class Uj extends Hj{constructor(t){super(t)}}class Wj{constructor(t,r,n){var i,s,a;this.supabaseUrl=t,this.supabaseKey=r;const l=Lk(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,d={db:Tk,realtime:Pk,auth:Object.assign(Object.assign({},Nk),{storageKey:c}),global:Ek},u=$k(n??{},d);this.storageKey=(i=u.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(s=u.global.headers)!==null&&s!==void 0?s:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(f,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=u.auth)!==null&&a!==void 0?a:{},this.headers,u.global.fetch),this.fetch=Ak(r,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new IS(new URL("rest/v1",l).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new kk(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new MS(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t,r;if(this.accessToken)return await this.accessToken();const{data:n}=await this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:i,userStorage:s,storageKey:a,flowType:l,lock:c,debug:d,throwOnError:u},f,h){const p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Uj({url:this.authUrl.href,headers:Object.assign(Object.assign({},p),f),storageKey:a,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:i,userStorage:s,flowType:l,lock:c,debug:d,throwOnError:u,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(g=>g.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new ek(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Gj=(e,t,r)=>new Wj(e,t,r);function Vj(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}Vj()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Bg={DRAFTIFY:"/api/studio-draftify",GEOMETRIC_GENERATE:"/api/studio-generate-geometric"},Hg={URL:"https://okakomwfikxmwllvliva.supabase.co",ANON_KEY:""},Ug={AUTH_SESSION:"studio_auth_session"},es={BLEND_MODE_ENABLED:!1},Dt=Gj(Hg.URL,Hg.ANON_KEY),Tn={async signIn(e,t){const{data:r,error:n}=await Dt.auth.signInWithPassword({email:e,password:t});if(n)throw n;return localStorage.setItem(Ug.AUTH_SESSION,JSON.stringify(r.session)),r},async signOut(){await Dt.auth.signOut(),localStorage.removeItem(Ug.AUTH_SESSION)},async getSession(){const{data:e}=await Dt.auth.getSession();return e.session},async updatePassword(e){const{data:t,error:r}=await Dt.auth.updateUser({password:e});if(r)throw r;return await Dt.auth.updateUser({data:{password_setup_complete:!0}}),t},onAuthStateChange(e){return Dt.auth.onAuthStateChange(e)}};async function yd(){var r,n;const e=await Dt.auth.getSession(),t=(n=(r=e==null?void 0:e.data)==null?void 0:r.session)==null?void 0:n.access_token;if(!t)throw new Error("Not authenticated");return{"Content-Type":"application/json",Authorization:`Bearer ${t}`}}async function op(e){const t=await yd(),r=await fetch("/api/designs/save",{method:"POST",headers:t,body:JSON.stringify(e)});if(!r.ok){const n=await r.json();throw new Error(n.error||"Unable to save your design. Please check your connection and try again.")}return r.json()}async function Fc({project_id:e,limit:t=50,offset:r=0,search:n}={}){const i=await yd(),s=new URLSearchParams;e&&s.append("project_id",e),s.append("limit",t),s.append("offset",r),n&&s.append("search",n);const a=await fetch(`/api/designs/list?${s}`,{method:"GET",headers:i});if(!a.ok){const l=await a.json();throw new Error(l.error||"Unable to load your designs. Please refresh the page and try again.")}return a.json()}async function ll(e){const t=await yd(),r=await fetch(`/api/designs/by-id?id=${e}`,{method:"GET",headers:t});if(!r.ok){const n=await r.json();throw new Error(n.error||"Unable to open this design. It may have been deleted or you may not have permission to view it.")}return r.json()}async function qj(e){const t=await yd(),r=await fetch(`/api/designs/by-id?id=${e}`,{method:"DELETE",headers:t});if(!r.ok){const n=await r.json();throw new Error(n.error||"Unable to delete this design. Please check your connection and try again.")}return r.json()}class Yj extends D.Component{constructor(r){super(r);im(this,"handleReset",()=>{this.setState({hasError:!1,error:null,errorInfo:null})});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(r){return{hasError:!0}}componentDidCatch(r,n){console.error("[ErrorBoundary] Caught error:",r,n),this.setState({error:r,errorInfo:n})}render(){return this.state.hasError?o.jsxs("div",{className:"error-boundary",children:[o.jsxs("div",{className:"error-content",children:[o.jsx("h1",{children:"Something went wrong"}),o.jsx("p",{children:"We're sorry, but something unexpected happened. Please try refreshing the page."}),o.jsxs("div",{className:"error-actions",children:[o.jsx("button",{onClick:this.handleReset,className:"btn-primary",children:"Try Again"}),o.jsx("button",{onClick:()=>window.location.reload(),className:"btn-secondary",children:"Refresh Page"})]}),!1]}),o.jsx("style",{jsx:!0,children:`
            .error-boundary {
              min-height: 100vh;
              display: flex;
              align-items: center;
              justify-content: center;
              padding: 2rem;
              background: #f9fafb;
            }

            .error-content {
              max-width: 500px;
              text-align: center;
              background: white;
              padding: 3rem;
              border-radius: 12px;
              box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            }

            h1 {
              color: #1e4a7a;
              margin: 0 0 1rem 0;
              font-size: 1.75rem;
            }

            p {
              color: #6b7280;
              margin: 0 0 2rem 0;
              line-height: 1.6;
            }

            .error-actions {
              display: flex;
              gap: 1rem;
              justify-content: center;
            }

            .btn-primary,
            .btn-secondary {
              padding: 0.75rem 1.5rem;
              border-radius: 6px;
              font-weight: 500;
              cursor: pointer;
              transition: all 0.2s;
              border: none;
            }

            .btn-primary {
              background: #ff6b35;
              color: white;
            }

            .btn-primary:hover {
              background: #e55a2b;
              transform: translateY(-1px);
            }

            .btn-secondary {
              background: white;
              color: #374151;
              border: 1px solid #d1d5db;
            }

            .btn-secondary:hover {
              background: #f9fafb;
            }

            .error-details {
              margin-top: 2rem;
              text-align: left;
              font-size: 0.875rem;
            }

            .error-details summary {
              cursor: pointer;
              color: #6b7280;
              margin-bottom: 0.5rem;
            }

            .error-details pre {
              background: #f3f4f6;
              padding: 1rem;
              border-radius: 4px;
              overflow-x: auto;
              font-size: 0.75rem;
              color: #dc2626;
            }
          `})]}):this.props.children}}const Xj="modulepreload",Kj=function(e){return"/"+e},Wg={},Zj=function(t,r,n){let i=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),l=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=Promise.allSettled(r.map(c=>{if(c=Kj(c),c in Wg)return;Wg[c]=!0;const d=c.endsWith(".css"),u=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const f=document.createElement("link");if(f.rel=d?"stylesheet":Xj,d||(f.as="script"),f.crossOrigin="",f.href=c,l&&f.setAttribute("nonce",l),document.head.appendChild(f),d)return new Promise((h,p)=>{f.addEventListener("load",h),f.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(a){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=a,window.dispatchEvent(l),!l.defaultPrevented)throw a}return i.then(a=>{for(const l of a||[])l.status==="rejected"&&s(l.reason);return t().catch(s)})},Gg=e=>{let t;const r=new Set,n=(d,u)=>{const f=typeof d=="function"?d(t):d;if(!Object.is(f,t)){const h=t;t=u??(typeof f!="object"||f===null)?f:Object.assign({},t,f),r.forEach(p=>p(t,h))}},i=()=>t,l={setState:n,getState:i,getInitialState:()=>c,subscribe:d=>(r.add(d),()=>r.delete(d))},c=t=e(n,i,l);return l},Jj=e=>e?Gg(e):Gg,Qj=e=>e;function eC(e,t=Qj){const r=D.useSyncExternalStore(e.subscribe,D.useCallback(()=>t(e.getState()),[e,t]),D.useCallback(()=>t(e.getInitialState()),[e,t]));return D.useDebugValue(r),r}const Vg=e=>{const t=Jj(e),r=n=>eC(t,n);return Object.assign(r,t),r},fw=e=>e?Vg(e):Vg,qg={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},Qa=new Map,Wl=e=>{const t=Qa.get(e);return t?Object.fromEntries(Object.entries(t.stores).map(([r,n])=>[r,n.getState()])):{}},tC=(e,t,r)=>{if(e===void 0)return{type:"untracked",connection:t.connect(r)};const n=Qa.get(r.name);if(n)return{type:"tracked",store:e,...n};const i={connection:t.connect(r),stores:{}};return Qa.set(r.name,i),{type:"tracked",store:e,...i}},rC=(e,t)=>{if(t===void 0)return;const r=Qa.get(e);r&&(delete r.stores[t],Object.keys(r.stores).length===0&&Qa.delete(e))},nC=e=>{var t,r;if(!e)return;const n=e.split(`
`),i=n.findIndex(a=>a.includes("api.setState"));if(i<0)return;const s=((t=n[i+1])==null?void 0:t.trim())||"";return(r=/.+ (.+) .+/.exec(s))==null?void 0:r[1]},iC=(e,t={})=>(r,n,i)=>{const{enabled:s,anonymousActionType:a,store:l,...c}=t;let d;try{d=(s??(qg?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!d)return e(r,n,i);const{connection:u,...f}=tC(l,d,c);let h=!0;i.setState=(m,x,v)=>{const y=r(m,x);if(!h)return y;const b=v===void 0?{type:a||nC(new Error().stack)||"anonymous"}:typeof v=="string"?{type:v}:v;return l===void 0?(u==null||u.send(b,n()),y):(u==null||u.send({...b,type:`${l}/${b.type}`},{...Wl(c.name),[l]:i.getState()}),y)},i.devtools={cleanup:()=>{u&&typeof u.unsubscribe=="function"&&u.unsubscribe(),rC(c.name,l)}};const p=(...m)=>{const x=h;h=!1,r(...m),h=x},g=e(i.setState,n,i);if(f.type==="untracked"?u==null||u.init(g):(f.stores[f.store]=i,u==null||u.init(Object.fromEntries(Object.entries(f.stores).map(([m,x])=>[m,m===f.store?g:x.getState()])))),i.dispatchFromDevtools&&typeof i.dispatch=="function"){let m=!1;const x=i.dispatch;i.dispatch=(...v)=>{(qg?"production":void 0)!=="production"&&v[0].type==="__setState"&&!m&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),m=!0),x(...v)}}return u.subscribe(m=>{var x;switch(m.type){case"ACTION":if(typeof m.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return gu(m.payload,v=>{if(v.type==="__setState"){if(l===void 0){p(v.state);return}Object.keys(v.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format.
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const y=v.state[l];if(y==null)return;JSON.stringify(i.getState())!==JSON.stringify(y)&&p(y);return}i.dispatchFromDevtools&&typeof i.dispatch=="function"&&i.dispatch(v)});case"DISPATCH":switch(m.payload.type){case"RESET":return p(g),l===void 0?u==null?void 0:u.init(i.getState()):u==null?void 0:u.init(Wl(c.name));case"COMMIT":if(l===void 0){u==null||u.init(i.getState());return}return u==null?void 0:u.init(Wl(c.name));case"ROLLBACK":return gu(m.state,v=>{if(l===void 0){p(v),u==null||u.init(i.getState());return}p(v[l]),u==null||u.init(Wl(c.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return gu(m.state,v=>{if(l===void 0){p(v);return}JSON.stringify(i.getState())!==JSON.stringify(v[l])&&p(v[l])});case"IMPORT_STATE":{const{nextLiftedState:v}=m.payload,y=(x=v.computedStates.slice(-1)[0])==null?void 0:x.state;if(!y)return;p(l===void 0?y:y[l]),u==null||u.send(null,v);return}case"PAUSE_RECORDING":return h=!h}return}}),g},pw=iC,gu=(e,t)=>{let r;try{r=JSON.parse(e)}catch(n){console.error("[zustand devtools middleware] Could not parse the received json",n)}r!==void 0&&t(r)};function mw(e){let t=e%2147483647;return t<=0&&(t+=2147483646),function(){return t=t*16807%2147483647,(t-1)/2147483646}}function Yg(e,t,r){const n=mw(r),i=[],s=.4,a=.5,l=.5;for(let c=0;c<e;c++){const d=c/e*Math.PI*2-Math.PI/2,u=(n()-.5)*.4*t,f=d+u,h=1+(n()-.5)*t*.8,p=s*h,g=a+p*Math.cos(f),m=l+p*Math.sin(f),x=.35/e*(1+t*(n()-.5)),v=f+Math.PI/2,y=(n()-.5)*.3*t,b=v+Math.PI+y,w=v+y;i.push({x:g,y:m,handleIn:{x:Math.cos(b)*x,y:Math.sin(b)*x},handleOut:{x:Math.cos(w)*x,y:Math.sin(w)*x}})}return i}function sC(e,t,r){if(!e||e.length<3)return oC(t,r);const n=[],i=e.length;for(let s=0;s<i;s++){const a=e[s],l=e[(s+1)%i],c=a.x*t,d=a.y*r,u=l.x*t,f=l.y*r,h=c+a.handleOut.x*t,p=d+a.handleOut.y*r,g=u+l.handleIn.x*t,m=f+l.handleIn.y*r;s===0&&n.push(`M ${c.toFixed(2)},${d.toFixed(2)}`),n.push(`C ${h.toFixed(2)},${p.toFixed(2)} ${g.toFixed(2)},${m.toFixed(2)} ${u.toFixed(2)},${f.toFixed(2)}`)}return n.push("Z"),n.join(" ")}function oC(e,t){const r=e/2,n=t/2,i=r,s=n;return`M ${i-r},${s} A ${r},${n} 0 1,1 ${i+r},${s} A ${r},${n} 0 1,1 ${i-r},${s} Z`}function aC(){const r=[];for(let a=0;a<8;a++){const l=a/8*Math.PI*2-Math.PI/2,c=.5+.4*Math.cos(l),d=.5+.4*Math.sin(l),u=l+Math.PI/2;r.push({x:c,y:d,handleIn:{x:Math.cos(u+Math.PI)*.2,y:Math.sin(u+Math.PI)*.2},handleOut:{x:Math.cos(u)*.2,y:Math.sin(u)*.2}})}return r}const Bc={organic:{name:"Organic",description:"Smooth, gentle curves like a pebble",minPoints:6,maxPoints:8,blobinessMin:.15,blobinessMax:.25,handleLengthFactor:.4,radiusVariation:.15},splashy:{name:"Splashy",description:"Irregular edges, some spikes like paint splatter",minPoints:10,maxPoints:12,blobinessMin:.3,blobinessMax:.5,handleLengthFactor:.25,radiusVariation:.35},cloudy:{name:"Cloudy",description:"Soft bumps, fluffy cloud-like appearance",minPoints:8,maxPoints:10,blobinessMin:.2,blobinessMax:.3,handleLengthFactor:.5,radiusVariation:.2},rocky:{name:"Rocky",description:"Angular variations, irregular stone-like edges",minPoints:8,maxPoints:12,blobinessMin:.25,blobinessMax:.4,handleLengthFactor:.2,radiusVariation:.3}};function vu(e,t){const r=Bc[e]||Bc.organic,n=mw(t),i=Math.floor(n()*(r.maxPoints-r.minPoints+1))+r.minPoints,s=r.blobinessMin+n()*(r.blobinessMax-r.blobinessMin),a=[],l=.4,c=.5,d=.5;for(let u=0;u<i;u++){const f=u/i*Math.PI*2-Math.PI/2,h=(n()-.5)*.4*s,p=f+h,g=1+(n()-.5)*r.radiusVariation*2,m=l*g,x=c+m*Math.cos(p),v=d+m*Math.sin(p),b=r.handleLengthFactor/i*(.8+n()*.4),w=p+Math.PI/2,j=(n()-.5)*.3*s,_=w+Math.PI+j,E=w+j;a.push({x,y:v,handleIn:{x:Math.cos(_)*b,y:Math.sin(_)*b},handleOut:{x:Math.cos(E)*b,y:Math.sin(E)*b}})}return a}function lC(e,t,r,n){return{x:r?.5-(e-.5):e,y:n?.5-(t-.5):t}}function cC(e,t,r,n){return{x:r?-e:e,y:n?-t:t}}function gw(e,t,r,n=4){const i=[{index:e,mirrorX:!1,mirrorY:!1,rotationAngle:0}];if(r==="none"||!r)return i;if(r==="horizontal"){const s=(t-e)%t;return s!==e&&i.push({index:s,mirrorX:!0,mirrorY:!1,rotationAngle:0}),i}if(r==="vertical"){const s=(Math.floor(t/2)-e+t)%t;return s!==e&&i.push({index:s,mirrorX:!1,mirrorY:!0,rotationAngle:0}),i}if(r==="radial"){for(let s=1;s<n;s++){const a=Math.round(e+s*t/n)%t;if(a!==e){const l=s*2*Math.PI/n;i.push({index:a,mirrorX:!1,mirrorY:!1,rotationAngle:l})}}return i}return i}function dC(e,t,r,n,i,s=4){if(i==="none"||!i)return e.map((l,c)=>c!==t?l:{...l,x:r,y:n});const a=gw(t,e.length,i,s);return e.map((l,c)=>{const d=a.find(f=>f.index===c);if(!d)return l;if(d.rotationAngle!==0){const p=r-.5,g=n-.5,m=Math.cos(d.rotationAngle),x=Math.sin(d.rotationAngle);return{...l,x:.5+p*m-g*x,y:.5+p*x+g*m}}const u=lC(r,n,d.mirrorX,d.mirrorY);return{...l,x:u.x,y:u.y}})}function uC(e,t,r,n,i,s,a=4){if(s==="none"||!s)return e.map((c,d)=>d!==t?c:{...c,[r]:{x:n,y:i}});const l=gw(t,e.length,s,a);return e.map((c,d)=>{const u=l.find(g=>g.index===d);if(!u)return c;let f=r,h=n,p=i;if(u.rotationAngle!==0){const g=Math.cos(u.rotationAngle),m=Math.sin(u.rotationAngle);h=n*g-i*m,p=n*m+i*g}else{const g=cC(n,i,u.mirrorX,u.mirrorY);h=g.x,p=g.y}return{...c,[f]:{x:h,y:p}}})}function hC(e,t,r,n=!0,i=!1){if(!e||e.length<2)return"";const s=[],a=e.length;for(let l=0;l<a;l++){const c=e[l],d=l===a-1,u=n?e[(l+1)%a]:d?null:e[l+1],f=c.x*t,h=c.y*r;if(l===0&&s.push(`M ${f.toFixed(2)},${h.toFixed(2)}`),!u)continue;const p=u.x*t,g=u.y*r;if(i&&c.handleOut&&u.handleIn){const m=f+c.handleOut.x*t,x=h+c.handleOut.y*r,v=p+u.handleIn.x*t,y=g+u.handleIn.y*r;s.push(`C ${m.toFixed(2)},${x.toFixed(2)} ${v.toFixed(2)},${y.toFixed(2)} ${p.toFixed(2)},${g.toFixed(2)}`)}else s.push(`L ${p.toFixed(2)},${g.toFixed(2)}`)}return n&&s.push("Z"),s.join(" ")}function yu(e,t=!0,r=.3){if(!e||e.length<2)return e;const n=e.length,i=e.map(s=>({...s,handleIn:{x:0,y:0},handleOut:{x:0,y:0}}));for(let s=0;s<n;s++){const a=t?e[(s-1+n)%n]:s>0?e[s-1]:e[s];e[s];const l=t?e[(s+1)%n]:s<n-1?e[s+1]:e[s],c=l.x-a.x,d=l.y-a.y,u=r*.5;!t&&s===0?(i[s].handleIn={x:0,y:0},i[s].handleOut={x:c*u,y:d*u}):!t&&s===n-1?(i[s].handleIn={x:-c*u,y:-d*u},i[s].handleOut={x:0,y:0}):(i[s].handleIn={x:-c*u,y:-d*u},i[s].handleOut={x:c*u,y:d*u})}return i}function fC(e,t,r,n){const i={x:r,y:n,handleIn:{x:0,y:0},handleOut:{x:0,y:0}},s=[...e];return s.splice(t,0,i),s}function pC(e,t,r=3){if(e.length<=r)return null;const n=[...e];return n.splice(t,1),n}const xu={surface:{width_mm:5e4,length_mm:5e4,color:{tpv_code:"RH12",hex:"#006C55",name:"Dark Green"}},courts:{},selectedCourtId:null,tracks:{},selectedTrackId:null,motifs:{},selectedMotifId:null,shapes:{},selectedShapeId:null,texts:{},selectedTextId:null,editingTextId:null,elementOrder:[],customMarkings:[],backgroundZones:[],designName:"Untitled Design",designDescription:"",designTags:[],history:[],historyIndex:-1,maxHistory:50,showCourtLibrary:!0,showPropertiesPanel:!0,propertiesPanelUserClosed:!1,showColorEditor:!1,snapToGrid:!0,gridSize_mm:100,mobileLibraryOpen:!1,mobilePropertiesOpen:!1,mobileColoursOpen:!1,mobileActiveTab:"courts",standaloneMode:!1,standaloneDesignId:null,pathDrawingMode:!1,activePathId:null,isSaving:!1,lastSaved:null},tt=fw(pw((e,t)=>({...xu,setSurfaceDimensions:(r,n)=>{e(i=>({surface:{...i.surface,width_mm:r,length_mm:n}})),t().addToHistory()},setSurfaceColor:r=>{e(n=>({surface:{...n.surface,color:r}})),t().addToHistory()},addCourt:(r,n)=>{const i=`court-${Date.now()}`,s=u=>({RH01:{tpv_code:"RH01",hex:"#A5362F",name:"Standard Red"},RH02:{tpv_code:"RH02",hex:"#E21F2F",name:"Bright Red"},RH10:{tpv_code:"RH10",hex:"#609B63",name:"Standard Green"},RH11:{tpv_code:"RH11",hex:"#3BB44A",name:"Bright Green"},RH12:{tpv_code:"RH12",hex:"#006C55",name:"Dark Green"},RH20:{tpv_code:"RH20",hex:"#0075BC",name:"Standard Blue"},RH21:{tpv_code:"RH21",hex:"#493D8C",name:"Purple"},RH22:{tpv_code:"RH22",hex:"#47AFE3",name:"Light Blue"},RH23:{tpv_code:"RH23",hex:"#039DC4",name:"Azure"},RH26:{tpv_code:"RH26",hex:"#00A6A3",name:"Turquoise"},RH30:{tpv_code:"RH30",hex:"#E4C4AA",name:"Standard Beige"},RH31:{tpv_code:"RH31",hex:"#E8E3D8",name:"Cream"},RH32:{tpv_code:"RH32",hex:"#8B5F3C",name:"Brown"},RH40:{tpv_code:"RH40",hex:"#E5A144",name:"Mustard Yellow"},RH41:{tpv_code:"RH41",hex:"#FFD833",name:"Bright Yellow"},RH50:{tpv_code:"RH50",hex:"#F15B32",name:"Orange"},RH60:{tpv_code:"RH60",hex:"#59595B",name:"Dark Grey"},RH61:{tpv_code:"RH61",hex:"#939598",name:"Light Grey"},RH65:{tpv_code:"RH65",hex:"#D9D9D6",name:"Pale Grey"},RH70:{tpv_code:"RH70",hex:"#231F20",name:"Black"},RH90:{tpv_code:"RH90",hex:"#E8457E",name:"Funky Pink"}})[u]||{tpv_code:"RH31",hex:"#E8E3D8",name:"Cream"},a={};if(n.defaultLineColor){const u=s(n.defaultLineColor);n.markings.forEach(f=>{a[f.id]=u})}const l={};if(n.defaultLineColor&&n.zones){const u=s(n.defaultLineColor);n.zones.forEach(f=>{l[f.id]=u})}const c=n.defaultSurfaceColor?s(n.defaultSurfaceColor):null,d={id:i,templateId:r,template:n,position:{x:t().surface.width_mm/2-n.dimensions.width_mm/2,y:t().surface.length_mm/2-n.dimensions.length_mm/2},rotation:0,scale:1,lineColorOverrides:a,zoneColorOverrides:l,courtSurfaceColor:c};e(u=>({courts:{...u.courts,[i]:d},elementOrder:[...u.elementOrder,i],selectedCourtId:i,selectedTrackId:null})),t().addToHistory()},removeCourt:r=>{const{[r]:n,...i}=t().courts;e(s=>({courts:i,elementOrder:s.elementOrder.filter(a=>a!==r),selectedCourtId:s.selectedCourtId===r?null:s.selectedCourtId})),t().addToHistory()},updateCourtPosition:(r,n)=>{e(i=>({courts:{...i.courts,[r]:{...i.courts[r],position:n}}}))},updateCourtRotation:(r,n)=>{e(i=>({courts:{...i.courts,[r]:{...i.courts[r],rotation:n}}}))},updateCourtScale:(r,n)=>{e(i=>({courts:{...i.courts,[r]:{...i.courts[r],scale:n}}}))},duplicateCourt:r=>{const n=t().courts[r];if(!n)return;const i=`court-${Date.now()}`,s={...n,id:i,position:{x:n.position.x+500,y:n.position.y+500}};e(a=>({courts:{...a.courts,[i]:s},elementOrder:[...a.elementOrder,i],selectedCourtId:i,selectedTrackId:null})),t().addToHistory()},duplicateTrack:r=>{const n=t().tracks[r];if(!n)return;const i=`track-${Date.now()}`,s={...n,id:i,position:{x:n.position.x+500,y:n.position.y+500}};e(a=>({tracks:{...a.tracks,[i]:s},elementOrder:[...a.elementOrder,i],selectedTrackId:i,selectedCourtId:null})),t().addToHistory()},renameElement:(r,n)=>{r.startsWith("court-")?e(i=>({courts:{...i.courts,[r]:{...i.courts[r],customName:n}}})):r.startsWith("track-")?e(i=>({tracks:{...i.tracks,[r]:{...i.tracks[r],customName:n}}})):r.startsWith("motif-")?e(i=>({motifs:{...i.motifs,[r]:{...i.motifs[r],customName:n}}})):r.startsWith("shape-")?e(i=>({shapes:{...i.shapes,[r]:{...i.shapes[r],customName:n}}})):r.startsWith("text-")&&e(i=>({texts:{...i.texts,[r]:{...i.texts[r],customName:n}}})),t().addToHistory()},toggleElementLock:r=>{r.startsWith("court-")?e(n=>{var i;return{courts:{...n.courts,[r]:{...n.courts[r],locked:!((i=n.courts[r])!=null&&i.locked)}}}}):r.startsWith("track-")?e(n=>{var i;return{tracks:{...n.tracks,[r]:{...n.tracks[r],locked:!((i=n.tracks[r])!=null&&i.locked)}}}}):r.startsWith("motif-")?e(n=>{var i;return{motifs:{...n.motifs,[r]:{...n.motifs[r],locked:!((i=n.motifs[r])!=null&&i.locked)}}}}):r.startsWith("shape-")?e(n=>{var i;return{shapes:{...n.shapes,[r]:{...n.shapes[r],locked:!((i=n.shapes[r])!=null&&i.locked)}}}}):r.startsWith("text-")&&e(n=>{var i;return{texts:{...n.texts,[r]:{...n.texts[r],locked:!((i=n.texts[r])!=null&&i.locked)}}}}),t().addToHistory()},toggleElementVisibility:r=>{r.startsWith("court-")?e(n=>{var i;return{courts:{...n.courts,[r]:{...n.courts[r],visible:((i=n.courts[r])==null?void 0:i.visible)===!1}}}}):r.startsWith("track-")?e(n=>{var i;return{tracks:{...n.tracks,[r]:{...n.tracks[r],visible:((i=n.tracks[r])==null?void 0:i.visible)===!1}}}}):r.startsWith("motif-")?e(n=>{var i;return{motifs:{...n.motifs,[r]:{...n.motifs[r],visible:((i=n.motifs[r])==null?void 0:i.visible)===!1}}}}):r.startsWith("shape-")?e(n=>{var i;return{shapes:{...n.shapes,[r]:{...n.shapes[r],visible:((i=n.shapes[r])==null?void 0:i.visible)===!1}}}}):r.startsWith("text-")&&e(n=>{var i;return{texts:{...n.texts,[r]:{...n.texts[r],visible:((i=n.texts[r])==null?void 0:i.visible)===!1}}}}),t().addToHistory()},setLineColor:(r,n,i)=>{e(s=>({courts:{...s.courts,[r]:{...s.courts[r],lineColorOverrides:{...s.courts[r].lineColorOverrides,[n]:i}}}})),t().addToHistory()},setZoneColor:(r,n,i)=>{e(s=>({courts:{...s.courts,[r]:{...s.courts[r],zoneColorOverrides:{...s.courts[r].zoneColorOverrides,[n]:i}}}})),t().addToHistory()},resetCourtColors:r=>{e(n=>({courts:{...n.courts,[r]:{...n.courts[r],lineColorOverrides:{},zoneColorOverrides:{}}}})),t().addToHistory()},setCourtSurfaceColor:(r,n)=>{e(i=>({courts:{...i.courts,[r]:{...i.courts[r],courtSurfaceColor:n}}})),t().addToHistory()},selectCourt:r=>{const{propertiesPanelUserClosed:n}=t();e(n?{selectedCourtId:r,selectedTrackId:null,selectedMotifId:null,selectedShapeId:null,selectedTextId:null,editingTextId:null}:{selectedCourtId:r,selectedTrackId:null,selectedMotifId:null,selectedShapeId:null,selectedTextId:null,editingTextId:null,showPropertiesPanel:!0})},deselectCourt:()=>{e({selectedCourtId:null,showPropertiesPanel:!1,propertiesPanelUserClosed:!0})},setElementOrder:r=>{e({elementOrder:r})},moveElementUp:r=>{const{elementOrder:n}=t(),i=n.indexOf(r);if(i<n.length-1){const s=[...n];[s[i],s[i+1]]=[s[i+1],s[i]],e({elementOrder:s}),t().addToHistory()}},moveElementDown:r=>{const{elementOrder:n}=t(),i=n.indexOf(r);if(i>0){const s=[...n];[s[i],s[i-1]]=[s[i-1],s[i]],e({elementOrder:s}),t().addToHistory()}},bringToFront:r=>{const{elementOrder:n}=t(),i=n.filter(s=>s!==r);i.push(r),e({elementOrder:i}),t().addToHistory()},sendToBack:r=>{const{elementOrder:n}=t(),i=n.filter(s=>s!==r);i.unshift(r),e({elementOrder:i}),t().addToHistory()},addTrack:(r,n)=>{const i=`track-${Date.now()}`,s=t().surface,a=s.width_mm,l=s.length_mm,c=x=>({RH01:{tpv_code:"RH01",hex:"#A5362F",name:"Standard Red"},RH31:{tpv_code:"RH31",hex:"#E8E3D8",name:"Cream"},RH30:{tpv_code:"RH30",hex:"#E4C4AA",name:"Standard Beige"},RH20:{tpv_code:"RH20",hex:"#0075BC",name:"Standard Blue"},RH12:{tpv_code:"RH12",hex:"#006C55",name:"Dark Green"}})[x]||{tpv_code:x,hex:"#A5362F",name:"Standard Red"},d=n.defaultTrackSurfaceColor?c(n.defaultTrackSurfaceColor):c("RH01"),u=n.trackType==="straight";let f,h,p;const g={enabled:!1,depth_mm:500,style:"staggered",direction:"counterclockwise",startPosition:0};if(u){const x=n.parameters.numLanes,v=n.parameters.laneWidth_mm,y=x*v,b=Math.max(a,l)*.9,w=n.parameters.height_mm||1e5,j=Math.min(w,b);f={...n.parameters,width_mm:y,height_mm:j,cornerRadius:{topLeft:0,topRight:0,bottomLeft:0,bottomRight:0},laneWidth_mm:v,startingBoxes:{...g,...n.parameters.startingBoxes}},p=90,h={x:a/2-y/2,y:l/2-j/2}}else{const x=a*.9,v=l*.9,y=n.parameters.width_mm||25e3,b=n.parameters.height_mm||15e3,w=x/y,j=v/b,_=Math.min(w,j),E=n.parameters.cornerRadius||{topLeft:3e3,topRight:3e3,bottomLeft:3e3,bottomRight:3e3},N={topLeft:E.topLeft*_,topRight:E.topRight*_,bottomLeft:E.bottomLeft*_,bottomRight:E.bottomRight*_};f={...n.parameters,width_mm:x,height_mm:v,cornerRadius:N,laneWidth_mm:n.parameters.laneWidth_mm,startingBoxes:{...g,...n.parameters.startingBoxes}},p=0,h={x:a/2-x/2,y:l/2-v/2}}const m={id:i,templateId:r,template:n,position:h,rotation:p,parameters:f,trackSurfaceColor:d};e(x=>({tracks:{...x.tracks,[i]:m},elementOrder:[...x.elementOrder,i],selectedTrackId:i,selectedCourtId:null})),t().addToHistory()},removeTrack:r=>{const{[r]:n,...i}=t().tracks;e(s=>({tracks:i,elementOrder:s.elementOrder.filter(a=>a!==r),selectedTrackId:s.selectedTrackId===r?null:s.selectedTrackId})),t().addToHistory()},updateTrackParameters:(r,n)=>{e(i=>{var u;const s=i.tracks[r];if(!s)return i;const a=s.parameters,l={...a,...n},c=((u=s.template)==null?void 0:u.trackType)==="straight";let d=s.position;if(c&&n.numLanes!==void 0&&n.numLanes!==a.numLanes){const f=a.laneWidth_mm,h=a.numLanes*f,p=n.numLanes*f;l.width_mm=p;const g=s.position.x+h/2,m=s.position.y+a.height_mm/2;d={x:g-p/2,y:m-l.height_mm/2}}return{tracks:{...i.tracks,[r]:{...s,parameters:l,position:d}}}}),t().addToHistory()},updateTrackPosition:(r,n)=>{e(i=>({tracks:{...i.tracks,[r]:{...i.tracks[r],position:n}}}))},updateTrackRotation:(r,n)=>{e(i=>({tracks:{...i.tracks,[r]:{...i.tracks[r],rotation:n}}}))},setTrackSurfaceColor:(r,n)=>{e(i=>({tracks:{...i.tracks,[r]:{...i.tracks[r],trackSurfaceColor:n}}})),t().addToHistory()},selectTrack:r=>{const{propertiesPanelUserClosed:n}=t();e(n?{selectedTrackId:r,selectedCourtId:null,selectedMotifId:null,selectedShapeId:null,selectedTextId:null,editingTextId:null}:{selectedTrackId:r,selectedCourtId:null,selectedMotifId:null,selectedShapeId:null,selectedTextId:null,editingTextId:null,showPropertiesPanel:!0})},deselectTrack:()=>{e({selectedTrackId:null,showPropertiesPanel:!1,propertiesPanelUserClosed:!0})},addMotif:(r,n,i,s,a,l=null,c={})=>{const d=`motif-${Date.now()}`,u=t().surface,f={id:d,type:"motif",sourceDesignId:r,sourceDesignName:n,sourceThumbnailUrl:l,solidSvgContent:c.solidSvgContent||i,blendSvgContent:c.blendSvgContent||null,hasBothVersions:c.hasBothVersions||!1,viewMode:"solid",svgContent:c.solidSvgContent||i,originalWidth_mm:s,originalHeight_mm:a,position:{x:u.width_mm/2-s/2,y:u.length_mm/2-a/2},rotation:0,scale:1};e(h=>({motifs:{...h.motifs,[d]:f},elementOrder:[...h.elementOrder,d],selectedMotifId:d,selectedCourtId:null,selectedTrackId:null})),t().addToHistory()},removeMotif:r=>{const{[r]:n,...i}=t().motifs;e(s=>({motifs:i,elementOrder:s.elementOrder.filter(a=>a!==r),selectedMotifId:s.selectedMotifId===r?null:s.selectedMotifId})),t().addToHistory()},updateMotifPosition:(r,n)=>{e(i=>({motifs:{...i.motifs,[r]:{...i.motifs[r],position:n}}}))},updateMotifRotation:(r,n)=>{e(i=>({motifs:{...i.motifs,[r]:{...i.motifs[r],rotation:n}}}))},updateMotifScale:(r,n)=>{e(i=>({motifs:{...i.motifs,[r]:{...i.motifs[r],scale:n}}}))},setMotifViewMode:(r,n)=>{const i=t().motifs[r];if(!i)return;const s=n==="blend"?i.blendSvgContent||i.solidSvgContent:i.solidSvgContent||i.blendSvgContent;e(a=>({motifs:{...a.motifs,[r]:{...a.motifs[r],viewMode:n,svgContent:s}}})),t().addToHistory()},duplicateMotif:r=>{const n=t().motifs[r];if(!n)return;const i=`motif-${Date.now()}`,s={...n,id:i,position:{x:n.position.x+500,y:n.position.y+500}};e(a=>({motifs:{...a.motifs,[i]:s},elementOrder:[...a.elementOrder,i],selectedMotifId:i,selectedCourtId:null,selectedTrackId:null})),t().addToHistory()},refreshMotif:async r=>{const n=t().motifs[r];if(!n)return{success:!1,error:"Motif not found"};try{const{fetchMotifFromDesign:i}=await Zj(async()=>{const{fetchMotifFromDesign:c}=await Promise.resolve().then(()=>yE);return{fetchMotifFromDesign:c}},void 0),s=await i(n.sourceDesignId),l=(n.viewMode||"solid")==="blend"?s.blendSvgContent||s.solidSvgContent:s.solidSvgContent||s.blendSvgContent;return e(c=>({motifs:{...c.motifs,[r]:{...c.motifs[r],solidSvgContent:s.solidSvgContent,blendSvgContent:s.blendSvgContent,hasBothVersions:s.hasBothVersions,svgContent:l,sourceThumbnailUrl:s.sourceThumbnailUrl,sourceDesignName:s.sourceDesignName,originalWidth_mm:s.originalWidth_mm,originalHeight_mm:s.originalHeight_mm}},lastModified:Date.now()})),t().addToHistory(),{success:!0}}catch(i){return console.error("[MOTIF] Failed to refresh:",i),{success:!1,error:i.message}}},selectMotif:r=>{const{propertiesPanelUserClosed:n}=t();e(n?{selectedMotifId:r,selectedCourtId:null,selectedTrackId:null,selectedShapeId:null,selectedTextId:null,editingTextId:null}:{selectedMotifId:r,selectedCourtId:null,selectedTrackId:null,selectedShapeId:null,selectedTextId:null,editingTextId:null,showPropertiesPanel:!0})},deselectMotif:()=>{e({selectedMotifId:null,showPropertiesPanel:!1,propertiesPanelUserClosed:!0})},addShape:(r="rectangle")=>{const n=`shape-${Date.now()}`,i=t().surface,s=t().shapes,a={rectangle:{sides:4,aspectLocked:!1,width:3e3,height:2e3},square:{sides:4,aspectLocked:!0,width:2e3,height:2e3},circle:{sides:32,aspectLocked:!0,width:2e3,height:2e3},triangle:{sides:3,aspectLocked:!0,width:2e3,height:2e3},pentagon:{sides:5,aspectLocked:!0,width:2e3,height:2e3},hexagon:{sides:6,aspectLocked:!0,width:2e3,height:2e3},polygon:{sides:6,aspectLocked:!0,width:2e3,height:2e3}},l=[{tpv_code:"RH20",hex:"#0075BC",name:"Standard Blue"},{tpv_code:"RH50",hex:"#F15B32",name:"Orange"},{tpv_code:"RH10",hex:"#609B63",name:"Standard Green"},{tpv_code:"RH21",hex:"#493D8C",name:"Purple"},{tpv_code:"RH41",hex:"#FFD833",name:"Bright Yellow"},{tpv_code:"RH26",hex:"#00A6A3",name:"Turquoise"},{tpv_code:"RH02",hex:"#E21F2F",name:"Bright Red"},{tpv_code:"RH90",hex:"#E8457E",name:"Funky Pink"}],c=Object.keys(s).length,d=l[c%l.length];if(r==="blob"){const h=Math.floor(Math.random()*1e5),p="organic",g=vu(p,h),m={id:n,type:"shape",shapeType:"blob",blobStyle:p,seed:h,controlPoints:g,editPointsVisible:!1,numPoints:g.length,blobiness:.2,symmetryMode:"none",radialSymmetryCount:4,width_mm:2e3,height_mm:2e3,position:{x:i.width_mm/2-1e3,y:i.length_mm/2-1e3},rotation:0,fillColor:d,strokeEnabled:!1,strokeColor:null,strokeWidth_mm:50,aspectLocked:!1,locked:!1,visible:!0};e(x=>({shapes:{...x.shapes,[n]:m},elementOrder:[...x.elementOrder,n],selectedShapeId:n,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null})),t().addToHistory();return}const u=a[r]||a.rectangle,f={id:n,type:"shape",shapeType:"polygon",sides:u.sides,width_mm:u.width,height_mm:u.height,cornerRadius:0,position:{x:i.width_mm/2-u.width/2,y:i.length_mm/2-u.height/2},rotation:0,fillColor:d,strokeEnabled:!1,strokeColor:null,strokeWidth_mm:50,aspectLocked:u.aspectLocked,locked:!1,visible:!0};e(h=>({shapes:{...h.shapes,[n]:f},elementOrder:[...h.elementOrder,n],selectedShapeId:n,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null})),t().addToHistory()},removeShape:r=>{const{[r]:n,...i}=t().shapes;e(s=>({shapes:i,elementOrder:s.elementOrder.filter(a=>a!==r),selectedShapeId:s.selectedShapeId===r?null:s.selectedShapeId})),t().addToHistory()},updateShapePosition:(r,n)=>{e(i=>({shapes:{...i.shapes,[r]:{...i.shapes[r],position:n}}}))},updateShapeDimensions:(r,n,i)=>{e(s=>({shapes:{...s.shapes,[r]:{...s.shapes[r],width_mm:n,height_mm:i}}}))},updateShapeSides:(r,n)=>{e(i=>{const s=i.shapes[r];if(!s)return i;const a=Math.max(3,Math.min(32,n));let l=s.width_mm,c=s.height_mm;if(a!==4){const d=Math.min(s.width_mm,s.height_mm);l=d,c=d}return{shapes:{...i.shapes,[r]:{...s,sides:a,width_mm:l,height_mm:c,aspectLocked:a!==4}}}}),t().addToHistory()},updateShapeCornerRadius:(r,n)=>{e(i=>({shapes:{...i.shapes,[r]:{...i.shapes[r],cornerRadius:Math.max(0,Math.min(100,n))}}})),t().addToHistory()},updateShapeRotation:(r,n)=>{e(i=>({shapes:{...i.shapes,[r]:{...i.shapes[r],rotation:n}}}))},setShapeFillColor:(r,n)=>{e(i=>({shapes:{...i.shapes,[r]:{...i.shapes[r],fillColor:n}}})),t().addToHistory()},setShapeStroke:(r,n,i=null,s=50)=>{e(a=>({shapes:{...a.shapes,[r]:{...a.shapes[r],strokeEnabled:n,strokeColor:i,strokeWidth_mm:s}}})),t().addToHistory()},setShapeAspectLock:(r,n)=>{e(i=>{const s=i.shapes[r],a=n?s.width_mm:s.height_mm;return{shapes:{...i.shapes,[r]:{...s,aspectLocked:n,height_mm:a}}}}),t().addToHistory()},updateBlobPoints:(r,n)=>{e(i=>{const s=i.shapes[r];if(!s||s.shapeType!=="blob")return i;const a=Yg(n,s.blobiness,s.seed);return{shapes:{...i.shapes,[r]:{...s,numPoints:n,controlPoints:a}}}}),t().addToHistory()},updateBlobiness:(r,n)=>{e(i=>{const s=i.shapes[r];if(!s||s.shapeType!=="blob")return i;const a=Yg(s.numPoints,n,s.seed);return{shapes:{...i.shapes,[r]:{...s,blobiness:n,controlPoints:a}}}}),t().addToHistory()},randomizeBlob:r=>{e(n=>{const i=n.shapes[r];if(!i||i.shapeType!=="blob")return n;const s=Math.floor(Math.random()*1e5),a=i.blobStyle||"organic",l=vu(a,s);return{shapes:{...n.shapes,[r]:{...i,seed:s,controlPoints:l,numPoints:l.length}}}}),t().addToHistory()},setBlobStyle:(r,n)=>{e(i=>{const s=i.shapes[r];if(!s||s.shapeType!=="blob")return i;const a=vu(n,s.seed);return{shapes:{...i.shapes,[r]:{...s,blobStyle:n,controlPoints:a,numPoints:a.length}}}}),t().addToHistory()},setEditPointsVisible:(r,n)=>{e(i=>{const s=i.shapes[r];return!s||s.shapeType!=="blob"&&s.shapeType!=="path"?i:{shapes:{...i.shapes,[r]:{...s,editPointsVisible:n}}}})},resetBlob:r=>{e(n=>{const i=n.shapes[r];if(!i||i.shapeType!=="blob")return n;const s=aC();return{shapes:{...n.shapes,[r]:{...i,blobiness:0,controlPoints:s}}}}),t().addToHistory()},updateBlobControlPoint:(r,n,i,s)=>{e(a=>{const l=a.shapes[r];if(!l||l.shapeType!=="blob"||!l.controlPoints)return a;const c=Math.max(0,Math.min(1,i)),d=Math.max(0,Math.min(1,s)),u=dC(l.controlPoints,n,c,d,l.symmetryMode||"none",l.radialSymmetryCount||4);return{shapes:{...a.shapes,[r]:{...l,controlPoints:u}}}})},updateBlobHandle:(r,n,i,s,a)=>{e(l=>{const c=l.shapes[r];if(!c||c.shapeType!=="blob"||!c.controlPoints)return l;const d=uC(c.controlPoints,n,i,s,a,c.symmetryMode||"none",c.radialSymmetryCount||4);return{shapes:{...l.shapes,[r]:{...c,controlPoints:d}}}})},commitBlobEdit:()=>{t().addToHistory()},setBlobSymmetry:(r,n,i=4)=>{e(s=>{const a=s.shapes[r];return!a||a.shapeType!=="blob"?s:{shapes:{...s.shapes,[r]:{...a,symmetryMode:n,radialSymmetryCount:i}}}}),t().addToHistory()},applyBlobPreset:(r,n)=>{const i=BLOB_PRESETS[n];!i||!i.controlPoints||(e(s=>{const a=s.shapes[r];return!a||a.shapeType!=="blob"?s:{shapes:{...s.shapes,[r]:{...a,numPoints:i.controlPoints.length,blobiness:0,controlPoints:JSON.parse(JSON.stringify(i.controlPoints))}}}}),t().addToHistory())},duplicateShape:r=>{const n=t().shapes[r];if(!n)return;const i=`shape-${Date.now()}`,s={...n,id:i,position:{x:n.position.x+500,y:n.position.y+500}};e(a=>({shapes:{...a.shapes,[i]:s},elementOrder:[...a.elementOrder,i],selectedShapeId:i,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null})),t().addToHistory()},selectShape:r=>{const{propertiesPanelUserClosed:n}=t();e(n?{selectedShapeId:r,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,selectedTextId:null,editingTextId:null}:{selectedShapeId:r,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,selectedTextId:null,editingTextId:null,showPropertiesPanel:!0})},deselectShape:()=>{e({selectedShapeId:null,showPropertiesPanel:!1,propertiesPanelUserClosed:!0})},startPathDrawing:()=>{const r=`shape-path-${Date.now()}`,n=t().surface,i=t().shapes,s=[{tpv_code:"RH20",hex:"#0075BC",name:"Standard Blue"},{tpv_code:"RH50",hex:"#F15B32",name:"Orange"},{tpv_code:"RH10",hex:"#609B63",name:"Standard Green"},{tpv_code:"RH21",hex:"#493D8C",name:"Purple"}],a=Object.keys(i).length,l=s[a%s.length],c={id:r,type:"shape",shapeType:"path",controlPoints:[],closed:!0,smooth:!1,editPointsVisible:!1,width_mm:n.width_mm,height_mm:n.length_mm,position:{x:0,y:0},rotation:0,fillColor:l,strokeEnabled:!0,strokeColor:{tpv_code:"RH70",hex:"#A8A9AD",name:"Light Grey"},strokeWidth_mm:20,aspectLocked:!1,locked:!1,visible:!0};e({pathDrawingMode:!0,activePathId:r,shapes:{...t().shapes,[r]:c},elementOrder:[...t().elementOrder,r],selectedShapeId:r,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,selectedTextId:null})},addPointToPath:(r,n)=>{const{activePathId:i,shapes:s,pathDrawingMode:a}=t();if(!a||!i)return;const l=s[i];if(!l||l.shapeType!=="path")return;const c={x:r,y:n,handleIn:{x:0,y:0},handleOut:{x:0,y:0}};e({shapes:{...s,[i]:{...l,controlPoints:[...l.controlPoints,c]}}})},finishPath:()=>{const{activePathId:r,shapes:n,pathDrawingMode:i}=t();if(!i||!r)return;const s=n[r];if(!s)return;if(s.controlPoints.length<3){t().cancelPath();return}const a=s.controlPoints;let l=1/0,c=1/0,d=-1/0,u=-1/0;for(const w of a)l=Math.min(l,w.x),c=Math.min(c,w.y),d=Math.max(d,w.x),u=Math.max(u,w.y);const f=d-l||1,h=u-c||1,p=.05,g=a.map(w=>({...w,x:p+(w.x-l)/f*(1-2*p),y:p+(w.y-c)/h*(1-2*p)})),m=t().surface,x=f*m.width_mm,v=h*m.length_mm,y=l*m.width_mm,b=c*m.length_mm;e({pathDrawingMode:!1,activePathId:null,shapes:{...n,[r]:{...s,controlPoints:g,width_mm:Math.max(500,x),height_mm:Math.max(500,v),position:{x:y,y:b},strokeEnabled:!1}}}),t().addToHistory()},cancelPath:()=>{const{activePathId:r,shapes:n,elementOrder:i}=t();if(!r){e({pathDrawingMode:!1});return}const s={...n};delete s[r],e({pathDrawingMode:!1,activePathId:null,shapes:s,elementOrder:i.filter(a=>a!==r),selectedShapeId:null})},setPathClosed:(r,n)=>{const i=t().shapes[r];!i||i.shapeType!=="path"||(e({shapes:{...t().shapes,[r]:{...i,closed:n}}}),t().addToHistory())},setPathSmooth:(r,n)=>{const i=t().shapes[r];if(!i||i.shapeType!=="path")return;let s=i.controlPoints;n&&i.controlPoints.length>=2?s=yu(i.controlPoints,i.closed,.3):s=i.controlPoints.map(a=>({...a,handleIn:{x:0,y:0},handleOut:{x:0,y:0}})),e({shapes:{...t().shapes,[r]:{...i,smooth:n,controlPoints:s}}}),t().addToHistory()},updatePathControlPoint:(r,n,i,s)=>{const a=t().shapes[r];if(!a||a.shapeType!=="path")return;const l=[...a.controlPoints];l[n]={...l[n],x:i,y:s},e({shapes:{...t().shapes,[r]:{...a,controlPoints:l}}})},updatePathHandle:(r,n,i,s,a)=>{const l=t().shapes[r];if(!l||l.shapeType!=="path")return;const c=[...l.controlPoints];c[n]={...c[n],[i]:{x:s,y:a}},e({shapes:{...t().shapes,[r]:{...l,controlPoints:c}}})},addPointToExistingPath:(r,n,i,s)=>{const a=t().shapes[r];if(!a||a.shapeType!=="path")return;const l=fC(a.controlPoints,n,i,s),c=a.smooth?yu(l,a.closed,.3):l;e({shapes:{...t().shapes,[r]:{...a,controlPoints:c}}}),t().addToHistory()},removePointFromPath:(r,n)=>{const i=t().shapes[r];if(!i||i.shapeType!=="path")return;const s=i.closed?3:2,a=pC(i.controlPoints,n,s);if(!a){console.log("[STORE] Cannot remove point - minimum reached");return}const l=i.smooth?yu(a,i.closed,.3):a;e({shapes:{...t().shapes,[r]:{...i,controlPoints:l}}}),t().addToHistory()},commitPathEdit:()=>{t().addToHistory()},addText:()=>{const{surface:r}=t(),n=`text-${Date.now()}`,i={id:n,type:"text",content:"",fontFamily:"Open Sans, sans-serif",fontSize_mm:500,fontWeight:"normal",fontStyle:"normal",textAlign:"left",position:{x:r.width_mm/2,y:r.length_mm/2},rotation:0,fillColor:{tpv_code:"RH70",hex:"#1C1C1C",name:"Black"},locked:!1,visible:!0,customName:null};e(s=>({texts:{...s.texts,[n]:i},elementOrder:[...s.elementOrder,n],selectedTextId:n,editingTextId:n,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,selectedShapeId:null})),t().addToHistory()},removeText:r=>{e(n=>{const{[r]:i,...s}=n.texts;return{texts:s,elementOrder:n.elementOrder.filter(a=>a!==r),selectedTextId:n.selectedTextId===r?null:n.selectedTextId,editingTextId:n.editingTextId===r?null:n.editingTextId}}),t().addToHistory()},selectText:r=>{const{propertiesPanelUserClosed:n}=t();e(n?{selectedTextId:r,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,selectedShapeId:null}:{selectedTextId:r,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,selectedShapeId:null,showPropertiesPanel:!0})},deselectText:()=>{e({selectedTextId:null,editingTextId:null,showPropertiesPanel:!1,propertiesPanelUserClosed:!0})},startEditingText:r=>{e({editingTextId:r})},stopEditingText:()=>{e({editingTextId:null}),t().addToHistory()},updateTextContent:(r,n)=>{e(i=>({texts:{...i.texts,[r]:{...i.texts[r],content:n}}}))},updateTextPosition:(r,n)=>{e(i=>({texts:{...i.texts,[r]:{...i.texts[r],position:n}}}))},updateTextFontSize:(r,n)=>{e(i=>({texts:{...i.texts,[r]:{...i.texts[r],fontSize_mm:Math.max(50,n)}}})),t().addToHistory()},updateTextFont:(r,n,i,s)=>{e(a=>({texts:{...a.texts,[r]:{...a.texts[r],fontFamily:n,fontWeight:i,fontStyle:s}}})),t().addToHistory()},updateTextAlign:(r,n)=>{e(i=>({texts:{...i.texts,[r]:{...i.texts[r],textAlign:n}}})),t().addToHistory()},updateTextRotation:(r,n)=>{e(i=>({texts:{...i.texts,[r]:{...i.texts[r],rotation:n}}}))},setTextFillColor:(r,n)=>{e(i=>({texts:{...i.texts,[r]:{...i.texts[r],fillColor:n}}})),t().addToHistory()},duplicateText:r=>{const{texts:n}=t(),i=n[r];if(!i)return;const s=`text-${Date.now()}`,a={...i,id:s,position:{x:i.position.x+500,y:i.position.y+500},customName:i.customName?`${i.customName} (copy)`:null};e(l=>({texts:{...l.texts,[s]:a},elementOrder:[...l.elementOrder,s],selectedTextId:s,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,selectedShapeId:null})),t().addToHistory()},addCustomMarking:r=>{e(n=>({customMarkings:[...n.customMarkings,{...r,id:`custom-${Date.now()}`}]})),t().addToHistory()},removeCustomMarking:r=>{e(n=>({customMarkings:n.customMarkings.filter(i=>i.id!==r)})),t().addToHistory()},addBackgroundZone:r=>{e(n=>({backgroundZones:[...n.backgroundZones,{...r,id:`zone-${Date.now()}`}]})),t().addToHistory()},removeBackgroundZone:r=>{e(n=>({backgroundZones:n.backgroundZones.filter(i=>i.id!==r)})),t().addToHistory()},setDesignName:r=>{e({designName:r})},setDesignDescription:r=>{e({designDescription:r})},setDesignTags:r=>{e({designTags:r})},addToHistory:()=>{const r=t(),n={surface:r.surface,courts:r.courts,tracks:r.tracks,motifs:r.motifs,shapes:r.shapes,texts:r.texts,elementOrder:r.elementOrder,customMarkings:r.customMarkings,backgroundZones:r.backgroundZones};e(i=>{const s=i.history.slice(0,i.historyIndex+1);return s.push(n),s.length>i.maxHistory&&s.shift(),{history:s,historyIndex:s.length-1}})},undo:()=>{const{history:r,historyIndex:n}=t();if(n>0){const i=r[n-1];e({...i,historyIndex:n-1})}},redo:()=>{const{history:r,historyIndex:n}=t();if(n<r.length-1){const i=r[n+1];e({...i,historyIndex:n+1})}},canUndo:()=>t().historyIndex>0,canRedo:()=>t().historyIndex<t().history.length-1,toggleCourtLibrary:()=>{e(r=>({showCourtLibrary:!r.showCourtLibrary}))},togglePropertiesPanel:()=>{e(r=>({showPropertiesPanel:!r.showPropertiesPanel,propertiesPanelUserClosed:!!r.showPropertiesPanel}))},setMobileLibraryOpen:r=>e({mobileLibraryOpen:r}),setMobilePropertiesOpen:r=>e({mobilePropertiesOpen:r}),setMobileColoursOpen:r=>e({mobileColoursOpen:r}),setMobileActiveTab:r=>e({mobileActiveTab:r}),closeMobileSheets:()=>e({mobileLibraryOpen:!1,mobilePropertiesOpen:!1,mobileColoursOpen:!1}),toggleColorEditor:()=>{e(r=>({showColorEditor:!r.showColorEditor}))},toggleSnapToGrid:()=>{e(r=>({snapToGrid:!r.snapToGrid}))},setGridSize:r=>{e({gridSize_mm:r})},toggleStandaloneMode:()=>{e(r=>({standaloneMode:!r.standaloneMode}))},setStandaloneMode:(r,n=null)=>{e({standaloneMode:r,standaloneDesignId:n})},setSaving:r=>{e({isSaving:r})},setLastSaved:r=>{e({lastSaved:r})},loadDesign:r=>{let n=r.elementOrder;!n&&(r.courtOrder||r.trackOrder)&&(n=[...r.trackOrder||[],...r.courtOrder||[]]),e({surface:r.surface||xu.surface,courts:r.courts||{},tracks:r.tracks||{},motifs:r.motifs||{},shapes:r.shapes||{},texts:r.texts||{},elementOrder:n||[],customMarkings:r.customMarkings||[],backgroundZones:r.backgroundZones||[],designName:r.name||"Untitled Design",designDescription:r.description||"",designTags:r.tags||[],selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,selectedShapeId:null,selectedTextId:null,editingTextId:null,history:[],historyIndex:-1}),t().addToHistory()},exportDesignData:()=>{const r=t();return{surface:r.surface,courts:r.courts,tracks:r.tracks,motifs:r.motifs,shapes:r.shapes,texts:r.texts,elementOrder:r.elementOrder,customMarkings:r.customMarkings,backgroundZones:r.backgroundZones,name:r.designName,description:r.designDescription,tags:r.designTags}},resetDesign:()=>{e(xu)},hasUnsavedChanges:()=>{const r=t();return Object.keys(r.courts).length>0||Object.keys(r.tracks).length>0||Object.keys(r.motifs).length>0||Object.keys(r.shapes).length>0||Object.keys(r.texts).length>0}}),{name:"SportsDesignStore"})),Xg={inputMode:"prompt",prompt:"",lengthMM:5e3,widthMM:5e3,selectedFileName:null,uploadedFileUrl:null,arMapping:null,result:null,jobId:null,blendRecipes:null,blendSvgUrl:null,colorMapping:null,blendEditedColors:new Map,solidRecipes:null,solidSvgUrl:null,solidColorMapping:null,solidEditedColors:new Map,viewMode:"solid",showFinalRecipes:!1,showSolidSummary:!1,regionOverrides:new Map,originalTaggedSvg:null,regionOverridesHistory:[new Map],historyIndex:0,designName:"",currentDesignId:null,hasGeneratedContent:!1,lastModified:null},Hc=fw(pw((e,t)=>({...Xg,setInputMode:r=>e({inputMode:r}),setPrompt:r=>e({prompt:r,lastModified:Date.now()}),setDimensions:(r,n)=>e({widthMM:r,lengthMM:n,lastModified:Date.now()}),setArMapping:r=>e({arMapping:r}),setSelectedFile:(r,n)=>e({selectedFileName:r,uploadedFileUrl:n,lastModified:Date.now()}),clearSelectedFile:()=>e({selectedFileName:null,uploadedFileUrl:null}),setGenerationResult:(r,n)=>e({result:r,jobId:n,hasGeneratedContent:!0,lastModified:Date.now()}),setResult:r=>e({result:r,hasGeneratedContent:!!r,lastModified:Date.now()}),setJobId:r=>e({jobId:r}),setBlendState:(r,n,i)=>e({blendRecipes:r,colorMapping:n,blendSvgUrl:i,lastModified:Date.now()}),setBlendRecipes:r=>e({blendRecipes:r,lastModified:Date.now()}),setColorMapping:r=>e({colorMapping:r,lastModified:Date.now()}),setBlendSvgUrl:r=>e({blendSvgUrl:r}),setBlendEditedColors:r=>e({blendEditedColors:r,lastModified:Date.now()}),updateBlendSvgUrl:r=>e({blendSvgUrl:r}),setSolidState:(r,n,i)=>e({solidRecipes:r,solidColorMapping:n,solidSvgUrl:i,lastModified:Date.now()}),setSolidRecipes:r=>e({solidRecipes:r,lastModified:Date.now()}),setSolidColorMapping:r=>e({solidColorMapping:r,lastModified:Date.now()}),setSolidSvgUrl:r=>e({solidSvgUrl:r}),setSolidEditedColors:r=>e({solidEditedColors:r,lastModified:Date.now()}),updateSolidSvgUrl:r=>e({solidSvgUrl:r}),setViewMode:r=>{if(r==="blend"){console.log("[STORE] Blend mode disabled - forcing solid mode");return}e({viewMode:r})},setShowFinalRecipes:r=>e({showFinalRecipes:r}),setShowSolidSummary:r=>e({showSolidSummary:r}),setOriginalTaggedSvg:r=>e({originalTaggedSvg:r}),setRegionOverrides:r=>e({regionOverrides:r,lastModified:Date.now()}),addRegionOverride:(r,n)=>{const i=new Map(t().regionOverrides),s=typeof n=="string"?{hex:n}:n;i.set(r,s);const a=t().regionOverridesHistory,l=t().historyIndex,c=a.slice(0,l+1);c.push(new Map(i)),c.length>50&&c.shift(),e({regionOverrides:i,regionOverridesHistory:c,historyIndex:c.length-1,lastModified:Date.now()})},setRegionOverridesHistory:r=>{e(typeof r=="function"?{regionOverridesHistory:r(t().regionOverridesHistory)}:{regionOverridesHistory:r})},setHistoryIndex:r=>{e(typeof r=="function"?{historyIndex:r(t().historyIndex)}:{historyIndex:r})},canUndo:()=>t().historyIndex>0,canRedo:()=>t().historyIndex<t().regionOverridesHistory.length-1,undo:()=>{const{historyIndex:r,regionOverridesHistory:n}=t();if(r>0){const i=r-1;e({historyIndex:i,regionOverrides:new Map(n[i])})}},redo:()=>{const{historyIndex:r,regionOverridesHistory:n}=t();if(r<n.length-1){const i=r+1;e({historyIndex:i,regionOverrides:new Map(n[i])})}},setRegionOverridesHistory:(r,n)=>e({regionOverridesHistory:r,historyIndex:n}),setDesignName:r=>e({designName:r}),setCurrentDesignId:r=>e({currentDesignId:r}),loadDesign:r=>{const n=r.regionOverrides||new Map,i=n.size>0?[new Map,new Map(n)]:[new Map],s=n.size>0?1:0;e({inputMode:r.inputMode||"prompt",prompt:r.prompt||"",lengthMM:r.lengthMM||5e3,widthMM:r.widthMM||5e3,uploadedFileUrl:r.selectedFile||null,result:r.result||null,blendRecipes:r.blendRecipes||null,solidRecipes:r.solidRecipes||null,colorMapping:r.colorMapping||null,solidColorMapping:r.solidColorMapping||null,solidEditedColors:r.solidEditedColors||new Map,blendEditedColors:r.blendEditedColors||new Map,blendSvgUrl:r.blendSvgUrl||null,solidSvgUrl:r.solidSvgUrl||null,viewMode:"solid",arMapping:r.arMapping||null,jobId:r.jobId||null,showFinalRecipes:r.showFinalRecipes||!1,showSolidSummary:r.showSolidSummary||!1,hasGeneratedContent:!!r.result,regionOverrides:n,originalTaggedSvg:r.originalTaggedSvg||null,regionOverridesHistory:i,historyIndex:s,lastModified:Date.now()})},exportDesignData:()=>{const r=t();return{inputMode:r.inputMode,prompt:r.prompt,lengthMM:r.lengthMM,widthMM:r.widthMM,uploadedFileUrl:r.uploadedFileUrl,result:r.result,blendRecipes:r.blendRecipes,solidRecipes:r.solidRecipes,colorMapping:r.colorMapping,solidColorMapping:r.solidColorMapping,solidEditedColors:r.solidEditedColors,blendEditedColors:r.blendEditedColors,viewMode:r.viewMode,arMapping:r.arMapping,jobId:r.jobId,showFinalRecipes:r.showFinalRecipes,showSolidSummary:r.showSolidSummary,regionOverrides:r.regionOverrides,designName:r.designName,currentDesignId:r.currentDesignId}},resetDesign:()=>{const{blendSvgUrl:r,solidSvgUrl:n}=t();r&&r.startsWith("blob:")&&URL.revokeObjectURL(r),n&&n.startsWith("blob:")&&URL.revokeObjectURL(n),e({...Xg,blendEditedColors:new Map,solidEditedColors:new Map,regionOverrides:new Map,regionOverridesHistory:[new Map]})},hasUnsavedChanges:()=>{const r=t();return r.hasGeneratedContent||r.prompt.trim()!==""||r.selectedFileName!==null}}),{name:"PlaygroundDesignStore"})),vw={"basketball-full":{id:"basketball-full",name:"Basketball (Full Court)",sport:"basketball",standard:"FIBA 2020",category:"court",description:"Official FIBA standard full basketball court with all markings",dimensions:{length_mm:28e3,width_mm:15e3,min_surround_mm:2e3},defaultSurfaceColor:"RH20",defaultLineColor:"RH31",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:15e3,height:28e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"center-line",name:"Center Line",type:"line",params:{x1:0,y1:14e3,x2:15e3,y2:14e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-circle",name:"Center Circle",type:"circle",params:{cx:7500,cy:14e3,radius:1800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"three-point-arc-top",name:"Three-Point Arc (Top)",type:"arc",params:{cx:7500,cy:26425,radius:6750,startAngle:192,endAngle:348},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"three-point-arc-bottom",name:"Three-Point Arc (Bottom)",type:"arc",params:{cx:7500,cy:1575,radius:6750,startAngle:12,endAngle:168},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"three-point-line-bottom-left",name:"Three-Point Line Bottom Left",type:"line",params:{x1:900,y1:0,x2:900,y2:2990},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"three-point-line-bottom-right",name:"Three-Point Line Bottom Right",type:"line",params:{x1:14100,y1:0,x2:14100,y2:2990},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"three-point-line-top-left",name:"Three-Point Line Top Left",type:"line",params:{x1:900,y1:25010,x2:900,y2:28e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"three-point-line-top-right",name:"Three-Point Line Top Right",type:"line",params:{x1:14100,y1:25010,x2:14100,y2:28e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"free-throw-line-top",name:"Free Throw Line (Top)",type:"line",params:{x1:5050,y1:22200,x2:9950,y2:22200},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"free-throw-line-bottom",name:"Free Throw Line (Bottom)",type:"line",params:{x1:5050,y1:5800,x2:9950,y2:5800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"free-throw-circle-top",name:"Free Throw Circle (Top)",type:"circle",params:{cx:7500,cy:22200,radius:1800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"free-throw-circle-bottom",name:"Free Throw Circle (Bottom)",type:"circle",params:{cx:7500,cy:5800,radius:1800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"key-lane-top",name:"Key Lane (Top)",type:"rectangle",params:{x:5050,y:22200,width:4900,height:5800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"key-lane-bottom",name:"Key Lane (Bottom)",type:"rectangle",params:{x:5050,y:0,width:4900,height:5800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"restricted-area-top",name:"Restricted Area (Top)",type:"arc",params:{cx:7500,cy:28e3,radius:1250,startAngle:180,endAngle:360},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"restricted-area-bottom",name:"Restricted Area (Bottom)",type:"arc",params:{cx:7500,cy:0,radius:1250,startAngle:0,endAngle:180},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[{id:"key-area-top",name:"Key Area (Top)",type:"rectangle",params:{x:5050,y:22200,width:4900,height:5800},defaultColor:"RH20",paintable:!0,area_m2:28.42},{id:"key-area-bottom",name:"Key Area (Bottom)",type:"rectangle",params:{x:5050,y:0,width:4900,height:5800},defaultColor:"RH20",paintable:!0,area_m2:28.42}]},"netball-full":{id:"netball-full",name:"Netball (Full Court)",sport:"netball",standard:"World Netball 2020",category:"court",description:"Official World Netball standard court with goal circles and thirds",dimensions:{length_mm:30500,width_mm:15250,min_surround_mm:3050},defaultSurfaceColor:"RH01",defaultLineColor:"RH31",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:15250,height:30500},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"transverse-line-1",name:"Transverse Line 1",type:"line",params:{x1:0,y1:10167,x2:15250,y2:10167},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"transverse-line-2",name:"Transverse Line 2",type:"line",params:{x1:0,y1:20333,x2:15250,y2:20333},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-circle",name:"Center Circle",type:"circle",params:{cx:7625,cy:15250,radius:450},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"goal-circle-bottom",name:"Goal Circle (Bottom)",type:"arc",params:{cx:7625,cy:0,radius:4900,startAngle:0,endAngle:180},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"goal-circle-top",name:"Goal Circle (Top)",type:"arc",params:{cx:7625,cy:30500,radius:4900,startAngle:180,endAngle:360},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"tennis-doubles":{id:"tennis-doubles",name:"Tennis (Doubles)",sport:"tennis",standard:"ITF 2020",category:"court",description:"Official ITF standard doubles tennis court with all service boxes",dimensions:{length_mm:23770,width_mm:10970,min_surround_mm:3660},defaultSurfaceColor:"RH22",defaultLineColor:"RH29",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:10970,height:23770},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"singles-sideline-left",name:"Singles Sideline (Left)",type:"line",params:{x1:1370,y1:0,x2:1370,y2:23770},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"singles-sideline-right",name:"Singles Sideline (Right)",type:"line",params:{x1:9600,y1:0,x2:9600,y2:23770},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"service-line-bottom",name:"Service Line (Bottom)",type:"line",params:{x1:0,y1:6400,x2:10970,y2:6400},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"service-line-top",name:"Service Line (Top)",type:"line",params:{x1:0,y1:17370,x2:10970,y2:17370},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-service-line",name:"Center Service Line",type:"line",params:{x1:5485,y1:6400,x2:5485,y2:17370},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-mark-bottom",name:"Center Mark (Bottom)",type:"line",params:{x1:5485,y1:0,x2:5485,y2:100},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-mark-top",name:"Center Mark (Top)",type:"line",params:{x1:5485,y1:23670,x2:5485,y2:23770},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"futsal-standard":{id:"futsal-standard",name:"Futsal (5-a-side)",sport:"futsal",standard:"FIFA 2020",category:"court",description:"Official FIFA standard futsal court for international matches",dimensions:{length_mm:4e4,width_mm:2e4,min_surround_mm:1e3},defaultSurfaceColor:"RH50",defaultLineColor:"RH30",defaultLineWidth_mm:80,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:2e4,height:4e4},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"boundary"},{id:"center-line",name:"Center Line",type:"line",params:{x1:0,y1:2e4,x2:2e4,y2:2e4},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"center-circle",name:"Center Circle",type:"circle",params:{cx:1e4,cy:2e4,radius:3e3},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"center-spot",name:"Center Spot",type:"circle",params:{cx:1e4,cy:2e4,radius:100},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"penalty-area-bottom",name:"Penalty Area (Bottom)",type:"arc",params:{cx:1e4,cy:0,radius:6e3,startAngle:0,endAngle:180},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"penalty-area-top",name:"Penalty Area (Top)",type:"arc",params:{cx:1e4,cy:4e4,radius:6e3,startAngle:180,endAngle:360},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"penalty-mark-bottom",name:"Penalty Mark (Bottom)",type:"circle",params:{cx:1e4,cy:6e3,radius:100},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"penalty-mark-top",name:"Penalty Mark (Top)",type:"circle",params:{cx:1e4,cy:34e3,radius:100},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"second-penalty-mark-bottom",name:"Second Penalty Mark (Bottom)",type:"circle",params:{cx:1e4,cy:1e4,radius:100},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"second-penalty-mark-top",name:"Second Penalty Mark (Top)",type:"circle",params:{cx:1e4,cy:3e4,radius:100},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"corner-arc-bl",name:"Corner Arc (Bottom Left)",type:"arc",params:{cx:0,cy:0,radius:250,startAngle:0,endAngle:90},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"corner-arc-br",name:"Corner Arc (Bottom Right)",type:"arc",params:{cx:2e4,cy:0,radius:250,startAngle:90,endAngle:180},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"corner-arc-tl",name:"Corner Arc (Top Left)",type:"arc",params:{cx:0,cy:4e4,radius:250,startAngle:270,endAngle:360},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"corner-arc-tr",name:"Corner Arc (Top Right)",type:"arc",params:{cx:2e4,cy:4e4,radius:250,startAngle:180,endAngle:270},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"}],zones:[]},"volleyball-indoor":{id:"volleyball-indoor",name:"Volleyball (Indoor)",sport:"volleyball",standard:"FIVB",category:"court",description:"Official FIVB standard indoor volleyball court with attack lines",dimensions:{length_mm:18e3,width_mm:9e3,min_surround_mm:3e3},defaultSurfaceColor:"RH40",defaultLineColor:"RH29",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:9e3,height:18e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"center-line",name:"Center Line",type:"line",params:{x1:0,y1:9e3,x2:9e3,y2:9e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"attack-line-bottom",name:"Attack Line (Bottom)",type:"line",params:{x1:0,y1:6e3,x2:9e3,y2:6e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"attack-line-top",name:"Attack Line (Top)",type:"line",params:{x1:0,y1:12e3,x2:9e3,y2:12e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"badminton-full":{id:"badminton-full",name:"Badminton (Full Court)",sport:"badminton",standard:"BWF",category:"court",description:"Official BWF standard full badminton court with singles and doubles lines",dimensions:{length_mm:13400,width_mm:6100,min_surround_mm:1e3},defaultSurfaceColor:"RH26",defaultLineColor:"RH12",defaultLineWidth_mm:40,markings:[{id:"boundary",name:"Boundary Lines (Doubles)",type:"rectangle",params:{x:0,y:0,width:6100,height:13400},defaultColor:"RH31",lineWidth_mm:40,required:!0,category:"boundary"},{id:"singles-sideline-left",name:"Singles Sideline (Left)",type:"line",params:{x1:460,y1:0,x2:460,y2:13400},defaultColor:"RH31",lineWidth_mm:40,required:!0,category:"court-marking"},{id:"singles-sideline-right",name:"Singles Sideline (Right)",type:"line",params:{x1:5640,y1:0,x2:5640,y2:13400},defaultColor:"RH31",lineWidth_mm:40,required:!0,category:"court-marking"},{id:"short-service-line-bottom",name:"Short Service Line (Bottom)",type:"line",params:{x1:0,y1:1980,x2:6100,y2:1980},defaultColor:"RH31",lineWidth_mm:40,required:!0,category:"court-marking"},{id:"short-service-line-top",name:"Short Service Line (Top)",type:"line",params:{x1:0,y1:11420,x2:6100,y2:11420},defaultColor:"RH31",lineWidth_mm:40,required:!0,category:"court-marking"},{id:"doubles-long-service-line-bottom",name:"Doubles Long Service Line (Bottom)",type:"line",params:{x1:0,y1:760,x2:6100,y2:760},defaultColor:"RH31",lineWidth_mm:40,required:!0,category:"court-marking"},{id:"doubles-long-service-line-top",name:"Doubles Long Service Line (Top)",type:"line",params:{x1:0,y1:12640,x2:6100,y2:12640},defaultColor:"RH31",lineWidth_mm:40,required:!0,category:"court-marking"},{id:"center-service-line",name:"Center Service Line",type:"line",params:{x1:3050,y1:1980,x2:3050,y2:11420},defaultColor:"RH31",lineWidth_mm:40,required:!0,category:"court-marking"}],zones:[]},"pickleball-standard":{id:"pickleball-standard",name:"Pickleball",sport:"pickleball",standard:"USA Pickleball",category:"court",description:"Official USA Pickleball standard court with non-volley zone (kitchen)",dimensions:{length_mm:13410,width_mm:6100,min_surround_mm:1e3},defaultSurfaceColor:"RH11",defaultLineColor:"RH31",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:6100,height:13410},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"non-volley-zone-line-bottom",name:"Non-Volley Zone Line (Bottom)",type:"line",params:{x1:0,y1:2130,x2:6100,y2:2130},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"non-volley-zone-line-top",name:"Non-Volley Zone Line (Top)",type:"line",params:{x1:0,y1:11280,x2:6100,y2:11280},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-line",name:"Center Line (Net)",type:"line",params:{x1:0,y1:6705,x2:6100,y2:6705},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-service-line",name:"Center Service Line",type:"line",params:{x1:3050,y1:0,x2:3050,y2:13410},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"basketball-half":{id:"basketball-half",name:"Basketball (Half Court / 3x3)",sport:"basketball",standard:"FIBA 3x3",category:"court",description:"Half-court basketball for 3x3 games, practice, or space-constrained areas",dimensions:{length_mm:11e3,width_mm:15e3,min_surround_mm:2e3},defaultSurfaceColor:"RH20",defaultLineColor:"RH31",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:15e3,height:11e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"three-point-arc",name:"Three-Point Arc",type:"arc",params:{cx:7500,cy:1575,radius:6750,startAngle:12,endAngle:168},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"three-point-line-left",name:"Three-Point Line (Left)",type:"line",params:{x1:900,y1:0,x2:900,y2:2990},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"three-point-line-right",name:"Three-Point Line (Right)",type:"line",params:{x1:14100,y1:0,x2:14100,y2:2990},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"free-throw-line",name:"Free Throw Line",type:"line",params:{x1:5050,y1:5800,x2:9950,y2:5800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"free-throw-circle",name:"Free Throw Circle",type:"circle",params:{cx:7500,cy:5800,radius:1800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"key-lane",name:"Key Lane",type:"rectangle",params:{x:5050,y:0,width:4900,height:5800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"restricted-area",name:"Restricted Area",type:"arc",params:{cx:7500,cy:0,radius:1250,startAngle:0,endAngle:180},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[{id:"key-area",name:"Key Area",type:"rectangle",params:{x:5050,y:0,width:4900,height:5800},defaultColor:"RH20",paintable:!0,area_m2:28.42}]},"tennis-singles":{id:"tennis-singles",name:"Tennis (Singles)",sport:"tennis",standard:"ITF",category:"court",description:"Singles-only tennis court without doubles alleys",dimensions:{length_mm:23770,width_mm:8230,min_surround_mm:3660},defaultSurfaceColor:"RH22",defaultLineColor:"RH29",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:8230,height:23770},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"service-line-bottom",name:"Service Line (Bottom)",type:"line",params:{x1:0,y1:6400,x2:8230,y2:6400},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"service-line-top",name:"Service Line (Top)",type:"line",params:{x1:0,y1:17370,x2:8230,y2:17370},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-service-line",name:"Center Service Line",type:"line",params:{x1:4115,y1:6400,x2:4115,y2:17370},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-mark-bottom",name:"Center Mark (Bottom)",type:"line",params:{x1:4115,y1:0,x2:4115,y2:100},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-mark-top",name:"Center Mark (Top)",type:"line",params:{x1:4115,y1:23670,x2:4115,y2:23770},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"mini-tennis-red":{id:"mini-tennis-red",name:"Mini Tennis (Red Court)",sport:"tennis",standard:"ITF Play+Stay",category:"court",description:"Beginner/youth court for red stage tennis coaching (36ft)",dimensions:{length_mm:10970,width_mm:5490,min_surround_mm:2e3},defaultSurfaceColor:"RH02",defaultLineColor:"RH29",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:5490,height:10970},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"net-line",name:"Net Line",type:"line",params:{x1:0,y1:5485,x2:5490,y2:5485},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"service-line-bottom",name:"Service Line (Bottom)",type:"line",params:{x1:0,y1:2745,x2:5490,y2:2745},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"service-line-top",name:"Service Line (Top)",type:"line",params:{x1:0,y1:8225,x2:5490,y2:8225},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-service-line",name:"Center Service Line",type:"line",params:{x1:2745,y1:2745,x2:2745,y2:8225},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"padel-standard":{id:"padel-standard",name:"Padel",sport:"padel",standard:"FIP",category:"court",description:"Official FIP padel court with service boxes",dimensions:{length_mm:2e4,width_mm:1e4,min_surround_mm:0},defaultSurfaceColor:"RH60",defaultLineColor:"RH29",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:1e4,height:2e4},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"net-line",name:"Net Line",type:"line",params:{x1:0,y1:1e4,x2:1e4,y2:1e4},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"service-line-bottom",name:"Service Line (Bottom)",type:"line",params:{x1:0,y1:3e3,x2:1e4,y2:3e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"service-line-top",name:"Service Line (Top)",type:"line",params:{x1:0,y1:17e3,x2:1e4,y2:17e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-service-line-bottom",name:"Center Service Line (Bottom)",type:"line",params:{x1:5e3,y1:0,x2:5e3,y2:3e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-service-line-top",name:"Center Service Line (Top)",type:"line",params:{x1:5e3,y1:17e3,x2:5e3,y2:2e4},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-line",name:"Center Line",type:"line",params:{x1:5e3,y1:3e3,x2:5e3,y2:17e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"handball-standard":{id:"handball-standard",name:"Handball",sport:"handball",standard:"IHF",category:"court",description:"Official IHF handball court with goal areas and penalty lines",dimensions:{length_mm:4e4,width_mm:2e4,min_surround_mm:1e3},defaultSurfaceColor:"RH10",defaultLineColor:"RH31",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:2e4,height:4e4},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"center-line",name:"Center Line",type:"line",params:{x1:0,y1:2e4,x2:2e4,y2:2e4},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"goal-area-bottom",name:"Goal Area (Bottom)",type:"arc",params:{cx:1e4,cy:0,radius:6e3,startAngle:0,endAngle:180},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"goal-area-top",name:"Goal Area (Top)",type:"arc",params:{cx:1e4,cy:4e4,radius:6e3,startAngle:180,endAngle:360},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"free-throw-line-bottom",name:"Free-Throw Line (Bottom)",type:"arc",params:{cx:1e4,cy:0,radius:9e3,startAngle:0,endAngle:180,dashed:!0,dashPattern:"300 150"},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"free-throw-line-top",name:"Free-Throw Line (Top)",type:"arc",params:{cx:1e4,cy:4e4,radius:9e3,startAngle:180,endAngle:360,dashed:!0,dashPattern:"300 150"},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"7m-line-bottom",name:"7m Penalty Line (Bottom)",type:"line",params:{x1:9e3,y1:7e3,x2:11e3,y2:7e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"7m-line-top",name:"7m Penalty Line (Top)",type:"line",params:{x1:9e3,y1:33e3,x2:11e3,y2:33e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"goalkeeper-line-bottom",name:"Goalkeeper Restriction Line (Bottom)",type:"line",params:{x1:9500,y1:4e3,x2:10500,y2:4e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"goalkeeper-line-top",name:"Goalkeeper Restriction Line (Top)",type:"line",params:{x1:9500,y1:36e3,x2:10500,y2:36e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"hockey-d":{id:"hockey-d",name:"Field Hockey D",sport:"hockey",standard:"FIH",category:"overlay",description:"Hockey shooting circle (D) for overlay on sports surfaces",dimensions:{length_mm:14630,width_mm:29260,min_surround_mm:0},defaultSurfaceColor:"RH23",defaultLineColor:"RH29",defaultLineWidth_mm:50,markings:[{id:"shooting-circle",name:"Shooting Circle (D)",type:"arc",params:{cx:14630,cy:0,radius:14630,startAngle:0,endAngle:180},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"goal-line",name:"Goal Line",type:"line",params:{x1:0,y1:0,x2:29260,y2:0},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"penalty-spot",name:"Penalty Spot",type:"circle",params:{cx:14630,cy:6400,radius:150},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"hockey-5s":{id:"hockey-5s",name:"Hockey 5s",sport:"hockey",standard:"England Hockey",category:"court",description:"Scaled-down hockey pitch for 5-a-side games",dimensions:{length_mm:55e3,width_mm:41100,min_surround_mm:2e3},defaultSurfaceColor:"RH23",defaultLineColor:"RH29",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:41100,height:55e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"center-line",name:"Center Line",type:"line",params:{x1:0,y1:27500,x2:41100,y2:27500},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-spot",name:"Center Spot",type:"circle",params:{cx:20550,cy:27500,radius:150},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"shooting-circle-bottom",name:"Shooting Circle (Bottom)",type:"arc",params:{cx:20550,cy:0,radius:9e3,startAngle:0,endAngle:180},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"shooting-circle-top",name:"Shooting Circle (Top)",type:"arc",params:{cx:20550,cy:55e3,radius:9e3,startAngle:180,endAngle:360},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"penalty-spot-bottom",name:"Penalty Spot (Bottom)",type:"circle",params:{cx:20550,cy:6400,radius:150},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"penalty-spot-top",name:"Penalty Spot (Top)",type:"circle",params:{cx:20550,cy:48600,radius:150},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]}},cr=[{code:"RH01",name:"Standard Red",hex:"#A5362F",R:165,G:54,B:47,L:39.4,a:58.5,b:29},{code:"RH02",name:"Bright Red",hex:"#E21F2F",R:226,G:31,B:47,L:47.4,a:70.1,b:44},{code:"RH10",name:"Standard Green",hex:"#609B63",R:96,G:155,B:99,L:40.5,a:-42.2,b:17.9},{code:"RH11",name:"Bright Green",hex:"#3BB44A",R:59,G:180,B:74,L:62.1,a:-47.7,b:47.2},{code:"RH12",name:"Dark Green",hex:"#006C55",R:0,G:108,B:85,L:39.6,a:-38.3,b:13.1},{code:"RH20",name:"Standard Blue",hex:"#0075BC",R:0,G:117,B:188,L:36.4,a:14.2,b:-46.7},{code:"RH21",name:"Purple",hex:"#493D8C",R:73,G:61,B:140,L:31.5,a:41.9,b:-40.9},{code:"RH22",name:"Light Blue",hex:"#47AFE3",R:71,G:175,B:227,L:55.3,a:-19.1,b:-37.3},{code:"RH23",name:"Azure",hex:"#039DC4",R:3,G:157,B:196,L:47.7,a:-4.8,b:-34.8},{code:"RH26",name:"Turquoise",hex:"#00A6A3",R:0,G:166,B:163,L:58.8,a:-38.4,b:-3},{code:"RH30",name:"Standard Beige",hex:"#E4C4AA",R:228,G:196,B:170,L:75.2,a:3.8,b:24.8},{code:"RH31",name:"Cream",hex:"#E8E3D8",R:232,G:227,B:216,L:91.8,a:-.5,b:12.5},{code:"RH32",name:"Brown",hex:"#8B5F3C",R:139,G:95,B:60,L:40,a:15.9,b:27.1},{code:"RH90",name:"Funky Pink",hex:"#E8457E",R:232,G:69,B:126,L:55,a:66.1,b:4.9},{code:"RH40",name:"Mustard Yellow",hex:"#E5A144",R:229,G:161,B:68,L:66,a:8.4,b:56.3},{code:"RH41",name:"Bright Yellow",hex:"#FFD833",R:255,G:216,B:51,L:86.9,a:-1,b:90.6},{code:"RH50",name:"Orange",hex:"#F15B32",R:241,G:91,B:50,L:63.2,a:49.8,b:60.2},{code:"RH60",name:"Dark Grey",hex:"#59595B",R:89,G:89,B:91,L:34.1,a:-.4,b:-2.4},{code:"RH61",name:"Light Grey",hex:"#939598",R:147,G:149,B:152,L:69,a:-.5,b:-1},{code:"RH65",name:"Pale Grey",hex:"#D9D9D6",R:217,G:217,B:214,L:87.6,a:-.2,b:-.7},{code:"RH70",name:"Black",hex:"#231F20",R:35,G:31,B:32,L:9.1,a:-.3,b:-6.3}];function mC(){return Object.values(vw)}function gC(e){return vw[e]||null}function vC(e,t,r){const{type:n,params:i}=e;switch(n){case"line":return xC(i,t,r);case"rectangle":return bC(i,t,r);case"circle":return wC(i,t,r);case"arc":return _C(i,t,r);case"polyline":return SC(i,t,r);default:return console.warn(`Unknown marking type: ${n}`),null}}function yC(e,t){const{type:r,params:n}=e;switch(r){case"rectangle":return{type:"rect",x:n.x,y:n.y,width:n.width,height:n.height,fill:t};case"circle":return{type:"circle",cx:n.cx,cy:n.cy,r:n.radius,fill:t};case"polygon":return{type:"polygon",points:n.points,fill:t};default:return console.warn(`Unknown zone type: ${r}`),null}}function xC(e,t,r){const n={type:"line",x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,stroke:t,strokeWidth:r};return e.dashed&&(n.strokeDasharray=e.dashPattern||"200 100"),n}function bC(e,t,r){return{type:"rect",x:e.x,y:e.y,width:e.width,height:e.height,stroke:t,strokeWidth:r,fill:"none"}}function wC(e,t,r){return{type:"circle",cx:e.cx,cy:e.cy,r:e.radius,stroke:t,strokeWidth:r,fill:"none"}}function _C(e,t,r){const{cx:n,cy:i,radius:s,startAngle:a,endAngle:l}=e,c=a*Math.PI/180,d=l*Math.PI/180,u=n+s*Math.cos(c),f=i+s*Math.sin(c),h=n+s*Math.cos(d),p=i+s*Math.sin(d),g=l-a>180?1:0,x={type:"path",d:`M ${u} ${f} A ${s} ${s} 0 ${g} 1 ${h} ${p}`,stroke:t,strokeWidth:r,fill:"none"};return e.dashed&&(x.strokeDasharray=e.dashPattern||"200 100"),x}function SC(e,t,r){return{type:"polyline",points:e.points.map(i=>`${i[0]},${i[1]}`).join(" "),stroke:t,strokeWidth:r,fill:"none"}}function Kg(e){if(e&&e.startsWith("#"))return e;const t=cr.find(r=>r.code===e);return t?t.hex:"#000000"}function kC(e){var a;const{template:t,lineColorOverrides:r,zoneColorOverrides:n}=e;if(!t)return console.error("No template provided for court"),{markings:[],zones:[]};const i=t.markings.map(l=>{var f;const c=((f=r[l.id])==null?void 0:f.hex)||t.defaultLineColor,d=Kg(c),u=l.lineWidth_mm||t.defaultLineWidth_mm;return{id:l.id,name:l.name,...vC(l,d,u)}}).filter(Boolean),s=((a=t.zones)==null?void 0:a.map(l=>{var u;const c=((u=n[l.id])==null?void 0:u.hex)||l.defaultColor,d=Kg(c);return{id:l.id,name:l.name,...yC(l,d)}}).filter(Boolean))||[];return{markings:i,zones:s}}function Zg(e,t){return Math.round(e/t)*t}function jC(e,t){return{x:Zg(e.x,t),y:Zg(e.y,t)}}function yw(e){let t=e%360;return t<0&&(t+=360),t}function bu(e,t,r){const{width_mm:n,length_mm:i}=t,{width_mm:s,length_mm:a}=r,l=500,c=-(n-l),d=s-l,u=-(i-l),f=a-l;return{x:Math.max(c,Math.min(e.x,d)),y:Math.max(u,Math.min(e.y,f))}}function CC(e){const{position:t,rotation:r,scale:n,template:i}=e,s=i.dimensions.width_mm/2,a=i.dimensions.length_mm/2;return`translate(${t.x}, ${t.y}) scale(${n}) rotate(${r}, ${s}, ${a})`}function EC({court:e,svgRef:t}){const{updateCourtRotation:r,updateCourtScale:n,updateCourtPosition:i,addToHistory:s}=tt(),[a,l]=A.useState(!1),[c,d]=A.useState(!1),[u,f]=A.useState(null),[h,p]=A.useState(null),{template:g,position:m,rotation:x,scale:v}=e,y=g.dimensions.width_mm*v,b=g.dimensions.length_mm*v,w=m.x+g.dimensions.width_mm*v/2,j=m.y+g.dimensions.length_mm*v/2,_=g.dimensions.width_mm/2,E=-1e3,N=(S,K)=>{if(!t.current)return{x:0,y:0};const fe=t.current.createSVGPoint();fe.x=S,fe.y=K;const U=fe.matrixTransform(t.current.getScreenCTM().inverse());return{x:U.x,y:U.y}},O=S=>{S.stopPropagation(),l(!0),p({x:S.clientX,y:S.clientY})},I=(S,K)=>{S.stopPropagation(),d(!0),f(K),p({x:S.clientX,y:S.clientY,initialScale:v,initialWidth:y,initialHeight:b,initialPosition:{...m}})};A.useEffect(()=>{if(!a&&!c)return;const S=fe=>{if(a){const U=N(fe.clientX,fe.clientY),z=U.x-w,H=U.y-j;let Q=Math.atan2(H,z)*(180/Math.PI)+90;Q=yw(Q),fe.shiftKey&&(Q=Math.round(Q/15)*15),r(e.id,Q)}else if(c&&h){const U=N(fe.clientX,fe.clientY),z=N(h.x,h.y),H=U.x-z.x,Q=U.y-z.y;let W=h.initialScale,q={...m};switch(u){case"se":W=Math.max(.3,h.initialScale+H/g.dimensions.width_mm);break;case"nw":W=Math.max(.3,h.initialScale-H/g.dimensions.width_mm),q.x=h.initialPosition.x+(h.initialWidth-g.dimensions.width_mm*W),q.y=h.initialPosition.y+(h.initialHeight-g.dimensions.length_mm*W);break;case"ne":W=Math.max(.3,h.initialScale+H/g.dimensions.width_mm),q.y=h.initialPosition.y+(h.initialHeight-g.dimensions.length_mm*W);break;case"sw":W=Math.max(.3,h.initialScale-H/g.dimensions.width_mm),q.x=h.initialPosition.x+(h.initialWidth-g.dimensions.width_mm*W);break;case"e":W=Math.max(.3,h.initialScale+H/g.dimensions.width_mm);break;case"w":W=Math.max(.3,h.initialScale-H/g.dimensions.width_mm),q.x=h.initialPosition.x+(h.initialWidth-g.dimensions.width_mm*W);break;case"n":W=Math.max(.3,h.initialScale-Q/g.dimensions.length_mm),q.y=h.initialPosition.y+(h.initialHeight-g.dimensions.length_mm*W);break;case"s":W=Math.max(.3,h.initialScale+Q/g.dimensions.length_mm);break}W=Math.min(3,Math.max(.3,W)),n(e.id,W),(q.x!==m.x||q.y!==m.y)&&i(e.id,q)}},K=()=>{(a||c)&&s(),l(!1),d(!1),f(null),p(null)};return window.addEventListener("mousemove",S),window.addEventListener("mouseup",K),()=>{window.removeEventListener("mousemove",S),window.removeEventListener("mouseup",K)}},[a,c,h,w,j,e.id,m,v,u]);const te=[{type:"nw",x:0,y:0,cursor:"nwse-resize"},{type:"n",x:g.dimensions.width_mm/2,y:0,cursor:"ns-resize"},{type:"ne",x:g.dimensions.width_mm,y:0,cursor:"nesw-resize"},{type:"e",x:g.dimensions.width_mm,y:g.dimensions.length_mm/2,cursor:"ew-resize"},{type:"se",x:g.dimensions.width_mm,y:g.dimensions.length_mm,cursor:"nwse-resize"},{type:"s",x:g.dimensions.width_mm/2,y:g.dimensions.length_mm,cursor:"ns-resize"},{type:"sw",x:0,y:g.dimensions.length_mm,cursor:"nesw-resize"},{type:"w",x:0,y:g.dimensions.length_mm/2,cursor:"ew-resize"}],T=300,V=250;return o.jsxs("g",{className:"transform-handles",children:[o.jsxs("g",{className:"rotation-handle",onMouseDown:O,style:{cursor:a?"grabbing":"grab"},children:[o.jsx("line",{x1:_,y1:0,x2:_,y2:E+V,stroke:"#007bff",strokeWidth:30,strokeDasharray:"100 50"}),o.jsx("circle",{cx:_,cy:E,r:V,fill:"white",stroke:"#007bff",strokeWidth:40}),o.jsx("path",{d:`M ${_-V*.4} ${E}
              A ${V*.5} ${V*.5} 0 1 1 ${_+V*.4} ${E}`,fill:"none",stroke:"#007bff",strokeWidth:30,strokeLinecap:"round"}),o.jsx("path",{d:`M ${_+V*.4} ${E}
              L ${_+V*.6} ${E-V*.2}
              M ${_+V*.4} ${E}
              L ${_+V*.6} ${E+V*.2}`,fill:"none",stroke:"#007bff",strokeWidth:30,strokeLinecap:"round"})]}),te.map(S=>o.jsx("rect",{className:`scale-handle scale-handle--${S.type}`,x:S.x-T/2,y:S.y-T/2,width:T,height:T,fill:"white",stroke:"#007bff",strokeWidth:40,rx:30,ry:30,style:{cursor:c&&u===S.type?"grabbing":S.cursor,pointerEvents:"all"},onMouseDown:K=>I(K,S.type)},S.type)),a&&o.jsxs("text",{x:g.dimensions.width_mm/2,y:-1e3-V-200,textAnchor:"middle",fontSize:400,fill:"#007bff",fontWeight:"bold",style:{pointerEvents:"none"},children:[Math.round(x),""]}),c&&o.jsxs("text",{x:g.dimensions.width_mm/2,y:g.dimensions.length_mm+600,textAnchor:"middle",fontSize:400,fill:"#007bff",fontWeight:"bold",style:{pointerEvents:"none"},children:[(v*100).toFixed(0),"%"]})]})}function xw(e){const{width_mm:t,height_mm:r,numLanes:n,laneWidth_mm:i,cornerRadius:s={topLeft:3e3,topRight:3e3,bottomLeft:3e3,bottomRight:3e3},lineWidth_mm:a=50}=e,l=[];if(s.topLeft===0&&s.topRight===0&&s.bottomLeft===0&&s.bottomRight===0){const d=n*i;for(let u=0;u<n;u++){const f=u*i;l.push({laneNumber:u+1,innerPath:null,outerPath:TC(i,r,u),perimeter:2*r/1e3,isParallel:!0,laneX:f,laneWidth:i})}return{lanes:l,totalWidth:d,totalLength:r,usableWidth:d,usableHeight:r,isStraightTrack:!0}}else for(let d=0;d<n;d++){const u=d*i,f=(d+1)*i,h=Math.max(0,t-f*2),p=Math.max(0,r-f*2),g=Math.max(0,t-u*2),m=Math.max(0,r-u*2),x={topLeft:Math.max(0,s.topLeft-f),topRight:Math.max(0,s.topRight-f),bottomLeft:Math.max(0,s.bottomLeft-f),bottomRight:Math.max(0,s.bottomRight-f)},v={topLeft:Math.max(0,s.topLeft-u),topRight:Math.max(0,s.topRight-u),bottomLeft:Math.max(0,s.bottomLeft-u),bottomRight:Math.max(0,s.bottomRight-u)};l.push({laneNumber:d+1,innerPath:Jg(h,p,x,f),outerPath:Jg(g,m,v,u),perimeter:NC(g,m,v),isParallel:!1})}return{lanes:l,totalWidth:t,totalLength:r,usableWidth:t-n*i*2,usableHeight:r-n*i*2}}function Jg(e,t,r,n=0){if(e<=0||t<=0)return`M ${n} ${n} L ${n} ${n}`;const i=Math.min(e/2,t/2),s=Math.min(r.topLeft,i),a=Math.min(r.topRight,i),l=Math.min(r.bottomRight,i),c=Math.min(r.bottomLeft,i),d=n,u=n+e,f=n,h=n+t;return`
    M ${d+s} ${f}
    L ${u-a} ${f}
    ${a>0?`A ${a} ${a} 0 0 1 ${u} ${f+a}`:""}
    L ${u} ${h-l}
    ${l>0?`A ${l} ${l} 0 0 1 ${u-l} ${h}`:""}
    L ${d+c} ${h}
    ${c>0?`A ${c} ${c} 0 0 1 ${d} ${h-c}`:""}
    L ${d} ${f+s}
    ${s>0?`A ${s} ${s} 0 0 1 ${d+s} ${f}`:""}
    Z
  `.trim().replace(/\s+/g," ")}function TC(e,t,r){const n=r*e;return`M ${n} 0 L ${n+e} 0 L ${n+e} ${t} L ${n} ${t} Z`}function NC(e,t,r){if(e<=0||t<=0)return 0;const n=Math.min(e/2,t/2),i=Math.min(r.topLeft,n),s=Math.min(r.topRight,n),a=Math.min(r.bottomRight,n),l=Math.min(r.bottomLeft,n),c=e-i-s,d=t-s-a,u=e-a-l,f=t-l-i,h=Math.PI*i/2,p=Math.PI*s/2,g=Math.PI*a/2,m=Math.PI*l/2;return(c+d+u+f+h+p+g+m)/1e3}function bw(e){if(!e||!e.lanes||e.lanes.length===0)return[];const t=e.lanes.length-1,r=e.lanes[t].perimeter;return e.lanes.map((n,i)=>n.perimeter-r)}function Qg(e,t,r){const{width_mm:n,height_mm:i,laneWidth_mm:s,cornerRadius:a={topLeft:3e3,topRight:3e3,bottomLeft:3e3,bottomRight:3e3}}=r,l=e*s,c=Math.max(0,n-l*2),d=Math.max(0,i-l*2),u=Math.min(c/2,d/2),f=Math.min(Math.max(0,a.topLeft-l),u),h=Math.min(Math.max(0,a.topRight-l),u),p=Math.min(Math.max(0,a.bottomRight-l),u),g=Math.min(Math.max(0,a.bottomLeft-l),u),m=l,x=l+c,v=l,y=l+d,b=[{type:"arc",length:Math.PI*g/2,radius:g,corner:"bottomLeft"},{type:"straight",length:d-g-f,dir:"up"},{type:"arc",length:Math.PI*f/2,radius:f,corner:"topLeft"},{type:"straight",length:c-f-h,dir:"right"},{type:"arc",length:Math.PI*h/2,radius:h,corner:"topRight"},{type:"straight",length:d-h-p,dir:"down"},{type:"arc",length:Math.PI*p/2,radius:p,corner:"bottomRight"},{type:"straight",length:c-p-g,dir:"left"}];let w=t;const j=b.reduce((E,N)=>E+N.length,0);for(;w<0;)w+=j;for(;w>=j;)w-=j;let _=0;for(const E of b){if(w<=_+E.length){const N=w-_,O=E.length>0?N/E.length:0;return E.type==="arc"?PC(E,O,{left:m,right:x,top:v,bottom:y,tl:f,tr:h,br:p,bl:g}):RC(E,O,{left:m,right:x,top:v,bottom:y,tl:f,tr:h,br:p,bl:g})}_+=E.length}return{x:m,y:y-g,angle:-Math.PI/2}}function PC(e,t,r){const{left:n,right:i,top:s,bottom:a,tl:l,tr:c,br:d,bl:u}=r,f=t*(Math.PI/2);switch(e.corner){case"bottomLeft":{const h=n+u,p=a-u,m=Math.PI/2+f;return{x:h+u*Math.cos(m),y:p+u*Math.sin(m),angle:m+Math.PI/2}}case"topLeft":{const h=n+l,p=s+l,m=Math.PI+f;return{x:h+l*Math.cos(m),y:p+l*Math.sin(m),angle:m+Math.PI/2}}case"topRight":{const h=i-c,p=s+c,m=-Math.PI/2+f;return{x:h+c*Math.cos(m),y:p+c*Math.sin(m),angle:m+Math.PI/2}}case"bottomRight":{const h=i-d,p=a-d,m=0+f;return{x:h+d*Math.cos(m),y:p+d*Math.sin(m),angle:m+Math.PI/2}}default:return{x:n,y:s,angle:0}}}function RC(e,t,r){const{left:n,right:i,top:s,bottom:a,tl:l,tr:c,br:d,bl:u}=r;switch(e.dir){case"up":{const f=a-u,h=s+l;return{x:n,y:f+t*(h-f),angle:-Math.PI/2}}case"right":{const f=n+l,h=i-c;return{x:f+t*(h-f),y:s,angle:0}}case"down":{const f=s+c,h=a-d;return{x:i,y:f+t*(h-f),angle:Math.PI/2}}case"left":{const f=i-d,h=n+u;return{x:f+t*(h-f),y:a,angle:Math.PI}}default:return{x:n,y:s,angle:0}}}function wu(e,t,r){const n=Qg(e,t,r),i=Qg(e+1,t,r);return{x:(n.x+i.x)/2,y:(n.y+i.y)/2,angle:n.angle,innerX:i.x,innerY:i.y,outerX:n.x,outerY:n.y}}function e0(e,t,r){const{width_mm:n,height_mm:i,laneWidth_mm:s,cornerRadius:a={topLeft:3e3,topRight:3e3,bottomLeft:3e3,bottomRight:3e3}}=r,l=e*s,c=Math.max(0,n-l*2),d=Math.max(0,i-l*2),u=Math.min(c/2,d/2),f=Math.min(Math.max(0,a.topLeft-l),u),h=Math.min(Math.max(0,a.topRight-l),u),p=Math.min(Math.max(0,a.bottomRight-l),u),g=Math.min(Math.max(0,a.bottomLeft-l),u),m=[{type:"arc",length:Math.PI*g/2,corner:"bottomLeft"},{type:"straight",length:d-g-f,dir:"up"},{type:"arc",length:Math.PI*f/2,corner:"topLeft"},{type:"straight",length:c-f-h,dir:"right"},{type:"arc",length:Math.PI*h/2,corner:"topRight"},{type:"straight",length:d-h-p,dir:"down"},{type:"arc",length:Math.PI*p/2,corner:"bottomRight"},{type:"straight",length:c-p-g,dir:"left"}],x=m.reduce((b,w)=>b+w.length,0);let v=t;for(;v<0;)v+=x;for(;v>=x;)v-=x;let y=0;for(let b=0;b<m.length;b++){if(v<=y+m[b].length){const w=v-y,j=m[b].length>0?w/m[b].length:0;return{segmentIndex:b,t:j,segments:m,totalPerimeter:x}}y+=m[b].length}return{segmentIndex:0,t:0,segments:m,totalPerimeter:x}}function t0(e,t,r,n){const i=e0(r,t,n),s=e0(e,0,n);let a=0;for(let d=0;d<i.segmentIndex;d++)a+=s.segments[d].length;const l=s.segments[i.segmentIndex].length;return a+i.t*l}function OC({track:e,svgRef:t}){const{updateTrackParameters:r,updateTrackPosition:n,updateTrackRotation:i,addToHistory:s}=tt(),[a,l]=A.useState(!1),[c,d]=A.useState(!1),[u,f]=A.useState(null),[h,p]=A.useState(null),{parameters:g,position:m,rotation:x}=e,v=g.width_mm,y=g.height_mm,b=m.x+v/2,w=m.y+y/2,j=v/2,_=-1e3,E=(T,V)=>{if(!t.current)return{x:0,y:0};const S=t.current.createSVGPoint();S.x=T,S.y=V;const K=S.matrixTransform(t.current.getScreenCTM().inverse());return{x:K.x,y:K.y}},N=T=>{T.stopPropagation();const V=T.touches?T.touches[0].clientX:T.clientX,S=T.touches?T.touches[0].clientY:T.clientY;d(!0),p({x:V,y:S})},O=(T,V)=>{T.stopPropagation(),l(!0),f(V);const S=T.touches?T.touches[0].clientX:T.clientX,K=T.touches?T.touches[0].clientY:T.clientY,fe=E(S,K);p({screenX:S,screenY:K,svgX:fe.x,svgY:fe.y,initialWidth:v,initialHeight:y,initialPosition:{...m},initialCornerRadius:{...g.cornerRadius}})};A.useEffect(()=>{if(!a&&!c)return;const T=S=>{const K=S.touches?S.touches[0].clientX:S.clientX,fe=S.touches?S.touches[0].clientY:S.clientY;if(c){const Pe=E(K,fe),Re=Pe.x-b,Ae=Pe.y-w;let Ce=Math.atan2(Ae,Re)*(180/Math.PI)+90;Ce=yw(Ce),S.shiftKey&&(Ce=Math.round(Ce/15)*15),i(e.id,Ce);return}if(!h)return;const U=E(K,fe),z=U.x-h.svgX,H=U.y-h.svgY;let Q=h.initialWidth,W=h.initialHeight,q={...m},re={...h.initialCornerRadius};const oe=3e3;switch(u){case"se":Q=Math.max(oe,h.initialWidth+z),W=Math.max(oe,h.initialHeight+H);const Pe=Math.min(Q/h.initialWidth,W/h.initialHeight);re={topLeft:h.initialCornerRadius.topLeft*Pe,topRight:h.initialCornerRadius.topRight*Pe,bottomLeft:h.initialCornerRadius.bottomLeft*Pe,bottomRight:h.initialCornerRadius.bottomRight*Pe};break;case"nw":Q=Math.max(oe,h.initialWidth-z),W=Math.max(oe,h.initialHeight-H),q.x=h.initialPosition.x+(h.initialWidth-Q),q.y=h.initialPosition.y+(h.initialHeight-W);const Re=Math.min(Q/h.initialWidth,W/h.initialHeight);re={topLeft:h.initialCornerRadius.topLeft*Re,topRight:h.initialCornerRadius.topRight*Re,bottomLeft:h.initialCornerRadius.bottomLeft*Re,bottomRight:h.initialCornerRadius.bottomRight*Re};break;case"ne":Q=Math.max(oe,h.initialWidth+z),W=Math.max(oe,h.initialHeight-H),q.y=h.initialPosition.y+(h.initialHeight-W);const Ae=Math.min(Q/h.initialWidth,W/h.initialHeight);re={topLeft:h.initialCornerRadius.topLeft*Ae,topRight:h.initialCornerRadius.topRight*Ae,bottomLeft:h.initialCornerRadius.bottomLeft*Ae,bottomRight:h.initialCornerRadius.bottomRight*Ae};break;case"sw":Q=Math.max(oe,h.initialWidth-z),W=Math.max(oe,h.initialHeight+H),q.x=h.initialPosition.x+(h.initialWidth-Q);const Ce=Math.min(Q/h.initialWidth,W/h.initialHeight);re={topLeft:h.initialCornerRadius.topLeft*Ce,topRight:h.initialCornerRadius.topRight*Ce,bottomLeft:h.initialCornerRadius.bottomLeft*Ce,bottomRight:h.initialCornerRadius.bottomRight*Ce};break;case"e":Q=Math.max(oe,h.initialWidth+z);const ve=Q/h.initialWidth;re={topLeft:h.initialCornerRadius.topLeft*ve,topRight:h.initialCornerRadius.topRight*ve,bottomLeft:h.initialCornerRadius.bottomLeft*ve,bottomRight:h.initialCornerRadius.bottomRight*ve};break;case"w":Q=Math.max(oe,h.initialWidth-z),q.x=h.initialPosition.x+(h.initialWidth-Q);const me=Q/h.initialWidth;re={topLeft:h.initialCornerRadius.topLeft*me,topRight:h.initialCornerRadius.topRight*me,bottomLeft:h.initialCornerRadius.bottomLeft*me,bottomRight:h.initialCornerRadius.bottomRight*me};break;case"n":W=Math.max(oe,h.initialHeight-H),q.y=h.initialPosition.y+(h.initialHeight-W);const De=W/h.initialHeight;re={topLeft:h.initialCornerRadius.topLeft*De,topRight:h.initialCornerRadius.topRight*De,bottomLeft:h.initialCornerRadius.bottomLeft*De,bottomRight:h.initialCornerRadius.bottomRight*De};break;case"s":W=Math.max(oe,h.initialHeight+H);const Xe=W/h.initialHeight;re={topLeft:h.initialCornerRadius.topLeft*Xe,topRight:h.initialCornerRadius.topRight*Xe,bottomLeft:h.initialCornerRadius.bottomLeft*Xe,bottomRight:h.initialCornerRadius.bottomRight*Xe};break}const pe=Math.min(Q,W)/2;re={topLeft:Math.min(re.topLeft,pe),topRight:Math.min(re.topRight,pe),bottomLeft:Math.min(re.bottomLeft,pe),bottomRight:Math.min(re.bottomRight,pe)},r(e.id,{width_mm:Q,height_mm:W,cornerRadius:re}),(q.x!==m.x||q.y!==m.y)&&n(e.id,q)},V=()=>{(a||c)&&s(),l(!1),d(!1),f(null),p(null)};return window.addEventListener("mousemove",T),window.addEventListener("mouseup",V),window.addEventListener("touchmove",T,{passive:!1}),window.addEventListener("touchend",V),window.addEventListener("touchcancel",V),()=>{window.removeEventListener("mousemove",T),window.removeEventListener("mouseup",V),window.removeEventListener("touchmove",T),window.removeEventListener("touchend",V),window.removeEventListener("touchcancel",V)}},[a,h,u,e.id,m,g,r,n,s]);const I=[{type:"nw",x:0,y:0,cursor:"nwse-resize"},{type:"n",x:v/2,y:0,cursor:"ns-resize"},{type:"ne",x:v,y:0,cursor:"nesw-resize"},{type:"e",x:v,y:y/2,cursor:"ew-resize"},{type:"se",x:v,y,cursor:"nwse-resize"},{type:"s",x:v/2,y,cursor:"ns-resize"},{type:"sw",x:0,y,cursor:"nesw-resize"},{type:"w",x:0,y:y/2,cursor:"ew-resize"}],te=400;return o.jsxs("g",{className:"track-resize-handles",children:[o.jsxs("g",{className:"rotation-handle-group",children:[o.jsx("line",{x1:j,y1:0,x2:j,y2:_,stroke:"#0066CC",strokeWidth:30,strokeDasharray:"100 100",opacity:.5,style:{pointerEvents:"none"}}),o.jsx("circle",{className:"rotation-handle",cx:j,cy:_,r:te/2,fill:"white",stroke:"#0066CC",strokeWidth:50,style:{cursor:c?"grabbing":"grab",pointerEvents:"all"},onMouseDown:N,onTouchStart:N}),o.jsx("path",{d:`M ${j-100} ${_-50}
              A 100 100 0 1 1 ${j+100} ${_-50}`,fill:"none",stroke:"#0066CC",strokeWidth:40,strokeLinecap:"round",style:{pointerEvents:"none"}}),o.jsx("path",{d:`M ${j+100} ${_-50}
              L ${j+80} ${_-120}
              L ${j+150} ${_-80}
              Z`,fill:"#0066CC",style:{pointerEvents:"none"}})]}),I.map(T=>o.jsx("rect",{className:`resize-handle resize-handle--${T.type}`,x:T.x-te/2,y:T.y-te/2,width:te,height:te,fill:"white",stroke:"#0066CC",strokeWidth:50,rx:40,ry:40,style:{cursor:a&&u===T.type?"grabbing":T.cursor,pointerEvents:"all"},onMouseDown:V=>O(V,T.type),onTouchStart:V=>O(V,T.type)},T.type)),a&&o.jsxs("text",{x:v/2,y:y+800,textAnchor:"middle",fontSize:400,fill:"#0066CC",fontWeight:"bold",style:{pointerEvents:"none"},children:[(v/1e3).toFixed(1),"m  ",(y/1e3).toFixed(1),"m"]}),c&&o.jsxs("text",{x:v/2,y:-1500,textAnchor:"middle",fontSize:400,fill:"#0066CC",fontWeight:"bold",style:{pointerEvents:"none"},children:[x.toFixed(0),""]})]})}function AC({geometry:e,parameters:t,boxConfig:r,surfaceColor:n,isStraightTrack:i}){if(!r||!r.enabled)return null;const{depth_mm:s=400,lineWidth_mm:a=50,perLaneOffsets:l=[],style:c="staggered",direction:d="counterclockwise",startPosition:u=0}=r,f=n||"#A5362F",h="#FFFFFF",p=c==="staggered"||c==="both",g=c==="straight"||c==="both";return o.jsx("g",{className:"starting-boxes",children:e.lanes.map((m,x)=>{const v=x+1;return i?MC(x,v,t,e,s,a,f,h,p,g,l,d):$C(x,v,t,e,s,a,f,h,p,g,l,d,u)})})}function MC(e,t,r,n,i,s,a,l,c,d,u,f){const h=e*r.laneWidth_mm,p=r.laneWidth_mm,g=f==="clockwise",m=g?n.totalLength-i:0,x=g?0:n.totalLength-i,v=(u[e]||0)*1e3,y=[];if(c&&!d){const b=g?m-v:m+v;y.push(o.jsx(Gl,{x:h,y:b,width:p,height:i,laneNumber:t,boxFillColor:a,lineColor:l,lineWidth:s,flipLine:g},`stagger-${t}`))}else if(d&&!c)y.push(o.jsx(Gl,{x:h,y:m,width:p,height:i,laneNumber:t,boxFillColor:a,lineColor:l,lineWidth:s,flipLine:g},`straight-${t}`));else if(c&&d){const b=g?m-v:m+v;y.push(o.jsx(Gl,{x:h,y:b,width:p,height:i,laneNumber:t,boxFillColor:a,lineColor:l,lineWidth:s,flipLine:g},`stagger-${t}`)),y.push(o.jsx(Gl,{x:h,y:x,width:p,height:i,laneNumber:t,boxFillColor:a,lineColor:l,lineWidth:s,flipLine:!g},`straight-${t}`))}return o.jsx("g",{children:y},`lane-boxes-${t}`)}function Gl({x:e,y:t,width:r,height:n,laneNumber:i,boxFillColor:s,lineColor:a,lineWidth:l,flipLine:c}){const d=c?t+n:t;return o.jsxs("g",{children:[o.jsx("rect",{x:e,y:t,width:r,height:n,fill:s,stroke:"none",pointerEvents:"none"}),o.jsx("line",{x1:e,y1:d,x2:e+r,y2:d,stroke:a,strokeWidth:l,strokeLinecap:"butt",pointerEvents:"none"}),o.jsx("text",{x:e+r/2,y:t+n/2,fontSize:Math.min(r*.4,r*.5),fill:a,textAnchor:"middle",dominantBaseline:"middle",fontWeight:"bold",pointerEvents:"none",opacity:"0.8",children:i})]})}function $C(e,t,r,n,i,s,a,l,c,d,u,f,h=0){var E,N;const p=f==="clockwise",g=n.lanes.length-1,m=(((E=n.lanes[g])==null?void 0:E.perimeter)||0)*1e3,x=m/2,v=h/100*m,y=t0(e,v,g,r),w=(((N=n.lanes[e])==null?void 0:N.perimeter)||0)*1e3/2,j=(u[e]||0)*1e3,_=[];if(c&&!d){const O=p?y+w+j:y+j;_.push(o.jsx(Vl,{index:e,laneNumber:t,distance:O,depth_mm:i,parameters:r,boxFillColor:a,lineColor:l,lineWidth:s},`stagger-${t}`))}else if(d&&!c){const O=p?y+w:y;_.push(o.jsx(Vl,{index:e,laneNumber:t,distance:O,depth_mm:i,parameters:r,boxFillColor:a,lineColor:l,lineWidth:s},`straight-${t}`))}else if(c&&d){const O=p?y+w+j:y+j,I=p?v:v+x,te=t0(e,I,g,r),T=te;_.push(o.jsx(Vl,{index:e,laneNumber:t,distance:O,depth_mm:i,parameters:r,boxFillColor:a,lineColor:l,lineWidth:s},`stagger-${t}`)),_.push(o.jsx(Vl,{index:e,laneNumber:t,distance:T,depth_mm:i,parameters:r,boxFillColor:a,lineColor:l,lineWidth:s},`straight-${t}`))}return o.jsx("g",{children:_},`lane-boxes-${t}`)}function Vl({index:e,laneNumber:t,distance:r,depth_mm:n,parameters:i,boxFillColor:s,lineColor:a,lineWidth:l}){const c=wu(e,r,i),d=c.angle+Math.PI/2,u=i.laneWidth_mm/2,f=c.x+Math.cos(d)*u,h=c.y+Math.sin(d)*u,p=c.x-Math.cos(d)*u,g=c.y-Math.sin(d)*u,m=wu(e,r+n,i),x=m.angle+Math.PI/2,v=m.x+Math.cos(x)*u,y=m.y+Math.sin(x)*u,b=m.x-Math.cos(x)*u,w=m.y-Math.sin(x)*u,j=wu(e,r+n/2,i),_=`
    M ${f} ${h}
    L ${p} ${g}
    L ${b} ${w}
    L ${v} ${y}
    Z
  `.trim().replace(/\s+/g," ");return o.jsxs("g",{children:[o.jsx("path",{d:_,fill:s,stroke:"none",pointerEvents:"none"}),o.jsx("line",{x1:f,y1:h,x2:p,y2:g,stroke:a,strokeWidth:l,strokeLinecap:"butt",pointerEvents:"none"}),o.jsx("text",{x:j.x,y:j.y,fontSize:i.laneWidth_mm*.5,fill:a,textAnchor:"middle",dominantBaseline:"middle",fontWeight:"bold",pointerEvents:"none",opacity:"0.8",transform:`rotate(${j.angle*180/Math.PI+90}, ${j.x}, ${j.y})`,children:t})]})}function LC({track:e,isSelected:t,onMouseDown:r,onTouchStart:n,onDoubleClick:i,svgRef:s}){var w,j,_;const{parameters:a,position:l,rotation:c,trackSurfaceColor:d}=e,u=xw(a),f=u.lanes.length>0&&u.lanes[0].isParallel===!0,h=u.totalWidth,p=u.totalLength,g=h/2,m=p/2,x=`translate(${l.x}, ${l.y}) rotate(${c}, ${g}, ${m})`,v=(d==null?void 0:d.hex)||"#A5362F",y="#FFFFFF",b=a.lineWidth_mm||50;return console.log("TrackRenderer - trackSurfaceColor:",d),console.log("TrackRenderer - surfaceColor:",v),console.log("TrackRenderer - geometry.lanes.length:",u.lanes.length),o.jsxs("g",{className:`track-element ${t?"track-element--selected":""}`,transform:x,style:{cursor:"move"},children:[o.jsx("rect",{x:"0",y:"0",width:h,height:p,fill:"none",pointerEvents:"all",onMouseDown:r,onTouchStart:n,onDoubleClick:i,style:{cursor:"move"}}),f?u.lanes.map(E=>o.jsx("path",{d:E.outerPath,fill:v,stroke:"none",pointerEvents:"none"},`lane-fill-${E.laneNumber}`)):o.jsx("path",{d:`${u.lanes[0].outerPath} ${u.lanes[u.lanes.length-1].innerPath}`,fill:v,fillRule:"evenodd",stroke:"none",pointerEvents:"none"}),u.lanes.map((E,N)=>o.jsx(IC,{lane:E,lineColor:y,lineWidth:b,isLastLane:N===u.lanes.length-1,isStraightTrack:f,geometry:u},`stroke-${E.laneNumber}`)),((w=a.startingBoxes)==null?void 0:w.enabled)&&o.jsx(AC,{geometry:u,parameters:a,boxConfig:{...a.startingBoxes,perLaneOffsets:((j=e.template)==null?void 0:j.trackType)==="curved"?bw(u):[]},surfaceColor:v,isStraightTrack:((_=e.template)==null?void 0:_.trackType)==="straight"}),t&&o.jsxs(o.Fragment,{children:[o.jsx("rect",{x:"-10",y:"-10",width:h+20,height:p+20,fill:"none",stroke:"#0066CC",strokeWidth:"80",strokeDasharray:"400 400",opacity:"0.5",pointerEvents:"none"}),o.jsx(OC,{track:e,svgRef:s})]})]})}function IC({lane:e,lineColor:t,lineWidth:r,isLastLane:n,isStraightTrack:i,geometry:s}){const{innerPath:a,outerPath:l}=e,c=50;return i?o.jsxs("g",{className:"track-lane-stroke",children:[e.laneNumber===1&&o.jsx("line",{x1:e.laneX,y1:0,x2:e.laneX,y2:s.totalLength,stroke:t,strokeWidth:c,pointerEvents:"none"}),o.jsx("line",{x1:e.laneX+e.laneWidth,y1:0,x2:e.laneX+e.laneWidth,y2:s.totalLength,stroke:t,strokeWidth:c,pointerEvents:"none"})]}):o.jsxs("g",{className:"track-lane-stroke",children:[o.jsx("path",{d:l,fill:"none",stroke:t,strokeWidth:c,pointerEvents:"none"}),n&&o.jsx("path",{d:a,fill:"none",stroke:t,strokeWidth:c,pointerEvents:"none"})]})}function DC({motif:e,isSelected:t,onMouseDown:r,onTouchStart:n,onDoubleClick:i,onScaleStart:s,onRotateStart:a}){const{svgContent:l,originalWidth_mm:c,originalHeight_mm:d,position:u,rotation:f,scale:h}=e,p=A.useMemo(()=>{if(!l)return null;const _=l.match(/viewBox=["']([^"']+)["']/i);if(_){const O=_[1].split(/\s+/).map(Number);if(O.length>=4)return{width:O[2],height:O[3]}}const E=l.match(/\bwidth=["']?(\d+(?:\.\d+)?)/i),N=l.match(/\bheight=["']?(\d+(?:\.\d+)?)/i);return E&&N?{width:parseFloat(E[1]),height:parseFloat(N[1])}:null},[l]),g=A.useMemo(()=>{if(!p)return{width:c,height:d};const _=p.width/p.height,E=c/d,N=_>=1,O=E>=1;if(N!==O){console.warn("[MOTIF] Orientation mismatch detected - using SVG viewBox aspect ratio"),console.log("[MOTIF] SVG viewBox:",p,"AR:",_.toFixed(2)),console.log("[MOTIF] Physical dims:",c,"",d,"AR:",E.toFixed(2));const I=c*d,te=Math.sqrt(I*_),T=te/_;return{width:te,height:T}}return{width:c,height:d}},[p,c,d]),m=g.width*(h||1),x=g.height*(h||1),v=m/2,y=x/2,b=`translate(${u.x}, ${u.y}) rotate(${f||0}, ${v}, ${y})`,w=A.useMemo(()=>{if(!l)return null;try{let _=l;return _=_.replace(/\s+(width|height)=["'][^"']*["']/gi,""),_.includes("viewBox")||(_=_.replace("<svg",`<svg viewBox="0 0 ${g.width} ${g.height}"`)),_}catch(_){return console.error("[MOTIF] Error processing SVG:",_),l}},[l,g]),j=A.useMemo(()=>{if(!w)return null;try{return`data:image/svg+xml,${encodeURIComponent(w).replace(/'/g,"%27").replace(/"/g,"%22")}`}catch(_){return console.error("[MOTIF] Error creating data URL:",_),null}},[w]);return j?o.jsxs("g",{className:`motif-element ${t?"motif-element--selected":""}`,transform:b,style:{cursor:"move"},children:[o.jsx("image",{href:j,x:"0",y:"0",width:m,height:x,preserveAspectRatio:"xMidYMid meet",pointerEvents:"none"}),o.jsx("rect",{x:"0",y:"0",width:m,height:x,fill:"transparent",pointerEvents:"all",onMouseDown:r,onTouchStart:n,onDoubleClick:i,style:{cursor:"move"}}),t&&o.jsx("rect",{x:"-10",y:"-10",width:m+20,height:x+20,fill:"none",stroke:"#9333EA",strokeWidth:"80",strokeDasharray:"400 400",opacity:"0.7",pointerEvents:"none"}),t&&o.jsx(zC,{width:m,height:x,onScaleStart:s,onRotateStart:a})]}):o.jsxs("g",{transform:b,children:[o.jsx("rect",{x:"0",y:"0",width:m,height:x,fill:"#f0f0f0",stroke:"#ccc",strokeWidth:"50",strokeDasharray:"200 200"}),o.jsx("text",{x:m/2,y:x/2,textAnchor:"middle",dominantBaseline:"middle",fontSize:Math.min(m,x)/10,fill:"#999",children:"Motif Error"})]})}function zC({width:e,height:t,onScaleStart:r,onRotateStart:n}){const i=Math.min(e,t)*.08,l=Math.max(150,Math.min(400,i)),c=[{x:-l/2,y:-l/2,corner:"nw",cursor:"nwse-resize"},{x:e-l/2,y:-l/2,corner:"ne",cursor:"nesw-resize"},{x:-l/2,y:t-l/2,corner:"sw",cursor:"nesw-resize"},{x:e-l/2,y:t-l/2,corner:"se",cursor:"nwse-resize"}],d=l*2.5,u=l*.8;return o.jsxs("g",{className:"motif-handles",children:[c.map(f=>o.jsx("rect",{x:f.x,y:f.y,width:l,height:l,fill:"#9333EA",stroke:"#fff",strokeWidth:"20",rx:l/4,style:{cursor:f.cursor},pointerEvents:"all",onMouseDown:h=>{h.stopPropagation(),r==null||r(h,f.corner)},onTouchStart:h=>{h.stopPropagation(),r==null||r(h,f.corner)}},f.corner)),o.jsx("line",{x1:e/2,y1:0,x2:e/2,y2:-d+u/2,stroke:"#9333EA",strokeWidth:"30",pointerEvents:"none"}),o.jsx("circle",{cx:e/2,cy:-d,r:u,fill:"#9333EA",stroke:"#fff",strokeWidth:"20",style:{cursor:"grab"},pointerEvents:"all",onMouseDown:f=>{f.stopPropagation(),n==null||n(f)},onTouchStart:f=>{f.stopPropagation(),n==null||n(f)}}),o.jsx("path",{d:`M ${e/2-u*.4} ${-d}
            A ${u*.4} ${u*.4} 0 1 1
            ${e/2+u*.4} ${-d}`,fill:"none",stroke:"#fff",strokeWidth:"25",strokeLinecap:"round",pointerEvents:"none"}),o.jsx("polygon",{points:`${e/2+u*.4},${-d-u*.25}
                 ${e/2+u*.4},${-d+u*.25}
                 ${e/2+u*.65},${-d}`,fill:"#fff",pointerEvents:"none"})]})}function FC(e,t,r,n=0){if(e>=32)return HC(t,r);const i=BC(e,t,r);return n>0?UC(i,n):`M ${i.map(s=>`${s.x},${s.y}`).join(" L ")} Z`}function BC(e,t,r){if(e===4)return[{x:0,y:0},{x:t,y:0},{x:t,y:r},{x:0,y:r}];const n=[],i=2*Math.PI/e,s=-Math.PI/2;for(let g=0;g<e;g++){const m=s+i*g;n.push({x:Math.cos(m),y:Math.sin(m)})}let a=1/0,l=-1/0,c=1/0,d=-1/0;for(const g of n)a=Math.min(a,g.x),l=Math.max(l,g.x),c=Math.min(c,g.y),d=Math.max(d,g.y);const u=l-a,f=d-c,h=t/u,p=r/f;return n.map(g=>({x:(g.x-a)*h,y:(g.y-c)*p}))}function HC(e,t){const r=e/2,n=t/2,i=r,s=n;return`M ${i-r},${s} A ${r},${n} 0 1,1 ${i+r},${s} A ${r},${n} 0 1,1 ${i-r},${s} Z`}function UC(e,t,r,n){if(e.length<3)return"";let i=1/0;for(let h=0;h<e.length;h++){const p=e[h],g=e[(h+1)%e.length],m=Math.sqrt(Math.pow(g.x-p.x,2)+Math.pow(g.y-p.y,2));i=Math.min(i,m)}const s=i/2,a=t/100*s;if(a<1)return`M ${e.map(h=>`${h.x},${h.y}`).join(" L ")} Z`;const l=[];for(let h=0;h<e.length;h++){const p=e[(h-1+e.length)%e.length],g=e[h],m=e[(h+1)%e.length],x=_u({x:p.x-g.x,y:p.y-g.y}),v=_u({x:m.x-g.x,y:m.y-g.y}),y={x:g.x+x.x*a,y:g.y+x.y*a},b={x:g.x+v.x*a,y:g.y+v.y*a};h===0?l.push(`M ${y.x},${y.y}`):l.push(`L ${y.x},${y.y}`),l.push(`Q ${g.x},${g.y} ${b.x},${b.y}`)}const c=e[e.length-1],d=e[0],u=_u({x:c.x-d.x,y:c.y-d.y}),f={x:d.x+u.x*a,y:d.y+u.y*a};return l.push(`L ${f.x},${f.y}`),l.push("Z"),l.join(" ")}function _u(e){const t=Math.sqrt(e.x*e.x+e.y*e.y);return t===0?{x:0,y:0}:{x:e.x/t,y:e.y/t}}function WC(e){const t={3:"Triangle",4:"Rectangle",5:"Pentagon",6:"Hexagon",7:"Heptagon",8:"Octagon",9:"Nonagon",10:"Decagon",12:"Dodecagon"};return e>=32?"Circle":t[e]?t[e]:`${e}-gon`}function GC(e){return e>=32?"":e===3?"":e===4?"":e===5?"":e===6?"":`${e}`}function VC({shape:e,isSelected:t,onMouseDown:r,onTouchStart:n,onDoubleClick:i,onScaleStart:s,onRotateStart:a}){const{sides:l,width_mm:c,height_mm:d,cornerRadius:u,position:f,rotation:h,fillColor:p,strokeEnabled:g,strokeColor:m,strokeWidth_mm:x}=e,v=A.useMemo(()=>FC(l,c,d,u),[l,c,d,u]),y=c/2,b=d/2,w=`translate(${f.x}, ${f.y}) rotate(${h||0}, ${y}, ${b})`;return o.jsxs("g",{className:`shape-element ${t?"shape-element--selected":""}`,transform:w,style:{cursor:"move"},children:[o.jsx("path",{d:v,fill:(p==null?void 0:p.hex)||"#609B63",stroke:g&&m?m.hex:"none",strokeWidth:g?x:0,pointerEvents:"none"}),o.jsx("path",{d:v,fill:"transparent",stroke:"transparent",strokeWidth:Math.max(x,100),pointerEvents:"all",onMouseDown:r,onTouchStart:n,onDoubleClick:i,style:{cursor:"move"}}),t&&o.jsx("rect",{x:"-10",y:"-10",width:c+20,height:d+20,fill:"none",stroke:"#3b82f6",strokeWidth:"80",strokeDasharray:"400 400",opacity:"0.7",pointerEvents:"none"}),t&&o.jsx(qC,{width:c,height:d,onScaleStart:s,onRotateStart:a})]})}function qC({width:e,height:t,onScaleStart:r,onRotateStart:n}){const i=Math.min(e,t)*.08,l=Math.max(150,Math.min(400,i)),c=[{x:e/2-l/2,y:-l/2,corner:"n",cursor:"ns-resize"},{x:e/2-l/2,y:t-l/2,corner:"s",cursor:"ns-resize"},{x:e-l/2,y:t/2-l/2,corner:"e",cursor:"ew-resize"},{x:-l/2,y:t/2-l/2,corner:"w",cursor:"ew-resize"}],d=l*2.5,u=l*.8;return o.jsxs("g",{className:"shape-handles",children:[c.map(f=>o.jsx("rect",{x:f.x,y:f.y,width:l,height:l,fill:"#3b82f6",stroke:"#fff",strokeWidth:"20",rx:l/4,style:{cursor:f.cursor},pointerEvents:"all",onMouseDown:h=>{h.stopPropagation(),r==null||r(h,f.corner)},onTouchStart:h=>{h.stopPropagation(),r==null||r(h,f.corner)}},f.corner)),o.jsx("line",{x1:e/2,y1:0,x2:e/2,y2:-d+u/2,stroke:"#3b82f6",strokeWidth:"30",pointerEvents:"none"}),o.jsx("circle",{cx:e/2,cy:-d,r:u,fill:"#3b82f6",stroke:"#fff",strokeWidth:"20",style:{cursor:"grab"},pointerEvents:"all",onMouseDown:f=>{f.stopPropagation(),n==null||n(f)},onTouchStart:f=>{f.stopPropagation(),n==null||n(f)}}),o.jsx("path",{d:`M ${e/2-u*.4} ${-d}
            A ${u*.4} ${u*.4} 0 1 1
            ${e/2+u*.4} ${-d}`,fill:"none",stroke:"#fff",strokeWidth:"25",strokeLinecap:"round",pointerEvents:"none"}),o.jsx("polygon",{points:`${e/2+u*.4},${-d-u*.25}
                 ${e/2+u*.4},${-d+u*.25}
                 ${e/2+u*.65},${-d}`,fill:"#fff",pointerEvents:"none"})]})}function ww({controlPoints:e,width:t,height:r,onPointDrag:n,onHandleDrag:i,onDragEnd:s,showHandles:a=!0,selectedPointIndex:l,onPointSelect:c,onPointDelete:d}){const[u,f]=A.useState(null),[h,p]=A.useState(null),g=Math.min(t,r)*.03,v=Math.max(60,Math.min(120,g)),y=v*.7,b=A.useCallback((_,E)=>{_.stopPropagation(),_.preventDefault(),c==null||c(E),f({type:"point",index:E}),p({x:_.clientX,y:_.clientY})},[c]),w=A.useCallback((_,E)=>{_.preventDefault(),_.stopPropagation(),d==null||d(E)},[d]),j=A.useCallback((_,E,N)=>{_.stopPropagation(),_.preventDefault(),f({type:"handle",index:E,handleType:N}),p({x:_.clientX,y:_.clientY})},[]);return A.useEffect(()=>{if(!u)return;const _=N=>{if(!h)return;const O=document.querySelector(".court-canvas__svg");if(!O)return;const I=O.getBoundingClientRect(),te=O.viewBox.baseVal,T=te.width/I.width,V=te.height/I.height,S=(N.clientX-h.x)*T,K=(N.clientY-h.y)*V;if(u.type==="point"){const fe=e[u.index],U=fe.x+S/t,z=fe.y+K/r;n==null||n(u.index,U,z)}else if(u.type==="handle"){const U=e[u.index][u.handleType],z=U.x+S/t,H=U.y+K/r;i==null||i(u.index,u.handleType,z,H)}p({x:N.clientX,y:N.clientY})},E=()=>{f(null),p(null),s==null||s()};return window.addEventListener("mousemove",_),window.addEventListener("mouseup",E),()=>{window.removeEventListener("mousemove",_),window.removeEventListener("mouseup",E)}},[u,h,e,t,r,n,i,s]),!e||e.length===0?null:o.jsx("g",{className:"blob-edit-handles",children:e.map((_,E)=>{const N=_.x*t,O=_.y*r,I=N+_.handleIn.x*t,te=O+_.handleIn.y*r,T=N+_.handleOut.x*t,V=O+_.handleOut.y*r,S=(u==null?void 0:u.type)==="point"&&(u==null?void 0:u.index)===E,K=(u==null?void 0:u.type)==="handle"&&(u==null?void 0:u.index)===E&&(u==null?void 0:u.handleType)==="handleIn",fe=(u==null?void 0:u.type)==="handle"&&(u==null?void 0:u.index)===E&&(u==null?void 0:u.handleType)==="handleOut",U=l===E;return o.jsxs("g",{className:"blob-control-point-group",children:[a&&o.jsxs(o.Fragment,{children:[o.jsx("line",{x1:N,y1:O,x2:I,y2:te,stroke:"#94a3b8",strokeWidth:"20",strokeDasharray:"60 40",pointerEvents:"none",opacity:"0.8"}),o.jsx("line",{x1:N,y1:O,x2:T,y2:V,stroke:"#94a3b8",strokeWidth:"20",strokeDasharray:"60 40",pointerEvents:"none",opacity:"0.8"}),o.jsx("circle",{cx:I,cy:te,r:y,fill:K?"#f97316":"#ffffff",stroke:"#64748b",strokeWidth:"15",style:{cursor:"crosshair"},pointerEvents:"all",onMouseDown:z=>j(z,E,"handleIn")}),o.jsx("circle",{cx:T,cy:V,r:y,fill:fe?"#f97316":"#ffffff",stroke:"#64748b",strokeWidth:"15",style:{cursor:"crosshair"},pointerEvents:"all",onMouseDown:z=>j(z,E,"handleOut")})]}),o.jsx("circle",{cx:N,cy:O,r:v,fill:U?"#ef4444":S?"#f97316":"#3b82f6",stroke:"#ffffff",strokeWidth:"20",style:{cursor:"move"},pointerEvents:"all",onMouseDown:z=>b(z,E),onContextMenu:z=>w(z,E)}),o.jsx("text",{x:N,y:O+v*.35,textAnchor:"middle",fontSize:v*.8,fill:"#ffffff",fontWeight:"bold",pointerEvents:"none",children:E+1})]},E)})})}function YC({shape:e,isSelected:t,onMouseDown:r,onTouchStart:n,onDoubleClick:i,onScaleStart:s,onRotateStart:a,onPointDrag:l,onHandleDrag:c,onDragEnd:d,selectedPointIndex:u,onPointSelect:f,onPointDelete:h}){const{controlPoints:p,width_mm:g,height_mm:m,position:x,rotation:v,fillColor:y,strokeEnabled:b,strokeColor:w,strokeWidth_mm:j,editPointsVisible:_}=e,E=A.useMemo(()=>sC(p,g,m),[p,g,m]),N=g/2,O=m/2,I=`translate(${x.x}, ${x.y}) rotate(${v||0}, ${N}, ${O})`;return o.jsxs("g",{className:`blob-element ${t?"blob-element--selected":""}`,transform:I,style:{cursor:"move"},children:[o.jsx("path",{d:E,fill:(y==null?void 0:y.hex)||"#609B63",stroke:b&&w?w.hex:"none",strokeWidth:b?j:0,pointerEvents:"none"}),o.jsx("path",{d:E,fill:"transparent",stroke:"transparent",strokeWidth:Math.max(j||0,100),pointerEvents:"all",onTouchStart:n,onMouseDown:r,onDoubleClick:i,style:{cursor:"move"}}),t&&o.jsx("rect",{x:"-10",y:"-10",width:g+20,height:m+20,fill:"none",stroke:"#3b82f6",strokeWidth:"80",strokeDasharray:"400 400",opacity:"0.7",pointerEvents:"none"}),t&&o.jsx(XC,{width:g,height:m,onScaleStart:s,onRotateStart:a}),t&&p&&_&&o.jsx(ww,{controlPoints:p,width:g,height:m,onPointDrag:l,onHandleDrag:c,onDragEnd:d,showHandles:!0,selectedPointIndex:u,onPointSelect:f,onPointDelete:h})]})}function XC({width:e,height:t,onScaleStart:r,onRotateStart:n}){const i=Math.min(e,t)*.08,l=Math.max(150,Math.min(400,i)),c=[{x:-l/2,y:-l/2,corner:"nw",cursor:"nwse-resize"},{x:e-l/2,y:-l/2,corner:"ne",cursor:"nesw-resize"},{x:-l/2,y:t-l/2,corner:"sw",cursor:"nesw-resize"},{x:e-l/2,y:t-l/2,corner:"se",cursor:"nwse-resize"}],d=l*2.5,u=l*.8;return o.jsxs("g",{className:"blob-resize-handles",children:[c.map(f=>o.jsx("rect",{x:f.x,y:f.y,width:l,height:l,fill:"#3b82f6",stroke:"#fff",strokeWidth:"20",rx:l/4,style:{cursor:f.cursor},pointerEvents:"all",onMouseDown:h=>{h.stopPropagation(),r==null||r(h,f.corner)},onTouchStart:h=>{h.stopPropagation(),r==null||r(h,f.corner)}},f.corner)),o.jsx("line",{x1:e/2,y1:0,x2:e/2,y2:-d+u/2,stroke:"#3b82f6",strokeWidth:"30",pointerEvents:"none"}),o.jsx("circle",{cx:e/2,cy:-d,r:u,fill:"#3b82f6",stroke:"#fff",strokeWidth:"20",style:{cursor:"grab"},pointerEvents:"all",onMouseDown:f=>{f.stopPropagation(),n==null||n(f)},onTouchStart:f=>{f.stopPropagation(),n==null||n(f)}}),o.jsx("path",{d:`M ${e/2-u*.4} ${-d}
            A ${u*.4} ${u*.4} 0 1 1
            ${e/2+u*.4} ${-d}`,fill:"none",stroke:"#fff",strokeWidth:"25",strokeLinecap:"round",pointerEvents:"none"}),o.jsx("polygon",{points:`${e/2+u*.4},${-d-u*.25}
                 ${e/2+u*.4},${-d+u*.25}
                 ${e/2+u*.65},${-d}`,fill:"#fff",pointerEvents:"none"})]})}function KC({shape:e,isSelected:t,onMouseDown:r,onTouchStart:n,onDoubleClick:i,onScaleStart:s,onRotateStart:a,onPointDrag:l,onHandleDrag:c,onDragEnd:d,selectedPointIndex:u,onPointSelect:f,onPointDelete:h}){const{controlPoints:p,width_mm:g,height_mm:m,position:x,rotation:v,fillColor:y,strokeEnabled:b,strokeColor:w,strokeWidth_mm:j,editPointsVisible:_,closed:E,smooth:N}=e,O=A.useMemo(()=>!p||p.length<2?"":hC(p,g,m,E,N),[p,g,m,E,N]),I=g/2,te=m/2,T=`translate(${x.x}, ${x.y}) rotate(${v||0}, ${I}, ${te})`;return O?o.jsxs("g",{className:`path-element ${t?"path-element--selected":""}`,transform:T,style:{cursor:"move"},children:[o.jsx("path",{d:O,fill:E?(y==null?void 0:y.hex)||"#609B63":"none",stroke:b&&w?w.hex:E?"none":(y==null?void 0:y.hex)||"#609B63",strokeWidth:b?j:E?0:50,strokeLinecap:"round",strokeLinejoin:"round",pointerEvents:"none"}),o.jsx("path",{d:O,fill:"transparent",stroke:"transparent",strokeWidth:Math.max(j||0,200),pointerEvents:"all",onTouchStart:n,onMouseDown:r,onDoubleClick:i,style:{cursor:"move"}}),t&&o.jsx("rect",{x:"-10",y:"-10",width:g+20,height:m+20,fill:"none",stroke:"#3b82f6",strokeWidth:"80",strokeDasharray:"400 400",opacity:"0.7",pointerEvents:"none"}),t&&o.jsx(ZC,{width:g,height:m,onScaleStart:s,onRotateStart:a}),t&&p&&_&&o.jsx(ww,{controlPoints:p,width:g,height:m,onPointDrag:l,onHandleDrag:c,onDragEnd:d,showHandles:N,selectedPointIndex:u,onPointSelect:f,onPointDelete:h})]}):null}function ZC({width:e,height:t,onScaleStart:r,onRotateStart:n}){const i=Math.min(e,t)*.08,l=Math.max(150,Math.min(400,i)),c=[{x:-l/2,y:-l/2,corner:"nw",cursor:"nwse-resize"},{x:e-l/2,y:-l/2,corner:"ne",cursor:"nesw-resize"},{x:-l/2,y:t-l/2,corner:"sw",cursor:"nesw-resize"},{x:e-l/2,y:t-l/2,corner:"se",cursor:"nwse-resize"}],d=l*2.5,u=l*.8;return o.jsxs("g",{className:"path-resize-handles",children:[c.map(f=>o.jsx("rect",{x:f.x,y:f.y,width:l,height:l,fill:"#3b82f6",stroke:"#fff",strokeWidth:"20",rx:l/4,style:{cursor:f.cursor},pointerEvents:"all",onMouseDown:h=>{h.stopPropagation(),r==null||r(h,f.corner)},onTouchStart:h=>{h.stopPropagation(),r==null||r(h,f.corner)}},f.corner)),o.jsx("line",{x1:e/2,y1:0,x2:e/2,y2:-d+u/2,stroke:"#3b82f6",strokeWidth:"30",pointerEvents:"none"}),o.jsx("circle",{cx:e/2,cy:-d,r:u,fill:"#3b82f6",stroke:"#fff",strokeWidth:"20",style:{cursor:"grab"},pointerEvents:"all",onMouseDown:f=>{f.stopPropagation(),n==null||n(f)},onTouchStart:f=>{f.stopPropagation(),n==null||n(f)}}),o.jsx("path",{d:`M ${e/2-u*.4} ${-d}
            A ${u*.4} ${u*.4} 0 1 1
            ${e/2+u*.4} ${-d}`,fill:"none",stroke:"#fff",strokeWidth:"25",strokeLinecap:"round",pointerEvents:"none"}),o.jsx("polygon",{points:`${e/2+u*.4},${-d-u*.25}
                 ${e/2+u*.4},${-d+u*.25}
                 ${e/2+u*.65},${-d}`,fill:"#fff",pointerEvents:"none"})]})}function bi(e,t,r,n="normal",i="normal"){bi._canvas||(bi._canvas=document.createElement("canvas"),bi._ctx=bi._canvas.getContext("2d"));const s=bi._ctx,a=i==="italic"?"italic ":"",l=n==="bold"?"bold ":"";s.font=`${a}${l}${r}px ${t}`;const c=s.measureText(e||"Double-click to edit");return{width:Math.max(c.width,100),height:r*1.2}}function JC(){return[{name:"Open Sans",family:"Open Sans, sans-serif"},{name:"Roboto",family:"Roboto, sans-serif"},{name:"Montserrat",family:"Montserrat, sans-serif"},{name:"Oswald",family:"Oswald, sans-serif"},{name:"Playfair Display",family:"Playfair Display, serif"},{name:"Arial",family:"Arial, sans-serif"},{name:"Georgia",family:"Georgia, serif"},{name:"Impact",family:"Impact, sans-serif"}]}function QC({text:e,isSelected:t,isEditing:r,onMouseDown:n,onTouchStart:i,onDoubleClick:s,onScaleStart:a,onRotateStart:l,onContentChange:c,onEditComplete:d}){const u=A.useRef(null),{content:f,fontFamily:h,fontSize_mm:p,fontWeight:g,fontStyle:m,textAlign:x,position:v,rotation:y,fillColor:b}=e,w=A.useMemo(()=>bi(f,h,p,g,m),[f,h,p,g,m]),j=A.useMemo(()=>{switch(x){case"center":return-w.width/2;case"right":return-w.width;default:return 0}},[x,w.width]),_=`translate(${v.x}, ${v.y}) rotate(${y||0})`;A.useEffect(()=>{r&&u.current&&(u.current.focus(),u.current.select())},[r]);const E=O=>{(O.key==="Enter"||O.key==="Escape")&&(O.preventDefault(),d==null||d())},N=f||"Double-click to edit";return o.jsxs("g",{className:`text-element ${t?"text-element--selected":""} ${r?"text-element--editing":""}`,transform:_,children:[r?o.jsx("foreignObject",{x:j-10,y:-p*.85,width:Math.max(w.width+200,500),height:p*1.5,style:{overflow:"visible"},children:o.jsx("input",{ref:u,type:"text",value:f,onChange:O=>c==null?void 0:c(O.target.value),onBlur:d,onKeyDown:E,style:{fontFamily:h,fontSize:`${p}px`,fontWeight:g,fontStyle:m,color:(b==null?void 0:b.hex)||"#1C1C1C",background:"rgba(255,255,255,0.95)",border:"4px solid #3b82f6",borderRadius:"4px",outline:"none",padding:"4px 8px",width:"100%",boxSizing:"border-box",lineHeight:1}})}):o.jsxs(o.Fragment,{children:[o.jsx("text",{x:"0",y:"0",fontFamily:h,fontSize:p,fontWeight:g,fontStyle:m,textAnchor:x==="center"?"middle":x==="right"?"end":"start",fill:(b==null?void 0:b.hex)||"#1C1C1C",style:{cursor:"move",userSelect:"none"},pointerEvents:"none",children:N}),o.jsx("rect",{x:j-20,y:-p*.85,width:w.width+40,height:p*1.2,fill:"transparent",onMouseDown:n,onTouchStart:i,onDoubleClick:s,style:{cursor:"move"}})]}),t&&!r&&o.jsx("rect",{x:j-40,y:-p-40,width:w.width+80,height:p*1.2+80,fill:"none",stroke:"#3b82f6",strokeWidth:"60",strokeDasharray:"300 300",opacity:"0.7",pointerEvents:"none"}),t&&!r&&o.jsx(eE,{bounds:w,fontSize:p,alignOffset:j,onScaleStart:a,onRotateStart:l})]})}function eE({bounds:e,fontSize:t,alignOffset:r,onScaleStart:n,onRotateStart:i}){const s=Math.min(e.width,t)*.15,c=Math.max(100,Math.min(300,s)),d=r-20,u=-t-20,f=e.width+40,h=t*1.2+40,p=[{x:d-c/2,y:u-c/2,corner:"nw",cursor:"nwse-resize"},{x:d+f-c/2,y:u-c/2,corner:"ne",cursor:"nesw-resize"},{x:d-c/2,y:u+h-c/2,corner:"sw",cursor:"nesw-resize"},{x:d+f-c/2,y:u+h-c/2,corner:"se",cursor:"nwse-resize"}],g=c*2.5,m=c*.8,x=d+f/2;return o.jsxs("g",{className:"text-handles",children:[p.map(v=>o.jsx("rect",{x:v.x,y:v.y,width:c,height:c,fill:"#3b82f6",stroke:"#fff",strokeWidth:"15",rx:c/4,style:{cursor:v.cursor},pointerEvents:"all",onMouseDown:y=>{y.stopPropagation(),n==null||n(y,v.corner)},onTouchStart:y=>{y.stopPropagation(),n==null||n(y,v.corner)}},v.corner)),o.jsx("line",{x1:x,y1:u,x2:x,y2:u-g+m/2,stroke:"#3b82f6",strokeWidth:"25",pointerEvents:"none"}),o.jsx("circle",{cx:x,cy:u-g,r:m,fill:"#3b82f6",stroke:"#fff",strokeWidth:"15",style:{cursor:"grab"},pointerEvents:"all",onMouseDown:v=>{v.stopPropagation(),i==null||i(v)},onTouchStart:v=>{v.stopPropagation(),i==null||i(v)}}),o.jsx("path",{d:`M ${x-m*.4} ${u-g}
            A ${m*.4} ${m*.4} 0 1 1
            ${x+m*.4} ${u-g}`,fill:"none",stroke:"#fff",strokeWidth:"20",strokeLinecap:"round",pointerEvents:"none"}),o.jsx("polygon",{points:`${x+m*.4},${u-g-m*.25}
                 ${x+m*.4},${u-g+m*.25}
                 ${x+m*.65},${u-g}`,fill:"#fff",pointerEvents:"none"})]})}const tE=A.forwardRef(function(t,r){var We,$e;const n=A.useRef(null),i=A.useRef(null);A.useImperativeHandle(r,()=>n.current);const[s,a]=A.useState(1),[l,c]=A.useState({x:0,y:0}),[d,u]=A.useState(!1),[f,h]=A.useState({x:0,y:0}),[p,g]=A.useState(!1),[m,x]=A.useState({active:!1,initialDistance:0,initialZoom:1,initialPan:{x:0,y:0},initialCenter:{x:0,y:0}}),[v,y]=A.useState(!1),[b,w]=A.useState(null),[j,_]=A.useState(null),[E,N]=A.useState(null),[O,I]=A.useState(null),[te,T]=A.useState(null),[V,S]=A.useState(null),[K,fe]=A.useState(!1),[U,z]=A.useState(null),[H,Q]=A.useState(null),[W,q]=A.useState(!1),[re,oe]=A.useState(null),[pe,Pe]=A.useState(null),[Re,Ae]=A.useState(!1),[Ce,ve]=A.useState(null),[me,De]=A.useState(null),[Xe,C]=A.useState(!1),[ce,ne]=A.useState(null),[F,R]=A.useState(null),[M,Z]=A.useState(!1),[Y,L]=A.useState(null),[J,ue]=A.useState(null),[ie,$]=A.useState(!1),[X,ae]=A.useState(null),[we,se]=A.useState(null),[xe,Oe]=A.useState(null),[be,Ne]=A.useState(0),[He,qe]=A.useState(null),{surface:Ze,courts:Je,tracks:Fe,motifs:Ve,shapes:Ke,texts:Be,elementOrder:at,selectedCourtId:qt,selectedTrackId:ri,selectedMotifId:Mn,selectedShapeId:Yt,selectedTextId:ni,editingTextId:wt,snapToGrid:Mt,gridSize_mm:nr,selectCourt:pn,deselectCourt:Ft,selectTrack:Xt,deselectTrack:Kt,selectMotif:Xr,deselectMotif:Ir,selectShape:mn,deselectShape:_t,selectText:ii,deselectText:rt,startEditingText:wr,stopEditingText:Ue,updateCourtPosition:ot,updateTrackPosition:pt,updateMotifPosition:et,updateMotifScale:$n,updateMotifRotation:si,updateShapePosition:Dr,updateShapeDimensions:gn,updateShapeRotation:hr,updateTextPosition:Kr,updateTextFontSize:_r,updateTextRotation:oi,updateTextContent:Ln,updateBlobControlPoint:zr,updateBlobHandle:vn,commitBlobEdit:ai,pathDrawingMode:ir,activePathId:Sr,addPointToPath:Vo,finishPath:In,cancelPath:yn,updatePathControlPoint:xn,updatePathHandle:kr,commitPathEdit:ks,removePointFromPath:Dn}=tt(),mt=(P,B)=>{const k=n.current,G=k.createSVGPoint();G.x=P,G.y=B;const le=G.matrixTransform(k.getScreenCTM().inverse());return{x:le.x,y:le.y}},li=(P,B)=>{P.stopPropagation(),pn(B);const k=Je[B];if(k!=null&&k.locked)return;const G=P.touches?P.touches[0].clientX:P.clientX,le=P.touches?P.touches[0].clientY:P.clientY,ye=mt(G,le);w({x:ye.x-k.position.x,y:ye.y-k.position.y}),_(B),y(!0)},js=(P,B)=>{P.stopPropagation(),pn(B),tt.setState({showPropertiesPanel:!0,propertiesPanelUserClosed:!1})},zn=(P,B)=>{P.stopPropagation(),Xt(B);const k=Fe[B];if(k!=null&&k.locked)return;const G=P.touches?P.touches[0].clientX:P.clientX,le=P.touches?P.touches[0].clientY:P.clientY,ye=mt(G,le);w({x:ye.x-k.position.x,y:ye.y-k.position.y}),N(B),y(!0)},Fn=(P,B)=>{P.stopPropagation(),Xt(B),tt.setState({showPropertiesPanel:!0,propertiesPanelUserClosed:!1})},fr=(P,B)=>{P.stopPropagation(),Xr(B);const k=Ve[B];if(k!=null&&k.locked)return;const G=P.touches?P.touches[0].clientX:P.clientX,le=P.touches?P.touches[0].clientY:P.clientY,ye=mt(G,le);w({x:ye.x-k.position.x,y:ye.y-k.position.y}),I(B),y(!0)},Zr=(P,B)=>{P.stopPropagation(),Xr(B),tt.setState({showPropertiesPanel:!0,propertiesPanelUserClosed:!1})},Bi=(P,B,k)=>{P.stopPropagation();const G=Ve[B];if(!G||G.locked)return;const le=P.touches?P.touches[0].clientX:P.clientX,ye=P.touches?P.touches[0].clientY:P.clientY,je=mt(le,ye),_e=G.originalWidth_mm*(G.scale||1),ge=G.originalHeight_mm*(G.scale||1);let Te;switch(k){case"nw":Te={x:G.position.x+_e,y:G.position.y+ge};break;case"ne":Te={x:G.position.x,y:G.position.y+ge};break;case"sw":Te={x:G.position.x+_e,y:G.position.y};break;case"se":default:Te={x:G.position.x,y:G.position.y};break}const Qe=Math.sqrt(Math.pow(je.x-Te.x,2)+Math.pow(je.y-Te.y,2));Q({initialDistance:Qe,originalScale:G.scale||1,originalWidth:_e,originalHeight:ge,corner:k,anchorPoint:Te}),z(B),fe(!0)},ci=(P,B)=>{P.stopPropagation();const k=Ve[B];if(!k||k.locked)return;const G=P.touches?P.touches[0].clientX:P.clientX,le=P.touches?P.touches[0].clientY:P.clientY,ye=mt(G,le),je=k.originalWidth_mm*(k.scale||1),_e=k.originalHeight_mm*(k.scale||1),ge={x:k.position.x+je/2,y:k.position.y+_e/2},Te=Math.atan2(ye.y-ge.y,ye.x-ge.x)*(180/Math.PI);Pe({initialAngle:Te,originalRotation:k.rotation||0,motifCenter:ge}),oe(B),q(!0)},Fr=(P,B)=>{P.stopPropagation(),mn(B);const k=Ke[B];if(k!=null&&k.locked)return;const G=P.touches?P.touches[0].clientX:P.clientX,le=P.touches?P.touches[0].clientY:P.clientY,ye=mt(G,le);w({x:ye.x-k.position.x,y:ye.y-k.position.y}),T(B),y(!0)},bn=(P,B)=>{P.stopPropagation(),mn(B),tt.setState({showPropertiesPanel:!0,propertiesPanelUserClosed:!1})},wn=(P,B,k)=>{P.stopPropagation();const G=Ke[B];if(!G||G.locked)return;const le=P.touches?P.touches[0].clientX:P.clientX,ye=P.touches?P.touches[0].clientY:P.clientY,je=mt(le,ye),{width_mm:_e,height_mm:ge}=G;let Te;switch(k){case"n":Te={x:G.position.x+_e/2,y:G.position.y+ge};break;case"s":Te={x:G.position.x+_e/2,y:G.position.y};break;case"e":Te={x:G.position.x,y:G.position.y+ge/2};break;case"w":Te={x:G.position.x+_e,y:G.position.y+ge/2};break;case"nw":Te={x:G.position.x+_e,y:G.position.y+ge};break;case"ne":Te={x:G.position.x,y:G.position.y+ge};break;case"sw":Te={x:G.position.x+_e,y:G.position.y};break;case"se":default:Te={x:G.position.x,y:G.position.y};break}const Qe=Math.sqrt(Math.pow(je.x-Te.x,2)+Math.pow(je.y-Te.y,2));De({initialDistance:Qe,originalWidth:_e,originalHeight:ge,aspectLocked:G.aspectLocked,corner:k,anchorPoint:Te}),ve(B),Ae(!0)},di=(P,B)=>{P.stopPropagation();const k=Ke[B];if(!k||k.locked)return;const G=P.touches?P.touches[0].clientX:P.clientX,le=P.touches?P.touches[0].clientY:P.clientY,ye=mt(G,le),{width_mm:je,height_mm:_e}=k,ge={x:k.position.x+je/2,y:k.position.y+_e/2},Te=Math.atan2(ye.y-ge.y,ye.x-ge.x)*(180/Math.PI);R({initialAngle:Te,originalRotation:k.rotation||0,shapeCenter:ge}),ne(B),C(!0)},_n=(P,B)=>{if(P.stopPropagation(),wt===B)return;ii(B);const k=Be[B];if(k!=null&&k.locked)return;const G=P.touches?P.touches[0].clientX:P.clientX,le=P.touches?P.touches[0].clientY:P.clientY,ye=mt(G,le);w({x:ye.x-k.position.x,y:ye.y-k.position.y}),S(B),y(!0)},qo=(P,B)=>{P.stopPropagation(),ii(B),wr(B)},Yo=(P,B,k)=>{P.stopPropagation();const G=Be[B];if(!G||G.locked)return;const le=P.touches?P.touches[0].clientX:P.clientX,ye=P.touches?P.touches[0].clientY:P.clientY,je=mt(le,ye),_e=bi(G.content,G.fontFamily,G.fontSize_mm,G.fontWeight,G.fontStyle);let ge=G.position.x;G.textAlign==="center"?ge-=_e.width/2:G.textAlign==="right"&&(ge-=_e.width);const Te=G.position.y-G.fontSize_mm;let Qe;switch(k){case"nw":Qe={x:ge+_e.width,y:Te+G.fontSize_mm*1.2};break;case"ne":Qe={x:ge,y:Te+G.fontSize_mm*1.2};break;case"sw":Qe={x:ge+_e.width,y:Te};break;case"se":default:Qe={x:ge,y:Te};break}const Nt=Math.sqrt(Math.pow(je.x-Qe.x,2)+Math.pow(je.y-Qe.y,2));ue({initialDistance:Nt,originalFontSize:G.fontSize_mm,originalPosition:{...G.position},originalBounds:_e,textAlign:G.textAlign,corner:k,anchorPoint:Qe}),L(B),Z(!0)},gt=(P,B)=>{P.stopPropagation();const k=Be[B];if(!k||k.locked)return;const G=P.touches?P.touches[0].clientX:P.clientX,le=P.touches?P.touches[0].clientY:P.clientY,ye=mt(G,le),je=bi(k.content,k.fontFamily,k.fontSize_mm,k.fontWeight,k.fontStyle);let _e=k.position.x;k.textAlign==="center"?_e=k.position.x:k.textAlign==="right"?_e=k.position.x-je.width/2:_e=k.position.x+je.width/2;const ge={x:_e,y:k.position.y-k.fontSize_mm*.4},Te=Math.atan2(ye.y-ge.y,ye.x-ge.x)*(180/Math.PI);se({initialAngle:Te,originalRotation:k.rotation||0,textCenter:ge}),ae(B),$(!0)};A.useEffect(()=>{y(!1),_(null),N(null),I(null),T(null),S(null),w(null)},[Ze.width_mm,Ze.length_mm]),A.useEffect(()=>{if(!v||!j&&!E&&!O&&!te&&!V)return;const P=k=>{const G=k.touches?k.touches[0].clientX:k.clientX,le=k.touches?k.touches[0].clientY:k.clientY,ye=mt(G,le);let je={x:ye.x-b.x,y:ye.y-b.y};if(Mt&&(je=jC(je,nr)),j){const _e=Je[j],ge={width_mm:_e.template.dimensions.width_mm*_e.scale,length_mm:_e.template.dimensions.length_mm*_e.scale};je=bu(je,ge,Ze),ot(j,je)}else if(E)pt(E,je);else if(O){const _e=Ve[O],ge={width_mm:_e.originalWidth_mm*(_e.scale||1),length_mm:_e.originalHeight_mm*(_e.scale||1)};je=bu(je,ge,Ze),et(O,je)}else if(te){const _e=Ke[te],ge={width_mm:_e.width_mm,length_mm:_e.height_mm};je=bu(je,ge,Ze),Dr(te,je)}else V&&Kr(V,je)},B=()=>{if(j||E||O||te||V){const{addToHistory:k}=tt.getState();k()}y(!1),_(null),N(null),I(null),T(null),S(null),w(null)};return window.addEventListener("mousemove",P),window.addEventListener("mouseup",B),window.addEventListener("touchmove",P,{passive:!1}),window.addEventListener("touchend",B),window.addEventListener("touchcancel",B),()=>{window.removeEventListener("mousemove",P),window.removeEventListener("mouseup",B),window.removeEventListener("touchmove",P),window.removeEventListener("touchend",B),window.removeEventListener("touchcancel",B)}},[v,j,E,O,te,V,b,Je,Fe,Ve,Ke,Be,Mt,nr,Ze,ot,pt,et,Dr,Kr]),A.useEffect(()=>{if(!K||!U||!H)return;const P=k=>{const G=k.touches?k.touches[0].clientX:k.clientX,le=k.touches?k.touches[0].clientY:k.clientY,ye=mt(G,le),je=Ve[U];if(!je)return;const ge=Math.sqrt(Math.pow(ye.x-H.anchorPoint.x,2)+Math.pow(ye.y-H.anchorPoint.y,2))/H.initialDistance;let Te=H.originalScale*ge;Te=Math.max(.1,Te),Te=Math.round(Te*100)/100;const Qe=je.originalWidth_mm*Te,Nt=je.originalHeight_mm*Te;let dt;switch(H.corner){case"nw":dt={x:H.anchorPoint.x-Qe,y:H.anchorPoint.y-Nt};break;case"ne":dt={x:H.anchorPoint.x,y:H.anchorPoint.y-Nt};break;case"sw":dt={x:H.anchorPoint.x-Qe,y:H.anchorPoint.y};break;case"se":default:dt={x:H.anchorPoint.x,y:H.anchorPoint.y};break}$n(U,Te),et(U,dt)},B=()=>{const{addToHistory:k}=tt.getState();k(),fe(!1),z(null),Q(null)};return window.addEventListener("mousemove",P),window.addEventListener("mouseup",B),window.addEventListener("touchmove",P,{passive:!1}),window.addEventListener("touchend",B),window.addEventListener("touchcancel",B),()=>{window.removeEventListener("mousemove",P),window.removeEventListener("mouseup",B),window.removeEventListener("touchmove",P),window.removeEventListener("touchend",B),window.removeEventListener("touchcancel",B)}},[K,U,H,Ve,$n,et]),A.useEffect(()=>{if(!W||!re||!pe)return;const P=k=>{const G=k.touches?k.touches[0].clientX:k.clientX,le=k.touches?k.touches[0].clientY:k.clientY,ye=mt(G,le),_e=Math.atan2(ye.y-pe.motifCenter.y,ye.x-pe.motifCenter.x)*(180/Math.PI)-pe.initialAngle;let ge=pe.originalRotation+_e;ge=(ge%360+360)%360,k.shiftKey&&(ge=Math.round(ge/15)*15),ge=Math.round(ge*10)/10,si(re,ge)},B=()=>{const{addToHistory:k}=tt.getState();k(),q(!1),oe(null),Pe(null)};return window.addEventListener("mousemove",P),window.addEventListener("mouseup",B),window.addEventListener("touchmove",P,{passive:!1}),window.addEventListener("touchend",B),window.addEventListener("touchcancel",B),()=>{window.removeEventListener("mousemove",P),window.removeEventListener("mouseup",B),window.removeEventListener("touchmove",P),window.removeEventListener("touchend",B),window.removeEventListener("touchcancel",B)}},[W,re,pe,si]),A.useEffect(()=>{if(!Re||!Ce||!me)return;const P=k=>{const G=k.touches?k.touches[0].clientX:k.clientX,le=k.touches?k.touches[0].clientY:k.clientY,ye=mt(G,le);if(!Ke[Ce])return;const ge=Math.sqrt(Math.pow(ye.x-me.anchorPoint.x,2)+Math.pow(ye.y-me.anchorPoint.y,2))/me.initialDistance;let Te,Qe;const Nt=me.corner,dt=["n","s","e","w"].includes(Nt);if(me.aspectLocked)Te=me.originalWidth*ge,Qe=me.originalHeight*ge;else if(dt){const sr=Math.abs(ye.y-me.anchorPoint.y),Zo=Math.abs(ye.x-me.anchorPoint.x);Nt==="n"||Nt==="s"?(Te=me.originalWidth,Qe=Math.max(100,sr)):(Te=Math.max(100,Zo),Qe=me.originalHeight)}else{const sr=Math.abs(ye.x-me.anchorPoint.x),Zo=Math.abs(ye.y-me.anchorPoint.y);Te=Math.max(100,sr),Qe=Math.max(100,Zo)}Te=Math.round(Te),Qe=Math.round(Qe);let lt;switch(Nt){case"n":lt={x:me.anchorPoint.x-Te/2,y:me.anchorPoint.y-Qe};break;case"s":lt={x:me.anchorPoint.x-Te/2,y:me.anchorPoint.y};break;case"e":lt={x:me.anchorPoint.x,y:me.anchorPoint.y-Qe/2};break;case"w":lt={x:me.anchorPoint.x-Te,y:me.anchorPoint.y-Qe/2};break;case"nw":lt={x:me.anchorPoint.x-Te,y:me.anchorPoint.y-Qe};break;case"ne":lt={x:me.anchorPoint.x,y:me.anchorPoint.y-Qe};break;case"sw":lt={x:me.anchorPoint.x-Te,y:me.anchorPoint.y};break;case"se":default:lt={x:me.anchorPoint.x,y:me.anchorPoint.y};break}gn(Ce,Te,Qe),Dr(Ce,lt)},B=()=>{const{addToHistory:k}=tt.getState();k(),Ae(!1),ve(null),De(null)};return window.addEventListener("mousemove",P),window.addEventListener("mouseup",B),window.addEventListener("touchmove",P,{passive:!1}),window.addEventListener("touchend",B),window.addEventListener("touchcancel",B),()=>{window.removeEventListener("mousemove",P),window.removeEventListener("mouseup",B),window.removeEventListener("touchmove",P),window.removeEventListener("touchend",B),window.removeEventListener("touchcancel",B)}},[Re,Ce,me,Ke,gn,Dr]),A.useEffect(()=>{if(!Xe||!ce||!F)return;const P=k=>{const G=k.touches?k.touches[0].clientX:k.clientX,le=k.touches?k.touches[0].clientY:k.clientY,ye=mt(G,le),_e=Math.atan2(ye.y-F.shapeCenter.y,ye.x-F.shapeCenter.x)*(180/Math.PI)-F.initialAngle;let ge=F.originalRotation+_e;ge=(ge%360+360)%360,k.shiftKey&&(ge=Math.round(ge/15)*15),ge=Math.round(ge*10)/10,hr(ce,ge)},B=()=>{const{addToHistory:k}=tt.getState();k(),C(!1),ne(null),R(null)};return window.addEventListener("mousemove",P),window.addEventListener("mouseup",B),window.addEventListener("touchmove",P,{passive:!1}),window.addEventListener("touchend",B),window.addEventListener("touchcancel",B),()=>{window.removeEventListener("mousemove",P),window.removeEventListener("mouseup",B),window.removeEventListener("touchmove",P),window.removeEventListener("touchend",B),window.removeEventListener("touchcancel",B)}},[Xe,ce,F,hr]),A.useEffect(()=>{if(!M||!Y||!J)return;const P=k=>{const G=k.touches?k.touches[0].clientX:k.clientX,le=k.touches?k.touches[0].clientY:k.clientY,ye=mt(G,le);if(!Be[Y])return;const ge=Math.sqrt(Math.pow(ye.x-J.anchorPoint.x,2)+Math.pow(ye.y-J.anchorPoint.y,2))/J.initialDistance;let Te=J.originalFontSize*ge;Te=Math.max(50,Te),Te=Math.round(Te);const Qe=Te/J.originalFontSize,Nt=J.originalBounds.width*Qe,{corner:dt,anchorPoint:lt,textAlign:sr,originalPosition:Zo,originalBounds:l7,originalFontSize:c7}=J;let Ut={...Zo};switch(dt){case"nw":sr==="left"?Ut.x=lt.x-Nt:sr==="center"?Ut.x=lt.x-Nt/2:Ut.x=lt.x,Ut.y=lt.y-Te*.2;break;case"ne":sr==="left"?Ut.x=lt.x:sr==="center"?Ut.x=lt.x+Nt/2:Ut.x=lt.x+Nt,Ut.y=lt.y-Te*.2;break;case"sw":sr==="left"?Ut.x=lt.x-Nt:sr==="center"?Ut.x=lt.x-Nt/2:Ut.x=lt.x,Ut.y=lt.y+Te;break;case"se":default:sr==="left"?Ut.x=lt.x:sr==="center"?Ut.x=lt.x+Nt/2:Ut.x=lt.x+Nt,Ut.y=lt.y+Te;break}_r(Y,Te),Kr(Y,Ut)},B=()=>{const{addToHistory:k}=tt.getState();k(),Z(!1),L(null),ue(null)};return window.addEventListener("mousemove",P),window.addEventListener("mouseup",B),window.addEventListener("touchmove",P,{passive:!1}),window.addEventListener("touchend",B),window.addEventListener("touchcancel",B),()=>{window.removeEventListener("mousemove",P),window.removeEventListener("mouseup",B),window.removeEventListener("touchmove",P),window.removeEventListener("touchend",B),window.removeEventListener("touchcancel",B)}},[M,Y,J,Be,_r,Kr]),A.useEffect(()=>{if(!ie||!X||!we)return;const P=k=>{const G=k.touches?k.touches[0].clientX:k.clientX,le=k.touches?k.touches[0].clientY:k.clientY,ye=mt(G,le),_e=Math.atan2(ye.y-we.textCenter.y,ye.x-we.textCenter.x)*(180/Math.PI)-we.initialAngle;let ge=we.originalRotation+_e;ge=(ge%360+360)%360,k.shiftKey&&(ge=Math.round(ge/15)*15),ge=Math.round(ge*10)/10,oi(X,ge)},B=()=>{const{addToHistory:k}=tt.getState();k(),$(!1),ae(null),se(null)};return window.addEventListener("mousemove",P),window.addEventListener("mouseup",B),window.addEventListener("touchmove",P,{passive:!1}),window.addEventListener("touchend",B),window.addEventListener("touchcancel",B),()=>{window.removeEventListener("mousemove",P),window.removeEventListener("mouseup",B),window.removeEventListener("touchmove",P),window.removeEventListener("touchend",B),window.removeEventListener("touchcancel",B)}},[ie,X,we,oi]);const Sn=P=>{if(ir&&Sr&&(P.target===P.currentTarget||P.target.tagName==="svg"||P.target.closest("svg"))){P.preventDefault(),P.stopPropagation();const B=Date.now(),k=B-be;if(Ne(B),k<300&&k>0){In();return}const G=P.clientX,le=P.clientY,ye=mt(G,le),je=Ke[Sr];if(je){const _e=(ye.x-je.position.x)/je.width_mm,ge=(ye.y-je.position.y)/je.height_mm,Te=Math.max(-.5,Math.min(1.5,_e)),Qe=Math.max(-.5,Math.min(1.5,ge));Vo(Te,Qe)}return}P.target===P.currentTarget&&(Ft(),Kt(),Ir(),_t(),rt(),qe(null))},Xo=()=>{a(P=>Math.min(P*1.25,5))},Cs=()=>{a(P=>Math.max(P/1.25,.25))},Hi=()=>{a(1),c({x:0,y:0})},Es=P=>{if(P.ctrlKey||P.metaKey){P.preventDefault();const B=P.deltaY*-.002;a(k=>Math.min(Math.max(k+k*B,.25),5))}else{P.preventDefault();const B=1;c(k=>({x:k.x-P.deltaX*B,y:k.y-P.deltaY*B}))}},Ts=P=>{(P.button===1||P.button===0&&p)&&(P.preventDefault(),P.stopPropagation(),u(!0),h({x:P.clientX-l.x,y:P.clientY-l.y}))},Ko=P=>{d&&c({x:P.clientX-f.x,y:P.clientY-f.y})},$t=()=>{u(!1)},Zt=P=>{const B=P[0].clientX-P[1].clientX,k=P[0].clientY-P[1].clientY;return Math.sqrt(B*B+k*k)},Ui=P=>({x:(P[0].clientX+P[1].clientX)/2,y:(P[0].clientY+P[1].clientY)/2}),Wi=P=>{if(P.touches.length===2){P.preventDefault();const B=Zt(P.touches),k=Ui(P.touches);x({active:!0,initialDistance:B,initialZoom:s,initialPan:{...l},initialCenter:k})}},ui=P=>{if(P.touches.length===2&&m.active){P.preventDefault();const k=Zt(P.touches)/m.initialDistance;let G=m.initialZoom*k;G=Math.min(Math.max(G,.25),5);const le=Ui(P.touches),ye=le.x-m.initialCenter.x,je=le.y-m.initialCenter.y;a(G),c({x:m.initialPan.x+ye,y:m.initialPan.y+je})}},ee=P=>{P.touches.length<2&&x({active:!1,initialDistance:0,initialZoom:1,initialPan:{x:0,y:0},initialCenter:{x:0,y:0}})};A.useEffect(()=>{if(d){const P=k=>Ko(k),B=()=>$t();return window.addEventListener("mousemove",P),window.addEventListener("mouseup",B),()=>{window.removeEventListener("mousemove",P),window.removeEventListener("mouseup",B)}}},[d,f]),A.useEffect(()=>{const P=k=>{if(k.code==="Space"&&!k.repeat){if(k.target.tagName==="INPUT"||k.target.tagName==="TEXTAREA")return;k.preventDefault(),g(!0)}if(k.code==="Escape"&&ir&&Sr&&(k.preventDefault(),yn()),k.code==="Enter"&&ir&&Sr&&(k.preventDefault(),In()),(k.code==="Delete"||k.code==="Backspace")&&Yt&&He!==null){if(k.target.tagName==="INPUT"||k.target.tagName==="TEXTAREA")return;const G=Ke[Yt];G&&(G.shapeType==="path"||G.shapeType==="blob")&&G.editPointsVisible&&(k.preventDefault(),Dn(Yt,He),qe(null))}},B=k=>{k.code==="Space"&&(g(!1),u(!1))};return window.addEventListener("keydown",P),window.addEventListener("keyup",B),()=>{window.removeEventListener("keydown",P),window.removeEventListener("keyup",B)}},[ir,Sr,yn,In,Yt,He,Ke,Dn]);const he=P=>{if(ir&&Sr){const B=mt(P.clientX,P.clientY);Oe(B)}},de=ir&&Sr?Ke[Sr]:null,Se=((We=de==null?void 0:de.controlPoints)==null?void 0:We.length)>0?de.controlPoints[de.controlPoints.length-1]:null;return o.jsxs("div",{className:`court-canvas ${ir?"court-canvas--drawing":""}`,onClick:Sn,onMouseMove:he,children:[ir&&o.jsx("div",{className:"court-canvas__drawing-indicator",children:"Click to add points  Double-click or Enter to finish  Escape to cancel"}),o.jsxs("div",{className:"court-canvas__zoom-controls",children:[o.jsx("button",{onClick:Xo,className:"court-canvas__zoom-btn",title:"Zoom In (Ctrl + Scroll)",children:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"11",cy:"11",r:"8"}),o.jsx("line",{x1:"11",y1:"8",x2:"11",y2:"14"}),o.jsx("line",{x1:"8",y1:"11",x2:"14",y2:"11"}),o.jsx("path",{d:"m21 21-4.35-4.35"})]})}),o.jsx("button",{onClick:Cs,className:"court-canvas__zoom-btn",title:"Zoom Out (Ctrl + Scroll)",children:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"11",cy:"11",r:"8"}),o.jsx("line",{x1:"8",y1:"11",x2:"14",y2:"11"}),o.jsx("path",{d:"m21 21-4.35-4.35"})]})}),o.jsx("button",{onClick:Hi,className:"court-canvas__zoom-btn",title:"Reset View",children:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M1 4v6h6"}),o.jsx("path",{d:"M23 20v-6h-6"}),o.jsx("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})]})}),o.jsxs("span",{className:"court-canvas__zoom-level",title:"Scroll to pan, Ctrl+Scroll to zoom, Space+Drag to pan",children:[Math.round(s*100),"%"]})]}),o.jsx("div",{ref:i,className:"court-canvas__viewport",onWheel:Es,onMouseDown:Ts,onTouchStart:Wi,onTouchMove:ui,onTouchEnd:ee,style:{cursor:d?"grabbing":p?"grab":void 0,touchAction:"none"},children:o.jsx("div",{className:"court-canvas__transform-wrapper",style:{transform:`translate(${l.x}px, ${l.y}px) scale(${s})`,transformOrigin:"center center"},children:o.jsxs("svg",{ref:n,className:"court-canvas__svg",viewBox:`0 0 ${Ze.width_mm} ${Ze.length_mm}`,preserveAspectRatio:"xMidYMid meet",children:[o.jsx("rect",{x:"0",y:"0",width:Ze.width_mm,height:Ze.length_mm,fill:Ze.color.hex,className:"court-canvas__surface"}),at.map(P=>{if(P.startsWith("court-")){const B=Je[P];return!B||B.visible===!1?null:o.jsx(rE,{court:B,isSelected:P===qt,onMouseDown:k=>li(k,P),onTouchStart:k=>li(k,P),onDoubleClick:k=>js(k,P),svgRef:n},P)}if(P.startsWith("track-")){const B=Fe[P];return!B||B.visible===!1?null:o.jsx(LC,{track:B,isSelected:P===ri,onMouseDown:k=>zn(k,P),onTouchStart:k=>zn(k,P),onDoubleClick:k=>Fn(k,P),svgRef:n},P)}if(P.startsWith("motif-")){const B=Ve[P];return!B||B.visible===!1?null:o.jsx(DC,{motif:B,isSelected:P===Mn,onMouseDown:k=>fr(k,P),onTouchStart:k=>fr(k,P),onDoubleClick:k=>Zr(k,P),onScaleStart:(k,G)=>Bi(k,P,G),onRotateStart:k=>ci(k,P)},P)}if(P.startsWith("shape-")){const B=Ke[P];return!B||B.visible===!1?null:B.shapeType==="blob"?o.jsx(YC,{shape:B,isSelected:P===Yt,onMouseDown:k=>Fr(k,P),onTouchStart:k=>Fr(k,P),onDoubleClick:k=>bn(k,P),onScaleStart:(k,G)=>wn(k,P,G),onRotateStart:k=>di(k,P),onPointDrag:(k,G,le)=>zr(P,k,G,le),onHandleDrag:(k,G,le,ye)=>vn(P,k,G,le,ye),onDragEnd:()=>ai(),selectedPointIndex:P===Yt?He:null,onPointSelect:k=>qe(k),onPointDelete:k=>Dn(P,k)},P):B.shapeType==="path"?o.jsx(KC,{shape:B,isSelected:P===Yt,onMouseDown:k=>Fr(k,P),onTouchStart:k=>Fr(k,P),onDoubleClick:k=>bn(k,P),onScaleStart:(k,G)=>wn(k,P,G),onRotateStart:k=>di(k,P),onPointDrag:(k,G,le)=>xn(P,k,G,le),onHandleDrag:(k,G,le,ye)=>kr(P,k,G,le,ye),onDragEnd:()=>ks(),selectedPointIndex:P===Yt?He:null,onPointSelect:k=>qe(k),onPointDelete:k=>Dn(P,k)},P):o.jsx(VC,{shape:B,isSelected:P===Yt,onMouseDown:k=>Fr(k,P),onTouchStart:k=>Fr(k,P),onDoubleClick:k=>bn(k,P),onScaleStart:(k,G)=>wn(k,P,G),onRotateStart:k=>di(k,P)},P)}if(P.startsWith("text-")){const B=Be[P];return!B||B.visible===!1?null:o.jsx(QC,{text:B,isSelected:P===ni,isEditing:P===wt,onMouseDown:k=>_n(k,P),onTouchStart:k=>_n(k,P),onDoubleClick:k=>qo(k,P),onScaleStart:(k,G)=>Yo(k,P,G),onRotateStart:k=>gt(k,P),onContentChange:k=>Ln(P,k),onEditComplete:()=>Ue()},P)}return null}),ir&&de&&Se&&xe&&o.jsx("line",{x1:de.position.x+Se.x*de.width_mm,y1:de.position.y+Se.y*de.height_mm,x2:xe.x,y2:xe.y,stroke:"#3b82f6",strokeWidth:"50",strokeDasharray:"100 100",opacity:"0.6",pointerEvents:"none"}),ir&&de&&(($e=de.controlPoints)==null?void 0:$e.map((P,B)=>o.jsx("circle",{cx:de.position.x+P.x*de.width_mm,cy:de.position.y+P.y*de.height_mm,r:"80",fill:"#3b82f6",stroke:"#fff",strokeWidth:"20",pointerEvents:"none"},`preview-point-${B}`)))]})})}),o.jsxs("div",{className:"court-canvas__info",children:[o.jsxs("span",{children:[(Ze.width_mm/1e3).toFixed(1),"m  ",(Ze.length_mm/1e3).toFixed(1),"m"]}),Mt&&o.jsxs("span",{className:"court-canvas__grid-indicator",children:["Grid: ",nr,"mm"]})]}),at.length===0&&o.jsxs("div",{className:"court-canvas__empty-state",children:[o.jsx("div",{className:"court-canvas__empty-icon",children:o.jsxs("svg",{width:"72",height:"72",viewBox:"0 0 24 24",fill:"none",children:[o.jsx("path",{d:"M12 2L14.4 8.4L21 9.6L16.2 14.4L17.6 21L12 17.6L6.4 21L7.8 14.4L3 9.6L9.6 8.4L12 2Z",fill:"rgba(255,255,255,0.15)",stroke:"currentColor",strokeWidth:"1.5",strokeLinejoin:"round"}),o.jsx("circle",{cx:"19",cy:"5",r:"1.5",fill:"currentColor",opacity:"0.6"}),o.jsx("circle",{cx:"5",cy:"18",r:"1",fill:"currentColor",opacity:"0.4"}),o.jsx("circle",{cx:"20",cy:"16",r:"0.8",fill:"currentColor",opacity:"0.5"})]})}),o.jsx("h3",{className:"court-canvas__empty-title",children:"Your canvas is ready"}),o.jsx("p",{className:"court-canvas__empty-text",children:"Design your perfect TPV surface in minutes"}),o.jsxs("div",{className:"court-canvas__empty-hints",children:[o.jsxs("div",{className:"court-canvas__hint",children:[o.jsx("span",{className:"court-canvas__hint-icon",children:o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),o.jsx("line",{x1:"9",y1:"3",x2:"9",y2:"21"})]})}),o.jsxs("span",{children:["Add ",o.jsx("strong",{children:"Courts"}),", ",o.jsx("strong",{children:"Tracks"}),", ",o.jsx("strong",{children:"Shapes"})," or ",o.jsx("strong",{children:"Designs"})]})]}),o.jsxs("div",{className:"court-canvas__hint",children:[o.jsx("span",{className:"court-canvas__hint-icon",children:o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M12 5v14M5 12h14"})})}),o.jsx("span",{children:"Click elements in the library to place them"})]}),o.jsxs("div",{className:"court-canvas__hint",children:[o.jsx("span",{className:"court-canvas__hint-icon",children:o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M5 9l4 4-4 4"}),o.jsx("path",{d:"M12 4h7a2 2 0 012 2v12a2 2 0 01-2 2h-7"})]})}),o.jsx("span",{children:"Arrange, customise colours and export"})]})]})]})]})});function rE({court:e,isSelected:t,onMouseDown:r,onTouchStart:n,onDoubleClick:i,svgRef:s}){var d;const{markings:a,zones:l}=kC(e),c=((d=e.courtSurfaceColor)==null?void 0:d.hex)||null;return o.jsxs("g",{className:`court-canvas__court ${t?"court-canvas__court--selected":""}`,transform:CC(e),style:{cursor:"move"},children:[c&&o.jsx("rect",{x:"0",y:"0",width:e.template.dimensions.width_mm,height:e.template.dimensions.length_mm,fill:c,className:"court-canvas__court-surface"}),o.jsx("rect",{x:"0",y:"0",width:e.template.dimensions.width_mm,height:e.template.dimensions.length_mm,fill:"none",pointerEvents:"all",onMouseDown:r,onTouchStart:n,onDoubleClick:i,style:{cursor:"move"}}),l.map(u=>o.jsx(nE,{zone:u},u.id)),a.map(u=>o.jsx(iE,{marking:u},u.id)),t&&o.jsxs(o.Fragment,{children:[o.jsx("rect",{x:"0",y:"0",width:e.template.dimensions.width_mm,height:e.template.dimensions.length_mm,fill:"none",stroke:"#007bff",strokeWidth:"100",strokeDasharray:"400 400",className:"court-canvas__selection-outline"}),o.jsx(EC,{court:e,svgRef:s})]})]})}function nE({zone:e}){switch(e.type){case"rect":return o.jsx("rect",{x:e.x,y:e.y,width:e.width,height:e.height,fill:e.fill});case"circle":return o.jsx("circle",{cx:e.cx,cy:e.cy,r:e.r,fill:e.fill});case"polygon":return o.jsx("polygon",{points:e.points,fill:e.fill});default:return null}}function iE({marking:e}){switch(e.type){case"line":return o.jsx("line",{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,stroke:e.stroke,strokeWidth:e.strokeWidth});case"rect":return o.jsx("rect",{x:e.x,y:e.y,width:e.width,height:e.height,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill});case"circle":return o.jsx("circle",{cx:e.cx,cy:e.cy,r:e.r,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill});case"path":return o.jsx("path",{d:e.d,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill});case"polyline":return o.jsx("polyline",{points:e.points,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill});default:return null}}const _w={"track-flexible":{id:"track-flexible",name:"Running Track",type:"running-track",trackType:"curved",standard:"Flexible Design",category:"track",description:"Flexible running track - adjust size, lanes, and corner radius to fit your surface",parameters:{numLanes:4,laneWidth_mm:1220,width_mm:25e3,height_mm:15e3,cornerRadius:{topLeft:3e3,topRight:3e3,bottomLeft:3e3,bottomRight:3e3},lineWidth_mm:50,startingBoxes:{enabled:!1,depth_mm:400,lineWidth_mm:50}},defaultLineColor:"RH31",defaultTrackSurfaceColor:"RH01",calculatedDimensions:{totalWidth_mm:25e3,totalLength_mm:15e3}},"track-straight":{id:"track-straight",name:"Straight Track",type:"running-track",trackType:"straight",standard:"Sprint Track",category:"track",description:"Straight sprint track - perfect for 60m, 100m, or custom length sprints",parameters:{numLanes:6,laneWidth_mm:1220,width_mm:7320,height_mm:1e5,cornerRadius:{topLeft:0,topRight:0,bottomLeft:0,bottomRight:0},lineWidth_mm:50,startingBoxes:{enabled:!1,depth_mm:400,lineWidth_mm:50}},defaultLineColor:"RH31",defaultTrackSurfaceColor:"RH01",calculatedDimensions:{totalWidth_mm:7320,totalLength_mm:1e5}}};function sE(){return Object.values(_w)}function oE(e){return _w[e]||null}/*! @license DOMPurify 3.3.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.0/LICENSE */var Su,r0;function n0(){if(r0)return Su;r0=1;const{entries:e,setPrototypeOf:t,isFrozen:r,getPrototypeOf:n,getOwnPropertyDescriptor:i}=Object;let{freeze:s,seal:a,create:l}=Object,{apply:c,construct:d}=typeof Reflect<"u"&&Reflect;s||(s=function(J){return J}),a||(a=function(J){return J}),c||(c=function(J,ue){for(var ie=arguments.length,$=new Array(ie>2?ie-2:0),X=2;X<ie;X++)$[X-2]=arguments[X];return J.apply(ue,$)}),d||(d=function(J){for(var ue=arguments.length,ie=new Array(ue>1?ue-1:0),$=1;$<ue;$++)ie[$-1]=arguments[$];return new J(...ie)});const u=N(Array.prototype.forEach),f=N(Array.prototype.lastIndexOf),h=N(Array.prototype.pop),p=N(Array.prototype.push),g=N(Array.prototype.splice),m=N(String.prototype.toLowerCase),x=N(String.prototype.toString),v=N(String.prototype.match),y=N(String.prototype.replace),b=N(String.prototype.indexOf),w=N(String.prototype.trim),j=N(Object.prototype.hasOwnProperty),_=N(RegExp.prototype.test),E=O(TypeError);function N(L){return function(J){J instanceof RegExp&&(J.lastIndex=0);for(var ue=arguments.length,ie=new Array(ue>1?ue-1:0),$=1;$<ue;$++)ie[$-1]=arguments[$];return c(L,J,ie)}}function O(L){return function(){for(var J=arguments.length,ue=new Array(J),ie=0;ie<J;ie++)ue[ie]=arguments[ie];return d(L,ue)}}function I(L,J){let ue=arguments.length>2&&arguments[2]!==void 0?arguments[2]:m;t&&t(L,null);let ie=J.length;for(;ie--;){let $=J[ie];if(typeof $=="string"){const X=ue($);X!==$&&(r(J)||(J[ie]=X),$=X)}L[$]=!0}return L}function te(L){for(let J=0;J<L.length;J++)j(L,J)||(L[J]=null);return L}function T(L){const J=l(null);for(const[ue,ie]of e(L))j(L,ue)&&(Array.isArray(ie)?J[ue]=te(ie):ie&&typeof ie=="object"&&ie.constructor===Object?J[ue]=T(ie):J[ue]=ie);return J}function V(L,J){for(;L!==null;){const ie=i(L,J);if(ie){if(ie.get)return N(ie.get);if(typeof ie.value=="function")return N(ie.value)}L=n(L)}function ue(){return null}return ue}const S=s(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),K=s(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),fe=s(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),U=s(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),z=s(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),H=s(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Q=s(["#text"]),W=s(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),q=s(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),re=s(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),oe=s(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),pe=a(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Pe=a(/<%[\w\W]*|[\w\W]*%>/gm),Re=a(/\$\{[\w\W]*/gm),Ae=a(/^data-[\-\w.\u00B7-\uFFFF]+$/),Ce=a(/^aria-[\-\w]+$/),ve=a(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),me=a(/^(?:\w+script|data):/i),De=a(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Xe=a(/^html$/i),C=a(/^[a-z][.\w]*(-[.\w]+)+$/i);var ce=Object.freeze({__proto__:null,ARIA_ATTR:Ce,ATTR_WHITESPACE:De,CUSTOM_ELEMENT:C,DATA_ATTR:Ae,DOCTYPE_NAME:Xe,ERB_EXPR:Pe,IS_ALLOWED_URI:ve,IS_SCRIPT_OR_DATA:me,MUSTACHE_EXPR:pe,TMPLIT_EXPR:Re});const ne={element:1,text:3,progressingInstruction:7,comment:8,document:9},F=function(){return typeof window>"u"?null:window},R=function(J,ue){if(typeof J!="object"||typeof J.createPolicy!="function")return null;let ie=null;const $="data-tt-policy-suffix";ue&&ue.hasAttribute($)&&(ie=ue.getAttribute($));const X="dompurify"+(ie?"#"+ie:"");try{return J.createPolicy(X,{createHTML(ae){return ae},createScriptURL(ae){return ae}})}catch{return console.warn("TrustedTypes policy "+X+" could not be created."),null}},M=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Z(){let L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:F();const J=B=>Z(B);if(J.version="3.3.0",J.removed=[],!L||!L.document||L.document.nodeType!==ne.document||!L.Element)return J.isSupported=!1,J;let{document:ue}=L;const ie=ue,$=ie.currentScript,{DocumentFragment:X,HTMLTemplateElement:ae,Node:we,Element:se,NodeFilter:xe,NamedNodeMap:Oe=L.NamedNodeMap||L.MozNamedAttrMap,HTMLFormElement:be,DOMParser:Ne,trustedTypes:He}=L,qe=se.prototype,Ze=V(qe,"cloneNode"),Je=V(qe,"remove"),Fe=V(qe,"nextSibling"),Ve=V(qe,"childNodes"),Ke=V(qe,"parentNode");if(typeof ae=="function"){const B=ue.createElement("template");B.content&&B.content.ownerDocument&&(ue=B.content.ownerDocument)}let Be,at="";const{implementation:qt,createNodeIterator:ri,createDocumentFragment:Mn,getElementsByTagName:Yt}=ue,{importNode:ni}=ie;let wt=M();J.isSupported=typeof e=="function"&&typeof Ke=="function"&&qt&&qt.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:Mt,ERB_EXPR:nr,TMPLIT_EXPR:pn,DATA_ATTR:Ft,ARIA_ATTR:Xt,IS_SCRIPT_OR_DATA:Kt,ATTR_WHITESPACE:Xr,CUSTOM_ELEMENT:Ir}=ce;let{IS_ALLOWED_URI:mn}=ce,_t=null;const ii=I({},[...S,...K,...fe,...z,...Q]);let rt=null;const wr=I({},[...W,...q,...re,...oe]);let Ue=Object.seal(l(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ot=null,pt=null;const et=Object.seal(l(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let $n=!0,si=!0,Dr=!1,gn=!0,hr=!1,Kr=!0,_r=!1,oi=!1,Ln=!1,zr=!1,vn=!1,ai=!1,ir=!0,Sr=!1;const Vo="user-content-";let In=!0,yn=!1,xn={},kr=null;const ks=I({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Dn=null;const mt=I({},["audio","video","img","source","image","track"]);let li=null;const js=I({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),zn="http://www.w3.org/1998/Math/MathML",Fn="http://www.w3.org/2000/svg",fr="http://www.w3.org/1999/xhtml";let Zr=fr,Bi=!1,ci=null;const Fr=I({},[zn,Fn,fr],x);let bn=I({},["mi","mo","mn","ms","mtext"]),wn=I({},["annotation-xml"]);const di=I({},["title","style","font","a","script"]);let _n=null;const qo=["application/xhtml+xml","text/html"],Yo="text/html";let gt=null,Sn=null;const Xo=ue.createElement("form"),Cs=function(k){return k instanceof RegExp||k instanceof Function},Hi=function(){let k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Sn&&Sn===k)){if((!k||typeof k!="object")&&(k={}),k=T(k),_n=qo.indexOf(k.PARSER_MEDIA_TYPE)===-1?Yo:k.PARSER_MEDIA_TYPE,gt=_n==="application/xhtml+xml"?x:m,_t=j(k,"ALLOWED_TAGS")?I({},k.ALLOWED_TAGS,gt):ii,rt=j(k,"ALLOWED_ATTR")?I({},k.ALLOWED_ATTR,gt):wr,ci=j(k,"ALLOWED_NAMESPACES")?I({},k.ALLOWED_NAMESPACES,x):Fr,li=j(k,"ADD_URI_SAFE_ATTR")?I(T(js),k.ADD_URI_SAFE_ATTR,gt):js,Dn=j(k,"ADD_DATA_URI_TAGS")?I(T(mt),k.ADD_DATA_URI_TAGS,gt):mt,kr=j(k,"FORBID_CONTENTS")?I({},k.FORBID_CONTENTS,gt):ks,ot=j(k,"FORBID_TAGS")?I({},k.FORBID_TAGS,gt):T({}),pt=j(k,"FORBID_ATTR")?I({},k.FORBID_ATTR,gt):T({}),xn=j(k,"USE_PROFILES")?k.USE_PROFILES:!1,$n=k.ALLOW_ARIA_ATTR!==!1,si=k.ALLOW_DATA_ATTR!==!1,Dr=k.ALLOW_UNKNOWN_PROTOCOLS||!1,gn=k.ALLOW_SELF_CLOSE_IN_ATTR!==!1,hr=k.SAFE_FOR_TEMPLATES||!1,Kr=k.SAFE_FOR_XML!==!1,_r=k.WHOLE_DOCUMENT||!1,zr=k.RETURN_DOM||!1,vn=k.RETURN_DOM_FRAGMENT||!1,ai=k.RETURN_TRUSTED_TYPE||!1,Ln=k.FORCE_BODY||!1,ir=k.SANITIZE_DOM!==!1,Sr=k.SANITIZE_NAMED_PROPS||!1,In=k.KEEP_CONTENT!==!1,yn=k.IN_PLACE||!1,mn=k.ALLOWED_URI_REGEXP||ve,Zr=k.NAMESPACE||fr,bn=k.MATHML_TEXT_INTEGRATION_POINTS||bn,wn=k.HTML_INTEGRATION_POINTS||wn,Ue=k.CUSTOM_ELEMENT_HANDLING||{},k.CUSTOM_ELEMENT_HANDLING&&Cs(k.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Ue.tagNameCheck=k.CUSTOM_ELEMENT_HANDLING.tagNameCheck),k.CUSTOM_ELEMENT_HANDLING&&Cs(k.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Ue.attributeNameCheck=k.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),k.CUSTOM_ELEMENT_HANDLING&&typeof k.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Ue.allowCustomizedBuiltInElements=k.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),hr&&(si=!1),vn&&(zr=!0),xn&&(_t=I({},Q),rt=[],xn.html===!0&&(I(_t,S),I(rt,W)),xn.svg===!0&&(I(_t,K),I(rt,q),I(rt,oe)),xn.svgFilters===!0&&(I(_t,fe),I(rt,q),I(rt,oe)),xn.mathMl===!0&&(I(_t,z),I(rt,re),I(rt,oe))),k.ADD_TAGS&&(typeof k.ADD_TAGS=="function"?et.tagCheck=k.ADD_TAGS:(_t===ii&&(_t=T(_t)),I(_t,k.ADD_TAGS,gt))),k.ADD_ATTR&&(typeof k.ADD_ATTR=="function"?et.attributeCheck=k.ADD_ATTR:(rt===wr&&(rt=T(rt)),I(rt,k.ADD_ATTR,gt))),k.ADD_URI_SAFE_ATTR&&I(li,k.ADD_URI_SAFE_ATTR,gt),k.FORBID_CONTENTS&&(kr===ks&&(kr=T(kr)),I(kr,k.FORBID_CONTENTS,gt)),In&&(_t["#text"]=!0),_r&&I(_t,["html","head","body"]),_t.table&&(I(_t,["tbody"]),delete ot.tbody),k.TRUSTED_TYPES_POLICY){if(typeof k.TRUSTED_TYPES_POLICY.createHTML!="function")throw E('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof k.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw E('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');Be=k.TRUSTED_TYPES_POLICY,at=Be.createHTML("")}else Be===void 0&&(Be=R(He,$)),Be!==null&&typeof at=="string"&&(at=Be.createHTML(""));s&&s(k),Sn=k}},Es=I({},[...K,...fe,...U]),Ts=I({},[...z,...H]),Ko=function(k){let G=Ke(k);(!G||!G.tagName)&&(G={namespaceURI:Zr,tagName:"template"});const le=m(k.tagName),ye=m(G.tagName);return ci[k.namespaceURI]?k.namespaceURI===Fn?G.namespaceURI===fr?le==="svg":G.namespaceURI===zn?le==="svg"&&(ye==="annotation-xml"||bn[ye]):!!Es[le]:k.namespaceURI===zn?G.namespaceURI===fr?le==="math":G.namespaceURI===Fn?le==="math"&&wn[ye]:!!Ts[le]:k.namespaceURI===fr?G.namespaceURI===Fn&&!wn[ye]||G.namespaceURI===zn&&!bn[ye]?!1:!Ts[le]&&(di[le]||!Es[le]):!!(_n==="application/xhtml+xml"&&ci[k.namespaceURI]):!1},$t=function(k){p(J.removed,{element:k});try{Ke(k).removeChild(k)}catch{Je(k)}},Zt=function(k,G){try{p(J.removed,{attribute:G.getAttributeNode(k),from:G})}catch{p(J.removed,{attribute:null,from:G})}if(G.removeAttribute(k),k==="is")if(zr||vn)try{$t(G)}catch{}else try{G.setAttribute(k,"")}catch{}},Ui=function(k){let G=null,le=null;if(Ln)k="<remove></remove>"+k;else{const _e=v(k,/^[\r\n\t ]+/);le=_e&&_e[0]}_n==="application/xhtml+xml"&&Zr===fr&&(k='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+k+"</body></html>");const ye=Be?Be.createHTML(k):k;if(Zr===fr)try{G=new Ne().parseFromString(ye,_n)}catch{}if(!G||!G.documentElement){G=qt.createDocument(Zr,"template",null);try{G.documentElement.innerHTML=Bi?at:ye}catch{}}const je=G.body||G.documentElement;return k&&le&&je.insertBefore(ue.createTextNode(le),je.childNodes[0]||null),Zr===fr?Yt.call(G,_r?"html":"body")[0]:_r?G.documentElement:je},Wi=function(k){return ri.call(k.ownerDocument||k,k,xe.SHOW_ELEMENT|xe.SHOW_COMMENT|xe.SHOW_TEXT|xe.SHOW_PROCESSING_INSTRUCTION|xe.SHOW_CDATA_SECTION,null)},ui=function(k){return k instanceof be&&(typeof k.nodeName!="string"||typeof k.textContent!="string"||typeof k.removeChild!="function"||!(k.attributes instanceof Oe)||typeof k.removeAttribute!="function"||typeof k.setAttribute!="function"||typeof k.namespaceURI!="string"||typeof k.insertBefore!="function"||typeof k.hasChildNodes!="function")},ee=function(k){return typeof we=="function"&&k instanceof we};function he(B,k,G){u(B,le=>{le.call(J,k,G,Sn)})}const de=function(k){let G=null;if(he(wt.beforeSanitizeElements,k,null),ui(k))return $t(k),!0;const le=gt(k.nodeName);if(he(wt.uponSanitizeElement,k,{tagName:le,allowedTags:_t}),Kr&&k.hasChildNodes()&&!ee(k.firstElementChild)&&_(/<[/\w!]/g,k.innerHTML)&&_(/<[/\w!]/g,k.textContent)||k.nodeType===ne.progressingInstruction||Kr&&k.nodeType===ne.comment&&_(/<[/\w]/g,k.data))return $t(k),!0;if(!(et.tagCheck instanceof Function&&et.tagCheck(le))&&(!_t[le]||ot[le])){if(!ot[le]&&We(le)&&(Ue.tagNameCheck instanceof RegExp&&_(Ue.tagNameCheck,le)||Ue.tagNameCheck instanceof Function&&Ue.tagNameCheck(le)))return!1;if(In&&!kr[le]){const ye=Ke(k)||k.parentNode,je=Ve(k)||k.childNodes;if(je&&ye){const _e=je.length;for(let ge=_e-1;ge>=0;--ge){const Te=Ze(je[ge],!0);Te.__removalCount=(k.__removalCount||0)+1,ye.insertBefore(Te,Fe(k))}}}return $t(k),!0}return k instanceof se&&!Ko(k)||(le==="noscript"||le==="noembed"||le==="noframes")&&_(/<\/no(script|embed|frames)/i,k.innerHTML)?($t(k),!0):(hr&&k.nodeType===ne.text&&(G=k.textContent,u([Mt,nr,pn],ye=>{G=y(G,ye," ")}),k.textContent!==G&&(p(J.removed,{element:k.cloneNode()}),k.textContent=G)),he(wt.afterSanitizeElements,k,null),!1)},Se=function(k,G,le){if(ir&&(G==="id"||G==="name")&&(le in ue||le in Xo))return!1;if(!(si&&!pt[G]&&_(Ft,G))){if(!($n&&_(Xt,G))){if(!(et.attributeCheck instanceof Function&&et.attributeCheck(G,k))){if(!rt[G]||pt[G]){if(!(We(k)&&(Ue.tagNameCheck instanceof RegExp&&_(Ue.tagNameCheck,k)||Ue.tagNameCheck instanceof Function&&Ue.tagNameCheck(k))&&(Ue.attributeNameCheck instanceof RegExp&&_(Ue.attributeNameCheck,G)||Ue.attributeNameCheck instanceof Function&&Ue.attributeNameCheck(G,k))||G==="is"&&Ue.allowCustomizedBuiltInElements&&(Ue.tagNameCheck instanceof RegExp&&_(Ue.tagNameCheck,le)||Ue.tagNameCheck instanceof Function&&Ue.tagNameCheck(le))))return!1}else if(!li[G]){if(!_(mn,y(le,Xr,""))){if(!((G==="src"||G==="xlink:href"||G==="href")&&k!=="script"&&b(le,"data:")===0&&Dn[k])){if(!(Dr&&!_(Kt,y(le,Xr,"")))){if(le)return!1}}}}}}}return!0},We=function(k){return k!=="annotation-xml"&&v(k,Ir)},$e=function(k){he(wt.beforeSanitizeAttributes,k,null);const{attributes:G}=k;if(!G||ui(k))return;const le={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:rt,forceKeepAttr:void 0};let ye=G.length;for(;ye--;){const je=G[ye],{name:_e,namespaceURI:ge,value:Te}=je,Qe=gt(_e),Nt=Te;let dt=_e==="value"?Nt:w(Nt);if(le.attrName=Qe,le.attrValue=dt,le.keepAttr=!0,le.forceKeepAttr=void 0,he(wt.uponSanitizeAttribute,k,le),dt=le.attrValue,Sr&&(Qe==="id"||Qe==="name")&&(Zt(_e,k),dt=Vo+dt),Kr&&_(/((--!?|])>)|<\/(style|title|textarea)/i,dt)){Zt(_e,k);continue}if(Qe==="attributename"&&v(dt,"href")){Zt(_e,k);continue}if(le.forceKeepAttr)continue;if(!le.keepAttr){Zt(_e,k);continue}if(!gn&&_(/\/>/i,dt)){Zt(_e,k);continue}hr&&u([Mt,nr,pn],sr=>{dt=y(dt,sr," ")});const lt=gt(k.nodeName);if(!Se(lt,Qe,dt)){Zt(_e,k);continue}if(Be&&typeof He=="object"&&typeof He.getAttributeType=="function"&&!ge)switch(He.getAttributeType(lt,Qe)){case"TrustedHTML":{dt=Be.createHTML(dt);break}case"TrustedScriptURL":{dt=Be.createScriptURL(dt);break}}if(dt!==Nt)try{ge?k.setAttributeNS(ge,_e,dt):k.setAttribute(_e,dt),ui(k)?$t(k):h(J.removed)}catch{Zt(_e,k)}}he(wt.afterSanitizeAttributes,k,null)},P=function B(k){let G=null;const le=Wi(k);for(he(wt.beforeSanitizeShadowDOM,k,null);G=le.nextNode();)he(wt.uponSanitizeShadowNode,G,null),de(G),$e(G),G.content instanceof X&&B(G.content);he(wt.afterSanitizeShadowDOM,k,null)};return J.sanitize=function(B){let k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},G=null,le=null,ye=null,je=null;if(Bi=!B,Bi&&(B="<!-->"),typeof B!="string"&&!ee(B))if(typeof B.toString=="function"){if(B=B.toString(),typeof B!="string")throw E("dirty is not a string, aborting")}else throw E("toString is not a function");if(!J.isSupported)return B;if(oi||Hi(k),J.removed=[],typeof B=="string"&&(yn=!1),yn){if(B.nodeName){const Te=gt(B.nodeName);if(!_t[Te]||ot[Te])throw E("root node is forbidden and cannot be sanitized in-place")}}else if(B instanceof we)G=Ui("<!---->"),le=G.ownerDocument.importNode(B,!0),le.nodeType===ne.element&&le.nodeName==="BODY"||le.nodeName==="HTML"?G=le:G.appendChild(le);else{if(!zr&&!hr&&!_r&&B.indexOf("<")===-1)return Be&&ai?Be.createHTML(B):B;if(G=Ui(B),!G)return zr?null:ai?at:""}G&&Ln&&$t(G.firstChild);const _e=Wi(yn?B:G);for(;ye=_e.nextNode();)de(ye),$e(ye),ye.content instanceof X&&P(ye.content);if(yn)return B;if(zr){if(vn)for(je=Mn.call(G.ownerDocument);G.firstChild;)je.appendChild(G.firstChild);else je=G;return(rt.shadowroot||rt.shadowrootmode)&&(je=ni.call(ie,je,!0)),je}let ge=_r?G.outerHTML:G.innerHTML;return _r&&_t["!doctype"]&&G.ownerDocument&&G.ownerDocument.doctype&&G.ownerDocument.doctype.name&&_(Xe,G.ownerDocument.doctype.name)&&(ge="<!DOCTYPE "+G.ownerDocument.doctype.name+`>
`+ge),hr&&u([Mt,nr,pn],Te=>{ge=y(ge,Te," ")}),Be&&ai?Be.createHTML(ge):ge},J.setConfig=function(){let B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Hi(B),oi=!0},J.clearConfig=function(){Sn=null,oi=!1},J.isValidAttribute=function(B,k,G){Sn||Hi({});const le=gt(B),ye=gt(k);return Se(le,ye,G)},J.addHook=function(B,k){typeof k=="function"&&p(wt[B],k)},J.removeHook=function(B,k){if(k!==void 0){const G=f(wt[B],k);return G===-1?void 0:g(wt[B],G,1)[0]}return h(wt[B])},J.removeHooks=function(B){wt[B]=[]},J.removeAllHooks=function(){wt=M()},J}var Y=Z();return Su=Y,Su}var aE=self.DOMPurify||(self.DOMPurify=n0().default||n0());const lE=Qc(aE);function ap(e,t={}){if(!e||typeof e!="string")return console.warn("[SVG-SANITIZE] Invalid input:",typeof e),"";const r={USE_PROFILES:{svg:!0,svgFilters:!0},FORBID_TAGS:["script","foreignObject","iframe","embed"],FORBID_ATTR:["onload","onerror","onclick","onmouseover","onmouseout","onmouseenter","onmouseleave","onmousemove","onmousedown","onmouseup","onfocus","onblur","onkeydown","onkeyup","onkeypress","onsubmit","onreset","onselect","onchange","oninput","onanimationstart","onanimationend","onanimationiteration","ontransitionend","ontransitionrun","ontransitionstart","ontransitioncancel","xlink:href",...t.additionalForbiddenAttrs||[]],ALLOW_DATA_ATTR:!0,ALLOW_COMMENTS:!1,RETURN_DOM:!1,RETURN_DOM_FRAGMENT:!1,ALLOWED_URI_REGEXP:/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,HOOKS:{afterSanitizeAttributes:n=>{if(n.hasAttribute("href")){const i=n.getAttribute("href");i&&i.toLowerCase().trim().startsWith("javascript:")&&(n.removeAttribute("href"),console.warn("[SVG-SANITIZE] Removed javascript: href"))}if(n.hasAttribute("xlink:href")){const i=n.getAttribute("xlink:href");i&&(i.toLowerCase().trim().startsWith("javascript:")||i.toLowerCase().trim().startsWith("data:text/html"))&&(n.removeAttribute("xlink:href"),console.warn("[SVG-SANITIZE] Removed dangerous xlink:href"))}}},...t};try{const n=lE.sanitize(e,r);if(!n||!n.includes("<svg"))return console.error("[SVG-SANITIZE] Sanitization removed SVG content - input may be malicious"),"";const i=e.length,s=n.length,a=(i-s)/i*100;return a>10&&console.warn(`[SVG-SANITIZE] Removed ${a.toFixed(1)}% of content (${i-s} chars) - possible malicious SVG detected`),n}catch(n){return console.error("[SVG-SANITIZE] Sanitization failed:",n),""}}function cE(e){if(!e||typeof e!="string")return!1;const t=e.toLowerCase(),r=["<script","javascript:","onload=","onerror=","onclick=","onmouseover=","<foreignobject","<iframe","<embed","data:text/html"];for(const n of r)if(t.includes(n))return console.warn(`[SVG-VALIDATE] Dangerous pattern detected: ${n}`),!1;return t.includes("<svg")?!0:(console.warn("[SVG-VALIDATE] Content does not appear to be valid SVG (no <svg> tag found)"),!1)}function dE(e){return e.replace("#","").toLowerCase()}async function ts(e,t,r=null){try{let n;if(r)n=r,console.log(`[SVG-RECOLOR] Using provided SVG text (${n.length} chars)`);else{console.log("[SVG-RECOLOR] Fetching SVG from:",e);const g=await fetch(e);if(!g.ok)throw new Error(`Failed to fetch SVG: ${g.status} ${g.statusText}`);n=await g.text(),console.log(`[SVG-RECOLOR] Fetched SVG (${n.length} chars)`)}console.log("[SVG-RECOLOR] Sanitizing SVG...");const i=ap(n);if(!i)throw new Error("SVG sanitization failed - content rejected");const a=new DOMParser().parseFromString(i,"image/svg+xml"),l=a.querySelector("parsererror");if(l)throw new Error(`SVG parse error: ${l.textContent}`);const c=a.documentElement;if(c.tagName!=="svg")throw new Error("Invalid SVG: root element is not <svg>");const d=uE(c,t);console.log("[SVG-RECOLOR] Recoloring complete:",d);const f=new XMLSerializer().serializeToString(a),h=new Blob([f],{type:"image/svg+xml"});return{dataUrl:URL.createObjectURL(h),svgText:f,stats:d}}catch(n){throw console.error("[SVG-RECOLOR] Error:",n),n}}function uE(e,t){const r={totalElements:0,fillsReplaced:0,strokesReplaced:0,stopColorsReplaced:0,stylesProcessed:0,colorsNotMapped:new Set},n=e.querySelectorAll("*");r.totalElements=n.length;for(const a of n){const l=a.getAttribute("fill");if(l&&l!=="none"){const f=Nn(l,t,r.colorsNotMapped);f!==l&&(f==="transparent"||f==="none"?(a.setAttribute("fill","none"),a.setAttribute("fill-opacity","0")):a.setAttribute("fill",f),r.fillsReplaced++)}const c=a.getAttribute("stroke");if(c&&c!=="none"){const f=Nn(c,t,r.colorsNotMapped);f!==c&&(f==="transparent"||f==="none"?(a.setAttribute("stroke","none"),a.setAttribute("stroke-opacity","0")):a.setAttribute("stroke",f),r.strokesReplaced++)}const d=a.getAttribute("stop-color");if(d&&d!=="none"){const f=Nn(d,t,r.colorsNotMapped);f!==d&&(a.setAttribute("stop-color",f),r.stopColorsReplaced++)}const u=a.getAttribute("style");if(u){const f=o0(u,t,r);f!==u&&(a.setAttribute("style",f),r.stylesProcessed++)}}const i=e.querySelectorAll("style");for(const a of i){const l=a.textContent,c=fE(l,t,r);c!==l&&(a.textContent=c,r.stylesProcessed++)}const s=e.querySelectorAll("stop");for(const a of s){const l=a.getAttribute("stop-color");if(l&&l!=="none"){const d=Nn(l,t,r.colorsNotMapped);d!==l&&(a.setAttribute("stop-color",d),r.stopColorsReplaced++)}const c=a.getAttribute("style");if(c&&c.includes("stop-color")){const d=o0(c,t,r);d!==c&&(a.setAttribute("style",d),r.stylesProcessed++)}}return r}function Nn(e,t,r){const n=pE(e);if(!n)return e;const i=`#${n}`,s=t.get(i);if(s)return s.blendHex;const a=i0(n);if(!a)return e;const l=s0(a);let c=null,d=1/0;for(const[u,f]of t.entries()){const h=i0(u.replace("#",""));if(!h)continue;const p=s0(h),g=hE(l,p);if(g<d&&(d=g,c=f),g<=9)return console.log(`[SVG-RECOLOR] Tolerance match: ${i}  ${u} (E=${g.toFixed(2)})`),f.blendHex}return c?(console.log(`[SVG-RECOLOR] Fallback to nearest: ${i}  ${c.blendHex} (E=${d.toFixed(2)})`),r&&r.add(e),c.blendHex):(console.warn(`[SVG-RECOLOR] No mapping found: ${i}`),e)}function i0(e){if(e.length!==6)return null;const t=parseInt(e.substring(0,2),16),r=parseInt(e.substring(2,4),16),n=parseInt(e.substring(4,6),16);return isNaN(t)||isNaN(r)||isNaN(n)?null:{r:t,g:r,b:n}}function s0(e){let t=e.r/255,r=e.g/255,n=e.b/255;t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92,r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92,n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92;const i=(t*.4124+r*.3576+n*.1805)*100,s=(t*.2126+r*.7152+n*.0722)*100,a=(t*.0193+r*.1192+n*.9505)*100,l=95.047,c=100,d=108.883;let u=i/l,f=s/c,h=a/d;return u=u>.008856?Math.pow(u,1/3):7.787*u+16/116,f=f>.008856?Math.pow(f,1/3):7.787*f+16/116,h=h>.008856?Math.pow(h,1/3):7.787*h+16/116,{L:116*f-16,a:500*(u-f),b:200*(f-h)}}function hE(e,t){const s=Math.PI*2,a=Math.PI,l=(e.L+t.L)/2,c=Math.sqrt(e.a*e.a+e.b*e.b),d=Math.sqrt(t.a*t.a+t.b*t.b),u=(c+d)/2,f=.5*(1-Math.sqrt(Math.pow(u,7)/(Math.pow(u,7)+Math.pow(25,7)))),h=e.a*(1+f),p=t.a*(1+f),g=Math.sqrt(h*h+e.b*e.b),m=Math.sqrt(p*p+t.b*t.b),x=(g+m)/2;let v=Math.atan2(e.b,h);v<0&&(v+=s);let y=Math.atan2(t.b,p);y<0&&(y+=s);const b=Math.abs(v-y)>a?(v+y+s)/2:(v+y)/2,w=1-.17*Math.cos(b-Math.PI/6)+.24*Math.cos(2*b)+.32*Math.cos(3*b+Math.PI/30)-.2*Math.cos(4*b-63*Math.PI/180);let j=y-v;Math.abs(j)>a&&(j=j>0?j-s:j+s);const _=t.L-e.L,E=m-g,N=2*Math.sqrt(g*m)*Math.sin(j/2),O=1+.015*Math.pow(l-50,2)/Math.sqrt(20+Math.pow(l-50,2)),I=1+.045*x,te=1+.015*x*w,T=30*Math.PI/180*Math.exp(-Math.pow((b-275*Math.PI/180)/(25*Math.PI/180),2)),S=-(2*Math.sqrt(Math.pow(x,7)/(Math.pow(x,7)+Math.pow(25,7))))*Math.sin(2*T);return Math.sqrt(Math.pow(_/(1*O),2)+Math.pow(E/(1*I),2)+Math.pow(N/(1*te),2)+S*(E/(1*I))*(N/(1*te)))}function o0(e,t,r){let n=e;return n=n.replace(/fill:\s*([^;]+)/gi,(i,s)=>`fill: ${Nn(s.trim(),t,r.colorsNotMapped)}`),n=n.replace(/stroke:\s*([^;]+)/gi,(i,s)=>`stroke: ${Nn(s.trim(),t,r.colorsNotMapped)}`),n=n.replace(/stop-color:\s*([^;]+)/gi,(i,s)=>`stop-color: ${Nn(s.trim(),t,r.colorsNotMapped)}`),n}function fE(e,t,r){let n=e,i=0;return n=n.replace(/fill:\s*([^;}\s]+)/gi,(s,a)=>{const l=a.trim(),c=Nn(l,t,r.colorsNotMapped);return c!==l&&(i++,console.log(`[SVG-RECOLOR-CSS] Replaced fill: ${l}  ${c}`)),`fill: ${c}`}),n=n.replace(/stroke:\s*([^;}\s]+)/gi,(s,a)=>{const l=a.trim(),c=Nn(l,t,r.colorsNotMapped);return c!==l&&(i++,console.log(`[SVG-RECOLOR-CSS] Replaced stroke: ${l}  ${c}`)),`stroke: ${c}`}),n=n.replace(/stop-color:\s*([^;}\s]+)/gi,(s,a)=>{const l=a.trim(),c=Nn(l,t,r.colorsNotMapped);return c!==l&&(i++,console.log(`[SVG-RECOLOR-CSS] Replaced stop-color: ${l}  ${c}`)),`stop-color: ${c}`}),i>0&&console.log(`[SVG-RECOLOR-CSS] Total CSS color replacements: ${i}`),n}function pE(e){const t=e.trim().toLowerCase();if(t.match(/^#?[0-9a-f]{6}$/))return dE(t);const r=t.match(/^#?([0-9a-f]{3})$/);if(r)return r[1].split("").map(a=>a+a).join("");const n=t.match(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/);if(n){const s=parseInt(n[1],10),a=parseInt(n[2],10),l=parseInt(n[3],10);return mE(s,a,l)}const i={white:"ffffff",black:"000000",red:"ff0000",green:"008000",blue:"0000ff",yellow:"ffff00",cyan:"00ffff",magenta:"ff00ff",gray:"808080",grey:"808080",orange:"ffa500",purple:"800080"};return i[t]?i[t]:null}function mE(e,t,r){const n=i=>Math.max(0,Math.min(255,i)).toString(16).padStart(2,"0");return`${n(e)}${n(t)}${n(r)}`}function wo(e){const r=new DOMParser().parseFromString(e,"image/svg+xml"),n=r.querySelector("parsererror");if(n)return console.error("[SVG-REGION-TAGGER] Parse error:",n.textContent),e;const i=r.documentElement;if(!i.hasAttribute("viewBox")){const l=i.getAttribute("width"),c=i.getAttribute("height");if(l&&c){const d=parseFloat(l),u=parseFloat(c);!isNaN(d)&&!isNaN(u)&&(i.setAttribute("viewBox",`0 0 ${d} ${u}`),console.log(`[SVG-REGION-TAGGER] Added viewBox from dimensions: 0 0 ${d} ${u}`))}else{const d=gE(r);d&&(i.setAttribute("viewBox",`${d.x} ${d.y} ${d.width} ${d.height}`),console.log(`[SVG-REGION-TAGGER] Added viewBox from content bounds: ${d.x} ${d.y} ${d.width} ${d.height}`))}}let s=0;return r.querySelectorAll("path, rect, circle, ellipse, polygon, polyline, line").forEach(l=>{l.hasAttribute("data-region-id")||l.setAttribute("data-region-id",`region-${s++}`)}),console.log(`[SVG-REGION-TAGGER] Tagged ${s} regions`),new XMLSerializer().serializeToString(r)}function gE(e){try{const t=e.documentElement.cloneNode(!0),r=document.createElement("div");r.style.position="absolute",r.style.visibility="hidden",document.body.appendChild(r),r.appendChild(t);const n=t.getBBox();if(document.body.removeChild(r),n.width>0&&n.height>0)return{x:Math.floor(n.x),y:Math.floor(n.y),width:Math.ceil(n.width),height:Math.ceil(n.height)}}catch(t){console.warn("[SVG-REGION-TAGGER] Could not calculate content bounds:",t)}return null}function fo(e,t){if(!t||t.size===0)return e;const n=new DOMParser().parseFromString(e,"image/svg+xml"),i=n.querySelector("parsererror");if(i)return console.error("[SVG-REGION-OVERRIDES] Parse error:",i.textContent),e;let s=0;return t.forEach((a,l)=>{const c=typeof a=="string"?a:a.hex,d=n.querySelector(`[data-region-id="${l}"]`);if(d){const u=c==="transparent"||c==="none";if((d.hasAttribute("fill")||u)&&(u?(d.setAttribute("fill","none"),d.setAttribute("fill-opacity","0")):(d.setAttribute("fill",c),d.removeAttribute("fill-opacity")),s++),d.hasAttribute("stroke")&&d.getAttribute("stroke")!=="none"){const h=d.getAttribute("stroke");h&&h!=="#000"&&h!=="#000000"&&h!=="#fff"&&h!=="#ffffff"&&(u?(d.setAttribute("stroke","none"),d.setAttribute("stroke-opacity","0")):d.setAttribute("stroke",c))}const f=d.getAttribute("style");if(f&&f.includes("fill:"))if(u){const h=f.replace(/fill:\s*[^;]+/,"fill: none");d.setAttribute("style",h)}else{const h=f.replace(/fill:\s*[^;]+/,`fill: ${c}`);d.setAttribute("style",h)}}else console.warn(`[SVG-REGION-OVERRIDES] Region not found: ${l}`)}),console.log(`[SVG-REGION-OVERRIDES] Applied ${s} region overrides`),new XMLSerializer().serializeToString(n)}async function Sw(e){var v,y;const t=await ll(e),r=(t==null?void 0:t.design)||t;if(!r)throw new Error("Design not found");if(r.input_mode==="sports_surface")throw new Error("Cannot use a sports surface design as a motif");const n=r.original_svg_url;if(!n||n.startsWith("blob:"))throw new Error("Design does not have a valid original SVG. Please ensure the design was saved after generation.");if(!r.solid_color_mapping&&!r.color_mapping)throw new Error("Design does not have color mappings. Please ensure the design was saved after color mapping.");console.log("[MOTIF] Fetching original SVG from:",n);const i=((v=r.design_data)==null?void 0:v.region_overrides)||r.region_overrides||null,s=((y=r.design_data)==null?void 0:y.original_tagged_svg)||r.original_tagged_svg||null;console.log("[MOTIF] Region overrides:",i?Object.keys(i).length:0,"regions"),console.log("[MOTIF] Original tagged SVG:",s?"present":"not present");const a=i?new Map(Object.entries(i)):null,l=await vE(n);if(!l)throw new Error("Failed to load or sanitize the original SVG.");console.log("[MOTIF] Original SVG loaded, regenerating recolored versions...");let c=null,d=null;if(r.solid_color_mapping&&Object.keys(r.solid_color_mapping).length>0)try{const b=a0(r.solid_color_mapping);console.log("[MOTIF] Solid mapping has",b.size,"colors");const{svgText:w}=await ts(null,b,l);if(c=w,console.log("[MOTIF] Generated solid SVG:",c.length,"chars"),a&&a.size>0&&c){console.log("[MOTIF] Applying",a.size,"region overrides to solid SVG");let j=c;j=wo(c),c=fo(j,a),console.log("[MOTIF] Applied region overrides to solid SVG")}}catch(b){console.error("[MOTIF] Failed to generate solid SVG:",b)}if(r.color_mapping&&Object.keys(r.color_mapping).length>0)try{const b=a0(r.color_mapping);console.log("[MOTIF] Blend mapping has",b.size,"colors");const{svgText:w}=await ts(null,b,l);if(d=w,console.log("[MOTIF] Generated blend SVG:",d.length,"chars"),a&&a.size>0&&d){console.log("[MOTIF] Applying",a.size,"region overrides to blend SVG");let j=wo(d);d=fo(j,a),console.log("[MOTIF] Applied region overrides to blend SVG")}}catch(b){console.error("[MOTIF] Failed to generate blend SVG:",b)}if(!c&&!d)throw new Error("Failed to regenerate TPV-recolored SVG versions.");const u=r.dimensions||{};let f=u.widthMM||u.width_mm||5e3,h=u.lengthMM||u.length_mm||5e3;const p=f===5e3&&h===5e3,g=c||d;if(g){const b=lp(g);if(b&&b.width&&b.height){const w=b.width/b.height;(p||Math.abs(w-1)>.01)&&(w>1?(f=5e3,h=Math.round(5e3/w)):w<1&&(h=5e3,f=Math.round(5e3*w)),console.log("[MOTIF] Corrected dimensions from SVG viewBox:",f,"x",h,"mm (aspect ratio:",w.toFixed(3),")"))}}const m=r.thumbnail_url||r.original_png_url||null,x=c&&d;return{sourceDesignId:e,sourceDesignName:r.name||"Unnamed Design",sourceThumbnailUrl:m,solidSvgContent:c,blendSvgContent:d,svgContent:c||d,hasBothVersions:x,originalWidth_mm:f,originalHeight_mm:h}}function a0(e){const t=new Map;if(!e||typeof e!="object")return t;for(const[r,n]of Object.entries(e)){const i=r.startsWith("#")?r:`#${r}`;t.set(i,n)}return t}async function vE(e){try{console.log("[MOTIF] Fetching SVG from:",e);const t=await fetch(e);if(!t.ok)return console.error("[MOTIF] Failed to fetch SVG:",t.status,t.statusText),null;const r=await t.text();if(console.log("[MOTIF] Fetched content length:",r.length,"chars"),console.log("[MOTIF] Content starts with:",r.substring(0,100)),!cE(r))return console.error("[MOTIF] SVG failed quick validation"),null;const n=ap(r);return n?(console.log("[MOTIF] Sanitized SVG length:",n.length,"chars"),n):(console.error("[MOTIF] SVG sanitization failed"),null)}catch(t){return console.error("[MOTIF] Error fetching SVG:",t),null}}async function kw(e={}){const t=await Fc(e);return{designs:(t.designs||[]).filter(n=>n.input_mode==="sports_surface"?!1:n.thumbnail_url||n.original_svg_url||n.original_png_url),pagination:t.pagination}}function lp(e){if(!e)return null;const t=e.match(/viewBox=["']([^"']+)["']/i);if(t){const i=t[1].split(/\s+/).map(Number);if(i.length>=4)return{width:i[2],height:i[3]}}const r=e.match(/\bwidth=["']?(\d+(?:\.\d+)?)/i),n=e.match(/\bheight=["']?(\d+(?:\.\d+)?)/i);return r&&n?{width:parseFloat(r[1]),height:parseFloat(n[1])}:null}const yE=Object.freeze(Object.defineProperty({__proto__:null,extractSVGDimensions:lp,fetchMotifFromDesign:Sw,listPlaygroundDesigns:kw},Symbol.toStringTag,{value:"Module"}));function l0({onOpenGenerator:e,mobileMode:t=!1,activeTab:r,onItemAdded:n}){const[i,s]=A.useState(null),[a,l]=A.useState("courts"),c=t?r:a,d=t?()=>{}:l,[u,f]=A.useState([]),[h,p]=A.useState(!1),[g,m]=A.useState(null),[x,v]=A.useState(null),{addCourt:y,addTrack:b,addMotif:w,addShape:j,courts:_,tracks:E,motifs:N,shapes:O}=tt(),I=Object.keys(_).length,te=Object.keys(E).length,T=Object.keys(N).length,V=mC(),S=sE();A.useEffect(()=>{c==="designs"&&u.length===0&&!h&&K()},[c]);const K=async()=>{p(!0),m(null);try{const re=await kw({limit:50});f(re.designs||[])}catch(re){console.error("[MOTIFS] Failed to load designs:",re),m(re.message||"Failed to load designs")}finally{p(!1)}},fe=re=>{const oe=gC(re);oe&&(y(re,oe),t&&n&&n())},U=re=>{const oe=oE(re);oe&&(b(re,oe),t&&n&&n())},z=async re=>{if(!x){v(re);try{const oe=await Sw(re);w(oe.sourceDesignId,oe.sourceDesignName,oe.svgContent,oe.originalWidth_mm,oe.originalHeight_mm,oe.sourceThumbnailUrl,{solidSvgContent:oe.solidSvgContent,blendSvgContent:oe.blendSvgContent,hasBothVersions:oe.hasBothVersions}),t&&n&&n()}catch(oe){console.error("[MOTIFS] Failed to add motif:",oe),alert(`Failed to add motif: ${oe.message}`)}finally{v(null)}}},H=[{id:"rectangle",name:"Rectangle",icon:""},{id:"square",name:"Square",icon:""},{id:"circle",name:"Circle",icon:""},{id:"triangle",name:"Triangle",icon:""},{id:"pentagon",name:"Pentagon",icon:""},{id:"hexagon",name:"Hexagon",icon:""},{id:"blob",name:"Blob",icon:""}],Q=Object.keys(O||{}).length,q=(()=>{switch(c){case"courts":return{title:"Courts",count:I,hint:"Select a court to add"};case"tracks":return{title:"Tracks",count:te,hint:"Select a track to add"};case"shapes":return{title:"Shapes",count:Q,hint:"Tap a shape to add it"};case"designs":return{title:"Designs",count:T,hint:"Add your saved designs as motifs"};default:return{title:"Library",count:0,hint:""}}})();return o.jsxs("div",{className:`court-library ${t?"court-library--mobile":""}`,children:[!t&&o.jsxs("div",{className:"court-library__header",children:[o.jsxs("div",{className:"court-library__header-row",children:[o.jsx("h2",{children:q.title}),o.jsxs("span",{className:"court-library__count",children:[q.count," on canvas"]})]}),o.jsx("p",{children:q.hint})]}),!t&&o.jsxs("div",{className:"court-library__tabs",children:[o.jsx("button",{className:`court-library__tab ${c==="courts"?"court-library__tab--active":""}`,onClick:()=>{d("courts"),s(null)},children:"Courts"}),o.jsx("button",{className:`court-library__tab ${c==="tracks"?"court-library__tab--active":""}`,onClick:()=>{d("tracks"),s(null)},children:"Tracks"}),o.jsx("button",{className:`court-library__tab ${c==="designs"?"court-library__tab--active":""}`,onClick:()=>{d("designs"),s(null)},children:"Designs"})]}),o.jsxs("div",{className:`court-library__list ${t?"court-library__list--mobile":""}`,children:[c==="courts"&&V.map(re=>o.jsxs("div",{className:`court-library__item ${i===re.id?"court-library__item--selected":""}`,onClick:()=>t?fe(re.id):s(re.id),onDoubleClick:()=>!t&&fe(re.id),children:[o.jsx("div",{className:"court-library__preview",children:o.jsx(xE,{template:re})}),o.jsxs("div",{className:"court-library__info",children:[o.jsx("div",{className:"court-library__name",children:re.name}),o.jsxs("div",{className:"court-library__dimensions",children:[(re.dimensions.width_mm/1e3).toFixed(1),"m  ",(re.dimensions.length_mm/1e3).toFixed(1),"m"]}),o.jsx("div",{className:"court-library__standard",children:re.standard})]}),i===re.id&&o.jsx("button",{className:"court-library__add-btn",onClick:oe=>{oe.stopPropagation(),fe(re.id)},children:"+ ADD"})]},re.id)),c==="tracks"&&S.map(re=>o.jsxs("div",{className:`court-library__item ${i===re.id?"court-library__item--selected":""}`,onClick:()=>t?U(re.id):s(re.id),onDoubleClick:()=>!t&&U(re.id),children:[o.jsx("div",{className:"court-library__preview",children:o.jsx(wE,{template:re})}),o.jsxs("div",{className:"court-library__info",children:[o.jsx("div",{className:"court-library__name",children:re.name}),o.jsxs("div",{className:"court-library__standard",children:[re.parameters.numLanes," Lanes  ",re.standard]}),o.jsx("div",{className:"court-library__note",children:"Scales to fit canvas"})]}),i===re.id&&o.jsx("button",{className:"court-library__add-btn",onClick:oe=>{oe.stopPropagation(),U(re.id)},children:"+ ADD"})]},re.id)),c==="shapes"&&o.jsx("div",{className:`court-library__shapes-grid ${t?"court-library__shapes-grid--mobile":""}`,children:H.map(re=>o.jsxs("button",{className:"court-library__shape-btn",onClick:()=>{j(re.id),t&&n&&n()},children:[o.jsx("span",{className:"court-library__shape-icon",children:re.icon}),o.jsx("span",{className:"court-library__shape-name",children:re.name})]},re.id))}),c==="designs"&&o.jsxs(o.Fragment,{children:[h&&o.jsxs("div",{className:"court-library__loading",children:[o.jsx("div",{className:"court-library__spinner"}),o.jsx("p",{children:"Loading your designs..."})]}),g&&o.jsxs("div",{className:"court-library__error",children:[o.jsx("p",{children:g}),o.jsx("button",{onClick:K,children:"Try Again"})]}),!h&&!g&&u.length===0&&o.jsxs("div",{className:"court-library__empty",children:[o.jsx("p",{children:"No designs found."}),o.jsx("p",{className:"court-library__empty-hint",children:"Generate new designs or save them to use as motifs."})]}),!h&&u.map(re=>{var oe,pe;return o.jsxs("div",{className:`court-library__item ${i===re.id?"court-library__item--selected":""} ${x===re.id?"court-library__item--loading":""}`,onClick:()=>t?z(re.id):s(re.id),onDoubleClick:()=>!t&&z(re.id),children:[o.jsx("div",{className:"court-library__preview",children:o.jsx(_E,{design:re})}),o.jsxs("div",{className:"court-library__info",children:[o.jsx("div",{className:"court-library__name",children:re.name||"Unnamed Design"}),o.jsxs("div",{className:"court-library__dimensions",children:[((((oe=re.design_data)==null?void 0:oe.widthMM)||5e3)/1e3).toFixed(1),"m  ",((((pe=re.design_data)==null?void 0:pe.lengthMM)||5e3)/1e3).toFixed(1),"m"]}),o.jsx("div",{className:"court-library__note",children:"Playground Design"})]}),i===re.id&&o.jsx("button",{className:"court-library__add-btn",onClick:Pe=>{Pe.stopPropagation(),z(re.id)},disabled:x===re.id,children:x===re.id?"Adding...":"+ ADD"})]},re.id)})]})]}),!t&&o.jsx("div",{className:"court-library__generate",children:o.jsxs("button",{className:"court-library__generate-btn",onClick:e,children:[o.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M12 5v14M5 12h14"})}),"Generate New Design"]})}),!t&&o.jsx("div",{className:"court-library__footer",children:o.jsxs("p",{className:"court-library__hint",children:[c==="courts"&&"Double-click a court to add it instantly",c==="tracks"&&"Double-click a track to add it instantly",c==="designs"&&"Double-click a design to add it as a motif"]})})]})}function xE({template:e}){const t=e.dimensions.width_mm,r=e.dimensions.length_mm,n=Math.min(62/t,62/r),i=t*n,s=r*n;return o.jsxs("svg",{width:"62",height:"62",viewBox:"0 0 62 62",className:"court-library__svg-preview",children:[o.jsx("rect",{x:(62-i)/2,y:(62-s)/2,width:i,height:s,fill:"#e5e7eb",stroke:"#9ca3af",strokeWidth:"1.5"}),e.markings.map((a,l)=>o.jsx(bE,{marking:a,scale:n,offsetX:(62-i)/2,offsetY:(62-s)/2},l))]})}function bE({marking:e,scale:t,offsetX:r,offsetY:n}){const{type:i,params:s}=e;switch(i){case"line":return o.jsx("line",{x1:s.x1*t+r,y1:s.y1*t+n,x2:s.x2*t+r,y2:s.y2*t+n,stroke:"#1e293b",strokeWidth:"1.5"});case"rectangle":return o.jsx("rect",{x:s.x*t+r,y:s.y*t+n,width:s.width*t,height:s.height*t,stroke:"#1e293b",strokeWidth:"1.5",fill:"none"});case"circle":return o.jsx("circle",{cx:s.cx*t+r,cy:s.cy*t+n,r:s.radius*t,stroke:"#1e293b",strokeWidth:"1.5",fill:"none"});case"arc":{const{cx:a,cy:l,radius:c,startAngle:d,endAngle:u}=s,f=d*Math.PI/180,h=u*Math.PI/180,p=(a+c*Math.cos(f))*t+r,g=(l+c*Math.sin(f))*t+n,m=(a+c*Math.cos(h))*t+r,x=(l+c*Math.sin(h))*t+n,v=u-d>180?1:0,y=`M ${p} ${g} A ${c*t} ${c*t} 0 ${v} 1 ${m} ${x}`;return o.jsx("path",{d:y,stroke:"#1e293b",strokeWidth:"1.5",fill:"none"})}default:return null}}function wE({template:e}){const{parameters:t}=e,r=t.width_mm,n=t.height_mm,i=Math.min(58/r,58/n),s=r*i,a=n*i,l=t.numLanes,c=t.laneWidth_mm*i,d=t.cornerRadius,f=(d.topLeft+d.topRight+d.bottomLeft+d.bottomRight)/4*i,h=(62-s)/2,p=(62-a)/2;return o.jsxs("svg",{width:"62",height:"62",viewBox:"0 0 62 62",className:"court-library__svg-preview",children:[o.jsx("rect",{x:h,y:p,width:s,height:a,rx:f,fill:"#e5e7eb"}),Array.from({length:l}).map((g,m)=>{const x=m*c,v=Math.max(0,f-x);return o.jsx("rect",{x:h+x,y:p+x,width:Math.max(0,s-x*2),height:Math.max(0,a-x*2),rx:v,stroke:"#1e293b",strokeWidth:"1",fill:"none"},m)})]})}function _E({design:e}){const t=e.thumbnail_url||e.original_png_url;return t?o.jsx("img",{src:t,alt:e.name||"Design preview",className:"court-library__motif-img",style:{width:"62px",height:"62px",objectFit:"contain",borderRadius:"4px",backgroundColor:"#f3f4f6"},onError:r=>{r.target.style.display="none",r.target.nextSibling&&(r.target.nextSibling.style.display="flex")}}):o.jsx("div",{className:"court-library__motif-placeholder",style:{width:"62px",height:"62px",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#e5e7eb",borderRadius:"4px",color:"#9ca3af",fontSize:"10px",textAlign:"center"},children:"No Preview"})}function c0({onEditSourceDesign:e}){var Ae,Ce;const{courts:t,tracks:r,motifs:n,shapes:i,texts:s,selectedCourtId:a,selectedTrackId:l,selectedMotifId:c,selectedShapeId:d,selectedTextId:u,updateCourtPosition:f,updateCourtRotation:h,updateCourtScale:p,setLineColor:g,setZoneColor:m,setCourtSurfaceColor:x,resetCourtColors:v,removeCourt:y,removeTrack:b,removeMotif:w,updateMotifPosition:j,updateMotifRotation:_,updateMotifScale:E,updateTrackParameters:N,addToHistory:O}=tt(),[I,te]=A.useState("transform"),[T,V]=A.useState(null);if(u){const ve=s[u];return ve?o.jsx(CE,{text:ve,textId:u}):null}if(d){const ve=i[d];return ve?o.jsx(jE,{shape:ve,shapeId:d}):null}if(c){const ve=n[c];return ve?o.jsx(kE,{motif:ve,motifId:c,onEditSourceDesign:e}):null}if(l){const ve=r[l];return ve?o.jsx(SE,{track:ve,trackId:l}):null}if(!a)return o.jsx("div",{className:"properties-panel properties-panel--empty",children:o.jsxs("div",{className:"properties-panel__empty-state",children:[o.jsx("p",{children:"No element selected"}),o.jsx("span",{className:"properties-panel__hint",children:"Click on a court, track, or motif to view and edit its properties"})]})});const S=t[a];if(!S)return null;const{position:K,rotation:fe,scale:U,template:z,lineColorOverrides:H,zoneColorOverrides:Q}=S,W=(ve,me)=>{const De=parseFloat(me);isNaN(De)||f(a,{...K,[ve]:De})},q=ve=>{const me=parseFloat(ve);isNaN(me)||h(a,me)},re=ve=>{const me=parseFloat(ve);isNaN(me)||me<=0||p(a,me)},oe=()=>{window.confirm(`Delete ${z.name}? This action cannot be undone.`)&&y(a)},pe=ve=>{if(!T)return;if(T.type==="courtSurface"&&ve===null){x(a,null),V(null);return}if(!ve)return;const me={tpv_code:ve.code,hex:ve.hex,name:ve.name};T.type==="line"?g(a,T.id,me):T.type==="zone"?m(a,T.id,me):T.type==="courtSurface"?x(a,me):T.type==="allLines"&&z.markings.forEach(De=>{g(a,De.id,me)}),V(null)},Pe=ve=>{const me=H[ve.id];if(me)return{code:me.tpv_code,hex:me.hex,name:me.name};const De=cr.find(Xe=>Xe.code===z.defaultLineColor);return De?{code:De.code,hex:De.hex,name:De.name}:null},Re=ve=>{const me=Q[ve.id];if(me)return{code:me.tpv_code,hex:me.hex,name:me.name};const De=cr.find(Xe=>Xe.code===ve.defaultColor);return De?{code:De.code,hex:De.hex,name:De.name}:null};return o.jsxs("div",{className:"properties-panel",children:[o.jsxs("div",{className:"properties-panel__header",children:[o.jsx("h3",{children:"Properties"}),o.jsxs("div",{className:"properties-panel__court-info",children:[o.jsx("span",{className:"court-name",children:z.name}),o.jsx("span",{className:"court-standard",children:z.standard})]})]}),o.jsxs("div",{className:"properties-panel__tabs",children:[o.jsx("button",{className:`tab ${I==="transform"?"tab--active":""}`,onClick:()=>te("transform"),children:"Transform"}),o.jsx("button",{className:`tab ${I==="lines"?"tab--active":""}`,onClick:()=>te("lines"),children:"Lines"}),o.jsx("button",{className:`tab ${I==="zones"?"tab--active":""}`,onClick:()=>te("zones"),children:"Zones"})]}),o.jsxs("div",{className:"properties-panel__content",children:[I==="transform"&&o.jsxs("div",{className:"properties-section",children:[o.jsx("div",{className:"properties-section__header",children:o.jsx("h4",{children:"Transform"})}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Position"}),o.jsxs("div",{className:"property-input-row",children:[o.jsxs("div",{className:"property-input-group",children:[o.jsx("span",{className:"property-label",children:"X"}),o.jsx("input",{type:"number",value:Math.round(K.x),onChange:ve=>W("x",ve.target.value),step:"100"}),o.jsx("span",{className:"property-unit",children:"mm"})]}),o.jsxs("div",{className:"property-input-group",children:[o.jsx("span",{className:"property-label",children:"Y"}),o.jsx("input",{type:"number",value:Math.round(K.y),onChange:ve=>W("y",ve.target.value),step:"100"}),o.jsx("span",{className:"property-unit",children:"mm"})]})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Rotation"}),o.jsxs("div",{className:"property-input-row",children:[o.jsx("input",{type:"range",min:"0",max:"360",value:fe,onChange:ve=>q(ve.target.value),className:"property-slider"}),o.jsxs("div",{className:"property-input-group property-input-group--compact",children:[o.jsx("input",{type:"number",value:Math.round(fe),onChange:ve=>q(ve.target.value),min:"0",max:"360"}),o.jsx("span",{className:"property-unit",children:""})]})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Scale"}),o.jsxs("div",{className:"property-input-row",children:[o.jsx("input",{type:"range",min:"0.5",max:"2.0",step:"0.1",value:U,onChange:ve=>re(ve.target.value),className:"property-slider"}),o.jsxs("div",{className:"property-input-group property-input-group--compact",children:[o.jsx("input",{type:"number",value:U.toFixed(2),onChange:ve=>re(ve.target.value),min:"0.5",max:"2.0",step:"0.1"}),o.jsx("span",{className:"property-unit",children:""})]})]})]}),o.jsxs("div",{className:"property-group property-group--info",children:[o.jsx("label",{children:"Dimensions"}),o.jsx("div",{className:"property-info",children:o.jsxs("span",{children:[(z.dimensions.width_mm*U/1e3).toFixed(1),"m  ",(z.dimensions.length_mm*U/1e3).toFixed(1),"m"]})})]}),o.jsx("div",{className:"property-group property-group--actions",children:o.jsx("button",{className:"btn-delete",onClick:oe,title:"Delete court (Delete key)",children:" Delete Court"})})]}),I==="lines"&&o.jsxs("div",{className:"properties-section",children:[o.jsxs("div",{className:"properties-section__header",children:[o.jsx("h4",{children:"Line Markings"}),o.jsx("button",{className:"btn-reset",onClick:()=>v(a),title:"Reset all colours to defaults",children:"Reset"})]}),o.jsxs("div",{className:"color-item color-item--all-lines",children:[o.jsxs("div",{className:"color-item__info",children:[o.jsx("span",{className:"color-item__name",children:"Change All Lines"}),o.jsx("span",{className:"color-item__hint",children:"Set all lines to same colour"})]}),o.jsx("button",{className:"color-item__swatch color-item__swatch--all",onClick:()=>V({type:"allLines"}),title:"Change all line colours at once",children:o.jsx("span",{style:{fontSize:"1rem"},children:""})})]}),o.jsx("div",{className:"color-list",children:z.markings.map(ve=>{const me=Pe(ve);return o.jsxs("div",{className:"color-item",children:[o.jsxs("div",{className:"color-item__info",children:[o.jsx("span",{className:"color-item__name",children:ve.name}),me&&o.jsx("span",{className:"color-item__code",children:me.code})]}),o.jsx("button",{className:"color-item__swatch",style:{backgroundColor:(me==null?void 0:me.hex)||"#000"},onClick:()=>V({type:"line",id:ve.id}),title:(me==null?void 0:me.name)||"Select colour"})]},ve.id)})})]}),I==="zones"&&o.jsxs("div",{className:"properties-section",children:[o.jsx("div",{className:"properties-section__header",children:o.jsx("h4",{children:"Fill Colours"})}),o.jsxs("div",{className:"color-item color-item--surface-fill",children:[o.jsxs("div",{className:"color-item__info",children:[o.jsx("span",{className:"color-item__name",children:"Court Surface"}),o.jsx("span",{className:"color-item__hint",children:S.courtSurfaceColor?S.courtSurfaceColor.name:"No Fill (transparent)"}),S.courtSurfaceColor&&o.jsx("span",{className:"color-item__code",children:S.courtSurfaceColor.tpv_code})]}),o.jsx("button",{className:`color-item__swatch ${S.courtSurfaceColor?"":"color-item__swatch--no-fill"}`,style:{backgroundColor:((Ae=S.courtSurfaceColor)==null?void 0:Ae.hex)||"transparent"},onClick:()=>V({type:"courtSurface"}),title:((Ce=S.courtSurfaceColor)==null?void 0:Ce.name)||"No Fill - Click to select colour"})]}),z.zones&&z.zones.length>0&&o.jsx("div",{className:"properties-section__divider",children:o.jsx("span",{children:"Paint Zones"})}),z.zones&&z.zones.length>0&&o.jsx("div",{className:"color-list",children:z.zones.map(ve=>{var De;const me=Re(ve);return o.jsxs("div",{className:"color-item",children:[o.jsxs("div",{className:"color-item__info",children:[o.jsx("span",{className:"color-item__name",children:ve.name}),o.jsxs("span",{className:"color-item__area",children:[((De=ve.area_m2)==null?void 0:De.toFixed(1))||0," m"]}),me&&o.jsx("span",{className:"color-item__code",children:me.code})]}),o.jsx("button",{className:"color-item__swatch",style:{backgroundColor:(me==null?void 0:me.hex)||"#000"},onClick:()=>V({type:"zone",id:ve.id}),title:(me==null?void 0:me.name)||"Select colour"})]},ve.id)})})]})]}),T&&o.jsx("div",{className:"color-picker-modal",onClick:()=>V(null),children:o.jsxs("div",{className:"color-picker-modal__content",onClick:ve=>ve.stopPropagation(),children:[o.jsxs("div",{className:"color-picker-modal__header",children:[o.jsx("h4",{children:T.type==="allLines"?"Change All Line Colours":T.type==="courtSurface"?"Select Court Fill Colour":"Select TPV Colour"}),o.jsx("button",{onClick:()=>V(null),children:""})]}),o.jsxs("div",{className:"color-picker-grid",children:[T.type==="courtSurface"&&o.jsx("button",{className:"color-picker-swatch color-picker-swatch--no-fill",onClick:()=>pe(null),title:"No Fill (transparent)",children:o.jsx("span",{className:"color-picker-swatch__code",children:"None"})}),cr.map(ve=>o.jsx("button",{className:"color-picker-swatch",style:{backgroundColor:ve.hex},onClick:()=>pe(ve),title:`${ve.code} - ${ve.name}`,children:o.jsx("span",{className:"color-picker-swatch__code",children:ve.code})},ve.code))]})]})})]})}function SE({track:e,trackId:t}){var S,K,fe;const{updateTrackParameters:r,removeTrack:n,setTrackSurfaceColor:i}=tt(),{parameters:s,template:a,trackSurfaceColor:l}=e,[c,d]=D.useState(!0),[u,f]=D.useState(!1),h=a.trackType==="straight",p=xw(s),g=((S=p.lanes[0])==null?void 0:S.perimeter)||0,m=p.lanes[p.lanes.length-1],x=(m==null?void 0:m.perimeter)||0,v=h?[]:bw(p),y=U=>{const z=parseInt(U);if(!(isNaN(z)||z<1||z>8))if(h){const H=z*s.laneWidth_mm;r(t,{numLanes:z,width_mm:H})}else r(t,{numLanes:z})},b=U=>{const z=parseFloat(U)*1e3;isNaN(z)||z<3e3||r(t,{width_mm:z})},w=U=>{const z=parseFloat(U)*1e3;isNaN(z)||z<3e3||r(t,{height_mm:z})},j=(U,z)=>{const H=parseFloat(z)*1e3;if(isNaN(H)||H<0)return;const Q=Math.min(s.width_mm,s.height_mm)/2,W=Math.min(H,Q);c?r(t,{cornerRadius:{topLeft:W,topRight:W,bottomLeft:W,bottomRight:W}}):r(t,{cornerRadius:{...s.cornerRadius,[U]:W}})},_=()=>{window.confirm(`Delete ${a.name}? This action cannot be undone.`)&&n(t)},E=U=>{i(t,{tpv_code:U.code,hex:U.hex,name:U.name}),f(!1)},N=U=>{r(t,{startingBoxes:{...s.startingBoxes,enabled:U}})},O=U=>{const z=parseFloat(U)*1e3;isNaN(z)||z<100||r(t,{startingBoxes:{...s.startingBoxes,depth_mm:z}})},I=U=>{r(t,{startingBoxes:{...s.startingBoxes,style:U}})},te=U=>{r(t,{startingBoxes:{...s.startingBoxes,direction:U}})},T=U=>{const z=parseFloat(U);isNaN(z)||z<0||z>100||r(t,{startingBoxes:{...s.startingBoxes,startPosition:z}})},V=(s.cornerRadius.topLeft+s.cornerRadius.topRight+s.cornerRadius.bottomLeft+s.cornerRadius.bottomRight)/4;return o.jsxs("div",{className:"properties-panel",children:[o.jsxs("div",{className:"properties-panel__header",children:[o.jsx("h3",{children:"Track Properties"}),o.jsxs("div",{className:"properties-panel__court-info",children:[o.jsx("span",{className:"court-name",children:a.name}),o.jsx("span",{className:"court-standard",children:a.standard})]})]}),o.jsx("div",{className:"properties-panel__content",children:o.jsxs("div",{className:"properties-section",children:[o.jsx("div",{className:"properties-section__header",children:o.jsx("h4",{children:"Track Parameters"})}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Number of Lanes"}),o.jsxs("div",{className:"property-input-row",children:[o.jsx("input",{type:"range",min:"1",max:"8",value:s.numLanes,onChange:U=>y(U.target.value),className:"property-slider"}),o.jsxs("div",{className:"property-input-group property-input-group--compact",children:[o.jsx("input",{type:"number",value:s.numLanes,onChange:U=>y(U.target.value),min:"1",max:"8"}),o.jsx("span",{className:"property-unit",children:"lanes"})]})]})]}),h?o.jsxs("div",{className:"property-group property-group--info",children:[o.jsx("label",{children:"Track Width"}),o.jsx("div",{className:"property-info",children:o.jsxs("span",{children:[(s.width_mm/1e3).toFixed(1),"m (Auto-calculated from lanes)"]})})]}):o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Track Width"}),o.jsxs("div",{className:"property-input-group",children:[o.jsx("input",{type:"number",value:(s.width_mm/1e3).toFixed(1),onChange:U=>b(U.target.value),min:"3",max:"100",step:"0.5"}),o.jsx("span",{className:"property-unit",children:"m"})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:h?"Track Length":"Track Height"}),o.jsxs("div",{className:"property-input-group",children:[o.jsx("input",{type:"number",value:(s.height_mm/1e3).toFixed(1),onChange:U=>w(U.target.value),min:"3",max:"100",step:"0.5"}),o.jsx("span",{className:"property-unit",children:"m"})]})]}),!h&&o.jsxs("div",{className:"property-group",children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[o.jsx("label",{children:"Corner Radius"}),o.jsx("button",{className:"btn-toggle",onClick:()=>d(!c),style:{padding:"0.25rem 0.5rem",fontSize:"0.75rem",background:c?"#0066CC":"#6b7280",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},title:c?"Click to edit corners independently":"Click to lock all corners together",children:c?" Locked":" Independent"})]}),c?o.jsxs("div",{className:"property-input-group",children:[o.jsx("input",{type:"number",value:(V/1e3).toFixed(2),onChange:U=>j("topLeft",U.target.value),min:"0",max:(Math.min(s.width_mm,s.height_mm)/2e3).toFixed(0),step:"0.5"}),o.jsx("span",{className:"property-unit",children:"m"})]}):o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[o.jsxs("div",{children:[o.jsx("label",{style:{fontSize:"0.75rem",color:"#64748b"},children:"Top Left"}),o.jsxs("div",{className:"property-input-group",children:[o.jsx("input",{type:"number",value:(s.cornerRadius.topLeft/1e3).toFixed(2),onChange:U=>j("topLeft",U.target.value),min:"0",max:(Math.min(s.width_mm,s.height_mm)/2e3).toFixed(0),step:"0.5"}),o.jsx("span",{className:"property-unit",children:"m"})]})]}),o.jsxs("div",{children:[o.jsx("label",{style:{fontSize:"0.75rem",color:"#64748b"},children:"Top Right"}),o.jsxs("div",{className:"property-input-group",children:[o.jsx("input",{type:"number",value:(s.cornerRadius.topRight/1e3).toFixed(2),onChange:U=>j("topRight",U.target.value),min:"0",max:(Math.min(s.width_mm,s.height_mm)/2e3).toFixed(0),step:"0.5"}),o.jsx("span",{className:"property-unit",children:"m"})]})]}),o.jsxs("div",{children:[o.jsx("label",{style:{fontSize:"0.75rem",color:"#64748b"},children:"Bottom Left"}),o.jsxs("div",{className:"property-input-group",children:[o.jsx("input",{type:"number",value:(s.cornerRadius.bottomLeft/1e3).toFixed(2),onChange:U=>j("bottomLeft",U.target.value),min:"0",max:(Math.min(s.width_mm,s.height_mm)/2e3).toFixed(0),step:"0.5"}),o.jsx("span",{className:"property-unit",children:"m"})]})]}),o.jsxs("div",{children:[o.jsx("label",{style:{fontSize:"0.75rem",color:"#64748b"},children:"Bottom Right"}),o.jsxs("div",{className:"property-input-group",children:[o.jsx("input",{type:"number",value:(s.cornerRadius.bottomRight/1e3).toFixed(2),onChange:U=>j("bottomRight",U.target.value),min:"0",max:(Math.min(s.width_mm,s.height_mm)/2e3).toFixed(0),step:"0.5"}),o.jsx("span",{className:"property-unit",children:"m"})]})]})]})]}),o.jsxs("div",{className:"property-group property-group--info",children:[o.jsx("label",{children:"Lane Width"}),o.jsx("div",{className:"property-info",children:o.jsxs("span",{children:[(s.laneWidth_mm/1e3).toFixed(2),"m (Fixed)"]})})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Track Surface Colour"}),o.jsxs("div",{className:"color-item",children:[o.jsxs("div",{className:"color-item__info",children:[o.jsx("span",{className:"color-item__name",children:(l==null?void 0:l.name)||"Select Colour"}),l&&o.jsx("span",{className:"color-item__code",children:l.tpv_code})]}),o.jsx("button",{className:"color-item__swatch",style:{backgroundColor:(l==null?void 0:l.hex)||"#A5362F"},onClick:()=>f(!0),title:(l==null?void 0:l.name)||"Select colour"})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[o.jsx("input",{type:"checkbox",checked:((K=s.startingBoxes)==null?void 0:K.enabled)||!1,onChange:U=>N(U.target.checked)}),"Show Starting Boxes"]}),((fe=s.startingBoxes)==null?void 0:fe.enabled)&&o.jsxs("div",{style:{marginTop:"0.75rem"},children:[o.jsxs("div",{className:"property-input-group",style:{marginBottom:"0.75rem"},children:[o.jsx("span",{className:"property-label",style:{fontSize:"0.875rem"},children:"Depth"}),o.jsx("input",{type:"number",value:(s.startingBoxes.depth_mm/1e3).toFixed(2),onChange:U=>O(U.target.value),min:"0.1",max:"1.0",step:"0.05"}),o.jsx("span",{className:"property-unit",children:"m"})]}),!h&&o.jsxs("div",{style:{marginBottom:"0.75rem"},children:[o.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#64748b",marginBottom:"0.375rem"},children:"Start Style"}),o.jsxs("select",{value:s.startingBoxes.style||"staggered",onChange:U=>I(U.target.value),style:{width:"100%",padding:"0.5rem",border:"1px solid #e4e9f0",borderRadius:"6px",fontSize:"0.875rem",fontFamily:"inherit",background:"white"},children:[o.jsx("option",{value:"straight",children:"Straight Start"}),o.jsx("option",{value:"staggered",children:"Staggered Start"}),o.jsx("option",{value:"both",children:"Both (opposite ends)"})]})]}),o.jsxs("div",{style:{marginBottom:"0.75rem"},children:[o.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#64748b",marginBottom:"0.375rem"},children:"Direction of Travel"}),o.jsxs("select",{value:s.startingBoxes.direction||"counterclockwise",onChange:U=>te(U.target.value),style:{width:"100%",padding:"0.5rem",border:"1px solid #e4e9f0",borderRadius:"6px",fontSize:"0.875rem",fontFamily:"inherit",background:"white"},children:[o.jsx("option",{value:"counterclockwise",children:"Counterclockwise (Standard)"}),o.jsx("option",{value:"clockwise",children:"Clockwise"})]})]}),!h&&o.jsxs("div",{style:{marginBottom:"0.75rem"},children:[o.jsxs("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#64748b",marginBottom:"0.375rem"},children:["Start Position (",s.startingBoxes.startPosition||0,"%)"]}),o.jsx("input",{type:"range",min:"0",max:"100",step:"1",value:s.startingBoxes.startPosition||0,onChange:U=>T(U.target.value),className:"property-slider",style:{width:"100%"}}),o.jsx("div",{style:{fontSize:"0.7rem",color:"#94a3b8",marginTop:"0.25rem"},children:"Slide to adjust where the start line appears around the track"})]}),o.jsx("div",{className:"property-info",style:{fontSize:"0.75rem",color:"#64748b",marginTop:"0.5rem"},children:"Boxes use track surface colour with white starting line and lane numbers"}),!h&&v.length>0&&(s.startingBoxes.style==="staggered"||s.startingBoxes.style==="both")&&o.jsxs("div",{style:{marginTop:"0.75rem",padding:"0.5rem",background:"#f8fafc",borderRadius:"4px"},children:[o.jsx("div",{style:{fontSize:"0.75rem",fontWeight:"600",color:"#1e293b",marginBottom:"0.25rem"},children:"Auto-Calculated Staggers:"}),o.jsx("div",{style:{fontSize:"0.7rem",color:"#64748b",lineHeight:"1.4"},children:v.map((U,z)=>o.jsxs("div",{children:["Lane ",z+1,": ",(U/1e3).toFixed(2),"m"]},z))}),o.jsx("div",{style:{fontSize:"0.65rem",color:"#64748b",marginTop:"0.25rem",fontStyle:"italic"},children:"Outer lanes start ahead to equalize distance"})]})]})]}),o.jsx("div",{className:"property-divider"}),o.jsx("div",{className:"properties-section__header",children:o.jsx("h4",{children:"Calculated Dimensions"})}),o.jsxs("div",{className:"property-group property-group--info",children:[o.jsx("label",{children:"Usable Infield"}),o.jsx("div",{className:"property-info",children:o.jsxs("span",{children:[(p.usableWidth/1e3).toFixed(1),"m  ",(p.usableHeight/1e3).toFixed(1),"m"]})})]}),o.jsxs("div",{className:"property-group property-group--info",children:[o.jsx("label",{children:"Lane 1 Perimeter"}),o.jsx("div",{className:"property-info",children:o.jsxs("span",{children:[g.toFixed(2),"m"]})})]}),s.numLanes>1&&o.jsxs("div",{className:"property-group property-group--info",children:[o.jsxs("label",{children:["Lane ",s.numLanes," Perimeter"]}),o.jsx("div",{className:"property-info",children:o.jsxs("span",{children:[x.toFixed(2),"m"]})})]}),o.jsx("div",{className:"property-group",children:o.jsx("div",{className:"property-hint",style:{fontStyle:"normal",color:"#64748b",fontSize:"0.75rem",marginTop:"1rem"},children:" Tip: Use drag handles on the canvas or edit values here. Corner radius auto-adjusts when locked."})}),o.jsx("div",{className:"property-group property-group--actions",children:o.jsx("button",{className:"btn-delete",onClick:_,title:"Delete track (Delete key)",children:" Delete Track"})})]})}),u&&o.jsx("div",{className:"color-picker-modal",onClick:()=>f(!1),children:o.jsxs("div",{className:"color-picker-modal__content",onClick:U=>U.stopPropagation(),children:[o.jsxs("div",{className:"color-picker-modal__header",children:[o.jsx("h4",{children:"Select Track Surface Colour"}),o.jsx("button",{onClick:()=>f(!1),children:""})]}),o.jsx("div",{className:"color-picker-grid",children:cr.map(U=>o.jsx("button",{className:"color-picker-swatch",style:{backgroundColor:U.hex},onClick:()=>E(U),title:`${U.code} - ${U.name}`,children:o.jsx("span",{className:"color-picker-swatch__code",children:U.code})},U.code))})]})})]})}function kE({motif:e,motifId:t,onEditSourceDesign:r}){const{updateMotifPosition:n,updateMotifRotation:i,updateMotifScale:s,removeMotif:a,duplicateMotif:l,refreshMotif:c,setMotifViewMode:d}=tt(),{position:u,rotation:f,scale:h,sourceDesignName:p,sourceDesignId:g,originalWidth_mm:m,originalHeight_mm:x,sourceThumbnailUrl:v,viewMode:y,hasBothVersions:b}=e,[w,j]=D.useState(!1),[_,E]=D.useState(null),N=(U,z)=>{const H=parseFloat(z);isNaN(H)||n(t,{...u,[U]:H})},O=U=>{const z=parseFloat(U);isNaN(z)||i(t,z)},I=U=>{const z=parseFloat(U);isNaN(z)||z<=0||s(t,z)},te=()=>{window.confirm("Delete this motif? This action cannot be undone.")&&a(t)},T=()=>{l(t)},V=()=>{if(r)r(g);else{if(!g){alert("Source design ID not found");return}window.open(`/studio/?design=${g}`,"_blank")}},S=async()=>{if(!w){j(!0),E(null);try{const U=await c(t);U.success||E(U.error||"Failed to refresh")}catch(U){E(U.message||"Failed to refresh")}finally{j(!1)}}},K=m*(h||1)/1e3,fe=x*(h||1)/1e3;return o.jsxs("div",{className:"properties-panel",children:[o.jsxs("div",{className:"properties-panel__header",children:[o.jsx("h3",{children:"Motif Properties"}),o.jsxs("div",{className:"properties-panel__court-info",children:[o.jsx("span",{className:"court-name",children:p||"Unnamed Motif"}),o.jsx("span",{className:"court-standard",children:"Playground Design"})]})]}),o.jsx("div",{className:"properties-panel__content",children:o.jsxs("div",{className:"properties-section",children:[v&&o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Preview"}),o.jsx("div",{style:{width:"100%",height:"80px",background:"#f3f4f6",borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden"},children:o.jsx("img",{src:v,alt:p,style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})})]}),es.BLEND_MODE_ENABLED,o.jsx("div",{className:"properties-section__header",children:o.jsx("h4",{children:"Transform"})}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Position"}),o.jsxs("div",{className:"property-input-row",children:[o.jsxs("div",{className:"property-input-group",children:[o.jsx("span",{className:"property-label",children:"X"}),o.jsx("input",{type:"number",value:Math.round(u.x),onChange:U=>N("x",U.target.value),step:"100"}),o.jsx("span",{className:"property-unit",children:"mm"})]}),o.jsxs("div",{className:"property-input-group",children:[o.jsx("span",{className:"property-label",children:"Y"}),o.jsx("input",{type:"number",value:Math.round(u.y),onChange:U=>N("y",U.target.value),step:"100"}),o.jsx("span",{className:"property-unit",children:"mm"})]})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Rotation"}),o.jsxs("div",{className:"property-input-row",children:[o.jsx("input",{type:"range",min:"0",max:"360",value:f||0,onChange:U=>O(U.target.value),className:"property-slider"}),o.jsxs("div",{className:"property-input-group property-input-group--compact",children:[o.jsx("input",{type:"number",value:Math.round(f||0),onChange:U=>O(U.target.value),min:"0",max:"360"}),o.jsx("span",{className:"property-unit",children:""})]})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsxs("label",{children:["Scale",o.jsx("span",{style:{fontSize:"0.7rem",color:"#64748b",marginLeft:"0.5rem"},children:"(aspect locked)"})]}),o.jsxs("div",{className:"property-input-row",children:[o.jsx("input",{type:"range",min:"0.1",max:"10",step:"0.1",value:Math.min(h||1,10),onChange:U=>I(U.target.value),className:"property-slider"}),o.jsxs("div",{className:"property-input-group property-input-group--compact",children:[o.jsx("input",{type:"number",value:(h||1).toFixed(2),onChange:U=>I(U.target.value),min:"0.1",step:"0.1"}),o.jsx("span",{className:"property-unit",children:""})]})]})]}),o.jsxs("div",{className:"property-group property-group--info",children:[o.jsx("label",{children:"Current Size"}),o.jsx("div",{className:"property-info",children:o.jsxs("span",{children:[K.toFixed(2),"m  ",fe.toFixed(2),"m"]})})]}),o.jsxs("div",{className:"property-group property-group--info",children:[o.jsx("label",{children:"Original Size"}),o.jsx("div",{className:"property-info",children:o.jsxs("span",{children:[(m/1e3).toFixed(2),"m  ",(x/1e3).toFixed(2),"m"]})})]}),o.jsx("div",{className:"properties-section__divider",style:{margin:"1rem 0"},children:o.jsx("span",{children:"Source Design"})}),o.jsx("div",{className:"property-group property-group--actions",children:o.jsx("button",{className:"btn-primary",onClick:V,title:"Edit the source playground design in a new tab",style:{width:"100%",padding:"0.5rem",background:"var(--color-primary, #1e4a7a)",color:"white",border:"none",borderRadius:"6px",fontSize:"0.875rem",fontFamily:"inherit",cursor:"pointer",marginBottom:"0.5rem",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem"},children:" Edit Source Design"})}),o.jsxs("div",{className:"property-group property-group--actions",children:[o.jsx("button",{className:"btn-secondary",onClick:S,disabled:w,title:"Refresh this motif with the latest version from the source design",style:{width:"100%",padding:"0.5rem",background:w?"#e5e7eb":"#f3f4f6",border:"1px solid #e4e9f0",borderRadius:"6px",fontSize:"0.875rem",fontFamily:"inherit",cursor:w?"not-allowed":"pointer",marginBottom:"0.5rem",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem"},children:w?" Refreshing...":" Refresh from Source"}),_&&o.jsx("div",{style:{fontSize:"0.75rem",color:"#dc2626",marginTop:"0.25rem"},children:_}),o.jsx("div",{style:{fontSize:"0.7rem",color:"#64748b",marginTop:"0.25rem"},children:"Click after editing the source design to update this motif"})]}),o.jsx("div",{className:"properties-section__divider",style:{margin:"1rem 0"},children:o.jsx("span",{children:"Actions"})}),o.jsx("div",{className:"property-group property-group--actions",children:o.jsx("button",{className:"btn-secondary",onClick:T,title:"Duplicate motif (Ctrl+D)",style:{width:"100%",padding:"0.5rem",background:"#f3f4f6",border:"1px solid #e4e9f0",borderRadius:"6px",fontSize:"0.875rem",fontFamily:"inherit",cursor:"pointer",marginBottom:"0.5rem"},children:" Duplicate Motif"})}),o.jsx("div",{className:"property-group property-group--actions",children:o.jsx("button",{className:"btn-delete",onClick:te,title:"Delete motif (Delete key)",children:" Delete Motif"})}),o.jsx("div",{className:"property-group",children:o.jsx("div",{className:"property-hint",style:{fontStyle:"normal",color:"#64748b",fontSize:"0.75rem",marginTop:"1rem"},children:' Tip: Drag the motif on the canvas to reposition. Edit the source design and click "Refresh" to update.'})})]})})]})}function jE({shape:e,shapeId:t}){var R;const{updateShapePosition:r,updateShapeDimensions:n,updateShapeSides:i,updateShapeCornerRadius:s,updateShapeRotation:a,setShapeFillColor:l,setShapeStroke:c,setShapeAspectLock:d,removeShape:u,duplicateShape:f,randomizeBlob:h,setBlobStyle:p,setEditPointsVisible:g,setPathClosed:m,setPathSmooth:x}=tt(),[v,y]=D.useState(!1),[b,w]=D.useState(!1),{shapeType:j,sides:_,width_mm:E,height_mm:N,cornerRadius:O,position:I,rotation:te,fillColor:T,strokeEnabled:V,strokeColor:S,strokeWidth_mm:K,aspectLocked:fe,blobStyle:U,editPointsVisible:z,closed:H,smooth:Q,controlPoints:W}=e,q=j==="blob",re=j==="path",oe=(M,Z)=>{const Y=parseFloat(Z);isNaN(Y)||r(t,{...I,[M]:Y})},pe=M=>{const Z=parseFloat(M);if(!(isNaN(Z)||Z<100))if(fe){const Y=N/E;n(t,Z,Z*Y)}else n(t,Z,N)},Pe=M=>{const Z=parseFloat(M);if(!(isNaN(Z)||Z<100))if(fe){const Y=E/N;n(t,Z*Y,Z)}else n(t,E,Z)},Re=M=>{const Z=parseInt(M);isNaN(Z)||Z<3||i(t,Z)},Ae=M=>{const Z=parseFloat(M);isNaN(Z)||Z<0||Z>100||s(t,Z)},Ce=M=>{const Z=parseFloat(M);isNaN(Z)||a(t,Z)},ve=M=>{l(t,{tpv_code:M.code,hex:M.hex,name:M.name}),y(!1)},me=M=>{c(t,!0,{tpv_code:M.code,hex:M.hex,name:M.name},K),w(!1)},De=M=>{M&&!S?c(t,!0,{tpv_code:"RH31",hex:"#E8E3D8",name:"Cream"},K):c(t,M,S,K)},Xe=M=>{const Z=parseFloat(M);isNaN(Z)||Z<10||c(t,V,S,Z)},C=()=>{d(t,!fe)},ce=()=>{window.confirm("Delete this shape? This action cannot be undone.")&&u(t)},ne=()=>{f(t)},F=[{sides:3,name:"Triangle",icon:""},{sides:4,name:"Rectangle",icon:""},{sides:5,name:"Pentagon",icon:""},{sides:6,name:"Hexagon",icon:""},{sides:8,name:"Octagon",icon:""},{sides:32,name:"Circle",icon:""}];return o.jsxs("div",{className:"properties-panel",children:[o.jsxs("div",{className:"properties-panel__header",children:[o.jsx("h3",{children:q?"Blob Shape":re?"Pen Path":"Shape Properties"}),o.jsxs("div",{className:"properties-panel__court-info",children:[o.jsx("span",{className:"court-name",children:q?((R=Bc[U||"organic"])==null?void 0:R.name)||"Organic":re?H?"Closed Path":"Open Path":WC(_)}),o.jsx("span",{className:"court-standard",children:q?" Blob":re?` ${(W==null?void 0:W.length)||0} points`:`${GC(_)} ${_} sides`})]})]}),o.jsx("div",{className:"properties-panel__content",children:o.jsxs("div",{className:"properties-section",children:[q?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Style"}),o.jsx("select",{value:U||"organic",onChange:M=>p(t,M.target.value),style:{width:"100%",padding:"0.5rem 0.75rem",border:"1px solid #e4e9f0",borderRadius:"6px",fontSize:"0.875rem",cursor:"pointer",background:"#fff"},children:Object.entries(Bc).map(([M,Z])=>o.jsxs("option",{value:M,children:[Z.name," - ",Z.description]},M))})]}),o.jsxs("div",{className:"property-group",children:[o.jsxs("button",{onClick:()=>h(t),style:{width:"100%",padding:"0.75rem 1rem",background:"#3b82f6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"0.875rem",fontWeight:"600",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem"},children:[o.jsx("span",{style:{fontSize:"1.1rem"},children:""})," New Shape"]}),o.jsx("div",{style:{fontSize:"0.7rem",color:"#64748b",marginTop:"0.5rem",textAlign:"center"},children:"Generate a new random shape in the selected style"})]}),o.jsxs("div",{className:"property-group",children:[o.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",padding:"0.5rem",border:"1px solid #e4e9f0",borderRadius:"6px",background:z?"#eff6ff":"#fff"},children:[o.jsx("input",{type:"checkbox",checked:z||!1,onChange:M=>g(t,M.target.checked),style:{width:"16px",height:"16px",cursor:"pointer"}}),o.jsx("span",{style:{fontSize:"0.875rem"},children:"Edit Points"})]}),z&&o.jsx("div",{style:{fontSize:"0.7rem",color:"#64748b",marginTop:"0.5rem"},children:"Drag points and handles on canvas for precise control"})]})]}):re?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"property-group",children:[o.jsx("label",{style:{marginBottom:"0.5rem",display:"block"},children:"Path Options"}),o.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",padding:"0.5rem",border:"1px solid #e4e9f0",borderRadius:"6px",background:H?"#eff6ff":"#fff",marginBottom:"0.5rem"},children:[o.jsx("input",{type:"checkbox",checked:H||!1,onChange:M=>m(t,M.target.checked),style:{width:"16px",height:"16px",cursor:"pointer"}}),o.jsx("span",{style:{fontSize:"0.875rem"},children:"Closed Path"})]}),o.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",padding:"0.5rem",border:"1px solid #e4e9f0",borderRadius:"6px",background:Q?"#eff6ff":"#fff"},children:[o.jsx("input",{type:"checkbox",checked:Q||!1,onChange:M=>x(t,M.target.checked),style:{width:"16px",height:"16px",cursor:"pointer"}}),o.jsx("span",{style:{fontSize:"0.875rem"},children:"Smooth Curves"})]}),Q&&o.jsx("div",{style:{fontSize:"0.7rem",color:"#64748b",marginTop:"0.5rem"},children:"Uses bezier curves for smooth transitions"})]}),o.jsxs("div",{className:"property-group",children:[o.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",padding:"0.5rem",border:"1px solid #e4e9f0",borderRadius:"6px",background:z?"#eff6ff":"#fff"},children:[o.jsx("input",{type:"checkbox",checked:z||!1,onChange:M=>g(t,M.target.checked),style:{width:"16px",height:"16px",cursor:"pointer"}}),o.jsx("span",{style:{fontSize:"0.875rem"},children:"Edit Points"})]}),z&&o.jsxs("div",{style:{fontSize:"0.7rem",color:"#64748b",marginTop:"0.5rem"},children:["Drag points to reshape. ",Q?"Drag handles for curve control.":"Enable smooth curves for bezier handles."]})]}),o.jsx("div",{className:"property-group",style:{background:"#f8fafc",padding:"0.75rem",borderRadius:"6px"},children:o.jsxs("div",{style:{fontSize:"0.8125rem",color:"#475569"},children:[o.jsx("strong",{children:(W==null?void 0:W.length)||0})," control points"]})})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Shape Type"}),o.jsx("div",{className:"shape-presets",style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"0.5rem",marginTop:"0.5rem"},children:F.map(M=>o.jsxs("button",{onClick:()=>Re(M.sides),title:M.name,style:{padding:"0.5rem",border:_===M.sides?"2px solid #3b82f6":"1px solid #e4e9f0",borderRadius:"6px",background:_===M.sides?"#eff6ff":"#fff",cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",gap:"0.25rem",fontSize:"1.25rem"},children:[o.jsx("span",{children:M.icon}),o.jsx("span",{style:{fontSize:"0.65rem",color:"#64748b"},children:M.name})]},M.sides))})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Number of Sides"}),o.jsxs("div",{className:"property-input-row",children:[o.jsx("input",{type:"range",min:"3",max:"32",value:_,onChange:M=>Re(M.target.value),className:"property-slider"}),o.jsx("div",{className:"property-input-group property-input-group--compact",children:o.jsx("input",{type:"number",value:_,onChange:M=>Re(M.target.value),min:"3",max:"32"})})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Corner Smoothing"}),o.jsxs("div",{className:"property-input-row",children:[o.jsx("input",{type:"range",min:"0",max:"100",value:O,onChange:M=>Ae(M.target.value),className:"property-slider"}),o.jsxs("div",{className:"property-input-group property-input-group--compact",children:[o.jsx("input",{type:"number",value:O,onChange:M=>Ae(M.target.value),min:"0",max:"100"}),o.jsx("span",{className:"property-unit",children:"%"})]})]})]})]}),o.jsx("div",{className:"properties-section__divider",style:{margin:"1rem 0"},children:o.jsx("span",{children:"Dimensions"})}),o.jsxs("div",{className:"property-group",children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[o.jsx("label",{style:{margin:0},children:"Size"}),o.jsx("button",{onClick:C,style:{padding:"0.25rem 0.5rem",fontSize:"0.75rem",background:fe?"#3b82f6":"#6b7280",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},title:fe?"Aspect ratio locked":"Aspect ratio unlocked",children:fe?" Locked":" Free"})]}),o.jsxs("div",{className:"property-input-row",children:[o.jsxs("div",{className:"property-input-group",children:[o.jsx("span",{className:"property-label",children:"W"}),o.jsx("input",{type:"number",value:E.toFixed(0),onChange:M=>pe(M.target.value),step:"100",min:"100"}),o.jsx("span",{className:"property-unit",children:"mm"})]}),o.jsxs("div",{className:"property-input-group",children:[o.jsx("span",{className:"property-label",children:"H"}),o.jsx("input",{type:"number",value:N.toFixed(0),onChange:M=>Pe(M.target.value),step:"100",min:"100"}),o.jsx("span",{className:"property-unit",children:"mm"})]})]}),o.jsxs("div",{style:{fontSize:"0.7rem",color:"#64748b",marginTop:"0.25rem"},children:[(E/1e3).toFixed(2),"m  ",(N/1e3).toFixed(2),"m"]})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Position"}),o.jsxs("div",{className:"property-input-row",children:[o.jsxs("div",{className:"property-input-group",children:[o.jsx("span",{className:"property-label",children:"X"}),o.jsx("input",{type:"number",value:Math.round(I.x),onChange:M=>oe("x",M.target.value),step:"100"}),o.jsx("span",{className:"property-unit",children:"mm"})]}),o.jsxs("div",{className:"property-input-group",children:[o.jsx("span",{className:"property-label",children:"Y"}),o.jsx("input",{type:"number",value:Math.round(I.y),onChange:M=>oe("y",M.target.value),step:"100"}),o.jsx("span",{className:"property-unit",children:"mm"})]})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Rotation"}),o.jsxs("div",{className:"property-input-row",children:[o.jsx("input",{type:"range",min:"0",max:"360",value:te||0,onChange:M=>Ce(M.target.value),className:"property-slider"}),o.jsxs("div",{className:"property-input-group property-input-group--compact",children:[o.jsx("input",{type:"number",value:Math.round(te||0),onChange:M=>Ce(M.target.value),min:"0",max:"360"}),o.jsx("span",{className:"property-unit",children:""})]})]})]}),o.jsx("div",{className:"properties-section__divider",style:{margin:"1rem 0"},children:o.jsx("span",{children:"Appearance"})}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Fill Colour"}),o.jsxs("div",{className:"color-item",children:[o.jsxs("div",{className:"color-item__info",children:[o.jsx("span",{className:"color-item__name",children:(T==null?void 0:T.name)||"Select Colour"}),T&&o.jsx("span",{className:"color-item__code",children:T.tpv_code})]}),o.jsx("button",{className:"color-item__swatch",style:{backgroundColor:(T==null?void 0:T.hex)||"#609B63"},onClick:()=>y(!0),title:(T==null?void 0:T.name)||"Select colour"})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[o.jsx("input",{type:"checkbox",checked:V||!1,onChange:M=>De(M.target.checked)}),"Border"]}),V&&o.jsxs("div",{style:{marginTop:"0.5rem"},children:[o.jsxs("div",{className:"color-item",style:{marginBottom:"0.5rem"},children:[o.jsxs("div",{className:"color-item__info",children:[o.jsx("span",{className:"color-item__name",children:(S==null?void 0:S.name)||"Select Colour"}),S&&o.jsx("span",{className:"color-item__code",children:S.tpv_code})]}),o.jsx("button",{className:"color-item__swatch",style:{backgroundColor:(S==null?void 0:S.hex)||"#FFFFFF"},onClick:()=>w(!0),title:(S==null?void 0:S.name)||"Select colour"})]}),o.jsxs("div",{className:"property-input-group",children:[o.jsx("span",{className:"property-label",style:{fontSize:"0.8rem"},children:"Width"}),o.jsx("input",{type:"number",value:K,onChange:M=>Xe(M.target.value),step:"10",min:"10"}),o.jsx("span",{className:"property-unit",children:"mm"})]})]})]}),o.jsx("div",{className:"properties-section__divider",style:{margin:"1rem 0"},children:o.jsx("span",{children:"Actions"})}),o.jsx("div",{className:"property-group property-group--actions",children:o.jsx("button",{className:"btn-secondary",onClick:ne,title:"Duplicate shape (Ctrl+D)",style:{width:"100%",padding:"0.5rem",background:"#f3f4f6",border:"1px solid #e4e9f0",borderRadius:"6px",fontSize:"0.875rem",fontFamily:"inherit",cursor:"pointer",marginBottom:"0.5rem"},children:" Duplicate Shape"})}),o.jsx("div",{className:"property-group property-group--actions",children:o.jsx("button",{className:"btn-delete",onClick:ce,title:"Delete shape (Delete key)",children:" Delete Shape"})}),o.jsx("div",{className:"property-group",children:o.jsx("div",{className:"property-hint",style:{fontStyle:"normal",color:"#64748b",fontSize:"0.75rem",marginTop:"1rem"},children:" Tip: Drag corners to resize, drag the rotation handle above the shape to rotate. Hold Shift to snap rotation to 15 increments."})})]})}),v&&o.jsx("div",{className:"color-picker-modal",onClick:()=>y(!1),children:o.jsxs("div",{className:"color-picker-modal__content",onClick:M=>M.stopPropagation(),children:[o.jsxs("div",{className:"color-picker-modal__header",children:[o.jsx("h4",{children:"Select Fill Colour"}),o.jsx("button",{onClick:()=>y(!1),children:""})]}),o.jsx("div",{className:"color-picker-grid",children:cr.map(M=>o.jsx("button",{className:"color-picker-swatch",style:{backgroundColor:M.hex},onClick:()=>ve(M),title:`${M.code} - ${M.name}`,children:o.jsx("span",{className:"color-picker-swatch__code",children:M.code})},M.code))})]})}),b&&o.jsx("div",{className:"color-picker-modal",onClick:()=>w(!1),children:o.jsxs("div",{className:"color-picker-modal__content",onClick:M=>M.stopPropagation(),children:[o.jsxs("div",{className:"color-picker-modal__header",children:[o.jsx("h4",{children:"Select Border Colour"}),o.jsx("button",{onClick:()=>w(!1),children:""})]}),o.jsx("div",{className:"color-picker-grid",children:cr.map(M=>o.jsx("button",{className:"color-picker-swatch",style:{backgroundColor:M.hex},onClick:()=>me(M),title:`${M.code} - ${M.name}`,children:o.jsx("span",{className:"color-picker-swatch__code",children:M.code})},M.code))})]})})]})}function CE({text:e,textId:t}){const{updateTextContent:r,updateTextPosition:n,updateTextFontSize:i,updateTextFont:s,updateTextAlign:a,updateTextRotation:l,setTextFillColor:c,removeText:d,duplicateText:u}=tt(),[f,h]=D.useState(!1),{content:p,fontFamily:g,fontSize_mm:m,fontWeight:x,fontStyle:v,textAlign:y,position:b,rotation:w,fillColor:j}=e,_=JC(),E=z=>{r(t,z)},N=(z,H)=>{const Q=parseFloat(H);isNaN(Q)||n(t,{...b,[z]:Q})},O=z=>{const H=parseFloat(z);isNaN(H)||H<50||i(t,H)},I=z=>{s(t,z,x,v)},te=()=>{s(t,g,x==="bold"?"normal":"bold",v)},T=()=>{s(t,g,x,v==="italic"?"normal":"italic")},V=z=>{a(t,z)},S=z=>{const H=parseFloat(z);isNaN(H)||l(t,H)},K=z=>{c(t,{tpv_code:z.code,hex:z.hex,name:z.name}),h(!1)},fe=()=>{window.confirm("Delete this text? This action cannot be undone.")&&d(t)},U=()=>{u(t)};return o.jsxs("div",{className:"properties-panel",children:[o.jsxs("div",{className:"properties-panel__header",children:[o.jsx("h3",{children:"Text Properties"}),o.jsxs("div",{className:"properties-panel__court-info",children:[o.jsx("span",{className:"court-name",style:{fontFamily:g},children:p||"Text Label"}),o.jsx("span",{className:"court-standard",children:"T Text Element"})]})]}),o.jsx("div",{className:"properties-panel__content",children:o.jsxs("div",{className:"properties-section",children:[o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Text Content"}),o.jsx("input",{type:"text",value:p,onChange:z=>E(z.target.value),placeholder:"Enter text...",style:{width:"100%",padding:"0.5rem",border:"1px solid #e4e9f0",borderRadius:"6px",fontFamily:g,fontSize:"1rem"}})]}),o.jsx("div",{className:"properties-section__divider",style:{margin:"1rem 0"},children:o.jsx("span",{children:"Typography"})}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Font Family"}),o.jsx("select",{value:g,onChange:z=>I(z.target.value),style:{width:"100%",padding:"0.5rem",border:"1px solid #e4e9f0",borderRadius:"6px",fontFamily:"inherit",fontSize:"0.875rem"},children:_.map(z=>o.jsx("option",{value:z.family,style:{fontFamily:z.family},children:z.name},z.name))})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Font Size"}),o.jsxs("div",{className:"property-input-row",children:[o.jsx("input",{type:"range",min:"100",max:"2000",step:"50",value:m,onChange:z=>O(z.target.value),className:"property-slider"}),o.jsxs("div",{className:"property-input-group property-input-group--compact",children:[o.jsx("input",{type:"number",value:m.toFixed(0),onChange:z=>O(z.target.value),min:"50",step:"50"}),o.jsx("span",{className:"property-unit",children:"mm"})]})]}),o.jsxs("div",{style:{fontSize:"0.7rem",color:"#64748b",marginTop:"0.25rem"},children:[" ",(m/1e3).toFixed(2),"m height"]})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Style"}),o.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[o.jsx("button",{onClick:te,style:{flex:1,padding:"0.5rem",border:x==="bold"?"2px solid #3b82f6":"1px solid #e4e9f0",borderRadius:"6px",background:x==="bold"?"#eff6ff":"#fff",fontWeight:"bold",fontSize:"1rem",cursor:"pointer"},title:"Bold",children:"B"}),o.jsx("button",{onClick:T,style:{flex:1,padding:"0.5rem",border:v==="italic"?"2px solid #3b82f6":"1px solid #e4e9f0",borderRadius:"6px",background:v==="italic"?"#eff6ff":"#fff",fontStyle:"italic",fontSize:"1rem",cursor:"pointer"},title:"Italic",children:"I"})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Alignment"}),o.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[o.jsx("button",{onClick:()=>V("left"),style:{flex:1,padding:"0.5rem",border:y==="left"?"2px solid #3b82f6":"1px solid #e4e9f0",borderRadius:"6px",background:y==="left"?"#eff6ff":"#fff",cursor:"pointer"},title:"Align Left",children:""}),o.jsx("button",{onClick:()=>V("center"),style:{flex:1,padding:"0.5rem",border:y==="center"?"2px solid #3b82f6":"1px solid #e4e9f0",borderRadius:"6px",background:y==="center"?"#eff6ff":"#fff",cursor:"pointer"},title:"Align Center",children:""}),o.jsx("button",{onClick:()=>V("right"),style:{flex:1,padding:"0.5rem",border:y==="right"?"2px solid #3b82f6":"1px solid #e4e9f0",borderRadius:"6px",background:y==="right"?"#eff6ff":"#fff",cursor:"pointer"},title:"Align Right",children:""})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Text Colour"}),o.jsxs("div",{className:"color-item",children:[o.jsxs("div",{className:"color-item__info",children:[o.jsx("span",{className:"color-item__name",children:(j==null?void 0:j.name)||"Select Colour"}),j&&o.jsx("span",{className:"color-item__code",children:j.tpv_code})]}),o.jsx("button",{className:"color-item__swatch",style:{backgroundColor:(j==null?void 0:j.hex)||"#1C1C1C"},onClick:()=>h(!0),title:(j==null?void 0:j.name)||"Select colour"})]})]}),o.jsx("div",{className:"properties-section__divider",style:{margin:"1rem 0"},children:o.jsx("span",{children:"Transform"})}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Position"}),o.jsxs("div",{className:"property-input-row",children:[o.jsxs("div",{className:"property-input-group",children:[o.jsx("span",{className:"property-label",children:"X"}),o.jsx("input",{type:"number",value:Math.round(b.x),onChange:z=>N("x",z.target.value),step:"100"}),o.jsx("span",{className:"property-unit",children:"mm"})]}),o.jsxs("div",{className:"property-input-group",children:[o.jsx("span",{className:"property-label",children:"Y"}),o.jsx("input",{type:"number",value:Math.round(b.y),onChange:z=>N("y",z.target.value),step:"100"}),o.jsx("span",{className:"property-unit",children:"mm"})]})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Rotation"}),o.jsxs("div",{className:"property-input-row",children:[o.jsx("input",{type:"range",min:"0",max:"360",value:w||0,onChange:z=>S(z.target.value),className:"property-slider"}),o.jsxs("div",{className:"property-input-group property-input-group--compact",children:[o.jsx("input",{type:"number",value:Math.round(w||0),onChange:z=>S(z.target.value),min:"0",max:"360"}),o.jsx("span",{className:"property-unit",children:""})]})]})]}),o.jsx("div",{className:"properties-section__divider",style:{margin:"1rem 0"},children:o.jsx("span",{children:"Actions"})}),o.jsx("div",{className:"property-group property-group--actions",children:o.jsx("button",{className:"btn-secondary",onClick:U,title:"Duplicate text (Ctrl+D)",style:{width:"100%",padding:"0.5rem",background:"#f3f4f6",border:"1px solid #e4e9f0",borderRadius:"6px",fontSize:"0.875rem",fontFamily:"inherit",cursor:"pointer",marginBottom:"0.5rem"},children:" Duplicate Text"})}),o.jsx("div",{className:"property-group property-group--actions",children:o.jsx("button",{className:"btn-delete",onClick:fe,title:"Delete text (Delete key)",children:" Delete Text"})}),o.jsx("div",{className:"property-group",children:o.jsx("div",{className:"property-hint",style:{fontStyle:"normal",color:"#64748b",fontSize:"0.75rem",marginTop:"1rem"},children:" Tip: Double-click text on canvas to edit inline. Drag corners to change font size. Hold Shift while rotating to snap to 15 increments."})})]})}),f&&o.jsx("div",{className:"color-picker-modal",onClick:()=>h(!1),children:o.jsxs("div",{className:"color-picker-modal__content",onClick:z=>z.stopPropagation(),children:[o.jsxs("div",{className:"color-picker-modal__header",children:[o.jsx("h4",{children:"Select Text Colour"}),o.jsx("button",{onClick:()=>h(!1),children:""})]}),o.jsx("div",{className:"color-picker-grid",children:cr.map(z=>o.jsx("button",{className:"color-picker-swatch",style:{backgroundColor:z.hex},onClick:()=>K(z),title:`${z.code} - ${z.name}`,children:o.jsx("span",{className:"color-picker-swatch__code",children:z.code})},z.code))})]})})]})}function EE(){const{courts:e,tracks:t,motifs:r,shapes:n,texts:i,elementOrder:s,selectedCourtId:a,selectedTrackId:l,selectedMotifId:c,selectedShapeId:d,selectedTextId:u,setElementOrder:f,selectCourt:h,selectTrack:p,selectMotif:g,selectShape:m,selectText:x,bringToFront:v,sendToBack:y,duplicateCourt:b,duplicateTrack:w,duplicateMotif:j,duplicateShape:_,duplicateText:E,removeCourt:N,removeTrack:O,removeMotif:I,removeShape:te,removeText:T,renameElement:V,toggleElementLock:S,toggleElementVisibility:K,addToHistory:fe}=tt(),[U,z]=A.useState(null),[H,Q]=A.useState(null),[W,q]=A.useState(null),[re,oe]=A.useState(null),[pe,Pe]=A.useState("");A.useEffect(()=>{const $=()=>q(null);if(W)return document.addEventListener("click",$),()=>document.removeEventListener("click",$)},[W]);const Re=[...s].reverse(),Ae=$=>{var X,ae,we;if($.startsWith("court-")){const se=e[$];return{type:"court",name:(se==null?void 0:se.customName)||((X=se==null?void 0:se.template)==null?void 0:X.name)||"Unknown Court",icon:"",sport:((ae=se==null?void 0:se.template)==null?void 0:ae.sport)||"",locked:(se==null?void 0:se.locked)||!1,visible:(se==null?void 0:se.visible)!==!1}}else if($.startsWith("track-")){const se=t[$];return{type:"track",name:(se==null?void 0:se.customName)||((we=se==null?void 0:se.template)==null?void 0:we.name)||"Unknown Track",icon:"",sport:"athletics",locked:(se==null?void 0:se.locked)||!1,visible:(se==null?void 0:se.visible)!==!1}}else if($.startsWith("motif-")){const se=r[$];return{type:"motif",name:(se==null?void 0:se.customName)||(se==null?void 0:se.sourceDesignName)||"Unknown Motif",icon:"",sport:"playground",locked:(se==null?void 0:se.locked)||!1,visible:(se==null?void 0:se.visible)!==!1}}else if($.startsWith("shape-")){const se=n[$],xe=(se==null?void 0:se.sides)>=32?"Circle":(se==null?void 0:se.sides)===3?"Triangle":(se==null?void 0:se.sides)===4?"Rectangle":`${se==null?void 0:se.sides}-gon`;return{type:"shape",name:(se==null?void 0:se.customName)||xe||"Unknown Shape",icon:(se==null?void 0:se.sides)>=32?"":(se==null?void 0:se.sides)===3?"":(se==null?void 0:se.sides)===4?"":"",sport:"shape",locked:(se==null?void 0:se.locked)||!1,visible:(se==null?void 0:se.visible)!==!1}}else if($.startsWith("text-")){const se=i[$],xe=(se==null?void 0:se.content)||"Text Label",Oe=xe.length>20?xe.substring(0,20)+"...":xe;return{type:"text",name:(se==null?void 0:se.customName)||Oe,icon:"T",sport:"text",locked:(se==null?void 0:se.locked)||!1,visible:(se==null?void 0:se.visible)!==!1}}return{type:"unknown",name:"Unknown",icon:"",sport:"",locked:!1,visible:!0}},Ce=$=>$===a||$===l||$===c||$===d||$===u,ve=$=>{$.startsWith("court-")?h($):$.startsWith("track-")?p($):$.startsWith("motif-")?g($):$.startsWith("shape-")?m($):$.startsWith("text-")&&x($)},me=($,X)=>{z(X),$.dataTransfer.effectAllowed="move",$.dataTransfer.setData("text/plain",X),setTimeout(()=>{$.target.classList.add("layer-item--dragging")},0)},De=$=>{$.target.classList.remove("layer-item--dragging"),z(null),Q(null)},Xe=($,X)=>{$.preventDefault(),$.dataTransfer.dropEffect="move",X!==U&&Q(X)},C=()=>{Q(null)},ce=($,X)=>{if($.preventDefault(),!U||U===X){z(null),Q(null);return}const ae=[...s],we=ae.indexOf(U),se=ae.indexOf(X);if(we===-1||se===-1)return;ae.splice(we,1);const xe=Re.indexOf(U),Oe=Re.indexOf(X);xe<Oe,ae.splice(se,0,U),f(ae),fe(),z(null),Q(null)},ne=($,X)=>{$.stopPropagation(),v(X),q(null)},F=($,X)=>{$.stopPropagation(),y(X),q(null)},R=($,X)=>{$.stopPropagation(),X.startsWith("court-")?b(X):X.startsWith("track-")?w(X):X.startsWith("motif-")?j(X):X.startsWith("shape-")?_(X):X.startsWith("text-")&&E(X),q(null)},M=($,X)=>{$.stopPropagation();const ae=Ae(X);confirm(`Delete "${ae.name}"?`)&&(X.startsWith("court-")?N(X):X.startsWith("track-")?O(X):X.startsWith("motif-")?I(X):X.startsWith("shape-")?te(X):X.startsWith("text-")&&T(X)),q(null)},Z=($,X)=>{$.stopPropagation();const ae=Ae(X);oe(X),Pe(ae.name),q(null)},Y=$=>{pe.trim()&&V($,pe.trim()),oe(null),Pe("")},L=($,X)=>{$.key==="Enter"?Y(X):$.key==="Escape"&&(oe(null),Pe(""))},J=($,X)=>{$.stopPropagation(),S(X),q(null)},ue=($,X)=>{$.stopPropagation(),K(X),q(null)},ie=($,X)=>{$.stopPropagation(),q(W===X?null:X)};return s.length===0?o.jsx("div",{className:"layers-panel layers-panel--empty",children:o.jsxs("div",{className:"layers-panel__empty-state",children:[o.jsx("span",{className:"layers-panel__empty-icon",children:""}),o.jsx("p",{children:"No elements yet"}),o.jsx("span",{className:"layers-panel__empty-hint",children:"Add courts, tracks, motifs, shapes, or text"})]})}):o.jsxs("div",{className:"layers-panel",children:[o.jsxs("div",{className:"layers-panel__header",children:[o.jsx("h4",{children:"Layers"}),o.jsx("span",{className:"layers-panel__count",children:s.length})]}),o.jsx("div",{className:"layers-panel__hint",children:"Drag to reorder layers. Top = front, bottom = back."}),o.jsx("div",{className:"layers-panel__list",children:Re.map(($,X)=>{const ae=Ae($),we=Ce($),se=$===H,xe=X===0,Oe=X===Re.length-1,be=re===$;return o.jsxs("div",{className:`layer-item ${we?"layer-item--selected":""} ${se?"layer-item--drag-over":""} ${ae.locked?"layer-item--locked":""} ${ae.visible?"":"layer-item--hidden"}`,draggable:!ae.locked&&!be,onDragStart:Ne=>me(Ne,$),onDragEnd:De,onDragOver:Ne=>Xe(Ne,$),onDragLeave:C,onDrop:Ne=>ce(Ne,$),onClick:()=>!be&&ve($),children:[o.jsx("span",{className:`layer-item__handle ${ae.locked?"layer-item__handle--disabled":""}`,title:ae.locked?"Locked":"Drag to reorder",children:ae.locked?"":""}),be?o.jsx("input",{type:"text",className:"layer-item__rename-input",value:pe,onChange:Ne=>Pe(Ne.target.value),onBlur:()=>Y($),onKeyDown:Ne=>L(Ne,$),autoFocus:!0,onClick:Ne=>Ne.stopPropagation()}):o.jsx("span",{className:`layer-item__name ${ae.visible?"":"layer-item__name--hidden"}`,children:ae.name}),o.jsx("div",{className:"layer-item__indicators",children:!ae.visible&&o.jsx("span",{className:"layer-item__indicator",title:"Hidden",children:""})}),o.jsxs("div",{className:"layer-item__actions",children:[o.jsx("button",{className:"layer-item__menu-btn",onClick:Ne=>ie(Ne,$),title:"More actions",children:""}),W===$&&o.jsxs("div",{className:"layer-item__menu",children:[o.jsx("button",{onClick:Ne=>ne(Ne,$),disabled:xe,children:" Bring to Front"}),o.jsx("button",{onClick:Ne=>F(Ne,$),disabled:Oe,children:" Send to Back"}),o.jsx("div",{className:"layer-item__menu-divider"}),o.jsx("button",{onClick:Ne=>R(Ne,$),children:" Duplicate"}),o.jsx("button",{onClick:Ne=>Z(Ne,$),children:" Rename"}),o.jsx("div",{className:"layer-item__menu-divider"}),o.jsx("button",{onClick:Ne=>J(Ne,$),children:ae.locked?" Unlock":" Lock"}),o.jsx("button",{onClick:Ne=>ue(Ne,$),children:ae.visible?" Hide":" Show"}),o.jsx("div",{className:"layer-item__menu-divider"}),o.jsx("button",{onClick:Ne=>M(Ne,$),className:"layer-item__menu-delete",children:" Delete"})]})]})]},$)})}),o.jsx("div",{className:"layers-panel__footer",children:o.jsx("span",{className:"layers-panel__shortcut-hint",children:"Tip: Use [ and ] keys to reorder selected element"})})]})}async function jw(){var r,n;const e=await Dt.auth.getSession(),t=(n=(r=e==null?void 0:e.data)==null?void 0:r.session)==null?void 0:n.access_token;if(!t)throw new Error("Not authenticated");return{"Content-Type":"application/json",Authorization:`Bearer ${t}`}}async function Cw(e){const t=await jw(),r=await fetch("/api/projects/create",{method:"POST",headers:t,body:JSON.stringify(e)});if(!r.ok){const n=await r.json();throw new Error(n.error||"Unable to create project. Please check your connection and try again.")}return r.json()}async function cp(){const e=await jw(),t=await fetch("/api/projects/list",{method:"GET",headers:e});if(!t.ok){const r=await t.json();throw new Error(r.error||"Unable to load your projects. Please refresh the page and try again.")}return t.json()}function TE(e,t={}){var r,n;return{type:"sports_surface",version:"1.0",name:t.name||e.name||"Untitled Design",description:t.description||e.description||"",tags:t.tags||e.tags||[],surface:e.surface,courts:NE(e.courts),tracks:PE(e.tracks),motifs:RE(e.motifs),elementOrder:e.elementOrder||[],customMarkings:e.customMarkings||[],backgroundZones:e.backgroundZones||[],dimensions:{width_mm:((r=e.surface)==null?void 0:r.width_mm)||5e4,length_mm:((n=e.surface)==null?void 0:n.length_mm)||5e4}}}function NE(e){return e?Object.fromEntries(Object.entries(e).map(([t,r])=>[t,{id:r.id,templateId:r.templateId,template:r.template,position:r.position,rotation:r.rotation,scale:r.scale,lineColorOverrides:r.lineColorOverrides||{},zoneColorOverrides:r.zoneColorOverrides||{},courtSurfaceColor:r.courtSurfaceColor}])):{}}function PE(e){return e?Object.fromEntries(Object.entries(e).map(([t,r])=>[t,{id:r.id,templateId:r.templateId,template:r.template,position:r.position,rotation:r.rotation,parameters:r.parameters,trackSurfaceColor:r.trackSurfaceColor}])):{}}function RE(e){return e?Object.fromEntries(Object.entries(e).map(([t,r])=>[t,{id:r.id,type:"motif",sourceDesignId:r.sourceDesignId,sourceDesignName:r.sourceDesignName,sourceThumbnailUrl:r.sourceThumbnailUrl,svgContent:r.svgContent,originalWidth_mm:r.originalWidth_mm,originalHeight_mm:r.originalHeight_mm,position:r.position,rotation:r.rotation,scale:r.scale}])):{}}function OE(e){var n,i;const t=[];return e.surface||t.push("Surface configuration is required"),(!((n=e.surface)!=null&&n.width_mm)||!((i=e.surface)!=null&&i.length_mm))&&t.push("Surface dimensions are required"),e.courts&&Object.keys(e.courts).length>0||e.tracks&&Object.keys(e.tracks).length>0||e.motifs&&Object.keys(e.motifs).length>0||t.push("Add at least one court, track, or motif to save"),{valid:t.length===0,errors:t}}async function AE(e,t=400){return new Promise((r,n)=>{try{const i=e.cloneNode(!0);i.querySelectorAll(".court-canvas__court--selected, .transform-handles").forEach(g=>{g.classList.remove("court-canvas__court--selected")}),i.querySelectorAll(".transform-handles").forEach(g=>g.remove());const s=e.getAttribute("viewBox").split(" ").map(Number),a=s[2],l=s[3];let c,d;a>l?(c=t,d=Math.round(l/a*t)):(d=t,c=Math.round(a/l*t)),i.setAttribute("width",c),i.setAttribute("height",d);const u=new XMLSerializer().serializeToString(i),f=new Blob([u],{type:"image/svg+xml;charset=utf-8"}),h=URL.createObjectURL(f),p=new Image;p.onload=()=>{const g=document.createElement("canvas");g.width=c,g.height=d;const m=g.getContext("2d");m.fillStyle="#ffffff",m.fillRect(0,0,c,d),m.drawImage(p,0,0,c,d),g.toBlob(x=>{URL.revokeObjectURL(h),r(x)},"image/png",.9)},p.onerror=g=>{URL.revokeObjectURL(h),n(new Error("Failed to load SVG for thumbnail"))},p.src=h}catch(i){n(i)}})}async function ME(e){const r=`thumbnails/sports/${`sports-${Date.now()}-${Math.random().toString(36).substr(2,9)}.png`}`,{data:n,error:i}=await Dt.storage.from("tpv-studio-uploads").upload(r,e,{cacheControl:"3600",contentType:"image/png",upsert:!1});if(i)throw i;const{data:{publicUrl:s}}=Dt.storage.from("tpv-studio-uploads").getPublicUrl(r);return s}function $E({existingDesignId:e=null,initialName:t="",svgRef:r=null,onClose:n,onSaved:i}){const s=tt(Q=>Q.exportDesignData),[a,l]=A.useState(t),[c,d]=A.useState(""),[u,f]=A.useState(""),[h,p]=A.useState(""),[g,m]=A.useState(!1),[x,v]=A.useState([]),[y,b]=A.useState(!1),[w,j]=A.useState(""),[_,E]=A.useState("#1a365d"),[N,O]=A.useState(!1),[I,te]=A.useState(!1),[T,V]=A.useState(!1),[S,K]=A.useState(null);A.useEffect(()=>{fe()},[]);const fe=async()=>{try{const{projects:Q}=await cp();v(Q)}catch(Q){console.error("Failed to load projects:",Q),K("Failed to load projects")}},U=async()=>{if(!w.trim()){K("Project name is required");return}V(!0),K(null);try{const{project:Q}=await Cw({name:w.trim(),color:_});v([Q,...x]),f(Q.id),b(!1),j(""),E("#1a365d")}catch(Q){console.error("Failed to create project:",Q),K(Q.message)}finally{V(!1)}},z=async(Q=!1)=>{if(!a.trim()){K("Design name is required");return}const W=s(),q=OE(W);if(!q.valid){K(q.errors.join(", "));return}Q?te(!0):O(!0),K(null);try{let re=null;if(r!=null&&r.current)try{console.log("[SPORTS-SAVE] Generating thumbnail...");const Re=await AE(r.current);console.log("[SPORTS-SAVE] Uploading thumbnail..."),re=await ME(Re),console.log("[SPORTS-SAVE] Thumbnail uploaded:",re)}catch(Re){console.warn("[SPORTS-SAVE] Thumbnail generation failed, continuing without:",Re)}const oe=TE(W,{name:a.trim(),description:c.trim()||"",tags:h.split(",").map(Re=>Re.trim()).filter(Re=>Re)});console.log("[SPORTS-SAVE] Serialized design data:",oe);const pe={name:a.trim(),description:c.trim()||null,project_id:u||null,tags:h.split(",").map(Re=>Re.trim()).filter(Re=>Re),is_public:g,design_data:oe,thumbnail_url:re};e&&!Q&&(pe.id=e);const Pe=await op(pe);i&&i(Pe,a.trim()),n()}catch(re){console.error("Failed to save design:",re),K(re.message)}finally{O(!1),te(!1)}},H=["#1a365d","#ff6b35","#4a90e2","#50c878","#9b59b6","#e74c3c"];return o.jsx("div",{className:"modal-overlay",onClick:n,children:o.jsxs("div",{className:"modal-content save-design-modal",onClick:Q=>Q.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsx("h2",{children:e?"Update Design":"Save Design"}),o.jsx("button",{onClick:n,className:"close-button",children:""})]}),o.jsxs("div",{className:"modal-body",children:[S&&o.jsx("div",{className:"error-message",children:S}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"design-name",children:"Design Name *"}),o.jsx("input",{id:"design-name",type:"text",value:a,onChange:Q=>l(Q.target.value),placeholder:"e.g., Multi-Sport Court Design",autoFocus:!0,disabled:N||I})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"design-description",children:"Description"}),o.jsx("textarea",{id:"design-description",value:c,onChange:Q=>d(Q.target.value),placeholder:"Optional notes about this sports surface design...",rows:3,disabled:N||I})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"design-project",children:"Project"}),y?o.jsxs("div",{className:"new-project-form",children:[o.jsxs("div",{className:"input-row",children:[o.jsx("input",{type:"text",value:w,onChange:Q=>j(Q.target.value),placeholder:"Project name...",disabled:T}),o.jsx("div",{className:"color-picker-inline",children:H.map(Q=>o.jsx("button",{type:"button",className:`color-swatch ${_===Q?"active":""}`,style:{backgroundColor:Q},onClick:()=>E(Q),disabled:T},Q))})]}),o.jsxs("div",{className:"button-row",children:[o.jsx("button",{type:"button",onClick:U,className:"btn-primary btn-small",disabled:T,children:T?"Creating...":"Create"}),o.jsx("button",{type:"button",onClick:()=>b(!1),className:"btn-secondary btn-small",disabled:T,children:"Cancel"})]})]}):o.jsxs("div",{className:"project-selector",children:[o.jsxs("select",{id:"design-project",value:u,onChange:Q=>f(Q.target.value),disabled:N||I,children:[o.jsx("option",{value:"",children:"No Project"}),x.map(Q=>o.jsxs("option",{value:Q.id,children:[Q.name," (",Q.design_count," designs)"]},Q.id))]}),o.jsx("button",{type:"button",onClick:()=>b(!0),className:"btn-secondary btn-small",disabled:N||I,children:"+ New Project"})]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"design-tags",children:"Tags"}),o.jsx("input",{id:"design-tags",type:"text",value:h,onChange:Q=>p(Q.target.value),placeholder:"e.g., tennis, multi-sport, school (comma-separated)",disabled:N||I}),o.jsx("small",{className:"help-text",children:"Separate tags with commas"})]}),o.jsx("div",{className:"form-group checkbox-group",children:o.jsxs("label",{children:[o.jsx("input",{type:"checkbox",checked:g,onChange:Q=>m(Q.target.checked),disabled:N||I}),o.jsx("span",{children:"Make this design public (shareable link)"})]})})]}),o.jsxs("div",{className:"modal-footer",children:[o.jsx("button",{onClick:n,className:"btn-secondary",disabled:N||I,children:"Cancel"}),e&&o.jsx("button",{onClick:()=>z(!0),className:"btn-secondary",disabled:N||I,children:I?"Saving...":"Save as New"}),o.jsx("button",{onClick:()=>z(!1),className:"btn-primary",disabled:N||I,children:N?"Saving...":e?"Update":"Save Design"})]})]})})}function dp(e,t){var f,h,p,g;if(!e)throw new Error("SVG element not found");const r=e.cloneNode(!0);r.querySelectorAll('.court-canvas__selection-outline, .transform-handles, [class*="selection"], [class*="handle"]').forEach(m=>m.remove()),r.querySelectorAll("[stroke-dasharray]").forEach(m=>{m.getAttribute("stroke-dasharray")&&m.remove()});const s=document.createElementNS("http://www.w3.org/2000/svg","title");s.textContent=(t==null?void 0:t.name)||"Sports Surface Design",r.insertBefore(s,r.firstChild);const a=document.createElementNS("http://www.w3.org/2000/svg","desc");a.textContent=`Generated by TPV Designer. Dimensions: ${(((f=t==null?void 0:t.surface)==null?void 0:f.width_mm)/1e3).toFixed(1)}m  ${(((h=t==null?void 0:t.surface)==null?void 0:h.length_mm)/1e3).toFixed(1)}m`,r.insertBefore(a,r.firstChild.nextSibling),r.setAttribute("xmlns","http://www.w3.org/2000/svg"),r.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");const l=((p=t==null?void 0:t.surface)==null?void 0:p.width_mm)||5e4,c=((g=t==null?void 0:t.surface)==null?void 0:g.length_mm)||5e4;r.setAttribute("width",`${l}mm`),r.setAttribute("height",`${c}mm`),r.setAttribute("data-tpv-studio","1.0"),r.setAttribute("data-design-type","sports_surface");let u=new XMLSerializer().serializeToString(r);return u=`<?xml version="1.0" encoding="UTF-8"?>
`+u,u}function LE(e,t="sports-surface.svg"){const r=new Blob([e],{type:"image/svg+xml"}),n=URL.createObjectURL(r),i=document.createElement("a");i.href=n,i.download=t,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(n)}async function IE(e,t,r="sports-surface.png",n=2){return new Promise((i,s)=>{try{const a=dp(e,t),l=document.createElement("canvas"),c=l.getContext("2d"),d=e.getAttribute("viewBox");let u=1200,f=1200;if(d){const[,,m,x]=d.split(" ").map(Number),v=2400,y=x/m;u=Math.min(m/10,v),f=u*y}l.width=u*n,l.height=f*n;const h=new Image,p=new Blob([a],{type:"image/svg+xml;charset=utf-8"}),g=URL.createObjectURL(p);h.onload=()=>{c.fillStyle="#ffffff",c.fillRect(0,0,l.width,l.height),c.drawImage(h,0,0,l.width,l.height),l.toBlob(m=>{if(!m){s(new Error("Failed to create PNG blob"));return}const x=URL.createObjectURL(m),v=document.createElement("a");v.href=x,v.download=r,document.body.appendChild(v),v.click(),document.body.removeChild(v),URL.revokeObjectURL(g),URL.revokeObjectURL(x),i()},"image/png",.95)},h.onerror=m=>{URL.revokeObjectURL(g),s(new Error("Failed to load SVG for PNG conversion"))},h.src=g}catch(a){s(a)}})}function ku(e,t){const r=(e||"sports-surface").toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"").substring(0,50),n=new Date().toISOString().split("T")[0];return`${r}_${n}.${t}`}function ql(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Ew={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(e,t){(function(r){e.exports=r()})(function(){return function r(n,i,s){function a(d,u){if(!i[d]){if(!n[d]){var f=typeof ql=="function"&&ql;if(!u&&f)return f(d,!0);if(l)return l(d,!0);var h=new Error("Cannot find module '"+d+"'");throw h.code="MODULE_NOT_FOUND",h}var p=i[d]={exports:{}};n[d][0].call(p.exports,function(g){var m=n[d][1][g];return a(m||g)},p,p.exports,r,n,i,s)}return i[d].exports}for(var l=typeof ql=="function"&&ql,c=0;c<s.length;c++)a(s[c]);return a}({1:[function(r,n,i){var s=r("./utils"),a=r("./support"),l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(c){for(var d,u,f,h,p,g,m,x=[],v=0,y=c.length,b=y,w=s.getTypeOf(c)!=="string";v<c.length;)b=y-v,f=w?(d=c[v++],u=v<y?c[v++]:0,v<y?c[v++]:0):(d=c.charCodeAt(v++),u=v<y?c.charCodeAt(v++):0,v<y?c.charCodeAt(v++):0),h=d>>2,p=(3&d)<<4|u>>4,g=1<b?(15&u)<<2|f>>6:64,m=2<b?63&f:64,x.push(l.charAt(h)+l.charAt(p)+l.charAt(g)+l.charAt(m));return x.join("")},i.decode=function(c){var d,u,f,h,p,g,m=0,x=0,v="data:";if(c.substr(0,v.length)===v)throw new Error("Invalid base64 input, it looks like a data url.");var y,b=3*(c=c.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(c.charAt(c.length-1)===l.charAt(64)&&b--,c.charAt(c.length-2)===l.charAt(64)&&b--,b%1!=0)throw new Error("Invalid base64 input, bad content length.");for(y=a.uint8array?new Uint8Array(0|b):new Array(0|b);m<c.length;)d=l.indexOf(c.charAt(m++))<<2|(h=l.indexOf(c.charAt(m++)))>>4,u=(15&h)<<4|(p=l.indexOf(c.charAt(m++)))>>2,f=(3&p)<<6|(g=l.indexOf(c.charAt(m++))),y[x++]=d,p!==64&&(y[x++]=u),g!==64&&(y[x++]=f);return y}},{"./support":30,"./utils":32}],2:[function(r,n,i){var s=r("./external"),a=r("./stream/DataWorker"),l=r("./stream/Crc32Probe"),c=r("./stream/DataLengthProbe");function d(u,f,h,p,g){this.compressedSize=u,this.uncompressedSize=f,this.crc32=h,this.compression=p,this.compressedContent=g}d.prototype={getContentWorker:function(){var u=new a(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new c("data_length")),f=this;return u.on("end",function(){if(this.streamInfo.data_length!==f.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),u},getCompressedWorker:function(){return new a(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},d.createWorkerFrom=function(u,f,h){return u.pipe(new l).pipe(new c("uncompressedSize")).pipe(f.compressWorker(h)).pipe(new c("compressedSize")).withStreamInfo("compression",f)},n.exports=d},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(r,n,i){var s=r("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},i.DEFLATE=r("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(r,n,i){var s=r("./utils"),a=function(){for(var l,c=[],d=0;d<256;d++){l=d;for(var u=0;u<8;u++)l=1&l?3988292384^l>>>1:l>>>1;c[d]=l}return c}();n.exports=function(l,c){return l!==void 0&&l.length?s.getTypeOf(l)!=="string"?function(d,u,f,h){var p=a,g=h+f;d^=-1;for(var m=h;m<g;m++)d=d>>>8^p[255&(d^u[m])];return-1^d}(0|c,l,l.length,0):function(d,u,f,h){var p=a,g=h+f;d^=-1;for(var m=h;m<g;m++)d=d>>>8^p[255&(d^u.charCodeAt(m))];return-1^d}(0|c,l,l.length,0):0}},{"./utils":32}],5:[function(r,n,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(r,n,i){var s=null;s=typeof Promise<"u"?Promise:r("lie"),n.exports={Promise:s}},{lie:37}],7:[function(r,n,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=r("pako"),l=r("./utils"),c=r("./stream/GenericWorker"),d=s?"uint8array":"array";function u(f,h){c.call(this,"FlateWorker/"+f),this._pako=null,this._pakoAction=f,this._pakoOptions=h,this.meta={}}i.magic="\b\0",l.inherits(u,c),u.prototype.processChunk=function(f){this.meta=f.meta,this._pako===null&&this._createPako(),this._pako.push(l.transformTo(d,f.data),!1)},u.prototype.flush=function(){c.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},u.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this._pako=null},u.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var f=this;this._pako.onData=function(h){f.push({data:h,meta:f.meta})}},i.compressWorker=function(f){return new u("Deflate",f)},i.uncompressWorker=function(){return new u("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(r,n,i){function s(p,g){var m,x="";for(m=0;m<g;m++)x+=String.fromCharCode(255&p),p>>>=8;return x}function a(p,g,m,x,v,y){var b,w,j=p.file,_=p.compression,E=y!==d.utf8encode,N=l.transformTo("string",y(j.name)),O=l.transformTo("string",d.utf8encode(j.name)),I=j.comment,te=l.transformTo("string",y(I)),T=l.transformTo("string",d.utf8encode(I)),V=O.length!==j.name.length,S=T.length!==I.length,K="",fe="",U="",z=j.dir,H=j.date,Q={crc32:0,compressedSize:0,uncompressedSize:0};g&&!m||(Q.crc32=p.crc32,Q.compressedSize=p.compressedSize,Q.uncompressedSize=p.uncompressedSize);var W=0;g&&(W|=8),E||!V&&!S||(W|=2048);var q=0,re=0;z&&(q|=16),v==="UNIX"?(re=798,q|=function(pe,Pe){var Re=pe;return pe||(Re=Pe?16893:33204),(65535&Re)<<16}(j.unixPermissions,z)):(re=20,q|=function(pe){return 63&(pe||0)}(j.dosPermissions)),b=H.getUTCHours(),b<<=6,b|=H.getUTCMinutes(),b<<=5,b|=H.getUTCSeconds()/2,w=H.getUTCFullYear()-1980,w<<=4,w|=H.getUTCMonth()+1,w<<=5,w|=H.getUTCDate(),V&&(fe=s(1,1)+s(u(N),4)+O,K+="up"+s(fe.length,2)+fe),S&&(U=s(1,1)+s(u(te),4)+T,K+="uc"+s(U.length,2)+U);var oe="";return oe+=`
\0`,oe+=s(W,2),oe+=_.magic,oe+=s(b,2),oe+=s(w,2),oe+=s(Q.crc32,4),oe+=s(Q.compressedSize,4),oe+=s(Q.uncompressedSize,4),oe+=s(N.length,2),oe+=s(K.length,2),{fileRecord:f.LOCAL_FILE_HEADER+oe+N+K,dirRecord:f.CENTRAL_FILE_HEADER+s(re,2)+oe+s(te.length,2)+"\0\0\0\0"+s(q,4)+s(x,4)+N+K+te}}var l=r("../utils"),c=r("../stream/GenericWorker"),d=r("../utf8"),u=r("../crc32"),f=r("../signature");function h(p,g,m,x){c.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=g,this.zipPlatform=m,this.encodeFileName=x,this.streamFiles=p,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}l.inherits(h,c),h.prototype.push=function(p){var g=p.meta.percent||0,m=this.entriesCount,x=this._sources.length;this.accumulate?this.contentBuffer.push(p):(this.bytesWritten+=p.data.length,c.prototype.push.call(this,{data:p.data,meta:{currentFile:this.currentFile,percent:m?(g+100*(m-x-1))/m:100}}))},h.prototype.openedSource=function(p){this.currentSourceOffset=this.bytesWritten,this.currentFile=p.file.name;var g=this.streamFiles&&!p.file.dir;if(g){var m=a(p,g,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:m.fileRecord,meta:{percent:0}})}else this.accumulate=!0},h.prototype.closedSource=function(p){this.accumulate=!1;var g=this.streamFiles&&!p.file.dir,m=a(p,g,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(m.dirRecord),g)this.push({data:function(x){return f.DATA_DESCRIPTOR+s(x.crc32,4)+s(x.compressedSize,4)+s(x.uncompressedSize,4)}(p),meta:{percent:100}});else for(this.push({data:m.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},h.prototype.flush=function(){for(var p=this.bytesWritten,g=0;g<this.dirRecords.length;g++)this.push({data:this.dirRecords[g],meta:{percent:100}});var m=this.bytesWritten-p,x=function(v,y,b,w,j){var _=l.transformTo("string",j(w));return f.CENTRAL_DIRECTORY_END+"\0\0\0\0"+s(v,2)+s(v,2)+s(y,4)+s(b,4)+s(_.length,2)+_}(this.dirRecords.length,m,p,this.zipComment,this.encodeFileName);this.push({data:x,meta:{percent:100}})},h.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},h.prototype.registerPrevious=function(p){this._sources.push(p);var g=this;return p.on("data",function(m){g.processChunk(m)}),p.on("end",function(){g.closedSource(g.previous.streamInfo),g._sources.length?g.prepareNextSource():g.end()}),p.on("error",function(m){g.error(m)}),this},h.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},h.prototype.error=function(p){var g=this._sources;if(!c.prototype.error.call(this,p))return!1;for(var m=0;m<g.length;m++)try{g[m].error(p)}catch{}return!0},h.prototype.lock=function(){c.prototype.lock.call(this);for(var p=this._sources,g=0;g<p.length;g++)p[g].lock()},n.exports=h},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(r,n,i){var s=r("../compressions"),a=r("./ZipFileWorker");i.generateWorker=function(l,c,d){var u=new a(c.streamFiles,d,c.platform,c.encodeFileName),f=0;try{l.forEach(function(h,p){f++;var g=function(y,b){var w=y||b,j=s[w];if(!j)throw new Error(w+" is not a valid compression method !");return j}(p.options.compression,c.compression),m=p.options.compressionOptions||c.compressionOptions||{},x=p.dir,v=p.date;p._compressWorker(g,m).withStreamInfo("file",{name:h,dir:x,date:v,comment:p.comment||"",unixPermissions:p.unixPermissions,dosPermissions:p.dosPermissions}).pipe(u)}),u.entriesCount=f}catch(h){u.error(h)}return u}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(r,n,i){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new s;for(var l in this)typeof this[l]!="function"&&(a[l]=this[l]);return a}}(s.prototype=r("./object")).loadAsync=r("./load"),s.support=r("./support"),s.defaults=r("./defaults"),s.version="3.10.1",s.loadAsync=function(a,l){return new s().loadAsync(a,l)},s.external=r("./external"),n.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(r,n,i){var s=r("./utils"),a=r("./external"),l=r("./utf8"),c=r("./zipEntries"),d=r("./stream/Crc32Probe"),u=r("./nodejsUtils");function f(h){return new a.Promise(function(p,g){var m=h.decompressed.getContentWorker().pipe(new d);m.on("error",function(x){g(x)}).on("end",function(){m.streamInfo.crc32!==h.decompressed.crc32?g(new Error("Corrupted zip : CRC32 mismatch")):p()}).resume()})}n.exports=function(h,p){var g=this;return p=s.extend(p||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:l.utf8decode}),u.isNode&&u.isStream(h)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",h,!0,p.optimizedBinaryString,p.base64).then(function(m){var x=new c(p);return x.load(m),x}).then(function(m){var x=[a.Promise.resolve(m)],v=m.files;if(p.checkCRC32)for(var y=0;y<v.length;y++)x.push(f(v[y]));return a.Promise.all(x)}).then(function(m){for(var x=m.shift(),v=x.files,y=0;y<v.length;y++){var b=v[y],w=b.fileNameStr,j=s.resolve(b.fileNameStr);g.file(j,b.decompressed,{binary:!0,optimizedBinaryString:!0,date:b.date,dir:b.dir,comment:b.fileCommentStr.length?b.fileCommentStr:null,unixPermissions:b.unixPermissions,dosPermissions:b.dosPermissions,createFolders:p.createFolders}),b.dir||(g.file(j).unsafeOriginalName=w)}return x.zipComment.length&&(g.comment=x.zipComment),g})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(r,n,i){var s=r("../utils"),a=r("../stream/GenericWorker");function l(c,d){a.call(this,"Nodejs stream input adapter for "+c),this._upstreamEnded=!1,this._bindStream(d)}s.inherits(l,a),l.prototype._bindStream=function(c){var d=this;(this._stream=c).pause(),c.on("data",function(u){d.push({data:u,meta:{percent:0}})}).on("error",function(u){d.isPaused?this.generatedError=u:d.error(u)}).on("end",function(){d.isPaused?d._upstreamEnded=!0:d.end()})},l.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},l.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=l},{"../stream/GenericWorker":28,"../utils":32}],13:[function(r,n,i){var s=r("readable-stream").Readable;function a(l,c,d){s.call(this,c),this._helper=l;var u=this;l.on("data",function(f,h){u.push(f)||u._helper.pause(),d&&d(h)}).on("error",function(f){u.emit("error",f)}).on("end",function(){u.push(null)})}r("../utils").inherits(a,s),a.prototype._read=function(){this._helper.resume()},n.exports=a},{"../utils":32,"readable-stream":16}],14:[function(r,n,i){n.exports={isNode:typeof Buffer<"u",newBufferFrom:function(s,a){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(s,a);if(typeof s=="number")throw new Error('The "data" argument must not be a number');return new Buffer(s,a)},allocBuffer:function(s){if(Buffer.alloc)return Buffer.alloc(s);var a=new Buffer(s);return a.fill(0),a},isBuffer:function(s){return Buffer.isBuffer(s)},isStream:function(s){return s&&typeof s.on=="function"&&typeof s.pause=="function"&&typeof s.resume=="function"}}},{}],15:[function(r,n,i){function s(j,_,E){var N,O=l.getTypeOf(_),I=l.extend(E||{},u);I.date=I.date||new Date,I.compression!==null&&(I.compression=I.compression.toUpperCase()),typeof I.unixPermissions=="string"&&(I.unixPermissions=parseInt(I.unixPermissions,8)),I.unixPermissions&&16384&I.unixPermissions&&(I.dir=!0),I.dosPermissions&&16&I.dosPermissions&&(I.dir=!0),I.dir&&(j=v(j)),I.createFolders&&(N=x(j))&&y.call(this,N,!0);var te=O==="string"&&I.binary===!1&&I.base64===!1;E&&E.binary!==void 0||(I.binary=!te),(_ instanceof f&&_.uncompressedSize===0||I.dir||!_||_.length===0)&&(I.base64=!1,I.binary=!0,_="",I.compression="STORE",O="string");var T=null;T=_ instanceof f||_ instanceof c?_:g.isNode&&g.isStream(_)?new m(j,_):l.prepareContent(j,_,I.binary,I.optimizedBinaryString,I.base64);var V=new h(j,T,I);this.files[j]=V}var a=r("./utf8"),l=r("./utils"),c=r("./stream/GenericWorker"),d=r("./stream/StreamHelper"),u=r("./defaults"),f=r("./compressedObject"),h=r("./zipObject"),p=r("./generate"),g=r("./nodejsUtils"),m=r("./nodejs/NodejsStreamInputAdapter"),x=function(j){j.slice(-1)==="/"&&(j=j.substring(0,j.length-1));var _=j.lastIndexOf("/");return 0<_?j.substring(0,_):""},v=function(j){return j.slice(-1)!=="/"&&(j+="/"),j},y=function(j,_){return _=_!==void 0?_:u.createFolders,j=v(j),this.files[j]||s.call(this,j,null,{dir:!0,createFolders:_}),this.files[j]};function b(j){return Object.prototype.toString.call(j)==="[object RegExp]"}var w={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(j){var _,E,N;for(_ in this.files)N=this.files[_],(E=_.slice(this.root.length,_.length))&&_.slice(0,this.root.length)===this.root&&j(E,N)},filter:function(j){var _=[];return this.forEach(function(E,N){j(E,N)&&_.push(N)}),_},file:function(j,_,E){if(arguments.length!==1)return j=this.root+j,s.call(this,j,_,E),this;if(b(j)){var N=j;return this.filter(function(I,te){return!te.dir&&N.test(I)})}var O=this.files[this.root+j];return O&&!O.dir?O:null},folder:function(j){if(!j)return this;if(b(j))return this.filter(function(O,I){return I.dir&&j.test(O)});var _=this.root+j,E=y.call(this,_),N=this.clone();return N.root=E.name,N},remove:function(j){j=this.root+j;var _=this.files[j];if(_||(j.slice(-1)!=="/"&&(j+="/"),_=this.files[j]),_&&!_.dir)delete this.files[j];else for(var E=this.filter(function(O,I){return I.name.slice(0,j.length)===j}),N=0;N<E.length;N++)delete this.files[E[N].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(j){var _,E={};try{if((E=l.extend(j||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=E.type.toLowerCase(),E.compression=E.compression.toUpperCase(),E.type==="binarystring"&&(E.type="string"),!E.type)throw new Error("No output type specified.");l.checkSupport(E.type),E.platform!=="darwin"&&E.platform!=="freebsd"&&E.platform!=="linux"&&E.platform!=="sunos"||(E.platform="UNIX"),E.platform==="win32"&&(E.platform="DOS");var N=E.comment||this.comment||"";_=p.generateWorker(this,E,N)}catch(O){(_=new c("error")).error(O)}return new d(_,E.type||"string",E.mimeType)},generateAsync:function(j,_){return this.generateInternalStream(j).accumulate(_)},generateNodeStream:function(j,_){return(j=j||{}).type||(j.type="nodebuffer"),this.generateInternalStream(j).toNodejsStream(_)}};n.exports=w},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(r,n,i){n.exports=r("stream")},{stream:void 0}],17:[function(r,n,i){var s=r("./DataReader");function a(l){s.call(this,l);for(var c=0;c<this.data.length;c++)l[c]=255&l[c]}r("../utils").inherits(a,s),a.prototype.byteAt=function(l){return this.data[this.zero+l]},a.prototype.lastIndexOfSignature=function(l){for(var c=l.charCodeAt(0),d=l.charCodeAt(1),u=l.charCodeAt(2),f=l.charCodeAt(3),h=this.length-4;0<=h;--h)if(this.data[h]===c&&this.data[h+1]===d&&this.data[h+2]===u&&this.data[h+3]===f)return h-this.zero;return-1},a.prototype.readAndCheckSignature=function(l){var c=l.charCodeAt(0),d=l.charCodeAt(1),u=l.charCodeAt(2),f=l.charCodeAt(3),h=this.readData(4);return c===h[0]&&d===h[1]&&u===h[2]&&f===h[3]},a.prototype.readData=function(l){if(this.checkOffset(l),l===0)return[];var c=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},n.exports=a},{"../utils":32,"./DataReader":18}],18:[function(r,n,i){var s=r("../utils");function a(l){this.data=l,this.length=l.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(l){this.checkIndex(this.index+l)},checkIndex:function(l){if(this.length<this.zero+l||l<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+l+"). Corrupted zip ?")},setIndex:function(l){this.checkIndex(l),this.index=l},skip:function(l){this.setIndex(this.index+l)},byteAt:function(){},readInt:function(l){var c,d=0;for(this.checkOffset(l),c=this.index+l-1;c>=this.index;c--)d=(d<<8)+this.byteAt(c);return this.index+=l,d},readString:function(l){return s.transformTo("string",this.readData(l))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var l=this.readInt(4);return new Date(Date.UTC(1980+(l>>25&127),(l>>21&15)-1,l>>16&31,l>>11&31,l>>5&63,(31&l)<<1))}},n.exports=a},{"../utils":32}],19:[function(r,n,i){var s=r("./Uint8ArrayReader");function a(l){s.call(this,l)}r("../utils").inherits(a,s),a.prototype.readData=function(l){this.checkOffset(l);var c=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},n.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(r,n,i){var s=r("./DataReader");function a(l){s.call(this,l)}r("../utils").inherits(a,s),a.prototype.byteAt=function(l){return this.data.charCodeAt(this.zero+l)},a.prototype.lastIndexOfSignature=function(l){return this.data.lastIndexOf(l)-this.zero},a.prototype.readAndCheckSignature=function(l){return l===this.readData(4)},a.prototype.readData=function(l){this.checkOffset(l);var c=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},n.exports=a},{"../utils":32,"./DataReader":18}],21:[function(r,n,i){var s=r("./ArrayReader");function a(l){s.call(this,l)}r("../utils").inherits(a,s),a.prototype.readData=function(l){if(this.checkOffset(l),l===0)return new Uint8Array(0);var c=this.data.subarray(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},n.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(r,n,i){var s=r("../utils"),a=r("../support"),l=r("./ArrayReader"),c=r("./StringReader"),d=r("./NodeBufferReader"),u=r("./Uint8ArrayReader");n.exports=function(f){var h=s.getTypeOf(f);return s.checkSupport(h),h!=="string"||a.uint8array?h==="nodebuffer"?new d(f):a.uint8array?new u(s.transformTo("uint8array",f)):new l(s.transformTo("array",f)):new c(f)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(r,n,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(r,n,i){var s=r("./GenericWorker"),a=r("../utils");function l(c){s.call(this,"ConvertWorker to "+c),this.destType=c}a.inherits(l,s),l.prototype.processChunk=function(c){this.push({data:a.transformTo(this.destType,c.data),meta:c.meta})},n.exports=l},{"../utils":32,"./GenericWorker":28}],25:[function(r,n,i){var s=r("./GenericWorker"),a=r("../crc32");function l(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}r("../utils").inherits(l,s),l.prototype.processChunk=function(c){this.streamInfo.crc32=a(c.data,this.streamInfo.crc32||0),this.push(c)},n.exports=l},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(r,n,i){var s=r("../utils"),a=r("./GenericWorker");function l(c){a.call(this,"DataLengthProbe for "+c),this.propName=c,this.withStreamInfo(c,0)}s.inherits(l,a),l.prototype.processChunk=function(c){if(c){var d=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=d+c.data.length}a.prototype.processChunk.call(this,c)},n.exports=l},{"../utils":32,"./GenericWorker":28}],27:[function(r,n,i){var s=r("../utils"),a=r("./GenericWorker");function l(c){a.call(this,"DataWorker");var d=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,c.then(function(u){d.dataIsReady=!0,d.data=u,d.max=u&&u.length||0,d.type=s.getTypeOf(u),d.isPaused||d._tickAndRepeat()},function(u){d.error(u)})}s.inherits(l,a),l.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},l.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0)},l.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},l.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var c=null,d=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":c=this.data.substring(this.index,d);break;case"uint8array":c=this.data.subarray(this.index,d);break;case"array":case"nodebuffer":c=this.data.slice(this.index,d)}return this.index=d,this.push({data:c,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=l},{"../utils":32,"./GenericWorker":28}],28:[function(r,n,i){function s(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return!this.isFinished&&(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,l){return this._listeners[a].push(l),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,l){if(this._listeners[a])for(var c=0;c<this._listeners[a].length;c++)this._listeners[a][c].call(this,l)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var l=this;return a.on("data",function(c){l.processChunk(c)}),a.on("end",function(){l.end()}),a.on("error",function(c){l.error(c)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var a=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,l){return this.extraStreamInfo[a]=l,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},n.exports=s},{}],29:[function(r,n,i){var s=r("../utils"),a=r("./ConvertWorker"),l=r("./GenericWorker"),c=r("../base64"),d=r("../support"),u=r("../external"),f=null;if(d.nodestream)try{f=r("../nodejs/NodejsStreamOutputAdapter")}catch{}function h(g,m){return new u.Promise(function(x,v){var y=[],b=g._internalType,w=g._outputType,j=g._mimeType;g.on("data",function(_,E){y.push(_),m&&m(E)}).on("error",function(_){y=[],v(_)}).on("end",function(){try{var _=function(E,N,O){switch(E){case"blob":return s.newBlob(s.transformTo("arraybuffer",N),O);case"base64":return c.encode(N);default:return s.transformTo(E,N)}}(w,function(E,N){var O,I=0,te=null,T=0;for(O=0;O<N.length;O++)T+=N[O].length;switch(E){case"string":return N.join("");case"array":return Array.prototype.concat.apply([],N);case"uint8array":for(te=new Uint8Array(T),O=0;O<N.length;O++)te.set(N[O],I),I+=N[O].length;return te;case"nodebuffer":return Buffer.concat(N);default:throw new Error("concat : unsupported type '"+E+"'")}}(b,y),j);x(_)}catch(E){v(E)}y=[]}).resume()})}function p(g,m,x){var v=m;switch(m){case"blob":case"arraybuffer":v="uint8array";break;case"base64":v="string"}try{this._internalType=v,this._outputType=m,this._mimeType=x,s.checkSupport(v),this._worker=g.pipe(new a(v)),g.lock()}catch(y){this._worker=new l("error"),this._worker.error(y)}}p.prototype={accumulate:function(g){return h(this,g)},on:function(g,m){var x=this;return g==="data"?this._worker.on(g,function(v){m.call(x,v.data,v.meta)}):this._worker.on(g,function(){s.delay(m,arguments,x)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(g){if(s.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new f(this,{objectMode:this._outputType!=="nodebuffer"},g)}},n.exports=p},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(r,n,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof Buffer<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var s=new ArrayBuffer(0);try{i.blob=new Blob([s],{type:"application/zip"}).size===0}catch{try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(s),i.blob=a.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!r("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(r,n,i){for(var s=r("./utils"),a=r("./support"),l=r("./nodejsUtils"),c=r("./stream/GenericWorker"),d=new Array(256),u=0;u<256;u++)d[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;d[254]=d[254]=1;function f(){c.call(this,"utf-8 decode"),this.leftOver=null}function h(){c.call(this,"utf-8 encode")}i.utf8encode=function(p){return a.nodebuffer?l.newBufferFrom(p,"utf-8"):function(g){var m,x,v,y,b,w=g.length,j=0;for(y=0;y<w;y++)(64512&(x=g.charCodeAt(y)))==55296&&y+1<w&&(64512&(v=g.charCodeAt(y+1)))==56320&&(x=65536+(x-55296<<10)+(v-56320),y++),j+=x<128?1:x<2048?2:x<65536?3:4;for(m=a.uint8array?new Uint8Array(j):new Array(j),y=b=0;b<j;y++)(64512&(x=g.charCodeAt(y)))==55296&&y+1<w&&(64512&(v=g.charCodeAt(y+1)))==56320&&(x=65536+(x-55296<<10)+(v-56320),y++),x<128?m[b++]=x:(x<2048?m[b++]=192|x>>>6:(x<65536?m[b++]=224|x>>>12:(m[b++]=240|x>>>18,m[b++]=128|x>>>12&63),m[b++]=128|x>>>6&63),m[b++]=128|63&x);return m}(p)},i.utf8decode=function(p){return a.nodebuffer?s.transformTo("nodebuffer",p).toString("utf-8"):function(g){var m,x,v,y,b=g.length,w=new Array(2*b);for(m=x=0;m<b;)if((v=g[m++])<128)w[x++]=v;else if(4<(y=d[v]))w[x++]=65533,m+=y-1;else{for(v&=y===2?31:y===3?15:7;1<y&&m<b;)v=v<<6|63&g[m++],y--;1<y?w[x++]=65533:v<65536?w[x++]=v:(v-=65536,w[x++]=55296|v>>10&1023,w[x++]=56320|1023&v)}return w.length!==x&&(w.subarray?w=w.subarray(0,x):w.length=x),s.applyFromCharCode(w)}(p=s.transformTo(a.uint8array?"uint8array":"array",p))},s.inherits(f,c),f.prototype.processChunk=function(p){var g=s.transformTo(a.uint8array?"uint8array":"array",p.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var m=g;(g=new Uint8Array(m.length+this.leftOver.length)).set(this.leftOver,0),g.set(m,this.leftOver.length)}else g=this.leftOver.concat(g);this.leftOver=null}var x=function(y,b){var w;for((b=b||y.length)>y.length&&(b=y.length),w=b-1;0<=w&&(192&y[w])==128;)w--;return w<0||w===0?b:w+d[y[w]]>b?w:b}(g),v=g;x!==g.length&&(a.uint8array?(v=g.subarray(0,x),this.leftOver=g.subarray(x,g.length)):(v=g.slice(0,x),this.leftOver=g.slice(x,g.length))),this.push({data:i.utf8decode(v),meta:p.meta})},f.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=f,s.inherits(h,c),h.prototype.processChunk=function(p){this.push({data:i.utf8encode(p.data),meta:p.meta})},i.Utf8EncodeWorker=h},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(r,n,i){var s=r("./support"),a=r("./base64"),l=r("./nodejsUtils"),c=r("./external");function d(m){return m}function u(m,x){for(var v=0;v<m.length;++v)x[v]=255&m.charCodeAt(v);return x}r("setimmediate"),i.newBlob=function(m,x){i.checkSupport("blob");try{return new Blob([m],{type:x})}catch{try{var v=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return v.append(m),v.getBlob(x)}catch{throw new Error("Bug : can't construct the Blob.")}}};var f={stringifyByChunk:function(m,x,v){var y=[],b=0,w=m.length;if(w<=v)return String.fromCharCode.apply(null,m);for(;b<w;)x==="array"||x==="nodebuffer"?y.push(String.fromCharCode.apply(null,m.slice(b,Math.min(b+v,w)))):y.push(String.fromCharCode.apply(null,m.subarray(b,Math.min(b+v,w)))),b+=v;return y.join("")},stringifyByChar:function(m){for(var x="",v=0;v<m.length;v++)x+=String.fromCharCode(m[v]);return x},applyCanBeUsed:{uint8array:function(){try{return s.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return s.nodebuffer&&String.fromCharCode.apply(null,l.allocBuffer(1)).length===1}catch{return!1}}()}};function h(m){var x=65536,v=i.getTypeOf(m),y=!0;if(v==="uint8array"?y=f.applyCanBeUsed.uint8array:v==="nodebuffer"&&(y=f.applyCanBeUsed.nodebuffer),y)for(;1<x;)try{return f.stringifyByChunk(m,v,x)}catch{x=Math.floor(x/2)}return f.stringifyByChar(m)}function p(m,x){for(var v=0;v<m.length;v++)x[v]=m[v];return x}i.applyFromCharCode=h;var g={};g.string={string:d,array:function(m){return u(m,new Array(m.length))},arraybuffer:function(m){return g.string.uint8array(m).buffer},uint8array:function(m){return u(m,new Uint8Array(m.length))},nodebuffer:function(m){return u(m,l.allocBuffer(m.length))}},g.array={string:h,array:d,arraybuffer:function(m){return new Uint8Array(m).buffer},uint8array:function(m){return new Uint8Array(m)},nodebuffer:function(m){return l.newBufferFrom(m)}},g.arraybuffer={string:function(m){return h(new Uint8Array(m))},array:function(m){return p(new Uint8Array(m),new Array(m.byteLength))},arraybuffer:d,uint8array:function(m){return new Uint8Array(m)},nodebuffer:function(m){return l.newBufferFrom(new Uint8Array(m))}},g.uint8array={string:h,array:function(m){return p(m,new Array(m.length))},arraybuffer:function(m){return m.buffer},uint8array:d,nodebuffer:function(m){return l.newBufferFrom(m)}},g.nodebuffer={string:h,array:function(m){return p(m,new Array(m.length))},arraybuffer:function(m){return g.nodebuffer.uint8array(m).buffer},uint8array:function(m){return p(m,new Uint8Array(m.length))},nodebuffer:d},i.transformTo=function(m,x){if(x=x||"",!m)return x;i.checkSupport(m);var v=i.getTypeOf(x);return g[v][m](x)},i.resolve=function(m){for(var x=m.split("/"),v=[],y=0;y<x.length;y++){var b=x[y];b==="."||b===""&&y!==0&&y!==x.length-1||(b===".."?v.pop():v.push(b))}return v.join("/")},i.getTypeOf=function(m){return typeof m=="string"?"string":Object.prototype.toString.call(m)==="[object Array]"?"array":s.nodebuffer&&l.isBuffer(m)?"nodebuffer":s.uint8array&&m instanceof Uint8Array?"uint8array":s.arraybuffer&&m instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(m){if(!s[m.toLowerCase()])throw new Error(m+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(m){var x,v,y="";for(v=0;v<(m||"").length;v++)y+="\\x"+((x=m.charCodeAt(v))<16?"0":"")+x.toString(16).toUpperCase();return y},i.delay=function(m,x,v){setImmediate(function(){m.apply(v||null,x||[])})},i.inherits=function(m,x){function v(){}v.prototype=x.prototype,m.prototype=new v},i.extend=function(){var m,x,v={};for(m=0;m<arguments.length;m++)for(x in arguments[m])Object.prototype.hasOwnProperty.call(arguments[m],x)&&v[x]===void 0&&(v[x]=arguments[m][x]);return v},i.prepareContent=function(m,x,v,y,b){return c.Promise.resolve(x).then(function(w){return s.blob&&(w instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(w))!==-1)&&typeof FileReader<"u"?new c.Promise(function(j,_){var E=new FileReader;E.onload=function(N){j(N.target.result)},E.onerror=function(N){_(N.target.error)},E.readAsArrayBuffer(w)}):w}).then(function(w){var j=i.getTypeOf(w);return j?(j==="arraybuffer"?w=i.transformTo("uint8array",w):j==="string"&&(b?w=a.decode(w):v&&y!==!0&&(w=function(_){return u(_,s.uint8array?new Uint8Array(_.length):new Array(_.length))}(w))),w):c.Promise.reject(new Error("Can't read the data of '"+m+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(r,n,i){var s=r("./reader/readerFor"),a=r("./utils"),l=r("./signature"),c=r("./zipEntry"),d=r("./support");function u(f){this.files=[],this.loadOptions=f}u.prototype={checkSignature:function(f){if(!this.reader.readAndCheckSignature(f)){this.reader.index-=4;var h=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(h)+", expected "+a.pretty(f)+")")}},isSignature:function(f,h){var p=this.reader.index;this.reader.setIndex(f);var g=this.reader.readString(4)===h;return this.reader.setIndex(p),g},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var f=this.reader.readData(this.zipCommentLength),h=d.uint8array?"uint8array":"array",p=a.transformTo(h,f);this.zipComment=this.loadOptions.decodeFileName(p)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var f,h,p,g=this.zip64EndOfCentralSize-44;0<g;)f=this.reader.readInt(2),h=this.reader.readInt(4),p=this.reader.readData(h),this.zip64ExtensibleData[f]={id:f,length:h,value:p}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var f,h;for(f=0;f<this.files.length;f++)h=this.files[f],this.reader.setIndex(h.localHeaderOffset),this.checkSignature(l.LOCAL_FILE_HEADER),h.readLocalPart(this.reader),h.handleUTF8(),h.processAttributes()},readCentralDir:function(){var f;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(l.CENTRAL_FILE_HEADER);)(f=new c({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(f);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var f=this.reader.lastIndexOfSignature(l.CENTRAL_DIRECTORY_END);if(f<0)throw this.isSignature(0,l.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(f);var h=f;if(this.checkSignature(l.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(f=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(f),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,l.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var p=this.centralDirOffset+this.centralDirSize;this.zip64&&(p+=20,p+=12+this.zip64EndOfCentralSize);var g=h-p;if(0<g)this.isSignature(h,l.CENTRAL_FILE_HEADER)||(this.reader.zero=g);else if(g<0)throw new Error("Corrupted zip: missing "+Math.abs(g)+" bytes.")},prepareReader:function(f){this.reader=s(f)},load:function(f){this.prepareReader(f),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=u},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(r,n,i){var s=r("./reader/readerFor"),a=r("./utils"),l=r("./compressedObject"),c=r("./crc32"),d=r("./utf8"),u=r("./compressions"),f=r("./support");function h(p,g){this.options=p,this.loadOptions=g}h.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(p){var g,m;if(p.skip(22),this.fileNameLength=p.readInt(2),m=p.readInt(2),this.fileName=p.readData(this.fileNameLength),p.skip(m),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((g=function(x){for(var v in u)if(Object.prototype.hasOwnProperty.call(u,v)&&u[v].magic===x)return u[v];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new l(this.compressedSize,this.uncompressedSize,this.crc32,g,p.readData(this.compressedSize))},readCentralPart:function(p){this.versionMadeBy=p.readInt(2),p.skip(2),this.bitFlag=p.readInt(2),this.compressionMethod=p.readString(2),this.date=p.readDate(),this.crc32=p.readInt(4),this.compressedSize=p.readInt(4),this.uncompressedSize=p.readInt(4);var g=p.readInt(2);if(this.extraFieldsLength=p.readInt(2),this.fileCommentLength=p.readInt(2),this.diskNumberStart=p.readInt(2),this.internalFileAttributes=p.readInt(2),this.externalFileAttributes=p.readInt(4),this.localHeaderOffset=p.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");p.skip(g),this.readExtraFields(p),this.parseZIP64ExtraField(p),this.fileComment=p.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var p=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),p==0&&(this.dosPermissions=63&this.externalFileAttributes),p==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var p=s(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=p.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=p.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=p.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=p.readInt(4))}},readExtraFields:function(p){var g,m,x,v=p.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});p.index+4<v;)g=p.readInt(2),m=p.readInt(2),x=p.readData(m),this.extraFields[g]={id:g,length:m,value:x};p.setIndex(v)},handleUTF8:function(){var p=f.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=d.utf8decode(this.fileName),this.fileCommentStr=d.utf8decode(this.fileComment);else{var g=this.findExtraFieldUnicodePath();if(g!==null)this.fileNameStr=g;else{var m=a.transformTo(p,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(m)}var x=this.findExtraFieldUnicodeComment();if(x!==null)this.fileCommentStr=x;else{var v=a.transformTo(p,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(v)}}},findExtraFieldUnicodePath:function(){var p=this.extraFields[28789];if(p){var g=s(p.value);return g.readInt(1)!==1||c(this.fileName)!==g.readInt(4)?null:d.utf8decode(g.readData(p.length-5))}return null},findExtraFieldUnicodeComment:function(){var p=this.extraFields[25461];if(p){var g=s(p.value);return g.readInt(1)!==1||c(this.fileComment)!==g.readInt(4)?null:d.utf8decode(g.readData(p.length-5))}return null}},n.exports=h},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(r,n,i){function s(g,m,x){this.name=g,this.dir=x.dir,this.date=x.date,this.comment=x.comment,this.unixPermissions=x.unixPermissions,this.dosPermissions=x.dosPermissions,this._data=m,this._dataBinary=x.binary,this.options={compression:x.compression,compressionOptions:x.compressionOptions}}var a=r("./stream/StreamHelper"),l=r("./stream/DataWorker"),c=r("./utf8"),d=r("./compressedObject"),u=r("./stream/GenericWorker");s.prototype={internalStream:function(g){var m=null,x="string";try{if(!g)throw new Error("No output type specified.");var v=(x=g.toLowerCase())==="string"||x==="text";x!=="binarystring"&&x!=="text"||(x="string"),m=this._decompressWorker();var y=!this._dataBinary;y&&!v&&(m=m.pipe(new c.Utf8EncodeWorker)),!y&&v&&(m=m.pipe(new c.Utf8DecodeWorker))}catch(b){(m=new u("error")).error(b)}return new a(m,x,"")},async:function(g,m){return this.internalStream(g).accumulate(m)},nodeStream:function(g,m){return this.internalStream(g||"nodebuffer").toNodejsStream(m)},_compressWorker:function(g,m){if(this._data instanceof d&&this._data.compression.magic===g.magic)return this._data.getCompressedWorker();var x=this._decompressWorker();return this._dataBinary||(x=x.pipe(new c.Utf8EncodeWorker)),d.createWorkerFrom(x,g,m)},_decompressWorker:function(){return this._data instanceof d?this._data.getContentWorker():this._data instanceof u?this._data:new l(this._data)}};for(var f=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],h=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},p=0;p<f.length;p++)s.prototype[f[p]]=h;n.exports=s},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(r,n,i){(function(s){var a,l,c=s.MutationObserver||s.WebKitMutationObserver;if(c){var d=0,u=new c(g),f=s.document.createTextNode("");u.observe(f,{characterData:!0}),a=function(){f.data=d=++d%2}}else if(s.setImmediate||s.MessageChannel===void 0)a="document"in s&&"onreadystatechange"in s.document.createElement("script")?function(){var m=s.document.createElement("script");m.onreadystatechange=function(){g(),m.onreadystatechange=null,m.parentNode.removeChild(m),m=null},s.document.documentElement.appendChild(m)}:function(){setTimeout(g,0)};else{var h=new s.MessageChannel;h.port1.onmessage=g,a=function(){h.port2.postMessage(0)}}var p=[];function g(){var m,x;l=!0;for(var v=p.length;v;){for(x=p,p=[],m=-1;++m<v;)x[m]();v=p.length}l=!1}n.exports=function(m){p.push(m)!==1||l||a()}}).call(this,typeof wi<"u"?wi:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(r,n,i){var s=r("immediate");function a(){}var l={},c=["REJECTED"],d=["FULFILLED"],u=["PENDING"];function f(v){if(typeof v!="function")throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,v!==a&&m(this,v)}function h(v,y,b){this.promise=v,typeof y=="function"&&(this.onFulfilled=y,this.callFulfilled=this.otherCallFulfilled),typeof b=="function"&&(this.onRejected=b,this.callRejected=this.otherCallRejected)}function p(v,y,b){s(function(){var w;try{w=y(b)}catch(j){return l.reject(v,j)}w===v?l.reject(v,new TypeError("Cannot resolve promise with itself")):l.resolve(v,w)})}function g(v){var y=v&&v.then;if(v&&(typeof v=="object"||typeof v=="function")&&typeof y=="function")return function(){y.apply(v,arguments)}}function m(v,y){var b=!1;function w(E){b||(b=!0,l.reject(v,E))}function j(E){b||(b=!0,l.resolve(v,E))}var _=x(function(){y(j,w)});_.status==="error"&&w(_.value)}function x(v,y){var b={};try{b.value=v(y),b.status="success"}catch(w){b.status="error",b.value=w}return b}(n.exports=f).prototype.finally=function(v){if(typeof v!="function")return this;var y=this.constructor;return this.then(function(b){return y.resolve(v()).then(function(){return b})},function(b){return y.resolve(v()).then(function(){throw b})})},f.prototype.catch=function(v){return this.then(null,v)},f.prototype.then=function(v,y){if(typeof v!="function"&&this.state===d||typeof y!="function"&&this.state===c)return this;var b=new this.constructor(a);return this.state!==u?p(b,this.state===d?v:y,this.outcome):this.queue.push(new h(b,v,y)),b},h.prototype.callFulfilled=function(v){l.resolve(this.promise,v)},h.prototype.otherCallFulfilled=function(v){p(this.promise,this.onFulfilled,v)},h.prototype.callRejected=function(v){l.reject(this.promise,v)},h.prototype.otherCallRejected=function(v){p(this.promise,this.onRejected,v)},l.resolve=function(v,y){var b=x(g,y);if(b.status==="error")return l.reject(v,b.value);var w=b.value;if(w)m(v,w);else{v.state=d,v.outcome=y;for(var j=-1,_=v.queue.length;++j<_;)v.queue[j].callFulfilled(y)}return v},l.reject=function(v,y){v.state=c,v.outcome=y;for(var b=-1,w=v.queue.length;++b<w;)v.queue[b].callRejected(y);return v},f.resolve=function(v){return v instanceof this?v:l.resolve(new this(a),v)},f.reject=function(v){var y=new this(a);return l.reject(y,v)},f.all=function(v){var y=this;if(Object.prototype.toString.call(v)!=="[object Array]")return this.reject(new TypeError("must be an array"));var b=v.length,w=!1;if(!b)return this.resolve([]);for(var j=new Array(b),_=0,E=-1,N=new this(a);++E<b;)O(v[E],E);return N;function O(I,te){y.resolve(I).then(function(T){j[te]=T,++_!==b||w||(w=!0,l.resolve(N,j))},function(T){w||(w=!0,l.reject(N,T))})}},f.race=function(v){var y=this;if(Object.prototype.toString.call(v)!=="[object Array]")return this.reject(new TypeError("must be an array"));var b=v.length,w=!1;if(!b)return this.resolve([]);for(var j=-1,_=new this(a);++j<b;)E=v[j],y.resolve(E).then(function(N){w||(w=!0,l.resolve(_,N))},function(N){w||(w=!0,l.reject(_,N))});var E;return _}},{immediate:36}],38:[function(r,n,i){var s={};(0,r("./lib/utils/common").assign)(s,r("./lib/deflate"),r("./lib/inflate"),r("./lib/zlib/constants")),n.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(r,n,i){var s=r("./zlib/deflate"),a=r("./utils/common"),l=r("./utils/strings"),c=r("./zlib/messages"),d=r("./zlib/zstream"),u=Object.prototype.toString,f=0,h=-1,p=0,g=8;function m(v){if(!(this instanceof m))return new m(v);this.options=a.assign({level:h,method:g,chunkSize:16384,windowBits:15,memLevel:8,strategy:p,to:""},v||{});var y=this.options;y.raw&&0<y.windowBits?y.windowBits=-y.windowBits:y.gzip&&0<y.windowBits&&y.windowBits<16&&(y.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var b=s.deflateInit2(this.strm,y.level,y.method,y.windowBits,y.memLevel,y.strategy);if(b!==f)throw new Error(c[b]);if(y.header&&s.deflateSetHeader(this.strm,y.header),y.dictionary){var w;if(w=typeof y.dictionary=="string"?l.string2buf(y.dictionary):u.call(y.dictionary)==="[object ArrayBuffer]"?new Uint8Array(y.dictionary):y.dictionary,(b=s.deflateSetDictionary(this.strm,w))!==f)throw new Error(c[b]);this._dict_set=!0}}function x(v,y){var b=new m(y);if(b.push(v,!0),b.err)throw b.msg||c[b.err];return b.result}m.prototype.push=function(v,y){var b,w,j=this.strm,_=this.options.chunkSize;if(this.ended)return!1;w=y===~~y?y:y===!0?4:0,typeof v=="string"?j.input=l.string2buf(v):u.call(v)==="[object ArrayBuffer]"?j.input=new Uint8Array(v):j.input=v,j.next_in=0,j.avail_in=j.input.length;do{if(j.avail_out===0&&(j.output=new a.Buf8(_),j.next_out=0,j.avail_out=_),(b=s.deflate(j,w))!==1&&b!==f)return this.onEnd(b),!(this.ended=!0);j.avail_out!==0&&(j.avail_in!==0||w!==4&&w!==2)||(this.options.to==="string"?this.onData(l.buf2binstring(a.shrinkBuf(j.output,j.next_out))):this.onData(a.shrinkBuf(j.output,j.next_out)))}while((0<j.avail_in||j.avail_out===0)&&b!==1);return w===4?(b=s.deflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===f):w!==2||(this.onEnd(f),!(j.avail_out=0))},m.prototype.onData=function(v){this.chunks.push(v)},m.prototype.onEnd=function(v){v===f&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=v,this.msg=this.strm.msg},i.Deflate=m,i.deflate=x,i.deflateRaw=function(v,y){return(y=y||{}).raw=!0,x(v,y)},i.gzip=function(v,y){return(y=y||{}).gzip=!0,x(v,y)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(r,n,i){var s=r("./zlib/inflate"),a=r("./utils/common"),l=r("./utils/strings"),c=r("./zlib/constants"),d=r("./zlib/messages"),u=r("./zlib/zstream"),f=r("./zlib/gzheader"),h=Object.prototype.toString;function p(m){if(!(this instanceof p))return new p(m);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},m||{});var x=this.options;x.raw&&0<=x.windowBits&&x.windowBits<16&&(x.windowBits=-x.windowBits,x.windowBits===0&&(x.windowBits=-15)),!(0<=x.windowBits&&x.windowBits<16)||m&&m.windowBits||(x.windowBits+=32),15<x.windowBits&&x.windowBits<48&&!(15&x.windowBits)&&(x.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var v=s.inflateInit2(this.strm,x.windowBits);if(v!==c.Z_OK)throw new Error(d[v]);this.header=new f,s.inflateGetHeader(this.strm,this.header)}function g(m,x){var v=new p(x);if(v.push(m,!0),v.err)throw v.msg||d[v.err];return v.result}p.prototype.push=function(m,x){var v,y,b,w,j,_,E=this.strm,N=this.options.chunkSize,O=this.options.dictionary,I=!1;if(this.ended)return!1;y=x===~~x?x:x===!0?c.Z_FINISH:c.Z_NO_FLUSH,typeof m=="string"?E.input=l.binstring2buf(m):h.call(m)==="[object ArrayBuffer]"?E.input=new Uint8Array(m):E.input=m,E.next_in=0,E.avail_in=E.input.length;do{if(E.avail_out===0&&(E.output=new a.Buf8(N),E.next_out=0,E.avail_out=N),(v=s.inflate(E,c.Z_NO_FLUSH))===c.Z_NEED_DICT&&O&&(_=typeof O=="string"?l.string2buf(O):h.call(O)==="[object ArrayBuffer]"?new Uint8Array(O):O,v=s.inflateSetDictionary(this.strm,_)),v===c.Z_BUF_ERROR&&I===!0&&(v=c.Z_OK,I=!1),v!==c.Z_STREAM_END&&v!==c.Z_OK)return this.onEnd(v),!(this.ended=!0);E.next_out&&(E.avail_out!==0&&v!==c.Z_STREAM_END&&(E.avail_in!==0||y!==c.Z_FINISH&&y!==c.Z_SYNC_FLUSH)||(this.options.to==="string"?(b=l.utf8border(E.output,E.next_out),w=E.next_out-b,j=l.buf2string(E.output,b),E.next_out=w,E.avail_out=N-w,w&&a.arraySet(E.output,E.output,b,w,0),this.onData(j)):this.onData(a.shrinkBuf(E.output,E.next_out)))),E.avail_in===0&&E.avail_out===0&&(I=!0)}while((0<E.avail_in||E.avail_out===0)&&v!==c.Z_STREAM_END);return v===c.Z_STREAM_END&&(y=c.Z_FINISH),y===c.Z_FINISH?(v=s.inflateEnd(this.strm),this.onEnd(v),this.ended=!0,v===c.Z_OK):y!==c.Z_SYNC_FLUSH||(this.onEnd(c.Z_OK),!(E.avail_out=0))},p.prototype.onData=function(m){this.chunks.push(m)},p.prototype.onEnd=function(m){m===c.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=m,this.msg=this.strm.msg},i.Inflate=p,i.inflate=g,i.inflateRaw=function(m,x){return(x=x||{}).raw=!0,g(m,x)},i.ungzip=g},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(r,n,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(c){for(var d=Array.prototype.slice.call(arguments,1);d.length;){var u=d.shift();if(u){if(typeof u!="object")throw new TypeError(u+"must be non-object");for(var f in u)u.hasOwnProperty(f)&&(c[f]=u[f])}}return c},i.shrinkBuf=function(c,d){return c.length===d?c:c.subarray?c.subarray(0,d):(c.length=d,c)};var a={arraySet:function(c,d,u,f,h){if(d.subarray&&c.subarray)c.set(d.subarray(u,u+f),h);else for(var p=0;p<f;p++)c[h+p]=d[u+p]},flattenChunks:function(c){var d,u,f,h,p,g;for(d=f=0,u=c.length;d<u;d++)f+=c[d].length;for(g=new Uint8Array(f),d=h=0,u=c.length;d<u;d++)p=c[d],g.set(p,h),h+=p.length;return g}},l={arraySet:function(c,d,u,f,h){for(var p=0;p<f;p++)c[h+p]=d[u+p]},flattenChunks:function(c){return[].concat.apply([],c)}};i.setTyped=function(c){c?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,a)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,l))},i.setTyped(s)},{}],42:[function(r,n,i){var s=r("./common"),a=!0,l=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{l=!1}for(var c=new s.Buf8(256),d=0;d<256;d++)c[d]=252<=d?6:248<=d?5:240<=d?4:224<=d?3:192<=d?2:1;function u(f,h){if(h<65537&&(f.subarray&&l||!f.subarray&&a))return String.fromCharCode.apply(null,s.shrinkBuf(f,h));for(var p="",g=0;g<h;g++)p+=String.fromCharCode(f[g]);return p}c[254]=c[254]=1,i.string2buf=function(f){var h,p,g,m,x,v=f.length,y=0;for(m=0;m<v;m++)(64512&(p=f.charCodeAt(m)))==55296&&m+1<v&&(64512&(g=f.charCodeAt(m+1)))==56320&&(p=65536+(p-55296<<10)+(g-56320),m++),y+=p<128?1:p<2048?2:p<65536?3:4;for(h=new s.Buf8(y),m=x=0;x<y;m++)(64512&(p=f.charCodeAt(m)))==55296&&m+1<v&&(64512&(g=f.charCodeAt(m+1)))==56320&&(p=65536+(p-55296<<10)+(g-56320),m++),p<128?h[x++]=p:(p<2048?h[x++]=192|p>>>6:(p<65536?h[x++]=224|p>>>12:(h[x++]=240|p>>>18,h[x++]=128|p>>>12&63),h[x++]=128|p>>>6&63),h[x++]=128|63&p);return h},i.buf2binstring=function(f){return u(f,f.length)},i.binstring2buf=function(f){for(var h=new s.Buf8(f.length),p=0,g=h.length;p<g;p++)h[p]=f.charCodeAt(p);return h},i.buf2string=function(f,h){var p,g,m,x,v=h||f.length,y=new Array(2*v);for(p=g=0;p<v;)if((m=f[p++])<128)y[g++]=m;else if(4<(x=c[m]))y[g++]=65533,p+=x-1;else{for(m&=x===2?31:x===3?15:7;1<x&&p<v;)m=m<<6|63&f[p++],x--;1<x?y[g++]=65533:m<65536?y[g++]=m:(m-=65536,y[g++]=55296|m>>10&1023,y[g++]=56320|1023&m)}return u(y,g)},i.utf8border=function(f,h){var p;for((h=h||f.length)>f.length&&(h=f.length),p=h-1;0<=p&&(192&f[p])==128;)p--;return p<0||p===0?h:p+c[f[p]]>h?p:h}},{"./common":41}],43:[function(r,n,i){n.exports=function(s,a,l,c){for(var d=65535&s|0,u=s>>>16&65535|0,f=0;l!==0;){for(l-=f=2e3<l?2e3:l;u=u+(d=d+a[c++]|0)|0,--f;);d%=65521,u%=65521}return d|u<<16|0}},{}],44:[function(r,n,i){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(r,n,i){var s=function(){for(var a,l=[],c=0;c<256;c++){a=c;for(var d=0;d<8;d++)a=1&a?3988292384^a>>>1:a>>>1;l[c]=a}return l}();n.exports=function(a,l,c,d){var u=s,f=d+c;a^=-1;for(var h=d;h<f;h++)a=a>>>8^u[255&(a^l[h])];return-1^a}},{}],46:[function(r,n,i){var s,a=r("../utils/common"),l=r("./trees"),c=r("./adler32"),d=r("./crc32"),u=r("./messages"),f=0,h=4,p=0,g=-2,m=-1,x=4,v=2,y=8,b=9,w=286,j=30,_=19,E=2*w+1,N=15,O=3,I=258,te=I+O+1,T=42,V=113,S=1,K=2,fe=3,U=4;function z(C,ce){return C.msg=u[ce],ce}function H(C){return(C<<1)-(4<C?9:0)}function Q(C){for(var ce=C.length;0<=--ce;)C[ce]=0}function W(C){var ce=C.state,ne=ce.pending;ne>C.avail_out&&(ne=C.avail_out),ne!==0&&(a.arraySet(C.output,ce.pending_buf,ce.pending_out,ne,C.next_out),C.next_out+=ne,ce.pending_out+=ne,C.total_out+=ne,C.avail_out-=ne,ce.pending-=ne,ce.pending===0&&(ce.pending_out=0))}function q(C,ce){l._tr_flush_block(C,0<=C.block_start?C.block_start:-1,C.strstart-C.block_start,ce),C.block_start=C.strstart,W(C.strm)}function re(C,ce){C.pending_buf[C.pending++]=ce}function oe(C,ce){C.pending_buf[C.pending++]=ce>>>8&255,C.pending_buf[C.pending++]=255&ce}function pe(C,ce){var ne,F,R=C.max_chain_length,M=C.strstart,Z=C.prev_length,Y=C.nice_match,L=C.strstart>C.w_size-te?C.strstart-(C.w_size-te):0,J=C.window,ue=C.w_mask,ie=C.prev,$=C.strstart+I,X=J[M+Z-1],ae=J[M+Z];C.prev_length>=C.good_match&&(R>>=2),Y>C.lookahead&&(Y=C.lookahead);do if(J[(ne=ce)+Z]===ae&&J[ne+Z-1]===X&&J[ne]===J[M]&&J[++ne]===J[M+1]){M+=2,ne++;do;while(J[++M]===J[++ne]&&J[++M]===J[++ne]&&J[++M]===J[++ne]&&J[++M]===J[++ne]&&J[++M]===J[++ne]&&J[++M]===J[++ne]&&J[++M]===J[++ne]&&J[++M]===J[++ne]&&M<$);if(F=I-($-M),M=$-I,Z<F){if(C.match_start=ce,Y<=(Z=F))break;X=J[M+Z-1],ae=J[M+Z]}}while((ce=ie[ce&ue])>L&&--R!=0);return Z<=C.lookahead?Z:C.lookahead}function Pe(C){var ce,ne,F,R,M,Z,Y,L,J,ue,ie=C.w_size;do{if(R=C.window_size-C.lookahead-C.strstart,C.strstart>=ie+(ie-te)){for(a.arraySet(C.window,C.window,ie,ie,0),C.match_start-=ie,C.strstart-=ie,C.block_start-=ie,ce=ne=C.hash_size;F=C.head[--ce],C.head[ce]=ie<=F?F-ie:0,--ne;);for(ce=ne=ie;F=C.prev[--ce],C.prev[ce]=ie<=F?F-ie:0,--ne;);R+=ie}if(C.strm.avail_in===0)break;if(Z=C.strm,Y=C.window,L=C.strstart+C.lookahead,J=R,ue=void 0,ue=Z.avail_in,J<ue&&(ue=J),ne=ue===0?0:(Z.avail_in-=ue,a.arraySet(Y,Z.input,Z.next_in,ue,L),Z.state.wrap===1?Z.adler=c(Z.adler,Y,ue,L):Z.state.wrap===2&&(Z.adler=d(Z.adler,Y,ue,L)),Z.next_in+=ue,Z.total_in+=ue,ue),C.lookahead+=ne,C.lookahead+C.insert>=O)for(M=C.strstart-C.insert,C.ins_h=C.window[M],C.ins_h=(C.ins_h<<C.hash_shift^C.window[M+1])&C.hash_mask;C.insert&&(C.ins_h=(C.ins_h<<C.hash_shift^C.window[M+O-1])&C.hash_mask,C.prev[M&C.w_mask]=C.head[C.ins_h],C.head[C.ins_h]=M,M++,C.insert--,!(C.lookahead+C.insert<O)););}while(C.lookahead<te&&C.strm.avail_in!==0)}function Re(C,ce){for(var ne,F;;){if(C.lookahead<te){if(Pe(C),C.lookahead<te&&ce===f)return S;if(C.lookahead===0)break}if(ne=0,C.lookahead>=O&&(C.ins_h=(C.ins_h<<C.hash_shift^C.window[C.strstart+O-1])&C.hash_mask,ne=C.prev[C.strstart&C.w_mask]=C.head[C.ins_h],C.head[C.ins_h]=C.strstart),ne!==0&&C.strstart-ne<=C.w_size-te&&(C.match_length=pe(C,ne)),C.match_length>=O)if(F=l._tr_tally(C,C.strstart-C.match_start,C.match_length-O),C.lookahead-=C.match_length,C.match_length<=C.max_lazy_match&&C.lookahead>=O){for(C.match_length--;C.strstart++,C.ins_h=(C.ins_h<<C.hash_shift^C.window[C.strstart+O-1])&C.hash_mask,ne=C.prev[C.strstart&C.w_mask]=C.head[C.ins_h],C.head[C.ins_h]=C.strstart,--C.match_length!=0;);C.strstart++}else C.strstart+=C.match_length,C.match_length=0,C.ins_h=C.window[C.strstart],C.ins_h=(C.ins_h<<C.hash_shift^C.window[C.strstart+1])&C.hash_mask;else F=l._tr_tally(C,0,C.window[C.strstart]),C.lookahead--,C.strstart++;if(F&&(q(C,!1),C.strm.avail_out===0))return S}return C.insert=C.strstart<O-1?C.strstart:O-1,ce===h?(q(C,!0),C.strm.avail_out===0?fe:U):C.last_lit&&(q(C,!1),C.strm.avail_out===0)?S:K}function Ae(C,ce){for(var ne,F,R;;){if(C.lookahead<te){if(Pe(C),C.lookahead<te&&ce===f)return S;if(C.lookahead===0)break}if(ne=0,C.lookahead>=O&&(C.ins_h=(C.ins_h<<C.hash_shift^C.window[C.strstart+O-1])&C.hash_mask,ne=C.prev[C.strstart&C.w_mask]=C.head[C.ins_h],C.head[C.ins_h]=C.strstart),C.prev_length=C.match_length,C.prev_match=C.match_start,C.match_length=O-1,ne!==0&&C.prev_length<C.max_lazy_match&&C.strstart-ne<=C.w_size-te&&(C.match_length=pe(C,ne),C.match_length<=5&&(C.strategy===1||C.match_length===O&&4096<C.strstart-C.match_start)&&(C.match_length=O-1)),C.prev_length>=O&&C.match_length<=C.prev_length){for(R=C.strstart+C.lookahead-O,F=l._tr_tally(C,C.strstart-1-C.prev_match,C.prev_length-O),C.lookahead-=C.prev_length-1,C.prev_length-=2;++C.strstart<=R&&(C.ins_h=(C.ins_h<<C.hash_shift^C.window[C.strstart+O-1])&C.hash_mask,ne=C.prev[C.strstart&C.w_mask]=C.head[C.ins_h],C.head[C.ins_h]=C.strstart),--C.prev_length!=0;);if(C.match_available=0,C.match_length=O-1,C.strstart++,F&&(q(C,!1),C.strm.avail_out===0))return S}else if(C.match_available){if((F=l._tr_tally(C,0,C.window[C.strstart-1]))&&q(C,!1),C.strstart++,C.lookahead--,C.strm.avail_out===0)return S}else C.match_available=1,C.strstart++,C.lookahead--}return C.match_available&&(F=l._tr_tally(C,0,C.window[C.strstart-1]),C.match_available=0),C.insert=C.strstart<O-1?C.strstart:O-1,ce===h?(q(C,!0),C.strm.avail_out===0?fe:U):C.last_lit&&(q(C,!1),C.strm.avail_out===0)?S:K}function Ce(C,ce,ne,F,R){this.good_length=C,this.max_lazy=ce,this.nice_length=ne,this.max_chain=F,this.func=R}function ve(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=y,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*E),this.dyn_dtree=new a.Buf16(2*(2*j+1)),this.bl_tree=new a.Buf16(2*(2*_+1)),Q(this.dyn_ltree),Q(this.dyn_dtree),Q(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(N+1),this.heap=new a.Buf16(2*w+1),Q(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*w+1),Q(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function me(C){var ce;return C&&C.state?(C.total_in=C.total_out=0,C.data_type=v,(ce=C.state).pending=0,ce.pending_out=0,ce.wrap<0&&(ce.wrap=-ce.wrap),ce.status=ce.wrap?T:V,C.adler=ce.wrap===2?0:1,ce.last_flush=f,l._tr_init(ce),p):z(C,g)}function De(C){var ce=me(C);return ce===p&&function(ne){ne.window_size=2*ne.w_size,Q(ne.head),ne.max_lazy_match=s[ne.level].max_lazy,ne.good_match=s[ne.level].good_length,ne.nice_match=s[ne.level].nice_length,ne.max_chain_length=s[ne.level].max_chain,ne.strstart=0,ne.block_start=0,ne.lookahead=0,ne.insert=0,ne.match_length=ne.prev_length=O-1,ne.match_available=0,ne.ins_h=0}(C.state),ce}function Xe(C,ce,ne,F,R,M){if(!C)return g;var Z=1;if(ce===m&&(ce=6),F<0?(Z=0,F=-F):15<F&&(Z=2,F-=16),R<1||b<R||ne!==y||F<8||15<F||ce<0||9<ce||M<0||x<M)return z(C,g);F===8&&(F=9);var Y=new ve;return(C.state=Y).strm=C,Y.wrap=Z,Y.gzhead=null,Y.w_bits=F,Y.w_size=1<<Y.w_bits,Y.w_mask=Y.w_size-1,Y.hash_bits=R+7,Y.hash_size=1<<Y.hash_bits,Y.hash_mask=Y.hash_size-1,Y.hash_shift=~~((Y.hash_bits+O-1)/O),Y.window=new a.Buf8(2*Y.w_size),Y.head=new a.Buf16(Y.hash_size),Y.prev=new a.Buf16(Y.w_size),Y.lit_bufsize=1<<R+6,Y.pending_buf_size=4*Y.lit_bufsize,Y.pending_buf=new a.Buf8(Y.pending_buf_size),Y.d_buf=1*Y.lit_bufsize,Y.l_buf=3*Y.lit_bufsize,Y.level=ce,Y.strategy=M,Y.method=ne,De(C)}s=[new Ce(0,0,0,0,function(C,ce){var ne=65535;for(ne>C.pending_buf_size-5&&(ne=C.pending_buf_size-5);;){if(C.lookahead<=1){if(Pe(C),C.lookahead===0&&ce===f)return S;if(C.lookahead===0)break}C.strstart+=C.lookahead,C.lookahead=0;var F=C.block_start+ne;if((C.strstart===0||C.strstart>=F)&&(C.lookahead=C.strstart-F,C.strstart=F,q(C,!1),C.strm.avail_out===0)||C.strstart-C.block_start>=C.w_size-te&&(q(C,!1),C.strm.avail_out===0))return S}return C.insert=0,ce===h?(q(C,!0),C.strm.avail_out===0?fe:U):(C.strstart>C.block_start&&(q(C,!1),C.strm.avail_out),S)}),new Ce(4,4,8,4,Re),new Ce(4,5,16,8,Re),new Ce(4,6,32,32,Re),new Ce(4,4,16,16,Ae),new Ce(8,16,32,32,Ae),new Ce(8,16,128,128,Ae),new Ce(8,32,128,256,Ae),new Ce(32,128,258,1024,Ae),new Ce(32,258,258,4096,Ae)],i.deflateInit=function(C,ce){return Xe(C,ce,y,15,8,0)},i.deflateInit2=Xe,i.deflateReset=De,i.deflateResetKeep=me,i.deflateSetHeader=function(C,ce){return C&&C.state?C.state.wrap!==2?g:(C.state.gzhead=ce,p):g},i.deflate=function(C,ce){var ne,F,R,M;if(!C||!C.state||5<ce||ce<0)return C?z(C,g):g;if(F=C.state,!C.output||!C.input&&C.avail_in!==0||F.status===666&&ce!==h)return z(C,C.avail_out===0?-5:g);if(F.strm=C,ne=F.last_flush,F.last_flush=ce,F.status===T)if(F.wrap===2)C.adler=0,re(F,31),re(F,139),re(F,8),F.gzhead?(re(F,(F.gzhead.text?1:0)+(F.gzhead.hcrc?2:0)+(F.gzhead.extra?4:0)+(F.gzhead.name?8:0)+(F.gzhead.comment?16:0)),re(F,255&F.gzhead.time),re(F,F.gzhead.time>>8&255),re(F,F.gzhead.time>>16&255),re(F,F.gzhead.time>>24&255),re(F,F.level===9?2:2<=F.strategy||F.level<2?4:0),re(F,255&F.gzhead.os),F.gzhead.extra&&F.gzhead.extra.length&&(re(F,255&F.gzhead.extra.length),re(F,F.gzhead.extra.length>>8&255)),F.gzhead.hcrc&&(C.adler=d(C.adler,F.pending_buf,F.pending,0)),F.gzindex=0,F.status=69):(re(F,0),re(F,0),re(F,0),re(F,0),re(F,0),re(F,F.level===9?2:2<=F.strategy||F.level<2?4:0),re(F,3),F.status=V);else{var Z=y+(F.w_bits-8<<4)<<8;Z|=(2<=F.strategy||F.level<2?0:F.level<6?1:F.level===6?2:3)<<6,F.strstart!==0&&(Z|=32),Z+=31-Z%31,F.status=V,oe(F,Z),F.strstart!==0&&(oe(F,C.adler>>>16),oe(F,65535&C.adler)),C.adler=1}if(F.status===69)if(F.gzhead.extra){for(R=F.pending;F.gzindex<(65535&F.gzhead.extra.length)&&(F.pending!==F.pending_buf_size||(F.gzhead.hcrc&&F.pending>R&&(C.adler=d(C.adler,F.pending_buf,F.pending-R,R)),W(C),R=F.pending,F.pending!==F.pending_buf_size));)re(F,255&F.gzhead.extra[F.gzindex]),F.gzindex++;F.gzhead.hcrc&&F.pending>R&&(C.adler=d(C.adler,F.pending_buf,F.pending-R,R)),F.gzindex===F.gzhead.extra.length&&(F.gzindex=0,F.status=73)}else F.status=73;if(F.status===73)if(F.gzhead.name){R=F.pending;do{if(F.pending===F.pending_buf_size&&(F.gzhead.hcrc&&F.pending>R&&(C.adler=d(C.adler,F.pending_buf,F.pending-R,R)),W(C),R=F.pending,F.pending===F.pending_buf_size)){M=1;break}M=F.gzindex<F.gzhead.name.length?255&F.gzhead.name.charCodeAt(F.gzindex++):0,re(F,M)}while(M!==0);F.gzhead.hcrc&&F.pending>R&&(C.adler=d(C.adler,F.pending_buf,F.pending-R,R)),M===0&&(F.gzindex=0,F.status=91)}else F.status=91;if(F.status===91)if(F.gzhead.comment){R=F.pending;do{if(F.pending===F.pending_buf_size&&(F.gzhead.hcrc&&F.pending>R&&(C.adler=d(C.adler,F.pending_buf,F.pending-R,R)),W(C),R=F.pending,F.pending===F.pending_buf_size)){M=1;break}M=F.gzindex<F.gzhead.comment.length?255&F.gzhead.comment.charCodeAt(F.gzindex++):0,re(F,M)}while(M!==0);F.gzhead.hcrc&&F.pending>R&&(C.adler=d(C.adler,F.pending_buf,F.pending-R,R)),M===0&&(F.status=103)}else F.status=103;if(F.status===103&&(F.gzhead.hcrc?(F.pending+2>F.pending_buf_size&&W(C),F.pending+2<=F.pending_buf_size&&(re(F,255&C.adler),re(F,C.adler>>8&255),C.adler=0,F.status=V)):F.status=V),F.pending!==0){if(W(C),C.avail_out===0)return F.last_flush=-1,p}else if(C.avail_in===0&&H(ce)<=H(ne)&&ce!==h)return z(C,-5);if(F.status===666&&C.avail_in!==0)return z(C,-5);if(C.avail_in!==0||F.lookahead!==0||ce!==f&&F.status!==666){var Y=F.strategy===2?function(L,J){for(var ue;;){if(L.lookahead===0&&(Pe(L),L.lookahead===0)){if(J===f)return S;break}if(L.match_length=0,ue=l._tr_tally(L,0,L.window[L.strstart]),L.lookahead--,L.strstart++,ue&&(q(L,!1),L.strm.avail_out===0))return S}return L.insert=0,J===h?(q(L,!0),L.strm.avail_out===0?fe:U):L.last_lit&&(q(L,!1),L.strm.avail_out===0)?S:K}(F,ce):F.strategy===3?function(L,J){for(var ue,ie,$,X,ae=L.window;;){if(L.lookahead<=I){if(Pe(L),L.lookahead<=I&&J===f)return S;if(L.lookahead===0)break}if(L.match_length=0,L.lookahead>=O&&0<L.strstart&&(ie=ae[$=L.strstart-1])===ae[++$]&&ie===ae[++$]&&ie===ae[++$]){X=L.strstart+I;do;while(ie===ae[++$]&&ie===ae[++$]&&ie===ae[++$]&&ie===ae[++$]&&ie===ae[++$]&&ie===ae[++$]&&ie===ae[++$]&&ie===ae[++$]&&$<X);L.match_length=I-(X-$),L.match_length>L.lookahead&&(L.match_length=L.lookahead)}if(L.match_length>=O?(ue=l._tr_tally(L,1,L.match_length-O),L.lookahead-=L.match_length,L.strstart+=L.match_length,L.match_length=0):(ue=l._tr_tally(L,0,L.window[L.strstart]),L.lookahead--,L.strstart++),ue&&(q(L,!1),L.strm.avail_out===0))return S}return L.insert=0,J===h?(q(L,!0),L.strm.avail_out===0?fe:U):L.last_lit&&(q(L,!1),L.strm.avail_out===0)?S:K}(F,ce):s[F.level].func(F,ce);if(Y!==fe&&Y!==U||(F.status=666),Y===S||Y===fe)return C.avail_out===0&&(F.last_flush=-1),p;if(Y===K&&(ce===1?l._tr_align(F):ce!==5&&(l._tr_stored_block(F,0,0,!1),ce===3&&(Q(F.head),F.lookahead===0&&(F.strstart=0,F.block_start=0,F.insert=0))),W(C),C.avail_out===0))return F.last_flush=-1,p}return ce!==h?p:F.wrap<=0?1:(F.wrap===2?(re(F,255&C.adler),re(F,C.adler>>8&255),re(F,C.adler>>16&255),re(F,C.adler>>24&255),re(F,255&C.total_in),re(F,C.total_in>>8&255),re(F,C.total_in>>16&255),re(F,C.total_in>>24&255)):(oe(F,C.adler>>>16),oe(F,65535&C.adler)),W(C),0<F.wrap&&(F.wrap=-F.wrap),F.pending!==0?p:1)},i.deflateEnd=function(C){var ce;return C&&C.state?(ce=C.state.status)!==T&&ce!==69&&ce!==73&&ce!==91&&ce!==103&&ce!==V&&ce!==666?z(C,g):(C.state=null,ce===V?z(C,-3):p):g},i.deflateSetDictionary=function(C,ce){var ne,F,R,M,Z,Y,L,J,ue=ce.length;if(!C||!C.state||(M=(ne=C.state).wrap)===2||M===1&&ne.status!==T||ne.lookahead)return g;for(M===1&&(C.adler=c(C.adler,ce,ue,0)),ne.wrap=0,ue>=ne.w_size&&(M===0&&(Q(ne.head),ne.strstart=0,ne.block_start=0,ne.insert=0),J=new a.Buf8(ne.w_size),a.arraySet(J,ce,ue-ne.w_size,ne.w_size,0),ce=J,ue=ne.w_size),Z=C.avail_in,Y=C.next_in,L=C.input,C.avail_in=ue,C.next_in=0,C.input=ce,Pe(ne);ne.lookahead>=O;){for(F=ne.strstart,R=ne.lookahead-(O-1);ne.ins_h=(ne.ins_h<<ne.hash_shift^ne.window[F+O-1])&ne.hash_mask,ne.prev[F&ne.w_mask]=ne.head[ne.ins_h],ne.head[ne.ins_h]=F,F++,--R;);ne.strstart=F,ne.lookahead=O-1,Pe(ne)}return ne.strstart+=ne.lookahead,ne.block_start=ne.strstart,ne.insert=ne.lookahead,ne.lookahead=0,ne.match_length=ne.prev_length=O-1,ne.match_available=0,C.next_in=Y,C.input=L,C.avail_in=Z,ne.wrap=M,p},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(r,n,i){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(r,n,i){n.exports=function(s,a){var l,c,d,u,f,h,p,g,m,x,v,y,b,w,j,_,E,N,O,I,te,T,V,S,K;l=s.state,c=s.next_in,S=s.input,d=c+(s.avail_in-5),u=s.next_out,K=s.output,f=u-(a-s.avail_out),h=u+(s.avail_out-257),p=l.dmax,g=l.wsize,m=l.whave,x=l.wnext,v=l.window,y=l.hold,b=l.bits,w=l.lencode,j=l.distcode,_=(1<<l.lenbits)-1,E=(1<<l.distbits)-1;e:do{b<15&&(y+=S[c++]<<b,b+=8,y+=S[c++]<<b,b+=8),N=w[y&_];t:for(;;){if(y>>>=O=N>>>24,b-=O,(O=N>>>16&255)===0)K[u++]=65535&N;else{if(!(16&O)){if(!(64&O)){N=w[(65535&N)+(y&(1<<O)-1)];continue t}if(32&O){l.mode=12;break e}s.msg="invalid literal/length code",l.mode=30;break e}I=65535&N,(O&=15)&&(b<O&&(y+=S[c++]<<b,b+=8),I+=y&(1<<O)-1,y>>>=O,b-=O),b<15&&(y+=S[c++]<<b,b+=8,y+=S[c++]<<b,b+=8),N=j[y&E];r:for(;;){if(y>>>=O=N>>>24,b-=O,!(16&(O=N>>>16&255))){if(!(64&O)){N=j[(65535&N)+(y&(1<<O)-1)];continue r}s.msg="invalid distance code",l.mode=30;break e}if(te=65535&N,b<(O&=15)&&(y+=S[c++]<<b,(b+=8)<O&&(y+=S[c++]<<b,b+=8)),p<(te+=y&(1<<O)-1)){s.msg="invalid distance too far back",l.mode=30;break e}if(y>>>=O,b-=O,(O=u-f)<te){if(m<(O=te-O)&&l.sane){s.msg="invalid distance too far back",l.mode=30;break e}if(V=v,(T=0)===x){if(T+=g-O,O<I){for(I-=O;K[u++]=v[T++],--O;);T=u-te,V=K}}else if(x<O){if(T+=g+x-O,(O-=x)<I){for(I-=O;K[u++]=v[T++],--O;);if(T=0,x<I){for(I-=O=x;K[u++]=v[T++],--O;);T=u-te,V=K}}}else if(T+=x-O,O<I){for(I-=O;K[u++]=v[T++],--O;);T=u-te,V=K}for(;2<I;)K[u++]=V[T++],K[u++]=V[T++],K[u++]=V[T++],I-=3;I&&(K[u++]=V[T++],1<I&&(K[u++]=V[T++]))}else{for(T=u-te;K[u++]=K[T++],K[u++]=K[T++],K[u++]=K[T++],2<(I-=3););I&&(K[u++]=K[T++],1<I&&(K[u++]=K[T++]))}break}}break}}while(c<d&&u<h);c-=I=b>>3,y&=(1<<(b-=I<<3))-1,s.next_in=c,s.next_out=u,s.avail_in=c<d?d-c+5:5-(c-d),s.avail_out=u<h?h-u+257:257-(u-h),l.hold=y,l.bits=b}},{}],49:[function(r,n,i){var s=r("../utils/common"),a=r("./adler32"),l=r("./crc32"),c=r("./inffast"),d=r("./inftrees"),u=1,f=2,h=0,p=-2,g=1,m=852,x=592;function v(T){return(T>>>24&255)+(T>>>8&65280)+((65280&T)<<8)+((255&T)<<24)}function y(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function b(T){var V;return T&&T.state?(V=T.state,T.total_in=T.total_out=V.total=0,T.msg="",V.wrap&&(T.adler=1&V.wrap),V.mode=g,V.last=0,V.havedict=0,V.dmax=32768,V.head=null,V.hold=0,V.bits=0,V.lencode=V.lendyn=new s.Buf32(m),V.distcode=V.distdyn=new s.Buf32(x),V.sane=1,V.back=-1,h):p}function w(T){var V;return T&&T.state?((V=T.state).wsize=0,V.whave=0,V.wnext=0,b(T)):p}function j(T,V){var S,K;return T&&T.state?(K=T.state,V<0?(S=0,V=-V):(S=1+(V>>4),V<48&&(V&=15)),V&&(V<8||15<V)?p:(K.window!==null&&K.wbits!==V&&(K.window=null),K.wrap=S,K.wbits=V,w(T))):p}function _(T,V){var S,K;return T?(K=new y,(T.state=K).window=null,(S=j(T,V))!==h&&(T.state=null),S):p}var E,N,O=!0;function I(T){if(O){var V;for(E=new s.Buf32(512),N=new s.Buf32(32),V=0;V<144;)T.lens[V++]=8;for(;V<256;)T.lens[V++]=9;for(;V<280;)T.lens[V++]=7;for(;V<288;)T.lens[V++]=8;for(d(u,T.lens,0,288,E,0,T.work,{bits:9}),V=0;V<32;)T.lens[V++]=5;d(f,T.lens,0,32,N,0,T.work,{bits:5}),O=!1}T.lencode=E,T.lenbits=9,T.distcode=N,T.distbits=5}function te(T,V,S,K){var fe,U=T.state;return U.window===null&&(U.wsize=1<<U.wbits,U.wnext=0,U.whave=0,U.window=new s.Buf8(U.wsize)),K>=U.wsize?(s.arraySet(U.window,V,S-U.wsize,U.wsize,0),U.wnext=0,U.whave=U.wsize):(K<(fe=U.wsize-U.wnext)&&(fe=K),s.arraySet(U.window,V,S-K,fe,U.wnext),(K-=fe)?(s.arraySet(U.window,V,S-K,K,0),U.wnext=K,U.whave=U.wsize):(U.wnext+=fe,U.wnext===U.wsize&&(U.wnext=0),U.whave<U.wsize&&(U.whave+=fe))),0}i.inflateReset=w,i.inflateReset2=j,i.inflateResetKeep=b,i.inflateInit=function(T){return _(T,15)},i.inflateInit2=_,i.inflate=function(T,V){var S,K,fe,U,z,H,Q,W,q,re,oe,pe,Pe,Re,Ae,Ce,ve,me,De,Xe,C,ce,ne,F,R=0,M=new s.Buf8(4),Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!T||!T.state||!T.output||!T.input&&T.avail_in!==0)return p;(S=T.state).mode===12&&(S.mode=13),z=T.next_out,fe=T.output,Q=T.avail_out,U=T.next_in,K=T.input,H=T.avail_in,W=S.hold,q=S.bits,re=H,oe=Q,ce=h;e:for(;;)switch(S.mode){case g:if(S.wrap===0){S.mode=13;break}for(;q<16;){if(H===0)break e;H--,W+=K[U++]<<q,q+=8}if(2&S.wrap&&W===35615){M[S.check=0]=255&W,M[1]=W>>>8&255,S.check=l(S.check,M,2,0),q=W=0,S.mode=2;break}if(S.flags=0,S.head&&(S.head.done=!1),!(1&S.wrap)||(((255&W)<<8)+(W>>8))%31){T.msg="incorrect header check",S.mode=30;break}if((15&W)!=8){T.msg="unknown compression method",S.mode=30;break}if(q-=4,C=8+(15&(W>>>=4)),S.wbits===0)S.wbits=C;else if(C>S.wbits){T.msg="invalid window size",S.mode=30;break}S.dmax=1<<C,T.adler=S.check=1,S.mode=512&W?10:12,q=W=0;break;case 2:for(;q<16;){if(H===0)break e;H--,W+=K[U++]<<q,q+=8}if(S.flags=W,(255&S.flags)!=8){T.msg="unknown compression method",S.mode=30;break}if(57344&S.flags){T.msg="unknown header flags set",S.mode=30;break}S.head&&(S.head.text=W>>8&1),512&S.flags&&(M[0]=255&W,M[1]=W>>>8&255,S.check=l(S.check,M,2,0)),q=W=0,S.mode=3;case 3:for(;q<32;){if(H===0)break e;H--,W+=K[U++]<<q,q+=8}S.head&&(S.head.time=W),512&S.flags&&(M[0]=255&W,M[1]=W>>>8&255,M[2]=W>>>16&255,M[3]=W>>>24&255,S.check=l(S.check,M,4,0)),q=W=0,S.mode=4;case 4:for(;q<16;){if(H===0)break e;H--,W+=K[U++]<<q,q+=8}S.head&&(S.head.xflags=255&W,S.head.os=W>>8),512&S.flags&&(M[0]=255&W,M[1]=W>>>8&255,S.check=l(S.check,M,2,0)),q=W=0,S.mode=5;case 5:if(1024&S.flags){for(;q<16;){if(H===0)break e;H--,W+=K[U++]<<q,q+=8}S.length=W,S.head&&(S.head.extra_len=W),512&S.flags&&(M[0]=255&W,M[1]=W>>>8&255,S.check=l(S.check,M,2,0)),q=W=0}else S.head&&(S.head.extra=null);S.mode=6;case 6:if(1024&S.flags&&(H<(pe=S.length)&&(pe=H),pe&&(S.head&&(C=S.head.extra_len-S.length,S.head.extra||(S.head.extra=new Array(S.head.extra_len)),s.arraySet(S.head.extra,K,U,pe,C)),512&S.flags&&(S.check=l(S.check,K,pe,U)),H-=pe,U+=pe,S.length-=pe),S.length))break e;S.length=0,S.mode=7;case 7:if(2048&S.flags){if(H===0)break e;for(pe=0;C=K[U+pe++],S.head&&C&&S.length<65536&&(S.head.name+=String.fromCharCode(C)),C&&pe<H;);if(512&S.flags&&(S.check=l(S.check,K,pe,U)),H-=pe,U+=pe,C)break e}else S.head&&(S.head.name=null);S.length=0,S.mode=8;case 8:if(4096&S.flags){if(H===0)break e;for(pe=0;C=K[U+pe++],S.head&&C&&S.length<65536&&(S.head.comment+=String.fromCharCode(C)),C&&pe<H;);if(512&S.flags&&(S.check=l(S.check,K,pe,U)),H-=pe,U+=pe,C)break e}else S.head&&(S.head.comment=null);S.mode=9;case 9:if(512&S.flags){for(;q<16;){if(H===0)break e;H--,W+=K[U++]<<q,q+=8}if(W!==(65535&S.check)){T.msg="header crc mismatch",S.mode=30;break}q=W=0}S.head&&(S.head.hcrc=S.flags>>9&1,S.head.done=!0),T.adler=S.check=0,S.mode=12;break;case 10:for(;q<32;){if(H===0)break e;H--,W+=K[U++]<<q,q+=8}T.adler=S.check=v(W),q=W=0,S.mode=11;case 11:if(S.havedict===0)return T.next_out=z,T.avail_out=Q,T.next_in=U,T.avail_in=H,S.hold=W,S.bits=q,2;T.adler=S.check=1,S.mode=12;case 12:if(V===5||V===6)break e;case 13:if(S.last){W>>>=7&q,q-=7&q,S.mode=27;break}for(;q<3;){if(H===0)break e;H--,W+=K[U++]<<q,q+=8}switch(S.last=1&W,q-=1,3&(W>>>=1)){case 0:S.mode=14;break;case 1:if(I(S),S.mode=20,V!==6)break;W>>>=2,q-=2;break e;case 2:S.mode=17;break;case 3:T.msg="invalid block type",S.mode=30}W>>>=2,q-=2;break;case 14:for(W>>>=7&q,q-=7&q;q<32;){if(H===0)break e;H--,W+=K[U++]<<q,q+=8}if((65535&W)!=(W>>>16^65535)){T.msg="invalid stored block lengths",S.mode=30;break}if(S.length=65535&W,q=W=0,S.mode=15,V===6)break e;case 15:S.mode=16;case 16:if(pe=S.length){if(H<pe&&(pe=H),Q<pe&&(pe=Q),pe===0)break e;s.arraySet(fe,K,U,pe,z),H-=pe,U+=pe,Q-=pe,z+=pe,S.length-=pe;break}S.mode=12;break;case 17:for(;q<14;){if(H===0)break e;H--,W+=K[U++]<<q,q+=8}if(S.nlen=257+(31&W),W>>>=5,q-=5,S.ndist=1+(31&W),W>>>=5,q-=5,S.ncode=4+(15&W),W>>>=4,q-=4,286<S.nlen||30<S.ndist){T.msg="too many length or distance symbols",S.mode=30;break}S.have=0,S.mode=18;case 18:for(;S.have<S.ncode;){for(;q<3;){if(H===0)break e;H--,W+=K[U++]<<q,q+=8}S.lens[Z[S.have++]]=7&W,W>>>=3,q-=3}for(;S.have<19;)S.lens[Z[S.have++]]=0;if(S.lencode=S.lendyn,S.lenbits=7,ne={bits:S.lenbits},ce=d(0,S.lens,0,19,S.lencode,0,S.work,ne),S.lenbits=ne.bits,ce){T.msg="invalid code lengths set",S.mode=30;break}S.have=0,S.mode=19;case 19:for(;S.have<S.nlen+S.ndist;){for(;Ce=(R=S.lencode[W&(1<<S.lenbits)-1])>>>16&255,ve=65535&R,!((Ae=R>>>24)<=q);){if(H===0)break e;H--,W+=K[U++]<<q,q+=8}if(ve<16)W>>>=Ae,q-=Ae,S.lens[S.have++]=ve;else{if(ve===16){for(F=Ae+2;q<F;){if(H===0)break e;H--,W+=K[U++]<<q,q+=8}if(W>>>=Ae,q-=Ae,S.have===0){T.msg="invalid bit length repeat",S.mode=30;break}C=S.lens[S.have-1],pe=3+(3&W),W>>>=2,q-=2}else if(ve===17){for(F=Ae+3;q<F;){if(H===0)break e;H--,W+=K[U++]<<q,q+=8}q-=Ae,C=0,pe=3+(7&(W>>>=Ae)),W>>>=3,q-=3}else{for(F=Ae+7;q<F;){if(H===0)break e;H--,W+=K[U++]<<q,q+=8}q-=Ae,C=0,pe=11+(127&(W>>>=Ae)),W>>>=7,q-=7}if(S.have+pe>S.nlen+S.ndist){T.msg="invalid bit length repeat",S.mode=30;break}for(;pe--;)S.lens[S.have++]=C}}if(S.mode===30)break;if(S.lens[256]===0){T.msg="invalid code -- missing end-of-block",S.mode=30;break}if(S.lenbits=9,ne={bits:S.lenbits},ce=d(u,S.lens,0,S.nlen,S.lencode,0,S.work,ne),S.lenbits=ne.bits,ce){T.msg="invalid literal/lengths set",S.mode=30;break}if(S.distbits=6,S.distcode=S.distdyn,ne={bits:S.distbits},ce=d(f,S.lens,S.nlen,S.ndist,S.distcode,0,S.work,ne),S.distbits=ne.bits,ce){T.msg="invalid distances set",S.mode=30;break}if(S.mode=20,V===6)break e;case 20:S.mode=21;case 21:if(6<=H&&258<=Q){T.next_out=z,T.avail_out=Q,T.next_in=U,T.avail_in=H,S.hold=W,S.bits=q,c(T,oe),z=T.next_out,fe=T.output,Q=T.avail_out,U=T.next_in,K=T.input,H=T.avail_in,W=S.hold,q=S.bits,S.mode===12&&(S.back=-1);break}for(S.back=0;Ce=(R=S.lencode[W&(1<<S.lenbits)-1])>>>16&255,ve=65535&R,!((Ae=R>>>24)<=q);){if(H===0)break e;H--,W+=K[U++]<<q,q+=8}if(Ce&&!(240&Ce)){for(me=Ae,De=Ce,Xe=ve;Ce=(R=S.lencode[Xe+((W&(1<<me+De)-1)>>me)])>>>16&255,ve=65535&R,!(me+(Ae=R>>>24)<=q);){if(H===0)break e;H--,W+=K[U++]<<q,q+=8}W>>>=me,q-=me,S.back+=me}if(W>>>=Ae,q-=Ae,S.back+=Ae,S.length=ve,Ce===0){S.mode=26;break}if(32&Ce){S.back=-1,S.mode=12;break}if(64&Ce){T.msg="invalid literal/length code",S.mode=30;break}S.extra=15&Ce,S.mode=22;case 22:if(S.extra){for(F=S.extra;q<F;){if(H===0)break e;H--,W+=K[U++]<<q,q+=8}S.length+=W&(1<<S.extra)-1,W>>>=S.extra,q-=S.extra,S.back+=S.extra}S.was=S.length,S.mode=23;case 23:for(;Ce=(R=S.distcode[W&(1<<S.distbits)-1])>>>16&255,ve=65535&R,!((Ae=R>>>24)<=q);){if(H===0)break e;H--,W+=K[U++]<<q,q+=8}if(!(240&Ce)){for(me=Ae,De=Ce,Xe=ve;Ce=(R=S.distcode[Xe+((W&(1<<me+De)-1)>>me)])>>>16&255,ve=65535&R,!(me+(Ae=R>>>24)<=q);){if(H===0)break e;H--,W+=K[U++]<<q,q+=8}W>>>=me,q-=me,S.back+=me}if(W>>>=Ae,q-=Ae,S.back+=Ae,64&Ce){T.msg="invalid distance code",S.mode=30;break}S.offset=ve,S.extra=15&Ce,S.mode=24;case 24:if(S.extra){for(F=S.extra;q<F;){if(H===0)break e;H--,W+=K[U++]<<q,q+=8}S.offset+=W&(1<<S.extra)-1,W>>>=S.extra,q-=S.extra,S.back+=S.extra}if(S.offset>S.dmax){T.msg="invalid distance too far back",S.mode=30;break}S.mode=25;case 25:if(Q===0)break e;if(pe=oe-Q,S.offset>pe){if((pe=S.offset-pe)>S.whave&&S.sane){T.msg="invalid distance too far back",S.mode=30;break}Pe=pe>S.wnext?(pe-=S.wnext,S.wsize-pe):S.wnext-pe,pe>S.length&&(pe=S.length),Re=S.window}else Re=fe,Pe=z-S.offset,pe=S.length;for(Q<pe&&(pe=Q),Q-=pe,S.length-=pe;fe[z++]=Re[Pe++],--pe;);S.length===0&&(S.mode=21);break;case 26:if(Q===0)break e;fe[z++]=S.length,Q--,S.mode=21;break;case 27:if(S.wrap){for(;q<32;){if(H===0)break e;H--,W|=K[U++]<<q,q+=8}if(oe-=Q,T.total_out+=oe,S.total+=oe,oe&&(T.adler=S.check=S.flags?l(S.check,fe,oe,z-oe):a(S.check,fe,oe,z-oe)),oe=Q,(S.flags?W:v(W))!==S.check){T.msg="incorrect data check",S.mode=30;break}q=W=0}S.mode=28;case 28:if(S.wrap&&S.flags){for(;q<32;){if(H===0)break e;H--,W+=K[U++]<<q,q+=8}if(W!==(4294967295&S.total)){T.msg="incorrect length check",S.mode=30;break}q=W=0}S.mode=29;case 29:ce=1;break e;case 30:ce=-3;break e;case 31:return-4;case 32:default:return p}return T.next_out=z,T.avail_out=Q,T.next_in=U,T.avail_in=H,S.hold=W,S.bits=q,(S.wsize||oe!==T.avail_out&&S.mode<30&&(S.mode<27||V!==4))&&te(T,T.output,T.next_out,oe-T.avail_out)?(S.mode=31,-4):(re-=T.avail_in,oe-=T.avail_out,T.total_in+=re,T.total_out+=oe,S.total+=oe,S.wrap&&oe&&(T.adler=S.check=S.flags?l(S.check,fe,oe,T.next_out-oe):a(S.check,fe,oe,T.next_out-oe)),T.data_type=S.bits+(S.last?64:0)+(S.mode===12?128:0)+(S.mode===20||S.mode===15?256:0),(re==0&&oe===0||V===4)&&ce===h&&(ce=-5),ce)},i.inflateEnd=function(T){if(!T||!T.state)return p;var V=T.state;return V.window&&(V.window=null),T.state=null,h},i.inflateGetHeader=function(T,V){var S;return T&&T.state&&2&(S=T.state).wrap?((S.head=V).done=!1,h):p},i.inflateSetDictionary=function(T,V){var S,K=V.length;return T&&T.state?(S=T.state).wrap!==0&&S.mode!==11?p:S.mode===11&&a(1,V,K,0)!==S.check?-3:te(T,V,K,K)?(S.mode=31,-4):(S.havedict=1,h):p},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(r,n,i){var s=r("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],d=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(u,f,h,p,g,m,x,v){var y,b,w,j,_,E,N,O,I,te=v.bits,T=0,V=0,S=0,K=0,fe=0,U=0,z=0,H=0,Q=0,W=0,q=null,re=0,oe=new s.Buf16(16),pe=new s.Buf16(16),Pe=null,Re=0;for(T=0;T<=15;T++)oe[T]=0;for(V=0;V<p;V++)oe[f[h+V]]++;for(fe=te,K=15;1<=K&&oe[K]===0;K--);if(K<fe&&(fe=K),K===0)return g[m++]=20971520,g[m++]=20971520,v.bits=1,0;for(S=1;S<K&&oe[S]===0;S++);for(fe<S&&(fe=S),T=H=1;T<=15;T++)if(H<<=1,(H-=oe[T])<0)return-1;if(0<H&&(u===0||K!==1))return-1;for(pe[1]=0,T=1;T<15;T++)pe[T+1]=pe[T]+oe[T];for(V=0;V<p;V++)f[h+V]!==0&&(x[pe[f[h+V]]++]=V);if(E=u===0?(q=Pe=x,19):u===1?(q=a,re-=257,Pe=l,Re-=257,256):(q=c,Pe=d,-1),T=S,_=m,z=V=W=0,w=-1,j=(Q=1<<(U=fe))-1,u===1&&852<Q||u===2&&592<Q)return 1;for(;;){for(N=T-z,I=x[V]<E?(O=0,x[V]):x[V]>E?(O=Pe[Re+x[V]],q[re+x[V]]):(O=96,0),y=1<<T-z,S=b=1<<U;g[_+(W>>z)+(b-=y)]=N<<24|O<<16|I|0,b!==0;);for(y=1<<T-1;W&y;)y>>=1;if(y!==0?(W&=y-1,W+=y):W=0,V++,--oe[T]==0){if(T===K)break;T=f[h+x[V]]}if(fe<T&&(W&j)!==w){for(z===0&&(z=fe),_+=S,H=1<<(U=T-z);U+z<K&&!((H-=oe[U+z])<=0);)U++,H<<=1;if(Q+=1<<U,u===1&&852<Q||u===2&&592<Q)return 1;g[w=W&j]=fe<<24|U<<16|_-m|0}}return W!==0&&(g[_+W]=T-z<<24|64<<16|0),v.bits=fe,0}},{"../utils/common":41}],51:[function(r,n,i){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(r,n,i){var s=r("../utils/common"),a=0,l=1;function c(R){for(var M=R.length;0<=--M;)R[M]=0}var d=0,u=29,f=256,h=f+1+u,p=30,g=19,m=2*h+1,x=15,v=16,y=7,b=256,w=16,j=17,_=18,E=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],N=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],O=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],te=new Array(2*(h+2));c(te);var T=new Array(2*p);c(T);var V=new Array(512);c(V);var S=new Array(256);c(S);var K=new Array(u);c(K);var fe,U,z,H=new Array(p);function Q(R,M,Z,Y,L){this.static_tree=R,this.extra_bits=M,this.extra_base=Z,this.elems=Y,this.max_length=L,this.has_stree=R&&R.length}function W(R,M){this.dyn_tree=R,this.max_code=0,this.stat_desc=M}function q(R){return R<256?V[R]:V[256+(R>>>7)]}function re(R,M){R.pending_buf[R.pending++]=255&M,R.pending_buf[R.pending++]=M>>>8&255}function oe(R,M,Z){R.bi_valid>v-Z?(R.bi_buf|=M<<R.bi_valid&65535,re(R,R.bi_buf),R.bi_buf=M>>v-R.bi_valid,R.bi_valid+=Z-v):(R.bi_buf|=M<<R.bi_valid&65535,R.bi_valid+=Z)}function pe(R,M,Z){oe(R,Z[2*M],Z[2*M+1])}function Pe(R,M){for(var Z=0;Z|=1&R,R>>>=1,Z<<=1,0<--M;);return Z>>>1}function Re(R,M,Z){var Y,L,J=new Array(x+1),ue=0;for(Y=1;Y<=x;Y++)J[Y]=ue=ue+Z[Y-1]<<1;for(L=0;L<=M;L++){var ie=R[2*L+1];ie!==0&&(R[2*L]=Pe(J[ie]++,ie))}}function Ae(R){var M;for(M=0;M<h;M++)R.dyn_ltree[2*M]=0;for(M=0;M<p;M++)R.dyn_dtree[2*M]=0;for(M=0;M<g;M++)R.bl_tree[2*M]=0;R.dyn_ltree[2*b]=1,R.opt_len=R.static_len=0,R.last_lit=R.matches=0}function Ce(R){8<R.bi_valid?re(R,R.bi_buf):0<R.bi_valid&&(R.pending_buf[R.pending++]=R.bi_buf),R.bi_buf=0,R.bi_valid=0}function ve(R,M,Z,Y){var L=2*M,J=2*Z;return R[L]<R[J]||R[L]===R[J]&&Y[M]<=Y[Z]}function me(R,M,Z){for(var Y=R.heap[Z],L=Z<<1;L<=R.heap_len&&(L<R.heap_len&&ve(M,R.heap[L+1],R.heap[L],R.depth)&&L++,!ve(M,Y,R.heap[L],R.depth));)R.heap[Z]=R.heap[L],Z=L,L<<=1;R.heap[Z]=Y}function De(R,M,Z){var Y,L,J,ue,ie=0;if(R.last_lit!==0)for(;Y=R.pending_buf[R.d_buf+2*ie]<<8|R.pending_buf[R.d_buf+2*ie+1],L=R.pending_buf[R.l_buf+ie],ie++,Y===0?pe(R,L,M):(pe(R,(J=S[L])+f+1,M),(ue=E[J])!==0&&oe(R,L-=K[J],ue),pe(R,J=q(--Y),Z),(ue=N[J])!==0&&oe(R,Y-=H[J],ue)),ie<R.last_lit;);pe(R,b,M)}function Xe(R,M){var Z,Y,L,J=M.dyn_tree,ue=M.stat_desc.static_tree,ie=M.stat_desc.has_stree,$=M.stat_desc.elems,X=-1;for(R.heap_len=0,R.heap_max=m,Z=0;Z<$;Z++)J[2*Z]!==0?(R.heap[++R.heap_len]=X=Z,R.depth[Z]=0):J[2*Z+1]=0;for(;R.heap_len<2;)J[2*(L=R.heap[++R.heap_len]=X<2?++X:0)]=1,R.depth[L]=0,R.opt_len--,ie&&(R.static_len-=ue[2*L+1]);for(M.max_code=X,Z=R.heap_len>>1;1<=Z;Z--)me(R,J,Z);for(L=$;Z=R.heap[1],R.heap[1]=R.heap[R.heap_len--],me(R,J,1),Y=R.heap[1],R.heap[--R.heap_max]=Z,R.heap[--R.heap_max]=Y,J[2*L]=J[2*Z]+J[2*Y],R.depth[L]=(R.depth[Z]>=R.depth[Y]?R.depth[Z]:R.depth[Y])+1,J[2*Z+1]=J[2*Y+1]=L,R.heap[1]=L++,me(R,J,1),2<=R.heap_len;);R.heap[--R.heap_max]=R.heap[1],function(ae,we){var se,xe,Oe,be,Ne,He,qe=we.dyn_tree,Ze=we.max_code,Je=we.stat_desc.static_tree,Fe=we.stat_desc.has_stree,Ve=we.stat_desc.extra_bits,Ke=we.stat_desc.extra_base,Be=we.stat_desc.max_length,at=0;for(be=0;be<=x;be++)ae.bl_count[be]=0;for(qe[2*ae.heap[ae.heap_max]+1]=0,se=ae.heap_max+1;se<m;se++)Be<(be=qe[2*qe[2*(xe=ae.heap[se])+1]+1]+1)&&(be=Be,at++),qe[2*xe+1]=be,Ze<xe||(ae.bl_count[be]++,Ne=0,Ke<=xe&&(Ne=Ve[xe-Ke]),He=qe[2*xe],ae.opt_len+=He*(be+Ne),Fe&&(ae.static_len+=He*(Je[2*xe+1]+Ne)));if(at!==0){do{for(be=Be-1;ae.bl_count[be]===0;)be--;ae.bl_count[be]--,ae.bl_count[be+1]+=2,ae.bl_count[Be]--,at-=2}while(0<at);for(be=Be;be!==0;be--)for(xe=ae.bl_count[be];xe!==0;)Ze<(Oe=ae.heap[--se])||(qe[2*Oe+1]!==be&&(ae.opt_len+=(be-qe[2*Oe+1])*qe[2*Oe],qe[2*Oe+1]=be),xe--)}}(R,M),Re(J,X,R.bl_count)}function C(R,M,Z){var Y,L,J=-1,ue=M[1],ie=0,$=7,X=4;for(ue===0&&($=138,X=3),M[2*(Z+1)+1]=65535,Y=0;Y<=Z;Y++)L=ue,ue=M[2*(Y+1)+1],++ie<$&&L===ue||(ie<X?R.bl_tree[2*L]+=ie:L!==0?(L!==J&&R.bl_tree[2*L]++,R.bl_tree[2*w]++):ie<=10?R.bl_tree[2*j]++:R.bl_tree[2*_]++,J=L,X=(ie=0)===ue?($=138,3):L===ue?($=6,3):($=7,4))}function ce(R,M,Z){var Y,L,J=-1,ue=M[1],ie=0,$=7,X=4;for(ue===0&&($=138,X=3),Y=0;Y<=Z;Y++)if(L=ue,ue=M[2*(Y+1)+1],!(++ie<$&&L===ue)){if(ie<X)for(;pe(R,L,R.bl_tree),--ie!=0;);else L!==0?(L!==J&&(pe(R,L,R.bl_tree),ie--),pe(R,w,R.bl_tree),oe(R,ie-3,2)):ie<=10?(pe(R,j,R.bl_tree),oe(R,ie-3,3)):(pe(R,_,R.bl_tree),oe(R,ie-11,7));J=L,X=(ie=0)===ue?($=138,3):L===ue?($=6,3):($=7,4)}}c(H);var ne=!1;function F(R,M,Z,Y){oe(R,(d<<1)+(Y?1:0),3),function(L,J,ue,ie){Ce(L),re(L,ue),re(L,~ue),s.arraySet(L.pending_buf,L.window,J,ue,L.pending),L.pending+=ue}(R,M,Z)}i._tr_init=function(R){ne||(function(){var M,Z,Y,L,J,ue=new Array(x+1);for(L=Y=0;L<u-1;L++)for(K[L]=Y,M=0;M<1<<E[L];M++)S[Y++]=L;for(S[Y-1]=L,L=J=0;L<16;L++)for(H[L]=J,M=0;M<1<<N[L];M++)V[J++]=L;for(J>>=7;L<p;L++)for(H[L]=J<<7,M=0;M<1<<N[L]-7;M++)V[256+J++]=L;for(Z=0;Z<=x;Z++)ue[Z]=0;for(M=0;M<=143;)te[2*M+1]=8,M++,ue[8]++;for(;M<=255;)te[2*M+1]=9,M++,ue[9]++;for(;M<=279;)te[2*M+1]=7,M++,ue[7]++;for(;M<=287;)te[2*M+1]=8,M++,ue[8]++;for(Re(te,h+1,ue),M=0;M<p;M++)T[2*M+1]=5,T[2*M]=Pe(M,5);fe=new Q(te,E,f+1,h,x),U=new Q(T,N,0,p,x),z=new Q(new Array(0),O,0,g,y)}(),ne=!0),R.l_desc=new W(R.dyn_ltree,fe),R.d_desc=new W(R.dyn_dtree,U),R.bl_desc=new W(R.bl_tree,z),R.bi_buf=0,R.bi_valid=0,Ae(R)},i._tr_stored_block=F,i._tr_flush_block=function(R,M,Z,Y){var L,J,ue=0;0<R.level?(R.strm.data_type===2&&(R.strm.data_type=function(ie){var $,X=4093624447;for($=0;$<=31;$++,X>>>=1)if(1&X&&ie.dyn_ltree[2*$]!==0)return a;if(ie.dyn_ltree[18]!==0||ie.dyn_ltree[20]!==0||ie.dyn_ltree[26]!==0)return l;for($=32;$<f;$++)if(ie.dyn_ltree[2*$]!==0)return l;return a}(R)),Xe(R,R.l_desc),Xe(R,R.d_desc),ue=function(ie){var $;for(C(ie,ie.dyn_ltree,ie.l_desc.max_code),C(ie,ie.dyn_dtree,ie.d_desc.max_code),Xe(ie,ie.bl_desc),$=g-1;3<=$&&ie.bl_tree[2*I[$]+1]===0;$--);return ie.opt_len+=3*($+1)+5+5+4,$}(R),L=R.opt_len+3+7>>>3,(J=R.static_len+3+7>>>3)<=L&&(L=J)):L=J=Z+5,Z+4<=L&&M!==-1?F(R,M,Z,Y):R.strategy===4||J===L?(oe(R,2+(Y?1:0),3),De(R,te,T)):(oe(R,4+(Y?1:0),3),function(ie,$,X,ae){var we;for(oe(ie,$-257,5),oe(ie,X-1,5),oe(ie,ae-4,4),we=0;we<ae;we++)oe(ie,ie.bl_tree[2*I[we]+1],3);ce(ie,ie.dyn_ltree,$-1),ce(ie,ie.dyn_dtree,X-1)}(R,R.l_desc.max_code+1,R.d_desc.max_code+1,ue+1),De(R,R.dyn_ltree,R.dyn_dtree)),Ae(R),Y&&Ce(R)},i._tr_tally=function(R,M,Z){return R.pending_buf[R.d_buf+2*R.last_lit]=M>>>8&255,R.pending_buf[R.d_buf+2*R.last_lit+1]=255&M,R.pending_buf[R.l_buf+R.last_lit]=255&Z,R.last_lit++,M===0?R.dyn_ltree[2*Z]++:(R.matches++,M--,R.dyn_ltree[2*(S[Z]+f+1)]++,R.dyn_dtree[2*q(M)]++),R.last_lit===R.lit_bufsize-1},i._tr_align=function(R){oe(R,2,3),pe(R,b,te),function(M){M.bi_valid===16?(re(M,M.bi_buf),M.bi_buf=0,M.bi_valid=0):8<=M.bi_valid&&(M.pending_buf[M.pending++]=255&M.bi_buf,M.bi_buf>>=8,M.bi_valid-=8)}(R)}},{"../utils/common":41}],53:[function(r,n,i){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(r,n,i){(function(s){(function(a,l){if(!a.setImmediate){var c,d,u,f,h=1,p={},g=!1,m=a.document,x=Object.getPrototypeOf&&Object.getPrototypeOf(a);x=x&&x.setTimeout?x:a,c={}.toString.call(a.process)==="[object process]"?function(w){process.nextTick(function(){y(w)})}:function(){if(a.postMessage&&!a.importScripts){var w=!0,j=a.onmessage;return a.onmessage=function(){w=!1},a.postMessage("","*"),a.onmessage=j,w}}()?(f="setImmediate$"+Math.random()+"$",a.addEventListener?a.addEventListener("message",b,!1):a.attachEvent("onmessage",b),function(w){a.postMessage(f+w,"*")}):a.MessageChannel?((u=new MessageChannel).port1.onmessage=function(w){y(w.data)},function(w){u.port2.postMessage(w)}):m&&"onreadystatechange"in m.createElement("script")?(d=m.documentElement,function(w){var j=m.createElement("script");j.onreadystatechange=function(){y(w),j.onreadystatechange=null,d.removeChild(j),j=null},d.appendChild(j)}):function(w){setTimeout(y,0,w)},x.setImmediate=function(w){typeof w!="function"&&(w=new Function(""+w));for(var j=new Array(arguments.length-1),_=0;_<j.length;_++)j[_]=arguments[_+1];var E={callback:w,args:j};return p[h]=E,c(h),h++},x.clearImmediate=v}function v(w){delete p[w]}function y(w){if(g)setTimeout(y,0,w);else{var j=p[w];if(j){g=!0;try{(function(_){var E=_.callback,N=_.args;switch(N.length){case 0:E();break;case 1:E(N[0]);break;case 2:E(N[0],N[1]);break;case 3:E(N[0],N[1],N[2]);break;default:E.apply(l,N)}})(j)}finally{v(w),g=!1}}}}function b(w){w.source===a&&typeof w.data=="string"&&w.data.indexOf(f)===0&&y(+w.data.slice(f.length))}})(typeof self>"u"?s===void 0?this:s:self)}).call(this,typeof wi<"u"?wi:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(Ew);var DE=Ew.exports;const zE=Qc(DE);function FE(e){let t="",r=e;for(;r>=0;)t=String.fromCharCode(r%26+65)+t,r=Math.floor(r/26)-1;return t}function BE(e,t){return`${FE(e)}${t+1}`}async function Tw(e,t,r="design"){const i=Math.ceil(t.width/1e3),s=Math.ceil(t.length/1e3);console.log(`[SLICER] Creating ${i}${s} grid (${i*s} tiles) for ${t.width}mm  ${t.length}mm design`);const c=new DOMParser().parseFromString(e,"image/svg+xml").querySelector("svg");if(!c)throw new Error("Invalid SVG content");const d=c.getAttribute("viewBox");let u,f;if(d){const E=d.split(/\s+/).map(Number);u=E[2],f=E[3]}else u=parseFloat(c.getAttribute("width"))||1024,f=parseFloat(c.getAttribute("height"))||1024;console.log(`[SLICER] SVG internal dimensions: ${u}  ${f}`);const h=u/t.width,p=f/t.length,g=1e3*h,m=1e3*p;console.log(`[SLICER] Tile size in SVG units: ${g}  ${m}`);const x=c.innerHTML,v=c.getAttribute("xmlns")||"http://www.w3.org/2000/svg",y=new zE,b=y.folder("tiles"),w=[];for(let E=0;E<s;E++){const N=[];for(let O=0;O<i;O++){const I=BE(O,E);N.push(I);const te=O*g,T=E*m,V=`${te} ${T} ${g} ${m}`,S=`<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="${v}" viewBox="${V}" width="1000mm" height="1000mm">
  <defs>
    <clipPath id="tile-clip">
      <rect x="${te}" y="${T}" width="${g}" height="${m}"/>
    </clipPath>
  </defs>
  <g clip-path="url(#tile-clip)">
${x}
  </g>
</svg>`,K=`${Nw(r)}_${I}.svg`;b.file(K,S)}w.push(N)}const j=HE(w,t,r);y.file("layout-guide.txt",j);const _=await y.generateAsync({type:"blob"});return console.log(`[SLICER] Created ZIP with ${i*s} tiles`),_}function HE(e,t,r){const n=e.length,i=e[0].length;let s=`TPV Studio - Tile Layout Guide
================================

Design: ${r}
Total Size: ${t.width}mm  ${t.length}mm (${t.width/1e3}m  ${t.length/1e3}m)
Tile Size: 1000mm  1000mm (1m  1m)
Grid: ${i} columns  ${n} rows (${i*n} tiles)

Layout (view from above):
-------------------------

`;const a=6;s+=""+("".repeat(a)+"").repeat(i-1)+"".repeat(a)+`
`;for(let l=0;l<n;l++){s+="";for(let c=0;c<i;c++){const d=e[l][c],u=a-d.length,f=Math.floor(u/2),h=u-f;s+=" ".repeat(f)+d+" ".repeat(h)+""}s+=`
`,l<n-1?s+=""+("".repeat(a)+"").repeat(i-1)+"".repeat(a)+`
`:s+=""+("".repeat(a)+"").repeat(i-1)+"".repeat(a)+`
`}return s+=`
Installation Notes:
-------------------
- Each tile is exactly 1m  1m
- Tiles are named by column (A-Z) and row (1-${n})
- Start from top-left corner (A1) when laying out
- Tiles align perfectly when placed edge-to-edge
- Edge tiles may contain partial content if design isn't exactly divisible by 1m

Generated by TPV Studio
`,s}function Nw(e){return e.replace(/[<>:"/\\|?*]/g,"_").replace(/\s+/g,"-").substring(0,50)}function Pw(e,t){const r=URL.createObjectURL(e),n=document.createElement("a");n.href=r,n.download=t,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(r)}async function UE(e,t,r="design"){try{const n=await fetch(e);if(!n.ok)throw new Error(`Failed to fetch SVG: ${n.statusText}`);const i=await n.text(),s=await Tw(i,t,r),a=`${Nw(r)}-tiles-1mx1m.zip`;return Pw(s,a),console.log(`[SLICER] Downloaded ${a}`),!0}catch(n){throw console.error("[SLICER] Failed to download tiles:",n),n}}async function WE(e){const t=Object.values(e||{});return t.length===0?[]:(await Promise.all(t.map(async n=>{try{const i=await ll(n.sourceDesignId),s=(i==null?void 0:i.design)||i;if(!s)return console.warn(`[EXPORT] Could not fetch design for motif ${n.id}`),null;console.log("[EXPORT] Loaded design for motif:",s.name),console.log("[EXPORT] Design has solid_recipes:",!!s.solid_recipes),console.log("[EXPORT] Design has blend_recipes:",!!s.blend_recipes);const a=n.scale||1,l=n.originalWidth_mm*a/1e3,c=n.originalHeight_mm*a/1e3,d=l*c,u=n.viewMode||"solid",f=u==="blend"?s.blend_recipes:s.solid_recipes;return console.log(`[EXPORT] Using ${u} recipes:`,(f==null?void 0:f.length)||0,"recipes"),{id:n.id,name:n.customName||n.sourceDesignName||s.name||"Motif",areaM2:d,viewMode:u,widthM:l,heightM:c,recipes:f||[]}}catch(i){return console.error(`[EXPORT] Error processing motif ${n.id}:`,i),null}}))).filter(Boolean)}function d0({svgRef:e}){const[t,r]=A.useState(!1),[n,i]=A.useState(null),s=A.useRef(null),a=tt(m=>m.exportDesignData),l=tt(m=>m.surface),c=tt(m=>m.designName),d=tt(m=>m.motifs);A.useEffect(()=>{const m=x=>{s.current&&!s.current.contains(x.target)&&r(!1)};return t&&document.addEventListener("mousedown",m),()=>{document.removeEventListener("mousedown",m)}},[t]);const u=()=>e!=null&&e.current?e.current:document.querySelector(".court-canvas__svg"),f=async()=>{i("svg");try{const m=u();if(!m)throw new Error("Canvas not found");const x=a(),v=dp(m,x),y=ku(x.name,"svg");LE(v,y)}catch(m){console.error("SVG export failed:",m),alert("Failed to export SVG: "+m.message)}finally{i(null),r(!1)}},h=async()=>{i("png");try{const m=u();if(!m)throw new Error("Canvas not found");const x=a(),v=ku(x.name,"png");await IE(m,x,v,2)}catch(m){console.error("PNG export failed:",m),alert("Failed to export PNG: "+m.message)}finally{i(null),r(!1)}},p=async()=>{i("pdf"),r(!1);try{const m=u();if(!m)throw new Error("Canvas not found");const x=await Tn.getSession();if(!(x!=null&&x.access_token))throw new Error("Authentication required for PDF export");const v=a(),y=v.name||"TPV Design",b=m.cloneNode(!0);b.querySelectorAll('[class*="selected"], .transform-handles, .track-resize-handles, .court-canvas__selection-outline, [class*="selection"], [class*="handle"], [stroke-dasharray]').forEach(I=>I.remove()),b.setAttribute("xmlns","http://www.w3.org/2000/svg"),b.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");const w=new XMLSerializer().serializeToString(b);console.log("[EXPORT] Generating PDF report via API...");const j=await WE(d);console.log("[EXPORT] Motifs for PDF:",j.length);const _=await fetch("/api/export-sports-pdf",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${x.access_token}`},body:JSON.stringify({svgString:w,designName:y,surface:v.surface,courts:v.courts,tracks:v.tracks,motifs:j,dimensions:{widthMM:v.surface.width_mm,lengthMM:v.surface.length_mm}})});if(!_.ok){const I=await _.json().catch(()=>({error:"Unknown error"}));throw new Error(I.error||`Server error: ${_.status}`)}const E=await _.blob(),N=ku(y,"pdf"),O=document.createElement("a");O.href=URL.createObjectURL(E),O.download=N,document.body.appendChild(O),O.click(),document.body.removeChild(O),URL.revokeObjectURL(O.href),console.log("[EXPORT] PDF downloaded:",N)}catch(m){console.error("PDF export failed:",m),alert("Failed to export PDF: "+m.message)}finally{i(null)}},g=async()=>{i("tiles"),r(!1);try{const m=u();if(!m)throw new Error("Canvas not found");const v=new XMLSerializer().serializeToString(m),y={width:l.width_mm,length:l.length_mm},b=c||"sports-surface",w=await Tw(v,y,b),j=`${b.replace(/[^a-zA-Z0-9-_]/g,"-")}-tiles-1mx1m.zip`;Pw(w,j),console.log("[EXPORT] Tiles ZIP downloaded:",j)}catch(m){console.error("Tiles export failed:",m),alert("Failed to export tiles: "+m.message)}finally{i(null)}};return o.jsxs("div",{className:"export-menu",ref:s,children:[o.jsxs("button",{className:"sports-toolbar__btn-export",onClick:()=>r(!t),title:"Export Design",children:["Export",o.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:t?"M18 15l-6-6-6 6":"M6 9l6 6 6-6"})})]}),t&&o.jsxs("div",{className:"export-menu__dropdown",children:[o.jsxs("button",{className:"export-menu__item",onClick:f,disabled:n!==null,children:[o.jsx("span",{className:"export-menu__icon",children:""}),o.jsxs("div",{className:"export-menu__item-content",children:[o.jsx("span",{className:"export-menu__item-title",children:n==="svg"?"Exporting...":"Download SVG"}),o.jsx("span",{className:"export-menu__item-desc",children:"Vector format for CAD/printing"})]})]}),o.jsxs("button",{className:"export-menu__item",onClick:h,disabled:n!==null,children:[o.jsx("span",{className:"export-menu__icon",children:""}),o.jsxs("div",{className:"export-menu__item-content",children:[o.jsx("span",{className:"export-menu__item-title",children:n==="png"?"Exporting...":"Download PNG"}),o.jsx("span",{className:"export-menu__item-desc",children:"High-res image for presentations"})]})]}),o.jsxs("button",{className:"export-menu__item",onClick:g,disabled:n!==null,children:[o.jsx("span",{className:"export-menu__icon",children:""}),o.jsxs("div",{className:"export-menu__item-content",children:[o.jsx("span",{className:"export-menu__item-title",children:n==="tiles"?"Generating...":"Download Tiles ZIP"}),o.jsx("span",{className:"export-menu__item-desc",children:"1m1m SVG tiles for large-format printing"})]})]}),o.jsx("div",{className:"export-menu__divider"}),o.jsxs("button",{className:"export-menu__item",onClick:p,disabled:n!==null,children:[o.jsx("span",{className:"export-menu__icon",children:""}),o.jsxs("div",{className:"export-menu__item-content",children:[o.jsx("span",{className:"export-menu__item-title",children:n==="pdf"?"Generating...":"Materials Report (PDF)"}),o.jsx("span",{className:"export-menu__item-desc",children:"TPV quantities & specifications"})]})]})]})]})}function GE({isOpen:e,onClose:t}){if(!e)return null;const r=[{category:"Selection",items:[{keys:["Delete"],description:"Remove selected element"},{keys:["Escape"],description:"Deselect element"}]},{category:"Edit",items:[{keys:["Ctrl","Z"],description:"Undo"},{keys:["Ctrl","Shift","Z"],description:"Redo"},{keys:["Ctrl","D"],description:"Duplicate selected"}]},{category:"Move",items:[{keys:["Arrow Keys"],description:"Nudge element (10mm)"},{keys:["Shift","Arrow Keys"],description:"Large nudge (100mm)"}]},{category:"Layers",items:[{keys:["["],description:"Send backward"},{keys:["]"],description:"Bring forward"}]},{category:"View",items:[{keys:["G"],description:"Toggle snap to grid"},{keys:["?"],description:"Show this help"}]}],i=navigator.platform.toUpperCase().indexOf("MAC")>=0?"":"Ctrl";return o.jsx("div",{className:"keyboard-shortcuts-overlay",onClick:t,style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},children:o.jsxs("div",{className:"keyboard-shortcuts-modal",onClick:s=>s.stopPropagation(),style:{background:"#fff",borderRadius:"8px",padding:"24px",maxWidth:"480px",width:"90%",maxHeight:"80vh",overflow:"auto",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.2)"},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[o.jsx("h2",{style:{margin:0,fontSize:"1.25rem",fontWeight:600},children:"Keyboard Shortcuts"}),o.jsx("button",{onClick:t,style:{background:"none",border:"none",fontSize:"1.5rem",cursor:"pointer",padding:"4px 8px",color:"#666"},"aria-label":"Close",children:""})]}),r.map(s=>o.jsxs("div",{style:{marginBottom:"20px"},children:[o.jsx("h3",{style:{fontSize:"0.75rem",fontWeight:600,textTransform:"uppercase",color:"#666",marginBottom:"8px",letterSpacing:"0.5px"},children:s.category}),o.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:s.items.map((a,l)=>o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 0"},children:[o.jsx("span",{style:{color:"#333",fontSize:"0.9rem"},children:a.description}),o.jsx("div",{style:{display:"flex",gap:"4px"},children:a.keys.map((c,d)=>o.jsx("kbd",{style:{display:"inline-block",padding:"4px 8px",fontSize:"0.75rem",fontFamily:"system-ui, -apple-system, sans-serif",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:"4px",boxShadow:"0 1px 2px rgba(0,0,0,0.1)",minWidth:"24px",textAlign:"center"},children:c==="Ctrl"?i:c},d))})]},l))})]},s.category)),o.jsxs("p",{style:{fontSize:"0.8rem",color:"#888",marginTop:"16px",paddingTop:"16px",borderTop:"1px solid #eee",marginBottom:0},children:["Press ",o.jsx("kbd",{style:{padding:"2px 6px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:"3px",fontSize:"0.75rem"},children:"?"})," at any time to show this help"]})]})})}class VE{async _getAuthHeaders(){const t=await Tn.getSession(),r={"Content-Type":"application/json"};return t!=null&&t.access_token&&(r.Authorization=`Bearer ${t.access_token}`),r}async generateRecraft(t){const r={prompt:t.prompt,width_mm:t.widthMM||5e3,length_mm:t.lengthMM||5e3,max_colours:t.maxColours||6,seed:t.seed||null},n=await this._getAuthHeaders(),i=await fetch("/api/recraft-generate",{method:"POST",headers:n,body:JSON.stringify(r)});if(!i.ok){const s=await i.json();throw new Error(s.error||"Recraft generation failed")}return i.json()}async vectorizeImage(t){const r={image_url:t.image_url,width_mm:t.width_mm||5e3,length_mm:t.length_mm||5e3,seed:t.seed||null},n=await this._getAuthHeaders(),i=await fetch("/api/recraft-vectorize",{method:"POST",headers:n,body:JSON.stringify(r)});if(!i.ok){const s=await i.json();throw new Error(s.error||"Vectorization failed")}return i.json()}async processUploadedSVG(t){const r={svg_url:t.svg_url,width_mm:t.width_mm||5e3,length_mm:t.length_mm||5e3},n=await this._getAuthHeaders(),i=await fetch("/api/process-uploaded-svg",{method:"POST",headers:n,body:JSON.stringify(r)});if(!i.ok){const s=await i.json();throw new Error(s.error||"SVG processing failed")}return i.json()}async getRecraftStatus(t){const r=await this._getAuthHeaders(),n=await fetch(`/api/studio-job-status?jobId=${t}`,{headers:r});if(!n.ok){const i=await n.json();throw new Error(i.error||"Status fetch failed")}return n.json()}async waitForRecraftCompletion(t,r=null,n=2e3){return new Promise((i,s)=>{const a=async()=>{var l,c,d,u;try{const f=await this.getRecraftStatus(t);r&&r(f),f.status==="completed"?((l=f.result)==null?void 0:l.svg_url)?(console.log("[API] Recraft job complete with SVG output"),i(f)):(console.error("[API] Recraft job completed but no SVG output"),s(new Error("Job completed but no output received"))):f.status==="failed"?(c=f.result)!=null&&c.svg_url?(console.warn("[API] Job failed compliance but has output (non-compliant)"),i(f)):s(new Error(f.error||"Job failed")):(f.status==="retrying"&&console.log(`[API] Retrying: ${(d=f.recraft)==null?void 0:d.attempt_current}/${(u=f.recraft)==null?void 0:u.attempt_max}`),setTimeout(a,n))}catch(f){s(f)}};a()})}async matchColor(t,r=2){const n=await fetch("/api/match-color",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({hex:t,max_components:r})});if(!n.ok){const i=await n.json();throw new Error(i.error||"Color matching failed")}return n.json()}async generateDesignName(t){const r={prompt:t.prompt,colors:t.colors||[],dimensions:t.dimensions||{}},n=await this._getAuthHeaders(),i=await fetch("/api/generate-design-name",{method:"POST",headers:n,body:JSON.stringify(r)});if(!i.ok){const s=await i.json();throw new Error(s.error||"Name generation failed")}return i.json()}async inspireSimpleCreateJob(t){const r={prompt:t.prompt,surface:{width_mm:t.lengthMM||5e3,height_mm:t.widthMM||5e3},max_colours:t.maxColours||6,try_simpler:t.trySimpler||!1};t.seed&&(r.seed=t.seed);const n=await fetch("/api/studio-inspire-simple",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!n.ok){const i=await n.json();throw new Error(i.message||"Unable to start design generation. Please check your connection and try again.")}return n.json()}async inspireSimpleGetStatus(t){const r=await this._getAuthHeaders(),n=await fetch(`/api/studio-job-status?jobId=${t}`,{headers:r});if(!n.ok){const i=await n.json();throw new Error(i.message||"Unable to check generation status. Please try again.")}return n.json()}async inspireSimpleWaitForCompletion(t,r=null,n=2e3){return new Promise((i,s)=>{const a=async()=>{var l;try{const c=await this.inspireSimpleGetStatus(t);r&&r(c),c.status==="completed"?((l=c.result)==null?void 0:l.final_url)?(console.log("[API] Job complete with JPG output, resolving"),i(c)):(console.log("[API] Job completed but no output received"),s(new Error("Job completed but no output received"))):c.status==="failed"?s(new Error(c.error||"Job failed")):setTimeout(a,n)}catch(c){s(c)}};a()})}async draftify(t){const r=await fetch(Bg.DRAFTIFY,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!r.ok){const n=await r.json();throw new Error(n.message||"Unable to convert image to vector format. Please try a different image.")}return r.json()}async generateGeometric(t){const r={brief:t.prompt||t.brief,canvas:{width_mm:t.lengthMM||5e3,height_mm:t.widthMM||5e3},options:{mood:t.mood||"playful",composition:t.composition||"mixed",colorCount:t.maxColours||t.colorCount||5,seed:t.seed},validate:!0},n=await fetch(Bg.GEOMETRIC_GENERATE,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!n.ok){const i=await n.json();throw new Error(i.message||"Unable to generate design. Please try a different prompt or settings.")}return n.json()}}const qi=new VE;function qE({recipes:e,onClose:t}){if(!e||e.length===0)return o.jsxs("div",{className:"solid-summary-empty",children:[o.jsx("p",{children:"No colours in design."}),o.jsx("button",{onClick:t,className:"close-button",children:"Close"})]});const r=e.reduce((n,i)=>n+i.targetColor.areaPct,0);return o.jsxs("div",{className:"solid-color-summary",children:[o.jsxs("div",{className:"summary-header",children:[o.jsx("h3",{children:"TPV Colours Used"}),o.jsx("button",{onClick:t,className:"close-button-icon",children:""})]}),o.jsx("div",{className:"summary-info",children:o.jsxs("p",{className:"summary-description",children:["This design uses ",o.jsx("strong",{children:e.length})," pure TPV colour",e.length!==1?"s":""," (no blending required)"]})}),o.jsx("div",{className:"colors-list",children:e.map((n,i)=>{const s=n.chosenRecipe.components[0],a=n.targetColor.areaPct;return o.jsxs("div",{className:"color-item",children:[o.jsx("div",{className:"color-swatch",style:{backgroundColor:n.blendColor.hex},title:`${s.code} - ${s.name}`}),o.jsxs("div",{className:"color-details",children:[o.jsxs("div",{className:"color-primary",children:[o.jsx("span",{className:"color-code",children:s.code}),o.jsx("span",{className:"color-name",children:s.name})]}),o.jsxs("div",{className:"color-secondary",children:[o.jsx("span",{className:"hex-value",children:n.blendColor.hex}),o.jsxs("span",{className:"coverage-badge",children:[a.toFixed(1),"%"]})]})]})]},i)})}),o.jsxs("div",{className:"summary-footer",children:[o.jsxs("div",{className:"footer-stat",children:[o.jsx("span",{className:"stat-label",children:"Total Coverage:"}),o.jsxs("span",{className:"stat-value",children:[r.toFixed(1),"%"]})]}),o.jsxs("div",{className:"footer-stat",children:[o.jsx("span",{className:"stat-label",children:"TPV Colours:"}),o.jsx("span",{className:"stat-value",children:e.length})]})]}),o.jsx("style",{jsx:!0,children:`
        .solid-color-summary {
          background: #fff;
          border-radius: 8px;
          border: 1px solid #ddd;
          padding: 2rem;
          max-width: 800px;
          margin: 2rem auto;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .solid-summary-empty {
          background: #fff;
          border-radius: 8px;
          padding: 2rem;
          text-align: center;
        }

        .summary-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 1.5rem;
          padding-bottom: 1rem;
          border-bottom: 2px solid #1a365d;
        }

        .summary-header h3 {
          margin: 0;
          color: #1a365d;
          font-size: 1.8rem;
        }

        .close-button-icon {
          background: none;
          border: none;
          font-size: 2rem;
          color: #666;
          cursor: pointer;
          padding: 0;
          width: 32px;
          height: 32px;
          line-height: 1;
          transition: color 0.2s;
        }

        .close-button-icon:hover {
          color: #333;
        }

        .summary-info {
          background: #f9f9f9;
          padding: 1rem;
          border-radius: 6px;
          margin-bottom: 1.5rem;
        }

        .summary-description {
          margin: 0;
          color: #333;
          font-size: 1rem;
          line-height: 1.5;
        }

        /* Colors List */
        .colors-list {
          display: flex;
          flex-direction: column;
          gap: 1rem;
          margin-bottom: 1.5rem;
        }

        .color-item {
          display: flex;
          align-items: center;
          gap: 1rem;
          padding: 1rem;
          background: #f9f9f9;
          border-radius: 6px;
          border: 1px solid #e0e0e0;
          transition: all 0.2s;
        }

        .color-item:hover {
          border-color: #ff6b35;
          box-shadow: 0 2px 8px rgba(255, 107, 53, 0.15);
        }

        .color-swatch {
          width: 60px;
          height: 60px;
          border-radius: 8px;
          border: 2px solid #ddd;
          flex-shrink: 0;
          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .color-details {
          flex: 1;
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .color-primary {
          display: flex;
          align-items: baseline;
          gap: 0.5rem;
        }

        .color-code {
          font-family: 'Courier New', monospace;
          font-weight: 700;
          font-size: 1.2rem;
          color: #1a365d;
        }

        .color-name {
          font-size: 1.1rem;
          color: #333;
          font-weight: 500;
        }

        .color-secondary {
          display: flex;
          align-items: center;
          gap: 1rem;
        }

        .hex-value {
          font-family: 'Courier New', monospace;
          font-size: 0.9rem;
          color: #666;
        }

        .coverage-badge {
          background: #ff6b35;
          color: white;
          padding: 0.25rem 0.75rem;
          border-radius: 12px;
          font-weight: 600;
          font-size: 0.9rem;
        }

        /* Summary Footer */
        .summary-footer {
          display: flex;
          justify-content: space-around;
          padding: 1.5rem;
          background: #f9f9f9;
          border-radius: 6px;
          border: 2px solid #ff6b35;
        }

        .footer-stat {
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 0.5rem;
        }

        .stat-label {
          font-size: 0.9rem;
          color: #666;
          font-weight: 500;
        }

        .stat-value {
          font-size: 1.5rem;
          font-weight: 700;
          color: #1a365d;
        }

        .close-button {
          padding: 0.75rem 1.5rem;
          background: #ff6b35;
          color: white;
          border: none;
          border-radius: 4px;
          font-weight: 600;
          cursor: pointer;
          transition: background 0.2s;
        }

        .close-button:hover {
          background: #e55a25;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
          .solid-color-summary {
            padding: 1rem;
          }

          .summary-header h3 {
            font-size: 1.4rem;
          }

          .color-item {
            flex-direction: column;
            align-items: flex-start;
          }

          .color-swatch {
            width: 100%;
            height: 50px;
          }

          .summary-footer {
            flex-direction: column;
            gap: 1rem;
          }
        }
      `})]})}function up({content:e,position:t="top"}){const[r,n]=A.useState(!1);return o.jsxs("div",{className:"help-icon-container",children:[o.jsx("button",{className:"help-icon",onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1),onClick:i=>{i.preventDefault(),i.stopPropagation(),n(!r)},type:"button","aria-label":"Help",children:"?"}),r&&o.jsx("div",{className:`help-tooltip help-tooltip-${t}`,children:e}),o.jsx("style",{children:`
        .help-icon-container {
          position: relative;
          display: inline-block;
        }

        .help-icon {
          display: inline-flex;
          align-items: center;
          justify-content: center;
          width: 18px;
          height: 18px;
          border-radius: 50%;
          background: #6b7280;
          color: white;
          border: none;
          font-size: 12px;
          font-weight: 600;
          cursor: help;
          transition: all 0.2s;
          padding: 0;
          line-height: 1;
        }

        .help-icon:hover {
          background: #374151;
          transform: scale(1.1);
        }

        .help-tooltip {
          position: absolute;
          z-index: 1000;
          background: #1f2937;
          color: white;
          padding: 0.75rem 1rem;
          border-radius: 6px;
          font-size: 0.875rem;
          line-height: 1.5;
          max-width: 300px;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
          pointer-events: none;
          white-space: normal;
        }

        .help-tooltip-top {
          bottom: calc(100% + 8px);
          left: 50%;
          transform: translateX(-50%);
        }

        .help-tooltip-top::after {
          content: '';
          position: absolute;
          top: 100%;
          left: 50%;
          transform: translateX(-50%);
          border: 6px solid transparent;
          border-top-color: #1f2937;
        }

        .help-tooltip-bottom {
          top: calc(100% + 8px);
          left: 50%;
          transform: translateX(-50%);
        }

        .help-tooltip-bottom::after {
          content: '';
          position: absolute;
          bottom: 100%;
          left: 50%;
          transform: translateX(-50%);
          border: 6px solid transparent;
          border-bottom-color: #1f2937;
        }

        .help-tooltip-right {
          left: calc(100% + 8px);
          top: 50%;
          transform: translateY(-50%);
        }

        .help-tooltip-right::after {
          content: '';
          position: absolute;
          right: 100%;
          top: 50%;
          transform: translateY(-50%);
          border: 6px solid transparent;
          border-right-color: #1f2937;
        }

        .help-tooltip-left {
          right: calc(100% + 8px);
          top: 50%;
          transform: translateY(-50%);
        }

        .help-tooltip-left::after {
          content: '';
          position: absolute;
          left: 100%;
          top: 50%;
          transform: translateY(-50%);
          border: 6px solid transparent;
          border-left-color: #1f2937;
        }

        @media (max-width: 768px) {
          .help-tooltip {
            max-width: 250px;
            font-size: 0.8125rem;
            padding: 0.625rem 0.875rem;
          }
        }
      `})]})}function YE({recipes:e,mode:t="blend",onColorClick:r,selectedColor:n,editedColors:i,onResetAll:s}){if(!e||e.length===0)return null;const a=h=>!i||i.size===0?!1:i.has(h.originalColor.hex.toLowerCase()),l=h=>{if(!i||i.size===0)return!1;const p=i.get(h.originalColor.hex.toLowerCase());return(p==null?void 0:p.newHex)==="transparent"||(p==null?void 0:p.newHex)==="none"},c=i&&i.size>0,d=h=>{const p=h.toLowerCase();return cr.find(g=>g.hex.toLowerCase()===p)},u=h=>{if(l(h))return"Transparent";if(t==="solid"){const p=d(h.blendColor.hex);if(p)return`${p.code} - ${p.name}`}return h.blendColor.hex},f=h=>{if(!n)return!1;const p=n.blendHex||n.hex;return h.blendColor.hex===p||h.targetColor.hex===p};return o.jsxs("div",{className:"color-legend",children:[o.jsxs("div",{className:"legend-header",children:[o.jsxs("div",{className:"legend-header-left",children:[o.jsx("span",{className:"legend-title",children:"Colours"}),o.jsx(up,{content:"Click any colour to edit all instances of that colour across the design. Changes apply to every region using that colour.",position:"right"}),r&&o.jsx("span",{className:"edit-hint",children:"(click to edit)"})]}),c&&s&&o.jsx("button",{onClick:s,className:"reset-all-btn",title:"Reset all colours to original",children:"Reset All"})]}),o.jsx("div",{className:"legend-colors",children:e.map((h,p)=>o.jsxs("div",{className:`color-item ${r?"clickable":""} ${f(h)?"selected":""}`,onClick:()=>{r&&r({hex:h.targetColor.hex,originalHex:h.originalColor.hex,blendHex:h.blendColor.hex,areaPct:h.targetColor.areaPct,recipe:h.chosenRecipe,targetColor:h.targetColor,isAddedFromEdit:h.isAddedFromEdit||!1,chosenRecipe:h.chosenRecipe},"palette")},title:r?"Click to edit this colour":"",children:[o.jsxs("div",{className:"color-swatch-wrapper",children:[o.jsx("div",{className:`color-swatch ${l(h)?"transparent-swatch":""}`,style:l(h)?{}:{backgroundColor:h.blendColor.hex}}),l(h)&&o.jsx("span",{className:"transparent-indicator",title:"Made transparent",children:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",width:"14",height:"14",children:[o.jsx("circle",{cx:"12",cy:"12",r:"10"}),o.jsx("line",{x1:"4",y1:"4",x2:"20",y2:"20"})]})}),a(h)&&!l(h)&&o.jsx("span",{className:"edit-indicator",title:"Colour has been modified",children:o.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"12",height:"12",children:o.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"})})})]}),o.jsxs("div",{className:"color-info",children:[o.jsx("span",{className:t==="solid"?"tpv-label":"hex-value",children:u(h)}),o.jsxs("span",{className:"coverage",children:[h.targetColor.areaPct.toFixed(1),"%"]})]})]},p))}),o.jsx("style",{jsx:!0,children:`
        .color-legend {
          background: rgba(255, 255, 255, 0.95);
          border: 1px solid #ddd;
          border-radius: 8px;
          padding: 1rem;
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
          width: 100%;
        }

        .legend-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          gap: 0.5rem;
          margin-bottom: 0.75rem;
          padding-bottom: 0.5rem;
          border-bottom: 1px solid #e0e0e0;
        }

        .legend-header-left {
          display: flex;
          align-items: center;
          gap: 0.5rem;
        }

        .legend-title {
          font-weight: 600;
          color: #1a365d;
          font-size: 0.95rem;
        }

        .edit-hint {
          font-size: 0.75rem;
          color: #ff6b35;
          font-weight: normal;
        }

        .reset-all-btn {
          padding: 0.25rem 0.5rem;
          font-size: 0.7rem;
          font-weight: 600;
          color: #ff6b35;
          background: #fff5f0;
          border: 1px solid #ff6b35;
          border-radius: 4px;
          cursor: pointer;
          transition: all 0.2s;
        }

        .reset-all-btn:hover {
          background: #ff6b35;
          color: white;
        }

        .legend-colors {
          display: grid;
          grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
          gap: 0.75rem;
        }

        .color-item {
          display: flex;
          align-items: center;
          gap: 0.75rem;
          padding: 0.5rem;
          border-radius: 4px;
          background: white;
          border: 1px solid #e8e8e8;
          transition: all 0.2s;
        }

        .color-item.clickable {
          cursor: pointer;
        }

        .color-item.clickable:hover {
          border-color: #ff6b35;
          background: #fff9f7;
          box-shadow: 0 2px 4px rgba(255, 107, 53, 0.15);
          transform: translateY(-2px);
        }

        .color-item.selected {
          border-color: #ff6b35;
          border-width: 2px;
          background: #fff9f7;
          box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.2);
          transform: translateY(-2px);
        }

        .color-swatch-wrapper {
          position: relative;
          flex-shrink: 0;
        }

        .color-swatch {
          width: 40px;
          height: 40px;
          border-radius: 4px;
          border: 2px solid #ddd;
        }

        .color-swatch.transparent-swatch {
          background:
            linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%),
            linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%);
          background-size: 8px 8px;
          background-position: 0 0, 4px 4px;
          background-color: white;
          border-color: #999;
        }

        .transparent-indicator {
          position: absolute;
          top: -4px;
          right: -4px;
          width: 18px;
          height: 18px;
          background: #6b7280;
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          color: white;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }

        .transparent-indicator svg {
          width: 12px;
          height: 12px;
        }

        .edit-indicator {
          position: absolute;
          top: -4px;
          right: -4px;
          width: 16px;
          height: 16px;
          background: #ff6b35;
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          color: white;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }

        .edit-indicator svg {
          width: 10px;
          height: 10px;
        }

        .color-info {
          display: flex;
          flex-direction: column;
          gap: 0.25rem;
          font-size: 0.85rem;
        }

        .hex-value {
          font-family: 'Courier New', monospace;
          font-weight: 600;
          color: #333;
        }

        .tpv-label {
          font-weight: 600;
          color: #1a365d;
          font-size: 0.9rem;
        }

        .coverage {
          color: #666;
          font-size: 0.8rem;
        }

        /* Mobile - compact horizontal grid of swatches */
        @media (max-width: 768px) {
          .color-legend {
            padding: 0.75rem;
          }

          .legend-header {
            margin-bottom: 0.5rem;
            padding-bottom: 0.5rem;
          }

          .legend-title {
            font-size: 0.85rem;
          }

          .edit-hint {
            font-size: 0.7rem;
          }

          .reset-all-btn {
            font-size: 0.65rem;
            padding: 0.2rem 0.4rem;
            min-height: 28px;
          }

          /* Horizontal scrolling grid of swatches */
          .legend-colors {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            justify-content: flex-start;
          }

          .color-item {
            flex-direction: column;
            padding: 0.25rem;
            border-radius: 6px;
            width: auto;
            min-width: 44px;
          }

          /* Hide text info on mobile - just show swatches */
          .color-info {
            display: none;
          }

          .color-swatch {
            width: 44px;
            height: 44px;
            border-radius: 6px;
          }

          .color-item.selected {
            transform: none;
            box-shadow: 0 0 0 2px rgba(255, 107, 53, 0.4);
          }

          .color-item.clickable:hover {
            transform: none;
          }

          .edit-indicator {
            top: -2px;
            right: -2px;
            width: 14px;
            height: 14px;
          }

          .edit-indicator svg {
            width: 8px;
            height: 8px;
          }
        }

        @media (max-width: 480px) {
          .color-legend {
            padding: 0.5rem;
          }

          .legend-colors {
            gap: 0.35rem;
          }

          .color-swatch {
            width: 40px;
            height: 40px;
          }

          .color-item {
            min-width: 40px;
          }
        }
      `})]})}const XE=[{code:"RH01",name:"Standard Red",hex:"#A5362F"},{code:"RH02",name:"Bright Red",hex:"#E21F2F"},{code:"RH10",name:"Standard Green",hex:"#609B63"},{code:"RH11",name:"Bright Green",hex:"#3BB44A"},{code:"RH12",name:"Dark Green",hex:"#006C55"},{code:"RH20",name:"Standard Blue",hex:"#0075BC"},{code:"RH21",name:"Purple",hex:"#493D8C"},{code:"RH22",name:"Light Blue",hex:"#47AFE3"},{code:"RH23",name:"Azure",hex:"#039DC4"},{code:"RH26",name:"Turquoise",hex:"#00A6A3"},{code:"RH30",name:"Standard Beige",hex:"#E4C4AA"},{code:"RH31",name:"Cream",hex:"#E8E3D8"},{code:"RH32",name:"Brown",hex:"#8B5F3C"},{code:"RH90",name:"Funky Pink",hex:"#E8457E"},{code:"RH40",name:"Mustard Yellow",hex:"#E5A144"},{code:"RH41",name:"Bright Yellow",hex:"#FFD833"},{code:"RH50",name:"Orange",hex:"#F15B32"},{code:"RH60",name:"Dark Grey",hex:"#59595B"},{code:"RH61",name:"Light Grey",hex:"#939598"},{code:"RH65",name:"Pale Grey",hex:"#D9D9D6"},{code:"RH70",name:"Black",hex:"#231F20"}];function KE({blendSvgUrl:e,recipes:t,mode:r="blend",onColorClick:n,onRegionClick:i,onEyedropperCancel:s,onMakeTransparent:a,onSelectTPVColor:l,selectedColor:c,editedColors:d,onResetAll:u,designName:f="",onNameChange:h,isNameLoading:p=!1,onInSituClick:g,eyedropperActive:m=!1,eyedropperRegion:x=null,onRegionUndo:v,onRegionRedo:y,canUndo:b=!1,canRedo:w=!1,regionOverridesCount:j=0}){const[_,E]=A.useState(null),[N,O]=A.useState(null),I=A.useRef(null),te=A.useRef(null);A.useRef(null);const[T,V]=A.useState(1),[S,K]=A.useState({x:0,y:0}),[fe,U]=A.useState(!1),[z,H]=A.useState({x:0,y:0}),Q=A.useRef(null),W=A.useRef(!1),[q,re]=A.useState(()=>localStorage.getItem("tpv_color_editing_tip_dismissed")!=="true"),oe=()=>{re(!1),localStorage.setItem("tpv_color_editing_tip_dismissed","true")};A.useEffect(()=>{if(!e){O(null);return}(async()=>{try{const Z=await(await fetch(e)).text();O(Z);const Y=Z.includes("data-region-id"),L=(Z.match(/data-region-id/g)||[]).length;console.log("[SVGPreview] Fetched inline SVG content - length:",Z.length,"hasRegionTags:",Y,"regionCount:",L)}catch(M){console.error("[SVGPreview] Failed to fetch SVG content:",M),O(null)}})()},[e]);const pe=A.useMemo(()=>{if(!N)return null;console.log("[SVGPreview] Sanitizing SVG content...");const R=ap(N);return R?(console.log("[SVGPreview] SVG sanitization complete - length:",R.length),console.log("[SVGPreview] Sanitized content preview:",R.substring(0,200)),R.includes("<svg")?R.replace(/<svg([^>]*)>/i,(Z,Y)=>(Y.includes("width=")||(Y+=' width="100%"'),Y.includes("height=")||(Y+=' height="100%"'),`<svg${Y}>`)):(console.error("[SVGPreview] Sanitized SVG does not contain <svg> tag!"),null)):(console.error("[SVGPreview] SVG sanitization failed - content rejected"),null)},[N]);A.useEffect(()=>{if(!c||!e){E(null);return}(async()=>{try{console.log("[SVGPreview] Creating highlight for color:",c);const M=new Image;M.crossOrigin="anonymous";const Z=new Promise((xe,Oe)=>{M.onload=()=>{console.log("[SVGPreview] Image loaded:",M.width,"x",M.height),xe()},M.onerror=be=>{console.error("[SVGPreview] Image load error:",be),Oe(be)}});M.src=e,await Z;const Y=document.createElement("canvas");Y.width=M.naturalWidth||M.width||1e3,Y.height=M.naturalHeight||M.height||1e3;const L=Y.getContext("2d");L.drawImage(M,0,0);const ue=L.getImageData(0,0,Y.width,Y.height).data,ie=c.hex,$=Pe(ie);console.log("[SVGPreview] Target color:",ie,$);const X=new Set;let ae=0;for(let xe=0;xe<Y.height;xe++)for(let Oe=0;Oe<Y.width;Oe++){const be=(xe*Y.width+Oe)*4,Ne=ue[be],He=ue[be+1],qe=ue[be+2];ue[be+3]>0&&Re(Ne,He,qe,$)&&(X.add(`${Oe},${xe}`),ae++)}if(console.log("[SVGPreview] Matched pixels:",ae),ae===0){console.warn("[SVGPreview] No pixels matched the target color"),E(null);return}const we=L.createImageData(Y.width,Y.height);for(let xe=0;xe<Y.height;xe++)for(let Oe=0;Oe<Y.width;Oe++){const be=(xe*Y.width+Oe)*4;X.has(`${Oe},${xe}`)&&(!X.has(`${Oe-1},${xe}`)||!X.has(`${Oe+1},${xe}`)||!X.has(`${Oe},${xe-1}`)||!X.has(`${Oe},${xe+1}`))&&(we.data[be]=255,we.data[be+1]=0,we.data[be+2]=255,we.data[be+3]=255)}L.clearRect(0,0,Y.width,Y.height),L.putImageData(we,0,0);const se=Y.toDataURL();console.log("[SVGPreview] Highlight mask created"),E(se)}catch(M){console.error("[SVGPreview] Failed to create highlight mask:",M),E(null)}})()},[c,e]);const Pe=R=>{const M=R.replace("#","");return{r:parseInt(M.substring(0,2),16),g:parseInt(M.substring(2,4),16),b:parseInt(M.substring(4,6),16)}},Re=(R,M,Z,Y)=>Math.abs(R-Y.r)<=50&&Math.abs(M-Y.g)<=50&&Math.abs(Z-Y.b)<=50,Ae=async(R,M)=>{try{if(!I.current||!e)return null;const Z=new Image;Z.crossOrigin="anonymous";const Y=new Promise((xe,Oe)=>{Z.onload=xe,Z.onerror=Oe});Z.src=e,await Y;const L=document.createElement("canvas");L.width=Z.naturalWidth||Z.width||1e3,L.height=Z.naturalHeight||Z.height||1e3;const J=L.getContext("2d");J.drawImage(Z,0,0);const ue=I.current.getBoundingClientRect(),ie=L.width/ue.width,$=L.height/ue.height,X=Math.floor(R*ie),ae=Math.floor(M*$),se=J.getImageData(X,ae,1,1).data;return{r:se[0],g:se[1],b:se[2],a:se[3]}}catch(Z){return console.error("[SVGPreview] Failed to get color at position:",Z),null}},Ce=()=>{V(R=>Math.min(R*1.5,5))},ve=()=>{V(R=>Math.max(R/1.5,.5))},me=()=>{V(1),K({x:0,y:0})},De=R=>{R.preventDefault();const M=R.deltaY*-.001;V(Z=>Math.min(Math.max(Z+M,.5),5))},Xe=R=>{R.button===0&&(U(!0),H({x:R.clientX-S.x,y:R.clientY-S.y}),W.current=!1)},C=R=>{if(!fe)return;const M=Math.abs(R.clientX-(z.x+S.x)),Z=Math.abs(R.clientY-(z.y+S.y));(M>5||Z>5)&&(W.current=!0),K({x:R.clientX-z.x,y:R.clientY-z.y})},ce=()=>{U(!1)};A.useEffect(()=>{if(fe)return document.addEventListener("mousemove",C),document.addEventListener("mouseup",ce),()=>{document.removeEventListener("mousemove",C),document.removeEventListener("mouseup",ce)}},[fe,z,S]);const ne=R=>{let M=R;for(;M&&M!==te.current;){if(M.hasAttribute&&M.hasAttribute("data-region-id"))return M;M=M.parentElement}return null},F=async R=>{var ie,$;if(W.current){console.log("[SVGPreview] Click ignored - was dragging");return}if(console.log("[SVGPreview] Click detected - onRegionClick:",!!i,"inlineSvgContent:",!!N,"target:",R.target.tagName),i&&N){console.log("[SVGPreview] Attempting region detection on target:",R.target);const X=ne(R.target);if(console.log("[SVGPreview] Found region element:",X),X){const ae=X.getAttribute("data-region-id"),we=X.getAttribute("fill")||(($=(ie=X.getAttribute("style"))==null?void 0:ie.match(/fill:\s*([^;]+)/))==null?void 0:$[1]);console.log("[SVGPreview] Region clicked:",ae,"fill:",we),i({regionId:ae,sourceColor:we,element:X});return}else console.log("[SVGPreview] No region element found from target")}else console.log("[SVGPreview] Region detection skipped - onRegionClick:",!!i,"inlineSvgContent:",!!N);if(!n||!t||t.length===0)return;const M=R.currentTarget.getBoundingClientRect(),Z=R.clientX-M.left,Y=R.clientY-M.top;console.log("[SVGPreview] Clicked at:",Z,Y);const L=await Ae(Z,Y);if(!L||L.a===0){console.log("[SVGPreview] Clicked on transparent area");return}console.log("[SVGPreview] Clicked color:",L);let J=null,ue=1/0;for(const X of t){const ae=X.targetColor.hex,we=Pe(ae);if(Re(L.r,L.g,L.b,we)){const se=Math.sqrt(Math.pow(L.r-we.r,2)+Math.pow(L.g-we.g,2)+Math.pow(L.b-we.b,2));se<ue&&(ue=se,J=X)}}J?(console.log("[SVGPreview] Matched recipe:",J.targetColor.hex),n({hex:J.targetColor.hex,originalHex:J.originalColor.hex,blendHex:J.blendColor.hex,areaPct:J.targetColor.areaPct,recipe:J.chosenRecipe,targetColor:J.targetColor,isAddedFromEdit:J.isAddedFromEdit||!1,chosenRecipe:J.chosenRecipe})):console.log("[SVGPreview] No matching recipe found for clicked color")};return e?o.jsxs("div",{className:"svg-preview",children:[o.jsxs("div",{className:"preview-header",children:[o.jsxs("div",{className:"design-name-container",children:[h?o.jsx("input",{type:"text",className:"design-name-input",value:f,onChange:R=>h(R.target.value),placeholder:p?"Generating name...":"Enter project name"}):o.jsx("h3",{children:f||"TPV Blend Design"}),p&&o.jsx("span",{className:"name-loading",children:"Generating..."})]}),c&&o.jsxs("span",{className:"editing-hint",children:["Editing: ",c.hex||c.blendHex]})]}),q&&n&&o.jsxs("div",{className:"color-editing-tip",children:[o.jsx("div",{className:"tip-icon",children:""}),o.jsxs("div",{className:"tip-content",children:[o.jsx("strong",{children:"Tip:"})," Click colours in the legend below to edit all instances, or click directly on the design to edit individual regions."]}),o.jsx("button",{onClick:oe,className:"tip-close",title:"Dismiss tip",children:""})]}),o.jsxs("div",{className:"svg-display-container",children:[o.jsxs("div",{className:"svg-panel",children:[o.jsxs("div",{className:"zoom-controls",children:[o.jsx("button",{onClick:Ce,className:"zoom-btn",title:"Zoom In",children:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"11",cy:"11",r:"8"}),o.jsx("line",{x1:"11",y1:"8",x2:"11",y2:"14"}),o.jsx("line",{x1:"8",y1:"11",x2:"14",y2:"11"}),o.jsx("path",{d:"m21 21-4.35-4.35"})]})}),o.jsx("button",{onClick:ve,className:"zoom-btn",title:"Zoom Out",children:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"11",cy:"11",r:"8"}),o.jsx("line",{x1:"8",y1:"11",x2:"14",y2:"11"}),o.jsx("path",{d:"m21 21-4.35-4.35"})]})}),o.jsx("button",{onClick:me,className:"zoom-btn",title:"Reset View",children:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M1 4v6h6"}),o.jsx("path",{d:"M23 20v-6h-6"}),o.jsx("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})]})}),o.jsxs("span",{className:"zoom-level",children:[Math.round(T*100),"%"]})]}),j>0&&o.jsxs("div",{className:"undo-redo-controls",children:[o.jsx("button",{onClick:v,className:"undo-redo-btn",title:"Undo (Ctrl+Z)",disabled:!b,children:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M3 7v6h6"}),o.jsx("path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13"})]})}),o.jsx("button",{onClick:y,className:"undo-redo-btn",title:"Redo (Ctrl+Y)",disabled:!w,children:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M21 7v6h-6"}),o.jsx("path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7"})]})})]}),g&&o.jsxs("button",{onClick:g,className:"in-situ-btn",title:"Upload a photo of your installation site and see how this design will look in place with realistic perspective",children:[o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),o.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),o.jsx("path",{d:"m21 15-5-5L5 21"})]}),o.jsx("span",{children:"Preview In-Situ"})]}),o.jsx("div",{ref:Q,className:"svg-wrapper",onWheel:De,children:o.jsxs("div",{className:"svg-image-container",onClick:F,onMouseDown:Xe,style:{transform:`translate(${S.x}px, ${S.y}px) scale(${T})`,cursor:fe?"grabbing":T>1?"grab":m?"crosshair":n?"pointer":"default"},children:[pe?o.jsx("div",{ref:te,className:"svg-inline-container",style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},dangerouslySetInnerHTML:{__html:pe}}):o.jsx("img",{ref:I,src:e,alt:"TPV blend design",className:"svg-image"}),_&&o.jsx("img",{src:_,alt:"Colour highlight",className:"svg-highlight-mask"})]})}),m&&x&&o.jsx("div",{className:"eyedropper-overlay",children:o.jsxs("div",{className:"eyedropper-content",children:[o.jsx("div",{className:"eyedropper-header",children:o.jsxs("div",{className:"eyedropper-color-indicator",children:[o.jsx("div",{className:"eyedropper-color-swatch",style:{backgroundColor:x.sourceColor}}),o.jsx("span",{children:"Click another area to copy its colour, or select a TPV colour:"})]})}),o.jsx("div",{className:"eyedropper-palette",children:o.jsx("div",{className:"palette-grid",children:XE.map(R=>o.jsx("button",{className:"palette-swatch",style:{backgroundColor:R.hex},onClick:M=>{M.stopPropagation(),l&&l({hex:R.hex,code:R.code,name:R.name})},title:`${R.name} (${R.code})`},R.code))})}),o.jsxs("div",{className:"eyedropper-actions",children:[o.jsxs("button",{className:"eyedropper-transparent",onClick:R=>{R.stopPropagation(),a&&a()},title:"Remove fill from this region",children:[o.jsx("span",{className:"transparent-icon",children:""}),"Make Transparent"]}),o.jsx("button",{className:"eyedropper-cancel",onClick:R=>{R.stopPropagation(),s&&s()},children:"Cancel (Esc)"})]})]})})]}),t&&t.length>0&&o.jsx("div",{className:"legend-sidebar",children:o.jsx(YE,{recipes:t,mode:r,onColorClick:n,selectedColor:c,editedColors:d,onResetAll:u})})]}),o.jsx("style",{jsx:!0,children:`
        .svg-preview {
          background: #fff;
          border-radius: 8px;
          border: 1px solid #ddd;
          padding: 1.5rem;
          margin-top: 1.5rem;
        }

        .preview-header {
          margin-bottom: 1.5rem;
          display: flex;
          align-items: center;
          justify-content: space-between;
          flex-wrap: wrap;
          gap: 0.5rem;
        }

        .design-name-container {
          display: flex;
          align-items: center;
          gap: 0.75rem;
          flex: 1;
        }

        .preview-header h3 {
          margin: 0;
          color: #1a365d;
          font-size: 1.5rem;
        }

        .design-name-input {
          font-family: var(--font-heading), 'Space Grotesk', sans-serif;
          font-size: 1.5rem;
          font-weight: 600;
          color: #1a365d;
          border: none;
          border-bottom: 2px solid transparent;
          background: transparent;
          padding: 0.25rem 0;
          width: 100%;
          max-width: 400px;
          transition: border-color 0.2s;
        }

        .design-name-input:hover {
          border-bottom-color: #e5e7eb;
        }

        .design-name-input:focus {
          outline: none;
          border-bottom-color: #ff6b35;
        }

        .design-name-input::placeholder {
          color: #9ca3af;
          font-weight: normal;
        }

        .name-loading {
          font-size: 0.75rem;
          color: #9ca3af;
          font-style: italic;
        }

        /* Color Editing Tip Banner */
        .color-editing-tip {
          display: flex;
          align-items: center;
          gap: 0.75rem;
          padding: 0.875rem 1rem;
          background: linear-gradient(to right, #fff7ed, #fffbeb);
          border: 1px solid #fed7aa;
          border-radius: 6px;
          margin-bottom: 1rem;
          font-size: 0.875rem;
          line-height: 1.5;
        }

        .tip-icon {
          font-size: 1.25rem;
          flex-shrink: 0;
        }

        .tip-content {
          flex: 1;
          color: #78350f;
        }

        .tip-content strong {
          color: #92400e;
        }

        .tip-close {
          background: none;
          border: none;
          font-size: 1.5rem;
          color: #92400e;
          cursor: pointer;
          padding: 0;
          line-height: 1;
          opacity: 0.6;
          transition: opacity 0.2s;
          flex-shrink: 0;
        }

        .tip-close:hover {
          opacity: 1;
        }

        /* SVG Display */
        .svg-display-container {
          display: flex;
          flex-direction: column;
          gap: 1.5rem;
          align-items: stretch;
        }

        .svg-panel {
          position: relative;
          flex: 1;
          border: 1px solid #e0e0e0;
          border-radius: 6px;
          overflow: hidden;
          background: #fafafa;
        }

        /* Zoom Controls */
        .zoom-controls {
          position: absolute;
          top: 1rem;
          right: 1rem;
          display: flex;
          gap: 0.5rem;
          background: white;
          border-radius: 8px;
          padding: 0.5rem;
          box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
          z-index: 10;
          align-items: center;
        }

        .zoom-btn {
          display: flex;
          align-items: center;
          justify-content: center;
          width: 36px;
          height: 36px;
          padding: 0;
          background: white;
          border: 1px solid #e0e0e0;
          border-radius: 6px;
          cursor: pointer;
          color: #1a365d;
          transition: all 0.2s ease;
        }

        .zoom-btn:hover {
          background: #f8fafc;
          border-color: #1e4a7a;
          transform: translateY(-1px);
          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .zoom-btn:active {
          transform: translateY(0);
        }

        .zoom-btn svg {
          width: 20px;
          height: 20px;
        }

        .zoom-level {
          font-size: 0.875rem;
          font-weight: 600;
          color: #1a365d;
          min-width: 50px;
          text-align: center;
          padding: 0 0.5rem;
        }

        /* Undo/Redo Controls */
        .undo-redo-controls {
          position: absolute;
          top: 5rem;
          right: 1rem;
          display: flex;
          gap: 0.5rem;
          background: white;
          border-radius: 8px;
          padding: 0.5rem;
          box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
          z-index: 10;
        }

        .undo-redo-btn {
          display: flex;
          align-items: center;
          justify-content: center;
          width: 36px;
          height: 36px;
          padding: 0;
          background: white;
          border: 1px solid #e0e0e0;
          border-radius: 6px;
          cursor: pointer;
          color: #1a365d;
          transition: all 0.2s ease;
        }

        .undo-redo-btn:hover:not(:disabled) {
          background: #f8fafc;
          border-color: #1e4a7a;
          transform: translateY(-1px);
          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .undo-redo-btn:active:not(:disabled) {
          transform: translateY(0);
        }

        .undo-redo-btn:disabled {
          opacity: 0.4;
          cursor: not-allowed;
        }

        .undo-redo-btn svg {
          width: 20px;
          height: 20px;
        }

        .in-situ-btn {
          position: absolute;
          top: 1rem;
          left: 1rem;
          display: flex;
          align-items: center;
          gap: 0.5rem;
          padding: 0.5rem 1rem;
          background: #ff6b35;
          color: white;
          border: none;
          border-radius: 6px;
          font-size: 0.875rem;
          font-weight: 500;
          cursor: pointer;
          box-shadow: 0 2px 12px rgba(255, 107, 53, 0.3);
          z-index: 10;
          transition: all 0.2s ease;
        }

        .in-situ-btn:hover {
          background: #e55a2b;
          transform: translateY(-1px);
          box-shadow: 0 4px 16px rgba(255, 107, 53, 0.4);
        }

        .in-situ-btn:active {
          transform: translateY(0);
        }

        .in-situ-btn svg {
          width: 18px;
          height: 18px;
        }

        .svg-wrapper {
          padding: 2rem;
          background: white;
          min-height: 400px;
          display: flex;
          align-items: center;
          justify-content: center;
          overflow: hidden;
          position: relative;
        }

        .svg-image-container {
          position: relative;
          display: inline-block;
          user-select: none;
          transition: transform 0.1s ease-out;
          transform-origin: center center;
        }

        .svg-image {
          max-width: 100%;
          height: auto;
          display: block;
          border-radius: 4px;
          pointer-events: ${n?"auto":"none"};
        }

        .svg-inline-container {
          max-width: 100%;
          display: block;
          border-radius: 4px;
        }

        .svg-inline-container svg {
          max-width: 100%;
          height: auto;
          display: block;
        }

        .svg-highlight-mask {
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          pointer-events: none;
          border-radius: 4px;
          filter: drop-shadow(0 0 3px rgba(255, 0, 255, 0.8)) drop-shadow(0 0 1px rgba(0, 0, 0, 0.6));
          animation: pulse 2s ease-in-out infinite;
        }

        .eyedropper-overlay {
          position: absolute;
          top: 20px;
          left: 50%;
          transform: translateX(-50%);
          z-index: 100;
        }

        .eyedropper-content {
          background: white;
          border-radius: 12px;
          padding: 16px 20px;
          box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
          display: flex;
          flex-direction: column;
          gap: 12px;
          border: 2px solid #3b82f6;
          max-width: 320px;
        }

        .eyedropper-header {
          display: flex;
          align-items: center;
          gap: 12px;
        }

        .eyedropper-color-indicator {
          display: flex;
          align-items: center;
          gap: 12px;
          font-size: 0.9rem;
          font-weight: 500;
          color: #111827;
        }

        .eyedropper-color-swatch {
          width: 28px;
          height: 28px;
          border-radius: 6px;
          border: 2px solid #d1d5db;
          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
          flex-shrink: 0;
        }

        .eyedropper-palette {
          padding: 10px;
          background: #f9fafb;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
        }

        .palette-grid {
          display: grid;
          grid-template-columns: repeat(7, 1fr);
          gap: 4px;
        }

        .palette-swatch {
          width: 32px;
          height: 32px;
          border: 2px solid rgba(0, 0, 0, 0.15);
          border-radius: 4px;
          cursor: pointer;
          padding: 0;
          transition: all 0.15s ease;
        }

        .palette-swatch:hover {
          transform: scale(1.15);
          z-index: 1;
          box-shadow: 0 3px 8px rgba(0, 0, 0, 0.25);
          border-color: #3b82f6;
        }

        .eyedropper-cancel {
          padding: 8px 16px;
          background: #ef4444;
          color: white;
          border: none;
          border-radius: 6px;
          font-size: 0.9rem;
          font-weight: 500;
          cursor: pointer;
          transition: all 0.2s;
          white-space: nowrap;
        }

        .eyedropper-cancel:hover {
          background: #dc2626;
          box-shadow: 0 2px 6px rgba(239, 68, 68, 0.3);
        }

        .eyedropper-actions {
          display: flex;
          gap: 8px;
          align-items: center;
          justify-content: center;
        }

        .eyedropper-transparent {
          display: flex;
          align-items: center;
          gap: 6px;
          padding: 8px 14px;
          background: linear-gradient(135deg, #f3f4f6 25%, #d1d5db 25%, #d1d5db 50%, #f3f4f6 50%, #f3f4f6 75%, #d1d5db 75%);
          background-size: 8px 8px;
          color: #374151;
          border: 2px solid #6b7280;
          border-radius: 6px;
          font-size: 0.9rem;
          font-weight: 600;
          cursor: pointer;
          transition: all 0.2s;
          white-space: nowrap;
        }

        .eyedropper-transparent:hover {
          border-color: #374151;
          box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
          transform: translateY(-1px);
        }

        .transparent-icon {
          width: 16px;
          height: 16px;
          background: linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%),
                      linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%);
          background-size: 8px 8px;
          background-position: 0 0, 4px 4px;
          background-color: white;
          border: 1px solid #999;
          border-radius: 2px;
          display: inline-block;
          font-size: 0;
        }

        @keyframes pulse {
          0%, 100% {
            opacity: 0.8;
          }
          50% {
            opacity: 1;
          }
        }

        .editing-hint {
          font-size: 0.9rem;
          color: #ff6b35;
          font-weight: 500;
          margin-left: 1rem;
        }

        .legend-sidebar {
          width: 100%;
        }

        @media (max-width: 768px) {
          .svg-preview {
            padding: 0.5rem;
            margin-top: 0.75rem;
            border-radius: 6px;
          }

          .preview-header {
            flex-direction: column;
            align-items: flex-start;
            gap: 0.25rem;
            margin-bottom: 0.5rem;
          }

          .preview-header h3 {
            font-size: 1.1rem;
          }

          .design-name-input {
            font-size: 1.1rem;
            max-width: 100%;
          }

          .editing-hint {
            margin-left: 0;
            font-size: 0.75rem;
          }

          .svg-panel {
            border: none;
            border-radius: 0;
          }

          .svg-wrapper {
            padding: 0;
            min-height: auto;
          }

          /* Position zoom controls at bottom-right on mobile */
          .zoom-controls {
            position: fixed;
            bottom: 1rem;
            right: 1rem;
            top: auto;
            flex-direction: column;
            gap: 0.25rem;
            padding: 0.25rem;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(8px);
            z-index: 50;
          }

          /* Position undo/redo controls above zoom on mobile */
          .undo-redo-controls {
            position: fixed;
            bottom: 12rem;
            right: 1rem;
            top: auto;
            gap: 0.25rem;
            padding: 0.25rem;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(8px);
            z-index: 50;
          }

          /* Make buttons circular and compact on mobile */
          .zoom-btn,
          .undo-redo-btn {
            width: 44px;
            height: 44px;
            padding: 0;
            border-radius: 50%;
            min-width: unset;
            font-size: 1.1rem;
          }

          /* Hide text labels on mobile */
          .zoom-btn span {
            display: none;
          }

          /* In-situ button - compact on mobile */
          .in-situ-btn {
            padding: 0.4rem;
            font-size: 0;
            top: 0.5rem;
            left: 0.5rem;
            border-radius: 50%;
            width: 36px;
            height: 36px;
          }

          .in-situ-btn span {
            display: none;
          }

          .in-situ-btn svg {
            width: 18px;
            height: 18px;
          }

          .svg-image-container {
            /* Allow zoom on mobile via buttons */
            cursor: default !important;
          }
        }

        /* Extra small screens */
        @media (max-width: 480px) {
          .svg-preview {
            padding: 0.25rem;
            margin-top: 0.5rem;
          }

          .preview-header {
            padding: 0 0.25rem;
          }

          .preview-header h3 {
            font-size: 1rem;
          }

          .design-name-input {
            font-size: 1rem;
          }
        }
      `})]}):null}var Ur={},cl={},ZE=typeof wi=="object"&&wi&&wi.Object===Object&&wi,Rw=ZE,JE=Rw,QE=typeof self=="object"&&self&&self.Object===Object&&self,e5=JE||QE||Function("return this")(),An=e5,t5=An,r5=t5.Symbol,dl=r5,u0=dl,Ow=Object.prototype,n5=Ow.hasOwnProperty,i5=Ow.toString,oa=u0?u0.toStringTag:void 0;function s5(e){var t=n5.call(e,oa),r=e[oa];try{e[oa]=void 0;var n=!0}catch{}var i=i5.call(e);return n&&(t?e[oa]=r:delete e[oa]),i}var o5=s5,a5=Object.prototype,l5=a5.toString;function c5(e){return l5.call(e)}var d5=c5,h0=dl,u5=o5,h5=d5,f5="[object Null]",p5="[object Undefined]",f0=h0?h0.toStringTag:void 0;function m5(e){return e==null?e===void 0?p5:f5:f0&&f0 in Object(e)?u5(e):h5(e)}var vs=m5,g5=Array.isArray,hn=g5;function v5(e){return e!=null&&typeof e=="object"}var Qn=v5,y5=vs,x5=hn,b5=Qn,w5="[object String]";function _5(e){return typeof e=="string"||!x5(e)&&b5(e)&&y5(e)==w5}var S5=_5;function k5(e){return function(t,r,n){for(var i=-1,s=Object(t),a=n(t),l=a.length;l--;){var c=a[e?l:++i];if(r(s[c],c,s)===!1)break}return t}}var j5=k5,C5=j5,E5=C5(),T5=E5;function N5(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var P5=N5,R5=vs,O5=Qn,A5="[object Arguments]";function M5(e){return O5(e)&&R5(e)==A5}var $5=M5,p0=$5,L5=Qn,Aw=Object.prototype,I5=Aw.hasOwnProperty,D5=Aw.propertyIsEnumerable,z5=p0(function(){return arguments}())?p0:function(e){return L5(e)&&I5.call(e,"callee")&&!D5.call(e,"callee")},Mw=z5,Uc={exports:{}};function F5(){return!1}var B5=F5;Uc.exports;(function(e,t){var r=An,n=B5,i=t&&!t.nodeType&&t,s=i&&!0&&e&&!e.nodeType&&e,a=s&&s.exports===i,l=a?r.Buffer:void 0,c=l?l.isBuffer:void 0,d=c||n;e.exports=d})(Uc,Uc.exports);var hp=Uc.exports,H5=9007199254740991,U5=/^(?:0|[1-9]\d*)$/;function W5(e,t){var r=typeof e;return t=t??H5,!!t&&(r=="number"||r!="symbol"&&U5.test(e))&&e>-1&&e%1==0&&e<t}var $w=W5,G5=9007199254740991;function V5(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=G5}var fp=V5,q5=vs,Y5=fp,X5=Qn,K5="[object Arguments]",Z5="[object Array]",J5="[object Boolean]",Q5="[object Date]",eT="[object Error]",tT="[object Function]",rT="[object Map]",nT="[object Number]",iT="[object Object]",sT="[object RegExp]",oT="[object Set]",aT="[object String]",lT="[object WeakMap]",cT="[object ArrayBuffer]",dT="[object DataView]",uT="[object Float32Array]",hT="[object Float64Array]",fT="[object Int8Array]",pT="[object Int16Array]",mT="[object Int32Array]",gT="[object Uint8Array]",vT="[object Uint8ClampedArray]",yT="[object Uint16Array]",xT="[object Uint32Array]",yt={};yt[uT]=yt[hT]=yt[fT]=yt[pT]=yt[mT]=yt[gT]=yt[vT]=yt[yT]=yt[xT]=!0;yt[K5]=yt[Z5]=yt[cT]=yt[J5]=yt[dT]=yt[Q5]=yt[eT]=yt[tT]=yt[rT]=yt[nT]=yt[iT]=yt[sT]=yt[oT]=yt[aT]=yt[lT]=!1;function bT(e){return X5(e)&&Y5(e.length)&&!!yt[q5(e)]}var wT=bT;function _T(e){return function(t){return e(t)}}var pp=_T,Wc={exports:{}};Wc.exports;(function(e,t){var r=Rw,n=t&&!t.nodeType&&t,i=n&&!0&&e&&!e.nodeType&&e,s=i&&i.exports===n,a=s&&r.process,l=function(){try{var c=i&&i.require&&i.require("util").types;return c||a&&a.binding&&a.binding("util")}catch{}}();e.exports=l})(Wc,Wc.exports);var mp=Wc.exports,ST=wT,kT=pp,m0=mp,g0=m0&&m0.isTypedArray,jT=g0?kT(g0):ST,Lw=jT,CT=P5,ET=Mw,TT=hn,NT=hp,PT=$w,RT=Lw,OT=Object.prototype,AT=OT.hasOwnProperty;function MT(e,t){var r=TT(e),n=!r&&ET(e),i=!r&&!n&&NT(e),s=!r&&!n&&!i&&RT(e),a=r||n||i||s,l=a?CT(e.length,String):[],c=l.length;for(var d in e)(t||AT.call(e,d))&&!(a&&(d=="length"||i&&(d=="offset"||d=="parent")||s&&(d=="buffer"||d=="byteLength"||d=="byteOffset")||PT(d,c)))&&l.push(d);return l}var Iw=MT,$T=Object.prototype;function LT(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||$T;return e===r}var gp=LT;function IT(e,t){return function(r){return e(t(r))}}var Dw=IT,DT=Dw,zT=DT(Object.keys,Object),FT=zT,BT=gp,HT=FT,UT=Object.prototype,WT=UT.hasOwnProperty;function GT(e){if(!BT(e))return HT(e);var t=[];for(var r in Object(e))WT.call(e,r)&&r!="constructor"&&t.push(r);return t}var VT=GT;function qT(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Lo=qT,YT=vs,XT=Lo,KT="[object AsyncFunction]",ZT="[object Function]",JT="[object GeneratorFunction]",QT="[object Proxy]";function eN(e){if(!XT(e))return!1;var t=YT(e);return t==ZT||t==JT||t==KT||t==QT}var zw=eN,tN=zw,rN=fp;function nN(e){return e!=null&&rN(e.length)&&!tN(e)}var xd=nN,iN=Iw,sN=VT,oN=xd;function aN(e){return oN(e)?iN(e):sN(e)}var ul=aN,lN=T5,cN=ul;function dN(e,t){return e&&lN(e,t,cN)}var Fw=dN;function uN(e){return e}var Bw=uN,hN=Bw;function fN(e){return typeof e=="function"?e:hN}var pN=fN,mN=Fw,gN=pN;function vN(e,t){return e&&mN(e,gN(t))}var vp=vN,yN=Dw,xN=yN(Object.getPrototypeOf,Object),yp=xN,bN=vs,wN=yp,_N=Qn,SN="[object Object]",kN=Function.prototype,jN=Object.prototype,Hw=kN.toString,CN=jN.hasOwnProperty,EN=Hw.call(Object);function TN(e){if(!_N(e)||bN(e)!=SN)return!1;var t=wN(e);if(t===null)return!0;var r=CN.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&Hw.call(r)==EN}var NN=TN;function PN(e,t){for(var r=-1,n=e==null?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i}var Uw=PN;function RN(){this.__data__=[],this.size=0}var ON=RN;function AN(e,t){return e===t||e!==e&&t!==t}var xp=AN,MN=xp;function $N(e,t){for(var r=e.length;r--;)if(MN(e[r][0],t))return r;return-1}var bd=$N,LN=bd,IN=Array.prototype,DN=IN.splice;function zN(e){var t=this.__data__,r=LN(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():DN.call(t,r,1),--this.size,!0}var FN=zN,BN=bd;function HN(e){var t=this.__data__,r=BN(t,e);return r<0?void 0:t[r][1]}var UN=HN,WN=bd;function GN(e){return WN(this.__data__,e)>-1}var VN=GN,qN=bd;function YN(e,t){var r=this.__data__,n=qN(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var XN=YN,KN=ON,ZN=FN,JN=UN,QN=VN,eP=XN;function Io(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Io.prototype.clear=KN;Io.prototype.delete=ZN;Io.prototype.get=JN;Io.prototype.has=QN;Io.prototype.set=eP;var wd=Io,tP=wd;function rP(){this.__data__=new tP,this.size=0}var nP=rP;function iP(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var sP=iP;function oP(e){return this.__data__.get(e)}var aP=oP;function lP(e){return this.__data__.has(e)}var cP=lP,dP=An,uP=dP["__core-js_shared__"],hP=uP,ju=hP,v0=function(){var e=/[^.]+$/.exec(ju&&ju.keys&&ju.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function fP(e){return!!v0&&v0 in e}var pP=fP,mP=Function.prototype,gP=mP.toString;function vP(e){if(e!=null){try{return gP.call(e)}catch{}try{return e+""}catch{}}return""}var Ww=vP,yP=zw,xP=pP,bP=Lo,wP=Ww,_P=/[\\^$.*+?()[\]{}|]/g,SP=/^\[object .+?Constructor\]$/,kP=Function.prototype,jP=Object.prototype,CP=kP.toString,EP=jP.hasOwnProperty,TP=RegExp("^"+CP.call(EP).replace(_P,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function NP(e){if(!bP(e)||xP(e))return!1;var t=yP(e)?TP:SP;return t.test(wP(e))}var PP=NP;function RP(e,t){return e==null?void 0:e[t]}var OP=RP,AP=PP,MP=OP;function $P(e,t){var r=MP(e,t);return AP(r)?r:void 0}var ys=$P,LP=ys,IP=An,DP=LP(IP,"Map"),bp=DP,zP=ys,FP=zP(Object,"create"),_d=FP,y0=_d;function BP(){this.__data__=y0?y0(null):{},this.size=0}var HP=BP;function UP(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var WP=UP,GP=_d,VP="__lodash_hash_undefined__",qP=Object.prototype,YP=qP.hasOwnProperty;function XP(e){var t=this.__data__;if(GP){var r=t[e];return r===VP?void 0:r}return YP.call(t,e)?t[e]:void 0}var KP=XP,ZP=_d,JP=Object.prototype,QP=JP.hasOwnProperty;function eR(e){var t=this.__data__;return ZP?t[e]!==void 0:QP.call(t,e)}var tR=eR,rR=_d,nR="__lodash_hash_undefined__";function iR(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=rR&&t===void 0?nR:t,this}var sR=iR,oR=HP,aR=WP,lR=KP,cR=tR,dR=sR;function Do(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Do.prototype.clear=oR;Do.prototype.delete=aR;Do.prototype.get=lR;Do.prototype.has=cR;Do.prototype.set=dR;var uR=Do,x0=uR,hR=wd,fR=bp;function pR(){this.size=0,this.__data__={hash:new x0,map:new(fR||hR),string:new x0}}var mR=pR;function gR(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var vR=gR,yR=vR;function xR(e,t){var r=e.__data__;return yR(t)?r[typeof t=="string"?"string":"hash"]:r.map}var Sd=xR,bR=Sd;function wR(e){var t=bR(this,e).delete(e);return this.size-=t?1:0,t}var _R=wR,SR=Sd;function kR(e){return SR(this,e).get(e)}var jR=kR,CR=Sd;function ER(e){return CR(this,e).has(e)}var TR=ER,NR=Sd;function PR(e,t){var r=NR(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var RR=PR,OR=mR,AR=_R,MR=jR,$R=TR,LR=RR;function zo(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}zo.prototype.clear=OR;zo.prototype.delete=AR;zo.prototype.get=MR;zo.prototype.has=$R;zo.prototype.set=LR;var wp=zo,IR=wd,DR=bp,zR=wp,FR=200;function BR(e,t){var r=this.__data__;if(r instanceof IR){var n=r.__data__;if(!DR||n.length<FR-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new zR(n)}return r.set(e,t),this.size=r.size,this}var HR=BR,UR=wd,WR=nP,GR=sP,VR=aP,qR=cP,YR=HR;function Fo(e){var t=this.__data__=new UR(e);this.size=t.size}Fo.prototype.clear=WR;Fo.prototype.delete=GR;Fo.prototype.get=VR;Fo.prototype.has=qR;Fo.prototype.set=YR;var _p=Fo,XR="__lodash_hash_undefined__";function KR(e){return this.__data__.set(e,XR),this}var ZR=KR;function JR(e){return this.__data__.has(e)}var QR=JR,e3=wp,t3=ZR,r3=QR;function Gc(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new e3;++t<r;)this.add(e[t])}Gc.prototype.add=Gc.prototype.push=t3;Gc.prototype.has=r3;var n3=Gc;function i3(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var s3=i3;function o3(e,t){return e.has(t)}var a3=o3,l3=n3,c3=s3,d3=a3,u3=1,h3=2;function f3(e,t,r,n,i,s){var a=r&u3,l=e.length,c=t.length;if(l!=c&&!(a&&c>l))return!1;var d=s.get(e),u=s.get(t);if(d&&u)return d==t&&u==e;var f=-1,h=!0,p=r&h3?new l3:void 0;for(s.set(e,t),s.set(t,e);++f<l;){var g=e[f],m=t[f];if(n)var x=a?n(m,g,f,t,e,s):n(g,m,f,e,t,s);if(x!==void 0){if(x)continue;h=!1;break}if(p){if(!c3(t,function(v,y){if(!d3(p,y)&&(g===v||i(g,v,r,n,s)))return p.push(y)})){h=!1;break}}else if(!(g===m||i(g,m,r,n,s))){h=!1;break}}return s.delete(e),s.delete(t),h}var Gw=f3,p3=An,m3=p3.Uint8Array,Vw=m3;function g3(e){var t=-1,r=Array(e.size);return e.forEach(function(n,i){r[++t]=[i,n]}),r}var v3=g3;function y3(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var x3=y3,b0=dl,w0=Vw,b3=xp,w3=Gw,_3=v3,S3=x3,k3=1,j3=2,C3="[object Boolean]",E3="[object Date]",T3="[object Error]",N3="[object Map]",P3="[object Number]",R3="[object RegExp]",O3="[object Set]",A3="[object String]",M3="[object Symbol]",$3="[object ArrayBuffer]",L3="[object DataView]",_0=b0?b0.prototype:void 0,Cu=_0?_0.valueOf:void 0;function I3(e,t,r,n,i,s,a){switch(r){case L3:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case $3:return!(e.byteLength!=t.byteLength||!s(new w0(e),new w0(t)));case C3:case E3:case P3:return b3(+e,+t);case T3:return e.name==t.name&&e.message==t.message;case R3:case A3:return e==t+"";case N3:var l=_3;case O3:var c=n&k3;if(l||(l=S3),e.size!=t.size&&!c)return!1;var d=a.get(e);if(d)return d==t;n|=j3,a.set(e,t);var u=w3(l(e),l(t),n,i,s,a);return a.delete(e),u;case M3:if(Cu)return Cu.call(e)==Cu.call(t)}return!1}var D3=I3;function z3(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}var qw=z3,F3=qw,B3=hn;function H3(e,t,r){var n=t(e);return B3(e)?n:F3(n,r(e))}var Yw=H3;function U3(e,t){for(var r=-1,n=e==null?0:e.length,i=0,s=[];++r<n;){var a=e[r];t(a,r,e)&&(s[i++]=a)}return s}var W3=U3;function G3(){return[]}var Xw=G3,V3=W3,q3=Xw,Y3=Object.prototype,X3=Y3.propertyIsEnumerable,S0=Object.getOwnPropertySymbols,K3=S0?function(e){return e==null?[]:(e=Object(e),V3(S0(e),function(t){return X3.call(e,t)}))}:q3,Sp=K3,Z3=Yw,J3=Sp,Q3=ul;function eO(e){return Z3(e,Q3,J3)}var Kw=eO,k0=Kw,tO=1,rO=Object.prototype,nO=rO.hasOwnProperty;function iO(e,t,r,n,i,s){var a=r&tO,l=k0(e),c=l.length,d=k0(t),u=d.length;if(c!=u&&!a)return!1;for(var f=c;f--;){var h=l[f];if(!(a?h in t:nO.call(t,h)))return!1}var p=s.get(e),g=s.get(t);if(p&&g)return p==t&&g==e;var m=!0;s.set(e,t),s.set(t,e);for(var x=a;++f<c;){h=l[f];var v=e[h],y=t[h];if(n)var b=a?n(y,v,h,t,e,s):n(v,y,h,e,t,s);if(!(b===void 0?v===y||i(v,y,r,n,s):b)){m=!1;break}x||(x=h=="constructor")}if(m&&!x){var w=e.constructor,j=t.constructor;w!=j&&"constructor"in e&&"constructor"in t&&!(typeof w=="function"&&w instanceof w&&typeof j=="function"&&j instanceof j)&&(m=!1)}return s.delete(e),s.delete(t),m}var sO=iO,oO=ys,aO=An,lO=oO(aO,"DataView"),cO=lO,dO=ys,uO=An,hO=dO(uO,"Promise"),fO=hO,pO=ys,mO=An,gO=pO(mO,"Set"),vO=gO,yO=ys,xO=An,bO=yO(xO,"WeakMap"),wO=bO,Uh=cO,Wh=bp,Gh=fO,Vh=vO,qh=wO,Zw=vs,Bo=Ww,j0="[object Map]",_O="[object Object]",C0="[object Promise]",E0="[object Set]",T0="[object WeakMap]",N0="[object DataView]",SO=Bo(Uh),kO=Bo(Wh),jO=Bo(Gh),CO=Bo(Vh),EO=Bo(qh),Zi=Zw;(Uh&&Zi(new Uh(new ArrayBuffer(1)))!=N0||Wh&&Zi(new Wh)!=j0||Gh&&Zi(Gh.resolve())!=C0||Vh&&Zi(new Vh)!=E0||qh&&Zi(new qh)!=T0)&&(Zi=function(e){var t=Zw(e),r=t==_O?e.constructor:void 0,n=r?Bo(r):"";if(n)switch(n){case SO:return N0;case kO:return j0;case jO:return C0;case CO:return E0;case EO:return T0}return t});var kd=Zi,Eu=_p,TO=Gw,NO=D3,PO=sO,P0=kd,R0=hn,O0=hp,RO=Lw,OO=1,A0="[object Arguments]",M0="[object Array]",Yl="[object Object]",AO=Object.prototype,$0=AO.hasOwnProperty;function MO(e,t,r,n,i,s){var a=R0(e),l=R0(t),c=a?M0:P0(e),d=l?M0:P0(t);c=c==A0?Yl:c,d=d==A0?Yl:d;var u=c==Yl,f=d==Yl,h=c==d;if(h&&O0(e)){if(!O0(t))return!1;a=!0,u=!1}if(h&&!u)return s||(s=new Eu),a||RO(e)?TO(e,t,r,n,i,s):NO(e,t,c,r,n,i,s);if(!(r&OO)){var p=u&&$0.call(e,"__wrapped__"),g=f&&$0.call(t,"__wrapped__");if(p||g){var m=p?e.value():e,x=g?t.value():t;return s||(s=new Eu),i(m,x,r,n,s)}}return h?(s||(s=new Eu),PO(e,t,r,n,i,s)):!1}var $O=MO,LO=$O,L0=Qn;function Jw(e,t,r,n,i){return e===t?!0:e==null||t==null||!L0(e)&&!L0(t)?e!==e&&t!==t:LO(e,t,r,n,Jw,i)}var Qw=Jw,IO=_p,DO=Qw,zO=1,FO=2;function BO(e,t,r,n){var i=r.length,s=i,a=!n;if(e==null)return!s;for(e=Object(e);i--;){var l=r[i];if(a&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++i<s;){l=r[i];var c=l[0],d=e[c],u=l[1];if(a&&l[2]){if(d===void 0&&!(c in e))return!1}else{var f=new IO;if(n)var h=n(d,u,c,e,t,f);if(!(h===void 0?DO(u,d,zO|FO,n,f):h))return!1}}return!0}var HO=BO,UO=Lo;function WO(e){return e===e&&!UO(e)}var e1=WO,GO=e1,VO=ul;function qO(e){for(var t=VO(e),r=t.length;r--;){var n=t[r],i=e[n];t[r]=[n,i,GO(i)]}return t}var YO=qO;function XO(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var t1=XO,KO=HO,ZO=YO,JO=t1;function QO(e){var t=ZO(e);return t.length==1&&t[0][2]?JO(t[0][0],t[0][1]):function(r){return r===e||KO(r,e,t)}}var eA=QO,tA=vs,rA=Qn,nA="[object Symbol]";function iA(e){return typeof e=="symbol"||rA(e)&&tA(e)==nA}var kp=iA,sA=hn,oA=kp,aA=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,lA=/^\w*$/;function cA(e,t){if(sA(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||oA(e)?!0:lA.test(e)||!aA.test(e)||t!=null&&e in Object(t)}var jp=cA,r1=wp,dA="Expected a function";function Cp(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(dA);var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],s=r.cache;if(s.has(i))return s.get(i);var a=e.apply(this,n);return r.cache=s.set(i,a)||s,a};return r.cache=new(Cp.Cache||r1),r}Cp.Cache=r1;var uA=Cp,hA=uA,fA=500;function pA(e){var t=hA(e,function(n){return r.size===fA&&r.clear(),n}),r=t.cache;return t}var mA=pA,gA=mA,vA=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,yA=/\\(\\)?/g,xA=gA(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(vA,function(r,n,i,s){t.push(i?s.replace(yA,"$1"):n||r)}),t}),bA=xA,I0=dl,wA=Uw,_A=hn,SA=kp,D0=I0?I0.prototype:void 0,z0=D0?D0.toString:void 0;function n1(e){if(typeof e=="string")return e;if(_A(e))return wA(e,n1)+"";if(SA(e))return z0?z0.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var kA=n1,jA=kA;function CA(e){return e==null?"":jA(e)}var EA=CA,TA=hn,NA=jp,PA=bA,RA=EA;function OA(e,t){return TA(e)?e:NA(e,t)?[e]:PA(RA(e))}var i1=OA,AA=kp;function MA(e){if(typeof e=="string"||AA(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var jd=MA,$A=i1,LA=jd;function IA(e,t){t=$A(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[LA(t[r++])];return r&&r==n?e:void 0}var s1=IA,DA=s1;function zA(e,t,r){var n=e==null?void 0:DA(e,t);return n===void 0?r:n}var FA=zA;function BA(e,t){return e!=null&&t in Object(e)}var HA=BA,UA=i1,WA=Mw,GA=hn,VA=$w,qA=fp,YA=jd;function XA(e,t,r){t=UA(t,e);for(var n=-1,i=t.length,s=!1;++n<i;){var a=YA(t[n]);if(!(s=e!=null&&r(e,a)))break;e=e[a]}return s||++n!=i?s:(i=e==null?0:e.length,!!i&&qA(i)&&VA(a,i)&&(GA(e)||WA(e)))}var KA=XA,ZA=HA,JA=KA;function QA(e,t){return e!=null&&JA(e,t,ZA)}var e4=QA,t4=Qw,r4=FA,n4=e4,i4=jp,s4=e1,o4=t1,a4=jd,l4=1,c4=2;function d4(e,t){return i4(e)&&s4(t)?o4(a4(e),t):function(r){var n=r4(r,e);return n===void 0&&n===t?n4(r,e):t4(t,n,l4|c4)}}var u4=d4;function h4(e){return function(t){return t==null?void 0:t[e]}}var f4=h4,p4=s1;function m4(e){return function(t){return p4(t,e)}}var g4=m4,v4=f4,y4=g4,x4=jp,b4=jd;function w4(e){return x4(e)?v4(b4(e)):y4(e)}var _4=w4,S4=eA,k4=u4,j4=Bw,C4=hn,E4=_4;function T4(e){return typeof e=="function"?e:e==null?j4:typeof e=="object"?C4(e)?k4(e[0],e[1]):S4(e):E4(e)}var N4=T4,P4=xd;function R4(e,t){return function(r,n){if(r==null)return r;if(!P4(r))return e(r,n);for(var i=r.length,s=t?i:-1,a=Object(r);(t?s--:++s<i)&&n(a[s],s,a)!==!1;);return r}}var O4=R4,A4=Fw,M4=O4,$4=M4(A4),L4=$4,I4=L4,D4=xd;function z4(e,t){var r=-1,n=D4(e)?Array(e.length):[];return I4(e,function(i,s,a){n[++r]=t(i,s,a)}),n}var F4=z4,B4=Uw,H4=N4,U4=F4,W4=hn;function G4(e,t){var r=W4(e)?B4:U4;return r(e,H4(t))}var V4=G4;Object.defineProperty(cl,"__esModule",{value:!0});cl.flattenNames=void 0;var q4=S5,Y4=Cd(q4),X4=vp,K4=Cd(X4),Z4=NN,J4=Cd(Z4),Q4=V4,eM=Cd(Q4);function Cd(e){return e&&e.__esModule?e:{default:e}}var tM=cl.flattenNames=function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=[];return(0,eM.default)(t,function(n){Array.isArray(n)?e(n).map(function(i){return r.push(i)}):(0,J4.default)(n)?(0,K4.default)(n,function(i,s){i===!0&&r.push(s),r.push(s+"-"+i)}):(0,Y4.default)(n)&&r.push(n)}),r};cl.default=tM;var hl={};function rM(e,t){for(var r=-1,n=e==null?0:e.length;++r<n&&t(e[r],r,e)!==!1;);return e}var nM=rM,iM=ys,sM=function(){try{var e=iM(Object,"defineProperty");return e({},"",{}),e}catch{}}(),oM=sM,F0=oM;function aM(e,t,r){t=="__proto__"&&F0?F0(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var o1=aM,lM=o1,cM=xp,dM=Object.prototype,uM=dM.hasOwnProperty;function hM(e,t,r){var n=e[t];(!(uM.call(e,t)&&cM(n,r))||r===void 0&&!(t in e))&&lM(e,t,r)}var a1=hM,fM=a1,pM=o1;function mM(e,t,r,n){var i=!r;r||(r={});for(var s=-1,a=t.length;++s<a;){var l=t[s],c=n?n(r[l],e[l],l,r,e):void 0;c===void 0&&(c=e[l]),i?pM(r,l,c):fM(r,l,c)}return r}var Ed=mM,gM=Ed,vM=ul;function yM(e,t){return e&&gM(t,vM(t),e)}var xM=yM;function bM(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}var wM=bM,_M=Lo,SM=gp,kM=wM,jM=Object.prototype,CM=jM.hasOwnProperty;function EM(e){if(!_M(e))return kM(e);var t=SM(e),r=[];for(var n in e)n=="constructor"&&(t||!CM.call(e,n))||r.push(n);return r}var TM=EM,NM=Iw,PM=TM,RM=xd;function OM(e){return RM(e)?NM(e,!0):PM(e)}var Ep=OM,AM=Ed,MM=Ep;function $M(e,t){return e&&AM(t,MM(t),e)}var LM=$M,Vc={exports:{}};Vc.exports;(function(e,t){var r=An,n=t&&!t.nodeType&&t,i=n&&!0&&e&&!e.nodeType&&e,s=i&&i.exports===n,a=s?r.Buffer:void 0,l=a?a.allocUnsafe:void 0;function c(d,u){if(u)return d.slice();var f=d.length,h=l?l(f):new d.constructor(f);return d.copy(h),h}e.exports=c})(Vc,Vc.exports);var IM=Vc.exports;function DM(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}var zM=DM,FM=Ed,BM=Sp;function HM(e,t){return FM(e,BM(e),t)}var UM=HM,WM=qw,GM=yp,VM=Sp,qM=Xw,YM=Object.getOwnPropertySymbols,XM=YM?function(e){for(var t=[];e;)WM(t,VM(e)),e=GM(e);return t}:qM,l1=XM,KM=Ed,ZM=l1;function JM(e,t){return KM(e,ZM(e),t)}var QM=JM,e6=Yw,t6=l1,r6=Ep;function n6(e){return e6(e,r6,t6)}var i6=n6,s6=Object.prototype,o6=s6.hasOwnProperty;function a6(e){var t=e.length,r=new e.constructor(t);return t&&typeof e[0]=="string"&&o6.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var l6=a6,B0=Vw;function c6(e){var t=new e.constructor(e.byteLength);return new B0(t).set(new B0(e)),t}var Tp=c6,d6=Tp;function u6(e,t){var r=t?d6(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}var h6=u6,f6=/\w*$/;function p6(e){var t=new e.constructor(e.source,f6.exec(e));return t.lastIndex=e.lastIndex,t}var m6=p6,H0=dl,U0=H0?H0.prototype:void 0,W0=U0?U0.valueOf:void 0;function g6(e){return W0?Object(W0.call(e)):{}}var v6=g6,y6=Tp;function x6(e,t){var r=t?y6(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var b6=x6,w6=Tp,_6=h6,S6=m6,k6=v6,j6=b6,C6="[object Boolean]",E6="[object Date]",T6="[object Map]",N6="[object Number]",P6="[object RegExp]",R6="[object Set]",O6="[object String]",A6="[object Symbol]",M6="[object ArrayBuffer]",$6="[object DataView]",L6="[object Float32Array]",I6="[object Float64Array]",D6="[object Int8Array]",z6="[object Int16Array]",F6="[object Int32Array]",B6="[object Uint8Array]",H6="[object Uint8ClampedArray]",U6="[object Uint16Array]",W6="[object Uint32Array]";function G6(e,t,r){var n=e.constructor;switch(t){case M6:return w6(e);case C6:case E6:return new n(+e);case $6:return _6(e,r);case L6:case I6:case D6:case z6:case F6:case B6:case H6:case U6:case W6:return j6(e,r);case T6:return new n;case N6:case O6:return new n(e);case P6:return S6(e);case R6:return new n;case A6:return k6(e)}}var V6=G6,q6=Lo,G0=Object.create,Y6=function(){function e(){}return function(t){if(!q6(t))return{};if(G0)return G0(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),X6=Y6,K6=X6,Z6=yp,J6=gp;function Q6(e){return typeof e.constructor=="function"&&!J6(e)?K6(Z6(e)):{}}var e$=Q6,t$=kd,r$=Qn,n$="[object Map]";function i$(e){return r$(e)&&t$(e)==n$}var s$=i$,o$=s$,a$=pp,V0=mp,q0=V0&&V0.isMap,l$=q0?a$(q0):o$,c$=l$,d$=kd,u$=Qn,h$="[object Set]";function f$(e){return u$(e)&&d$(e)==h$}var p$=f$,m$=p$,g$=pp,Y0=mp,X0=Y0&&Y0.isSet,v$=X0?g$(X0):m$,y$=v$,x$=_p,b$=nM,w$=a1,_$=xM,S$=LM,k$=IM,j$=zM,C$=UM,E$=QM,T$=Kw,N$=i6,P$=kd,R$=l6,O$=V6,A$=e$,M$=hn,$$=hp,L$=c$,I$=Lo,D$=y$,z$=ul,F$=Ep,B$=1,H$=2,U$=4,c1="[object Arguments]",W$="[object Array]",G$="[object Boolean]",V$="[object Date]",q$="[object Error]",d1="[object Function]",Y$="[object GeneratorFunction]",X$="[object Map]",K$="[object Number]",u1="[object Object]",Z$="[object RegExp]",J$="[object Set]",Q$="[object String]",eL="[object Symbol]",tL="[object WeakMap]",rL="[object ArrayBuffer]",nL="[object DataView]",iL="[object Float32Array]",sL="[object Float64Array]",oL="[object Int8Array]",aL="[object Int16Array]",lL="[object Int32Array]",cL="[object Uint8Array]",dL="[object Uint8ClampedArray]",uL="[object Uint16Array]",hL="[object Uint32Array]",ht={};ht[c1]=ht[W$]=ht[rL]=ht[nL]=ht[G$]=ht[V$]=ht[iL]=ht[sL]=ht[oL]=ht[aL]=ht[lL]=ht[X$]=ht[K$]=ht[u1]=ht[Z$]=ht[J$]=ht[Q$]=ht[eL]=ht[cL]=ht[dL]=ht[uL]=ht[hL]=!0;ht[q$]=ht[d1]=ht[tL]=!1;function dc(e,t,r,n,i,s){var a,l=t&B$,c=t&H$,d=t&U$;if(r&&(a=i?r(e,n,i,s):r(e)),a!==void 0)return a;if(!I$(e))return e;var u=M$(e);if(u){if(a=R$(e),!l)return j$(e,a)}else{var f=P$(e),h=f==d1||f==Y$;if($$(e))return k$(e,l);if(f==u1||f==c1||h&&!i){if(a=c||h?{}:A$(e),!l)return c?E$(e,S$(a,e)):C$(e,_$(a,e))}else{if(!ht[f])return i?e:{};a=O$(e,f,l)}}s||(s=new x$);var p=s.get(e);if(p)return p;s.set(e,a),D$(e)?e.forEach(function(x){a.add(dc(x,t,r,x,e,s))}):L$(e)&&e.forEach(function(x,v){a.set(v,dc(x,t,r,v,e,s))});var g=d?c?N$:T$:c?F$:z$,m=u?void 0:g(e);return b$(m||e,function(x,v){m&&(v=x,x=e[v]),w$(a,v,dc(x,t,r,v,e,s))}),a}var fL=dc,pL=fL,mL=1,gL=4;function vL(e){return pL(e,mL|gL)}var yL=vL;Object.defineProperty(hl,"__esModule",{value:!0});hl.mergeClasses=void 0;var xL=vp,bL=h1(xL),wL=yL,_L=h1(wL),SL=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};function h1(e){return e&&e.__esModule?e:{default:e}}var kL=hl.mergeClasses=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=t.default&&(0,_L.default)(t.default)||{};return r.map(function(i){var s=t[i];return s&&(0,bL.default)(s,function(a,l){n[l]||(n[l]={}),n[l]=SL({},n[l],s[l])}),i}),n};hl.default=kL;var fl={};Object.defineProperty(fl,"__esModule",{value:!0});fl.autoprefix=void 0;var jL=vp,K0=EL(jL),CL=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};function EL(e){return e&&e.__esModule?e:{default:e}}var TL={borderRadius:function(t){return{msBorderRadius:t,MozBorderRadius:t,OBorderRadius:t,WebkitBorderRadius:t,borderRadius:t}},boxShadow:function(t){return{msBoxShadow:t,MozBoxShadow:t,OBoxShadow:t,WebkitBoxShadow:t,boxShadow:t}},userSelect:function(t){return{WebkitTouchCallout:t,KhtmlUserSelect:t,MozUserSelect:t,msUserSelect:t,WebkitUserSelect:t,userSelect:t}},flex:function(t){return{WebkitBoxFlex:t,MozBoxFlex:t,WebkitFlex:t,msFlex:t,flex:t}},flexBasis:function(t){return{WebkitFlexBasis:t,flexBasis:t}},justifyContent:function(t){return{WebkitJustifyContent:t,justifyContent:t}},transition:function(t){return{msTransition:t,MozTransition:t,OTransition:t,WebkitTransition:t,transition:t}},transform:function(t){return{msTransform:t,MozTransform:t,OTransform:t,WebkitTransform:t,transform:t}},absolute:function(t){var r=t&&t.split(" ");return{position:"absolute",top:r&&r[0],right:r&&r[1],bottom:r&&r[2],left:r&&r[3]}},extend:function(t,r){var n=r[t];return n||{extend:t}}},NL=fl.autoprefix=function(t){var r={};return(0,K0.default)(t,function(n,i){var s={};(0,K0.default)(n,function(a,l){var c=TL[l];c?s=CL({},s,c(a)):s[l]=a}),r[i]=s}),r};fl.default=NL;var pl={};Object.defineProperty(pl,"__esModule",{value:!0});pl.hover=void 0;var PL=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},RL=A,Tu=OL(RL);function OL(e){return e&&e.__esModule?e:{default:e}}function AL(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Z0(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e}function ML(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var $L=pl.hover=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"span";return function(n){ML(i,n);function i(){var s,a,l,c;AL(this,i);for(var d=arguments.length,u=Array(d),f=0;f<d;f++)u[f]=arguments[f];return c=(a=(l=Z0(this,(s=i.__proto__||Object.getPrototypeOf(i)).call.apply(s,[this].concat(u))),l),l.state={hover:!1},l.handleMouseOver=function(){return l.setState({hover:!0})},l.handleMouseOut=function(){return l.setState({hover:!1})},l.render=function(){return Tu.default.createElement(r,{onMouseOver:l.handleMouseOver,onMouseOut:l.handleMouseOut},Tu.default.createElement(t,PL({},l.props,l.state)))},a),Z0(l,c)}return i}(Tu.default.Component)};pl.default=$L;var ml={};Object.defineProperty(ml,"__esModule",{value:!0});ml.active=void 0;var LL=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},IL=A,Nu=DL(IL);function DL(e){return e&&e.__esModule?e:{default:e}}function zL(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function J0(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e}function FL(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var BL=ml.active=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"span";return function(n){FL(i,n);function i(){var s,a,l,c;zL(this,i);for(var d=arguments.length,u=Array(d),f=0;f<d;f++)u[f]=arguments[f];return c=(a=(l=J0(this,(s=i.__proto__||Object.getPrototypeOf(i)).call.apply(s,[this].concat(u))),l),l.state={active:!1},l.handleMouseDown=function(){return l.setState({active:!0})},l.handleMouseUp=function(){return l.setState({active:!1})},l.render=function(){return Nu.default.createElement(r,{onMouseDown:l.handleMouseDown,onMouseUp:l.handleMouseUp},Nu.default.createElement(t,LL({},l.props,l.state)))},a),J0(l,c)}return i}(Nu.default.Component)};ml.default=BL;var Np={};Object.defineProperty(Np,"__esModule",{value:!0});var HL=function(t,r){var n={},i=function(a){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;n[a]=l};return t===0&&i("first-child"),t===r-1&&i("last-child"),(t===0||t%2===0)&&i("even"),Math.abs(t%2)===1&&i("odd"),i("nth-child",t),n};Np.default=HL;Object.defineProperty(Ur,"__esModule",{value:!0});Ur.ReactCSS=Ur.loop=Ur.handleActive=Pp=Ur.handleHover=Ur.hover=void 0;var UL=cl,WL=Ho(UL),GL=hl,VL=Ho(GL),qL=fl,YL=Ho(qL),XL=pl,f1=Ho(XL),KL=ml,ZL=Ho(KL),JL=Np,QL=Ho(JL);function Ho(e){return e&&e.__esModule?e:{default:e}}Ur.hover=f1.default;var Pp=Ur.handleHover=f1.default;Ur.handleActive=ZL.default;Ur.loop=QL.default;var eI=Ur.ReactCSS=function(t){for(var r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];var s=(0,WL.default)(n),a=(0,VL.default)(t,s);return(0,YL.default)(a)},Ye=Ur.default=eI,tI=function(t,r,n,i,s){var a=s.clientWidth,l=s.clientHeight,c=typeof t.pageX=="number"?t.pageX:t.touches[0].pageX,d=typeof t.pageY=="number"?t.pageY:t.touches[0].pageY,u=c-(s.getBoundingClientRect().left+window.pageXOffset),f=d-(s.getBoundingClientRect().top+window.pageYOffset);if(n==="vertical"){var h=void 0;if(f<0?h=0:f>l?h=1:h=Math.round(f*100/l)/100,r.a!==h)return{h:r.h,s:r.s,l:r.l,a:h,source:"rgb"}}else{var p=void 0;if(u<0?p=0:u>a?p=1:p=Math.round(u*100/a)/100,i!==p)return{h:r.h,s:r.s,l:r.l,a:p,source:"rgb"}}return null},Pu={},rI=function(t,r,n,i){if(typeof document>"u"&&!i)return null;var s=i?new i:document.createElement("canvas");s.width=n*2,s.height=n*2;var a=s.getContext("2d");return a?(a.fillStyle=t,a.fillRect(0,0,s.width,s.height),a.fillStyle=r,a.fillRect(0,0,n,n),a.translate(n,n),a.fillRect(0,0,n,n),s.toDataURL()):null},nI=function(t,r,n,i){var s=t+"-"+r+"-"+n+(i?"-server":"");if(Pu[s])return Pu[s];var a=rI(t,r,n,i);return Pu[s]=a,a},Q0=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Uo=function(t){var r=t.white,n=t.grey,i=t.size,s=t.renderers,a=t.borderRadius,l=t.boxShadow,c=t.children,d=Ye({default:{grid:{borderRadius:a,boxShadow:l,absolute:"0px 0px 0px 0px",background:"url("+nI(r,n,i,s.canvas)+") center left"}}});return A.isValidElement(c)?D.cloneElement(c,Q0({},c.props,{style:Q0({},c.props.style,d.grid)})):D.createElement("div",{style:d.grid})};Uo.defaultProps={size:8,white:"transparent",grey:"rgba(0,0,0,.08)",renderers:{}};var iI=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sI=function(){function e(t,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function oI(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ev(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e}function aI(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var Rp=function(e){aI(t,e);function t(){var r,n,i,s;oI(this,t);for(var a=arguments.length,l=Array(a),c=0;c<a;c++)l[c]=arguments[c];return s=(n=(i=ev(this,(r=t.__proto__||Object.getPrototypeOf(t)).call.apply(r,[this].concat(l))),i),i.handleChange=function(d){var u=tI(d,i.props.hsl,i.props.direction,i.props.a,i.container);u&&typeof i.props.onChange=="function"&&i.props.onChange(u,d)},i.handleMouseDown=function(d){i.handleChange(d),window.addEventListener("mousemove",i.handleChange),window.addEventListener("mouseup",i.handleMouseUp)},i.handleMouseUp=function(){i.unbindEventListeners()},i.unbindEventListeners=function(){window.removeEventListener("mousemove",i.handleChange),window.removeEventListener("mouseup",i.handleMouseUp)},n),ev(i,s)}return sI(t,[{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"render",value:function(){var n=this,i=this.props.rgb,s=Ye({default:{alpha:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius},checkboard:{absolute:"0px 0px 0px 0px",overflow:"hidden",borderRadius:this.props.radius},gradient:{absolute:"0px 0px 0px 0px",background:"linear-gradient(to right, rgba("+i.r+","+i.g+","+i.b+`, 0) 0%,
           rgba(`+i.r+","+i.g+","+i.b+", 1) 100%)",boxShadow:this.props.shadow,borderRadius:this.props.radius},container:{position:"relative",height:"100%",margin:"0 3px"},pointer:{position:"absolute",left:i.a*100+"%"},slider:{width:"4px",borderRadius:"1px",height:"8px",boxShadow:"0 0 2px rgba(0, 0, 0, .6)",background:"#fff",marginTop:"1px",transform:"translateX(-2px)"}},vertical:{gradient:{background:"linear-gradient(to bottom, rgba("+i.r+","+i.g+","+i.b+`, 0) 0%,
           rgba(`+i.r+","+i.g+","+i.b+", 1) 100%)"},pointer:{left:0,top:i.a*100+"%"}},overwrite:iI({},this.props.style)},{vertical:this.props.direction==="vertical",overwrite:!0});return D.createElement("div",{style:s.alpha},D.createElement("div",{style:s.checkboard},D.createElement(Uo,{renderers:this.props.renderers})),D.createElement("div",{style:s.gradient}),D.createElement("div",{style:s.container,ref:function(l){return n.container=l},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},D.createElement("div",{style:s.pointer},this.props.pointer?D.createElement(this.props.pointer,this.props):D.createElement("div",{style:s.slider}))))}}]),t}(A.PureComponent||A.Component),lI=function(){function e(t,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function cI(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dI(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uI(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e}function hI(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var fI=1,p1=38,pI=40,mI=[p1,pI],gI=function(t){return mI.indexOf(t)>-1},vI=function(t){return Number(String(t).replace(/%/g,""))},yI=1,it=function(e){hI(t,e);function t(r){dI(this,t);var n=uI(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.handleBlur=function(){n.state.blurValue&&n.setState({value:n.state.blurValue,blurValue:null})},n.handleChange=function(i){n.setUpdatedValue(i.target.value,i)},n.handleKeyDown=function(i){var s=vI(i.target.value);if(!isNaN(s)&&gI(i.keyCode)){var a=n.getArrowOffset(),l=i.keyCode===p1?s+a:s-a;n.setUpdatedValue(l,i)}},n.handleDrag=function(i){if(n.props.dragLabel){var s=Math.round(n.props.value+i.movementX);s>=0&&s<=n.props.dragMax&&n.props.onChange&&n.props.onChange(n.getValueObjectWithLabel(s),i)}},n.handleMouseDown=function(i){n.props.dragLabel&&(i.preventDefault(),n.handleDrag(i),window.addEventListener("mousemove",n.handleDrag),window.addEventListener("mouseup",n.handleMouseUp))},n.handleMouseUp=function(){n.unbindEventListeners()},n.unbindEventListeners=function(){window.removeEventListener("mousemove",n.handleDrag),window.removeEventListener("mouseup",n.handleMouseUp)},n.state={value:String(r.value).toUpperCase(),blurValue:String(r.value).toUpperCase()},n.inputId="rc-editable-input-"+yI++,n}return lI(t,[{key:"componentDidUpdate",value:function(n,i){this.props.value!==this.state.value&&(n.value!==this.props.value||i.value!==this.state.value)&&(this.input===document.activeElement?this.setState({blurValue:String(this.props.value).toUpperCase()}):this.setState({value:String(this.props.value).toUpperCase(),blurValue:!this.state.blurValue&&String(this.props.value).toUpperCase()}))}},{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"getValueObjectWithLabel",value:function(n){return cI({},this.props.label,n)}},{key:"getArrowOffset",value:function(){return this.props.arrowOffset||fI}},{key:"setUpdatedValue",value:function(n,i){var s=this.props.label?this.getValueObjectWithLabel(n):n;this.props.onChange&&this.props.onChange(s,i),this.setState({value:n})}},{key:"render",value:function(){var n=this,i=Ye({default:{wrap:{position:"relative"}},"user-override":{wrap:this.props.style&&this.props.style.wrap?this.props.style.wrap:{},input:this.props.style&&this.props.style.input?this.props.style.input:{},label:this.props.style&&this.props.style.label?this.props.style.label:{}},"dragLabel-true":{label:{cursor:"ew-resize"}}},{"user-override":!0},this.props);return D.createElement("div",{style:i.wrap},D.createElement("input",{id:this.inputId,style:i.input,ref:function(a){return n.input=a},value:this.state.value,onKeyDown:this.handleKeyDown,onChange:this.handleChange,onBlur:this.handleBlur,placeholder:this.props.placeholder,spellCheck:"false"}),this.props.label&&!this.props.hideLabel?D.createElement("label",{htmlFor:this.inputId,style:i.label,onMouseDown:this.handleMouseDown},this.props.label):null)}}]),t}(A.PureComponent||A.Component),xI=function(t,r,n,i){var s=i.clientWidth,a=i.clientHeight,l=typeof t.pageX=="number"?t.pageX:t.touches[0].pageX,c=typeof t.pageY=="number"?t.pageY:t.touches[0].pageY,d=l-(i.getBoundingClientRect().left+window.pageXOffset),u=c-(i.getBoundingClientRect().top+window.pageYOffset);if(r==="vertical"){var f=void 0;if(u<0)f=359;else if(u>a)f=0;else{var h=-(u*100/a)+100;f=360*h/100}if(n.h!==f)return{h:f,s:n.s,l:n.l,a:n.a,source:"hsl"}}else{var p=void 0;if(d<0)p=0;else if(d>s)p=359;else{var g=d*100/s;p=360*g/100}if(n.h!==p)return{h:p,s:n.s,l:n.l,a:n.a,source:"hsl"}}return null},bI=function(){function e(t,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function wI(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tv(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e}function _I(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var Wo=function(e){_I(t,e);function t(){var r,n,i,s;wI(this,t);for(var a=arguments.length,l=Array(a),c=0;c<a;c++)l[c]=arguments[c];return s=(n=(i=tv(this,(r=t.__proto__||Object.getPrototypeOf(t)).call.apply(r,[this].concat(l))),i),i.handleChange=function(d){var u=xI(d,i.props.direction,i.props.hsl,i.container);u&&typeof i.props.onChange=="function"&&i.props.onChange(u,d)},i.handleMouseDown=function(d){i.handleChange(d),window.addEventListener("mousemove",i.handleChange),window.addEventListener("mouseup",i.handleMouseUp)},i.handleMouseUp=function(){i.unbindEventListeners()},n),tv(i,s)}return bI(t,[{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"unbindEventListeners",value:function(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}},{key:"render",value:function(){var n=this,i=this.props.direction,s=i===void 0?"horizontal":i,a=Ye({default:{hue:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius,boxShadow:this.props.shadow},container:{padding:"0 2px",position:"relative",height:"100%",borderRadius:this.props.radius},pointer:{position:"absolute",left:this.props.hsl.h*100/360+"%"},slider:{marginTop:"1px",width:"4px",borderRadius:"1px",height:"8px",boxShadow:"0 0 2px rgba(0, 0, 0, .6)",background:"#fff",transform:"translateX(-2px)"}},vertical:{pointer:{left:"0px",top:-(this.props.hsl.h*100/360)+100+"%"}}},{vertical:s==="vertical"});return D.createElement("div",{style:a.hue},D.createElement("div",{className:"hue-"+s,style:a.container,ref:function(c){return n.container=c},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},D.createElement("style",null,`
            .hue-horizontal {
              background: linear-gradient(to right, #f00 0%, #ff0 17%, #0f0
                33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
              background: -webkit-linear-gradient(to right, #f00 0%, #ff0
                17%, #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
            }

            .hue-vertical {
              background: linear-gradient(to top, #f00 0%, #ff0 17%, #0f0 33%,
                #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
              background: -webkit-linear-gradient(to top, #f00 0%, #ff0 17%,
                #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
            }
          `),D.createElement("div",{style:a.pointer},this.props.pointer?D.createElement(this.props.pointer,this.props):D.createElement("div",{style:a.slider}))))}}]),t}(A.PureComponent||A.Component),m1={exports:{}},SI="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",kI=SI,jI=kI;function g1(){}function v1(){}v1.resetWarningCache=g1;var CI=function(){function e(n,i,s,a,l,c){if(c!==jI){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:v1,resetWarningCache:g1};return r.PropTypes=r,r};m1.exports=CI();var EI=m1.exports;const Ee=Qc(EI);function TI(){this.__data__=[],this.size=0}function gl(e,t){return e===t||e!==e&&t!==t}function Td(e,t){for(var r=e.length;r--;)if(gl(e[r][0],t))return r;return-1}var NI=Array.prototype,PI=NI.splice;function RI(e){var t=this.__data__,r=Td(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():PI.call(t,r,1),--this.size,!0}function OI(e){var t=this.__data__,r=Td(t,e);return r<0?void 0:t[r][1]}function AI(e){return Td(this.__data__,e)>-1}function MI(e,t){var r=this.__data__,n=Td(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}function ei(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}ei.prototype.clear=TI;ei.prototype.delete=RI;ei.prototype.get=OI;ei.prototype.has=AI;ei.prototype.set=MI;function $I(){this.__data__=new ei,this.size=0}function LI(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}function II(e){return this.__data__.get(e)}function DI(e){return this.__data__.has(e)}var y1=typeof global=="object"&&global&&global.Object===Object&&global,zI=typeof self=="object"&&self&&self.Object===Object&&self,fn=y1||zI||Function("return this")(),Mi=fn.Symbol,x1=Object.prototype,FI=x1.hasOwnProperty,BI=x1.toString,aa=Mi?Mi.toStringTag:void 0;function HI(e){var t=FI.call(e,aa),r=e[aa];try{e[aa]=void 0;var n=!0}catch{}var i=BI.call(e);return n&&(t?e[aa]=r:delete e[aa]),i}var UI=Object.prototype,WI=UI.toString;function GI(e){return WI.call(e)}var VI="[object Null]",qI="[object Undefined]",rv=Mi?Mi.toStringTag:void 0;function xs(e){return e==null?e===void 0?qI:VI:rv&&rv in Object(e)?HI(e):GI(e)}function Yr(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var YI="[object AsyncFunction]",XI="[object Function]",KI="[object GeneratorFunction]",ZI="[object Proxy]";function Op(e){if(!Yr(e))return!1;var t=xs(e);return t==XI||t==KI||t==YI||t==ZI}var Ru=fn["__core-js_shared__"],nv=function(){var e=/[^.]+$/.exec(Ru&&Ru.keys&&Ru.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function JI(e){return!!nv&&nv in e}var QI=Function.prototype,eD=QI.toString;function bs(e){if(e!=null){try{return eD.call(e)}catch{}try{return e+""}catch{}}return""}var tD=/[\\^$.*+?()[\]{}|]/g,rD=/^\[object .+?Constructor\]$/,nD=Function.prototype,iD=Object.prototype,sD=nD.toString,oD=iD.hasOwnProperty,aD=RegExp("^"+sD.call(oD).replace(tD,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function lD(e){if(!Yr(e)||JI(e))return!1;var t=Op(e)?aD:rD;return t.test(bs(e))}function cD(e,t){return e==null?void 0:e[t]}function ws(e,t){var r=cD(e,t);return lD(r)?r:void 0}var el=ws(fn,"Map"),tl=ws(Object,"create");function dD(){this.__data__=tl?tl(null):{},this.size=0}function uD(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var hD="__lodash_hash_undefined__",fD=Object.prototype,pD=fD.hasOwnProperty;function mD(e){var t=this.__data__;if(tl){var r=t[e];return r===hD?void 0:r}return pD.call(t,e)?t[e]:void 0}var gD=Object.prototype,vD=gD.hasOwnProperty;function yD(e){var t=this.__data__;return tl?t[e]!==void 0:vD.call(t,e)}var xD="__lodash_hash_undefined__";function bD(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=tl&&t===void 0?xD:t,this}function ps(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}ps.prototype.clear=dD;ps.prototype.delete=uD;ps.prototype.get=mD;ps.prototype.has=yD;ps.prototype.set=bD;function wD(){this.size=0,this.__data__={hash:new ps,map:new(el||ei),string:new ps}}function _D(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function Nd(e,t){var r=e.__data__;return _D(t)?r[typeof t=="string"?"string":"hash"]:r.map}function SD(e){var t=Nd(this,e).delete(e);return this.size-=t?1:0,t}function kD(e){return Nd(this,e).get(e)}function jD(e){return Nd(this,e).has(e)}function CD(e,t){var r=Nd(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}function ti(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}ti.prototype.clear=wD;ti.prototype.delete=SD;ti.prototype.get=kD;ti.prototype.has=jD;ti.prototype.set=CD;var ED=200;function TD(e,t){var r=this.__data__;if(r instanceof ei){var n=r.__data__;if(!el||n.length<ED-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new ti(n)}return r.set(e,t),this.size=r.size,this}function On(e){var t=this.__data__=new ei(e);this.size=t.size}On.prototype.clear=$I;On.prototype.delete=LI;On.prototype.get=II;On.prototype.has=DI;On.prototype.set=TD;var qc=function(){try{var e=ws(Object,"defineProperty");return e({},"",{}),e}catch{}}();function Ap(e,t,r){t=="__proto__"&&qc?qc(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}function Yh(e,t,r){(r!==void 0&&!gl(e[t],r)||r===void 0&&!(t in e))&&Ap(e,t,r)}function ND(e){return function(t,r,n){for(var i=-1,s=Object(t),a=n(t),l=a.length;l--;){var c=a[++i];if(r(s[c],c,s)===!1)break}return t}}var b1=ND(),w1=typeof Pr=="object"&&Pr&&!Pr.nodeType&&Pr,iv=w1&&typeof Rr=="object"&&Rr&&!Rr.nodeType&&Rr,PD=iv&&iv.exports===w1,sv=PD?fn.Buffer:void 0;sv&&sv.allocUnsafe;function RD(e,t){return e.slice()}var Yc=fn.Uint8Array;function OD(e){var t=new e.constructor(e.byteLength);return new Yc(t).set(new Yc(e)),t}function AD(e,t){var r=OD(e.buffer);return new e.constructor(r,e.byteOffset,e.length)}function MD(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}var ov=Object.create,$D=function(){function e(){}return function(t){if(!Yr(t))return{};if(ov)return ov(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();function _1(e,t){return function(r){return e(t(r))}}var S1=_1(Object.getPrototypeOf,Object),LD=Object.prototype;function Mp(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||LD;return e===r}function ID(e){return typeof e.constructor=="function"&&!Mp(e)?$D(S1(e)):{}}function $i(e){return e!=null&&typeof e=="object"}var DD="[object Arguments]";function av(e){return $i(e)&&xs(e)==DD}var k1=Object.prototype,zD=k1.hasOwnProperty,FD=k1.propertyIsEnumerable,Xc=av(function(){return arguments}())?av:function(e){return $i(e)&&zD.call(e,"callee")&&!FD.call(e,"callee")},Mr=Array.isArray,BD=9007199254740991;function $p(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=BD}function Go(e){return e!=null&&$p(e.length)&&!Op(e)}function HD(e){return $i(e)&&Go(e)}function UD(){return!1}var j1=typeof Pr=="object"&&Pr&&!Pr.nodeType&&Pr,lv=j1&&typeof Rr=="object"&&Rr&&!Rr.nodeType&&Rr,WD=lv&&lv.exports===j1,cv=WD?fn.Buffer:void 0,GD=cv?cv.isBuffer:void 0,Kc=GD||UD,VD="[object Object]",qD=Function.prototype,YD=Object.prototype,C1=qD.toString,XD=YD.hasOwnProperty,KD=C1.call(Object);function ZD(e){if(!$i(e)||xs(e)!=VD)return!1;var t=S1(e);if(t===null)return!0;var r=XD.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&C1.call(r)==KD}var JD="[object Arguments]",QD="[object Array]",e8="[object Boolean]",t8="[object Date]",r8="[object Error]",n8="[object Function]",i8="[object Map]",s8="[object Number]",o8="[object Object]",a8="[object RegExp]",l8="[object Set]",c8="[object String]",d8="[object WeakMap]",u8="[object ArrayBuffer]",h8="[object DataView]",f8="[object Float32Array]",p8="[object Float64Array]",m8="[object Int8Array]",g8="[object Int16Array]",v8="[object Int32Array]",y8="[object Uint8Array]",x8="[object Uint8ClampedArray]",b8="[object Uint16Array]",w8="[object Uint32Array]",xt={};xt[f8]=xt[p8]=xt[m8]=xt[g8]=xt[v8]=xt[y8]=xt[x8]=xt[b8]=xt[w8]=!0;xt[JD]=xt[QD]=xt[u8]=xt[e8]=xt[h8]=xt[t8]=xt[r8]=xt[n8]=xt[i8]=xt[s8]=xt[o8]=xt[a8]=xt[l8]=xt[c8]=xt[d8]=!1;function _8(e){return $i(e)&&$p(e.length)&&!!xt[xs(e)]}function S8(e){return function(t){return e(t)}}var E1=typeof Pr=="object"&&Pr&&!Pr.nodeType&&Pr,Oa=E1&&typeof Rr=="object"&&Rr&&!Rr.nodeType&&Rr,k8=Oa&&Oa.exports===E1,Ou=k8&&y1.process,dv=function(){try{var e=Oa&&Oa.require&&Oa.require("util").types;return e||Ou&&Ou.binding&&Ou.binding("util")}catch{}}(),uv=dv&&dv.isTypedArray,Lp=uv?S8(uv):_8;function Xh(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var j8=Object.prototype,C8=j8.hasOwnProperty;function E8(e,t,r){var n=e[t];(!(C8.call(e,t)&&gl(n,r))||r===void 0&&!(t in e))&&Ap(e,t,r)}function T8(e,t,r,n){var i=!r;r||(r={});for(var s=-1,a=t.length;++s<a;){var l=t[s],c=void 0;c===void 0&&(c=e[l]),i?Ap(r,l,c):E8(r,l,c)}return r}function N8(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var P8=9007199254740991,R8=/^(?:0|[1-9]\d*)$/;function Ip(e,t){var r=typeof e;return t=t??P8,!!t&&(r=="number"||r!="symbol"&&R8.test(e))&&e>-1&&e%1==0&&e<t}var O8=Object.prototype,A8=O8.hasOwnProperty;function T1(e,t){var r=Mr(e),n=!r&&Xc(e),i=!r&&!n&&Kc(e),s=!r&&!n&&!i&&Lp(e),a=r||n||i||s,l=a?N8(e.length,String):[],c=l.length;for(var d in e)(t||A8.call(e,d))&&!(a&&(d=="length"||i&&(d=="offset"||d=="parent")||s&&(d=="buffer"||d=="byteLength"||d=="byteOffset")||Ip(d,c)))&&l.push(d);return l}function M8(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}var $8=Object.prototype,L8=$8.hasOwnProperty;function I8(e){if(!Yr(e))return M8(e);var t=Mp(e),r=[];for(var n in e)n=="constructor"&&(t||!L8.call(e,n))||r.push(n);return r}function N1(e){return Go(e)?T1(e,!0):I8(e)}function D8(e){return T8(e,N1(e))}function z8(e,t,r,n,i,s,a){var l=Xh(e,r),c=Xh(t,r),d=a.get(c);if(d){Yh(e,r,d);return}var u=s?s(l,c,r+"",e,t,a):void 0,f=u===void 0;if(f){var h=Mr(c),p=!h&&Kc(c),g=!h&&!p&&Lp(c);u=c,h||p||g?Mr(l)?u=l:HD(l)?u=MD(l):p?(f=!1,u=RD(c)):g?(f=!1,u=AD(c)):u=[]:ZD(c)||Xc(c)?(u=l,Xc(l)?u=D8(l):(!Yr(l)||Op(l))&&(u=ID(c))):f=!1}f&&(a.set(c,u),i(u,c,n,s,a),a.delete(c)),Yh(e,r,u)}function P1(e,t,r,n,i){e!==t&&b1(t,function(s,a){if(i||(i=new On),Yr(s))z8(e,t,a,r,P1,n,i);else{var l=n?n(Xh(e,a),s,a+"",e,t,i):void 0;l===void 0&&(l=s),Yh(e,a,l)}},N1)}function Pd(e){return e}function F8(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var hv=Math.max;function B8(e,t,r){return t=hv(t===void 0?e.length-1:t,0),function(){for(var n=arguments,i=-1,s=hv(n.length-t,0),a=Array(s);++i<s;)a[i]=n[t+i];i=-1;for(var l=Array(t+1);++i<t;)l[i]=n[i];return l[t]=r(a),F8(e,this,l)}}function H8(e){return function(){return e}}var U8=qc?function(e,t){return qc(e,"toString",{configurable:!0,enumerable:!1,value:H8(t),writable:!0})}:Pd,W8=800,G8=16,V8=Date.now;function q8(e){var t=0,r=0;return function(){var n=V8(),i=G8-(n-r);if(r=n,i>0){if(++t>=W8)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var Y8=q8(U8);function X8(e,t){return Y8(B8(e,t,Pd),e+"")}function K8(e,t,r){if(!Yr(r))return!1;var n=typeof t;return(n=="number"?Go(r)&&Ip(t,r.length):n=="string"&&t in r)?gl(r[t],e):!1}function Z8(e){return X8(function(t,r){var n=-1,i=r.length,s=i>1?r[i-1]:void 0,a=i>2?r[2]:void 0;for(s=e.length>3&&typeof s=="function"?(i--,s):void 0,a&&K8(r[0],r[1],a)&&(s=i<3?void 0:s,i=1),t=Object(t);++n<i;){var l=r[n];l&&e(t,l,n,s)}return t})}var xr=Z8(function(e,t,r){P1(e,t,r)}),vl=function(t){var r=t.zDepth,n=t.radius,i=t.background,s=t.children,a=t.styles,l=a===void 0?{}:a,c=Ye(xr({default:{wrap:{position:"relative",display:"inline-block"},content:{position:"relative"},bg:{absolute:"0px 0px 0px 0px",boxShadow:"0 "+r+"px "+r*4+"px rgba(0,0,0,.24)",borderRadius:n,background:i}},"zDepth-0":{bg:{boxShadow:"none"}},"zDepth-1":{bg:{boxShadow:"0 2px 10px rgba(0,0,0,.12), 0 2px 5px rgba(0,0,0,.16)"}},"zDepth-2":{bg:{boxShadow:"0 6px 20px rgba(0,0,0,.19), 0 8px 17px rgba(0,0,0,.2)"}},"zDepth-3":{bg:{boxShadow:"0 17px 50px rgba(0,0,0,.19), 0 12px 15px rgba(0,0,0,.24)"}},"zDepth-4":{bg:{boxShadow:"0 25px 55px rgba(0,0,0,.21), 0 16px 28px rgba(0,0,0,.22)"}},"zDepth-5":{bg:{boxShadow:"0 40px 77px rgba(0,0,0,.22), 0 27px 24px rgba(0,0,0,.2)"}},square:{bg:{borderRadius:"0"}},circle:{bg:{borderRadius:"50%"}}},l),{"zDepth-1":r===1});return D.createElement("div",{style:c.wrap},D.createElement("div",{style:c.bg}),D.createElement("div",{style:c.content},s))};vl.propTypes={background:Ee.string,zDepth:Ee.oneOf([0,1,2,3,4,5]),radius:Ee.number,styles:Ee.object};vl.defaultProps={background:"#fff",zDepth:1,radius:2,styles:{}};var Au=function(){return fn.Date.now()},J8=/\s/;function Q8(e){for(var t=e.length;t--&&J8.test(e.charAt(t)););return t}var ez=/^\s+/;function tz(e){return e&&e.slice(0,Q8(e)+1).replace(ez,"")}var rz="[object Symbol]";function Rd(e){return typeof e=="symbol"||$i(e)&&xs(e)==rz}var fv=NaN,nz=/^[-+]0x[0-9a-f]+$/i,iz=/^0b[01]+$/i,sz=/^0o[0-7]+$/i,oz=parseInt;function pv(e){if(typeof e=="number")return e;if(Rd(e))return fv;if(Yr(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Yr(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=tz(e);var r=iz.test(e);return r||sz.test(e)?oz(e.slice(2),r?2:8):nz.test(e)?fv:+e}var az="Expected a function",lz=Math.max,cz=Math.min;function R1(e,t,r){var n,i,s,a,l,c,d=0,u=!1,f=!1,h=!0;if(typeof e!="function")throw new TypeError(az);t=pv(t)||0,Yr(r)&&(u=!!r.leading,f="maxWait"in r,s=f?lz(pv(r.maxWait)||0,t):s,h="trailing"in r?!!r.trailing:h);function p(_){var E=n,N=i;return n=i=void 0,d=_,a=e.apply(N,E),a}function g(_){return d=_,l=setTimeout(v,t),u?p(_):a}function m(_){var E=_-c,N=_-d,O=t-E;return f?cz(O,s-N):O}function x(_){var E=_-c,N=_-d;return c===void 0||E>=t||E<0||f&&N>=s}function v(){var _=Au();if(x(_))return y(_);l=setTimeout(v,m(_))}function y(_){return l=void 0,h&&n?p(_):(n=i=void 0,a)}function b(){l!==void 0&&clearTimeout(l),d=0,n=c=i=l=void 0}function w(){return l===void 0?a:y(Au())}function j(){var _=Au(),E=x(_);if(n=arguments,i=this,c=_,E){if(l===void 0)return g(c);if(f)return clearTimeout(l),l=setTimeout(v,t),p(c)}return l===void 0&&(l=setTimeout(v,t)),a}return j.cancel=b,j.flush=w,j}var dz="Expected a function";function uz(e,t,r){var n=!0,i=!0;if(typeof e!="function")throw new TypeError(dz);return Yr(r)&&(n="leading"in r?!!r.leading:n,i="trailing"in r?!!r.trailing:i),R1(e,t,{leading:n,maxWait:t,trailing:i})}var hz=function(t,r,n){var i=n.getBoundingClientRect(),s=i.width,a=i.height,l=typeof t.pageX=="number"?t.pageX:t.touches[0].pageX,c=typeof t.pageY=="number"?t.pageY:t.touches[0].pageY,d=l-(n.getBoundingClientRect().left+window.pageXOffset),u=c-(n.getBoundingClientRect().top+window.pageYOffset);d<0?d=0:d>s&&(d=s),u<0?u=0:u>a&&(u=a);var f=d/s,h=1-u/a;return{h:r.h,s:f,v:h,a:r.a,source:"hsv"}},fz=function(){function e(t,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function pz(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mz(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e}function gz(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var Od=function(e){gz(t,e);function t(r){pz(this,t);var n=mz(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r));return n.handleChange=function(i){typeof n.props.onChange=="function"&&n.throttle(n.props.onChange,hz(i,n.props.hsl,n.container),i)},n.handleMouseDown=function(i){n.handleChange(i);var s=n.getContainerRenderWindow();s.addEventListener("mousemove",n.handleChange),s.addEventListener("mouseup",n.handleMouseUp)},n.handleMouseUp=function(){n.unbindEventListeners()},n.throttle=uz(function(i,s,a){i(s,a)},50),n}return fz(t,[{key:"componentWillUnmount",value:function(){this.throttle.cancel(),this.unbindEventListeners()}},{key:"getContainerRenderWindow",value:function(){for(var n=this.container,i=window;!i.document.contains(n)&&i.parent!==i;)i=i.parent;return i}},{key:"unbindEventListeners",value:function(){var n=this.getContainerRenderWindow();n.removeEventListener("mousemove",this.handleChange),n.removeEventListener("mouseup",this.handleMouseUp)}},{key:"render",value:function(){var n=this,i=this.props.style||{},s=i.color,a=i.white,l=i.black,c=i.pointer,d=i.circle,u=Ye({default:{color:{absolute:"0px 0px 0px 0px",background:"hsl("+this.props.hsl.h+",100%, 50%)",borderRadius:this.props.radius},white:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius},black:{absolute:"0px 0px 0px 0px",boxShadow:this.props.shadow,borderRadius:this.props.radius},pointer:{position:"absolute",top:-(this.props.hsv.v*100)+100+"%",left:this.props.hsv.s*100+"%",cursor:"default"},circle:{width:"4px",height:"4px",boxShadow:`0 0 0 1.5px #fff, inset 0 0 1px 1px rgba(0,0,0,.3),
            0 0 1px 2px rgba(0,0,0,.4)`,borderRadius:"50%",cursor:"hand",transform:"translate(-2px, -2px)"}},custom:{color:s,white:a,black:l,pointer:c,circle:d}},{custom:!!this.props.style});return D.createElement("div",{style:u.color,ref:function(h){return n.container=h},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},D.createElement("style",null,`
          .saturation-white {
            background: -webkit-linear-gradient(to right, #fff, rgba(255,255,255,0));
            background: linear-gradient(to right, #fff, rgba(255,255,255,0));
          }
          .saturation-black {
            background: -webkit-linear-gradient(to top, #000, rgba(0,0,0,0));
            background: linear-gradient(to top, #000, rgba(0,0,0,0));
          }
        `),D.createElement("div",{style:u.white,className:"saturation-white"},D.createElement("div",{style:u.black,className:"saturation-black"}),D.createElement("div",{style:u.pointer},this.props.pointer?D.createElement(this.props.pointer,this.props):D.createElement("div",{style:u.circle}))))}}]),t}(A.PureComponent||A.Component);function vz(e,t){for(var r=-1,n=e==null?0:e.length;++r<n&&t(e[r],r,e)!==!1;);return e}var yz=_1(Object.keys,Object),xz=Object.prototype,bz=xz.hasOwnProperty;function wz(e){if(!Mp(e))return yz(e);var t=[];for(var r in Object(e))bz.call(e,r)&&r!="constructor"&&t.push(r);return t}function Dp(e){return Go(e)?T1(e):wz(e)}function _z(e,t){return e&&b1(e,t,Dp)}function Sz(e,t){return function(r,n){if(r==null)return r;if(!Go(r))return e(r,n);for(var i=r.length,s=-1,a=Object(r);++s<i&&n(a[s],s,a)!==!1;);return r}}var O1=Sz(_z);function kz(e){return typeof e=="function"?e:Pd}function jz(e,t){var r=Mr(e)?vz:O1;return r(e,kz(t))}function Zc(e){"@babel/helpers - typeof";return Zc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zc(e)}var Cz=/^\s+/,Ez=/\s+$/;function Ie(e,t){if(e=e||"",t=t||{},e instanceof Ie)return e;if(!(this instanceof Ie))return new Ie(e,t);var r=Tz(e);this._originalInput=e,this._r=r.r,this._g=r.g,this._b=r.b,this._a=r.a,this._roundA=Math.round(100*this._a)/100,this._format=t.format||r.format,this._gradientType=t.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=r.ok}Ie.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var t=this.toRgb();return(t.r*299+t.g*587+t.b*114)/1e3},getLuminance:function(){var t=this.toRgb(),r,n,i,s,a,l;return r=t.r/255,n=t.g/255,i=t.b/255,r<=.03928?s=r/12.92:s=Math.pow((r+.055)/1.055,2.4),n<=.03928?a=n/12.92:a=Math.pow((n+.055)/1.055,2.4),i<=.03928?l=i/12.92:l=Math.pow((i+.055)/1.055,2.4),.2126*s+.7152*a+.0722*l},setAlpha:function(t){return this._a=A1(t),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var t=gv(this._r,this._g,this._b);return{h:t.h*360,s:t.s,v:t.v,a:this._a}},toHsvString:function(){var t=gv(this._r,this._g,this._b),r=Math.round(t.h*360),n=Math.round(t.s*100),i=Math.round(t.v*100);return this._a==1?"hsv("+r+", "+n+"%, "+i+"%)":"hsva("+r+", "+n+"%, "+i+"%, "+this._roundA+")"},toHsl:function(){var t=mv(this._r,this._g,this._b);return{h:t.h*360,s:t.s,l:t.l,a:this._a}},toHslString:function(){var t=mv(this._r,this._g,this._b),r=Math.round(t.h*360),n=Math.round(t.s*100),i=Math.round(t.l*100);return this._a==1?"hsl("+r+", "+n+"%, "+i+"%)":"hsla("+r+", "+n+"%, "+i+"%, "+this._roundA+")"},toHex:function(t){return vv(this._r,this._g,this._b,t)},toHexString:function(t){return"#"+this.toHex(t)},toHex8:function(t){return Oz(this._r,this._g,this._b,this._a,t)},toHex8String:function(t){return"#"+this.toHex8(t)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(St(this._r,255)*100)+"%",g:Math.round(St(this._g,255)*100)+"%",b:Math.round(St(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(St(this._r,255)*100)+"%, "+Math.round(St(this._g,255)*100)+"%, "+Math.round(St(this._b,255)*100)+"%)":"rgba("+Math.round(St(this._r,255)*100)+"%, "+Math.round(St(this._g,255)*100)+"%, "+Math.round(St(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:Wz[vv(this._r,this._g,this._b,!0)]||!1},toFilter:function(t){var r="#"+yv(this._r,this._g,this._b,this._a),n=r,i=this._gradientType?"GradientType = 1, ":"";if(t){var s=Ie(t);n="#"+yv(s._r,s._g,s._b,s._a)}return"progid:DXImageTransform.Microsoft.gradient("+i+"startColorstr="+r+",endColorstr="+n+")"},toString:function(t){var r=!!t;t=t||this._format;var n=!1,i=this._a<1&&this._a>=0,s=!r&&i&&(t==="hex"||t==="hex6"||t==="hex3"||t==="hex4"||t==="hex8"||t==="name");return s?t==="name"&&this._a===0?this.toName():this.toRgbString():(t==="rgb"&&(n=this.toRgbString()),t==="prgb"&&(n=this.toPercentageRgbString()),(t==="hex"||t==="hex6")&&(n=this.toHexString()),t==="hex3"&&(n=this.toHexString(!0)),t==="hex4"&&(n=this.toHex8String(!0)),t==="hex8"&&(n=this.toHex8String()),t==="name"&&(n=this.toName()),t==="hsl"&&(n=this.toHslString()),t==="hsv"&&(n=this.toHsvString()),n||this.toHexString())},clone:function(){return Ie(this.toString())},_applyModification:function(t,r){var n=t.apply(null,[this].concat([].slice.call(r)));return this._r=n._r,this._g=n._g,this._b=n._b,this.setAlpha(n._a),this},lighten:function(){return this._applyModification(Lz,arguments)},brighten:function(){return this._applyModification(Iz,arguments)},darken:function(){return this._applyModification(Dz,arguments)},desaturate:function(){return this._applyModification(Az,arguments)},saturate:function(){return this._applyModification(Mz,arguments)},greyscale:function(){return this._applyModification($z,arguments)},spin:function(){return this._applyModification(zz,arguments)},_applyCombination:function(t,r){return t.apply(null,[this].concat([].slice.call(r)))},analogous:function(){return this._applyCombination(Hz,arguments)},complement:function(){return this._applyCombination(Fz,arguments)},monochromatic:function(){return this._applyCombination(Uz,arguments)},splitcomplement:function(){return this._applyCombination(Bz,arguments)},triad:function(){return this._applyCombination(xv,[3])},tetrad:function(){return this._applyCombination(xv,[4])}};Ie.fromRatio=function(e,t){if(Zc(e)=="object"){var r={};for(var n in e)e.hasOwnProperty(n)&&(n==="a"?r[n]=e[n]:r[n]=va(e[n]));e=r}return Ie(e,t)};function Tz(e){var t={r:0,g:0,b:0},r=1,n=null,i=null,s=null,a=!1,l=!1;return typeof e=="string"&&(e=Yz(e)),Zc(e)=="object"&&(Bn(e.r)&&Bn(e.g)&&Bn(e.b)?(t=Nz(e.r,e.g,e.b),a=!0,l=String(e.r).substr(-1)==="%"?"prgb":"rgb"):Bn(e.h)&&Bn(e.s)&&Bn(e.v)?(n=va(e.s),i=va(e.v),t=Rz(e.h,n,i),a=!0,l="hsv"):Bn(e.h)&&Bn(e.s)&&Bn(e.l)&&(n=va(e.s),s=va(e.l),t=Pz(e.h,n,s),a=!0,l="hsl"),e.hasOwnProperty("a")&&(r=e.a)),r=A1(r),{ok:a,format:e.format||l,r:Math.min(255,Math.max(t.r,0)),g:Math.min(255,Math.max(t.g,0)),b:Math.min(255,Math.max(t.b,0)),a:r}}function Nz(e,t,r){return{r:St(e,255)*255,g:St(t,255)*255,b:St(r,255)*255}}function mv(e,t,r){e=St(e,255),t=St(t,255),r=St(r,255);var n=Math.max(e,t,r),i=Math.min(e,t,r),s,a,l=(n+i)/2;if(n==i)s=a=0;else{var c=n-i;switch(a=l>.5?c/(2-n-i):c/(n+i),n){case e:s=(t-r)/c+(t<r?6:0);break;case t:s=(r-e)/c+2;break;case r:s=(e-t)/c+4;break}s/=6}return{h:s,s:a,l}}function Pz(e,t,r){var n,i,s;e=St(e,360),t=St(t,100),r=St(r,100);function a(d,u,f){return f<0&&(f+=1),f>1&&(f-=1),f<1/6?d+(u-d)*6*f:f<1/2?u:f<2/3?d+(u-d)*(2/3-f)*6:d}if(t===0)n=i=s=r;else{var l=r<.5?r*(1+t):r+t-r*t,c=2*r-l;n=a(c,l,e+1/3),i=a(c,l,e),s=a(c,l,e-1/3)}return{r:n*255,g:i*255,b:s*255}}function gv(e,t,r){e=St(e,255),t=St(t,255),r=St(r,255);var n=Math.max(e,t,r),i=Math.min(e,t,r),s,a,l=n,c=n-i;if(a=n===0?0:c/n,n==i)s=0;else{switch(n){case e:s=(t-r)/c+(t<r?6:0);break;case t:s=(r-e)/c+2;break;case r:s=(e-t)/c+4;break}s/=6}return{h:s,s:a,v:l}}function Rz(e,t,r){e=St(e,360)*6,t=St(t,100),r=St(r,100);var n=Math.floor(e),i=e-n,s=r*(1-t),a=r*(1-i*t),l=r*(1-(1-i)*t),c=n%6,d=[r,a,s,s,l,r][c],u=[l,r,r,a,s,s][c],f=[s,s,l,r,r,a][c];return{r:d*255,g:u*255,b:f*255}}function vv(e,t,r,n){var i=[ln(Math.round(e).toString(16)),ln(Math.round(t).toString(16)),ln(Math.round(r).toString(16))];return n&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function Oz(e,t,r,n,i){var s=[ln(Math.round(e).toString(16)),ln(Math.round(t).toString(16)),ln(Math.round(r).toString(16)),ln(M1(n))];return i&&s[0].charAt(0)==s[0].charAt(1)&&s[1].charAt(0)==s[1].charAt(1)&&s[2].charAt(0)==s[2].charAt(1)&&s[3].charAt(0)==s[3].charAt(1)?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0)+s[3].charAt(0):s.join("")}function yv(e,t,r,n){var i=[ln(M1(n)),ln(Math.round(e).toString(16)),ln(Math.round(t).toString(16)),ln(Math.round(r).toString(16))];return i.join("")}Ie.equals=function(e,t){return!e||!t?!1:Ie(e).toRgbString()==Ie(t).toRgbString()};Ie.random=function(){return Ie.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function Az(e,t){t=t===0?0:t||10;var r=Ie(e).toHsl();return r.s-=t/100,r.s=Ad(r.s),Ie(r)}function Mz(e,t){t=t===0?0:t||10;var r=Ie(e).toHsl();return r.s+=t/100,r.s=Ad(r.s),Ie(r)}function $z(e){return Ie(e).desaturate(100)}function Lz(e,t){t=t===0?0:t||10;var r=Ie(e).toHsl();return r.l+=t/100,r.l=Ad(r.l),Ie(r)}function Iz(e,t){t=t===0?0:t||10;var r=Ie(e).toRgb();return r.r=Math.max(0,Math.min(255,r.r-Math.round(255*-(t/100)))),r.g=Math.max(0,Math.min(255,r.g-Math.round(255*-(t/100)))),r.b=Math.max(0,Math.min(255,r.b-Math.round(255*-(t/100)))),Ie(r)}function Dz(e,t){t=t===0?0:t||10;var r=Ie(e).toHsl();return r.l-=t/100,r.l=Ad(r.l),Ie(r)}function zz(e,t){var r=Ie(e).toHsl(),n=(r.h+t)%360;return r.h=n<0?360+n:n,Ie(r)}function Fz(e){var t=Ie(e).toHsl();return t.h=(t.h+180)%360,Ie(t)}function xv(e,t){if(isNaN(t)||t<=0)throw new Error("Argument to polyad must be a positive number");for(var r=Ie(e).toHsl(),n=[Ie(e)],i=360/t,s=1;s<t;s++)n.push(Ie({h:(r.h+s*i)%360,s:r.s,l:r.l}));return n}function Bz(e){var t=Ie(e).toHsl(),r=t.h;return[Ie(e),Ie({h:(r+72)%360,s:t.s,l:t.l}),Ie({h:(r+216)%360,s:t.s,l:t.l})]}function Hz(e,t,r){t=t||6,r=r||30;var n=Ie(e).toHsl(),i=360/r,s=[Ie(e)];for(n.h=(n.h-(i*t>>1)+720)%360;--t;)n.h=(n.h+i)%360,s.push(Ie(n));return s}function Uz(e,t){t=t||6;for(var r=Ie(e).toHsv(),n=r.h,i=r.s,s=r.v,a=[],l=1/t;t--;)a.push(Ie({h:n,s:i,v:s})),s=(s+l)%1;return a}Ie.mix=function(e,t,r){r=r===0?0:r||50;var n=Ie(e).toRgb(),i=Ie(t).toRgb(),s=r/100,a={r:(i.r-n.r)*s+n.r,g:(i.g-n.g)*s+n.g,b:(i.b-n.b)*s+n.b,a:(i.a-n.a)*s+n.a};return Ie(a)};Ie.readability=function(e,t){var r=Ie(e),n=Ie(t);return(Math.max(r.getLuminance(),n.getLuminance())+.05)/(Math.min(r.getLuminance(),n.getLuminance())+.05)};Ie.isReadable=function(e,t,r){var n=Ie.readability(e,t),i,s;switch(s=!1,i=Xz(r),i.level+i.size){case"AAsmall":case"AAAlarge":s=n>=4.5;break;case"AAlarge":s=n>=3;break;case"AAAsmall":s=n>=7;break}return s};Ie.mostReadable=function(e,t,r){var n=null,i=0,s,a,l,c;r=r||{},a=r.includeFallbackColors,l=r.level,c=r.size;for(var d=0;d<t.length;d++)s=Ie.readability(e,t[d]),s>i&&(i=s,n=Ie(t[d]));return Ie.isReadable(e,n,{level:l,size:c})||!a?n:(r.includeFallbackColors=!1,Ie.mostReadable(e,["#fff","#000"],r))};var Kh=Ie.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},Wz=Ie.hexNames=Gz(Kh);function Gz(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[e[r]]=r);return t}function A1(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function St(e,t){Vz(e)&&(e="100%");var r=qz(e);return e=Math.min(t,Math.max(0,parseFloat(e))),r&&(e=parseInt(e*t,10)/100),Math.abs(e-t)<1e-6?1:e%t/parseFloat(t)}function Ad(e){return Math.min(1,Math.max(0,e))}function jr(e){return parseInt(e,16)}function Vz(e){return typeof e=="string"&&e.indexOf(".")!=-1&&parseFloat(e)===1}function qz(e){return typeof e=="string"&&e.indexOf("%")!=-1}function ln(e){return e.length==1?"0"+e:""+e}function va(e){return e<=1&&(e=e*100+"%"),e}function M1(e){return Math.round(parseFloat(e)*255).toString(16)}function bv(e){return jr(e)/255}var tn=function(){var e="[-\\+]?\\d+%?",t="[-\\+]?\\d*\\.\\d+%?",r="(?:"+t+")|(?:"+e+")",n="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?",i="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?";return{CSS_UNIT:new RegExp(r),rgb:new RegExp("rgb"+n),rgba:new RegExp("rgba"+i),hsl:new RegExp("hsl"+n),hsla:new RegExp("hsla"+i),hsv:new RegExp("hsv"+n),hsva:new RegExp("hsva"+i),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function Bn(e){return!!tn.CSS_UNIT.exec(e)}function Yz(e){e=e.replace(Cz,"").replace(Ez,"").toLowerCase();var t=!1;if(Kh[e])e=Kh[e],t=!0;else if(e=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var r;return(r=tn.rgb.exec(e))?{r:r[1],g:r[2],b:r[3]}:(r=tn.rgba.exec(e))?{r:r[1],g:r[2],b:r[3],a:r[4]}:(r=tn.hsl.exec(e))?{h:r[1],s:r[2],l:r[3]}:(r=tn.hsla.exec(e))?{h:r[1],s:r[2],l:r[3],a:r[4]}:(r=tn.hsv.exec(e))?{h:r[1],s:r[2],v:r[3]}:(r=tn.hsva.exec(e))?{h:r[1],s:r[2],v:r[3],a:r[4]}:(r=tn.hex8.exec(e))?{r:jr(r[1]),g:jr(r[2]),b:jr(r[3]),a:bv(r[4]),format:t?"name":"hex8"}:(r=tn.hex6.exec(e))?{r:jr(r[1]),g:jr(r[2]),b:jr(r[3]),format:t?"name":"hex"}:(r=tn.hex4.exec(e))?{r:jr(r[1]+""+r[1]),g:jr(r[2]+""+r[2]),b:jr(r[3]+""+r[3]),a:bv(r[4]+""+r[4]),format:t?"name":"hex8"}:(r=tn.hex3.exec(e))?{r:jr(r[1]+""+r[1]),g:jr(r[2]+""+r[2]),b:jr(r[3]+""+r[3]),format:t?"name":"hex"}:!1}function Xz(e){var t,r;return e=e||{level:"AA",size:"small"},t=(e.level||"AA").toUpperCase(),r=(e.size||"small").toLowerCase(),t!=="AA"&&t!=="AAA"&&(t="AA"),r!=="small"&&r!=="large"&&(r="small"),{level:t,size:r}}var wv=function(t){var r=["r","g","b","a","h","s","l","v"],n=0,i=0;return jz(r,function(s){if(t[s]&&(n+=1,isNaN(t[s])||(i+=1),s==="s"||s==="l")){var a=/^\d+%$/;a.test(t[s])&&(i+=1)}}),n===i?t:!1},ya=function(t,r){var n=t.hex?Ie(t.hex):Ie(t),i=n.toHsl(),s=n.toHsv(),a=n.toRgb(),l=n.toHex();i.s===0&&(i.h=r||0,s.h=r||0);var c=l==="000000"&&a.a===0;return{hsl:i,hex:c?"transparent":"#"+l,rgb:a,hsv:s,oldHue:t.h||r||i.h,source:t.source}},Fi=function(t){if(t==="transparent")return!0;var r=String(t).charAt(0)==="#"?1:0;return t.length!==4+r&&t.length<7+r&&Ie(t).isValid()},zp=function(t){if(!t)return"#fff";var r=ya(t);if(r.hex==="transparent")return"rgba(0,0,0,0.4)";var n=(r.rgb.r*299+r.rgb.g*587+r.rgb.b*114)/1e3;return n>=128?"#000":"#fff"},Mu=function(t,r){var n=t.replace("","");return Ie(r+" ("+n+")")._ok},la=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Kz=function(){function e(t,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function Zz(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Jz(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e}function Qz(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var br=function(t){var r=function(n){Qz(i,n);function i(s){Zz(this,i);var a=Jz(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return a.handleChange=function(l,c){var d=wv(l);if(d){var u=ya(l,l.h||a.state.oldHue);a.setState(u),a.props.onChangeComplete&&a.debounce(a.props.onChangeComplete,u,c),a.props.onChange&&a.props.onChange(u,c)}},a.handleSwatchHover=function(l,c){var d=wv(l);if(d){var u=ya(l,l.h||a.state.oldHue);a.props.onSwatchHover&&a.props.onSwatchHover(u,c)}},a.state=la({},ya(s.color,0)),a.debounce=R1(function(l,c,d){l(c,d)},100),a}return Kz(i,[{key:"render",value:function(){var a={};return this.props.onSwatchHover&&(a.onSwatchHover=this.handleSwatchHover),D.createElement(t,la({},this.props,this.state,{onChange:this.handleChange},a))}}],[{key:"getDerivedStateFromProps",value:function(a,l){return la({},ya(a.color,l.oldHue))}}]),i}(A.PureComponent||A.Component);return r.propTypes=la({},t.propTypes),r.defaultProps=la({},t.defaultProps,{color:{h:250,s:.5,l:.2,a:1}}),r},eF=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},tF=function(){function e(t,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function rF(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _v(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e}function nF(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var iF=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"span";return function(n){nF(i,n);function i(){var s,a,l,c;rF(this,i);for(var d=arguments.length,u=Array(d),f=0;f<d;f++)u[f]=arguments[f];return c=(a=(l=_v(this,(s=i.__proto__||Object.getPrototypeOf(i)).call.apply(s,[this].concat(u))),l),l.state={focus:!1},l.handleFocus=function(){return l.setState({focus:!0})},l.handleBlur=function(){return l.setState({focus:!1})},a),_v(l,c)}return tF(i,[{key:"render",value:function(){return D.createElement(r,{onFocus:this.handleFocus,onBlur:this.handleBlur},D.createElement(t,eF({},this.props,this.state)))}}]),i}(D.Component)},Sv=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sF=13,oF=function(t){var r=t.color,n=t.style,i=t.onClick,s=i===void 0?function(){}:i,a=t.onHover,l=t.title,c=l===void 0?r:l,d=t.children,u=t.focus,f=t.focusStyle,h=f===void 0?{}:f,p=r==="transparent",g=Ye({default:{swatch:Sv({background:r,height:"100%",width:"100%",cursor:"pointer",position:"relative",outline:"none"},n,u?h:{})}}),m=function(w){return s(r,w)},x=function(w){return w.keyCode===sF&&s(r,w)},v=function(w){return a(r,w)},y={};return a&&(y.onMouseOver=v),D.createElement("div",Sv({style:g.swatch,onClick:m,title:c,tabIndex:0,onKeyDown:x},y),d,p&&D.createElement(Uo,{borderRadius:g.swatch.borderRadius,boxShadow:"inset 0 0 0 1px rgba(0,0,0,0.1)"}))};const _s=iF(oF);var aF=function(t){var r=t.direction,n=Ye({default:{picker:{width:"18px",height:"18px",borderRadius:"50%",transform:"translate(-9px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}},vertical:{picker:{transform:"translate(-3px, -9px)"}}},{vertical:r==="vertical"});return D.createElement("div",{style:n.picker})},lF=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$1=function(t){var r=t.rgb,n=t.hsl,i=t.width,s=t.height,a=t.onChange,l=t.direction,c=t.style,d=t.renderers,u=t.pointer,f=t.className,h=f===void 0?"":f,p=Ye({default:{picker:{position:"relative",width:i,height:s},alpha:{radius:"2px",style:c}}});return D.createElement("div",{style:p.picker,className:"alpha-picker "+h},D.createElement(Rp,lF({},p.alpha,{rgb:r,hsl:n,pointer:u,renderers:d,onChange:a,direction:l})))};$1.defaultProps={width:"316px",height:"16px",direction:"horizontal",pointer:aF};br($1);function L1(e,t){for(var r=-1,n=e==null?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i}var cF="__lodash_hash_undefined__";function dF(e){return this.__data__.set(e,cF),this}function uF(e){return this.__data__.has(e)}function Jc(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new ti;++t<r;)this.add(e[t])}Jc.prototype.add=Jc.prototype.push=dF;Jc.prototype.has=uF;function hF(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}function fF(e,t){return e.has(t)}var pF=1,mF=2;function I1(e,t,r,n,i,s){var a=r&pF,l=e.length,c=t.length;if(l!=c&&!(a&&c>l))return!1;var d=s.get(e),u=s.get(t);if(d&&u)return d==t&&u==e;var f=-1,h=!0,p=r&mF?new Jc:void 0;for(s.set(e,t),s.set(t,e);++f<l;){var g=e[f],m=t[f];if(n)var x=a?n(m,g,f,t,e,s):n(g,m,f,e,t,s);if(x!==void 0){if(x)continue;h=!1;break}if(p){if(!hF(t,function(v,y){if(!fF(p,y)&&(g===v||i(g,v,r,n,s)))return p.push(y)})){h=!1;break}}else if(!(g===m||i(g,m,r,n,s))){h=!1;break}}return s.delete(e),s.delete(t),h}function gF(e){var t=-1,r=Array(e.size);return e.forEach(function(n,i){r[++t]=[i,n]}),r}function vF(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var yF=1,xF=2,bF="[object Boolean]",wF="[object Date]",_F="[object Error]",SF="[object Map]",kF="[object Number]",jF="[object RegExp]",CF="[object Set]",EF="[object String]",TF="[object Symbol]",NF="[object ArrayBuffer]",PF="[object DataView]",kv=Mi?Mi.prototype:void 0,$u=kv?kv.valueOf:void 0;function RF(e,t,r,n,i,s,a){switch(r){case PF:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case NF:return!(e.byteLength!=t.byteLength||!s(new Yc(e),new Yc(t)));case bF:case wF:case kF:return gl(+e,+t);case _F:return e.name==t.name&&e.message==t.message;case jF:case EF:return e==t+"";case SF:var l=gF;case CF:var c=n&yF;if(l||(l=vF),e.size!=t.size&&!c)return!1;var d=a.get(e);if(d)return d==t;n|=xF,a.set(e,t);var u=I1(l(e),l(t),n,i,s,a);return a.delete(e),u;case TF:if($u)return $u.call(e)==$u.call(t)}return!1}function OF(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}function AF(e,t,r){var n=t(e);return Mr(e)?n:OF(n,r(e))}function MF(e,t){for(var r=-1,n=e==null?0:e.length,i=0,s=[];++r<n;){var a=e[r];t(a,r,e)&&(s[i++]=a)}return s}function $F(){return[]}var LF=Object.prototype,IF=LF.propertyIsEnumerable,jv=Object.getOwnPropertySymbols,DF=jv?function(e){return e==null?[]:(e=Object(e),MF(jv(e),function(t){return IF.call(e,t)}))}:$F;function Cv(e){return AF(e,Dp,DF)}var zF=1,FF=Object.prototype,BF=FF.hasOwnProperty;function HF(e,t,r,n,i,s){var a=r&zF,l=Cv(e),c=l.length,d=Cv(t),u=d.length;if(c!=u&&!a)return!1;for(var f=c;f--;){var h=l[f];if(!(a?h in t:BF.call(t,h)))return!1}var p=s.get(e),g=s.get(t);if(p&&g)return p==t&&g==e;var m=!0;s.set(e,t),s.set(t,e);for(var x=a;++f<c;){h=l[f];var v=e[h],y=t[h];if(n)var b=a?n(y,v,h,t,e,s):n(v,y,h,e,t,s);if(!(b===void 0?v===y||i(v,y,r,n,s):b)){m=!1;break}x||(x=h=="constructor")}if(m&&!x){var w=e.constructor,j=t.constructor;w!=j&&"constructor"in e&&"constructor"in t&&!(typeof w=="function"&&w instanceof w&&typeof j=="function"&&j instanceof j)&&(m=!1)}return s.delete(e),s.delete(t),m}var Zh=ws(fn,"DataView"),Jh=ws(fn,"Promise"),Qh=ws(fn,"Set"),ef=ws(fn,"WeakMap"),Ev="[object Map]",UF="[object Object]",Tv="[object Promise]",Nv="[object Set]",Pv="[object WeakMap]",Rv="[object DataView]",WF=bs(Zh),GF=bs(el),VF=bs(Jh),qF=bs(Qh),YF=bs(ef),gi=xs;(Zh&&gi(new Zh(new ArrayBuffer(1)))!=Rv||el&&gi(new el)!=Ev||Jh&&gi(Jh.resolve())!=Tv||Qh&&gi(new Qh)!=Nv||ef&&gi(new ef)!=Pv)&&(gi=function(e){var t=xs(e),r=t==UF?e.constructor:void 0,n=r?bs(r):"";if(n)switch(n){case WF:return Rv;case GF:return Ev;case VF:return Tv;case qF:return Nv;case YF:return Pv}return t});var XF=1,Ov="[object Arguments]",Av="[object Array]",Xl="[object Object]",KF=Object.prototype,Mv=KF.hasOwnProperty;function ZF(e,t,r,n,i,s){var a=Mr(e),l=Mr(t),c=a?Av:gi(e),d=l?Av:gi(t);c=c==Ov?Xl:c,d=d==Ov?Xl:d;var u=c==Xl,f=d==Xl,h=c==d;if(h&&Kc(e)){if(!Kc(t))return!1;a=!0,u=!1}if(h&&!u)return s||(s=new On),a||Lp(e)?I1(e,t,r,n,i,s):RF(e,t,c,r,n,i,s);if(!(r&XF)){var p=u&&Mv.call(e,"__wrapped__"),g=f&&Mv.call(t,"__wrapped__");if(p||g){var m=p?e.value():e,x=g?t.value():t;return s||(s=new On),i(m,x,r,n,s)}}return h?(s||(s=new On),HF(e,t,r,n,i,s)):!1}function Fp(e,t,r,n,i){return e===t?!0:e==null||t==null||!$i(e)&&!$i(t)?e!==e&&t!==t:ZF(e,t,r,n,Fp,i)}var JF=1,QF=2;function eB(e,t,r,n){var i=r.length,s=i;if(e==null)return!s;for(e=Object(e);i--;){var a=r[i];if(a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++i<s;){a=r[i];var l=a[0],c=e[l],d=a[1];if(a[2]){if(c===void 0&&!(l in e))return!1}else{var u=new On,f;if(!(f===void 0?Fp(d,c,JF|QF,n,u):f))return!1}}return!0}function D1(e){return e===e&&!Yr(e)}function tB(e){for(var t=Dp(e),r=t.length;r--;){var n=t[r],i=e[n];t[r]=[n,i,D1(i)]}return t}function z1(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}function rB(e){var t=tB(e);return t.length==1&&t[0][2]?z1(t[0][0],t[0][1]):function(r){return r===e||eB(r,e,t)}}var nB=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,iB=/^\w*$/;function Bp(e,t){if(Mr(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||Rd(e)?!0:iB.test(e)||!nB.test(e)||t!=null&&e in Object(t)}var sB="Expected a function";function Hp(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(sB);var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],s=r.cache;if(s.has(i))return s.get(i);var a=e.apply(this,n);return r.cache=s.set(i,a)||s,a};return r.cache=new(Hp.Cache||ti),r}Hp.Cache=ti;var oB=500;function aB(e){var t=Hp(e,function(n){return r.size===oB&&r.clear(),n}),r=t.cache;return t}var lB=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,cB=/\\(\\)?/g,dB=aB(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(lB,function(r,n,i,s){t.push(i?s.replace(cB,"$1"):n||r)}),t}),$v=Mi?Mi.prototype:void 0,Lv=$v?$v.toString:void 0;function F1(e){if(typeof e=="string")return e;if(Mr(e))return L1(e,F1)+"";if(Rd(e))return Lv?Lv.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}function uB(e){return e==null?"":F1(e)}function B1(e,t){return Mr(e)?e:Bp(e,t)?[e]:dB(uB(e))}function Md(e){if(typeof e=="string"||Rd(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}function H1(e,t){t=B1(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[Md(t[r++])];return r&&r==n?e:void 0}function hB(e,t,r){var n=e==null?void 0:H1(e,t);return n===void 0?r:n}function fB(e,t){return e!=null&&t in Object(e)}function pB(e,t,r){t=B1(t,e);for(var n=-1,i=t.length,s=!1;++n<i;){var a=Md(t[n]);if(!(s=e!=null&&r(e,a)))break;e=e[a]}return s||++n!=i?s:(i=e==null?0:e.length,!!i&&$p(i)&&Ip(a,i)&&(Mr(e)||Xc(e)))}function mB(e,t){return e!=null&&pB(e,t,fB)}var gB=1,vB=2;function yB(e,t){return Bp(e)&&D1(t)?z1(Md(e),t):function(r){var n=hB(r,e);return n===void 0&&n===t?mB(r,e):Fp(t,n,gB|vB)}}function xB(e){return function(t){return t==null?void 0:t[e]}}function bB(e){return function(t){return H1(t,e)}}function wB(e){return Bp(e)?xB(Md(e)):bB(e)}function _B(e){return typeof e=="function"?e:e==null?Pd:typeof e=="object"?Mr(e)?yB(e[0],e[1]):rB(e):wB(e)}function SB(e,t){var r=-1,n=Go(e)?Array(e.length):[];return O1(e,function(i,s,a){n[++r]=t(i,s,a)}),n}function Ss(e,t){var r=Mr(e)?L1:SB;return r(e,_B(t))}var kB=function(t){var r=t.colors,n=t.onClick,i=t.onSwatchHover,s=Ye({default:{swatches:{marginRight:"-10px"},swatch:{width:"22px",height:"22px",float:"left",marginRight:"10px",marginBottom:"10px",borderRadius:"4px"},clear:{clear:"both"}}});return D.createElement("div",{style:s.swatches},Ss(r,function(a){return D.createElement(_s,{key:a,color:a,style:s.swatch,onClick:n,onHover:i,focusStyle:{boxShadow:"0 0 4px "+a}})}),D.createElement("div",{style:s.clear}))},Up=function(t){var r=t.onChange,n=t.onSwatchHover,i=t.hex,s=t.colors,a=t.width,l=t.triangle,c=t.styles,d=c===void 0?{}:c,u=t.className,f=u===void 0?"":u,h=i==="transparent",p=function(x,v){Fi(x)&&r({hex:x,source:"hex"},v)},g=Ye(xr({default:{card:{width:a,background:"#fff",boxShadow:"0 1px rgba(0,0,0,.1)",borderRadius:"6px",position:"relative"},head:{height:"110px",background:i,borderRadius:"6px 6px 0 0",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},body:{padding:"10px"},label:{fontSize:"18px",color:zp(i),position:"relative"},triangle:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 10px 10px 10px",borderColor:"transparent transparent "+i+" transparent",position:"absolute",top:"-10px",left:"50%",marginLeft:"-10px"},input:{width:"100%",fontSize:"12px",color:"#666",border:"0px",outline:"none",height:"22px",boxShadow:"inset 0 0 0 1px #ddd",borderRadius:"4px",padding:"0 7px",boxSizing:"border-box"}},"hide-triangle":{triangle:{display:"none"}}},d),{"hide-triangle":l==="hide"});return D.createElement("div",{style:g.card,className:"block-picker "+f},D.createElement("div",{style:g.triangle}),D.createElement("div",{style:g.head},h&&D.createElement(Uo,{borderRadius:"6px 6px 0 0"}),D.createElement("div",{style:g.label},i)),D.createElement("div",{style:g.body},D.createElement(kB,{colors:s,onClick:p,onSwatchHover:n}),D.createElement(it,{style:{input:g.input},value:i,onChange:p})))};Up.propTypes={width:Ee.oneOfType([Ee.string,Ee.number]),colors:Ee.arrayOf(Ee.string),triangle:Ee.oneOf(["top","hide"]),styles:Ee.object};Up.defaultProps={width:170,colors:["#D9E3F0","#F47373","#697689","#37D67A","#2CCCE4","#555555","#dce775","#ff8a65","#ba68c8"],triangle:"top",styles:{}};br(Up);var Is={100:"#ffcdd2",300:"#e57373",500:"#f44336",700:"#d32f2f",900:"#b71c1c"},Ds={100:"#f8bbd0",300:"#f06292",500:"#e91e63",700:"#c2185b",900:"#880e4f"},zs={100:"#e1bee7",300:"#ba68c8",500:"#9c27b0",700:"#7b1fa2",900:"#4a148c"},Fs={100:"#d1c4e9",300:"#9575cd",500:"#673ab7",700:"#512da8",900:"#311b92"},Bs={100:"#c5cae9",300:"#7986cb",500:"#3f51b5",700:"#303f9f",900:"#1a237e"},Hs={100:"#bbdefb",300:"#64b5f6",500:"#2196f3",700:"#1976d2",900:"#0d47a1"},Us={100:"#b3e5fc",300:"#4fc3f7",500:"#03a9f4",700:"#0288d1",900:"#01579b"},Ws={100:"#b2ebf2",300:"#4dd0e1",500:"#00bcd4",700:"#0097a7",900:"#006064"},Gs={100:"#b2dfdb",300:"#4db6ac",500:"#009688",700:"#00796b",900:"#004d40"},xa={100:"#c8e6c9",300:"#81c784",500:"#4caf50",700:"#388e3c"},Vs={100:"#dcedc8",300:"#aed581",500:"#8bc34a",700:"#689f38",900:"#33691e"},qs={100:"#f0f4c3",300:"#dce775",500:"#cddc39",700:"#afb42b",900:"#827717"},Ys={100:"#fff9c4",300:"#fff176",500:"#ffeb3b",700:"#fbc02d",900:"#f57f17"},Xs={100:"#ffecb3",300:"#ffd54f",500:"#ffc107",700:"#ffa000",900:"#ff6f00"},Ks={100:"#ffe0b2",300:"#ffb74d",500:"#ff9800",700:"#f57c00",900:"#e65100"},Zs={100:"#ffccbc",300:"#ff8a65",500:"#ff5722",700:"#e64a19",900:"#bf360c"},Js={100:"#d7ccc8",300:"#a1887f",500:"#795548",700:"#5d4037",900:"#3e2723"},Qs={100:"#cfd8dc",300:"#90a4ae",500:"#607d8b",700:"#455a64",900:"#263238"},U1=function(t){var r=t.color,n=t.onClick,i=t.onSwatchHover,s=t.hover,a=t.active,l=t.circleSize,c=t.circleSpacing,d=Ye({default:{swatch:{width:l,height:l,marginRight:c,marginBottom:c,transform:"scale(1)",transition:"100ms transform ease"},Swatch:{borderRadius:"50%",background:"transparent",boxShadow:"inset 0 0 0 "+(l/2+1)+"px "+r,transition:"100ms box-shadow ease"}},hover:{swatch:{transform:"scale(1.2)"}},active:{Swatch:{boxShadow:"inset 0 0 0 3px "+r}}},{hover:s,active:a});return D.createElement("div",{style:d.swatch},D.createElement(_s,{style:d.Swatch,color:r,onClick:n,onHover:i,focusStyle:{boxShadow:d.Swatch.boxShadow+", 0 0 5px "+r}}))};U1.defaultProps={circleSize:28,circleSpacing:14};const jB=Pp(U1);var Wp=function(t){var r=t.width,n=t.onChange,i=t.onSwatchHover,s=t.colors,a=t.hex,l=t.circleSize,c=t.styles,d=c===void 0?{}:c,u=t.circleSpacing,f=t.className,h=f===void 0?"":f,p=Ye(xr({default:{card:{width:r,display:"flex",flexWrap:"wrap",marginRight:-u,marginBottom:-u}}},d)),g=function(x,v){return n({hex:x,source:"hex"},v)};return D.createElement("div",{style:p.card,className:"circle-picker "+h},Ss(s,function(m){return D.createElement(jB,{key:m,color:m,onClick:g,onSwatchHover:i,active:a===m.toLowerCase(),circleSize:l,circleSpacing:u})}))};Wp.propTypes={width:Ee.oneOfType([Ee.string,Ee.number]),circleSize:Ee.number,circleSpacing:Ee.number,styles:Ee.object};Wp.defaultProps={width:252,circleSize:28,circleSpacing:14,colors:[Is[500],Ds[500],zs[500],Fs[500],Bs[500],Hs[500],Us[500],Ws[500],Gs[500],xa[500],Vs[500],qs[500],Ys[500],Xs[500],Ks[500],Zs[500],Js[500],Qs[500]],styles:{}};br(Wp);function Iv(e){return e===void 0}var W1={};Object.defineProperty(W1,"__esModule",{value:!0});var Dv=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},CB=A,zv=EB(CB);function EB(e){return e&&e.__esModule?e:{default:e}}function TB(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}var Kl=24,NB=W1.default=function(e){var t=e.fill,r=t===void 0?"currentColor":t,n=e.width,i=n===void 0?Kl:n,s=e.height,a=s===void 0?Kl:s,l=e.style,c=l===void 0?{}:l,d=TB(e,["fill","width","height","style"]);return zv.default.createElement("svg",Dv({viewBox:"0 0 "+Kl+" "+Kl,style:Dv({fill:r,width:i,height:a},c)},d),zv.default.createElement("path",{d:"M12,18.17L8.83,15L7.42,16.41L12,21L16.59,16.41L15.17,15M12,5.83L15.17,9L16.58,7.59L12,3L7.41,7.59L8.83,9L12,5.83Z"}))},PB=function(){function e(t,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function RB(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OB(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e}function AB(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var G1=function(e){AB(t,e);function t(r){RB(this,t);var n=OB(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.toggleViews=function(){n.state.view==="hex"?n.setState({view:"rgb"}):n.state.view==="rgb"?n.setState({view:"hsl"}):n.state.view==="hsl"&&(n.props.hsl.a===1?n.setState({view:"hex"}):n.setState({view:"rgb"}))},n.handleChange=function(i,s){i.hex?Fi(i.hex)&&n.props.onChange({hex:i.hex,source:"hex"},s):i.r||i.g||i.b?n.props.onChange({r:i.r||n.props.rgb.r,g:i.g||n.props.rgb.g,b:i.b||n.props.rgb.b,source:"rgb"},s):i.a?(i.a<0?i.a=0:i.a>1&&(i.a=1),n.props.onChange({h:n.props.hsl.h,s:n.props.hsl.s,l:n.props.hsl.l,a:Math.round(i.a*100)/100,source:"rgb"},s)):(i.h||i.s||i.l)&&(typeof i.s=="string"&&i.s.includes("%")&&(i.s=i.s.replace("%","")),typeof i.l=="string"&&i.l.includes("%")&&(i.l=i.l.replace("%","")),i.s==1?i.s=.01:i.l==1&&(i.l=.01),n.props.onChange({h:i.h||n.props.hsl.h,s:Number(Iv(i.s)?n.props.hsl.s:i.s),l:Number(Iv(i.l)?n.props.hsl.l:i.l),source:"hsl"},s))},n.showHighlight=function(i){i.currentTarget.style.background="#eee"},n.hideHighlight=function(i){i.currentTarget.style.background="transparent"},r.hsl.a!==1&&r.view==="hex"?n.state={view:"rgb"}:n.state={view:r.view},n}return PB(t,[{key:"render",value:function(){var n=this,i=Ye({default:{wrap:{paddingTop:"16px",display:"flex"},fields:{flex:"1",display:"flex",marginLeft:"-6px"},field:{paddingLeft:"6px",width:"100%"},alpha:{paddingLeft:"6px",width:"100%"},toggle:{width:"32px",textAlign:"right",position:"relative"},icon:{marginRight:"-4px",marginTop:"12px",cursor:"pointer",position:"relative"},iconHighlight:{position:"absolute",width:"24px",height:"28px",background:"#eee",borderRadius:"4px",top:"10px",left:"12px",display:"none"},input:{fontSize:"11px",color:"#333",width:"100%",borderRadius:"2px",border:"none",boxShadow:"inset 0 0 0 1px #dadada",height:"21px",textAlign:"center"},label:{textTransform:"uppercase",fontSize:"11px",lineHeight:"11px",color:"#969696",textAlign:"center",display:"block",marginTop:"12px"},svg:{fill:"#333",width:"24px",height:"24px",border:"1px transparent solid",borderRadius:"5px"}},disableAlpha:{alpha:{display:"none"}}},this.props,this.state),s=void 0;return this.state.view==="hex"?s=D.createElement("div",{style:i.fields,className:"flexbox-fix"},D.createElement("div",{style:i.field},D.createElement(it,{style:{input:i.input,label:i.label},label:"hex",value:this.props.hex,onChange:this.handleChange}))):this.state.view==="rgb"?s=D.createElement("div",{style:i.fields,className:"flexbox-fix"},D.createElement("div",{style:i.field},D.createElement(it,{style:{input:i.input,label:i.label},label:"r",value:this.props.rgb.r,onChange:this.handleChange})),D.createElement("div",{style:i.field},D.createElement(it,{style:{input:i.input,label:i.label},label:"g",value:this.props.rgb.g,onChange:this.handleChange})),D.createElement("div",{style:i.field},D.createElement(it,{style:{input:i.input,label:i.label},label:"b",value:this.props.rgb.b,onChange:this.handleChange})),D.createElement("div",{style:i.alpha},D.createElement(it,{style:{input:i.input,label:i.label},label:"a",value:this.props.rgb.a,arrowOffset:.01,onChange:this.handleChange}))):this.state.view==="hsl"&&(s=D.createElement("div",{style:i.fields,className:"flexbox-fix"},D.createElement("div",{style:i.field},D.createElement(it,{style:{input:i.input,label:i.label},label:"h",value:Math.round(this.props.hsl.h),onChange:this.handleChange})),D.createElement("div",{style:i.field},D.createElement(it,{style:{input:i.input,label:i.label},label:"s",value:Math.round(this.props.hsl.s*100)+"%",onChange:this.handleChange})),D.createElement("div",{style:i.field},D.createElement(it,{style:{input:i.input,label:i.label},label:"l",value:Math.round(this.props.hsl.l*100)+"%",onChange:this.handleChange})),D.createElement("div",{style:i.alpha},D.createElement(it,{style:{input:i.input,label:i.label},label:"a",value:this.props.hsl.a,arrowOffset:.01,onChange:this.handleChange})))),D.createElement("div",{style:i.wrap,className:"flexbox-fix"},s,D.createElement("div",{style:i.toggle},D.createElement("div",{style:i.icon,onClick:this.toggleViews,ref:function(l){return n.icon=l}},D.createElement(NB,{style:i.svg,onMouseOver:this.showHighlight,onMouseEnter:this.showHighlight,onMouseOut:this.hideHighlight}))))}}],[{key:"getDerivedStateFromProps",value:function(n,i){return n.hsl.a!==1&&i.view==="hex"?{view:"rgb"}:null}}]),t}(D.Component);G1.defaultProps={view:"hex"};var Fv=function(){var t=Ye({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",transform:"translate(-6px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}}});return D.createElement("div",{style:t.picker})},MB=function(){var t=Ye({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",boxShadow:"inset 0 0 0 1px #fff",transform:"translate(-6px, -6px)"}}});return D.createElement("div",{style:t.picker})},Gp=function(t){var r=t.width,n=t.onChange,i=t.disableAlpha,s=t.rgb,a=t.hsl,l=t.hsv,c=t.hex,d=t.renderers,u=t.styles,f=u===void 0?{}:u,h=t.className,p=h===void 0?"":h,g=t.defaultView,m=Ye(xr({default:{picker:{width:r,background:"#fff",borderRadius:"2px",boxShadow:"0 0 2px rgba(0,0,0,.3), 0 4px 8px rgba(0,0,0,.3)",boxSizing:"initial",fontFamily:"Menlo"},saturation:{width:"100%",paddingBottom:"55%",position:"relative",borderRadius:"2px 2px 0 0",overflow:"hidden"},Saturation:{radius:"2px 2px 0 0"},body:{padding:"16px 16px 12px"},controls:{display:"flex"},color:{width:"32px"},swatch:{marginTop:"6px",width:"16px",height:"16px",borderRadius:"8px",position:"relative",overflow:"hidden"},active:{absolute:"0px 0px 0px 0px",borderRadius:"8px",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.1)",background:"rgba("+s.r+", "+s.g+", "+s.b+", "+s.a+")",zIndex:"2"},toggles:{flex:"1"},hue:{height:"10px",position:"relative",marginBottom:"8px"},Hue:{radius:"2px"},alpha:{height:"10px",position:"relative"},Alpha:{radius:"2px"}},disableAlpha:{color:{width:"22px"},alpha:{display:"none"},hue:{marginBottom:"0px"},swatch:{width:"10px",height:"10px",marginTop:"0px"}}},f),{disableAlpha:i});return D.createElement("div",{style:m.picker,className:"chrome-picker "+p},D.createElement("div",{style:m.saturation},D.createElement(Od,{style:m.Saturation,hsl:a,hsv:l,pointer:MB,onChange:n})),D.createElement("div",{style:m.body},D.createElement("div",{style:m.controls,className:"flexbox-fix"},D.createElement("div",{style:m.color},D.createElement("div",{style:m.swatch},D.createElement("div",{style:m.active}),D.createElement(Uo,{renderers:d}))),D.createElement("div",{style:m.toggles},D.createElement("div",{style:m.hue},D.createElement(Wo,{style:m.Hue,hsl:a,pointer:Fv,onChange:n})),D.createElement("div",{style:m.alpha},D.createElement(Rp,{style:m.Alpha,rgb:s,hsl:a,pointer:Fv,renderers:d,onChange:n})))),D.createElement(G1,{rgb:s,hsl:a,hex:c,view:g,onChange:n,disableAlpha:i})))};Gp.propTypes={width:Ee.oneOfType([Ee.string,Ee.number]),disableAlpha:Ee.bool,styles:Ee.object,defaultView:Ee.oneOf(["hex","rgb","hsl"])};Gp.defaultProps={width:225,disableAlpha:!1,styles:{}};br(Gp);var $B=function(t){var r=t.color,n=t.onClick,i=n===void 0?function(){}:n,s=t.onSwatchHover,a=t.active,l=Ye({default:{color:{background:r,width:"15px",height:"15px",float:"left",marginRight:"5px",marginBottom:"5px",position:"relative",cursor:"pointer"},dot:{absolute:"5px 5px 5px 5px",background:zp(r),borderRadius:"50%",opacity:"0"}},active:{dot:{opacity:"1"}},"color-#FFFFFF":{color:{boxShadow:"inset 0 0 0 1px #ddd"},dot:{background:"#000"}},transparent:{dot:{background:"#000"}}},{active:a,"color-#FFFFFF":r==="#FFFFFF",transparent:r==="transparent"});return D.createElement(_s,{style:l.color,color:r,onClick:i,onHover:s,focusStyle:{boxShadow:"0 0 4px "+r}},D.createElement("div",{style:l.dot}))},LB=function(t){var r=t.hex,n=t.rgb,i=t.onChange,s=Ye({default:{fields:{display:"flex",paddingBottom:"6px",paddingRight:"5px",position:"relative"},active:{position:"absolute",top:"6px",left:"5px",height:"9px",width:"9px",background:r},HEXwrap:{flex:"6",position:"relative"},HEXinput:{width:"80%",padding:"0px",paddingLeft:"20%",border:"none",outline:"none",background:"none",fontSize:"12px",color:"#333",height:"16px"},HEXlabel:{display:"none"},RGBwrap:{flex:"3",position:"relative"},RGBinput:{width:"70%",padding:"0px",paddingLeft:"30%",border:"none",outline:"none",background:"none",fontSize:"12px",color:"#333",height:"16px"},RGBlabel:{position:"absolute",top:"3px",left:"0px",lineHeight:"16px",textTransform:"uppercase",fontSize:"12px",color:"#999"}}}),a=function(c,d){c.r||c.g||c.b?i({r:c.r||n.r,g:c.g||n.g,b:c.b||n.b,source:"rgb"},d):i({hex:c.hex,source:"hex"},d)};return D.createElement("div",{style:s.fields,className:"flexbox-fix"},D.createElement("div",{style:s.active}),D.createElement(it,{style:{wrap:s.HEXwrap,input:s.HEXinput,label:s.HEXlabel},label:"hex",value:r,onChange:a}),D.createElement(it,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"r",value:n.r,onChange:a}),D.createElement(it,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"g",value:n.g,onChange:a}),D.createElement(it,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"b",value:n.b,onChange:a}))},Vp=function(t){var r=t.onChange,n=t.onSwatchHover,i=t.colors,s=t.hex,a=t.rgb,l=t.styles,c=l===void 0?{}:l,d=t.className,u=d===void 0?"":d,f=Ye(xr({default:{Compact:{background:"#f6f6f6",radius:"4px"},compact:{paddingTop:"5px",paddingLeft:"5px",boxSizing:"initial",width:"240px"},clear:{clear:"both"}}},c)),h=function(g,m){g.hex?Fi(g.hex)&&r({hex:g.hex,source:"hex"},m):r(g,m)};return D.createElement(vl,{style:f.Compact,styles:c},D.createElement("div",{style:f.compact,className:"compact-picker "+u},D.createElement("div",null,Ss(i,function(p){return D.createElement($B,{key:p,color:p,active:p.toLowerCase()===s,onClick:h,onSwatchHover:n})}),D.createElement("div",{style:f.clear})),D.createElement(LB,{hex:s,rgb:a,onChange:h})))};Vp.propTypes={colors:Ee.arrayOf(Ee.string),styles:Ee.object};Vp.defaultProps={colors:["#4D4D4D","#999999","#FFFFFF","#F44E3B","#FE9200","#FCDC00","#DBDF00","#A4DD00","#68CCCA","#73D8FF","#AEA1FF","#FDA1FF","#333333","#808080","#cccccc","#D33115","#E27300","#FCC400","#B0BC00","#68BC00","#16A5A5","#009CE0","#7B64FF","#FA28FF","#000000","#666666","#B3B3B3","#9F0500","#C45100","#FB9E00","#808900","#194D33","#0C797D","#0062B1","#653294","#AB149E"],styles:{}};br(Vp);var IB=function(t){var r=t.hover,n=t.color,i=t.onClick,s=t.onSwatchHover,a={position:"relative",zIndex:"2",outline:"2px solid #fff",boxShadow:"0 0 5px 2px rgba(0,0,0,0.25)"},l=Ye({default:{swatch:{width:"25px",height:"25px",fontSize:"0"}},hover:{swatch:a}},{hover:r});return D.createElement("div",{style:l.swatch},D.createElement(_s,{color:n,onClick:i,onHover:s,focusStyle:a}))};const DB=Pp(IB);var qp=function(t){var r=t.width,n=t.colors,i=t.onChange,s=t.onSwatchHover,a=t.triangle,l=t.styles,c=l===void 0?{}:l,d=t.className,u=d===void 0?"":d,f=Ye(xr({default:{card:{width:r,background:"#fff",border:"1px solid rgba(0,0,0,0.2)",boxShadow:"0 3px 12px rgba(0,0,0,0.15)",borderRadius:"4px",position:"relative",padding:"5px",display:"flex",flexWrap:"wrap"},triangle:{position:"absolute",border:"7px solid transparent",borderBottomColor:"#fff"},triangleShadow:{position:"absolute",border:"8px solid transparent",borderBottomColor:"rgba(0,0,0,0.15)"}},"hide-triangle":{triangle:{display:"none"},triangleShadow:{display:"none"}},"top-left-triangle":{triangle:{top:"-14px",left:"10px"},triangleShadow:{top:"-16px",left:"9px"}},"top-right-triangle":{triangle:{top:"-14px",right:"10px"},triangleShadow:{top:"-16px",right:"9px"}},"bottom-left-triangle":{triangle:{top:"35px",left:"10px",transform:"rotate(180deg)"},triangleShadow:{top:"37px",left:"9px",transform:"rotate(180deg)"}},"bottom-right-triangle":{triangle:{top:"35px",right:"10px",transform:"rotate(180deg)"},triangleShadow:{top:"37px",right:"9px",transform:"rotate(180deg)"}}},c),{"hide-triangle":a==="hide","top-left-triangle":a==="top-left","top-right-triangle":a==="top-right","bottom-left-triangle":a==="bottom-left","bottom-right-triangle":a==="bottom-right"}),h=function(g,m){return i({hex:g,source:"hex"},m)};return D.createElement("div",{style:f.card,className:"github-picker "+u},D.createElement("div",{style:f.triangleShadow}),D.createElement("div",{style:f.triangle}),Ss(n,function(p){return D.createElement(DB,{color:p,key:p,onClick:h,onSwatchHover:s})}))};qp.propTypes={width:Ee.oneOfType([Ee.string,Ee.number]),colors:Ee.arrayOf(Ee.string),triangle:Ee.oneOf(["hide","top-left","top-right","bottom-left","bottom-right"]),styles:Ee.object};qp.defaultProps={width:200,colors:["#B80000","#DB3E00","#FCCB00","#008B02","#006B76","#1273DE","#004DCF","#5300EB","#EB9694","#FAD0C3","#FEF3BD","#C1E1C5","#BEDADC","#C4DEF6","#BED3F3","#D4C4FB"],triangle:"top-left",styles:{}};br(qp);var zB=function(t){var r=t.direction,n=Ye({default:{picker:{width:"18px",height:"18px",borderRadius:"50%",transform:"translate(-9px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}},vertical:{picker:{transform:"translate(-3px, -9px)"}}},{vertical:r==="vertical"});return D.createElement("div",{style:n.picker})},FB=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Yp=function(t){var r=t.width,n=t.height,i=t.onChange,s=t.hsl,a=t.direction,l=t.pointer,c=t.styles,d=c===void 0?{}:c,u=t.className,f=u===void 0?"":u,h=Ye(xr({default:{picker:{position:"relative",width:r,height:n},hue:{radius:"2px"}}},d)),p=function(m){return i({a:1,h:m.h,l:.5,s:1})};return D.createElement("div",{style:h.picker,className:"hue-picker "+f},D.createElement(Wo,FB({},h.hue,{hsl:s,pointer:l,onChange:p,direction:a})))};Yp.propTypes={styles:Ee.object};Yp.defaultProps={width:"316px",height:"16px",direction:"horizontal",pointer:zB,styles:{}};br(Yp);var BB=function(t){var r=t.onChange,n=t.hex,i=t.rgb,s=t.styles,a=s===void 0?{}:s,l=t.className,c=l===void 0?"":l,d=Ye(xr({default:{material:{width:"98px",height:"98px",padding:"16px",fontFamily:"Roboto"},HEXwrap:{position:"relative"},HEXinput:{width:"100%",marginTop:"12px",fontSize:"15px",color:"#333",padding:"0px",border:"0px",borderBottom:"2px solid "+n,outline:"none",height:"30px"},HEXlabel:{position:"absolute",top:"0px",left:"0px",fontSize:"11px",color:"#999999",textTransform:"capitalize"},Hex:{style:{}},RGBwrap:{position:"relative"},RGBinput:{width:"100%",marginTop:"12px",fontSize:"15px",color:"#333",padding:"0px",border:"0px",borderBottom:"1px solid #eee",outline:"none",height:"30px"},RGBlabel:{position:"absolute",top:"0px",left:"0px",fontSize:"11px",color:"#999999",textTransform:"capitalize"},split:{display:"flex",marginRight:"-10px",paddingTop:"11px"},third:{flex:"1",paddingRight:"10px"}}},a)),u=function(h,p){h.hex?Fi(h.hex)&&r({hex:h.hex,source:"hex"},p):(h.r||h.g||h.b)&&r({r:h.r||i.r,g:h.g||i.g,b:h.b||i.b,source:"rgb"},p)};return D.createElement(vl,{styles:a},D.createElement("div",{style:d.material,className:"material-picker "+c},D.createElement(it,{style:{wrap:d.HEXwrap,input:d.HEXinput,label:d.HEXlabel},label:"hex",value:n,onChange:u}),D.createElement("div",{style:d.split,className:"flexbox-fix"},D.createElement("div",{style:d.third},D.createElement(it,{style:{wrap:d.RGBwrap,input:d.RGBinput,label:d.RGBlabel},label:"r",value:i.r,onChange:u})),D.createElement("div",{style:d.third},D.createElement(it,{style:{wrap:d.RGBwrap,input:d.RGBinput,label:d.RGBlabel},label:"g",value:i.g,onChange:u})),D.createElement("div",{style:d.third},D.createElement(it,{style:{wrap:d.RGBwrap,input:d.RGBinput,label:d.RGBlabel},label:"b",value:i.b,onChange:u})))))};br(BB);var HB=function(t){var r=t.onChange,n=t.rgb,i=t.hsv,s=t.hex,a=Ye({default:{fields:{paddingTop:"5px",paddingBottom:"9px",width:"80px",position:"relative"},divider:{height:"5px"},RGBwrap:{position:"relative"},RGBinput:{marginLeft:"40%",width:"40%",height:"18px",border:"1px solid #888888",boxShadow:"inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC",marginBottom:"5px",fontSize:"13px",paddingLeft:"3px",marginRight:"10px"},RGBlabel:{left:"0px",top:"0px",width:"34px",textTransform:"uppercase",fontSize:"13px",height:"18px",lineHeight:"22px",position:"absolute"},HEXwrap:{position:"relative"},HEXinput:{marginLeft:"20%",width:"80%",height:"18px",border:"1px solid #888888",boxShadow:"inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC",marginBottom:"6px",fontSize:"13px",paddingLeft:"3px"},HEXlabel:{position:"absolute",top:"0px",left:"0px",width:"14px",textTransform:"uppercase",fontSize:"13px",height:"18px",lineHeight:"22px"},fieldSymbols:{position:"absolute",top:"5px",right:"-7px",fontSize:"13px"},symbol:{height:"20px",lineHeight:"22px",paddingBottom:"7px"}}}),l=function(d,u){d["#"]?Fi(d["#"])&&r({hex:d["#"],source:"hex"},u):d.r||d.g||d.b?r({r:d.r||n.r,g:d.g||n.g,b:d.b||n.b,source:"rgb"},u):(d.h||d.s||d.v)&&r({h:d.h||i.h,s:d.s||i.s,v:d.v||i.v,source:"hsv"},u)};return D.createElement("div",{style:a.fields},D.createElement(it,{style:{wrap:a.RGBwrap,input:a.RGBinput,label:a.RGBlabel},label:"h",value:Math.round(i.h),onChange:l}),D.createElement(it,{style:{wrap:a.RGBwrap,input:a.RGBinput,label:a.RGBlabel},label:"s",value:Math.round(i.s*100),onChange:l}),D.createElement(it,{style:{wrap:a.RGBwrap,input:a.RGBinput,label:a.RGBlabel},label:"v",value:Math.round(i.v*100),onChange:l}),D.createElement("div",{style:a.divider}),D.createElement(it,{style:{wrap:a.RGBwrap,input:a.RGBinput,label:a.RGBlabel},label:"r",value:n.r,onChange:l}),D.createElement(it,{style:{wrap:a.RGBwrap,input:a.RGBinput,label:a.RGBlabel},label:"g",value:n.g,onChange:l}),D.createElement(it,{style:{wrap:a.RGBwrap,input:a.RGBinput,label:a.RGBlabel},label:"b",value:n.b,onChange:l}),D.createElement("div",{style:a.divider}),D.createElement(it,{style:{wrap:a.HEXwrap,input:a.HEXinput,label:a.HEXlabel},label:"#",value:s.replace("#",""),onChange:l}),D.createElement("div",{style:a.fieldSymbols},D.createElement("div",{style:a.symbol},""),D.createElement("div",{style:a.symbol},"%"),D.createElement("div",{style:a.symbol},"%")))},UB=function(t){var r=t.hsl,n=Ye({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",boxShadow:"inset 0 0 0 1px #fff",transform:"translate(-6px, -6px)"}},"black-outline":{picker:{boxShadow:"inset 0 0 0 1px #000"}}},{"black-outline":r.l>.5});return D.createElement("div",{style:n.picker})},WB=function(){var t=Ye({default:{triangle:{width:0,height:0,borderStyle:"solid",borderWidth:"4px 0 4px 6px",borderColor:"transparent transparent transparent #fff",position:"absolute",top:"1px",left:"1px"},triangleBorder:{width:0,height:0,borderStyle:"solid",borderWidth:"5px 0 5px 8px",borderColor:"transparent transparent transparent #555"},left:{Extend:"triangleBorder",transform:"translate(-13px, -4px)"},leftInside:{Extend:"triangle",transform:"translate(-8px, -5px)"},right:{Extend:"triangleBorder",transform:"translate(20px, -14px) rotate(180deg)"},rightInside:{Extend:"triangle",transform:"translate(-8px, -5px)"}}});return D.createElement("div",{style:t.pointer},D.createElement("div",{style:t.left},D.createElement("div",{style:t.leftInside})),D.createElement("div",{style:t.right},D.createElement("div",{style:t.rightInside})))},Bv=function(t){var r=t.onClick,n=t.label,i=t.children,s=t.active,a=Ye({default:{button:{backgroundImage:"linear-gradient(-180deg, #FFFFFF 0%, #E6E6E6 100%)",border:"1px solid #878787",borderRadius:"2px",height:"20px",boxShadow:"0 1px 0 0 #EAEAEA",fontSize:"14px",color:"#000",lineHeight:"20px",textAlign:"center",marginBottom:"10px",cursor:"pointer"}},active:{button:{boxShadow:"0 0 0 1px #878787"}}},{active:s});return D.createElement("div",{style:a.button,onClick:r},n||i)},GB=function(t){var r=t.rgb,n=t.currentColor,i=Ye({default:{swatches:{border:"1px solid #B3B3B3",borderBottom:"1px solid #F0F0F0",marginBottom:"2px",marginTop:"1px"},new:{height:"34px",background:"rgb("+r.r+","+r.g+", "+r.b+")",boxShadow:"inset 1px 0 0 #000, inset -1px 0 0 #000, inset 0 1px 0 #000"},current:{height:"34px",background:n,boxShadow:"inset 1px 0 0 #000, inset -1px 0 0 #000, inset 0 -1px 0 #000"},label:{fontSize:"14px",color:"#000",textAlign:"center"}}});return D.createElement("div",null,D.createElement("div",{style:i.label},"new"),D.createElement("div",{style:i.swatches},D.createElement("div",{style:i.new}),D.createElement("div",{style:i.current})),D.createElement("div",{style:i.label},"current"))},VB=function(){function e(t,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function qB(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YB(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e}function XB(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var Xp=function(e){XB(t,e);function t(r){qB(this,t);var n=YB(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.state={currentColor:r.hex},n}return VB(t,[{key:"render",value:function(){var n=this.props,i=n.styles,s=i===void 0?{}:i,a=n.className,l=a===void 0?"":a,c=Ye(xr({default:{picker:{background:"#DCDCDC",borderRadius:"4px",boxShadow:"0 0 0 1px rgba(0,0,0,.25), 0 8px 16px rgba(0,0,0,.15)",boxSizing:"initial",width:"513px"},head:{backgroundImage:"linear-gradient(-180deg, #F0F0F0 0%, #D4D4D4 100%)",borderBottom:"1px solid #B1B1B1",boxShadow:"inset 0 1px 0 0 rgba(255,255,255,.2), inset 0 -1px 0 0 rgba(0,0,0,.02)",height:"23px",lineHeight:"24px",borderRadius:"4px 4px 0 0",fontSize:"13px",color:"#4D4D4D",textAlign:"center"},body:{padding:"15px 15px 0",display:"flex"},saturation:{width:"256px",height:"256px",position:"relative",border:"2px solid #B3B3B3",borderBottom:"2px solid #F0F0F0",overflow:"hidden"},hue:{position:"relative",height:"256px",width:"19px",marginLeft:"10px",border:"2px solid #B3B3B3",borderBottom:"2px solid #F0F0F0"},controls:{width:"180px",marginLeft:"10px"},top:{display:"flex"},previews:{width:"60px"},actions:{flex:"1",marginLeft:"20px"}}},s));return D.createElement("div",{style:c.picker,className:"photoshop-picker "+l},D.createElement("div",{style:c.head},this.props.header),D.createElement("div",{style:c.body,className:"flexbox-fix"},D.createElement("div",{style:c.saturation},D.createElement(Od,{hsl:this.props.hsl,hsv:this.props.hsv,pointer:UB,onChange:this.props.onChange})),D.createElement("div",{style:c.hue},D.createElement(Wo,{direction:"vertical",hsl:this.props.hsl,pointer:WB,onChange:this.props.onChange})),D.createElement("div",{style:c.controls},D.createElement("div",{style:c.top,className:"flexbox-fix"},D.createElement("div",{style:c.previews},D.createElement(GB,{rgb:this.props.rgb,currentColor:this.state.currentColor})),D.createElement("div",{style:c.actions},D.createElement(Bv,{label:"OK",onClick:this.props.onAccept,active:!0}),D.createElement(Bv,{label:"Cancel",onClick:this.props.onCancel}),D.createElement(HB,{onChange:this.props.onChange,rgb:this.props.rgb,hsv:this.props.hsv,hex:this.props.hex}))))))}}]),t}(D.Component);Xp.propTypes={header:Ee.string,styles:Ee.object};Xp.defaultProps={header:"Color Picker",styles:{}};br(Xp);var KB=function(t){var r=t.onChange,n=t.rgb,i=t.hsl,s=t.hex,a=t.disableAlpha,l=Ye({default:{fields:{display:"flex",paddingTop:"4px"},single:{flex:"1",paddingLeft:"6px"},alpha:{flex:"1",paddingLeft:"6px"},double:{flex:"2"},input:{width:"80%",padding:"4px 10% 3px",border:"none",boxShadow:"inset 0 0 0 1px #ccc",fontSize:"11px"},label:{display:"block",textAlign:"center",fontSize:"11px",color:"#222",paddingTop:"3px",paddingBottom:"4px",textTransform:"capitalize"}},disableAlpha:{alpha:{display:"none"}}},{disableAlpha:a}),c=function(u,f){u.hex?Fi(u.hex)&&r({hex:u.hex,source:"hex"},f):u.r||u.g||u.b?r({r:u.r||n.r,g:u.g||n.g,b:u.b||n.b,a:n.a,source:"rgb"},f):u.a&&(u.a<0?u.a=0:u.a>100&&(u.a=100),u.a/=100,r({h:i.h,s:i.s,l:i.l,a:u.a,source:"rgb"},f))};return D.createElement("div",{style:l.fields,className:"flexbox-fix"},D.createElement("div",{style:l.double},D.createElement(it,{style:{input:l.input,label:l.label},label:"hex",value:s.replace("#",""),onChange:c})),D.createElement("div",{style:l.single},D.createElement(it,{style:{input:l.input,label:l.label},label:"r",value:n.r,onChange:c,dragLabel:"true",dragMax:"255"})),D.createElement("div",{style:l.single},D.createElement(it,{style:{input:l.input,label:l.label},label:"g",value:n.g,onChange:c,dragLabel:"true",dragMax:"255"})),D.createElement("div",{style:l.single},D.createElement(it,{style:{input:l.input,label:l.label},label:"b",value:n.b,onChange:c,dragLabel:"true",dragMax:"255"})),D.createElement("div",{style:l.alpha},D.createElement(it,{style:{input:l.input,label:l.label},label:"a",value:Math.round(n.a*100),onChange:c,dragLabel:"true",dragMax:"100"})))},ZB=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},V1=function(t){var r=t.colors,n=t.onClick,i=n===void 0?function(){}:n,s=t.onSwatchHover,a=Ye({default:{colors:{margin:"0 -10px",padding:"10px 0 0 10px",borderTop:"1px solid #eee",display:"flex",flexWrap:"wrap",position:"relative"},swatchWrap:{width:"16px",height:"16px",margin:"0 10px 10px 0"},swatch:{borderRadius:"3px",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15)"}},"no-presets":{colors:{display:"none"}}},{"no-presets":!r||!r.length}),l=function(d,u){i({hex:d,source:"hex"},u)};return D.createElement("div",{style:a.colors,className:"flexbox-fix"},r.map(function(c){var d=typeof c=="string"?{color:c}:c,u=""+d.color+(d.title||"");return D.createElement("div",{key:u,style:a.swatchWrap},D.createElement(_s,ZB({},d,{style:a.swatch,onClick:l,onHover:s,focusStyle:{boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15), 0 0 4px "+d.color}})))}))};V1.propTypes={colors:Ee.arrayOf(Ee.oneOfType([Ee.string,Ee.shape({color:Ee.string,title:Ee.string})])).isRequired};var JB=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Kp=function(t){var r=t.width,n=t.rgb,i=t.hex,s=t.hsv,a=t.hsl,l=t.onChange,c=t.onSwatchHover,d=t.disableAlpha,u=t.presetColors,f=t.renderers,h=t.styles,p=h===void 0?{}:h,g=t.className,m=g===void 0?"":g,x=Ye(xr({default:JB({picker:{width:r,padding:"10px 10px 0",boxSizing:"initial",background:"#fff",borderRadius:"4px",boxShadow:"0 0 0 1px rgba(0,0,0,.15), 0 8px 16px rgba(0,0,0,.15)"},saturation:{width:"100%",paddingBottom:"75%",position:"relative",overflow:"hidden"},Saturation:{radius:"3px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},controls:{display:"flex"},sliders:{padding:"4px 0",flex:"1"},color:{width:"24px",height:"24px",position:"relative",marginTop:"4px",marginLeft:"4px",borderRadius:"3px"},activeColor:{absolute:"0px 0px 0px 0px",borderRadius:"2px",background:"rgba("+n.r+","+n.g+","+n.b+","+n.a+")",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},hue:{position:"relative",height:"10px",overflow:"hidden"},Hue:{radius:"2px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},alpha:{position:"relative",height:"10px",marginTop:"4px",overflow:"hidden"},Alpha:{radius:"2px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"}},p),disableAlpha:{color:{height:"10px"},hue:{height:"10px"},alpha:{display:"none"}}},p),{disableAlpha:d});return D.createElement("div",{style:x.picker,className:"sketch-picker "+m},D.createElement("div",{style:x.saturation},D.createElement(Od,{style:x.Saturation,hsl:a,hsv:s,onChange:l})),D.createElement("div",{style:x.controls,className:"flexbox-fix"},D.createElement("div",{style:x.sliders},D.createElement("div",{style:x.hue},D.createElement(Wo,{style:x.Hue,hsl:a,onChange:l})),D.createElement("div",{style:x.alpha},D.createElement(Rp,{style:x.Alpha,rgb:n,hsl:a,renderers:f,onChange:l}))),D.createElement("div",{style:x.color},D.createElement(Uo,null),D.createElement("div",{style:x.activeColor}))),D.createElement(KB,{rgb:n,hsl:a,hex:i,onChange:l,disableAlpha:d}),D.createElement(V1,{colors:u,onClick:l,onSwatchHover:c}))};Kp.propTypes={disableAlpha:Ee.bool,width:Ee.oneOfType([Ee.string,Ee.number]),styles:Ee.object};Kp.defaultProps={disableAlpha:!1,width:200,styles:{},presetColors:["#D0021B","#F5A623","#F8E71C","#8B572A","#7ED321","#417505","#BD10E0","#9013FE","#4A90E2","#50E3C2","#B8E986","#000000","#4A4A4A","#9B9B9B","#FFFFFF"]};br(Kp);var ca=function(t){var r=t.hsl,n=t.offset,i=t.onClick,s=i===void 0?function(){}:i,a=t.active,l=t.first,c=t.last,d=Ye({default:{swatch:{height:"12px",background:"hsl("+r.h+", 50%, "+n*100+"%)",cursor:"pointer"}},first:{swatch:{borderRadius:"2px 0 0 2px"}},last:{swatch:{borderRadius:"0 2px 2px 0"}},active:{swatch:{transform:"scaleY(1.8)",borderRadius:"3.6px/2px"}}},{active:a,first:l,last:c}),u=function(h){return s({h:r.h,s:.5,l:n,source:"hsl"},h)};return D.createElement("div",{style:d.swatch,onClick:u})},QB=function(t){var r=t.onClick,n=t.hsl,i=Ye({default:{swatches:{marginTop:"20px"},swatch:{boxSizing:"border-box",width:"20%",paddingRight:"1px",float:"left"},clear:{clear:"both"}}}),s=.1;return D.createElement("div",{style:i.swatches},D.createElement("div",{style:i.swatch},D.createElement(ca,{hsl:n,offset:".80",active:Math.abs(n.l-.8)<s&&Math.abs(n.s-.5)<s,onClick:r,first:!0})),D.createElement("div",{style:i.swatch},D.createElement(ca,{hsl:n,offset:".65",active:Math.abs(n.l-.65)<s&&Math.abs(n.s-.5)<s,onClick:r})),D.createElement("div",{style:i.swatch},D.createElement(ca,{hsl:n,offset:".50",active:Math.abs(n.l-.5)<s&&Math.abs(n.s-.5)<s,onClick:r})),D.createElement("div",{style:i.swatch},D.createElement(ca,{hsl:n,offset:".35",active:Math.abs(n.l-.35)<s&&Math.abs(n.s-.5)<s,onClick:r})),D.createElement("div",{style:i.swatch},D.createElement(ca,{hsl:n,offset:".20",active:Math.abs(n.l-.2)<s&&Math.abs(n.s-.5)<s,onClick:r,last:!0})),D.createElement("div",{style:i.clear}))},eH=function(){var t=Ye({default:{picker:{width:"14px",height:"14px",borderRadius:"6px",transform:"translate(-7px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}}});return D.createElement("div",{style:t.picker})},Zp=function(t){var r=t.hsl,n=t.onChange,i=t.pointer,s=t.styles,a=s===void 0?{}:s,l=t.className,c=l===void 0?"":l,d=Ye(xr({default:{hue:{height:"12px",position:"relative"},Hue:{radius:"2px"}}},a));return D.createElement("div",{style:d.wrap||{},className:"slider-picker "+c},D.createElement("div",{style:d.hue},D.createElement(Wo,{style:d.Hue,hsl:r,pointer:i,onChange:n})),D.createElement("div",{style:d.swatches},D.createElement(QB,{hsl:r,onClick:n})))};Zp.propTypes={styles:Ee.object};Zp.defaultProps={pointer:eH,styles:{}};br(Zp);var q1={};Object.defineProperty(q1,"__esModule",{value:!0});var Hv=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},tH=A,Uv=rH(tH);function rH(e){return e&&e.__esModule?e:{default:e}}function nH(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}var Zl=24,iH=q1.default=function(e){var t=e.fill,r=t===void 0?"currentColor":t,n=e.width,i=n===void 0?Zl:n,s=e.height,a=s===void 0?Zl:s,l=e.style,c=l===void 0?{}:l,d=nH(e,["fill","width","height","style"]);return Uv.default.createElement("svg",Hv({viewBox:"0 0 "+Zl+" "+Zl,style:Hv({fill:r,width:i,height:a},c)},d),Uv.default.createElement("path",{d:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"}))},sH=function(t){var r=t.color,n=t.onClick,i=n===void 0?function(){}:n,s=t.onSwatchHover,a=t.first,l=t.last,c=t.active,d=Ye({default:{color:{width:"40px",height:"24px",cursor:"pointer",background:r,marginBottom:"1px"},check:{color:zp(r),marginLeft:"8px",display:"none"}},first:{color:{overflow:"hidden",borderRadius:"2px 2px 0 0"}},last:{color:{overflow:"hidden",borderRadius:"0 0 2px 2px"}},active:{check:{display:"block"}},"color-#FFFFFF":{color:{boxShadow:"inset 0 0 0 1px #ddd"},check:{color:"#333"}},transparent:{check:{color:"#333"}}},{first:a,last:l,active:c,"color-#FFFFFF":r==="#FFFFFF",transparent:r==="transparent"});return D.createElement(_s,{color:r,style:d.color,onClick:i,onHover:s,focusStyle:{boxShadow:"0 0 4px "+r}},D.createElement("div",{style:d.check},D.createElement(iH,null)))},oH=function(t){var r=t.onClick,n=t.onSwatchHover,i=t.group,s=t.active,a=Ye({default:{group:{paddingBottom:"10px",width:"40px",float:"left",marginRight:"10px"}}});return D.createElement("div",{style:a.group},Ss(i,function(l,c){return D.createElement(sH,{key:l,color:l,active:l.toLowerCase()===s,first:c===0,last:c===i.length-1,onClick:r,onSwatchHover:n})}))},Jp=function(t){var r=t.width,n=t.height,i=t.onChange,s=t.onSwatchHover,a=t.colors,l=t.hex,c=t.styles,d=c===void 0?{}:c,u=t.className,f=u===void 0?"":u,h=Ye(xr({default:{picker:{width:r,height:n},overflow:{height:n,overflowY:"scroll"},body:{padding:"16px 0 6px 16px"},clear:{clear:"both"}}},d)),p=function(m,x){return i({hex:m,source:"hex"},x)};return D.createElement("div",{style:h.picker,className:"swatches-picker "+f},D.createElement(vl,null,D.createElement("div",{style:h.overflow},D.createElement("div",{style:h.body},Ss(a,function(g){return D.createElement(oH,{key:g.toString(),group:g,active:l,onClick:p,onSwatchHover:s})}),D.createElement("div",{style:h.clear})))))};Jp.propTypes={width:Ee.oneOfType([Ee.string,Ee.number]),height:Ee.oneOfType([Ee.string,Ee.number]),colors:Ee.arrayOf(Ee.arrayOf(Ee.string)),styles:Ee.object};Jp.defaultProps={width:320,height:240,colors:[[Is[900],Is[700],Is[500],Is[300],Is[100]],[Ds[900],Ds[700],Ds[500],Ds[300],Ds[100]],[zs[900],zs[700],zs[500],zs[300],zs[100]],[Fs[900],Fs[700],Fs[500],Fs[300],Fs[100]],[Bs[900],Bs[700],Bs[500],Bs[300],Bs[100]],[Hs[900],Hs[700],Hs[500],Hs[300],Hs[100]],[Us[900],Us[700],Us[500],Us[300],Us[100]],[Ws[900],Ws[700],Ws[500],Ws[300],Ws[100]],[Gs[900],Gs[700],Gs[500],Gs[300],Gs[100]],["#194D33",xa[700],xa[500],xa[300],xa[100]],[Vs[900],Vs[700],Vs[500],Vs[300],Vs[100]],[qs[900],qs[700],qs[500],qs[300],qs[100]],[Ys[900],Ys[700],Ys[500],Ys[300],Ys[100]],[Xs[900],Xs[700],Xs[500],Xs[300],Xs[100]],[Ks[900],Ks[700],Ks[500],Ks[300],Ks[100]],[Zs[900],Zs[700],Zs[500],Zs[300],Zs[100]],[Js[900],Js[700],Js[500],Js[300],Js[100]],[Qs[900],Qs[700],Qs[500],Qs[300],Qs[100]],["#000000","#525252","#969696","#D9D9D9","#FFFFFF"]],styles:{}};br(Jp);var Qp=function(t){var r=t.onChange,n=t.onSwatchHover,i=t.hex,s=t.colors,a=t.width,l=t.triangle,c=t.styles,d=c===void 0?{}:c,u=t.className,f=u===void 0?"":u,h=Ye(xr({default:{card:{width:a,background:"#fff",border:"0 solid rgba(0,0,0,0.25)",boxShadow:"0 1px 4px rgba(0,0,0,0.25)",borderRadius:"4px",position:"relative"},body:{padding:"15px 9px 9px 15px"},label:{fontSize:"18px",color:"#fff"},triangle:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 9px 10px 9px",borderColor:"transparent transparent #fff transparent",position:"absolute"},triangleShadow:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 9px 10px 9px",borderColor:"transparent transparent rgba(0,0,0,.1) transparent",position:"absolute"},hash:{background:"#F0F0F0",height:"30px",width:"30px",borderRadius:"4px 0 0 4px",float:"left",color:"#98A1A4",display:"flex",alignItems:"center",justifyContent:"center"},input:{width:"100px",fontSize:"14px",color:"#666",border:"0px",outline:"none",height:"28px",boxShadow:"inset 0 0 0 1px #F0F0F0",boxSizing:"content-box",borderRadius:"0 4px 4px 0",float:"left",paddingLeft:"8px"},swatch:{width:"30px",height:"30px",float:"left",borderRadius:"4px",margin:"0 6px 6px 0"},clear:{clear:"both"}},"hide-triangle":{triangle:{display:"none"},triangleShadow:{display:"none"}},"top-left-triangle":{triangle:{top:"-10px",left:"12px"},triangleShadow:{top:"-11px",left:"12px"}},"top-right-triangle":{triangle:{top:"-10px",right:"12px"},triangleShadow:{top:"-11px",right:"12px"}}},d),{"hide-triangle":l==="hide","top-left-triangle":l==="top-left","top-right-triangle":l==="top-right"}),p=function(m,x){Fi(m)&&r({hex:m,source:"hex"},x)};return D.createElement("div",{style:h.card,className:"twitter-picker "+f},D.createElement("div",{style:h.triangleShadow}),D.createElement("div",{style:h.triangle}),D.createElement("div",{style:h.body},Ss(s,function(g,m){return D.createElement(_s,{key:m,color:g,hex:g,style:h.swatch,onClick:p,onHover:n,focusStyle:{boxShadow:"0 0 4px "+g}})}),D.createElement("div",{style:h.hash},"#"),D.createElement(it,{label:null,style:{input:h.input},value:i.replace("#",""),onChange:p}),D.createElement("div",{style:h.clear})))};Qp.propTypes={width:Ee.oneOfType([Ee.string,Ee.number]),triangle:Ee.oneOf(["hide","top-left","top-right"]),colors:Ee.arrayOf(Ee.string),styles:Ee.object};Qp.defaultProps={width:276,colors:["#FF6900","#FCB900","#7BDCB5","#00D084","#8ED1FC","#0693E3","#ABB8C3","#EB144C","#F78DA7","#9900EF"],triangle:"top-left",styles:{}};br(Qp);var em=function(t){var r=Ye({default:{picker:{width:"20px",height:"20px",borderRadius:"22px",border:"2px #fff solid",transform:"translate(-12px, -13px)",background:"hsl("+Math.round(t.hsl.h)+", "+Math.round(t.hsl.s*100)+"%, "+Math.round(t.hsl.l*100)+"%)"}}});return D.createElement("div",{style:r.picker})};em.propTypes={hsl:Ee.shape({h:Ee.number,s:Ee.number,l:Ee.number,a:Ee.number})};em.defaultProps={hsl:{a:1,h:249.94,l:.2,s:.5}};var tm=function(t){var r=Ye({default:{picker:{width:"20px",height:"20px",borderRadius:"22px",transform:"translate(-10px, -7px)",background:"hsl("+Math.round(t.hsl.h)+", 100%, 50%)",border:"2px white solid"}}});return D.createElement("div",{style:r.picker})};tm.propTypes={hsl:Ee.shape({h:Ee.number,s:Ee.number,l:Ee.number,a:Ee.number})};tm.defaultProps={hsl:{a:1,h:249.94,l:.2,s:.5}};var aH=function(t){var r=t.onChange,n=t.rgb,i=t.hsl,s=t.hex,a=t.hsv,l=function(p,g){if(p.hex)Fi(p.hex)&&r({hex:p.hex,source:"hex"},g);else if(p.rgb){var m=p.rgb.split(",");Mu(p.rgb,"rgb")&&r({r:m[0],g:m[1],b:m[2],a:1,source:"rgb"},g)}else if(p.hsv){var x=p.hsv.split(",");Mu(p.hsv,"hsv")&&(x[2]=x[2].replace("%",""),x[1]=x[1].replace("%",""),x[0]=x[0].replace("",""),x[1]==1?x[1]=.01:x[2]==1&&(x[2]=.01),r({h:Number(x[0]),s:Number(x[1]),v:Number(x[2]),source:"hsv"},g))}else if(p.hsl){var v=p.hsl.split(",");Mu(p.hsl,"hsl")&&(v[2]=v[2].replace("%",""),v[1]=v[1].replace("%",""),v[0]=v[0].replace("",""),f[1]==1?f[1]=.01:f[2]==1&&(f[2]=.01),r({h:Number(v[0]),s:Number(v[1]),v:Number(v[2]),source:"hsl"},g))}},c=Ye({default:{wrap:{display:"flex",height:"100px",marginTop:"4px"},fields:{width:"100%"},column:{paddingTop:"10px",display:"flex",justifyContent:"space-between"},double:{padding:"0px 4.4px",boxSizing:"border-box"},input:{width:"100%",height:"38px",boxSizing:"border-box",padding:"4px 10% 3px",textAlign:"center",border:"1px solid #dadce0",fontSize:"11px",textTransform:"lowercase",borderRadius:"5px",outline:"none",fontFamily:"Roboto,Arial,sans-serif"},input2:{height:"38px",width:"100%",border:"1px solid #dadce0",boxSizing:"border-box",fontSize:"11px",textTransform:"lowercase",borderRadius:"5px",outline:"none",paddingLeft:"10px",fontFamily:"Roboto,Arial,sans-serif"},label:{textAlign:"center",fontSize:"12px",background:"#fff",position:"absolute",textTransform:"uppercase",color:"#3c4043",width:"35px",top:"-6px",left:"0",right:"0",marginLeft:"auto",marginRight:"auto",fontFamily:"Roboto,Arial,sans-serif"},label2:{left:"10px",textAlign:"center",fontSize:"12px",background:"#fff",position:"absolute",textTransform:"uppercase",color:"#3c4043",width:"32px",top:"-6px",fontFamily:"Roboto,Arial,sans-serif"},single:{flexGrow:"1",margin:"0px 4.4px"}}}),d=n.r+", "+n.g+", "+n.b,u=Math.round(i.h)+", "+Math.round(i.s*100)+"%, "+Math.round(i.l*100)+"%",f=Math.round(a.h)+", "+Math.round(a.s*100)+"%, "+Math.round(a.v*100)+"%";return D.createElement("div",{style:c.wrap,className:"flexbox-fix"},D.createElement("div",{style:c.fields},D.createElement("div",{style:c.double},D.createElement(it,{style:{input:c.input,label:c.label},label:"hex",value:s,onChange:l})),D.createElement("div",{style:c.column},D.createElement("div",{style:c.single},D.createElement(it,{style:{input:c.input2,label:c.label2},label:"rgb",value:d,onChange:l})),D.createElement("div",{style:c.single},D.createElement(it,{style:{input:c.input2,label:c.label2},label:"hsv",value:f,onChange:l})),D.createElement("div",{style:c.single},D.createElement(it,{style:{input:c.input2,label:c.label2},label:"hsl",value:u,onChange:l})))))},rm=function(t){var r=t.width,n=t.onChange,i=t.rgb,s=t.hsl,a=t.hsv,l=t.hex,c=t.header,d=t.styles,u=d===void 0?{}:d,f=t.className,h=f===void 0?"":f,p=Ye(xr({default:{picker:{width:r,background:"#fff",border:"1px solid #dfe1e5",boxSizing:"initial",display:"flex",flexWrap:"wrap",borderRadius:"8px 8px 0px 0px"},head:{height:"57px",width:"100%",paddingTop:"16px",paddingBottom:"16px",paddingLeft:"16px",fontSize:"20px",boxSizing:"border-box",fontFamily:"Roboto-Regular,HelveticaNeue,Arial,sans-serif"},saturation:{width:"70%",padding:"0px",position:"relative",overflow:"hidden"},swatch:{width:"30%",height:"228px",padding:"0px",background:"rgba("+i.r+", "+i.g+", "+i.b+", 1)",position:"relative",overflow:"hidden"},body:{margin:"auto",width:"95%"},controls:{display:"flex",boxSizing:"border-box",height:"52px",paddingTop:"22px"},color:{width:"32px"},hue:{height:"8px",position:"relative",margin:"0px 16px 0px 16px",width:"100%"},Hue:{radius:"2px"}}},u));return D.createElement("div",{style:p.picker,className:"google-picker "+h},D.createElement("div",{style:p.head},c),D.createElement("div",{style:p.swatch}),D.createElement("div",{style:p.saturation},D.createElement(Od,{hsl:s,hsv:a,pointer:em,onChange:n})),D.createElement("div",{style:p.body},D.createElement("div",{style:p.controls,className:"flexbox-fix"},D.createElement("div",{style:p.hue},D.createElement(Wo,{style:p.Hue,hsl:s,radius:"4px",pointer:tm,onChange:n}))),D.createElement(aH,{rgb:i,hsl:s,hex:l,hsv:a,onChange:n})))};rm.propTypes={width:Ee.oneOfType([Ee.string,Ee.number]),styles:Ee.object,header:Ee.string};rm.defaultProps={width:652,styles:{},header:"Color picker"};br(rm);function lH({color:e,mode:t="blend",onColorChange:r,onClose:n}){var u;const[i,s]=A.useState((e==null?void 0:e.hex)||"#000000");A.useEffect(()=>{e!=null&&e.hex&&s(e.hex)},[e==null?void 0:e.hex]);const a=()=>{e!=null&&e.originalHex&&(s(e.originalHex),r&&r(e.originalHex))},l=f=>{const h=f.hex;s(h),r&&r(h)},c=()=>{s("transparent"),r&&r("transparent")},d=i==="transparent"||i==="none";return e?o.jsxs("div",{className:"color-editor-panel",children:[o.jsxs("div",{className:"editor-header",children:[o.jsx("h3",{children:"Edit Colour"}),o.jsx("button",{onClick:n,className:"close-button",children:""})]}),o.jsxs("div",{className:"editor-content",children:[o.jsxs("div",{className:"color-info-section",children:[o.jsx("div",{className:"color-display",children:o.jsxs("div",{className:"swatch-pair",children:[o.jsxs("div",{className:"swatch-group",children:[o.jsx("div",{className:"swatch original",style:{backgroundColor:e.originalHex||e.hex},title:"Original colour"}),o.jsx("span",{className:"swatch-label",children:"Original"})]}),o.jsx("span",{className:"arrow",children:""}),o.jsxs("div",{className:"swatch-group",children:[o.jsx("div",{className:`swatch current ${d?"transparent-preview":""}`,style:d?{}:{backgroundColor:i},title:"Current colour"}),o.jsx("span",{className:"swatch-label",children:d?"Transparent":"Current"})]})]})}),o.jsxs("div",{className:"color-details",children:[o.jsxs("div",{className:"detail-row",children:[o.jsx("span",{className:"label",children:"Hex:"}),o.jsx("span",{className:"value",children:i})]}),o.jsxs("div",{className:"detail-row",children:[o.jsx("span",{className:"label",children:"Coverage:"}),o.jsxs("span",{className:"value",children:[((u=e.areaPct)==null?void 0:u.toFixed(1))||0,"%"]})]})]})]}),o.jsxs("div",{className:"transparent-section",children:[o.jsx("h4",{children:"Remove Fill"}),o.jsxs("button",{className:`transparent-option ${d?"selected":""}`,onClick:c,title:"Make this area transparent (remove fill)",children:[o.jsx("div",{className:"transparent-swatch"}),o.jsx("span",{children:"Make Transparent"})]})]}),o.jsxs("div",{className:"tpv-palette-section",children:[o.jsx("h4",{children:"Standard TPV Colours"}),o.jsx("p",{className:"palette-description",children:"Select a pure TPV colour (no blending required)"}),o.jsx("div",{className:"tpv-color-grid",children:cr.map(f=>o.jsxs("div",{className:`tpv-color-item ${i.toLowerCase()===f.hex.toLowerCase()?"selected":""}`,onClick:()=>l(f),title:`${f.code} - ${f.name}`,children:[o.jsx("div",{className:"tpv-color-swatch",style:{backgroundColor:f.hex}}),o.jsx("span",{className:"tpv-color-code",children:f.code})]},f.code))})]}),es.BLEND_MODE_ENABLED,o.jsxs("div",{className:"solid-mode-info",children:[o.jsx("h4",{children:"Solid Mode Editing"}),o.jsx("p",{className:"info-description",children:"Select from the standard TPV colours above. Only solid TPV colours are available."}),o.jsx("button",{onClick:a,className:"reset-button",children:"Reset to Original Colour"})]})]}),o.jsx("style",{jsx:!0,children:`
        .color-editor-panel {
          position: fixed;
          top: 0;
          right: 0;
          width: 400px;
          height: 100vh;
          background: white;
          box-shadow: -4px 0 12px rgba(0, 0, 0, 0.15);
          z-index: 1000;
          display: flex;
          flex-direction: column;
          overflow: hidden;
        }

        .editor-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 1.5rem;
          border-bottom: 2px solid #1a365d;
          background: #f9f9f9;
        }

        .editor-header h3 {
          font-family: 'Space Grotesk', sans-serif;
          margin: 0;
          color: #1e4a7a;
          font-size: 1.5rem;
          font-weight: 600;
        }

        .close-button {
          background: none;
          border: none;
          font-size: 2rem;
          color: #666;
          cursor: pointer;
          padding: 0;
          width: 32px;
          height: 32px;
          line-height: 1;
          transition: color 0.2s;
        }

        .close-button:hover {
          color: #333;
        }

        .editor-content {
          flex: 1;
          overflow-y: auto;
          padding: 1.5rem;
        }

        /* Color Info Section */
        .color-info-section {
          margin-bottom: 2rem;
          padding: 1rem;
          background: #f9f9f9;
          border-radius: 6px;
        }

        .color-display {
          margin-bottom: 1rem;
        }

        .swatch-pair {
          display: flex;
          align-items: center;
          gap: 1rem;
          justify-content: center;
        }

        .swatch-group {
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 0.5rem;
        }

        .swatch {
          width: 60px;
          height: 60px;
          border-radius: 8px;
          border: 3px solid #ddd;
          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .swatch.original {
          border-color: #999;
        }

        .swatch.current {
          border-color: #ff6b35;
        }

        .swatch.transparent-preview {
          background:
            linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%),
            linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%);
          background-size: 10px 10px;
          background-position: 0 0, 5px 5px;
          background-color: white;
        }

        .swatch-label {
          font-size: 0.85rem;
          color: #666;
          font-weight: 500;
        }

        .arrow {
          font-size: 1.5rem;
          color: #666;
          font-weight: bold;
        }

        .color-details {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .detail-row {
          display: flex;
          justify-content: space-between;
          align-items: center;
          font-size: 0.95rem;
        }

        .detail-row .label {
          font-weight: 600;
          color: #666;
        }

        .detail-row .value {
          font-family: 'Courier New', monospace;
          color: #333;
        }

        /* Transparent Section */
        .transparent-section {
          margin-bottom: 1.5rem;
          padding: 1rem;
          background: #f9f9f9;
          border-radius: 6px;
        }

        .transparent-section h4 {
          margin: 0 0 0.75rem 0;
          color: #1a365d;
          font-size: 1rem;
          font-weight: 600;
        }

        .transparent-option {
          display: flex;
          align-items: center;
          gap: 12px;
          width: 100%;
          padding: 12px 16px;
          background: white;
          border: 2px solid #d1d5db;
          border-radius: 8px;
          cursor: pointer;
          transition: all 0.2s;
          font-size: 0.95rem;
          font-weight: 500;
          color: #374151;
        }

        .transparent-option:hover {
          border-color: #6b7280;
          background: #fafafa;
        }

        .transparent-option.selected {
          border-color: #ff6b35;
          background: #fff5f0;
          box-shadow: 0 0 0 2px rgba(255, 107, 53, 0.2);
        }

        .transparent-swatch {
          width: 32px;
          height: 32px;
          border-radius: 4px;
          border: 1px solid #999;
          background:
            linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%),
            linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%);
          background-size: 8px 8px;
          background-position: 0 0, 4px 4px;
          background-color: white;
        }

        /* TPV Palette Section */
        .tpv-palette-section {
          margin-bottom: 2rem;
          padding: 1rem;
          background: #f9f9f9;
          border-radius: 6px;
        }

        .tpv-palette-section h4 {
          margin: 0 0 0.5rem 0;
          color: #1a365d;
          font-size: 1rem;
          font-weight: 600;
        }

        .palette-description {
          margin: 0 0 1rem 0;
          font-size: 0.85rem;
          color: #666;
        }

        .tpv-color-grid {
          display: grid;
          grid-template-columns: repeat(3, 1fr);
          gap: 0.75rem;
        }

        .tpv-color-item {
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 0.4rem;
          padding: 0.5rem;
          border: 2px solid transparent;
          border-radius: 6px;
          cursor: pointer;
          transition: all 0.2s;
          background: white;
        }

        .tpv-color-item:hover {
          border-color: #ff6b35;
          transform: translateY(-2px);
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .tpv-color-item.selected {
          border-color: #ff6b35;
          background: #fff5f0;
          box-shadow: 0 0 0 2px rgba(255, 107, 53, 0.2);
        }

        .tpv-color-swatch {
          width: 100%;
          height: 50px;
          border-radius: 4px;
          border: 1px solid rgba(0, 0, 0, 0.1);
          box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .tpv-color-code {
          font-size: 0.75rem;
          font-weight: 600;
          color: #1a365d;
          font-family: 'Courier New', monospace;
        }

        /* Picker Section */
        .picker-section {
          margin-bottom: 1rem;
          padding: 1rem;
          background: #f9f9f9;
          border-radius: 6px;
        }

        .picker-section h4 {
          margin: 0 0 0.5rem 0;
          color: #1a365d;
          font-size: 1rem;
          font-weight: 600;
        }

        .picker-description {
          margin: 0 0 1rem 0;
          font-size: 0.85rem;
          color: #666;
        }

        .picker-section :global(.chrome-picker) {
          box-shadow: none !important;
          width: 100% !important;
        }

        .reset-button {
          width: 100%;
          padding: 0.75rem;
          margin-top: 1rem;
          background: #e0e0e0;
          color: #333;
          border: none;
          border-radius: 4px;
          font-weight: 600;
          cursor: pointer;
          transition: background 0.2s;
        }

        .reset-button:hover {
          background: #d0d0d0;
        }

        /* Solid Mode Info */
        .solid-mode-info {
          margin-bottom: 1rem;
          padding: 1rem;
          background: #fff5f0;
          border: 2px solid #ff6b35;
          border-radius: 6px;
        }

        .solid-mode-info h4 {
          margin: 0 0 0.5rem 0;
          color: #1a365d;
          font-size: 1rem;
          font-weight: 600;
        }

        .info-description {
          margin: 0;
          font-size: 0.85rem;
          color: #666;
          line-height: 1.5;
        }

        /* Mobile Responsive - Fullscreen Modal */
        @media (max-width: 768px) {
          .color-editor-panel {
            width: 100%;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 0;
          }

          .editor-header {
            padding: 1rem;
            position: sticky;
            top: 0;
            z-index: 10;
          }

          .editor-header h3 {
            font-size: 1.25rem;
          }

          /* Larger close button for touch */
          .close-button {
            width: 44px;
            height: 44px;
            font-size: 2.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
          }

          .editor-content {
            padding: 1rem;
          }

          /* Color swatches - larger for touch */
          .swatch {
            width: 50px;
            height: 50px;
          }

          .color-info-section {
            padding: 0.75rem;
            margin-bottom: 1.5rem;
          }

          /* TPV color grid - better touch targets */
          .tpv-color-grid {
            grid-template-columns: repeat(4, 1fr);
            gap: 0.5rem;
          }

          .tpv-color-item {
            padding: 0.4rem;
            min-height: 44px;
          }

          .tpv-color-swatch {
            height: 36px;
          }

          .tpv-color-code {
            font-size: 0.65rem;
          }

          .tpv-palette-section {
            padding: 0.75rem;
            margin-bottom: 1.5rem;
          }

          .tpv-palette-section h4 {
            font-size: 0.9rem;
          }

          .palette-description {
            font-size: 0.8rem;
          }

          /* Picker section */
          .picker-section {
            padding: 0.75rem;
          }

          .picker-section h4 {
            font-size: 0.9rem;
          }

          .picker-description {
            font-size: 0.8rem;
          }

          /* Larger reset button for touch */
          .reset-button {
            min-height: 44px;
            font-size: 0.9rem;
          }

          .solid-mode-info {
            padding: 0.75rem;
          }

          .solid-mode-info h4 {
            font-size: 0.9rem;
          }

          .info-description {
            font-size: 0.8rem;
          }
        }

        /* Extra small screens */
        @media (max-width: 400px) {
          .tpv-color-grid {
            grid-template-columns: repeat(3, 1fr);
          }

          .tpv-color-swatch {
            height: 44px;
          }

          .swatch {
            width: 44px;
            height: 44px;
          }

          .swatch-pair {
            gap: 0.5rem;
          }

          .arrow {
            font-size: 1.2rem;
          }
        }
      `})]}):null}const cH=cr;new Map(cH.map((e,t)=>[e.code,t]));function Y1(e){const{inputMode:t,prompt:r,selectedFile:n,lengthMM:i,widthMM:s,result:a,viewMode:l,blendRecipes:c,solidRecipes:d,colorMapping:u,solidColorMapping:f,solidEditedColors:h,blendEditedColors:p,blendSvgUrl:g,solidSvgUrl:m,arMapping:x,jobId:v,inSituData:y,regionOverrides:b,originalTaggedSvg:w}=e;console.log("[SERIALIZE] Serializing design with result:",a),console.log("[SERIALIZE] result.svg_url:",a==null?void 0:a.svg_url),console.log("[SERIALIZE] regionOverrides:",b),console.log("[SERIALIZE] regionOverrides size:",b==null?void 0:b.size),console.log("[SERIALIZE] originalTaggedSvg present:",!!w);const j=_=>_?_ instanceof Map?Object.fromEntries(_):_:null;return{input_mode:t,prompt:r||null,uploaded_file_url:(n==null?void 0:n.url)||null,dimensions:{widthMM:s,lengthMM:i},original_svg_url:(a==null?void 0:a.svg_url)||null,original_png_url:(a==null?void 0:a.png_url)||null,thumbnail_url:(a==null?void 0:a.thumb_url)||null,blend_recipes:c||null,solid_recipes:d||null,color_mapping:j(u),solid_color_mapping:j(f),solid_color_edits:j(h),blend_color_edits:j(p),final_blend_svg_url:g||null,final_solid_svg_url:m||null,preferred_view_mode:l||"solid",aspect_ratio_mapping:x||null,job_id:v||null,in_situ:y?{room_photo_url:y.room_photo_url||null,mask_url:y.mask_url||null,floor_dimensions_m:y.floor_dimensions_m||null,preview_url:y.preview_url||null,blend_opacity:y.blend_opacity||20,perspective_corners:y.perspective_corners||null}:null,region_overrides:j(b),original_tagged_svg:w||null}}function tf(e){var s,a,l,c;console.log("[DESERIALIZE] Incoming savedData keys:",Object.keys(e||{})),console.log("[DESERIALIZE] savedData.region_overrides:",e==null?void 0:e.region_overrides),console.log("[DESERIALIZE] savedData.design_data:",e==null?void 0:e.design_data),console.log("[DESERIALIZE] savedData.design_data?.region_overrides:",(s=e==null?void 0:e.design_data)==null?void 0:s.region_overrides),console.log("[DESERIALIZE] savedData.original_tagged_svg present:",!!(e!=null&&e.original_tagged_svg)),console.log("[DESERIALIZE] savedData.design_data?.original_tagged_svg present:",!!((a=e==null?void 0:e.design_data)!=null&&a.original_tagged_svg));const t=d=>d?d instanceof Map?d:new Map(Object.entries(d)):new Map,r=d=>{var u;return e[d]??((u=e.design_data)==null?void 0:u[d])},n=r("region_overrides"),i=r("original_tagged_svg");return console.log("[DESERIALIZE] Final regionOverridesData:",n),console.log("[DESERIALIZE] Final originalTaggedSvgData present:",!!i),{inputMode:e.input_mode||r("input_mode"),prompt:r("prompt")||"",selectedFile:r("uploaded_file_url")?{url:r("uploaded_file_url"),name:r("uploaded_file_url").split("/").pop()}:null,lengthMM:((l=r("dimensions"))==null?void 0:l.lengthMM)||0,widthMM:((c=r("dimensions"))==null?void 0:c.widthMM)||0,result:{svg_url:r("original_svg_url"),png_url:r("original_png_url"),thumbnail_url:r("thumbnail_url")},blendRecipes:r("blend_recipes")||null,solidRecipes:r("solid_recipes")||null,colorMapping:t(r("color_mapping")),solidColorMapping:t(r("solid_color_mapping")),solidEditedColors:t(r("solid_color_edits")),blendEditedColors:t(r("blend_color_edits")),blendSvgUrl:null,solidSvgUrl:null,viewMode:"solid",arMapping:r("aspect_ratio_mapping"),jobId:r("job_id"),inSituData:r("in_situ")||null,regionOverrides:t(n),originalTaggedSvg:i||null,generating:!1,generatingBlends:!1,showFinalRecipes:!!e.blend_recipes,showSolidSummary:!!e.solid_recipes,colorEditorOpen:!1,selectedColor:null}}function dH(e){var r;const t=[];return e.inputMode||t.push("Input mode is required"),(!(e.widthMM>0)||!(e.lengthMM>0))&&t.push("Surface dimensions are required"),(r=e.result)!=null&&r.svg_url||t.push("No design to save - generate a design first"),{valid:t.length===0,errors:t}}function uH({currentState:e,existingDesignId:t=null,initialName:r="",onClose:n,onSaved:i}){const[s,a]=A.useState(r),[l,c]=A.useState(""),[d,u]=A.useState(""),[f,h]=A.useState(""),[p,g]=A.useState(!1),[m,x]=A.useState([]),[v,y]=A.useState(!1),[b,w]=A.useState(""),[j,_]=A.useState("#1a365d"),[E,N]=A.useState(!1),[O,I]=A.useState(!1),[te,T]=A.useState(!1),[V,S]=A.useState(null);A.useEffect(()=>{K()},[]);const K=async()=>{try{const{projects:H}=await cp();x(H)}catch(H){console.error("Failed to load projects:",H),S("Failed to load projects")}},fe=async()=>{if(!b.trim()){S("Project name is required");return}T(!0),S(null);try{const{project:H}=await Cw({name:b.trim(),color:j});x([H,...m]),u(H.id),y(!1),w(""),_("#1a365d")}catch(H){console.error("Failed to create project:",H),S(H.message)}finally{T(!1)}},U=async(H=!1)=>{if(!s.trim()){S("Design name is required");return}const Q=dH(e);if(!Q.valid){S(Q.errors.join(", "));return}H?I(!0):N(!0),S(null);try{const W=Y1(e);console.log("[SAVE-MODAL] Serialized design data:",W),console.log("[SAVE-MODAL] SVG URL from serialized data:",W.original_svg_url);const q={name:s.trim(),description:l.trim()||null,project_id:d||null,tags:f.split(",").map(oe=>oe.trim()).filter(oe=>oe),is_public:p,design_data:W};console.log("[SAVE-MODAL] Full save payload:",q),t&&!H&&(q.id=t);const re=await op(q);i&&i(re,s.trim()),n()}catch(W){console.error("Failed to save design:",W),S(W.message)}finally{N(!1),I(!1)}},z=["#1a365d","#ff6b35","#4a90e2","#50c878","#9b59b6","#e74c3c"];return o.jsx("div",{className:"modal-overlay",onClick:n,children:o.jsxs("div",{className:"modal-content save-design-modal",onClick:H=>H.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsx("h2",{children:t?"Update Design":"Save Design"}),o.jsx("button",{onClick:n,className:"close-button",children:""})]}),o.jsxs("div",{className:"modal-body",children:[V&&o.jsx("div",{className:"error-message",children:V}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"design-name",children:"Design Name *"}),o.jsx("input",{id:"design-name",type:"text",value:s,onChange:H=>a(H.target.value),placeholder:"e.g., Playground Design A",autoFocus:!0,disabled:E||O})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"design-description",children:"Description"}),o.jsx("textarea",{id:"design-description",value:l,onChange:H=>c(H.target.value),placeholder:"Optional notes about this design...",rows:3,disabled:E||O})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"design-project",children:"Project"}),v?o.jsxs("div",{className:"new-project-form",children:[o.jsxs("div",{className:"input-row",children:[o.jsx("input",{type:"text",value:b,onChange:H=>w(H.target.value),placeholder:"Project name...",disabled:te}),o.jsx("div",{className:"color-picker-inline",children:z.map(H=>o.jsx("button",{type:"button",className:`color-swatch ${j===H?"active":""}`,style:{backgroundColor:H},onClick:()=>_(H),disabled:te},H))})]}),o.jsxs("div",{className:"button-row",children:[o.jsx("button",{type:"button",onClick:fe,className:"btn-primary btn-small",disabled:te,children:te?"Creating...":"Create"}),o.jsx("button",{type:"button",onClick:()=>y(!1),className:"btn-secondary btn-small",disabled:te,children:"Cancel"})]})]}):o.jsxs("div",{className:"project-selector",children:[o.jsxs("select",{id:"design-project",value:d,onChange:H=>u(H.target.value),disabled:E||O,children:[o.jsx("option",{value:"",children:"No Project"}),m.map(H=>o.jsxs("option",{value:H.id,children:[H.name," (",H.design_count," designs)"]},H.id))]}),o.jsx("button",{type:"button",onClick:()=>y(!0),className:"btn-secondary btn-small",disabled:E||O,children:"+ New Project"})]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"design-tags",children:"Tags"}),o.jsx("input",{id:"design-tags",type:"text",value:f,onChange:H=>h(H.target.value),placeholder:"e.g., playground, vibrant, geometric (comma-separated)",disabled:E||O}),o.jsx("small",{className:"help-text",children:"Separate tags with commas"})]}),o.jsx("div",{className:"form-group checkbox-group",children:o.jsxs("label",{children:[o.jsx("input",{type:"checkbox",checked:p,onChange:H=>g(H.target.checked),disabled:E||O}),o.jsx("span",{children:"Make this design public (shareable link)"})]})})]}),o.jsxs("div",{className:"modal-footer",children:[o.jsx("button",{onClick:n,className:"btn-secondary",disabled:E||O,children:"Cancel"}),t&&o.jsx("button",{onClick:()=>U(!0),className:"btn-secondary",disabled:E||O,children:O?"Saving...":"Save as New"}),o.jsx("button",{onClick:()=>U(!1),className:"btn-primary",disabled:E||O,children:E?"Saving...":t?"Update":"Save Design"})]})]})})}const hH=10*1024*1024,fH=["image/jpeg","image/png","image/jpg"];function pH({onPhotoUploaded:e,disabled:t=!1}){const[r,n]=A.useState(!1),[i,s]=A.useState(!1),[a,l]=A.useState(null),[c,d]=A.useState(null),u=A.useRef(null),f=y=>{y.preventDefault(),t||n(!0)},h=y=>{y.preventDefault(),n(!1)},p=async y=>{if(y.preventDefault(),n(!1),t)return;const b=y.dataTransfer.files;b.length>0&&await x(b[0])},g=()=>{!t&&u.current&&u.current.click()},m=async y=>{y.target.files.length>0&&await x(y.target.files[0])},x=async y=>{if(l(null),!fH.includes(y.type)){l("Please upload a JPG or PNG image");return}if(y.size>hH){l("Image must be under 10MB");return}const b=URL.createObjectURL(y);d(b),console.log("[IN-SITU-UPLOADER] Loading local file to get dimensions...");const w=await new Promise((j,_)=>{const E=new Image;E.onload=()=>{console.log("[IN-SITU-UPLOADER] Local image loaded, dimensions:",E.naturalWidth,"x",E.naturalHeight),j({width:E.naturalWidth,height:E.naturalHeight})},E.onerror=N=>{console.error("[IN-SITU-UPLOADER] Failed to load local image:",N),_(new Error("Failed to read image dimensions"))},E.src=b});s(!0);try{const _=`in-situ-photos/${`${Date.now()}-${Math.random().toString(36).substr(2,9)}.${y.type.split("/")[1]}`}`,{data:E,error:N}=await Dt.storage.from("tpv-studio-uploads").upload(_,y,{cacheControl:"3600",upsert:!1});if(N)throw N;const{data:{publicUrl:O}}=Dt.storage.from("tpv-studio-uploads").getPublicUrl(_);console.log("[IN-SITU-UPLOADER] Photo uploaded:",O),console.log("[IN-SITU-UPLOADER] Using dimensions from local file:",w),console.log("[IN-SITU-UPLOADER] Passing local blob URL for fast preview"),console.log("[IN-SITU-UPLOADER] Calling onPhotoUploaded callback..."),e({url:b,supabaseUrl:O,width:w.width,height:w.height,filename:y.name})}catch(j){console.error("[IN-SITU-UPLOADER] Upload failed:",j),l(j.message||"Upload failed"),URL.revokeObjectURL(b),d(null)}finally{s(!1)}},v=()=>{c&&URL.revokeObjectURL(c),d(null),l(null)};return o.jsxs("div",{className:"in-situ-uploader",children:[c?o.jsxs("div",{className:"preview-container",children:[o.jsx("img",{src:c,alt:"Site preview",className:"preview-image"}),i&&o.jsxs("div",{className:"upload-overlay",children:[o.jsx("div",{className:"upload-spinner"}),o.jsx("p",{children:"Uploading..."})]}),!i&&o.jsx("button",{className:"clear-button",onClick:v,title:"Remove photo",children:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),o.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}):o.jsxs("div",{className:`upload-zone ${r?"dragging":""} ${t?"disabled":""}`,onDragOver:f,onDragLeave:h,onDrop:p,onClick:g,children:[o.jsx("input",{ref:u,type:"file",accept:"image/jpeg,image/png",onChange:m,style:{display:"none"},disabled:t}),o.jsx("div",{className:"upload-icon",children:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),o.jsx("polyline",{points:"17 8 12 3 7 8"}),o.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]})}),o.jsxs("div",{className:"upload-text",children:[o.jsx("p",{className:"primary",children:r?"Drop photo here":"Upload site photo"}),o.jsx("p",{className:"secondary",children:"Drag & drop or click to browse"}),o.jsx("p",{className:"hint",children:"JPG or PNG, max 10MB"})]})]}),a&&o.jsx("div",{className:"error-message",children:a}),o.jsx("style",{children:`
        .in-situ-uploader {
          width: 100%;
        }

        .upload-zone {
          border: 2px dashed #d1d5db;
          border-radius: 8px;
          padding: 2rem;
          text-align: center;
          cursor: pointer;
          transition: all 0.2s;
          background: #f9fafb;
        }

        .upload-zone:hover {
          border-color: #ff6b35;
          background: #fff7f5;
        }

        .upload-zone.dragging {
          border-color: #ff6b35;
          background: #fff7f5;
          border-style: solid;
        }

        .upload-zone.disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .upload-zone.disabled:hover {
          border-color: #d1d5db;
          background: #f9fafb;
        }

        .upload-icon {
          width: 48px;
          height: 48px;
          margin: 0 auto 1rem;
          color: #9ca3af;
        }

        .upload-zone:hover .upload-icon {
          color: #ff6b35;
        }

        .upload-text .primary {
          font-size: 1rem;
          font-weight: 600;
          color: #374151;
          margin: 0 0 0.25rem;
        }

        .upload-text .secondary {
          font-size: 0.875rem;
          color: #6b7280;
          margin: 0 0 0.5rem;
        }

        .upload-text .hint {
          font-size: 0.75rem;
          color: #9ca3af;
          margin: 0;
        }

        .preview-container {
          position: relative;
          border-radius: 8px;
          overflow: hidden;
        }

        .preview-image {
          width: 100%;
          display: block;
          border-radius: 8px;
        }

        .upload-overlay {
          position: absolute;
          inset: 0;
          background: rgba(0, 0, 0, 0.6);
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          color: white;
        }

        .upload-spinner {
          width: 32px;
          height: 32px;
          border: 3px solid rgba(255, 255, 255, 0.3);
          border-top-color: white;
          border-radius: 50%;
          animation: spin 0.8s linear infinite;
          margin-bottom: 0.5rem;
        }

        @keyframes spin {
          to { transform: rotate(360deg); }
        }

        .clear-button {
          position: absolute;
          top: 0.5rem;
          right: 0.5rem;
          width: 32px;
          height: 32px;
          border-radius: 50%;
          background: rgba(0, 0, 0, 0.6);
          border: none;
          cursor: pointer;
          color: white;
          display: flex;
          align-items: center;
          justify-content: center;
          transition: background 0.2s;
        }

        .clear-button:hover {
          background: rgba(0, 0, 0, 0.8);
        }

        .clear-button svg {
          width: 16px;
          height: 16px;
        }

        .error-message {
          margin-top: 0.75rem;
          padding: 0.5rem 0.75rem;
          background: #fef2f2;
          border: 1px solid #fecaca;
          border-radius: 4px;
          color: #dc2626;
          font-size: 0.875rem;
        }
      `})]})}function mH(e,t){const[r,n,i,s,a,l,c,d]=e,[u,f,h,p,g,m,x,v]=t,y=[[r,n,1,0,0,0,-u*r,-u*n],[0,0,0,r,n,1,-f*r,-f*n],[i,s,1,0,0,0,-h*i,-h*s],[0,0,0,i,s,1,-p*i,-p*s],[a,l,1,0,0,0,-g*a,-g*l],[0,0,0,a,l,1,-m*a,-m*l],[c,d,1,0,0,0,-x*c,-x*d],[0,0,0,c,d,1,-v*c,-v*d]],w=gH(y,[u,f,h,p,g,m,x,v]);return function(_,E){const N=w[6]*_+w[7]*E+1,O=(w[0]*_+w[1]*E+w[2])/N,I=(w[3]*_+w[4]*E+w[5])/N;return[O,I]}}function gH(e,t){const r=e.length,n=e.map((s,a)=>[...s,t[a]]);for(let s=0;s<r;s++){let a=s;for(let l=s+1;l<r;l++)Math.abs(n[l][s])>Math.abs(n[a][s])&&(a=l);[n[s],n[a]]=[n[a],n[s]];for(let l=s+1;l<r;l++){const c=n[l][s]/n[s][s];for(let d=s;d<=r;d++)n[l][d]-=c*n[s][d]}}const i=new Array(r);for(let s=r-1;s>=0;s--){i[s]=n[s][r];for(let a=s+1;a<r;a++)i[s]-=n[s][a]*i[a];i[s]/=n[s][s]}return i}function nm(e){return new Promise((t,r)=>{const n=new Image;!e.startsWith("blob:")&&!e.startsWith("data:")?(n.crossOrigin="anonymous",console.log("[LOAD-IMAGE] Loading external URL with CORS:",e.substring(0,50))):console.log("[LOAD-IMAGE] Loading local URL (blob/data):",e.substring(0,50)),n.onload=()=>{console.log("[LOAD-IMAGE] Successfully loaded image:",e.substring(0,50)),t(n)},n.onerror=()=>{console.error("[LOAD-IMAGE] Failed to load image:",e),r(new Error(`Failed to load image: ${e}`))},n.src=e})}async function X1(e,t=1536){console.log("[RASTERIZE-SVG] Starting SVG rasterization:",e.substring(0,50),"maxSize:",t);const r=await nm(e),{naturalWidth:n,naturalHeight:i}=r;console.log("[RASTERIZE-SVG] SVG loaded with dimensions:",n,"x",i);const s=Math.min(1,t/Math.max(n,i)),a=Math.round(n*s),l=Math.round(i*s);console.log("[RASTERIZE-SVG] Scaling to:",a,"x",l,"(scale:",s.toFixed(2),")");const c=document.createElement("canvas");return c.width=a,c.height=l,c.getContext("2d").drawImage(r,0,0,a,l),console.log("[RASTERIZE-SVG] Drew SVG to canvas"),new Promise((u,f)=>{const h=new Image;h.onload=()=>{console.log("[RASTERIZE-SVG] Successfully rasterized SVG to PNG"),u(h)},h.onerror=p=>{console.error("[RASTERIZE-SVG] Failed to convert canvas to image:",p),f(p)},h.src=c.toDataURL("image/png")})}function K1({photoCtx:e,photoImg:t,designImg:r,quad:n,opacity:i,shape:s,lighting:a}){const l=e.canvas;e.clearRect(0,0,l.width,l.height),e.drawImage(t,0,0,l.width,l.height);const c=r.width,d=r.height,u=[0,0,c,0,c,d,0,d],f=[n[0].x,n[0].y,n[1].x,n[1].y,n[2].x,n[2].y,n[3].x,n[3].y],h=mH(u,f),p=10,g=c/p,m=d/p,x=document.createElement("canvas");if(x.width=c,x.height=d,x.getContext("2d").drawImage(r,0,0),e.save(),e.globalAlpha=i,a&&a.enabled){const b=a.strength||.6,w=1+(a.baseBrightness-1)*b,j=1+(a.baseContrast-1)*b;e.filter=`brightness(${w}) contrast(${j})`}const y=s&&s.length>=3?s:n;e.beginPath(),e.moveTo(y[0].x,y[0].y);for(let b=1;b<y.length;b++)e.lineTo(y[b].x,y[b].y);e.closePath(),e.clip();for(let b=0;b<p;b++)for(let w=0;w<p;w++){const j=b*g,_=w*m,E=(b+1)*g,N=(w+1)*m,O=h(j,_),I=h(E,_),te=h(E,N),T=h(j,N);Wv(e,x,j,_,E,_,j,N,O[0],O[1],I[0],I[1],T[0],T[1]),Wv(e,x,E,_,E,N,j,N,I[0],I[1],te[0],te[1],T[0],T[1])}e.restore()}function Wv(e,t,r,n,i,s,a,l,c,d,u,f,h,p){e.save(),e.beginPath(),e.moveTo(c,d),e.lineTo(u,f),e.lineTo(h,p),e.closePath(),e.clip();const g=(r-a)*(s-l)-(i-a)*(n-l);if(Math.abs(g)<.001){e.restore();return}const m=((c-h)*(s-l)-(u-h)*(n-l))/g,x=((d-p)*(s-l)-(f-p)*(n-l))/g,v=((r-a)*(u-h)-(i-a)*(c-h))/g,y=((r-a)*(f-p)-(i-a)*(d-p))/g,b=c-m*r-v*n,w=d-x*r-y*n;e.setTransform(m,x,v,y,b,w),e.drawImage(t,0,0),e.restore()}function vH(e,t="tpv-in-situ-preview.png"){e.toBlob(r=>{const n=URL.createObjectURL(r),i=document.createElement("a");i.href=n,i.download=t,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(n)},"image/png")}function yH(e,t,r,n){const i=r/n,s=e*.6,a=t*.6;let l,c;i>s/a?(l=s,c=s/i):(c=a,l=a*i);const d=(e-l)/2,u=(t-c)/2;return[{x:d,y:u},{x:d+l,y:u},{x:d+l,y:u+c},{x:d,y:u+c}]}function xH(e,t,r){let n=!1;for(let i=0,s=r.length-1;i<r.length;s=i++){const a=r[i].x,l=r[i].y,c=r[s].x,d=r[s].y;l>t!=d>t&&e<(c-a)*(t-l)/(d-l)+a&&(n=!n)}return n}function bH(e,t,r){e/=255,t/=255,r/=255;const n=Math.max(e,t,r),i=Math.min(e,t,r),s=(n+i)/2;if(n===i)return{h:0,s:0,l:s};const a=n-i,l=s>.5?a/(2-n-i):a/(n+i);let c;switch(n){case e:c=((t-r)/a+(t<r?6:0))/6;break;case t:c=((r-e)/a+2)/6;break;case r:c=((e-t)/a+4)/6;break}return{h:c,s:l,l:s}}function wH(e,t,r=2e3){if(!e||!t||t.length<3)return{avgLightness:.5,avgContrastProxy:.5};const n=Math.floor(Math.min(...t.map(y=>y.x))),i=Math.ceil(Math.max(...t.map(y=>y.x))),s=Math.floor(Math.min(...t.map(y=>y.y))),a=Math.ceil(Math.max(...t.map(y=>y.y))),l=i-n,c=a-s;if(l<=0||c<=0)return{avgLightness:.5,avgContrastProxy:.5};let d;try{d=e.getImageData(n,s,l,c)}catch(y){return console.warn("[LIGHTING] Failed to get image data:",y),{avgLightness:.5,avgContrastProxy:.5}}const u=d.data,f=[];let h=0;const p=r*5;for(;f.length<r&&h<p;){h++;const y=n+Math.random()*l,b=s+Math.random()*c;if(!xH(y,b,t))continue;const w=Math.floor(y-n),_=(Math.floor(b-s)*l+w)*4;if(_<0||_>=u.length-3)continue;const E=u[_],N=u[_+1],O=u[_+2],{l:I}=bH(E,N,O);f.push(I)}if(f.length===0)return{avgLightness:.5,avgContrastProxy:.5};const g=f.reduce((y,b)=>y+b,0)/f.length,m=f.reduce((y,b)=>y+Math.pow(b-g,2),0)/f.length,x=Math.sqrt(m),v=Math.min(1,x/.25);return{avgLightness:g,avgContrastProxy:v}}function _H(e){let t=1,r=1;const i=e.avgLightness-.5;return t+=i*.6,r+=(e.avgContrastProxy-.5)*.4,t=Math.max(.7,Math.min(1.3,t)),r=Math.max(.8,Math.min(1.25,r)),{brightness:t,contrast:r}}const SH=100;function kH({photoUrl:e,svgUrl:t,designSizeMm:r,initialQuad:n,initialShape:i,initialOpacity:s=.8,initialLighting:a,onChange:l}){const[c,d]=A.useState(null),[u,f]=A.useState(null),[h,p]=A.useState(n||null),[g,m]=A.useState(i||null),[x,v]=A.useState(Math.max(.3,Math.min(1,s))),[y,b]=A.useState(a||{enabled:!1,strength:.6,baseBrightness:1,baseContrast:1}),[w,j]=A.useState(!0),[_,E]=A.useState(null),[N,O]=A.useState(1),[I,te]=A.useState("corners"),[T,V]=A.useState(null),[S,K]=A.useState(!1),[fe,U]=A.useState(null),[z,H]=A.useState(null),Q=A.useRef(null),W=A.useRef(null),q=A.useRef(null),[re,oe]=A.useState([]),pe=20;A.useEffect(()=>{Pe()},[e,t]),A.useEffect(()=>{c&&u&&h&&Re()},[c,u,h,g,x,y,I,T,S,z]),A.useEffect(()=>{if(!c||!h||h.length!==4)return;const $=document.createElement("canvas");$.width=c.naturalWidth,$.height=c.naturalHeight;const X=$.getContext("2d");X.drawImage(c,0,0);const ae=wH(X,h),{brightness:we,contrast:se}=_H(ae);b(xe=>({...xe,baseBrightness:we,baseContrast:se}))},[c,JSON.stringify(h)]),A.useEffect(()=>{const $=X=>{if(I==="shape"&&(X.key==="Delete"||X.key==="Backspace")&&z!==null&&g&&g.length>3){X.preventDefault();const ae=g.filter((we,se)=>se!==z);m(ae),H(null),Ce(h,x,ae)}};return window.addEventListener("keydown",$),()=>window.removeEventListener("keydown",$)},[I,z,g,h,x]);const Pe=async()=>{var $;console.log("[FOUR-POINT] Starting to load images - photo:",e==null?void 0:e.substring(0,50),"svg:",t==null?void 0:t.substring(0,50)),j(!0),E(null);try{console.log("[FOUR-POINT] Loading photo and rasterizing SVG...");const[X,ae]=await Promise.all([nm(e),X1(t,1536)]);console.log("[FOUR-POINT] Both images loaded successfully - photo:",X.naturalWidth,"x",X.naturalHeight,"design:",ae.naturalWidth,"x",ae.naturalHeight),d(X),f(ae);const we=(($=W.current)==null?void 0:$.clientWidth)||800,se=500,xe=we/X.naturalWidth,Oe=se/X.naturalHeight,be=Math.min(1,xe,Oe);if(O(be),console.log("[FOUR-POINT] Display scale set to:",be.toFixed(3)),n)console.log("[FOUR-POINT] Using provided initial quad");else{const Ne=yH(X.naturalWidth,X.naturalHeight,r.width_mm,r.length_mm);p(Ne),console.log("[FOUR-POINT] Initialized default quad")}}catch(X){console.error("[FOUR-POINT] Failed to load images:",X),E(X.message)}finally{j(!1),console.log("[FOUR-POINT] Loading complete")}},Re=()=>{const $=Q.current;if(!$||!c||!u||!h)return;$.width=c.naturalWidth,$.height=c.naturalHeight;const X=$.getContext("2d");K1({photoCtx:X,photoImg:c,designImg:u,quad:h,opacity:x,shape:g,lighting:y}),Ae(X)},Ae=$=>{if(!h)return;$.setTransform(1,0,0,1,0,0);const X=Math.max(8,Math.min(15,c.naturalWidth/80));if(I==="corners"){$.strokeStyle="rgba(255, 255, 255, 0.8)",$.lineWidth=2,$.setLineDash([5,5]),$.beginPath(),$.moveTo(h[0].x,h[0].y),$.lineTo(h[1].x,h[1].y),$.lineTo(h[2].x,h[2].y),$.lineTo(h[3].x,h[3].y),$.closePath(),$.stroke(),$.setLineDash([]);const ae=["TL","TR","BR","BL"];h.forEach((we,se)=>{$.beginPath(),$.arc(we.x,we.y,X,0,Math.PI*2),$.fillStyle=T===se?"#ff6b35":"rgba(255, 107, 53, 0.9)",$.fill(),$.strokeStyle="white",$.lineWidth=2,$.stroke(),$.fillStyle="white",$.font="10px sans-serif",$.textAlign="center",$.textBaseline="middle",$.fillText(ae[se],we.x,we.y)})}else{const ae=g||h;$.strokeStyle="rgba(34, 197, 94, 0.8)",$.lineWidth=2,$.setLineDash([]),$.beginPath(),$.moveTo(ae[0].x,ae[0].y);for(let we=1;we<ae.length;we++)$.lineTo(ae[we].x,ae[we].y);$.closePath(),$.stroke(),ae.forEach((we,se)=>{$.beginPath(),$.arc(we.x,we.y,X*.8,0,Math.PI*2),z===se?$.fillStyle="#22c55e":T===se?$.fillStyle="#16a34a":$.fillStyle="rgba(34, 197, 94, 0.9)",$.fill(),$.strokeStyle="white",$.lineWidth=2,$.stroke()}),$.strokeStyle="rgba(255, 107, 53, 0.3)",$.lineWidth=1,$.setLineDash([3,3]),$.beginPath(),$.moveTo(h[0].x,h[0].y),$.lineTo(h[1].x,h[1].y),$.lineTo(h[2].x,h[2].y),$.lineTo(h[3].x,h[3].y),$.closePath(),$.stroke(),$.setLineDash([])}},Ce=A.useCallback(($,X,ae,we)=>{q.current&&clearTimeout(q.current),q.current=setTimeout(()=>{l&&l({quad:$,opacity:X,shape:ae,lighting:we||y})},SH)},[l,y]),ve=A.useCallback(()=>{oe($=>{const X=[...$,{quad:[...h],shape:g?[...g]:null,opacity:x,lighting:{...y}}];return X.length>pe?X.slice(-pe):X})},[h,g,x,y]),me=()=>{if(re.length===0)return;const $=re[re.length-1];oe(X=>X.slice(0,-1)),p($.quad),m($.shape),v($.opacity),b($.lighting),Ce($.quad,$.opacity,$.shape,$.lighting)},De=($,X)=>({x:$/N,y:X/N}),Xe=($,X,ae)=>{if(!ae)return-1;const we=25/N;for(let se=0;se<ae.length;se++){const xe=ae[se].x-$,Oe=ae[se].y-X;if(Math.sqrt(xe*xe+Oe*Oe)<we)return se}return-1},C=($,X,ae)=>{if(!ae||ae.length<3)return!1;let we=!1;for(let se=0,xe=ae.length-1;se<ae.length;xe=se++){const Oe=ae[se].x,be=ae[se].y,Ne=ae[xe].x,He=ae[xe].y;be>X!=He>X&&$<(Ne-Oe)*(X-be)/(He-be)+Oe&&(we=!we)}return we},ce=$=>{if(I!=="shape"||!g||g.length<=3)return;const X=Q.current;if(!X)return;const ae=X.getBoundingClientRect(),we=$.clientX-ae.left,se=$.clientY-ae.top,{x:xe,y:Oe}=De(we,se),be=Xe(xe,Oe,g);if(be>=0){ve();const Ne=g.filter((qe,Ze)=>Ze!==be);m(Ne),H(null);const He=M(h,Ne);He!==h?(p(He),Ce(He,x,Ne)):Ce(h,x,Ne)}},ne=$=>{const X=Q.current;if(!X)return;const ae=X.getBoundingClientRect(),we=$.clientX-ae.left,se=$.clientY-ae.top,{x:xe,y:Oe}=De(we,se);if(I==="corners"){const be=Xe(xe,Oe,h);be>=0?(ve(),V(be),X.setPointerCapture($.pointerId)):C(xe,Oe,h)&&(ve(),K(!0),U({x:xe,y:Oe}),X.setPointerCapture($.pointerId))}else{const be=g||h,Ne=Xe(xe,Oe,be);if(Ne>=0)ve(),V(Ne),H(Ne),X.setPointerCapture($.pointerId);else{ve();let He=0,qe=1/0;for(let Ve=0;Ve<be.length;Ve++){const Ke=(Ve+1)%be.length,Be=Y(xe,Oe,be[Ve].x,be[Ve].y,be[Ke].x,be[Ke].y);Be<qe&&(qe=Be,He=Ke)}const Ze={x:xe,y:Oe},Je=[...be];Je.splice(He,0,Ze),m(Je),H(He);const Fe=M(h,Je);Fe!==h?(p(Fe),Ce(Fe,x,Je)):Ce(h,x,Je)}}},F=$=>{if(T===null&&!S)return;const X=Q.current;if(!X)return;const ae=X.getBoundingClientRect(),we=$.clientX-ae.left,se=$.clientY-ae.top,{x:xe,y:Oe}=De(we,se),be=Math.max(0,Math.min(c.naturalWidth,xe)),Ne=Math.max(0,Math.min(c.naturalHeight,Oe));if(I==="corners"){if(S&&fe){const He=be-fe.x,qe=Ne-fe.y,Ze=h.map(Fe=>({x:Math.max(0,Math.min(c.naturalWidth,Fe.x+He)),y:Math.max(0,Math.min(c.naturalHeight,Fe.y+qe))}));let Je=g;g&&(Je=g.map(Fe=>({x:Math.max(0,Math.min(c.naturalWidth,Fe.x+He)),y:Math.max(0,Math.min(c.naturalHeight,Fe.y+qe))})),m(Je)),p(Ze),U({x:be,y:Ne}),Ce(Ze,x,Je)}else if(T!==null){const He=[...h];He[T]={x:be,y:Ne},p(He),Ce(He,x,g)}}else{const qe=[...g||h];qe[T]={x:be,y:Ne},m(qe),Ce(h,x,qe)}},R=$=>{if(T!==null||S){const X=Q.current;if(X&&X.releasePointerCapture($.pointerId),I==="shape"&&g&&T!==null){const ae=M(h,g);ae!==h&&(p(ae),Ce(ae,x,g))}V(null),K(!1),U(null)}},M=($,X)=>{if(!X||X.length<3||!$)return $;const ae=$.reduce((Fe,Ve)=>Fe+Ve.x,0)/4,we=$.reduce((Fe,Ve)=>Fe+Ve.y,0)/4,se=X.reduce((Fe,Ve)=>Fe+Ve.x,0)/X.length,xe=X.reduce((Fe,Ve)=>Fe+Ve.y,0)/X.length;let Oe=1;for(const Fe of X){const Ve=Fe.x-ae,Ke=Fe.y-we,Be=Math.sqrt(Ve*Ve+Ke*Ke);if(Be<1)continue;const at=Z(ae,we,Ve,Ke,$);if(at>0&&Be>at){const qt=Be/at;Oe=Math.max(Oe,qt)}}let be=1/0;for(const Fe of X){const Ve=Fe.x-ae,Ke=Fe.y-we,Be=Math.sqrt(Ve*Ve+Ke*Ke);if(Be<1)continue;const at=Z(ae,we,Ve,Ke,$);if(at>0){const qt=Be/at;be=Math.min(be,qt)}}let Ne=Oe;if(Oe<=1&&be<1/0&&(Ne=be),Math.abs(Ne-1)<.01)return $;const He=$.map(Fe=>({x:ae+(Fe.x-ae)*Ne,y:we+(Fe.y-we)*Ne})),qe=se-ae,Ze=xe-we;return He.map(Fe=>({x:Fe.x+qe,y:Fe.y+Ze}))},Z=($,X,ae,we,se)=>{let xe=1/0;for(let Oe=0;Oe<4;Oe++){const be=se[Oe],Ne=se[(Oe+1)%4],He=Ne.x-be.x,qe=Ne.y-be.y,Ze=ae*qe-we*He;if(Math.abs(Ze)<1e-4)continue;const Je=((be.x-$)*qe-(be.y-X)*He)/Ze,Fe=((be.x-$)*we-(be.y-X)*ae)/Ze;Je>0&&Fe>=0&&Fe<=1&&(xe=Math.min(xe,Je*Math.sqrt(ae*ae+we*we)))}return xe===1/0?0:xe},Y=($,X,ae,we,se,xe)=>{const Oe=$-ae,be=X-we,Ne=se-ae,He=xe-we,qe=Oe*Ne+be*He,Ze=Ne*Ne+He*He;let Je=Ze!==0?qe/Ze:-1,Fe,Ve;return Je<0?(Fe=ae,Ve=we):Je>1?(Fe=se,Ve=xe):(Fe=ae+Je*Ne,Ve=we+Je*He),Math.sqrt(($-Fe)**2+(X-Ve)**2)},L=()=>{I==="corners"?(g||m([...h]),te("shape"),H(null)):(te("corners"),H(null))},J=$=>{const X=Math.max(.3,Math.min(1,parseFloat($.target.value)/100));v(X),Ce(h,X,g)},ue=$=>{const X={...y,enabled:$.target.checked};b(X),Ce(h,x,g,X)},ie=$=>{const X={...y,strength:parseFloat($.target.value)/100};b(X),Ce(h,x,g,X)};return w?o.jsxs("div",{className:"four-point-editor loading",children:[o.jsx("div",{className:"spinner"}),o.jsx("p",{children:"Loading preview..."})]}):_?o.jsx("div",{className:"four-point-editor error",children:o.jsxs("p",{children:["Failed to load: ",_]})}):o.jsxs("div",{className:"four-point-editor",ref:W,children:[o.jsxs("div",{className:"editor-header",children:[o.jsxs("div",{className:"header-title",children:[o.jsx("h3",{children:"Position Your Design"}),o.jsx(up,{content:o.jsxs("div",{children:[o.jsxs("p",{children:[o.jsx("strong",{children:"Corners Mode:"})," Drag the 4 corner handles (TL, TR, BR, BL) to position your design with perspective. You can also drag inside the design to move all corners at once."]}),o.jsxs("p",{style:{marginTop:"0.5rem"},children:[o.jsx("strong",{children:"Refine Shape Mode:"})," Click anywhere to add new vertices for precise shape control. Drag existing vertices to adjust. Double-click or press Delete/Backspace on a vertex to remove it."]}),o.jsxs("p",{style:{marginTop:"0.5rem"},children:[o.jsx("strong",{children:"Overlay Opacity:"})," Adjust transparency to see how the design blends with your photo."]}),o.jsxs("p",{style:{marginTop:"0.5rem"},children:[o.jsx("strong",{children:"Match Floor Lighting:"})," Automatically adjusts design brightness to match your floor's lighting conditions."]})]}),position:"right"})]}),o.jsx("p",{className:"instructions",children:I==="corners"?"Drag the corner handles (TL, TR, BR, BL) to position the design. Drag inside to move all corners.":"Click to add vertices, drag to move them, double-click or press Delete to remove."})]}),o.jsx("div",{className:"canvas-container",children:o.jsx("canvas",{ref:Q,onPointerDown:ne,onPointerMove:F,onPointerUp:R,onPointerLeave:R,onDoubleClick:ce,style:{width:`${((c==null?void 0:c.naturalWidth)||800)*N}px`,height:`${((c==null?void 0:c.naturalHeight)||600)*N}px`,cursor:T!==null||S?"grabbing":I==="shape"?"crosshair":"move",touchAction:"none"}})}),o.jsxs("div",{className:"controls",children:[o.jsxs("div",{className:"mode-toggle",children:[o.jsx("button",{className:`toggle-btn ${I==="corners"?"active":""}`,onClick:()=>te("corners"),children:"Corners"}),o.jsx("button",{className:`toggle-btn ${I==="shape"?"active":""}`,onClick:L,children:"Refine Shape"}),o.jsx("button",{className:"toggle-btn undo-btn",onClick:me,disabled:re.length===0,title:"Undo last change",children:"Undo"})]}),o.jsxs("div",{className:"opacity-control",children:[o.jsxs("label",{children:["Overlay Opacity",o.jsxs("span",{className:"value",children:[Math.round(x*100),"%"]})]}),o.jsx("input",{type:"range",min:"30",max:"100",value:Math.round(x*100),onChange:J})]}),o.jsxs("div",{className:"lighting-control",children:[o.jsxs("label",{className:"checkbox-label",children:[o.jsx("input",{type:"checkbox",checked:y.enabled,onChange:ue}),"Match floor lighting"]}),y.enabled&&o.jsxs("div",{className:"lighting-slider",children:[o.jsxs("label",{children:["Strength",o.jsxs("span",{className:"value",children:[Math.round(y.strength*100),"%"]})]}),o.jsx("input",{type:"range",min:"0",max:"100",value:Math.round(y.strength*100),onChange:ie})]})]})]}),o.jsx("style",{children:`
        .four-point-editor {
          display: flex;
          flex-direction: column;
          height: 100%;
        }

        .four-point-editor.loading,
        .four-point-editor.error {
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          min-height: 400px;
          color: #6b7280;
        }

        .four-point-editor .spinner {
          width: 40px;
          height: 40px;
          border: 3px solid #e5e7eb;
          border-top-color: #ff6b35;
          border-radius: 50%;
          animation: spin 0.8s linear infinite;
          margin-bottom: 1rem;
        }

        @keyframes spin {
          to { transform: rotate(360deg); }
        }

        .editor-header {
          padding-bottom: 1rem;
          border-bottom: 1px solid #e5e7eb;
          margin-bottom: 1rem;
        }

        .editor-header .header-title {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          margin-bottom: 0.5rem;
        }

        .editor-header h3 {
          margin: 0;
          font-size: 1.125rem;
          color: #1e4a7a;
        }

        .editor-header .instructions {
          margin: 0;
          font-size: 0.875rem;
          color: #6b7280;
        }

        .canvas-container {
          flex: 1;
          display: flex;
          align-items: center;
          justify-content: center;
          background: #f3f4f6;
          border-radius: 8px;
          overflow: hidden;
          min-height: 400px;
        }

        .canvas-container canvas {
          display: block;
        }

        .controls {
          padding-top: 1rem;
          border-top: 1px solid #e5e7eb;
          margin-top: 1rem;
          display: flex;
          flex-direction: column;
          gap: 1rem;
        }

        .mode-toggle {
          display: flex;
          gap: 0.5rem;
        }

        .toggle-btn {
          padding: 0.5rem 1rem;
          border: 1px solid #d1d5db;
          background: white;
          border-radius: 4px;
          font-size: 0.875rem;
          cursor: pointer;
          transition: all 0.2s;
        }

        .toggle-btn:hover {
          background: #f9fafb;
        }

        .toggle-btn.active {
          background: #ff6b35;
          color: white;
          border-color: #ff6b35;
        }

        .toggle-btn:disabled {
          opacity: 0.4;
          cursor: not-allowed;
        }

        .toggle-btn:disabled:hover {
          background: white;
        }

        .opacity-control {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .opacity-control label {
          display: flex;
          justify-content: space-between;
          font-size: 0.875rem;
          font-weight: 500;
          color: #374151;
        }

        .opacity-control .value {
          font-weight: 400;
          color: #6b7280;
        }

        .opacity-control input[type="range"] {
          width: 100%;
          height: 6px;
          border-radius: 3px;
          background: #e5e7eb;
          outline: none;
          -webkit-appearance: none;
        }

        .opacity-control input[type="range"]::-webkit-slider-thumb {
          -webkit-appearance: none;
          width: 16px;
          height: 16px;
          border-radius: 50%;
          background: #ff6b35;
          cursor: pointer;
        }

        .lighting-control {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .checkbox-label {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          font-size: 0.875rem;
          font-weight: 500;
          color: #374151;
          cursor: pointer;
        }

        .checkbox-label input[type="checkbox"] {
          width: 16px;
          height: 16px;
          cursor: pointer;
        }

        .lighting-slider {
          display: flex;
          flex-direction: column;
          gap: 0.25rem;
          padding-left: 1.5rem;
        }

        .lighting-slider label {
          display: flex;
          justify-content: space-between;
          font-size: 0.8rem;
          color: #6b7280;
        }

        .lighting-slider .value {
          font-weight: 400;
        }

        .lighting-slider input[type="range"] {
          width: 100%;
          height: 6px;
          border-radius: 3px;
          background: #e5e7eb;
          outline: none;
          -webkit-appearance: none;
        }

        .lighting-slider input[type="range"]::-webkit-slider-thumb {
          -webkit-appearance: none;
          width: 14px;
          height: 14px;
          border-radius: 50%;
          background: #22c55e;
          cursor: pointer;
        }
      `})]})}const jn={UPLOAD:"upload",POSITION:"position"};function Z1({designUrl:e,designDimensions:t,onClose:r,onSaved:n}){const[i,s]=A.useState(jn.UPLOAD),[a,l]=A.useState(null),[c,d]=A.useState(null),[u,f]=A.useState(null),[h,p]=A.useState(.8),[g,m]=A.useState({enabled:!1,strength:.6,baseBrightness:1,baseContrast:1}),[x,v]=A.useState(!1),y=A.useRef(null);A.useEffect(()=>{if(e){console.log("[IN-SITU-MODAL] Design URL received:",e==null?void 0:e.substring(0,50));const O=new Image;!e.startsWith("blob:")&&!e.startsWith("data:")&&(O.crossOrigin="anonymous"),O.src=e}else console.warn("[IN-SITU-MODAL] No design URL provided")},[e]);const b=O=>{console.log("[IN-SITU-MODAL] Photo uploaded:",O),l(O),console.log("[IN-SITU-MODAL] Advancing to POSITION step, designUrl:",e==null?void 0:e.substring(0,50)),s(jn.POSITION)},w=({quad:O,opacity:I,shape:te,lighting:T})=>{d(O),p(I),f(te),T&&m(T)},j=async()=>{if(!a||!c)return null;try{console.log("[InSitu] Loading design from URL:",e);const[O,I]=await Promise.all([nm(a.url),X1(e,1536)]);console.log("[InSitu] Successfully loaded design image");const te=document.createElement("canvas");te.width=O.naturalWidth,te.height=O.naturalHeight;const T=te.getContext("2d");return K1({photoCtx:T,photoImg:O,designImg:I,quad:c,opacity:h,shape:u,lighting:g}),te}catch(O){return console.error("[InSitu] Failed to generate canvas:",O),alert(`Failed to load design: ${O.message}`),null}},_=async()=>{const O=await j();O&&vH(O,"tpv-in-situ-preview.png")},E=async()=>{if(!(!c||!a)){v(!0);try{const O=await j();if(!O)throw new Error("Failed to generate preview");const I=await new Promise(K=>O.toBlob(K,"image/png")),T=`in-situ-previews/${`${Date.now()}-${Math.random().toString(36).substr(2,9)}.png`}`,{error:V}=await Dt.storage.from("tpv-studio-uploads").upload(T,I,{contentType:"image/png",cacheControl:"3600"});if(V)throw V;const{data:{publicUrl:S}}=Dt.storage.from("tpv-studio-uploads").getPublicUrl(T);n&&n({photo_url:a.supabaseUrl||a.url,quad:c,shape:u,opacity:h,lighting:g,preview_url:S}),r()}catch(O){console.error("[IN-SITU] Save failed:",O),alert("Failed to save preview: "+O.message)}finally{v(!1)}}},N=()=>{switch(i){case jn.UPLOAD:return"Upload Site Photo";case jn.POSITION:return"Position Your Design";default:return"In-Situ Preview"}};return o.jsxs("div",{className:"modal-overlay in-situ-modal-overlay",onClick:r,children:[o.jsxs("div",{className:"modal-content in-situ-modal",onClick:O=>O.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsxs("div",{className:"header-left",children:[o.jsx("h2",{children:N()}),o.jsxs("div",{className:"step-indicator",children:[o.jsx("span",{className:i===jn.UPLOAD?"active":"completed",children:"1. Upload"}),o.jsx("span",{className:i===jn.POSITION?"active":"",children:"2. Position"})]})]}),o.jsx("button",{onClick:r,className:"close-button",children:""})]}),o.jsxs("div",{className:"modal-body",children:[i===jn.UPLOAD&&o.jsxs("div",{className:"upload-step",children:[o.jsx("p",{className:"step-description",children:"Upload a photo of your site to see how your TPV design will look when installed. For best results, use a photo taken from above or at a slight angle showing the floor area clearly."}),o.jsx(pH,{onPhotoUploaded:b})]}),i===jn.POSITION&&a&&o.jsx(kH,{ref:y,photoUrl:a.url,svgUrl:e,designSizeMm:{width_mm:t.width,length_mm:t.length},initialOpacity:.8,onChange:w})]}),i===jn.POSITION&&o.jsxs("div",{className:"modal-footer",children:[o.jsx("button",{onClick:()=>s(jn.UPLOAD),className:"btn-secondary",children:"Back"}),o.jsxs("div",{className:"footer-actions",children:[o.jsx("button",{onClick:_,disabled:!c,className:"btn-secondary",children:"Download PNG"}),o.jsx("button",{onClick:E,disabled:!c||x,className:"btn-primary",children:x?"Saving...":"Save to Project"})]})]})]}),o.jsx("style",{children:`
        .in-situ-modal-overlay {
          position: fixed;
          inset: 0;
          background: rgba(0, 0, 0, 0.6);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 1000;
          padding: 1rem;
        }

        .in-situ-modal {
          background: white;
          border-radius: 12px;
          width: 100%;
          max-width: 1000px;
          max-height: 90vh;
          display: flex;
          flex-direction: column;
          box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .in-situ-modal .modal-header {
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
          padding: 1.25rem 1.5rem;
          border-bottom: 1px solid #e5e7eb;
        }

        .header-left {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .in-situ-modal .modal-header h2 {
          margin: 0;
          font-size: 1.25rem;
          color: #1e4a7a;
        }

        .step-indicator {
          display: flex;
          gap: 1rem;
          font-size: 0.75rem;
        }

        .step-indicator span {
          color: #9ca3af;
          padding: 0.25rem 0.5rem;
          border-radius: 4px;
        }

        .step-indicator span.active {
          background: #fff7f5;
          color: #ff6b35;
          font-weight: 500;
        }

        .step-indicator span.completed {
          color: #22c55e;
        }

        .close-button {
          background: none;
          border: none;
          font-size: 1.5rem;
          cursor: pointer;
          color: #9ca3af;
          padding: 0;
          line-height: 1;
        }

        .close-button:hover {
          color: #374151;
        }

        .modal-body {
          flex: 1;
          padding: 1.5rem;
          overflow-y: auto;
          min-height: 500px;
        }

        .upload-step {
          display: flex;
          flex-direction: column;
          gap: 1.5rem;
        }

        .step-description {
          margin: 0;
          font-size: 0.875rem;
          color: #6b7280;
          line-height: 1.6;
        }

        .modal-footer {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 1rem 1.5rem;
          border-top: 1px solid #e5e7eb;
          background: #f9fafb;
          border-radius: 0 0 12px 12px;
        }

        .footer-actions {
          display: flex;
          gap: 0.5rem;
        }

        .btn-primary,
        .btn-secondary {
          padding: 0.5rem 1rem;
          border-radius: 4px;
          font-size: 0.875rem;
          font-weight: 500;
          cursor: pointer;
          transition: all 0.2s;
          border: none;
        }

        .btn-primary {
          background: #ff6b35;
          color: white;
        }

        .btn-primary:hover:not(:disabled) {
          background: #e55a2b;
        }

        .btn-primary:disabled {
          background: #d1d5db;
          cursor: not-allowed;
        }

        .btn-secondary {
          background: white;
          color: #374151;
          border: 1px solid #d1d5db;
        }

        .btn-secondary:hover:not(:disabled) {
          background: #f9fafb;
        }

        .btn-secondary:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
          .in-situ-modal {
            max-width: 100%;
            max-height: 100vh;
            border-radius: 0;
          }

          .modal-body {
            padding: 1rem;
          }

          .step-indicator {
            display: none;
          }

          .modal-footer {
            border-radius: 0;
          }
        }
      `})]})}function jH({isOpen:e,onClose:t,onConfirm:r,aspectRatio:n,defaultLongestSide:i=5e3}){const[s,a]=A.useState(i),[l,c]=A.useState(i/1e3),u=(m=>{if(!n||n<=0)return{width:m,length:m};if(n>=1){const x=m,v=Math.round(m/n);return{width:x,length:v}}else{const x=m;return{width:Math.round(m*n),length:x}}})(s),f=n>=1?"landscape":"portrait",h=n>=1?`${n.toFixed(1)}:1`:`1:${(1/n).toFixed(1)}`,p=m=>{const x=parseFloat(m.target.value)||0;c(x),a(Math.round(x*1e3))},g=()=>{r(u.width,u.length),t()};return e?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"dimension-modal-overlay",onClick:t,children:o.jsxs("div",{className:"dimension-modal",onClick:m=>m.stopPropagation(),children:[o.jsxs("div",{className:"dimension-modal-header",children:[o.jsxs("div",{className:"dimension-modal-title",children:[o.jsx("h2",{children:"Set Installation Size"}),o.jsx(up,{content:o.jsxs("div",{children:[o.jsx("p",{children:o.jsx("strong",{children:"Why specify dimensions?"})}),o.jsx("p",{style:{marginTop:"0.5rem"},children:"Accurate dimensions are essential for:"}),o.jsxs("ul",{style:{marginTop:"0.5rem",marginBottom:0,paddingLeft:"1.25rem"},children:[o.jsx("li",{children:"Calculating exact material quantities"}),o.jsx("li",{children:"Generating PDF specifications for manufacturers"}),o.jsx("li",{children:"Slicing designs into 1m1m installation tiles"})]}),o.jsxs("p",{style:{marginTop:"0.5rem"},children:[o.jsx("strong",{children:"Tip:"})," Typical playground installations range from 3m to 20m on the longest side."]})]}),position:"bottom"})]}),o.jsx("button",{className:"dimension-modal-close",onClick:t,"aria-label":"Close",children:""})]}),o.jsxs("div",{className:"dimension-modal-body",children:[o.jsx("div",{className:"dimension-info",children:o.jsxs("p",{className:"dimension-aspect",children:["Your design has a ",o.jsxs("strong",{children:[h," ",f]})," aspect ratio"]})}),o.jsxs("div",{className:"dimension-input-group",children:[o.jsx("label",{htmlFor:"longest-dimension",children:"Installation Size (Longest Side)"}),o.jsxs("div",{className:"dimension-input-wrapper",children:[o.jsx("input",{id:"longest-dimension",type:"number",min:"0.1",max:"50",step:"0.1",value:l,onChange:p,className:"dimension-input"}),o.jsx("span",{className:"dimension-unit",children:"meters"})]}),o.jsx("p",{className:"dimension-help",children:"Enter the measurement of the longest side of your installation area. The other dimension will be calculated automatically based on your design's aspect ratio."})]}),o.jsxs("div",{className:"dimension-preview",children:[o.jsx("div",{className:"dimension-preview-title",children:"Calculated Dimensions:"}),o.jsxs("div",{className:"dimension-preview-values",children:[o.jsxs("div",{className:"dimension-preview-item",children:[o.jsx("span",{className:"dimension-preview-label",children:"Width:"}),o.jsxs("span",{className:"dimension-preview-value",children:[(u.width/1e3).toFixed(2),"m"]})]}),o.jsxs("div",{className:"dimension-preview-item",children:[o.jsx("span",{className:"dimension-preview-label",children:"Length:"}),o.jsxs("span",{className:"dimension-preview-value",children:[(u.length/1e3).toFixed(2),"m"]})]}),o.jsxs("div",{className:"dimension-preview-item",children:[o.jsx("span",{className:"dimension-preview-label",children:"Total Area:"}),o.jsxs("span",{className:"dimension-preview-value",children:[(u.width*u.length/1e6).toFixed(2),"m"]})]})]})]}),o.jsxs("div",{className:"dimension-note",children:[o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"8",cy:"8",r:"7"}),o.jsx("line",{x1:"8",y1:"11",x2:"8",y2:"8"}),o.jsx("circle",{cx:"8",cy:"5",r:"0.5",fill:"currentColor"})]}),o.jsx("p",{children:"These dimensions will be used to calculate material quantities for your PDF specification and to slice your design into 1m1m installation tiles."})]})]}),o.jsxs("div",{className:"dimension-modal-footer",children:[o.jsx("button",{className:"dimension-btn dimension-btn-secondary",onClick:t,children:"Cancel"}),o.jsx("button",{className:"dimension-btn dimension-btn-primary",onClick:g,disabled:l<=0,children:"Confirm Size"})]})]})}),o.jsx("style",{children:`
        .dimension-modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.6);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 10000;
        padding: 20px;
        backdrop-filter: blur(4px);
      }

      .dimension-modal {
        background: white;
        border-radius: 16px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        max-width: 500px;
        width: 100%;
        max-height: 90vh;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        animation: dimensionModalSlideIn 0.3s ease-out;
      }

      @keyframes dimensionModalSlideIn {
        from {
          opacity: 0;
          transform: translateY(-20px) scale(0.95);
        }
        to {
          opacity: 1;
          transform: translateY(0) scale(1);
        }
      }

      .dimension-modal-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 24px;
        border-bottom: 1px solid #e5e7eb;
      }

      .dimension-modal-title {
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .dimension-modal-header h2 {
        margin: 0;
        font-size: 1.5rem;
        font-weight: 600;
        color: #111827;
      }

      .dimension-modal-close {
        background: none;
        border: none;
        font-size: 2rem;
        line-height: 1;
        color: #9ca3af;
        cursor: pointer;
        padding: 0;
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 8px;
        transition: all 0.2s;
      }

      .dimension-modal-close:hover {
        background: #f3f4f6;
        color: #111827;
      }

      .dimension-modal-body {
        padding: 24px;
        overflow-y: auto;
        flex: 1;
      }

      .dimension-info {
        background: #f0f9ff;
        border: 1px solid #bae6fd;
        border-radius: 12px;
        padding: 16px;
        margin-bottom: 24px;
      }

      .dimension-aspect {
        margin: 0;
        color: #0c4a6e;
        font-size: 0.95rem;
        line-height: 1.5;
      }

      .dimension-input-group {
        margin-bottom: 24px;
      }

      .dimension-input-group label {
        display: block;
        font-weight: 600;
        color: #374151;
        margin-bottom: 8px;
        font-size: 0.95rem;
      }

      .dimension-input-wrapper {
        position: relative;
        display: flex;
        align-items: center;
      }

      .dimension-input {
        width: 100%;
        padding: 12px 16px;
        padding-right: 70px;
        font-size: 1.1rem;
        border: 2px solid #d1d5db;
        border-radius: 10px;
        transition: all 0.2s;
        font-family: inherit;
      }

      .dimension-input:focus {
        outline: none;
        border-color: #3b82f6;
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
      }

      .dimension-unit {
        position: absolute;
        right: 16px;
        color: #6b7280;
        font-weight: 500;
        pointer-events: none;
      }

      .dimension-help {
        margin: 8px 0 0 0;
        font-size: 0.85rem;
        color: #6b7280;
      }

      .dimension-preview {
        background: #f9fafb;
        border: 1px solid #e5e7eb;
        border-radius: 12px;
        padding: 20px;
        margin-bottom: 24px;
      }

      .dimension-preview-title {
        font-weight: 600;
        color: #374151;
        margin-bottom: 16px;
        font-size: 0.95rem;
      }

      .dimension-preview-values {
        display: flex;
        flex-direction: column;
        gap: 12px;
      }

      .dimension-preview-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 12px;
        background: white;
        border-radius: 8px;
      }

      .dimension-preview-label {
        color: #6b7280;
        font-size: 0.9rem;
      }

      .dimension-preview-value {
        font-weight: 600;
        color: #111827;
        font-size: 1.05rem;
      }

      .dimension-note {
        display: flex;
        gap: 12px;
        padding: 16px;
        background: #fffbeb;
        border: 1px solid #fde68a;
        border-radius: 10px;
      }

      .dimension-note svg {
        flex-shrink: 0;
        margin-top: 2px;
        color: #f59e0b;
      }

      .dimension-note p {
        margin: 0;
        font-size: 0.85rem;
        color: #78350f;
        line-height: 1.5;
      }

      .dimension-modal-footer {
        padding: 20px 24px;
        border-top: 1px solid #e5e7eb;
        display: flex;
        gap: 12px;
        justify-content: flex-end;
      }

      .dimension-btn {
        padding: 10px 24px;
        border-radius: 8px;
        font-weight: 600;
        font-size: 0.95rem;
        cursor: pointer;
        transition: all 0.2s;
        border: none;
        font-family: inherit;
      }

      .dimension-btn-secondary {
        background: white;
        border: 1px solid #d1d5db;
        color: #374151;
      }

      .dimension-btn-secondary:hover {
        background: #f9fafb;
        border-color: #9ca3af;
      }

      .dimension-btn-primary {
        background: #3b82f6;
        color: white;
      }

      .dimension-btn-primary:hover {
        background: #2563eb;
        box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
      }

      .dimension-btn-primary:disabled {
        background: #9ca3af;
        cursor: not-allowed;
        box-shadow: none;
      }

      @media (max-width: 640px) {
        .dimension-modal {
          max-width: none;
          width: 100%;
          margin: 0;
          max-height: 100vh;
          border-radius: 0;
        }

        .dimension-modal-header {
          padding: 20px;
        }

        .dimension-modal-header h2 {
          font-size: 1.25rem;
        }

        .dimension-modal-body {
          padding: 20px;
        }

        .dimension-modal-footer {
          flex-direction: column-reverse;
          padding: 16px 20px;
        }

        .dimension-btn {
          width: 100%;
        }
      }
      `})]}):null}function CH(e,t,r){return"#"+[e,t,r].map(n=>n.toString(16).padStart(2,"0")).join("").toUpperCase()}async function EH(e,t={}){const{canvasSize:r=500,ignoreWhite:n=!0,ignoreTransparent:i=!0}=t;return new Promise((s,a)=>{const l=document.createElement("canvas");l.width=r,l.height=r;const c=l.getContext("2d",{willReadFrequently:!0}),d=new Image,u=new Blob([e],{type:"image/svg+xml"}),f=URL.createObjectURL(u);d.onload=()=>{try{c.clearRect(0,0,r,r);const h=Math.min(r/d.width,r/d.height),p=d.width*h,g=d.height*h,m=(r-p)/2,x=(r-g)/2;c.drawImage(d,m,x,p,g);const y=c.getImageData(0,0,r,r).data,b=new Map;let w=0;for(let _=0;_<y.length;_+=4){const E=y[_],N=y[_+1],O=y[_+2],I=y[_+3];if(i&&I<128||n&&E>250&&N>250&&O>250)continue;const te=CH(E,N,O),T=b.get(te)||0;b.set(te,T+1),w++}const j=new Map;for(const[_,E]of b)j.set(_,{coverage:w>0?E/w*100:0,pixelCount:E});URL.revokeObjectURL(f),s(j)}catch(h){URL.revokeObjectURL(f),a(h)}},d.onerror=h=>{URL.revokeObjectURL(f),a(new Error("Failed to load SVG for coverage analysis"))},d.src=f})}function ls(e){if(!e)return null;let t=e.replace("#","").toUpperCase();return t.length===3&&(t=t.split("").map(r=>r+r).join("")),"#"+t}function TH(e,t=10){const r=Array.from(e.entries()),n=new Map,i=new Set;for(const[s,a]of r){if(i.has(s))continue;let l=a.coverage,c=a.pixelCount;const d=Gv(s);for(const[u,f]of r){if(s===u||i.has(u))continue;const h=Gv(u);Math.max(Math.abs(d.r-h.r),Math.abs(d.g-h.g),Math.abs(d.b-h.b))<=t&&(l+=f.coverage,c+=f.pixelCount,i.add(u))}i.add(s),n.set(s,{coverage:l,pixelCount:c})}return n}function Gv(e){const t=e.replace("#","");return{r:parseInt(t.substring(0,2),16),g:parseInt(t.substring(2,4),16),b:parseInt(t.substring(4,6),16)}}async function NH(e,t={}){try{const n=await(await fetch(e)).text();return EH(n,t)}catch(r){throw console.error("[CoverageAnalyzer] Failed to fetch SVG from URL:",r),r}}const PH=[{code:"RH01",name:"Standard Red",hex:"#A5362F"},{code:"RH02",name:"Bright Red",hex:"#E21F2F"},{code:"RH10",name:"Standard Green",hex:"#609B63"},{code:"RH11",name:"Bright Green",hex:"#3BB44A"},{code:"RH12",name:"Dark Green",hex:"#006C55"},{code:"RH20",name:"Standard Blue",hex:"#0075BC"},{code:"RH21",name:"Purple",hex:"#493D8C"},{code:"RH22",name:"Light Blue",hex:"#47AFE3"},{code:"RH23",name:"Azure",hex:"#039DC4"},{code:"RH26",name:"Turquoise",hex:"#00A6A3"},{code:"RH30",name:"Standard Beige",hex:"#E4C4AA"},{code:"RH31",name:"Cream",hex:"#E8E3D8"},{code:"RH32",name:"Brown",hex:"#8B5F3C"},{code:"RH90",name:"Funky Pink",hex:"#E8457E"},{code:"RH40",name:"Mustard Yellow",hex:"#E5A144"},{code:"RH41",name:"Bright Yellow",hex:"#FFD833"},{code:"RH50",name:"Orange",hex:"#F15B32"},{code:"RH60",name:"Dark Grey",hex:"#59595B"},{code:"RH61",name:"Light Grey",hex:"#939598"},{code:"RH65",name:"Pale Grey",hex:"#D9D9D6"},{code:"RH70",name:"Black",hex:"#231F20"}];function RH(e){if(!e)return null;const t=ls(e);return PH.find(r=>ls(r.hex)===t)||null}function Vv(e){const t=e.replace("#","");return{r:parseInt(t.substring(0,2),16),g:parseInt(t.substring(2,4),16),b:parseInt(t.substring(4,6),16)}}function qv(e,t,r=10){const n=ls(t);if(!n)return 0;for(const[l,c]of e)if(ls(l)===n)return c.coverage;const i=Vv(n);let s=null,a=1/0;for(const[l,c]of e){const d=Vv(ls(l)),u=Math.max(Math.abs(i.r-d.r),Math.abs(i.g-d.g),Math.abs(i.b-d.b));u<=r&&u<a&&(a=u,s=c)}return s?s.coverage:0}async function Yv(e,t,r,n="solid"){var i,s;if(!e||!t)return t||[];try{const a=await NH(e,{canvasSize:600,ignoreWhite:!0,ignoreTransparent:!0}),l=TH(a,5);console.log("[deriveCurrentColors] Coverage analysis:",l);const c=new Map;r&&r.size>0&&r.forEach(f=>{const h=typeof f=="string"?f:f.hex,p=ls(h);p&&h!=="transparent"&&h!=="none"&&(!c.has(p)||f.tpvCode)&&c.set(p,{hex:p,tpvCode:f.tpvCode||null,tpvName:f.tpvName||null,editType:f.editType||"unknown",blendComponents:f.blendComponents||null})});const d=new Map;for(const f of t){const h=ls(((i=f.blendColor)==null?void 0:i.hex)||((s=f.targetColor)==null?void 0:s.hex));if(!h)continue;const p=qv(l,h,10);p>.1&&d.set(h,{...f,targetColor:{...f.targetColor,areaPct:p}})}for(const[f,h]of c)if(!d.has(f)){const p=qv(l,f,10);if(p>.1){const g=h.tpvCode?{code:h.tpvCode,name:h.tpvName}:RH(f);d.set(f,{originalColor:{hex:f},targetColor:{hex:f,areaPct:p},blendColor:{hex:f},chosenRecipe:h.blendComponents?{components:h.blendComponents,deltaE:0,quality:"Custom Blend"}:{components:g?[{code:g.code,name:g.name,percentage:100,parts:10}]:[{code:"CUSTOM",name:"Custom Color",percentage:100,parts:10}],deltaE:0,quality:g?"Pure TPV Colour":"Custom"},tpvCode:h.tpvCode||(g==null?void 0:g.code)||null,tpvName:h.tpvName||(g==null?void 0:g.name)||null,isAddedFromEdit:!0})}}const u=Array.from(d.values()).sort((f,h)=>{var p,g;return(((p=h.targetColor)==null?void 0:p.areaPct)||0)-(((g=f.targetColor)==null?void 0:g.areaPct)||0)});return console.log("[deriveCurrentColors] Derived colors:",u.length,"colors"),u}catch(a){return console.error("[deriveCurrentColors] Failed to analyze coverage:",a),t}}function OH(e){if(!e||e.size===0)return!1;for(const t of e.values()){const r=typeof t=="string"?t:t.hex;if(r&&r!=="transparent"&&r!=="none")return!0}return!1}const Xv={landscape:[{name:"1:1",ratio:1,width:1024,height:1024},{name:"4:3",ratio:4/3,width:1024,height:768},{name:"3:2",ratio:3/2,width:1024,height:683},{name:"16:9",ratio:16/9,width:1024,height:576},{name:"2:1",ratio:2,width:1024,height:512},{name:"3:1",ratio:3,width:1024,height:341}],portrait:[{name:"1:1",ratio:1,width:1024,height:1024},{name:"3:4",ratio:3/4,width:768,height:1024},{name:"2:3",ratio:2/3,width:683,height:1024},{name:"9:16",ratio:9/16,width:576,height:1024},{name:"1:2",ratio:1/2,width:512,height:1024},{name:"1:3",ratio:1/3,width:341,height:1024}]},da={safeDifference:.3,tilingThreshold:3.5,framingThreshold:2.5};function AH(e,t){return e/t}function MH(e){return e>=.95&&e<=1.05?"square":e>1?"landscape":"portrait"}function $H(e,t){const r=t==="portrait"?Xv.portrait:Xv.landscape;let n=r[0],i=Math.abs(e-n.ratio);for(const s of r){const a=Math.abs(e-s.ratio);a<i&&(i=a,n=s)}return{...n,difference:i}}function LH(e,t,r){return e>=da.tilingThreshold||e<=1/da.tilingThreshold?{mode:"tiling",reason:"Extreme aspect ratio - design will repeat along length",warning:!0}:r>=da.safeDifference||e>=da.framingThreshold||e<=1/da.framingThreshold?{mode:"framing",reason:"Design panel centered with base color surround",warning:!1}:{mode:"full",reason:"Design fills entire surface",warning:!1}}function IH(e,t){const r=AH(e,t),n=MH(r),i=$H(r,n),s=LH(r,i.ratio,i.difference);return{user:{widthMM:e,heightMM:t,aspectRatio:r,orientation:n,formatted:`${(e/1e3).toFixed(1)}m  ${(t/1e3).toFixed(1)}m`},canonical:{name:i.name,ratio:i.ratio,width:i.width,height:i.height,difference:i.difference},layout:s,recraft:{width:i.width,height:i.height,metadata:{targetWidthMM:e,targetHeightMM:t,layoutMode:s.mode}}}}function DH(e){const{user:t,canonical:r,layout:n}=e;let i=`Generating ${r.name} design panel`;return n.mode==="full"?i+=` (fills ${t.formatted} surface)`:n.mode==="framing"?i+=` (centered in ${t.formatted} surface with base color surround)`:n.mode==="tiling"&&(i+=` (will repeat along ${t.formatted} surface)`),i}function zH(e){return e.layout.warning||e.layout.mode!=="full"}async function FH(e,t="tpv-studio-uploads"){try{const r=Date.now(),n=Math.random().toString(36).substring(7),i=e.name.split(".").pop(),a=`uploads/${`${r}-${n}.${i}`}`;console.log("[Upload] Uploading file:",e.name,"",a);const{data:l,error:c}=await Dt.storage.from(t).upload(a,e,{cacheControl:"3600",upsert:!1});if(c)return console.error("[Upload] Error:",c),{success:!1,error:c.message||"Failed to upload file"};const{data:{publicUrl:d}}=Dt.storage.from(t).getPublicUrl(a);return console.log("[Upload] Success:",d),{success:!0,url:d,path:a}}catch(r){return console.error("[Upload] Unexpected error:",r),{success:!1,error:r.message||"Unexpected error during upload"}}}function Kv(e,t={}){const{maxSizeMB:r=10,allowedTypes:n=["image/png","image/jpeg","image/svg+xml"]}=t;if(!e)return{valid:!1,error:"No file selected"};if(!n.includes(e.type))return{valid:!1,error:`Invalid file type. Allowed: ${n.map(a=>a.split("/")[1].toUpperCase()).join(", ")}`};const i=r*1024*1024;return e.size>i?{valid:!1,error:`File too large. Maximum size: ${r}MB`}:{valid:!0}}function BH({onExportSVG:e,onExportPNG:t,onExportPDF:r,onExportTiles:n,viewMode:i,exporting:s,disabled:a}){const[l,c]=A.useState(!1),d=A.useRef(null);A.useEffect(()=>{const h=p=>{d.current&&!d.current.contains(p.target)&&c(!1)};return l&&document.addEventListener("mousedown",h),()=>document.removeEventListener("mousedown",h)},[l]);const u=i==="solid"?"Solid":"Blend",f=h=>{c(!1),h()};return o.jsxs("div",{className:"playground-export-menu",ref:d,children:[o.jsxs("button",{className:"action-bar__btn action-bar__btn--export",onClick:()=>c(!l),disabled:a||s,children:[o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"}),o.jsx("polyline",{points:"7 10 12 15 17 10"}),o.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),s?"Exporting...":"Export",o.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{marginLeft:"0.25rem"},children:o.jsx("path",{d:l?"M18 15l-6-6-6 6":"M6 9l6 6 6-6"})})]}),l&&o.jsxs("div",{className:"playground-export-menu__dropdown",children:[o.jsxs("button",{className:"playground-export-menu__item",onClick:()=>f(e),children:[o.jsx("span",{className:"playground-export-menu__icon",children:""}),o.jsxs("div",{className:"playground-export-menu__content",children:[o.jsxs("span",{className:"playground-export-menu__title",children:["Download ",u," SVG"]}),o.jsx("span",{className:"playground-export-menu__desc",children:"Vector format for CAD/printing"})]})]}),o.jsxs("button",{className:"playground-export-menu__item",onClick:()=>f(t),children:[o.jsx("span",{className:"playground-export-menu__icon",children:""}),o.jsxs("div",{className:"playground-export-menu__content",children:[o.jsxs("span",{className:"playground-export-menu__title",children:["Download ",u," PNG"]}),o.jsx("span",{className:"playground-export-menu__desc",children:"High-res image for presentations"})]})]}),o.jsxs("button",{className:"playground-export-menu__item",onClick:()=>f(n),children:[o.jsx("span",{className:"playground-export-menu__icon",children:""}),o.jsxs("div",{className:"playground-export-menu__content",children:[o.jsx("span",{className:"playground-export-menu__title",children:"Download Tiles ZIP"}),o.jsx("span",{className:"playground-export-menu__desc",children:"1m1m SVG tiles for large printing"})]})]}),o.jsx("div",{className:"playground-export-menu__divider"}),o.jsxs("button",{className:"playground-export-menu__item",onClick:()=>f(r),children:[o.jsx("span",{className:"playground-export-menu__icon",children:""}),o.jsxs("div",{className:"playground-export-menu__content",children:[o.jsxs("span",{className:"playground-export-menu__title",children:[u," Recipe Report (PDF)"]}),o.jsx("span",{className:"playground-export-menu__desc",children:"TPV quantities & specifications"})]})]})]})]})}function ua(e){var r;if(!e)return null;if(e.type==="image/svg+xml")return"svg";if(e.type==="image/png"||e.type==="image/jpeg")return"image";const t=(r=e.name.split(".").pop())==null?void 0:r.toLowerCase();return t==="svg"?"svg":["png","jpg","jpeg"].includes(t)?"image":null}function HH({loadedDesign:e,onDesignSaved:t,isEmbedded:r=!1}){const n=Hc(),{inputMode:i,prompt:s,lengthMM:a,widthMM:l,arMapping:c,uploadedFileUrl:d,result:u,jobId:f,blendRecipes:h,colorMapping:p,blendSvgUrl:g,blendEditedColors:m,solidRecipes:x,solidColorMapping:v,solidSvgUrl:y,solidEditedColors:b,viewMode:w,showFinalRecipes:j,showSolidSummary:_,regionOverrides:E,originalTaggedSvg:N,regionOverridesHistory:O,historyIndex:I,designName:te,currentDesignId:T,hasUnsavedChanges:V,resetDesign:S}=n,K=n.setInputMode,fe=n.setPrompt,U=n.setDimensions,z=n.setArMapping;n.setGenerationResult;const H=n.setResult,Q=n.setJobId;n.setBlendState;const W=n.setBlendRecipes,q=n.setColorMapping,re=n.setBlendSvgUrl;n.setSolidState;const oe=n.setSolidRecipes,pe=n.setSolidColorMapping,Pe=n.setSolidSvgUrl;n.updateBlendSvgUrl,n.updateSolidSvgUrl;const Re=n.setBlendEditedColors,Ae=n.setSolidEditedColors;n.setViewMode;const Ce=n.setShowFinalRecipes,ve=n.setShowSolidSummary,me=n.setRegionOverrides;n.addRegionOverride;const De=n.setOriginalTaggedSvg,Xe=n.setRegionOverridesHistory,C=n.setHistoryIndex;n.canUndo,n.canRedo,n.undo,n.redo;const ce=n.setDesignName,ne=n.setCurrentDesignId,F=n.loadDesign,R=ee=>U(ee,a),M=ee=>U(l,ee),[Z,Y]=A.useState(null),[L,J]=A.useState(null),[ue,ie]=A.useState(!1),[$,X]=A.useState(!1),[ae,we]=A.useState(null),[se,xe]=A.useState(null),[Oe,be]=A.useState(""),[Ne,He]=A.useState(null),[qe,Ze]=A.useState(!1),[Je,Fe]=A.useState(null),[Ve,Ke]=A.useState(!1),[Be,at]=A.useState(null),[qt,ri]=A.useState([]),[Mn,Yt]=A.useState(!1),[ni,wt]=A.useState(!1),[Mt,nr]=A.useState(null),[pn,Ft]=A.useState(!1),[Xt,Kt]=A.useState(!1),[Xr,Ir]=A.useState(!1),[mn,_t]=A.useState(null),[ii,rt]=A.useState(!1),[wr,Ue]=A.useState(null),[ot,pt]=A.useState(null),[et,$n]=A.useState(null),[si,Dr]=A.useState(null),[gn,hr]=A.useState(null),[Kr,_r]=A.useState(!1),[oi,Ln]=A.useState(null),zr=A.useRef(null);A.useEffect(()=>{(y||g)&&zr.current&&!ni&&!qe&&setTimeout(()=>{var ee;(ee=zr.current)==null||ee.scrollIntoView({behavior:"smooth",block:"start"})},300)},[y,g,ni,qe]),A.useEffect(()=>{(async()=>{try{const he=await Fc({limit:1,offset:0});Ln(he.designs.length>0),console.log("[INSPIRE] Existing designs check:",he.designs.length>0?"User has designs":"No designs found")}catch(he){console.error("[INSPIRE] Failed to check for existing designs:",he),Ln(!0)}})()},[]),A.useEffect(()=>{i==="upload"?(U(null,null),console.log("[DIMENSION] Reset dimensions for upload mode")):i==="prompt"&&(l===null||a===null)&&(U(5e3,5e3),console.log("[DIMENSION] Restored default dimensions for prompt mode"))},[i,U]),A.useEffect(()=>()=>{g&&g.startsWith("blob:")&&URL.revokeObjectURL(g),y&&y.startsWith("blob:")&&URL.revokeObjectURL(y)},[]),A.useEffect(()=>{const ee=he=>{he.key==="Escape"&&Ve&&(Ke(!1),at(null))};return window.addEventListener("keydown",ee),()=>window.removeEventListener("keydown",ee)},[Ve]),A.useEffect(()=>{qt.length>0&&!Mn&&Sn()},[qt,Mn]),A.useEffect(()=>{(async()=>{if(!g&&!y){Dr(null),hr(null);return}if(!OH(E)){Dr(h),hr(x);return}_r(!0),console.log("[INSPIRE] Recalculating current recipes from edited SVG...");try{if(g&&h){const he=await Yv(g,h,E,"blend");Dr(he),console.log("[INSPIRE] Derived blend recipes:",he.length)}if(y&&x){const he=await Yv(y,x,E,"solid");hr(he),console.log("[INSPIRE] Derived solid recipes:",he.length)}}catch(he){console.error("[INSPIRE] Failed to recalculate recipes:",he),Dr(h),hr(x)}finally{_r(!1)}})()},[g,y,E,h,x]),A.useEffect(()=>{if(e){console.log("[INSPIRE] Loading design data:",e);const ee=tf(e);console.log("[INSPIRE] Restored state:",ee),F(ee),e.name&&ce(e.name),e.id&&ne(e.id),console.log("[INSPIRE] Loaded design:",e.name),setTimeout(async()=>{var he;if((he=ee.result)!=null&&he.svg_url){console.log("[INSPIRE] Regenerating SVGs from loaded design");let de=ee.originalTaggedSvg||null;if(de)console.log("[INSPIRE] Using saved tagged SVG with preserved region IDs"),De(de);else try{const We=await(await fetch(ee.result.svg_url)).text();de=wo(We),De(de),console.log("[INSPIRE] Tagged SVG with region IDs for loaded design")}catch(Se){console.error("[INSPIRE] Failed to tag SVG regions:",Se)}try{ee.blendRecipes&&ee.colorMapping&&await Wi(ee.result.svg_url,ee.colorMapping,ee.blendRecipes,ee.blendEditedColors,de,ee.regionOverrides),ee.solidRecipes&&ee.solidColorMapping&&await ui(ee.result.svg_url,ee.solidColorMapping,ee.solidRecipes,ee.solidEditedColors,de,ee.regionOverrides)}catch(Se){console.error("[INSPIRE] Failed to regenerate SVGs:",Se),xe("Failed to restore design preview. Please try reloading.")}}},100)}},[e,F,ce,ne,De]);const vn=A.useRef(!1);A.useEffect(()=>{if(e||vn.current||!((u==null?void 0:u.svg_url)&&!g&&!y&&(h||x)))return;vn.current=!0,console.log("[INSPIRE] Detected design loaded directly into store, regenerating SVGs..."),(async()=>{let de=N||null;if(de)console.log("[INSPIRE] Using existing tagged SVG with preserved region IDs");else try{const We=await(await fetch(u.svg_url)).text();de=wo(We),De(de),console.log("[INSPIRE] Tagged SVG with region IDs")}catch(Se){console.error("[INSPIRE] Failed to tag SVG regions:",Se)}try{h&&p&&await Wi(u.svg_url,p,h,m,de,E),x&&v&&await ui(u.svg_url,v,x,b,de,E)}catch(Se){console.error("[INSPIRE] Failed to regenerate SVGs:",Se),xe("Failed to restore design preview. Please try reloading.")}})()},[u,g,y,h,x,p,v,e,E,N]),A.useEffect(()=>{u||(vn.current=!1)},[u]);const ai=ee=>{var Se;const he=(Se=ee.target.files)==null?void 0:Se[0];if(!he){Y(null);return}const de=Kv(he,{maxSizeMB:10,allowedTypes:["image/png","image/jpeg","image/svg+xml"]});if(!de.valid){xe(de.error),Y(null);return}Y(he),xe(null)},ir=ee=>{ee.preventDefault(),ee.stopPropagation(),ie(!0)},Sr=ee=>{ee.preventDefault(),ee.stopPropagation(),ee.currentTarget===ee.target&&ie(!1)},Vo=ee=>{ee.preventDefault(),ee.stopPropagation()},In=ee=>{ee.preventDefault(),ee.stopPropagation(),ie(!1);const he=ee.dataTransfer.files;if(he&&he.length>0){const de=he[0],Se=Kv(de,{maxSizeMB:10,allowedTypes:["image/png","image/jpeg","image/svg+xml"]});if(!Se.valid){xe(Se.error),Y(null);return}Y(de),xe(null)}},yn=async()=>{var ee,he;if(i==="prompt"&&!s.trim()){xe("Please enter a design description");return}if(i==="upload"&&!Z){xe("Please select a file to upload");return}if(i==="upload"&&Z&&!ua(Z)){xe("Unsupported file type. Please upload PNG, JPG, or SVG.");return}xe(null),X(!0),we(null),H(null),Q(null),be("Initialising..."),He(null);try{let de;if(i==="upload"&&Z){const P=ua(Z);be(P==="svg"?"Uploading SVG file...":"Uploading image..."),J("Uploading...");const B=await FH(Z);if(!B.success)throw new Error(B.error||"Failed to upload file");if(J(null),P==="svg"){if(be("Processing SVG..."),de=await qi.processUploadedSVG({svg_url:B.url}),!de.success)throw new Error(de.error||"Failed to process SVG");Q(de.jobId),be(" SVG uploaded successfully!"),X(!1);const k=await qi.getRecraftStatus(de.jobId);we(k),H(k.result),(ee=k.result)!=null&&ee.svg_url&&await Fr(k.result.svg_url,de.jobId);return}else{if(be("Starting vectorisation..."),de=await qi.vectorizeImage({image_url:B.url}),!de.success)throw new Error(de.error||"Failed to start vectorisation");be(" AI is vectorising your image...")}}else if(i==="prompt"){const P=IH(a,l);if(z(P),console.log("[TPV-STUDIO] AR Mapping:",P),console.log("[TPV-STUDIO] Layout:",DH(P)),zH(P)?be(`Generating ${P.canonical.name} design panel...`):be("Initialising..."),de=await qi.generateRecraft({prompt:s.trim(),lengthMM:P.recraft.height,widthMM:P.recraft.width}),!de.success)throw new Error(de.error||"Failed to start generation");be(" AI is creating your design...")}Q(de.jobId),be("Request submitted, waiting for processing...");let Se=null,We=Date.now();await qi.waitForRecraftCompletion(de.jobId,P=>{var k,G;we(P);const B=Math.floor((Date.now()-We)/1e3);if(P.status==="queued"){const le=[` Preparing your canvas... (${B}s)`,` Warming up the AI brushes... (${B}s)`,` Queueing your masterpiece... (${B}s)`,` Mixing digital paints... (${B}s)`,` AI is contemplating your vision... (${B}s)`,` Selecting the perfect colours... (${B}s)`,` Calculating vector paths... (${B}s)`,` Almost ready to create... (${B}s)`],ye=Math.floor(B/4)%le.length;be(le[ye])}else if(P.status==="running")if(Se!=="running")be(" AI is creating your design..."),Se="running";else{const le=[` Creating vector shapes... (${B}s)`,` Applying colours and patterns... (${B}s)`,` Refining design details... (${B}s)`,` Finalising artwork... (${B}s)`],ye=Math.floor(B/5)%le.length;be(le[ye])}else if(P.status==="retrying"){const le=((k=P.recraft)==null?void 0:k.attempt_current)||0,ye=((G=P.recraft)==null?void 0:G.attempt_max)||3;be(` Retrying generation (attempt ${le}/${ye})...`)}});const $e=await qi.getRecraftStatus(de.jobId);we($e),H($e.result),$e.status==="completed"&&(be(" Design ready!"),X(!1),(he=$e.result)!=null&&he.svg_url&&await Fr($e.result.svg_url,de.jobId))}catch(de){console.error("Generation failed:",de),xe(de.message),be(""),X(!1)}},xn=()=>{const ee=w==="solid"?y:g,he=w==="solid"?"tpv-solid":"tpv-blend";if(ee){const de=document.createElement("a");de.href=ee,de.download=`${he}-${Date.now()}.svg`,document.body.appendChild(de),de.click(),document.body.removeChild(de)}},kr=async ee=>{try{const de=await(await fetch(ee)).text(),$e=new DOMParser().parseFromString(de,"image/svg+xml").querySelector("svg");if(!$e)return null;let P,B;const k=$e.getAttribute("viewBox");if(k){const le=k.split(/\s+/).map(Number);P=le[2],B=le[3]}else P=parseFloat($e.getAttribute("width"))||1024,B=parseFloat($e.getAttribute("height"))||1024;const G=P/B;return console.log(`[DIMENSION] Detected aspect ratio: ${G.toFixed(2)} (${P}${B})`),G}catch(he){return console.error("[DIMENSION] Failed to detect aspect ratio:",he),null}},ks=(ee,he)=>{console.log(`[DIMENSION] User confirmed dimensions: ${ee}mm  ${he}mm`),R(ee),M(he),$n({width:ee,height:he}),ot==="pdf"?setTimeout(()=>Zr(ee,he),100):ot==="tiles"?setTimeout(()=>ci(ee,he),100):ot==="insitu"?setTimeout(()=>Ir(!0),100):ot==="save"&&Ft(!0),pt(null)},Dn=async()=>{const ee=w==="solid"?y:g;if(i==="upload"&&(!l||!a)){console.log("[DIMENSION] No dimensions set for upload, showing modal...");const he=await kr(ee);if(he){Ue(he),pt("insitu"),rt(!0);return}else{Ue(1),pt("insitu"),rt(!0);return}}Ir(!0)},mt=()=>{const ee=w==="solid"?y:g,he=w==="solid"?"tpv-solid":"tpv-blend";if(ee){const de=new Image;de.onload=()=>{const Se=document.createElement("canvas");Se.width=de.naturalWidth||1e3,Se.height=de.naturalHeight||1e3,Se.getContext("2d").drawImage(de,0,0),Se.toBlob($e=>{const P=URL.createObjectURL($e),B=document.createElement("a");B.href=P,B.download=`${he}-${Date.now()}.png`,document.body.appendChild(B),B.click(),document.body.removeChild(B),URL.revokeObjectURL(P)})},de.src=ee}},li=()=>{V()&&!window.confirm(`Start a new design?

You have unsaved changes that will be lost.`)||(S(),Y(null),X(!1),we(null),xe(null),be(""),He(null),Ze(!1),Fe(null),Ke(!1),at(null),wt(!1),nr(null))},js=async()=>{const ee=w==="solid"?y:g,he=l>0&&a>0;if(i==="upload"&&!he){console.log("[DIMENSION] No dimensions set for upload, showing modal before save...");const Se=await kr(ee);if(Se){Ue(Se),pt("save"),rt(!0);return}else{Ue(1),pt("save"),rt(!0);return}}Ft(!0)},[zn,Fn]=A.useState(!1),fr=async()=>{const ee=w==="solid"?y:g;if(i==="upload"&&(!l||!a)){console.log("[DIMENSION] No dimensions set for upload, showing modal...");const he=await kr(ee);if(he){Ue(he),pt("pdf"),rt(!0);return}else{Ue(1),pt("pdf"),rt(!0);return}}await Zr(l,a)},Zr=async(ee,he)=>{const de=w==="solid"?y:g,Se=w==="solid"?gn||x:si||h,We=w==="solid"?"tpv-solid":"tpv-blend";if(!de||!Se){xe("Cannot generate PDF: missing SVG or recipes");return}Fn(!0),xe(null);try{const P=await(await fetch(de)).text(),B=new AbortController,k=setTimeout(()=>B.abort(),3e4),G=await Tn.getSession(),le={"Content-Type":"application/json"};G!=null&&G.access_token&&(le.Authorization=`Bearer ${G.access_token}`);const ye=await fetch("/api/export-pdf",{method:"POST",headers:le,signal:B.signal,body:JSON.stringify({svgString:P,designName:te||s||"TPV Design",projectName:"TPV Studio",dimensions:{widthMM:ee,lengthMM:he},recipes:Se,mode:w,designId:f||""})});if(clearTimeout(k),!ye.ok){const Te=ye.headers.get("content-type");if(Te&&Te.includes("application/json")){const Qe=await ye.json();throw new Error(Qe.message||"PDF generation failed")}else{const Qe=await ye.text();throw console.error("PDF API error response:",Qe),new Error(`Server error: ${ye.status}`)}}const je=await ye.blob(),_e=URL.createObjectURL(je),ge=document.createElement("a");ge.href=_e,ge.download=`${We}-${Date.now()}.pdf`,document.body.appendChild(ge),ge.click(),document.body.removeChild(ge),URL.revokeObjectURL(_e)}catch($e){console.error("PDF download error:",$e),$e.name==="AbortError"?xe("PDF generation timed out. Please try again."):xe(`PDF generation failed: ${$e.message}`)}finally{Fn(!1)}},Bi=async()=>{const ee=w==="solid"?y:g;if(!ee){xe("No SVG available to slice");return}if(i==="upload"&&(!l||!a)){console.log("[DIMENSION] No dimensions set for upload, showing modal...");const he=await kr(ee);if(he){Ue(he),pt("tiles"),rt(!0);return}else{Ue(1),pt("tiles"),rt(!0);return}}await ci(l,a)},ci=async(ee,he)=>{const de=w==="solid"?y:g;try{await UE(de,{width:ee,length:he},te||"tpv-design")}catch(Se){console.error("Tile download error:",Se),xe(`Failed to download tiles: ${Se.message}`)}},Fr=async(ee=null,he=null)=>{const de=ee||(u==null?void 0:u.svg_url),Se=he||f;if(!de){xe("No SVG available to analyse");return}{console.log("[TPV-STUDIO] Blend mode disabled - skipping blend recipes, generating solid only"),xe(null),be(" Processing design colours...");let We=null;try{const P=await(await fetch(de)).text();We=wo(P),De(We),console.log("[TPV-STUDIO] Tagged SVG with region IDs")}catch($e){console.error("[TPV-STUDIO] Failed to tag SVG regions:",$e)}await _n(de,Se,We);return}},bn=async()=>{Ze(!1),Fe(null),wt(!1),nr(null),w==="solid"?Ae(new Map):Re(new Map),u!=null&&u.svg_url&&await Fr(u.svg_url,f)},wn=async ee=>{var he;if(!te){if(!s||i!=="prompt"){Z&&ce(`TPV Design  ${Z.name.replace(/\.[^/.]+$/,"")}`);return}Kt(!0);try{const de=(ee==null?void 0:ee.slice(0,6).map(We=>{var P,B;const $e=(B=(P=We.chosenRecipe)==null?void 0:P.components)==null?void 0:B[0];return($e==null?void 0:$e.name)||null}).filter(Boolean))||[],Se=await qi.generateDesignName({prompt:s,colors:de,dimensions:{widthMM:l,lengthMM:a}});Se.success&&((he=Se.names)==null?void 0:he.length)>0?ce(Se.names[0]):ce(di(s))}catch(de){console.error("[TPV-STUDIO] Name generation failed:",de),ce(di(s))}finally{Kt(!1)}}},di=ee=>ee?`TPV Design  ${ee.split(/[,.]/)[0].trim().slice(0,40)}`:"TPV Playground Design",_n=async(ee=null,he=null,de=null)=>{const Se=ee||(u==null?void 0:u.svg_url),We=he||f,$e=de||N;if(Se)try{console.log("[TPV-STUDIO] Generating solid color version...");const P=await fetch("/api/solid-recipes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({svg_url:Se,job_id:We,max_colors:15})}),B=await P.json();if(!P.ok)throw new Error(B.error||"Failed to generate solid recipes");if(B.success){oe(B.recipes);const k=new Map(Object.entries(B.colorMapping||{}));console.log("[TPV-STUDIO] Using API colorMapping with",k.size,"entries"),pe(k);try{const{dataUrl:G,stats:le}=await ts(Se,k,$e);Pe(G),console.log("[TPV-STUDIO] Solid color SVG generated:",le),le.colorsNotMapped&&le.colorsNotMapped.size>0&&console.warn("[TPV-STUDIO] Unmapped colors in solid mode:",Array.from(le.colorsNotMapped)),wn(B.recipes)}catch(G){console.error("[TPV-STUDIO] Failed to generate solid SVG:",G)}}}catch(P){console.error("[TPV-STUDIO] Solid generation failed:",P)}},qo=(ee,he="palette")=>{if(console.log("[TPV-STUDIO] Color clicked:",ee,"source:",he,"in mode:",w),Ve&&Be&&he==="palette"){gt(Be.regionId,ee.hex),Ke(!1),at(null);return}he==="palette"&&(w==="blend"?(nr(ee),wt(!0),Ce(!1)):(Fe(ee),Ze(!0),ve(!1)))},Yo=ee=>{console.log("[TPV-STUDIO] Region clicked:",ee),Ve?(gt(Be.regionId,ee.sourceColor),Ke(!1),at(null)):(Ke(!0),at(ee))},gt=(ee,he)=>{const de=typeof he=="string"?{hex:he,editType:"eyedrop"}:he;console.log("[TPV-STUDIO] Queuing region recolor:",ee,"->",de),ri(Se=>[...Se,{regionId:ee,colorData:{...de,hex:de.hex.toLowerCase()},viewMode:w}])},Sn=async()=>{if(Mn||qt.length===0)return;Yt(!0);const ee=qt[0],he=ee.colorData;console.log("[TPV-STUDIO] Processing queued region recolor:",ee.regionId,"->",he);try{const de=new Map(E);de.set(ee.regionId,he),ee.viewMode==="blend"?await $t(null,null,de):await Zt(null,null,de),me(de);const Se=n.historyIndex,$e=n.regionOverridesHistory.slice(0,Se+1);$e.push(new Map(de)),$e.length>50&&$e.shift(),Xe($e),C($e.length-1),console.log("[TPV-STUDIO] Completed region recolor for:",ee.regionId)}catch(de){console.error("[TPV-STUDIO] Failed to process region recolor:",de)}finally{ri(de=>de.slice(1)),Yt(!1)}},Xo=()=>{console.log("[TPV-STUDIO] Eyedropper cancelled"),Ke(!1),at(null)},Cs=()=>{Be&&(console.log("[TPV-STUDIO] Making region transparent:",Be.regionId),gt(Be.regionId,"transparent"),Ke(!1),at(null))},Hi=ee=>{if(!Be)return;console.log("[TPV-STUDIO] Selecting TPV color for region:",Be.regionId,ee);const he={hex:ee.hex,tpvCode:ee.code,tpvName:ee.name,originalHex:Be.sourceColor,editType:"solid"};gt(Be.regionId,he),Ke(!1),at(null)},Es=async()=>{if(I<=0)return;const ee=I-1,he=O[ee];console.log("[TPV-STUDIO] Undoing region override to index:",ee),me(new Map(he)),C(ee),w==="blend"?await $t(null,null,he):await Zt(null,null,he)},Ts=async()=>{if(I>=O.length-1)return;const ee=I+1,he=O[ee];console.log("[TPV-STUDIO] Redoing region override to index:",ee),me(new Map(he)),C(ee),w==="blend"?await $t(null,null,he):await Zt(null,null,he)},Ko=async ee=>{if(Je)if(console.log("[TPV-STUDIO] Color changed:",Je.hex,"->",ee,"in mode:",w),w==="solid"){const de=(gn||x).find(Se=>Se.targetColor.hex.toLowerCase()===Je.hex.toLowerCase());if(de!=null&&de.isAddedFromEdit){const Se=Je.hex.toLowerCase(),We=new Map(E);let $e=0;const P=cr.find(k=>k.hex.toLowerCase()===ee.toLowerCase());E.forEach((k,G)=>{(typeof k=="string"?k:k.hex).toLowerCase()===Se&&(We.set(G,{hex:ee,tpvCode:(P==null?void 0:P.code)||null,tpvName:(P==null?void 0:P.name)||null,originalHex:k.originalHex||Se,editType:"solid"}),$e++)}),console.log("[TPV-STUDIO] Updated",$e,"region overrides for derived color:",Se,"->",ee);const B=O.slice(0,I+1);B.push(new Map(We)),B.length>50&&B.shift(),me(We),Xe(B),C(B.length-1),Fe({...Je,hex:ee,blendHex:ee}),await Zt(b,ee,We)}else{const Se=new Map(b),We=(de==null?void 0:de.mergedOriginalColors)||[Je.originalHex.toLowerCase()];console.log("[TPV-STUDIO] Updating",We.length,"original colors:",We),We.forEach($e=>{Se.set($e,{newHex:ee.toLowerCase()})}),Ae(Se),Fe({...Je,hex:ee,blendHex:ee}),await Zt(Se,ee)}}else{const he=new Map(m);he.set(Je.originalHex.toLowerCase(),{newHex:ee.toLowerCase()}),Re(he),Fe({...Je,hex:ee,blendHex:ee}),await $t(he,ee)}};A.useCallback(async({blendHex:ee,parts:he,recipe:de})=>{if(Mt)if(console.log("[TPV-STUDIO] Mixer blend changed:",Mt.originalHex,"->",ee,"recipe:",de,"isAddedFromEdit:",Mt.isAddedFromEdit),Mt.isAddedFromEdit){const Se=Mt.hex.toLowerCase(),We=new Map(E);let $e=0;E.forEach((B,k)=>{(typeof B=="string"?B:B.hex).toLowerCase()===Se&&(We.set(k,{hex:ee,originalHex:B.originalHex||Se,editType:"blend",blendComponents:(de==null?void 0:de.components)||null}),$e++)}),console.log("[TPV-STUDIO] Updated",$e,"region overrides for derived blend color:",Se,"->",ee),nr({...Mt,hex:ee,blendHex:ee}),await $t(m,ee,We);const P=O.slice(0,I+1);P.push(new Map(We)),P.length>50&&P.shift(),me(We),Xe(P),C(P.length-1)}else{const Se=new Map(m);Se.set(Mt.originalHex.toLowerCase(),{newHex:ee.toLowerCase(),recipe:de,parts:he}),Re(Se),nr({...Mt,hex:ee,blendHex:ee}),await $t(Se,ee)}},[Mt,m,E,O,I,u,p]);const $t=async(ee=null,he=null,de=null)=>{if(!(!(u!=null&&u.svg_url)||!p||!h))try{const Se=new Map(p),We=ee||m;We.forEach((je,_e)=>{if(je.newHex){const ge=_e.toLowerCase();Se.set(ge,{...Se.get(ge),blendHex:je.newHex})}});const $e=h.map(je=>{const _e=We.get(je.originalColor.hex.toLowerCase());if(_e!=null&&_e.newHex){const ge={...je,targetColor:{...je.targetColor,hex:_e.newHex},blendColor:{...je.blendColor,hex:_e.newHex}};return _e.recipe&&_e.recipe.components&&(ge.chosenRecipe={...je.chosenRecipe,components:_e.recipe.components,deltaE:0,quality:"Excellent"}),ge}return je}),{svgText:P,stats:B}=await ts(u.svg_url,Se,N),k=de!==null?de:E,G=fo(P,k);g&&g.startsWith("blob:")&&(URL.revokeObjectURL(g),console.log("[TPV-STUDIO] Revoked old blend blob URL"));const le=new Blob([G],{type:"image/svg+xml"}),ye=URL.createObjectURL(le);console.log("[TPV-STUDIO] Created new blend blob URL, SVG length:",G.length),re(ye),q(Se),W($e),console.log("[TPV-STUDIO] Blend SVG regenerated with edits:",B),k.size>0&&console.log("[TPV-STUDIO] Applied",k.size,"region overrides")}catch(Se){console.error("[TPV-STUDIO] Failed to regenerate blend SVG:",Se)}},Zt=async(ee=null,he=null,de=null)=>{if(!(!(u!=null&&u.svg_url)||!v||!x))try{const Se=new Map(v),We=ee||b;We.forEach((je,_e)=>{if(je.newHex){const ge=_e.toLowerCase();Se.set(ge,{...Se.get(ge),blendHex:je.newHex})}});const $e=x.map(je=>{const _e=We.get(je.originalColor.hex.toLowerCase());if(_e!=null&&_e.newHex){const ge=cr.find(Te=>Te.hex.toLowerCase()===_e.newHex.toLowerCase());return ge?{...je,targetColor:{...je.targetColor,hex:_e.newHex},blendColor:{hex:_e.newHex,rgb:ge.rgb,lab:ge.lab},chosenRecipe:{components:[{code:ge.code,name:ge.name,hex:ge.hex,rgb:ge.rgb,lab:ge.lab,ratio:1}],blendColor:{hex:ge.hex,rgb:ge.rgb,lab:ge.lab},deltaE:0,quality:"Perfect"}}:{...je,targetColor:{...je.targetColor,hex:_e.newHex},blendColor:{...je.blendColor,hex:_e.newHex}}}return je}),{svgText:P,stats:B}=await ts(u.svg_url,Se,N),k=de!==null?de:E,G=fo(P,k);y&&y.startsWith("blob:")&&(URL.revokeObjectURL(y),console.log("[TPV-STUDIO] Revoked old solid blob URL"));const le=new Blob([G],{type:"image/svg+xml"}),ye=URL.createObjectURL(le);console.log("[TPV-STUDIO] Created new solid blob URL, SVG length:",G.length),Pe(ye),pe(Se),oe($e),console.log("[TPV-STUDIO] Solid SVG regenerated with edits:",B),k.size>0&&console.log("[TPV-STUDIO] Applied",k.size,"region overrides")}catch(Se){console.error("[TPV-STUDIO] Failed to regenerate solid SVG:",Se)}},Ui=ee=>{if(!(ee!=null&&ee.components))return null;const he={};return ee.components.forEach(de=>{de.code&&de.parts&&(he[de.code]=de.parts)}),Object.keys(he).length>0?{parts:he}:null};A.useCallback(ee=>{var de;if(!ee)return null;const he=m.get((de=ee.originalHex)==null?void 0:de.toLowerCase());return he!=null&&he.recipe?he.recipe:ee.isAddedFromEdit&&ee.chosenRecipe?Ui(ee.chosenRecipe):ee.recipe||null},[m]);const Wi=async(ee,he,de,Se,We=null,$e=null)=>{try{console.log("[INSPIRE] Regenerating blend SVG from state");const P=new Map(he);Se&&Se.size>0&&Se.forEach((je,_e)=>{const ge=_e.toLowerCase();P.has(ge)&&P.set(ge,{...P.get(ge),blendHex:je.newHex})});const{dataUrl:B,svgText:k}=await ts(ee,P,We);let G=k;$e&&$e.size>0&&(console.log("[INSPIRE] Applying",$e.size,"region overrides to blend SVG"),G=fo(k,$e));const le=new Blob([G],{type:"image/svg+xml"}),ye=URL.createObjectURL(le);re(ye),console.log("[INSPIRE] Blend SVG regenerated")}catch(P){console.error("[INSPIRE] Failed to regenerate blend SVG:",P)}},ui=async(ee,he,de,Se,We=null,$e=null)=>{try{console.log("[INSPIRE] Regenerating solid SVG from state");const P=new Map(he);Se&&Se.size>0&&Se.forEach((je,_e)=>{const ge=_e.toLowerCase();P.has(ge)&&P.set(ge,{...P.get(ge),blendHex:je.newHex})});const{dataUrl:B,svgText:k}=await ts(ee,P,We);let G=k;$e&&$e.size>0&&(console.log("[INSPIRE] Applying",$e.size,"region overrides to solid SVG"),G=fo(k,$e));const le=new Blob([G],{type:"image/svg+xml"}),ye=URL.createObjectURL(le);Pe(ye),console.log("[INSPIRE] Solid SVG regenerated")}catch(P){console.error("[INSPIRE] Failed to regenerate solid SVG:",P)}};return o.jsxs("div",{className:`inspire-panel-recraft${r?" inspire-panel-recraft--embedded":""}`,children:[!r&&o.jsxs("div",{className:"panel-header",children:[o.jsx("h2",{children:"TPV Studio - Vector AI"}),o.jsx("p",{className:"subtitle",children:"AI-powered vector designs for playground surfacing"})]}),!u&&!$&&oi===!1&&o.jsxs("div",{className:"welcome-guidance",children:[o.jsx("div",{className:"welcome-icon",children:""}),o.jsx("h3",{children:"Create Your First Design"}),o.jsx("p",{children:"Choose how you'd like to create your TPV design below. You can describe what you want, upload an image to convert, or process an existing SVG file. Once generated, you'll be able to edit colours, export PDFs with specifications, and preview designs on-site."})]}),o.jsxs("div",{className:"input-mode-tabs",children:[o.jsxs("button",{className:`input-mode-tab ${i==="prompt"?"active":""}`,onClick:()=>{K("prompt"),Y(null),xe(null)},disabled:$,children:[o.jsxs("svg",{className:"mode-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M12 3l1.545 4.635L18.18 9.18l-4.635 1.545L12 15.36l-1.545-4.635L5.82 9.18l4.635-1.545L12 3z"}),o.jsx("path",{d:"M5 21l1.5-4.5L2 15l4.5-1.5L8 9l1.5 4.5L14 15l-4.5 1.5L8 21z",opacity:"0.5"})]}),o.jsx("span",{className:"mode-title",children:"Text Prompt"}),o.jsx("span",{className:"mode-description",children:"Describe your design"})]}),o.jsxs("button",{className:`input-mode-tab ${i==="upload"?"active":""}`,onClick:()=>{K("upload"),fe(""),xe(null)},disabled:$,children:[o.jsxs("svg",{className:"mode-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),o.jsx("polyline",{points:"17 8 12 3 7 8"}),o.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]}),o.jsx("span",{className:"mode-title",children:"Upload Design"}),o.jsx("span",{className:"mode-description",children:"PNG, JPG, or SVG"})]})]}),o.jsxs("div",{className:"form-section",children:[i==="prompt"&&o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"prompt",children:"Design Description"}),o.jsx("textarea",{id:"prompt",value:s,onChange:ee=>fe(ee.target.value),placeholder:"e.g., calm ocean theme with big fish silhouettes and waves",rows:4,disabled:$,className:"prompt-input"}),o.jsx("p",{className:"helper-text",children:"Describe the design you want to generate. The AI will create a vector illustration based on your description. Perfect for creating completely new designs from scratch - just describe colors, themes, and elements you want."})]}),i==="upload"&&o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"design-upload",children:"Upload Design File"}),o.jsxs("div",{className:`drop-zone ${ue?"dragging":""} ${Z?"has-file":""}`,onDragEnter:ir,onDragLeave:Sr,onDragOver:Vo,onDrop:In,children:[o.jsx("input",{id:"design-upload",type:"file",accept:".png,.jpg,.jpeg,.svg,image/png,image/jpeg,image/svg+xml",onChange:ai,disabled:$,className:"file-input-hidden"}),o.jsx("label",{htmlFor:"design-upload",className:"drop-zone-content",children:Z?o.jsxs(o.Fragment,{children:[o.jsxs("svg",{className:"upload-icon success",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),o.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),o.jsx("span",{className:"file-name",children:Z.name}),o.jsx("span",{className:"file-type-badge",children:ua(Z)==="svg"?"SVG - will process immediately":"Image - will vectorise with AI"}),o.jsx("span",{className:"drop-hint",children:"Click to change file"})]}):o.jsxs(o.Fragment,{children:[o.jsxs("svg",{className:"upload-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),o.jsx("polyline",{points:"17 8 12 3 7 8"}),o.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]}),o.jsx("span",{className:"drop-text",children:"Drag & drop your design here"}),o.jsx("span",{className:"drop-hint",children:"or click to browse"}),o.jsx("span",{className:"supported-formats",children:"PNG, JPG, or SVG"})]})})]}),o.jsxs("p",{className:"helper-text",children:["Upload your design file. ",o.jsx("strong",{children:"PNG/JPG"})," images will be vectorised with AI (~30 seconds). ",o.jsx("strong",{children:"SVG"})," files are processed immediately for TPV colour matching."]})]}),i==="prompt"&&o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"length",children:"Length (mm)"}),o.jsx("input",{id:"length",type:"number",value:a,onChange:ee=>M(parseInt(ee.target.value,10)),min:1e3,max:2e4,step:100,disabled:$})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"width",children:"Width (mm)"}),o.jsx("input",{id:"width",type:"number",value:l,onChange:ee=>R(parseInt(ee.target.value,10)),min:1e3,max:2e4,step:100,disabled:$})]})]}),se&&o.jsxs("div",{className:"error-message",children:[o.jsx("strong",{children:"Error:"})," ",se]}),L&&o.jsx("div",{className:"upload-progress",children:o.jsx("p",{children:L})}),o.jsx("button",{onClick:yn,disabled:$||i==="prompt"&&!s.trim()||i==="upload"&&!Z,className:"generate-button",children:$?i==="upload"&&Z&&ua(Z)==="svg"?"Processing...":"Generating...":i==="prompt"?"Generate Vector Design":Z&&ua(Z)==="svg"?"Process SVG":"Vectorise & Process"})]}),$&&o.jsxs("div",{className:"progress-section",children:[o.jsx("div",{className:"progress-bar",children:o.jsx("div",{className:"progress-bar-fill"})}),o.jsx("p",{className:"progress-message",children:Oe})]}),u&&!$&&o.jsxs("div",{className:"results-section",children:[c&&o.jsxs("div",{className:`ar-info ${c.layout.mode}`,children:[o.jsxs("div",{className:"ar-info-header",children:[o.jsx("strong",{children:"Layout:"})," ",c.layout.reason]}),o.jsxs("div",{className:"ar-info-details",children:[o.jsxs("span",{children:["Requested: ",c.user.formatted]}),o.jsx("span",{children:""}),o.jsxs("span",{children:["Generated: ",c.canonical.name," panel"]}),c.layout.mode==="framing"&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:""}),o.jsx("span",{className:"layout-note",children:"Panel centred with base colour surround"})]}),c.layout.mode==="tiling"&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:""}),o.jsx("span",{className:"layout-note",children:"Pattern will repeat along length"})]})]})]}),es.BLEND_MODE_ENABLED,es.BLEND_MODE_ENABLED,w==="solid"&&y&&x&&o.jsx("div",{ref:zr,children:o.jsx(KE,{blendSvgUrl:y,recipes:gn||x,mode:"solid",onColorClick:qo,onRegionClick:Yo,onEyedropperCancel:Xo,onMakeTransparent:Cs,onSelectTPVColor:Hi,selectedColor:Je,editedColors:b,onResetAll:bn,designName:te,onNameChange:ce,isNameLoading:Xt,onInSituClick:Dn,eyedropperActive:Ve,eyedropperRegion:Be,onRegionUndo:Es,onRegionRedo:Ts,canUndo:I>0,canRedo:I<O.length-1,regionOverridesCount:E.size})}),es.BLEND_MODE_ENABLED,(g||y)&&o.jsxs("div",{className:"action-bar",children:[o.jsxs("button",{className:"action-bar__btn action-bar__btn--secondary",onClick:li,title:"Start a new design",children:[o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M12 5v14M5 12h14"})}),"New"]}),o.jsxs("button",{className:"action-bar__btn action-bar__btn--primary",onClick:js,title:"Save this design to your gallery",children:[o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z"}),o.jsx("polyline",{points:"17 21 17 13 7 13 7 21"}),o.jsx("polyline",{points:"7 3 7 8 15 8"})]}),"Save"]}),o.jsx(BH,{onExportSVG:xn,onExportPNG:mt,onExportPDF:fr,onExportTiles:Bi,viewMode:w,exporting:zn,disabled:!(g||y)})]})]}),es.BLEND_MODE_ENABLED,w==="solid"&&y&&x&&!_&&o.jsxs("div",{className:"finalize-section",children:[o.jsx("button",{onClick:()=>ve(!0),className:"finalize-button",children:"View TPV Colours Used"}),o.jsx("p",{className:"finalize-hint",children:"See which pure TPV colours are used in this design"})]}),es.BLEND_MODE_ENABLED,_&&x&&o.jsx(qE,{recipes:gn||x,onClose:()=>{ve(!1)},isRecalculating:Kr}),qe&&Je&&o.jsx(lH,{color:Je,mode:w,onColorChange:Ko,onClose:()=>{Ze(!1),Fe(null)}}),pn&&o.jsx(uH,{currentState:{inputMode:i,prompt:s,selectedFile:Z,lengthMM:(et==null?void 0:et.height)||a,widthMM:(et==null?void 0:et.width)||l,result:u,viewMode:w,blendRecipes:h,solidRecipes:x,colorMapping:p,solidColorMapping:v,solidEditedColors:b,blendEditedColors:m,blendSvgUrl:g,solidSvgUrl:y,arMapping:c,jobId:f,inSituData:mn,regionOverrides:E,originalTaggedSvg:N},existingDesignId:T,initialName:te,onClose:()=>{Ft(!1),$n(null)},onSaved:(ee,he)=>{Ft(!1),$n(null),Ln(!0),he&&ce(he),t&&t(he),console.log("[INSPIRE] Design saved:",ee)}}),Xr&&o.jsx(Z1,{designUrl:w==="solid"?y:g,designDimensions:{width:l,length:a},onClose:()=>Ir(!1),onSaved:ee=>{console.log("[INSPIRE] In-situ preview saved:",ee),_t(ee),Ir(!1)}}),o.jsx(jH,{isOpen:ii,onClose:()=>{rt(!1),pt(null)},onConfirm:ks,aspectRatio:wr,defaultLongestSide:5e3}),o.jsx("style",{jsx:!0,children:`
        .inspire-panel-recraft {
          max-width: var(--max-width-xl);
          margin: 0 auto;
          padding: var(--space-4);
        }

        .panel-header {
          text-align: center;
          margin-bottom: var(--space-6);
        }

        .panel-header h2 {
          font-family: var(--font-heading);
          font-size: var(--text-3xl);
          margin: 0 0 var(--space-2) 0;
          color: var(--color-primary);
          font-weight: var(--font-bold);
          letter-spacing: var(--tracking-tight);
        }

        .subtitle {
          color: var(--color-text-secondary);
          font-size: var(--text-base);
          line-height: var(--leading-relaxed);
        }

        /* Welcome Guidance */
        .welcome-guidance {
          background: linear-gradient(135deg, #fff5f0 0%, #fff9f7 100%);
          border: 2px solid #ff6b35;
          border-radius: var(--radius-lg);
          padding: var(--space-6);
          margin-bottom: var(--space-6);
          text-align: center;
        }

        .welcome-icon {
          font-size: 3rem;
          margin-bottom: var(--space-2);
        }

        .welcome-guidance h3 {
          margin: 0 0 var(--space-3);
          font-size: var(--text-xl);
          font-weight: var(--font-bold);
          color: var(--color-primary);
        }

        .welcome-guidance p {
          margin: 0;
          color: var(--color-text-secondary);
          font-size: var(--text-base);
          line-height: var(--leading-relaxed);
          max-width: 600px;
          margin-left: auto;
          margin-right: auto;
        }

        /* Input Mode Tabs - Enhanced cards */
        .input-mode-tabs {
          display: flex;
          gap: var(--space-2);
          margin-bottom: var(--space-3);
          background: var(--color-bg-subtle);
          padding: var(--space-1);
          border-radius: var(--radius-lg);
        }

        .input-mode-tab {
          flex: 1;
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: var(--space-1);
          padding: var(--space-3);
          background: var(--color-bg-card);
          border: 1px solid var(--color-border);
          border-radius: var(--radius-md);
          cursor: pointer;
          transition: all var(--transition-base);
        }

        .input-mode-tab:hover:not(:disabled) {
          border-color: var(--color-primary);
          transform: translateY(-2px);
          box-shadow: var(--shadow-md);
        }

        .input-mode-tab.active {
          background: linear-gradient(135deg, var(--color-bg-subtle) 0%, var(--color-bg-card) 100%);
          border-color: var(--color-primary);
          box-shadow: var(--shadow-glow);
        }

        .input-mode-tab:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .mode-icon {
          width: 28px;
          height: 28px;
          color: var(--color-text-secondary);
          transition: all var(--transition-base);
        }

        .input-mode-tab:hover:not(:disabled) .mode-icon {
          color: var(--color-primary);
          transform: scale(1.1);
        }

        .input-mode-tab.active .mode-icon {
          color: var(--color-primary);
        }

        .input-mode-tab .mode-title {
          font-family: var(--font-heading);
          font-size: var(--text-sm);
          font-weight: var(--font-semibold);
          color: var(--color-text-primary);
          margin-top: 0;
        }

        .input-mode-tab .mode-description {
          display: none; /* Hidden to save space */
        }

        .input-mode-tab.active .mode-title {
          color: var(--color-primary);
          font-weight: var(--font-bold);
        }

        /* Helper text */
        .helper-text {
          margin-top: var(--space-1);
          font-size: var(--text-sm);
          color: var(--color-text-tertiary);
          font-style: normal;
          line-height: var(--leading-snug);
        }

        /* Drag & Drop File Upload */
        .file-input-hidden {
          position: absolute;
          width: 1px;
          height: 1px;
          padding: 0;
          margin: -1px;
          overflow: hidden;
          clip: rect(0, 0, 0, 0);
          white-space: nowrap;
          border: 0;
        }

        .drop-zone {
          position: relative;
          width: 100%;
          min-height: 120px;
          border: 2px dashed var(--color-border);
          border-radius: var(--radius-lg);
          background: var(--color-bg-subtle);
          transition: all var(--transition-base);
        }

        .drop-zone.dragging {
          border-color: var(--color-primary);
          background: var(--color-primary-light);
          background: linear-gradient(135deg, rgba(30, 74, 122, 0.05) 0%, rgba(30, 74, 122, 0.1) 100%);
          box-shadow: var(--shadow-glow);
        }

        .drop-zone.has-file {
          border-color: var(--color-success);
          background: var(--color-success-light);
        }

        .drop-zone-content {
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          gap: var(--space-1);
          padding: var(--space-4);
          cursor: pointer;
          min-height: 120px;
        }

        .upload-icon {
          width: 36px;
          height: 36px;
          color: var(--color-text-secondary);
          transition: all var(--transition-base);
        }

        .upload-icon.success {
          color: var(--color-success);
        }

        .drop-zone:hover .upload-icon {
          color: var(--color-primary);
          transform: scale(1.1);
        }

        .drop-zone.has-file:hover .upload-icon.success {
          color: var(--color-success);
        }

        .drop-text {
          font-size: var(--text-base);
          font-weight: var(--font-semibold);
          color: var(--color-text-primary);
        }

        .file-name {
          font-size: var(--text-base);
          font-weight: var(--font-semibold);
          color: var(--color-success);
          max-width: 100%;
          overflow: hidden;
          text-overflow: ellipsis;
          white-space: nowrap;
        }

        .drop-hint {
          font-size: var(--text-sm);
          color: var(--color-text-tertiary);
        }

        .file-type-badge {
          display: inline-block;
          font-size: var(--text-xs);
          color: var(--color-text-secondary);
          background: var(--color-bg-tertiary);
          padding: var(--space-1) var(--space-2);
          border-radius: var(--radius-sm);
          margin-top: var(--space-1);
        }

        .supported-formats {
          display: block;
          font-size: var(--text-xs);
          color: var(--color-text-tertiary);
          margin-top: var(--space-2);
          font-weight: var(--font-medium);
        }

        .drop-zone.dragging .drop-text,
        .drop-zone.dragging .drop-hint {
          color: var(--color-primary);
        }

        .upload-progress {
          padding: var(--space-2);
          background: var(--color-info-light);
          border: 1px solid var(--color-info);
          border-radius: var(--radius-md);
          color: var(--color-info);
          margin-bottom: var(--space-2);
          text-align: center;
          font-size: var(--text-sm);
        }

        .form-section {
          background: var(--color-bg-card);
          padding: var(--space-3);
          border-radius: var(--radius-lg);
          margin-bottom: var(--space-3);
          border: 1px solid var(--color-border);
          box-shadow: var(--shadow-xs);
        }

        .form-group {
          margin-bottom: var(--space-3);
        }

        .form-group label {
          display: block;
          margin-bottom: var(--space-2);
          font-weight: var(--font-semibold);
          color: var(--color-text-primary);
          font-size: var(--text-sm);
        }

        .prompt-input {
          width: 100%;
          padding: var(--space-3);
          border: 1px solid var(--color-border);
          border-radius: var(--radius-md);
          font-family: inherit;
          font-size: var(--text-base);
          background: var(--color-bg-card);
          color: var(--color-text-primary);
          transition: border-color var(--transition-base);
        }

        .prompt-input:focus {
          outline: none;
          border-color: var(--color-primary);
          box-shadow: var(--shadow-glow);
        }

        .form-row {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: var(--space-3);
        }

        input[type="number"] {
          width: 100%;
          padding: var(--space-2);
          border: 1px solid var(--color-border);
          border-radius: var(--radius-md);
          background: var(--color-bg-card);
          color: var(--color-text-primary);
          font-size: var(--text-base);
          transition: border-color var(--transition-base);
        }

        input[type="number"]:focus {
          outline: none;
          border-color: var(--color-primary);
          box-shadow: var(--shadow-glow);
        }

        .error-message {
          padding: var(--space-3);
          background: var(--color-error-light);
          border: 1px solid var(--color-error);
          border-radius: var(--radius-md);
          color: var(--color-error);
          margin-bottom: var(--space-4);
          font-size: var(--text-sm);
        }

        .generate-button {
          width: 100%;
          padding: var(--space-4);
          background: var(--color-accent);
          color: white;
          border: none;
          border-radius: var(--radius-md);
          font-size: var(--text-lg);
          font-weight: var(--font-semibold);
          cursor: pointer;
          transition: all var(--transition-base);
          box-shadow: var(--shadow-sm);
        }

        .generate-button:hover:not(:disabled) {
          background: var(--color-accent-hover);
          transform: translateY(-2px);
          box-shadow: 0 8px 24px rgba(255, 107, 53, 0.3);
        }

        .generate-button:disabled {
          background: var(--color-bg-subtle);
          color: var(--color-text-tertiary);
          cursor: not-allowed;
          transform: none;
          box-shadow: none;
        }

        .progress-section {
          padding: var(--space-4);
          background: var(--color-info-light);
          border-radius: var(--radius-lg);
          margin-bottom: var(--space-4);
          border: 1px solid var(--color-info);
        }

        .progress-bar {
          height: 4px;
          background: var(--color-border);
          border-radius: var(--radius-full);
          overflow: hidden;
          margin-bottom: var(--space-3);
        }

        .progress-bar-fill {
          height: 100%;
          background: var(--color-accent);
          animation: progress 2s ease-in-out infinite;
        }

        @keyframes progress {
          0% { transform: translateX(-100%); }
          100% { transform: translateX(100%); }
        }

        .progress-message {
          text-align: center;
          color: var(--color-text-secondary);
          font-weight: var(--font-medium);
          font-size: var(--text-base);
        }

        .results-section {
          background: var(--color-bg-card);
          padding: var(--space-4);
          border-radius: var(--radius-lg);
          border: 1px solid var(--color-border);
          box-shadow: var(--shadow-sm);
        }

        .results-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: var(--space-3);
        }

        .results-header h3 {
          font-family: var(--font-heading);
          margin: 0;
          color: var(--color-primary);
          font-size: var(--text-xl);
          font-weight: var(--font-bold);
        }

        /* Aspect Ratio Info */
        .ar-info {
          padding: var(--space-3) var(--space-4);
          border-radius: var(--radius-md);
          margin-bottom: var(--space-3);
          font-size: var(--text-sm);
        }

        .ar-info.full {
          background: var(--color-success-light);
          border: 1px solid var(--color-success);
        }

        .ar-info.framing {
          background: var(--color-warning-light);
          border: 1px solid var(--color-warning);
        }

        .ar-info.tiling {
          background: var(--color-info-light);
          border: 1px solid var(--color-info);
        }

        .ar-info-header {
          color: var(--color-text-primary);
          margin-bottom: var(--space-2);
          font-weight: var(--font-semibold);
        }

        .ar-info-details {
          display: flex;
          flex-wrap: wrap;
          gap: var(--space-2);
          align-items: center;
          color: var(--color-text-secondary);
          font-size: var(--text-sm);
        }

        .ar-info-details span {
          white-space: nowrap;
        }

        .layout-note {
          color: var(--color-accent);
          font-weight: var(--font-medium);
        }

        /* Mode Toggle Tabs */
        .mode-tabs {
          display: flex;
          gap: var(--space-2);
          margin-bottom: var(--space-3);
          background: var(--color-bg-subtle);
          padding: var(--space-1);
          border-radius: var(--radius-lg);
        }

        .mode-tab {
          flex: 1;
          display: flex;
          flex-direction: row;
          align-items: center;
          justify-content: center;
          gap: var(--space-2);
          padding: var(--space-2);
          background: var(--color-bg-card);
          border: 1px solid var(--color-border);
          border-radius: var(--radius-md);
          cursor: pointer;
          transition: all var(--transition-base);
        }

        .mode-tab:hover:not(:disabled) {
          border-color: var(--color-accent);
          transform: translateY(-2px);
          box-shadow: var(--shadow-md);
        }

        .mode-tab.active {
          background: var(--color-accent);
          border-color: var(--color-accent);
          box-shadow: var(--shadow-glow-accent);
        }

        .mode-tab:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .mode-title {
          font-family: var(--font-heading);
          font-size: var(--text-base);
          font-weight: var(--font-semibold);
          color: var(--color-primary);
        }

        .mode-description {
          display: none; /* Hidden to save space */
        }

        .mode-tab.active .mode-title {
          color: white;
          font-weight: var(--font-bold);
        }

        .svg-preview {
          margin: var(--space-2) 0;
          border: 1px solid var(--color-border);
          border-radius: var(--radius-md);
          background: var(--color-bg-subtle);
          padding: var(--space-2);
        }

        .design-preview {
          width: 100%;
          height: auto;
          display: block;
        }

        /* Finalize Section */
        .finalize-section {
          background: var(--color-accent-light);
          border: 2px solid var(--color-accent);
          border-radius: var(--radius-lg);
          padding: var(--space-3);
          margin-top: var(--space-3);
          text-align: center;
        }

        .finalize-button {
          width: 100%;
          max-width: 400px;
          padding: var(--space-3);
          background: var(--color-accent);
          color: white;
          border: none;
          border-radius: var(--radius-md);
          font-size: var(--text-base);
          font-weight: var(--font-semibold);
          cursor: pointer;
          transition: all var(--transition-base);
          box-shadow: var(--shadow-sm);
        }

        .finalize-button:hover {
          background: var(--color-accent-hover);
          transform: translateY(-1px);
          box-shadow: var(--shadow-md);
        }

        .finalize-hint {
          margin: var(--space-2) 0 0 0;
          color: var(--color-text-secondary);
          font-size: var(--text-xs);
        }

        /* Mixer Widget Container Styles */
        .mixer-widget-container {
          margin-top: var(--space-3);
          background: white;
          border-radius: 12px;
          padding: var(--space-3);
          box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        }

        .mixer-widget-header {
          display: flex;
          justify-content: flex-end;
          margin-bottom: var(--space-2);
          padding-bottom: var(--space-2);
          border-bottom: 2px solid var(--color-border);
        }

        .mixer-close-btn {
          padding: var(--space-2) var(--space-4);
          background: var(--color-primary);
          color: white;
          border: none;
          border-radius: 8px;
          font-weight: 600;
          font-size: var(--text-sm);
          cursor: pointer;
          transition: all 0.2s;
        }

        .mixer-close-btn:hover {
          background: #2563eb;
          box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
          transform: translateY(-1px);
        }

        /* Mobile Responsive Styles */
        @media (max-width: 768px) {
          .inspire-panel-recraft {
            padding: var(--space-2);
          }

          .panel-header {
            margin-bottom: var(--space-4);
          }

          .panel-header h2 {
            font-size: var(--text-xl);
          }

          .subtitle {
            font-size: var(--text-sm);
          }

          .welcome-guidance {
            padding: var(--space-4);
            margin-bottom: var(--space-4);
          }

          .welcome-icon {
            font-size: 2rem;
          }

          .welcome-guidance h3 {
            font-size: var(--text-lg);
          }

          .welcome-guidance p {
            font-size: var(--text-sm);
          }

          /* Stack input mode tabs vertically on mobile */
          .input-mode-tabs {
            flex-direction: column;
            gap: var(--space-1);
          }

          .input-mode-tab {
            flex-direction: row;
            justify-content: flex-start;
            padding: var(--space-3);
            min-height: 44px;
          }

          .mode-icon {
            width: 24px;
            height: 24px;
            flex-shrink: 0;
          }

          .input-mode-tab .mode-title {
            font-size: var(--text-sm);
            margin-top: 0;
          }

          .input-mode-tab .mode-description {
            display: none;
          }

          /* Form sections */
          .form-section {
            padding: var(--space-3);
          }

          .form-group label {
            font-size: var(--text-xs);
          }

          /* Stack form rows on mobile */
          .form-row {
            grid-template-columns: 1fr;
            gap: var(--space-2);
          }

          /* Drop zone adjustments */
          .drop-zone {
            min-height: 140px;
          }

          .drop-zone-content {
            padding: var(--space-4);
            min-height: 140px;
          }

          .upload-icon {
            width: 36px;
            height: 36px;
          }

          .drop-text {
            font-size: var(--text-sm);
          }

          /* Generate button */
          .generate-button {
            padding: var(--space-3);
            font-size: var(--text-base);
            min-height: 44px;
          }

          /* Results section - minimal padding for max image width */
          .results-section {
            padding: var(--space-2);
            border-radius: var(--radius-md);
          }

          .results-header h3 {
            font-size: var(--text-lg);
          }

          /* Mode tabs */
          .mode-tabs {
            flex-direction: column;
            gap: var(--space-1);
          }

          .mode-tab {
            flex-direction: row;
            justify-content: flex-start;
            padding: var(--space-3);
            min-height: 44px;
          }

          .mode-title {
            font-size: var(--text-sm);
          }

          .mode-description {
            display: none;
          }

          /* AR info */
          .ar-info {
            padding: var(--space-2) var(--space-3);
          }

          .ar-info-details {
            flex-direction: column;
            align-items: flex-start;
            gap: var(--space-1);
          }

          /* Finalize section */
          .finalize-section {
            padding: var(--space-3);
          }

          .finalize-button {
            padding: var(--space-3);
            font-size: var(--text-base);
          }
        }

        /* Extra small screens */
        @media (max-width: 480px) {
          .inspire-panel-recraft {
            padding: var(--space-1);
          }

          .panel-header h2 {
            font-size: var(--text-lg);
          }

          /* Results section - even less padding */
          .results-section {
            padding: var(--space-1);
            margin: 0 calc(-1 * var(--space-1));
            border-radius: 0;
          }

          .input-mode-tab {
            padding: var(--space-2);
          }

          .mode-tab {
            padding: var(--space-2);
          }
        }
      `})]})}function UH({isOpen:e,onClose:t}){const[r,n]=A.useState(!1),[i,s]=A.useState(!1),[a,l]=A.useState(!1),{addMotif:c}=tt(),d=Hc(),{currentDesignId:u,blendSvgUrl:f,solidSvgUrl:h,designName:p}=d,g=f||h,m=!!u;A.useEffect(()=>{if(!e)return;const y=b=>{b.key==="Escape"&&t()};return window.addEventListener("keydown",y),()=>window.removeEventListener("keydown",y)},[e,t]),A.useEffect(()=>{e||(l(!1),n(!1),s(!1))},[e]);const x=A.useCallback((y,b)=>{console.log("[EDITOR] Design saved:",y,b),l(!1)},[]),v=async()=>{var y,b;if(!(!g||r)){n(!0);try{const{blendSvgUrl:w,solidSvgUrl:j,widthMM:_,lengthMM:E}=d;let N=null,O=null;if(j)try{N=await(await fetch(j)).text(),console.log("[EDITOR] Fetched solid SVG from blob:",N.length,"chars")}catch(H){console.error("[EDITOR] Failed to fetch solid SVG:",H)}if(w)try{O=await(await fetch(w)).text(),console.log("[EDITOR] Fetched blend SVG from blob:",O.length,"chars")}catch(H){console.error("[EDITOR] Failed to fetch blend SVG:",H)}if(!N&&!O)throw new Error("No SVG content available. Please ensure a design has been generated.");const te=lp(N||O);let T=_||5e3,V=E||5e3;if(te){const H=te.width/te.height;H>1?(T=Math.max(_||5e3,5e3),V=T/H):(V=Math.max(E||5e3,5e3),T=V*H),console.log("[EDITOR] Using SVG aspect ratio:",H,"",T,"x",V,"mm")}s(!0);let S=u;const K=p||`Design ${new Date().toLocaleString("en-GB",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"})}`,fe=Y1(d);S=(await op({id:S||void 0,name:K,description:"",tags:[],design_data:fe,input_mode:d.inputMode})).design_id,d.setCurrentDesignId(S),d.setDesignName(K),s(!1);const z=((y=d.result)==null?void 0:y.thumb_url)||((b=d.result)==null?void 0:b.png_url)||null;c(S,K,N||O,T,V,z,{solidSvgContent:N,blendSvgContent:O,hasBothVersions:!!(N&&O)}),l(!0),setTimeout(()=>{t()},600)}catch(w){console.error("[EDITOR] Failed to add to canvas:",w),alert("Failed to add design to canvas: "+w.message),s(!1)}finally{n(!1)}}};return e?o.jsx("div",{className:"design-editor-overlay",children:o.jsxs("div",{className:"design-editor-modal",children:[o.jsxs("div",{className:"design-editor__header",children:[o.jsxs("div",{className:"design-editor__title",children:[o.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("polygon",{points:"12 2 2 7 12 12 22 7 12 2"}),o.jsx("polyline",{points:"2 17 12 22 22 17"}),o.jsx("polyline",{points:"2 12 12 17 22 12"})]}),o.jsx("h2",{children:"Design Editor"})]}),o.jsx("div",{className:"design-editor__hint",children:"Generate a design with AI or upload your own SVG"}),o.jsx("button",{className:"design-editor__close",onClick:t,title:"Close (Esc)",children:o.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),o.jsx("div",{className:"design-editor__content",children:o.jsx(HH,{onDesignSaved:x,isEmbedded:!0})}),o.jsx("div",{className:`design-editor__footer ${a?"design-editor__footer--success":""}`,children:a?o.jsxs("div",{className:"design-editor__success",children:[o.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M20 6L9 17l-5-5"})}),o.jsx("span",{children:"Added to canvas!"})]}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"design-editor__status",children:g?m?o.jsxs("span",{className:"design-editor__saved-indicator",children:[o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M20 6L9 17l-5-5"})}),"Saved to library"]}):o.jsx("span",{className:"design-editor__unsaved-indicator",children:"Design ready  Will auto-save when added"}):o.jsx("span",{className:"design-editor__no-design",children:"Generate or upload a design to continue"})}),o.jsxs("div",{className:"design-editor__actions",children:[o.jsx("button",{className:"design-editor__btn design-editor__btn--secondary",onClick:t,children:"Cancel"}),o.jsx("button",{className:"design-editor__btn design-editor__btn--primary",onClick:v,disabled:!g||r,children:r?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"design-editor__spinner"}),i?"Saving...":"Adding..."]}):o.jsxs(o.Fragment,{children:[o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),o.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"16"}),o.jsx("line",{x1:"8",y1:"12",x2:"16",y2:"12"})]}),"Add to Canvas"]})})]})]})})]})}):null}function WH(){const{addShape:e,addText:t,standaloneMode:r,startPathDrawing:n}=tt(),[i,s]=A.useState(!1);if(r)return null;const a=[{preset:"rectangle",icon:"",label:"Shape"},{preset:"blob",icon:"",label:"Blob"},{preset:"path",icon:"",label:"Pen"}],l=d=>{d==="path"?(n(),s(!1)):e(d)},c=()=>{t(),s(!1)};return o.jsxs("div",{className:`shape-toolbar ${i?"shape-toolbar--expanded":""}`,children:[o.jsxs("button",{className:"shape-toolbar__toggle",onClick:()=>s(!i),title:i?"Collapse elements panel":"Add elements",children:[o.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("polygon",{points:"12 2 2 7 12 12 22 7 12 2"}),o.jsx("polyline",{points:"2 17 12 22 22 17"}),o.jsx("polyline",{points:"2 12 12 17 22 12"})]}),!i&&o.jsx("span",{className:"shape-toolbar__label",children:"Elements"})]}),i&&o.jsxs("div",{className:"shape-toolbar__shapes",children:[o.jsxs("button",{className:"shape-toolbar__btn shape-toolbar__btn--text",onClick:c,title:"Add Text Label",children:[o.jsx("span",{className:"shape-toolbar__icon",children:"T"}),o.jsx("span",{className:"shape-toolbar__name",children:"Text"})]}),o.jsx("div",{className:"shape-toolbar__divider"}),a.map(d=>o.jsxs("button",{className:"shape-toolbar__btn",onClick:()=>l(d.preset),title:`Add ${d.label}`,children:[o.jsx("span",{className:"shape-toolbar__icon",children:d.icon}),o.jsx("span",{className:"shape-toolbar__name",children:d.label})]},d.preset))]})]})}function GH({loadedDesign:e}){const[t,r]=A.useState(!1),[n,i]=A.useState(()=>{const Y=tt.getState().surface;return Y!=null&&Y.width_mm?String(Y.width_mm/1e3):"50"}),[s,a]=A.useState(()=>{const Y=tt.getState().surface;return Y!=null&&Y.length_mm?String(Y.length_mm/1e3):"50"}),[l,c]=A.useState(!1),[d,u]=A.useState(!1),[f,h]=A.useState(!1),[p,g]=A.useState(!1),[m,x]=A.useState(!1),[v,y]=A.useState(null),[b,w]=A.useState(null),[j,_]=A.useState(""),E=A.useRef(null);A.useEffect(()=>{if(e){const Y=e.design_data||{},L=e.input_mode||Y.input_mode||Y.blend_recipes||Y.solid_recipes,J=Y.courts||Y.surface||Y.tracks;if(console.log("[TPV] Design detection:",{id:e.id,name:e.name,hasDesignData:!!e.design_data,topLevelInputMode:e.input_mode,isPlaygroundDesign:L,isSportsDesign:J}),L&&!J){console.log("[TPV] Loading playground design into editor:",e.id,e.name);const ue=tf(e),ie=Hc.getState();ie.loadDesign(ue),e.name&&ie.setDesignName(e.name),ie.setCurrentDesignId(e.id),g(!0)}else e.design_data?(console.log("[SPORTS] Loading design from prop:",e.id,e.name),tt.getState().loadDesign(Y),w(e.id),_(e.name||""),r(!1)):console.warn("[TPV] Design has no design_data and is not a playground design:",e.id,e.name)}},[e]);const{surface:N,courts:O,tracks:I,selectedCourtId:te,selectedTrackId:T,selectedMotifId:V,selectedShapeId:S,selectedTextId:K,showCourtLibrary:fe,showPropertiesPanel:U,toggleCourtLibrary:z,togglePropertiesPanel:H,setSurfaceDimensions:Q,setSurfaceColor:W,resetDesign:q,hasUnsavedChanges:re,standaloneMode:oe,toggleStandaloneMode:pe,mobileLibraryOpen:Pe,mobilePropertiesOpen:Re,mobileColoursOpen:Ae,mobileActiveTab:Ce,setMobileLibraryOpen:ve,setMobilePropertiesOpen:me,setMobileColoursOpen:De,setMobileActiveTab:Xe,closeMobileSheets:C}=tt(),ce=Y=>{Y.preventDefault();const L=parseFloat(n)*1e3,J=parseFloat(s)*1e3;L>0&&J>0&&(Q(L,J),r(!1))},ne=Y=>{W({tpv_code:Y.code,hex:Y.hex,name:Y.name}),c(!1)},F=()=>{re()&&!window.confirm(`Start a new design?

You have unsaved changes that will be lost.`)||(q(),w(null),_(""),i("50"),a("50"))},R=()=>{const Y=E.current||document.querySelector(".court-canvas__svg");if(!Y){alert("Canvas not ready");return}const L=tt.getState().exportDesignData(),J=dp(Y,L),ue=new Blob([J],{type:"image/svg+xml"}),ie=URL.createObjectURL(ue);v&&URL.revokeObjectURL(v),y(ie),x(!0)},M=()=>{x(!1),v&&(URL.revokeObjectURL(v),y(null))},Z=async Y=>{if(!Y){alert("Source design ID not found");return}try{const L=await ll(Y),J=(L==null?void 0:L.design)||L;if(!J)throw new Error("Design not found");const ue=tf(J),ie=Hc.getState();ie.loadDesign(ue),J.name&&ie.setDesignName(J.name),ie.setCurrentDesignId(Y),g(!0),console.log("[TPV] Loaded source design for editing:",J.name)}catch(L){console.error("[TPV] Failed to load source design:",L),alert("Failed to load design: "+L.message)}};return A.useEffect(()=>{const Y=L=>{const J=L.target.tagName.toLowerCase();if(J==="input"||J==="textarea"||J==="select")return;const{removeCourt:ue,removeTrack:ie,removeMotif:$,removeShape:X,removeText:ae,deselectCourt:we,deselectTrack:se,deselectMotif:xe,deselectShape:Oe,deselectText:be,stopEditingText:Ne,undo:He,redo:qe,canUndo:Ze,canRedo:Je,duplicateCourt:Fe,duplicateMotif:Ve,duplicateShape:Ke,duplicateText:Be,updateCourtPosition:at,updateTrackPosition:qt,updateMotifPosition:ri,updateShapePosition:Mn,updateTextPosition:Yt,courts:ni,tracks:wt,motifs:Mt,shapes:nr,texts:pn,selectedMotifId:Ft,selectedShapeId:Xt,selectedTextId:Kt,editingTextId:Xr,elementOrder:Ir,setElementOrder:mn,toggleSnapToGrid:_t,snapToGrid:ii,addToHistory:rt}=tt.getState(),wr=te||T||Ft||Xt||Kt;if(L.key==="Delete"&&wr&&!Xr&&(L.preventDefault(),te?ue(te):T?ie(T):Ft?$(Ft):Xt?X(Xt):Kt&&ae(Kt)),L.key==="Escape"&&(Xr?Ne():wr&&(te?we():T?se():Ft?xe():Xt?Oe():Kt&&be())),(L.ctrlKey||L.metaKey)&&L.key==="z"&&!L.shiftKey&&(L.preventDefault(),Ze()&&He()),(L.ctrlKey||L.metaKey)&&L.key==="z"&&L.shiftKey&&(L.preventDefault(),Je()&&qe()),(L.ctrlKey||L.metaKey)&&L.key==="d"&&wr&&(L.preventDefault(),te?Fe(te):Ft?Ve(Ft):Xt?Ke(Xt):Kt&&Be(Kt)),wr&&!Xr&&["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(L.key)){L.preventDefault();const Ue=L.shiftKey?10:100;let ot=0,pt=0;if(L.key==="ArrowLeft"&&(ot=-Ue),L.key==="ArrowRight"&&(ot=Ue),L.key==="ArrowUp"&&(pt=-Ue),L.key==="ArrowDown"&&(pt=Ue),te){const et=ni[te];et&&(at(te,{x:et.position.x+ot,y:et.position.y+pt}),rt())}else if(T){const et=wt[T];et&&(qt(T,{x:et.position.x+ot,y:et.position.y+pt}),rt())}else if(Ft){const et=Mt[Ft];et&&(ri(Ft,{x:et.position.x+ot,y:et.position.y+pt}),rt())}else if(Xt){const et=nr[Xt];et&&(Mn(Xt,{x:et.position.x+ot,y:et.position.y+pt}),rt())}else if(Kt){const et=pn[Kt];et&&(Yt(Kt,{x:et.position.x+ot,y:et.position.y+pt}),rt())}}if(wr&&(L.key==="["||L.key==="]")){L.preventDefault();const Ue=Ir.indexOf(wr);if(Ue===-1)return;const ot=[...Ir];L.key==="["&&Ue>0?([ot[Ue],ot[Ue-1]]=[ot[Ue-1],ot[Ue]],mn(ot),rt()):L.key==="]"&&Ue<Ir.length-1&&([ot[Ue],ot[Ue+1]]=[ot[Ue+1],ot[Ue]],mn(ot),rt())}(L.key==="g"||L.key==="G")&&(L.preventDefault(),_t()),(L.key==="?"||L.shiftKey&&L.key==="/")&&(L.preventDefault(),h(!0))};return window.addEventListener("keydown",Y),()=>window.removeEventListener("keydown",Y)},[te,T,V,S,K]),o.jsxs("div",{className:"sports-designer",children:[t&&o.jsx("div",{className:"sports-designer__modal-overlay",onClick:()=>r(!1),children:o.jsxs("div",{className:"sports-designer__modal",onClick:Y=>Y.stopPropagation(),children:[o.jsx("h2",{children:"Edit Surface Size"}),o.jsx("p",{children:"Adjust the dimensions of your sports surface"}),o.jsxs("form",{onSubmit:ce,children:[o.jsxs("div",{className:"sports-designer__dimension-inputs",children:[o.jsxs("div",{className:"sports-designer__input-group",children:[o.jsx("label",{htmlFor:"width",children:"Width (metres)"}),o.jsx("input",{id:"width",type:"number",min:"5",max:"100",step:"0.5",value:n,onChange:Y=>i(Y.target.value),required:!0,autoFocus:!0})]}),o.jsx("span",{className:"sports-designer__dimension-separator",children:""}),o.jsxs("div",{className:"sports-designer__input-group",children:[o.jsx("label",{htmlFor:"length",children:"Length (metres)"}),o.jsx("input",{id:"length",type:"number",min:"5",max:"100",step:"0.5",value:s,onChange:Y=>a(Y.target.value),required:!0})]})]}),o.jsx("p",{className:"sports-designer__dimension-hint",children:"Common sizes: 37m  34m (tennis), 40m  20m (futsal), 50m  50m (multi-sport)"}),o.jsx("button",{type:"submit",className:"sports-designer__btn-primary",children:"Update Surface"})]})]})}),o.jsxs(o.Fragment,{children:[o.jsxs("header",{className:"sports-designer__mobile-header",children:[o.jsx("span",{className:"sports-designer__mobile-header-title",children:"TPV Designer"}),o.jsxs("div",{className:"sports-designer__mobile-header-actions",children:[o.jsx("button",{className:"sports-designer__mobile-header-btn",onClick:()=>{i(String(N.width_mm/1e3)),a(String(N.length_mm/1e3)),r(!0)},title:"Surface settings",children:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"12",cy:"12",r:"3"}),o.jsx("path",{d:"M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z"})]})}),o.jsx(d0,{svgRef:E,mobileMode:!0})]})]}),o.jsxs("nav",{className:"sports-designer__mobile-action-bar",children:[o.jsxs("button",{className:`sports-designer__mobile-action-btn ${Pe?"sports-designer__mobile-action-btn--active":""}`,onClick:()=>{C(),ve(!0)},children:[o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"12",cy:"12",r:"10"}),o.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"16"}),o.jsx("line",{x1:"8",y1:"12",x2:"16",y2:"12"})]}),o.jsx("span",{children:"Add"})]}),o.jsxs("button",{className:"sports-designer__mobile-action-btn",onClick:()=>{C(),De(!0)},children:[o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"13.5",cy:"6.5",r:"2.5"}),o.jsx("circle",{cx:"17.5",cy:"10.5",r:"2.5"}),o.jsx("circle",{cx:"8.5",cy:"7.5",r:"2.5"}),o.jsx("circle",{cx:"6.5",cy:"12.5",r:"2.5"})]}),o.jsx("span",{children:"Colours"})]}),o.jsxs("button",{className:`sports-designer__mobile-action-btn ${te||T||V||S||K?"":"sports-designer__mobile-action-btn--disabled"}`,onClick:()=>{(te||T||V||S||K)&&(C(),me(!0))},disabled:!te&&!T&&!V&&!S&&!K,children:[o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("line",{x1:"4",y1:"21",x2:"4",y2:"14"}),o.jsx("line",{x1:"4",y1:"10",x2:"4",y2:"3"}),o.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"12"}),o.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"3"}),o.jsx("line",{x1:"20",y1:"21",x2:"20",y2:"16"}),o.jsx("line",{x1:"20",y1:"12",x2:"20",y2:"3"}),o.jsx("line",{x1:"1",y1:"14",x2:"7",y2:"14"}),o.jsx("line",{x1:"9",y1:"8",x2:"15",y2:"8"}),o.jsx("line",{x1:"17",y1:"16",x2:"23",y2:"16"})]}),o.jsx("span",{children:"Properties"})]}),o.jsxs("button",{className:"sports-designer__mobile-action-btn",onClick:()=>u(!0),children:[o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z"}),o.jsx("polyline",{points:"17 21 17 13 7 13 7 21"}),o.jsx("polyline",{points:"7 3 7 8 15 8"})]}),o.jsx("span",{children:"Save"})]})]}),o.jsx("div",{className:`sports-designer__bottom-sheet-overlay ${Pe?"sports-designer__bottom-sheet-overlay--open":""}`,onClick:()=>ve(!1)}),o.jsxs("div",{className:`sports-designer__bottom-sheet ${Pe?"sports-designer__bottom-sheet--open":""}`,children:[o.jsx("div",{className:"sports-designer__bottom-sheet-handle"}),o.jsxs("div",{className:"sports-designer__bottom-sheet-header",children:[o.jsx("h3",{children:"Add Element"}),o.jsx("button",{className:"sports-designer__bottom-sheet-close",onClick:()=>ve(!1),children:o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),o.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),o.jsxs("div",{className:"sports-designer__mobile-tabs",children:[o.jsx("button",{className:`sports-designer__mobile-tab ${Ce==="courts"?"sports-designer__mobile-tab--active":""}`,onClick:()=>Xe("courts"),children:"Courts"}),o.jsx("button",{className:`sports-designer__mobile-tab ${Ce==="tracks"?"sports-designer__mobile-tab--active":""}`,onClick:()=>Xe("tracks"),children:"Tracks"}),o.jsx("button",{className:`sports-designer__mobile-tab ${Ce==="shapes"?"sports-designer__mobile-tab--active":""}`,onClick:()=>Xe("shapes"),children:"Shapes"}),o.jsx("button",{className:`sports-designer__mobile-tab ${Ce==="designs"?"sports-designer__mobile-tab--active":""}`,onClick:()=>Xe("designs"),children:"Designs"})]}),o.jsx("div",{className:"sports-designer__bottom-sheet-content",children:o.jsx(l0,{mobileMode:!0,activeTab:Ce,onItemAdded:()=>ve(!1),onOpenGenerator:()=>{ve(!1),g(!0)}})})]}),o.jsx("div",{className:`sports-designer__bottom-sheet-overlay ${Ae?"sports-designer__bottom-sheet-overlay--open":""}`,onClick:()=>De(!1)}),o.jsxs("div",{className:`sports-designer__bottom-sheet ${Ae?"sports-designer__bottom-sheet--open":""}`,children:[o.jsx("div",{className:"sports-designer__bottom-sheet-handle"}),o.jsxs("div",{className:"sports-designer__bottom-sheet-header",children:[o.jsx("h3",{children:"Surface Colour"}),o.jsx("button",{className:"sports-designer__bottom-sheet-close",onClick:()=>De(!1),children:o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),o.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),o.jsx("div",{className:"sports-designer__bottom-sheet-content",children:o.jsx("div",{className:"sports-designer__color-grid",children:cr.map(Y=>o.jsx("button",{className:`sports-designer__color-swatch ${N.color.tpv_code===Y.code?"sports-designer__color-swatch--selected":""}`,style:{backgroundColor:Y.hex},onClick:()=>{ne(Y),De(!1)},title:`${Y.code} - ${Y.name}`,children:o.jsx("span",{className:"sports-designer__color-code",children:Y.code})},Y.code))})})]}),o.jsx("div",{className:`sports-designer__bottom-sheet-overlay ${Re?"sports-designer__bottom-sheet-overlay--open":""}`,onClick:()=>me(!1)}),o.jsxs("div",{className:`sports-designer__bottom-sheet ${Re?"sports-designer__bottom-sheet--open":""}`,children:[o.jsx("div",{className:"sports-designer__bottom-sheet-handle"}),o.jsxs("div",{className:"sports-designer__bottom-sheet-header",children:[o.jsx("h3",{children:"Properties"}),o.jsx("button",{className:"sports-designer__bottom-sheet-close",onClick:()=>me(!1),children:o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),o.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),o.jsx("div",{className:"sports-designer__bottom-sheet-content",children:(te||T||V||S||K)&&o.jsx(c0,{mobileMode:!0,onEditSourceDesign:Z})})]}),o.jsxs("div",{className:"sports-designer__content",children:[!oe&&o.jsxs("aside",{className:`sports-designer__sidebar ${fe?"":"sports-designer__sidebar--collapsed"}`,children:[o.jsxs("div",{className:"sidebar-content",children:[o.jsx(l0,{onOpenGenerator:()=>g(!0)}),o.jsx(EE,{})]}),o.jsx("button",{className:"sidebar-toggle sidebar-toggle--left",onClick:z,title:fe?"Collapse library":"Expand library",children:o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:fe?o.jsx("polyline",{points:"15 18 9 12 15 6"}):o.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),o.jsxs("main",{className:"sports-designer__canvas-container",children:[o.jsxs("div",{className:"sports-toolbar",children:[o.jsxs("div",{className:"sports-toolbar__group",children:[o.jsx("button",{className:`sports-toolbar__btn ${fe?"sports-toolbar__btn--active":""}`,onClick:z,title:"Element Library",disabled:oe,children:o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),o.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),o.jsx("rect",{x:"3",y:"14",width:"7",height:"7"}),o.jsx("rect",{x:"14",y:"14",width:"7",height:"7"})]})}),o.jsx("button",{className:`sports-toolbar__btn ${U&&(te||T||V||S||K)?"sports-toolbar__btn--active":""}`,onClick:H,title:"Properties",disabled:!te&&!T&&!V&&!S&&!K||oe,children:o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("line",{x1:"4",y1:"21",x2:"4",y2:"14"}),o.jsx("line",{x1:"4",y1:"10",x2:"4",y2:"3"}),o.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"12"}),o.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"3"}),o.jsx("line",{x1:"20",y1:"21",x2:"20",y2:"16"}),o.jsx("line",{x1:"20",y1:"12",x2:"20",y2:"3"}),o.jsx("line",{x1:"1",y1:"14",x2:"7",y2:"14"}),o.jsx("line",{x1:"9",y1:"8",x2:"15",y2:"8"}),o.jsx("line",{x1:"17",y1:"16",x2:"23",y2:"16"})]})})]}),o.jsx("div",{className:"sports-toolbar__divider"}),o.jsx("div",{className:"sports-toolbar__group",children:o.jsx("button",{className:`sports-toolbar__mode-toggle ${oe?"sports-toolbar__mode-toggle--active":""}`,onClick:pe,title:oe?"Switch to Edit Mode":"Switch to Focus Mode",children:oe?o.jsxs(o.Fragment,{children:[o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"})}),o.jsx("span",{children:"Focus"})]}):o.jsxs(o.Fragment,{children:[o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),o.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),o.jsx("rect",{x:"3",y:"14",width:"7",height:"7"}),o.jsx("rect",{x:"14",y:"14",width:"7",height:"7"})]}),o.jsx("span",{children:"Edit"})]})})}),o.jsx("div",{className:"sports-toolbar__divider"}),o.jsxs("div",{className:"sports-toolbar__group",children:[o.jsxs("button",{className:"sports-toolbar__dimensions",onClick:()=>{i(String(N.width_mm/1e3)),a(String(N.length_mm/1e3)),r(!0)},title:"Click to edit surface size",children:[(N.width_mm/1e3).toFixed(0),"m  ",(N.length_mm/1e3).toFixed(0),"m"]}),o.jsx("button",{className:"sports-toolbar__color-swatch",style:{backgroundColor:N.color.hex},onClick:()=>c(!0),title:`${N.color.name} (${N.color.tpv_code}) - Click to change`})]}),o.jsx("div",{className:"sports-toolbar__divider"}),o.jsxs("div",{className:"sports-toolbar__group",children:[o.jsx("button",{className:"sports-toolbar__btn",disabled:!tt.getState().canUndo(),onClick:()=>tt.getState().undo(),title:"Undo (Ctrl+Z)",children:o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("path",{d:"M3 7v6h6"}),o.jsx("path",{d:"M21 17a9 9 0 00-9-9 9 9 0 00-6 2.3L3 13"})]})}),o.jsx("button",{className:"sports-toolbar__btn",disabled:!tt.getState().canRedo(),onClick:()=>tt.getState().redo(),title:"Redo (Ctrl+Shift+Z)",children:o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("path",{d:"M21 7v6h-6"}),o.jsx("path",{d:"M3 17a9 9 0 019-9 9 9 0 016 2.3l3 2.7"})]})})]}),o.jsx("div",{className:"sports-toolbar__divider"}),o.jsxs("div",{className:"sports-toolbar__group",children:[o.jsx("button",{className:"sports-toolbar__btn",onClick:F,title:"Start new design",children:o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),o.jsx("polyline",{points:"14 2 14 8 20 8"}),o.jsx("line",{x1:"12",y1:"18",x2:"12",y2:"12"}),o.jsx("line",{x1:"9",y1:"15",x2:"15",y2:"15"})]})}),o.jsx("button",{className:"sports-toolbar__btn",onClick:R,title:"View In-Situ Preview",children:o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),o.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),o.jsx("polyline",{points:"21 15 16 10 5 21"})]})}),o.jsx("button",{className:"sports-toolbar__btn",onClick:()=>h(!0),title:"Keyboard shortcuts (?)",children:o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("circle",{cx:"12",cy:"12",r:"10"}),o.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),o.jsx("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]})}),o.jsx("button",{className:"sports-toolbar__btn-primary",onClick:()=>u(!0),children:"Save"}),o.jsx(d0,{svgRef:E})]})]}),o.jsx(tE,{ref:E}),o.jsx(WH,{})]}),(te||T||V||S||K)&&!oe&&o.jsxs("aside",{className:`sports-designer__properties ${U?"":"sports-designer__properties--collapsed"}`,children:[o.jsx("button",{className:"sidebar-toggle sidebar-toggle--right",onClick:H,title:U?"Collapse properties":"Expand properties",children:o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:U?o.jsx("polyline",{points:"9 18 15 12 9 6"}):o.jsx("polyline",{points:"15 18 9 12 15 6"})})}),o.jsx("div",{className:"sidebar-content",children:o.jsx(c0,{onEditSourceDesign:Z})})]})]}),l&&o.jsx("div",{className:"sports-designer__color-modal-overlay",onClick:()=>c(!1),children:o.jsxs("div",{className:"sports-designer__color-modal",onClick:Y=>Y.stopPropagation(),children:[o.jsxs("div",{className:"sports-designer__color-modal-header",children:[o.jsx("h4",{children:"Select Surface Colour"}),o.jsx("button",{onClick:()=>c(!1),children:""})]}),o.jsx("div",{className:"sports-designer__color-grid",children:cr.map(Y=>o.jsx("button",{className:`sports-designer__color-swatch ${N.color.tpv_code===Y.code?"sports-designer__color-swatch--selected":""}`,style:{backgroundColor:Y.hex},onClick:()=>ne(Y),title:`${Y.code} - ${Y.name}`,children:o.jsx("span",{className:"sports-designer__color-code",children:Y.code})},Y.code))})]})}),d&&o.jsx($E,{existingDesignId:b,initialName:j,svgRef:E,onClose:()=>u(!1),onSaved:(Y,L)=>{w(Y.design_id),_(L),console.log("[SPORTS] Design saved:",Y.design_id)}}),o.jsx(GE,{isOpen:f,onClose:()=>h(!1)}),o.jsx(UH,{isOpen:p,onClose:()=>g(!1)}),m&&v&&o.jsx(Z1,{designUrl:v,designDimensions:{width:N.width_mm,length:N.length_mm},onClose:M,onSaved:Y=>{console.log("[TPV] In-situ preview saved:",Y),M()}})]})]})}function VH({onShowDesigns:e,onShowAdmin:t,isAdmin:r,currentDesignName:n}){const[i,s]=A.useState(!1),a=async()=>{confirm("Sign out?")&&(await Tn.signOut(),window.location.reload())};return o.jsx("header",{className:"studio-header",children:o.jsxs("div",{className:"header-content",children:[o.jsxs("div",{className:"header-left",children:[o.jsx("h1",{className:"studio-title",children:"TPV Designer"}),n&&o.jsxs("span",{className:"current-design-indicator",children:[o.jsx("svg",{width:"4",height:"4",viewBox:"0 0 4 4",children:o.jsx("circle",{cx:"2",cy:"2",r:"2",fill:"currentColor"})}),n]})]}),o.jsxs("div",{className:"header-right",children:[o.jsxs("button",{onClick:e,className:"btn-my-designs",children:[o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"}),o.jsx("path",{d:"M9 22V12h6v10"})]}),"My Designs"]}),r&&o.jsxs("button",{onClick:t,className:"btn-admin",children:[o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M12 15a3 3 0 100-6 3 3 0 000 6z"}),o.jsx("path",{d:"M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z"})]}),"Admin"]}),o.jsxs("div",{className:"user-menu",children:[o.jsx("button",{onClick:()=>s(!i),className:"user-menu-button",children:o.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"}),o.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),i&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"user-menu-backdrop",onClick:()=>s(!1)}),o.jsx("div",{className:"user-menu-dropdown",children:o.jsxs("button",{onClick:a,className:"menu-item sign-out",children:[o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4M16 17l5-5-5-5M21 12H9"})}),"Sign Out"]})})]})]})]})]})})}function qH({design:e,onLoad:t,onDelete:r,onUpdateMetadata:n}){var g;const[i,s]=A.useState(!1),[a,l]=A.useState(!1),c=async()=>{if(confirm(`Delete "${e.name}"? This cannot be undone.`)){l(!0);try{await r(e.id)}catch(m){console.error("Failed to delete design:",m),alert(`Failed to delete: ${m.message}`),l(!1)}}},d=m=>{const x=new Date(m),v=new Date,y=v-x,b=Math.floor(y/(1e3*60*60*24));return b===0?"Today":b===1?"Yesterday":b<7?`${b} days ago`:b<30?`${Math.floor(b/7)} weeks ago`:x.toLocaleDateString("en-GB",{day:"numeric",month:"short",year:x.getFullYear()!==v.getFullYear()?"numeric":void 0})},u=e.input_mode==="sports_surface"||((g=e.design_data)==null?void 0:g.type)==="sports_surface",f=e.thumbnail_url||e.original_png_url||e.original_svg_url,p=u?{label:"Surface",icon:"",className:"type-surface"}:{label:"Motif",icon:"",className:"type-motif"};return o.jsxs("div",{className:`design-card ${a?"deleting":""}`,onMouseEnter:()=>s(!0),onMouseLeave:()=>s(!1),children:[o.jsxs("div",{className:`design-type-badge ${p.className}`,children:[o.jsx("span",{className:"type-icon",children:p.icon}),o.jsx("span",{className:"type-label",children:p.label})]}),o.jsxs("div",{className:"card-thumbnail",onClick:()=>t(e.id),children:[f?o.jsx("img",{src:f,alt:e.name}):o.jsx("div",{className:"no-thumbnail",children:o.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[o.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),o.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),o.jsx("polyline",{points:"21 15 16 10 5 21"})]})}),i&&o.jsx("div",{className:"thumbnail-overlay",children:o.jsx("button",{className:"btn-load",children:"Open"})})]}),o.jsxs("div",{className:"card-info",children:[o.jsx("h3",{className:"design-name",title:e.name,children:e.name}),e.description&&o.jsx("p",{className:"design-description",title:e.description,children:e.description}),o.jsxs("div",{className:"card-meta",children:[e.projects&&o.jsx("span",{className:"project-badge",style:{backgroundColor:e.projects.color||"#1a365d"},title:e.projects.name,children:e.projects.name}),o.jsx("span",{className:"design-date",title:new Date(e.updated_at).toLocaleString(),children:d(e.updated_at)})]}),e.tags&&e.tags.length>0&&o.jsxs("div",{className:"design-tags",children:[e.tags.slice(0,3).map((m,x)=>o.jsx("span",{className:"tag",children:m},x)),e.tags.length>3&&o.jsxs("span",{className:"tag more",children:["+",e.tags.length-3]})]})]}),i&&!a&&o.jsxs("div",{className:"card-actions",children:[o.jsx("button",{onClick:()=>t(e.id),className:"action-btn load-btn",title:"Load design",children:o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),o.jsx("circle",{cx:"12",cy:"12",r:"3"})]})}),o.jsx("button",{onClick:c,className:"action-btn delete-btn",title:"Delete design",children:o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]}),a&&o.jsx("div",{className:"deleting-overlay",children:o.jsx("div",{className:"spinner"})})]})}function YH({onClose:e,onLoadDesign:t}){const[r,n]=A.useState([]),[i,s]=A.useState([]),[a,l]=A.useState(!0),[c,d]=A.useState(null),[u,f]=A.useState(""),[h,p]=A.useState(""),[g,m]=A.useState(!1),[x,v]=A.useState(!1);A.useEffect(()=>{y()},[u,h]);const y=async()=>{l(!0),d(null);try{const[_,E]=await Promise.all([cp(),Fc({project_id:u||void 0,search:h||void 0,limit:12,offset:0})]);s(_.projects),n(E.designs),m(E.pagination.has_more)}catch(_){console.error("Failed to load designs:",_),d(_.message)}finally{l(!1)}},b=async()=>{if(!(x||!g)){v(!0);try{const _=await Fc({project_id:u||void 0,search:h||void 0,limit:12,offset:r.length});n([...r,..._.designs]),m(_.pagination.has_more)}catch(_){console.error("Failed to load more designs:",_),d(_.message)}finally{v(!1)}}},w=async _=>{try{const{design:E}=await ll(_);t(E),e()}catch(E){console.error("Failed to load design:",E),alert(`Failed to load design: ${E.message}`)}},j=async _=>{try{await qj(_),n(r.filter(E=>E.id!==_))}catch(E){throw console.error("Failed to delete design:",E),E}};return o.jsx("div",{className:"modal-overlay",onClick:e,children:o.jsxs("div",{className:"modal-content design-gallery-modal",onClick:_=>_.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsx("h2",{children:"My Designs"}),o.jsx("button",{onClick:e,className:"close-button",children:""})]}),o.jsxs("div",{className:"gallery-filters",children:[o.jsx("div",{className:"filter-group",children:o.jsx("input",{type:"text",placeholder:"Search designs...",value:h,onChange:_=>p(_.target.value),className:"search-input"})}),o.jsx("div",{className:"filter-group",children:o.jsxs("select",{value:u,onChange:_=>f(_.target.value),className:"project-filter",children:[o.jsx("option",{value:"",children:"All Projects"}),i.map(_=>o.jsxs("option",{value:_.id,children:[_.name," (",_.design_count,")"]},_.id))]})})]}),o.jsxs("div",{className:"modal-body",children:[c&&o.jsxs("div",{className:"error-message",children:[c,o.jsx("button",{onClick:y,className:"btn-retry",children:"Retry"})]}),a?o.jsxs("div",{className:"loading-state",children:[o.jsx("div",{className:"spinner-large"}),o.jsx("p",{children:"Loading your designs..."})]}):r.length===0?o.jsxs("div",{className:"empty-state",children:[o.jsxs("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[o.jsx("path",{d:"M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z"}),o.jsx("path",{d:"M17 21v-8H7v8M7 3v5h8"})]}),o.jsx("h3",{children:"No designs yet"}),o.jsx("p",{children:h||u?"No designs match your filters. Try adjusting your search.":"Create your first design to see it here!"})]}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"designs-grid",children:r.map(_=>o.jsx(qH,{design:_,onLoad:w,onDelete:j},_.id))}),g&&o.jsx("div",{className:"load-more-section",children:o.jsx("button",{onClick:b,className:"btn-load-more",disabled:x,children:x?"Loading...":"Load More"})})]})]})]})})}function XH(){const[e,t]=A.useState([]),[r,n]=A.useState(0),[i,s]=A.useState(!1),[a,l]=A.useState(null),[c,d]=A.useState("all"),[u,f]=A.useState("all"),[h,p]=A.useState(""),[g,m]=A.useState(0),x=50,v=async()=>{var N,O;const _=await Dt.auth.getSession();return{"Content-Type":"application/json",Authorization:`Bearer ${(O=(N=_==null?void 0:_.data)==null?void 0:N.session)==null?void 0:O.access_token}`}},y=async()=>{s(!0),l(null);try{const _=await v(),E=new URLSearchParams({limit:x.toString(),offset:g.toString()});c!=="all"&&E.append("status",c),u!=="all"&&E.append("saved_status",u),h&&E.append("search",h);const N=await fetch(`/api/admin/jobs?${E.toString()}`,{headers:_}),O=await N.json();if(!N.ok)throw new Error(O.error||"Failed to fetch jobs");t(O.jobs),n(O.total)}catch(_){console.error("Failed to fetch jobs:",_),l(_.message)}finally{s(!1)}};A.useEffect(()=>{y()},[c,u,h,g]);const b=e.filter(_=>_.status==="completed").length,w=e.filter(_=>!_.is_saved&&_.status==="completed").length,j=e.filter(_=>_.is_saved).length;return o.jsxs("div",{className:"generations-tab",children:[o.jsxs("div",{className:"admin-stats-grid",children:[o.jsxs("div",{className:"admin-stat-card",children:[o.jsx("h3",{children:"Total Generations"}),o.jsx("p",{className:"stat-value",children:r}),o.jsx("span",{className:"stat-label",children:"All time"})]}),o.jsxs("div",{className:"admin-stat-card",children:[o.jsx("h3",{children:"Completed"}),o.jsx("p",{className:"stat-value",children:b}),o.jsx("span",{className:"stat-label",children:"Current page"})]}),o.jsxs("div",{className:"admin-stat-card success",children:[o.jsx("h3",{children:"Saved"}),o.jsx("p",{className:"stat-value",children:j}),o.jsx("span",{className:"stat-label",children:" Linked to designs"})]}),o.jsxs("div",{className:"admin-stat-card warning",children:[o.jsx("h3",{children:"Orphaned"}),o.jsx("p",{className:"stat-value",children:w}),o.jsx("span",{className:"stat-label",children:" Not saved"})]})]}),o.jsxs("div",{className:"admin-filters",children:[o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{children:"Status:"}),o.jsxs("select",{value:c,onChange:_=>d(_.target.value),children:[o.jsx("option",{value:"all",children:"All"}),o.jsx("option",{value:"completed",children:"Completed"}),o.jsx("option",{value:"failed",children:"Failed"}),o.jsx("option",{value:"running",children:"Running"}),o.jsx("option",{value:"queued",children:"Queued"})]})]}),o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{children:"Saved:"}),o.jsxs("select",{value:u,onChange:_=>f(_.target.value),children:[o.jsx("option",{value:"all",children:"All"}),o.jsx("option",{value:"saved",children:"Saved only"}),o.jsx("option",{value:"orphaned",children:"Orphaned only"})]})]}),o.jsxs("div",{className:"filter-group search",children:[o.jsx("label",{children:"Search prompt:"}),o.jsx("input",{type:"text",placeholder:"Search in prompts...",value:h,onChange:_=>p(_.target.value)})]})]}),i&&o.jsxs("div",{className:"admin-loading",children:[o.jsx("div",{className:"spinner"}),o.jsx("p",{children:"Loading jobs..."})]}),a&&o.jsx("div",{className:"admin-error",children:o.jsxs("p",{children:["Error: ",a]})}),!i&&e.length>0&&o.jsx("div",{className:"jobs-table-container",children:o.jsxs("table",{className:"jobs-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Thumbnail"}),o.jsx("th",{children:"Prompt"}),o.jsx("th",{children:"Dimensions"}),o.jsx("th",{children:"Status"}),o.jsx("th",{children:"Saved"}),o.jsx("th",{children:"User"}),o.jsx("th",{children:"Created"})]})}),o.jsx("tbody",{children:e.map(_=>o.jsxs("tr",{className:`job-row ${_.is_saved?"saved":"orphaned"} ${_.status}`,children:[o.jsx("td",{className:"thumbnail-cell",children:_.thumbnail_url?o.jsx("img",{src:_.thumbnail_url,alt:"Design",className:"job-thumbnail"}):o.jsx("div",{className:"thumbnail-placeholder",children:"No image"})}),o.jsx("td",{className:"prompt-cell",children:o.jsx("div",{className:"prompt-text",title:_.prompt,children:_.prompt||o.jsx("em",{children:"No prompt"})})}),o.jsx("td",{className:"dimensions-cell",children:_.width_mm&&_.length_mm?o.jsxs("span",{children:[_.width_mm,"  ",_.length_mm," mm"]}):o.jsx("em",{children:"N/A"})}),o.jsx("td",{className:"status-cell",children:o.jsx("span",{className:`status-badge ${_.status}`,children:_.status})}),o.jsx("td",{className:"saved-cell",children:_.is_saved?o.jsx("span",{className:"saved-badge",children:" Saved"}):o.jsx("span",{className:"orphaned-badge",children:" Orphaned"})}),o.jsx("td",{className:"user-cell",children:_.user_email}),o.jsx("td",{className:"date-cell",children:new Date(_.created_at).toLocaleDateString()})]},_.id))})]})}),!i&&e.length===0&&o.jsx("div",{className:"admin-empty",children:o.jsx("p",{children:"No jobs found matching your filters."})}),r>x&&o.jsxs("div",{className:"admin-pagination",children:[o.jsx("button",{onClick:()=>m(Math.max(0,g-x)),disabled:g===0,children:"Previous"}),o.jsxs("span",{children:["Showing ",g+1," to ",Math.min(g+x,r)," of ",r]}),o.jsx("button",{onClick:()=>m(g+x),disabled:g+x>=r,children:"Next"})]}),o.jsx("style",{children:`
        .jobs-table-container {
          overflow-x: auto;
          background: white;
          border-radius: 8px;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .jobs-table {
          width: 100%;
          border-collapse: collapse;
        }

        .jobs-table th {
          background: #f9fafb;
          padding: 1rem;
          text-align: left;
          font-weight: 600;
          font-size: 0.875rem;
          color: #374151;
          border-bottom: 1px solid #e5e7eb;
        }

        .jobs-table td {
          padding: 1rem;
          border-bottom: 1px solid #e5e7eb;
        }

        .job-row.saved {
          background: rgba(16, 185, 129, 0.03);
        }

        .job-row.orphaned {
          background: rgba(245, 158, 11, 0.03);
        }

        .thumbnail-cell {
          width: 80px;
        }

        .job-thumbnail {
          width: 64px;
          height: 64px;
          object-fit: cover;
          border-radius: 4px;
        }

        .thumbnail-placeholder {
          width: 64px;
          height: 64px;
          background: #f3f4f6;
          border-radius: 4px;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 0.75rem;
          color: #9ca3af;
        }

        .prompt-cell {
          max-width: 300px;
        }

        .prompt-text {
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
        }

        .status-badge {
          display: inline-block;
          padding: 0.25rem 0.75rem;
          border-radius: 9999px;
          font-size: 0.75rem;
          font-weight: 500;
        }

        .status-badge.completed {
          background: #d1fae5;
          color: #065f46;
        }

        .status-badge.failed {
          background: #fee2e2;
          color: #991b1b;
        }

        .status-badge.running {
          background: #dbeafe;
          color: #1e40af;
        }

        .status-badge.queued {
          background: #e0e7ff;
          color: #3730a3;
        }

        .saved-badge {
          color: #059669;
          font-weight: 500;
        }

        .orphaned-badge {
          color: #d97706;
          font-weight: 500;
        }

        .user-cell {
          font-size: 0.875rem;
          color: #6b7280;
        }

        .date-cell {
          font-size: 0.875rem;
          color: #6b7280;
          white-space: nowrap;
        }

        .admin-stat-card.success {
          border-left: 4px solid #10b981;
        }

        .admin-stat-card.warning {
          border-left: 4px solid #f59e0b;
        }
      `})]})}function KH(){const[e,t]=A.useState([]),[r,n]=A.useState(null),[i,s]=A.useState(!1),[a,l]=A.useState(null),[c,d]=A.useState(!1),[u,f]=A.useState(new Set),[h,p]=A.useState("all"),g=async()=>{var _,E;const w=await Dt.auth.getSession();return{"Content-Type":"application/json",Authorization:`Bearer ${(E=(_=w==null?void 0:w.data)==null?void 0:_.session)==null?void 0:E.access_token}`}},m=async()=>{s(!0),l(null);try{const w=await g(),j=new URLSearchParams;h!=="all"&&j.append("age_filter",h);const _=await fetch(`/api/admin/recovery/orphaned?${j.toString()}`,{headers:w}),E=await _.json();if(!_.ok)throw new Error(E.error||"Failed to fetch orphaned jobs");t(E.orphaned_jobs),n(E.age_buckets)}catch(w){console.error("Failed to fetch orphaned jobs:",w),l(w.message)}finally{s(!1)}};A.useEffect(()=>{m()},[h]);const x=w=>{const j=new Set(u);j.has(w)?j.delete(w):j.add(w),f(j)},v=()=>{f(new Set(e.map(w=>w.id)))},y=()=>{f(new Set)},b=async()=>{if(u.size===0){alert("Please select at least one job to recover");return}if(confirm(`Recover ${u.size} orphaned ${u.size===1?"design":"designs"}?`)){d(!0),l(null);try{const w=await g(),j=await fetch("/api/admin/recovery/create",{method:"POST",headers:w,body:JSON.stringify({job_ids:Array.from(u)})}),_=await j.json();if(!j.ok)throw new Error(_.error||"Failed to recover designs");alert(`Successfully recovered ${_.recovered_count} ${_.recovered_count===1?"design":"designs"}!`),y(),await m()}catch(w){console.error("Failed to recover designs:",w),l(w.message),alert(`Recovery failed: ${w.message}`)}finally{d(!1)}}};return o.jsxs("div",{className:"recovery-tab",children:[o.jsxs("div",{className:"admin-stats-grid",children:[o.jsxs("div",{className:"admin-stat-card warning",children:[o.jsx("h3",{children:"Total Orphaned"}),o.jsx("p",{className:"stat-value",children:e.length}),o.jsx("span",{className:"stat-label",children:"Designs not saved"})]}),r&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"admin-stat-card",children:[o.jsx("h3",{children:"<24 hours"}),o.jsx("p",{className:"stat-value",children:r["<24h"]}),o.jsx("span",{className:"stat-label",children:"Recent"})]}),o.jsxs("div",{className:"admin-stat-card",children:[o.jsx("h3",{children:"1-7 days"}),o.jsx("p",{className:"stat-value",children:r["1-7d"]}),o.jsx("span",{className:"stat-label",children:"This week"})]}),o.jsxs("div",{className:"admin-stat-card",children:[o.jsx("h3",{children:">7 days"}),o.jsx("p",{className:"stat-value",children:r["7-30d"]+r[">30d"]}),o.jsx("span",{className:"stat-label",children:"Older"})]})]})]}),o.jsxs("div",{className:"recovery-controls",children:[o.jsx("div",{className:"admin-filters",children:o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{children:"Age:"}),o.jsxs("select",{value:h,onChange:w=>p(w.target.value),children:[o.jsx("option",{value:"all",children:"All"}),o.jsx("option",{value:"24h",children:"<24 hours"}),o.jsx("option",{value:"7d",children:"<7 days"}),o.jsx("option",{value:"30d",children:"<30 days"})]})]})}),o.jsxs("div",{className:"bulk-actions",children:[o.jsx("button",{onClick:v,className:"btn-secondary",children:"Select All"}),o.jsxs("button",{onClick:y,className:"btn-secondary",children:["Clear (",u.size,")"]}),o.jsx("button",{onClick:b,disabled:u.size===0||c,className:"btn-primary",children:c?"Recovering...":`Recover Selected (${u.size})`})]})]}),i&&o.jsxs("div",{className:"admin-loading",children:[o.jsx("div",{className:"spinner"}),o.jsx("p",{children:"Loading orphaned jobs..."})]}),a&&o.jsx("div",{className:"admin-error",children:o.jsxs("p",{children:["Error: ",a]})}),!i&&e.length>0&&o.jsx("div",{className:"recovery-table-container",children:o.jsxs("table",{className:"recovery-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{style:{width:"40px"},children:o.jsx("input",{type:"checkbox",checked:u.size===e.length,onChange:w=>w.target.checked?v():y()})}),o.jsx("th",{children:"Thumbnail"}),o.jsx("th",{children:"Prompt / Auto-name"}),o.jsx("th",{children:"Dimensions"}),o.jsx("th",{children:"Age"}),o.jsx("th",{children:"User"})]})}),o.jsx("tbody",{children:e.map(w=>o.jsxs("tr",{className:u.has(w.id)?"selected":"",onClick:()=>x(w.id),children:[o.jsx("td",{onClick:j=>j.stopPropagation(),children:o.jsx("input",{type:"checkbox",checked:u.has(w.id),onChange:()=>x(w.id)})}),o.jsx("td",{className:"thumbnail-cell",children:w.thumbnail_url?o.jsx("img",{src:w.thumbnail_url,alt:"Design",className:"job-thumbnail"}):o.jsx("div",{className:"thumbnail-placeholder",children:"No image"})}),o.jsxs("td",{className:"prompt-cell",children:[o.jsx("div",{className:"prompt-text",title:w.prompt,children:w.auto_name}),w.prompt&&w.prompt.length>50&&o.jsx("div",{className:"prompt-full",children:w.prompt})]}),o.jsx("td",{className:"dimensions-cell",children:w.width_mm&&w.length_mm?o.jsxs("span",{children:[w.width_mm,"  ",w.length_mm," mm"]}):o.jsx("em",{children:"N/A"})}),o.jsx("td",{className:"age-cell",children:o.jsxs("span",{className:`age-badge ${w.age_bucket.replace(/[<>]/g,"")}`,children:[w.age_days," ",w.age_days===1?"day":"days"]})}),o.jsx("td",{className:"user-cell",children:w.user_email})]},w.id))})]})}),!i&&e.length===0&&o.jsx("div",{className:"admin-empty",children:o.jsx("p",{children:"No orphaned jobs found. All designs have been saved!"})}),o.jsx("style",{children:`
        .recovery-controls {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 1.5rem;
          flex-wrap: wrap;
          gap: 1rem;
        }

        .bulk-actions {
          display: flex;
          gap: 0.5rem;
        }

        .btn-primary {
          padding: 0.5rem 1rem;
          background: #ff6b35;
          color: white;
          border: none;
          border-radius: 4px;
          font-weight: 500;
          cursor: pointer;
        }

        .btn-primary:hover:not(:disabled) {
          background: #e55a2b;
        }

        .btn-primary:disabled {
          background: #d1d5db;
          cursor: not-allowed;
        }

        .btn-secondary {
          padding: 0.5rem 1rem;
          background: white;
          color: #374151;
          border: 1px solid #d1d5db;
          border-radius: 4px;
          font-weight: 500;
          cursor: pointer;
        }

        .btn-secondary:hover {
          background: #f9fafb;
        }

        .recovery-table-container {
          overflow-x: auto;
          background: white;
          border-radius: 8px;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .recovery-table {
          width: 100%;
          border-collapse: collapse;
        }

        .recovery-table th {
          background: #f9fafb;
          padding: 1rem;
          text-align: left;
          font-weight: 600;
          font-size: 0.875rem;
          color: #374151;
          border-bottom: 1px solid #e5e7eb;
        }

        .recovery-table td {
          padding: 1rem;
          border-bottom: 1px solid #e5e7eb;
        }

        .recovery-table tbody tr {
          cursor: pointer;
          transition: background 0.15s;
        }

        .recovery-table tbody tr:hover {
          background: #f9fafb;
        }

        .recovery-table tbody tr.selected {
          background: #eff6ff;
        }

        .age-badge {
          display: inline-block;
          padding: 0.25rem 0.75rem;
          border-radius: 9999px;
          font-size: 0.75rem;
          font-weight: 500;
        }

        .age-badge.24h {
          background: #fee2e2;
          color: #991b1b;
        }

        .age-badge.1-7d {
          background: #fed7aa;
          color: #92400e;
        }

        .age-badge.7-30d {
          background: #fef3c7;
          color: #78350f;
        }

        .age-badge.30d {
          background: #e5e7eb;
          color: #374151;
        }

        .prompt-full {
          font-size: 0.75rem;
          color: #6b7280;
          margin-top: 0.25rem;
          display: none;
        }

        .recovery-table tbody tr:hover .prompt-full {
          display: block;
        }
      `})]})}function ZH({onClose:e}){const[t,r]=A.useState("overview"),[n,i]=A.useState(!0),[s,a]=A.useState(null),[l,c]=A.useState(null),[d,u]=A.useState([]),[f,h]=A.useState([]),[p,g]=A.useState(0),[m,x]=A.useState(null),v=async()=>{var N,O;const _=await Dt.auth.getSession();return{"Content-Type":"application/json",Authorization:`Bearer ${(O=(N=_==null?void 0:_.data)==null?void 0:N.session)==null?void 0:O.access_token}`}},y=async()=>{try{const _=await v(),E=await fetch("/api/admin/analytics/overview",{headers:_}),N=await E.json();if(!E.ok)throw new Error(N.error||"Failed to fetch overview");c(N.stats)}catch(_){console.error("Failed to fetch overview:",_),a(_.message)}},b=async()=>{try{const _=await v(),E=await fetch("/api/admin/users",{headers:_}),N=await E.json();if(!E.ok)throw new Error(N.error||"Failed to fetch users");u(N.users)}catch(_){console.error("Failed to fetch users:",_),a(_.message)}},w=async()=>{try{const _=await v(),E=await fetch("/api/admin/designs?limit=50",{headers:_}),N=await E.json();if(!E.ok)throw new Error(N.error||"Failed to fetch designs");h(N.designs),g(N.total)}catch(_){console.error("Failed to fetch designs:",_),a(_.message)}},j=async()=>{try{const _=await v(),E=await fetch("/api/admin/analytics/colours",{headers:_}),N=await E.json();if(!E.ok)throw new Error(N.error||"Failed to fetch colour analytics");x(N.analytics)}catch(_){console.error("Failed to fetch colours:",_),a(_.message)}};return A.useEffect(()=>{(async()=>{i(!0),await y(),i(!1)})()},[]),A.useEffect(()=>{t==="users"&&d.length===0?b():t==="designs"&&f.length===0?w():t==="colours"&&!m&&j()},[t]),n?o.jsxs("div",{className:"admin-loading",children:[o.jsx("div",{className:"spinner"}),o.jsx("p",{children:"Loading admin dashboard..."})]}):s?o.jsxs("div",{className:"admin-error",children:[o.jsx("h2",{children:"Access Denied"}),o.jsx("p",{children:s}),o.jsx("p",{children:"You need admin privileges to view this page."})]}):o.jsxs("div",{className:"admin-dashboard",children:[o.jsxs("header",{className:"admin-header",children:[o.jsxs("div",{className:"admin-header-left",children:[o.jsxs("button",{onClick:e,className:"btn-back",children:[o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7"})}),"Back to Studio"]}),o.jsx("h1",{children:"TPV Studio Admin"})]}),o.jsxs("nav",{className:"admin-nav",children:[o.jsx("button",{className:t==="overview"?"active":"",onClick:()=>r("overview"),children:"Overview"}),o.jsx("button",{className:t==="generations"?"active":"",onClick:()=>r("generations"),children:"Generations"}),o.jsx("button",{className:t==="recovery"?"active":"",onClick:()=>r("recovery"),children:"Recovery"}),o.jsx("button",{className:t==="users"?"active":"",onClick:()=>r("users"),children:"Users"}),o.jsx("button",{className:t==="designs"?"active":"",onClick:()=>r("designs"),children:"Designs"}),o.jsx("button",{className:t==="colours"?"active":"",onClick:()=>r("colours"),children:"Colour Analytics"})]})]}),o.jsxs("main",{className:"admin-content",children:[t==="overview"&&l&&o.jsx(JH,{stats:l}),t==="generations"&&o.jsx(XH,{}),t==="recovery"&&o.jsx(KH,{}),t==="users"&&o.jsx(QH,{users:d}),t==="designs"&&o.jsx(e7,{designs:f,total:p}),t==="colours"&&m&&o.jsx(t7,{analytics:m})]}),o.jsx("style",{jsx:!0,children:`
        .admin-dashboard {
          min-height: 100vh;
          background: #f8fafc;
        }

        .admin-header {
          background: white;
          border-bottom: 1px solid #e5e7eb;
          padding: 20px 40px;
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
        }

        .admin-header-left {
          display: flex;
          flex-direction: column;
          gap: 8px;
        }

        .btn-back {
          display: inline-flex;
          align-items: center;
          gap: 6px;
          padding: 6px 12px;
          background: #f3f4f6;
          border: 1px solid #e5e7eb;
          border-radius: 6px;
          font-size: 13px;
          color: #6b7280;
          cursor: pointer;
          transition: all 0.2s;
          width: fit-content;
        }

        .btn-back:hover {
          background: #e5e7eb;
          color: #374151;
        }

        .admin-header h1 {
          margin: 0;
          font-size: 24px;
          color: #1e4a7a;
        }

        .admin-nav {
          display: flex;
          gap: 8px;
        }

        .admin-nav button {
          padding: 8px 16px;
          border: 1px solid #e5e7eb;
          background: white;
          border-radius: 6px;
          cursor: pointer;
          font-size: 14px;
          color: #64748b;
          transition: all 0.2s;
        }

        .admin-nav button:hover {
          background: #f8fafc;
          color: #1e4a7a;
        }

        .admin-nav button.active {
          background: #1e4a7a;
          color: white;
          border-color: #1e4a7a;
        }

        .admin-content {
          padding: 24px 40px;
        }

        .admin-loading,
        .admin-error {
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          min-height: 50vh;
          text-align: center;
        }

        .admin-error h2 {
          color: #dc2626;
        }

        .spinner {
          width: 40px;
          height: 40px;
          border: 3px solid #e5e7eb;
          border-top-color: #1e4a7a;
          border-radius: 50%;
          animation: spin 0.8s linear infinite;
          margin-bottom: 16px;
        }

        @keyframes spin {
          to { transform: rotate(360deg); }
        }
      `})]})}function JH({stats:e}){return o.jsxs("div",{className:"overview-panel",children:[o.jsx("h2",{children:"Dashboard Overview"}),o.jsxs("div",{className:"stats-grid",children:[o.jsxs("div",{className:"stat-card",children:[o.jsx("div",{className:"stat-value",children:e.totals.users}),o.jsx("div",{className:"stat-label",children:"Total Users"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("div",{className:"stat-value",children:e.totals.designs}),o.jsx("div",{className:"stat-label",children:"Total Designs"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("div",{className:"stat-value",children:e.totals.projects}),o.jsx("div",{className:"stat-label",children:"Total Projects"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("div",{className:"stat-value",children:e.totals.jobs}),o.jsx("div",{className:"stat-label",children:"AI Jobs Run"})]})]}),o.jsxs("div",{className:"stats-grid",children:[o.jsxs("div",{className:"stat-card highlight",children:[o.jsx("div",{className:"stat-value",children:e.activity.active_users_30d}),o.jsx("div",{className:"stat-label",children:"Active Users (30d)"})]}),o.jsxs("div",{className:"stat-card highlight",children:[o.jsx("div",{className:"stat-value",children:e.activity.designs_7d}),o.jsx("div",{className:"stat-label",children:"Designs This Week"})]}),o.jsxs("div",{className:"stat-card highlight",children:[o.jsx("div",{className:"stat-value",children:e.activity.designs_30d}),o.jsx("div",{className:"stat-label",children:"Designs This Month"})]}),o.jsxs("div",{className:"stat-card highlight",children:[o.jsxs("div",{className:"stat-value",children:[e.activity.job_success_rate,"%"]}),o.jsx("div",{className:"stat-label",children:"Job Success Rate"})]})]}),o.jsx("h3",{children:"Activity Timeline (14 Days)"}),o.jsx("div",{className:"activity-chart",children:e.timeline.map((t,r)=>o.jsxs("div",{className:"bar-container",children:[o.jsx("div",{className:"bar",style:{height:`${Math.max(4,t.count*20)}px`},title:`${t.date}: ${t.count} designs`}),o.jsx("div",{className:"bar-label",children:t.date.split("-")[2]})]},r))}),o.jsxs("div",{className:"breakdowns",children:[o.jsxs("div",{className:"breakdown-card",children:[o.jsx("h4",{children:"Input Mode"}),o.jsxs("div",{className:"breakdown-items",children:[o.jsxs("div",{className:"breakdown-item",children:[o.jsx("span",{children:"Prompt"}),o.jsx("strong",{children:e.breakdowns.input_mode.prompt})]}),o.jsxs("div",{className:"breakdown-item",children:[o.jsx("span",{children:"Image Upload"}),o.jsx("strong",{children:e.breakdowns.input_mode.image})]}),o.jsxs("div",{className:"breakdown-item",children:[o.jsx("span",{children:"SVG Upload"}),o.jsx("strong",{children:e.breakdowns.input_mode.svg})]})]})]}),o.jsxs("div",{className:"breakdown-card",children:[o.jsx("h4",{children:"View Mode Preference"}),o.jsxs("div",{className:"breakdown-items",children:[o.jsxs("div",{className:"breakdown-item",children:[o.jsx("span",{children:"Solid TPV"}),o.jsx("strong",{children:e.breakdowns.view_mode.solid})]}),o.jsxs("div",{className:"breakdown-item",children:[o.jsx("span",{children:"Blend TPV"}),o.jsx("strong",{children:e.breakdowns.view_mode.blend})]})]})]})]}),o.jsx("style",{jsx:!0,children:`
        .overview-panel h2 {
          margin: 0 0 24px 0;
          color: #1a202c;
        }

        .overview-panel h3 {
          margin: 32px 0 16px 0;
          color: #1a202c;
        }

        .stats-grid {
          display: grid;
          grid-template-columns: repeat(4, 1fr);
          gap: 16px;
          margin-bottom: 16px;
        }

        .stat-card {
          background: white;
          padding: 20px;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
        }

        .stat-card.highlight {
          border-color: #1e4a7a;
          border-width: 2px;
        }

        .stat-value {
          font-size: 32px;
          font-weight: 700;
          color: #1e4a7a;
        }

        .stat-label {
          font-size: 14px;
          color: #64748b;
          margin-top: 4px;
        }

        .activity-chart {
          display: flex;
          align-items: flex-end;
          gap: 8px;
          height: 120px;
          padding: 16px;
          background: white;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
        }

        .bar-container {
          flex: 1;
          display: flex;
          flex-direction: column;
          align-items: center;
        }

        .bar {
          width: 100%;
          background: #1e4a7a;
          border-radius: 4px 4px 0 0;
          min-height: 4px;
        }

        .bar-label {
          font-size: 10px;
          color: #64748b;
          margin-top: 4px;
        }

        .breakdowns {
          display: grid;
          grid-template-columns: repeat(2, 1fr);
          gap: 16px;
          margin-top: 24px;
        }

        .breakdown-card {
          background: white;
          padding: 20px;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
        }

        .breakdown-card h4 {
          margin: 0 0 12px 0;
          color: #1a202c;
        }

        .breakdown-item {
          display: flex;
          justify-content: space-between;
          padding: 8px 0;
          border-bottom: 1px solid #f3f4f6;
        }

        .breakdown-item:last-child {
          border-bottom: none;
        }

        .breakdown-item span {
          color: #64748b;
        }

        .breakdown-item strong {
          color: #1a202c;
        }
      `})]})}function QH({users:e}){return o.jsxs("div",{className:"users-panel",children:[o.jsxs("h2",{children:["User Management (",e.length," users)"]}),o.jsxs("table",{className:"users-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Email"}),o.jsx("th",{children:"Role"}),o.jsx("th",{children:"Designs"}),o.jsx("th",{children:"Projects"}),o.jsx("th",{children:"Jobs"}),o.jsx("th",{children:"Last Design"}),o.jsx("th",{children:"Joined"})]})}),o.jsx("tbody",{children:e.map(t=>o.jsxs("tr",{children:[o.jsx("td",{children:t.email}),o.jsx("td",{children:o.jsx("span",{className:`role-badge ${t.role}`,children:t.role})}),o.jsx("td",{children:t.design_count}),o.jsx("td",{children:t.project_count}),o.jsx("td",{children:t.job_count}),o.jsx("td",{children:t.last_design_at?new Date(t.last_design_at).toLocaleDateString():"-"}),o.jsx("td",{children:new Date(t.created_at).toLocaleDateString()})]},t.id))})]}),o.jsx("style",{jsx:!0,children:`
        .users-panel h2 {
          margin: 0 0 24px 0;
          color: #1a202c;
        }

        .users-table {
          width: 100%;
          background: white;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
          border-collapse: collapse;
        }

        .users-table th,
        .users-table td {
          padding: 12px 16px;
          text-align: left;
          border-bottom: 1px solid #e5e7eb;
        }

        .users-table th {
          background: #f8fafc;
          font-weight: 600;
          color: #64748b;
          font-size: 12px;
          text-transform: uppercase;
        }

        .users-table td {
          font-size: 14px;
          color: #1a202c;
        }

        .role-badge {
          padding: 4px 8px;
          border-radius: 4px;
          font-size: 12px;
          font-weight: 500;
        }

        .role-badge.user {
          background: #f3f4f6;
          color: #64748b;
        }

        .role-badge.admin {
          background: #dbeafe;
          color: #1e40af;
        }

        .role-badge.superadmin {
          background: #fef3c7;
          color: #92400e;
        }
      `})]})}function e7({designs:e,total:t}){return o.jsxs("div",{className:"designs-panel",children:[o.jsxs("h2",{children:["All Designs (",t," total)"]}),o.jsx("div",{className:"designs-grid",children:e.map(r=>o.jsxs("div",{className:"design-card",children:[o.jsx("div",{className:"design-thumbnail",children:r.thumbnail_url||r.original_png_url?o.jsx("img",{src:r.thumbnail_url||r.original_png_url,alt:r.name}):o.jsx("div",{className:"no-image",children:"No preview"})}),o.jsxs("div",{className:"design-info",children:[o.jsx("h4",{children:r.name}),o.jsx("p",{className:"design-user",children:r.user_email}),o.jsx("p",{className:"design-date",children:new Date(r.created_at).toLocaleDateString()}),r.project&&o.jsx("span",{className:"project-badge",style:{backgroundColor:r.project.color||"#64748b"},children:r.project.name})]})]},r.id))}),o.jsx("style",{jsx:!0,children:`
        .designs-panel h2 {
          margin: 0 0 24px 0;
          color: #1a202c;
        }

        .designs-grid {
          display: grid;
          grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
          gap: 16px;
        }

        .design-card {
          background: white;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
          overflow: hidden;
        }

        .design-thumbnail {
          aspect-ratio: 1;
          background: #f3f4f6;
          overflow: hidden;
        }

        .design-thumbnail img {
          width: 100%;
          height: 100%;
          object-fit: cover;
        }

        .no-image {
          width: 100%;
          height: 100%;
          display: flex;
          align-items: center;
          justify-content: center;
          color: #9ca3af;
          font-size: 14px;
        }

        .design-info {
          padding: 12px;
        }

        .design-info h4 {
          margin: 0 0 4px 0;
          font-size: 14px;
          color: #1a202c;
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
        }

        .design-user {
          margin: 0;
          font-size: 12px;
          color: #64748b;
        }

        .design-date {
          margin: 4px 0;
          font-size: 12px;
          color: #9ca3af;
        }

        .project-badge {
          display: inline-block;
          padding: 2px 8px;
          border-radius: 10px;
          font-size: 10px;
          color: white;
        }
      `})]})}function t7({analytics:e}){return o.jsxs("div",{className:"colours-panel",children:[o.jsx("h2",{children:"Colour Usage Analytics"}),o.jsxs("div",{className:"colour-stats",children:[o.jsxs("div",{className:"stat-card",children:[o.jsx("div",{className:"stat-value",children:e.totals.designs_analysed}),o.jsx("div",{className:"stat-label",children:"Designs Analysed"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("div",{className:"stat-value",children:e.totals.colour_usages}),o.jsx("div",{className:"stat-label",children:"Total Colour Uses"})]})]}),o.jsx("h3",{children:"Top 10 TPV Colours"}),o.jsx("div",{className:"colour-list",children:e.top_colours.map((t,r)=>o.jsxs("div",{className:"colour-item",children:[o.jsxs("span",{className:"colour-rank",children:["#",r+1]}),o.jsx("div",{className:"colour-swatch",style:{backgroundColor:t.hex}}),o.jsxs("div",{className:"colour-info",children:[o.jsx("strong",{children:t.code}),o.jsx("span",{children:t.name})]}),o.jsxs("div",{className:"colour-count",children:[t.count," uses"]})]},t.code))}),o.jsx("h3",{children:"Colour Family Breakdown"}),o.jsx("div",{className:"family-bars",children:Object.entries(e.families).map(([t,r])=>o.jsxs("div",{className:"family-bar",children:[o.jsx("span",{className:"family-name",children:t}),o.jsx("div",{className:"bar-bg",children:o.jsx("div",{className:"bar-fill",style:{width:`${r/e.totals.colour_usages*100}%`,backgroundColor:r7(t)}})}),o.jsx("span",{className:"family-count",children:r})]},t))}),e.top_blends.length>0&&o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Top Blend Combinations"}),o.jsx("div",{className:"blend-list",children:e.top_blends.map((t,r)=>o.jsxs("div",{className:"blend-item",children:[o.jsx("div",{className:"blend-swatches",children:t.components.map((n,i)=>o.jsx("div",{className:"blend-swatch",style:{backgroundColor:n.hex},title:`${n.code} - ${n.name}`},i))}),o.jsx("div",{className:"blend-codes",children:t.components.map(n=>n.code).join(" + ")}),o.jsxs("div",{className:"blend-count",children:[t.count," uses"]})]},r))})]}),o.jsx("style",{jsx:!0,children:`
        .colours-panel h2 {
          margin: 0 0 24px 0;
          color: #1a202c;
        }

        .colours-panel h3 {
          margin: 32px 0 16px 0;
          color: #1a202c;
        }

        .colour-stats {
          display: grid;
          grid-template-columns: repeat(2, 1fr);
          gap: 16px;
          margin-bottom: 24px;
        }

        .stat-card {
          background: white;
          padding: 20px;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
        }

        .stat-value {
          font-size: 32px;
          font-weight: 700;
          color: #1e4a7a;
        }

        .stat-label {
          font-size: 14px;
          color: #64748b;
          margin-top: 4px;
        }

        .colour-list {
          background: white;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
          overflow: hidden;
        }

        .colour-item {
          display: flex;
          align-items: center;
          gap: 12px;
          padding: 12px 16px;
          border-bottom: 1px solid #f3f4f6;
        }

        .colour-item:last-child {
          border-bottom: none;
        }

        .colour-rank {
          width: 30px;
          font-size: 12px;
          color: #9ca3af;
        }

        .colour-swatch {
          width: 32px;
          height: 32px;
          border-radius: 6px;
          border: 1px solid #e5e7eb;
        }

        .colour-info {
          flex: 1;
        }

        .colour-info strong {
          display: block;
          color: #1a202c;
        }

        .colour-info span {
          font-size: 12px;
          color: #64748b;
        }

        .colour-count {
          font-weight: 600;
          color: #1e4a7a;
        }

        .family-bars {
          background: white;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
          padding: 16px;
        }

        .family-bar {
          display: flex;
          align-items: center;
          gap: 12px;
          margin-bottom: 12px;
        }

        .family-bar:last-child {
          margin-bottom: 0;
        }

        .family-name {
          width: 80px;
          font-size: 14px;
          color: #64748b;
          text-transform: capitalize;
        }

        .bar-bg {
          flex: 1;
          height: 20px;
          background: #f3f4f6;
          border-radius: 4px;
          overflow: hidden;
        }

        .bar-fill {
          height: 100%;
          border-radius: 4px;
        }

        .family-count {
          width: 50px;
          text-align: right;
          font-weight: 600;
          color: #1a202c;
        }

        .blend-list {
          background: white;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
          overflow: hidden;
        }

        .blend-item {
          display: flex;
          align-items: center;
          gap: 12px;
          padding: 12px 16px;
          border-bottom: 1px solid #f3f4f6;
        }

        .blend-item:last-child {
          border-bottom: none;
        }

        .blend-swatches {
          display: flex;
          gap: 4px;
        }

        .blend-swatch {
          width: 24px;
          height: 24px;
          border-radius: 4px;
          border: 1px solid #e5e7eb;
        }

        .blend-codes {
          flex: 1;
          font-size: 14px;
          color: #1a202c;
        }

        .blend-count {
          font-weight: 600;
          color: #1e4a7a;
        }
      `})]})}function r7(e){return{reds:"#dc2626",greens:"#16a34a",blues:"#2563eb",yellows:"#ca8a04",neutrals:"#6b7280"}[e]||"#6b7280"}const Lu=[{code:"RH30",name:"Beige",hex:"#E4C4AA"},{code:"RH31",name:"Cream",hex:"#E8E3D8"},{code:"RH41",name:"Bright Yellow",hex:"#FFD833"},{code:"RH40",name:"Mustard",hex:"#E5A144"},{code:"RH50",name:"Orange",hex:"#F15B32"},{code:"RH01",name:"Standard Red",hex:"#A5362F"},{code:"RH02",name:"Bright Red",hex:"#E21F2F"},{code:"RH90",name:"Funky Pink",hex:"#E8457E"},{code:"RH21",name:"Purple",hex:"#493D8C"},{code:"RH20",name:"Standard Blue",hex:"#0075BC"},{code:"RH22",name:"Light Blue",hex:"#47AFE3"},{code:"RH23",name:"Azure",hex:"#039DC4"},{code:"RH26",name:"Turquoise",hex:"#00A6A3"},{code:"RH12",name:"Dark Green",hex:"#006C55"},{code:"RH10",name:"Standard Green",hex:"#609B63"},{code:"RH11",name:"Bright Green",hex:"#3BB44A"},{code:"RH32",name:"Brown",hex:"#8B5F3C"},{code:"RH65",name:"Pale Grey",hex:"#D9D9D6"},{code:"RH61",name:"Light Grey",hex:"#939598"},{code:"RH60",name:"Dark Grey",hex:"#59595B"},{code:"RH70",name:"Black",hex:"#231F20"}],Zv=["ocean theme with dolphins and waves","jungle adventure with parrots","solar system with planets","garden with butterflies and flowers","racing track with cars","underwater coral reef scene","dinosaur footprints trail","rainbow with clouds"],n7=[...Array(60)].map(e=>({delay:`${Math.random()*3}s`,x:`${Math.random()*100}%`,y:`${Math.random()*100}%`,size:`${8+Math.random()*12}px`}));function i7(){const[e,t]=A.useState(""),[r,n]=A.useState(""),[i,s]=A.useState(""),[a,l]=A.useState(!1),[c,d]=A.useState(!1),[u,f]=A.useState(0);A.useEffect(()=>{const g=setInterval(()=>{f(m=>(m+1)%Zv.length)},5e3);return()=>clearInterval(g)},[]);const h=async g=>{g.preventDefault(),s(""),l(!0);try{await Tn.signIn(e,r)}catch(m){s(m.message||"Sign in failed")}finally{l(!1)}},p=g=>{var m;(m=document.getElementById(g))==null||m.scrollIntoView({behavior:"smooth"})};return o.jsxs("div",{className:"landing-page",children:[o.jsxs("nav",{className:"landing-nav",children:[o.jsxs("div",{className:"nav-logo",children:[o.jsx("span",{className:"logo-text",children:"TPV"}),o.jsx("span",{className:"logo-accent",children:"Studio"})]}),o.jsxs("div",{className:"nav-links",children:[o.jsx("button",{onClick:()=>p("features"),children:"Features"}),o.jsx("button",{onClick:()=>p("palette"),children:"Colours"}),o.jsx("button",{onClick:()=>d(!0),className:"nav-cta",children:"Sign In"})]})]}),o.jsxs("section",{className:"hero",children:[o.jsx("div",{className:"hero-background",children:o.jsx("div",{className:"granule-field",children:n7.map((g,m)=>o.jsx("div",{className:"granule",style:{"--delay":g.delay,"--x":g.x,"--y":g.y,"--color":Lu[m%Lu.length].hex,"--size":g.size}},m))})}),o.jsxs("div",{className:"hero-content",children:[o.jsx("div",{className:"hero-badge",children:"TPV Surface Design Platform"}),o.jsxs("h1",{children:[o.jsx("span",{className:"hero-line-1",children:"Design Any"}),o.jsx("span",{className:"hero-line-2",children:"TPV Surface"})]}),o.jsx("p",{className:"hero-subtitle",children:"From AI-generated playground art to professional sports courts  one powerful design platform for all your TPV surfaces."}),o.jsxs("div",{className:"hero-ctas",children:[o.jsxs("button",{onClick:()=>d(!0),className:"cta-primary",children:["Start Designing",o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M5 12h14M12 5l7 7-7 7"})})]}),o.jsx("button",{onClick:()=>p("how-it-works"),className:"cta-secondary",children:"See How It Works"})]})]}),o.jsx("div",{className:"hero-visual",children:o.jsx("div",{className:"mockup-container",children:o.jsxs("div",{className:"mockup-screen",children:[o.jsx("div",{className:"mockup-header",children:o.jsxs("div",{className:"mockup-dots",children:[o.jsx("span",{}),o.jsx("span",{}),o.jsx("span",{})]})}),o.jsxs("div",{className:"mockup-content",children:[o.jsx("div",{className:"mockup-input",children:o.jsx("span",{className:"typing-text",children:Zv[u]},u)}),o.jsxs("div",{className:"mockup-preview",children:[o.jsx("div",{className:"preview-shape shape-1"}),o.jsx("div",{className:"preview-shape shape-2"}),o.jsx("div",{className:"preview-shape shape-3"})]})]})]})})})]}),o.jsxs("section",{className:"unified-showcase",children:[o.jsxs("div",{className:"section-header",children:[o.jsx("span",{className:"section-tag",children:"One Powerful Tool"}),o.jsx("h2",{children:"Design Any Surface"}),o.jsx("p",{className:"section-subtitle",children:"Courts, tracks, playgrounds, and custom graphics  all in one canvas"})]}),o.jsx("div",{className:"showcase-container",children:o.jsxs("div",{className:"showcase-card",children:[o.jsxs("div",{className:"showcase-canvas",children:[o.jsxs("div",{className:"canvas-preview",children:[o.jsx("div",{className:"canvas-grid"}),o.jsxs("div",{className:"canvas-surface",children:[o.jsx("div",{className:"surface-court"}),o.jsx("div",{className:"surface-motif"})]})]}),o.jsxs("div",{className:"capability-pill pill-courts",children:[o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[o.jsx("rect",{x:"2",y:"4",width:"20",height:"16",rx:"2"}),o.jsx("circle",{cx:"12",cy:"12",r:"3"}),o.jsx("path",{d:"M2 12h4M18 12h4"})]}),o.jsx("span",{children:"Courts & Tracks"})]}),o.jsxs("div",{className:"capability-pill pill-ai",children:[o.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:o.jsx("path",{d:"M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2z"})}),o.jsx("span",{children:"AI Artwork"})]}),o.jsxs("div",{className:"capability-pill pill-upload",children:[o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[o.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),o.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),o.jsx("path",{d:"M21 15l-5-5L5 21"})]}),o.jsx("span",{children:"Custom Images"})]}),o.jsxs("div",{className:"capability-pill pill-layers",children:[o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[o.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5z"}),o.jsx("path",{d:"M2 17l10 5 10-5"}),o.jsx("path",{d:"M2 12l10 5 10-5"})]}),o.jsx("span",{children:"Layer & Combine"})]})]}),o.jsx("div",{className:"showcase-tagline",children:"One canvas. Unlimited possibilities."}),o.jsxs("div",{className:"showcase-features",children:[o.jsxs("div",{className:"showcase-feature",children:[o.jsx("div",{className:"feature-badge ai-badge",children:"AI-POWERED"}),o.jsx("span",{children:"Generate motifs from text descriptions"})]}),o.jsxs("div",{className:"showcase-feature",children:[o.jsx("div",{className:"feature-badge template-badge",children:"TEMPLATES"}),o.jsx("span",{children:"15+ professional court layouts"})]}),o.jsxs("div",{className:"showcase-feature",children:[o.jsx("div",{className:"feature-badge compose-badge",children:"COMPOSE"}),o.jsx("span",{children:"Mix courts, tracks & artwork freely"})]})]}),o.jsxs("button",{onClick:()=>d(!0),className:"cta-primary showcase-cta",children:["Start Designing",o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M5 12h14M12 5l7 7-7 7"})})]})]})})]}),o.jsxs("section",{id:"how-it-works",className:"how-it-works",children:[o.jsxs("div",{className:"section-header",children:[o.jsx("span",{className:"section-tag",children:"Process"}),o.jsx("h2",{children:"Three Steps to Production-Ready Designs"})]}),o.jsxs("div",{className:"steps-container",children:[o.jsxs("div",{className:"step",children:[o.jsx("div",{className:"step-number",children:"01"}),o.jsx("div",{className:"step-icon",children:o.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[o.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),o.jsx("path",{d:"M3 9h18M9 21V9"})]})}),o.jsx("h3",{children:"Set Up Your Surface"}),o.jsx("p",{children:"Define your dimensions and choose your base colour. Start with any size from small playgrounds to full athletic facilities."})]}),o.jsx("div",{className:"step-connector",children:o.jsx("svg",{viewBox:"0 0 100 20",preserveAspectRatio:"none",children:o.jsx("path",{d:"M0 10 Q50 10 100 10",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeDasharray:"4 4"})})}),o.jsxs("div",{className:"step",children:[o.jsx("div",{className:"step-number",children:"02"}),o.jsx("div",{className:"step-icon",children:o.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[o.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5z"}),o.jsx("path",{d:"M2 17l10 5 10-5"}),o.jsx("path",{d:"M2 12l10 5 10-5"})]})}),o.jsx("h3",{children:"Add Elements"}),o.jsx("p",{children:"Drop in courts and tracks from the library, generate AI artwork, upload your own designs  layer and combine freely."})]}),o.jsx("div",{className:"step-connector",children:o.jsx("svg",{viewBox:"0 0 100 20",preserveAspectRatio:"none",children:o.jsx("path",{d:"M0 10 Q50 10 100 10",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeDasharray:"4 4"})})}),o.jsxs("div",{className:"step",children:[o.jsx("div",{className:"step-number",children:"03"}),o.jsx("div",{className:"step-icon",children:o.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[o.jsx("path",{d:"M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"}),o.jsx("path",{d:"M14 2v6h6M12 18v-6M9 15l3 3 3-3"})]})}),o.jsx("h3",{children:"Export & Build"}),o.jsx("p",{children:"Generate professional PDFs with material specifications, TPV blend recipes, and exact quantities for installation."})]})]})]}),o.jsxs("section",{id:"features",className:"features",children:[o.jsxs("div",{className:"section-header",children:[o.jsx("span",{className:"section-tag",children:"Capabilities"}),o.jsx("h2",{children:"Everything You Need to Design TPV Surfaces"})]}),o.jsxs("div",{className:"features-grid unified-features",children:[o.jsxs("div",{className:"feature-card feature-highlight",children:[o.jsx("div",{className:"feature-icon",children:o.jsx("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:o.jsx("path",{d:"M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2z"})})}),o.jsx("h3",{children:"AI Text-to-Vector"}),o.jsx("p",{children:"Describe any concept in natural language. Our AI transforms your words into production-ready vector designs optimised for TPV surfaces."}),o.jsx("div",{className:"feature-example",children:'"vibrant underwater scene with coral reef"'})]}),o.jsxs("div",{className:"feature-card",children:[o.jsx("div",{className:"feature-icon",children:o.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[o.jsx("rect",{x:"2",y:"4",width:"20",height:"16",rx:"2"}),o.jsx("circle",{cx:"12",cy:"12",r:"3"}),o.jsx("path",{d:"M2 12h4M18 12h4"})]})}),o.jsx("h3",{children:"Court & Track Library"}),o.jsx("p",{children:"15+ professional templates including basketball, tennis, netball, futsal, and running tracks."})]}),o.jsxs("div",{className:"feature-card",children:[o.jsx("div",{className:"feature-icon",children:o.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[o.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),o.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),o.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),o.jsx("h3",{children:"Image Vectorisation"}),o.jsx("p",{children:"Upload any image and convert it to clean vectors optimised for TPV production."})]}),o.jsxs("div",{className:"feature-card",children:[o.jsx("div",{className:"feature-icon",children:o.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[o.jsx("circle",{cx:"13.5",cy:"6.5",r:"2.5"}),o.jsx("circle",{cx:"17.5",cy:"10.5",r:"2.5"}),o.jsx("circle",{cx:"8.5",cy:"7.5",r:"2.5"}),o.jsx("circle",{cx:"6.5",cy:"12.5",r:"2.5"})]})}),o.jsx("h3",{children:"Blend Colour Matching"}),o.jsx("p",{children:"Automatic TPV recipe generation with precise blend ratios for perfect colour accuracy."})]}),o.jsxs("div",{className:"feature-card",children:[o.jsx("div",{className:"feature-icon",children:o.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[o.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5z"}),o.jsx("path",{d:"M2 17l10 5 10-5"}),o.jsx("path",{d:"M2 12l10 5 10-5"})]})}),o.jsx("h3",{children:"Layer Management"}),o.jsx("p",{children:"Combine courts, tracks, and motifs freely. Drag, rotate, and layer with precision controls."})]}),o.jsxs("div",{className:"feature-card",children:[o.jsx("div",{className:"feature-icon",children:o.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[o.jsx("path",{d:"M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"}),o.jsx("path",{d:"M14 2v6h6M12 18v-6M9 15l3 3 3-3"})]})}),o.jsx("h3",{children:"PDF Specifications"}),o.jsx("p",{children:"Export production-ready material specs with blend recipes and installation guides."})]})]})]}),o.jsxs("section",{id:"palette",className:"palette-section",children:[o.jsxs("div",{className:"section-header light",children:[o.jsx("span",{className:"section-tag",children:"Palette"}),o.jsx("h2",{children:"21 Standard TPV Colours"}),o.jsx("p",{className:"section-subtitle",children:"The complete Rosehill TPV granule palette at your fingertips"})]}),o.jsx("div",{className:"palette-grid",children:Lu.map((g,m)=>o.jsxs("div",{className:"palette-swatch",style:{"--swatch-color":g.hex,"--delay":`${m*.03}s`},children:[o.jsx("div",{className:"swatch-color"}),o.jsxs("div",{className:"swatch-info",children:[o.jsx("span",{className:"swatch-name",children:g.name}),o.jsx("span",{className:"swatch-code",children:g.code})]})]},g.code))})]}),o.jsx("section",{className:"benefits",children:o.jsxs("div",{className:"benefits-grid benefits-grid-4",children:[o.jsxs("div",{className:"benefit",children:[o.jsx("div",{className:"benefit-metric",children:"10x"}),o.jsx("div",{className:"benefit-label",children:"Faster Design"}),o.jsx("p",{children:"What took hours now takes minutes with AI and templates."})]}),o.jsxs("div",{className:"benefit",children:[o.jsx("div",{className:"benefit-metric",children:"100%"}),o.jsx("div",{className:"benefit-label",children:"Production Accurate"}),o.jsx("p",{children:"Exact TPV granule specs with precise ratio specifications."})]}),o.jsxs("div",{className:"benefit",children:[o.jsx("div",{className:"benefit-metric infinite-symbol",children:""}),o.jsx("div",{className:"benefit-label",children:"Combinations"}),o.jsx("p",{children:"Mix courts, tracks, and artwork in unlimited configurations."})]}),o.jsxs("div",{className:"benefit",children:[o.jsx("div",{className:"benefit-metric",children:"21"}),o.jsx("div",{className:"benefit-label",children:"Standard Colours"}),o.jsx("p",{children:"Complete Rosehill TPV palette with blend combinations."})]})]})}),o.jsx("section",{className:"cta-footer",children:o.jsxs("div",{className:"cta-content",children:[o.jsx("h2",{children:"Ready to Design Your Surface?"}),o.jsx("p",{children:"Create playgrounds or sports facilities with production-ready TPV specifications."}),o.jsxs("button",{onClick:()=>d(!0),className:"cta-primary large",children:["Sign In to TPV Studio",o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M5 12h14M12 5l7 7-7 7"})})]}),o.jsxs("p",{className:"cta-note",children:["Need an account? Contact ",o.jsx("a",{href:"mailto:info@rosehill.group",children:"info@rosehill.group"})]})]})}),c&&o.jsx("div",{className:"modal-overlay",onClick:()=>d(!1),children:o.jsxs("div",{className:"sign-in-modal",onClick:g=>g.stopPropagation(),children:[o.jsx("button",{className:"modal-close",onClick:()=>d(!1),children:o.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})}),o.jsxs("div",{className:"modal-header",children:[o.jsx("h2",{children:"Sign In"}),o.jsx("p",{children:"Access your TPV Studio account"})]}),i&&o.jsx("div",{className:"form-error",children:i}),o.jsxs("form",{onSubmit:h,children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Email"}),o.jsx("input",{type:"email",value:e,onChange:g=>t(g.target.value),placeholder:"your.email@company.com",required:!0})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Password"}),o.jsx("input",{type:"password",value:r,onChange:g=>n(g.target.value),required:!0})]}),o.jsx("button",{type:"submit",disabled:a,className:"submit-btn",children:a?"Signing in...":"Sign In"})]}),o.jsx("p",{className:"modal-footer-text",children:"Don't have an account? Contact your administrator."})]})}),o.jsx("style",{jsx:!0,children:`
        /* ============================================
           TPV STUDIO LANDING PAGE
           Aesthetic: Sophisticated Industrial-Creative
           ============================================ */

        @import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=DM+Sans:wght@400;500;600&display=swap');

        .landing-page {
          --primary: #1e4a7a;
          --primary-light: #2a5a8e;
          --accent: #ff6b35;
          --accent-hover: #e55a2a;
          --text: #1a202c;
          --text-secondary: #64748b;
          --text-light: #94a3b8;
          --bg: #fafbfc;
          --bg-dark: #0f172a;
          --card: #ffffff;
          --border: #e2e8f0;

          font-family: 'DM Sans', sans-serif;
          background: var(--bg);
          color: var(--text);
          overflow-x: hidden;
        }

        /* Navigation */
        .landing-nav {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          z-index: 1000;
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 1rem 3rem;
          background: rgba(255, 255, 255, 0.9);
          backdrop-filter: blur(12px);
          border-bottom: 1px solid var(--border);
        }

        .nav-logo {
          font-family: 'Space Grotesk', sans-serif;
          font-size: 1.5rem;
          font-weight: 700;
        }

        .logo-text {
          color: var(--primary);
        }

        .logo-accent {
          color: var(--accent);
        }

        .nav-links {
          display: flex;
          align-items: center;
          gap: 2rem;
        }

        .nav-links button {
          background: none;
          border: none;
          font-family: inherit;
          font-size: 0.875rem;
          font-weight: 500;
          color: var(--text-secondary);
          cursor: pointer;
          transition: color 0.2s;
        }

        .nav-links button:hover {
          color: var(--text);
        }

        .nav-cta {
          background: var(--primary) !important;
          color: white !important;
          padding: 0.5rem 1.25rem !important;
          border-radius: 6px !important;
        }

        .nav-cta:hover {
          background: var(--primary-light) !important;
        }

        /* Hero Section */
        .hero {
          min-height: 100vh;
          display: grid;
          grid-template-columns: 1fr 1fr;
          align-items: center;
          padding: 8rem 4rem 4rem;
          position: relative;
          overflow: hidden;
        }

        .hero-background {
          position: absolute;
          inset: 0;
          pointer-events: none;
        }

        .granule-field {
          position: absolute;
          inset: 0;
        }

        .granule {
          position: absolute;
          left: var(--x);
          top: var(--y);
          width: var(--size);
          height: var(--size);
          background: var(--color);
          border-radius: 50%;
          opacity: 0.15;
          animation: float 8s ease-in-out infinite;
          animation-delay: var(--delay);
        }

        @keyframes float {
          0%, 100% { transform: translateY(0) scale(1); }
          50% { transform: translateY(-20px) scale(1.1); }
        }

        .hero-content {
          position: relative;
          z-index: 10;
        }

        .hero-badge {
          display: inline-block;
          padding: 0.5rem 1rem;
          background: rgba(30, 74, 122, 0.1);
          color: var(--primary);
          font-size: 0.75rem;
          font-weight: 600;
          text-transform: uppercase;
          letter-spacing: 0.1em;
          border-radius: 50px;
          margin-bottom: 1.5rem;
        }

        .hero h1 {
          font-family: 'Space Grotesk', sans-serif;
          font-size: 3.5rem;
          font-weight: 700;
          line-height: 1.1;
          margin: 0 0 1.5rem;
        }

        .hero-line-1 {
          display: block;
          color: var(--text-secondary);
        }

        .hero-line-2 {
          display: block;
          color: var(--primary);
        }

        .hero-subtitle {
          font-size: 1.125rem;
          color: var(--text-secondary);
          line-height: 1.7;
          max-width: 480px;
          margin-bottom: 2rem;
        }

        .hero-ctas {
          display: flex;
          gap: 1rem;
        }

        .cta-primary {
          display: inline-flex;
          align-items: center;
          gap: 0.5rem;
          padding: 0.875rem 1.5rem;
          background: var(--accent);
          color: white;
          border: none;
          border-radius: 8px;
          font-family: inherit;
          font-size: 0.9375rem;
          font-weight: 600;
          cursor: pointer;
          transition: all 0.2s;
        }

        .cta-primary:hover {
          background: var(--accent-hover);
          transform: translateY(-2px);
          box-shadow: 0 8px 24px rgba(255, 107, 53, 0.3);
        }

        .cta-primary.large {
          padding: 1rem 2rem;
          font-size: 1rem;
        }

        .cta-secondary {
          padding: 0.875rem 1.5rem;
          background: white;
          color: var(--text);
          border: 2px solid var(--border);
          border-radius: 8px;
          font-family: inherit;
          font-size: 0.9375rem;
          font-weight: 600;
          cursor: pointer;
          transition: all 0.2s;
        }

        .cta-secondary:hover {
          border-color: var(--primary);
          color: var(--primary);
        }

        /* Hero Visual / Mockup */
        .hero-visual {
          position: relative;
          z-index: 10;
          display: flex;
          justify-content: center;
        }

        .mockup-container {
          perspective: 1000px;
        }

        .mockup-screen {
          width: 400px;
          background: white;
          border-radius: 12px;
          box-shadow: 0 24px 80px rgba(0, 0, 0, 0.15);
          overflow: hidden;
          transform: rotateY(-5deg) rotateX(2deg);
          animation: mockupFloat 6s ease-in-out infinite;
        }

        @keyframes mockupFloat {
          0%, 100% { transform: rotateY(-5deg) rotateX(2deg) translateY(0); }
          50% { transform: rotateY(-5deg) rotateX(2deg) translateY(-10px); }
        }

        .mockup-header {
          padding: 0.75rem 1rem;
          background: #f8f8f8;
          border-bottom: 1px solid #eee;
        }

        .mockup-dots {
          display: flex;
          gap: 6px;
        }

        .mockup-dots span {
          width: 10px;
          height: 10px;
          border-radius: 50%;
          background: #ddd;
        }

        .mockup-dots span:nth-child(1) { background: #ff5f56; }
        .mockup-dots span:nth-child(2) { background: #ffbd2e; }
        .mockup-dots span:nth-child(3) { background: #27ca41; }

        .mockup-content {
          padding: 1.5rem;
        }

        .mockup-input {
          background: #f5f5f5;
          padding: 1rem;
          border-radius: 8px;
          font-size: 0.875rem;
          color: var(--text-secondary);
          margin-bottom: 1.5rem;
          display: flex;
          align-items: center;
        }

        .typing-text {
          display: inline-block;
          overflow: hidden;
          white-space: nowrap;
          border-right: 2px solid var(--primary);
          animation: typing 5s steps(40, end) forwards, blink 0.7s step-end infinite;
        }

        @keyframes typing {
          0% { max-width: 0; }
          35% { max-width: 500px; }
          65% { max-width: 500px; }
          100% { max-width: 0; }
        }

        @keyframes blink {
          50% { border-color: transparent; }
        }

        .mockup-preview {
          height: 180px;
          background: linear-gradient(135deg, #e8f4f8, #f0f4ff);
          border-radius: 8px;
          position: relative;
          overflow: hidden;
        }

        .preview-shape {
          position: absolute;
          border-radius: 50%;
          animation: shapeReveal 4s ease-out infinite;
        }

        .shape-1 {
          width: 80px;
          height: 80px;
          background: var(--accent);
          opacity: 0.8;
          top: 20%;
          left: 15%;
          animation-delay: 0s;
        }

        .shape-2 {
          width: 60px;
          height: 60px;
          background: #30D5C8;
          opacity: 0.8;
          top: 40%;
          left: 50%;
          animation-delay: 0.3s;
        }

        .shape-3 {
          width: 100px;
          height: 100px;
          background: var(--primary);
          opacity: 0.8;
          top: 50%;
          right: 10%;
          animation-delay: 0.6s;
        }

        @keyframes shapeReveal {
          0%, 100% { transform: scale(0.8); opacity: 0.4; }
          50% { transform: scale(1); opacity: 0.8; }
        }

        /* Section Headers */
        .section-header {
          text-align: center;
          margin-bottom: 4rem;
        }

        .section-header.light h2,
        .section-header.light .section-subtitle {
          color: white;
        }

        .section-header.light .section-tag {
          background: rgba(255, 255, 255, 0.1);
          color: rgba(255, 255, 255, 0.9);
        }

        .section-tag {
          display: inline-block;
          padding: 0.375rem 0.875rem;
          background: rgba(30, 74, 122, 0.1);
          color: var(--primary);
          font-size: 0.6875rem;
          font-weight: 600;
          text-transform: uppercase;
          letter-spacing: 0.15em;
          border-radius: 50px;
          margin-bottom: 1rem;
        }

        .section-header h2 {
          font-family: 'Space Grotesk', sans-serif;
          font-size: 2.5rem;
          font-weight: 700;
          color: var(--text);
          margin: 0;
        }

        .section-subtitle {
          margin-top: 1rem;
          font-size: 1.125rem;
          color: var(--text-secondary);
        }

        /* How It Works */
        .how-it-works {
          padding: 6rem 4rem;
          background: white;
        }

        .steps-container {
          display: flex;
          align-items: flex-start;
          justify-content: center;
          gap: 1rem;
        }

        .step {
          flex: 1;
          max-width: 280px;
          text-align: center;
          padding: 2rem 1.5rem;
        }

        .step-number {
          font-family: 'Space Grotesk', sans-serif;
          font-size: 3rem;
          font-weight: 700;
          color: rgba(30, 74, 122, 0.1);
          margin-bottom: 1rem;
        }

        .step-icon {
          width: 64px;
          height: 64px;
          margin: 0 auto 1.5rem;
          display: flex;
          align-items: center;
          justify-content: center;
          background: rgba(255, 107, 53, 0.1);
          border-radius: 16px;
          color: var(--accent);
        }

        .step h3 {
          font-family: 'Space Grotesk', sans-serif;
          font-size: 1.25rem;
          font-weight: 600;
          margin: 0 0 0.75rem;
          color: var(--text);
        }

        .step p {
          font-size: 0.9375rem;
          color: var(--text-secondary);
          line-height: 1.6;
          margin: 0;
        }

        .step-connector {
          width: 100px;
          padding-top: 5rem;
          color: var(--border);
        }

        /* Features */
        .features {
          padding: 6rem 4rem;
          background: var(--bg);
        }

        .features-grid {
          display: grid;
          grid-template-columns: repeat(3, 1fr);
          gap: 1.5rem;
          max-width: 1200px;
          margin: 0 auto;
        }

        .feature-card {
          background: white;
          padding: 2rem;
          border-radius: 12px;
          border: 1px solid var(--border);
          transition: all 0.3s;
        }

        .feature-card:hover {
          transform: translateY(-4px);
          box-shadow: 0 12px 40px rgba(0, 0, 0, 0.08);
        }

        .feature-highlight {
          grid-column: span 2;
          background: linear-gradient(135deg, var(--primary), var(--primary-light));
          color: white;
          border: none;
        }

        .feature-highlight .feature-icon {
          background: rgba(255, 255, 255, 0.2);
          color: white;
        }

        .feature-highlight h3 {
          color: white;
        }

        .feature-highlight p {
          color: rgba(255, 255, 255, 0.9);
        }

        .feature-icon {
          width: 56px;
          height: 56px;
          display: flex;
          align-items: center;
          justify-content: center;
          background: rgba(30, 74, 122, 0.1);
          border-radius: 12px;
          color: var(--primary);
          margin-bottom: 1.25rem;
        }

        .feature-card h3 {
          font-family: 'Space Grotesk', sans-serif;
          font-size: 1.125rem;
          font-weight: 600;
          margin: 0 0 0.5rem;
        }

        .feature-card p {
          font-size: 0.875rem;
          color: var(--text-secondary);
          line-height: 1.6;
          margin: 0;
        }

        .feature-example {
          margin-top: 1.5rem;
          padding: 0.875rem 1rem;
          background: rgba(255, 255, 255, 0.1);
          border-radius: 8px;
          font-size: 0.8125rem;
          font-style: italic;
          opacity: 0.9;
        }

        /* Unified Showcase Section */
        .unified-showcase {
          padding: 6rem 4rem;
          background: white;
        }

        .showcase-container {
          max-width: 900px;
          margin: 0 auto;
        }

        .showcase-card {
          background: linear-gradient(135deg, #f8fafc, #f1f5f9);
          border-radius: 24px;
          padding: 3rem;
          border: 1px solid var(--border);
          text-align: center;
        }

        .showcase-canvas {
          position: relative;
          height: 280px;
          margin-bottom: 2rem;
        }

        .canvas-preview {
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 240px;
          height: 160px;
          background: white;
          border-radius: 12px;
          border: 2px solid var(--border);
          box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08);
          overflow: hidden;
        }

        .canvas-grid {
          position: absolute;
          inset: 0;
          background-image:
            linear-gradient(rgba(30, 74, 122, 0.05) 1px, transparent 1px),
            linear-gradient(90deg, rgba(30, 74, 122, 0.05) 1px, transparent 1px);
          background-size: 20px 20px;
        }

        .canvas-surface {
          position: absolute;
          inset: 10px;
          background: #e8f4f8;
          border-radius: 4px;
        }

        .surface-court {
          position: absolute;
          top: 20%;
          left: 15%;
          width: 70%;
          height: 60%;
          border: 2px solid #00a6a3;
          border-radius: 4px;
          opacity: 0.8;
        }

        .surface-court::before {
          content: '';
          position: absolute;
          top: 50%;
          left: 0;
          right: 0;
          height: 2px;
          background: #00a6a3;
        }

        .surface-court::after {
          content: '';
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 20px;
          height: 20px;
          border: 2px solid #00a6a3;
          border-radius: 50%;
        }

        .surface-motif {
          position: absolute;
          bottom: 10%;
          right: 10%;
          width: 35px;
          height: 35px;
          background: var(--accent);
          border-radius: 50%;
          opacity: 0.8;
          animation: motifPulse 3s ease-in-out infinite;
        }

        @keyframes motifPulse {
          0%, 100% { transform: scale(1); opacity: 0.8; }
          50% { transform: scale(1.1); opacity: 1; }
        }

        .capability-pill {
          position: absolute;
          display: flex;
          align-items: center;
          gap: 0.5rem;
          padding: 0.625rem 1rem;
          background: white;
          border-radius: 50px;
          box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
          font-size: 0.8125rem;
          font-weight: 500;
          color: var(--text);
          animation: pillFloat 4s ease-in-out infinite;
        }

        .pill-courts {
          top: 10%;
          left: 5%;
          animation-delay: 0s;
        }

        .pill-courts svg {
          color: #00a6a3;
        }

        .pill-ai {
          top: 5%;
          right: 10%;
          animation-delay: 0.5s;
        }

        .pill-ai svg {
          color: var(--accent);
        }

        .pill-upload {
          bottom: 15%;
          left: 8%;
          animation-delay: 1s;
        }

        .pill-upload svg {
          color: var(--primary);
        }

        .pill-layers {
          bottom: 10%;
          right: 5%;
          animation-delay: 1.5s;
        }

        .pill-layers svg {
          color: #30D5C8;
        }

        @keyframes pillFloat {
          0%, 100% { transform: translateY(0); }
          50% { transform: translateY(-8px); }
        }

        .showcase-tagline {
          font-family: 'Space Grotesk', sans-serif;
          font-size: 1.5rem;
          font-weight: 600;
          color: var(--text);
          margin-bottom: 2rem;
        }

        .showcase-features {
          display: flex;
          justify-content: center;
          gap: 2rem;
          flex-wrap: wrap;
          margin-bottom: 2rem;
        }

        .showcase-feature {
          display: flex;
          align-items: center;
          gap: 0.625rem;
          font-size: 0.875rem;
          color: var(--text-secondary);
        }

        .feature-badge {
          padding: 0.25rem 0.625rem;
          border-radius: 50px;
          font-size: 0.625rem;
          font-weight: 700;
          letter-spacing: 0.05em;
        }

        .ai-badge {
          background: rgba(255, 107, 53, 0.1);
          color: var(--accent);
        }

        .template-badge {
          background: rgba(0, 166, 163, 0.1);
          color: #00a6a3;
        }

        .compose-badge {
          background: rgba(30, 74, 122, 0.1);
          color: var(--primary);
        }

        .showcase-cta {
          margin: 0 auto;
        }

        /* Unified Features Grid */
        .unified-features {
          grid-template-columns: repeat(3, 1fr);
        }

        /* Infinite symbol styling */
        .infinite-symbol {
          font-size: 3.5rem;
          line-height: 1;
        }

        /* Benefits Grid 4 columns */
        .benefits-grid-4 {
          grid-template-columns: repeat(4, 1fr);
        }

        /* Palette Section */
        .palette-section {
          padding: 6rem 4rem;
          background: var(--bg-dark);
        }

        .palette-grid {
          display: grid;
          grid-template-columns: repeat(7, 1fr);
          gap: 1rem;
          max-width: 1000px;
          margin: 0 auto;
        }

        .palette-swatch {
          animation: swatchReveal 0.5s ease-out forwards;
          animation-delay: var(--delay);
          opacity: 0;
          transform: translateY(20px);
        }

        @keyframes swatchReveal {
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        .swatch-color {
          aspect-ratio: 1;
          background: var(--swatch-color);
          border-radius: 8px;
          margin-bottom: 0.5rem;
          transition: transform 0.2s;
        }

        .palette-swatch:hover .swatch-color {
          transform: scale(1.1);
        }

        .swatch-info {
          text-align: center;
        }

        .swatch-name {
          display: block;
          font-size: 0.6875rem;
          font-weight: 500;
          color: white;
        }

        .swatch-code {
          display: block;
          font-size: 0.625rem;
          color: rgba(255, 255, 255, 0.5);
        }

        /* Benefits */
        .benefits {
          padding: 6rem 4rem;
          background: white;
        }

        .benefits-grid {
          display: grid;
          grid-template-columns: repeat(3, 1fr);
          gap: 3rem;
          max-width: 1000px;
          margin: 0 auto;
          text-align: center;
        }

        .benefit-metric {
          font-family: 'Space Grotesk', sans-serif;
          font-size: 4rem;
          font-weight: 700;
          color: var(--accent);
          line-height: 1;
        }

        .benefit-label {
          font-family: 'Space Grotesk', sans-serif;
          font-size: 1.125rem;
          font-weight: 600;
          color: var(--text);
          margin: 0.5rem 0 1rem;
        }

        .benefit p {
          font-size: 0.875rem;
          color: var(--text-secondary);
          line-height: 1.6;
          margin: 0;
        }

        /* CTA Footer */
        .cta-footer {
          padding: 6rem 4rem;
          background: var(--bg);
          text-align: center;
        }

        .cta-content h2 {
          font-family: 'Space Grotesk', sans-serif;
          font-size: 2.5rem;
          font-weight: 700;
          color: var(--text);
          margin: 0 0 1rem;
        }

        .cta-content > p {
          font-size: 1.125rem;
          color: var(--text-secondary);
          margin-bottom: 2rem;
        }

        .cta-note {
          margin-top: 1.5rem;
          font-size: 0.875rem;
          color: var(--text-light);
        }

        .cta-note a {
          color: var(--primary);
          text-decoration: none;
        }

        .cta-note a:hover {
          text-decoration: underline;
        }

        /* Modal */
        .modal-overlay {
          position: fixed;
          inset: 0;
          background: rgba(0, 0, 0, 0.5);
          backdrop-filter: blur(4px);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 2000;
          padding: 2rem;
        }

        .sign-in-modal {
          background: white;
          border-radius: 16px;
          padding: 2.5rem;
          width: 100%;
          max-width: 400px;
          position: relative;
          animation: modalSlide 0.3s ease-out;
        }

        @keyframes modalSlide {
          from {
            opacity: 0;
            transform: translateY(-20px);
          }
        }

        .modal-close {
          position: absolute;
          top: 1rem;
          right: 1rem;
          width: 32px;
          height: 32px;
          display: flex;
          align-items: center;
          justify-content: center;
          background: none;
          border: none;
          color: var(--text-light);
          cursor: pointer;
          border-radius: 6px;
          transition: all 0.2s;
        }

        .modal-close:hover {
          background: var(--bg);
          color: var(--text);
        }

        .modal-header {
          text-align: center;
          margin-bottom: 1.5rem;
        }

        .modal-header h2 {
          font-family: 'Space Grotesk', sans-serif;
          font-size: 1.5rem;
          font-weight: 600;
          margin: 0 0 0.25rem;
        }

        .modal-header p {
          font-size: 0.875rem;
          color: var(--text-secondary);
          margin: 0;
        }

        .form-error {
          padding: 0.75rem 1rem;
          background: #fef2f2;
          color: #dc2626;
          border-radius: 8px;
          font-size: 0.875rem;
          margin-bottom: 1rem;
        }

        .form-group {
          margin-bottom: 1rem;
        }

        .form-group label {
          display: block;
          font-size: 0.875rem;
          font-weight: 500;
          margin-bottom: 0.5rem;
        }

        .form-group input {
          width: 100%;
          padding: 0.75rem 1rem;
          border: 1px solid var(--border);
          border-radius: 8px;
          font-family: inherit;
          font-size: 0.9375rem;
          transition: all 0.2s;
        }

        .form-group input:focus {
          outline: none;
          border-color: var(--primary);
          box-shadow: 0 0 0 3px rgba(30, 74, 122, 0.1);
        }

        .submit-btn {
          width: 100%;
          padding: 0.875rem;
          background: var(--accent);
          color: white;
          border: none;
          border-radius: 8px;
          font-family: inherit;
          font-size: 0.9375rem;
          font-weight: 600;
          cursor: pointer;
          transition: all 0.2s;
        }

        .submit-btn:hover:not(:disabled) {
          background: var(--accent-hover);
        }

        .submit-btn:disabled {
          opacity: 0.6;
          cursor: not-allowed;
        }

        .modal-footer-text {
          text-align: center;
          font-size: 0.8125rem;
          color: var(--text-light);
          margin: 1.5rem 0 0;
        }

        /* Responsive */
        @media (max-width: 1024px) {
          .hero {
            grid-template-columns: 1fr;
            text-align: center;
          }

          .hero-content {
            max-width: 600px;
            margin: 0 auto;
          }

          .hero-subtitle {
            margin-left: auto;
            margin-right: auto;
          }

          .hero-ctas {
            justify-content: center;
          }

          .hero-visual {
            display: none;
          }

          .showcase-canvas {
            height: 240px;
          }

          .capability-pill {
            padding: 0.5rem 0.75rem;
            font-size: 0.75rem;
          }

          .features-grid {
            grid-template-columns: repeat(2, 1fr);
          }

          .unified-features {
            grid-template-columns: repeat(2, 1fr);
          }

          .feature-highlight {
            grid-column: span 2;
          }

          .benefits-grid-4 {
            grid-template-columns: repeat(2, 1fr);
          }

          .palette-grid {
            grid-template-columns: repeat(5, 1fr);
          }
        }

        @media (max-width: 768px) {
          .landing-nav {
            padding: 1rem 1.5rem;
          }

          .nav-links {
            gap: 1rem;
          }

          .hero {
            padding: 6rem 1.5rem 3rem;
          }

          .hero h1 {
            font-size: 2.5rem;
          }

          .steps-container {
            flex-direction: column;
            gap: 0;
          }

          .step-connector {
            display: none;
          }

          .features-grid,
          .unified-features {
            grid-template-columns: 1fr;
          }

          .feature-highlight {
            grid-column: span 1;
          }

          .section-header h2 {
            font-size: 2rem;
          }

          .how-it-works,
          .features,
          .palette-section,
          .benefits,
          .cta-footer,
          .unified-showcase {
            padding: 4rem 1.5rem;
          }

          .showcase-card {
            padding: 2rem 1.5rem;
          }

          .showcase-canvas {
            height: 200px;
          }

          .canvas-preview {
            width: 180px;
            height: 120px;
          }

          .capability-pill {
            display: none;
          }

          .showcase-features {
            flex-direction: column;
            gap: 1rem;
          }

          .showcase-tagline {
            font-size: 1.25rem;
          }

          .benefits-grid,
          .benefits-grid-4 {
            grid-template-columns: 1fr;
            gap: 2rem;
          }

          .palette-grid {
            grid-template-columns: repeat(4, 1fr);
          }
        }

        @media (max-width: 480px) {
          .nav-links button:not(.nav-cta) {
            display: none;
          }

          .hero h1 {
            font-size: 2rem;
          }

          .cta-content h2 {
            font-size: 1.75rem;
          }

          .palette-grid {
            grid-template-columns: repeat(3, 1fr);
          }
        }
      `})]})}function s7({user:e,onPasswordSet:t}){const[r,n]=A.useState(""),[i,s]=A.useState(""),[a,l]=A.useState(!1),[c,d]=A.useState(""),u=async f=>{if(f.preventDefault(),d(""),r.length<8){d("Password must be at least 8 characters long");return}if(!/[A-Z]/.test(r)){d("Password must contain at least one uppercase letter");return}if(!/[a-z]/.test(r)){d("Password must contain at least one lowercase letter");return}if(!/[0-9]/.test(r)){d("Password must contain at least one number");return}if(r!==i){d("Passwords do not match");return}l(!0);try{await Tn.updatePassword(r),t()}catch(h){d(h.message||"Failed to set password. Please try again.")}finally{l(!1)}};return o.jsx("div",{className:"tpv-studio",children:o.jsx("div",{className:"tpv-studio__container",style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh"},children:o.jsxs("div",{style:{maxWidth:"400px",width:"100%",padding:"2rem",background:"#fff",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[o.jsx("h2",{style:{marginBottom:"0.5rem",fontSize:"1.5rem"},children:"Welcome to TPV Studio"}),o.jsxs("p",{style:{marginBottom:"1.5rem",color:"#666",fontSize:"0.9rem"},children:["Please set a password for your account: ",o.jsx("strong",{children:e.email})]}),o.jsxs("form",{onSubmit:u,children:[o.jsxs("div",{style:{marginBottom:"1rem"},children:[o.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.9rem",fontWeight:"500"},children:"New Password"}),o.jsx("input",{type:"password",value:r,onChange:f=>n(f.target.value),placeholder:"Enter your password",required:!0,minLength:8,style:{width:"100%",padding:"0.75rem",border:"1px solid #ddd",borderRadius:"4px",fontSize:"1rem"}}),o.jsx("small",{style:{display:"block",marginTop:"0.25rem",color:"#666"},children:"At least 8 characters with uppercase, lowercase, and a number"})]}),o.jsxs("div",{style:{marginBottom:"1.5rem"},children:[o.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.9rem",fontWeight:"500"},children:"Confirm Password"}),o.jsx("input",{type:"password",value:i,onChange:f=>s(f.target.value),placeholder:"Confirm your password",required:!0,minLength:8,style:{width:"100%",padding:"0.75rem",border:"1px solid #ddd",borderRadius:"4px",fontSize:"1rem"}})]}),c&&o.jsx("div",{style:{padding:"0.75rem",marginBottom:"1rem",background:"#fee",border:"1px solid #fcc",borderRadius:"4px",color:"#c00",fontSize:"0.9rem"},children:c}),o.jsx("button",{type:"submit",disabled:a,style:{width:"100%",padding:"0.75rem",background:a?"#ccc":"#007bff",color:"#fff",border:"none",borderRadius:"4px",fontSize:"1rem",fontWeight:"500",cursor:a?"not-allowed":"pointer"},children:a?"Setting Password...":"Set Password"})]})]})})})}function o7(){const[e,t]=A.useState(null),[r,n]=A.useState(!0),[i,s]=A.useState(!1),[a,l]=A.useState(!1),[c,d]=A.useState(!1),[u,f]=A.useState(!1),[h,p]=A.useState(null),[g,m]=A.useState(null),x=async()=>{try{const w=await Tn.getSession();if(!(w!=null&&w.access_token)){d(!1);return}const j=await fetch("/api/admin/users",{headers:{Authorization:`Bearer ${w.access_token}`}});d(j.ok)}catch{console.error("[APP] Admin check failed"),d(!1)}},v=async w=>{try{console.log("[APP] Loading design from URL:",w);const{design:j}=await ll(w);if(j){y(j);const _=new URL(window.location);_.searchParams.delete("design"),window.history.replaceState({},"",_)}}catch(j){console.error("[APP] Failed to load design from URL:",j)}};A.useEffect(()=>{Tn.getSession().then(j=>{var E;const _=(j==null?void 0:j.user)||null;if(t(_),n(!1),_){const N=(E=_.user_metadata)==null?void 0:E.password_setup_complete;f(!N),x();const I=new URLSearchParams(window.location.search).get("design");I&&v(I)}});const{data:w}=Tn.onAuthStateChange((j,_)=>{var N;const E=(_==null?void 0:_.user)||null;if(t(E),E){const O=(N=E.user_metadata)==null?void 0:N.password_setup_complete;f(!O),x()}else d(!1),f(!1)});return()=>w==null?void 0:w.unsubscribe()},[]);const y=w=>{p(w),m(w.name)},b=async()=>{f(!1);const w=await Tn.getSession();t((w==null?void 0:w.user)||null)};return r?o.jsx("div",{className:"tpv-studio",children:o.jsx("div",{className:"tpv-studio__container",children:o.jsxs("div",{className:"tpv-studio__empty",children:[o.jsx("div",{className:"tpv-studio__spinner"}),o.jsx("p",{children:"Loading..."})]})})}):e?u?o.jsx(s7,{user:e,onPasswordSet:b}):a?o.jsx("div",{className:"tpv-studio",children:o.jsx(ZH,{onClose:()=>l(!1)})}):o.jsx(Yj,{children:o.jsxs("div",{className:"tpv-studio",children:[o.jsx(VH,{onShowDesigns:()=>s(!0),onShowAdmin:()=>l(!0),isAdmin:c,currentDesignName:g}),o.jsx("main",{className:"tpv-studio__container tpv-studio__container--full",children:o.jsx(GH,{loadedDesign:h})}),i&&o.jsx(YH,{onClose:()=>s(!1),onLoadDesign:y})]})}):o.jsx(i7,{})}Iu.createRoot(document.getElementById("root")).render(o.jsx(D.StrictMode,{children:o.jsx(o7,{})}))});export default a7();
//# sourceMappingURL=index-Uvg-ZktS.js.map
