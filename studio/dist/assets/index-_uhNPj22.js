var g_=Object.defineProperty;var v_=(t,e,r)=>e in t?g_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var y_=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var ym=(t,e,r)=>v_(t,typeof e!="symbol"?e+"":e,r);var XH=y_((Mr,$r)=>{function x_(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var Si=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function id(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function b_(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}),r}var gy={exports:{}},sd={},vy={exports:{}},ot={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nl=Symbol.for("react.element"),w_=Symbol.for("react.portal"),__=Symbol.for("react.fragment"),S_=Symbol.for("react.strict_mode"),k_=Symbol.for("react.profiler"),j_=Symbol.for("react.provider"),C_=Symbol.for("react.context"),E_=Symbol.for("react.forward_ref"),T_=Symbol.for("react.suspense"),N_=Symbol.for("react.memo"),R_=Symbol.for("react.lazy"),xm=Symbol.iterator;function P_(t){return t===null||typeof t!="object"?null:(t=xm&&t[xm]||t["@@iterator"],typeof t=="function"?t:null)}var yy={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},xy=Object.assign,by={};function $o(t,e,r){this.props=t,this.context=e,this.refs=by,this.updater=r||yy}$o.prototype.isReactComponent={};$o.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};$o.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function wy(){}wy.prototype=$o.prototype;function pf(t,e,r){this.props=t,this.context=e,this.refs=by,this.updater=r||yy}var mf=pf.prototype=new wy;mf.constructor=pf;xy(mf,$o.prototype);mf.isPureReactComponent=!0;var bm=Array.isArray,_y=Object.prototype.hasOwnProperty,gf={current:null},Sy={key:!0,ref:!0,__self:!0,__source:!0};function ky(t,e,r){var n,i={},s=null,o=null;if(e!=null)for(n in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)_y.call(e,n)&&!Sy.hasOwnProperty(n)&&(i[n]=e[n]);var l=arguments.length-2;if(l===1)i.children=r;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];i.children=c}if(t&&t.defaultProps)for(n in l=t.defaultProps,l)i[n]===void 0&&(i[n]=l[n]);return{$$typeof:nl,type:t,key:s,ref:o,props:i,_owner:gf.current}}function O_(t,e){return{$$typeof:nl,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function vf(t){return typeof t=="object"&&t!==null&&t.$$typeof===nl}function A_(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var wm=/\/+/g;function Bd(t,e){return typeof t=="object"&&t!==null&&t.key!=null?A_(""+t.key):e.toString(36)}function rc(t,e,r,n,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case nl:case w_:o=!0}}if(o)return o=t,i=i(o),t=n===""?"."+Bd(o,0):n,bm(i)?(r="",t!=null&&(r=t.replace(wm,"$&/")+"/"),rc(i,e,r,"",function(d){return d})):i!=null&&(vf(i)&&(i=O_(i,r+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(wm,"$&/")+"/")+t)),e.push(i)),1;if(o=0,n=n===""?".":n+":",bm(t))for(var l=0;l<t.length;l++){s=t[l];var c=n+Bd(s,l);o+=rc(s,e,r,c,i)}else if(c=P_(t),typeof c=="function")for(t=c.call(t),l=0;!(s=t.next()).done;)s=s.value,c=n+Bd(s,l++),o+=rc(s,e,r,c,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function bl(t,e,r){if(t==null)return t;var n=[],i=0;return rc(t,n,"","",function(s){return e.call(r,s,i++)}),n}function M_(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var fr={current:null},nc={transition:null},$_={ReactCurrentDispatcher:fr,ReactCurrentBatchConfig:nc,ReactCurrentOwner:gf};function jy(){throw Error("act(...) is not supported in production builds of React.")}ot.Children={map:bl,forEach:function(t,e,r){bl(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return bl(t,function(){e++}),e},toArray:function(t){return bl(t,function(e){return e})||[]},only:function(t){if(!vf(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ot.Component=$o;ot.Fragment=__;ot.Profiler=k_;ot.PureComponent=pf;ot.StrictMode=S_;ot.Suspense=T_;ot.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$_;ot.act=jy;ot.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=xy({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=gf.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)_y.call(e,c)&&!Sy.hasOwnProperty(c)&&(n[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];n.children=l}return{$$typeof:nl,type:t.type,key:i,ref:s,props:n,_owner:o}};ot.createContext=function(t){return t={$$typeof:C_,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:j_,_context:t},t.Consumer=t};ot.createElement=ky;ot.createFactory=function(t){var e=ky.bind(null,t);return e.type=t,e};ot.createRef=function(){return{current:null}};ot.forwardRef=function(t){return{$$typeof:E_,render:t}};ot.isValidElement=vf;ot.lazy=function(t){return{$$typeof:R_,_payload:{_status:-1,_result:t},_init:M_}};ot.memo=function(t,e){return{$$typeof:N_,type:t,compare:e===void 0?null:e}};ot.startTransition=function(t){var e=nc.transition;nc.transition={};try{t()}finally{nc.transition=e}};ot.unstable_act=jy;ot.useCallback=function(t,e){return fr.current.useCallback(t,e)};ot.useContext=function(t){return fr.current.useContext(t)};ot.useDebugValue=function(){};ot.useDeferredValue=function(t){return fr.current.useDeferredValue(t)};ot.useEffect=function(t,e){return fr.current.useEffect(t,e)};ot.useId=function(){return fr.current.useId()};ot.useImperativeHandle=function(t,e,r){return fr.current.useImperativeHandle(t,e,r)};ot.useInsertionEffect=function(t,e){return fr.current.useInsertionEffect(t,e)};ot.useLayoutEffect=function(t,e){return fr.current.useLayoutEffect(t,e)};ot.useMemo=function(t,e){return fr.current.useMemo(t,e)};ot.useReducer=function(t,e,r){return fr.current.useReducer(t,e,r)};ot.useRef=function(t){return fr.current.useRef(t)};ot.useState=function(t){return fr.current.useState(t)};ot.useSyncExternalStore=function(t,e,r){return fr.current.useSyncExternalStore(t,e,r)};ot.useTransition=function(){return fr.current.useTransition()};ot.version="18.3.1";vy.exports=ot;var P=vy.exports;const $=id(P);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var L_=P,I_=Symbol.for("react.element"),D_=Symbol.for("react.fragment"),z_=Object.prototype.hasOwnProperty,F_=L_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,B_={key:!0,ref:!0,__self:!0,__source:!0};function Cy(t,e,r){var n,i={},s=null,o=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)z_.call(e,n)&&!B_.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:I_,type:t,key:s,ref:o,props:i,_owner:F_.current}}sd.Fragment=D_;sd.jsx=Cy;sd.jsxs=Cy;gy.exports=sd;var a=gy.exports,qu={},Ey={exports:{}},zr={},Ty={exports:{}},Ny={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(I,L){var Z=I.length;I.push(L);e:for(;0<Z;){var H=Z-1>>>1,G=I[H];if(0<i(G,L))I[H]=L,I[Z]=G,Z=H;else break e}}function r(I){return I.length===0?null:I[0]}function n(I){if(I.length===0)return null;var L=I[0],Z=I.pop();if(Z!==L){I[0]=Z;e:for(var H=0,G=I.length,ee=G>>>1;H<ee;){var oe=2*(H+1)-1,fe=I[oe],Oe=oe+1,$e=I[Oe];if(0>i(fe,Z))Oe<G&&0>i($e,fe)?(I[H]=$e,I[Oe]=Z,H=Oe):(I[H]=fe,I[oe]=Z,H=oe);else if(Oe<G&&0>i($e,Z))I[H]=$e,I[Oe]=Z,H=Oe;else break e}}return L}function i(I,L){var Z=I.sortIndex-L.sortIndex;return Z!==0?Z:I.id-L.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],d=[],u=1,f=null,h=3,p=!1,g=!1,m=!1,x=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(I){for(var L=r(d);L!==null;){if(L.callback===null)n(d);else if(L.startTime<=I)n(d),L.sortIndex=L.expirationTime,e(c,L);else break;L=r(d)}}function w(I){if(m=!1,b(I),!g)if(r(c)!==null)g=!0,le(k);else{var L=r(d);L!==null&&D(w,L.startTime-I)}}function k(I,L){g=!1,m&&(m=!1,v(N),N=-1),p=!0;var Z=h;try{for(b(L),f=r(c);f!==null&&(!(f.expirationTime>L)||I&&!X());){var H=f.callback;if(typeof H=="function"){f.callback=null,h=f.priorityLevel;var G=H(f.expirationTime<=L);L=t.unstable_now(),typeof G=="function"?f.callback=G:f===r(c)&&n(c),b(L)}else n(c);f=r(c)}if(f!==null)var ee=!0;else{var oe=r(d);oe!==null&&D(w,oe.startTime-L),ee=!1}return ee}finally{f=null,h=Z,p=!1}}var _=!1,C=null,N=-1,T=5,O=-1;function X(){return!(t.unstable_now()-O<T)}function E(){if(C!==null){var I=t.unstable_now();O=I;var L=!0;try{L=C(!0,I)}finally{L?F():(_=!1,C=null)}}else _=!1}var F;if(typeof y=="function")F=function(){y(E)};else if(typeof MessageChannel<"u"){var S=new MessageChannel,K=S.port2;S.port1.onmessage=E,F=function(){K.postMessage(null)}}else F=function(){x(E,0)};function le(I){C=I,_||(_=!0,F())}function D(I,L){N=x(function(){I(t.unstable_now())},L)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(I){I.callback=null},t.unstable_continueExecution=function(){g||p||(g=!0,le(k))},t.unstable_forceFrameRate=function(I){0>I||125<I?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<I?Math.floor(1e3/I):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(I){switch(h){case 1:case 2:case 3:var L=3;break;default:L=h}var Z=h;h=L;try{return I()}finally{h=Z}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(I,L){switch(I){case 1:case 2:case 3:case 4:case 5:break;default:I=3}var Z=h;h=I;try{return L()}finally{h=Z}},t.unstable_scheduleCallback=function(I,L,Z){var H=t.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?H+Z:H):Z=H,I){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=Z+G,I={id:u++,callback:L,priorityLevel:I,startTime:Z,expirationTime:G,sortIndex:-1},Z>H?(I.sortIndex=Z,e(d,I),r(c)===null&&I===r(d)&&(m?(v(N),N=-1):m=!0,D(w,Z-H))):(I.sortIndex=G,e(c,I),g||p||(g=!0,le(k))),I},t.unstable_shouldYield=X,t.unstable_wrapCallback=function(I){var L=h;return function(){var Z=h;h=L;try{return I.apply(this,arguments)}finally{h=Z}}}})(Ny);Ty.exports=Ny;var H_=Ty.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var U_=P,Ir=H_;function je(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Ry=new Set,Ma={};function ms(t,e){Eo(t,e),Eo(t+"Capture",e)}function Eo(t,e){for(Ma[t]=e,t=0;t<e.length;t++)Ry.add(e[t])}var ti=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Yu=Object.prototype.hasOwnProperty,W_=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,_m={},Sm={};function G_(t){return Yu.call(Sm,t)?!0:Yu.call(_m,t)?!1:W_.test(t)?Sm[t]=!0:(_m[t]=!0,!1)}function V_(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function q_(t,e,r,n){if(e===null||typeof e>"u"||V_(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function pr(t,e,r,n,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var er={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){er[t]=new pr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];er[e]=new pr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){er[t]=new pr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){er[t]=new pr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){er[t]=new pr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){er[t]=new pr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){er[t]=new pr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){er[t]=new pr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){er[t]=new pr(t,5,!1,t.toLowerCase(),null,!1,!1)});var yf=/[\-:]([a-z])/g;function xf(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(yf,xf);er[e]=new pr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(yf,xf);er[e]=new pr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(yf,xf);er[e]=new pr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){er[t]=new pr(t,1,!1,t.toLowerCase(),null,!1,!1)});er.xlinkHref=new pr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){er[t]=new pr(t,1,!1,t.toLowerCase(),null,!0,!0)});function bf(t,e,r,n){var i=er.hasOwnProperty(e)?er[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(q_(e,r,i,n)&&(r=null),n||i===null?G_(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var si=U_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,wl=Symbol.for("react.element"),io=Symbol.for("react.portal"),so=Symbol.for("react.fragment"),wf=Symbol.for("react.strict_mode"),Xu=Symbol.for("react.profiler"),Py=Symbol.for("react.provider"),Oy=Symbol.for("react.context"),_f=Symbol.for("react.forward_ref"),Ku=Symbol.for("react.suspense"),Zu=Symbol.for("react.suspense_list"),Sf=Symbol.for("react.memo"),mi=Symbol.for("react.lazy"),Ay=Symbol.for("react.offscreen"),km=Symbol.iterator;function Qo(t){return t===null||typeof t!="object"?null:(t=km&&t[km]||t["@@iterator"],typeof t=="function"?t:null)}var At=Object.assign,Hd;function fa(t){if(Hd===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);Hd=e&&e[1]||""}return`
`+Hd+t}var Ud=!1;function Wd(t,e){if(!t||Ud)return"";Ud=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var n=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){n=d}t.call(e.prototype)}else{try{throw Error()}catch(d){n=d}t()}}catch(d){if(d&&n&&typeof d.stack=="string"){for(var i=d.stack.split(`
`),s=n.stack.split(`
`),o=i.length-1,l=s.length-1;1<=o&&0<=l&&i[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==s[l]){var c=`
`+i[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{Ud=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?fa(t):""}function Y_(t){switch(t.tag){case 5:return fa(t.type);case 16:return fa("Lazy");case 13:return fa("Suspense");case 19:return fa("SuspenseList");case 0:case 2:case 15:return t=Wd(t.type,!1),t;case 11:return t=Wd(t.type.render,!1),t;case 1:return t=Wd(t.type,!0),t;default:return""}}function Ju(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case so:return"Fragment";case io:return"Portal";case Xu:return"Profiler";case wf:return"StrictMode";case Ku:return"Suspense";case Zu:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Oy:return(t.displayName||"Context")+".Consumer";case Py:return(t._context.displayName||"Context")+".Provider";case _f:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Sf:return e=t.displayName||null,e!==null?e:Ju(t.type)||"Memo";case mi:e=t._payload,t=t._init;try{return Ju(t(e))}catch{}}return null}function X_(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ju(e);case 8:return e===wf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Mi(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function My(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function K_(t){var e=My(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function _l(t){t._valueTracker||(t._valueTracker=K_(t))}function $y(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=My(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function mc(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Qu(t,e){var r=e.checked;return At({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function jm(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=Mi(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Ly(t,e){e=e.checked,e!=null&&bf(t,"checked",e,!1)}function eh(t,e){Ly(t,e);var r=Mi(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?th(t,e.type,r):e.hasOwnProperty("defaultValue")&&th(t,e.type,Mi(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Cm(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function th(t,e,r){(e!=="number"||mc(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var pa=Array.isArray;function xo(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Mi(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function rh(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(je(91));return At({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Em(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(je(92));if(pa(r)){if(1<r.length)throw Error(je(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Mi(r)}}function Iy(t,e){var r=Mi(e.value),n=Mi(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function Tm(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Dy(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function nh(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Dy(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Sl,zy=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Sl=Sl||document.createElement("div"),Sl.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Sl.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function $a(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var wa={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Z_=["Webkit","ms","Moz","O"];Object.keys(wa).forEach(function(t){Z_.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),wa[e]=wa[t]})});function Fy(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||wa.hasOwnProperty(t)&&wa[t]?(""+e).trim():e+"px"}function By(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=Fy(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var J_=At({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ih(t,e){if(e){if(J_[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(je(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(je(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(je(61))}if(e.style!=null&&typeof e.style!="object")throw Error(je(62))}}function sh(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var oh=null;function kf(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var ah=null,bo=null,wo=null;function Nm(t){if(t=ol(t)){if(typeof ah!="function")throw Error(je(280));var e=t.stateNode;e&&(e=dd(e),ah(t.stateNode,t.type,e))}}function Hy(t){bo?wo?wo.push(t):wo=[t]:bo=t}function Uy(){if(bo){var t=bo,e=wo;if(wo=bo=null,Nm(t),e)for(t=0;t<e.length;t++)Nm(e[t])}}function Wy(t,e){return t(e)}function Gy(){}var Gd=!1;function Vy(t,e,r){if(Gd)return t(e,r);Gd=!0;try{return Wy(t,e,r)}finally{Gd=!1,(bo!==null||wo!==null)&&(Gy(),Uy())}}function La(t,e){var r=t.stateNode;if(r===null)return null;var n=dd(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(je(231,e,typeof r));return r}var lh=!1;if(ti)try{var ea={};Object.defineProperty(ea,"passive",{get:function(){lh=!0}}),window.addEventListener("test",ea,ea),window.removeEventListener("test",ea,ea)}catch{lh=!1}function Q_(t,e,r,n,i,s,o,l,c){var d=Array.prototype.slice.call(arguments,3);try{e.apply(r,d)}catch(u){this.onError(u)}}var _a=!1,gc=null,vc=!1,ch=null,e2={onError:function(t){_a=!0,gc=t}};function t2(t,e,r,n,i,s,o,l,c){_a=!1,gc=null,Q_.apply(e2,arguments)}function r2(t,e,r,n,i,s,o,l,c){if(t2.apply(this,arguments),_a){if(_a){var d=gc;_a=!1,gc=null}else throw Error(je(198));vc||(vc=!0,ch=d)}}function gs(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function qy(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Rm(t){if(gs(t)!==t)throw Error(je(188))}function n2(t){var e=t.alternate;if(!e){if(e=gs(t),e===null)throw Error(je(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return Rm(i),t;if(s===n)return Rm(i),e;s=s.sibling}throw Error(je(188))}if(r.return!==n.return)r=i,n=s;else{for(var o=!1,l=i.child;l;){if(l===r){o=!0,r=i,n=s;break}if(l===n){o=!0,n=i,r=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===r){o=!0,r=s,n=i;break}if(l===n){o=!0,n=s,r=i;break}l=l.sibling}if(!o)throw Error(je(189))}}if(r.alternate!==n)throw Error(je(190))}if(r.tag!==3)throw Error(je(188));return r.stateNode.current===r?t:e}function Yy(t){return t=n2(t),t!==null?Xy(t):null}function Xy(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Xy(t);if(e!==null)return e;t=t.sibling}return null}var Ky=Ir.unstable_scheduleCallback,Pm=Ir.unstable_cancelCallback,i2=Ir.unstable_shouldYield,s2=Ir.unstable_requestPaint,It=Ir.unstable_now,o2=Ir.unstable_getCurrentPriorityLevel,jf=Ir.unstable_ImmediatePriority,Zy=Ir.unstable_UserBlockingPriority,yc=Ir.unstable_NormalPriority,a2=Ir.unstable_LowPriority,Jy=Ir.unstable_IdlePriority,od=null,An=null;function l2(t){if(An&&typeof An.onCommitFiberRoot=="function")try{An.onCommitFiberRoot(od,t,void 0,(t.current.flags&128)===128)}catch{}}var pn=Math.clz32?Math.clz32:u2,c2=Math.log,d2=Math.LN2;function u2(t){return t>>>=0,t===0?32:31-(c2(t)/d2|0)|0}var kl=64,jl=4194304;function ma(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function xc(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,s=t.pingedLanes,o=r&268435455;if(o!==0){var l=o&~i;l!==0?n=ma(l):(s&=o,s!==0&&(n=ma(s)))}else o=r&~i,o!==0?n=ma(o):s!==0&&(n=ma(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-pn(e),i=1<<r,n|=t[r],e&=~i;return n}function h2(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function f2(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-pn(s),l=1<<o,c=i[o];c===-1?(!(l&r)||l&n)&&(i[o]=h2(l,e)):c<=e&&(t.expiredLanes|=l),s&=~l}}function dh(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Qy(){var t=kl;return kl<<=1,!(kl&4194240)&&(kl=64),t}function Vd(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function il(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-pn(e),t[e]=r}function p2(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-pn(r),s=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~s}}function Cf(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-pn(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var yt=0;function ex(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var tx,Ef,rx,nx,ix,uh=!1,Cl=[],Ci=null,Ei=null,Ti=null,Ia=new Map,Da=new Map,xi=[],m2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Om(t,e){switch(t){case"focusin":case"focusout":Ci=null;break;case"dragenter":case"dragleave":Ei=null;break;case"mouseover":case"mouseout":Ti=null;break;case"pointerover":case"pointerout":Ia.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Da.delete(e.pointerId)}}function ta(t,e,r,n,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},e!==null&&(e=ol(e),e!==null&&Ef(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function g2(t,e,r,n,i){switch(e){case"focusin":return Ci=ta(Ci,t,e,r,n,i),!0;case"dragenter":return Ei=ta(Ei,t,e,r,n,i),!0;case"mouseover":return Ti=ta(Ti,t,e,r,n,i),!0;case"pointerover":var s=i.pointerId;return Ia.set(s,ta(Ia.get(s)||null,t,e,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,Da.set(s,ta(Da.get(s)||null,t,e,r,n,i)),!0}return!1}function sx(t){var e=ts(t.target);if(e!==null){var r=gs(e);if(r!==null){if(e=r.tag,e===13){if(e=qy(r),e!==null){t.blockedOn=e,ix(t.priority,function(){rx(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ic(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=hh(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);oh=n,r.target.dispatchEvent(n),oh=null}else return e=ol(r),e!==null&&Ef(e),t.blockedOn=r,!1;e.shift()}return!0}function Am(t,e,r){ic(t)&&r.delete(e)}function v2(){uh=!1,Ci!==null&&ic(Ci)&&(Ci=null),Ei!==null&&ic(Ei)&&(Ei=null),Ti!==null&&ic(Ti)&&(Ti=null),Ia.forEach(Am),Da.forEach(Am)}function ra(t,e){t.blockedOn===e&&(t.blockedOn=null,uh||(uh=!0,Ir.unstable_scheduleCallback(Ir.unstable_NormalPriority,v2)))}function za(t){function e(i){return ra(i,t)}if(0<Cl.length){ra(Cl[0],t);for(var r=1;r<Cl.length;r++){var n=Cl[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Ci!==null&&ra(Ci,t),Ei!==null&&ra(Ei,t),Ti!==null&&ra(Ti,t),Ia.forEach(e),Da.forEach(e),r=0;r<xi.length;r++)n=xi[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<xi.length&&(r=xi[0],r.blockedOn===null);)sx(r),r.blockedOn===null&&xi.shift()}var _o=si.ReactCurrentBatchConfig,bc=!0;function y2(t,e,r,n){var i=yt,s=_o.transition;_o.transition=null;try{yt=1,Tf(t,e,r,n)}finally{yt=i,_o.transition=s}}function x2(t,e,r,n){var i=yt,s=_o.transition;_o.transition=null;try{yt=4,Tf(t,e,r,n)}finally{yt=i,_o.transition=s}}function Tf(t,e,r,n){if(bc){var i=hh(t,e,r,n);if(i===null)ru(t,e,n,wc,r),Om(t,n);else if(g2(i,t,e,r,n))n.stopPropagation();else if(Om(t,n),e&4&&-1<m2.indexOf(t)){for(;i!==null;){var s=ol(i);if(s!==null&&tx(s),s=hh(t,e,r,n),s===null&&ru(t,e,n,wc,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else ru(t,e,n,null,r)}}var wc=null;function hh(t,e,r,n){if(wc=null,t=kf(n),t=ts(t),t!==null)if(e=gs(t),e===null)t=null;else if(r=e.tag,r===13){if(t=qy(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return wc=t,null}function ox(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(o2()){case jf:return 1;case Zy:return 4;case yc:case a2:return 16;case Jy:return 536870912;default:return 16}default:return 16}}var ki=null,Nf=null,sc=null;function ax(){if(sc)return sc;var t,e=Nf,r=e.length,n,i="value"in ki?ki.value:ki.textContent,s=i.length;for(t=0;t<r&&e[t]===i[t];t++);var o=r-t;for(n=1;n<=o&&e[r-n]===i[s-n];n++);return sc=i.slice(t,1<n?1-n:void 0)}function oc(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function El(){return!0}function Mm(){return!1}function Fr(t){function e(r,n,i,s,o){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(r=t[l],this[l]=r?r(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?El:Mm,this.isPropagationStopped=Mm,this}return At(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=El)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=El)},persist:function(){},isPersistent:El}),e}var Lo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Rf=Fr(Lo),sl=At({},Lo,{view:0,detail:0}),b2=Fr(sl),qd,Yd,na,ad=At({},sl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Pf,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==na&&(na&&t.type==="mousemove"?(qd=t.screenX-na.screenX,Yd=t.screenY-na.screenY):Yd=qd=0,na=t),qd)},movementY:function(t){return"movementY"in t?t.movementY:Yd}}),$m=Fr(ad),w2=At({},ad,{dataTransfer:0}),_2=Fr(w2),S2=At({},sl,{relatedTarget:0}),Xd=Fr(S2),k2=At({},Lo,{animationName:0,elapsedTime:0,pseudoElement:0}),j2=Fr(k2),C2=At({},Lo,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),E2=Fr(C2),T2=At({},Lo,{data:0}),Lm=Fr(T2),N2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},R2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},P2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function O2(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=P2[t])?!!e[t]:!1}function Pf(){return O2}var A2=At({},sl,{key:function(t){if(t.key){var e=N2[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=oc(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?R2[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Pf,charCode:function(t){return t.type==="keypress"?oc(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?oc(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),M2=Fr(A2),$2=At({},ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Im=Fr($2),L2=At({},sl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Pf}),I2=Fr(L2),D2=At({},Lo,{propertyName:0,elapsedTime:0,pseudoElement:0}),z2=Fr(D2),F2=At({},ad,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),B2=Fr(F2),H2=[9,13,27,32],Of=ti&&"CompositionEvent"in window,Sa=null;ti&&"documentMode"in document&&(Sa=document.documentMode);var U2=ti&&"TextEvent"in window&&!Sa,lx=ti&&(!Of||Sa&&8<Sa&&11>=Sa),Dm=" ",zm=!1;function cx(t,e){switch(t){case"keyup":return H2.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function dx(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var oo=!1;function W2(t,e){switch(t){case"compositionend":return dx(e);case"keypress":return e.which!==32?null:(zm=!0,Dm);case"textInput":return t=e.data,t===Dm&&zm?null:t;default:return null}}function G2(t,e){if(oo)return t==="compositionend"||!Of&&cx(t,e)?(t=ax(),sc=Nf=ki=null,oo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return lx&&e.locale!=="ko"?null:e.data;default:return null}}var V2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Fm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!V2[t.type]:e==="textarea"}function ux(t,e,r,n){Hy(n),e=_c(e,"onChange"),0<e.length&&(r=new Rf("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var ka=null,Fa=null;function q2(t){_x(t,0)}function ld(t){var e=co(t);if($y(e))return t}function Y2(t,e){if(t==="change")return e}var hx=!1;if(ti){var Kd;if(ti){var Zd="oninput"in document;if(!Zd){var Bm=document.createElement("div");Bm.setAttribute("oninput","return;"),Zd=typeof Bm.oninput=="function"}Kd=Zd}else Kd=!1;hx=Kd&&(!document.documentMode||9<document.documentMode)}function Hm(){ka&&(ka.detachEvent("onpropertychange",fx),Fa=ka=null)}function fx(t){if(t.propertyName==="value"&&ld(Fa)){var e=[];ux(e,Fa,t,kf(t)),Vy(q2,e)}}function X2(t,e,r){t==="focusin"?(Hm(),ka=e,Fa=r,ka.attachEvent("onpropertychange",fx)):t==="focusout"&&Hm()}function K2(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return ld(Fa)}function Z2(t,e){if(t==="click")return ld(e)}function J2(t,e){if(t==="input"||t==="change")return ld(e)}function Q2(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var gn=typeof Object.is=="function"?Object.is:Q2;function Ba(t,e){if(gn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!Yu.call(e,i)||!gn(t[i],e[i]))return!1}return!0}function Um(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Wm(t,e){var r=Um(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Um(r)}}function px(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?px(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function mx(){for(var t=window,e=mc();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=mc(t.document)}return e}function Af(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function eS(t){var e=mx(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&px(r.ownerDocument.documentElement,r)){if(n!==null&&Af(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!t.extend&&s>n&&(i=n,n=s,s=i),i=Wm(r,s);var o=Wm(r,n);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var tS=ti&&"documentMode"in document&&11>=document.documentMode,ao=null,fh=null,ja=null,ph=!1;function Gm(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;ph||ao==null||ao!==mc(n)||(n=ao,"selectionStart"in n&&Af(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),ja&&Ba(ja,n)||(ja=n,n=_c(fh,"onSelect"),0<n.length&&(e=new Rf("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=ao)))}function Tl(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var lo={animationend:Tl("Animation","AnimationEnd"),animationiteration:Tl("Animation","AnimationIteration"),animationstart:Tl("Animation","AnimationStart"),transitionend:Tl("Transition","TransitionEnd")},Jd={},gx={};ti&&(gx=document.createElement("div").style,"AnimationEvent"in window||(delete lo.animationend.animation,delete lo.animationiteration.animation,delete lo.animationstart.animation),"TransitionEvent"in window||delete lo.transitionend.transition);function cd(t){if(Jd[t])return Jd[t];if(!lo[t])return t;var e=lo[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in gx)return Jd[t]=e[r];return t}var vx=cd("animationend"),yx=cd("animationiteration"),xx=cd("animationstart"),bx=cd("transitionend"),wx=new Map,Vm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Di(t,e){wx.set(t,e),ms(e,[t])}for(var Qd=0;Qd<Vm.length;Qd++){var eu=Vm[Qd],rS=eu.toLowerCase(),nS=eu[0].toUpperCase()+eu.slice(1);Di(rS,"on"+nS)}Di(vx,"onAnimationEnd");Di(yx,"onAnimationIteration");Di(xx,"onAnimationStart");Di("dblclick","onDoubleClick");Di("focusin","onFocus");Di("focusout","onBlur");Di(bx,"onTransitionEnd");Eo("onMouseEnter",["mouseout","mouseover"]);Eo("onMouseLeave",["mouseout","mouseover"]);Eo("onPointerEnter",["pointerout","pointerover"]);Eo("onPointerLeave",["pointerout","pointerover"]);ms("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ms("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ms("onBeforeInput",["compositionend","keypress","textInput","paste"]);ms("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ms("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ms("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ga="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),iS=new Set("cancel close invalid load scroll toggle".split(" ").concat(ga));function qm(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,r2(n,e,void 0,t),t.currentTarget=null}function _x(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==s&&i.isPropagationStopped())break e;qm(i,l,d),s=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,d=l.currentTarget,l=l.listener,c!==s&&i.isPropagationStopped())break e;qm(i,l,d),s=c}}}if(vc)throw t=ch,vc=!1,ch=null,t}function St(t,e){var r=e[xh];r===void 0&&(r=e[xh]=new Set);var n=t+"__bubble";r.has(n)||(Sx(e,t,2,!1),r.add(n))}function tu(t,e,r){var n=0;e&&(n|=4),Sx(r,t,n,e)}var Nl="_reactListening"+Math.random().toString(36).slice(2);function Ha(t){if(!t[Nl]){t[Nl]=!0,Ry.forEach(function(r){r!=="selectionchange"&&(iS.has(r)||tu(r,!1,t),tu(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Nl]||(e[Nl]=!0,tu("selectionchange",!1,e))}}function Sx(t,e,r,n){switch(ox(e)){case 1:var i=y2;break;case 4:i=x2;break;default:i=Tf}r=i.bind(null,e,r,t),i=void 0,!lh||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function ru(t,e,r,n,i){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;l!==null;){if(o=ts(l),o===null)return;if(c=o.tag,c===5||c===6){n=s=o;continue e}l=l.parentNode}}n=n.return}Vy(function(){var d=s,u=kf(r),f=[];e:{var h=wx.get(t);if(h!==void 0){var p=Rf,g=t;switch(t){case"keypress":if(oc(r)===0)break e;case"keydown":case"keyup":p=M2;break;case"focusin":g="focus",p=Xd;break;case"focusout":g="blur",p=Xd;break;case"beforeblur":case"afterblur":p=Xd;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=$m;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=_2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=I2;break;case vx:case yx:case xx:p=j2;break;case bx:p=z2;break;case"scroll":p=b2;break;case"wheel":p=B2;break;case"copy":case"cut":case"paste":p=E2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Im}var m=(e&4)!==0,x=!m&&t==="scroll",v=m?h!==null?h+"Capture":null:h;m=[];for(var y=d,b;y!==null;){b=y;var w=b.stateNode;if(b.tag===5&&w!==null&&(b=w,v!==null&&(w=La(y,v),w!=null&&m.push(Ua(y,w,b)))),x)break;y=y.return}0<m.length&&(h=new p(h,g,null,r,u),f.push({event:h,listeners:m}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",h&&r!==oh&&(g=r.relatedTarget||r.fromElement)&&(ts(g)||g[ri]))break e;if((p||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,p?(g=r.relatedTarget||r.toElement,p=d,g=g?ts(g):null,g!==null&&(x=gs(g),g!==x||g.tag!==5&&g.tag!==6)&&(g=null)):(p=null,g=d),p!==g)){if(m=$m,w="onMouseLeave",v="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(m=Im,w="onPointerLeave",v="onPointerEnter",y="pointer"),x=p==null?h:co(p),b=g==null?h:co(g),h=new m(w,y+"leave",p,r,u),h.target=x,h.relatedTarget=b,w=null,ts(u)===d&&(m=new m(v,y+"enter",g,r,u),m.target=b,m.relatedTarget=x,w=m),x=w,p&&g)t:{for(m=p,v=g,y=0,b=m;b;b=Ps(b))y++;for(b=0,w=v;w;w=Ps(w))b++;for(;0<y-b;)m=Ps(m),y--;for(;0<b-y;)v=Ps(v),b--;for(;y--;){if(m===v||v!==null&&m===v.alternate)break t;m=Ps(m),v=Ps(v)}m=null}else m=null;p!==null&&Ym(f,h,p,m,!1),g!==null&&x!==null&&Ym(f,x,g,m,!0)}}e:{if(h=d?co(d):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var k=Y2;else if(Fm(h))if(hx)k=J2;else{k=K2;var _=X2}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(k=Z2);if(k&&(k=k(t,d))){ux(f,k,r,u);break e}_&&_(t,h,d),t==="focusout"&&(_=h._wrapperState)&&_.controlled&&h.type==="number"&&th(h,"number",h.value)}switch(_=d?co(d):window,t){case"focusin":(Fm(_)||_.contentEditable==="true")&&(ao=_,fh=d,ja=null);break;case"focusout":ja=fh=ao=null;break;case"mousedown":ph=!0;break;case"contextmenu":case"mouseup":case"dragend":ph=!1,Gm(f,r,u);break;case"selectionchange":if(tS)break;case"keydown":case"keyup":Gm(f,r,u)}var C;if(Of)e:{switch(t){case"compositionstart":var N="onCompositionStart";break e;case"compositionend":N="onCompositionEnd";break e;case"compositionupdate":N="onCompositionUpdate";break e}N=void 0}else oo?cx(t,r)&&(N="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(N="onCompositionStart");N&&(lx&&r.locale!=="ko"&&(oo||N!=="onCompositionStart"?N==="onCompositionEnd"&&oo&&(C=ax()):(ki=u,Nf="value"in ki?ki.value:ki.textContent,oo=!0)),_=_c(d,N),0<_.length&&(N=new Lm(N,t,null,r,u),f.push({event:N,listeners:_}),C?N.data=C:(C=dx(r),C!==null&&(N.data=C)))),(C=U2?W2(t,r):G2(t,r))&&(d=_c(d,"onBeforeInput"),0<d.length&&(u=new Lm("onBeforeInput","beforeinput",null,r,u),f.push({event:u,listeners:d}),u.data=C))}_x(f,e)})}function Ua(t,e,r){return{instance:t,listener:e,currentTarget:r}}function _c(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=La(t,r),s!=null&&n.unshift(Ua(t,s,i)),s=La(t,e),s!=null&&n.push(Ua(t,s,i))),t=t.return}return n}function Ps(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Ym(t,e,r,n,i){for(var s=e._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,d=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&d!==null&&(l=d,i?(c=La(r,s),c!=null&&o.unshift(Ua(r,c,l))):i||(c=La(r,s),c!=null&&o.push(Ua(r,c,l)))),r=r.return}o.length!==0&&t.push({event:e,listeners:o})}var sS=/\r\n?/g,oS=/\u0000|\uFFFD/g;function Xm(t){return(typeof t=="string"?t:""+t).replace(sS,`
`).replace(oS,"")}function Rl(t,e,r){if(e=Xm(e),Xm(t)!==e&&r)throw Error(je(425))}function Sc(){}var mh=null,gh=null;function vh(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var yh=typeof setTimeout=="function"?setTimeout:void 0,aS=typeof clearTimeout=="function"?clearTimeout:void 0,Km=typeof Promise=="function"?Promise:void 0,lS=typeof queueMicrotask=="function"?queueMicrotask:typeof Km<"u"?function(t){return Km.resolve(null).then(t).catch(cS)}:yh;function cS(t){setTimeout(function(){throw t})}function nu(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),za(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);za(e)}function Ni(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Zm(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var Io=Math.random().toString(36).slice(2),Rn="__reactFiber$"+Io,Wa="__reactProps$"+Io,ri="__reactContainer$"+Io,xh="__reactEvents$"+Io,dS="__reactListeners$"+Io,uS="__reactHandles$"+Io;function ts(t){var e=t[Rn];if(e)return e;for(var r=t.parentNode;r;){if(e=r[ri]||r[Rn]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=Zm(t);t!==null;){if(r=t[Rn])return r;t=Zm(t)}return e}t=r,r=t.parentNode}return null}function ol(t){return t=t[Rn]||t[ri],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function co(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(je(33))}function dd(t){return t[Wa]||null}var bh=[],uo=-1;function zi(t){return{current:t}}function Ct(t){0>uo||(t.current=bh[uo],bh[uo]=null,uo--)}function wt(t,e){uo++,bh[uo]=t.current,t.current=e}var $i={},ar=zi($i),br=zi(!1),cs=$i;function To(t,e){var r=t.type.contextTypes;if(!r)return $i;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function wr(t){return t=t.childContextTypes,t!=null}function kc(){Ct(br),Ct(ar)}function Jm(t,e,r){if(ar.current!==$i)throw Error(je(168));wt(ar,e),wt(br,r)}function kx(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(je(108,X_(t)||"Unknown",i));return At({},r,n)}function jc(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||$i,cs=ar.current,wt(ar,t),wt(br,br.current),!0}function Qm(t,e,r){var n=t.stateNode;if(!n)throw Error(je(169));r?(t=kx(t,e,cs),n.__reactInternalMemoizedMergedChildContext=t,Ct(br),Ct(ar),wt(ar,t)):Ct(br),wt(br,r)}var Kn=null,ud=!1,iu=!1;function jx(t){Kn===null?Kn=[t]:Kn.push(t)}function hS(t){ud=!0,jx(t)}function Fi(){if(!iu&&Kn!==null){iu=!0;var t=0,e=yt;try{var r=Kn;for(yt=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Kn=null,ud=!1}catch(i){throw Kn!==null&&(Kn=Kn.slice(t+1)),Ky(jf,Fi),i}finally{yt=e,iu=!1}}return null}var ho=[],fo=0,Cc=null,Ec=0,Gr=[],Vr=0,ds=null,Zn=1,Jn="";function Xi(t,e){ho[fo++]=Ec,ho[fo++]=Cc,Cc=t,Ec=e}function Cx(t,e,r){Gr[Vr++]=Zn,Gr[Vr++]=Jn,Gr[Vr++]=ds,ds=t;var n=Zn;t=Jn;var i=32-pn(n)-1;n&=~(1<<i),r+=1;var s=32-pn(e)+i;if(30<s){var o=i-i%5;s=(n&(1<<o)-1).toString(32),n>>=o,i-=o,Zn=1<<32-pn(e)+i|r<<i|n,Jn=s+t}else Zn=1<<s|r<<i|n,Jn=t}function Mf(t){t.return!==null&&(Xi(t,1),Cx(t,1,0))}function $f(t){for(;t===Cc;)Cc=ho[--fo],ho[fo]=null,Ec=ho[--fo],ho[fo]=null;for(;t===ds;)ds=Gr[--Vr],Gr[Vr]=null,Jn=Gr[--Vr],Gr[Vr]=null,Zn=Gr[--Vr],Gr[Vr]=null}var Lr=null,Ar=null,Tt=!1,hn=null;function Ex(t,e){var r=Yr(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function eg(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Lr=t,Ar=Ni(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Lr=t,Ar=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=ds!==null?{id:Zn,overflow:Jn}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Yr(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Lr=t,Ar=null,!0):!1;default:return!1}}function wh(t){return(t.mode&1)!==0&&(t.flags&128)===0}function _h(t){if(Tt){var e=Ar;if(e){var r=e;if(!eg(t,e)){if(wh(t))throw Error(je(418));e=Ni(r.nextSibling);var n=Lr;e&&eg(t,e)?Ex(n,r):(t.flags=t.flags&-4097|2,Tt=!1,Lr=t)}}else{if(wh(t))throw Error(je(418));t.flags=t.flags&-4097|2,Tt=!1,Lr=t}}}function tg(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Lr=t}function Pl(t){if(t!==Lr)return!1;if(!Tt)return tg(t),Tt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!vh(t.type,t.memoizedProps)),e&&(e=Ar)){if(wh(t))throw Tx(),Error(je(418));for(;e;)Ex(t,e),e=Ni(e.nextSibling)}if(tg(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(je(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Ar=Ni(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Ar=null}}else Ar=Lr?Ni(t.stateNode.nextSibling):null;return!0}function Tx(){for(var t=Ar;t;)t=Ni(t.nextSibling)}function No(){Ar=Lr=null,Tt=!1}function Lf(t){hn===null?hn=[t]:hn.push(t)}var fS=si.ReactCurrentBatchConfig;function ia(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(je(309));var n=r.stateNode}if(!n)throw Error(je(147,t));var i=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var l=i.refs;o===null?delete l[s]:l[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(je(284));if(!r._owner)throw Error(je(290,t))}return t}function Ol(t,e){throw t=Object.prototype.toString.call(e),Error(je(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function rg(t){var e=t._init;return e(t._payload)}function Nx(t){function e(v,y){if(t){var b=v.deletions;b===null?(v.deletions=[y],v.flags|=16):b.push(y)}}function r(v,y){if(!t)return null;for(;y!==null;)e(v,y),y=y.sibling;return null}function n(v,y){for(v=new Map;y!==null;)y.key!==null?v.set(y.key,y):v.set(y.index,y),y=y.sibling;return v}function i(v,y){return v=Ai(v,y),v.index=0,v.sibling=null,v}function s(v,y,b){return v.index=b,t?(b=v.alternate,b!==null?(b=b.index,b<y?(v.flags|=2,y):b):(v.flags|=2,y)):(v.flags|=1048576,y)}function o(v){return t&&v.alternate===null&&(v.flags|=2),v}function l(v,y,b,w){return y===null||y.tag!==6?(y=uu(b,v.mode,w),y.return=v,y):(y=i(y,b),y.return=v,y)}function c(v,y,b,w){var k=b.type;return k===so?u(v,y,b.props.children,w,b.key):y!==null&&(y.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===mi&&rg(k)===y.type)?(w=i(y,b.props),w.ref=ia(v,y,b),w.return=v,w):(w=fc(b.type,b.key,b.props,null,v.mode,w),w.ref=ia(v,y,b),w.return=v,w)}function d(v,y,b,w){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=hu(b,v.mode,w),y.return=v,y):(y=i(y,b.children||[]),y.return=v,y)}function u(v,y,b,w,k){return y===null||y.tag!==7?(y=as(b,v.mode,w,k),y.return=v,y):(y=i(y,b),y.return=v,y)}function f(v,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=uu(""+y,v.mode,b),y.return=v,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case wl:return b=fc(y.type,y.key,y.props,null,v.mode,b),b.ref=ia(v,null,y),b.return=v,b;case io:return y=hu(y,v.mode,b),y.return=v,y;case mi:var w=y._init;return f(v,w(y._payload),b)}if(pa(y)||Qo(y))return y=as(y,v.mode,b,null),y.return=v,y;Ol(v,y)}return null}function h(v,y,b,w){var k=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return k!==null?null:l(v,y,""+b,w);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case wl:return b.key===k?c(v,y,b,w):null;case io:return b.key===k?d(v,y,b,w):null;case mi:return k=b._init,h(v,y,k(b._payload),w)}if(pa(b)||Qo(b))return k!==null?null:u(v,y,b,w,null);Ol(v,b)}return null}function p(v,y,b,w,k){if(typeof w=="string"&&w!==""||typeof w=="number")return v=v.get(b)||null,l(y,v,""+w,k);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case wl:return v=v.get(w.key===null?b:w.key)||null,c(y,v,w,k);case io:return v=v.get(w.key===null?b:w.key)||null,d(y,v,w,k);case mi:var _=w._init;return p(v,y,b,_(w._payload),k)}if(pa(w)||Qo(w))return v=v.get(b)||null,u(y,v,w,k,null);Ol(y,w)}return null}function g(v,y,b,w){for(var k=null,_=null,C=y,N=y=0,T=null;C!==null&&N<b.length;N++){C.index>N?(T=C,C=null):T=C.sibling;var O=h(v,C,b[N],w);if(O===null){C===null&&(C=T);break}t&&C&&O.alternate===null&&e(v,C),y=s(O,y,N),_===null?k=O:_.sibling=O,_=O,C=T}if(N===b.length)return r(v,C),Tt&&Xi(v,N),k;if(C===null){for(;N<b.length;N++)C=f(v,b[N],w),C!==null&&(y=s(C,y,N),_===null?k=C:_.sibling=C,_=C);return Tt&&Xi(v,N),k}for(C=n(v,C);N<b.length;N++)T=p(C,v,N,b[N],w),T!==null&&(t&&T.alternate!==null&&C.delete(T.key===null?N:T.key),y=s(T,y,N),_===null?k=T:_.sibling=T,_=T);return t&&C.forEach(function(X){return e(v,X)}),Tt&&Xi(v,N),k}function m(v,y,b,w){var k=Qo(b);if(typeof k!="function")throw Error(je(150));if(b=k.call(b),b==null)throw Error(je(151));for(var _=k=null,C=y,N=y=0,T=null,O=b.next();C!==null&&!O.done;N++,O=b.next()){C.index>N?(T=C,C=null):T=C.sibling;var X=h(v,C,O.value,w);if(X===null){C===null&&(C=T);break}t&&C&&X.alternate===null&&e(v,C),y=s(X,y,N),_===null?k=X:_.sibling=X,_=X,C=T}if(O.done)return r(v,C),Tt&&Xi(v,N),k;if(C===null){for(;!O.done;N++,O=b.next())O=f(v,O.value,w),O!==null&&(y=s(O,y,N),_===null?k=O:_.sibling=O,_=O);return Tt&&Xi(v,N),k}for(C=n(v,C);!O.done;N++,O=b.next())O=p(C,v,N,O.value,w),O!==null&&(t&&O.alternate!==null&&C.delete(O.key===null?N:O.key),y=s(O,y,N),_===null?k=O:_.sibling=O,_=O);return t&&C.forEach(function(E){return e(v,E)}),Tt&&Xi(v,N),k}function x(v,y,b,w){if(typeof b=="object"&&b!==null&&b.type===so&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case wl:e:{for(var k=b.key,_=y;_!==null;){if(_.key===k){if(k=b.type,k===so){if(_.tag===7){r(v,_.sibling),y=i(_,b.props.children),y.return=v,v=y;break e}}else if(_.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===mi&&rg(k)===_.type){r(v,_.sibling),y=i(_,b.props),y.ref=ia(v,_,b),y.return=v,v=y;break e}r(v,_);break}else e(v,_);_=_.sibling}b.type===so?(y=as(b.props.children,v.mode,w,b.key),y.return=v,v=y):(w=fc(b.type,b.key,b.props,null,v.mode,w),w.ref=ia(v,y,b),w.return=v,v=w)}return o(v);case io:e:{for(_=b.key;y!==null;){if(y.key===_)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){r(v,y.sibling),y=i(y,b.children||[]),y.return=v,v=y;break e}else{r(v,y);break}else e(v,y);y=y.sibling}y=hu(b,v.mode,w),y.return=v,v=y}return o(v);case mi:return _=b._init,x(v,y,_(b._payload),w)}if(pa(b))return g(v,y,b,w);if(Qo(b))return m(v,y,b,w);Ol(v,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(r(v,y.sibling),y=i(y,b),y.return=v,v=y):(r(v,y),y=uu(b,v.mode,w),y.return=v,v=y),o(v)):r(v,y)}return x}var Ro=Nx(!0),Rx=Nx(!1),Tc=zi(null),Nc=null,po=null,If=null;function Df(){If=po=Nc=null}function zf(t){var e=Tc.current;Ct(Tc),t._currentValue=e}function Sh(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function So(t,e){Nc=t,If=po=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(xr=!0),t.firstContext=null)}function Kr(t){var e=t._currentValue;if(If!==t)if(t={context:t,memoizedValue:e,next:null},po===null){if(Nc===null)throw Error(je(308));po=t,Nc.dependencies={lanes:0,firstContext:t}}else po=po.next=t;return e}var rs=null;function Ff(t){rs===null?rs=[t]:rs.push(t)}function Px(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,Ff(e)):(r.next=i.next,i.next=r),e.interleaved=r,ni(t,n)}function ni(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var gi=!1;function Bf(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ox(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Qn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ri(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,dt&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,ni(t,r)}return i=n.interleaved,i===null?(e.next=e,Ff(n)):(e.next=i.next,i.next=e),n.interleaved=e,ni(t,r)}function ac(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Cf(t,r)}}function ng(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=o:s=s.next=o,r=r.next}while(r!==null);s===null?i=s=e:s=s.next=e}else i=s=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Rc(t,e,r,n){var i=t.updateQueue;gi=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var c=l,d=c.next;c.next=null,o===null?s=d:o.next=d,o=c;var u=t.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==o&&(l===null?u.firstBaseUpdate=d:l.next=d,u.lastBaseUpdate=c))}if(s!==null){var f=i.baseState;o=0,u=d=c=null,l=s;do{var h=l.lane,p=l.eventTime;if((n&h)===h){u!==null&&(u=u.next={eventTime:p,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var g=t,m=l;switch(h=e,p=r,m.tag){case 1:if(g=m.payload,typeof g=="function"){f=g.call(p,f,h);break e}f=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=m.payload,h=typeof g=="function"?g.call(p,f,h):g,h==null)break e;f=At({},f,h);break e;case 2:gi=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,h=i.effects,h===null?i.effects=[l]:h.push(l))}else p={eventTime:p,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(d=u=p,c=f):u=u.next=p,o|=h;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;h=l,l=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(u===null&&(c=f),i.baseState=c,i.firstBaseUpdate=d,i.lastBaseUpdate=u,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);hs|=o,t.lanes=o,t.memoizedState=f}}function ig(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(je(191,i));i.call(n)}}}var al={},Mn=zi(al),Ga=zi(al),Va=zi(al);function ns(t){if(t===al)throw Error(je(174));return t}function Hf(t,e){switch(wt(Va,e),wt(Ga,t),wt(Mn,al),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:nh(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=nh(e,t)}Ct(Mn),wt(Mn,e)}function Po(){Ct(Mn),Ct(Ga),Ct(Va)}function Ax(t){ns(Va.current);var e=ns(Mn.current),r=nh(e,t.type);e!==r&&(wt(Ga,t),wt(Mn,r))}function Uf(t){Ga.current===t&&(Ct(Mn),Ct(Ga))}var Pt=zi(0);function Pc(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var su=[];function Wf(){for(var t=0;t<su.length;t++)su[t]._workInProgressVersionPrimary=null;su.length=0}var lc=si.ReactCurrentDispatcher,ou=si.ReactCurrentBatchConfig,us=0,Ot=null,Gt=null,Yt=null,Oc=!1,Ca=!1,qa=0,pS=0;function rr(){throw Error(je(321))}function Gf(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!gn(t[r],e[r]))return!1;return!0}function Vf(t,e,r,n,i,s){if(us=s,Ot=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,lc.current=t===null||t.memoizedState===null?yS:xS,t=r(n,i),Ca){s=0;do{if(Ca=!1,qa=0,25<=s)throw Error(je(301));s+=1,Yt=Gt=null,e.updateQueue=null,lc.current=bS,t=r(n,i)}while(Ca)}if(lc.current=Ac,e=Gt!==null&&Gt.next!==null,us=0,Yt=Gt=Ot=null,Oc=!1,e)throw Error(je(300));return t}function qf(){var t=qa!==0;return qa=0,t}function Nn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yt===null?Ot.memoizedState=Yt=t:Yt=Yt.next=t,Yt}function Zr(){if(Gt===null){var t=Ot.alternate;t=t!==null?t.memoizedState:null}else t=Gt.next;var e=Yt===null?Ot.memoizedState:Yt.next;if(e!==null)Yt=e,Gt=t;else{if(t===null)throw Error(je(310));Gt=t,t={memoizedState:Gt.memoizedState,baseState:Gt.baseState,baseQueue:Gt.baseQueue,queue:Gt.queue,next:null},Yt===null?Ot.memoizedState=Yt=t:Yt=Yt.next=t}return Yt}function Ya(t,e){return typeof e=="function"?e(t):e}function au(t){var e=Zr(),r=e.queue;if(r===null)throw Error(je(311));r.lastRenderedReducer=t;var n=Gt,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var l=o=null,c=null,d=s;do{var u=d.lane;if((us&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:t(n,d.action);else{var f={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=f,o=n):c=c.next=f,Ot.lanes|=u,hs|=u}d=d.next}while(d!==null&&d!==s);c===null?o=n:c.next=l,gn(n,e.memoizedState)||(xr=!0),e.memoizedState=n,e.baseState=o,e.baseQueue=c,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do s=i.lane,Ot.lanes|=s,hs|=s,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function lu(t){var e=Zr(),r=e.queue;if(r===null)throw Error(je(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,s=e.memoizedState;if(i!==null){r.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);gn(s,e.memoizedState)||(xr=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function Mx(){}function $x(t,e){var r=Ot,n=Zr(),i=e(),s=!gn(n.memoizedState,i);if(s&&(n.memoizedState=i,xr=!0),n=n.queue,Yf(Dx.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||Yt!==null&&Yt.memoizedState.tag&1){if(r.flags|=2048,Xa(9,Ix.bind(null,r,n,i,e),void 0,null),Xt===null)throw Error(je(349));us&30||Lx(r,e,i)}return i}function Lx(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Ot.updateQueue,e===null?(e={lastEffect:null,stores:null},Ot.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function Ix(t,e,r,n){e.value=r,e.getSnapshot=n,zx(e)&&Fx(t)}function Dx(t,e,r){return r(function(){zx(e)&&Fx(t)})}function zx(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!gn(t,r)}catch{return!0}}function Fx(t){var e=ni(t,1);e!==null&&mn(e,t,1,-1)}function sg(t){var e=Nn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ya,lastRenderedState:t},e.queue=t,t=t.dispatch=vS.bind(null,Ot,t),[e.memoizedState,t]}function Xa(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Ot.updateQueue,e===null?(e={lastEffect:null,stores:null},Ot.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function Bx(){return Zr().memoizedState}function cc(t,e,r,n){var i=Nn();Ot.flags|=t,i.memoizedState=Xa(1|e,r,void 0,n===void 0?null:n)}function hd(t,e,r,n){var i=Zr();n=n===void 0?null:n;var s=void 0;if(Gt!==null){var o=Gt.memoizedState;if(s=o.destroy,n!==null&&Gf(n,o.deps)){i.memoizedState=Xa(e,r,s,n);return}}Ot.flags|=t,i.memoizedState=Xa(1|e,r,s,n)}function og(t,e){return cc(8390656,8,t,e)}function Yf(t,e){return hd(2048,8,t,e)}function Hx(t,e){return hd(4,2,t,e)}function Ux(t,e){return hd(4,4,t,e)}function Wx(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Gx(t,e,r){return r=r!=null?r.concat([t]):null,hd(4,4,Wx.bind(null,e,t),r)}function Xf(){}function Vx(t,e){var r=Zr();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Gf(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function qx(t,e){var r=Zr();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Gf(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function Yx(t,e,r){return us&21?(gn(r,e)||(r=Qy(),Ot.lanes|=r,hs|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,xr=!0),t.memoizedState=r)}function mS(t,e){var r=yt;yt=r!==0&&4>r?r:4,t(!0);var n=ou.transition;ou.transition={};try{t(!1),e()}finally{yt=r,ou.transition=n}}function Xx(){return Zr().memoizedState}function gS(t,e,r){var n=Oi(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Kx(t))Zx(e,r);else if(r=Px(t,e,r,n),r!==null){var i=hr();mn(r,t,n,i),Jx(r,e,n)}}function vS(t,e,r){var n=Oi(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Kx(t))Zx(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,l=s(o,r);if(i.hasEagerState=!0,i.eagerState=l,gn(l,o)){var c=e.interleaved;c===null?(i.next=i,Ff(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}r=Px(t,e,i,n),r!==null&&(i=hr(),mn(r,t,n,i),Jx(r,e,n))}}function Kx(t){var e=t.alternate;return t===Ot||e!==null&&e===Ot}function Zx(t,e){Ca=Oc=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function Jx(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Cf(t,r)}}var Ac={readContext:Kr,useCallback:rr,useContext:rr,useEffect:rr,useImperativeHandle:rr,useInsertionEffect:rr,useLayoutEffect:rr,useMemo:rr,useReducer:rr,useRef:rr,useState:rr,useDebugValue:rr,useDeferredValue:rr,useTransition:rr,useMutableSource:rr,useSyncExternalStore:rr,useId:rr,unstable_isNewReconciler:!1},yS={readContext:Kr,useCallback:function(t,e){return Nn().memoizedState=[t,e===void 0?null:e],t},useContext:Kr,useEffect:og,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,cc(4194308,4,Wx.bind(null,e,t),r)},useLayoutEffect:function(t,e){return cc(4194308,4,t,e)},useInsertionEffect:function(t,e){return cc(4,2,t,e)},useMemo:function(t,e){var r=Nn();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=Nn();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=gS.bind(null,Ot,t),[n.memoizedState,t]},useRef:function(t){var e=Nn();return t={current:t},e.memoizedState=t},useState:sg,useDebugValue:Xf,useDeferredValue:function(t){return Nn().memoizedState=t},useTransition:function(){var t=sg(!1),e=t[0];return t=mS.bind(null,t[1]),Nn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Ot,i=Nn();if(Tt){if(r===void 0)throw Error(je(407));r=r()}else{if(r=e(),Xt===null)throw Error(je(349));us&30||Lx(n,e,r)}i.memoizedState=r;var s={value:r,getSnapshot:e};return i.queue=s,og(Dx.bind(null,n,s,t),[t]),n.flags|=2048,Xa(9,Ix.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=Nn(),e=Xt.identifierPrefix;if(Tt){var r=Jn,n=Zn;r=(n&~(1<<32-pn(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=qa++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=pS++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},xS={readContext:Kr,useCallback:Vx,useContext:Kr,useEffect:Yf,useImperativeHandle:Gx,useInsertionEffect:Hx,useLayoutEffect:Ux,useMemo:qx,useReducer:au,useRef:Bx,useState:function(){return au(Ya)},useDebugValue:Xf,useDeferredValue:function(t){var e=Zr();return Yx(e,Gt.memoizedState,t)},useTransition:function(){var t=au(Ya)[0],e=Zr().memoizedState;return[t,e]},useMutableSource:Mx,useSyncExternalStore:$x,useId:Xx,unstable_isNewReconciler:!1},bS={readContext:Kr,useCallback:Vx,useContext:Kr,useEffect:Yf,useImperativeHandle:Gx,useInsertionEffect:Hx,useLayoutEffect:Ux,useMemo:qx,useReducer:lu,useRef:Bx,useState:function(){return lu(Ya)},useDebugValue:Xf,useDeferredValue:function(t){var e=Zr();return Gt===null?e.memoizedState=t:Yx(e,Gt.memoizedState,t)},useTransition:function(){var t=lu(Ya)[0],e=Zr().memoizedState;return[t,e]},useMutableSource:Mx,useSyncExternalStore:$x,useId:Xx,unstable_isNewReconciler:!1};function ln(t,e){if(t&&t.defaultProps){e=At({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function kh(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:At({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var fd={isMounted:function(t){return(t=t._reactInternals)?gs(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=hr(),i=Oi(t),s=Qn(n,i);s.payload=e,r!=null&&(s.callback=r),e=Ri(t,s,i),e!==null&&(mn(e,t,i,n),ac(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=hr(),i=Oi(t),s=Qn(n,i);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=Ri(t,s,i),e!==null&&(mn(e,t,i,n),ac(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=hr(),n=Oi(t),i=Qn(r,n);i.tag=2,e!=null&&(i.callback=e),e=Ri(t,i,n),e!==null&&(mn(e,t,n,r),ac(e,t,n))}};function ag(t,e,r,n,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,o):e.prototype&&e.prototype.isPureReactComponent?!Ba(r,n)||!Ba(i,s):!0}function Qx(t,e,r){var n=!1,i=$i,s=e.contextType;return typeof s=="object"&&s!==null?s=Kr(s):(i=wr(e)?cs:ar.current,n=e.contextTypes,s=(n=n!=null)?To(t,i):$i),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=fd,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function lg(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&fd.enqueueReplaceState(e,e.state,null)}function jh(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},Bf(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Kr(s):(s=wr(e)?cs:ar.current,i.context=To(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(kh(t,e,s,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&fd.enqueueReplaceState(i,i.state,null),Rc(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Oo(t,e){try{var r="",n=e;do r+=Y_(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function cu(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function Ch(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var wS=typeof WeakMap=="function"?WeakMap:Map;function eb(t,e,r){r=Qn(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){$c||($c=!0,Lh=n),Ch(t,e)},r}function tb(t,e,r){r=Qn(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){Ch(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Ch(t,e),typeof n!="function"&&(Pi===null?Pi=new Set([this]):Pi.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),r}function cg(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new wS;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=$S.bind(null,t,e,r),e.then(t,t))}function dg(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function ug(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Qn(-1,1),e.tag=2,Ri(r,e,1))),r.lanes|=1),t)}var _S=si.ReactCurrentOwner,xr=!1;function dr(t,e,r,n){e.child=t===null?Rx(e,null,r,n):Ro(e,t.child,r,n)}function hg(t,e,r,n,i){r=r.render;var s=e.ref;return So(e,i),n=Vf(t,e,r,n,s,i),r=qf(),t!==null&&!xr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ii(t,e,i)):(Tt&&r&&Mf(e),e.flags|=1,dr(t,e,n,i),e.child)}function fg(t,e,r,n,i){if(t===null){var s=r.type;return typeof s=="function"&&!np(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,rb(t,e,s,n,i)):(t=fc(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(r=r.compare,r=r!==null?r:Ba,r(o,n)&&t.ref===e.ref)return ii(t,e,i)}return e.flags|=1,t=Ai(s,n),t.ref=e.ref,t.return=e,e.child=t}function rb(t,e,r,n,i){if(t!==null){var s=t.memoizedProps;if(Ba(s,n)&&t.ref===e.ref)if(xr=!1,e.pendingProps=n=s,(t.lanes&i)!==0)t.flags&131072&&(xr=!0);else return e.lanes=t.lanes,ii(t,e,i)}return Eh(t,e,r,n,i)}function nb(t,e,r){var n=e.pendingProps,i=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},wt(go,Rr),Rr|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,wt(go,Rr),Rr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,wt(go,Rr),Rr|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,wt(go,Rr),Rr|=n;return dr(t,e,i,r),e.child}function ib(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function Eh(t,e,r,n,i){var s=wr(r)?cs:ar.current;return s=To(e,s),So(e,i),r=Vf(t,e,r,n,s,i),n=qf(),t!==null&&!xr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ii(t,e,i)):(Tt&&n&&Mf(e),e.flags|=1,dr(t,e,r,i),e.child)}function pg(t,e,r,n,i){if(wr(r)){var s=!0;jc(e)}else s=!1;if(So(e,i),e.stateNode===null)dc(t,e),Qx(e,r,n),jh(e,r,n,i),n=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,d=r.contextType;typeof d=="object"&&d!==null?d=Kr(d):(d=wr(r)?cs:ar.current,d=To(e,d));var u=r.getDerivedStateFromProps,f=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==d)&&lg(e,o,n,d),gi=!1;var h=e.memoizedState;o.state=h,Rc(e,n,o,i),c=e.memoizedState,l!==n||h!==c||br.current||gi?(typeof u=="function"&&(kh(e,r,u,n),c=e.memoizedState),(l=gi||ag(e,r,l,n,h,c,d))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=c),o.props=n,o.state=c,o.context=d,n=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{o=e.stateNode,Ox(t,e),l=e.memoizedProps,d=e.type===e.elementType?l:ln(e.type,l),o.props=d,f=e.pendingProps,h=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=Kr(c):(c=wr(r)?cs:ar.current,c=To(e,c));var p=r.getDerivedStateFromProps;(u=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||h!==c)&&lg(e,o,n,c),gi=!1,h=e.memoizedState,o.state=h,Rc(e,n,o,i);var g=e.memoizedState;l!==f||h!==g||br.current||gi?(typeof p=="function"&&(kh(e,r,p,n),g=e.memoizedState),(d=gi||ag(e,r,d,n,h,g,c)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,g,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,g,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=g),o.props=n,o.state=g,o.context=c,n=d):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),n=!1)}return Th(t,e,r,n,s,i)}function Th(t,e,r,n,i,s){ib(t,e);var o=(e.flags&128)!==0;if(!n&&!o)return i&&Qm(e,r,!1),ii(t,e,s);n=e.stateNode,_S.current=e;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&o?(e.child=Ro(e,t.child,null,s),e.child=Ro(e,null,l,s)):dr(t,e,l,s),e.memoizedState=n.state,i&&Qm(e,r,!0),e.child}function sb(t){var e=t.stateNode;e.pendingContext?Jm(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Jm(t,e.context,!1),Hf(t,e.containerInfo)}function mg(t,e,r,n,i){return No(),Lf(i),e.flags|=256,dr(t,e,r,n),e.child}var Nh={dehydrated:null,treeContext:null,retryLane:0};function Rh(t){return{baseLanes:t,cachePool:null,transitions:null}}function ob(t,e,r){var n=e.pendingProps,i=Pt.current,s=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(i&2)!==0),l?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),wt(Pt,i&1),t===null)return _h(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=n.children,t=n.fallback,s?(n=e.mode,s=e.child,o={mode:"hidden",children:o},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=gd(o,n,0,null),t=as(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Rh(r),e.memoizedState=Nh,t):Kf(e,o));if(i=t.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return SS(t,e,o,n,l,i,r);if(s){s=n.fallback,o=e.mode,i=t.child,l=i.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=c,e.deletions=null):(n=Ai(i,c),n.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=Ai(l,s):(s=as(s,o,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,o=t.child.memoizedState,o=o===null?Rh(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~r,e.memoizedState=Nh,n}return s=t.child,t=s.sibling,n=Ai(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function Kf(t,e){return e=gd({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Al(t,e,r,n){return n!==null&&Lf(n),Ro(e,t.child,null,r),t=Kf(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function SS(t,e,r,n,i,s,o){if(r)return e.flags&256?(e.flags&=-257,n=cu(Error(je(422))),Al(t,e,o,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,i=e.mode,n=gd({mode:"visible",children:n.children},i,0,null),s=as(s,i,o,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&Ro(e,t.child,null,o),e.child.memoizedState=Rh(o),e.memoizedState=Nh,s);if(!(e.mode&1))return Al(t,e,o,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var l=n.dgst;return n=l,s=Error(je(419)),n=cu(s,n,void 0),Al(t,e,o,n)}if(l=(o&t.childLanes)!==0,xr||l){if(n=Xt,n!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,ni(t,i),mn(n,t,i,-1))}return rp(),n=cu(Error(je(421))),Al(t,e,o,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=LS.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Ar=Ni(i.nextSibling),Lr=e,Tt=!0,hn=null,t!==null&&(Gr[Vr++]=Zn,Gr[Vr++]=Jn,Gr[Vr++]=ds,Zn=t.id,Jn=t.overflow,ds=e),e=Kf(e,n.children),e.flags|=4096,e)}function gg(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),Sh(t.return,e,r)}function du(t,e,r,n,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function ab(t,e,r){var n=e.pendingProps,i=n.revealOrder,s=n.tail;if(dr(t,e,n.children,r),n=Pt.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&gg(t,r,e);else if(t.tag===19)gg(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(wt(Pt,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&Pc(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),du(e,!1,i,r,s);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Pc(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}du(e,!0,r,null,s);break;case"together":du(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function dc(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ii(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),hs|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(je(153));if(e.child!==null){for(t=e.child,r=Ai(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Ai(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function kS(t,e,r){switch(e.tag){case 3:sb(e),No();break;case 5:Ax(e);break;case 1:wr(e.type)&&jc(e);break;case 4:Hf(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;wt(Tc,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(wt(Pt,Pt.current&1),e.flags|=128,null):r&e.child.childLanes?ob(t,e,r):(wt(Pt,Pt.current&1),t=ii(t,e,r),t!==null?t.sibling:null);wt(Pt,Pt.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return ab(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),wt(Pt,Pt.current),n)break;return null;case 22:case 23:return e.lanes=0,nb(t,e,r)}return ii(t,e,r)}var lb,Ph,cb,db;lb=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Ph=function(){};cb=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,ns(Mn.current);var s=null;switch(r){case"input":i=Qu(t,i),n=Qu(t,n),s=[];break;case"select":i=At({},i,{value:void 0}),n=At({},n,{value:void 0}),s=[];break;case"textarea":i=rh(t,i),n=rh(t,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=Sc)}ih(r,n);var o;r=null;for(d in i)if(!n.hasOwnProperty(d)&&i.hasOwnProperty(d)&&i[d]!=null)if(d==="style"){var l=i[d];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Ma.hasOwnProperty(d)?s||(s=[]):(s=s||[]).push(d,null));for(d in n){var c=n[d];if(l=i!=null?i[d]:void 0,n.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(s||(s=[]),s.push(d,r)),r=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(s=s||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Ma.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&St("scroll",t),s||l===c||(s=[])):(s=s||[]).push(d,c))}r&&(s=s||[]).push("style",r);var d=s;(e.updateQueue=d)&&(e.flags|=4)}};db=function(t,e,r,n){r!==n&&(e.flags|=4)};function sa(t,e){if(!Tt)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function nr(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function jS(t,e,r){var n=e.pendingProps;switch($f(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return nr(e),null;case 1:return wr(e.type)&&kc(),nr(e),null;case 3:return n=e.stateNode,Po(),Ct(br),Ct(ar),Wf(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(Pl(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,hn!==null&&(zh(hn),hn=null))),Ph(t,e),nr(e),null;case 5:Uf(e);var i=ns(Va.current);if(r=e.type,t!==null&&e.stateNode!=null)cb(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(je(166));return nr(e),null}if(t=ns(Mn.current),Pl(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[Rn]=e,n[Wa]=s,t=(e.mode&1)!==0,r){case"dialog":St("cancel",n),St("close",n);break;case"iframe":case"object":case"embed":St("load",n);break;case"video":case"audio":for(i=0;i<ga.length;i++)St(ga[i],n);break;case"source":St("error",n);break;case"img":case"image":case"link":St("error",n),St("load",n);break;case"details":St("toggle",n);break;case"input":jm(n,s),St("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},St("invalid",n);break;case"textarea":Em(n,s),St("invalid",n)}ih(r,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?n.textContent!==l&&(s.suppressHydrationWarning!==!0&&Rl(n.textContent,l,t),i=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&Rl(n.textContent,l,t),i=["children",""+l]):Ma.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&St("scroll",n)}switch(r){case"input":_l(n),Cm(n,s,!0);break;case"textarea":_l(n),Tm(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Sc)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Dy(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=o.createElement(r,{is:n.is}):(t=o.createElement(r),r==="select"&&(o=t,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):t=o.createElementNS(t,r),t[Rn]=e,t[Wa]=n,lb(t,e,!1,!1),e.stateNode=t;e:{switch(o=sh(r,n),r){case"dialog":St("cancel",t),St("close",t),i=n;break;case"iframe":case"object":case"embed":St("load",t),i=n;break;case"video":case"audio":for(i=0;i<ga.length;i++)St(ga[i],t);i=n;break;case"source":St("error",t),i=n;break;case"img":case"image":case"link":St("error",t),St("load",t),i=n;break;case"details":St("toggle",t),i=n;break;case"input":jm(t,n),i=Qu(t,n),St("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=At({},n,{value:void 0}),St("invalid",t);break;case"textarea":Em(t,n),i=rh(t,n),St("invalid",t);break;default:i=n}ih(r,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var c=l[s];s==="style"?By(t,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&zy(t,c)):s==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&$a(t,c):typeof c=="number"&&$a(t,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Ma.hasOwnProperty(s)?c!=null&&s==="onScroll"&&St("scroll",t):c!=null&&bf(t,s,c,o))}switch(r){case"input":_l(t),Cm(t,n,!1);break;case"textarea":_l(t),Tm(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Mi(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?xo(t,!!n.multiple,s,!1):n.defaultValue!=null&&xo(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Sc)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return nr(e),null;case 6:if(t&&e.stateNode!=null)db(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(je(166));if(r=ns(Va.current),ns(Mn.current),Pl(e)){if(n=e.stateNode,r=e.memoizedProps,n[Rn]=e,(s=n.nodeValue!==r)&&(t=Lr,t!==null))switch(t.tag){case 3:Rl(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Rl(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Rn]=e,e.stateNode=n}return nr(e),null;case 13:if(Ct(Pt),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Tt&&Ar!==null&&e.mode&1&&!(e.flags&128))Tx(),No(),e.flags|=98560,s=!1;else if(s=Pl(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(je(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(je(317));s[Rn]=e}else No(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;nr(e),s=!1}else hn!==null&&(zh(hn),hn=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||Pt.current&1?qt===0&&(qt=3):rp())),e.updateQueue!==null&&(e.flags|=4),nr(e),null);case 4:return Po(),Ph(t,e),t===null&&Ha(e.stateNode.containerInfo),nr(e),null;case 10:return zf(e.type._context),nr(e),null;case 17:return wr(e.type)&&kc(),nr(e),null;case 19:if(Ct(Pt),s=e.memoizedState,s===null)return nr(e),null;if(n=(e.flags&128)!==0,o=s.rendering,o===null)if(n)sa(s,!1);else{if(qt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Pc(t),o!==null){for(e.flags|=128,sa(s,!1),n=o.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return wt(Pt,Pt.current&1|2),e.child}t=t.sibling}s.tail!==null&&It()>Ao&&(e.flags|=128,n=!0,sa(s,!1),e.lanes=4194304)}else{if(!n)if(t=Pc(o),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),sa(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Tt)return nr(e),null}else 2*It()-s.renderingStartTime>Ao&&r!==1073741824&&(e.flags|=128,n=!0,sa(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(r=s.last,r!==null?r.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=It(),e.sibling=null,r=Pt.current,wt(Pt,n?r&1|2:r&1),e):(nr(e),null);case 22:case 23:return tp(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Rr&1073741824&&(nr(e),e.subtreeFlags&6&&(e.flags|=8192)):nr(e),null;case 24:return null;case 25:return null}throw Error(je(156,e.tag))}function CS(t,e){switch($f(e),e.tag){case 1:return wr(e.type)&&kc(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Po(),Ct(br),Ct(ar),Wf(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Uf(e),null;case 13:if(Ct(Pt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(je(340));No()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ct(Pt),null;case 4:return Po(),null;case 10:return zf(e.type._context),null;case 22:case 23:return tp(),null;case 24:return null;default:return null}}var Ml=!1,or=!1,ES=typeof WeakSet=="function"?WeakSet:Set,Le=null;function mo(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Lt(t,e,n)}else r.current=null}function Oh(t,e,r){try{r()}catch(n){Lt(t,e,n)}}var vg=!1;function TS(t,e){if(mh=bc,t=mx(),Af(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,d=0,u=0,f=t,h=null;t:for(;;){for(var p;f!==r||i!==0&&f.nodeType!==3||(l=o+i),f!==s||n!==0&&f.nodeType!==3||(c=o+n),f.nodeType===3&&(o+=f.nodeValue.length),(p=f.firstChild)!==null;)h=f,f=p;for(;;){if(f===t)break t;if(h===r&&++d===i&&(l=o),h===s&&++u===n&&(c=o),(p=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=p}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(gh={focusedElem:t,selectionRange:r},bc=!1,Le=e;Le!==null;)if(e=Le,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Le=t;else for(;Le!==null;){e=Le;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var m=g.memoizedProps,x=g.memoizedState,v=e.stateNode,y=v.getSnapshotBeforeUpdate(e.elementType===e.type?m:ln(e.type,m),x);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(je(163))}}catch(w){Lt(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,Le=t;break}Le=e.return}return g=vg,vg=!1,g}function Ea(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Oh(e,r,s)}i=i.next}while(i!==n)}}function pd(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function Ah(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function ub(t){var e=t.alternate;e!==null&&(t.alternate=null,ub(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Rn],delete e[Wa],delete e[xh],delete e[dS],delete e[uS])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function hb(t){return t.tag===5||t.tag===3||t.tag===4}function yg(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||hb(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Mh(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Sc));else if(n!==4&&(t=t.child,t!==null))for(Mh(t,e,r),t=t.sibling;t!==null;)Mh(t,e,r),t=t.sibling}function $h(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for($h(t,e,r),t=t.sibling;t!==null;)$h(t,e,r),t=t.sibling}var Jt=null,dn=!1;function fi(t,e,r){for(r=r.child;r!==null;)fb(t,e,r),r=r.sibling}function fb(t,e,r){if(An&&typeof An.onCommitFiberUnmount=="function")try{An.onCommitFiberUnmount(od,r)}catch{}switch(r.tag){case 5:or||mo(r,e);case 6:var n=Jt,i=dn;Jt=null,fi(t,e,r),Jt=n,dn=i,Jt!==null&&(dn?(t=Jt,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):Jt.removeChild(r.stateNode));break;case 18:Jt!==null&&(dn?(t=Jt,r=r.stateNode,t.nodeType===8?nu(t.parentNode,r):t.nodeType===1&&nu(t,r),za(t)):nu(Jt,r.stateNode));break;case 4:n=Jt,i=dn,Jt=r.stateNode.containerInfo,dn=!0,fi(t,e,r),Jt=n,dn=i;break;case 0:case 11:case 14:case 15:if(!or&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Oh(r,e,o),i=i.next}while(i!==n)}fi(t,e,r);break;case 1:if(!or&&(mo(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){Lt(r,e,l)}fi(t,e,r);break;case 21:fi(t,e,r);break;case 22:r.mode&1?(or=(n=or)||r.memoizedState!==null,fi(t,e,r),or=n):fi(t,e,r);break;default:fi(t,e,r)}}function xg(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new ES),e.forEach(function(n){var i=IS.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function nn(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:Jt=l.stateNode,dn=!1;break e;case 3:Jt=l.stateNode.containerInfo,dn=!0;break e;case 4:Jt=l.stateNode.containerInfo,dn=!0;break e}l=l.return}if(Jt===null)throw Error(je(160));fb(s,o,i),Jt=null,dn=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(d){Lt(i,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)pb(e,t),e=e.sibling}function pb(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(nn(e,t),En(t),n&4){try{Ea(3,t,t.return),pd(3,t)}catch(m){Lt(t,t.return,m)}try{Ea(5,t,t.return)}catch(m){Lt(t,t.return,m)}}break;case 1:nn(e,t),En(t),n&512&&r!==null&&mo(r,r.return);break;case 5:if(nn(e,t),En(t),n&512&&r!==null&&mo(r,r.return),t.flags&32){var i=t.stateNode;try{$a(i,"")}catch(m){Lt(t,t.return,m)}}if(n&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=r!==null?r.memoizedProps:s,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&Ly(i,s),sh(l,o);var d=sh(l,s);for(o=0;o<c.length;o+=2){var u=c[o],f=c[o+1];u==="style"?By(i,f):u==="dangerouslySetInnerHTML"?zy(i,f):u==="children"?$a(i,f):bf(i,u,f,d)}switch(l){case"input":eh(i,s);break;case"textarea":Iy(i,s);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?xo(i,!!s.multiple,p,!1):h!==!!s.multiple&&(s.defaultValue!=null?xo(i,!!s.multiple,s.defaultValue,!0):xo(i,!!s.multiple,s.multiple?[]:"",!1))}i[Wa]=s}catch(m){Lt(t,t.return,m)}}break;case 6:if(nn(e,t),En(t),n&4){if(t.stateNode===null)throw Error(je(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(m){Lt(t,t.return,m)}}break;case 3:if(nn(e,t),En(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{za(e.containerInfo)}catch(m){Lt(t,t.return,m)}break;case 4:nn(e,t),En(t);break;case 13:nn(e,t),En(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Qf=It())),n&4&&xg(t);break;case 22:if(u=r!==null&&r.memoizedState!==null,t.mode&1?(or=(d=or)||u,nn(e,t),or=d):nn(e,t),En(t),n&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!u&&t.mode&1)for(Le=t,u=t.child;u!==null;){for(f=Le=u;Le!==null;){switch(h=Le,p=h.child,h.tag){case 0:case 11:case 14:case 15:Ea(4,h,h.return);break;case 1:mo(h,h.return);var g=h.stateNode;if(typeof g.componentWillUnmount=="function"){n=h,r=h.return;try{e=n,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(m){Lt(n,r,m)}}break;case 5:mo(h,h.return);break;case 22:if(h.memoizedState!==null){wg(f);continue}}p!==null?(p.return=h,Le=p):wg(f)}u=u.sibling}e:for(u=null,f=t;;){if(f.tag===5){if(u===null){u=f;try{i=f.stateNode,d?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=f.stateNode,c=f.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=Fy("display",o))}catch(m){Lt(t,t.return,m)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(m){Lt(t,t.return,m)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:nn(e,t),En(t),n&4&&xg(t);break;case 21:break;default:nn(e,t),En(t)}}function En(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(hb(r)){var n=r;break e}r=r.return}throw Error(je(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&($a(i,""),n.flags&=-33);var s=yg(t);$h(t,s,i);break;case 3:case 4:var o=n.stateNode.containerInfo,l=yg(t);Mh(t,l,o);break;default:throw Error(je(161))}}catch(c){Lt(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function NS(t,e,r){Le=t,mb(t)}function mb(t,e,r){for(var n=(t.mode&1)!==0;Le!==null;){var i=Le,s=i.child;if(i.tag===22&&n){var o=i.memoizedState!==null||Ml;if(!o){var l=i.alternate,c=l!==null&&l.memoizedState!==null||or;l=Ml;var d=or;if(Ml=o,(or=c)&&!d)for(Le=i;Le!==null;)o=Le,c=o.child,o.tag===22&&o.memoizedState!==null?_g(i):c!==null?(c.return=o,Le=c):_g(i);for(;s!==null;)Le=s,mb(s),s=s.sibling;Le=i,Ml=l,or=d}bg(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Le=s):bg(t)}}function bg(t){for(;Le!==null;){var e=Le;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:or||pd(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!or)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:ln(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&ig(e,s,n);break;case 3:var o=e.updateQueue;if(o!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}ig(e,o,r)}break;case 5:var l=e.stateNode;if(r===null&&e.flags&4){r=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&za(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(je(163))}or||e.flags&512&&Ah(e)}catch(h){Lt(e,e.return,h)}}if(e===t){Le=null;break}if(r=e.sibling,r!==null){r.return=e.return,Le=r;break}Le=e.return}}function wg(t){for(;Le!==null;){var e=Le;if(e===t){Le=null;break}var r=e.sibling;if(r!==null){r.return=e.return,Le=r;break}Le=e.return}}function _g(t){for(;Le!==null;){var e=Le;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{pd(4,e)}catch(c){Lt(e,r,c)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(c){Lt(e,i,c)}}var s=e.return;try{Ah(e)}catch(c){Lt(e,s,c)}break;case 5:var o=e.return;try{Ah(e)}catch(c){Lt(e,o,c)}}}catch(c){Lt(e,e.return,c)}if(e===t){Le=null;break}var l=e.sibling;if(l!==null){l.return=e.return,Le=l;break}Le=e.return}}var RS=Math.ceil,Mc=si.ReactCurrentDispatcher,Zf=si.ReactCurrentOwner,Xr=si.ReactCurrentBatchConfig,dt=0,Xt=null,Bt=null,Qt=0,Rr=0,go=zi(0),qt=0,Ka=null,hs=0,md=0,Jf=0,Ta=null,yr=null,Qf=0,Ao=1/0,Yn=null,$c=!1,Lh=null,Pi=null,$l=!1,ji=null,Lc=0,Na=0,Ih=null,uc=-1,hc=0;function hr(){return dt&6?It():uc!==-1?uc:uc=It()}function Oi(t){return t.mode&1?dt&2&&Qt!==0?Qt&-Qt:fS.transition!==null?(hc===0&&(hc=Qy()),hc):(t=yt,t!==0||(t=window.event,t=t===void 0?16:ox(t.type)),t):1}function mn(t,e,r,n){if(50<Na)throw Na=0,Ih=null,Error(je(185));il(t,r,n),(!(dt&2)||t!==Xt)&&(t===Xt&&(!(dt&2)&&(md|=r),qt===4&&bi(t,Qt)),_r(t,n),r===1&&dt===0&&!(e.mode&1)&&(Ao=It()+500,ud&&Fi()))}function _r(t,e){var r=t.callbackNode;f2(t,e);var n=xc(t,t===Xt?Qt:0);if(n===0)r!==null&&Pm(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&Pm(r),e===1)t.tag===0?hS(Sg.bind(null,t)):jx(Sg.bind(null,t)),lS(function(){!(dt&6)&&Fi()}),r=null;else{switch(ex(n)){case 1:r=jf;break;case 4:r=Zy;break;case 16:r=yc;break;case 536870912:r=Jy;break;default:r=yc}r=Sb(r,gb.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function gb(t,e){if(uc=-1,hc=0,dt&6)throw Error(je(327));var r=t.callbackNode;if(ko()&&t.callbackNode!==r)return null;var n=xc(t,t===Xt?Qt:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=Ic(t,n);else{e=n;var i=dt;dt|=2;var s=yb();(Xt!==t||Qt!==e)&&(Yn=null,Ao=It()+500,os(t,e));do try{AS();break}catch(l){vb(t,l)}while(!0);Df(),Mc.current=s,dt=i,Bt!==null?e=0:(Xt=null,Qt=0,e=qt)}if(e!==0){if(e===2&&(i=dh(t),i!==0&&(n=i,e=Dh(t,i))),e===1)throw r=Ka,os(t,0),bi(t,n),_r(t,It()),r;if(e===6)bi(t,n);else{if(i=t.current.alternate,!(n&30)&&!PS(i)&&(e=Ic(t,n),e===2&&(s=dh(t),s!==0&&(n=s,e=Dh(t,s))),e===1))throw r=Ka,os(t,0),bi(t,n),_r(t,It()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(je(345));case 2:Ki(t,yr,Yn);break;case 3:if(bi(t,n),(n&130023424)===n&&(e=Qf+500-It(),10<e)){if(xc(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){hr(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=yh(Ki.bind(null,t,yr,Yn),e);break}Ki(t,yr,Yn);break;case 4:if(bi(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var o=31-pn(n);s=1<<o,o=e[o],o>i&&(i=o),n&=~s}if(n=i,n=It()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*RS(n/1960))-n,10<n){t.timeoutHandle=yh(Ki.bind(null,t,yr,Yn),n);break}Ki(t,yr,Yn);break;case 5:Ki(t,yr,Yn);break;default:throw Error(je(329))}}}return _r(t,It()),t.callbackNode===r?gb.bind(null,t):null}function Dh(t,e){var r=Ta;return t.current.memoizedState.isDehydrated&&(os(t,e).flags|=256),t=Ic(t,e),t!==2&&(e=yr,yr=r,e!==null&&zh(e)),t}function zh(t){yr===null?yr=t:yr.push.apply(yr,t)}function PS(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!gn(s(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function bi(t,e){for(e&=~Jf,e&=~md,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-pn(e),n=1<<r;t[r]=-1,e&=~n}}function Sg(t){if(dt&6)throw Error(je(327));ko();var e=xc(t,0);if(!(e&1))return _r(t,It()),null;var r=Ic(t,e);if(t.tag!==0&&r===2){var n=dh(t);n!==0&&(e=n,r=Dh(t,n))}if(r===1)throw r=Ka,os(t,0),bi(t,e),_r(t,It()),r;if(r===6)throw Error(je(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ki(t,yr,Yn),_r(t,It()),null}function ep(t,e){var r=dt;dt|=1;try{return t(e)}finally{dt=r,dt===0&&(Ao=It()+500,ud&&Fi())}}function fs(t){ji!==null&&ji.tag===0&&!(dt&6)&&ko();var e=dt;dt|=1;var r=Xr.transition,n=yt;try{if(Xr.transition=null,yt=1,t)return t()}finally{yt=n,Xr.transition=r,dt=e,!(dt&6)&&Fi()}}function tp(){Rr=go.current,Ct(go)}function os(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,aS(r)),Bt!==null)for(r=Bt.return;r!==null;){var n=r;switch($f(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&kc();break;case 3:Po(),Ct(br),Ct(ar),Wf();break;case 5:Uf(n);break;case 4:Po();break;case 13:Ct(Pt);break;case 19:Ct(Pt);break;case 10:zf(n.type._context);break;case 22:case 23:tp()}r=r.return}if(Xt=t,Bt=t=Ai(t.current,null),Qt=Rr=e,qt=0,Ka=null,Jf=md=hs=0,yr=Ta=null,rs!==null){for(e=0;e<rs.length;e++)if(r=rs[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var o=s.next;s.next=i,n.next=o}r.pending=n}rs=null}return t}function vb(t,e){do{var r=Bt;try{if(Df(),lc.current=Ac,Oc){for(var n=Ot.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Oc=!1}if(us=0,Yt=Gt=Ot=null,Ca=!1,qa=0,Zf.current=null,r===null||r.return===null){qt=1,Ka=e,Bt=null;break}e:{var s=t,o=r.return,l=r,c=e;if(e=Qt,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=l,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=dg(o);if(p!==null){p.flags&=-257,ug(p,o,l,s,e),p.mode&1&&cg(s,d,e),e=p,c=d;var g=e.updateQueue;if(g===null){var m=new Set;m.add(c),e.updateQueue=m}else g.add(c);break e}else{if(!(e&1)){cg(s,d,e),rp();break e}c=Error(je(426))}}else if(Tt&&l.mode&1){var x=dg(o);if(x!==null){!(x.flags&65536)&&(x.flags|=256),ug(x,o,l,s,e),Lf(Oo(c,l));break e}}s=c=Oo(c,l),qt!==4&&(qt=2),Ta===null?Ta=[s]:Ta.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var v=eb(s,c,e);ng(s,v);break e;case 1:l=c;var y=s.type,b=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Pi===null||!Pi.has(b)))){s.flags|=65536,e&=-e,s.lanes|=e;var w=tb(s,l,e);ng(s,w);break e}}s=s.return}while(s!==null)}bb(r)}catch(k){e=k,Bt===r&&r!==null&&(Bt=r=r.return);continue}break}while(!0)}function yb(){var t=Mc.current;return Mc.current=Ac,t===null?Ac:t}function rp(){(qt===0||qt===3||qt===2)&&(qt=4),Xt===null||!(hs&268435455)&&!(md&268435455)||bi(Xt,Qt)}function Ic(t,e){var r=dt;dt|=2;var n=yb();(Xt!==t||Qt!==e)&&(Yn=null,os(t,e));do try{OS();break}catch(i){vb(t,i)}while(!0);if(Df(),dt=r,Mc.current=n,Bt!==null)throw Error(je(261));return Xt=null,Qt=0,qt}function OS(){for(;Bt!==null;)xb(Bt)}function AS(){for(;Bt!==null&&!i2();)xb(Bt)}function xb(t){var e=_b(t.alternate,t,Rr);t.memoizedProps=t.pendingProps,e===null?bb(t):Bt=e,Zf.current=null}function bb(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=CS(r,e),r!==null){r.flags&=32767,Bt=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{qt=6,Bt=null;return}}else if(r=jS(r,e,Rr),r!==null){Bt=r;return}if(e=e.sibling,e!==null){Bt=e;return}Bt=e=t}while(e!==null);qt===0&&(qt=5)}function Ki(t,e,r){var n=yt,i=Xr.transition;try{Xr.transition=null,yt=1,MS(t,e,r,n)}finally{Xr.transition=i,yt=n}return null}function MS(t,e,r,n){do ko();while(ji!==null);if(dt&6)throw Error(je(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(je(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if(p2(t,s),t===Xt&&(Bt=Xt=null,Qt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||$l||($l=!0,Sb(yc,function(){return ko(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Xr.transition,Xr.transition=null;var o=yt;yt=1;var l=dt;dt|=4,Zf.current=null,TS(t,r),pb(r,t),eS(gh),bc=!!mh,gh=mh=null,t.current=r,NS(r),s2(),dt=l,yt=o,Xr.transition=s}else t.current=r;if($l&&($l=!1,ji=t,Lc=i),s=t.pendingLanes,s===0&&(Pi=null),l2(r.stateNode),_r(t,It()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if($c)throw $c=!1,t=Lh,Lh=null,t;return Lc&1&&t.tag!==0&&ko(),s=t.pendingLanes,s&1?t===Ih?Na++:(Na=0,Ih=t):Na=0,Fi(),null}function ko(){if(ji!==null){var t=ex(Lc),e=Xr.transition,r=yt;try{if(Xr.transition=null,yt=16>t?16:t,ji===null)var n=!1;else{if(t=ji,ji=null,Lc=0,dt&6)throw Error(je(331));var i=dt;for(dt|=4,Le=t.current;Le!==null;){var s=Le,o=s.child;if(Le.flags&16){var l=s.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(Le=d;Le!==null;){var u=Le;switch(u.tag){case 0:case 11:case 15:Ea(8,u,s)}var f=u.child;if(f!==null)f.return=u,Le=f;else for(;Le!==null;){u=Le;var h=u.sibling,p=u.return;if(ub(u),u===d){Le=null;break}if(h!==null){h.return=p,Le=h;break}Le=p}}}var g=s.alternate;if(g!==null){var m=g.child;if(m!==null){g.child=null;do{var x=m.sibling;m.sibling=null,m=x}while(m!==null)}}Le=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,Le=o;else e:for(;Le!==null;){if(s=Le,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Ea(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,Le=v;break e}Le=s.return}}var y=t.current;for(Le=y;Le!==null;){o=Le;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,Le=b;else e:for(o=y;Le!==null;){if(l=Le,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:pd(9,l)}}catch(k){Lt(l,l.return,k)}if(l===o){Le=null;break e}var w=l.sibling;if(w!==null){w.return=l.return,Le=w;break e}Le=l.return}}if(dt=i,Fi(),An&&typeof An.onPostCommitFiberRoot=="function")try{An.onPostCommitFiberRoot(od,t)}catch{}n=!0}return n}finally{yt=r,Xr.transition=e}}return!1}function kg(t,e,r){e=Oo(r,e),e=eb(t,e,1),t=Ri(t,e,1),e=hr(),t!==null&&(il(t,1,e),_r(t,e))}function Lt(t,e,r){if(t.tag===3)kg(t,t,r);else for(;e!==null;){if(e.tag===3){kg(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Pi===null||!Pi.has(n))){t=Oo(r,t),t=tb(e,t,1),e=Ri(e,t,1),t=hr(),e!==null&&(il(e,1,t),_r(e,t));break}}e=e.return}}function $S(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=hr(),t.pingedLanes|=t.suspendedLanes&r,Xt===t&&(Qt&r)===r&&(qt===4||qt===3&&(Qt&130023424)===Qt&&500>It()-Qf?os(t,0):Jf|=r),_r(t,e)}function wb(t,e){e===0&&(t.mode&1?(e=jl,jl<<=1,!(jl&130023424)&&(jl=4194304)):e=1);var r=hr();t=ni(t,e),t!==null&&(il(t,e,r),_r(t,r))}function LS(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),wb(t,r)}function IS(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(je(314))}n!==null&&n.delete(e),wb(t,r)}var _b;_b=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||br.current)xr=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return xr=!1,kS(t,e,r);xr=!!(t.flags&131072)}else xr=!1,Tt&&e.flags&1048576&&Cx(e,Ec,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;dc(t,e),t=e.pendingProps;var i=To(e,ar.current);So(e,r),i=Vf(null,e,n,t,i,r);var s=qf();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,wr(n)?(s=!0,jc(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Bf(e),i.updater=fd,e.stateNode=i,i._reactInternals=e,jh(e,n,t,r),e=Th(null,e,n,!0,s,r)):(e.tag=0,Tt&&s&&Mf(e),dr(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(dc(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=zS(n),t=ln(n,t),i){case 0:e=Eh(null,e,n,t,r);break e;case 1:e=pg(null,e,n,t,r);break e;case 11:e=hg(null,e,n,t,r);break e;case 14:e=fg(null,e,n,ln(n.type,t),r);break e}throw Error(je(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:ln(n,i),Eh(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:ln(n,i),pg(t,e,n,i,r);case 3:e:{if(sb(e),t===null)throw Error(je(387));n=e.pendingProps,s=e.memoizedState,i=s.element,Ox(t,e),Rc(e,n,null,r);var o=e.memoizedState;if(n=o.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Oo(Error(je(423)),e),e=mg(t,e,n,r,i);break e}else if(n!==i){i=Oo(Error(je(424)),e),e=mg(t,e,n,r,i);break e}else for(Ar=Ni(e.stateNode.containerInfo.firstChild),Lr=e,Tt=!0,hn=null,r=Rx(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(No(),n===i){e=ii(t,e,r);break e}dr(t,e,n,r)}e=e.child}return e;case 5:return Ax(e),t===null&&_h(e),n=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,vh(n,i)?o=null:s!==null&&vh(n,s)&&(e.flags|=32),ib(t,e),dr(t,e,o,r),e.child;case 6:return t===null&&_h(e),null;case 13:return ob(t,e,r);case 4:return Hf(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=Ro(e,null,n,r):dr(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:ln(n,i),hg(t,e,n,i,r);case 7:return dr(t,e,e.pendingProps,r),e.child;case 8:return dr(t,e,e.pendingProps.children,r),e.child;case 12:return dr(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,wt(Tc,n._currentValue),n._currentValue=o,s!==null)if(gn(s.value,o)){if(s.children===i.children&&!br.current){e=ii(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(s.tag===1){c=Qn(-1,r&-r),c.tag=2;var d=s.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}s.lanes|=r,c=s.alternate,c!==null&&(c.lanes|=r),Sh(s.return,r,e),l.lanes|=r;break}c=c.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(je(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),Sh(o,r,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}dr(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,So(e,r),i=Kr(i),n=n(i),e.flags|=1,dr(t,e,n,r),e.child;case 14:return n=e.type,i=ln(n,e.pendingProps),i=ln(n.type,i),fg(t,e,n,i,r);case 15:return rb(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:ln(n,i),dc(t,e),e.tag=1,wr(n)?(t=!0,jc(e)):t=!1,So(e,r),Qx(e,n,i),jh(e,n,i,r),Th(null,e,n,!0,t,r);case 19:return ab(t,e,r);case 22:return nb(t,e,r)}throw Error(je(156,e.tag))};function Sb(t,e){return Ky(t,e)}function DS(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Yr(t,e,r,n){return new DS(t,e,r,n)}function np(t){return t=t.prototype,!(!t||!t.isReactComponent)}function zS(t){if(typeof t=="function")return np(t)?1:0;if(t!=null){if(t=t.$$typeof,t===_f)return 11;if(t===Sf)return 14}return 2}function Ai(t,e){var r=t.alternate;return r===null?(r=Yr(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function fc(t,e,r,n,i,s){var o=2;if(n=t,typeof t=="function")np(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case so:return as(r.children,i,s,e);case wf:o=8,i|=8;break;case Xu:return t=Yr(12,r,e,i|2),t.elementType=Xu,t.lanes=s,t;case Ku:return t=Yr(13,r,e,i),t.elementType=Ku,t.lanes=s,t;case Zu:return t=Yr(19,r,e,i),t.elementType=Zu,t.lanes=s,t;case Ay:return gd(r,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Py:o=10;break e;case Oy:o=9;break e;case _f:o=11;break e;case Sf:o=14;break e;case mi:o=16,n=null;break e}throw Error(je(130,t==null?t:typeof t,""))}return e=Yr(o,r,e,i),e.elementType=t,e.type=n,e.lanes=s,e}function as(t,e,r,n){return t=Yr(7,t,n,e),t.lanes=r,t}function gd(t,e,r,n){return t=Yr(22,t,n,e),t.elementType=Ay,t.lanes=r,t.stateNode={isHidden:!1},t}function uu(t,e,r){return t=Yr(6,t,null,e),t.lanes=r,t}function hu(t,e,r){return e=Yr(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function FS(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Vd(0),this.expirationTimes=Vd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Vd(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function ip(t,e,r,n,i,s,o,l,c){return t=new FS(t,e,r,l,c),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Yr(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Bf(s),t}function BS(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:io,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function kb(t){if(!t)return $i;t=t._reactInternals;e:{if(gs(t)!==t||t.tag!==1)throw Error(je(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(wr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(je(171))}if(t.tag===1){var r=t.type;if(wr(r))return kx(t,r,e)}return e}function jb(t,e,r,n,i,s,o,l,c){return t=ip(r,n,!0,t,i,s,o,l,c),t.context=kb(null),r=t.current,n=hr(),i=Oi(r),s=Qn(n,i),s.callback=e??null,Ri(r,s,i),t.current.lanes=i,il(t,i,n),_r(t,n),t}function vd(t,e,r,n){var i=e.current,s=hr(),o=Oi(i);return r=kb(r),e.context===null?e.context=r:e.pendingContext=r,e=Qn(s,o),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Ri(i,e,o),t!==null&&(mn(t,i,o,s),ac(t,i,o)),o}function Dc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function jg(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function sp(t,e){jg(t,e),(t=t.alternate)&&jg(t,e)}function HS(){return null}var Cb=typeof reportError=="function"?reportError:function(t){console.error(t)};function op(t){this._internalRoot=t}yd.prototype.render=op.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(je(409));vd(t,e,null,null)};yd.prototype.unmount=op.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;fs(function(){vd(null,t,null,null)}),e[ri]=null}};function yd(t){this._internalRoot=t}yd.prototype.unstable_scheduleHydration=function(t){if(t){var e=nx();t={blockedOn:null,target:t,priority:e};for(var r=0;r<xi.length&&e!==0&&e<xi[r].priority;r++);xi.splice(r,0,t),r===0&&sx(t)}};function ap(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function xd(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Cg(){}function US(t,e,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var d=Dc(o);s.call(d)}}var o=jb(e,n,t,0,null,!1,!1,"",Cg);return t._reactRootContainer=o,t[ri]=o.current,Ha(t.nodeType===8?t.parentNode:t),fs(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var l=n;n=function(){var d=Dc(c);l.call(d)}}var c=ip(t,0,!1,null,null,!1,!1,"",Cg);return t._reactRootContainer=c,t[ri]=c.current,Ha(t.nodeType===8?t.parentNode:t),fs(function(){vd(e,c,r,n)}),c}function bd(t,e,r,n,i){var s=r._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var l=i;i=function(){var c=Dc(o);l.call(c)}}vd(e,o,t,i)}else o=US(r,e,t,i,n);return Dc(o)}tx=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=ma(e.pendingLanes);r!==0&&(Cf(e,r|1),_r(e,It()),!(dt&6)&&(Ao=It()+500,Fi()))}break;case 13:fs(function(){var n=ni(t,1);if(n!==null){var i=hr();mn(n,t,1,i)}}),sp(t,1)}};Ef=function(t){if(t.tag===13){var e=ni(t,134217728);if(e!==null){var r=hr();mn(e,t,134217728,r)}sp(t,134217728)}};rx=function(t){if(t.tag===13){var e=Oi(t),r=ni(t,e);if(r!==null){var n=hr();mn(r,t,e,n)}sp(t,e)}};nx=function(){return yt};ix=function(t,e){var r=yt;try{return yt=t,e()}finally{yt=r}};ah=function(t,e,r){switch(e){case"input":if(eh(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=dd(n);if(!i)throw Error(je(90));$y(n),eh(n,i)}}}break;case"textarea":Iy(t,r);break;case"select":e=r.value,e!=null&&xo(t,!!r.multiple,e,!1)}};Wy=ep;Gy=fs;var WS={usingClientEntryPoint:!1,Events:[ol,co,dd,Hy,Uy,ep]},oa={findFiberByHostInstance:ts,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},GS={bundleType:oa.bundleType,version:oa.version,rendererPackageName:oa.rendererPackageName,rendererConfig:oa.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:si.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Yy(t),t===null?null:t.stateNode},findFiberByHostInstance:oa.findFiberByHostInstance||HS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ll=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ll.isDisabled&&Ll.supportsFiber)try{od=Ll.inject(GS),An=Ll}catch{}}zr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=WS;zr.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ap(e))throw Error(je(200));return BS(t,e,null,r)};zr.createRoot=function(t,e){if(!ap(t))throw Error(je(299));var r=!1,n="",i=Cb;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=ip(t,1,!1,null,null,r,!1,n,i),t[ri]=e.current,Ha(t.nodeType===8?t.parentNode:t),new op(e)};zr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(je(188)):(t=Object.keys(t).join(","),Error(je(268,t)));return t=Yy(e),t=t===null?null:t.stateNode,t};zr.flushSync=function(t){return fs(t)};zr.hydrate=function(t,e,r){if(!xd(e))throw Error(je(200));return bd(null,t,e,!0,r)};zr.hydrateRoot=function(t,e,r){if(!ap(t))throw Error(je(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",o=Cb;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),e=jb(e,null,t,1,r??null,i,!1,s,o),t[ri]=e.current,Ha(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new yd(e)};zr.render=function(t,e,r){if(!xd(e))throw Error(je(200));return bd(null,t,e,!1,r)};zr.unmountComponentAtNode=function(t){if(!xd(t))throw Error(je(40));return t._reactRootContainer?(fs(function(){bd(null,null,t,!1,function(){t._reactRootContainer=null,t[ri]=null})}),!0):!1};zr.unstable_batchedUpdates=ep;zr.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!xd(r))throw Error(je(200));if(t==null||t._reactInternals===void 0)throw Error(je(38));return bd(t,e,r,!1,n)};zr.version="18.3.1-next-f1338f8080-20240426";function Eb(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Eb)}catch(t){console.error(t)}}Eb(),Ey.exports=zr;var VS=Ey.exports,Eg=VS;qu.createRoot=Eg.createRoot,qu.hydrateRoot=Eg.hydrateRoot;var Fh=function(t,e){return Fh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},Fh(t,e)};function Tb(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Fh(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var zc=function(){return zc=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},zc.apply(this,arguments)};function Do(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function Nb(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(i<3?o(s):i>3?o(e,r,s):o(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function Rb(t,e){return function(r,n){e(r,n,t)}}function Pb(t,e,r,n,i,s){function o(v){if(v!==void 0&&typeof v!="function")throw new TypeError("Function expected");return v}for(var l=n.kind,c=l==="getter"?"get":l==="setter"?"set":"value",d=!e&&t?n.static?t:t.prototype:null,u=e||(d?Object.getOwnPropertyDescriptor(d,n.name):{}),f,h=!1,p=r.length-1;p>=0;p--){var g={};for(var m in n)g[m]=m==="access"?{}:n[m];for(var m in n.access)g.access[m]=n.access[m];g.addInitializer=function(v){if(h)throw new TypeError("Cannot add initializers after decoration has completed");s.push(o(v||null))};var x=(0,r[p])(l==="accessor"?{get:u.get,set:u.set}:u[c],g);if(l==="accessor"){if(x===void 0)continue;if(x===null||typeof x!="object")throw new TypeError("Object expected");(f=o(x.get))&&(u.get=f),(f=o(x.set))&&(u.set=f),(f=o(x.init))&&i.unshift(f)}else(f=o(x))&&(l==="field"?i.unshift(f):u[c]=f)}d&&Object.defineProperty(d,n.name,u),h=!0}function Ob(t,e,r){for(var n=arguments.length>2,i=0;i<e.length;i++)r=n?e[i].call(t,r):e[i].call(t);return n?r:void 0}function Ab(t){return typeof t=="symbol"?t:"".concat(t)}function Mb(t,e,r){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(t,"name",{configurable:!0,value:r?"".concat(r," ",e):e})}function $b(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function ze(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function l(u){try{d(n.next(u))}catch(f){o(f)}}function c(u){try{d(n.throw(u))}catch(f){o(f)}}function d(u){u.done?s(u.value):i(u.value).then(l,c)}d((n=n.apply(t,e||[])).next())})}function Lb(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=l(0),o.throw=l(1),o.return=l(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(d){return function(u){return c([d,u])}}function c(d){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,d[0]&&(r=0)),r;)try{if(n=1,i&&(s=d[0]&2?i.return:d[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,d[1])).done)return s;switch(i=0,s&&(d=[d[0]&2,s.value]),d[0]){case 0:case 1:s=d;break;case 4:return r.label++,{value:d[1],done:!1};case 5:r.label++,i=d[1],d=[0];continue;case 7:d=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(d[0]===6||d[0]===2)){r=0;continue}if(d[0]===3&&(!s||d[1]>s[0]&&d[1]<s[3])){r.label=d[1];break}if(d[0]===6&&r.label<s[1]){r.label=s[1],s=d;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(d);break}s[2]&&r.ops.pop(),r.trys.pop();continue}d=e.call(t,r)}catch(u){d=[6,u],i=0}finally{n=s=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}var wd=Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]};function Ib(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&wd(e,t,r)}function Fc(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function lp(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(l){o={error:l}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}function Db(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(lp(arguments[e]));return t}function zb(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],o=0,l=s.length;o<l;o++,i++)n[i]=s[o];return n}function Fb(t,e,r){if(r||arguments.length===2)for(var n=0,i=e.length,s;n<i;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))}function Mo(t){return this instanceof Mo?(this.v=t,this):new Mo(t)}function Bb(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(p){return function(g){return Promise.resolve(g).then(p,f)}}function l(p,g){n[p]&&(i[p]=function(m){return new Promise(function(x,v){s.push([p,m,x,v])>1||c(p,m)})},g&&(i[p]=g(i[p])))}function c(p,g){try{d(n[p](g))}catch(m){h(s[0][3],m)}}function d(p){p.value instanceof Mo?Promise.resolve(p.value.v).then(u,f):h(s[0][2],p)}function u(p){c("next",p)}function f(p){c("throw",p)}function h(p,g){p(g),s.shift(),s.length&&c(s[0][0],s[0][1])}}function Hb(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(o){return(r=!r)?{value:Mo(t[i](o)),done:!1}:s?s(o):o}:s}}function Ub(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Fc=="function"?Fc(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(o){return new Promise(function(l,c){o=t[s](o),i(l,c,o.done,o.value)})}}function i(s,o,l,c){Promise.resolve(c).then(function(d){s({value:d,done:l})},o)}}function Wb(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}var qS=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e},Bh=function(t){return Bh=Object.getOwnPropertyNames||function(e){var r=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[r.length]=n);return r},Bh(t)};function Gb(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r=Bh(t),n=0;n<r.length;n++)r[n]!=="default"&&wd(e,t,r[n]);return qS(e,t),e}function Vb(t){return t&&t.__esModule?t:{default:t}}function qb(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)}function Yb(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r}function Xb(t,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof t=="function"?e===t:t.has(e)}function Kb(t,e,r){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var n,i;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=e[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=e[Symbol.dispose],r&&(i=n)}if(typeof n!="function")throw new TypeError("Object not disposable.");i&&(n=function(){try{i.call(this)}catch(s){return Promise.reject(s)}}),t.stack.push({value:e,dispose:n,async:r})}else r&&t.stack.push({async:!0});return e}var YS=typeof SuppressedError=="function"?SuppressedError:function(t,e,r){var n=new Error(r);return n.name="SuppressedError",n.error=t,n.suppressed=e,n};function Zb(t){function e(s){t.error=t.hasError?new YS(s,t.error,"An error was suppressed during disposal."):s,t.hasError=!0}var r,n=0;function i(){for(;r=t.stack.pop();)try{if(!r.async&&n===1)return n=0,t.stack.push(r),Promise.resolve().then(i);if(r.dispose){var s=r.dispose.call(r.value);if(r.async)return n|=2,Promise.resolve(s).then(i,function(o){return e(o),i()})}else n|=1}catch(o){e(o)}if(n===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return i()}function Jb(t,e){return typeof t=="string"&&/^\.\.?\//.test(t)?t.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(r,n,i,s,o){return n?e?".jsx":".js":i&&(!s||!o)?r:i+s+"."+o.toLowerCase()+"js"}):t}const XS={__extends:Tb,__assign:zc,__rest:Do,__decorate:Nb,__param:Rb,__esDecorate:Pb,__runInitializers:Ob,__propKey:Ab,__setFunctionName:Mb,__metadata:$b,__awaiter:ze,__generator:Lb,__createBinding:wd,__exportStar:Ib,__values:Fc,__read:lp,__spread:Db,__spreadArrays:zb,__spreadArray:Fb,__await:Mo,__asyncGenerator:Bb,__asyncDelegator:Hb,__asyncValues:Ub,__makeTemplateObject:Wb,__importStar:Gb,__importDefault:Vb,__classPrivateFieldGet:qb,__classPrivateFieldSet:Yb,__classPrivateFieldIn:Xb,__addDisposableResource:Kb,__disposeResources:Zb,__rewriteRelativeImportExtension:Jb},KS=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:Kb,get __assign(){return zc},__asyncDelegator:Hb,__asyncGenerator:Bb,__asyncValues:Ub,__await:Mo,__awaiter:ze,__classPrivateFieldGet:qb,__classPrivateFieldIn:Xb,__classPrivateFieldSet:Yb,__createBinding:wd,__decorate:Nb,__disposeResources:Zb,__esDecorate:Pb,__exportStar:Ib,__extends:Tb,__generator:Lb,__importDefault:Vb,__importStar:Gb,__makeTemplateObject:Wb,__metadata:$b,__param:Rb,__propKey:Ab,__read:lp,__rest:Do,__rewriteRelativeImportExtension:Jb,__runInitializers:Ob,__setFunctionName:Mb,__spread:Db,__spreadArray:Fb,__spreadArrays:zb,__values:Fc,default:XS},Symbol.toStringTag,{value:"Module"})),ZS=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class cp extends Error{constructor(e,r="FunctionsError",n){super(e),this.name=r,this.context=n}}class Tg extends cp{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Ng extends cp{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Rg extends cp{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Hh;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Hh||(Hh={}));class JS{constructor(e,{headers:r={},customFetch:n,region:i=Hh.Any}={}){this.url=e,this.headers=r,this.region=i,this.fetch=ZS(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return ze(this,arguments,void 0,function*(r,n={}){var i;try{const{headers:s,method:o,body:l,signal:c}=n;let d={},{region:u}=n;u||(u=this.region);const f=new URL(`${this.url}/${r}`);u&&u!=="any"&&(d["x-region"]=u,f.searchParams.set("forceFunctionRegion",u));let h;l&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)?typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(d["Content-Type"]="application/octet-stream",h=l):typeof l=="string"?(d["Content-Type"]="text/plain",h=l):typeof FormData<"u"&&l instanceof FormData?h=l:(d["Content-Type"]="application/json",h=JSON.stringify(l)):h=l;const p=yield this.fetch(f.toString(),{method:o||"POST",headers:Object.assign(Object.assign(Object.assign({},d),this.headers),s),body:h,signal:c}).catch(v=>{throw v.name==="AbortError"?v:new Tg(v)}),g=p.headers.get("x-relay-error");if(g&&g==="true")throw new Ng(p);if(!p.ok)throw new Rg(p);let m=((i=p.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),x;return m==="application/json"?x=yield p.json():m==="application/octet-stream"||m==="application/pdf"?x=yield p.blob():m==="text/event-stream"?x=p:m==="multipart/form-data"?x=yield p.formData():x=yield p.text(),{data:x,error:null,response:p}}catch(s){return s instanceof Error&&s.name==="AbortError"?{data:null,error:new Tg(s)}:{data:null,error:s,response:s instanceof Rg||s instanceof Ng?s.context:void 0}}})}}var ur={};const zo=b_(KS);var Il={},Dl={},zl={},Fl={},Bl={},Hl={},Pg;function Qb(){if(Pg)return Hl;Pg=1,Object.defineProperty(Hl,"__esModule",{value:!0});class t extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return Hl.default=t,Hl}var Og;function ew(){if(Og)return Bl;Og=1,Object.defineProperty(Bl,"__esModule",{value:!0});const e=zo.__importDefault(Qb());class r{constructor(i){var s,o;this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=new Headers(i.headers),this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=(s=i.shouldThrowOnError)!==null&&s!==void 0?s:!1,this.signal=i.signal,this.isMaybeSingle=(o=i.isMaybeSingle)!==null&&o!==void 0?o:!1,i.fetch?this.fetch=i.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,s){return this.headers=new Headers(this.headers),this.headers.set(i,s),this}then(i,s){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const o=this.fetch;let l=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var d,u,f,h;let p=null,g=null,m=null,x=c.status,v=c.statusText;if(c.ok){if(this.method!=="HEAD"){const k=await c.text();k===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((d=this.headers.get("Accept"))===null||d===void 0)&&d.includes("application/vnd.pgrst.plan+text"))?g=k:g=JSON.parse(k))}const b=(u=this.headers.get("Prefer"))===null||u===void 0?void 0:u.match(/count=(exact|planned|estimated)/),w=(f=c.headers.get("content-range"))===null||f===void 0?void 0:f.split("/");b&&w&&w.length>1&&(m=parseInt(w[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(g)&&(g.length>1?(p={code:"PGRST116",details:`Results contain ${g.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},g=null,m=null,x=406,v="Not Acceptable"):g.length===1?g=g[0]:g=null)}else{const b=await c.text();try{p=JSON.parse(b),Array.isArray(p)&&c.status===404&&(g=[],p=null,x=200,v="OK")}catch{c.status===404&&b===""?(x=204,v="No Content"):p={message:b}}if(p&&this.isMaybeSingle&&(!((h=p==null?void 0:p.details)===null||h===void 0)&&h.includes("0 rows"))&&(p=null,x=200,v="OK"),p&&this.shouldThrowOnError)throw new e.default(p)}return{error:p,data:g,count:m,status:x,statusText:v}});return this.shouldThrowOnError||(l=l.catch(c=>{var d,u,f;return{error:{message:`${(d=c==null?void 0:c.name)!==null&&d!==void 0?d:"FetchError"}: ${c==null?void 0:c.message}`,details:`${(u=c==null?void 0:c.stack)!==null&&u!==void 0?u:""}`,hint:"",code:`${(f=c==null?void 0:c.code)!==null&&f!==void 0?f:""}`},data:null,count:null,status:0,statusText:""}})),l.then(i,s)}returns(){return this}overrideTypes(){return this}}return Bl.default=r,Bl}var Ag;function tw(){if(Ag)return Fl;Ag=1,Object.defineProperty(Fl,"__esModule",{value:!0});const e=zo.__importDefault(ew());class r extends e.default{select(i){let s=!1;const o=(i??"*").split("").map(l=>/\s/.test(l)&&!s?"":(l==='"'&&(s=!s),l)).join("");return this.url.searchParams.set("select",o),this.headers.append("Prefer","return=representation"),this}order(i,{ascending:s=!0,nullsFirst:o,foreignTable:l,referencedTable:c=l}={}){const d=c?`${c}.order`:"order",u=this.url.searchParams.get(d);return this.url.searchParams.set(d,`${u?`${u},`:""}${i}.${s?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(i,{foreignTable:s,referencedTable:o=s}={}){const l=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(l,`${i}`),this}range(i,s,{foreignTable:o,referencedTable:l=o}={}){const c=typeof l>"u"?"offset":`${l}.offset`,d=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${i}`),this.url.searchParams.set(d,`${s-i+1}`),this}abortSignal(i){return this.signal=i,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:i=!1,verbose:s=!1,settings:o=!1,buffers:l=!1,wal:c=!1,format:d="text"}={}){var u;const f=[i?"analyze":null,s?"verbose":null,o?"settings":null,l?"buffers":null,c?"wal":null].filter(Boolean).join("|"),h=(u=this.headers.get("Accept"))!==null&&u!==void 0?u:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${d}; for="${h}"; options=${f};`),d==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(i){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${i}`),this}}return Fl.default=r,Fl}var Mg;function dp(){if(Mg)return zl;Mg=1,Object.defineProperty(zl,"__esModule",{value:!0});const e=zo.__importDefault(tw()),r=new RegExp("[,()]");class n extends e.default{eq(s,o){return this.url.searchParams.append(s,`eq.${o}`),this}neq(s,o){return this.url.searchParams.append(s,`neq.${o}`),this}gt(s,o){return this.url.searchParams.append(s,`gt.${o}`),this}gte(s,o){return this.url.searchParams.append(s,`gte.${o}`),this}lt(s,o){return this.url.searchParams.append(s,`lt.${o}`),this}lte(s,o){return this.url.searchParams.append(s,`lte.${o}`),this}like(s,o){return this.url.searchParams.append(s,`like.${o}`),this}likeAllOf(s,o){return this.url.searchParams.append(s,`like(all).{${o.join(",")}}`),this}likeAnyOf(s,o){return this.url.searchParams.append(s,`like(any).{${o.join(",")}}`),this}ilike(s,o){return this.url.searchParams.append(s,`ilike.${o}`),this}ilikeAllOf(s,o){return this.url.searchParams.append(s,`ilike(all).{${o.join(",")}}`),this}ilikeAnyOf(s,o){return this.url.searchParams.append(s,`ilike(any).{${o.join(",")}}`),this}is(s,o){return this.url.searchParams.append(s,`is.${o}`),this}in(s,o){const l=Array.from(new Set(o)).map(c=>typeof c=="string"&&r.test(c)?`"${c}"`:`${c}`).join(",");return this.url.searchParams.append(s,`in.(${l})`),this}contains(s,o){return typeof o=="string"?this.url.searchParams.append(s,`cs.${o}`):Array.isArray(o)?this.url.searchParams.append(s,`cs.{${o.join(",")}}`):this.url.searchParams.append(s,`cs.${JSON.stringify(o)}`),this}containedBy(s,o){return typeof o=="string"?this.url.searchParams.append(s,`cd.${o}`):Array.isArray(o)?this.url.searchParams.append(s,`cd.{${o.join(",")}}`):this.url.searchParams.append(s,`cd.${JSON.stringify(o)}`),this}rangeGt(s,o){return this.url.searchParams.append(s,`sr.${o}`),this}rangeGte(s,o){return this.url.searchParams.append(s,`nxl.${o}`),this}rangeLt(s,o){return this.url.searchParams.append(s,`sl.${o}`),this}rangeLte(s,o){return this.url.searchParams.append(s,`nxr.${o}`),this}rangeAdjacent(s,o){return this.url.searchParams.append(s,`adj.${o}`),this}overlaps(s,o){return typeof o=="string"?this.url.searchParams.append(s,`ov.${o}`):this.url.searchParams.append(s,`ov.{${o.join(",")}}`),this}textSearch(s,o,{config:l,type:c}={}){let d="";c==="plain"?d="pl":c==="phrase"?d="ph":c==="websearch"&&(d="w");const u=l===void 0?"":`(${l})`;return this.url.searchParams.append(s,`${d}fts${u}.${o}`),this}match(s){return Object.entries(s).forEach(([o,l])=>{this.url.searchParams.append(o,`eq.${l}`)}),this}not(s,o,l){return this.url.searchParams.append(s,`not.${o}.${l}`),this}or(s,{foreignTable:o,referencedTable:l=o}={}){const c=l?`${l}.or`:"or";return this.url.searchParams.append(c,`(${s})`),this}filter(s,o,l){return this.url.searchParams.append(s,`${o}.${l}`),this}}return zl.default=n,zl}var $g;function rw(){if($g)return Dl;$g=1,Object.defineProperty(Dl,"__esModule",{value:!0});const e=zo.__importDefault(dp());class r{constructor(i,{headers:s={},schema:o,fetch:l}){this.url=i,this.headers=new Headers(s),this.schema=o,this.fetch=l}select(i,s){const{head:o=!1,count:l}=s??{},c=o?"HEAD":"GET";let d=!1;const u=(i??"*").split("").map(f=>/\s/.test(f)&&!d?"":(f==='"'&&(d=!d),f)).join("");return this.url.searchParams.set("select",u),l&&this.headers.append("Prefer",`count=${l}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(i,{count:s,defaultToNull:o=!0}={}){var l;const c="POST";if(s&&this.headers.append("Prefer",`count=${s}`),o||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const d=i.reduce((u,f)=>u.concat(Object.keys(f)),[]);if(d.length>0){const u=[...new Set(d)].map(f=>`"${f}"`);this.url.searchParams.set("columns",u.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}upsert(i,{onConflict:s,ignoreDuplicates:o=!1,count:l,defaultToNull:c=!0}={}){var d;const u="POST";if(this.headers.append("Prefer",`resolution=${o?"ignore":"merge"}-duplicates`),s!==void 0&&this.url.searchParams.set("on_conflict",s),l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const f=i.reduce((h,p)=>h.concat(Object.keys(p)),[]);if(f.length>0){const h=[...new Set(f)].map(p=>`"${p}"`);this.url.searchParams.set("columns",h.join(","))}}return new e.default({method:u,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}update(i,{count:s}={}){var o;const l="PATCH";return s&&this.headers.append("Prefer",`count=${s}`),new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}delete({count:i}={}){var s;const o="DELETE";return i&&this.headers.append("Prefer",`count=${i}`),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}}return Dl.default=r,Dl}var Lg;function QS(){if(Lg)return Il;Lg=1,Object.defineProperty(Il,"__esModule",{value:!0});const t=zo,e=t.__importDefault(rw()),r=t.__importDefault(dp());class n{constructor(s,{headers:o={},schema:l,fetch:c}={}){this.url=s,this.headers=new Headers(o),this.schemaName=l,this.fetch=c}from(s){const o=new URL(`${this.url}/${s}`);return new e.default(o,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(s){return new n(this.url,{headers:this.headers,schema:s,fetch:this.fetch})}rpc(s,o={},{head:l=!1,get:c=!1,count:d}={}){var u;let f;const h=new URL(`${this.url}/rpc/${s}`);let p;l||c?(f=l?"HEAD":"GET",Object.entries(o).filter(([m,x])=>x!==void 0).map(([m,x])=>[m,Array.isArray(x)?`{${x.join(",")}}`:`${x}`]).forEach(([m,x])=>{h.searchParams.append(m,x)})):(f="POST",p=o);const g=new Headers(this.headers);return d&&g.set("Prefer",`count=${d}`),new r.default({method:f,url:h,headers:g,schema:this.schemaName,body:p,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}}return Il.default=n,Il}Object.defineProperty(ur,"__esModule",{value:!0});var nw=ur.PostgrestError=fw=ur.PostgrestBuilder=uw=ur.PostgrestTransformBuilder=cw=ur.PostgrestFilterBuilder=aw=ur.PostgrestQueryBuilder=sw=ur.PostgrestClient=void 0;const Fo=zo,iw=Fo.__importDefault(QS());var sw=ur.PostgrestClient=iw.default;const ow=Fo.__importDefault(rw());var aw=ur.PostgrestQueryBuilder=ow.default;const lw=Fo.__importDefault(dp());var cw=ur.PostgrestFilterBuilder=lw.default;const dw=Fo.__importDefault(tw());var uw=ur.PostgrestTransformBuilder=dw.default;const hw=Fo.__importDefault(ew());var fw=ur.PostgrestBuilder=hw.default;const pw=Fo.__importDefault(Qb());nw=ur.PostgrestError=pw.default;var mw=ur.default={PostgrestClient:iw.default,PostgrestQueryBuilder:ow.default,PostgrestFilterBuilder:lw.default,PostgrestTransformBuilder:dw.default,PostgrestBuilder:hw.default,PostgrestError:pw.default};const ek=x_({__proto__:null,get PostgrestBuilder(){return fw},get PostgrestClient(){return sw},get PostgrestError(){return nw},get PostgrestFilterBuilder(){return cw},get PostgrestQueryBuilder(){return aw},get PostgrestTransformBuilder(){return uw},default:mw},[ur]),{PostgrestClient:tk,PostgrestQueryBuilder:ZH,PostgrestFilterBuilder:JH,PostgrestTransformBuilder:QH,PostgrestBuilder:eU,PostgrestError:tU}=mw||ek;class rk{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,i=parseInt(n.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let r=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(r+=`

Suggested solution: ${e.workaround}`),new Error(r)}static createWebSocket(e,r){const n=this.getWebSocketConstructor();return new n(e,r)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const nk="2.79.0",ik=`realtime-js/${nk}`,sk="1.0.0",Uh=1e4,ok=1e3,ak=100;var Ra;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Ra||(Ra={}));var Wt;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(Wt||(Wt={}));var un;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(un||(un={}));var Wh;(function(t){t.websocket="websocket"})(Wh||(Wh={}));var Qi;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Qi||(Qi={}));class lk{constructor(){this.HEADER_LENGTH=1}decode(e,r){return e.constructor===ArrayBuffer?r(this._binaryDecode(e)):r(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const r=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,r,n)}_decodeBroadcast(e,r,n){const i=r.getUint8(1),s=r.getUint8(2);let o=this.HEADER_LENGTH+2;const l=n.decode(e.slice(o,o+i));o=o+i;const c=n.decode(e.slice(o,o+s));o=o+s;const d=JSON.parse(n.decode(e.slice(o,e.byteLength)));return{ref:null,topic:l,event:c,payload:d}}}class gw{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var xt;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(xt||(xt={}));const Ig=(t,e,r={})=>{var n;const i=(n=r.skipTypes)!==null&&n!==void 0?n:[];return e?Object.keys(e).reduce((s,o)=>(s[o]=ck(o,t,e,i),s),{}):{}},ck=(t,e,r,n)=>{const i=e.find(l=>l.name===t),s=i==null?void 0:i.type,o=r[t];return s&&!n.includes(s)?vw(s,o):Gh(o)},vw=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return fk(e,r)}switch(t){case xt.bool:return dk(e);case xt.float4:case xt.float8:case xt.int2:case xt.int4:case xt.int8:case xt.numeric:case xt.oid:return uk(e);case xt.json:case xt.jsonb:return hk(e);case xt.timestamp:return pk(e);case xt.abstime:case xt.date:case xt.daterange:case xt.int4range:case xt.int8range:case xt.money:case xt.reltime:case xt.text:case xt.time:case xt.timestamptz:case xt.timetz:case xt.tsrange:case xt.tstzrange:return Gh(e);default:return Gh(e)}},Gh=t=>t,dk=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},uk=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},hk=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},fk=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,n=t[r];if(t[0]==="{"&&n==="}"){let s;const o=t.slice(1,r);try{s=JSON.parse("["+o+"]")}catch{s=o?o.split(","):[]}return s.map(l=>vw(e,l))}return t},pk=t=>typeof t=="string"?t.replace(" ","T"):t,yw=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class fu{constructor(e,r,n={},i=Uh){this.channel=e,this.event=r,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var n;return this._hasReceived(e)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Dg;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Dg||(Dg={}));class Pa{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:s,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Pa.syncState(this.state,i,s,o),this.pendingDiffs.forEach(c=>{this.state=Pa.syncDiff(this.state,c,s,o)}),this.pendingDiffs=[],l()}),this.channel._on(n.diff,{},i=>{const{onJoin:s,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=Pa.syncDiff(this.state,i,s,o),l())}),this.onJoin((i,s,o)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:s,newPresences:o})}),this.onLeave((i,s,o)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:s,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,n,i){const s=this.cloneDeep(e),o=this.transformState(r),l={},c={};return this.map(s,(d,u)=>{o[d]||(c[d]=u)}),this.map(o,(d,u)=>{const f=s[d];if(f){const h=u.map(x=>x.presence_ref),p=f.map(x=>x.presence_ref),g=u.filter(x=>p.indexOf(x.presence_ref)<0),m=f.filter(x=>h.indexOf(x.presence_ref)<0);g.length>0&&(l[d]=g),m.length>0&&(c[d]=m)}else l[d]=u}),this.syncDiff(s,{joins:l,leaves:c},n,i)}static syncDiff(e,r,n,i){const{joins:s,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(s,(l,c)=>{var d;const u=(d=e[l])!==null&&d!==void 0?d:[];if(e[l]=this.cloneDeep(c),u.length>0){const f=e[l].map(p=>p.presence_ref),h=u.filter(p=>f.indexOf(p.presence_ref)<0);e[l].unshift(...h)}n(l,u,c)}),this.map(o,(l,c)=>{let d=e[l];if(!d)return;const u=c.map(f=>f.presence_ref);d=d.filter(f=>u.indexOf(f.presence_ref)<0),e[l]=d,i(l,d,c),d.length===0&&delete e[l]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(n=>r(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,n)=>{const i=e[n];return"metas"in i?r[n]=i.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=i,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var zg;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(zg||(zg={}));var Oa;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(Oa||(Oa={}));var Xn;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Xn||(Xn={}));class up{constructor(e,r={config:{}},n){var i,s;if(this.topic=e,this.params=r,this.socket=n,this.bindings={},this.state=Wt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new fu(this,un.join,this.params,this.timeout),this.rejoinTimer=new gw(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Wt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Wt.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Wt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Wt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Wt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(un.reply,{},(o,l)=>{this._trigger(this._replyEventName(l),o)}),this.presence=new Pa(this),this.broadcastEndpointURL=yw(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((s=(i=this.params.config)===null||i===void 0?void 0:i.broadcast)===null||s===void 0)&&s.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,r=this.timeout){var n,i,s;if(this.socket.isConnected()||this.socket.connect(),this.state==Wt.closed){const{config:{broadcast:o,presence:l,private:c}}=this.params,d=(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(p=>p.filter))!==null&&i!==void 0?i:[],u=!!this.bindings[Oa.PRESENCE]&&this.bindings[Oa.PRESENCE].length>0||((s=this.params.config.presence)===null||s===void 0?void 0:s.enabled)===!0,f={},h={broadcast:o,presence:Object.assign(Object.assign({},l),{enabled:u}),postgres_changes:d,private:c};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(p=>e==null?void 0:e(Xn.CHANNEL_ERROR,p)),this._onClose(()=>e==null?void 0:e(Xn.CLOSED)),this.updateJoinPayload(Object.assign({config:h},f)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:p})=>{var g;if(this.socket.setAuth(),p===void 0){e==null||e(Xn.SUBSCRIBED);return}else{const m=this.bindings.postgres_changes,x=(g=m==null?void 0:m.length)!==null&&g!==void 0?g:0,v=[];for(let y=0;y<x;y++){const b=m[y],{filter:{event:w,schema:k,table:_,filter:C}}=b,N=p&&p[y];if(N&&N.event===w&&N.schema===k&&N.table===_&&N.filter===C)v.push(Object.assign(Object.assign({},b),{id:N.id}));else{this.unsubscribe(),this.state=Wt.errored,e==null||e(Xn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=v,e&&e(Xn.SUBSCRIBED);return}}).receive("error",p=>{this.state=Wt.errored,e==null||e(Xn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Xn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,n){return this.state===Wt.joined&&e===Oa.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,r,n)}async httpSend(e,r,n={}){var i;const s=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(r==null)return Promise.reject("Payload is required for httpSend()");const o={method:"POST",headers:{Authorization:s,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:r,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(i=n.timeout)!==null&&i!==void 0?i:this.timeout);if(l.status===202)return{success:!0};let c=l.statusText;try{const d=await l.json();c=d.error||d.message||c}catch{}return Promise.reject(new Error(c))}async send(e,r={}){var n,i;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:s,payload:o}=e,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:o,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=d.body)===null||i===void 0?void 0:i.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var o,l,c;const d=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&s("ok"),d.receive("ok",()=>s("ok")),d.receive("error",()=>s("error")),d.receive("timeout",()=>s("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Wt.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(un.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(i=>{n=new fu(this,un.leave,{},e),n.receive("ok",()=>{r(),i("ok")}).receive("timeout",()=>{r(),i("timed out")}).receive("error",()=>{i("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Wt.closed,this.bindings={}}async _fetchWithTimeout(e,r,n){const i=new AbortController,s=setTimeout(()=>i.abort(),n),o=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:i.signal}));return clearTimeout(s),o}_push(e,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new fu(this,e,r,n);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>ak){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(e,r,n){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,n){var i,s;const o=e.toLocaleLowerCase(),{close:l,error:c,leave:d,join:u}=un;if(n&&[l,c,d,u].indexOf(o)>=0&&n!==this._joinRef())return;let h=this._onMessage(o,r,n);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(p=>{var g,m,x;return((g=p.filter)===null||g===void 0?void 0:g.event)==="*"||((x=(m=p.filter)===null||m===void 0?void 0:m.event)===null||x===void 0?void 0:x.toLocaleLowerCase())===o}).map(p=>p.callback(h,n)):(s=this.bindings[o])===null||s===void 0||s.filter(p=>{var g,m,x,v,y,b;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in p){const w=p.id,k=(g=p.filter)===null||g===void 0?void 0:g.event;return w&&((m=r.ids)===null||m===void 0?void 0:m.includes(w))&&(k==="*"||(k==null?void 0:k.toLocaleLowerCase())===((x=r.data)===null||x===void 0?void 0:x.type.toLocaleLowerCase()))}else{const w=(y=(v=p==null?void 0:p.filter)===null||v===void 0?void 0:v.event)===null||y===void 0?void 0:y.toLocaleLowerCase();return w==="*"||w===((b=r==null?void 0:r.event)===null||b===void 0?void 0:b.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===o}).map(p=>{if(typeof h=="object"&&"ids"in h){const g=h.data,{schema:m,table:x,commit_timestamp:v,type:y,errors:b}=g;h=Object.assign(Object.assign({},{schema:m,table:x,commit_timestamp:v,eventType:y,new:{},old:{},errors:b}),this._getPayloadRecords(g))}p.callback(h,n)})}_isClosed(){return this.state===Wt.closed}_isJoined(){return this.state===Wt.joined}_isJoining(){return this.state===Wt.joining}_isLeaving(){return this.state===Wt.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,n){const i=e.toLocaleLowerCase(),s={type:i,filter:r,callback:n};return this.bindings[i]?this.bindings[i].push(s):this.bindings[i]=[s],this}_off(e,r){const n=e.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(i=>{var s;return!(((s=i.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&up.isEqual(i.filter,r))})),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const n in e)if(e[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(un.close,{},e)}_onError(e){this._on(un.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Wt.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=Ig(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=Ig(e.columns,e.old_record)),r}}const pu=()=>{},Ul={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},mk=[1e3,2e3,5e3,1e4],gk=1e4,vk=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class yk{constructor(e,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Uh,this.transport=null,this.heartbeatIntervalMs=Ul.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=pu,this.ref=0,this.reconnectTimer=null,this.logger=pu,this.conn=null,this.sendBuffer=[],this.serializer=new lk,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=i=>i?(...s)=>i(...s):(...s)=>fetch(...s),!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${e}/${Wh.websocket}`,this.httpEndpoint=yw(e),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=rk.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const r=e.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:sk}))}disconnect(e,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},e?this.conn.close(e,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,n){this.logger(e,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Ra.connecting:return Qi.Connecting;case Ra.open:return Qi.Open;case Ra.closing:return Qi.Closing;default:return Qi.Closed}}isConnected(){return this.connectionState()===Qi.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,r={config:{}}){const n=`realtime:${e}`,i=this.getChannels().find(s=>s.topic===n);if(i)return i;{const s=new up(`realtime:${e}`,r,this);return this.channels.push(s),s}}push(e){const{topic:r,event:n,payload:i,ref:s}=e,o=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${n} (${s})`,i),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(ok,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Ul.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:i,payload:s,ref:o}=r,l=o?`(${o})`:"",c=s.status||"";this.log("receive",`${c} ${n} ${i} ${l}`.trim(),s),this.channels.filter(d=>d._isMember(n)).forEach(d=>d._trigger(i,s,o)),this._triggerStateCallbacks("message",r)})}_clearTimer(e){var r;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var r;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(un.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const n=e.match(/\?/)?"&":"?",i=new URLSearchParams(r);return`${e}${n}${i}`}_workerObjectUrl(e){let r;if(e)r=e;else{const n=new Blob([vk],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(e,r=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(e=null){let r;e?r=e:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const i={access_token:r,version:ik};r&&n.updateJoinPayload(i),n.joinedOnce&&n._isJoined()&&n._push(un.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${e}`,r)})}_triggerStateCallbacks(e,r){try{this.stateChangeCallbacks[e].forEach(n=>{try{n(r)}catch(i){this.log("error",`error in ${e} callback`,i)}})}catch(n){this.log("error",`error triggering ${e} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new gw(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Ul.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var r,n,i,s,o,l,c,d,u;if(this.transport=(r=e==null?void 0:e.transport)!==null&&r!==void 0?r:null,this.timeout=(n=e==null?void 0:e.timeout)!==null&&n!==void 0?n:Uh,this.heartbeatIntervalMs=(i=e==null?void 0:e.heartbeatIntervalMs)!==null&&i!==void 0?i:Ul.HEARTBEAT_INTERVAL,this.worker=(s=e==null?void 0:e.worker)!==null&&s!==void 0?s:!1,this.accessToken=(o=e==null?void 0:e.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(l=e==null?void 0:e.heartbeatCallback)!==null&&l!==void 0?l:pu,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=e==null?void 0:e.reconnectAfterMs)!==null&&c!==void 0?c:f=>mk[f-1]||gk,this.encode=(d=e==null?void 0:e.encode)!==null&&d!==void 0?d:(f,h)=>h(JSON.stringify(f)),this.decode=(u=e==null?void 0:e.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class hp extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Rt(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class xk extends hp{constructor(e,r,n){super(e),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Vh extends hp{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}}const fp=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),bk=()=>Response,qh=t=>{if(Array.isArray(t))return t.map(r=>qh(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,n])=>{const i=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));e[i]=qh(n)}),e},wk=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},mu=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},_k=(t,e,r)=>ze(void 0,void 0,void 0,function*(){const n=yield bk();t instanceof n&&!(r!=null&&r.noResolveJson)?t.json().then(i=>{const s=t.status||500,o=(i==null?void 0:i.statusCode)||s+"";e(new xk(mu(i),s,o))}).catch(i=>{e(new Vh(mu(i),i))}):e(new Vh(mu(t),t))}),Sk=(t,e,r,n)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!n?i:(wk(n)?(i.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),i.body=JSON.stringify(n)):i.body=n,e!=null&&e.duplex&&(i.duplex=e.duplex),Object.assign(Object.assign({},i),r))};function ll(t,e,r,n,i,s){return ze(this,void 0,void 0,function*(){return new Promise((o,l)=>{t(r,Sk(e,n,i,s)).then(c=>{if(!c.ok)throw c;return n!=null&&n.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>_k(c,l,n))})})}function Za(t,e,r,n){return ze(this,void 0,void 0,function*(){return ll(t,"GET",e,r,n)})}function cn(t,e,r,n,i){return ze(this,void 0,void 0,function*(){return ll(t,"POST",e,n,i,r)})}function Yh(t,e,r,n,i){return ze(this,void 0,void 0,function*(){return ll(t,"PUT",e,n,i,r)})}function kk(t,e,r,n){return ze(this,void 0,void 0,function*(){return ll(t,"HEAD",e,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function pp(t,e,r,n,i){return ze(this,void 0,void 0,function*(){return ll(t,"DELETE",e,n,i,r)})}class jk{constructor(e,r){this.downloadFn=e,this.shouldThrowOnError=r}then(e,r){return this.execute().then(e,r)}execute(){return ze(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Rt(e))return{data:null,error:e};throw e}})}}var xw;class Ck{constructor(e,r){this.downloadFn=e,this.shouldThrowOnError=r,this[xw]="BlobDownloadBuilder",this.promise=null}asStream(){return new jk(this.downloadFn,this.shouldThrowOnError)}then(e,r){return this.getPromise().then(e,r)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return ze(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Rt(e))return{data:null,error:e};throw e}})}}xw=Symbol.toStringTag;const Ek={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Fg={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Tk{constructor(e,r={},n,i){this.shouldThrowOnError=!1,this.url=e,this.headers=r,this.bucketId=n,this.fetch=fp(i)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,r,n,i){return ze(this,void 0,void 0,function*(){try{let s;const o=Object.assign(Object.assign({},Fg),i);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",o.cacheControl),c&&s.append("metadata",this.encodeMetadata(c)),s.append("",n)):typeof FormData<"u"&&n instanceof FormData?(s=n,s.has("cacheControl")||s.append("cacheControl",o.cacheControl),c&&!s.has("metadata")&&s.append("metadata",this.encodeMetadata(c))):(s=n,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c))),(typeof ReadableStream<"u"&&s instanceof ReadableStream||s&&typeof s=="object"&&"pipe"in s&&typeof s.pipe=="function")&&!o.duplex&&(o.duplex="half")),i!=null&&i.headers&&(l=Object.assign(Object.assign({},l),i.headers));const d=this._removeEmptyFolders(r),u=this._getFinalPath(d),f=yield(e=="PUT"?Yh:cn)(this.fetch,`${this.url}/object/${u}`,s,Object.assign({headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:d,id:f.Id,fullPath:f.Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Rt(s))return{data:null,error:s};throw s}})}upload(e,r,n){return ze(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,r,n)})}uploadToSignedUrl(e,r,n,i){return ze(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(e),o=this._getFinalPath(s),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",r);try{let c;const d=Object.assign({upsert:Fg.upsert},i),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",n)):typeof FormData<"u"&&n instanceof FormData?(c=n,c.append("cacheControl",d.cacheControl)):(c=n,u["cache-control"]=`max-age=${d.cacheControl}`,u["content-type"]=d.contentType);const f=yield Yh(this.fetch,l.toString(),c,{headers:u});return{data:{path:s,fullPath:f.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(Rt(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,r){return ze(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const i=Object.assign({},this.headers);r!=null&&r.upsert&&(i["x-upsert"]="true");const s=yield cn(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:i}),o=new URL(this.url+s.url),l=o.searchParams.get("token");if(!l)throw new hp("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:l},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Rt(n))return{data:null,error:n};throw n}})}update(e,r,n){return ze(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,r,n)})}move(e,r,n){return ze(this,void 0,void 0,function*(){try{return{data:yield cn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Rt(i))return{data:null,error:i};throw i}})}copy(e,r,n){return ze(this,void 0,void 0,function*(){try{return{data:{path:(yield cn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Rt(i))return{data:null,error:i};throw i}})}createSignedUrl(e,r,n){return ze(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),s=yield cn(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${o}`)},{data:s,error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Rt(i))return{data:null,error:i};throw i}})}createSignedUrls(e,r,n){return ze(this,void 0,void 0,function*(){try{const i=yield cn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:i.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${s}`):null})),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Rt(i))return{data:null,error:i};throw i}})}download(e,r){const i=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),o=s?`?${s}`:"",l=this._getFinalPath(e),c=()=>Za(this.fetch,`${this.url}/${i}/${l}${o}`,{headers:this.headers,noResolveJson:!0});return new Ck(c,this.shouldThrowOnError)}info(e){return ze(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{const n=yield Za(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:qh(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Rt(n))return{data:null,error:n};throw n}})}exists(e){return ze(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{return yield kk(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Rt(n)&&n instanceof Vh){const i=n.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,r){const n=this._getFinalPath(e),i=[],s=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";s!==""&&i.push(s);const l=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});c!==""&&i.push(c);let d=i.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${n}${d}`)}}}remove(e){return ze(this,void 0,void 0,function*(){try{return{data:yield pp(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Rt(r))return{data:null,error:r};throw r}})}list(e,r,n){return ze(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},Ek),r),{prefix:e||""});return{data:yield cn(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},n),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Rt(i))return{data:null,error:i};throw i}})}listV2(e,r){return ze(this,void 0,void 0,function*(){try{const n=Object.assign({},e);return{data:yield cn(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Rt(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}}const bw="2.79.0",ww={"X-Client-Info":`storage-js/${bw}`};class Nk{constructor(e,r={},n,i){this.shouldThrowOnError=!1;const s=new URL(e);i!=null&&i.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},ww),r),this.fetch=fp(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(e){return ze(this,void 0,void 0,function*(){try{const r=this.listBucketOptionsToQueryString(e);return{data:yield Za(this.fetch,`${this.url}/bucket${r}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Rt(r))return{data:null,error:r};throw r}})}getBucket(e){return ze(this,void 0,void 0,function*(){try{return{data:yield Za(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Rt(r))return{data:null,error:r};throw r}})}createBucket(e){return ze(this,arguments,void 0,function*(r,n={public:!1}){try{return{data:yield cn(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Rt(i))return{data:null,error:i};throw i}})}updateBucket(e,r){return ze(this,void 0,void 0,function*(){try{return{data:yield Yh(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Rt(n))return{data:null,error:n};throw n}})}emptyBucket(e){return ze(this,void 0,void 0,function*(){try{return{data:yield cn(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Rt(r))return{data:null,error:r};throw r}})}deleteBucket(e){return ze(this,void 0,void 0,function*(){try{return{data:yield pp(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Rt(r))return{data:null,error:r};throw r}})}listBucketOptionsToQueryString(e){const r={};return e&&("limit"in e&&(r.limit=String(e.limit)),"offset"in e&&(r.offset=String(e.offset)),e.search&&(r.search=e.search),e.sortColumn&&(r.sortColumn=e.sortColumn),e.sortOrder&&(r.sortOrder=e.sortOrder)),Object.keys(r).length>0?"?"+new URLSearchParams(r).toString():""}}class Rk{constructor(e,r={},n){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},ww),r),this.fetch=fp(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return ze(this,void 0,void 0,function*(){try{return{data:yield cn(this.fetch,`${this.url}/bucket`,{name:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Rt(r))return{data:null,error:r};throw r}})}listBuckets(e){return ze(this,void 0,void 0,function*(){try{const r=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&r.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&r.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&r.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&r.set("sortOrder",e.sortOrder),e!=null&&e.search&&r.set("search",e.search);const n=r.toString(),i=n?`${this.url}/bucket?${n}`:`${this.url}/bucket`;return{data:yield Za(this.fetch,i,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Rt(r))return{data:null,error:r};throw r}})}deleteBucket(e){return ze(this,void 0,void 0,function*(){try{return{data:yield pp(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Rt(r))return{data:null,error:r};throw r}})}}const mp={"X-Client-Info":`storage-js/${bw}`,"Content-Type":"application/json"};class _w extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function Pr(t){return typeof t=="object"&&t!==null&&"__isStorageVectorsError"in t}class gu extends _w{constructor(e,r,n){super(e),this.name="StorageVectorsApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Pk extends _w{constructor(e,r){super(e),this.name="StorageVectorsUnknownError",this.originalError=r}}var Bg;(function(t){t.InternalError="InternalError",t.S3VectorConflictException="S3VectorConflictException",t.S3VectorNotFoundException="S3VectorNotFoundException",t.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",t.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",t.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(Bg||(Bg={}));const gp=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),Ok=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Hg=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Ak=(t,e,r)=>ze(void 0,void 0,void 0,function*(){if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!(r!=null&&r.noResolveJson)){const i=t.status||500,s=t;if(typeof s.json=="function")s.json().then(o=>{const l=(o==null?void 0:o.statusCode)||(o==null?void 0:o.code)||i+"";e(new gu(Hg(o),i,l))}).catch(()=>{const o=i+"",l=s.statusText||`HTTP ${i} error`;e(new gu(l,i,o))});else{const o=i+"",l=s.statusText||`HTTP ${i} error`;e(new gu(l,i,o))}}else e(new Pk(Hg(t),t))}),Mk=(t,e,r,n)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return n?(Ok(n)?(i.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),i.body=JSON.stringify(n)):i.body=n,Object.assign(Object.assign({},i),r)):i};function $k(t,e,r,n,i,s){return ze(this,void 0,void 0,function*(){return new Promise((o,l)=>{t(r,Mk(e,n,i,s)).then(c=>{if(!c.ok)throw c;if(n!=null&&n.noResolveJson)return c;const d=c.headers.get("content-type");return!d||!d.includes("application/json")?{}:c.json()}).then(c=>o(c)).catch(c=>Ak(c,l,n))})})}function Or(t,e,r,n,i){return ze(this,void 0,void 0,function*(){return $k(t,"POST",e,n,i,r)})}class Lk{constructor(e,r={},n){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},mp),r),this.fetch=gp(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(e){return ze(this,void 0,void 0,function*(){try{return{data:(yield Or(this.fetch,`${this.url}/CreateIndex`,e,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Pr(r))return{data:null,error:r};throw r}})}getIndex(e,r){return ze(this,void 0,void 0,function*(){try{return{data:yield Or(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:e,indexName:r},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Pr(n))return{data:null,error:n};throw n}})}listIndexes(e){return ze(this,void 0,void 0,function*(){try{return{data:yield Or(this.fetch,`${this.url}/ListIndexes`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Pr(r))return{data:null,error:r};throw r}})}deleteIndex(e,r){return ze(this,void 0,void 0,function*(){try{return{data:(yield Or(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:e,indexName:r},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Pr(n))return{data:null,error:n};throw n}})}}class Ik{constructor(e,r={},n){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},mp),r),this.fetch=gp(n)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(e){return ze(this,void 0,void 0,function*(){try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield Or(this.fetch,`${this.url}/PutVectors`,e,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Pr(r))return{data:null,error:r};throw r}})}getVectors(e){return ze(this,void 0,void 0,function*(){try{return{data:yield Or(this.fetch,`${this.url}/GetVectors`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Pr(r))return{data:null,error:r};throw r}})}listVectors(e){return ze(this,void 0,void 0,function*(){try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:yield Or(this.fetch,`${this.url}/ListVectors`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Pr(r))return{data:null,error:r};throw r}})}queryVectors(e){return ze(this,void 0,void 0,function*(){try{return{data:yield Or(this.fetch,`${this.url}/QueryVectors`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Pr(r))return{data:null,error:r};throw r}})}deleteVectors(e){return ze(this,void 0,void 0,function*(){try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield Or(this.fetch,`${this.url}/DeleteVectors`,e,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Pr(r))return{data:null,error:r};throw r}})}}class Dk{constructor(e,r={},n){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},mp),r),this.fetch=gp(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return ze(this,void 0,void 0,function*(){try{return{data:(yield Or(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Pr(r))return{data:null,error:r};throw r}})}getBucket(e){return ze(this,void 0,void 0,function*(){try{return{data:yield Or(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Pr(r))return{data:null,error:r};throw r}})}listBuckets(){return ze(this,arguments,void 0,function*(e={}){try{return{data:yield Or(this.fetch,`${this.url}/ListVectorBuckets`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Pr(r))return{data:null,error:r};throw r}})}deleteBucket(e){return ze(this,void 0,void 0,function*(){try{return{data:(yield Or(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Pr(r))return{data:null,error:r};throw r}})}}class zk extends Dk{constructor(e,r={}){super(e,r.headers||{},r.fetch)}from(e){return new Fk(this.url,this.headers,e,this.fetch)}}class Fk extends Lk{constructor(e,r,n,i){super(e,r,i),this.vectorBucketName=n}createIndex(e){const r=Object.create(null,{createIndex:{get:()=>super.createIndex}});return ze(this,void 0,void 0,function*(){return r.createIndex.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const e=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return ze(this,arguments,void 0,function*(r={}){return e.listIndexes.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName}))})}getIndex(e){const r=Object.create(null,{getIndex:{get:()=>super.getIndex}});return ze(this,void 0,void 0,function*(){return r.getIndex.call(this,this.vectorBucketName,e)})}deleteIndex(e){const r=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return ze(this,void 0,void 0,function*(){return r.deleteIndex.call(this,this.vectorBucketName,e)})}index(e){return new Bk(this.url,this.headers,this.vectorBucketName,e,this.fetch)}}class Bk extends Ik{constructor(e,r,n,i,s){super(e,r,s),this.vectorBucketName=n,this.indexName=i}putVectors(e){const r=Object.create(null,{putVectors:{get:()=>super.putVectors}});return ze(this,void 0,void 0,function*(){return r.putVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(e){const r=Object.create(null,{getVectors:{get:()=>super.getVectors}});return ze(this,void 0,void 0,function*(){return r.getVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const e=Object.create(null,{listVectors:{get:()=>super.listVectors}});return ze(this,arguments,void 0,function*(r={}){return e.listVectors.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(e){const r=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return ze(this,void 0,void 0,function*(){return r.queryVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(e){const r=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return ze(this,void 0,void 0,function*(){return r.deleteVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class Hk extends Nk{constructor(e,r={},n,i){super(e,r,n,i)}from(e){return new Tk(this.url,this.headers,e,this.fetch)}get vectors(){return new zk(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new Rk(this.url+"/iceberg",this.headers,this.fetch)}}const Uk="2.79.0";let va="";typeof Deno<"u"?va="deno":typeof document<"u"?va="web":typeof navigator<"u"&&navigator.product==="ReactNative"?va="react-native":va="node";const Wk={"X-Client-Info":`supabase-js-${va}/${Uk}`},Gk={headers:Wk},Vk={schema:"public"},qk={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Yk={},Xk=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),Kk=()=>Headers,Zk=(t,e,r)=>{const n=Xk(r),i=Kk();return async(s,o)=>{var l;const c=(l=await e())!==null&&l!==void 0?l:t;let d=new i(o==null?void 0:o.headers);return d.has("apikey")||d.set("apikey",t),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),n(s,Object.assign(Object.assign({},o),{headers:d}))}};function Jk(t){return t.endsWith("/")?t:t+"/"}function Qk(t,e){var r,n;const{db:i,auth:s,realtime:o,global:l}=t,{db:c,auth:d,realtime:u,global:f}=e,h={db:Object.assign(Object.assign({},c),i),auth:Object.assign(Object.assign({},d),s),realtime:Object.assign(Object.assign({},u),o),storage:{},global:Object.assign(Object.assign(Object.assign({},f),l),{headers:Object.assign(Object.assign({},(r=f==null?void 0:f.headers)!==null&&r!==void 0?r:{}),(n=l==null?void 0:l.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return t.accessToken?h.accessToken=t.accessToken:delete h.accessToken,h}function ej(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Jk(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const Sw="2.79.0",zs=30*1e3,Xh=3,vu=Xh*zs,tj="http://localhost:9999",rj="supabase.auth.token",nj={"X-Client-Info":`gotrue-js/${Sw}`},Kh="X-Supabase-Api-Version",kw={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},ij=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,sj=10*60*1e3;class Ja extends Error{constructor(e,r,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Ve(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class oj extends Ja{constructor(e,r,n){super(e,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function aj(t){return Ve(t)&&t.name==="AuthApiError"}class es extends Ja{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class Bi extends Ja{constructor(e,r,n,i){super(e,n,i),this.name=r,this.status=n}}class sn extends Bi{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function lj(t){return Ve(t)&&t.name==="AuthSessionMissingError"}class Os extends Bi{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Wl extends Bi{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Gl extends Bi{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function cj(t){return Ve(t)&&t.name==="AuthImplicitGrantRedirectError"}class Ug extends Bi{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Zh extends Bi{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function yu(t){return Ve(t)&&t.name==="AuthRetryableFetchError"}class Wg extends Bi{constructor(e,r,n){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Jh extends Bi{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Bc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Gg=` 	
\r=`.split(""),dj=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<Gg.length;e+=1)t[Gg[e].charCodeAt(0)]=-2;for(let e=0;e<Bc.length;e+=1)t[Bc[e].charCodeAt(0)]=e;return t})();function Vg(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(Bc[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(Bc[n]),e.queuedBits-=6}}function jw(t,e,r){const n=dj[t];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function qg(t){const e=[],r=o=>{e.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},s=o=>{fj(o,n,r)};for(let o=0;o<t.length;o+=1)jw(t.charCodeAt(o),i,s);return e.join("")}function uj(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function hj(t,e){for(let r=0;r<t.length;r+=1){let n=t.charCodeAt(r);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(t.charCodeAt(r+1)-56320&65535|i)+65536,r+=1}uj(n,e)}}function fj(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let n=1;n<6;n+=1)if(!(t>>7-n&1)){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function jo(t){const e=[],r={queue:0,queuedBits:0},n=i=>{e.push(i)};for(let i=0;i<t.length;i+=1)jw(t.charCodeAt(i),r,n);return new Uint8Array(e)}function pj(t){const e=[];return hj(t,r=>e.push(r)),new Uint8Array(e)}function is(t){const e=[],r={queue:0,queuedBits:0},n=i=>{e.push(i)};return t.forEach(i=>Vg(i,r,n)),Vg(null,r,n),e.join("")}function mj(t){return Math.round(Date.now()/1e3)+t}function gj(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const sr=()=>typeof window<"u"&&typeof document<"u",Vi={tested:!1,writable:!1},Cw=()=>{if(!sr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Vi.tested)return Vi.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Vi.tested=!0,Vi.writable=!0}catch{Vi.tested=!0,Vi.writable=!1}return Vi.writable};function vj(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((i,s)=>{e[s]=i})}catch{}return r.searchParams.forEach((n,i)=>{e[i]=n}),e}const Ew=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),yj=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",Fs=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},qi=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},pi=async(t,e)=>{await t.removeItem(e)};class _d{constructor(){this.promise=new _d.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}_d.promiseConstructor=Promise;function xu(t){const e=t.split(".");if(e.length!==3)throw new Jh("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!ij.test(e[n]))throw new Jh("JWT not in base64url format");return{header:JSON.parse(qg(e[0])),payload:JSON.parse(qg(e[1])),signature:jo(e[2]),raw:{header:e[0],payload:e[1]}}}async function xj(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function bj(t,e){return new Promise((n,i)=>{(async()=>{for(let s=0;s<1/0;s++)try{const o=await t(s);if(!e(s,null,o)){n(o);return}}catch(o){if(!e(s,o)){i(o);return}}})()})}function wj(t){return("0"+t.toString(16)).substr(-2)}function _j(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let i="";for(let s=0;s<56;s++)i+=r.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(e),Array.from(e,wj).join("")}async function Sj(t){const r=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",r),i=new Uint8Array(n);return Array.from(i).map(s=>String.fromCharCode(s)).join("")}async function kj(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await Sj(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function As(t,e,r=!1){const n=_j();let i=n;r&&(i+="/PASSWORD_RECOVERY"),await Fs(t,`${e}-code-verifier`,i);const s=await kj(n);return[s,n===s?"plain":"s256"]}const jj=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Cj(t){const e=t.headers.get(Kh);if(!e||!e.match(jj))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Ej(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function Tj(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Nj=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Ms(t){if(!Nj.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function bu(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Rj(t,e){return new Proxy(t,{get:(r,n,i)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const s=n.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)"||s==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,i)}return!e.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(r,n,i)}})}function Yg(t){return JSON.parse(JSON.stringify(t))}const Zi=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Pj=[502,503,504];async function Xg(t){var e;if(!yj(t))throw new Zh(Zi(t),0);if(Pj.includes(t.status))throw new Zh(Zi(t),t.status);let r;try{r=await t.json()}catch(s){throw new es(Zi(s),s)}let n;const i=Cj(t);if(i&&i.getTime()>=kw["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Wg(Zi(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new sn}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,o)=>s&&typeof o=="string",!0))throw new Wg(Zi(r),t.status,r.weak_password.reasons);throw new oj(Zi(r),t.status||500,n)}const Oj=(t,e,r,n)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};async function Je(t,e,r,n){var i;const s=Object.assign({},n==null?void 0:n.headers);s[Kh]||(s[Kh]=kw["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const o=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(o.redirect_to=n.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await Aj(t,e,r+l,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(c):{data:Object.assign({},c),error:null}}async function Aj(t,e,r,n,i,s){const o=Oj(e,n,i,s);let l;try{l=await t(r,Object.assign({},o))}catch(c){throw console.error(c),new Zh(Zi(c),0)}if(l.ok||await Xg(l),n!=null&&n.noResolveJson)return l;try{return await l.json()}catch(c){await Xg(c)}}function on(t){var e;let r=null;Lj(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=mj(t.expires_in)));const n=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:n},error:null}}function Kg(t){const e=on(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(e.data.weak_password=t.weak_password),e}function wi(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function Mj(t){return{data:t,error:null}}function $j(t){const{action_link:e,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s}=t,o=Do(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function Zg(t){return t}function Lj(t){return t.access_token&&t.refresh_token&&t.expires_in}const wu=["global","local","others"];class Ij{constructor({url:e="",headers:r={},fetch:n}){this.url=e,this.headers=r,this.fetch=Ew(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,r=wu[0]){if(wu.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${wu.join(", ")}`);try{return await Je(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Ve(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,r={}){try{return await Je(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:wi})}catch(n){if(Ve(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:r}=e,n=Do(e,["options"]),i=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),await Je(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:$j,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Ve(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await Je(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:wi})}catch(r){if(Ve(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,n,i,s,o,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await Je(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:Zg});if(u.error)throw u.error;const f=await u.json(),h=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return p.length>0&&(p.forEach(g=>{const m=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(g.split(";")[1].split("=")[1]);d[`${x}Page`]=m}),d.total=parseInt(h)),{data:Object.assign(Object.assign({},f),d),error:null}}catch(d){if(Ve(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){Ms(e);try{return await Je(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:wi})}catch(r){if(Ve(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){Ms(e);try{return await Je(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:wi})}catch(n){if(Ve(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,r=!1){Ms(e);try{return await Je(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:wi})}catch(n){if(Ve(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){Ms(e.userId);try{const{data:r,error:n}=await Je(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:r,error:n}}catch(r){if(Ve(r))return{data:null,error:r};throw r}}async _deleteFactor(e){Ms(e.userId),Ms(e.id);try{return{data:await Je(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(Ve(r))return{data:null,error:r};throw r}}async _listOAuthClients(e){var r,n,i,s,o,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await Je(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:Zg});if(u.error)throw u.error;const f=await u.json(),h=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return p.length>0&&(p.forEach(g=>{const m=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(g.split(";")[1].split("=")[1]);d[`${x}Page`]=m}),d.total=parseInt(h)),{data:Object.assign(Object.assign({},f),d),error:null}}catch(d){if(Ve(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(e){try{return await Je(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ve(r))return{data:null,error:r};throw r}}async _getOAuthClient(e){try{return await Je(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ve(r))return{data:null,error:r};throw r}}async _updateOAuthClient(e,r){try{return await Je(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Ve(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(e){try{return await Je(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Ve(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(e){try{return await Je(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ve(r))return{data:null,error:r};throw r}}}function Jg(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}const $s={debug:!!(globalThis&&Cw()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Tw extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Dj extends Tw{}async function zj(t,e,r){$s.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),$s.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){$s.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,i.name);try{return await r()}finally{$s.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,i.name)}}else{if(e===0)throw $s.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new Dj(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if($s.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function Fj(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Nw(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function Bj(t){return parseInt(t,16)}function Hj(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,n=>n.toString(16).padStart(2,"0")).join("")}function Uj(t){var e;const{chainId:r,domain:n,expirationTime:i,issuedAt:s=new Date,nonce:o,notBefore:l,requestId:c,resources:d,scheme:u,uri:f,version:h}=t;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!f)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(h!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${h}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const p=Nw(t.address),g=u?`${u}://${n}`:n,m=t.statement?`${t.statement}
`:"",x=`${g} wants you to sign in with your Ethereum account:
${p}

${m}`;let v=`URI: ${f}
Version: ${h}
Chain ID: ${r}${o?`
Nonce: ${o}`:""}
Issued At: ${s.toISOString()}`;if(i&&(v+=`
Expiration Time: ${i.toISOString()}`),l&&(v+=`
Not Before: ${l.toISOString()}`),c&&(v+=`
Request ID: ${c}`),d){let y=`
Resources:`;for(const b of d){if(!b||typeof b!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${b}`);y+=`
- ${b}`}v+=y}return`${x}
${v}`}class Ft extends Error{constructor({message:e,code:r,cause:n,name:i}){var s;super(e,{cause:n}),this.__isWebAuthnError=!0,this.name=(s=i??(n instanceof Error?n.name:void 0))!==null&&s!==void 0?s:"Unknown Error",this.code=r}}class Hc extends Ft{constructor(e,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:e}),this.name="WebAuthnUnknownError",this.originalError=r}}function Wj({error:t,options:e}){var r,n,i;const{publicKey:s}=e;if(!s)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Ft({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((r=s.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Ft({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((n=s.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Ft({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((i=s.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new Ft({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new Ft({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new Ft({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return s.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new Ft({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new Ft({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const o=window.location.hostname;if(Rw(o)){if(s.rp.id!==o)return new Ft({message:`The RP ID "${s.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Ft({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(s.user.id.byteLength<1||s.user.id.byteLength>64)return new Ft({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new Ft({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Ft({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function Gj({error:t,options:e}){const{publicKey:r}=e;if(!r)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Ft({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new Ft({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const n=window.location.hostname;if(Rw(n)){if(r.rpId!==n)return new Ft({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Ft({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new Ft({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Ft({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class Vj{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const qj=new Vj;function Yj(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:r,excludeCredentials:n}=t,i=Do(t,["challenge","user","excludeCredentials"]),s=jo(e).buffer,o=Object.assign(Object.assign({},r),{id:jo(r.id).buffer}),l=Object.assign(Object.assign({},i),{challenge:s,user:o});if(n&&n.length>0){l.excludeCredentials=new Array(n.length);for(let c=0;c<n.length;c++){const d=n[c];l.excludeCredentials[c]=Object.assign(Object.assign({},d),{id:jo(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return l}function Xj(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:r}=t,n=Do(t,["challenge","allowCredentials"]),i=jo(e).buffer,s=Object.assign(Object.assign({},n),{challenge:i});if(r&&r.length>0){s.allowCredentials=new Array(r.length);for(let o=0;o<r.length;o++){const l=r[o];s.allowCredentials[o]=Object.assign(Object.assign({},l),{id:jo(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return s}function Kj(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t;return{id:t.id,rawId:t.id,response:{attestationObject:is(new Uint8Array(t.response.attestationObject)),clientDataJSON:is(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function Zj(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t,n=t.getClientExtensionResults(),i=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:is(new Uint8Array(i.authenticatorData)),clientDataJSON:is(new Uint8Array(i.clientDataJSON)),signature:is(new Uint8Array(i.signature)),userHandle:i.userHandle?is(new Uint8Array(i.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function Rw(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function Qg(){var t,e;return!!(sr()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function Jj(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Hc("Browser returned unexpected credential type",e)}:{data:null,error:new Hc("Empty credential response",e)}}catch(e){return{data:null,error:Wj({error:e,options:t})}}}async function Qj(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Hc("Browser returned unexpected credential type",e)}:{data:null,error:new Hc("Empty credential response",e)}}catch(e){return{data:null,error:Gj({error:e,options:t})}}}const eC={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},tC={userVerification:"preferred",hints:["security-key"]};function Uc(...t){const e=i=>i!==null&&typeof i=="object"&&!Array.isArray(i),r=i=>i instanceof ArrayBuffer||ArrayBuffer.isView(i),n={};for(const i of t)if(i)for(const s in i){const o=i[s];if(o!==void 0)if(Array.isArray(o))n[s]=o;else if(r(o))n[s]=o;else if(e(o)){const l=n[s];e(l)?n[s]=Uc(l,o):n[s]=Uc(o)}else n[s]=o}return n}function rC(t,e){return Uc(eC,t,e||{})}function nC(t,e){return Uc(tC,t,e||{})}class iC{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:r,friendlyName:n,signal:i},s){try{const{data:o,error:l}=await this.client.mfa.challenge({factorId:e,webauthn:r});if(!o)return{data:null,error:l};const c=i??qj.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:d}=o.webauthn.credential_options.publicKey;d.name||(d.name=`${d.id}:${n}`),d.displayName||(d.displayName=d.name)}switch(o.webauthn.type){case"create":{const d=rC(o.webauthn.credential_options.publicKey,s==null?void 0:s.create),{data:u,error:f}=await Jj({publicKey:d,signal:c});return u?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:u}},error:null}:{data:null,error:f}}case"request":{const d=nC(o.webauthn.credential_options.publicKey,s==null?void 0:s.request),{data:u,error:f}=await Qj(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:d,signal:c}));return u?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:u}},error:null}:{data:null,error:f}}}}catch(o){return Ve(o)?{data:null,error:o}:{data:null,error:new es("Unexpected error in challenge",o)}}}async _verify({challengeId:e,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:e,webauthn:n})}async _authenticate({factorId:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}},s){if(!r)return{data:null,error:new Ja("rpId is required for WebAuthn authentication")};try{if(!Qg())return{data:null,error:new es("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this.challenge({factorId:e,webauthn:{rpId:r,rpOrigins:n},signal:i},{request:s});if(!o)return{data:null,error:l};const{webauthn:c}=o;return this._verify({factorId:e,challengeId:o.challengeId,webauthn:{type:c.type,rpId:r,rpOrigins:n,credential_response:c.credential_response}})}catch(o){return Ve(o)?{data:null,error:o}:{data:null,error:new es("Unexpected error in authenticate",o)}}}async _register({friendlyName:e,rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i},s){if(!r)return{data:null,error:new Ja("rpId is required for WebAuthn registration")};try{if(!Qg())return{data:null,error:new es("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this._enroll({friendlyName:e});if(!o)return await this.client.mfa.listFactors().then(u=>{var f;return(f=u.data)===null||f===void 0?void 0:f.all.find(h=>h.factor_type==="webauthn"&&h.friendly_name===e&&h.status!=="unverified")}).then(u=>u?this.client.mfa.unenroll({factorId:u==null?void 0:u.id}):void 0),{data:null,error:l};const{data:c,error:d}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:i},{create:s});return c?this._verify({factorId:o.id,challengeId:c.challengeId,webauthn:{rpId:r,rpOrigins:n,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:d}}catch(o){return Ve(o)?{data:null,error:o}:{data:null,error:new es("Unexpected error in register",o)}}}}Fj();const sC={url:tj,storageKey:rj,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:nj,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function e0(t,e,r){return await r()}const Ls={};class Qa{get jwks(){var e,r;return(r=(e=Ls[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){Ls[this.storageKey]=Object.assign(Object.assign({},Ls[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=Ls[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Ls[this.storageKey]=Object.assign(Object.assign({},Ls[this.storageKey]),{cachedAt:e})}constructor(e){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Qa.nextInstanceID,Qa.nextInstanceID+=1,this.instanceID>0&&sr()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},sC),e);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new Ij({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=Ew(i.fetch),this.lock=i.lock||e0,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,i.lock?this.lock=i.lock:sr()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=zj:this.lock=e0,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new iC(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:Cw()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Jg(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=Jg(this.memoryStorage)),sr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Sw}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let r={},n="none";if(sr()&&(r=vj(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),sr()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),cj(s)){const c=(e=s.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:o,redirectType:l}=i;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Ve(r)?this._returnResult({error:r}):this._returnResult({error:new es("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,n,i;try{const s=await Je(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=e==null?void 0:e.options)===null||i===void 0?void 0:i.captchaToken}},xform:on}),{data:o,error:l}=s;if(l||!o)return this._returnResult({data:{user:null,session:null},error:l});const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(s){if(Ve(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signUp(e){var r,n,i;try{let s;if("email"in e){const{email:u,password:f,options:h}=e;let p=null,g=null;this.flowType==="pkce"&&([p,g]=await As(this.storage,this.storageKey)),s=await Je(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:u,password:f,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:p,code_challenge_method:g},xform:on})}else if("phone"in e){const{phone:u,password:f,options:h}=e;s=await Je(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:f,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},channel:(i=h==null?void 0:h.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:on})}else throw new Wl("You must provide either an email or phone number and a password");const{data:o,error:l}=s;if(l||!o)return this._returnResult({data:{user:null,session:null},error:l});const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(s){if(Ve(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithPassword(e){try{let r;if("email"in e){const{email:s,password:o,options:l}=e;r=await Je(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Kg})}else if("phone"in e){const{phone:s,password:o,options:l}=e;r=await Je(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Kg})}else throw new Wl("You must provide either an email or phone number and a password");const{data:n,error:i}=r;if(i)return this._returnResult({data:{user:null,session:null},error:i});if(!n||!n.session||!n.user){const s=new Os;return this._returnResult({data:{user:null,session:null},error:s})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(r){if(Ve(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(e){var r,n,i,s;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=e.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;switch(r){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(e){var r,n,i,s,o,l,c,d,u,f,h;let p,g;if("message"in e)p=e.message,g=e.signature;else{const{chain:m,wallet:x,statement:v,options:y}=e;let b;if(sr())if(typeof x=="object")b=x;else{const T=window;if("ethereum"in T&&typeof T.ethereum=="object"&&"request"in T.ethereum&&typeof T.ethereum.request=="function")b=T.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(y!=null&&y.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");b=x}const w=new URL((r=y==null?void 0:y.url)!==null&&r!==void 0?r:window.location.href),k=await b.request({method:"eth_requestAccounts"}).then(T=>T).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!k||k.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const _=Nw(k[0]);let C=(n=y==null?void 0:y.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!C){const T=await b.request({method:"eth_chainId"});C=Bj(T)}const N={domain:w.host,address:_,statement:v,uri:w.href,version:"1",chainId:C,nonce:(i=y==null?void 0:y.signInWithEthereum)===null||i===void 0?void 0:i.nonce,issuedAt:(o=(s=y==null?void 0:y.signInWithEthereum)===null||s===void 0?void 0:s.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(l=y==null?void 0:y.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=y==null?void 0:y.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(d=y==null?void 0:y.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(u=y==null?void 0:y.signInWithEthereum)===null||u===void 0?void 0:u.resources};p=Uj(N),g=await b.request({method:"personal_sign",params:[Hj(p),_]})}try{const{data:m,error:x}=await Je(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:p,signature:g},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(h=e.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:on});if(x)throw x;if(!m||!m.session||!m.user){const v=new Os;return this._returnResult({data:{user:null,session:null},error:v})}return m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),this._returnResult({data:Object.assign({},m),error:x})}catch(m){if(Ve(m))return this._returnResult({data:{user:null,session:null},error:m});throw m}}async signInWithSolana(e){var r,n,i,s,o,l,c,d,u,f,h,p;let g,m;if("message"in e)g=e.message,m=e.signature;else{const{chain:x,wallet:v,statement:y,options:b}=e;let w;if(sr())if(typeof v=="object")w=v;else{const _=window;if("solana"in _&&typeof _.solana=="object"&&("signIn"in _.solana&&typeof _.solana.signIn=="function"||"signMessage"in _.solana&&typeof _.solana.signMessage=="function"))w=_.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof v!="object"||!(b!=null&&b.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=v}const k=new URL((r=b==null?void 0:b.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in w&&w.signIn){const _=await w.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},b==null?void 0:b.signInWithSolana),{version:"1",domain:k.host,uri:k.href}),y?{statement:y}:null));let C;if(Array.isArray(_)&&_[0]&&typeof _[0]=="object")C=_[0];else if(_&&typeof _=="object"&&"signedMessage"in _&&"signature"in _)C=_;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in C&&"signature"in C&&(typeof C.signedMessage=="string"||C.signedMessage instanceof Uint8Array)&&C.signature instanceof Uint8Array)g=typeof C.signedMessage=="string"?C.signedMessage:new TextDecoder().decode(C.signedMessage),m=C.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in w)||typeof w.signMessage!="function"||!("publicKey"in w)||typeof w!="object"||!w.publicKey||!("toBase58"in w.publicKey)||typeof w.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");g=[`${k.host} wants you to sign in with your Solana account:`,w.publicKey.toBase58(),...y?["",y,""]:[""],"Version: 1",`URI: ${k.href}`,`Issued At: ${(i=(n=b==null?void 0:b.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((s=b==null?void 0:b.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${b.signInWithSolana.notBefore}`]:[],...!((o=b==null?void 0:b.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${b.signInWithSolana.expirationTime}`]:[],...!((l=b==null?void 0:b.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${b.signInWithSolana.chainId}`]:[],...!((c=b==null?void 0:b.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${b.signInWithSolana.nonce}`]:[],...!((d=b==null?void 0:b.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${b.signInWithSolana.requestId}`]:[],...!((f=(u=b==null?void 0:b.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||f===void 0)&&f.length?["Resources",...b.signInWithSolana.resources.map(C=>`- ${C}`)]:[]].join(`
`);const _=await w.signMessage(new TextEncoder().encode(g),"utf8");if(!_||!(_ instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=_}}try{const{data:x,error:v}=await Je(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:g,signature:is(m)},!((h=e.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(p=e.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:on});if(v)throw v;if(!x||!x.session||!x.user){const y=new Os;return this._returnResult({data:{user:null,session:null},error:y})}return x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",x.session)),this._returnResult({data:Object.assign({},x),error:v})}catch(x){if(Ve(x))return this._returnResult({data:{user:null,session:null},error:x});throw x}}async _exchangeCodeForSession(e){const r=await qi(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(r??"").split("/");try{const{data:s,error:o}=await Je(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:on});if(await pi(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!s||!s.session||!s.user){const l=new Os;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign(Object.assign({},s),{redirectType:i??null}),error:o})}catch(s){if(Ve(s))return this._returnResult({data:{user:null,session:null,redirectType:null},error:s});throw s}}async signInWithIdToken(e){try{const{options:r,provider:n,token:i,access_token:s,nonce:o}=e,l=await Je(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:s,nonce:o,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:on}),{data:c,error:d}=l;if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!c||!c.session||!c.user){const u=new Os;return this._returnResult({data:{user:null,session:null},error:u})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:d})}catch(r){if(Ve(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(e){var r,n,i,s,o;try{if("email"in e){const{email:l,options:c}=e;let d=null,u=null;this.flowType==="pkce"&&([d,u]=await As(this.storage,this.storageKey));const{error:f}=await Je(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(n=c==null?void 0:c.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:d,code_challenge_method:u},redirectTo:c==null?void 0:c.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:f})}if("phone"in e){const{phone:l,options:c}=e,{data:d,error:u}=await Je(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(i=c==null?void 0:c.data)!==null&&i!==void 0?i:{},create_user:(s=c==null?void 0:c.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:u})}throw new Wl("You must provide either an email or phone number.")}catch(l){if(Ve(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(e){var r,n;try{let i,s;"options"in e&&(i=(r=e.options)===null||r===void 0?void 0:r.redirectTo,s=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:l}=await Je(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:i,xform:on});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,d=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(i){if(Ve(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithSSO(e){var r,n,i;try{let s=null,o=null;this.flowType==="pkce"&&([s,o]=await As(this.storage,this.storageKey));const l=await Je(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=e==null?void 0:e.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:o}),headers:this.headers,xform:Mj});return this._returnResult(l)}catch(s){if(Ve(s))return this._returnResult({data:null,error:s});throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:n}=e;if(n)throw n;if(!r)throw new sn;const{error:i}=await Je(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:i})})}catch(e){if(Ve(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:n,type:i,options:s}=e,{error:o}=await Je(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in e){const{phone:n,type:i,options:s}=e,{data:o,error:l}=await Je(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l})}throw new Wl("You must provide either an email or phone number and a type")}catch(r){if(Ve(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await qi(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<vu:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.userStorage){const o=await qi(this.userStorage,this.storageKey+"-user");o!=null&&o.user?e.user=o.user:e.user=bu()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};e.user=Rj(e.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:i,error:s}=await this._callRefreshToken(e.refresh_token);return s?this._returnResult({data:{session:null},error:s}):this._returnResult({data:{session:i},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Je(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:wi}):await this._useSession(async r=>{var n,i,s;const{data:o,error:l}=r;if(l)throw l;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new sn}:await Je(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(i=o.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0,xform:wi})})}catch(r){if(Ve(r))return lj(r)&&(await this._removeSession(),await pi(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async n=>{const{data:i,error:s}=n;if(s)throw s;if(!i.session)throw new sn;const o=i.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await As(this.storage,this.storageKey));const{data:d,error:u}=await Je(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:wi});if(u)throw u;return o.user=d.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(n){if(Ve(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new sn;const r=Date.now()/1e3;let n=r,i=!0,s=null;const{payload:o}=xu(e.access_token);if(o.exp&&(n=o.exp,i=n<=r),i){const{data:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l)return{data:{user:null,session:null},error:null};s=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)throw c;s={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return this._returnResult({data:{user:s.user,session:s},error:null})}catch(r){if(Ve(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var n;if(!e){const{data:o,error:l}=r;if(l)throw l;e=(n=o.session)!==null&&n!==void 0?n:void 0}if(!(e!=null&&e.refresh_token))throw new sn;const{data:i,error:s}=await this._callRefreshToken(e.refresh_token);return s?this._returnResult({data:{user:null,session:null},error:s}):i?this._returnResult({data:{user:i.user,session:i},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(Ve(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(e,r){try{if(!sr())throw new Gl("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Gl(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Ug("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Gl("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Ug("No code detected.");const{data:y,error:b}=await this._exchangeCodeForSession(e.code);if(b)throw b;const w=new URL(window.location.href);return w.searchParams.delete("code"),window.history.replaceState(window.history.state,"",w.toString()),{data:{session:y.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:s,refresh_token:o,expires_in:l,expires_at:c,token_type:d}=e;if(!s||!l||!o||!d)throw new Gl("No session defined in URL");const u=Math.round(Date.now()/1e3),f=parseInt(l);let h=u+f;c&&(h=parseInt(c));const p=h-u;p*1e3<=zs&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${f}s`);const g=h-f;u-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,h,u):u-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,h,u);const{data:m,error:x}=await this._getUser(s);if(x)throw x;const v={provider_token:n,provider_refresh_token:i,access_token:s,expires_in:f,expires_at:h,refresh_token:o,token_type:d,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:v,redirectType:e.type},error:null})}catch(n){if(Ve(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await qi(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return this._returnResult({error:s});const o=(n=i.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(aj(l)&&(l.status===404||l.status===401||l.status===403)))return this._returnResult({error:l})}return e!=="others"&&(await this._removeSession(),await pi(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const r=gj(),n={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async r=>{var n,i;try{const{data:{session:s},error:o}=r;if(o)throw o;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}async resetPasswordForEmail(e,r={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await As(this.storage,this.storageKey,!0));try{return await Je(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(Ve(s))return this._returnResult({data:null,error:s});throw s}}async getUserIdentities(){var e;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(r){if(Ve(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var r;try{const{data:n,error:i}=await this._useSession(async s=>{var o,l,c,d,u;const{data:f,error:h}=s;if(h)throw h;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await Je(this.fetch,"GET",p,{headers:this.headers,jwt:(u=(d=f.session)===null||d===void 0?void 0:d.access_token)!==null&&u!==void 0?u:void 0})});if(i)throw i;return sr()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:e.provider,url:n==null?void 0:n.url},error:null})}catch(n){if(Ve(n))return this._returnResult({data:{provider:e.provider,url:null},error:n});throw n}}async linkIdentityIdToken(e){return await this._useSession(async r=>{var n;try{const{error:i,data:{session:s}}=r;if(i)throw i;const{options:o,provider:l,token:c,access_token:d,nonce:u}=e,f=await Je(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=s==null?void 0:s.access_token)!==null&&n!==void 0?n:void 0,body:{provider:l,id_token:c,access_token:d,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:on}),{data:h,error:p}=f;return p?this._returnResult({data:{user:null,session:null},error:p}):!h||!h.session||!h.user?this._returnResult({data:{user:null,session:null},error:new Os}):(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("USER_UPDATED",h.session)),this._returnResult({data:h,error:p}))}catch(i){if(Ve(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}})}async unlinkIdentity(e){try{return await this._useSession(async r=>{var n,i;const{data:s,error:o}=r;if(o)throw o;return await Je(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(r){if(Ve(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await bj(async i=>(i>0&&await xj(200*Math.pow(2,i-1)),this._debug(r,"refreshing attempt",i),await Je(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:on})),(i,s)=>{const o=200*Math.pow(2,i);return s&&yu(s)&&Date.now()+o-n<zs})}catch(n){if(this._debug(r,"error",n),Ve(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",n),sr()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const i=await qi(this.storage,this.storageKey);if(i&&this.userStorage){let o=await qi(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:i.user},await Fs(this.userStorage,this.storageKey+"-user",o)),i.user=(e=o==null?void 0:o.user)!==null&&e!==void 0?e:bu()}else if(i&&!i.user&&!i.user){const o=await qi(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(i.user=o.user,await pi(this.storage,this.storageKey+"-user"),await Fs(this.storage,this.storageKey,i)):i.user=bu()}if(this._debug(n,"session from storage",i),!this._isValidSession(i)){this._debug(n,"session is not valid"),i!==null&&await this._removeSession();return}const s=((r=i.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<vu;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${vu}s`),s){if(this.autoRefreshToken&&i.refresh_token){const{error:o}=await this._callRefreshToken(i.refresh_token);o&&(console.error(o),yu(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(i.access_token);!l&&(o!=null&&o.user)?(i.user=o.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(n,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(n,"error",i),console.error(i);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var r,n;if(!e)throw new sn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new _d;const{data:s,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!s.session)throw new sn;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const l={data:s.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(s){if(this._debug(i,"error",s),Ve(s)){const o={data:null,error:s};return yu(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,r,n=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:r});const s=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,r)}catch(c){s.push(c)}});if(await Promise.all(o),s.length>0){for(let l=0;l<s.length;l+=1)console.error(s[l]);throw s[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const r=Object.assign({},e),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await Fs(this.userStorage,this.storageKey+"-user",{user:r.user});const i=Object.assign({},r);delete i.user;const s=Yg(i);await Fs(this.storage,this.storageKey,s)}else{const i=Yg(r);await Fs(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),await pi(this.storage,this.storageKey),await pi(this.storage,this.storageKey+"-code-verifier"),await pi(this.storage,this.storageKey+"-user"),this.userStorage&&await pi(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&sr()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),zs);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-e)/zs);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${zs}ms, refresh threshold is ${Xh} ticks`),i<=Xh&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Tw)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!sr()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,n){const i=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,o]=await As(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(o)}`});i.push(l.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);i.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;return s?this._returnResult({data:null,error:s}):await Je(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Ve(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(e){try{return await this._useSession(async r=>{var n,i;const{data:s,error:o}=r;if(o)return this._returnResult({data:null,error:o});const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:c,error:d}=await Je(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return d?this._returnResult({data:null,error:d}):(e.factorType==="totp"&&c.type==="totp"&&(!((i=c==null?void 0:c.totp)===null||i===void 0)&&i.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(r){if(Ve(r))return this._returnResult({data:null,error:r});throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return this._returnResult({data:null,error:s});const o=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?Kj(e.webauthn.credential_response):Zj(e.webauthn.credential_response)})}:{code:e.code}),{data:l,error:c}=await Je(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:o,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:c}))})}catch(r){if(Ve(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return this._returnResult({data:null,error:s});const o=await Je(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});if(o.error)return o;const{data:l}=o;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:Yj(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:Xj(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Ve(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(e){const{data:r,error:n}=await this._challenge({factorId:e.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){var e;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const i={all:[],phone:[],totp:[],webauthn:[]};for(const s of(e=r==null?void 0:r.factors)!==null&&e!==void 0?e:[])i.all.push(s),s.status==="verified"&&i[s.factor_type].push(s);return{data:i,error:null}}async _getAuthenticatorAssuranceLevel(){var e,r;const{data:{session:n},error:i}=await this.getSession();if(i)return this._returnResult({data:null,error:i});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:s}=xu(n.access_token);let o=null;s.aal&&(o=s.aal);let l=o;((r=(e=n.user.factors)===null||e===void 0?void 0:e.filter(u=>u.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const d=s.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:d},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async r=>{const{data:{session:n},error:i}=r;return i?this._returnResult({data:null,error:i}):n?await Je(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:n.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new sn})})}catch(r){if(Ve(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(e,r){try{return await this._useSession(async n=>{const{data:{session:i},error:s}=n;if(s)return this._returnResult({data:null,error:s});if(!i)return this._returnResult({data:null,error:new sn});const o=await Je(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&sr()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(n){if(Ve(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(e,r){try{return await this._useSession(async n=>{const{data:{session:i},error:s}=n;if(s)return this._returnResult({data:null,error:s});if(!i)return this._returnResult({data:null,error:new sn});const o=await Je(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&sr()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(n){if(Ve(n))return this._returnResult({data:null,error:n});throw n}}async fetchJwk(e,r={keys:[]}){let n=r.keys.find(l=>l.kid===e);if(n)return n;const i=Date.now();if(n=this.jwks.keys.find(l=>l.kid===e),n&&this.jwks_cached_at+sj>i)return n;const{data:s,error:o}=await Je(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=i,n=s.keys.find(l=>l.kid===e),!n)?null:n}async getClaims(e,r={}){try{let n=e;if(!n){const{data:p,error:g}=await this.getSession();if(g||!p.session)return this._returnResult({data:null,error:g});n=p.session.access_token}const{header:i,payload:s,signature:o,raw:{header:l,payload:c}}=xu(n);r!=null&&r.allowExpired||Ej(s.exp);const d=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!d){const{error:p}=await this.getUser(n);if(p)throw p;return{data:{claims:s,header:i,signature:o},error:null}}const u=Tj(i.alg),f=await crypto.subtle.importKey("jwk",d,u,!0,["verify"]);if(!await crypto.subtle.verify(u,f,o,pj(`${l}.${c}`)))throw new Jh("Invalid JWT signature");return{data:{claims:s,header:i,signature:o},error:null}}catch(n){if(Ve(n))return this._returnResult({data:null,error:n});throw n}}}Qa.nextInstanceID=0;const oC=Qa;class aC extends oC{constructor(e){super(e)}}class lC{constructor(e,r,n){var i,s,o;this.supabaseUrl=e,this.supabaseKey=r;const l=ej(e);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,d={db:Vk,realtime:Yk,auth:Object.assign(Object.assign({},qk),{storageKey:c}),global:Gk},u=Qk(n??{},d);this.storageKey=(i=u.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(s=u.global.headers)!==null&&s!==void 0?s:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(f,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=u.auth)!==null&&o!==void 0?o:{},this.headers,u.global.fetch),this.fetch=Zk(r,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new tk(new URL("rest/v1",l).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new Hk(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new JS(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,r,n)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,r;if(this.accessToken)return await this.accessToken();const{data:n}=await this.auth.getSession();return(r=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:i,userStorage:s,storageKey:o,flowType:l,lock:c,debug:d,throwOnError:u},f,h){const p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new aC({url:this.authUrl.href,headers:Object.assign(Object.assign({},p),f),storageKey:o,autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:i,userStorage:s,flowType:l,lock:c,debug:d,throwOnError:u,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(g=>g.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new yk(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(e,r,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const cC=(t,e,r)=>new lC(t,e,r);function dC(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}dC()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const t0={DRAFTIFY:"/api/studio-draftify",GEOMETRIC_GENERATE:"/api/studio-generate-geometric"},r0={URL:"https://okakomwfikxmwllvliva.supabase.co",ANON_KEY:""},n0={AUTH_SESSION:"studio_auth_session"},Vt=cC(r0.URL,r0.ANON_KEY),Pn={async signIn(t,e){const{data:r,error:n}=await Vt.auth.signInWithPassword({email:t,password:e});if(n)throw n;return localStorage.setItem(n0.AUTH_SESSION,JSON.stringify(r.session)),r},async signOut(){await Vt.auth.signOut(),localStorage.removeItem(n0.AUTH_SESSION)},async getSession(){const{data:t}=await Vt.auth.getSession();return t.session},async updatePassword(t){const{data:e,error:r}=await Vt.auth.updateUser({password:t});if(r)throw r;return await Vt.auth.updateUser({data:{password_setup_complete:!0}}),e},onAuthStateChange(t){return Vt.auth.onAuthStateChange(t)}};async function Sd(){var r,n;const t=await Vt.auth.getSession(),e=(n=(r=t==null?void 0:t.data)==null?void 0:r.session)==null?void 0:n.access_token;if(!e)throw new Error("Not authenticated");return{"Content-Type":"application/json",Authorization:`Bearer ${e}`}}async function vp(t){const e=await Sd(),r=await fetch("/api/designs/save",{method:"POST",headers:e,body:JSON.stringify(t)});if(!r.ok){const n=await r.json();throw new Error(n.error||"Unable to save your design. Please check your connection and try again.")}return r.json()}async function Wc({project_id:t,limit:e=50,offset:r=0,search:n}={}){const i=await Sd(),s=new URLSearchParams;t&&s.append("project_id",t),s.append("limit",e),s.append("offset",r),n&&s.append("search",n);const o=await fetch(`/api/designs/list?${s}`,{method:"GET",headers:i});if(!o.ok){const l=await o.json();throw new Error(l.error||"Unable to load your designs. Please refresh the page and try again.")}return o.json()}async function cl(t){const e=await Sd(),r=await fetch(`/api/designs/by-id?id=${t}`,{method:"GET",headers:e});if(!r.ok){const n=await r.json();throw new Error(n.error||"Unable to open this design. It may have been deleted or you may not have permission to view it.")}return r.json()}async function uC(t){const e=await Sd(),r=await fetch(`/api/designs/by-id?id=${t}`,{method:"DELETE",headers:e});if(!r.ok){const n=await r.json();throw new Error(n.error||"Unable to delete this design. Please check your connection and try again.")}return r.json()}class hC extends $.Component{constructor(r){super(r);ym(this,"handleReset",()=>{this.setState({hasError:!1,error:null,errorInfo:null})});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(r){return{hasError:!0}}componentDidCatch(r,n){console.error("[ErrorBoundary] Caught error:",r,n),this.setState({error:r,errorInfo:n})}render(){return this.state.hasError?a.jsxs("div",{className:"error-boundary",children:[a.jsxs("div",{className:"error-content",children:[a.jsx("h1",{children:"Something went wrong"}),a.jsx("p",{children:"We're sorry, but something unexpected happened. Please try refreshing the page."}),a.jsxs("div",{className:"error-actions",children:[a.jsx("button",{onClick:this.handleReset,className:"btn-primary",children:"Try Again"}),a.jsx("button",{onClick:()=>window.location.reload(),className:"btn-secondary",children:"Refresh Page"})]}),!1]}),a.jsx("style",{jsx:!0,children:`
            .error-boundary {
              min-height: 100vh;
              display: flex;
              align-items: center;
              justify-content: center;
              padding: 2rem;
              background: #f9fafb;
            }

            .error-content {
              max-width: 500px;
              text-align: center;
              background: white;
              padding: 3rem;
              border-radius: 12px;
              box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            }

            h1 {
              color: #1e4a7a;
              margin: 0 0 1rem 0;
              font-size: 1.75rem;
            }

            p {
              color: #6b7280;
              margin: 0 0 2rem 0;
              line-height: 1.6;
            }

            .error-actions {
              display: flex;
              gap: 1rem;
              justify-content: center;
            }

            .btn-primary,
            .btn-secondary {
              padding: 0.75rem 1.5rem;
              border-radius: 6px;
              font-weight: 500;
              cursor: pointer;
              transition: all 0.2s;
              border: none;
            }

            .btn-primary {
              background: #ff6b35;
              color: white;
            }

            .btn-primary:hover {
              background: #e55a2b;
              transform: translateY(-1px);
            }

            .btn-secondary {
              background: white;
              color: #374151;
              border: 1px solid #d1d5db;
            }

            .btn-secondary:hover {
              background: #f9fafb;
            }

            .error-details {
              margin-top: 2rem;
              text-align: left;
              font-size: 0.875rem;
            }

            .error-details summary {
              cursor: pointer;
              color: #6b7280;
              margin-bottom: 0.5rem;
            }

            .error-details pre {
              background: #f3f4f6;
              padding: 1rem;
              border-radius: 4px;
              overflow-x: auto;
              font-size: 0.75rem;
              color: #dc2626;
            }
          `})]}):this.props.children}}const fC="modulepreload",pC=function(t){return"/"+t},i0={},mC=function(e,r,n){let i=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(r.map(c=>{if(c=pC(c),c in i0)return;i0[c]=!0;const d=c.endsWith(".css"),u=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const f=document.createElement("link");if(f.rel=d?"stylesheet":fC,d||(f.as="script"),f.crossOrigin="",f.href=c,l&&f.setAttribute("nonce",l),document.head.appendChild(f),d)return new Promise((h,p)=>{f.addEventListener("load",h),f.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return i.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})},s0=t=>{let e;const r=new Set,n=(d,u)=>{const f=typeof d=="function"?d(e):d;if(!Object.is(f,e)){const h=e;e=u??(typeof f!="object"||f===null)?f:Object.assign({},e,f),r.forEach(p=>p(e,h))}},i=()=>e,l={setState:n,getState:i,getInitialState:()=>c,subscribe:d=>(r.add(d),()=>r.delete(d))},c=e=t(n,i,l);return l},gC=t=>t?s0(t):s0,vC=t=>t;function yC(t,e=vC){const r=$.useSyncExternalStore(t.subscribe,$.useCallback(()=>e(t.getState()),[t,e]),$.useCallback(()=>e(t.getInitialState()),[t,e]));return $.useDebugValue(r),r}const o0=t=>{const e=gC(t),r=n=>yC(e,n);return Object.assign(r,e),r},Pw=t=>t?o0(t):o0,a0={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},el=new Map,Vl=t=>{const e=el.get(t);return e?Object.fromEntries(Object.entries(e.stores).map(([r,n])=>[r,n.getState()])):{}},xC=(t,e,r)=>{if(t===void 0)return{type:"untracked",connection:e.connect(r)};const n=el.get(r.name);if(n)return{type:"tracked",store:t,...n};const i={connection:e.connect(r),stores:{}};return el.set(r.name,i),{type:"tracked",store:t,...i}},bC=(t,e)=>{if(e===void 0)return;const r=el.get(t);r&&(delete r.stores[e],Object.keys(r.stores).length===0&&el.delete(t))},wC=t=>{var e,r;if(!t)return;const n=t.split(`
`),i=n.findIndex(o=>o.includes("api.setState"));if(i<0)return;const s=((e=n[i+1])==null?void 0:e.trim())||"";return(r=/.+ (.+) .+/.exec(s))==null?void 0:r[1]},_C=(t,e={})=>(r,n,i)=>{const{enabled:s,anonymousActionType:o,store:l,...c}=e;let d;try{d=(s??(a0?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!d)return t(r,n,i);const{connection:u,...f}=xC(l,d,c);let h=!0;i.setState=(m,x,v)=>{const y=r(m,x);if(!h)return y;const b=v===void 0?{type:o||wC(new Error().stack)||"anonymous"}:typeof v=="string"?{type:v}:v;return l===void 0?(u==null||u.send(b,n()),y):(u==null||u.send({...b,type:`${l}/${b.type}`},{...Vl(c.name),[l]:i.getState()}),y)},i.devtools={cleanup:()=>{u&&typeof u.unsubscribe=="function"&&u.unsubscribe(),bC(c.name,l)}};const p=(...m)=>{const x=h;h=!1,r(...m),h=x},g=t(i.setState,n,i);if(f.type==="untracked"?u==null||u.init(g):(f.stores[f.store]=i,u==null||u.init(Object.fromEntries(Object.entries(f.stores).map(([m,x])=>[m,m===f.store?g:x.getState()])))),i.dispatchFromDevtools&&typeof i.dispatch=="function"){let m=!1;const x=i.dispatch;i.dispatch=(...v)=>{(a0?"production":void 0)!=="production"&&v[0].type==="__setState"&&!m&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),m=!0),x(...v)}}return u.subscribe(m=>{var x;switch(m.type){case"ACTION":if(typeof m.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return _u(m.payload,v=>{if(v.type==="__setState"){if(l===void 0){p(v.state);return}Object.keys(v.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format.
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const y=v.state[l];if(y==null)return;JSON.stringify(i.getState())!==JSON.stringify(y)&&p(y);return}i.dispatchFromDevtools&&typeof i.dispatch=="function"&&i.dispatch(v)});case"DISPATCH":switch(m.payload.type){case"RESET":return p(g),l===void 0?u==null?void 0:u.init(i.getState()):u==null?void 0:u.init(Vl(c.name));case"COMMIT":if(l===void 0){u==null||u.init(i.getState());return}return u==null?void 0:u.init(Vl(c.name));case"ROLLBACK":return _u(m.state,v=>{if(l===void 0){p(v),u==null||u.init(i.getState());return}p(v[l]),u==null||u.init(Vl(c.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return _u(m.state,v=>{if(l===void 0){p(v);return}JSON.stringify(i.getState())!==JSON.stringify(v[l])&&p(v[l])});case"IMPORT_STATE":{const{nextLiftedState:v}=m.payload,y=(x=v.computedStates.slice(-1)[0])==null?void 0:x.state;if(!y)return;p(l===void 0?y:y[l]),u==null||u.send(null,v);return}case"PAUSE_RECORDING":return h=!h}return}}),g},Ow=_C,_u=(t,e)=>{let r;try{r=JSON.parse(t)}catch(n){console.error("[zustand devtools middleware] Could not parse the received json",n)}r!==void 0&&e(r)};function Aw(t){let e=t%2147483647;return e<=0&&(e+=2147483646),function(){return e=e*16807%2147483647,(e-1)/2147483646}}function l0(t,e,r){const n=Aw(r),i=[],s=.4,o=.5,l=.5;for(let c=0;c<t;c++){const d=c/t*Math.PI*2-Math.PI/2,u=(n()-.5)*.4*e,f=d+u,h=1+(n()-.5)*e*.8,p=s*h,g=o+p*Math.cos(f),m=l+p*Math.sin(f),x=.35/t*(1+e*(n()-.5)),v=f+Math.PI/2,y=(n()-.5)*.3*e,b=v+Math.PI+y,w=v+y;i.push({x:g,y:m,handleIn:{x:Math.cos(b)*x,y:Math.sin(b)*x},handleOut:{x:Math.cos(w)*x,y:Math.sin(w)*x}})}return i}function SC(t,e,r){if(!t||t.length<3)return kC(e,r);const n=[],i=t.length;for(let s=0;s<i;s++){const o=t[s],l=t[(s+1)%i],c=o.x*e,d=o.y*r,u=l.x*e,f=l.y*r,h=c+o.handleOut.x*e,p=d+o.handleOut.y*r,g=u+l.handleIn.x*e,m=f+l.handleIn.y*r;s===0&&n.push(`M ${c.toFixed(2)},${d.toFixed(2)}`),n.push(`C ${h.toFixed(2)},${p.toFixed(2)} ${g.toFixed(2)},${m.toFixed(2)} ${u.toFixed(2)},${f.toFixed(2)}`)}return n.push("Z"),n.join(" ")}function kC(t,e){const r=t/2,n=e/2,i=r,s=n;return`M ${i-r},${s} A ${r},${n} 0 1,1 ${i+r},${s} A ${r},${n} 0 1,1 ${i-r},${s} Z`}function jC(){const r=[];for(let o=0;o<8;o++){const l=o/8*Math.PI*2-Math.PI/2,c=.5+.4*Math.cos(l),d=.5+.4*Math.sin(l),u=l+Math.PI/2;r.push({x:c,y:d,handleIn:{x:Math.cos(u+Math.PI)*.2,y:Math.sin(u+Math.PI)*.2},handleOut:{x:Math.cos(u)*.2,y:Math.sin(u)*.2}})}return r}const Gc={organic:{name:"Organic",description:"Smooth, gentle curves like a pebble",minPoints:6,maxPoints:8,blobinessMin:.15,blobinessMax:.25,handleLengthFactor:.4,radiusVariation:.15},splashy:{name:"Splashy",description:"Irregular edges, some spikes like paint splatter",minPoints:10,maxPoints:12,blobinessMin:.3,blobinessMax:.5,handleLengthFactor:.25,radiusVariation:.35},cloudy:{name:"Cloudy",description:"Soft bumps, fluffy cloud-like appearance",minPoints:8,maxPoints:10,blobinessMin:.2,blobinessMax:.3,handleLengthFactor:.5,radiusVariation:.2},rocky:{name:"Rocky",description:"Angular variations, irregular stone-like edges",minPoints:8,maxPoints:12,blobinessMin:.25,blobinessMax:.4,handleLengthFactor:.2,radiusVariation:.3}};function Su(t,e){const r=Gc[t]||Gc.organic,n=Aw(e),i=Math.floor(n()*(r.maxPoints-r.minPoints+1))+r.minPoints,s=r.blobinessMin+n()*(r.blobinessMax-r.blobinessMin),o=[],l=.4,c=.5,d=.5;for(let u=0;u<i;u++){const f=u/i*Math.PI*2-Math.PI/2,h=(n()-.5)*.4*s,p=f+h,g=1+(n()-.5)*r.radiusVariation*2,m=l*g,x=c+m*Math.cos(p),v=d+m*Math.sin(p),b=r.handleLengthFactor/i*(.8+n()*.4),w=p+Math.PI/2,k=(n()-.5)*.3*s,_=w+Math.PI+k,C=w+k;o.push({x,y:v,handleIn:{x:Math.cos(_)*b,y:Math.sin(_)*b},handleOut:{x:Math.cos(C)*b,y:Math.sin(C)*b}})}return o}function CC(t,e,r,n){return{x:r?.5-(t-.5):t,y:n?.5-(e-.5):e}}function EC(t,e,r,n){return{x:r?-t:t,y:n?-e:e}}function Mw(t,e,r,n=4){const i=[{index:t,mirrorX:!1,mirrorY:!1,rotationAngle:0}];if(r==="none"||!r)return i;if(r==="horizontal"){const s=(e-t)%e;return s!==t&&i.push({index:s,mirrorX:!0,mirrorY:!1,rotationAngle:0}),i}if(r==="vertical"){const s=(Math.floor(e/2)-t+e)%e;return s!==t&&i.push({index:s,mirrorX:!1,mirrorY:!0,rotationAngle:0}),i}if(r==="radial"){for(let s=1;s<n;s++){const o=Math.round(t+s*e/n)%e;if(o!==t){const l=s*2*Math.PI/n;i.push({index:o,mirrorX:!1,mirrorY:!1,rotationAngle:l})}}return i}return i}function TC(t,e,r,n,i,s=4){if(i==="none"||!i)return t.map((l,c)=>c!==e?l:{...l,x:r,y:n});const o=Mw(e,t.length,i,s);return t.map((l,c)=>{const d=o.find(f=>f.index===c);if(!d)return l;if(d.rotationAngle!==0){const p=r-.5,g=n-.5,m=Math.cos(d.rotationAngle),x=Math.sin(d.rotationAngle);return{...l,x:.5+p*m-g*x,y:.5+p*x+g*m}}const u=CC(r,n,d.mirrorX,d.mirrorY);return{...l,x:u.x,y:u.y}})}function NC(t,e,r,n,i,s,o=4){if(s==="none"||!s)return t.map((c,d)=>d!==e?c:{...c,[r]:{x:n,y:i}});const l=Mw(e,t.length,s,o);return t.map((c,d)=>{const u=l.find(g=>g.index===d);if(!u)return c;let f=r,h=n,p=i;if(u.rotationAngle!==0){const g=Math.cos(u.rotationAngle),m=Math.sin(u.rotationAngle);h=n*g-i*m,p=n*m+i*g}else{const g=EC(n,i,u.mirrorX,u.mirrorY);h=g.x,p=g.y}return{...c,[f]:{x:h,y:p}}})}const ku={surface:{width_mm:5e4,length_mm:5e4,color:{tpv_code:"RH12",hex:"#006C55",name:"Dark Green"}},courts:{},selectedCourtId:null,tracks:{},selectedTrackId:null,motifs:{},selectedMotifId:null,shapes:{},selectedShapeId:null,texts:{},selectedTextId:null,editingTextId:null,elementOrder:[],customMarkings:[],backgroundZones:[],designName:"Untitled Design",designDescription:"",designTags:[],history:[],historyIndex:-1,maxHistory:50,showCourtLibrary:!0,showPropertiesPanel:!0,propertiesPanelUserClosed:!1,showColorEditor:!1,snapToGrid:!0,gridSize_mm:100,mobileLibraryOpen:!1,mobilePropertiesOpen:!1,mobileColoursOpen:!1,mobileActiveTab:"courts",standaloneMode:!1,standaloneDesignId:null,isSaving:!1,lastSaved:null},st=Pw(Ow((t,e)=>({...ku,setSurfaceDimensions:(r,n)=>{t(i=>({surface:{...i.surface,width_mm:r,length_mm:n}})),e().addToHistory()},setSurfaceColor:r=>{t(n=>({surface:{...n.surface,color:r}})),e().addToHistory()},addCourt:(r,n)=>{const i=`court-${Date.now()}`,s=u=>({RH01:{tpv_code:"RH01",hex:"#A5362F",name:"Standard Red"},RH02:{tpv_code:"RH02",hex:"#E21F2F",name:"Bright Red"},RH10:{tpv_code:"RH10",hex:"#609B63",name:"Standard Green"},RH11:{tpv_code:"RH11",hex:"#3BB44A",name:"Bright Green"},RH12:{tpv_code:"RH12",hex:"#006C55",name:"Dark Green"},RH20:{tpv_code:"RH20",hex:"#0075BC",name:"Standard Blue"},RH21:{tpv_code:"RH21",hex:"#493D8C",name:"Purple"},RH22:{tpv_code:"RH22",hex:"#47AFE3",name:"Light Blue"},RH23:{tpv_code:"RH23",hex:"#039DC4",name:"Azure"},RH26:{tpv_code:"RH26",hex:"#00A6A3",name:"Turquoise"},RH30:{tpv_code:"RH30",hex:"#E4C4AA",name:"Standard Beige"},RH31:{tpv_code:"RH31",hex:"#E8E3D8",name:"Cream"},RH32:{tpv_code:"RH32",hex:"#8B5F3C",name:"Brown"},RH40:{tpv_code:"RH40",hex:"#E5A144",name:"Mustard Yellow"},RH41:{tpv_code:"RH41",hex:"#FFD833",name:"Bright Yellow"},RH50:{tpv_code:"RH50",hex:"#F15B32",name:"Orange"},RH60:{tpv_code:"RH60",hex:"#59595B",name:"Dark Grey"},RH61:{tpv_code:"RH61",hex:"#939598",name:"Light Grey"},RH65:{tpv_code:"RH65",hex:"#D9D9D6",name:"Pale Grey"},RH70:{tpv_code:"RH70",hex:"#231F20",name:"Black"},RH90:{tpv_code:"RH90",hex:"#E8457E",name:"Funky Pink"}})[u]||{tpv_code:"RH31",hex:"#E8E3D8",name:"Cream"},o={};if(n.defaultLineColor){const u=s(n.defaultLineColor);n.markings.forEach(f=>{o[f.id]=u})}const l={};if(n.defaultLineColor&&n.zones){const u=s(n.defaultLineColor);n.zones.forEach(f=>{l[f.id]=u})}const c=n.defaultSurfaceColor?s(n.defaultSurfaceColor):null,d={id:i,templateId:r,template:n,position:{x:e().surface.width_mm/2-n.dimensions.width_mm/2,y:e().surface.length_mm/2-n.dimensions.length_mm/2},rotation:0,scale:1,lineColorOverrides:o,zoneColorOverrides:l,courtSurfaceColor:c};t(u=>({courts:{...u.courts,[i]:d},elementOrder:[...u.elementOrder,i],selectedCourtId:i,selectedTrackId:null})),e().addToHistory()},removeCourt:r=>{const{[r]:n,...i}=e().courts;t(s=>({courts:i,elementOrder:s.elementOrder.filter(o=>o!==r),selectedCourtId:s.selectedCourtId===r?null:s.selectedCourtId})),e().addToHistory()},updateCourtPosition:(r,n)=>{t(i=>({courts:{...i.courts,[r]:{...i.courts[r],position:n}}}))},updateCourtRotation:(r,n)=>{t(i=>({courts:{...i.courts,[r]:{...i.courts[r],rotation:n}}}))},updateCourtScale:(r,n)=>{t(i=>({courts:{...i.courts,[r]:{...i.courts[r],scale:n}}}))},duplicateCourt:r=>{const n=e().courts[r];if(!n)return;const i=`court-${Date.now()}`,s={...n,id:i,position:{x:n.position.x+500,y:n.position.y+500}};t(o=>({courts:{...o.courts,[i]:s},elementOrder:[...o.elementOrder,i],selectedCourtId:i,selectedTrackId:null})),e().addToHistory()},duplicateTrack:r=>{const n=e().tracks[r];if(!n)return;const i=`track-${Date.now()}`,s={...n,id:i,position:{x:n.position.x+500,y:n.position.y+500}};t(o=>({tracks:{...o.tracks,[i]:s},elementOrder:[...o.elementOrder,i],selectedTrackId:i,selectedCourtId:null})),e().addToHistory()},renameElement:(r,n)=>{r.startsWith("court-")?t(i=>({courts:{...i.courts,[r]:{...i.courts[r],customName:n}}})):r.startsWith("track-")?t(i=>({tracks:{...i.tracks,[r]:{...i.tracks[r],customName:n}}})):r.startsWith("motif-")?t(i=>({motifs:{...i.motifs,[r]:{...i.motifs[r],customName:n}}})):r.startsWith("shape-")?t(i=>({shapes:{...i.shapes,[r]:{...i.shapes[r],customName:n}}})):r.startsWith("text-")&&t(i=>({texts:{...i.texts,[r]:{...i.texts[r],customName:n}}})),e().addToHistory()},toggleElementLock:r=>{r.startsWith("court-")?t(n=>{var i;return{courts:{...n.courts,[r]:{...n.courts[r],locked:!((i=n.courts[r])!=null&&i.locked)}}}}):r.startsWith("track-")?t(n=>{var i;return{tracks:{...n.tracks,[r]:{...n.tracks[r],locked:!((i=n.tracks[r])!=null&&i.locked)}}}}):r.startsWith("motif-")?t(n=>{var i;return{motifs:{...n.motifs,[r]:{...n.motifs[r],locked:!((i=n.motifs[r])!=null&&i.locked)}}}}):r.startsWith("shape-")?t(n=>{var i;return{shapes:{...n.shapes,[r]:{...n.shapes[r],locked:!((i=n.shapes[r])!=null&&i.locked)}}}}):r.startsWith("text-")&&t(n=>{var i;return{texts:{...n.texts,[r]:{...n.texts[r],locked:!((i=n.texts[r])!=null&&i.locked)}}}}),e().addToHistory()},toggleElementVisibility:r=>{r.startsWith("court-")?t(n=>{var i;return{courts:{...n.courts,[r]:{...n.courts[r],visible:((i=n.courts[r])==null?void 0:i.visible)===!1}}}}):r.startsWith("track-")?t(n=>{var i;return{tracks:{...n.tracks,[r]:{...n.tracks[r],visible:((i=n.tracks[r])==null?void 0:i.visible)===!1}}}}):r.startsWith("motif-")?t(n=>{var i;return{motifs:{...n.motifs,[r]:{...n.motifs[r],visible:((i=n.motifs[r])==null?void 0:i.visible)===!1}}}}):r.startsWith("shape-")?t(n=>{var i;return{shapes:{...n.shapes,[r]:{...n.shapes[r],visible:((i=n.shapes[r])==null?void 0:i.visible)===!1}}}}):r.startsWith("text-")&&t(n=>{var i;return{texts:{...n.texts,[r]:{...n.texts[r],visible:((i=n.texts[r])==null?void 0:i.visible)===!1}}}}),e().addToHistory()},setLineColor:(r,n,i)=>{t(s=>({courts:{...s.courts,[r]:{...s.courts[r],lineColorOverrides:{...s.courts[r].lineColorOverrides,[n]:i}}}})),e().addToHistory()},setZoneColor:(r,n,i)=>{t(s=>({courts:{...s.courts,[r]:{...s.courts[r],zoneColorOverrides:{...s.courts[r].zoneColorOverrides,[n]:i}}}})),e().addToHistory()},resetCourtColors:r=>{t(n=>({courts:{...n.courts,[r]:{...n.courts[r],lineColorOverrides:{},zoneColorOverrides:{}}}})),e().addToHistory()},setCourtSurfaceColor:(r,n)=>{t(i=>({courts:{...i.courts,[r]:{...i.courts[r],courtSurfaceColor:n}}})),e().addToHistory()},selectCourt:r=>{const{propertiesPanelUserClosed:n}=e();t(n?{selectedCourtId:r,selectedTrackId:null,selectedMotifId:null,selectedShapeId:null,selectedTextId:null,editingTextId:null}:{selectedCourtId:r,selectedTrackId:null,selectedMotifId:null,selectedShapeId:null,selectedTextId:null,editingTextId:null,showPropertiesPanel:!0})},deselectCourt:()=>{t({selectedCourtId:null,showPropertiesPanel:!1,propertiesPanelUserClosed:!0})},setElementOrder:r=>{t({elementOrder:r})},moveElementUp:r=>{const{elementOrder:n}=e(),i=n.indexOf(r);if(i<n.length-1){const s=[...n];[s[i],s[i+1]]=[s[i+1],s[i]],t({elementOrder:s}),e().addToHistory()}},moveElementDown:r=>{const{elementOrder:n}=e(),i=n.indexOf(r);if(i>0){const s=[...n];[s[i],s[i-1]]=[s[i-1],s[i]],t({elementOrder:s}),e().addToHistory()}},bringToFront:r=>{const{elementOrder:n}=e(),i=n.filter(s=>s!==r);i.push(r),t({elementOrder:i}),e().addToHistory()},sendToBack:r=>{const{elementOrder:n}=e(),i=n.filter(s=>s!==r);i.unshift(r),t({elementOrder:i}),e().addToHistory()},addTrack:(r,n)=>{const i=`track-${Date.now()}`,s=e().surface,o=s.width_mm,l=s.length_mm,c=x=>({RH01:{tpv_code:"RH01",hex:"#A5362F",name:"Standard Red"},RH31:{tpv_code:"RH31",hex:"#E8E3D8",name:"Cream"},RH30:{tpv_code:"RH30",hex:"#E4C4AA",name:"Standard Beige"},RH20:{tpv_code:"RH20",hex:"#0075BC",name:"Standard Blue"},RH12:{tpv_code:"RH12",hex:"#006C55",name:"Dark Green"}})[x]||{tpv_code:x,hex:"#A5362F",name:"Standard Red"},d=n.defaultTrackSurfaceColor?c(n.defaultTrackSurfaceColor):c("RH01"),u=n.trackType==="straight";let f,h,p;const g={enabled:!1,depth_mm:500,style:"staggered",direction:"counterclockwise",startPosition:0};if(u){const x=n.parameters.numLanes,v=n.parameters.laneWidth_mm,y=x*v,b=Math.max(o,l)*.9,w=n.parameters.height_mm||1e5,k=Math.min(w,b);f={...n.parameters,width_mm:y,height_mm:k,cornerRadius:{topLeft:0,topRight:0,bottomLeft:0,bottomRight:0},laneWidth_mm:v,startingBoxes:{...g,...n.parameters.startingBoxes}},p=90,h={x:o/2-y/2,y:l/2-k/2}}else{const x=o*.9,v=l*.9,y=n.parameters.width_mm||25e3,b=n.parameters.height_mm||15e3,w=x/y,k=v/b,_=Math.min(w,k),C=n.parameters.cornerRadius||{topLeft:3e3,topRight:3e3,bottomLeft:3e3,bottomRight:3e3},N={topLeft:C.topLeft*_,topRight:C.topRight*_,bottomLeft:C.bottomLeft*_,bottomRight:C.bottomRight*_};f={...n.parameters,width_mm:x,height_mm:v,cornerRadius:N,laneWidth_mm:n.parameters.laneWidth_mm,startingBoxes:{...g,...n.parameters.startingBoxes}},p=0,h={x:o/2-x/2,y:l/2-v/2}}const m={id:i,templateId:r,template:n,position:h,rotation:p,parameters:f,trackSurfaceColor:d};t(x=>({tracks:{...x.tracks,[i]:m},elementOrder:[...x.elementOrder,i],selectedTrackId:i,selectedCourtId:null})),e().addToHistory()},removeTrack:r=>{const{[r]:n,...i}=e().tracks;t(s=>({tracks:i,elementOrder:s.elementOrder.filter(o=>o!==r),selectedTrackId:s.selectedTrackId===r?null:s.selectedTrackId})),e().addToHistory()},updateTrackParameters:(r,n)=>{t(i=>{var u;const s=i.tracks[r];if(!s)return i;const o=s.parameters,l={...o,...n},c=((u=s.template)==null?void 0:u.trackType)==="straight";let d=s.position;if(c&&n.numLanes!==void 0&&n.numLanes!==o.numLanes){const f=o.laneWidth_mm,h=o.numLanes*f,p=n.numLanes*f;l.width_mm=p;const g=s.position.x+h/2,m=s.position.y+o.height_mm/2;d={x:g-p/2,y:m-l.height_mm/2}}return{tracks:{...i.tracks,[r]:{...s,parameters:l,position:d}}}}),e().addToHistory()},updateTrackPosition:(r,n)=>{t(i=>({tracks:{...i.tracks,[r]:{...i.tracks[r],position:n}}}))},updateTrackRotation:(r,n)=>{t(i=>({tracks:{...i.tracks,[r]:{...i.tracks[r],rotation:n}}}))},setTrackSurfaceColor:(r,n)=>{t(i=>({tracks:{...i.tracks,[r]:{...i.tracks[r],trackSurfaceColor:n}}})),e().addToHistory()},selectTrack:r=>{const{propertiesPanelUserClosed:n}=e();t(n?{selectedTrackId:r,selectedCourtId:null,selectedMotifId:null,selectedShapeId:null,selectedTextId:null,editingTextId:null}:{selectedTrackId:r,selectedCourtId:null,selectedMotifId:null,selectedShapeId:null,selectedTextId:null,editingTextId:null,showPropertiesPanel:!0})},deselectTrack:()=>{t({selectedTrackId:null,showPropertiesPanel:!1,propertiesPanelUserClosed:!0})},addMotif:(r,n,i,s,o,l=null,c={})=>{const d=`motif-${Date.now()}`,u=e().surface,f={id:d,type:"motif",sourceDesignId:r,sourceDesignName:n,sourceThumbnailUrl:l,solidSvgContent:c.solidSvgContent||i,blendSvgContent:c.blendSvgContent||null,hasBothVersions:c.hasBothVersions||!1,viewMode:"solid",svgContent:c.solidSvgContent||i,originalWidth_mm:s,originalHeight_mm:o,position:{x:u.width_mm/2-s/2,y:u.length_mm/2-o/2},rotation:0,scale:1};t(h=>({motifs:{...h.motifs,[d]:f},elementOrder:[...h.elementOrder,d],selectedMotifId:d,selectedCourtId:null,selectedTrackId:null})),e().addToHistory()},removeMotif:r=>{const{[r]:n,...i}=e().motifs;t(s=>({motifs:i,elementOrder:s.elementOrder.filter(o=>o!==r),selectedMotifId:s.selectedMotifId===r?null:s.selectedMotifId})),e().addToHistory()},updateMotifPosition:(r,n)=>{t(i=>({motifs:{...i.motifs,[r]:{...i.motifs[r],position:n}}}))},updateMotifRotation:(r,n)=>{t(i=>({motifs:{...i.motifs,[r]:{...i.motifs[r],rotation:n}}}))},updateMotifScale:(r,n)=>{t(i=>({motifs:{...i.motifs,[r]:{...i.motifs[r],scale:n}}}))},setMotifViewMode:(r,n)=>{const i=e().motifs[r];if(!i)return;const s=n==="blend"?i.blendSvgContent||i.solidSvgContent:i.solidSvgContent||i.blendSvgContent;t(o=>({motifs:{...o.motifs,[r]:{...o.motifs[r],viewMode:n,svgContent:s}}})),e().addToHistory()},duplicateMotif:r=>{const n=e().motifs[r];if(!n)return;const i=`motif-${Date.now()}`,s={...n,id:i,position:{x:n.position.x+500,y:n.position.y+500}};t(o=>({motifs:{...o.motifs,[i]:s},elementOrder:[...o.elementOrder,i],selectedMotifId:i,selectedCourtId:null,selectedTrackId:null})),e().addToHistory()},refreshMotif:async r=>{const n=e().motifs[r];if(!n)return{success:!1,error:"Motif not found"};try{const{fetchMotifFromDesign:i}=await mC(async()=>{const{fetchMotifFromDesign:c}=await Promise.resolve().then(()=>A5);return{fetchMotifFromDesign:c}},void 0),s=await i(n.sourceDesignId),l=(n.viewMode||"solid")==="blend"?s.blendSvgContent||s.solidSvgContent:s.solidSvgContent||s.blendSvgContent;return t(c=>({motifs:{...c.motifs,[r]:{...c.motifs[r],solidSvgContent:s.solidSvgContent,blendSvgContent:s.blendSvgContent,hasBothVersions:s.hasBothVersions,svgContent:l,sourceThumbnailUrl:s.sourceThumbnailUrl,sourceDesignName:s.sourceDesignName,originalWidth_mm:s.originalWidth_mm,originalHeight_mm:s.originalHeight_mm}},lastModified:Date.now()})),e().addToHistory(),{success:!0}}catch(i){return console.error("[MOTIF] Failed to refresh:",i),{success:!1,error:i.message}}},selectMotif:r=>{const{propertiesPanelUserClosed:n}=e();t(n?{selectedMotifId:r,selectedCourtId:null,selectedTrackId:null,selectedShapeId:null,selectedTextId:null,editingTextId:null}:{selectedMotifId:r,selectedCourtId:null,selectedTrackId:null,selectedShapeId:null,selectedTextId:null,editingTextId:null,showPropertiesPanel:!0})},deselectMotif:()=>{t({selectedMotifId:null,showPropertiesPanel:!1,propertiesPanelUserClosed:!0})},addShape:(r="rectangle")=>{const n=`shape-${Date.now()}`,i=e().surface,s=e().shapes,o={rectangle:{sides:4,aspectLocked:!1,width:3e3,height:2e3},square:{sides:4,aspectLocked:!0,width:2e3,height:2e3},circle:{sides:32,aspectLocked:!0,width:2e3,height:2e3},triangle:{sides:3,aspectLocked:!0,width:2e3,height:2e3},pentagon:{sides:5,aspectLocked:!0,width:2e3,height:2e3},hexagon:{sides:6,aspectLocked:!0,width:2e3,height:2e3},polygon:{sides:6,aspectLocked:!0,width:2e3,height:2e3}},l=[{tpv_code:"RH20",hex:"#0075BC",name:"Standard Blue"},{tpv_code:"RH50",hex:"#F15B32",name:"Orange"},{tpv_code:"RH10",hex:"#609B63",name:"Standard Green"},{tpv_code:"RH21",hex:"#493D8C",name:"Purple"},{tpv_code:"RH41",hex:"#FFD833",name:"Bright Yellow"},{tpv_code:"RH26",hex:"#00A6A3",name:"Turquoise"},{tpv_code:"RH02",hex:"#E21F2F",name:"Bright Red"},{tpv_code:"RH90",hex:"#E8457E",name:"Funky Pink"}],c=Object.keys(s).length,d=l[c%l.length];if(r==="blob"){const h=Math.floor(Math.random()*1e5),p="organic",g=Su(p,h),m={id:n,type:"shape",shapeType:"blob",blobStyle:p,seed:h,controlPoints:g,editPointsVisible:!1,numPoints:g.length,blobiness:.2,symmetryMode:"none",radialSymmetryCount:4,width_mm:2e3,height_mm:2e3,position:{x:i.width_mm/2-1e3,y:i.length_mm/2-1e3},rotation:0,fillColor:d,strokeEnabled:!1,strokeColor:null,strokeWidth_mm:50,aspectLocked:!1,locked:!1,visible:!0};t(x=>({shapes:{...x.shapes,[n]:m},elementOrder:[...x.elementOrder,n],selectedShapeId:n,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null})),e().addToHistory();return}const u=o[r]||o.rectangle,f={id:n,type:"shape",shapeType:"polygon",sides:u.sides,width_mm:u.width,height_mm:u.height,cornerRadius:0,position:{x:i.width_mm/2-u.width/2,y:i.length_mm/2-u.height/2},rotation:0,fillColor:d,strokeEnabled:!1,strokeColor:null,strokeWidth_mm:50,aspectLocked:u.aspectLocked,locked:!1,visible:!0};t(h=>({shapes:{...h.shapes,[n]:f},elementOrder:[...h.elementOrder,n],selectedShapeId:n,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null})),e().addToHistory()},removeShape:r=>{const{[r]:n,...i}=e().shapes;t(s=>({shapes:i,elementOrder:s.elementOrder.filter(o=>o!==r),selectedShapeId:s.selectedShapeId===r?null:s.selectedShapeId})),e().addToHistory()},updateShapePosition:(r,n)=>{t(i=>({shapes:{...i.shapes,[r]:{...i.shapes[r],position:n}}}))},updateShapeDimensions:(r,n,i)=>{t(s=>({shapes:{...s.shapes,[r]:{...s.shapes[r],width_mm:n,height_mm:i}}}))},updateShapeSides:(r,n)=>{t(i=>({shapes:{...i.shapes,[r]:{...i.shapes[r],sides:Math.max(3,Math.min(32,n))}}})),e().addToHistory()},updateShapeCornerRadius:(r,n)=>{t(i=>({shapes:{...i.shapes,[r]:{...i.shapes[r],cornerRadius:Math.max(0,Math.min(100,n))}}})),e().addToHistory()},updateShapeRotation:(r,n)=>{t(i=>({shapes:{...i.shapes,[r]:{...i.shapes[r],rotation:n}}}))},setShapeFillColor:(r,n)=>{t(i=>({shapes:{...i.shapes,[r]:{...i.shapes[r],fillColor:n}}})),e().addToHistory()},setShapeStroke:(r,n,i=null,s=50)=>{t(o=>({shapes:{...o.shapes,[r]:{...o.shapes[r],strokeEnabled:n,strokeColor:i,strokeWidth_mm:s}}})),e().addToHistory()},setShapeAspectLock:(r,n)=>{t(i=>{const s=i.shapes[r],o=n?s.width_mm:s.height_mm;return{shapes:{...i.shapes,[r]:{...s,aspectLocked:n,height_mm:o}}}}),e().addToHistory()},updateBlobPoints:(r,n)=>{t(i=>{const s=i.shapes[r];if(!s||s.shapeType!=="blob")return i;const o=l0(n,s.blobiness,s.seed);return{shapes:{...i.shapes,[r]:{...s,numPoints:n,controlPoints:o}}}}),e().addToHistory()},updateBlobiness:(r,n)=>{t(i=>{const s=i.shapes[r];if(!s||s.shapeType!=="blob")return i;const o=l0(s.numPoints,n,s.seed);return{shapes:{...i.shapes,[r]:{...s,blobiness:n,controlPoints:o}}}}),e().addToHistory()},randomizeBlob:r=>{t(n=>{const i=n.shapes[r];if(!i||i.shapeType!=="blob")return n;const s=Math.floor(Math.random()*1e5),o=i.blobStyle||"organic",l=Su(o,s);return{shapes:{...n.shapes,[r]:{...i,seed:s,controlPoints:l,numPoints:l.length}}}}),e().addToHistory()},setBlobStyle:(r,n)=>{t(i=>{const s=i.shapes[r];if(!s||s.shapeType!=="blob")return i;const o=Su(n,s.seed);return{shapes:{...i.shapes,[r]:{...s,blobStyle:n,controlPoints:o,numPoints:o.length}}}}),e().addToHistory()},setEditPointsVisible:(r,n)=>{t(i=>{const s=i.shapes[r];return!s||s.shapeType!=="blob"?i:{shapes:{...i.shapes,[r]:{...s,editPointsVisible:n}}}})},resetBlob:r=>{t(n=>{const i=n.shapes[r];if(!i||i.shapeType!=="blob")return n;const s=jC();return{shapes:{...n.shapes,[r]:{...i,blobiness:0,controlPoints:s}}}}),e().addToHistory()},updateBlobControlPoint:(r,n,i,s)=>{t(o=>{const l=o.shapes[r];if(!l||l.shapeType!=="blob"||!l.controlPoints)return o;const c=Math.max(0,Math.min(1,i)),d=Math.max(0,Math.min(1,s)),u=TC(l.controlPoints,n,c,d,l.symmetryMode||"none",l.radialSymmetryCount||4);return{shapes:{...o.shapes,[r]:{...l,controlPoints:u}}}})},updateBlobHandle:(r,n,i,s,o)=>{t(l=>{const c=l.shapes[r];if(!c||c.shapeType!=="blob"||!c.controlPoints)return l;const d=NC(c.controlPoints,n,i,s,o,c.symmetryMode||"none",c.radialSymmetryCount||4);return{shapes:{...l.shapes,[r]:{...c,controlPoints:d}}}})},commitBlobEdit:()=>{e().addToHistory()},setBlobSymmetry:(r,n,i=4)=>{t(s=>{const o=s.shapes[r];return!o||o.shapeType!=="blob"?s:{shapes:{...s.shapes,[r]:{...o,symmetryMode:n,radialSymmetryCount:i}}}}),e().addToHistory()},applyBlobPreset:(r,n)=>{const i=BLOB_PRESETS[n];!i||!i.controlPoints||(t(s=>{const o=s.shapes[r];return!o||o.shapeType!=="blob"?s:{shapes:{...s.shapes,[r]:{...o,numPoints:i.controlPoints.length,blobiness:0,controlPoints:JSON.parse(JSON.stringify(i.controlPoints))}}}}),e().addToHistory())},duplicateShape:r=>{const n=e().shapes[r];if(!n)return;const i=`shape-${Date.now()}`,s={...n,id:i,position:{x:n.position.x+500,y:n.position.y+500}};t(o=>({shapes:{...o.shapes,[i]:s},elementOrder:[...o.elementOrder,i],selectedShapeId:i,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null})),e().addToHistory()},selectShape:r=>{const{propertiesPanelUserClosed:n}=e();t(n?{selectedShapeId:r,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,selectedTextId:null,editingTextId:null}:{selectedShapeId:r,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,selectedTextId:null,editingTextId:null,showPropertiesPanel:!0})},deselectShape:()=>{t({selectedShapeId:null,showPropertiesPanel:!1,propertiesPanelUserClosed:!0})},addText:()=>{const{surface:r}=e(),n=`text-${Date.now()}`,i={id:n,type:"text",content:"",fontFamily:"Open Sans, sans-serif",fontSize_mm:500,fontWeight:"normal",fontStyle:"normal",textAlign:"left",position:{x:r.width_mm/2,y:r.length_mm/2},rotation:0,fillColor:{tpv_code:"RH70",hex:"#1C1C1C",name:"Black"},locked:!1,visible:!0,customName:null};t(s=>({texts:{...s.texts,[n]:i},elementOrder:[...s.elementOrder,n],selectedTextId:n,editingTextId:n,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,selectedShapeId:null})),e().addToHistory()},removeText:r=>{t(n=>{const{[r]:i,...s}=n.texts;return{texts:s,elementOrder:n.elementOrder.filter(o=>o!==r),selectedTextId:n.selectedTextId===r?null:n.selectedTextId,editingTextId:n.editingTextId===r?null:n.editingTextId}}),e().addToHistory()},selectText:r=>{const{propertiesPanelUserClosed:n}=e();t(n?{selectedTextId:r,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,selectedShapeId:null}:{selectedTextId:r,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,selectedShapeId:null,showPropertiesPanel:!0})},deselectText:()=>{t({selectedTextId:null,editingTextId:null,showPropertiesPanel:!1,propertiesPanelUserClosed:!0})},startEditingText:r=>{t({editingTextId:r})},stopEditingText:()=>{t({editingTextId:null}),e().addToHistory()},updateTextContent:(r,n)=>{t(i=>({texts:{...i.texts,[r]:{...i.texts[r],content:n}}}))},updateTextPosition:(r,n)=>{t(i=>({texts:{...i.texts,[r]:{...i.texts[r],position:n}}}))},updateTextFontSize:(r,n)=>{t(i=>({texts:{...i.texts,[r]:{...i.texts[r],fontSize_mm:Math.max(50,n)}}})),e().addToHistory()},updateTextFont:(r,n,i,s)=>{t(o=>({texts:{...o.texts,[r]:{...o.texts[r],fontFamily:n,fontWeight:i,fontStyle:s}}})),e().addToHistory()},updateTextAlign:(r,n)=>{t(i=>({texts:{...i.texts,[r]:{...i.texts[r],textAlign:n}}})),e().addToHistory()},updateTextRotation:(r,n)=>{t(i=>({texts:{...i.texts,[r]:{...i.texts[r],rotation:n}}}))},setTextFillColor:(r,n)=>{t(i=>({texts:{...i.texts,[r]:{...i.texts[r],fillColor:n}}})),e().addToHistory()},duplicateText:r=>{const{texts:n}=e(),i=n[r];if(!i)return;const s=`text-${Date.now()}`,o={...i,id:s,position:{x:i.position.x+500,y:i.position.y+500},customName:i.customName?`${i.customName} (copy)`:null};t(l=>({texts:{...l.texts,[s]:o},elementOrder:[...l.elementOrder,s],selectedTextId:s,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,selectedShapeId:null})),e().addToHistory()},addCustomMarking:r=>{t(n=>({customMarkings:[...n.customMarkings,{...r,id:`custom-${Date.now()}`}]})),e().addToHistory()},removeCustomMarking:r=>{t(n=>({customMarkings:n.customMarkings.filter(i=>i.id!==r)})),e().addToHistory()},addBackgroundZone:r=>{t(n=>({backgroundZones:[...n.backgroundZones,{...r,id:`zone-${Date.now()}`}]})),e().addToHistory()},removeBackgroundZone:r=>{t(n=>({backgroundZones:n.backgroundZones.filter(i=>i.id!==r)})),e().addToHistory()},setDesignName:r=>{t({designName:r})},setDesignDescription:r=>{t({designDescription:r})},setDesignTags:r=>{t({designTags:r})},addToHistory:()=>{const r=e(),n={surface:r.surface,courts:r.courts,tracks:r.tracks,motifs:r.motifs,shapes:r.shapes,texts:r.texts,elementOrder:r.elementOrder,customMarkings:r.customMarkings,backgroundZones:r.backgroundZones};t(i=>{const s=i.history.slice(0,i.historyIndex+1);return s.push(n),s.length>i.maxHistory&&s.shift(),{history:s,historyIndex:s.length-1}})},undo:()=>{const{history:r,historyIndex:n}=e();if(n>0){const i=r[n-1];t({...i,historyIndex:n-1})}},redo:()=>{const{history:r,historyIndex:n}=e();if(n<r.length-1){const i=r[n+1];t({...i,historyIndex:n+1})}},canUndo:()=>e().historyIndex>0,canRedo:()=>e().historyIndex<e().history.length-1,toggleCourtLibrary:()=>{t(r=>({showCourtLibrary:!r.showCourtLibrary}))},togglePropertiesPanel:()=>{t(r=>({showPropertiesPanel:!r.showPropertiesPanel,propertiesPanelUserClosed:!!r.showPropertiesPanel}))},setMobileLibraryOpen:r=>t({mobileLibraryOpen:r}),setMobilePropertiesOpen:r=>t({mobilePropertiesOpen:r}),setMobileColoursOpen:r=>t({mobileColoursOpen:r}),setMobileActiveTab:r=>t({mobileActiveTab:r}),closeMobileSheets:()=>t({mobileLibraryOpen:!1,mobilePropertiesOpen:!1,mobileColoursOpen:!1}),toggleColorEditor:()=>{t(r=>({showColorEditor:!r.showColorEditor}))},toggleSnapToGrid:()=>{t(r=>({snapToGrid:!r.snapToGrid}))},setGridSize:r=>{t({gridSize_mm:r})},toggleStandaloneMode:()=>{t(r=>({standaloneMode:!r.standaloneMode}))},setStandaloneMode:(r,n=null)=>{t({standaloneMode:r,standaloneDesignId:n})},setSaving:r=>{t({isSaving:r})},setLastSaved:r=>{t({lastSaved:r})},loadDesign:r=>{let n=r.elementOrder;!n&&(r.courtOrder||r.trackOrder)&&(n=[...r.trackOrder||[],...r.courtOrder||[]]),t({surface:r.surface||ku.surface,courts:r.courts||{},tracks:r.tracks||{},motifs:r.motifs||{},shapes:r.shapes||{},texts:r.texts||{},elementOrder:n||[],customMarkings:r.customMarkings||[],backgroundZones:r.backgroundZones||[],designName:r.name||"Untitled Design",designDescription:r.description||"",designTags:r.tags||[],selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,selectedShapeId:null,selectedTextId:null,editingTextId:null,history:[],historyIndex:-1}),e().addToHistory()},exportDesignData:()=>{const r=e();return{surface:r.surface,courts:r.courts,tracks:r.tracks,motifs:r.motifs,shapes:r.shapes,texts:r.texts,elementOrder:r.elementOrder,customMarkings:r.customMarkings,backgroundZones:r.backgroundZones,name:r.designName,description:r.designDescription,tags:r.designTags}},resetDesign:()=>{t(ku)},hasUnsavedChanges:()=>{const r=e();return Object.keys(r.courts).length>0||Object.keys(r.tracks).length>0||Object.keys(r.motifs).length>0||Object.keys(r.shapes).length>0||Object.keys(r.texts).length>0}}),{name:"SportsDesignStore"})),c0={inputMode:"prompt",prompt:"",lengthMM:5e3,widthMM:5e3,selectedFileName:null,uploadedFileUrl:null,arMapping:null,result:null,jobId:null,blendRecipes:null,blendSvgUrl:null,colorMapping:null,blendEditedColors:new Map,solidRecipes:null,solidSvgUrl:null,solidColorMapping:null,solidEditedColors:new Map,viewMode:"solid",showFinalRecipes:!1,showSolidSummary:!1,regionOverrides:new Map,originalTaggedSvg:null,regionOverridesHistory:[new Map],historyIndex:0,designName:"",currentDesignId:null,hasGeneratedContent:!1,lastModified:null},Vc=Pw(Ow((t,e)=>({...c0,setInputMode:r=>t({inputMode:r}),setPrompt:r=>t({prompt:r,lastModified:Date.now()}),setDimensions:(r,n)=>t({widthMM:r,lengthMM:n,lastModified:Date.now()}),setArMapping:r=>t({arMapping:r}),setSelectedFile:(r,n)=>t({selectedFileName:r,uploadedFileUrl:n,lastModified:Date.now()}),clearSelectedFile:()=>t({selectedFileName:null,uploadedFileUrl:null}),setGenerationResult:(r,n)=>t({result:r,jobId:n,hasGeneratedContent:!0,lastModified:Date.now()}),setResult:r=>t({result:r,hasGeneratedContent:!!r,lastModified:Date.now()}),setJobId:r=>t({jobId:r}),setBlendState:(r,n,i)=>t({blendRecipes:r,colorMapping:n,blendSvgUrl:i,lastModified:Date.now()}),setBlendRecipes:r=>t({blendRecipes:r,lastModified:Date.now()}),setColorMapping:r=>t({colorMapping:r,lastModified:Date.now()}),setBlendSvgUrl:r=>t({blendSvgUrl:r}),setBlendEditedColors:r=>t({blendEditedColors:r,lastModified:Date.now()}),updateBlendSvgUrl:r=>t({blendSvgUrl:r}),setSolidState:(r,n,i)=>t({solidRecipes:r,solidColorMapping:n,solidSvgUrl:i,lastModified:Date.now()}),setSolidRecipes:r=>t({solidRecipes:r,lastModified:Date.now()}),setSolidColorMapping:r=>t({solidColorMapping:r,lastModified:Date.now()}),setSolidSvgUrl:r=>t({solidSvgUrl:r}),setSolidEditedColors:r=>t({solidEditedColors:r,lastModified:Date.now()}),updateSolidSvgUrl:r=>t({solidSvgUrl:r}),setViewMode:r=>t({viewMode:r}),setShowFinalRecipes:r=>t({showFinalRecipes:r}),setShowSolidSummary:r=>t({showSolidSummary:r}),setOriginalTaggedSvg:r=>t({originalTaggedSvg:r}),setRegionOverrides:r=>t({regionOverrides:r,lastModified:Date.now()}),addRegionOverride:(r,n)=>{const i=new Map(e().regionOverrides);i.set(r,n);const s=e().regionOverridesHistory,o=e().historyIndex,l=s.slice(0,o+1);l.push(new Map(i)),l.length>50&&l.shift(),t({regionOverrides:i,regionOverridesHistory:l,historyIndex:l.length-1,lastModified:Date.now()})},setRegionOverridesHistory:r=>{t(typeof r=="function"?{regionOverridesHistory:r(e().regionOverridesHistory)}:{regionOverridesHistory:r})},setHistoryIndex:r=>{t(typeof r=="function"?{historyIndex:r(e().historyIndex)}:{historyIndex:r})},canUndo:()=>e().historyIndex>0,canRedo:()=>e().historyIndex<e().regionOverridesHistory.length-1,undo:()=>{const{historyIndex:r,regionOverridesHistory:n}=e();if(r>0){const i=r-1;t({historyIndex:i,regionOverrides:new Map(n[i])})}},redo:()=>{const{historyIndex:r,regionOverridesHistory:n}=e();if(r<n.length-1){const i=r+1;t({historyIndex:i,regionOverrides:new Map(n[i])})}},setRegionOverridesHistory:(r,n)=>t({regionOverridesHistory:r,historyIndex:n}),setDesignName:r=>t({designName:r}),setCurrentDesignId:r=>t({currentDesignId:r}),loadDesign:r=>{const n=r.regionOverrides||new Map,i=n.size>0?[new Map,new Map(n)]:[new Map],s=n.size>0?1:0;t({inputMode:r.inputMode||"prompt",prompt:r.prompt||"",lengthMM:r.lengthMM||5e3,widthMM:r.widthMM||5e3,uploadedFileUrl:r.selectedFile||null,result:r.result||null,blendRecipes:r.blendRecipes||null,solidRecipes:r.solidRecipes||null,colorMapping:r.colorMapping||null,solidColorMapping:r.solidColorMapping||null,solidEditedColors:r.solidEditedColors||new Map,blendEditedColors:r.blendEditedColors||new Map,blendSvgUrl:r.blendSvgUrl||null,solidSvgUrl:r.solidSvgUrl||null,viewMode:r.viewMode||"solid",arMapping:r.arMapping||null,jobId:r.jobId||null,showFinalRecipes:r.showFinalRecipes||!1,showSolidSummary:r.showSolidSummary||!1,hasGeneratedContent:!!r.result,regionOverrides:n,originalTaggedSvg:r.originalTaggedSvg||null,regionOverridesHistory:i,historyIndex:s,lastModified:Date.now()})},exportDesignData:()=>{const r=e();return{inputMode:r.inputMode,prompt:r.prompt,lengthMM:r.lengthMM,widthMM:r.widthMM,uploadedFileUrl:r.uploadedFileUrl,result:r.result,blendRecipes:r.blendRecipes,solidRecipes:r.solidRecipes,colorMapping:r.colorMapping,solidColorMapping:r.solidColorMapping,solidEditedColors:r.solidEditedColors,blendEditedColors:r.blendEditedColors,viewMode:r.viewMode,arMapping:r.arMapping,jobId:r.jobId,showFinalRecipes:r.showFinalRecipes,showSolidSummary:r.showSolidSummary,regionOverrides:r.regionOverrides,designName:r.designName,currentDesignId:r.currentDesignId}},resetDesign:()=>{const{blendSvgUrl:r,solidSvgUrl:n}=e();r&&r.startsWith("blob:")&&URL.revokeObjectURL(r),n&&n.startsWith("blob:")&&URL.revokeObjectURL(n),t({...c0,blendEditedColors:new Map,solidEditedColors:new Map,regionOverrides:new Map,regionOverridesHistory:[new Map]})},hasUnsavedChanges:()=>{const r=e();return r.hasGeneratedContent||r.prompt.trim()!==""||r.selectedFileName!==null}}),{name:"PlaygroundDesignStore"})),$w={"basketball-full":{id:"basketball-full",name:"Basketball (Full Court)",sport:"basketball",standard:"FIBA 2020",category:"court",description:"Official FIBA standard full basketball court with all markings",dimensions:{length_mm:28e3,width_mm:15e3,min_surround_mm:2e3},defaultSurfaceColor:"RH20",defaultLineColor:"RH31",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:15e3,height:28e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"center-line",name:"Center Line",type:"line",params:{x1:0,y1:14e3,x2:15e3,y2:14e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-circle",name:"Center Circle",type:"circle",params:{cx:7500,cy:14e3,radius:1800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"three-point-arc-top",name:"Three-Point Arc (Top)",type:"arc",params:{cx:7500,cy:26425,radius:6750,startAngle:192,endAngle:348},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"three-point-arc-bottom",name:"Three-Point Arc (Bottom)",type:"arc",params:{cx:7500,cy:1575,radius:6750,startAngle:12,endAngle:168},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"three-point-line-bottom-left",name:"Three-Point Line Bottom Left",type:"line",params:{x1:900,y1:0,x2:900,y2:2990},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"three-point-line-bottom-right",name:"Three-Point Line Bottom Right",type:"line",params:{x1:14100,y1:0,x2:14100,y2:2990},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"three-point-line-top-left",name:"Three-Point Line Top Left",type:"line",params:{x1:900,y1:25010,x2:900,y2:28e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"three-point-line-top-right",name:"Three-Point Line Top Right",type:"line",params:{x1:14100,y1:25010,x2:14100,y2:28e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"free-throw-line-top",name:"Free Throw Line (Top)",type:"line",params:{x1:5050,y1:22200,x2:9950,y2:22200},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"free-throw-line-bottom",name:"Free Throw Line (Bottom)",type:"line",params:{x1:5050,y1:5800,x2:9950,y2:5800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"free-throw-circle-top",name:"Free Throw Circle (Top)",type:"circle",params:{cx:7500,cy:22200,radius:1800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"free-throw-circle-bottom",name:"Free Throw Circle (Bottom)",type:"circle",params:{cx:7500,cy:5800,radius:1800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"key-lane-top",name:"Key Lane (Top)",type:"rectangle",params:{x:5050,y:22200,width:4900,height:5800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"key-lane-bottom",name:"Key Lane (Bottom)",type:"rectangle",params:{x:5050,y:0,width:4900,height:5800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"restricted-area-top",name:"Restricted Area (Top)",type:"arc",params:{cx:7500,cy:28e3,radius:1250,startAngle:180,endAngle:360},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"restricted-area-bottom",name:"Restricted Area (Bottom)",type:"arc",params:{cx:7500,cy:0,radius:1250,startAngle:0,endAngle:180},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[{id:"key-area-top",name:"Key Area (Top)",type:"rectangle",params:{x:5050,y:22200,width:4900,height:5800},defaultColor:"RH20",paintable:!0,area_m2:28.42},{id:"key-area-bottom",name:"Key Area (Bottom)",type:"rectangle",params:{x:5050,y:0,width:4900,height:5800},defaultColor:"RH20",paintable:!0,area_m2:28.42}]},"netball-full":{id:"netball-full",name:"Netball (Full Court)",sport:"netball",standard:"World Netball 2020",category:"court",description:"Official World Netball standard court with goal circles and thirds",dimensions:{length_mm:30500,width_mm:15250,min_surround_mm:3050},defaultSurfaceColor:"RH01",defaultLineColor:"RH31",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:15250,height:30500},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"transverse-line-1",name:"Transverse Line 1",type:"line",params:{x1:0,y1:10167,x2:15250,y2:10167},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"transverse-line-2",name:"Transverse Line 2",type:"line",params:{x1:0,y1:20333,x2:15250,y2:20333},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-circle",name:"Center Circle",type:"circle",params:{cx:7625,cy:15250,radius:450},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"goal-circle-bottom",name:"Goal Circle (Bottom)",type:"arc",params:{cx:7625,cy:0,radius:4900,startAngle:0,endAngle:180},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"goal-circle-top",name:"Goal Circle (Top)",type:"arc",params:{cx:7625,cy:30500,radius:4900,startAngle:180,endAngle:360},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"tennis-doubles":{id:"tennis-doubles",name:"Tennis (Doubles)",sport:"tennis",standard:"ITF 2020",category:"court",description:"Official ITF standard doubles tennis court with all service boxes",dimensions:{length_mm:23770,width_mm:10970,min_surround_mm:3660},defaultSurfaceColor:"RH22",defaultLineColor:"RH29",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:10970,height:23770},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"singles-sideline-left",name:"Singles Sideline (Left)",type:"line",params:{x1:1370,y1:0,x2:1370,y2:23770},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"singles-sideline-right",name:"Singles Sideline (Right)",type:"line",params:{x1:9600,y1:0,x2:9600,y2:23770},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"service-line-bottom",name:"Service Line (Bottom)",type:"line",params:{x1:0,y1:6400,x2:10970,y2:6400},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"service-line-top",name:"Service Line (Top)",type:"line",params:{x1:0,y1:17370,x2:10970,y2:17370},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-service-line",name:"Center Service Line",type:"line",params:{x1:5485,y1:6400,x2:5485,y2:17370},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-mark-bottom",name:"Center Mark (Bottom)",type:"line",params:{x1:5485,y1:0,x2:5485,y2:100},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-mark-top",name:"Center Mark (Top)",type:"line",params:{x1:5485,y1:23670,x2:5485,y2:23770},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"futsal-standard":{id:"futsal-standard",name:"Futsal (5-a-side)",sport:"futsal",standard:"FIFA 2020",category:"court",description:"Official FIFA standard futsal court for international matches",dimensions:{length_mm:4e4,width_mm:2e4,min_surround_mm:1e3},defaultSurfaceColor:"RH50",defaultLineColor:"RH30",defaultLineWidth_mm:80,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:2e4,height:4e4},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"boundary"},{id:"center-line",name:"Center Line",type:"line",params:{x1:0,y1:2e4,x2:2e4,y2:2e4},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"center-circle",name:"Center Circle",type:"circle",params:{cx:1e4,cy:2e4,radius:3e3},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"center-spot",name:"Center Spot",type:"circle",params:{cx:1e4,cy:2e4,radius:100},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"penalty-area-bottom",name:"Penalty Area (Bottom)",type:"arc",params:{cx:1e4,cy:0,radius:6e3,startAngle:0,endAngle:180},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"penalty-area-top",name:"Penalty Area (Top)",type:"arc",params:{cx:1e4,cy:4e4,radius:6e3,startAngle:180,endAngle:360},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"penalty-mark-bottom",name:"Penalty Mark (Bottom)",type:"circle",params:{cx:1e4,cy:6e3,radius:100},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"penalty-mark-top",name:"Penalty Mark (Top)",type:"circle",params:{cx:1e4,cy:34e3,radius:100},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"second-penalty-mark-bottom",name:"Second Penalty Mark (Bottom)",type:"circle",params:{cx:1e4,cy:1e4,radius:100},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"second-penalty-mark-top",name:"Second Penalty Mark (Top)",type:"circle",params:{cx:1e4,cy:3e4,radius:100},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"corner-arc-bl",name:"Corner Arc (Bottom Left)",type:"arc",params:{cx:0,cy:0,radius:250,startAngle:0,endAngle:90},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"corner-arc-br",name:"Corner Arc (Bottom Right)",type:"arc",params:{cx:2e4,cy:0,radius:250,startAngle:90,endAngle:180},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"corner-arc-tl",name:"Corner Arc (Top Left)",type:"arc",params:{cx:0,cy:4e4,radius:250,startAngle:270,endAngle:360},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"corner-arc-tr",name:"Corner Arc (Top Right)",type:"arc",params:{cx:2e4,cy:4e4,radius:250,startAngle:180,endAngle:270},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"}],zones:[]},"volleyball-indoor":{id:"volleyball-indoor",name:"Volleyball (Indoor)",sport:"volleyball",standard:"FIVB",category:"court",description:"Official FIVB standard indoor volleyball court with attack lines",dimensions:{length_mm:18e3,width_mm:9e3,min_surround_mm:3e3},defaultSurfaceColor:"RH40",defaultLineColor:"RH29",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:9e3,height:18e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"center-line",name:"Center Line",type:"line",params:{x1:0,y1:9e3,x2:9e3,y2:9e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"attack-line-bottom",name:"Attack Line (Bottom)",type:"line",params:{x1:0,y1:6e3,x2:9e3,y2:6e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"attack-line-top",name:"Attack Line (Top)",type:"line",params:{x1:0,y1:12e3,x2:9e3,y2:12e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"badminton-full":{id:"badminton-full",name:"Badminton (Full Court)",sport:"badminton",standard:"BWF",category:"court",description:"Official BWF standard full badminton court with singles and doubles lines",dimensions:{length_mm:13400,width_mm:6100,min_surround_mm:1e3},defaultSurfaceColor:"RH26",defaultLineColor:"RH12",defaultLineWidth_mm:40,markings:[{id:"boundary",name:"Boundary Lines (Doubles)",type:"rectangle",params:{x:0,y:0,width:6100,height:13400},defaultColor:"RH31",lineWidth_mm:40,required:!0,category:"boundary"},{id:"singles-sideline-left",name:"Singles Sideline (Left)",type:"line",params:{x1:460,y1:0,x2:460,y2:13400},defaultColor:"RH31",lineWidth_mm:40,required:!0,category:"court-marking"},{id:"singles-sideline-right",name:"Singles Sideline (Right)",type:"line",params:{x1:5640,y1:0,x2:5640,y2:13400},defaultColor:"RH31",lineWidth_mm:40,required:!0,category:"court-marking"},{id:"short-service-line-bottom",name:"Short Service Line (Bottom)",type:"line",params:{x1:0,y1:1980,x2:6100,y2:1980},defaultColor:"RH31",lineWidth_mm:40,required:!0,category:"court-marking"},{id:"short-service-line-top",name:"Short Service Line (Top)",type:"line",params:{x1:0,y1:11420,x2:6100,y2:11420},defaultColor:"RH31",lineWidth_mm:40,required:!0,category:"court-marking"},{id:"doubles-long-service-line-bottom",name:"Doubles Long Service Line (Bottom)",type:"line",params:{x1:0,y1:760,x2:6100,y2:760},defaultColor:"RH31",lineWidth_mm:40,required:!0,category:"court-marking"},{id:"doubles-long-service-line-top",name:"Doubles Long Service Line (Top)",type:"line",params:{x1:0,y1:12640,x2:6100,y2:12640},defaultColor:"RH31",lineWidth_mm:40,required:!0,category:"court-marking"},{id:"center-service-line",name:"Center Service Line",type:"line",params:{x1:3050,y1:1980,x2:3050,y2:11420},defaultColor:"RH31",lineWidth_mm:40,required:!0,category:"court-marking"}],zones:[]},"pickleball-standard":{id:"pickleball-standard",name:"Pickleball",sport:"pickleball",standard:"USA Pickleball",category:"court",description:"Official USA Pickleball standard court with non-volley zone (kitchen)",dimensions:{length_mm:13410,width_mm:6100,min_surround_mm:1e3},defaultSurfaceColor:"RH11",defaultLineColor:"RH31",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:6100,height:13410},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"non-volley-zone-line-bottom",name:"Non-Volley Zone Line (Bottom)",type:"line",params:{x1:0,y1:2130,x2:6100,y2:2130},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"non-volley-zone-line-top",name:"Non-Volley Zone Line (Top)",type:"line",params:{x1:0,y1:11280,x2:6100,y2:11280},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-line",name:"Center Line (Net)",type:"line",params:{x1:0,y1:6705,x2:6100,y2:6705},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-service-line",name:"Center Service Line",type:"line",params:{x1:3050,y1:0,x2:3050,y2:13410},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"basketball-half":{id:"basketball-half",name:"Basketball (Half Court / 3x3)",sport:"basketball",standard:"FIBA 3x3",category:"court",description:"Half-court basketball for 3x3 games, practice, or space-constrained areas",dimensions:{length_mm:11e3,width_mm:15e3,min_surround_mm:2e3},defaultSurfaceColor:"RH20",defaultLineColor:"RH31",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:15e3,height:11e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"three-point-arc",name:"Three-Point Arc",type:"arc",params:{cx:7500,cy:1575,radius:6750,startAngle:12,endAngle:168},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"three-point-line-left",name:"Three-Point Line (Left)",type:"line",params:{x1:900,y1:0,x2:900,y2:2990},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"three-point-line-right",name:"Three-Point Line (Right)",type:"line",params:{x1:14100,y1:0,x2:14100,y2:2990},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"free-throw-line",name:"Free Throw Line",type:"line",params:{x1:5050,y1:5800,x2:9950,y2:5800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"free-throw-circle",name:"Free Throw Circle",type:"circle",params:{cx:7500,cy:5800,radius:1800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"key-lane",name:"Key Lane",type:"rectangle",params:{x:5050,y:0,width:4900,height:5800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"restricted-area",name:"Restricted Area",type:"arc",params:{cx:7500,cy:0,radius:1250,startAngle:0,endAngle:180},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[{id:"key-area",name:"Key Area",type:"rectangle",params:{x:5050,y:0,width:4900,height:5800},defaultColor:"RH20",paintable:!0,area_m2:28.42}]},"tennis-singles":{id:"tennis-singles",name:"Tennis (Singles)",sport:"tennis",standard:"ITF",category:"court",description:"Singles-only tennis court without doubles alleys",dimensions:{length_mm:23770,width_mm:8230,min_surround_mm:3660},defaultSurfaceColor:"RH22",defaultLineColor:"RH29",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:8230,height:23770},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"service-line-bottom",name:"Service Line (Bottom)",type:"line",params:{x1:0,y1:6400,x2:8230,y2:6400},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"service-line-top",name:"Service Line (Top)",type:"line",params:{x1:0,y1:17370,x2:8230,y2:17370},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-service-line",name:"Center Service Line",type:"line",params:{x1:4115,y1:6400,x2:4115,y2:17370},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-mark-bottom",name:"Center Mark (Bottom)",type:"line",params:{x1:4115,y1:0,x2:4115,y2:100},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-mark-top",name:"Center Mark (Top)",type:"line",params:{x1:4115,y1:23670,x2:4115,y2:23770},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"mini-tennis-red":{id:"mini-tennis-red",name:"Mini Tennis (Red Court)",sport:"tennis",standard:"ITF Play+Stay",category:"court",description:"Beginner/youth court for red stage tennis coaching (36ft)",dimensions:{length_mm:10970,width_mm:5490,min_surround_mm:2e3},defaultSurfaceColor:"RH02",defaultLineColor:"RH29",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:5490,height:10970},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"net-line",name:"Net Line",type:"line",params:{x1:0,y1:5485,x2:5490,y2:5485},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"service-line-bottom",name:"Service Line (Bottom)",type:"line",params:{x1:0,y1:2745,x2:5490,y2:2745},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"service-line-top",name:"Service Line (Top)",type:"line",params:{x1:0,y1:8225,x2:5490,y2:8225},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-service-line",name:"Center Service Line",type:"line",params:{x1:2745,y1:2745,x2:2745,y2:8225},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"padel-standard":{id:"padel-standard",name:"Padel",sport:"padel",standard:"FIP",category:"court",description:"Official FIP padel court with service boxes",dimensions:{length_mm:2e4,width_mm:1e4,min_surround_mm:0},defaultSurfaceColor:"RH60",defaultLineColor:"RH29",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:1e4,height:2e4},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"net-line",name:"Net Line",type:"line",params:{x1:0,y1:1e4,x2:1e4,y2:1e4},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"service-line-bottom",name:"Service Line (Bottom)",type:"line",params:{x1:0,y1:3e3,x2:1e4,y2:3e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"service-line-top",name:"Service Line (Top)",type:"line",params:{x1:0,y1:17e3,x2:1e4,y2:17e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-service-line-bottom",name:"Center Service Line (Bottom)",type:"line",params:{x1:5e3,y1:0,x2:5e3,y2:3e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-service-line-top",name:"Center Service Line (Top)",type:"line",params:{x1:5e3,y1:17e3,x2:5e3,y2:2e4},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-line",name:"Center Line",type:"line",params:{x1:5e3,y1:3e3,x2:5e3,y2:17e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"handball-standard":{id:"handball-standard",name:"Handball",sport:"handball",standard:"IHF",category:"court",description:"Official IHF handball court with goal areas and penalty lines",dimensions:{length_mm:4e4,width_mm:2e4,min_surround_mm:1e3},defaultSurfaceColor:"RH10",defaultLineColor:"RH31",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:2e4,height:4e4},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"center-line",name:"Center Line",type:"line",params:{x1:0,y1:2e4,x2:2e4,y2:2e4},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"goal-area-bottom",name:"Goal Area (Bottom)",type:"arc",params:{cx:1e4,cy:0,radius:6e3,startAngle:0,endAngle:180},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"goal-area-top",name:"Goal Area (Top)",type:"arc",params:{cx:1e4,cy:4e4,radius:6e3,startAngle:180,endAngle:360},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"free-throw-line-bottom",name:"Free-Throw Line (Bottom)",type:"arc",params:{cx:1e4,cy:0,radius:9e3,startAngle:0,endAngle:180,dashed:!0,dashPattern:"300 150"},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"free-throw-line-top",name:"Free-Throw Line (Top)",type:"arc",params:{cx:1e4,cy:4e4,radius:9e3,startAngle:180,endAngle:360,dashed:!0,dashPattern:"300 150"},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"7m-line-bottom",name:"7m Penalty Line (Bottom)",type:"line",params:{x1:9e3,y1:7e3,x2:11e3,y2:7e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"7m-line-top",name:"7m Penalty Line (Top)",type:"line",params:{x1:9e3,y1:33e3,x2:11e3,y2:33e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"goalkeeper-line-bottom",name:"Goalkeeper Restriction Line (Bottom)",type:"line",params:{x1:9500,y1:4e3,x2:10500,y2:4e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"goalkeeper-line-top",name:"Goalkeeper Restriction Line (Top)",type:"line",params:{x1:9500,y1:36e3,x2:10500,y2:36e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"hockey-d":{id:"hockey-d",name:"Field Hockey D",sport:"hockey",standard:"FIH",category:"overlay",description:"Hockey shooting circle (D) for overlay on sports surfaces",dimensions:{length_mm:14630,width_mm:29260,min_surround_mm:0},defaultSurfaceColor:"RH23",defaultLineColor:"RH29",defaultLineWidth_mm:50,markings:[{id:"shooting-circle",name:"Shooting Circle (D)",type:"arc",params:{cx:14630,cy:0,radius:14630,startAngle:0,endAngle:180},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"goal-line",name:"Goal Line",type:"line",params:{x1:0,y1:0,x2:29260,y2:0},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"penalty-spot",name:"Penalty Spot",type:"circle",params:{cx:14630,cy:6400,radius:150},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"hockey-5s":{id:"hockey-5s",name:"Hockey 5s",sport:"hockey",standard:"England Hockey",category:"court",description:"Scaled-down hockey pitch for 5-a-side games",dimensions:{length_mm:55e3,width_mm:41100,min_surround_mm:2e3},defaultSurfaceColor:"RH23",defaultLineColor:"RH29",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:41100,height:55e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"center-line",name:"Center Line",type:"line",params:{x1:0,y1:27500,x2:41100,y2:27500},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-spot",name:"Center Spot",type:"circle",params:{cx:20550,cy:27500,radius:150},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"shooting-circle-bottom",name:"Shooting Circle (Bottom)",type:"arc",params:{cx:20550,cy:0,radius:9e3,startAngle:0,endAngle:180},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"shooting-circle-top",name:"Shooting Circle (Top)",type:"arc",params:{cx:20550,cy:55e3,radius:9e3,startAngle:180,endAngle:360},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"penalty-spot-bottom",name:"Penalty Spot (Bottom)",type:"circle",params:{cx:20550,cy:6400,radius:150},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"penalty-spot-top",name:"Penalty Spot (Top)",type:"circle",params:{cx:20550,cy:48600,radius:150},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]}},Sr=[{code:"RH01",name:"Standard Red",hex:"#A5362F",R:165,G:54,B:47,L:39.4,a:58.5,b:29},{code:"RH02",name:"Bright Red",hex:"#E21F2F",R:226,G:31,B:47,L:47.4,a:70.1,b:44},{code:"RH10",name:"Standard Green",hex:"#609B63",R:96,G:155,B:99,L:40.5,a:-42.2,b:17.9},{code:"RH11",name:"Bright Green",hex:"#3BB44A",R:59,G:180,B:74,L:62.1,a:-47.7,b:47.2},{code:"RH12",name:"Dark Green",hex:"#006C55",R:0,G:108,B:85,L:39.6,a:-38.3,b:13.1},{code:"RH20",name:"Standard Blue",hex:"#0075BC",R:0,G:117,B:188,L:36.4,a:14.2,b:-46.7},{code:"RH21",name:"Purple",hex:"#493D8C",R:73,G:61,B:140,L:31.5,a:41.9,b:-40.9},{code:"RH22",name:"Light Blue",hex:"#47AFE3",R:71,G:175,B:227,L:55.3,a:-19.1,b:-37.3},{code:"RH23",name:"Azure",hex:"#039DC4",R:3,G:157,B:196,L:47.7,a:-4.8,b:-34.8},{code:"RH26",name:"Turquoise",hex:"#00A6A3",R:0,G:166,B:163,L:58.8,a:-38.4,b:-3},{code:"RH30",name:"Standard Beige",hex:"#E4C4AA",R:228,G:196,B:170,L:75.2,a:3.8,b:24.8},{code:"RH31",name:"Cream",hex:"#E8E3D8",R:232,G:227,B:216,L:91.8,a:-.5,b:12.5},{code:"RH32",name:"Brown",hex:"#8B5F3C",R:139,G:95,B:60,L:40,a:15.9,b:27.1},{code:"RH90",name:"Funky Pink",hex:"#E8457E",R:232,G:69,B:126,L:55,a:66.1,b:4.9},{code:"RH40",name:"Mustard Yellow",hex:"#E5A144",R:229,G:161,B:68,L:66,a:8.4,b:56.3},{code:"RH41",name:"Bright Yellow",hex:"#FFD833",R:255,G:216,B:51,L:86.9,a:-1,b:90.6},{code:"RH50",name:"Orange",hex:"#F15B32",R:241,G:91,B:50,L:63.2,a:49.8,b:60.2},{code:"RH60",name:"Dark Grey",hex:"#59595B",R:89,G:89,B:91,L:34.1,a:-.4,b:-2.4},{code:"RH61",name:"Light Grey",hex:"#939598",R:147,G:149,B:152,L:69,a:-.5,b:-1},{code:"RH65",name:"Pale Grey",hex:"#D9D9D6",R:217,G:217,B:214,L:87.6,a:-.2,b:-.7},{code:"RH70",name:"Black",hex:"#231F20",R:35,G:31,B:32,L:9.1,a:-.3,b:-6.3}];function RC(){return Object.values($w)}function PC(t){return $w[t]||null}function OC(t,e,r){const{type:n,params:i}=t;switch(n){case"line":return MC(i,e,r);case"rectangle":return $C(i,e,r);case"circle":return LC(i,e,r);case"arc":return IC(i,e,r);case"polyline":return DC(i,e,r);default:return console.warn(`Unknown marking type: ${n}`),null}}function AC(t,e){const{type:r,params:n}=t;switch(r){case"rectangle":return{type:"rect",x:n.x,y:n.y,width:n.width,height:n.height,fill:e};case"circle":return{type:"circle",cx:n.cx,cy:n.cy,r:n.radius,fill:e};case"polygon":return{type:"polygon",points:n.points,fill:e};default:return console.warn(`Unknown zone type: ${r}`),null}}function MC(t,e,r){const n={type:"line",x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,stroke:e,strokeWidth:r};return t.dashed&&(n.strokeDasharray=t.dashPattern||"200 100"),n}function $C(t,e,r){return{type:"rect",x:t.x,y:t.y,width:t.width,height:t.height,stroke:e,strokeWidth:r,fill:"none"}}function LC(t,e,r){return{type:"circle",cx:t.cx,cy:t.cy,r:t.radius,stroke:e,strokeWidth:r,fill:"none"}}function IC(t,e,r){const{cx:n,cy:i,radius:s,startAngle:o,endAngle:l}=t,c=o*Math.PI/180,d=l*Math.PI/180,u=n+s*Math.cos(c),f=i+s*Math.sin(c),h=n+s*Math.cos(d),p=i+s*Math.sin(d),g=l-o>180?1:0,x={type:"path",d:`M ${u} ${f} A ${s} ${s} 0 ${g} 1 ${h} ${p}`,stroke:e,strokeWidth:r,fill:"none"};return t.dashed&&(x.strokeDasharray=t.dashPattern||"200 100"),x}function DC(t,e,r){return{type:"polyline",points:t.points.map(i=>`${i[0]},${i[1]}`).join(" "),stroke:e,strokeWidth:r,fill:"none"}}function d0(t){if(t&&t.startsWith("#"))return t;const e=Sr.find(r=>r.code===t);return e?e.hex:"#000000"}function zC(t){var o;const{template:e,lineColorOverrides:r,zoneColorOverrides:n}=t;if(!e)return console.error("No template provided for court"),{markings:[],zones:[]};const i=e.markings.map(l=>{var f;const c=((f=r[l.id])==null?void 0:f.hex)||e.defaultLineColor,d=d0(c),u=l.lineWidth_mm||e.defaultLineWidth_mm;return{id:l.id,name:l.name,...OC(l,d,u)}}).filter(Boolean),s=((o=e.zones)==null?void 0:o.map(l=>{var u;const c=((u=n[l.id])==null?void 0:u.hex)||l.defaultColor,d=d0(c);return{id:l.id,name:l.name,...AC(l,d)}}).filter(Boolean))||[];return{markings:i,zones:s}}function u0(t,e){return Math.round(t/e)*e}function FC(t,e){return{x:u0(t.x,e),y:u0(t.y,e)}}function Lw(t){let e=t%360;return e<0&&(e+=360),e}function ju(t,e,r){const{width_mm:n,length_mm:i}=e,{width_mm:s,length_mm:o}=r,l=500,c=-(n-l),d=s-l,u=-(i-l),f=o-l;return{x:Math.max(c,Math.min(t.x,d)),y:Math.max(u,Math.min(t.y,f))}}function BC(t){const{position:e,rotation:r,scale:n,template:i}=t,s=i.dimensions.width_mm/2,o=i.dimensions.length_mm/2;return`translate(${e.x}, ${e.y}) scale(${n}) rotate(${r}, ${s}, ${o})`}function HC({court:t,svgRef:e}){const{updateCourtRotation:r,updateCourtScale:n,updateCourtPosition:i,addToHistory:s}=st(),[o,l]=P.useState(!1),[c,d]=P.useState(!1),[u,f]=P.useState(null),[h,p]=P.useState(null),{template:g,position:m,rotation:x,scale:v}=t,y=g.dimensions.width_mm*v,b=g.dimensions.length_mm*v,w=m.x+g.dimensions.width_mm*v/2,k=m.y+g.dimensions.length_mm*v/2,_=g.dimensions.width_mm/2,C=-1e3,N=(S,K)=>{if(!e.current)return{x:0,y:0};const le=e.current.createSVGPoint();le.x=S,le.y=K;const D=le.matrixTransform(e.current.getScreenCTM().inverse());return{x:D.x,y:D.y}},T=S=>{S.stopPropagation(),l(!0),p({x:S.clientX,y:S.clientY})},O=(S,K)=>{S.stopPropagation(),d(!0),f(K),p({x:S.clientX,y:S.clientY,initialScale:v,initialWidth:y,initialHeight:b,initialPosition:{...m}})};P.useEffect(()=>{if(!o&&!c)return;const S=le=>{if(o){const D=N(le.clientX,le.clientY),I=D.x-w,L=D.y-k;let Z=Math.atan2(L,I)*(180/Math.PI)+90;Z=Lw(Z),le.shiftKey&&(Z=Math.round(Z/15)*15),r(t.id,Z)}else if(c&&h){const D=N(le.clientX,le.clientY),I=N(h.x,h.y),L=D.x-I.x,Z=D.y-I.y;let H=h.initialScale,G={...m};switch(u){case"se":H=Math.max(.3,h.initialScale+L/g.dimensions.width_mm);break;case"nw":H=Math.max(.3,h.initialScale-L/g.dimensions.width_mm),G.x=h.initialPosition.x+(h.initialWidth-g.dimensions.width_mm*H),G.y=h.initialPosition.y+(h.initialHeight-g.dimensions.length_mm*H);break;case"ne":H=Math.max(.3,h.initialScale+L/g.dimensions.width_mm),G.y=h.initialPosition.y+(h.initialHeight-g.dimensions.length_mm*H);break;case"sw":H=Math.max(.3,h.initialScale-L/g.dimensions.width_mm),G.x=h.initialPosition.x+(h.initialWidth-g.dimensions.width_mm*H);break;case"e":H=Math.max(.3,h.initialScale+L/g.dimensions.width_mm);break;case"w":H=Math.max(.3,h.initialScale-L/g.dimensions.width_mm),G.x=h.initialPosition.x+(h.initialWidth-g.dimensions.width_mm*H);break;case"n":H=Math.max(.3,h.initialScale-Z/g.dimensions.length_mm),G.y=h.initialPosition.y+(h.initialHeight-g.dimensions.length_mm*H);break;case"s":H=Math.max(.3,h.initialScale+Z/g.dimensions.length_mm);break}H=Math.min(3,Math.max(.3,H)),n(t.id,H),(G.x!==m.x||G.y!==m.y)&&i(t.id,G)}},K=()=>{(o||c)&&s(),l(!1),d(!1),f(null),p(null)};return window.addEventListener("mousemove",S),window.addEventListener("mouseup",K),()=>{window.removeEventListener("mousemove",S),window.removeEventListener("mouseup",K)}},[o,c,h,w,k,t.id,m,v,u]);const X=[{type:"nw",x:0,y:0,cursor:"nwse-resize"},{type:"n",x:g.dimensions.width_mm/2,y:0,cursor:"ns-resize"},{type:"ne",x:g.dimensions.width_mm,y:0,cursor:"nesw-resize"},{type:"e",x:g.dimensions.width_mm,y:g.dimensions.length_mm/2,cursor:"ew-resize"},{type:"se",x:g.dimensions.width_mm,y:g.dimensions.length_mm,cursor:"nwse-resize"},{type:"s",x:g.dimensions.width_mm/2,y:g.dimensions.length_mm,cursor:"ns-resize"},{type:"sw",x:0,y:g.dimensions.length_mm,cursor:"nesw-resize"},{type:"w",x:0,y:g.dimensions.length_mm/2,cursor:"ew-resize"}],E=300,F=250;return a.jsxs("g",{className:"transform-handles",children:[a.jsxs("g",{className:"rotation-handle",onMouseDown:T,style:{cursor:o?"grabbing":"grab"},children:[a.jsx("line",{x1:_,y1:0,x2:_,y2:C+F,stroke:"#007bff",strokeWidth:30,strokeDasharray:"100 50"}),a.jsx("circle",{cx:_,cy:C,r:F,fill:"white",stroke:"#007bff",strokeWidth:40}),a.jsx("path",{d:`M ${_-F*.4} ${C}
              A ${F*.5} ${F*.5} 0 1 1 ${_+F*.4} ${C}`,fill:"none",stroke:"#007bff",strokeWidth:30,strokeLinecap:"round"}),a.jsx("path",{d:`M ${_+F*.4} ${C}
              L ${_+F*.6} ${C-F*.2}
              M ${_+F*.4} ${C}
              L ${_+F*.6} ${C+F*.2}`,fill:"none",stroke:"#007bff",strokeWidth:30,strokeLinecap:"round"})]}),X.map(S=>a.jsx("rect",{className:`scale-handle scale-handle--${S.type}`,x:S.x-E/2,y:S.y-E/2,width:E,height:E,fill:"white",stroke:"#007bff",strokeWidth:40,rx:30,ry:30,style:{cursor:c&&u===S.type?"grabbing":S.cursor,pointerEvents:"all"},onMouseDown:K=>O(K,S.type)},S.type)),o&&a.jsxs("text",{x:g.dimensions.width_mm/2,y:-1e3-F-200,textAnchor:"middle",fontSize:400,fill:"#007bff",fontWeight:"bold",style:{pointerEvents:"none"},children:[Math.round(x),""]}),c&&a.jsxs("text",{x:g.dimensions.width_mm/2,y:g.dimensions.length_mm+600,textAnchor:"middle",fontSize:400,fill:"#007bff",fontWeight:"bold",style:{pointerEvents:"none"},children:[(v*100).toFixed(0),"%"]})]})}function Iw(t){const{width_mm:e,height_mm:r,numLanes:n,laneWidth_mm:i,cornerRadius:s={topLeft:3e3,topRight:3e3,bottomLeft:3e3,bottomRight:3e3},lineWidth_mm:o=50}=t,l=[];if(s.topLeft===0&&s.topRight===0&&s.bottomLeft===0&&s.bottomRight===0){const d=n*i;for(let u=0;u<n;u++){const f=u*i;l.push({laneNumber:u+1,innerPath:null,outerPath:UC(i,r,u),perimeter:2*r/1e3,isParallel:!0,laneX:f,laneWidth:i})}return{lanes:l,totalWidth:d,totalLength:r,usableWidth:d,usableHeight:r,isStraightTrack:!0}}else for(let d=0;d<n;d++){const u=d*i,f=(d+1)*i,h=Math.max(0,e-f*2),p=Math.max(0,r-f*2),g=Math.max(0,e-u*2),m=Math.max(0,r-u*2),x={topLeft:Math.max(0,s.topLeft-f),topRight:Math.max(0,s.topRight-f),bottomLeft:Math.max(0,s.bottomLeft-f),bottomRight:Math.max(0,s.bottomRight-f)},v={topLeft:Math.max(0,s.topLeft-u),topRight:Math.max(0,s.topRight-u),bottomLeft:Math.max(0,s.bottomLeft-u),bottomRight:Math.max(0,s.bottomRight-u)};l.push({laneNumber:d+1,innerPath:h0(h,p,x,f),outerPath:h0(g,m,v,u),perimeter:WC(g,m,v),isParallel:!1})}return{lanes:l,totalWidth:e,totalLength:r,usableWidth:e-n*i*2,usableHeight:r-n*i*2}}function h0(t,e,r,n=0){if(t<=0||e<=0)return`M ${n} ${n} L ${n} ${n}`;const i=Math.min(t/2,e/2),s=Math.min(r.topLeft,i),o=Math.min(r.topRight,i),l=Math.min(r.bottomRight,i),c=Math.min(r.bottomLeft,i),d=n,u=n+t,f=n,h=n+e;return`
    M ${d+s} ${f}
    L ${u-o} ${f}
    ${o>0?`A ${o} ${o} 0 0 1 ${u} ${f+o}`:""}
    L ${u} ${h-l}
    ${l>0?`A ${l} ${l} 0 0 1 ${u-l} ${h}`:""}
    L ${d+c} ${h}
    ${c>0?`A ${c} ${c} 0 0 1 ${d} ${h-c}`:""}
    L ${d} ${f+s}
    ${s>0?`A ${s} ${s} 0 0 1 ${d+s} ${f}`:""}
    Z
  `.trim().replace(/\s+/g," ")}function UC(t,e,r){const n=r*t;return`M ${n} 0 L ${n+t} 0 L ${n+t} ${e} L ${n} ${e} Z`}function WC(t,e,r){if(t<=0||e<=0)return 0;const n=Math.min(t/2,e/2),i=Math.min(r.topLeft,n),s=Math.min(r.topRight,n),o=Math.min(r.bottomRight,n),l=Math.min(r.bottomLeft,n),c=t-i-s,d=e-s-o,u=t-o-l,f=e-l-i,h=Math.PI*i/2,p=Math.PI*s/2,g=Math.PI*o/2,m=Math.PI*l/2;return(c+d+u+f+h+p+g+m)/1e3}function Dw(t){if(!t||!t.lanes||t.lanes.length===0)return[];const e=t.lanes.length-1,r=t.lanes[e].perimeter;return t.lanes.map((n,i)=>n.perimeter-r)}function f0(t,e,r){const{width_mm:n,height_mm:i,laneWidth_mm:s,cornerRadius:o={topLeft:3e3,topRight:3e3,bottomLeft:3e3,bottomRight:3e3}}=r,l=t*s,c=Math.max(0,n-l*2),d=Math.max(0,i-l*2),u=Math.min(c/2,d/2),f=Math.min(Math.max(0,o.topLeft-l),u),h=Math.min(Math.max(0,o.topRight-l),u),p=Math.min(Math.max(0,o.bottomRight-l),u),g=Math.min(Math.max(0,o.bottomLeft-l),u),m=l,x=l+c,v=l,y=l+d,b=[{type:"arc",length:Math.PI*g/2,radius:g,corner:"bottomLeft"},{type:"straight",length:d-g-f,dir:"up"},{type:"arc",length:Math.PI*f/2,radius:f,corner:"topLeft"},{type:"straight",length:c-f-h,dir:"right"},{type:"arc",length:Math.PI*h/2,radius:h,corner:"topRight"},{type:"straight",length:d-h-p,dir:"down"},{type:"arc",length:Math.PI*p/2,radius:p,corner:"bottomRight"},{type:"straight",length:c-p-g,dir:"left"}];let w=e;const k=b.reduce((C,N)=>C+N.length,0);for(;w<0;)w+=k;for(;w>=k;)w-=k;let _=0;for(const C of b){if(w<=_+C.length){const N=w-_,T=C.length>0?N/C.length:0;return C.type==="arc"?GC(C,T,{left:m,right:x,top:v,bottom:y,tl:f,tr:h,br:p,bl:g}):VC(C,T,{left:m,right:x,top:v,bottom:y,tl:f,tr:h,br:p,bl:g})}_+=C.length}return{x:m,y:y-g,angle:-Math.PI/2}}function GC(t,e,r){const{left:n,right:i,top:s,bottom:o,tl:l,tr:c,br:d,bl:u}=r,f=e*(Math.PI/2);switch(t.corner){case"bottomLeft":{const h=n+u,p=o-u,m=Math.PI/2+f;return{x:h+u*Math.cos(m),y:p+u*Math.sin(m),angle:m+Math.PI/2}}case"topLeft":{const h=n+l,p=s+l,m=Math.PI+f;return{x:h+l*Math.cos(m),y:p+l*Math.sin(m),angle:m+Math.PI/2}}case"topRight":{const h=i-c,p=s+c,m=-Math.PI/2+f;return{x:h+c*Math.cos(m),y:p+c*Math.sin(m),angle:m+Math.PI/2}}case"bottomRight":{const h=i-d,p=o-d,m=0+f;return{x:h+d*Math.cos(m),y:p+d*Math.sin(m),angle:m+Math.PI/2}}default:return{x:n,y:s,angle:0}}}function VC(t,e,r){const{left:n,right:i,top:s,bottom:o,tl:l,tr:c,br:d,bl:u}=r;switch(t.dir){case"up":{const f=o-u,h=s+l;return{x:n,y:f+e*(h-f),angle:-Math.PI/2}}case"right":{const f=n+l,h=i-c;return{x:f+e*(h-f),y:s,angle:0}}case"down":{const f=s+c,h=o-d;return{x:i,y:f+e*(h-f),angle:Math.PI/2}}case"left":{const f=i-d,h=n+u;return{x:f+e*(h-f),y:o,angle:Math.PI}}default:return{x:n,y:s,angle:0}}}function Cu(t,e,r){const n=f0(t,e,r),i=f0(t+1,e,r);return{x:(n.x+i.x)/2,y:(n.y+i.y)/2,angle:n.angle,innerX:i.x,innerY:i.y,outerX:n.x,outerY:n.y}}function p0(t,e,r){const{width_mm:n,height_mm:i,laneWidth_mm:s,cornerRadius:o={topLeft:3e3,topRight:3e3,bottomLeft:3e3,bottomRight:3e3}}=r,l=t*s,c=Math.max(0,n-l*2),d=Math.max(0,i-l*2),u=Math.min(c/2,d/2),f=Math.min(Math.max(0,o.topLeft-l),u),h=Math.min(Math.max(0,o.topRight-l),u),p=Math.min(Math.max(0,o.bottomRight-l),u),g=Math.min(Math.max(0,o.bottomLeft-l),u),m=[{type:"arc",length:Math.PI*g/2,corner:"bottomLeft"},{type:"straight",length:d-g-f,dir:"up"},{type:"arc",length:Math.PI*f/2,corner:"topLeft"},{type:"straight",length:c-f-h,dir:"right"},{type:"arc",length:Math.PI*h/2,corner:"topRight"},{type:"straight",length:d-h-p,dir:"down"},{type:"arc",length:Math.PI*p/2,corner:"bottomRight"},{type:"straight",length:c-p-g,dir:"left"}],x=m.reduce((b,w)=>b+w.length,0);let v=e;for(;v<0;)v+=x;for(;v>=x;)v-=x;let y=0;for(let b=0;b<m.length;b++){if(v<=y+m[b].length){const w=v-y,k=m[b].length>0?w/m[b].length:0;return{segmentIndex:b,t:k,segments:m,totalPerimeter:x}}y+=m[b].length}return{segmentIndex:0,t:0,segments:m,totalPerimeter:x}}function m0(t,e,r,n){const i=p0(r,e,n),s=p0(t,0,n);let o=0;for(let d=0;d<i.segmentIndex;d++)o+=s.segments[d].length;const l=s.segments[i.segmentIndex].length;return o+i.t*l}function qC({track:t,svgRef:e}){const{updateTrackParameters:r,updateTrackPosition:n,updateTrackRotation:i,addToHistory:s}=st(),[o,l]=P.useState(!1),[c,d]=P.useState(!1),[u,f]=P.useState(null),[h,p]=P.useState(null),{parameters:g,position:m,rotation:x}=t,v=g.width_mm,y=g.height_mm,b=m.x+v/2,w=m.y+y/2,k=v/2,_=-1e3,C=(E,F)=>{if(!e.current)return{x:0,y:0};const S=e.current.createSVGPoint();S.x=E,S.y=F;const K=S.matrixTransform(e.current.getScreenCTM().inverse());return{x:K.x,y:K.y}},N=E=>{E.stopPropagation();const F=E.touches?E.touches[0].clientX:E.clientX,S=E.touches?E.touches[0].clientY:E.clientY;d(!0),p({x:F,y:S})},T=(E,F)=>{E.stopPropagation(),l(!0),f(F);const S=E.touches?E.touches[0].clientX:E.clientX,K=E.touches?E.touches[0].clientY:E.clientY,le=C(S,K);p({screenX:S,screenY:K,svgX:le.x,svgY:le.y,initialWidth:v,initialHeight:y,initialPosition:{...m},initialCornerRadius:{...g.cornerRadius}})};P.useEffect(()=>{if(!o&&!c)return;const E=S=>{const K=S.touches?S.touches[0].clientX:S.clientX,le=S.touches?S.touches[0].clientY:S.clientY;if(c){const Oe=C(K,le),$e=Oe.x-b,Ie=Oe.y-w;let Ee=Math.atan2(Ie,$e)*(180/Math.PI)+90;Ee=Lw(Ee),S.shiftKey&&(Ee=Math.round(Ee/15)*15),i(t.id,Ee);return}if(!h)return;const D=C(K,le),I=D.x-h.svgX,L=D.y-h.svgY;let Z=h.initialWidth,H=h.initialHeight,G={...m},ee={...h.initialCornerRadius};const oe=3e3;switch(u){case"se":Z=Math.max(oe,h.initialWidth+I),H=Math.max(oe,h.initialHeight+L);const Oe=Math.min(Z/h.initialWidth,H/h.initialHeight);ee={topLeft:h.initialCornerRadius.topLeft*Oe,topRight:h.initialCornerRadius.topRight*Oe,bottomLeft:h.initialCornerRadius.bottomLeft*Oe,bottomRight:h.initialCornerRadius.bottomRight*Oe};break;case"nw":Z=Math.max(oe,h.initialWidth-I),H=Math.max(oe,h.initialHeight-L),G.x=h.initialPosition.x+(h.initialWidth-Z),G.y=h.initialPosition.y+(h.initialHeight-H);const $e=Math.min(Z/h.initialWidth,H/h.initialHeight);ee={topLeft:h.initialCornerRadius.topLeft*$e,topRight:h.initialCornerRadius.topRight*$e,bottomLeft:h.initialCornerRadius.bottomLeft*$e,bottomRight:h.initialCornerRadius.bottomRight*$e};break;case"ne":Z=Math.max(oe,h.initialWidth+I),H=Math.max(oe,h.initialHeight-L),G.y=h.initialPosition.y+(h.initialHeight-H);const Ie=Math.min(Z/h.initialWidth,H/h.initialHeight);ee={topLeft:h.initialCornerRadius.topLeft*Ie,topRight:h.initialCornerRadius.topRight*Ie,bottomLeft:h.initialCornerRadius.bottomLeft*Ie,bottomRight:h.initialCornerRadius.bottomRight*Ie};break;case"sw":Z=Math.max(oe,h.initialWidth-I),H=Math.max(oe,h.initialHeight+L),G.x=h.initialPosition.x+(h.initialWidth-Z);const Ee=Math.min(Z/h.initialWidth,H/h.initialHeight);ee={topLeft:h.initialCornerRadius.topLeft*Ee,topRight:h.initialCornerRadius.topRight*Ee,bottomLeft:h.initialCornerRadius.bottomLeft*Ee,bottomRight:h.initialCornerRadius.bottomRight*Ee};break;case"e":Z=Math.max(oe,h.initialWidth+I);const ge=Z/h.initialWidth;ee={topLeft:h.initialCornerRadius.topLeft*ge,topRight:h.initialCornerRadius.topRight*ge,bottomLeft:h.initialCornerRadius.bottomLeft*ge,bottomRight:h.initialCornerRadius.bottomRight*ge};break;case"w":Z=Math.max(oe,h.initialWidth-I),G.x=h.initialPosition.x+(h.initialWidth-Z);const me=Z/h.initialWidth;ee={topLeft:h.initialCornerRadius.topLeft*me,topRight:h.initialCornerRadius.topRight*me,bottomLeft:h.initialCornerRadius.bottomLeft*me,bottomRight:h.initialCornerRadius.bottomRight*me};break;case"n":H=Math.max(oe,h.initialHeight-L),G.y=h.initialPosition.y+(h.initialHeight-H);const He=H/h.initialHeight;ee={topLeft:h.initialCornerRadius.topLeft*He,topRight:h.initialCornerRadius.topRight*He,bottomLeft:h.initialCornerRadius.bottomLeft*He,bottomRight:h.initialCornerRadius.bottomRight*He};break;case"s":H=Math.max(oe,h.initialHeight+L);const ue=H/h.initialHeight;ee={topLeft:h.initialCornerRadius.topLeft*ue,topRight:h.initialCornerRadius.topRight*ue,bottomLeft:h.initialCornerRadius.bottomLeft*ue,bottomRight:h.initialCornerRadius.bottomRight*ue};break}const fe=Math.min(Z,H)/2;ee={topLeft:Math.min(ee.topLeft,fe),topRight:Math.min(ee.topRight,fe),bottomLeft:Math.min(ee.bottomLeft,fe),bottomRight:Math.min(ee.bottomRight,fe)},r(t.id,{width_mm:Z,height_mm:H,cornerRadius:ee}),(G.x!==m.x||G.y!==m.y)&&n(t.id,G)},F=()=>{(o||c)&&s(),l(!1),d(!1),f(null),p(null)};return window.addEventListener("mousemove",E),window.addEventListener("mouseup",F),window.addEventListener("touchmove",E,{passive:!1}),window.addEventListener("touchend",F),window.addEventListener("touchcancel",F),()=>{window.removeEventListener("mousemove",E),window.removeEventListener("mouseup",F),window.removeEventListener("touchmove",E),window.removeEventListener("touchend",F),window.removeEventListener("touchcancel",F)}},[o,h,u,t.id,m,g,r,n,s]);const O=[{type:"nw",x:0,y:0,cursor:"nwse-resize"},{type:"n",x:v/2,y:0,cursor:"ns-resize"},{type:"ne",x:v,y:0,cursor:"nesw-resize"},{type:"e",x:v,y:y/2,cursor:"ew-resize"},{type:"se",x:v,y,cursor:"nwse-resize"},{type:"s",x:v/2,y,cursor:"ns-resize"},{type:"sw",x:0,y,cursor:"nesw-resize"},{type:"w",x:0,y:y/2,cursor:"ew-resize"}],X=400;return a.jsxs("g",{className:"track-resize-handles",children:[a.jsxs("g",{className:"rotation-handle-group",children:[a.jsx("line",{x1:k,y1:0,x2:k,y2:_,stroke:"#0066CC",strokeWidth:30,strokeDasharray:"100 100",opacity:.5,style:{pointerEvents:"none"}}),a.jsx("circle",{className:"rotation-handle",cx:k,cy:_,r:X/2,fill:"white",stroke:"#0066CC",strokeWidth:50,style:{cursor:c?"grabbing":"grab",pointerEvents:"all"},onMouseDown:N,onTouchStart:N}),a.jsx("path",{d:`M ${k-100} ${_-50}
              A 100 100 0 1 1 ${k+100} ${_-50}`,fill:"none",stroke:"#0066CC",strokeWidth:40,strokeLinecap:"round",style:{pointerEvents:"none"}}),a.jsx("path",{d:`M ${k+100} ${_-50}
              L ${k+80} ${_-120}
              L ${k+150} ${_-80}
              Z`,fill:"#0066CC",style:{pointerEvents:"none"}})]}),O.map(E=>a.jsx("rect",{className:`resize-handle resize-handle--${E.type}`,x:E.x-X/2,y:E.y-X/2,width:X,height:X,fill:"white",stroke:"#0066CC",strokeWidth:50,rx:40,ry:40,style:{cursor:o&&u===E.type?"grabbing":E.cursor,pointerEvents:"all"},onMouseDown:F=>T(F,E.type),onTouchStart:F=>T(F,E.type)},E.type)),o&&a.jsxs("text",{x:v/2,y:y+800,textAnchor:"middle",fontSize:400,fill:"#0066CC",fontWeight:"bold",style:{pointerEvents:"none"},children:[(v/1e3).toFixed(1),"m  ",(y/1e3).toFixed(1),"m"]}),c&&a.jsxs("text",{x:v/2,y:-1500,textAnchor:"middle",fontSize:400,fill:"#0066CC",fontWeight:"bold",style:{pointerEvents:"none"},children:[x.toFixed(0),""]})]})}function YC({geometry:t,parameters:e,boxConfig:r,surfaceColor:n,isStraightTrack:i}){if(!r||!r.enabled)return null;const{depth_mm:s=400,lineWidth_mm:o=50,perLaneOffsets:l=[],style:c="staggered",direction:d="counterclockwise",startPosition:u=0}=r,f=n||"#A5362F",h="#FFFFFF",p=c==="staggered"||c==="both",g=c==="straight"||c==="both";return a.jsx("g",{className:"starting-boxes",children:t.lanes.map((m,x)=>{const v=x+1;return i?XC(x,v,e,t,s,o,f,h,p,g,l,d):KC(x,v,e,t,s,o,f,h,p,g,l,d,u)})})}function XC(t,e,r,n,i,s,o,l,c,d,u,f){const h=t*r.laneWidth_mm,p=r.laneWidth_mm,g=f==="clockwise",m=g?n.totalLength-i:0,x=g?0:n.totalLength-i,v=(u[t]||0)*1e3,y=[];if(c&&!d){const b=g?m-v:m+v;y.push(a.jsx(ql,{x:h,y:b,width:p,height:i,laneNumber:e,boxFillColor:o,lineColor:l,lineWidth:s,flipLine:g},`stagger-${e}`))}else if(d&&!c)y.push(a.jsx(ql,{x:h,y:m,width:p,height:i,laneNumber:e,boxFillColor:o,lineColor:l,lineWidth:s,flipLine:g},`straight-${e}`));else if(c&&d){const b=g?m-v:m+v;y.push(a.jsx(ql,{x:h,y:b,width:p,height:i,laneNumber:e,boxFillColor:o,lineColor:l,lineWidth:s,flipLine:g},`stagger-${e}`)),y.push(a.jsx(ql,{x:h,y:x,width:p,height:i,laneNumber:e,boxFillColor:o,lineColor:l,lineWidth:s,flipLine:!g},`straight-${e}`))}return a.jsx("g",{children:y},`lane-boxes-${e}`)}function ql({x:t,y:e,width:r,height:n,laneNumber:i,boxFillColor:s,lineColor:o,lineWidth:l,flipLine:c}){const d=c?e+n:e;return a.jsxs("g",{children:[a.jsx("rect",{x:t,y:e,width:r,height:n,fill:s,stroke:"none",pointerEvents:"none"}),a.jsx("line",{x1:t,y1:d,x2:t+r,y2:d,stroke:o,strokeWidth:l,strokeLinecap:"butt",pointerEvents:"none"}),a.jsx("text",{x:t+r/2,y:e+n/2,fontSize:Math.min(r*.4,r*.5),fill:o,textAnchor:"middle",dominantBaseline:"middle",fontWeight:"bold",pointerEvents:"none",opacity:"0.8",children:i})]})}function KC(t,e,r,n,i,s,o,l,c,d,u,f,h=0){var C,N;const p=f==="clockwise",g=n.lanes.length-1,m=(((C=n.lanes[g])==null?void 0:C.perimeter)||0)*1e3,x=m/2,v=h/100*m,y=m0(t,v,g,r),w=(((N=n.lanes[t])==null?void 0:N.perimeter)||0)*1e3/2,k=(u[t]||0)*1e3,_=[];if(c&&!d){const T=p?y+w+k:y+k;_.push(a.jsx(Yl,{index:t,laneNumber:e,distance:T,depth_mm:i,parameters:r,boxFillColor:o,lineColor:l,lineWidth:s},`stagger-${e}`))}else if(d&&!c){const T=p?y+w:y;_.push(a.jsx(Yl,{index:t,laneNumber:e,distance:T,depth_mm:i,parameters:r,boxFillColor:o,lineColor:l,lineWidth:s},`straight-${e}`))}else if(c&&d){const T=p?y+w+k:y+k,O=p?v:v+x,X=m0(t,O,g,r),E=X;_.push(a.jsx(Yl,{index:t,laneNumber:e,distance:T,depth_mm:i,parameters:r,boxFillColor:o,lineColor:l,lineWidth:s},`stagger-${e}`)),_.push(a.jsx(Yl,{index:t,laneNumber:e,distance:E,depth_mm:i,parameters:r,boxFillColor:o,lineColor:l,lineWidth:s},`straight-${e}`))}return a.jsx("g",{children:_},`lane-boxes-${e}`)}function Yl({index:t,laneNumber:e,distance:r,depth_mm:n,parameters:i,boxFillColor:s,lineColor:o,lineWidth:l}){const c=Cu(t,r,i),d=c.angle+Math.PI/2,u=i.laneWidth_mm/2,f=c.x+Math.cos(d)*u,h=c.y+Math.sin(d)*u,p=c.x-Math.cos(d)*u,g=c.y-Math.sin(d)*u,m=Cu(t,r+n,i),x=m.angle+Math.PI/2,v=m.x+Math.cos(x)*u,y=m.y+Math.sin(x)*u,b=m.x-Math.cos(x)*u,w=m.y-Math.sin(x)*u,k=Cu(t,r+n/2,i),_=`
    M ${f} ${h}
    L ${p} ${g}
    L ${b} ${w}
    L ${v} ${y}
    Z
  `.trim().replace(/\s+/g," ");return a.jsxs("g",{children:[a.jsx("path",{d:_,fill:s,stroke:"none",pointerEvents:"none"}),a.jsx("line",{x1:f,y1:h,x2:p,y2:g,stroke:o,strokeWidth:l,strokeLinecap:"butt",pointerEvents:"none"}),a.jsx("text",{x:k.x,y:k.y,fontSize:i.laneWidth_mm*.5,fill:o,textAnchor:"middle",dominantBaseline:"middle",fontWeight:"bold",pointerEvents:"none",opacity:"0.8",transform:`rotate(${k.angle*180/Math.PI+90}, ${k.x}, ${k.y})`,children:e})]})}function ZC({track:t,isSelected:e,onMouseDown:r,onTouchStart:n,onDoubleClick:i,svgRef:s}){var w,k,_;const{parameters:o,position:l,rotation:c,trackSurfaceColor:d}=t,u=Iw(o),f=u.lanes.length>0&&u.lanes[0].isParallel===!0,h=u.totalWidth,p=u.totalLength,g=h/2,m=p/2,x=`translate(${l.x}, ${l.y}) rotate(${c}, ${g}, ${m})`,v=(d==null?void 0:d.hex)||"#A5362F",y="#FFFFFF",b=o.lineWidth_mm||50;return console.log("TrackRenderer - trackSurfaceColor:",d),console.log("TrackRenderer - surfaceColor:",v),console.log("TrackRenderer - geometry.lanes.length:",u.lanes.length),a.jsxs("g",{className:`track-element ${e?"track-element--selected":""}`,transform:x,style:{cursor:"move"},children:[a.jsx("rect",{x:"0",y:"0",width:h,height:p,fill:"none",pointerEvents:"all",onMouseDown:r,onTouchStart:n,onDoubleClick:i,style:{cursor:"move"}}),f?u.lanes.map(C=>a.jsx("path",{d:C.outerPath,fill:v,stroke:"none",pointerEvents:"none"},`lane-fill-${C.laneNumber}`)):a.jsx("path",{d:`${u.lanes[0].outerPath} ${u.lanes[u.lanes.length-1].innerPath}`,fill:v,fillRule:"evenodd",stroke:"none",pointerEvents:"none"}),u.lanes.map((C,N)=>a.jsx(JC,{lane:C,lineColor:y,lineWidth:b,isLastLane:N===u.lanes.length-1,isStraightTrack:f,geometry:u},`stroke-${C.laneNumber}`)),((w=o.startingBoxes)==null?void 0:w.enabled)&&a.jsx(YC,{geometry:u,parameters:o,boxConfig:{...o.startingBoxes,perLaneOffsets:((k=t.template)==null?void 0:k.trackType)==="curved"?Dw(u):[]},surfaceColor:v,isStraightTrack:((_=t.template)==null?void 0:_.trackType)==="straight"}),e&&a.jsxs(a.Fragment,{children:[a.jsx("rect",{x:"-10",y:"-10",width:h+20,height:p+20,fill:"none",stroke:"#0066CC",strokeWidth:"80",strokeDasharray:"400 400",opacity:"0.5",pointerEvents:"none"}),a.jsx(qC,{track:t,svgRef:s})]})]})}function JC({lane:t,lineColor:e,lineWidth:r,isLastLane:n,isStraightTrack:i,geometry:s}){const{innerPath:o,outerPath:l}=t,c=50;return i?a.jsxs("g",{className:"track-lane-stroke",children:[t.laneNumber===1&&a.jsx("line",{x1:t.laneX,y1:0,x2:t.laneX,y2:s.totalLength,stroke:e,strokeWidth:c,pointerEvents:"none"}),a.jsx("line",{x1:t.laneX+t.laneWidth,y1:0,x2:t.laneX+t.laneWidth,y2:s.totalLength,stroke:e,strokeWidth:c,pointerEvents:"none"})]}):a.jsxs("g",{className:"track-lane-stroke",children:[a.jsx("path",{d:l,fill:"none",stroke:e,strokeWidth:c,pointerEvents:"none"}),n&&a.jsx("path",{d:o,fill:"none",stroke:e,strokeWidth:c,pointerEvents:"none"})]})}function QC({motif:t,isSelected:e,onMouseDown:r,onTouchStart:n,onDoubleClick:i,onScaleStart:s,onRotateStart:o}){const{svgContent:l,originalWidth_mm:c,originalHeight_mm:d,position:u,rotation:f,scale:h}=t,p=P.useMemo(()=>{if(!l)return null;const _=l.match(/viewBox=["']([^"']+)["']/i);if(_){const T=_[1].split(/\s+/).map(Number);if(T.length>=4)return{width:T[2],height:T[3]}}const C=l.match(/\bwidth=["']?(\d+(?:\.\d+)?)/i),N=l.match(/\bheight=["']?(\d+(?:\.\d+)?)/i);return C&&N?{width:parseFloat(C[1]),height:parseFloat(N[1])}:null},[l]),g=P.useMemo(()=>{if(!p)return{width:c,height:d};const _=p.width/p.height,C=c/d,N=_>=1,T=C>=1;if(N!==T){console.warn("[MOTIF] Orientation mismatch detected - using SVG viewBox aspect ratio"),console.log("[MOTIF] SVG viewBox:",p,"AR:",_.toFixed(2)),console.log("[MOTIF] Physical dims:",c,"",d,"AR:",C.toFixed(2));const O=c*d,X=Math.sqrt(O*_),E=X/_;return{width:X,height:E}}return{width:c,height:d}},[p,c,d]),m=g.width*(h||1),x=g.height*(h||1),v=m/2,y=x/2,b=`translate(${u.x}, ${u.y}) rotate(${f||0}, ${v}, ${y})`,w=P.useMemo(()=>{if(!l)return null;try{let _=l;return _=_.replace(/\s+(width|height)=["'][^"']*["']/gi,""),_.includes("viewBox")||(_=_.replace("<svg",`<svg viewBox="0 0 ${g.width} ${g.height}"`)),_}catch(_){return console.error("[MOTIF] Error processing SVG:",_),l}},[l,g]),k=P.useMemo(()=>{if(!w)return null;try{return`data:image/svg+xml,${encodeURIComponent(w).replace(/'/g,"%27").replace(/"/g,"%22")}`}catch(_){return console.error("[MOTIF] Error creating data URL:",_),null}},[w]);return k?a.jsxs("g",{className:`motif-element ${e?"motif-element--selected":""}`,transform:b,style:{cursor:"move"},children:[a.jsx("image",{href:k,x:"0",y:"0",width:m,height:x,preserveAspectRatio:"xMidYMid meet",pointerEvents:"none"}),a.jsx("rect",{x:"0",y:"0",width:m,height:x,fill:"transparent",pointerEvents:"all",onMouseDown:r,onTouchStart:n,onDoubleClick:i,style:{cursor:"move"}}),e&&a.jsx("rect",{x:"-10",y:"-10",width:m+20,height:x+20,fill:"none",stroke:"#9333EA",strokeWidth:"80",strokeDasharray:"400 400",opacity:"0.7",pointerEvents:"none"}),e&&a.jsx(e5,{width:m,height:x,onScaleStart:s,onRotateStart:o})]}):a.jsxs("g",{transform:b,children:[a.jsx("rect",{x:"0",y:"0",width:m,height:x,fill:"#f0f0f0",stroke:"#ccc",strokeWidth:"50",strokeDasharray:"200 200"}),a.jsx("text",{x:m/2,y:x/2,textAnchor:"middle",dominantBaseline:"middle",fontSize:Math.min(m,x)/10,fill:"#999",children:"Motif Error"})]})}function e5({width:t,height:e,onScaleStart:r,onRotateStart:n}){const i=Math.min(t,e)*.08,l=Math.max(150,Math.min(400,i)),c=[{x:-l/2,y:-l/2,corner:"nw",cursor:"nwse-resize"},{x:t-l/2,y:-l/2,corner:"ne",cursor:"nesw-resize"},{x:-l/2,y:e-l/2,corner:"sw",cursor:"nesw-resize"},{x:t-l/2,y:e-l/2,corner:"se",cursor:"nwse-resize"}],d=l*2.5,u=l*.8;return a.jsxs("g",{className:"motif-handles",children:[c.map(f=>a.jsx("rect",{x:f.x,y:f.y,width:l,height:l,fill:"#9333EA",stroke:"#fff",strokeWidth:"20",rx:l/4,style:{cursor:f.cursor},pointerEvents:"all",onMouseDown:h=>{h.stopPropagation(),r==null||r(h,f.corner)},onTouchStart:h=>{h.stopPropagation(),r==null||r(h,f.corner)}},f.corner)),a.jsx("line",{x1:t/2,y1:0,x2:t/2,y2:-d+u/2,stroke:"#9333EA",strokeWidth:"30",pointerEvents:"none"}),a.jsx("circle",{cx:t/2,cy:-d,r:u,fill:"#9333EA",stroke:"#fff",strokeWidth:"20",style:{cursor:"grab"},pointerEvents:"all",onMouseDown:f=>{f.stopPropagation(),n==null||n(f)},onTouchStart:f=>{f.stopPropagation(),n==null||n(f)}}),a.jsx("path",{d:`M ${t/2-u*.4} ${-d}
            A ${u*.4} ${u*.4} 0 1 1
            ${t/2+u*.4} ${-d}`,fill:"none",stroke:"#fff",strokeWidth:"25",strokeLinecap:"round",pointerEvents:"none"}),a.jsx("polygon",{points:`${t/2+u*.4},${-d-u*.25}
                 ${t/2+u*.4},${-d+u*.25}
                 ${t/2+u*.65},${-d}`,fill:"#fff",pointerEvents:"none"})]})}function t5(t,e,r,n=0){if(t>=32)return n5(e,r);const i=r5(t,e,r);return n>0?i5(i,n):`M ${i.map(s=>`${s.x},${s.y}`).join(" L ")} Z`}function r5(t,e,r){if(t===4)return[{x:0,y:0},{x:e,y:0},{x:e,y:r},{x:0,y:r}];const n=[],i=2*Math.PI/t,s=-Math.PI/2;for(let g=0;g<t;g++){const m=s+i*g;n.push({x:Math.cos(m),y:Math.sin(m)})}let o=1/0,l=-1/0,c=1/0,d=-1/0;for(const g of n)o=Math.min(o,g.x),l=Math.max(l,g.x),c=Math.min(c,g.y),d=Math.max(d,g.y);const u=l-o,f=d-c,h=e/u,p=r/f;return n.map(g=>({x:(g.x-o)*h,y:(g.y-c)*p}))}function n5(t,e){const r=t/2,n=e/2,i=r,s=n;return`M ${i-r},${s} A ${r},${n} 0 1,1 ${i+r},${s} A ${r},${n} 0 1,1 ${i-r},${s} Z`}function i5(t,e,r,n){if(t.length<3)return"";let i=1/0;for(let h=0;h<t.length;h++){const p=t[h],g=t[(h+1)%t.length],m=Math.sqrt(Math.pow(g.x-p.x,2)+Math.pow(g.y-p.y,2));i=Math.min(i,m)}const s=i/2,o=e/100*s;if(o<1)return`M ${t.map(h=>`${h.x},${h.y}`).join(" L ")} Z`;const l=[];for(let h=0;h<t.length;h++){const p=t[(h-1+t.length)%t.length],g=t[h],m=t[(h+1)%t.length],x=Eu({x:p.x-g.x,y:p.y-g.y}),v=Eu({x:m.x-g.x,y:m.y-g.y}),y={x:g.x+x.x*o,y:g.y+x.y*o},b={x:g.x+v.x*o,y:g.y+v.y*o};h===0?l.push(`M ${y.x},${y.y}`):l.push(`L ${y.x},${y.y}`),l.push(`Q ${g.x},${g.y} ${b.x},${b.y}`)}const c=t[t.length-1],d=t[0],u=Eu({x:c.x-d.x,y:c.y-d.y}),f={x:d.x+u.x*o,y:d.y+u.y*o};return l.push(`L ${f.x},${f.y}`),l.push("Z"),l.join(" ")}function Eu(t){const e=Math.sqrt(t.x*t.x+t.y*t.y);return e===0?{x:0,y:0}:{x:t.x/e,y:t.y/e}}function s5(t){const e={3:"Triangle",4:"Rectangle",5:"Pentagon",6:"Hexagon",7:"Heptagon",8:"Octagon",9:"Nonagon",10:"Decagon",12:"Dodecagon"};return t>=32?"Circle":e[t]?e[t]:`${t}-gon`}function o5(t){return t>=32?"":t===3?"":t===4?"":t===5?"":t===6?"":`${t}`}function a5({shape:t,isSelected:e,onMouseDown:r,onTouchStart:n,onDoubleClick:i,onScaleStart:s,onRotateStart:o}){const{sides:l,width_mm:c,height_mm:d,cornerRadius:u,position:f,rotation:h,fillColor:p,strokeEnabled:g,strokeColor:m,strokeWidth_mm:x}=t,v=P.useMemo(()=>t5(l,c,d,u),[l,c,d,u]),y=c/2,b=d/2,w=`translate(${f.x}, ${f.y}) rotate(${h||0}, ${y}, ${b})`;return a.jsxs("g",{className:`shape-element ${e?"shape-element--selected":""}`,transform:w,style:{cursor:"move"},children:[a.jsx("path",{d:v,fill:(p==null?void 0:p.hex)||"#609B63",stroke:g&&m?m.hex:"none",strokeWidth:g?x:0,pointerEvents:"none"}),a.jsx("path",{d:v,fill:"transparent",stroke:"transparent",strokeWidth:Math.max(x,100),pointerEvents:"all",onMouseDown:r,onTouchStart:n,onDoubleClick:i,style:{cursor:"move"}}),e&&a.jsx("rect",{x:"-10",y:"-10",width:c+20,height:d+20,fill:"none",stroke:"#3b82f6",strokeWidth:"80",strokeDasharray:"400 400",opacity:"0.7",pointerEvents:"none"}),e&&a.jsx(l5,{width:c,height:d,onScaleStart:s,onRotateStart:o})]})}function l5({width:t,height:e,onScaleStart:r,onRotateStart:n}){const i=Math.min(t,e)*.08,l=Math.max(150,Math.min(400,i)),c=[{x:t/2-l/2,y:-l/2,corner:"n",cursor:"ns-resize"},{x:t/2-l/2,y:e-l/2,corner:"s",cursor:"ns-resize"},{x:t-l/2,y:e/2-l/2,corner:"e",cursor:"ew-resize"},{x:-l/2,y:e/2-l/2,corner:"w",cursor:"ew-resize"}],d=l*2.5,u=l*.8;return a.jsxs("g",{className:"shape-handles",children:[c.map(f=>a.jsx("rect",{x:f.x,y:f.y,width:l,height:l,fill:"#3b82f6",stroke:"#fff",strokeWidth:"20",rx:l/4,style:{cursor:f.cursor},pointerEvents:"all",onMouseDown:h=>{h.stopPropagation(),r==null||r(h,f.corner)},onTouchStart:h=>{h.stopPropagation(),r==null||r(h,f.corner)}},f.corner)),a.jsx("line",{x1:t/2,y1:0,x2:t/2,y2:-d+u/2,stroke:"#3b82f6",strokeWidth:"30",pointerEvents:"none"}),a.jsx("circle",{cx:t/2,cy:-d,r:u,fill:"#3b82f6",stroke:"#fff",strokeWidth:"20",style:{cursor:"grab"},pointerEvents:"all",onMouseDown:f=>{f.stopPropagation(),n==null||n(f)},onTouchStart:f=>{f.stopPropagation(),n==null||n(f)}}),a.jsx("path",{d:`M ${t/2-u*.4} ${-d}
            A ${u*.4} ${u*.4} 0 1 1
            ${t/2+u*.4} ${-d}`,fill:"none",stroke:"#fff",strokeWidth:"25",strokeLinecap:"round",pointerEvents:"none"}),a.jsx("polygon",{points:`${t/2+u*.4},${-d-u*.25}
                 ${t/2+u*.4},${-d+u*.25}
                 ${t/2+u*.65},${-d}`,fill:"#fff",pointerEvents:"none"})]})}function c5({controlPoints:t,width:e,height:r,onPointDrag:n,onHandleDrag:i,onDragEnd:s}){const[o,l]=P.useState(null),[c,d]=P.useState(null),u=Math.min(e,r)*.03,p=Math.max(60,Math.min(120,u)),g=p*.7,m=P.useCallback((v,y)=>{v.stopPropagation(),v.preventDefault(),l({type:"point",index:y}),d({x:v.clientX,y:v.clientY})},[]),x=P.useCallback((v,y,b)=>{v.stopPropagation(),v.preventDefault(),l({type:"handle",index:y,handleType:b}),d({x:v.clientX,y:v.clientY})},[]);return P.useEffect(()=>{if(!o)return;const v=b=>{if(!c)return;const w=document.querySelector(".court-canvas__svg");if(!w)return;const k=w.getBoundingClientRect(),_=w.viewBox.baseVal,C=_.width/k.width,N=_.height/k.height,T=(b.clientX-c.x)*C,O=(b.clientY-c.y)*N;if(o.type==="point"){const X=t[o.index],E=X.x+T/e,F=X.y+O/r;n==null||n(o.index,E,F)}else if(o.type==="handle"){const E=t[o.index][o.handleType],F=E.x+T/e,S=E.y+O/r;i==null||i(o.index,o.handleType,F,S)}d({x:b.clientX,y:b.clientY})},y=()=>{l(null),d(null),s==null||s()};return window.addEventListener("mousemove",v),window.addEventListener("mouseup",y),()=>{window.removeEventListener("mousemove",v),window.removeEventListener("mouseup",y)}},[o,c,t,e,r,n,i,s]),!t||t.length===0?null:a.jsx("g",{className:"blob-edit-handles",children:t.map((v,y)=>{const b=v.x*e,w=v.y*r,k=b+v.handleIn.x*e,_=w+v.handleIn.y*r,C=b+v.handleOut.x*e,N=w+v.handleOut.y*r,T=(o==null?void 0:o.type)==="point"&&(o==null?void 0:o.index)===y,O=(o==null?void 0:o.type)==="handle"&&(o==null?void 0:o.index)===y&&(o==null?void 0:o.handleType)==="handleIn",X=(o==null?void 0:o.type)==="handle"&&(o==null?void 0:o.index)===y&&(o==null?void 0:o.handleType)==="handleOut";return a.jsxs("g",{className:"blob-control-point-group",children:[a.jsx("line",{x1:b,y1:w,x2:k,y2:_,stroke:"#94a3b8",strokeWidth:"20",strokeDasharray:"60 40",pointerEvents:"none",opacity:"0.8"}),a.jsx("line",{x1:b,y1:w,x2:C,y2:N,stroke:"#94a3b8",strokeWidth:"20",strokeDasharray:"60 40",pointerEvents:"none",opacity:"0.8"}),a.jsx("circle",{cx:k,cy:_,r:g,fill:O?"#f97316":"#ffffff",stroke:"#64748b",strokeWidth:"15",style:{cursor:"crosshair"},pointerEvents:"all",onMouseDown:E=>x(E,y,"handleIn")}),a.jsx("circle",{cx:C,cy:N,r:g,fill:X?"#f97316":"#ffffff",stroke:"#64748b",strokeWidth:"15",style:{cursor:"crosshair"},pointerEvents:"all",onMouseDown:E=>x(E,y,"handleOut")}),a.jsx("circle",{cx:b,cy:w,r:p,fill:T?"#f97316":"#3b82f6",stroke:"#ffffff",strokeWidth:"20",style:{cursor:"move"},pointerEvents:"all",onMouseDown:E=>m(E,y)}),a.jsx("text",{x:b,y:w+p*.35,textAnchor:"middle",fontSize:p*.8,fill:"#ffffff",fontWeight:"bold",pointerEvents:"none",children:y+1})]},y)})})}function d5({shape:t,isSelected:e,onMouseDown:r,onTouchStart:n,onDoubleClick:i,onScaleStart:s,onRotateStart:o,onPointDrag:l,onHandleDrag:c,onDragEnd:d}){const{controlPoints:u,width_mm:f,height_mm:h,position:p,rotation:g,fillColor:m,strokeEnabled:x,strokeColor:v,strokeWidth_mm:y,editPointsVisible:b}=t,w=P.useMemo(()=>SC(u,f,h),[u,f,h]),k=f/2,_=h/2,C=`translate(${p.x}, ${p.y}) rotate(${g||0}, ${k}, ${_})`;return a.jsxs("g",{className:`blob-element ${e?"blob-element--selected":""}`,transform:C,style:{cursor:"move"},children:[a.jsx("path",{d:w,fill:(m==null?void 0:m.hex)||"#609B63",stroke:x&&v?v.hex:"none",strokeWidth:x?y:0,pointerEvents:"none"}),a.jsx("path",{d:w,fill:"transparent",stroke:"transparent",strokeWidth:Math.max(y||0,100),pointerEvents:"all",onTouchStart:n,onMouseDown:r,onDoubleClick:i,style:{cursor:"move"}}),e&&a.jsx("rect",{x:"-10",y:"-10",width:f+20,height:h+20,fill:"none",stroke:"#3b82f6",strokeWidth:"80",strokeDasharray:"400 400",opacity:"0.7",pointerEvents:"none"}),e&&a.jsx(u5,{width:f,height:h,onScaleStart:s,onRotateStart:o}),e&&u&&b&&a.jsx(c5,{controlPoints:u,width:f,height:h,onPointDrag:l,onHandleDrag:c,onDragEnd:d})]})}function u5({width:t,height:e,onScaleStart:r,onRotateStart:n}){const i=Math.min(t,e)*.08,l=Math.max(150,Math.min(400,i)),c=[{x:-l/2,y:-l/2,corner:"nw",cursor:"nwse-resize"},{x:t-l/2,y:-l/2,corner:"ne",cursor:"nesw-resize"},{x:-l/2,y:e-l/2,corner:"sw",cursor:"nesw-resize"},{x:t-l/2,y:e-l/2,corner:"se",cursor:"nwse-resize"}],d=l*2.5,u=l*.8;return a.jsxs("g",{className:"blob-resize-handles",children:[c.map(f=>a.jsx("rect",{x:f.x,y:f.y,width:l,height:l,fill:"#3b82f6",stroke:"#fff",strokeWidth:"20",rx:l/4,style:{cursor:f.cursor},pointerEvents:"all",onMouseDown:h=>{h.stopPropagation(),r==null||r(h,f.corner)},onTouchStart:h=>{h.stopPropagation(),r==null||r(h,f.corner)}},f.corner)),a.jsx("line",{x1:t/2,y1:0,x2:t/2,y2:-d+u/2,stroke:"#3b82f6",strokeWidth:"30",pointerEvents:"none"}),a.jsx("circle",{cx:t/2,cy:-d,r:u,fill:"#3b82f6",stroke:"#fff",strokeWidth:"20",style:{cursor:"grab"},pointerEvents:"all",onMouseDown:f=>{f.stopPropagation(),n==null||n(f)},onTouchStart:f=>{f.stopPropagation(),n==null||n(f)}}),a.jsx("path",{d:`M ${t/2-u*.4} ${-d}
            A ${u*.4} ${u*.4} 0 1 1
            ${t/2+u*.4} ${-d}`,fill:"none",stroke:"#fff",strokeWidth:"25",strokeLinecap:"round",pointerEvents:"none"}),a.jsx("polygon",{points:`${t/2+u*.4},${-d-u*.25}
                 ${t/2+u*.4},${-d+u*.25}
                 ${t/2+u*.65},${-d}`,fill:"#fff",pointerEvents:"none"})]})}function _i(t,e,r,n="normal",i="normal"){_i._canvas||(_i._canvas=document.createElement("canvas"),_i._ctx=_i._canvas.getContext("2d"));const s=_i._ctx,o=i==="italic"?"italic ":"",l=n==="bold"?"bold ":"";s.font=`${o}${l}${r}px ${e}`;const c=s.measureText(t||"Double-click to edit");return{width:Math.max(c.width,100),height:r*1.2}}function h5(){return[{name:"Open Sans",family:"Open Sans, sans-serif"},{name:"Roboto",family:"Roboto, sans-serif"},{name:"Montserrat",family:"Montserrat, sans-serif"},{name:"Oswald",family:"Oswald, sans-serif"},{name:"Playfair Display",family:"Playfair Display, serif"},{name:"Arial",family:"Arial, sans-serif"},{name:"Georgia",family:"Georgia, serif"},{name:"Impact",family:"Impact, sans-serif"}]}function f5({text:t,isSelected:e,isEditing:r,onMouseDown:n,onTouchStart:i,onDoubleClick:s,onScaleStart:o,onRotateStart:l,onContentChange:c,onEditComplete:d}){const u=P.useRef(null),{content:f,fontFamily:h,fontSize_mm:p,fontWeight:g,fontStyle:m,textAlign:x,position:v,rotation:y,fillColor:b}=t,w=P.useMemo(()=>_i(f,h,p,g,m),[f,h,p,g,m]),k=P.useMemo(()=>{switch(x){case"center":return-w.width/2;case"right":return-w.width;default:return 0}},[x,w.width]),_=`translate(${v.x}, ${v.y}) rotate(${y||0})`;P.useEffect(()=>{r&&u.current&&(u.current.focus(),u.current.select())},[r]);const C=T=>{(T.key==="Enter"||T.key==="Escape")&&(T.preventDefault(),d==null||d())},N=f||"Double-click to edit";return a.jsxs("g",{className:`text-element ${e?"text-element--selected":""} ${r?"text-element--editing":""}`,transform:_,children:[r?a.jsx("foreignObject",{x:k-10,y:-p*.85,width:Math.max(w.width+200,500),height:p*1.5,style:{overflow:"visible"},children:a.jsx("input",{ref:u,type:"text",value:f,onChange:T=>c==null?void 0:c(T.target.value),onBlur:d,onKeyDown:C,style:{fontFamily:h,fontSize:`${p}px`,fontWeight:g,fontStyle:m,color:(b==null?void 0:b.hex)||"#1C1C1C",background:"rgba(255,255,255,0.95)",border:"4px solid #3b82f6",borderRadius:"4px",outline:"none",padding:"4px 8px",width:"100%",boxSizing:"border-box",lineHeight:1}})}):a.jsxs(a.Fragment,{children:[a.jsx("text",{x:"0",y:"0",fontFamily:h,fontSize:p,fontWeight:g,fontStyle:m,textAnchor:x==="center"?"middle":x==="right"?"end":"start",fill:(b==null?void 0:b.hex)||"#1C1C1C",style:{cursor:"move",userSelect:"none"},pointerEvents:"none",children:N}),a.jsx("rect",{x:k-20,y:-p*.85,width:w.width+40,height:p*1.2,fill:"transparent",onMouseDown:n,onTouchStart:i,onDoubleClick:s,style:{cursor:"move"}})]}),e&&!r&&a.jsx("rect",{x:k-40,y:-p-40,width:w.width+80,height:p*1.2+80,fill:"none",stroke:"#3b82f6",strokeWidth:"60",strokeDasharray:"300 300",opacity:"0.7",pointerEvents:"none"}),e&&!r&&a.jsx(p5,{bounds:w,fontSize:p,alignOffset:k,onScaleStart:o,onRotateStart:l})]})}function p5({bounds:t,fontSize:e,alignOffset:r,onScaleStart:n,onRotateStart:i}){const s=Math.min(t.width,e)*.15,c=Math.max(100,Math.min(300,s)),d=r-20,u=-e-20,f=t.width+40,h=e*1.2+40,p=[{x:d-c/2,y:u-c/2,corner:"nw",cursor:"nwse-resize"},{x:d+f-c/2,y:u-c/2,corner:"ne",cursor:"nesw-resize"},{x:d-c/2,y:u+h-c/2,corner:"sw",cursor:"nesw-resize"},{x:d+f-c/2,y:u+h-c/2,corner:"se",cursor:"nwse-resize"}],g=c*2.5,m=c*.8,x=d+f/2;return a.jsxs("g",{className:"text-handles",children:[p.map(v=>a.jsx("rect",{x:v.x,y:v.y,width:c,height:c,fill:"#3b82f6",stroke:"#fff",strokeWidth:"15",rx:c/4,style:{cursor:v.cursor},pointerEvents:"all",onMouseDown:y=>{y.stopPropagation(),n==null||n(y,v.corner)},onTouchStart:y=>{y.stopPropagation(),n==null||n(y,v.corner)}},v.corner)),a.jsx("line",{x1:x,y1:u,x2:x,y2:u-g+m/2,stroke:"#3b82f6",strokeWidth:"25",pointerEvents:"none"}),a.jsx("circle",{cx:x,cy:u-g,r:m,fill:"#3b82f6",stroke:"#fff",strokeWidth:"15",style:{cursor:"grab"},pointerEvents:"all",onMouseDown:v=>{v.stopPropagation(),i==null||i(v)},onTouchStart:v=>{v.stopPropagation(),i==null||i(v)}}),a.jsx("path",{d:`M ${x-m*.4} ${u-g}
            A ${m*.4} ${m*.4} 0 1 1
            ${x+m*.4} ${u-g}`,fill:"none",stroke:"#fff",strokeWidth:"20",strokeLinecap:"round",pointerEvents:"none"}),a.jsx("polygon",{points:`${x+m*.4},${u-g-m*.25}
                 ${x+m*.4},${u-g+m*.25}
                 ${x+m*.65},${u-g}`,fill:"#fff",pointerEvents:"none"})]})}const m5=P.forwardRef(function(e,r){const n=P.useRef(null),i=P.useRef(null);P.useImperativeHandle(r,()=>n.current);const[s,o]=P.useState(1),[l,c]=P.useState({x:0,y:0}),[d,u]=P.useState(!1),[f,h]=P.useState({x:0,y:0}),[p,g]=P.useState(!1),[m,x]=P.useState({active:!1,initialDistance:0,initialZoom:1,initialPan:{x:0,y:0},initialCenter:{x:0,y:0}}),[v,y]=P.useState(!1),[b,w]=P.useState(null),[k,_]=P.useState(null),[C,N]=P.useState(null),[T,O]=P.useState(null),[X,E]=P.useState(null),[F,S]=P.useState(null),[K,le]=P.useState(!1),[D,I]=P.useState(null),[L,Z]=P.useState(null),[H,G]=P.useState(!1),[ee,oe]=P.useState(null),[fe,Oe]=P.useState(null),[$e,Ie]=P.useState(!1),[Ee,ge]=P.useState(null),[me,He]=P.useState(null),[ue,j]=P.useState(!1),[ce,re]=P.useState(null),[z,R]=P.useState(null),[U,ae]=P.useState(!1),[q,M]=P.useState(null),[J,de]=P.useState(null),[ie,A]=P.useState(!1),[Y,se]=P.useState(null),[we,ne]=P.useState(null),{surface:Se,courts:ke,tracks:Ce,motifs:xe,shapes:Ye,texts:Ke,elementOrder:ft,selectedCourtId:ut,selectedTrackId:We,selectedMotifId:nt,selectedShapeId:ht,selectedTextId:tt,editingTextId:ct,snapToGrid:Mt,gridSize_mm:Br,selectCourt:In,deselectCourt:Dn,selectTrack:zn,deselectTrack:Nt,selectMotif:Cr,deselectMotif:Kt,selectShape:mr,deselectShape:lr,selectText:Ht,deselectText:tr,startEditingText:Qr,stopEditingText:Fn,updateCourtPosition:Er,updateTrackPosition:_t,updateMotifPosition:xn,updateMotifScale:pt,updateMotifRotation:$t,updateShapePosition:et,updateShapeDimensions:at,updateShapeRotation:Ut,updateTextPosition:rt,updateTextFontSize:Hr,updateTextRotation:bn,updateTextContent:ks,updateBlobControlPoint:ci,updateBlobHandle:Tr,commitBlobEdit:wn}=st(),gt=(B,te)=>{const W=n.current,ve=W.createSVGPoint();ve.x=B,ve.y=te;const Xe=ve.matrixTransform(W.getScreenCTM().inverse());return{x:Xe.x,y:Xe.y}},Bn=(B,te)=>{B.stopPropagation(),In(te);const W=ke[te];if(W!=null&&W.locked)return;const ve=B.touches?B.touches[0].clientX:B.clientX,Xe=B.touches?B.touches[0].clientY:B.clientY,Ae=gt(ve,Xe);w({x:Ae.x-W.position.x,y:Ae.y-W.position.y}),_(te),y(!0)},di=(B,te)=>{B.stopPropagation(),In(te),st.setState({showPropertiesPanel:!0,propertiesPanelUserClosed:!1})},Ur=(B,te)=>{B.stopPropagation(),zn(te);const W=Ce[te];if(W!=null&&W.locked)return;const ve=B.touches?B.touches[0].clientX:B.clientX,Xe=B.touches?B.touches[0].clientY:B.clientY,Ae=gt(ve,Xe);w({x:Ae.x-W.position.x,y:Ae.y-W.position.y}),N(te),y(!0)},Hn=(B,te)=>{B.stopPropagation(),zn(te),st.setState({showPropertiesPanel:!0,propertiesPanelUserClosed:!1})},Un=(B,te)=>{B.stopPropagation(),Cr(te);const W=xe[te];if(W!=null&&W.locked)return;const ve=B.touches?B.touches[0].clientX:B.clientX,Xe=B.touches?B.touches[0].clientY:B.clientY,Ae=gt(ve,Xe);w({x:Ae.x-W.position.x,y:Ae.y-W.position.y}),O(te),y(!0)},js=(B,te)=>{B.stopPropagation(),Cr(te),st.setState({showPropertiesPanel:!0,propertiesPanelUserClosed:!1})},Wn=(B,te,W)=>{B.stopPropagation();const ve=xe[te];if(!ve||ve.locked)return;const Xe=B.touches?B.touches[0].clientX:B.clientX,Ae=B.touches?B.touches[0].clientY:B.clientY,Ze=gt(Xe,Ae),qe=ve.originalWidth_mm*(ve.scale||1),Pe=ve.originalHeight_mm*(ve.scale||1);let Ne;switch(W){case"nw":Ne={x:ve.position.x+qe,y:ve.position.y+Pe};break;case"ne":Ne={x:ve.position.x,y:ve.position.y+Pe};break;case"sw":Ne={x:ve.position.x+qe,y:ve.position.y};break;case"se":default:Ne={x:ve.position.x,y:ve.position.y};break}const Q=Math.sqrt(Math.pow(Ze.x-Ne.x,2)+Math.pow(Ze.y-Ne.y,2));Z({initialDistance:Q,originalScale:ve.scale||1,originalWidth:qe,originalHeight:Pe,corner:W,anchorPoint:Ne}),I(te),le(!0)},Zo=(B,te)=>{B.stopPropagation();const W=xe[te];if(!W||W.locked)return;const ve=B.touches?B.touches[0].clientX:B.clientX,Xe=B.touches?B.touches[0].clientY:B.clientY,Ae=gt(ve,Xe),Ze=W.originalWidth_mm*(W.scale||1),qe=W.originalHeight_mm*(W.scale||1),Pe={x:W.position.x+Ze/2,y:W.position.y+qe/2},Ne=Math.atan2(Ae.y-Pe.y,Ae.x-Pe.x)*(180/Math.PI);Oe({initialAngle:Ne,originalRotation:W.rotation||0,motifCenter:Pe}),oe(te),G(!0)},en=(B,te)=>{B.stopPropagation(),mr(te);const W=Ye[te];if(W!=null&&W.locked)return;const ve=B.touches?B.touches[0].clientX:B.clientX,Xe=B.touches?B.touches[0].clientY:B.clientY,Ae=gt(ve,Xe);w({x:Ae.x-W.position.x,y:Ae.y-W.position.y}),E(te),y(!0)},_n=(B,te)=>{B.stopPropagation(),mr(te),st.setState({showPropertiesPanel:!0,propertiesPanelUserClosed:!1})},tn=(B,te,W)=>{B.stopPropagation();const ve=Ye[te];if(!ve||ve.locked)return;const Xe=B.touches?B.touches[0].clientX:B.clientX,Ae=B.touches?B.touches[0].clientY:B.clientY,Ze=gt(Xe,Ae),{width_mm:qe,height_mm:Pe}=ve;let Ne;switch(W){case"n":Ne={x:ve.position.x+qe/2,y:ve.position.y+Pe};break;case"s":Ne={x:ve.position.x+qe/2,y:ve.position.y};break;case"e":Ne={x:ve.position.x,y:ve.position.y+Pe/2};break;case"w":Ne={x:ve.position.x+qe,y:ve.position.y+Pe/2};break;case"nw":Ne={x:ve.position.x+qe,y:ve.position.y+Pe};break;case"ne":Ne={x:ve.position.x,y:ve.position.y+Pe};break;case"sw":Ne={x:ve.position.x+qe,y:ve.position.y};break;case"se":default:Ne={x:ve.position.x,y:ve.position.y};break}const Q=Math.sqrt(Math.pow(Ze.x-Ne.x,2)+Math.pow(Ze.y-Ne.y,2));He({initialDistance:Q,originalWidth:qe,originalHeight:Pe,aspectLocked:ve.aspectLocked,corner:W,anchorPoint:Ne}),ge(te),Ie(!0)},rn=(B,te)=>{B.stopPropagation();const W=Ye[te];if(!W||W.locked)return;const ve=B.touches?B.touches[0].clientX:B.clientX,Xe=B.touches?B.touches[0].clientY:B.clientY,Ae=gt(ve,Xe),{width_mm:Ze,height_mm:qe}=W,Pe={x:W.position.x+Ze/2,y:W.position.y+qe/2},Ne=Math.atan2(Ae.y-Pe.y,Ae.x-Pe.x)*(180/Math.PI);R({initialAngle:Ne,originalRotation:W.rotation||0,shapeCenter:Pe}),re(te),j(!0)},Ui=(B,te)=>{if(B.stopPropagation(),ct===te)return;Ht(te);const W=Ke[te];if(W!=null&&W.locked)return;const ve=B.touches?B.touches[0].clientX:B.clientX,Xe=B.touches?B.touches[0].clientY:B.clientY,Ae=gt(ve,Xe);w({x:Ae.x-W.position.x,y:Ae.y-W.position.y}),S(te),y(!0)},Wi=(B,te)=>{B.stopPropagation(),Ht(te),Qr(te)},Cs=(B,te,W)=>{B.stopPropagation();const ve=Ke[te];if(!ve||ve.locked)return;const Xe=B.touches?B.touches[0].clientX:B.clientX,Ae=B.touches?B.touches[0].clientY:B.clientY,Ze=gt(Xe,Ae),qe=_i(ve.content,ve.fontFamily,ve.fontSize_mm,ve.fontWeight,ve.fontStyle);let Pe=ve.position.x;ve.textAlign==="center"?Pe-=qe.width/2:ve.textAlign==="right"&&(Pe-=qe.width);const Ne=ve.position.y-ve.fontSize_mm;let Q;switch(W){case"nw":Q={x:Pe+qe.width,y:Ne+ve.fontSize_mm*1.2};break;case"ne":Q={x:Pe,y:Ne+ve.fontSize_mm*1.2};break;case"sw":Q={x:Pe+qe.width,y:Ne};break;case"se":default:Q={x:Pe,y:Ne};break}const he=Math.sqrt(Math.pow(Ze.x-Q.x,2)+Math.pow(Ze.y-Q.y,2));de({initialDistance:he,originalFontSize:ve.fontSize_mm,originalPosition:{...ve.position},originalBounds:qe,textAlign:ve.textAlign,corner:W,anchorPoint:Q}),M(te),ae(!0)},ui=(B,te)=>{B.stopPropagation();const W=Ke[te];if(!W||W.locked)return;const ve=B.touches?B.touches[0].clientX:B.clientX,Xe=B.touches?B.touches[0].clientY:B.clientY,Ae=gt(ve,Xe),Ze=_i(W.content,W.fontFamily,W.fontSize_mm,W.fontWeight,W.fontStyle);let qe=W.position.x;W.textAlign==="center"?qe=W.position.x:W.textAlign==="right"?qe=W.position.x-Ze.width/2:qe=W.position.x+Ze.width/2;const Pe={x:qe,y:W.position.y-W.fontSize_mm*.4},Ne=Math.atan2(Ae.y-Pe.y,Ae.x-Pe.x)*(180/Math.PI);ne({initialAngle:Ne,originalRotation:W.rotation||0,textCenter:Pe}),se(te),A(!0)};P.useEffect(()=>{y(!1),_(null),N(null),O(null),E(null),S(null),w(null)},[Se.width_mm,Se.length_mm]),P.useEffect(()=>{if(!v||!k&&!C&&!T&&!X&&!F)return;const B=W=>{const ve=W.touches?W.touches[0].clientX:W.clientX,Xe=W.touches?W.touches[0].clientY:W.clientY,Ae=gt(ve,Xe);let Ze={x:Ae.x-b.x,y:Ae.y-b.y};if(Mt&&(Ze=FC(Ze,Br)),k){const qe=ke[k],Pe={width_mm:qe.template.dimensions.width_mm*qe.scale,length_mm:qe.template.dimensions.length_mm*qe.scale};Ze=ju(Ze,Pe,Se),Er(k,Ze)}else if(C)_t(C,Ze);else if(T){const qe=xe[T],Pe={width_mm:qe.originalWidth_mm*(qe.scale||1),length_mm:qe.originalHeight_mm*(qe.scale||1)};Ze=ju(Ze,Pe,Se),xn(T,Ze)}else if(X){const qe=Ye[X],Pe={width_mm:qe.width_mm,length_mm:qe.height_mm};Ze=ju(Ze,Pe,Se),et(X,Ze)}else F&&rt(F,Ze)},te=()=>{if(k||C||T||X||F){const{addToHistory:W}=st.getState();W()}y(!1),_(null),N(null),O(null),E(null),S(null),w(null)};return window.addEventListener("mousemove",B),window.addEventListener("mouseup",te),window.addEventListener("touchmove",B,{passive:!1}),window.addEventListener("touchend",te),window.addEventListener("touchcancel",te),()=>{window.removeEventListener("mousemove",B),window.removeEventListener("mouseup",te),window.removeEventListener("touchmove",B),window.removeEventListener("touchend",te),window.removeEventListener("touchcancel",te)}},[v,k,C,T,X,F,b,ke,Ce,xe,Ye,Ke,Mt,Br,Se,Er,_t,xn,et,rt]),P.useEffect(()=>{if(!K||!D||!L)return;const B=W=>{const ve=W.touches?W.touches[0].clientX:W.clientX,Xe=W.touches?W.touches[0].clientY:W.clientY,Ae=gt(ve,Xe),Ze=xe[D];if(!Ze)return;const Pe=Math.sqrt(Math.pow(Ae.x-L.anchorPoint.x,2)+Math.pow(Ae.y-L.anchorPoint.y,2))/L.initialDistance;let Ne=L.originalScale*Pe;Ne=Math.max(.1,Ne),Ne=Math.round(Ne*100)/100;const Q=Ze.originalWidth_mm*Ne,he=Ze.originalHeight_mm*Ne;let be;switch(L.corner){case"nw":be={x:L.anchorPoint.x-Q,y:L.anchorPoint.y-he};break;case"ne":be={x:L.anchorPoint.x,y:L.anchorPoint.y-he};break;case"sw":be={x:L.anchorPoint.x-Q,y:L.anchorPoint.y};break;case"se":default:be={x:L.anchorPoint.x,y:L.anchorPoint.y};break}pt(D,Ne),xn(D,be)},te=()=>{const{addToHistory:W}=st.getState();W(),le(!1),I(null),Z(null)};return window.addEventListener("mousemove",B),window.addEventListener("mouseup",te),window.addEventListener("touchmove",B,{passive:!1}),window.addEventListener("touchend",te),window.addEventListener("touchcancel",te),()=>{window.removeEventListener("mousemove",B),window.removeEventListener("mouseup",te),window.removeEventListener("touchmove",B),window.removeEventListener("touchend",te),window.removeEventListener("touchcancel",te)}},[K,D,L,xe,pt,xn]),P.useEffect(()=>{if(!H||!ee||!fe)return;const B=W=>{const ve=W.touches?W.touches[0].clientX:W.clientX,Xe=W.touches?W.touches[0].clientY:W.clientY,Ae=gt(ve,Xe),qe=Math.atan2(Ae.y-fe.motifCenter.y,Ae.x-fe.motifCenter.x)*(180/Math.PI)-fe.initialAngle;let Pe=fe.originalRotation+qe;Pe=(Pe%360+360)%360,W.shiftKey&&(Pe=Math.round(Pe/15)*15),Pe=Math.round(Pe*10)/10,$t(ee,Pe)},te=()=>{const{addToHistory:W}=st.getState();W(),G(!1),oe(null),Oe(null)};return window.addEventListener("mousemove",B),window.addEventListener("mouseup",te),window.addEventListener("touchmove",B,{passive:!1}),window.addEventListener("touchend",te),window.addEventListener("touchcancel",te),()=>{window.removeEventListener("mousemove",B),window.removeEventListener("mouseup",te),window.removeEventListener("touchmove",B),window.removeEventListener("touchend",te),window.removeEventListener("touchcancel",te)}},[H,ee,fe,$t]),P.useEffect(()=>{if(!$e||!Ee||!me)return;const B=W=>{const ve=W.touches?W.touches[0].clientX:W.clientX,Xe=W.touches?W.touches[0].clientY:W.clientY,Ae=gt(ve,Xe);if(!Ye[Ee])return;const Pe=Math.sqrt(Math.pow(Ae.x-me.anchorPoint.x,2)+Math.pow(Ae.y-me.anchorPoint.y,2))/me.initialDistance;let Ne,Q;const he=me.corner,be=["n","s","e","w"].includes(he);if(me.aspectLocked)Ne=me.originalWidth*Pe,Q=me.originalHeight*Pe;else if(be){const De=Math.abs(Ae.y-me.anchorPoint.y),Be=Math.abs(Ae.x-me.anchorPoint.x);he==="n"||he==="s"?(Ne=me.originalWidth,Q=Math.max(100,De)):(Ne=Math.max(100,Be),Q=me.originalHeight)}else{const De=Math.abs(Ae.x-me.anchorPoint.x),Be=Math.abs(Ae.y-me.anchorPoint.y);Ne=Math.max(100,De),Q=Math.max(100,Be)}Ne=Math.round(Ne),Q=Math.round(Q);let ye;switch(he){case"n":ye={x:me.anchorPoint.x-Ne/2,y:me.anchorPoint.y-Q};break;case"s":ye={x:me.anchorPoint.x-Ne/2,y:me.anchorPoint.y};break;case"e":ye={x:me.anchorPoint.x,y:me.anchorPoint.y-Q/2};break;case"w":ye={x:me.anchorPoint.x-Ne,y:me.anchorPoint.y-Q/2};break;case"nw":ye={x:me.anchorPoint.x-Ne,y:me.anchorPoint.y-Q};break;case"ne":ye={x:me.anchorPoint.x,y:me.anchorPoint.y-Q};break;case"sw":ye={x:me.anchorPoint.x-Ne,y:me.anchorPoint.y};break;case"se":default:ye={x:me.anchorPoint.x,y:me.anchorPoint.y};break}at(Ee,Ne,Q),et(Ee,ye)},te=()=>{const{addToHistory:W}=st.getState();W(),Ie(!1),ge(null),He(null)};return window.addEventListener("mousemove",B),window.addEventListener("mouseup",te),window.addEventListener("touchmove",B,{passive:!1}),window.addEventListener("touchend",te),window.addEventListener("touchcancel",te),()=>{window.removeEventListener("mousemove",B),window.removeEventListener("mouseup",te),window.removeEventListener("touchmove",B),window.removeEventListener("touchend",te),window.removeEventListener("touchcancel",te)}},[$e,Ee,me,Ye,at,et]),P.useEffect(()=>{if(!ue||!ce||!z)return;const B=W=>{const ve=W.touches?W.touches[0].clientX:W.clientX,Xe=W.touches?W.touches[0].clientY:W.clientY,Ae=gt(ve,Xe),qe=Math.atan2(Ae.y-z.shapeCenter.y,Ae.x-z.shapeCenter.x)*(180/Math.PI)-z.initialAngle;let Pe=z.originalRotation+qe;Pe=(Pe%360+360)%360,W.shiftKey&&(Pe=Math.round(Pe/15)*15),Pe=Math.round(Pe*10)/10,Ut(ce,Pe)},te=()=>{const{addToHistory:W}=st.getState();W(),j(!1),re(null),R(null)};return window.addEventListener("mousemove",B),window.addEventListener("mouseup",te),window.addEventListener("touchmove",B,{passive:!1}),window.addEventListener("touchend",te),window.addEventListener("touchcancel",te),()=>{window.removeEventListener("mousemove",B),window.removeEventListener("mouseup",te),window.removeEventListener("touchmove",B),window.removeEventListener("touchend",te),window.removeEventListener("touchcancel",te)}},[ue,ce,z,Ut]),P.useEffect(()=>{if(!U||!q||!J)return;const B=W=>{const ve=W.touches?W.touches[0].clientX:W.clientX,Xe=W.touches?W.touches[0].clientY:W.clientY,Ae=gt(ve,Xe);if(!Ke[q])return;const Pe=Math.sqrt(Math.pow(Ae.x-J.anchorPoint.x,2)+Math.pow(Ae.y-J.anchorPoint.y,2))/J.initialDistance;let Ne=J.originalFontSize*Pe;Ne=Math.max(50,Ne),Ne=Math.round(Ne);const Q=Ne/J.originalFontSize,he=J.originalBounds.width*Q,{corner:be,anchorPoint:ye,textAlign:De,originalPosition:Be,originalBounds:Me,originalFontSize:Ge}=J;let Ue={...Be};switch(be){case"nw":De==="left"?Ue.x=ye.x-he:De==="center"?Ue.x=ye.x-he/2:Ue.x=ye.x,Ue.y=ye.y-Ne*.2;break;case"ne":De==="left"?Ue.x=ye.x:De==="center"?Ue.x=ye.x+he/2:Ue.x=ye.x+he,Ue.y=ye.y-Ne*.2;break;case"sw":De==="left"?Ue.x=ye.x-he:De==="center"?Ue.x=ye.x-he/2:Ue.x=ye.x,Ue.y=ye.y+Ne;break;case"se":default:De==="left"?Ue.x=ye.x:De==="center"?Ue.x=ye.x+he/2:Ue.x=ye.x+he,Ue.y=ye.y+Ne;break}Hr(q,Ne),rt(q,Ue)},te=()=>{const{addToHistory:W}=st.getState();W(),ae(!1),M(null),de(null)};return window.addEventListener("mousemove",B),window.addEventListener("mouseup",te),window.addEventListener("touchmove",B,{passive:!1}),window.addEventListener("touchend",te),window.addEventListener("touchcancel",te),()=>{window.removeEventListener("mousemove",B),window.removeEventListener("mouseup",te),window.removeEventListener("touchmove",B),window.removeEventListener("touchend",te),window.removeEventListener("touchcancel",te)}},[U,q,J,Ke,Hr,rt]),P.useEffect(()=>{if(!ie||!Y||!we)return;const B=W=>{const ve=W.touches?W.touches[0].clientX:W.clientX,Xe=W.touches?W.touches[0].clientY:W.clientY,Ae=gt(ve,Xe),qe=Math.atan2(Ae.y-we.textCenter.y,Ae.x-we.textCenter.x)*(180/Math.PI)-we.initialAngle;let Pe=we.originalRotation+qe;Pe=(Pe%360+360)%360,W.shiftKey&&(Pe=Math.round(Pe/15)*15),Pe=Math.round(Pe*10)/10,bn(Y,Pe)},te=()=>{const{addToHistory:W}=st.getState();W(),A(!1),se(null),ne(null)};return window.addEventListener("mousemove",B),window.addEventListener("mouseup",te),window.addEventListener("touchmove",B,{passive:!1}),window.addEventListener("touchend",te),window.addEventListener("touchcancel",te),()=>{window.removeEventListener("mousemove",B),window.removeEventListener("mouseup",te),window.removeEventListener("touchmove",B),window.removeEventListener("touchend",te),window.removeEventListener("touchcancel",te)}},[ie,Y,we,bn]);const Es=B=>{B.target===B.currentTarget&&(Dn(),Nt(),Kt(),lr(),tr())},Gn=()=>{o(B=>Math.min(B*1.25,5))},Sn=()=>{o(B=>Math.max(B/1.25,.25))},gr=()=>{o(1),c({x:0,y:0})},kn=B=>{if(B.ctrlKey||B.metaKey){B.preventDefault();const te=B.deltaY*-.002;o(W=>Math.min(Math.max(W+W*te,.25),5))}else{B.preventDefault();const te=1;c(W=>({x:W.x-B.deltaX*te,y:W.y-B.deltaY*te}))}},hi=B=>{(B.button===1||B.button===0&&p)&&(B.preventDefault(),B.stopPropagation(),u(!0),h({x:B.clientX-l.x,y:B.clientY-l.y}))},Gi=B=>{d&&c({x:B.clientX-f.x,y:B.clientY-f.y})},Ts=()=>{u(!1)},jn=B=>{const te=B[0].clientX-B[1].clientX,W=B[0].clientY-B[1].clientY;return Math.sqrt(te*te+W*W)},Wr=B=>({x:(B[0].clientX+B[1].clientX)/2,y:(B[0].clientY+B[1].clientY)/2}),Jo=B=>{if(B.touches.length===2){B.preventDefault();const te=jn(B.touches),W=Wr(B.touches);x({active:!0,initialDistance:te,initialZoom:s,initialPan:{...l},initialCenter:W})}},Cn=B=>{if(B.touches.length===2&&m.active){B.preventDefault();const W=jn(B.touches)/m.initialDistance;let ve=m.initialZoom*W;ve=Math.min(Math.max(ve,.25),5);const Xe=Wr(B.touches),Ae=Xe.x-m.initialCenter.x,Ze=Xe.y-m.initialCenter.y;o(ve),c({x:m.initialPan.x+Ae,y:m.initialPan.y+Ze})}},Ns=B=>{B.touches.length<2&&x({active:!1,initialDistance:0,initialZoom:1,initialPan:{x:0,y:0},initialCenter:{x:0,y:0}})};return P.useEffect(()=>{if(d){const B=W=>Gi(W),te=()=>Ts();return window.addEventListener("mousemove",B),window.addEventListener("mouseup",te),()=>{window.removeEventListener("mousemove",B),window.removeEventListener("mouseup",te)}}},[d,f]),P.useEffect(()=>{const B=W=>{if(W.code==="Space"&&!W.repeat){if(W.target.tagName==="INPUT"||W.target.tagName==="TEXTAREA")return;W.preventDefault(),g(!0)}},te=W=>{W.code==="Space"&&(g(!1),u(!1))};return window.addEventListener("keydown",B),window.addEventListener("keyup",te),()=>{window.removeEventListener("keydown",B),window.removeEventListener("keyup",te)}},[]),a.jsxs("div",{className:"court-canvas",onClick:Es,children:[a.jsxs("div",{className:"court-canvas__zoom-controls",children:[a.jsx("button",{onClick:Gn,className:"court-canvas__zoom-btn",title:"Zoom In (Ctrl + Scroll)",children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"11",y1:"8",x2:"11",y2:"14"}),a.jsx("line",{x1:"8",y1:"11",x2:"14",y2:"11"}),a.jsx("path",{d:"m21 21-4.35-4.35"})]})}),a.jsx("button",{onClick:Sn,className:"court-canvas__zoom-btn",title:"Zoom Out (Ctrl + Scroll)",children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"8",y1:"11",x2:"14",y2:"11"}),a.jsx("path",{d:"m21 21-4.35-4.35"})]})}),a.jsx("button",{onClick:gr,className:"court-canvas__zoom-btn",title:"Reset View",children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M1 4v6h6"}),a.jsx("path",{d:"M23 20v-6h-6"}),a.jsx("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})]})}),a.jsxs("span",{className:"court-canvas__zoom-level",title:"Scroll to pan, Ctrl+Scroll to zoom, Space+Drag to pan",children:[Math.round(s*100),"%"]})]}),a.jsx("div",{ref:i,className:"court-canvas__viewport",onWheel:kn,onMouseDown:hi,onTouchStart:Jo,onTouchMove:Cn,onTouchEnd:Ns,style:{cursor:d?"grabbing":p?"grab":void 0,touchAction:"none"},children:a.jsx("div",{className:"court-canvas__transform-wrapper",style:{transform:`translate(${l.x}px, ${l.y}px) scale(${s})`,transformOrigin:"center center"},children:a.jsxs("svg",{ref:n,className:"court-canvas__svg",viewBox:`0 0 ${Se.width_mm} ${Se.length_mm}`,preserveAspectRatio:"xMidYMid meet",children:[a.jsx("rect",{x:"0",y:"0",width:Se.width_mm,height:Se.length_mm,fill:Se.color.hex,className:"court-canvas__surface"}),ft.map(B=>{if(B.startsWith("court-")){const te=ke[B];return!te||te.visible===!1?null:a.jsx(g5,{court:te,isSelected:B===ut,onMouseDown:W=>Bn(W,B),onTouchStart:W=>Bn(W,B),onDoubleClick:W=>di(W,B),svgRef:n},B)}if(B.startsWith("track-")){const te=Ce[B];return!te||te.visible===!1?null:a.jsx(ZC,{track:te,isSelected:B===We,onMouseDown:W=>Ur(W,B),onTouchStart:W=>Ur(W,B),onDoubleClick:W=>Hn(W,B),svgRef:n},B)}if(B.startsWith("motif-")){const te=xe[B];return!te||te.visible===!1?null:a.jsx(QC,{motif:te,isSelected:B===nt,onMouseDown:W=>Un(W,B),onTouchStart:W=>Un(W,B),onDoubleClick:W=>js(W,B),onScaleStart:(W,ve)=>Wn(W,B,ve),onRotateStart:W=>Zo(W,B)},B)}if(B.startsWith("shape-")){const te=Ye[B];return!te||te.visible===!1?null:te.shapeType==="blob"?a.jsx(d5,{shape:te,isSelected:B===ht,onMouseDown:W=>en(W,B),onTouchStart:W=>en(W,B),onDoubleClick:W=>_n(W,B),onScaleStart:(W,ve)=>tn(W,B,ve),onRotateStart:W=>rn(W,B),onPointDrag:(W,ve,Xe)=>ci(B,W,ve,Xe),onHandleDrag:(W,ve,Xe,Ae)=>Tr(B,W,ve,Xe,Ae),onDragEnd:()=>wn()},B):a.jsx(a5,{shape:te,isSelected:B===ht,onMouseDown:W=>en(W,B),onTouchStart:W=>en(W,B),onDoubleClick:W=>_n(W,B),onScaleStart:(W,ve)=>tn(W,B,ve),onRotateStart:W=>rn(W,B)},B)}if(B.startsWith("text-")){const te=Ke[B];return!te||te.visible===!1?null:a.jsx(f5,{text:te,isSelected:B===tt,isEditing:B===ct,onMouseDown:W=>Ui(W,B),onTouchStart:W=>Ui(W,B),onDoubleClick:W=>Wi(W,B),onScaleStart:(W,ve)=>Cs(W,B,ve),onRotateStart:W=>ui(W,B),onContentChange:W=>ks(B,W),onEditComplete:()=>Fn()},B)}return null})]})})}),a.jsxs("div",{className:"court-canvas__info",children:[a.jsxs("span",{children:[(Se.width_mm/1e3).toFixed(1),"m  ",(Se.length_mm/1e3).toFixed(1),"m"]}),Mt&&a.jsxs("span",{className:"court-canvas__grid-indicator",children:["Grid: ",Br,"mm"]})]}),ft.length===0&&a.jsxs("div",{className:"court-canvas__empty-state",children:[a.jsx("div",{className:"court-canvas__empty-icon",children:a.jsxs("svg",{width:"72",height:"72",viewBox:"0 0 24 24",fill:"none",children:[a.jsx("path",{d:"M12 2L14.4 8.4L21 9.6L16.2 14.4L17.6 21L12 17.6L6.4 21L7.8 14.4L3 9.6L9.6 8.4L12 2Z",fill:"rgba(255,255,255,0.15)",stroke:"currentColor",strokeWidth:"1.5",strokeLinejoin:"round"}),a.jsx("circle",{cx:"19",cy:"5",r:"1.5",fill:"currentColor",opacity:"0.6"}),a.jsx("circle",{cx:"5",cy:"18",r:"1",fill:"currentColor",opacity:"0.4"}),a.jsx("circle",{cx:"20",cy:"16",r:"0.8",fill:"currentColor",opacity:"0.5"})]})}),a.jsx("h3",{className:"court-canvas__empty-title",children:"Your canvas is ready"}),a.jsx("p",{className:"court-canvas__empty-text",children:"Design your perfect TPV surface in minutes"}),a.jsxs("div",{className:"court-canvas__empty-hints",children:[a.jsxs("div",{className:"court-canvas__hint",children:[a.jsx("span",{className:"court-canvas__hint-icon",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("line",{x1:"9",y1:"3",x2:"9",y2:"21"})]})}),a.jsxs("span",{children:["Add ",a.jsx("strong",{children:"Courts"}),", ",a.jsx("strong",{children:"Tracks"}),", ",a.jsx("strong",{children:"Shapes"})," or ",a.jsx("strong",{children:"Designs"})]})]}),a.jsxs("div",{className:"court-canvas__hint",children:[a.jsx("span",{className:"court-canvas__hint-icon",children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 5v14M5 12h14"})})}),a.jsx("span",{children:"Click elements in the library to place them"})]}),a.jsxs("div",{className:"court-canvas__hint",children:[a.jsx("span",{className:"court-canvas__hint-icon",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M5 9l4 4-4 4"}),a.jsx("path",{d:"M12 4h7a2 2 0 012 2v12a2 2 0 01-2 2h-7"})]})}),a.jsx("span",{children:"Arrange, customise colours and export"})]})]})]})]})});function g5({court:t,isSelected:e,onMouseDown:r,onTouchStart:n,onDoubleClick:i,svgRef:s}){var d;const{markings:o,zones:l}=zC(t),c=((d=t.courtSurfaceColor)==null?void 0:d.hex)||null;return a.jsxs("g",{className:`court-canvas__court ${e?"court-canvas__court--selected":""}`,transform:BC(t),style:{cursor:"move"},children:[c&&a.jsx("rect",{x:"0",y:"0",width:t.template.dimensions.width_mm,height:t.template.dimensions.length_mm,fill:c,className:"court-canvas__court-surface"}),a.jsx("rect",{x:"0",y:"0",width:t.template.dimensions.width_mm,height:t.template.dimensions.length_mm,fill:"none",pointerEvents:"all",onMouseDown:r,onTouchStart:n,onDoubleClick:i,style:{cursor:"move"}}),l.map(u=>a.jsx(v5,{zone:u},u.id)),o.map(u=>a.jsx(y5,{marking:u},u.id)),e&&a.jsxs(a.Fragment,{children:[a.jsx("rect",{x:"0",y:"0",width:t.template.dimensions.width_mm,height:t.template.dimensions.length_mm,fill:"none",stroke:"#007bff",strokeWidth:"100",strokeDasharray:"400 400",className:"court-canvas__selection-outline"}),a.jsx(HC,{court:t,svgRef:s})]})]})}function v5({zone:t}){switch(t.type){case"rect":return a.jsx("rect",{x:t.x,y:t.y,width:t.width,height:t.height,fill:t.fill});case"circle":return a.jsx("circle",{cx:t.cx,cy:t.cy,r:t.r,fill:t.fill});case"polygon":return a.jsx("polygon",{points:t.points,fill:t.fill});default:return null}}function y5({marking:t}){switch(t.type){case"line":return a.jsx("line",{x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,stroke:t.stroke,strokeWidth:t.strokeWidth});case"rect":return a.jsx("rect",{x:t.x,y:t.y,width:t.width,height:t.height,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill});case"circle":return a.jsx("circle",{cx:t.cx,cy:t.cy,r:t.r,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill});case"path":return a.jsx("path",{d:t.d,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill});case"polyline":return a.jsx("polyline",{points:t.points,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill});default:return null}}const zw={"track-flexible":{id:"track-flexible",name:"Running Track",type:"running-track",trackType:"curved",standard:"Flexible Design",category:"track",description:"Flexible running track - adjust size, lanes, and corner radius to fit your surface",parameters:{numLanes:4,laneWidth_mm:1220,width_mm:25e3,height_mm:15e3,cornerRadius:{topLeft:3e3,topRight:3e3,bottomLeft:3e3,bottomRight:3e3},lineWidth_mm:50,startingBoxes:{enabled:!1,depth_mm:400,lineWidth_mm:50}},defaultLineColor:"RH31",defaultTrackSurfaceColor:"RH01",calculatedDimensions:{totalWidth_mm:25e3,totalLength_mm:15e3}},"track-straight":{id:"track-straight",name:"Straight Track",type:"running-track",trackType:"straight",standard:"Sprint Track",category:"track",description:"Straight sprint track - perfect for 60m, 100m, or custom length sprints",parameters:{numLanes:6,laneWidth_mm:1220,width_mm:7320,height_mm:1e5,cornerRadius:{topLeft:0,topRight:0,bottomLeft:0,bottomRight:0},lineWidth_mm:50,startingBoxes:{enabled:!1,depth_mm:400,lineWidth_mm:50}},defaultLineColor:"RH31",defaultTrackSurfaceColor:"RH01",calculatedDimensions:{totalWidth_mm:7320,totalLength_mm:1e5}}};function x5(){return Object.values(zw)}function b5(t){return zw[t]||null}/*! @license DOMPurify 3.3.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.0/LICENSE */var Tu,g0;function v0(){if(g0)return Tu;g0=1;const{entries:t,setPrototypeOf:e,isFrozen:r,getPrototypeOf:n,getOwnPropertyDescriptor:i}=Object;let{freeze:s,seal:o,create:l}=Object,{apply:c,construct:d}=typeof Reflect<"u"&&Reflect;s||(s=function(J){return J}),o||(o=function(J){return J}),c||(c=function(J,de){for(var ie=arguments.length,A=new Array(ie>2?ie-2:0),Y=2;Y<ie;Y++)A[Y-2]=arguments[Y];return J.apply(de,A)}),d||(d=function(J){for(var de=arguments.length,ie=new Array(de>1?de-1:0),A=1;A<de;A++)ie[A-1]=arguments[A];return new J(...ie)});const u=N(Array.prototype.forEach),f=N(Array.prototype.lastIndexOf),h=N(Array.prototype.pop),p=N(Array.prototype.push),g=N(Array.prototype.splice),m=N(String.prototype.toLowerCase),x=N(String.prototype.toString),v=N(String.prototype.match),y=N(String.prototype.replace),b=N(String.prototype.indexOf),w=N(String.prototype.trim),k=N(Object.prototype.hasOwnProperty),_=N(RegExp.prototype.test),C=T(TypeError);function N(M){return function(J){J instanceof RegExp&&(J.lastIndex=0);for(var de=arguments.length,ie=new Array(de>1?de-1:0),A=1;A<de;A++)ie[A-1]=arguments[A];return c(M,J,ie)}}function T(M){return function(){for(var J=arguments.length,de=new Array(J),ie=0;ie<J;ie++)de[ie]=arguments[ie];return d(M,de)}}function O(M,J){let de=arguments.length>2&&arguments[2]!==void 0?arguments[2]:m;e&&e(M,null);let ie=J.length;for(;ie--;){let A=J[ie];if(typeof A=="string"){const Y=de(A);Y!==A&&(r(J)||(J[ie]=Y),A=Y)}M[A]=!0}return M}function X(M){for(let J=0;J<M.length;J++)k(M,J)||(M[J]=null);return M}function E(M){const J=l(null);for(const[de,ie]of t(M))k(M,de)&&(Array.isArray(ie)?J[de]=X(ie):ie&&typeof ie=="object"&&ie.constructor===Object?J[de]=E(ie):J[de]=ie);return J}function F(M,J){for(;M!==null;){const ie=i(M,J);if(ie){if(ie.get)return N(ie.get);if(typeof ie.value=="function")return N(ie.value)}M=n(M)}function de(){return null}return de}const S=s(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),K=s(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),le=s(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),D=s(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),I=s(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),L=s(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Z=s(["#text"]),H=s(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),G=s(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),ee=s(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),oe=s(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),fe=o(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Oe=o(/<%[\w\W]*|[\w\W]*%>/gm),$e=o(/\$\{[\w\W]*/gm),Ie=o(/^data-[\-\w.\u00B7-\uFFFF]+$/),Ee=o(/^aria-[\-\w]+$/),ge=o(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),me=o(/^(?:\w+script|data):/i),He=o(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),ue=o(/^html$/i),j=o(/^[a-z][.\w]*(-[.\w]+)+$/i);var ce=Object.freeze({__proto__:null,ARIA_ATTR:Ee,ATTR_WHITESPACE:He,CUSTOM_ELEMENT:j,DATA_ATTR:Ie,DOCTYPE_NAME:ue,ERB_EXPR:Oe,IS_ALLOWED_URI:ge,IS_SCRIPT_OR_DATA:me,MUSTACHE_EXPR:fe,TMPLIT_EXPR:$e});const re={element:1,text:3,progressingInstruction:7,comment:8,document:9},z=function(){return typeof window>"u"?null:window},R=function(J,de){if(typeof J!="object"||typeof J.createPolicy!="function")return null;let ie=null;const A="data-tt-policy-suffix";de&&de.hasAttribute(A)&&(ie=de.getAttribute(A));const Y="dompurify"+(ie?"#"+ie:"");try{return J.createPolicy(Y,{createHTML(se){return se},createScriptURL(se){return se}})}catch{return console.warn("TrustedTypes policy "+Y+" could not be created."),null}},U=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function ae(){let M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:z();const J=Re=>ae(Re);if(J.version="3.3.0",J.removed=[],!M||!M.document||M.document.nodeType!==re.document||!M.Element)return J.isSupported=!1,J;let{document:de}=M;const ie=de,A=ie.currentScript,{DocumentFragment:Y,HTMLTemplateElement:se,Node:we,Element:ne,NodeFilter:Se,NamedNodeMap:ke=M.NamedNodeMap||M.MozNamedAttrMap,HTMLFormElement:Ce,DOMParser:xe,trustedTypes:Ye}=M,Ke=ne.prototype,ft=F(Ke,"cloneNode"),ut=F(Ke,"remove"),We=F(Ke,"nextSibling"),nt=F(Ke,"childNodes"),ht=F(Ke,"parentNode");if(typeof se=="function"){const Re=de.createElement("template");Re.content&&Re.content.ownerDocument&&(de=Re.content.ownerDocument)}let tt,ct="";const{implementation:Mt,createNodeIterator:Br,createDocumentFragment:In,getElementsByTagName:Dn}=de,{importNode:zn}=ie;let Nt=U();J.isSupported=typeof t=="function"&&typeof ht=="function"&&Mt&&Mt.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:Cr,ERB_EXPR:Kt,TMPLIT_EXPR:mr,DATA_ATTR:lr,ARIA_ATTR:Ht,IS_SCRIPT_OR_DATA:tr,ATTR_WHITESPACE:Qr,CUSTOM_ELEMENT:Fn}=ce;let{IS_ALLOWED_URI:Er}=ce,_t=null;const xn=O({},[...S,...K,...le,...I,...Z]);let pt=null;const $t=O({},[...H,...G,...ee,...oe]);let et=Object.seal(l(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),at=null,Ut=null;const rt=Object.seal(l(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let Hr=!0,bn=!0,ks=!1,ci=!0,Tr=!1,wn=!0,gt=!1,Bn=!1,di=!1,Ur=!1,Hn=!1,Un=!1,js=!0,Wn=!1;const Zo="user-content-";let en=!0,_n=!1,tn={},rn=null;const Ui=O({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Wi=null;const Cs=O({},["audio","video","img","source","image","track"]);let ui=null;const Es=O({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Gn="http://www.w3.org/1998/Math/MathML",Sn="http://www.w3.org/2000/svg",gr="http://www.w3.org/1999/xhtml";let kn=gr,hi=!1,Gi=null;const Ts=O({},[Gn,Sn,gr],x);let jn=O({},["mi","mo","mn","ms","mtext"]),Wr=O({},["annotation-xml"]);const Jo=O({},["title","style","font","a","script"]);let Cn=null;const Ns=["application/xhtml+xml","text/html"],B="text/html";let te=null,W=null;const ve=de.createElement("form"),Xe=function(V){return V instanceof RegExp||V instanceof Function},Ae=function(){let V=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(W&&W===V)){if((!V||typeof V!="object")&&(V={}),V=E(V),Cn=Ns.indexOf(V.PARSER_MEDIA_TYPE)===-1?B:V.PARSER_MEDIA_TYPE,te=Cn==="application/xhtml+xml"?x:m,_t=k(V,"ALLOWED_TAGS")?O({},V.ALLOWED_TAGS,te):xn,pt=k(V,"ALLOWED_ATTR")?O({},V.ALLOWED_ATTR,te):$t,Gi=k(V,"ALLOWED_NAMESPACES")?O({},V.ALLOWED_NAMESPACES,x):Ts,ui=k(V,"ADD_URI_SAFE_ATTR")?O(E(Es),V.ADD_URI_SAFE_ATTR,te):Es,Wi=k(V,"ADD_DATA_URI_TAGS")?O(E(Cs),V.ADD_DATA_URI_TAGS,te):Cs,rn=k(V,"FORBID_CONTENTS")?O({},V.FORBID_CONTENTS,te):Ui,at=k(V,"FORBID_TAGS")?O({},V.FORBID_TAGS,te):E({}),Ut=k(V,"FORBID_ATTR")?O({},V.FORBID_ATTR,te):E({}),tn=k(V,"USE_PROFILES")?V.USE_PROFILES:!1,Hr=V.ALLOW_ARIA_ATTR!==!1,bn=V.ALLOW_DATA_ATTR!==!1,ks=V.ALLOW_UNKNOWN_PROTOCOLS||!1,ci=V.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Tr=V.SAFE_FOR_TEMPLATES||!1,wn=V.SAFE_FOR_XML!==!1,gt=V.WHOLE_DOCUMENT||!1,Ur=V.RETURN_DOM||!1,Hn=V.RETURN_DOM_FRAGMENT||!1,Un=V.RETURN_TRUSTED_TYPE||!1,di=V.FORCE_BODY||!1,js=V.SANITIZE_DOM!==!1,Wn=V.SANITIZE_NAMED_PROPS||!1,en=V.KEEP_CONTENT!==!1,_n=V.IN_PLACE||!1,Er=V.ALLOWED_URI_REGEXP||ge,kn=V.NAMESPACE||gr,jn=V.MATHML_TEXT_INTEGRATION_POINTS||jn,Wr=V.HTML_INTEGRATION_POINTS||Wr,et=V.CUSTOM_ELEMENT_HANDLING||{},V.CUSTOM_ELEMENT_HANDLING&&Xe(V.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(et.tagNameCheck=V.CUSTOM_ELEMENT_HANDLING.tagNameCheck),V.CUSTOM_ELEMENT_HANDLING&&Xe(V.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(et.attributeNameCheck=V.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),V.CUSTOM_ELEMENT_HANDLING&&typeof V.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(et.allowCustomizedBuiltInElements=V.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Tr&&(bn=!1),Hn&&(Ur=!0),tn&&(_t=O({},Z),pt=[],tn.html===!0&&(O(_t,S),O(pt,H)),tn.svg===!0&&(O(_t,K),O(pt,G),O(pt,oe)),tn.svgFilters===!0&&(O(_t,le),O(pt,G),O(pt,oe)),tn.mathMl===!0&&(O(_t,I),O(pt,ee),O(pt,oe))),V.ADD_TAGS&&(typeof V.ADD_TAGS=="function"?rt.tagCheck=V.ADD_TAGS:(_t===xn&&(_t=E(_t)),O(_t,V.ADD_TAGS,te))),V.ADD_ATTR&&(typeof V.ADD_ATTR=="function"?rt.attributeCheck=V.ADD_ATTR:(pt===$t&&(pt=E(pt)),O(pt,V.ADD_ATTR,te))),V.ADD_URI_SAFE_ATTR&&O(ui,V.ADD_URI_SAFE_ATTR,te),V.FORBID_CONTENTS&&(rn===Ui&&(rn=E(rn)),O(rn,V.FORBID_CONTENTS,te)),en&&(_t["#text"]=!0),gt&&O(_t,["html","head","body"]),_t.table&&(O(_t,["tbody"]),delete at.tbody),V.TRUSTED_TYPES_POLICY){if(typeof V.TRUSTED_TYPES_POLICY.createHTML!="function")throw C('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof V.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw C('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');tt=V.TRUSTED_TYPES_POLICY,ct=tt.createHTML("")}else tt===void 0&&(tt=R(Ye,A)),tt!==null&&typeof ct=="string"&&(ct=tt.createHTML(""));s&&s(V),W=V}},Ze=O({},[...K,...le,...D]),qe=O({},[...I,...L]),Pe=function(V){let pe=ht(V);(!pe||!pe.tagName)&&(pe={namespaceURI:kn,tagName:"template"});const _e=m(V.tagName),vt=m(pe.tagName);return Gi[V.namespaceURI]?V.namespaceURI===Sn?pe.namespaceURI===gr?_e==="svg":pe.namespaceURI===Gn?_e==="svg"&&(vt==="annotation-xml"||jn[vt]):!!Ze[_e]:V.namespaceURI===Gn?pe.namespaceURI===gr?_e==="math":pe.namespaceURI===Sn?_e==="math"&&Wr[vt]:!!qe[_e]:V.namespaceURI===gr?pe.namespaceURI===Sn&&!Wr[vt]||pe.namespaceURI===Gn&&!jn[vt]?!1:!qe[_e]&&(Jo[_e]||!Ze[_e]):!!(Cn==="application/xhtml+xml"&&Gi[V.namespaceURI]):!1},Ne=function(V){p(J.removed,{element:V});try{ht(V).removeChild(V)}catch{ut(V)}},Q=function(V,pe){try{p(J.removed,{attribute:pe.getAttributeNode(V),from:pe})}catch{p(J.removed,{attribute:null,from:pe})}if(pe.removeAttribute(V),V==="is")if(Ur||Hn)try{Ne(pe)}catch{}else try{pe.setAttribute(V,"")}catch{}},he=function(V){let pe=null,_e=null;if(di)V="<remove></remove>"+V;else{const zt=v(V,/^[\r\n\t ]+/);_e=zt&&zt[0]}Cn==="application/xhtml+xml"&&kn===gr&&(V='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+V+"</body></html>");const vt=tt?tt.createHTML(V):V;if(kn===gr)try{pe=new xe().parseFromString(vt,Cn)}catch{}if(!pe||!pe.documentElement){pe=Mt.createDocument(kn,"template",null);try{pe.documentElement.innerHTML=hi?ct:vt}catch{}}const Dt=pe.body||pe.documentElement;return V&&_e&&Dt.insertBefore(de.createTextNode(_e),Dt.childNodes[0]||null),kn===gr?Dn.call(pe,gt?"html":"body")[0]:gt?pe.documentElement:Dt},be=function(V){return Br.call(V.ownerDocument||V,V,Se.SHOW_ELEMENT|Se.SHOW_COMMENT|Se.SHOW_TEXT|Se.SHOW_PROCESSING_INSTRUCTION|Se.SHOW_CDATA_SECTION,null)},ye=function(V){return V instanceof Ce&&(typeof V.nodeName!="string"||typeof V.textContent!="string"||typeof V.removeChild!="function"||!(V.attributes instanceof ke)||typeof V.removeAttribute!="function"||typeof V.setAttribute!="function"||typeof V.namespaceURI!="string"||typeof V.insertBefore!="function"||typeof V.hasChildNodes!="function")},De=function(V){return typeof we=="function"&&V instanceof we};function Be(Re,V,pe){u(Re,_e=>{_e.call(J,V,pe,W)})}const Me=function(V){let pe=null;if(Be(Nt.beforeSanitizeElements,V,null),ye(V))return Ne(V),!0;const _e=te(V.nodeName);if(Be(Nt.uponSanitizeElement,V,{tagName:_e,allowedTags:_t}),wn&&V.hasChildNodes()&&!De(V.firstElementChild)&&_(/<[/\w!]/g,V.innerHTML)&&_(/<[/\w!]/g,V.textContent)||V.nodeType===re.progressingInstruction||wn&&V.nodeType===re.comment&&_(/<[/\w]/g,V.data))return Ne(V),!0;if(!(rt.tagCheck instanceof Function&&rt.tagCheck(_e))&&(!_t[_e]||at[_e])){if(!at[_e]&&Ue(_e)&&(et.tagNameCheck instanceof RegExp&&_(et.tagNameCheck,_e)||et.tagNameCheck instanceof Function&&et.tagNameCheck(_e)))return!1;if(en&&!rn[_e]){const vt=ht(V)||V.parentNode,Dt=nt(V)||V.childNodes;if(Dt&&vt){const zt=Dt.length;for(let vr=zt-1;vr>=0;--vr){const Vn=ft(Dt[vr],!0);Vn.__removalCount=(V.__removalCount||0)+1,vt.insertBefore(Vn,We(V))}}}return Ne(V),!0}return V instanceof ne&&!Pe(V)||(_e==="noscript"||_e==="noembed"||_e==="noframes")&&_(/<\/no(script|embed|frames)/i,V.innerHTML)?(Ne(V),!0):(Tr&&V.nodeType===re.text&&(pe=V.textContent,u([Cr,Kt,mr],vt=>{pe=y(pe,vt," ")}),V.textContent!==pe&&(p(J.removed,{element:V.cloneNode()}),V.textContent=pe)),Be(Nt.afterSanitizeElements,V,null),!1)},Ge=function(V,pe,_e){if(js&&(pe==="id"||pe==="name")&&(_e in de||_e in ve))return!1;if(!(bn&&!Ut[pe]&&_(lr,pe))){if(!(Hr&&_(Ht,pe))){if(!(rt.attributeCheck instanceof Function&&rt.attributeCheck(pe,V))){if(!pt[pe]||Ut[pe]){if(!(Ue(V)&&(et.tagNameCheck instanceof RegExp&&_(et.tagNameCheck,V)||et.tagNameCheck instanceof Function&&et.tagNameCheck(V))&&(et.attributeNameCheck instanceof RegExp&&_(et.attributeNameCheck,pe)||et.attributeNameCheck instanceof Function&&et.attributeNameCheck(pe,V))||pe==="is"&&et.allowCustomizedBuiltInElements&&(et.tagNameCheck instanceof RegExp&&_(et.tagNameCheck,_e)||et.tagNameCheck instanceof Function&&et.tagNameCheck(_e))))return!1}else if(!ui[pe]){if(!_(Er,y(_e,Qr,""))){if(!((pe==="src"||pe==="xlink:href"||pe==="href")&&V!=="script"&&b(_e,"data:")===0&&Wi[V])){if(!(ks&&!_(tr,y(_e,Qr,"")))){if(_e)return!1}}}}}}}return!0},Ue=function(V){return V!=="annotation-xml"&&v(V,Fn)},it=function(V){Be(Nt.beforeSanitizeAttributes,V,null);const{attributes:pe}=V;if(!pe||ye(V))return;const _e={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:pt,forceKeepAttr:void 0};let vt=pe.length;for(;vt--;){const Dt=pe[vt],{name:zt,namespaceURI:vr,value:Vn}=Dt,Rs=te(zt),Fd=Vn;let Zt=zt==="value"?Fd:w(Fd);if(_e.attrName=Rs,_e.attrValue=Zt,_e.keepAttr=!0,_e.forceKeepAttr=void 0,Be(Nt.uponSanitizeAttribute,V,_e),Zt=_e.attrValue,Wn&&(Rs==="id"||Rs==="name")&&(Q(zt,V),Zt=Zo+Zt),wn&&_(/((--!?|])>)|<\/(style|title|textarea)/i,Zt)){Q(zt,V);continue}if(Rs==="attributename"&&v(Zt,"href")){Q(zt,V);continue}if(_e.forceKeepAttr)continue;if(!_e.keepAttr){Q(zt,V);continue}if(!ci&&_(/\/>/i,Zt)){Q(zt,V);continue}Tr&&u([Cr,Kt,mr],vm=>{Zt=y(Zt,vm," ")});const gm=te(V.nodeName);if(!Ge(gm,Rs,Zt)){Q(zt,V);continue}if(tt&&typeof Ye=="object"&&typeof Ye.getAttributeType=="function"&&!vr)switch(Ye.getAttributeType(gm,Rs)){case"TrustedHTML":{Zt=tt.createHTML(Zt);break}case"TrustedScriptURL":{Zt=tt.createScriptURL(Zt);break}}if(Zt!==Fd)try{vr?V.setAttributeNS(vr,zt,Zt):V.setAttribute(zt,Zt),ye(V)?Ne(V):h(J.removed)}catch{Q(zt,V)}}Be(Nt.afterSanitizeAttributes,V,null)},mt=function Re(V){let pe=null;const _e=be(V);for(Be(Nt.beforeSanitizeShadowDOM,V,null);pe=_e.nextNode();)Be(Nt.uponSanitizeShadowNode,pe,null),Me(pe),it(pe),pe.content instanceof Y&&Re(pe.content);Be(Nt.afterSanitizeShadowDOM,V,null)};return J.sanitize=function(Re){let V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},pe=null,_e=null,vt=null,Dt=null;if(hi=!Re,hi&&(Re="<!-->"),typeof Re!="string"&&!De(Re))if(typeof Re.toString=="function"){if(Re=Re.toString(),typeof Re!="string")throw C("dirty is not a string, aborting")}else throw C("toString is not a function");if(!J.isSupported)return Re;if(Bn||Ae(V),J.removed=[],typeof Re=="string"&&(_n=!1),_n){if(Re.nodeName){const Vn=te(Re.nodeName);if(!_t[Vn]||at[Vn])throw C("root node is forbidden and cannot be sanitized in-place")}}else if(Re instanceof we)pe=he("<!---->"),_e=pe.ownerDocument.importNode(Re,!0),_e.nodeType===re.element&&_e.nodeName==="BODY"||_e.nodeName==="HTML"?pe=_e:pe.appendChild(_e);else{if(!Ur&&!Tr&&!gt&&Re.indexOf("<")===-1)return tt&&Un?tt.createHTML(Re):Re;if(pe=he(Re),!pe)return Ur?null:Un?ct:""}pe&&di&&Ne(pe.firstChild);const zt=be(_n?Re:pe);for(;vt=zt.nextNode();)Me(vt),it(vt),vt.content instanceof Y&&mt(vt.content);if(_n)return Re;if(Ur){if(Hn)for(Dt=In.call(pe.ownerDocument);pe.firstChild;)Dt.appendChild(pe.firstChild);else Dt=pe;return(pt.shadowroot||pt.shadowrootmode)&&(Dt=zn.call(ie,Dt,!0)),Dt}let vr=gt?pe.outerHTML:pe.innerHTML;return gt&&_t["!doctype"]&&pe.ownerDocument&&pe.ownerDocument.doctype&&pe.ownerDocument.doctype.name&&_(ue,pe.ownerDocument.doctype.name)&&(vr="<!DOCTYPE "+pe.ownerDocument.doctype.name+`>
`+vr),Tr&&u([Cr,Kt,mr],Vn=>{vr=y(vr,Vn," ")}),tt&&Un?tt.createHTML(vr):vr},J.setConfig=function(){let Re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ae(Re),Bn=!0},J.clearConfig=function(){W=null,Bn=!1},J.isValidAttribute=function(Re,V,pe){W||Ae({});const _e=te(Re),vt=te(V);return Ge(_e,vt,pe)},J.addHook=function(Re,V){typeof V=="function"&&p(Nt[Re],V)},J.removeHook=function(Re,V){if(V!==void 0){const pe=f(Nt[Re],V);return pe===-1?void 0:g(Nt[Re],pe,1)[0]}return h(Nt[Re])},J.removeHooks=function(Re){Nt[Re]=[]},J.removeAllHooks=function(){Nt=U()},J}var q=ae();return Tu=q,Tu}var w5=self.DOMPurify||(self.DOMPurify=v0().default||v0());const _5=id(w5);function yp(t,e={}){if(!t||typeof t!="string")return console.warn("[SVG-SANITIZE] Invalid input:",typeof t),"";const r={USE_PROFILES:{svg:!0,svgFilters:!0},FORBID_TAGS:["script","foreignObject","iframe","embed"],FORBID_ATTR:["onload","onerror","onclick","onmouseover","onmouseout","onmouseenter","onmouseleave","onmousemove","onmousedown","onmouseup","onfocus","onblur","onkeydown","onkeyup","onkeypress","onsubmit","onreset","onselect","onchange","oninput","onanimationstart","onanimationend","onanimationiteration","ontransitionend","ontransitionrun","ontransitionstart","ontransitioncancel","xlink:href",...e.additionalForbiddenAttrs||[]],ALLOW_DATA_ATTR:!0,ALLOW_COMMENTS:!1,RETURN_DOM:!1,RETURN_DOM_FRAGMENT:!1,ALLOWED_URI_REGEXP:/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,HOOKS:{afterSanitizeAttributes:n=>{if(n.hasAttribute("href")){const i=n.getAttribute("href");i&&i.toLowerCase().trim().startsWith("javascript:")&&(n.removeAttribute("href"),console.warn("[SVG-SANITIZE] Removed javascript: href"))}if(n.hasAttribute("xlink:href")){const i=n.getAttribute("xlink:href");i&&(i.toLowerCase().trim().startsWith("javascript:")||i.toLowerCase().trim().startsWith("data:text/html"))&&(n.removeAttribute("xlink:href"),console.warn("[SVG-SANITIZE] Removed dangerous xlink:href"))}}},...e};try{const n=_5.sanitize(t,r);if(!n||!n.includes("<svg"))return console.error("[SVG-SANITIZE] Sanitization removed SVG content - input may be malicious"),"";const i=t.length,s=n.length,o=(i-s)/i*100;return o>10&&console.warn(`[SVG-SANITIZE] Removed ${o.toFixed(1)}% of content (${i-s} chars) - possible malicious SVG detected`),n}catch(n){return console.error("[SVG-SANITIZE] Sanitization failed:",n),""}}function S5(t){if(!t||typeof t!="string")return!1;const e=t.toLowerCase(),r=["<script","javascript:","onload=","onerror=","onclick=","onmouseover=","<foreignobject","<iframe","<embed","data:text/html"];for(const n of r)if(e.includes(n))return console.warn(`[SVG-VALIDATE] Dangerous pattern detected: ${n}`),!1;return e.includes("<svg")?!0:(console.warn("[SVG-VALIDATE] Content does not appear to be valid SVG (no <svg> tag found)"),!1)}function k5(t){const e=new Map;for(const r of t){const n=r.originalColor.hex.toLowerCase(),i=r.targetColor.hex.toLowerCase(),s=r.chosenRecipe.id,o=r.chosenRecipe.deltaE,l=r.targetColor.areaPct;e.set(n,{blendHex:i,recipeId:s,deltaE:o,coverage:l,quality:r.chosenRecipe.quality,components:r.chosenRecipe.components})}return e}function j5(t){return t.replace("#","").toLowerCase()}async function vi(t,e,r=null){try{let n;if(r)n=r,console.log(`[SVG-RECOLOR] Using provided SVG text (${n.length} chars)`);else{console.log("[SVG-RECOLOR] Fetching SVG from:",t);const g=await fetch(t);if(!g.ok)throw new Error(`Failed to fetch SVG: ${g.status} ${g.statusText}`);n=await g.text(),console.log(`[SVG-RECOLOR] Fetched SVG (${n.length} chars)`)}console.log("[SVG-RECOLOR] Sanitizing SVG...");const i=yp(n);if(!i)throw new Error("SVG sanitization failed - content rejected");const o=new DOMParser().parseFromString(i,"image/svg+xml"),l=o.querySelector("parsererror");if(l)throw new Error(`SVG parse error: ${l.textContent}`);const c=o.documentElement;if(c.tagName!=="svg")throw new Error("Invalid SVG: root element is not <svg>");const d=C5(c,e);console.log("[SVG-RECOLOR] Recoloring complete:",d);const f=new XMLSerializer().serializeToString(o),h=new Blob([f],{type:"image/svg+xml"});return{dataUrl:URL.createObjectURL(h),svgText:f,stats:d}}catch(n){throw console.error("[SVG-RECOLOR] Error:",n),n}}function C5(t,e){const r={totalElements:0,fillsReplaced:0,strokesReplaced:0,stopColorsReplaced:0,stylesProcessed:0,colorsNotMapped:new Set},n=t.querySelectorAll("*");r.totalElements=n.length;for(const o of n){const l=o.getAttribute("fill");if(l&&l!=="none"){const f=On(l,e,r.colorsNotMapped);f!==l&&(f==="transparent"||f==="none"?(o.setAttribute("fill","none"),o.setAttribute("fill-opacity","0")):o.setAttribute("fill",f),r.fillsReplaced++)}const c=o.getAttribute("stroke");if(c&&c!=="none"){const f=On(c,e,r.colorsNotMapped);f!==c&&(f==="transparent"||f==="none"?(o.setAttribute("stroke","none"),o.setAttribute("stroke-opacity","0")):o.setAttribute("stroke",f),r.strokesReplaced++)}const d=o.getAttribute("stop-color");if(d&&d!=="none"){const f=On(d,e,r.colorsNotMapped);f!==d&&(o.setAttribute("stop-color",f),r.stopColorsReplaced++)}const u=o.getAttribute("style");if(u){const f=b0(u,e,r);f!==u&&(o.setAttribute("style",f),r.stylesProcessed++)}}const i=t.querySelectorAll("style");for(const o of i){const l=o.textContent,c=T5(l,e,r);c!==l&&(o.textContent=c,r.stylesProcessed++)}const s=t.querySelectorAll("stop");for(const o of s){const l=o.getAttribute("stop-color");if(l&&l!=="none"){const d=On(l,e,r.colorsNotMapped);d!==l&&(o.setAttribute("stop-color",d),r.stopColorsReplaced++)}const c=o.getAttribute("style");if(c&&c.includes("stop-color")){const d=b0(c,e,r);d!==c&&(o.setAttribute("style",d),r.stylesProcessed++)}}return r}function On(t,e,r){const n=N5(t);if(!n)return t;const i=`#${n}`,s=e.get(i);if(s)return s.blendHex;const o=y0(n);if(!o)return t;const l=x0(o);let c=null,d=1/0;for(const[u,f]of e.entries()){const h=y0(u.replace("#",""));if(!h)continue;const p=x0(h),g=E5(l,p);if(g<d&&(d=g,c=f),g<=9)return console.log(`[SVG-RECOLOR] Tolerance match: ${i}  ${u} (E=${g.toFixed(2)})`),f.blendHex}return c?(console.log(`[SVG-RECOLOR] Fallback to nearest: ${i}  ${c.blendHex} (E=${d.toFixed(2)})`),r&&r.add(t),c.blendHex):(console.warn(`[SVG-RECOLOR] No mapping found: ${i}`),t)}function y0(t){if(t.length!==6)return null;const e=parseInt(t.substring(0,2),16),r=parseInt(t.substring(2,4),16),n=parseInt(t.substring(4,6),16);return isNaN(e)||isNaN(r)||isNaN(n)?null:{r:e,g:r,b:n}}function x0(t){let e=t.r/255,r=t.g/255,n=t.b/255;e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92,r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92,n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92;const i=(e*.4124+r*.3576+n*.1805)*100,s=(e*.2126+r*.7152+n*.0722)*100,o=(e*.0193+r*.1192+n*.9505)*100,l=95.047,c=100,d=108.883;let u=i/l,f=s/c,h=o/d;return u=u>.008856?Math.pow(u,1/3):7.787*u+16/116,f=f>.008856?Math.pow(f,1/3):7.787*f+16/116,h=h>.008856?Math.pow(h,1/3):7.787*h+16/116,{L:116*f-16,a:500*(u-f),b:200*(f-h)}}function E5(t,e){const s=Math.PI*2,o=Math.PI,l=(t.L+e.L)/2,c=Math.sqrt(t.a*t.a+t.b*t.b),d=Math.sqrt(e.a*e.a+e.b*e.b),u=(c+d)/2,f=.5*(1-Math.sqrt(Math.pow(u,7)/(Math.pow(u,7)+Math.pow(25,7)))),h=t.a*(1+f),p=e.a*(1+f),g=Math.sqrt(h*h+t.b*t.b),m=Math.sqrt(p*p+e.b*e.b),x=(g+m)/2;let v=Math.atan2(t.b,h);v<0&&(v+=s);let y=Math.atan2(e.b,p);y<0&&(y+=s);const b=Math.abs(v-y)>o?(v+y+s)/2:(v+y)/2,w=1-.17*Math.cos(b-Math.PI/6)+.24*Math.cos(2*b)+.32*Math.cos(3*b+Math.PI/30)-.2*Math.cos(4*b-63*Math.PI/180);let k=y-v;Math.abs(k)>o&&(k=k>0?k-s:k+s);const _=e.L-t.L,C=m-g,N=2*Math.sqrt(g*m)*Math.sin(k/2),T=1+.015*Math.pow(l-50,2)/Math.sqrt(20+Math.pow(l-50,2)),O=1+.045*x,X=1+.015*x*w,E=30*Math.PI/180*Math.exp(-Math.pow((b-275*Math.PI/180)/(25*Math.PI/180),2)),S=-(2*Math.sqrt(Math.pow(x,7)/(Math.pow(x,7)+Math.pow(25,7))))*Math.sin(2*E);return Math.sqrt(Math.pow(_/(1*T),2)+Math.pow(C/(1*O),2)+Math.pow(N/(1*X),2)+S*(C/(1*O))*(N/(1*X)))}function b0(t,e,r){let n=t;return n=n.replace(/fill:\s*([^;]+)/gi,(i,s)=>`fill: ${On(s.trim(),e,r.colorsNotMapped)}`),n=n.replace(/stroke:\s*([^;]+)/gi,(i,s)=>`stroke: ${On(s.trim(),e,r.colorsNotMapped)}`),n=n.replace(/stop-color:\s*([^;]+)/gi,(i,s)=>`stop-color: ${On(s.trim(),e,r.colorsNotMapped)}`),n}function T5(t,e,r){let n=t,i=0;return n=n.replace(/fill:\s*([^;}\s]+)/gi,(s,o)=>{const l=o.trim(),c=On(l,e,r.colorsNotMapped);return c!==l&&(i++,console.log(`[SVG-RECOLOR-CSS] Replaced fill: ${l}  ${c}`)),`fill: ${c}`}),n=n.replace(/stroke:\s*([^;}\s]+)/gi,(s,o)=>{const l=o.trim(),c=On(l,e,r.colorsNotMapped);return c!==l&&(i++,console.log(`[SVG-RECOLOR-CSS] Replaced stroke: ${l}  ${c}`)),`stroke: ${c}`}),n=n.replace(/stop-color:\s*([^;}\s]+)/gi,(s,o)=>{const l=o.trim(),c=On(l,e,r.colorsNotMapped);return c!==l&&(i++,console.log(`[SVG-RECOLOR-CSS] Replaced stop-color: ${l}  ${c}`)),`stop-color: ${c}`}),i>0&&console.log(`[SVG-RECOLOR-CSS] Total CSS color replacements: ${i}`),n}function N5(t){const e=t.trim().toLowerCase();if(e.match(/^#?[0-9a-f]{6}$/))return j5(e);const r=e.match(/^#?([0-9a-f]{3})$/);if(r)return r[1].split("").map(o=>o+o).join("");const n=e.match(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/);if(n){const s=parseInt(n[1],10),o=parseInt(n[2],10),l=parseInt(n[3],10);return R5(s,o,l)}const i={white:"ffffff",black:"000000",red:"ff0000",green:"008000",blue:"0000ff",yellow:"ffff00",cyan:"00ffff",magenta:"ff00ff",gray:"808080",grey:"808080",orange:"ffa500",purple:"800080"};return i[e]?i[e]:null}function R5(t,e,r){const n=i=>Math.max(0,Math.min(255,i)).toString(16).padStart(2,"0");return`${n(t)}${n(e)}${n(r)}`}function Co(t){const r=new DOMParser().parseFromString(t,"image/svg+xml"),n=r.querySelector("parsererror");if(n)return console.error("[SVG-REGION-TAGGER] Parse error:",n.textContent),t;const i=r.documentElement;if(!i.hasAttribute("viewBox")){const l=i.getAttribute("width"),c=i.getAttribute("height");if(l&&c){const d=parseFloat(l),u=parseFloat(c);!isNaN(d)&&!isNaN(u)&&(i.setAttribute("viewBox",`0 0 ${d} ${u}`),console.log(`[SVG-REGION-TAGGER] Added viewBox from dimensions: 0 0 ${d} ${u}`))}else{const d=P5(r);d&&(i.setAttribute("viewBox",`${d.x} ${d.y} ${d.width} ${d.height}`),console.log(`[SVG-REGION-TAGGER] Added viewBox from content bounds: ${d.x} ${d.y} ${d.width} ${d.height}`))}}let s=0;return r.querySelectorAll("path, rect, circle, ellipse, polygon, polyline, line").forEach(l=>{l.hasAttribute("data-region-id")||l.setAttribute("data-region-id",`region-${s++}`)}),console.log(`[SVG-REGION-TAGGER] Tagged ${s} regions`),new XMLSerializer().serializeToString(r)}function P5(t){try{const e=t.documentElement.cloneNode(!0),r=document.createElement("div");r.style.position="absolute",r.style.visibility="hidden",document.body.appendChild(r),r.appendChild(e);const n=e.getBBox();if(document.body.removeChild(r),n.width>0&&n.height>0)return{x:Math.floor(n.x),y:Math.floor(n.y),width:Math.ceil(n.width),height:Math.ceil(n.height)}}catch(e){console.warn("[SVG-REGION-TAGGER] Could not calculate content bounds:",e)}return null}function vo(t,e){if(!e||e.size===0)return t;const n=new DOMParser().parseFromString(t,"image/svg+xml"),i=n.querySelector("parsererror");if(i)return console.error("[SVG-REGION-OVERRIDES] Parse error:",i.textContent),t;let s=0;return e.forEach((o,l)=>{const c=n.querySelector(`[data-region-id="${l}"]`);if(c){const d=o==="transparent"||o==="none";if((c.hasAttribute("fill")||d)&&(d?(c.setAttribute("fill","none"),c.setAttribute("fill-opacity","0")):(c.setAttribute("fill",o),c.removeAttribute("fill-opacity")),s++),c.hasAttribute("stroke")&&c.getAttribute("stroke")!=="none"){const f=c.getAttribute("stroke");f&&f!=="#000"&&f!=="#000000"&&f!=="#fff"&&f!=="#ffffff"&&(d?(c.setAttribute("stroke","none"),c.setAttribute("stroke-opacity","0")):c.setAttribute("stroke",o))}const u=c.getAttribute("style");if(u&&u.includes("fill:"))if(d){const f=u.replace(/fill:\s*[^;]+/,"fill: none");c.setAttribute("style",f)}else{const f=u.replace(/fill:\s*[^;]+/,`fill: ${o}`);c.setAttribute("style",f)}}else console.warn(`[SVG-REGION-OVERRIDES] Region not found: ${l}`)}),console.log(`[SVG-REGION-OVERRIDES] Applied ${s} region overrides`),new XMLSerializer().serializeToString(n)}async function Fw(t){var v,y;const e=await cl(t),r=(e==null?void 0:e.design)||e;if(!r)throw new Error("Design not found");if(r.input_mode==="sports_surface")throw new Error("Cannot use a sports surface design as a motif");const n=r.original_svg_url;if(!n||n.startsWith("blob:"))throw new Error("Design does not have a valid original SVG. Please ensure the design was saved after generation.");if(!r.solid_color_mapping&&!r.color_mapping)throw new Error("Design does not have color mappings. Please ensure the design was saved after color mapping.");console.log("[MOTIF] Fetching original SVG from:",n);const i=((v=r.design_data)==null?void 0:v.region_overrides)||r.region_overrides||null,s=((y=r.design_data)==null?void 0:y.original_tagged_svg)||r.original_tagged_svg||null;console.log("[MOTIF] Region overrides:",i?Object.keys(i).length:0,"regions"),console.log("[MOTIF] Original tagged SVG:",s?"present":"not present");const o=i?new Map(Object.entries(i)):null,l=await O5(n);if(!l)throw new Error("Failed to load or sanitize the original SVG.");console.log("[MOTIF] Original SVG loaded, regenerating recolored versions...");let c=null,d=null;if(r.solid_color_mapping&&Object.keys(r.solid_color_mapping).length>0)try{const b=w0(r.solid_color_mapping);console.log("[MOTIF] Solid mapping has",b.size,"colors");const{svgText:w}=await vi(null,b,l);if(c=w,console.log("[MOTIF] Generated solid SVG:",c.length,"chars"),o&&o.size>0&&c){console.log("[MOTIF] Applying",o.size,"region overrides to solid SVG");let k=c;k=Co(c),c=vo(k,o),console.log("[MOTIF] Applied region overrides to solid SVG")}}catch(b){console.error("[MOTIF] Failed to generate solid SVG:",b)}if(r.color_mapping&&Object.keys(r.color_mapping).length>0)try{const b=w0(r.color_mapping);console.log("[MOTIF] Blend mapping has",b.size,"colors");const{svgText:w}=await vi(null,b,l);if(d=w,console.log("[MOTIF] Generated blend SVG:",d.length,"chars"),o&&o.size>0&&d){console.log("[MOTIF] Applying",o.size,"region overrides to blend SVG");let k=Co(d);d=vo(k,o),console.log("[MOTIF] Applied region overrides to blend SVG")}}catch(b){console.error("[MOTIF] Failed to generate blend SVG:",b)}if(!c&&!d)throw new Error("Failed to regenerate TPV-recolored SVG versions.");const u=r.dimensions||{};let f=u.widthMM||u.width_mm||5e3,h=u.lengthMM||u.length_mm||5e3;const p=f===5e3&&h===5e3,g=c||d;if(g){const b=xp(g);if(b&&b.width&&b.height){const w=b.width/b.height;(p||Math.abs(w-1)>.01)&&(w>1?(f=5e3,h=Math.round(5e3/w)):w<1&&(h=5e3,f=Math.round(5e3*w)),console.log("[MOTIF] Corrected dimensions from SVG viewBox:",f,"x",h,"mm (aspect ratio:",w.toFixed(3),")"))}}const m=r.thumbnail_url||r.original_png_url||null,x=c&&d;return{sourceDesignId:t,sourceDesignName:r.name||"Unnamed Design",sourceThumbnailUrl:m,solidSvgContent:c,blendSvgContent:d,svgContent:c||d,hasBothVersions:x,originalWidth_mm:f,originalHeight_mm:h}}function w0(t){const e=new Map;if(!t||typeof t!="object")return e;for(const[r,n]of Object.entries(t)){const i=r.startsWith("#")?r:`#${r}`;e.set(i,n)}return e}async function O5(t){try{console.log("[MOTIF] Fetching SVG from:",t);const e=await fetch(t);if(!e.ok)return console.error("[MOTIF] Failed to fetch SVG:",e.status,e.statusText),null;const r=await e.text();if(console.log("[MOTIF] Fetched content length:",r.length,"chars"),console.log("[MOTIF] Content starts with:",r.substring(0,100)),!S5(r))return console.error("[MOTIF] SVG failed quick validation"),null;const n=yp(r);return n?(console.log("[MOTIF] Sanitized SVG length:",n.length,"chars"),n):(console.error("[MOTIF] SVG sanitization failed"),null)}catch(e){return console.error("[MOTIF] Error fetching SVG:",e),null}}async function Bw(t={}){const e=await Wc(t);return{designs:(e.designs||[]).filter(n=>n.input_mode==="sports_surface"?!1:n.thumbnail_url||n.original_svg_url||n.original_png_url),pagination:e.pagination}}function xp(t){if(!t)return null;const e=t.match(/viewBox=["']([^"']+)["']/i);if(e){const i=e[1].split(/\s+/).map(Number);if(i.length>=4)return{width:i[2],height:i[3]}}const r=t.match(/\bwidth=["']?(\d+(?:\.\d+)?)/i),n=t.match(/\bheight=["']?(\d+(?:\.\d+)?)/i);return r&&n?{width:parseFloat(r[1]),height:parseFloat(n[1])}:null}const A5=Object.freeze(Object.defineProperty({__proto__:null,extractSVGDimensions:xp,fetchMotifFromDesign:Fw,listPlaygroundDesigns:Bw},Symbol.toStringTag,{value:"Module"}));function _0({onOpenGenerator:t,mobileMode:e=!1,activeTab:r,onItemAdded:n}){const[i,s]=P.useState(null),[o,l]=P.useState("courts"),c=e?r:o,d=e?()=>{}:l,[u,f]=P.useState([]),[h,p]=P.useState(!1),[g,m]=P.useState(null),[x,v]=P.useState(null),{addCourt:y,addTrack:b,addMotif:w,addShape:k,courts:_,tracks:C,motifs:N,shapes:T}=st(),O=Object.keys(_).length,X=Object.keys(C).length,E=Object.keys(N).length,F=RC(),S=x5();P.useEffect(()=>{c==="designs"&&u.length===0&&!h&&K()},[c]);const K=async()=>{p(!0),m(null);try{const ee=await Bw({limit:50});f(ee.designs||[])}catch(ee){console.error("[MOTIFS] Failed to load designs:",ee),m(ee.message||"Failed to load designs")}finally{p(!1)}},le=ee=>{const oe=PC(ee);oe&&(y(ee,oe),e&&n&&n())},D=ee=>{const oe=b5(ee);oe&&(b(ee,oe),e&&n&&n())},I=async ee=>{if(!x){v(ee);try{const oe=await Fw(ee);w(oe.sourceDesignId,oe.sourceDesignName,oe.svgContent,oe.originalWidth_mm,oe.originalHeight_mm,oe.sourceThumbnailUrl,{solidSvgContent:oe.solidSvgContent,blendSvgContent:oe.blendSvgContent,hasBothVersions:oe.hasBothVersions}),e&&n&&n()}catch(oe){console.error("[MOTIFS] Failed to add motif:",oe),alert(`Failed to add motif: ${oe.message}`)}finally{v(null)}}},L=[{id:"rectangle",name:"Rectangle",icon:""},{id:"square",name:"Square",icon:""},{id:"circle",name:"Circle",icon:""},{id:"triangle",name:"Triangle",icon:""},{id:"pentagon",name:"Pentagon",icon:""},{id:"hexagon",name:"Hexagon",icon:""},{id:"blob",name:"Blob",icon:""}],Z=Object.keys(T||{}).length,G=(()=>{switch(c){case"courts":return{title:"Courts",count:O,hint:"Select a court to add"};case"tracks":return{title:"Tracks",count:X,hint:"Select a track to add"};case"shapes":return{title:"Shapes",count:Z,hint:"Tap a shape to add it"};case"designs":return{title:"Designs",count:E,hint:"Add your saved designs as motifs"};default:return{title:"Library",count:0,hint:""}}})();return a.jsxs("div",{className:`court-library ${e?"court-library--mobile":""}`,children:[!e&&a.jsxs("div",{className:"court-library__header",children:[a.jsxs("div",{className:"court-library__header-row",children:[a.jsx("h2",{children:G.title}),a.jsxs("span",{className:"court-library__count",children:[G.count," on canvas"]})]}),a.jsx("p",{children:G.hint})]}),!e&&a.jsxs("div",{className:"court-library__tabs",children:[a.jsx("button",{className:`court-library__tab ${c==="courts"?"court-library__tab--active":""}`,onClick:()=>{d("courts"),s(null)},children:"Courts"}),a.jsx("button",{className:`court-library__tab ${c==="tracks"?"court-library__tab--active":""}`,onClick:()=>{d("tracks"),s(null)},children:"Tracks"}),a.jsx("button",{className:`court-library__tab ${c==="designs"?"court-library__tab--active":""}`,onClick:()=>{d("designs"),s(null)},children:"Designs"})]}),a.jsxs("div",{className:`court-library__list ${e?"court-library__list--mobile":""}`,children:[c==="courts"&&F.map(ee=>a.jsxs("div",{className:`court-library__item ${i===ee.id?"court-library__item--selected":""}`,onClick:()=>e?le(ee.id):s(ee.id),onDoubleClick:()=>!e&&le(ee.id),children:[a.jsx("div",{className:"court-library__preview",children:a.jsx(M5,{template:ee})}),a.jsxs("div",{className:"court-library__info",children:[a.jsx("div",{className:"court-library__name",children:ee.name}),a.jsxs("div",{className:"court-library__dimensions",children:[(ee.dimensions.width_mm/1e3).toFixed(1),"m  ",(ee.dimensions.length_mm/1e3).toFixed(1),"m"]}),a.jsx("div",{className:"court-library__standard",children:ee.standard})]}),i===ee.id&&a.jsx("button",{className:"court-library__add-btn",onClick:oe=>{oe.stopPropagation(),le(ee.id)},children:"+ ADD"})]},ee.id)),c==="tracks"&&S.map(ee=>a.jsxs("div",{className:`court-library__item ${i===ee.id?"court-library__item--selected":""}`,onClick:()=>e?D(ee.id):s(ee.id),onDoubleClick:()=>!e&&D(ee.id),children:[a.jsx("div",{className:"court-library__preview",children:a.jsx(L5,{template:ee})}),a.jsxs("div",{className:"court-library__info",children:[a.jsx("div",{className:"court-library__name",children:ee.name}),a.jsxs("div",{className:"court-library__standard",children:[ee.parameters.numLanes," Lanes  ",ee.standard]}),a.jsx("div",{className:"court-library__note",children:"Scales to fit canvas"})]}),i===ee.id&&a.jsx("button",{className:"court-library__add-btn",onClick:oe=>{oe.stopPropagation(),D(ee.id)},children:"+ ADD"})]},ee.id)),c==="shapes"&&a.jsx("div",{className:`court-library__shapes-grid ${e?"court-library__shapes-grid--mobile":""}`,children:L.map(ee=>a.jsxs("button",{className:"court-library__shape-btn",onClick:()=>{k(ee.id),e&&n&&n()},children:[a.jsx("span",{className:"court-library__shape-icon",children:ee.icon}),a.jsx("span",{className:"court-library__shape-name",children:ee.name})]},ee.id))}),c==="designs"&&a.jsxs(a.Fragment,{children:[h&&a.jsxs("div",{className:"court-library__loading",children:[a.jsx("div",{className:"court-library__spinner"}),a.jsx("p",{children:"Loading your designs..."})]}),g&&a.jsxs("div",{className:"court-library__error",children:[a.jsx("p",{children:g}),a.jsx("button",{onClick:K,children:"Try Again"})]}),!h&&!g&&u.length===0&&a.jsxs("div",{className:"court-library__empty",children:[a.jsx("p",{children:"No designs found."}),a.jsx("p",{className:"court-library__empty-hint",children:"Generate new designs or save them to use as motifs."})]}),!h&&u.map(ee=>{var oe,fe;return a.jsxs("div",{className:`court-library__item ${i===ee.id?"court-library__item--selected":""} ${x===ee.id?"court-library__item--loading":""}`,onClick:()=>e?I(ee.id):s(ee.id),onDoubleClick:()=>!e&&I(ee.id),children:[a.jsx("div",{className:"court-library__preview",children:a.jsx(I5,{design:ee})}),a.jsxs("div",{className:"court-library__info",children:[a.jsx("div",{className:"court-library__name",children:ee.name||"Unnamed Design"}),a.jsxs("div",{className:"court-library__dimensions",children:[((((oe=ee.design_data)==null?void 0:oe.widthMM)||5e3)/1e3).toFixed(1),"m  ",((((fe=ee.design_data)==null?void 0:fe.lengthMM)||5e3)/1e3).toFixed(1),"m"]}),a.jsx("div",{className:"court-library__note",children:"Playground Design"})]}),i===ee.id&&a.jsx("button",{className:"court-library__add-btn",onClick:Oe=>{Oe.stopPropagation(),I(ee.id)},disabled:x===ee.id,children:x===ee.id?"Adding...":"+ ADD"})]},ee.id)})]})]}),!e&&a.jsx("div",{className:"court-library__generate",children:a.jsxs("button",{className:"court-library__generate-btn",onClick:t,children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 5v14M5 12h14"})}),"Generate New Design"]})}),!e&&a.jsx("div",{className:"court-library__footer",children:a.jsxs("p",{className:"court-library__hint",children:[c==="courts"&&"Double-click a court to add it instantly",c==="tracks"&&"Double-click a track to add it instantly",c==="designs"&&"Double-click a design to add it as a motif"]})})]})}function M5({template:t}){const e=t.dimensions.width_mm,r=t.dimensions.length_mm,n=Math.min(62/e,62/r),i=e*n,s=r*n;return a.jsxs("svg",{width:"62",height:"62",viewBox:"0 0 62 62",className:"court-library__svg-preview",children:[a.jsx("rect",{x:(62-i)/2,y:(62-s)/2,width:i,height:s,fill:"#e5e7eb",stroke:"#9ca3af",strokeWidth:"1.5"}),t.markings.map((o,l)=>a.jsx($5,{marking:o,scale:n,offsetX:(62-i)/2,offsetY:(62-s)/2},l))]})}function $5({marking:t,scale:e,offsetX:r,offsetY:n}){const{type:i,params:s}=t;switch(i){case"line":return a.jsx("line",{x1:s.x1*e+r,y1:s.y1*e+n,x2:s.x2*e+r,y2:s.y2*e+n,stroke:"#1e293b",strokeWidth:"1.5"});case"rectangle":return a.jsx("rect",{x:s.x*e+r,y:s.y*e+n,width:s.width*e,height:s.height*e,stroke:"#1e293b",strokeWidth:"1.5",fill:"none"});case"circle":return a.jsx("circle",{cx:s.cx*e+r,cy:s.cy*e+n,r:s.radius*e,stroke:"#1e293b",strokeWidth:"1.5",fill:"none"});case"arc":{const{cx:o,cy:l,radius:c,startAngle:d,endAngle:u}=s,f=d*Math.PI/180,h=u*Math.PI/180,p=(o+c*Math.cos(f))*e+r,g=(l+c*Math.sin(f))*e+n,m=(o+c*Math.cos(h))*e+r,x=(l+c*Math.sin(h))*e+n,v=u-d>180?1:0,y=`M ${p} ${g} A ${c*e} ${c*e} 0 ${v} 1 ${m} ${x}`;return a.jsx("path",{d:y,stroke:"#1e293b",strokeWidth:"1.5",fill:"none"})}default:return null}}function L5({template:t}){const{parameters:e}=t,r=e.width_mm,n=e.height_mm,i=Math.min(58/r,58/n),s=r*i,o=n*i,l=e.numLanes,c=e.laneWidth_mm*i,d=e.cornerRadius,f=(d.topLeft+d.topRight+d.bottomLeft+d.bottomRight)/4*i,h=(62-s)/2,p=(62-o)/2;return a.jsxs("svg",{width:"62",height:"62",viewBox:"0 0 62 62",className:"court-library__svg-preview",children:[a.jsx("rect",{x:h,y:p,width:s,height:o,rx:f,fill:"#e5e7eb"}),Array.from({length:l}).map((g,m)=>{const x=m*c,v=Math.max(0,f-x);return a.jsx("rect",{x:h+x,y:p+x,width:Math.max(0,s-x*2),height:Math.max(0,o-x*2),rx:v,stroke:"#1e293b",strokeWidth:"1",fill:"none"},m)})]})}function I5({design:t}){const e=t.thumbnail_url||t.original_png_url;return e?a.jsx("img",{src:e,alt:t.name||"Design preview",className:"court-library__motif-img",style:{width:"62px",height:"62px",objectFit:"contain",borderRadius:"4px",backgroundColor:"#f3f4f6"},onError:r=>{r.target.style.display="none",r.target.nextSibling&&(r.target.nextSibling.style.display="flex")}}):a.jsx("div",{className:"court-library__motif-placeholder",style:{width:"62px",height:"62px",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#e5e7eb",borderRadius:"4px",color:"#9ca3af",fontSize:"10px",textAlign:"center"},children:"No Preview"})}function S0({onEditSourceDesign:t}){var Ie,Ee;const{courts:e,tracks:r,motifs:n,shapes:i,texts:s,selectedCourtId:o,selectedTrackId:l,selectedMotifId:c,selectedShapeId:d,selectedTextId:u,updateCourtPosition:f,updateCourtRotation:h,updateCourtScale:p,setLineColor:g,setZoneColor:m,setCourtSurfaceColor:x,resetCourtColors:v,removeCourt:y,removeTrack:b,removeMotif:w,updateMotifPosition:k,updateMotifRotation:_,updateMotifScale:C,updateTrackParameters:N,addToHistory:T}=st(),[O,X]=P.useState("transform"),[E,F]=P.useState(null);if(u){const ge=s[u];return ge?a.jsx(B5,{text:ge,textId:u}):null}if(d){const ge=i[d];return ge?a.jsx(F5,{shape:ge,shapeId:d}):null}if(c){const ge=n[c];return ge?a.jsx(z5,{motif:ge,motifId:c,onEditSourceDesign:t}):null}if(l){const ge=r[l];return ge?a.jsx(D5,{track:ge,trackId:l}):null}if(!o)return a.jsx("div",{className:"properties-panel properties-panel--empty",children:a.jsxs("div",{className:"properties-panel__empty-state",children:[a.jsx("p",{children:"No element selected"}),a.jsx("span",{className:"properties-panel__hint",children:"Click on a court, track, or motif to view and edit its properties"})]})});const S=e[o];if(!S)return null;const{position:K,rotation:le,scale:D,template:I,lineColorOverrides:L,zoneColorOverrides:Z}=S,H=(ge,me)=>{const He=parseFloat(me);isNaN(He)||f(o,{...K,[ge]:He})},G=ge=>{const me=parseFloat(ge);isNaN(me)||h(o,me)},ee=ge=>{const me=parseFloat(ge);isNaN(me)||me<=0||p(o,me)},oe=()=>{window.confirm(`Delete ${I.name}? This action cannot be undone.`)&&y(o)},fe=ge=>{if(!E)return;if(E.type==="courtSurface"&&ge===null){x(o,null),F(null);return}if(!ge)return;const me={tpv_code:ge.code,hex:ge.hex,name:ge.name};E.type==="line"?g(o,E.id,me):E.type==="zone"?m(o,E.id,me):E.type==="courtSurface"?x(o,me):E.type==="allLines"&&I.markings.forEach(He=>{g(o,He.id,me)}),F(null)},Oe=ge=>{const me=L[ge.id];if(me)return{code:me.tpv_code,hex:me.hex,name:me.name};const He=Sr.find(ue=>ue.code===I.defaultLineColor);return He?{code:He.code,hex:He.hex,name:He.name}:null},$e=ge=>{const me=Z[ge.id];if(me)return{code:me.tpv_code,hex:me.hex,name:me.name};const He=Sr.find(ue=>ue.code===ge.defaultColor);return He?{code:He.code,hex:He.hex,name:He.name}:null};return a.jsxs("div",{className:"properties-panel",children:[a.jsxs("div",{className:"properties-panel__header",children:[a.jsx("h3",{children:"Properties"}),a.jsxs("div",{className:"properties-panel__court-info",children:[a.jsx("span",{className:"court-name",children:I.name}),a.jsx("span",{className:"court-standard",children:I.standard})]})]}),a.jsxs("div",{className:"properties-panel__tabs",children:[a.jsx("button",{className:`tab ${O==="transform"?"tab--active":""}`,onClick:()=>X("transform"),children:"Transform"}),a.jsx("button",{className:`tab ${O==="lines"?"tab--active":""}`,onClick:()=>X("lines"),children:"Lines"}),a.jsx("button",{className:`tab ${O==="zones"?"tab--active":""}`,onClick:()=>X("zones"),children:"Zones"})]}),a.jsxs("div",{className:"properties-panel__content",children:[O==="transform"&&a.jsxs("div",{className:"properties-section",children:[a.jsx("div",{className:"properties-section__header",children:a.jsx("h4",{children:"Transform"})}),a.jsxs("div",{className:"property-group",children:[a.jsx("label",{children:"Position"}),a.jsxs("div",{className:"property-input-row",children:[a.jsxs("div",{className:"property-input-group",children:[a.jsx("span",{className:"property-label",children:"X"}),a.jsx("input",{type:"number",value:Math.round(K.x),onChange:ge=>H("x",ge.target.value),step:"100"}),a.jsx("span",{className:"property-unit",children:"mm"})]}),a.jsxs("div",{className:"property-input-group",children:[a.jsx("span",{className:"property-label",children:"Y"}),a.jsx("input",{type:"number",value:Math.round(K.y),onChange:ge=>H("y",ge.target.value),step:"100"}),a.jsx("span",{className:"property-unit",children:"mm"})]})]})]}),a.jsxs("div",{className:"property-group",children:[a.jsx("label",{children:"Rotation"}),a.jsxs("div",{className:"property-input-row",children:[a.jsx("input",{type:"range",min:"0",max:"360",value:le,onChange:ge=>G(ge.target.value),className:"property-slider"}),a.jsxs("div",{className:"property-input-group property-input-group--compact",children:[a.jsx("input",{type:"number",value:Math.round(le),onChange:ge=>G(ge.target.value),min:"0",max:"360"}),a.jsx("span",{className:"property-unit",children:""})]})]})]}),a.jsxs("div",{className:"property-group",children:[a.jsx("label",{children:"Scale"}),a.jsxs("div",{className:"property-input-row",children:[a.jsx("input",{type:"range",min:"0.5",max:"2.0",step:"0.1",value:D,onChange:ge=>ee(ge.target.value),className:"property-slider"}),a.jsxs("div",{className:"property-input-group property-input-group--compact",children:[a.jsx("input",{type:"number",value:D.toFixed(2),onChange:ge=>ee(ge.target.value),min:"0.5",max:"2.0",step:"0.1"}),a.jsx("span",{className:"property-unit",children:""})]})]})]}),a.jsxs("div",{className:"property-group property-group--info",children:[a.jsx("label",{children:"Dimensions"}),a.jsx("div",{className:"property-info",children:a.jsxs("span",{children:[(I.dimensions.width_mm*D/1e3).toFixed(1),"m  ",(I.dimensions.length_mm*D/1e3).toFixed(1),"m"]})})]}),a.jsx("div",{className:"property-group property-group--actions",children:a.jsx("button",{className:"btn-delete",onClick:oe,title:"Delete court (Delete key)",children:" Delete Court"})})]}),O==="lines"&&a.jsxs("div",{className:"properties-section",children:[a.jsxs("div",{className:"properties-section__header",children:[a.jsx("h4",{children:"Line Markings"}),a.jsx("button",{className:"btn-reset",onClick:()=>v(o),title:"Reset all colours to defaults",children:"Reset"})]}),a.jsxs("div",{className:"color-item color-item--all-lines",children:[a.jsxs("div",{className:"color-item__info",children:[a.jsx("span",{className:"color-item__name",children:"Change All Lines"}),a.jsx("span",{className:"color-item__hint",children:"Set all lines to same colour"})]}),a.jsx("button",{className:"color-item__swatch color-item__swatch--all",onClick:()=>F({type:"allLines"}),title:"Change all line colours at once",children:a.jsx("span",{style:{fontSize:"1rem"},children:""})})]}),a.jsx("div",{className:"color-list",children:I.markings.map(ge=>{const me=Oe(ge);return a.jsxs("div",{className:"color-item",children:[a.jsxs("div",{className:"color-item__info",children:[a.jsx("span",{className:"color-item__name",children:ge.name}),me&&a.jsx("span",{className:"color-item__code",children:me.code})]}),a.jsx("button",{className:"color-item__swatch",style:{backgroundColor:(me==null?void 0:me.hex)||"#000"},onClick:()=>F({type:"line",id:ge.id}),title:(me==null?void 0:me.name)||"Select colour"})]},ge.id)})})]}),O==="zones"&&a.jsxs("div",{className:"properties-section",children:[a.jsx("div",{className:"properties-section__header",children:a.jsx("h4",{children:"Fill Colours"})}),a.jsxs("div",{className:"color-item color-item--surface-fill",children:[a.jsxs("div",{className:"color-item__info",children:[a.jsx("span",{className:"color-item__name",children:"Court Surface"}),a.jsx("span",{className:"color-item__hint",children:S.courtSurfaceColor?S.courtSurfaceColor.name:"No Fill (transparent)"}),S.courtSurfaceColor&&a.jsx("span",{className:"color-item__code",children:S.courtSurfaceColor.tpv_code})]}),a.jsx("button",{className:`color-item__swatch ${S.courtSurfaceColor?"":"color-item__swatch--no-fill"}`,style:{backgroundColor:((Ie=S.courtSurfaceColor)==null?void 0:Ie.hex)||"transparent"},onClick:()=>F({type:"courtSurface"}),title:((Ee=S.courtSurfaceColor)==null?void 0:Ee.name)||"No Fill - Click to select colour"})]}),I.zones&&I.zones.length>0&&a.jsx("div",{className:"properties-section__divider",children:a.jsx("span",{children:"Paint Zones"})}),I.zones&&I.zones.length>0&&a.jsx("div",{className:"color-list",children:I.zones.map(ge=>{var He;const me=$e(ge);return a.jsxs("div",{className:"color-item",children:[a.jsxs("div",{className:"color-item__info",children:[a.jsx("span",{className:"color-item__name",children:ge.name}),a.jsxs("span",{className:"color-item__area",children:[((He=ge.area_m2)==null?void 0:He.toFixed(1))||0," m"]}),me&&a.jsx("span",{className:"color-item__code",children:me.code})]}),a.jsx("button",{className:"color-item__swatch",style:{backgroundColor:(me==null?void 0:me.hex)||"#000"},onClick:()=>F({type:"zone",id:ge.id}),title:(me==null?void 0:me.name)||"Select colour"})]},ge.id)})})]})]}),E&&a.jsx("div",{className:"color-picker-modal",onClick:()=>F(null),children:a.jsxs("div",{className:"color-picker-modal__content",onClick:ge=>ge.stopPropagation(),children:[a.jsxs("div",{className:"color-picker-modal__header",children:[a.jsx("h4",{children:E.type==="allLines"?"Change All Line Colours":E.type==="courtSurface"?"Select Court Fill Colour":"Select TPV Colour"}),a.jsx("button",{onClick:()=>F(null),children:""})]}),a.jsxs("div",{className:"color-picker-grid",children:[E.type==="courtSurface"&&a.jsx("button",{className:"color-picker-swatch color-picker-swatch--no-fill",onClick:()=>fe(null),title:"No Fill (transparent)",children:a.jsx("span",{className:"color-picker-swatch__code",children:"None"})}),Sr.map(ge=>a.jsx("button",{className:"color-picker-swatch",style:{backgroundColor:ge.hex},onClick:()=>fe(ge),title:`${ge.code} - ${ge.name}`,children:a.jsx("span",{className:"color-picker-swatch__code",children:ge.code})},ge.code))]})]})})]})}function D5({track:t,trackId:e}){var S,K,le;const{updateTrackParameters:r,removeTrack:n,setTrackSurfaceColor:i}=st(),{parameters:s,template:o,trackSurfaceColor:l}=t,[c,d]=$.useState(!0),[u,f]=$.useState(!1),h=o.trackType==="straight",p=Iw(s),g=((S=p.lanes[0])==null?void 0:S.perimeter)||0,m=p.lanes[p.lanes.length-1],x=(m==null?void 0:m.perimeter)||0,v=h?[]:Dw(p),y=D=>{const I=parseInt(D);if(!(isNaN(I)||I<1||I>8))if(h){const L=I*s.laneWidth_mm;r(e,{numLanes:I,width_mm:L})}else r(e,{numLanes:I})},b=D=>{const I=parseFloat(D)*1e3;isNaN(I)||I<3e3||r(e,{width_mm:I})},w=D=>{const I=parseFloat(D)*1e3;isNaN(I)||I<3e3||r(e,{height_mm:I})},k=(D,I)=>{const L=parseFloat(I)*1e3;if(isNaN(L)||L<0)return;const Z=Math.min(s.width_mm,s.height_mm)/2,H=Math.min(L,Z);c?r(e,{cornerRadius:{topLeft:H,topRight:H,bottomLeft:H,bottomRight:H}}):r(e,{cornerRadius:{...s.cornerRadius,[D]:H}})},_=()=>{window.confirm(`Delete ${o.name}? This action cannot be undone.`)&&n(e)},C=D=>{i(e,{tpv_code:D.code,hex:D.hex,name:D.name}),f(!1)},N=D=>{r(e,{startingBoxes:{...s.startingBoxes,enabled:D}})},T=D=>{const I=parseFloat(D)*1e3;isNaN(I)||I<100||r(e,{startingBoxes:{...s.startingBoxes,depth_mm:I}})},O=D=>{r(e,{startingBoxes:{...s.startingBoxes,style:D}})},X=D=>{r(e,{startingBoxes:{...s.startingBoxes,direction:D}})},E=D=>{const I=parseFloat(D);isNaN(I)||I<0||I>100||r(e,{startingBoxes:{...s.startingBoxes,startPosition:I}})},F=(s.cornerRadius.topLeft+s.cornerRadius.topRight+s.cornerRadius.bottomLeft+s.cornerRadius.bottomRight)/4;return a.jsxs("div",{className:"properties-panel",children:[a.jsxs("div",{className:"properties-panel__header",children:[a.jsx("h3",{children:"Track Properties"}),a.jsxs("div",{className:"properties-panel__court-info",children:[a.jsx("span",{className:"court-name",children:o.name}),a.jsx("span",{className:"court-standard",children:o.standard})]})]}),a.jsx("div",{className:"properties-panel__content",children:a.jsxs("div",{className:"properties-section",children:[a.jsx("div",{className:"properties-section__header",children:a.jsx("h4",{children:"Track Parameters"})}),a.jsxs("div",{className:"property-group",children:[a.jsx("label",{children:"Number of Lanes"}),a.jsxs("div",{className:"property-input-row",children:[a.jsx("input",{type:"range",min:"1",max:"8",value:s.numLanes,onChange:D=>y(D.target.value),className:"property-slider"}),a.jsxs("div",{className:"property-input-group property-input-group--compact",children:[a.jsx("input",{type:"number",value:s.numLanes,onChange:D=>y(D.target.value),min:"1",max:"8"}),a.jsx("span",{className:"property-unit",children:"lanes"})]})]})]}),h?a.jsxs("div",{className:"property-group property-group--info",children:[a.jsx("label",{children:"Track Width"}),a.jsx("div",{className:"property-info",children:a.jsxs("span",{children:[(s.width_mm/1e3).toFixed(1),"m (Auto-calculated from lanes)"]})})]}):a.jsxs("div",{className:"property-group",children:[a.jsx("label",{children:"Track Width"}),a.jsxs("div",{className:"property-input-group",children:[a.jsx("input",{type:"number",value:(s.width_mm/1e3).toFixed(1),onChange:D=>b(D.target.value),min:"3",max:"100",step:"0.5"}),a.jsx("span",{className:"property-unit",children:"m"})]})]}),a.jsxs("div",{className:"property-group",children:[a.jsx("label",{children:h?"Track Length":"Track Height"}),a.jsxs("div",{className:"property-input-group",children:[a.jsx("input",{type:"number",value:(s.height_mm/1e3).toFixed(1),onChange:D=>w(D.target.value),min:"3",max:"100",step:"0.5"}),a.jsx("span",{className:"property-unit",children:"m"})]})]}),!h&&a.jsxs("div",{className:"property-group",children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[a.jsx("label",{children:"Corner Radius"}),a.jsx("button",{className:"btn-toggle",onClick:()=>d(!c),style:{padding:"0.25rem 0.5rem",fontSize:"0.75rem",background:c?"#0066CC":"#6b7280",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},title:c?"Click to edit corners independently":"Click to lock all corners together",children:c?" Locked":" Independent"})]}),c?a.jsxs("div",{className:"property-input-group",children:[a.jsx("input",{type:"number",value:(F/1e3).toFixed(2),onChange:D=>k("topLeft",D.target.value),min:"0",max:(Math.min(s.width_mm,s.height_mm)/2e3).toFixed(0),step:"0.5"}),a.jsx("span",{className:"property-unit",children:"m"})]}):a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs("div",{children:[a.jsx("label",{style:{fontSize:"0.75rem",color:"#64748b"},children:"Top Left"}),a.jsxs("div",{className:"property-input-group",children:[a.jsx("input",{type:"number",value:(s.cornerRadius.topLeft/1e3).toFixed(2),onChange:D=>k("topLeft",D.target.value),min:"0",max:(Math.min(s.width_mm,s.height_mm)/2e3).toFixed(0),step:"0.5"}),a.jsx("span",{className:"property-unit",children:"m"})]})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontSize:"0.75rem",color:"#64748b"},children:"Top Right"}),a.jsxs("div",{className:"property-input-group",children:[a.jsx("input",{type:"number",value:(s.cornerRadius.topRight/1e3).toFixed(2),onChange:D=>k("topRight",D.target.value),min:"0",max:(Math.min(s.width_mm,s.height_mm)/2e3).toFixed(0),step:"0.5"}),a.jsx("span",{className:"property-unit",children:"m"})]})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontSize:"0.75rem",color:"#64748b"},children:"Bottom Left"}),a.jsxs("div",{className:"property-input-group",children:[a.jsx("input",{type:"number",value:(s.cornerRadius.bottomLeft/1e3).toFixed(2),onChange:D=>k("bottomLeft",D.target.value),min:"0",max:(Math.min(s.width_mm,s.height_mm)/2e3).toFixed(0),step:"0.5"}),a.jsx("span",{className:"property-unit",children:"m"})]})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontSize:"0.75rem",color:"#64748b"},children:"Bottom Right"}),a.jsxs("div",{className:"property-input-group",children:[a.jsx("input",{type:"number",value:(s.cornerRadius.bottomRight/1e3).toFixed(2),onChange:D=>k("bottomRight",D.target.value),min:"0",max:(Math.min(s.width_mm,s.height_mm)/2e3).toFixed(0),step:"0.5"}),a.jsx("span",{className:"property-unit",children:"m"})]})]})]})]}),a.jsxs("div",{className:"property-group property-group--info",children:[a.jsx("label",{children:"Lane Width"}),a.jsx("div",{className:"property-info",children:a.jsxs("span",{children:[(s.laneWidth_mm/1e3).toFixed(2),"m (Fixed)"]})})]}),a.jsxs("div",{className:"property-group",children:[a.jsx("label",{children:"Track Surface Colour"}),a.jsxs("div",{className:"color-item",children:[a.jsxs("div",{className:"color-item__info",children:[a.jsx("span",{className:"color-item__name",children:(l==null?void 0:l.name)||"Select Colour"}),l&&a.jsx("span",{className:"color-item__code",children:l.tpv_code})]}),a.jsx("button",{className:"color-item__swatch",style:{backgroundColor:(l==null?void 0:l.hex)||"#A5362F"},onClick:()=>f(!0),title:(l==null?void 0:l.name)||"Select colour"})]})]}),a.jsxs("div",{className:"property-group",children:[a.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[a.jsx("input",{type:"checkbox",checked:((K=s.startingBoxes)==null?void 0:K.enabled)||!1,onChange:D=>N(D.target.checked)}),"Show Starting Boxes"]}),((le=s.startingBoxes)==null?void 0:le.enabled)&&a.jsxs("div",{style:{marginTop:"0.75rem"},children:[a.jsxs("div",{className:"property-input-group",style:{marginBottom:"0.75rem"},children:[a.jsx("span",{className:"property-label",style:{fontSize:"0.875rem"},children:"Depth"}),a.jsx("input",{type:"number",value:(s.startingBoxes.depth_mm/1e3).toFixed(2),onChange:D=>T(D.target.value),min:"0.1",max:"1.0",step:"0.05"}),a.jsx("span",{className:"property-unit",children:"m"})]}),!h&&a.jsxs("div",{style:{marginBottom:"0.75rem"},children:[a.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#64748b",marginBottom:"0.375rem"},children:"Start Style"}),a.jsxs("select",{value:s.startingBoxes.style||"staggered",onChange:D=>O(D.target.value),style:{width:"100%",padding:"0.5rem",border:"1px solid #e4e9f0",borderRadius:"6px",fontSize:"0.875rem",fontFamily:"inherit",background:"white"},children:[a.jsx("option",{value:"straight",children:"Straight Start"}),a.jsx("option",{value:"staggered",children:"Staggered Start"}),a.jsx("option",{value:"both",children:"Both (opposite ends)"})]})]}),a.jsxs("div",{style:{marginBottom:"0.75rem"},children:[a.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#64748b",marginBottom:"0.375rem"},children:"Direction of Travel"}),a.jsxs("select",{value:s.startingBoxes.direction||"counterclockwise",onChange:D=>X(D.target.value),style:{width:"100%",padding:"0.5rem",border:"1px solid #e4e9f0",borderRadius:"6px",fontSize:"0.875rem",fontFamily:"inherit",background:"white"},children:[a.jsx("option",{value:"counterclockwise",children:"Counterclockwise (Standard)"}),a.jsx("option",{value:"clockwise",children:"Clockwise"})]})]}),!h&&a.jsxs("div",{style:{marginBottom:"0.75rem"},children:[a.jsxs("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#64748b",marginBottom:"0.375rem"},children:["Start Position (",s.startingBoxes.startPosition||0,"%)"]}),a.jsx("input",{type:"range",min:"0",max:"100",step:"1",value:s.startingBoxes.startPosition||0,onChange:D=>E(D.target.value),className:"property-slider",style:{width:"100%"}}),a.jsx("div",{style:{fontSize:"0.7rem",color:"#94a3b8",marginTop:"0.25rem"},children:"Slide to adjust where the start line appears around the track"})]}),a.jsx("div",{className:"property-info",style:{fontSize:"0.75rem",color:"#64748b",marginTop:"0.5rem"},children:"Boxes use track surface colour with white starting line and lane numbers"}),!h&&v.length>0&&(s.startingBoxes.style==="staggered"||s.startingBoxes.style==="both")&&a.jsxs("div",{style:{marginTop:"0.75rem",padding:"0.5rem",background:"#f8fafc",borderRadius:"4px"},children:[a.jsx("div",{style:{fontSize:"0.75rem",fontWeight:"600",color:"#1e293b",marginBottom:"0.25rem"},children:"Auto-Calculated Staggers:"}),a.jsx("div",{style:{fontSize:"0.7rem",color:"#64748b",lineHeight:"1.4"},children:v.map((D,I)=>a.jsxs("div",{children:["Lane ",I+1,": ",(D/1e3).toFixed(2),"m"]},I))}),a.jsx("div",{style:{fontSize:"0.65rem",color:"#64748b",marginTop:"0.25rem",fontStyle:"italic"},children:"Outer lanes start ahead to equalize distance"})]})]})]}),a.jsx("div",{className:"property-divider"}),a.jsx("div",{className:"properties-section__header",children:a.jsx("h4",{children:"Calculated Dimensions"})}),a.jsxs("div",{className:"property-group property-group--info",children:[a.jsx("label",{children:"Usable Infield"}),a.jsx("div",{className:"property-info",children:a.jsxs("span",{children:[(p.usableWidth/1e3).toFixed(1),"m  ",(p.usableHeight/1e3).toFixed(1),"m"]})})]}),a.jsxs("div",{className:"property-group property-group--info",children:[a.jsx("label",{children:"Lane 1 Perimeter"}),a.jsx("div",{className:"property-info",children:a.jsxs("span",{children:[g.toFixed(2),"m"]})})]}),s.numLanes>1&&a.jsxs("div",{className:"property-group property-group--info",children:[a.jsxs("label",{children:["Lane ",s.numLanes," Perimeter"]}),a.jsx("div",{className:"property-info",children:a.jsxs("span",{children:[x.toFixed(2),"m"]})})]}),a.jsx("div",{className:"property-group",children:a.jsx("div",{className:"property-hint",style:{fontStyle:"normal",color:"#64748b",fontSize:"0.75rem",marginTop:"1rem"},children:" Tip: Use drag handles on the canvas or edit values here. Corner radius auto-adjusts when locked."})}),a.jsx("div",{className:"property-group property-group--actions",children:a.jsx("button",{className:"btn-delete",onClick:_,title:"Delete track (Delete key)",children:" Delete Track"})})]})}),u&&a.jsx("div",{className:"color-picker-modal",onClick:()=>f(!1),children:a.jsxs("div",{className:"color-picker-modal__content",onClick:D=>D.stopPropagation(),children:[a.jsxs("div",{className:"color-picker-modal__header",children:[a.jsx("h4",{children:"Select Track Surface Colour"}),a.jsx("button",{onClick:()=>f(!1),children:""})]}),a.jsx("div",{className:"color-picker-grid",children:Sr.map(D=>a.jsx("button",{className:"color-picker-swatch",style:{backgroundColor:D.hex},onClick:()=>C(D),title:`${D.code} - ${D.name}`,children:a.jsx("span",{className:"color-picker-swatch__code",children:D.code})},D.code))})]})})]})}function z5({motif:t,motifId:e,onEditSourceDesign:r}){const{updateMotifPosition:n,updateMotifRotation:i,updateMotifScale:s,removeMotif:o,duplicateMotif:l,refreshMotif:c,setMotifViewMode:d}=st(),{position:u,rotation:f,scale:h,sourceDesignName:p,sourceDesignId:g,originalWidth_mm:m,originalHeight_mm:x,sourceThumbnailUrl:v,viewMode:y,hasBothVersions:b}=t,[w,k]=$.useState(!1),[_,C]=$.useState(null),N=(D,I)=>{const L=parseFloat(I);isNaN(L)||n(e,{...u,[D]:L})},T=D=>{const I=parseFloat(D);isNaN(I)||i(e,I)},O=D=>{const I=parseFloat(D);isNaN(I)||I<=0||s(e,I)},X=()=>{window.confirm("Delete this motif? This action cannot be undone.")&&o(e)},E=()=>{l(e)},F=()=>{if(r)r(g);else{if(!g){alert("Source design ID not found");return}window.open(`/studio/?design=${g}`,"_blank")}},S=async()=>{if(!w){k(!0),C(null);try{const D=await c(e);D.success||C(D.error||"Failed to refresh")}catch(D){C(D.message||"Failed to refresh")}finally{k(!1)}}},K=m*(h||1)/1e3,le=x*(h||1)/1e3;return a.jsxs("div",{className:"properties-panel",children:[a.jsxs("div",{className:"properties-panel__header",children:[a.jsx("h3",{children:"Motif Properties"}),a.jsxs("div",{className:"properties-panel__court-info",children:[a.jsx("span",{className:"court-name",children:p||"Unnamed Motif"}),a.jsx("span",{className:"court-standard",children:"Playground Design"})]})]}),a.jsx("div",{className:"properties-panel__content",children:a.jsxs("div",{className:"properties-section",children:[v&&a.jsxs("div",{className:"property-group",children:[a.jsx("label",{children:"Preview"}),a.jsx("div",{style:{width:"100%",height:"80px",background:"#f3f4f6",borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden"},children:a.jsx("img",{src:v,alt:p,style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})})]}),b&&a.jsxs("div",{className:"property-group",children:[a.jsx("label",{children:"Colour Style"}),a.jsxs("div",{className:"property-toggle-buttons",children:[a.jsx("button",{className:`toggle-btn ${y==="solid"?"toggle-btn--active":""}`,onClick:()=>d(e,"solid"),children:"Solid"}),a.jsx("button",{className:`toggle-btn ${y==="blend"?"toggle-btn--active":""}`,onClick:()=>d(e,"blend"),children:"Blend"})]})]}),a.jsx("div",{className:"properties-section__header",children:a.jsx("h4",{children:"Transform"})}),a.jsxs("div",{className:"property-group",children:[a.jsx("label",{children:"Position"}),a.jsxs("div",{className:"property-input-row",children:[a.jsxs("div",{className:"property-input-group",children:[a.jsx("span",{className:"property-label",children:"X"}),a.jsx("input",{type:"number",value:Math.round(u.x),onChange:D=>N("x",D.target.value),step:"100"}),a.jsx("span",{className:"property-unit",children:"mm"})]}),a.jsxs("div",{className:"property-input-group",children:[a.jsx("span",{className:"property-label",children:"Y"}),a.jsx("input",{type:"number",value:Math.round(u.y),onChange:D=>N("y",D.target.value),step:"100"}),a.jsx("span",{className:"property-unit",children:"mm"})]})]})]}),a.jsxs("div",{className:"property-group",children:[a.jsx("label",{children:"Rotation"}),a.jsxs("div",{className:"property-input-row",children:[a.jsx("input",{type:"range",min:"0",max:"360",value:f||0,onChange:D=>T(D.target.value),className:"property-slider"}),a.jsxs("div",{className:"property-input-group property-input-group--compact",children:[a.jsx("input",{type:"number",value:Math.round(f||0),onChange:D=>T(D.target.value),min:"0",max:"360"}),a.jsx("span",{className:"property-unit",children:""})]})]})]}),a.jsxs("div",{className:"property-group",children:[a.jsxs("label",{children:["Scale",a.jsx("span",{style:{fontSize:"0.7rem",color:"#64748b",marginLeft:"0.5rem"},children:"(aspect locked)"})]}),a.jsxs("div",{className:"property-input-row",children:[a.jsx("input",{type:"range",min:"0.1",max:"10",step:"0.1",value:Math.min(h||1,10),onChange:D=>O(D.target.value),className:"property-slider"}),a.jsxs("div",{className:"property-input-group property-input-group--compact",children:[a.jsx("input",{type:"number",value:(h||1).toFixed(2),onChange:D=>O(D.target.value),min:"0.1",step:"0.1"}),a.jsx("span",{className:"property-unit",children:""})]})]})]}),a.jsxs("div",{className:"property-group property-group--info",children:[a.jsx("label",{children:"Current Size"}),a.jsx("div",{className:"property-info",children:a.jsxs("span",{children:[K.toFixed(2),"m  ",le.toFixed(2),"m"]})})]}),a.jsxs("div",{className:"property-group property-group--info",children:[a.jsx("label",{children:"Original Size"}),a.jsx("div",{className:"property-info",children:a.jsxs("span",{children:[(m/1e3).toFixed(2),"m  ",(x/1e3).toFixed(2),"m"]})})]}),a.jsx("div",{className:"properties-section__divider",style:{margin:"1rem 0"},children:a.jsx("span",{children:"Source Design"})}),a.jsx("div",{className:"property-group property-group--actions",children:a.jsx("button",{className:"btn-primary",onClick:F,title:"Edit the source playground design in a new tab",style:{width:"100%",padding:"0.5rem",background:"var(--color-primary, #1e4a7a)",color:"white",border:"none",borderRadius:"6px",fontSize:"0.875rem",fontFamily:"inherit",cursor:"pointer",marginBottom:"0.5rem",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem"},children:" Edit Source Design"})}),a.jsxs("div",{className:"property-group property-group--actions",children:[a.jsx("button",{className:"btn-secondary",onClick:S,disabled:w,title:"Refresh this motif with the latest version from the source design",style:{width:"100%",padding:"0.5rem",background:w?"#e5e7eb":"#f3f4f6",border:"1px solid #e4e9f0",borderRadius:"6px",fontSize:"0.875rem",fontFamily:"inherit",cursor:w?"not-allowed":"pointer",marginBottom:"0.5rem",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem"},children:w?" Refreshing...":" Refresh from Source"}),_&&a.jsx("div",{style:{fontSize:"0.75rem",color:"#dc2626",marginTop:"0.25rem"},children:_}),a.jsx("div",{style:{fontSize:"0.7rem",color:"#64748b",marginTop:"0.25rem"},children:"Click after editing the source design to update this motif"})]}),a.jsx("div",{className:"properties-section__divider",style:{margin:"1rem 0"},children:a.jsx("span",{children:"Actions"})}),a.jsx("div",{className:"property-group property-group--actions",children:a.jsx("button",{className:"btn-secondary",onClick:E,title:"Duplicate motif (Ctrl+D)",style:{width:"100%",padding:"0.5rem",background:"#f3f4f6",border:"1px solid #e4e9f0",borderRadius:"6px",fontSize:"0.875rem",fontFamily:"inherit",cursor:"pointer",marginBottom:"0.5rem"},children:" Duplicate Motif"})}),a.jsx("div",{className:"property-group property-group--actions",children:a.jsx("button",{className:"btn-delete",onClick:X,title:"Delete motif (Delete key)",children:" Delete Motif"})}),a.jsx("div",{className:"property-group",children:a.jsx("div",{className:"property-hint",style:{fontStyle:"normal",color:"#64748b",fontSize:"0.75rem",marginTop:"1rem"},children:' Tip: Drag the motif on the canvas to reposition. Edit the source design and click "Refresh" to update.'})})]})})]})}function F5({shape:t,shapeId:e}){var He;const{updateShapePosition:r,updateShapeDimensions:n,updateShapeSides:i,updateShapeCornerRadius:s,updateShapeRotation:o,setShapeFillColor:l,setShapeStroke:c,setShapeAspectLock:d,removeShape:u,duplicateShape:f,randomizeBlob:h,setBlobStyle:p,setEditPointsVisible:g}=st(),[m,x]=$.useState(!1),[v,y]=$.useState(!1),{shapeType:b,sides:w,width_mm:k,height_mm:_,cornerRadius:C,position:N,rotation:T,fillColor:O,strokeEnabled:X,strokeColor:E,strokeWidth_mm:F,aspectLocked:S,blobStyle:K,editPointsVisible:le}=t,D=b==="blob",I=(ue,j)=>{const ce=parseFloat(j);isNaN(ce)||r(e,{...N,[ue]:ce})},L=ue=>{const j=parseFloat(ue);if(!(isNaN(j)||j<100))if(S){const ce=_/k;n(e,j,j*ce)}else n(e,j,_)},Z=ue=>{const j=parseFloat(ue);if(!(isNaN(j)||j<100))if(S){const ce=k/_;n(e,j*ce,j)}else n(e,k,j)},H=ue=>{const j=parseInt(ue);isNaN(j)||j<3||i(e,j)},G=ue=>{const j=parseFloat(ue);isNaN(j)||j<0||j>100||s(e,j)},ee=ue=>{const j=parseFloat(ue);isNaN(j)||o(e,j)},oe=ue=>{l(e,{tpv_code:ue.code,hex:ue.hex,name:ue.name}),x(!1)},fe=ue=>{c(e,!0,{tpv_code:ue.code,hex:ue.hex,name:ue.name},F),y(!1)},Oe=ue=>{ue&&!E?c(e,!0,{tpv_code:"RH31",hex:"#E8E3D8",name:"Cream"},F):c(e,ue,E,F)},$e=ue=>{const j=parseFloat(ue);isNaN(j)||j<10||c(e,X,E,j)},Ie=()=>{d(e,!S)},Ee=()=>{window.confirm("Delete this shape? This action cannot be undone.")&&u(e)},ge=()=>{f(e)},me=[{sides:3,name:"Triangle",icon:""},{sides:4,name:"Square",icon:""},{sides:5,name:"Pentagon",icon:""},{sides:6,name:"Hexagon",icon:""},{sides:8,name:"Octagon",icon:""},{sides:32,name:"Circle",icon:""}];return a.jsxs("div",{className:"properties-panel",children:[a.jsxs("div",{className:"properties-panel__header",children:[a.jsx("h3",{children:D?"Blob Shape":"Shape Properties"}),a.jsxs("div",{className:"properties-panel__court-info",children:[a.jsx("span",{className:"court-name",children:D?((He=Gc[K||"organic"])==null?void 0:He.name)||"Organic":s5(w)}),a.jsx("span",{className:"court-standard",children:D?" Blob":`${o5(w)} ${w} sides`})]})]}),a.jsx("div",{className:"properties-panel__content",children:a.jsxs("div",{className:"properties-section",children:[D?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"property-group",children:[a.jsx("label",{children:"Style"}),a.jsx("select",{value:K||"organic",onChange:ue=>p(e,ue.target.value),style:{width:"100%",padding:"0.5rem 0.75rem",border:"1px solid #e4e9f0",borderRadius:"6px",fontSize:"0.875rem",cursor:"pointer",background:"#fff"},children:Object.entries(Gc).map(([ue,j])=>a.jsxs("option",{value:ue,children:[j.name," - ",j.description]},ue))})]}),a.jsxs("div",{className:"property-group",children:[a.jsxs("button",{onClick:()=>h(e),style:{width:"100%",padding:"0.75rem 1rem",background:"#3b82f6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"0.875rem",fontWeight:"600",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem"},children:[a.jsx("span",{style:{fontSize:"1.1rem"},children:""})," New Shape"]}),a.jsx("div",{style:{fontSize:"0.7rem",color:"#64748b",marginTop:"0.5rem",textAlign:"center"},children:"Generate a new random shape in the selected style"})]}),a.jsxs("div",{className:"property-group",children:[a.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",padding:"0.5rem",border:"1px solid #e4e9f0",borderRadius:"6px",background:le?"#eff6ff":"#fff"},children:[a.jsx("input",{type:"checkbox",checked:le||!1,onChange:ue=>g(e,ue.target.checked),style:{width:"16px",height:"16px",cursor:"pointer"}}),a.jsx("span",{style:{fontSize:"0.875rem"},children:"Edit Points"})]}),le&&a.jsx("div",{style:{fontSize:"0.7rem",color:"#64748b",marginTop:"0.5rem"},children:"Drag points and handles on canvas for precise control"})]})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"property-group",children:[a.jsx("label",{children:"Shape Type"}),a.jsx("div",{className:"shape-presets",style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"0.5rem",marginTop:"0.5rem"},children:me.map(ue=>a.jsxs("button",{onClick:()=>H(ue.sides),title:ue.name,style:{padding:"0.5rem",border:w===ue.sides?"2px solid #3b82f6":"1px solid #e4e9f0",borderRadius:"6px",background:w===ue.sides?"#eff6ff":"#fff",cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",gap:"0.25rem",fontSize:"1.25rem"},children:[a.jsx("span",{children:ue.icon}),a.jsx("span",{style:{fontSize:"0.65rem",color:"#64748b"},children:ue.name})]},ue.sides))})]}),a.jsxs("div",{className:"property-group",children:[a.jsx("label",{children:"Number of Sides"}),a.jsxs("div",{className:"property-input-row",children:[a.jsx("input",{type:"range",min:"3",max:"32",value:w,onChange:ue=>H(ue.target.value),className:"property-slider"}),a.jsx("div",{className:"property-input-group property-input-group--compact",children:a.jsx("input",{type:"number",value:w,onChange:ue=>H(ue.target.value),min:"3",max:"32"})})]})]}),a.jsxs("div",{className:"property-group",children:[a.jsx("label",{children:"Corner Smoothing"}),a.jsxs("div",{className:"property-input-row",children:[a.jsx("input",{type:"range",min:"0",max:"100",value:C,onChange:ue=>G(ue.target.value),className:"property-slider"}),a.jsxs("div",{className:"property-input-group property-input-group--compact",children:[a.jsx("input",{type:"number",value:C,onChange:ue=>G(ue.target.value),min:"0",max:"100"}),a.jsx("span",{className:"property-unit",children:"%"})]})]})]})]}),a.jsx("div",{className:"properties-section__divider",style:{margin:"1rem 0"},children:a.jsx("span",{children:"Dimensions"})}),a.jsxs("div",{className:"property-group",children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[a.jsx("label",{style:{margin:0},children:"Size"}),a.jsx("button",{onClick:Ie,style:{padding:"0.25rem 0.5rem",fontSize:"0.75rem",background:S?"#3b82f6":"#6b7280",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},title:S?"Aspect ratio locked":"Aspect ratio unlocked",children:S?" Locked":" Free"})]}),a.jsxs("div",{className:"property-input-row",children:[a.jsxs("div",{className:"property-input-group",children:[a.jsx("span",{className:"property-label",children:"W"}),a.jsx("input",{type:"number",value:k.toFixed(0),onChange:ue=>L(ue.target.value),step:"100",min:"100"}),a.jsx("span",{className:"property-unit",children:"mm"})]}),a.jsxs("div",{className:"property-input-group",children:[a.jsx("span",{className:"property-label",children:"H"}),a.jsx("input",{type:"number",value:_.toFixed(0),onChange:ue=>Z(ue.target.value),step:"100",min:"100"}),a.jsx("span",{className:"property-unit",children:"mm"})]})]}),a.jsxs("div",{style:{fontSize:"0.7rem",color:"#64748b",marginTop:"0.25rem"},children:[(k/1e3).toFixed(2),"m  ",(_/1e3).toFixed(2),"m"]})]}),a.jsxs("div",{className:"property-group",children:[a.jsx("label",{children:"Position"}),a.jsxs("div",{className:"property-input-row",children:[a.jsxs("div",{className:"property-input-group",children:[a.jsx("span",{className:"property-label",children:"X"}),a.jsx("input",{type:"number",value:Math.round(N.x),onChange:ue=>I("x",ue.target.value),step:"100"}),a.jsx("span",{className:"property-unit",children:"mm"})]}),a.jsxs("div",{className:"property-input-group",children:[a.jsx("span",{className:"property-label",children:"Y"}),a.jsx("input",{type:"number",value:Math.round(N.y),onChange:ue=>I("y",ue.target.value),step:"100"}),a.jsx("span",{className:"property-unit",children:"mm"})]})]})]}),a.jsxs("div",{className:"property-group",children:[a.jsx("label",{children:"Rotation"}),a.jsxs("div",{className:"property-input-row",children:[a.jsx("input",{type:"range",min:"0",max:"360",value:T||0,onChange:ue=>ee(ue.target.value),className:"property-slider"}),a.jsxs("div",{className:"property-input-group property-input-group--compact",children:[a.jsx("input",{type:"number",value:Math.round(T||0),onChange:ue=>ee(ue.target.value),min:"0",max:"360"}),a.jsx("span",{className:"property-unit",children:""})]})]})]}),a.jsx("div",{className:"properties-section__divider",style:{margin:"1rem 0"},children:a.jsx("span",{children:"Appearance"})}),a.jsxs("div",{className:"property-group",children:[a.jsx("label",{children:"Fill Colour"}),a.jsxs("div",{className:"color-item",children:[a.jsxs("div",{className:"color-item__info",children:[a.jsx("span",{className:"color-item__name",children:(O==null?void 0:O.name)||"Select Colour"}),O&&a.jsx("span",{className:"color-item__code",children:O.tpv_code})]}),a.jsx("button",{className:"color-item__swatch",style:{backgroundColor:(O==null?void 0:O.hex)||"#609B63"},onClick:()=>x(!0),title:(O==null?void 0:O.name)||"Select colour"})]})]}),a.jsxs("div",{className:"property-group",children:[a.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[a.jsx("input",{type:"checkbox",checked:X||!1,onChange:ue=>Oe(ue.target.checked)}),"Border"]}),X&&a.jsxs("div",{style:{marginTop:"0.5rem"},children:[a.jsxs("div",{className:"color-item",style:{marginBottom:"0.5rem"},children:[a.jsxs("div",{className:"color-item__info",children:[a.jsx("span",{className:"color-item__name",children:(E==null?void 0:E.name)||"Select Colour"}),E&&a.jsx("span",{className:"color-item__code",children:E.tpv_code})]}),a.jsx("button",{className:"color-item__swatch",style:{backgroundColor:(E==null?void 0:E.hex)||"#FFFFFF"},onClick:()=>y(!0),title:(E==null?void 0:E.name)||"Select colour"})]}),a.jsxs("div",{className:"property-input-group",children:[a.jsx("span",{className:"property-label",style:{fontSize:"0.8rem"},children:"Width"}),a.jsx("input",{type:"number",value:F,onChange:ue=>$e(ue.target.value),step:"10",min:"10"}),a.jsx("span",{className:"property-unit",children:"mm"})]})]})]}),a.jsx("div",{className:"properties-section__divider",style:{margin:"1rem 0"},children:a.jsx("span",{children:"Actions"})}),a.jsx("div",{className:"property-group property-group--actions",children:a.jsx("button",{className:"btn-secondary",onClick:ge,title:"Duplicate shape (Ctrl+D)",style:{width:"100%",padding:"0.5rem",background:"#f3f4f6",border:"1px solid #e4e9f0",borderRadius:"6px",fontSize:"0.875rem",fontFamily:"inherit",cursor:"pointer",marginBottom:"0.5rem"},children:" Duplicate Shape"})}),a.jsx("div",{className:"property-group property-group--actions",children:a.jsx("button",{className:"btn-delete",onClick:Ee,title:"Delete shape (Delete key)",children:" Delete Shape"})}),a.jsx("div",{className:"property-group",children:a.jsx("div",{className:"property-hint",style:{fontStyle:"normal",color:"#64748b",fontSize:"0.75rem",marginTop:"1rem"},children:" Tip: Drag corners to resize, drag the rotation handle above the shape to rotate. Hold Shift to snap rotation to 15 increments."})})]})}),m&&a.jsx("div",{className:"color-picker-modal",onClick:()=>x(!1),children:a.jsxs("div",{className:"color-picker-modal__content",onClick:ue=>ue.stopPropagation(),children:[a.jsxs("div",{className:"color-picker-modal__header",children:[a.jsx("h4",{children:"Select Fill Colour"}),a.jsx("button",{onClick:()=>x(!1),children:""})]}),a.jsx("div",{className:"color-picker-grid",children:Sr.map(ue=>a.jsx("button",{className:"color-picker-swatch",style:{backgroundColor:ue.hex},onClick:()=>oe(ue),title:`${ue.code} - ${ue.name}`,children:a.jsx("span",{className:"color-picker-swatch__code",children:ue.code})},ue.code))})]})}),v&&a.jsx("div",{className:"color-picker-modal",onClick:()=>y(!1),children:a.jsxs("div",{className:"color-picker-modal__content",onClick:ue=>ue.stopPropagation(),children:[a.jsxs("div",{className:"color-picker-modal__header",children:[a.jsx("h4",{children:"Select Border Colour"}),a.jsx("button",{onClick:()=>y(!1),children:""})]}),a.jsx("div",{className:"color-picker-grid",children:Sr.map(ue=>a.jsx("button",{className:"color-picker-swatch",style:{backgroundColor:ue.hex},onClick:()=>fe(ue),title:`${ue.code} - ${ue.name}`,children:a.jsx("span",{className:"color-picker-swatch__code",children:ue.code})},ue.code))})]})})]})}function B5({text:t,textId:e}){const{updateTextContent:r,updateTextPosition:n,updateTextFontSize:i,updateTextFont:s,updateTextAlign:o,updateTextRotation:l,setTextFillColor:c,removeText:d,duplicateText:u}=st(),[f,h]=$.useState(!1),{content:p,fontFamily:g,fontSize_mm:m,fontWeight:x,fontStyle:v,textAlign:y,position:b,rotation:w,fillColor:k}=t,_=h5(),C=I=>{r(e,I)},N=(I,L)=>{const Z=parseFloat(L);isNaN(Z)||n(e,{...b,[I]:Z})},T=I=>{const L=parseFloat(I);isNaN(L)||L<50||i(e,L)},O=I=>{s(e,I,x,v)},X=()=>{s(e,g,x==="bold"?"normal":"bold",v)},E=()=>{s(e,g,x,v==="italic"?"normal":"italic")},F=I=>{o(e,I)},S=I=>{const L=parseFloat(I);isNaN(L)||l(e,L)},K=I=>{c(e,{tpv_code:I.code,hex:I.hex,name:I.name}),h(!1)},le=()=>{window.confirm("Delete this text? This action cannot be undone.")&&d(e)},D=()=>{u(e)};return a.jsxs("div",{className:"properties-panel",children:[a.jsxs("div",{className:"properties-panel__header",children:[a.jsx("h3",{children:"Text Properties"}),a.jsxs("div",{className:"properties-panel__court-info",children:[a.jsx("span",{className:"court-name",style:{fontFamily:g},children:p||"Text Label"}),a.jsx("span",{className:"court-standard",children:"T Text Element"})]})]}),a.jsx("div",{className:"properties-panel__content",children:a.jsxs("div",{className:"properties-section",children:[a.jsxs("div",{className:"property-group",children:[a.jsx("label",{children:"Text Content"}),a.jsx("input",{type:"text",value:p,onChange:I=>C(I.target.value),placeholder:"Enter text...",style:{width:"100%",padding:"0.5rem",border:"1px solid #e4e9f0",borderRadius:"6px",fontFamily:g,fontSize:"1rem"}})]}),a.jsx("div",{className:"properties-section__divider",style:{margin:"1rem 0"},children:a.jsx("span",{children:"Typography"})}),a.jsxs("div",{className:"property-group",children:[a.jsx("label",{children:"Font Family"}),a.jsx("select",{value:g,onChange:I=>O(I.target.value),style:{width:"100%",padding:"0.5rem",border:"1px solid #e4e9f0",borderRadius:"6px",fontFamily:"inherit",fontSize:"0.875rem"},children:_.map(I=>a.jsx("option",{value:I.family,style:{fontFamily:I.family},children:I.name},I.name))})]}),a.jsxs("div",{className:"property-group",children:[a.jsx("label",{children:"Font Size"}),a.jsxs("div",{className:"property-input-row",children:[a.jsx("input",{type:"range",min:"100",max:"2000",step:"50",value:m,onChange:I=>T(I.target.value),className:"property-slider"}),a.jsxs("div",{className:"property-input-group property-input-group--compact",children:[a.jsx("input",{type:"number",value:m.toFixed(0),onChange:I=>T(I.target.value),min:"50",step:"50"}),a.jsx("span",{className:"property-unit",children:"mm"})]})]}),a.jsxs("div",{style:{fontSize:"0.7rem",color:"#64748b",marginTop:"0.25rem"},children:[" ",(m/1e3).toFixed(2),"m height"]})]}),a.jsxs("div",{className:"property-group",children:[a.jsx("label",{children:"Style"}),a.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[a.jsx("button",{onClick:X,style:{flex:1,padding:"0.5rem",border:x==="bold"?"2px solid #3b82f6":"1px solid #e4e9f0",borderRadius:"6px",background:x==="bold"?"#eff6ff":"#fff",fontWeight:"bold",fontSize:"1rem",cursor:"pointer"},title:"Bold",children:"B"}),a.jsx("button",{onClick:E,style:{flex:1,padding:"0.5rem",border:v==="italic"?"2px solid #3b82f6":"1px solid #e4e9f0",borderRadius:"6px",background:v==="italic"?"#eff6ff":"#fff",fontStyle:"italic",fontSize:"1rem",cursor:"pointer"},title:"Italic",children:"I"})]})]}),a.jsxs("div",{className:"property-group",children:[a.jsx("label",{children:"Alignment"}),a.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[a.jsx("button",{onClick:()=>F("left"),style:{flex:1,padding:"0.5rem",border:y==="left"?"2px solid #3b82f6":"1px solid #e4e9f0",borderRadius:"6px",background:y==="left"?"#eff6ff":"#fff",cursor:"pointer"},title:"Align Left",children:""}),a.jsx("button",{onClick:()=>F("center"),style:{flex:1,padding:"0.5rem",border:y==="center"?"2px solid #3b82f6":"1px solid #e4e9f0",borderRadius:"6px",background:y==="center"?"#eff6ff":"#fff",cursor:"pointer"},title:"Align Center",children:""}),a.jsx("button",{onClick:()=>F("right"),style:{flex:1,padding:"0.5rem",border:y==="right"?"2px solid #3b82f6":"1px solid #e4e9f0",borderRadius:"6px",background:y==="right"?"#eff6ff":"#fff",cursor:"pointer"},title:"Align Right",children:""})]})]}),a.jsxs("div",{className:"property-group",children:[a.jsx("label",{children:"Text Colour"}),a.jsxs("div",{className:"color-item",children:[a.jsxs("div",{className:"color-item__info",children:[a.jsx("span",{className:"color-item__name",children:(k==null?void 0:k.name)||"Select Colour"}),k&&a.jsx("span",{className:"color-item__code",children:k.tpv_code})]}),a.jsx("button",{className:"color-item__swatch",style:{backgroundColor:(k==null?void 0:k.hex)||"#1C1C1C"},onClick:()=>h(!0),title:(k==null?void 0:k.name)||"Select colour"})]})]}),a.jsx("div",{className:"properties-section__divider",style:{margin:"1rem 0"},children:a.jsx("span",{children:"Transform"})}),a.jsxs("div",{className:"property-group",children:[a.jsx("label",{children:"Position"}),a.jsxs("div",{className:"property-input-row",children:[a.jsxs("div",{className:"property-input-group",children:[a.jsx("span",{className:"property-label",children:"X"}),a.jsx("input",{type:"number",value:Math.round(b.x),onChange:I=>N("x",I.target.value),step:"100"}),a.jsx("span",{className:"property-unit",children:"mm"})]}),a.jsxs("div",{className:"property-input-group",children:[a.jsx("span",{className:"property-label",children:"Y"}),a.jsx("input",{type:"number",value:Math.round(b.y),onChange:I=>N("y",I.target.value),step:"100"}),a.jsx("span",{className:"property-unit",children:"mm"})]})]})]}),a.jsxs("div",{className:"property-group",children:[a.jsx("label",{children:"Rotation"}),a.jsxs("div",{className:"property-input-row",children:[a.jsx("input",{type:"range",min:"0",max:"360",value:w||0,onChange:I=>S(I.target.value),className:"property-slider"}),a.jsxs("div",{className:"property-input-group property-input-group--compact",children:[a.jsx("input",{type:"number",value:Math.round(w||0),onChange:I=>S(I.target.value),min:"0",max:"360"}),a.jsx("span",{className:"property-unit",children:""})]})]})]}),a.jsx("div",{className:"properties-section__divider",style:{margin:"1rem 0"},children:a.jsx("span",{children:"Actions"})}),a.jsx("div",{className:"property-group property-group--actions",children:a.jsx("button",{className:"btn-secondary",onClick:D,title:"Duplicate text (Ctrl+D)",style:{width:"100%",padding:"0.5rem",background:"#f3f4f6",border:"1px solid #e4e9f0",borderRadius:"6px",fontSize:"0.875rem",fontFamily:"inherit",cursor:"pointer",marginBottom:"0.5rem"},children:" Duplicate Text"})}),a.jsx("div",{className:"property-group property-group--actions",children:a.jsx("button",{className:"btn-delete",onClick:le,title:"Delete text (Delete key)",children:" Delete Text"})}),a.jsx("div",{className:"property-group",children:a.jsx("div",{className:"property-hint",style:{fontStyle:"normal",color:"#64748b",fontSize:"0.75rem",marginTop:"1rem"},children:" Tip: Double-click text on canvas to edit inline. Drag corners to change font size. Hold Shift while rotating to snap to 15 increments."})})]})}),f&&a.jsx("div",{className:"color-picker-modal",onClick:()=>h(!1),children:a.jsxs("div",{className:"color-picker-modal__content",onClick:I=>I.stopPropagation(),children:[a.jsxs("div",{className:"color-picker-modal__header",children:[a.jsx("h4",{children:"Select Text Colour"}),a.jsx("button",{onClick:()=>h(!1),children:""})]}),a.jsx("div",{className:"color-picker-grid",children:Sr.map(I=>a.jsx("button",{className:"color-picker-swatch",style:{backgroundColor:I.hex},onClick:()=>K(I),title:`${I.code} - ${I.name}`,children:a.jsx("span",{className:"color-picker-swatch__code",children:I.code})},I.code))})]})})]})}function H5(){const{courts:t,tracks:e,motifs:r,shapes:n,texts:i,elementOrder:s,selectedCourtId:o,selectedTrackId:l,selectedMotifId:c,selectedShapeId:d,selectedTextId:u,setElementOrder:f,selectCourt:h,selectTrack:p,selectMotif:g,selectShape:m,selectText:x,bringToFront:v,sendToBack:y,duplicateCourt:b,duplicateTrack:w,duplicateMotif:k,duplicateShape:_,duplicateText:C,removeCourt:N,removeTrack:T,removeMotif:O,removeShape:X,removeText:E,renameElement:F,toggleElementLock:S,toggleElementVisibility:K,addToHistory:le}=st(),[D,I]=P.useState(null),[L,Z]=P.useState(null),[H,G]=P.useState(null),[ee,oe]=P.useState(null),[fe,Oe]=P.useState("");P.useEffect(()=>{const A=()=>G(null);if(H)return document.addEventListener("click",A),()=>document.removeEventListener("click",A)},[H]);const $e=[...s].reverse(),Ie=A=>{var Y,se,we;if(A.startsWith("court-")){const ne=t[A];return{type:"court",name:(ne==null?void 0:ne.customName)||((Y=ne==null?void 0:ne.template)==null?void 0:Y.name)||"Unknown Court",icon:"",sport:((se=ne==null?void 0:ne.template)==null?void 0:se.sport)||"",locked:(ne==null?void 0:ne.locked)||!1,visible:(ne==null?void 0:ne.visible)!==!1}}else if(A.startsWith("track-")){const ne=e[A];return{type:"track",name:(ne==null?void 0:ne.customName)||((we=ne==null?void 0:ne.template)==null?void 0:we.name)||"Unknown Track",icon:"",sport:"athletics",locked:(ne==null?void 0:ne.locked)||!1,visible:(ne==null?void 0:ne.visible)!==!1}}else if(A.startsWith("motif-")){const ne=r[A];return{type:"motif",name:(ne==null?void 0:ne.customName)||(ne==null?void 0:ne.sourceDesignName)||"Unknown Motif",icon:"",sport:"playground",locked:(ne==null?void 0:ne.locked)||!1,visible:(ne==null?void 0:ne.visible)!==!1}}else if(A.startsWith("shape-")){const ne=n[A],Se=(ne==null?void 0:ne.sides)>=32?"Circle":(ne==null?void 0:ne.sides)===3?"Triangle":(ne==null?void 0:ne.sides)===4?"Rectangle":`${ne==null?void 0:ne.sides}-gon`;return{type:"shape",name:(ne==null?void 0:ne.customName)||Se||"Unknown Shape",icon:(ne==null?void 0:ne.sides)>=32?"":(ne==null?void 0:ne.sides)===3?"":(ne==null?void 0:ne.sides)===4?"":"",sport:"shape",locked:(ne==null?void 0:ne.locked)||!1,visible:(ne==null?void 0:ne.visible)!==!1}}else if(A.startsWith("text-")){const ne=i[A],Se=(ne==null?void 0:ne.content)||"Text Label",ke=Se.length>20?Se.substring(0,20)+"...":Se;return{type:"text",name:(ne==null?void 0:ne.customName)||ke,icon:"T",sport:"text",locked:(ne==null?void 0:ne.locked)||!1,visible:(ne==null?void 0:ne.visible)!==!1}}return{type:"unknown",name:"Unknown",icon:"",sport:"",locked:!1,visible:!0}},Ee=A=>A===o||A===l||A===c||A===d||A===u,ge=A=>{A.startsWith("court-")?h(A):A.startsWith("track-")?p(A):A.startsWith("motif-")?g(A):A.startsWith("shape-")?m(A):A.startsWith("text-")&&x(A)},me=(A,Y)=>{I(Y),A.dataTransfer.effectAllowed="move",A.dataTransfer.setData("text/plain",Y),setTimeout(()=>{A.target.classList.add("layer-item--dragging")},0)},He=A=>{A.target.classList.remove("layer-item--dragging"),I(null),Z(null)},ue=(A,Y)=>{A.preventDefault(),A.dataTransfer.dropEffect="move",Y!==D&&Z(Y)},j=()=>{Z(null)},ce=(A,Y)=>{if(A.preventDefault(),!D||D===Y){I(null),Z(null);return}const se=[...s],we=se.indexOf(D),ne=se.indexOf(Y);if(we===-1||ne===-1)return;se.splice(we,1);const Se=$e.indexOf(D),ke=$e.indexOf(Y);Se<ke,se.splice(ne,0,D),f(se),le(),I(null),Z(null)},re=(A,Y)=>{A.stopPropagation(),v(Y),G(null)},z=(A,Y)=>{A.stopPropagation(),y(Y),G(null)},R=(A,Y)=>{A.stopPropagation(),Y.startsWith("court-")?b(Y):Y.startsWith("track-")?w(Y):Y.startsWith("motif-")?k(Y):Y.startsWith("shape-")?_(Y):Y.startsWith("text-")&&C(Y),G(null)},U=(A,Y)=>{A.stopPropagation();const se=Ie(Y);confirm(`Delete "${se.name}"?`)&&(Y.startsWith("court-")?N(Y):Y.startsWith("track-")?T(Y):Y.startsWith("motif-")?O(Y):Y.startsWith("shape-")?X(Y):Y.startsWith("text-")&&E(Y)),G(null)},ae=(A,Y)=>{A.stopPropagation();const se=Ie(Y);oe(Y),Oe(se.name),G(null)},q=A=>{fe.trim()&&F(A,fe.trim()),oe(null),Oe("")},M=(A,Y)=>{A.key==="Enter"?q(Y):A.key==="Escape"&&(oe(null),Oe(""))},J=(A,Y)=>{A.stopPropagation(),S(Y),G(null)},de=(A,Y)=>{A.stopPropagation(),K(Y),G(null)},ie=(A,Y)=>{A.stopPropagation(),G(H===Y?null:Y)};return s.length===0?a.jsx("div",{className:"layers-panel layers-panel--empty",children:a.jsxs("div",{className:"layers-panel__empty-state",children:[a.jsx("span",{className:"layers-panel__empty-icon",children:""}),a.jsx("p",{children:"No elements yet"}),a.jsx("span",{className:"layers-panel__empty-hint",children:"Add courts, tracks, motifs, shapes, or text"})]})}):a.jsxs("div",{className:"layers-panel",children:[a.jsxs("div",{className:"layers-panel__header",children:[a.jsx("h4",{children:"Layers"}),a.jsx("span",{className:"layers-panel__count",children:s.length})]}),a.jsx("div",{className:"layers-panel__hint",children:"Drag to reorder layers. Top = front, bottom = back."}),a.jsx("div",{className:"layers-panel__list",children:$e.map((A,Y)=>{const se=Ie(A),we=Ee(A),ne=A===L,Se=Y===0,ke=Y===$e.length-1,Ce=ee===A;return a.jsxs("div",{className:`layer-item ${we?"layer-item--selected":""} ${ne?"layer-item--drag-over":""} ${se.locked?"layer-item--locked":""} ${se.visible?"":"layer-item--hidden"}`,draggable:!se.locked&&!Ce,onDragStart:xe=>me(xe,A),onDragEnd:He,onDragOver:xe=>ue(xe,A),onDragLeave:j,onDrop:xe=>ce(xe,A),onClick:()=>!Ce&&ge(A),children:[a.jsx("span",{className:`layer-item__handle ${se.locked?"layer-item__handle--disabled":""}`,title:se.locked?"Locked":"Drag to reorder",children:se.locked?"":""}),Ce?a.jsx("input",{type:"text",className:"layer-item__rename-input",value:fe,onChange:xe=>Oe(xe.target.value),onBlur:()=>q(A),onKeyDown:xe=>M(xe,A),autoFocus:!0,onClick:xe=>xe.stopPropagation()}):a.jsx("span",{className:`layer-item__name ${se.visible?"":"layer-item__name--hidden"}`,children:se.name}),a.jsx("div",{className:"layer-item__indicators",children:!se.visible&&a.jsx("span",{className:"layer-item__indicator",title:"Hidden",children:""})}),a.jsxs("div",{className:"layer-item__actions",children:[a.jsx("button",{className:"layer-item__menu-btn",onClick:xe=>ie(xe,A),title:"More actions",children:""}),H===A&&a.jsxs("div",{className:"layer-item__menu",children:[a.jsx("button",{onClick:xe=>re(xe,A),disabled:Se,children:" Bring to Front"}),a.jsx("button",{onClick:xe=>z(xe,A),disabled:ke,children:" Send to Back"}),a.jsx("div",{className:"layer-item__menu-divider"}),a.jsx("button",{onClick:xe=>R(xe,A),children:" Duplicate"}),a.jsx("button",{onClick:xe=>ae(xe,A),children:" Rename"}),a.jsx("div",{className:"layer-item__menu-divider"}),a.jsx("button",{onClick:xe=>J(xe,A),children:se.locked?" Unlock":" Lock"}),a.jsx("button",{onClick:xe=>de(xe,A),children:se.visible?" Hide":" Show"}),a.jsx("div",{className:"layer-item__menu-divider"}),a.jsx("button",{onClick:xe=>U(xe,A),className:"layer-item__menu-delete",children:" Delete"})]})]})]},A)})}),a.jsx("div",{className:"layers-panel__footer",children:a.jsx("span",{className:"layers-panel__shortcut-hint",children:"Tip: Use [ and ] keys to reorder selected element"})})]})}async function Hw(){var r,n;const t=await Vt.auth.getSession(),e=(n=(r=t==null?void 0:t.data)==null?void 0:r.session)==null?void 0:n.access_token;if(!e)throw new Error("Not authenticated");return{"Content-Type":"application/json",Authorization:`Bearer ${e}`}}async function Uw(t){const e=await Hw(),r=await fetch("/api/projects/create",{method:"POST",headers:e,body:JSON.stringify(t)});if(!r.ok){const n=await r.json();throw new Error(n.error||"Unable to create project. Please check your connection and try again.")}return r.json()}async function bp(){const t=await Hw(),e=await fetch("/api/projects/list",{method:"GET",headers:t});if(!e.ok){const r=await e.json();throw new Error(r.error||"Unable to load your projects. Please refresh the page and try again.")}return e.json()}function U5(t,e={}){var r,n;return{type:"sports_surface",version:"1.0",name:e.name||t.name||"Untitled Design",description:e.description||t.description||"",tags:e.tags||t.tags||[],surface:t.surface,courts:W5(t.courts),tracks:G5(t.tracks),motifs:V5(t.motifs),elementOrder:t.elementOrder||[],customMarkings:t.customMarkings||[],backgroundZones:t.backgroundZones||[],dimensions:{width_mm:((r=t.surface)==null?void 0:r.width_mm)||5e4,length_mm:((n=t.surface)==null?void 0:n.length_mm)||5e4}}}function W5(t){return t?Object.fromEntries(Object.entries(t).map(([e,r])=>[e,{id:r.id,templateId:r.templateId,template:r.template,position:r.position,rotation:r.rotation,scale:r.scale,lineColorOverrides:r.lineColorOverrides||{},zoneColorOverrides:r.zoneColorOverrides||{},courtSurfaceColor:r.courtSurfaceColor}])):{}}function G5(t){return t?Object.fromEntries(Object.entries(t).map(([e,r])=>[e,{id:r.id,templateId:r.templateId,template:r.template,position:r.position,rotation:r.rotation,parameters:r.parameters,trackSurfaceColor:r.trackSurfaceColor}])):{}}function V5(t){return t?Object.fromEntries(Object.entries(t).map(([e,r])=>[e,{id:r.id,type:"motif",sourceDesignId:r.sourceDesignId,sourceDesignName:r.sourceDesignName,sourceThumbnailUrl:r.sourceThumbnailUrl,svgContent:r.svgContent,originalWidth_mm:r.originalWidth_mm,originalHeight_mm:r.originalHeight_mm,position:r.position,rotation:r.rotation,scale:r.scale}])):{}}function q5(t){var n,i;const e=[];return t.surface||e.push("Surface configuration is required"),(!((n=t.surface)!=null&&n.width_mm)||!((i=t.surface)!=null&&i.length_mm))&&e.push("Surface dimensions are required"),t.courts&&Object.keys(t.courts).length>0||t.tracks&&Object.keys(t.tracks).length>0||t.motifs&&Object.keys(t.motifs).length>0||e.push("Add at least one court, track, or motif to save"),{valid:e.length===0,errors:e}}async function Y5(t,e=400){return new Promise((r,n)=>{try{const i=t.cloneNode(!0);i.querySelectorAll(".court-canvas__court--selected, .transform-handles").forEach(g=>{g.classList.remove("court-canvas__court--selected")}),i.querySelectorAll(".transform-handles").forEach(g=>g.remove());const s=t.getAttribute("viewBox").split(" ").map(Number),o=s[2],l=s[3];let c,d;o>l?(c=e,d=Math.round(l/o*e)):(d=e,c=Math.round(o/l*e)),i.setAttribute("width",c),i.setAttribute("height",d);const u=new XMLSerializer().serializeToString(i),f=new Blob([u],{type:"image/svg+xml;charset=utf-8"}),h=URL.createObjectURL(f),p=new Image;p.onload=()=>{const g=document.createElement("canvas");g.width=c,g.height=d;const m=g.getContext("2d");m.fillStyle="#ffffff",m.fillRect(0,0,c,d),m.drawImage(p,0,0,c,d),g.toBlob(x=>{URL.revokeObjectURL(h),r(x)},"image/png",.9)},p.onerror=g=>{URL.revokeObjectURL(h),n(new Error("Failed to load SVG for thumbnail"))},p.src=h}catch(i){n(i)}})}async function X5(t){const r=`thumbnails/sports/${`sports-${Date.now()}-${Math.random().toString(36).substr(2,9)}.png`}`,{data:n,error:i}=await Vt.storage.from("tpv-studio-uploads").upload(r,t,{cacheControl:"3600",contentType:"image/png",upsert:!1});if(i)throw i;const{data:{publicUrl:s}}=Vt.storage.from("tpv-studio-uploads").getPublicUrl(r);return s}function K5({existingDesignId:t=null,initialName:e="",svgRef:r=null,onClose:n,onSaved:i}){const s=st(Z=>Z.exportDesignData),[o,l]=P.useState(e),[c,d]=P.useState(""),[u,f]=P.useState(""),[h,p]=P.useState(""),[g,m]=P.useState(!1),[x,v]=P.useState([]),[y,b]=P.useState(!1),[w,k]=P.useState(""),[_,C]=P.useState("#1a365d"),[N,T]=P.useState(!1),[O,X]=P.useState(!1),[E,F]=P.useState(!1),[S,K]=P.useState(null);P.useEffect(()=>{le()},[]);const le=async()=>{try{const{projects:Z}=await bp();v(Z)}catch(Z){console.error("Failed to load projects:",Z),K("Failed to load projects")}},D=async()=>{if(!w.trim()){K("Project name is required");return}F(!0),K(null);try{const{project:Z}=await Uw({name:w.trim(),color:_});v([Z,...x]),f(Z.id),b(!1),k(""),C("#1a365d")}catch(Z){console.error("Failed to create project:",Z),K(Z.message)}finally{F(!1)}},I=async(Z=!1)=>{if(!o.trim()){K("Design name is required");return}const H=s(),G=q5(H);if(!G.valid){K(G.errors.join(", "));return}Z?X(!0):T(!0),K(null);try{let ee=null;if(r!=null&&r.current)try{console.log("[SPORTS-SAVE] Generating thumbnail...");const $e=await Y5(r.current);console.log("[SPORTS-SAVE] Uploading thumbnail..."),ee=await X5($e),console.log("[SPORTS-SAVE] Thumbnail uploaded:",ee)}catch($e){console.warn("[SPORTS-SAVE] Thumbnail generation failed, continuing without:",$e)}const oe=U5(H,{name:o.trim(),description:c.trim()||"",tags:h.split(",").map($e=>$e.trim()).filter($e=>$e)});console.log("[SPORTS-SAVE] Serialized design data:",oe);const fe={name:o.trim(),description:c.trim()||null,project_id:u||null,tags:h.split(",").map($e=>$e.trim()).filter($e=>$e),is_public:g,design_data:oe,thumbnail_url:ee};t&&!Z&&(fe.id=t);const Oe=await vp(fe);i&&i(Oe,o.trim()),n()}catch(ee){console.error("Failed to save design:",ee),K(ee.message)}finally{T(!1),X(!1)}},L=["#1a365d","#ff6b35","#4a90e2","#50c878","#9b59b6","#e74c3c"];return a.jsx("div",{className:"modal-overlay",onClick:n,children:a.jsxs("div",{className:"modal-content save-design-modal",onClick:Z=>Z.stopPropagation(),children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h2",{children:t?"Update Design":"Save Design"}),a.jsx("button",{onClick:n,className:"close-button",children:""})]}),a.jsxs("div",{className:"modal-body",children:[S&&a.jsx("div",{className:"error-message",children:S}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"design-name",children:"Design Name *"}),a.jsx("input",{id:"design-name",type:"text",value:o,onChange:Z=>l(Z.target.value),placeholder:"e.g., Multi-Sport Court Design",autoFocus:!0,disabled:N||O})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"design-description",children:"Description"}),a.jsx("textarea",{id:"design-description",value:c,onChange:Z=>d(Z.target.value),placeholder:"Optional notes about this sports surface design...",rows:3,disabled:N||O})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"design-project",children:"Project"}),y?a.jsxs("div",{className:"new-project-form",children:[a.jsxs("div",{className:"input-row",children:[a.jsx("input",{type:"text",value:w,onChange:Z=>k(Z.target.value),placeholder:"Project name...",disabled:E}),a.jsx("div",{className:"color-picker-inline",children:L.map(Z=>a.jsx("button",{type:"button",className:`color-swatch ${_===Z?"active":""}`,style:{backgroundColor:Z},onClick:()=>C(Z),disabled:E},Z))})]}),a.jsxs("div",{className:"button-row",children:[a.jsx("button",{type:"button",onClick:D,className:"btn-primary btn-small",disabled:E,children:E?"Creating...":"Create"}),a.jsx("button",{type:"button",onClick:()=>b(!1),className:"btn-secondary btn-small",disabled:E,children:"Cancel"})]})]}):a.jsxs("div",{className:"project-selector",children:[a.jsxs("select",{id:"design-project",value:u,onChange:Z=>f(Z.target.value),disabled:N||O,children:[a.jsx("option",{value:"",children:"No Project"}),x.map(Z=>a.jsxs("option",{value:Z.id,children:[Z.name," (",Z.design_count," designs)"]},Z.id))]}),a.jsx("button",{type:"button",onClick:()=>b(!0),className:"btn-secondary btn-small",disabled:N||O,children:"+ New Project"})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"design-tags",children:"Tags"}),a.jsx("input",{id:"design-tags",type:"text",value:h,onChange:Z=>p(Z.target.value),placeholder:"e.g., tennis, multi-sport, school (comma-separated)",disabled:N||O}),a.jsx("small",{className:"help-text",children:"Separate tags with commas"})]}),a.jsx("div",{className:"form-group checkbox-group",children:a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:g,onChange:Z=>m(Z.target.checked),disabled:N||O}),a.jsx("span",{children:"Make this design public (shareable link)"})]})})]}),a.jsxs("div",{className:"modal-footer",children:[a.jsx("button",{onClick:n,className:"btn-secondary",disabled:N||O,children:"Cancel"}),t&&a.jsx("button",{onClick:()=>I(!0),className:"btn-secondary",disabled:N||O,children:O?"Saving...":"Save as New"}),a.jsx("button",{onClick:()=>I(!1),className:"btn-primary",disabled:N||O,children:N?"Saving...":t?"Update":"Save Design"})]})]})})}function wp(t,e){var f,h,p,g;if(!t)throw new Error("SVG element not found");const r=t.cloneNode(!0);r.querySelectorAll('.court-canvas__selection-outline, .transform-handles, [class*="selection"], [class*="handle"]').forEach(m=>m.remove()),r.querySelectorAll("[stroke-dasharray]").forEach(m=>{m.getAttribute("stroke-dasharray")&&m.remove()});const s=document.createElementNS("http://www.w3.org/2000/svg","title");s.textContent=(e==null?void 0:e.name)||"Sports Surface Design",r.insertBefore(s,r.firstChild);const o=document.createElementNS("http://www.w3.org/2000/svg","desc");o.textContent=`Generated by TPV Designer. Dimensions: ${(((f=e==null?void 0:e.surface)==null?void 0:f.width_mm)/1e3).toFixed(1)}m  ${(((h=e==null?void 0:e.surface)==null?void 0:h.length_mm)/1e3).toFixed(1)}m`,r.insertBefore(o,r.firstChild.nextSibling),r.setAttribute("xmlns","http://www.w3.org/2000/svg"),r.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");const l=((p=e==null?void 0:e.surface)==null?void 0:p.width_mm)||5e4,c=((g=e==null?void 0:e.surface)==null?void 0:g.length_mm)||5e4;r.setAttribute("width",`${l}mm`),r.setAttribute("height",`${c}mm`),r.setAttribute("data-tpv-studio","1.0"),r.setAttribute("data-design-type","sports_surface");let u=new XMLSerializer().serializeToString(r);return u=`<?xml version="1.0" encoding="UTF-8"?>
`+u,u}function Z5(t,e="sports-surface.svg"){const r=new Blob([t],{type:"image/svg+xml"}),n=URL.createObjectURL(r),i=document.createElement("a");i.href=n,i.download=e,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(n)}async function J5(t,e,r="sports-surface.png",n=2){return new Promise((i,s)=>{try{const o=wp(t,e),l=document.createElement("canvas"),c=l.getContext("2d"),d=t.getAttribute("viewBox");let u=1200,f=1200;if(d){const[,,m,x]=d.split(" ").map(Number),v=2400,y=x/m;u=Math.min(m/10,v),f=u*y}l.width=u*n,l.height=f*n;const h=new Image,p=new Blob([o],{type:"image/svg+xml;charset=utf-8"}),g=URL.createObjectURL(p);h.onload=()=>{c.fillStyle="#ffffff",c.fillRect(0,0,l.width,l.height),c.drawImage(h,0,0,l.width,l.height),l.toBlob(m=>{if(!m){s(new Error("Failed to create PNG blob"));return}const x=URL.createObjectURL(m),v=document.createElement("a");v.href=x,v.download=r,document.body.appendChild(v),v.click(),document.body.removeChild(v),URL.revokeObjectURL(g),URL.revokeObjectURL(x),i()},"image/png",.95)},h.onerror=m=>{URL.revokeObjectURL(g),s(new Error("Failed to load SVG for PNG conversion"))},h.src=g}catch(o){s(o)}})}function Nu(t,e){const r=(t||"sports-surface").toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"").substring(0,50),n=new Date().toISOString().split("T")[0];return`${r}_${n}.${e}`}function Xl(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Ww={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(t,e){(function(r){t.exports=r()})(function(){return function r(n,i,s){function o(d,u){if(!i[d]){if(!n[d]){var f=typeof Xl=="function"&&Xl;if(!u&&f)return f(d,!0);if(l)return l(d,!0);var h=new Error("Cannot find module '"+d+"'");throw h.code="MODULE_NOT_FOUND",h}var p=i[d]={exports:{}};n[d][0].call(p.exports,function(g){var m=n[d][1][g];return o(m||g)},p,p.exports,r,n,i,s)}return i[d].exports}for(var l=typeof Xl=="function"&&Xl,c=0;c<s.length;c++)o(s[c]);return o}({1:[function(r,n,i){var s=r("./utils"),o=r("./support"),l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(c){for(var d,u,f,h,p,g,m,x=[],v=0,y=c.length,b=y,w=s.getTypeOf(c)!=="string";v<c.length;)b=y-v,f=w?(d=c[v++],u=v<y?c[v++]:0,v<y?c[v++]:0):(d=c.charCodeAt(v++),u=v<y?c.charCodeAt(v++):0,v<y?c.charCodeAt(v++):0),h=d>>2,p=(3&d)<<4|u>>4,g=1<b?(15&u)<<2|f>>6:64,m=2<b?63&f:64,x.push(l.charAt(h)+l.charAt(p)+l.charAt(g)+l.charAt(m));return x.join("")},i.decode=function(c){var d,u,f,h,p,g,m=0,x=0,v="data:";if(c.substr(0,v.length)===v)throw new Error("Invalid base64 input, it looks like a data url.");var y,b=3*(c=c.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(c.charAt(c.length-1)===l.charAt(64)&&b--,c.charAt(c.length-2)===l.charAt(64)&&b--,b%1!=0)throw new Error("Invalid base64 input, bad content length.");for(y=o.uint8array?new Uint8Array(0|b):new Array(0|b);m<c.length;)d=l.indexOf(c.charAt(m++))<<2|(h=l.indexOf(c.charAt(m++)))>>4,u=(15&h)<<4|(p=l.indexOf(c.charAt(m++)))>>2,f=(3&p)<<6|(g=l.indexOf(c.charAt(m++))),y[x++]=d,p!==64&&(y[x++]=u),g!==64&&(y[x++]=f);return y}},{"./support":30,"./utils":32}],2:[function(r,n,i){var s=r("./external"),o=r("./stream/DataWorker"),l=r("./stream/Crc32Probe"),c=r("./stream/DataLengthProbe");function d(u,f,h,p,g){this.compressedSize=u,this.uncompressedSize=f,this.crc32=h,this.compression=p,this.compressedContent=g}d.prototype={getContentWorker:function(){var u=new o(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new c("data_length")),f=this;return u.on("end",function(){if(this.streamInfo.data_length!==f.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),u},getCompressedWorker:function(){return new o(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},d.createWorkerFrom=function(u,f,h){return u.pipe(new l).pipe(new c("uncompressedSize")).pipe(f.compressWorker(h)).pipe(new c("compressedSize")).withStreamInfo("compression",f)},n.exports=d},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(r,n,i){var s=r("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},i.DEFLATE=r("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(r,n,i){var s=r("./utils"),o=function(){for(var l,c=[],d=0;d<256;d++){l=d;for(var u=0;u<8;u++)l=1&l?3988292384^l>>>1:l>>>1;c[d]=l}return c}();n.exports=function(l,c){return l!==void 0&&l.length?s.getTypeOf(l)!=="string"?function(d,u,f,h){var p=o,g=h+f;d^=-1;for(var m=h;m<g;m++)d=d>>>8^p[255&(d^u[m])];return-1^d}(0|c,l,l.length,0):function(d,u,f,h){var p=o,g=h+f;d^=-1;for(var m=h;m<g;m++)d=d>>>8^p[255&(d^u.charCodeAt(m))];return-1^d}(0|c,l,l.length,0):0}},{"./utils":32}],5:[function(r,n,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(r,n,i){var s=null;s=typeof Promise<"u"?Promise:r("lie"),n.exports={Promise:s}},{lie:37}],7:[function(r,n,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",o=r("pako"),l=r("./utils"),c=r("./stream/GenericWorker"),d=s?"uint8array":"array";function u(f,h){c.call(this,"FlateWorker/"+f),this._pako=null,this._pakoAction=f,this._pakoOptions=h,this.meta={}}i.magic="\b\0",l.inherits(u,c),u.prototype.processChunk=function(f){this.meta=f.meta,this._pako===null&&this._createPako(),this._pako.push(l.transformTo(d,f.data),!1)},u.prototype.flush=function(){c.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},u.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this._pako=null},u.prototype._createPako=function(){this._pako=new o[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var f=this;this._pako.onData=function(h){f.push({data:h,meta:f.meta})}},i.compressWorker=function(f){return new u("Deflate",f)},i.uncompressWorker=function(){return new u("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(r,n,i){function s(p,g){var m,x="";for(m=0;m<g;m++)x+=String.fromCharCode(255&p),p>>>=8;return x}function o(p,g,m,x,v,y){var b,w,k=p.file,_=p.compression,C=y!==d.utf8encode,N=l.transformTo("string",y(k.name)),T=l.transformTo("string",d.utf8encode(k.name)),O=k.comment,X=l.transformTo("string",y(O)),E=l.transformTo("string",d.utf8encode(O)),F=T.length!==k.name.length,S=E.length!==O.length,K="",le="",D="",I=k.dir,L=k.date,Z={crc32:0,compressedSize:0,uncompressedSize:0};g&&!m||(Z.crc32=p.crc32,Z.compressedSize=p.compressedSize,Z.uncompressedSize=p.uncompressedSize);var H=0;g&&(H|=8),C||!F&&!S||(H|=2048);var G=0,ee=0;I&&(G|=16),v==="UNIX"?(ee=798,G|=function(fe,Oe){var $e=fe;return fe||($e=Oe?16893:33204),(65535&$e)<<16}(k.unixPermissions,I)):(ee=20,G|=function(fe){return 63&(fe||0)}(k.dosPermissions)),b=L.getUTCHours(),b<<=6,b|=L.getUTCMinutes(),b<<=5,b|=L.getUTCSeconds()/2,w=L.getUTCFullYear()-1980,w<<=4,w|=L.getUTCMonth()+1,w<<=5,w|=L.getUTCDate(),F&&(le=s(1,1)+s(u(N),4)+T,K+="up"+s(le.length,2)+le),S&&(D=s(1,1)+s(u(X),4)+E,K+="uc"+s(D.length,2)+D);var oe="";return oe+=`
\0`,oe+=s(H,2),oe+=_.magic,oe+=s(b,2),oe+=s(w,2),oe+=s(Z.crc32,4),oe+=s(Z.compressedSize,4),oe+=s(Z.uncompressedSize,4),oe+=s(N.length,2),oe+=s(K.length,2),{fileRecord:f.LOCAL_FILE_HEADER+oe+N+K,dirRecord:f.CENTRAL_FILE_HEADER+s(ee,2)+oe+s(X.length,2)+"\0\0\0\0"+s(G,4)+s(x,4)+N+K+X}}var l=r("../utils"),c=r("../stream/GenericWorker"),d=r("../utf8"),u=r("../crc32"),f=r("../signature");function h(p,g,m,x){c.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=g,this.zipPlatform=m,this.encodeFileName=x,this.streamFiles=p,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}l.inherits(h,c),h.prototype.push=function(p){var g=p.meta.percent||0,m=this.entriesCount,x=this._sources.length;this.accumulate?this.contentBuffer.push(p):(this.bytesWritten+=p.data.length,c.prototype.push.call(this,{data:p.data,meta:{currentFile:this.currentFile,percent:m?(g+100*(m-x-1))/m:100}}))},h.prototype.openedSource=function(p){this.currentSourceOffset=this.bytesWritten,this.currentFile=p.file.name;var g=this.streamFiles&&!p.file.dir;if(g){var m=o(p,g,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:m.fileRecord,meta:{percent:0}})}else this.accumulate=!0},h.prototype.closedSource=function(p){this.accumulate=!1;var g=this.streamFiles&&!p.file.dir,m=o(p,g,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(m.dirRecord),g)this.push({data:function(x){return f.DATA_DESCRIPTOR+s(x.crc32,4)+s(x.compressedSize,4)+s(x.uncompressedSize,4)}(p),meta:{percent:100}});else for(this.push({data:m.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},h.prototype.flush=function(){for(var p=this.bytesWritten,g=0;g<this.dirRecords.length;g++)this.push({data:this.dirRecords[g],meta:{percent:100}});var m=this.bytesWritten-p,x=function(v,y,b,w,k){var _=l.transformTo("string",k(w));return f.CENTRAL_DIRECTORY_END+"\0\0\0\0"+s(v,2)+s(v,2)+s(y,4)+s(b,4)+s(_.length,2)+_}(this.dirRecords.length,m,p,this.zipComment,this.encodeFileName);this.push({data:x,meta:{percent:100}})},h.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},h.prototype.registerPrevious=function(p){this._sources.push(p);var g=this;return p.on("data",function(m){g.processChunk(m)}),p.on("end",function(){g.closedSource(g.previous.streamInfo),g._sources.length?g.prepareNextSource():g.end()}),p.on("error",function(m){g.error(m)}),this},h.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},h.prototype.error=function(p){var g=this._sources;if(!c.prototype.error.call(this,p))return!1;for(var m=0;m<g.length;m++)try{g[m].error(p)}catch{}return!0},h.prototype.lock=function(){c.prototype.lock.call(this);for(var p=this._sources,g=0;g<p.length;g++)p[g].lock()},n.exports=h},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(r,n,i){var s=r("../compressions"),o=r("./ZipFileWorker");i.generateWorker=function(l,c,d){var u=new o(c.streamFiles,d,c.platform,c.encodeFileName),f=0;try{l.forEach(function(h,p){f++;var g=function(y,b){var w=y||b,k=s[w];if(!k)throw new Error(w+" is not a valid compression method !");return k}(p.options.compression,c.compression),m=p.options.compressionOptions||c.compressionOptions||{},x=p.dir,v=p.date;p._compressWorker(g,m).withStreamInfo("file",{name:h,dir:x,date:v,comment:p.comment||"",unixPermissions:p.unixPermissions,dosPermissions:p.dosPermissions}).pipe(u)}),u.entriesCount=f}catch(h){u.error(h)}return u}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(r,n,i){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var o=new s;for(var l in this)typeof this[l]!="function"&&(o[l]=this[l]);return o}}(s.prototype=r("./object")).loadAsync=r("./load"),s.support=r("./support"),s.defaults=r("./defaults"),s.version="3.10.1",s.loadAsync=function(o,l){return new s().loadAsync(o,l)},s.external=r("./external"),n.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(r,n,i){var s=r("./utils"),o=r("./external"),l=r("./utf8"),c=r("./zipEntries"),d=r("./stream/Crc32Probe"),u=r("./nodejsUtils");function f(h){return new o.Promise(function(p,g){var m=h.decompressed.getContentWorker().pipe(new d);m.on("error",function(x){g(x)}).on("end",function(){m.streamInfo.crc32!==h.decompressed.crc32?g(new Error("Corrupted zip : CRC32 mismatch")):p()}).resume()})}n.exports=function(h,p){var g=this;return p=s.extend(p||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:l.utf8decode}),u.isNode&&u.isStream(h)?o.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",h,!0,p.optimizedBinaryString,p.base64).then(function(m){var x=new c(p);return x.load(m),x}).then(function(m){var x=[o.Promise.resolve(m)],v=m.files;if(p.checkCRC32)for(var y=0;y<v.length;y++)x.push(f(v[y]));return o.Promise.all(x)}).then(function(m){for(var x=m.shift(),v=x.files,y=0;y<v.length;y++){var b=v[y],w=b.fileNameStr,k=s.resolve(b.fileNameStr);g.file(k,b.decompressed,{binary:!0,optimizedBinaryString:!0,date:b.date,dir:b.dir,comment:b.fileCommentStr.length?b.fileCommentStr:null,unixPermissions:b.unixPermissions,dosPermissions:b.dosPermissions,createFolders:p.createFolders}),b.dir||(g.file(k).unsafeOriginalName=w)}return x.zipComment.length&&(g.comment=x.zipComment),g})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(r,n,i){var s=r("../utils"),o=r("../stream/GenericWorker");function l(c,d){o.call(this,"Nodejs stream input adapter for "+c),this._upstreamEnded=!1,this._bindStream(d)}s.inherits(l,o),l.prototype._bindStream=function(c){var d=this;(this._stream=c).pause(),c.on("data",function(u){d.push({data:u,meta:{percent:0}})}).on("error",function(u){d.isPaused?this.generatedError=u:d.error(u)}).on("end",function(){d.isPaused?d._upstreamEnded=!0:d.end()})},l.prototype.pause=function(){return!!o.prototype.pause.call(this)&&(this._stream.pause(),!0)},l.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=l},{"../stream/GenericWorker":28,"../utils":32}],13:[function(r,n,i){var s=r("readable-stream").Readable;function o(l,c,d){s.call(this,c),this._helper=l;var u=this;l.on("data",function(f,h){u.push(f)||u._helper.pause(),d&&d(h)}).on("error",function(f){u.emit("error",f)}).on("end",function(){u.push(null)})}r("../utils").inherits(o,s),o.prototype._read=function(){this._helper.resume()},n.exports=o},{"../utils":32,"readable-stream":16}],14:[function(r,n,i){n.exports={isNode:typeof Buffer<"u",newBufferFrom:function(s,o){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(s,o);if(typeof s=="number")throw new Error('The "data" argument must not be a number');return new Buffer(s,o)},allocBuffer:function(s){if(Buffer.alloc)return Buffer.alloc(s);var o=new Buffer(s);return o.fill(0),o},isBuffer:function(s){return Buffer.isBuffer(s)},isStream:function(s){return s&&typeof s.on=="function"&&typeof s.pause=="function"&&typeof s.resume=="function"}}},{}],15:[function(r,n,i){function s(k,_,C){var N,T=l.getTypeOf(_),O=l.extend(C||{},u);O.date=O.date||new Date,O.compression!==null&&(O.compression=O.compression.toUpperCase()),typeof O.unixPermissions=="string"&&(O.unixPermissions=parseInt(O.unixPermissions,8)),O.unixPermissions&&16384&O.unixPermissions&&(O.dir=!0),O.dosPermissions&&16&O.dosPermissions&&(O.dir=!0),O.dir&&(k=v(k)),O.createFolders&&(N=x(k))&&y.call(this,N,!0);var X=T==="string"&&O.binary===!1&&O.base64===!1;C&&C.binary!==void 0||(O.binary=!X),(_ instanceof f&&_.uncompressedSize===0||O.dir||!_||_.length===0)&&(O.base64=!1,O.binary=!0,_="",O.compression="STORE",T="string");var E=null;E=_ instanceof f||_ instanceof c?_:g.isNode&&g.isStream(_)?new m(k,_):l.prepareContent(k,_,O.binary,O.optimizedBinaryString,O.base64);var F=new h(k,E,O);this.files[k]=F}var o=r("./utf8"),l=r("./utils"),c=r("./stream/GenericWorker"),d=r("./stream/StreamHelper"),u=r("./defaults"),f=r("./compressedObject"),h=r("./zipObject"),p=r("./generate"),g=r("./nodejsUtils"),m=r("./nodejs/NodejsStreamInputAdapter"),x=function(k){k.slice(-1)==="/"&&(k=k.substring(0,k.length-1));var _=k.lastIndexOf("/");return 0<_?k.substring(0,_):""},v=function(k){return k.slice(-1)!=="/"&&(k+="/"),k},y=function(k,_){return _=_!==void 0?_:u.createFolders,k=v(k),this.files[k]||s.call(this,k,null,{dir:!0,createFolders:_}),this.files[k]};function b(k){return Object.prototype.toString.call(k)==="[object RegExp]"}var w={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(k){var _,C,N;for(_ in this.files)N=this.files[_],(C=_.slice(this.root.length,_.length))&&_.slice(0,this.root.length)===this.root&&k(C,N)},filter:function(k){var _=[];return this.forEach(function(C,N){k(C,N)&&_.push(N)}),_},file:function(k,_,C){if(arguments.length!==1)return k=this.root+k,s.call(this,k,_,C),this;if(b(k)){var N=k;return this.filter(function(O,X){return!X.dir&&N.test(O)})}var T=this.files[this.root+k];return T&&!T.dir?T:null},folder:function(k){if(!k)return this;if(b(k))return this.filter(function(T,O){return O.dir&&k.test(T)});var _=this.root+k,C=y.call(this,_),N=this.clone();return N.root=C.name,N},remove:function(k){k=this.root+k;var _=this.files[k];if(_||(k.slice(-1)!=="/"&&(k+="/"),_=this.files[k]),_&&!_.dir)delete this.files[k];else for(var C=this.filter(function(T,O){return O.name.slice(0,k.length)===k}),N=0;N<C.length;N++)delete this.files[C[N].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(k){var _,C={};try{if((C=l.extend(k||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:o.utf8encode})).type=C.type.toLowerCase(),C.compression=C.compression.toUpperCase(),C.type==="binarystring"&&(C.type="string"),!C.type)throw new Error("No output type specified.");l.checkSupport(C.type),C.platform!=="darwin"&&C.platform!=="freebsd"&&C.platform!=="linux"&&C.platform!=="sunos"||(C.platform="UNIX"),C.platform==="win32"&&(C.platform="DOS");var N=C.comment||this.comment||"";_=p.generateWorker(this,C,N)}catch(T){(_=new c("error")).error(T)}return new d(_,C.type||"string",C.mimeType)},generateAsync:function(k,_){return this.generateInternalStream(k).accumulate(_)},generateNodeStream:function(k,_){return(k=k||{}).type||(k.type="nodebuffer"),this.generateInternalStream(k).toNodejsStream(_)}};n.exports=w},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(r,n,i){n.exports=r("stream")},{stream:void 0}],17:[function(r,n,i){var s=r("./DataReader");function o(l){s.call(this,l);for(var c=0;c<this.data.length;c++)l[c]=255&l[c]}r("../utils").inherits(o,s),o.prototype.byteAt=function(l){return this.data[this.zero+l]},o.prototype.lastIndexOfSignature=function(l){for(var c=l.charCodeAt(0),d=l.charCodeAt(1),u=l.charCodeAt(2),f=l.charCodeAt(3),h=this.length-4;0<=h;--h)if(this.data[h]===c&&this.data[h+1]===d&&this.data[h+2]===u&&this.data[h+3]===f)return h-this.zero;return-1},o.prototype.readAndCheckSignature=function(l){var c=l.charCodeAt(0),d=l.charCodeAt(1),u=l.charCodeAt(2),f=l.charCodeAt(3),h=this.readData(4);return c===h[0]&&d===h[1]&&u===h[2]&&f===h[3]},o.prototype.readData=function(l){if(this.checkOffset(l),l===0)return[];var c=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},n.exports=o},{"../utils":32,"./DataReader":18}],18:[function(r,n,i){var s=r("../utils");function o(l){this.data=l,this.length=l.length,this.index=0,this.zero=0}o.prototype={checkOffset:function(l){this.checkIndex(this.index+l)},checkIndex:function(l){if(this.length<this.zero+l||l<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+l+"). Corrupted zip ?")},setIndex:function(l){this.checkIndex(l),this.index=l},skip:function(l){this.setIndex(this.index+l)},byteAt:function(){},readInt:function(l){var c,d=0;for(this.checkOffset(l),c=this.index+l-1;c>=this.index;c--)d=(d<<8)+this.byteAt(c);return this.index+=l,d},readString:function(l){return s.transformTo("string",this.readData(l))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var l=this.readInt(4);return new Date(Date.UTC(1980+(l>>25&127),(l>>21&15)-1,l>>16&31,l>>11&31,l>>5&63,(31&l)<<1))}},n.exports=o},{"../utils":32}],19:[function(r,n,i){var s=r("./Uint8ArrayReader");function o(l){s.call(this,l)}r("../utils").inherits(o,s),o.prototype.readData=function(l){this.checkOffset(l);var c=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},n.exports=o},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(r,n,i){var s=r("./DataReader");function o(l){s.call(this,l)}r("../utils").inherits(o,s),o.prototype.byteAt=function(l){return this.data.charCodeAt(this.zero+l)},o.prototype.lastIndexOfSignature=function(l){return this.data.lastIndexOf(l)-this.zero},o.prototype.readAndCheckSignature=function(l){return l===this.readData(4)},o.prototype.readData=function(l){this.checkOffset(l);var c=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},n.exports=o},{"../utils":32,"./DataReader":18}],21:[function(r,n,i){var s=r("./ArrayReader");function o(l){s.call(this,l)}r("../utils").inherits(o,s),o.prototype.readData=function(l){if(this.checkOffset(l),l===0)return new Uint8Array(0);var c=this.data.subarray(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},n.exports=o},{"../utils":32,"./ArrayReader":17}],22:[function(r,n,i){var s=r("../utils"),o=r("../support"),l=r("./ArrayReader"),c=r("./StringReader"),d=r("./NodeBufferReader"),u=r("./Uint8ArrayReader");n.exports=function(f){var h=s.getTypeOf(f);return s.checkSupport(h),h!=="string"||o.uint8array?h==="nodebuffer"?new d(f):o.uint8array?new u(s.transformTo("uint8array",f)):new l(s.transformTo("array",f)):new c(f)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(r,n,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(r,n,i){var s=r("./GenericWorker"),o=r("../utils");function l(c){s.call(this,"ConvertWorker to "+c),this.destType=c}o.inherits(l,s),l.prototype.processChunk=function(c){this.push({data:o.transformTo(this.destType,c.data),meta:c.meta})},n.exports=l},{"../utils":32,"./GenericWorker":28}],25:[function(r,n,i){var s=r("./GenericWorker"),o=r("../crc32");function l(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}r("../utils").inherits(l,s),l.prototype.processChunk=function(c){this.streamInfo.crc32=o(c.data,this.streamInfo.crc32||0),this.push(c)},n.exports=l},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(r,n,i){var s=r("../utils"),o=r("./GenericWorker");function l(c){o.call(this,"DataLengthProbe for "+c),this.propName=c,this.withStreamInfo(c,0)}s.inherits(l,o),l.prototype.processChunk=function(c){if(c){var d=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=d+c.data.length}o.prototype.processChunk.call(this,c)},n.exports=l},{"../utils":32,"./GenericWorker":28}],27:[function(r,n,i){var s=r("../utils"),o=r("./GenericWorker");function l(c){o.call(this,"DataWorker");var d=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,c.then(function(u){d.dataIsReady=!0,d.data=u,d.max=u&&u.length||0,d.type=s.getTypeOf(u),d.isPaused||d._tickAndRepeat()},function(u){d.error(u)})}s.inherits(l,o),l.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this.data=null},l.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0)},l.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},l.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var c=null,d=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":c=this.data.substring(this.index,d);break;case"uint8array":c=this.data.subarray(this.index,d);break;case"array":case"nodebuffer":c=this.data.slice(this.index,d)}return this.index=d,this.push({data:c,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=l},{"../utils":32,"./GenericWorker":28}],28:[function(r,n,i){function s(o){this.name=o||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(o){this.emit("data",o)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(o){this.emit("error",o)}return!0},error:function(o){return!this.isFinished&&(this.isPaused?this.generatedError=o:(this.isFinished=!0,this.emit("error",o),this.previous&&this.previous.error(o),this.cleanUp()),!0)},on:function(o,l){return this._listeners[o].push(l),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(o,l){if(this._listeners[o])for(var c=0;c<this._listeners[o].length;c++)this._listeners[o][c].call(this,l)},pipe:function(o){return o.registerPrevious(this)},registerPrevious:function(o){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=o.streamInfo,this.mergeStreamInfo(),this.previous=o;var l=this;return o.on("data",function(c){l.processChunk(c)}),o.on("end",function(){l.end()}),o.on("error",function(c){l.error(c)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var o=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),o=!0),this.previous&&this.previous.resume(),!o},flush:function(){},processChunk:function(o){this.push(o)},withStreamInfo:function(o,l){return this.extraStreamInfo[o]=l,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var o in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,o)&&(this.streamInfo[o]=this.extraStreamInfo[o])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var o="Worker "+this.name;return this.previous?this.previous+" -> "+o:o}},n.exports=s},{}],29:[function(r,n,i){var s=r("../utils"),o=r("./ConvertWorker"),l=r("./GenericWorker"),c=r("../base64"),d=r("../support"),u=r("../external"),f=null;if(d.nodestream)try{f=r("../nodejs/NodejsStreamOutputAdapter")}catch{}function h(g,m){return new u.Promise(function(x,v){var y=[],b=g._internalType,w=g._outputType,k=g._mimeType;g.on("data",function(_,C){y.push(_),m&&m(C)}).on("error",function(_){y=[],v(_)}).on("end",function(){try{var _=function(C,N,T){switch(C){case"blob":return s.newBlob(s.transformTo("arraybuffer",N),T);case"base64":return c.encode(N);default:return s.transformTo(C,N)}}(w,function(C,N){var T,O=0,X=null,E=0;for(T=0;T<N.length;T++)E+=N[T].length;switch(C){case"string":return N.join("");case"array":return Array.prototype.concat.apply([],N);case"uint8array":for(X=new Uint8Array(E),T=0;T<N.length;T++)X.set(N[T],O),O+=N[T].length;return X;case"nodebuffer":return Buffer.concat(N);default:throw new Error("concat : unsupported type '"+C+"'")}}(b,y),k);x(_)}catch(C){v(C)}y=[]}).resume()})}function p(g,m,x){var v=m;switch(m){case"blob":case"arraybuffer":v="uint8array";break;case"base64":v="string"}try{this._internalType=v,this._outputType=m,this._mimeType=x,s.checkSupport(v),this._worker=g.pipe(new o(v)),g.lock()}catch(y){this._worker=new l("error"),this._worker.error(y)}}p.prototype={accumulate:function(g){return h(this,g)},on:function(g,m){var x=this;return g==="data"?this._worker.on(g,function(v){m.call(x,v.data,v.meta)}):this._worker.on(g,function(){s.delay(m,arguments,x)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(g){if(s.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new f(this,{objectMode:this._outputType!=="nodebuffer"},g)}},n.exports=p},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(r,n,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof Buffer<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var s=new ArrayBuffer(0);try{i.blob=new Blob([s],{type:"application/zip"}).size===0}catch{try{var o=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);o.append(s),i.blob=o.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!r("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(r,n,i){for(var s=r("./utils"),o=r("./support"),l=r("./nodejsUtils"),c=r("./stream/GenericWorker"),d=new Array(256),u=0;u<256;u++)d[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;d[254]=d[254]=1;function f(){c.call(this,"utf-8 decode"),this.leftOver=null}function h(){c.call(this,"utf-8 encode")}i.utf8encode=function(p){return o.nodebuffer?l.newBufferFrom(p,"utf-8"):function(g){var m,x,v,y,b,w=g.length,k=0;for(y=0;y<w;y++)(64512&(x=g.charCodeAt(y)))==55296&&y+1<w&&(64512&(v=g.charCodeAt(y+1)))==56320&&(x=65536+(x-55296<<10)+(v-56320),y++),k+=x<128?1:x<2048?2:x<65536?3:4;for(m=o.uint8array?new Uint8Array(k):new Array(k),y=b=0;b<k;y++)(64512&(x=g.charCodeAt(y)))==55296&&y+1<w&&(64512&(v=g.charCodeAt(y+1)))==56320&&(x=65536+(x-55296<<10)+(v-56320),y++),x<128?m[b++]=x:(x<2048?m[b++]=192|x>>>6:(x<65536?m[b++]=224|x>>>12:(m[b++]=240|x>>>18,m[b++]=128|x>>>12&63),m[b++]=128|x>>>6&63),m[b++]=128|63&x);return m}(p)},i.utf8decode=function(p){return o.nodebuffer?s.transformTo("nodebuffer",p).toString("utf-8"):function(g){var m,x,v,y,b=g.length,w=new Array(2*b);for(m=x=0;m<b;)if((v=g[m++])<128)w[x++]=v;else if(4<(y=d[v]))w[x++]=65533,m+=y-1;else{for(v&=y===2?31:y===3?15:7;1<y&&m<b;)v=v<<6|63&g[m++],y--;1<y?w[x++]=65533:v<65536?w[x++]=v:(v-=65536,w[x++]=55296|v>>10&1023,w[x++]=56320|1023&v)}return w.length!==x&&(w.subarray?w=w.subarray(0,x):w.length=x),s.applyFromCharCode(w)}(p=s.transformTo(o.uint8array?"uint8array":"array",p))},s.inherits(f,c),f.prototype.processChunk=function(p){var g=s.transformTo(o.uint8array?"uint8array":"array",p.data);if(this.leftOver&&this.leftOver.length){if(o.uint8array){var m=g;(g=new Uint8Array(m.length+this.leftOver.length)).set(this.leftOver,0),g.set(m,this.leftOver.length)}else g=this.leftOver.concat(g);this.leftOver=null}var x=function(y,b){var w;for((b=b||y.length)>y.length&&(b=y.length),w=b-1;0<=w&&(192&y[w])==128;)w--;return w<0||w===0?b:w+d[y[w]]>b?w:b}(g),v=g;x!==g.length&&(o.uint8array?(v=g.subarray(0,x),this.leftOver=g.subarray(x,g.length)):(v=g.slice(0,x),this.leftOver=g.slice(x,g.length))),this.push({data:i.utf8decode(v),meta:p.meta})},f.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=f,s.inherits(h,c),h.prototype.processChunk=function(p){this.push({data:i.utf8encode(p.data),meta:p.meta})},i.Utf8EncodeWorker=h},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(r,n,i){var s=r("./support"),o=r("./base64"),l=r("./nodejsUtils"),c=r("./external");function d(m){return m}function u(m,x){for(var v=0;v<m.length;++v)x[v]=255&m.charCodeAt(v);return x}r("setimmediate"),i.newBlob=function(m,x){i.checkSupport("blob");try{return new Blob([m],{type:x})}catch{try{var v=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return v.append(m),v.getBlob(x)}catch{throw new Error("Bug : can't construct the Blob.")}}};var f={stringifyByChunk:function(m,x,v){var y=[],b=0,w=m.length;if(w<=v)return String.fromCharCode.apply(null,m);for(;b<w;)x==="array"||x==="nodebuffer"?y.push(String.fromCharCode.apply(null,m.slice(b,Math.min(b+v,w)))):y.push(String.fromCharCode.apply(null,m.subarray(b,Math.min(b+v,w)))),b+=v;return y.join("")},stringifyByChar:function(m){for(var x="",v=0;v<m.length;v++)x+=String.fromCharCode(m[v]);return x},applyCanBeUsed:{uint8array:function(){try{return s.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return s.nodebuffer&&String.fromCharCode.apply(null,l.allocBuffer(1)).length===1}catch{return!1}}()}};function h(m){var x=65536,v=i.getTypeOf(m),y=!0;if(v==="uint8array"?y=f.applyCanBeUsed.uint8array:v==="nodebuffer"&&(y=f.applyCanBeUsed.nodebuffer),y)for(;1<x;)try{return f.stringifyByChunk(m,v,x)}catch{x=Math.floor(x/2)}return f.stringifyByChar(m)}function p(m,x){for(var v=0;v<m.length;v++)x[v]=m[v];return x}i.applyFromCharCode=h;var g={};g.string={string:d,array:function(m){return u(m,new Array(m.length))},arraybuffer:function(m){return g.string.uint8array(m).buffer},uint8array:function(m){return u(m,new Uint8Array(m.length))},nodebuffer:function(m){return u(m,l.allocBuffer(m.length))}},g.array={string:h,array:d,arraybuffer:function(m){return new Uint8Array(m).buffer},uint8array:function(m){return new Uint8Array(m)},nodebuffer:function(m){return l.newBufferFrom(m)}},g.arraybuffer={string:function(m){return h(new Uint8Array(m))},array:function(m){return p(new Uint8Array(m),new Array(m.byteLength))},arraybuffer:d,uint8array:function(m){return new Uint8Array(m)},nodebuffer:function(m){return l.newBufferFrom(new Uint8Array(m))}},g.uint8array={string:h,array:function(m){return p(m,new Array(m.length))},arraybuffer:function(m){return m.buffer},uint8array:d,nodebuffer:function(m){return l.newBufferFrom(m)}},g.nodebuffer={string:h,array:function(m){return p(m,new Array(m.length))},arraybuffer:function(m){return g.nodebuffer.uint8array(m).buffer},uint8array:function(m){return p(m,new Uint8Array(m.length))},nodebuffer:d},i.transformTo=function(m,x){if(x=x||"",!m)return x;i.checkSupport(m);var v=i.getTypeOf(x);return g[v][m](x)},i.resolve=function(m){for(var x=m.split("/"),v=[],y=0;y<x.length;y++){var b=x[y];b==="."||b===""&&y!==0&&y!==x.length-1||(b===".."?v.pop():v.push(b))}return v.join("/")},i.getTypeOf=function(m){return typeof m=="string"?"string":Object.prototype.toString.call(m)==="[object Array]"?"array":s.nodebuffer&&l.isBuffer(m)?"nodebuffer":s.uint8array&&m instanceof Uint8Array?"uint8array":s.arraybuffer&&m instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(m){if(!s[m.toLowerCase()])throw new Error(m+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(m){var x,v,y="";for(v=0;v<(m||"").length;v++)y+="\\x"+((x=m.charCodeAt(v))<16?"0":"")+x.toString(16).toUpperCase();return y},i.delay=function(m,x,v){setImmediate(function(){m.apply(v||null,x||[])})},i.inherits=function(m,x){function v(){}v.prototype=x.prototype,m.prototype=new v},i.extend=function(){var m,x,v={};for(m=0;m<arguments.length;m++)for(x in arguments[m])Object.prototype.hasOwnProperty.call(arguments[m],x)&&v[x]===void 0&&(v[x]=arguments[m][x]);return v},i.prepareContent=function(m,x,v,y,b){return c.Promise.resolve(x).then(function(w){return s.blob&&(w instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(w))!==-1)&&typeof FileReader<"u"?new c.Promise(function(k,_){var C=new FileReader;C.onload=function(N){k(N.target.result)},C.onerror=function(N){_(N.target.error)},C.readAsArrayBuffer(w)}):w}).then(function(w){var k=i.getTypeOf(w);return k?(k==="arraybuffer"?w=i.transformTo("uint8array",w):k==="string"&&(b?w=o.decode(w):v&&y!==!0&&(w=function(_){return u(_,s.uint8array?new Uint8Array(_.length):new Array(_.length))}(w))),w):c.Promise.reject(new Error("Can't read the data of '"+m+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(r,n,i){var s=r("./reader/readerFor"),o=r("./utils"),l=r("./signature"),c=r("./zipEntry"),d=r("./support");function u(f){this.files=[],this.loadOptions=f}u.prototype={checkSignature:function(f){if(!this.reader.readAndCheckSignature(f)){this.reader.index-=4;var h=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+o.pretty(h)+", expected "+o.pretty(f)+")")}},isSignature:function(f,h){var p=this.reader.index;this.reader.setIndex(f);var g=this.reader.readString(4)===h;return this.reader.setIndex(p),g},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var f=this.reader.readData(this.zipCommentLength),h=d.uint8array?"uint8array":"array",p=o.transformTo(h,f);this.zipComment=this.loadOptions.decodeFileName(p)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var f,h,p,g=this.zip64EndOfCentralSize-44;0<g;)f=this.reader.readInt(2),h=this.reader.readInt(4),p=this.reader.readData(h),this.zip64ExtensibleData[f]={id:f,length:h,value:p}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var f,h;for(f=0;f<this.files.length;f++)h=this.files[f],this.reader.setIndex(h.localHeaderOffset),this.checkSignature(l.LOCAL_FILE_HEADER),h.readLocalPart(this.reader),h.handleUTF8(),h.processAttributes()},readCentralDir:function(){var f;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(l.CENTRAL_FILE_HEADER);)(f=new c({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(f);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var f=this.reader.lastIndexOfSignature(l.CENTRAL_DIRECTORY_END);if(f<0)throw this.isSignature(0,l.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(f);var h=f;if(this.checkSignature(l.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===o.MAX_VALUE_16BITS||this.diskWithCentralDirStart===o.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===o.MAX_VALUE_16BITS||this.centralDirRecords===o.MAX_VALUE_16BITS||this.centralDirSize===o.MAX_VALUE_32BITS||this.centralDirOffset===o.MAX_VALUE_32BITS){if(this.zip64=!0,(f=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(f),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,l.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var p=this.centralDirOffset+this.centralDirSize;this.zip64&&(p+=20,p+=12+this.zip64EndOfCentralSize);var g=h-p;if(0<g)this.isSignature(h,l.CENTRAL_FILE_HEADER)||(this.reader.zero=g);else if(g<0)throw new Error("Corrupted zip: missing "+Math.abs(g)+" bytes.")},prepareReader:function(f){this.reader=s(f)},load:function(f){this.prepareReader(f),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=u},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(r,n,i){var s=r("./reader/readerFor"),o=r("./utils"),l=r("./compressedObject"),c=r("./crc32"),d=r("./utf8"),u=r("./compressions"),f=r("./support");function h(p,g){this.options=p,this.loadOptions=g}h.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(p){var g,m;if(p.skip(22),this.fileNameLength=p.readInt(2),m=p.readInt(2),this.fileName=p.readData(this.fileNameLength),p.skip(m),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((g=function(x){for(var v in u)if(Object.prototype.hasOwnProperty.call(u,v)&&u[v].magic===x)return u[v];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+o.transformTo("string",this.fileName)+")");this.decompressed=new l(this.compressedSize,this.uncompressedSize,this.crc32,g,p.readData(this.compressedSize))},readCentralPart:function(p){this.versionMadeBy=p.readInt(2),p.skip(2),this.bitFlag=p.readInt(2),this.compressionMethod=p.readString(2),this.date=p.readDate(),this.crc32=p.readInt(4),this.compressedSize=p.readInt(4),this.uncompressedSize=p.readInt(4);var g=p.readInt(2);if(this.extraFieldsLength=p.readInt(2),this.fileCommentLength=p.readInt(2),this.diskNumberStart=p.readInt(2),this.internalFileAttributes=p.readInt(2),this.externalFileAttributes=p.readInt(4),this.localHeaderOffset=p.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");p.skip(g),this.readExtraFields(p),this.parseZIP64ExtraField(p),this.fileComment=p.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var p=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),p==0&&(this.dosPermissions=63&this.externalFileAttributes),p==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var p=s(this.extraFields[1].value);this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=p.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=p.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=p.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS&&(this.diskNumberStart=p.readInt(4))}},readExtraFields:function(p){var g,m,x,v=p.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});p.index+4<v;)g=p.readInt(2),m=p.readInt(2),x=p.readData(m),this.extraFields[g]={id:g,length:m,value:x};p.setIndex(v)},handleUTF8:function(){var p=f.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=d.utf8decode(this.fileName),this.fileCommentStr=d.utf8decode(this.fileComment);else{var g=this.findExtraFieldUnicodePath();if(g!==null)this.fileNameStr=g;else{var m=o.transformTo(p,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(m)}var x=this.findExtraFieldUnicodeComment();if(x!==null)this.fileCommentStr=x;else{var v=o.transformTo(p,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(v)}}},findExtraFieldUnicodePath:function(){var p=this.extraFields[28789];if(p){var g=s(p.value);return g.readInt(1)!==1||c(this.fileName)!==g.readInt(4)?null:d.utf8decode(g.readData(p.length-5))}return null},findExtraFieldUnicodeComment:function(){var p=this.extraFields[25461];if(p){var g=s(p.value);return g.readInt(1)!==1||c(this.fileComment)!==g.readInt(4)?null:d.utf8decode(g.readData(p.length-5))}return null}},n.exports=h},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(r,n,i){function s(g,m,x){this.name=g,this.dir=x.dir,this.date=x.date,this.comment=x.comment,this.unixPermissions=x.unixPermissions,this.dosPermissions=x.dosPermissions,this._data=m,this._dataBinary=x.binary,this.options={compression:x.compression,compressionOptions:x.compressionOptions}}var o=r("./stream/StreamHelper"),l=r("./stream/DataWorker"),c=r("./utf8"),d=r("./compressedObject"),u=r("./stream/GenericWorker");s.prototype={internalStream:function(g){var m=null,x="string";try{if(!g)throw new Error("No output type specified.");var v=(x=g.toLowerCase())==="string"||x==="text";x!=="binarystring"&&x!=="text"||(x="string"),m=this._decompressWorker();var y=!this._dataBinary;y&&!v&&(m=m.pipe(new c.Utf8EncodeWorker)),!y&&v&&(m=m.pipe(new c.Utf8DecodeWorker))}catch(b){(m=new u("error")).error(b)}return new o(m,x,"")},async:function(g,m){return this.internalStream(g).accumulate(m)},nodeStream:function(g,m){return this.internalStream(g||"nodebuffer").toNodejsStream(m)},_compressWorker:function(g,m){if(this._data instanceof d&&this._data.compression.magic===g.magic)return this._data.getCompressedWorker();var x=this._decompressWorker();return this._dataBinary||(x=x.pipe(new c.Utf8EncodeWorker)),d.createWorkerFrom(x,g,m)},_decompressWorker:function(){return this._data instanceof d?this._data.getContentWorker():this._data instanceof u?this._data:new l(this._data)}};for(var f=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],h=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},p=0;p<f.length;p++)s.prototype[f[p]]=h;n.exports=s},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(r,n,i){(function(s){var o,l,c=s.MutationObserver||s.WebKitMutationObserver;if(c){var d=0,u=new c(g),f=s.document.createTextNode("");u.observe(f,{characterData:!0}),o=function(){f.data=d=++d%2}}else if(s.setImmediate||s.MessageChannel===void 0)o="document"in s&&"onreadystatechange"in s.document.createElement("script")?function(){var m=s.document.createElement("script");m.onreadystatechange=function(){g(),m.onreadystatechange=null,m.parentNode.removeChild(m),m=null},s.document.documentElement.appendChild(m)}:function(){setTimeout(g,0)};else{var h=new s.MessageChannel;h.port1.onmessage=g,o=function(){h.port2.postMessage(0)}}var p=[];function g(){var m,x;l=!0;for(var v=p.length;v;){for(x=p,p=[],m=-1;++m<v;)x[m]();v=p.length}l=!1}n.exports=function(m){p.push(m)!==1||l||o()}}).call(this,typeof Si<"u"?Si:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(r,n,i){var s=r("immediate");function o(){}var l={},c=["REJECTED"],d=["FULFILLED"],u=["PENDING"];function f(v){if(typeof v!="function")throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,v!==o&&m(this,v)}function h(v,y,b){this.promise=v,typeof y=="function"&&(this.onFulfilled=y,this.callFulfilled=this.otherCallFulfilled),typeof b=="function"&&(this.onRejected=b,this.callRejected=this.otherCallRejected)}function p(v,y,b){s(function(){var w;try{w=y(b)}catch(k){return l.reject(v,k)}w===v?l.reject(v,new TypeError("Cannot resolve promise with itself")):l.resolve(v,w)})}function g(v){var y=v&&v.then;if(v&&(typeof v=="object"||typeof v=="function")&&typeof y=="function")return function(){y.apply(v,arguments)}}function m(v,y){var b=!1;function w(C){b||(b=!0,l.reject(v,C))}function k(C){b||(b=!0,l.resolve(v,C))}var _=x(function(){y(k,w)});_.status==="error"&&w(_.value)}function x(v,y){var b={};try{b.value=v(y),b.status="success"}catch(w){b.status="error",b.value=w}return b}(n.exports=f).prototype.finally=function(v){if(typeof v!="function")return this;var y=this.constructor;return this.then(function(b){return y.resolve(v()).then(function(){return b})},function(b){return y.resolve(v()).then(function(){throw b})})},f.prototype.catch=function(v){return this.then(null,v)},f.prototype.then=function(v,y){if(typeof v!="function"&&this.state===d||typeof y!="function"&&this.state===c)return this;var b=new this.constructor(o);return this.state!==u?p(b,this.state===d?v:y,this.outcome):this.queue.push(new h(b,v,y)),b},h.prototype.callFulfilled=function(v){l.resolve(this.promise,v)},h.prototype.otherCallFulfilled=function(v){p(this.promise,this.onFulfilled,v)},h.prototype.callRejected=function(v){l.reject(this.promise,v)},h.prototype.otherCallRejected=function(v){p(this.promise,this.onRejected,v)},l.resolve=function(v,y){var b=x(g,y);if(b.status==="error")return l.reject(v,b.value);var w=b.value;if(w)m(v,w);else{v.state=d,v.outcome=y;for(var k=-1,_=v.queue.length;++k<_;)v.queue[k].callFulfilled(y)}return v},l.reject=function(v,y){v.state=c,v.outcome=y;for(var b=-1,w=v.queue.length;++b<w;)v.queue[b].callRejected(y);return v},f.resolve=function(v){return v instanceof this?v:l.resolve(new this(o),v)},f.reject=function(v){var y=new this(o);return l.reject(y,v)},f.all=function(v){var y=this;if(Object.prototype.toString.call(v)!=="[object Array]")return this.reject(new TypeError("must be an array"));var b=v.length,w=!1;if(!b)return this.resolve([]);for(var k=new Array(b),_=0,C=-1,N=new this(o);++C<b;)T(v[C],C);return N;function T(O,X){y.resolve(O).then(function(E){k[X]=E,++_!==b||w||(w=!0,l.resolve(N,k))},function(E){w||(w=!0,l.reject(N,E))})}},f.race=function(v){var y=this;if(Object.prototype.toString.call(v)!=="[object Array]")return this.reject(new TypeError("must be an array"));var b=v.length,w=!1;if(!b)return this.resolve([]);for(var k=-1,_=new this(o);++k<b;)C=v[k],y.resolve(C).then(function(N){w||(w=!0,l.resolve(_,N))},function(N){w||(w=!0,l.reject(_,N))});var C;return _}},{immediate:36}],38:[function(r,n,i){var s={};(0,r("./lib/utils/common").assign)(s,r("./lib/deflate"),r("./lib/inflate"),r("./lib/zlib/constants")),n.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(r,n,i){var s=r("./zlib/deflate"),o=r("./utils/common"),l=r("./utils/strings"),c=r("./zlib/messages"),d=r("./zlib/zstream"),u=Object.prototype.toString,f=0,h=-1,p=0,g=8;function m(v){if(!(this instanceof m))return new m(v);this.options=o.assign({level:h,method:g,chunkSize:16384,windowBits:15,memLevel:8,strategy:p,to:""},v||{});var y=this.options;y.raw&&0<y.windowBits?y.windowBits=-y.windowBits:y.gzip&&0<y.windowBits&&y.windowBits<16&&(y.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var b=s.deflateInit2(this.strm,y.level,y.method,y.windowBits,y.memLevel,y.strategy);if(b!==f)throw new Error(c[b]);if(y.header&&s.deflateSetHeader(this.strm,y.header),y.dictionary){var w;if(w=typeof y.dictionary=="string"?l.string2buf(y.dictionary):u.call(y.dictionary)==="[object ArrayBuffer]"?new Uint8Array(y.dictionary):y.dictionary,(b=s.deflateSetDictionary(this.strm,w))!==f)throw new Error(c[b]);this._dict_set=!0}}function x(v,y){var b=new m(y);if(b.push(v,!0),b.err)throw b.msg||c[b.err];return b.result}m.prototype.push=function(v,y){var b,w,k=this.strm,_=this.options.chunkSize;if(this.ended)return!1;w=y===~~y?y:y===!0?4:0,typeof v=="string"?k.input=l.string2buf(v):u.call(v)==="[object ArrayBuffer]"?k.input=new Uint8Array(v):k.input=v,k.next_in=0,k.avail_in=k.input.length;do{if(k.avail_out===0&&(k.output=new o.Buf8(_),k.next_out=0,k.avail_out=_),(b=s.deflate(k,w))!==1&&b!==f)return this.onEnd(b),!(this.ended=!0);k.avail_out!==0&&(k.avail_in!==0||w!==4&&w!==2)||(this.options.to==="string"?this.onData(l.buf2binstring(o.shrinkBuf(k.output,k.next_out))):this.onData(o.shrinkBuf(k.output,k.next_out)))}while((0<k.avail_in||k.avail_out===0)&&b!==1);return w===4?(b=s.deflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===f):w!==2||(this.onEnd(f),!(k.avail_out=0))},m.prototype.onData=function(v){this.chunks.push(v)},m.prototype.onEnd=function(v){v===f&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=v,this.msg=this.strm.msg},i.Deflate=m,i.deflate=x,i.deflateRaw=function(v,y){return(y=y||{}).raw=!0,x(v,y)},i.gzip=function(v,y){return(y=y||{}).gzip=!0,x(v,y)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(r,n,i){var s=r("./zlib/inflate"),o=r("./utils/common"),l=r("./utils/strings"),c=r("./zlib/constants"),d=r("./zlib/messages"),u=r("./zlib/zstream"),f=r("./zlib/gzheader"),h=Object.prototype.toString;function p(m){if(!(this instanceof p))return new p(m);this.options=o.assign({chunkSize:16384,windowBits:0,to:""},m||{});var x=this.options;x.raw&&0<=x.windowBits&&x.windowBits<16&&(x.windowBits=-x.windowBits,x.windowBits===0&&(x.windowBits=-15)),!(0<=x.windowBits&&x.windowBits<16)||m&&m.windowBits||(x.windowBits+=32),15<x.windowBits&&x.windowBits<48&&!(15&x.windowBits)&&(x.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var v=s.inflateInit2(this.strm,x.windowBits);if(v!==c.Z_OK)throw new Error(d[v]);this.header=new f,s.inflateGetHeader(this.strm,this.header)}function g(m,x){var v=new p(x);if(v.push(m,!0),v.err)throw v.msg||d[v.err];return v.result}p.prototype.push=function(m,x){var v,y,b,w,k,_,C=this.strm,N=this.options.chunkSize,T=this.options.dictionary,O=!1;if(this.ended)return!1;y=x===~~x?x:x===!0?c.Z_FINISH:c.Z_NO_FLUSH,typeof m=="string"?C.input=l.binstring2buf(m):h.call(m)==="[object ArrayBuffer]"?C.input=new Uint8Array(m):C.input=m,C.next_in=0,C.avail_in=C.input.length;do{if(C.avail_out===0&&(C.output=new o.Buf8(N),C.next_out=0,C.avail_out=N),(v=s.inflate(C,c.Z_NO_FLUSH))===c.Z_NEED_DICT&&T&&(_=typeof T=="string"?l.string2buf(T):h.call(T)==="[object ArrayBuffer]"?new Uint8Array(T):T,v=s.inflateSetDictionary(this.strm,_)),v===c.Z_BUF_ERROR&&O===!0&&(v=c.Z_OK,O=!1),v!==c.Z_STREAM_END&&v!==c.Z_OK)return this.onEnd(v),!(this.ended=!0);C.next_out&&(C.avail_out!==0&&v!==c.Z_STREAM_END&&(C.avail_in!==0||y!==c.Z_FINISH&&y!==c.Z_SYNC_FLUSH)||(this.options.to==="string"?(b=l.utf8border(C.output,C.next_out),w=C.next_out-b,k=l.buf2string(C.output,b),C.next_out=w,C.avail_out=N-w,w&&o.arraySet(C.output,C.output,b,w,0),this.onData(k)):this.onData(o.shrinkBuf(C.output,C.next_out)))),C.avail_in===0&&C.avail_out===0&&(O=!0)}while((0<C.avail_in||C.avail_out===0)&&v!==c.Z_STREAM_END);return v===c.Z_STREAM_END&&(y=c.Z_FINISH),y===c.Z_FINISH?(v=s.inflateEnd(this.strm),this.onEnd(v),this.ended=!0,v===c.Z_OK):y!==c.Z_SYNC_FLUSH||(this.onEnd(c.Z_OK),!(C.avail_out=0))},p.prototype.onData=function(m){this.chunks.push(m)},p.prototype.onEnd=function(m){m===c.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=m,this.msg=this.strm.msg},i.Inflate=p,i.inflate=g,i.inflateRaw=function(m,x){return(x=x||{}).raw=!0,g(m,x)},i.ungzip=g},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(r,n,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(c){for(var d=Array.prototype.slice.call(arguments,1);d.length;){var u=d.shift();if(u){if(typeof u!="object")throw new TypeError(u+"must be non-object");for(var f in u)u.hasOwnProperty(f)&&(c[f]=u[f])}}return c},i.shrinkBuf=function(c,d){return c.length===d?c:c.subarray?c.subarray(0,d):(c.length=d,c)};var o={arraySet:function(c,d,u,f,h){if(d.subarray&&c.subarray)c.set(d.subarray(u,u+f),h);else for(var p=0;p<f;p++)c[h+p]=d[u+p]},flattenChunks:function(c){var d,u,f,h,p,g;for(d=f=0,u=c.length;d<u;d++)f+=c[d].length;for(g=new Uint8Array(f),d=h=0,u=c.length;d<u;d++)p=c[d],g.set(p,h),h+=p.length;return g}},l={arraySet:function(c,d,u,f,h){for(var p=0;p<f;p++)c[h+p]=d[u+p]},flattenChunks:function(c){return[].concat.apply([],c)}};i.setTyped=function(c){c?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,o)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,l))},i.setTyped(s)},{}],42:[function(r,n,i){var s=r("./common"),o=!0,l=!0;try{String.fromCharCode.apply(null,[0])}catch{o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{l=!1}for(var c=new s.Buf8(256),d=0;d<256;d++)c[d]=252<=d?6:248<=d?5:240<=d?4:224<=d?3:192<=d?2:1;function u(f,h){if(h<65537&&(f.subarray&&l||!f.subarray&&o))return String.fromCharCode.apply(null,s.shrinkBuf(f,h));for(var p="",g=0;g<h;g++)p+=String.fromCharCode(f[g]);return p}c[254]=c[254]=1,i.string2buf=function(f){var h,p,g,m,x,v=f.length,y=0;for(m=0;m<v;m++)(64512&(p=f.charCodeAt(m)))==55296&&m+1<v&&(64512&(g=f.charCodeAt(m+1)))==56320&&(p=65536+(p-55296<<10)+(g-56320),m++),y+=p<128?1:p<2048?2:p<65536?3:4;for(h=new s.Buf8(y),m=x=0;x<y;m++)(64512&(p=f.charCodeAt(m)))==55296&&m+1<v&&(64512&(g=f.charCodeAt(m+1)))==56320&&(p=65536+(p-55296<<10)+(g-56320),m++),p<128?h[x++]=p:(p<2048?h[x++]=192|p>>>6:(p<65536?h[x++]=224|p>>>12:(h[x++]=240|p>>>18,h[x++]=128|p>>>12&63),h[x++]=128|p>>>6&63),h[x++]=128|63&p);return h},i.buf2binstring=function(f){return u(f,f.length)},i.binstring2buf=function(f){for(var h=new s.Buf8(f.length),p=0,g=h.length;p<g;p++)h[p]=f.charCodeAt(p);return h},i.buf2string=function(f,h){var p,g,m,x,v=h||f.length,y=new Array(2*v);for(p=g=0;p<v;)if((m=f[p++])<128)y[g++]=m;else if(4<(x=c[m]))y[g++]=65533,p+=x-1;else{for(m&=x===2?31:x===3?15:7;1<x&&p<v;)m=m<<6|63&f[p++],x--;1<x?y[g++]=65533:m<65536?y[g++]=m:(m-=65536,y[g++]=55296|m>>10&1023,y[g++]=56320|1023&m)}return u(y,g)},i.utf8border=function(f,h){var p;for((h=h||f.length)>f.length&&(h=f.length),p=h-1;0<=p&&(192&f[p])==128;)p--;return p<0||p===0?h:p+c[f[p]]>h?p:h}},{"./common":41}],43:[function(r,n,i){n.exports=function(s,o,l,c){for(var d=65535&s|0,u=s>>>16&65535|0,f=0;l!==0;){for(l-=f=2e3<l?2e3:l;u=u+(d=d+o[c++]|0)|0,--f;);d%=65521,u%=65521}return d|u<<16|0}},{}],44:[function(r,n,i){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(r,n,i){var s=function(){for(var o,l=[],c=0;c<256;c++){o=c;for(var d=0;d<8;d++)o=1&o?3988292384^o>>>1:o>>>1;l[c]=o}return l}();n.exports=function(o,l,c,d){var u=s,f=d+c;o^=-1;for(var h=d;h<f;h++)o=o>>>8^u[255&(o^l[h])];return-1^o}},{}],46:[function(r,n,i){var s,o=r("../utils/common"),l=r("./trees"),c=r("./adler32"),d=r("./crc32"),u=r("./messages"),f=0,h=4,p=0,g=-2,m=-1,x=4,v=2,y=8,b=9,w=286,k=30,_=19,C=2*w+1,N=15,T=3,O=258,X=O+T+1,E=42,F=113,S=1,K=2,le=3,D=4;function I(j,ce){return j.msg=u[ce],ce}function L(j){return(j<<1)-(4<j?9:0)}function Z(j){for(var ce=j.length;0<=--ce;)j[ce]=0}function H(j){var ce=j.state,re=ce.pending;re>j.avail_out&&(re=j.avail_out),re!==0&&(o.arraySet(j.output,ce.pending_buf,ce.pending_out,re,j.next_out),j.next_out+=re,ce.pending_out+=re,j.total_out+=re,j.avail_out-=re,ce.pending-=re,ce.pending===0&&(ce.pending_out=0))}function G(j,ce){l._tr_flush_block(j,0<=j.block_start?j.block_start:-1,j.strstart-j.block_start,ce),j.block_start=j.strstart,H(j.strm)}function ee(j,ce){j.pending_buf[j.pending++]=ce}function oe(j,ce){j.pending_buf[j.pending++]=ce>>>8&255,j.pending_buf[j.pending++]=255&ce}function fe(j,ce){var re,z,R=j.max_chain_length,U=j.strstart,ae=j.prev_length,q=j.nice_match,M=j.strstart>j.w_size-X?j.strstart-(j.w_size-X):0,J=j.window,de=j.w_mask,ie=j.prev,A=j.strstart+O,Y=J[U+ae-1],se=J[U+ae];j.prev_length>=j.good_match&&(R>>=2),q>j.lookahead&&(q=j.lookahead);do if(J[(re=ce)+ae]===se&&J[re+ae-1]===Y&&J[re]===J[U]&&J[++re]===J[U+1]){U+=2,re++;do;while(J[++U]===J[++re]&&J[++U]===J[++re]&&J[++U]===J[++re]&&J[++U]===J[++re]&&J[++U]===J[++re]&&J[++U]===J[++re]&&J[++U]===J[++re]&&J[++U]===J[++re]&&U<A);if(z=O-(A-U),U=A-O,ae<z){if(j.match_start=ce,q<=(ae=z))break;Y=J[U+ae-1],se=J[U+ae]}}while((ce=ie[ce&de])>M&&--R!=0);return ae<=j.lookahead?ae:j.lookahead}function Oe(j){var ce,re,z,R,U,ae,q,M,J,de,ie=j.w_size;do{if(R=j.window_size-j.lookahead-j.strstart,j.strstart>=ie+(ie-X)){for(o.arraySet(j.window,j.window,ie,ie,0),j.match_start-=ie,j.strstart-=ie,j.block_start-=ie,ce=re=j.hash_size;z=j.head[--ce],j.head[ce]=ie<=z?z-ie:0,--re;);for(ce=re=ie;z=j.prev[--ce],j.prev[ce]=ie<=z?z-ie:0,--re;);R+=ie}if(j.strm.avail_in===0)break;if(ae=j.strm,q=j.window,M=j.strstart+j.lookahead,J=R,de=void 0,de=ae.avail_in,J<de&&(de=J),re=de===0?0:(ae.avail_in-=de,o.arraySet(q,ae.input,ae.next_in,de,M),ae.state.wrap===1?ae.adler=c(ae.adler,q,de,M):ae.state.wrap===2&&(ae.adler=d(ae.adler,q,de,M)),ae.next_in+=de,ae.total_in+=de,de),j.lookahead+=re,j.lookahead+j.insert>=T)for(U=j.strstart-j.insert,j.ins_h=j.window[U],j.ins_h=(j.ins_h<<j.hash_shift^j.window[U+1])&j.hash_mask;j.insert&&(j.ins_h=(j.ins_h<<j.hash_shift^j.window[U+T-1])&j.hash_mask,j.prev[U&j.w_mask]=j.head[j.ins_h],j.head[j.ins_h]=U,U++,j.insert--,!(j.lookahead+j.insert<T)););}while(j.lookahead<X&&j.strm.avail_in!==0)}function $e(j,ce){for(var re,z;;){if(j.lookahead<X){if(Oe(j),j.lookahead<X&&ce===f)return S;if(j.lookahead===0)break}if(re=0,j.lookahead>=T&&(j.ins_h=(j.ins_h<<j.hash_shift^j.window[j.strstart+T-1])&j.hash_mask,re=j.prev[j.strstart&j.w_mask]=j.head[j.ins_h],j.head[j.ins_h]=j.strstart),re!==0&&j.strstart-re<=j.w_size-X&&(j.match_length=fe(j,re)),j.match_length>=T)if(z=l._tr_tally(j,j.strstart-j.match_start,j.match_length-T),j.lookahead-=j.match_length,j.match_length<=j.max_lazy_match&&j.lookahead>=T){for(j.match_length--;j.strstart++,j.ins_h=(j.ins_h<<j.hash_shift^j.window[j.strstart+T-1])&j.hash_mask,re=j.prev[j.strstart&j.w_mask]=j.head[j.ins_h],j.head[j.ins_h]=j.strstart,--j.match_length!=0;);j.strstart++}else j.strstart+=j.match_length,j.match_length=0,j.ins_h=j.window[j.strstart],j.ins_h=(j.ins_h<<j.hash_shift^j.window[j.strstart+1])&j.hash_mask;else z=l._tr_tally(j,0,j.window[j.strstart]),j.lookahead--,j.strstart++;if(z&&(G(j,!1),j.strm.avail_out===0))return S}return j.insert=j.strstart<T-1?j.strstart:T-1,ce===h?(G(j,!0),j.strm.avail_out===0?le:D):j.last_lit&&(G(j,!1),j.strm.avail_out===0)?S:K}function Ie(j,ce){for(var re,z,R;;){if(j.lookahead<X){if(Oe(j),j.lookahead<X&&ce===f)return S;if(j.lookahead===0)break}if(re=0,j.lookahead>=T&&(j.ins_h=(j.ins_h<<j.hash_shift^j.window[j.strstart+T-1])&j.hash_mask,re=j.prev[j.strstart&j.w_mask]=j.head[j.ins_h],j.head[j.ins_h]=j.strstart),j.prev_length=j.match_length,j.prev_match=j.match_start,j.match_length=T-1,re!==0&&j.prev_length<j.max_lazy_match&&j.strstart-re<=j.w_size-X&&(j.match_length=fe(j,re),j.match_length<=5&&(j.strategy===1||j.match_length===T&&4096<j.strstart-j.match_start)&&(j.match_length=T-1)),j.prev_length>=T&&j.match_length<=j.prev_length){for(R=j.strstart+j.lookahead-T,z=l._tr_tally(j,j.strstart-1-j.prev_match,j.prev_length-T),j.lookahead-=j.prev_length-1,j.prev_length-=2;++j.strstart<=R&&(j.ins_h=(j.ins_h<<j.hash_shift^j.window[j.strstart+T-1])&j.hash_mask,re=j.prev[j.strstart&j.w_mask]=j.head[j.ins_h],j.head[j.ins_h]=j.strstart),--j.prev_length!=0;);if(j.match_available=0,j.match_length=T-1,j.strstart++,z&&(G(j,!1),j.strm.avail_out===0))return S}else if(j.match_available){if((z=l._tr_tally(j,0,j.window[j.strstart-1]))&&G(j,!1),j.strstart++,j.lookahead--,j.strm.avail_out===0)return S}else j.match_available=1,j.strstart++,j.lookahead--}return j.match_available&&(z=l._tr_tally(j,0,j.window[j.strstart-1]),j.match_available=0),j.insert=j.strstart<T-1?j.strstart:T-1,ce===h?(G(j,!0),j.strm.avail_out===0?le:D):j.last_lit&&(G(j,!1),j.strm.avail_out===0)?S:K}function Ee(j,ce,re,z,R){this.good_length=j,this.max_lazy=ce,this.nice_length=re,this.max_chain=z,this.func=R}function ge(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=y,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new o.Buf16(2*C),this.dyn_dtree=new o.Buf16(2*(2*k+1)),this.bl_tree=new o.Buf16(2*(2*_+1)),Z(this.dyn_ltree),Z(this.dyn_dtree),Z(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new o.Buf16(N+1),this.heap=new o.Buf16(2*w+1),Z(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new o.Buf16(2*w+1),Z(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function me(j){var ce;return j&&j.state?(j.total_in=j.total_out=0,j.data_type=v,(ce=j.state).pending=0,ce.pending_out=0,ce.wrap<0&&(ce.wrap=-ce.wrap),ce.status=ce.wrap?E:F,j.adler=ce.wrap===2?0:1,ce.last_flush=f,l._tr_init(ce),p):I(j,g)}function He(j){var ce=me(j);return ce===p&&function(re){re.window_size=2*re.w_size,Z(re.head),re.max_lazy_match=s[re.level].max_lazy,re.good_match=s[re.level].good_length,re.nice_match=s[re.level].nice_length,re.max_chain_length=s[re.level].max_chain,re.strstart=0,re.block_start=0,re.lookahead=0,re.insert=0,re.match_length=re.prev_length=T-1,re.match_available=0,re.ins_h=0}(j.state),ce}function ue(j,ce,re,z,R,U){if(!j)return g;var ae=1;if(ce===m&&(ce=6),z<0?(ae=0,z=-z):15<z&&(ae=2,z-=16),R<1||b<R||re!==y||z<8||15<z||ce<0||9<ce||U<0||x<U)return I(j,g);z===8&&(z=9);var q=new ge;return(j.state=q).strm=j,q.wrap=ae,q.gzhead=null,q.w_bits=z,q.w_size=1<<q.w_bits,q.w_mask=q.w_size-1,q.hash_bits=R+7,q.hash_size=1<<q.hash_bits,q.hash_mask=q.hash_size-1,q.hash_shift=~~((q.hash_bits+T-1)/T),q.window=new o.Buf8(2*q.w_size),q.head=new o.Buf16(q.hash_size),q.prev=new o.Buf16(q.w_size),q.lit_bufsize=1<<R+6,q.pending_buf_size=4*q.lit_bufsize,q.pending_buf=new o.Buf8(q.pending_buf_size),q.d_buf=1*q.lit_bufsize,q.l_buf=3*q.lit_bufsize,q.level=ce,q.strategy=U,q.method=re,He(j)}s=[new Ee(0,0,0,0,function(j,ce){var re=65535;for(re>j.pending_buf_size-5&&(re=j.pending_buf_size-5);;){if(j.lookahead<=1){if(Oe(j),j.lookahead===0&&ce===f)return S;if(j.lookahead===0)break}j.strstart+=j.lookahead,j.lookahead=0;var z=j.block_start+re;if((j.strstart===0||j.strstart>=z)&&(j.lookahead=j.strstart-z,j.strstart=z,G(j,!1),j.strm.avail_out===0)||j.strstart-j.block_start>=j.w_size-X&&(G(j,!1),j.strm.avail_out===0))return S}return j.insert=0,ce===h?(G(j,!0),j.strm.avail_out===0?le:D):(j.strstart>j.block_start&&(G(j,!1),j.strm.avail_out),S)}),new Ee(4,4,8,4,$e),new Ee(4,5,16,8,$e),new Ee(4,6,32,32,$e),new Ee(4,4,16,16,Ie),new Ee(8,16,32,32,Ie),new Ee(8,16,128,128,Ie),new Ee(8,32,128,256,Ie),new Ee(32,128,258,1024,Ie),new Ee(32,258,258,4096,Ie)],i.deflateInit=function(j,ce){return ue(j,ce,y,15,8,0)},i.deflateInit2=ue,i.deflateReset=He,i.deflateResetKeep=me,i.deflateSetHeader=function(j,ce){return j&&j.state?j.state.wrap!==2?g:(j.state.gzhead=ce,p):g},i.deflate=function(j,ce){var re,z,R,U;if(!j||!j.state||5<ce||ce<0)return j?I(j,g):g;if(z=j.state,!j.output||!j.input&&j.avail_in!==0||z.status===666&&ce!==h)return I(j,j.avail_out===0?-5:g);if(z.strm=j,re=z.last_flush,z.last_flush=ce,z.status===E)if(z.wrap===2)j.adler=0,ee(z,31),ee(z,139),ee(z,8),z.gzhead?(ee(z,(z.gzhead.text?1:0)+(z.gzhead.hcrc?2:0)+(z.gzhead.extra?4:0)+(z.gzhead.name?8:0)+(z.gzhead.comment?16:0)),ee(z,255&z.gzhead.time),ee(z,z.gzhead.time>>8&255),ee(z,z.gzhead.time>>16&255),ee(z,z.gzhead.time>>24&255),ee(z,z.level===9?2:2<=z.strategy||z.level<2?4:0),ee(z,255&z.gzhead.os),z.gzhead.extra&&z.gzhead.extra.length&&(ee(z,255&z.gzhead.extra.length),ee(z,z.gzhead.extra.length>>8&255)),z.gzhead.hcrc&&(j.adler=d(j.adler,z.pending_buf,z.pending,0)),z.gzindex=0,z.status=69):(ee(z,0),ee(z,0),ee(z,0),ee(z,0),ee(z,0),ee(z,z.level===9?2:2<=z.strategy||z.level<2?4:0),ee(z,3),z.status=F);else{var ae=y+(z.w_bits-8<<4)<<8;ae|=(2<=z.strategy||z.level<2?0:z.level<6?1:z.level===6?2:3)<<6,z.strstart!==0&&(ae|=32),ae+=31-ae%31,z.status=F,oe(z,ae),z.strstart!==0&&(oe(z,j.adler>>>16),oe(z,65535&j.adler)),j.adler=1}if(z.status===69)if(z.gzhead.extra){for(R=z.pending;z.gzindex<(65535&z.gzhead.extra.length)&&(z.pending!==z.pending_buf_size||(z.gzhead.hcrc&&z.pending>R&&(j.adler=d(j.adler,z.pending_buf,z.pending-R,R)),H(j),R=z.pending,z.pending!==z.pending_buf_size));)ee(z,255&z.gzhead.extra[z.gzindex]),z.gzindex++;z.gzhead.hcrc&&z.pending>R&&(j.adler=d(j.adler,z.pending_buf,z.pending-R,R)),z.gzindex===z.gzhead.extra.length&&(z.gzindex=0,z.status=73)}else z.status=73;if(z.status===73)if(z.gzhead.name){R=z.pending;do{if(z.pending===z.pending_buf_size&&(z.gzhead.hcrc&&z.pending>R&&(j.adler=d(j.adler,z.pending_buf,z.pending-R,R)),H(j),R=z.pending,z.pending===z.pending_buf_size)){U=1;break}U=z.gzindex<z.gzhead.name.length?255&z.gzhead.name.charCodeAt(z.gzindex++):0,ee(z,U)}while(U!==0);z.gzhead.hcrc&&z.pending>R&&(j.adler=d(j.adler,z.pending_buf,z.pending-R,R)),U===0&&(z.gzindex=0,z.status=91)}else z.status=91;if(z.status===91)if(z.gzhead.comment){R=z.pending;do{if(z.pending===z.pending_buf_size&&(z.gzhead.hcrc&&z.pending>R&&(j.adler=d(j.adler,z.pending_buf,z.pending-R,R)),H(j),R=z.pending,z.pending===z.pending_buf_size)){U=1;break}U=z.gzindex<z.gzhead.comment.length?255&z.gzhead.comment.charCodeAt(z.gzindex++):0,ee(z,U)}while(U!==0);z.gzhead.hcrc&&z.pending>R&&(j.adler=d(j.adler,z.pending_buf,z.pending-R,R)),U===0&&(z.status=103)}else z.status=103;if(z.status===103&&(z.gzhead.hcrc?(z.pending+2>z.pending_buf_size&&H(j),z.pending+2<=z.pending_buf_size&&(ee(z,255&j.adler),ee(z,j.adler>>8&255),j.adler=0,z.status=F)):z.status=F),z.pending!==0){if(H(j),j.avail_out===0)return z.last_flush=-1,p}else if(j.avail_in===0&&L(ce)<=L(re)&&ce!==h)return I(j,-5);if(z.status===666&&j.avail_in!==0)return I(j,-5);if(j.avail_in!==0||z.lookahead!==0||ce!==f&&z.status!==666){var q=z.strategy===2?function(M,J){for(var de;;){if(M.lookahead===0&&(Oe(M),M.lookahead===0)){if(J===f)return S;break}if(M.match_length=0,de=l._tr_tally(M,0,M.window[M.strstart]),M.lookahead--,M.strstart++,de&&(G(M,!1),M.strm.avail_out===0))return S}return M.insert=0,J===h?(G(M,!0),M.strm.avail_out===0?le:D):M.last_lit&&(G(M,!1),M.strm.avail_out===0)?S:K}(z,ce):z.strategy===3?function(M,J){for(var de,ie,A,Y,se=M.window;;){if(M.lookahead<=O){if(Oe(M),M.lookahead<=O&&J===f)return S;if(M.lookahead===0)break}if(M.match_length=0,M.lookahead>=T&&0<M.strstart&&(ie=se[A=M.strstart-1])===se[++A]&&ie===se[++A]&&ie===se[++A]){Y=M.strstart+O;do;while(ie===se[++A]&&ie===se[++A]&&ie===se[++A]&&ie===se[++A]&&ie===se[++A]&&ie===se[++A]&&ie===se[++A]&&ie===se[++A]&&A<Y);M.match_length=O-(Y-A),M.match_length>M.lookahead&&(M.match_length=M.lookahead)}if(M.match_length>=T?(de=l._tr_tally(M,1,M.match_length-T),M.lookahead-=M.match_length,M.strstart+=M.match_length,M.match_length=0):(de=l._tr_tally(M,0,M.window[M.strstart]),M.lookahead--,M.strstart++),de&&(G(M,!1),M.strm.avail_out===0))return S}return M.insert=0,J===h?(G(M,!0),M.strm.avail_out===0?le:D):M.last_lit&&(G(M,!1),M.strm.avail_out===0)?S:K}(z,ce):s[z.level].func(z,ce);if(q!==le&&q!==D||(z.status=666),q===S||q===le)return j.avail_out===0&&(z.last_flush=-1),p;if(q===K&&(ce===1?l._tr_align(z):ce!==5&&(l._tr_stored_block(z,0,0,!1),ce===3&&(Z(z.head),z.lookahead===0&&(z.strstart=0,z.block_start=0,z.insert=0))),H(j),j.avail_out===0))return z.last_flush=-1,p}return ce!==h?p:z.wrap<=0?1:(z.wrap===2?(ee(z,255&j.adler),ee(z,j.adler>>8&255),ee(z,j.adler>>16&255),ee(z,j.adler>>24&255),ee(z,255&j.total_in),ee(z,j.total_in>>8&255),ee(z,j.total_in>>16&255),ee(z,j.total_in>>24&255)):(oe(z,j.adler>>>16),oe(z,65535&j.adler)),H(j),0<z.wrap&&(z.wrap=-z.wrap),z.pending!==0?p:1)},i.deflateEnd=function(j){var ce;return j&&j.state?(ce=j.state.status)!==E&&ce!==69&&ce!==73&&ce!==91&&ce!==103&&ce!==F&&ce!==666?I(j,g):(j.state=null,ce===F?I(j,-3):p):g},i.deflateSetDictionary=function(j,ce){var re,z,R,U,ae,q,M,J,de=ce.length;if(!j||!j.state||(U=(re=j.state).wrap)===2||U===1&&re.status!==E||re.lookahead)return g;for(U===1&&(j.adler=c(j.adler,ce,de,0)),re.wrap=0,de>=re.w_size&&(U===0&&(Z(re.head),re.strstart=0,re.block_start=0,re.insert=0),J=new o.Buf8(re.w_size),o.arraySet(J,ce,de-re.w_size,re.w_size,0),ce=J,de=re.w_size),ae=j.avail_in,q=j.next_in,M=j.input,j.avail_in=de,j.next_in=0,j.input=ce,Oe(re);re.lookahead>=T;){for(z=re.strstart,R=re.lookahead-(T-1);re.ins_h=(re.ins_h<<re.hash_shift^re.window[z+T-1])&re.hash_mask,re.prev[z&re.w_mask]=re.head[re.ins_h],re.head[re.ins_h]=z,z++,--R;);re.strstart=z,re.lookahead=T-1,Oe(re)}return re.strstart+=re.lookahead,re.block_start=re.strstart,re.insert=re.lookahead,re.lookahead=0,re.match_length=re.prev_length=T-1,re.match_available=0,j.next_in=q,j.input=M,j.avail_in=ae,re.wrap=U,p},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(r,n,i){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(r,n,i){n.exports=function(s,o){var l,c,d,u,f,h,p,g,m,x,v,y,b,w,k,_,C,N,T,O,X,E,F,S,K;l=s.state,c=s.next_in,S=s.input,d=c+(s.avail_in-5),u=s.next_out,K=s.output,f=u-(o-s.avail_out),h=u+(s.avail_out-257),p=l.dmax,g=l.wsize,m=l.whave,x=l.wnext,v=l.window,y=l.hold,b=l.bits,w=l.lencode,k=l.distcode,_=(1<<l.lenbits)-1,C=(1<<l.distbits)-1;e:do{b<15&&(y+=S[c++]<<b,b+=8,y+=S[c++]<<b,b+=8),N=w[y&_];t:for(;;){if(y>>>=T=N>>>24,b-=T,(T=N>>>16&255)===0)K[u++]=65535&N;else{if(!(16&T)){if(!(64&T)){N=w[(65535&N)+(y&(1<<T)-1)];continue t}if(32&T){l.mode=12;break e}s.msg="invalid literal/length code",l.mode=30;break e}O=65535&N,(T&=15)&&(b<T&&(y+=S[c++]<<b,b+=8),O+=y&(1<<T)-1,y>>>=T,b-=T),b<15&&(y+=S[c++]<<b,b+=8,y+=S[c++]<<b,b+=8),N=k[y&C];r:for(;;){if(y>>>=T=N>>>24,b-=T,!(16&(T=N>>>16&255))){if(!(64&T)){N=k[(65535&N)+(y&(1<<T)-1)];continue r}s.msg="invalid distance code",l.mode=30;break e}if(X=65535&N,b<(T&=15)&&(y+=S[c++]<<b,(b+=8)<T&&(y+=S[c++]<<b,b+=8)),p<(X+=y&(1<<T)-1)){s.msg="invalid distance too far back",l.mode=30;break e}if(y>>>=T,b-=T,(T=u-f)<X){if(m<(T=X-T)&&l.sane){s.msg="invalid distance too far back",l.mode=30;break e}if(F=v,(E=0)===x){if(E+=g-T,T<O){for(O-=T;K[u++]=v[E++],--T;);E=u-X,F=K}}else if(x<T){if(E+=g+x-T,(T-=x)<O){for(O-=T;K[u++]=v[E++],--T;);if(E=0,x<O){for(O-=T=x;K[u++]=v[E++],--T;);E=u-X,F=K}}}else if(E+=x-T,T<O){for(O-=T;K[u++]=v[E++],--T;);E=u-X,F=K}for(;2<O;)K[u++]=F[E++],K[u++]=F[E++],K[u++]=F[E++],O-=3;O&&(K[u++]=F[E++],1<O&&(K[u++]=F[E++]))}else{for(E=u-X;K[u++]=K[E++],K[u++]=K[E++],K[u++]=K[E++],2<(O-=3););O&&(K[u++]=K[E++],1<O&&(K[u++]=K[E++]))}break}}break}}while(c<d&&u<h);c-=O=b>>3,y&=(1<<(b-=O<<3))-1,s.next_in=c,s.next_out=u,s.avail_in=c<d?d-c+5:5-(c-d),s.avail_out=u<h?h-u+257:257-(u-h),l.hold=y,l.bits=b}},{}],49:[function(r,n,i){var s=r("../utils/common"),o=r("./adler32"),l=r("./crc32"),c=r("./inffast"),d=r("./inftrees"),u=1,f=2,h=0,p=-2,g=1,m=852,x=592;function v(E){return(E>>>24&255)+(E>>>8&65280)+((65280&E)<<8)+((255&E)<<24)}function y(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function b(E){var F;return E&&E.state?(F=E.state,E.total_in=E.total_out=F.total=0,E.msg="",F.wrap&&(E.adler=1&F.wrap),F.mode=g,F.last=0,F.havedict=0,F.dmax=32768,F.head=null,F.hold=0,F.bits=0,F.lencode=F.lendyn=new s.Buf32(m),F.distcode=F.distdyn=new s.Buf32(x),F.sane=1,F.back=-1,h):p}function w(E){var F;return E&&E.state?((F=E.state).wsize=0,F.whave=0,F.wnext=0,b(E)):p}function k(E,F){var S,K;return E&&E.state?(K=E.state,F<0?(S=0,F=-F):(S=1+(F>>4),F<48&&(F&=15)),F&&(F<8||15<F)?p:(K.window!==null&&K.wbits!==F&&(K.window=null),K.wrap=S,K.wbits=F,w(E))):p}function _(E,F){var S,K;return E?(K=new y,(E.state=K).window=null,(S=k(E,F))!==h&&(E.state=null),S):p}var C,N,T=!0;function O(E){if(T){var F;for(C=new s.Buf32(512),N=new s.Buf32(32),F=0;F<144;)E.lens[F++]=8;for(;F<256;)E.lens[F++]=9;for(;F<280;)E.lens[F++]=7;for(;F<288;)E.lens[F++]=8;for(d(u,E.lens,0,288,C,0,E.work,{bits:9}),F=0;F<32;)E.lens[F++]=5;d(f,E.lens,0,32,N,0,E.work,{bits:5}),T=!1}E.lencode=C,E.lenbits=9,E.distcode=N,E.distbits=5}function X(E,F,S,K){var le,D=E.state;return D.window===null&&(D.wsize=1<<D.wbits,D.wnext=0,D.whave=0,D.window=new s.Buf8(D.wsize)),K>=D.wsize?(s.arraySet(D.window,F,S-D.wsize,D.wsize,0),D.wnext=0,D.whave=D.wsize):(K<(le=D.wsize-D.wnext)&&(le=K),s.arraySet(D.window,F,S-K,le,D.wnext),(K-=le)?(s.arraySet(D.window,F,S-K,K,0),D.wnext=K,D.whave=D.wsize):(D.wnext+=le,D.wnext===D.wsize&&(D.wnext=0),D.whave<D.wsize&&(D.whave+=le))),0}i.inflateReset=w,i.inflateReset2=k,i.inflateResetKeep=b,i.inflateInit=function(E){return _(E,15)},i.inflateInit2=_,i.inflate=function(E,F){var S,K,le,D,I,L,Z,H,G,ee,oe,fe,Oe,$e,Ie,Ee,ge,me,He,ue,j,ce,re,z,R=0,U=new s.Buf8(4),ae=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!E||!E.state||!E.output||!E.input&&E.avail_in!==0)return p;(S=E.state).mode===12&&(S.mode=13),I=E.next_out,le=E.output,Z=E.avail_out,D=E.next_in,K=E.input,L=E.avail_in,H=S.hold,G=S.bits,ee=L,oe=Z,ce=h;e:for(;;)switch(S.mode){case g:if(S.wrap===0){S.mode=13;break}for(;G<16;){if(L===0)break e;L--,H+=K[D++]<<G,G+=8}if(2&S.wrap&&H===35615){U[S.check=0]=255&H,U[1]=H>>>8&255,S.check=l(S.check,U,2,0),G=H=0,S.mode=2;break}if(S.flags=0,S.head&&(S.head.done=!1),!(1&S.wrap)||(((255&H)<<8)+(H>>8))%31){E.msg="incorrect header check",S.mode=30;break}if((15&H)!=8){E.msg="unknown compression method",S.mode=30;break}if(G-=4,j=8+(15&(H>>>=4)),S.wbits===0)S.wbits=j;else if(j>S.wbits){E.msg="invalid window size",S.mode=30;break}S.dmax=1<<j,E.adler=S.check=1,S.mode=512&H?10:12,G=H=0;break;case 2:for(;G<16;){if(L===0)break e;L--,H+=K[D++]<<G,G+=8}if(S.flags=H,(255&S.flags)!=8){E.msg="unknown compression method",S.mode=30;break}if(57344&S.flags){E.msg="unknown header flags set",S.mode=30;break}S.head&&(S.head.text=H>>8&1),512&S.flags&&(U[0]=255&H,U[1]=H>>>8&255,S.check=l(S.check,U,2,0)),G=H=0,S.mode=3;case 3:for(;G<32;){if(L===0)break e;L--,H+=K[D++]<<G,G+=8}S.head&&(S.head.time=H),512&S.flags&&(U[0]=255&H,U[1]=H>>>8&255,U[2]=H>>>16&255,U[3]=H>>>24&255,S.check=l(S.check,U,4,0)),G=H=0,S.mode=4;case 4:for(;G<16;){if(L===0)break e;L--,H+=K[D++]<<G,G+=8}S.head&&(S.head.xflags=255&H,S.head.os=H>>8),512&S.flags&&(U[0]=255&H,U[1]=H>>>8&255,S.check=l(S.check,U,2,0)),G=H=0,S.mode=5;case 5:if(1024&S.flags){for(;G<16;){if(L===0)break e;L--,H+=K[D++]<<G,G+=8}S.length=H,S.head&&(S.head.extra_len=H),512&S.flags&&(U[0]=255&H,U[1]=H>>>8&255,S.check=l(S.check,U,2,0)),G=H=0}else S.head&&(S.head.extra=null);S.mode=6;case 6:if(1024&S.flags&&(L<(fe=S.length)&&(fe=L),fe&&(S.head&&(j=S.head.extra_len-S.length,S.head.extra||(S.head.extra=new Array(S.head.extra_len)),s.arraySet(S.head.extra,K,D,fe,j)),512&S.flags&&(S.check=l(S.check,K,fe,D)),L-=fe,D+=fe,S.length-=fe),S.length))break e;S.length=0,S.mode=7;case 7:if(2048&S.flags){if(L===0)break e;for(fe=0;j=K[D+fe++],S.head&&j&&S.length<65536&&(S.head.name+=String.fromCharCode(j)),j&&fe<L;);if(512&S.flags&&(S.check=l(S.check,K,fe,D)),L-=fe,D+=fe,j)break e}else S.head&&(S.head.name=null);S.length=0,S.mode=8;case 8:if(4096&S.flags){if(L===0)break e;for(fe=0;j=K[D+fe++],S.head&&j&&S.length<65536&&(S.head.comment+=String.fromCharCode(j)),j&&fe<L;);if(512&S.flags&&(S.check=l(S.check,K,fe,D)),L-=fe,D+=fe,j)break e}else S.head&&(S.head.comment=null);S.mode=9;case 9:if(512&S.flags){for(;G<16;){if(L===0)break e;L--,H+=K[D++]<<G,G+=8}if(H!==(65535&S.check)){E.msg="header crc mismatch",S.mode=30;break}G=H=0}S.head&&(S.head.hcrc=S.flags>>9&1,S.head.done=!0),E.adler=S.check=0,S.mode=12;break;case 10:for(;G<32;){if(L===0)break e;L--,H+=K[D++]<<G,G+=8}E.adler=S.check=v(H),G=H=0,S.mode=11;case 11:if(S.havedict===0)return E.next_out=I,E.avail_out=Z,E.next_in=D,E.avail_in=L,S.hold=H,S.bits=G,2;E.adler=S.check=1,S.mode=12;case 12:if(F===5||F===6)break e;case 13:if(S.last){H>>>=7&G,G-=7&G,S.mode=27;break}for(;G<3;){if(L===0)break e;L--,H+=K[D++]<<G,G+=8}switch(S.last=1&H,G-=1,3&(H>>>=1)){case 0:S.mode=14;break;case 1:if(O(S),S.mode=20,F!==6)break;H>>>=2,G-=2;break e;case 2:S.mode=17;break;case 3:E.msg="invalid block type",S.mode=30}H>>>=2,G-=2;break;case 14:for(H>>>=7&G,G-=7&G;G<32;){if(L===0)break e;L--,H+=K[D++]<<G,G+=8}if((65535&H)!=(H>>>16^65535)){E.msg="invalid stored block lengths",S.mode=30;break}if(S.length=65535&H,G=H=0,S.mode=15,F===6)break e;case 15:S.mode=16;case 16:if(fe=S.length){if(L<fe&&(fe=L),Z<fe&&(fe=Z),fe===0)break e;s.arraySet(le,K,D,fe,I),L-=fe,D+=fe,Z-=fe,I+=fe,S.length-=fe;break}S.mode=12;break;case 17:for(;G<14;){if(L===0)break e;L--,H+=K[D++]<<G,G+=8}if(S.nlen=257+(31&H),H>>>=5,G-=5,S.ndist=1+(31&H),H>>>=5,G-=5,S.ncode=4+(15&H),H>>>=4,G-=4,286<S.nlen||30<S.ndist){E.msg="too many length or distance symbols",S.mode=30;break}S.have=0,S.mode=18;case 18:for(;S.have<S.ncode;){for(;G<3;){if(L===0)break e;L--,H+=K[D++]<<G,G+=8}S.lens[ae[S.have++]]=7&H,H>>>=3,G-=3}for(;S.have<19;)S.lens[ae[S.have++]]=0;if(S.lencode=S.lendyn,S.lenbits=7,re={bits:S.lenbits},ce=d(0,S.lens,0,19,S.lencode,0,S.work,re),S.lenbits=re.bits,ce){E.msg="invalid code lengths set",S.mode=30;break}S.have=0,S.mode=19;case 19:for(;S.have<S.nlen+S.ndist;){for(;Ee=(R=S.lencode[H&(1<<S.lenbits)-1])>>>16&255,ge=65535&R,!((Ie=R>>>24)<=G);){if(L===0)break e;L--,H+=K[D++]<<G,G+=8}if(ge<16)H>>>=Ie,G-=Ie,S.lens[S.have++]=ge;else{if(ge===16){for(z=Ie+2;G<z;){if(L===0)break e;L--,H+=K[D++]<<G,G+=8}if(H>>>=Ie,G-=Ie,S.have===0){E.msg="invalid bit length repeat",S.mode=30;break}j=S.lens[S.have-1],fe=3+(3&H),H>>>=2,G-=2}else if(ge===17){for(z=Ie+3;G<z;){if(L===0)break e;L--,H+=K[D++]<<G,G+=8}G-=Ie,j=0,fe=3+(7&(H>>>=Ie)),H>>>=3,G-=3}else{for(z=Ie+7;G<z;){if(L===0)break e;L--,H+=K[D++]<<G,G+=8}G-=Ie,j=0,fe=11+(127&(H>>>=Ie)),H>>>=7,G-=7}if(S.have+fe>S.nlen+S.ndist){E.msg="invalid bit length repeat",S.mode=30;break}for(;fe--;)S.lens[S.have++]=j}}if(S.mode===30)break;if(S.lens[256]===0){E.msg="invalid code -- missing end-of-block",S.mode=30;break}if(S.lenbits=9,re={bits:S.lenbits},ce=d(u,S.lens,0,S.nlen,S.lencode,0,S.work,re),S.lenbits=re.bits,ce){E.msg="invalid literal/lengths set",S.mode=30;break}if(S.distbits=6,S.distcode=S.distdyn,re={bits:S.distbits},ce=d(f,S.lens,S.nlen,S.ndist,S.distcode,0,S.work,re),S.distbits=re.bits,ce){E.msg="invalid distances set",S.mode=30;break}if(S.mode=20,F===6)break e;case 20:S.mode=21;case 21:if(6<=L&&258<=Z){E.next_out=I,E.avail_out=Z,E.next_in=D,E.avail_in=L,S.hold=H,S.bits=G,c(E,oe),I=E.next_out,le=E.output,Z=E.avail_out,D=E.next_in,K=E.input,L=E.avail_in,H=S.hold,G=S.bits,S.mode===12&&(S.back=-1);break}for(S.back=0;Ee=(R=S.lencode[H&(1<<S.lenbits)-1])>>>16&255,ge=65535&R,!((Ie=R>>>24)<=G);){if(L===0)break e;L--,H+=K[D++]<<G,G+=8}if(Ee&&!(240&Ee)){for(me=Ie,He=Ee,ue=ge;Ee=(R=S.lencode[ue+((H&(1<<me+He)-1)>>me)])>>>16&255,ge=65535&R,!(me+(Ie=R>>>24)<=G);){if(L===0)break e;L--,H+=K[D++]<<G,G+=8}H>>>=me,G-=me,S.back+=me}if(H>>>=Ie,G-=Ie,S.back+=Ie,S.length=ge,Ee===0){S.mode=26;break}if(32&Ee){S.back=-1,S.mode=12;break}if(64&Ee){E.msg="invalid literal/length code",S.mode=30;break}S.extra=15&Ee,S.mode=22;case 22:if(S.extra){for(z=S.extra;G<z;){if(L===0)break e;L--,H+=K[D++]<<G,G+=8}S.length+=H&(1<<S.extra)-1,H>>>=S.extra,G-=S.extra,S.back+=S.extra}S.was=S.length,S.mode=23;case 23:for(;Ee=(R=S.distcode[H&(1<<S.distbits)-1])>>>16&255,ge=65535&R,!((Ie=R>>>24)<=G);){if(L===0)break e;L--,H+=K[D++]<<G,G+=8}if(!(240&Ee)){for(me=Ie,He=Ee,ue=ge;Ee=(R=S.distcode[ue+((H&(1<<me+He)-1)>>me)])>>>16&255,ge=65535&R,!(me+(Ie=R>>>24)<=G);){if(L===0)break e;L--,H+=K[D++]<<G,G+=8}H>>>=me,G-=me,S.back+=me}if(H>>>=Ie,G-=Ie,S.back+=Ie,64&Ee){E.msg="invalid distance code",S.mode=30;break}S.offset=ge,S.extra=15&Ee,S.mode=24;case 24:if(S.extra){for(z=S.extra;G<z;){if(L===0)break e;L--,H+=K[D++]<<G,G+=8}S.offset+=H&(1<<S.extra)-1,H>>>=S.extra,G-=S.extra,S.back+=S.extra}if(S.offset>S.dmax){E.msg="invalid distance too far back",S.mode=30;break}S.mode=25;case 25:if(Z===0)break e;if(fe=oe-Z,S.offset>fe){if((fe=S.offset-fe)>S.whave&&S.sane){E.msg="invalid distance too far back",S.mode=30;break}Oe=fe>S.wnext?(fe-=S.wnext,S.wsize-fe):S.wnext-fe,fe>S.length&&(fe=S.length),$e=S.window}else $e=le,Oe=I-S.offset,fe=S.length;for(Z<fe&&(fe=Z),Z-=fe,S.length-=fe;le[I++]=$e[Oe++],--fe;);S.length===0&&(S.mode=21);break;case 26:if(Z===0)break e;le[I++]=S.length,Z--,S.mode=21;break;case 27:if(S.wrap){for(;G<32;){if(L===0)break e;L--,H|=K[D++]<<G,G+=8}if(oe-=Z,E.total_out+=oe,S.total+=oe,oe&&(E.adler=S.check=S.flags?l(S.check,le,oe,I-oe):o(S.check,le,oe,I-oe)),oe=Z,(S.flags?H:v(H))!==S.check){E.msg="incorrect data check",S.mode=30;break}G=H=0}S.mode=28;case 28:if(S.wrap&&S.flags){for(;G<32;){if(L===0)break e;L--,H+=K[D++]<<G,G+=8}if(H!==(4294967295&S.total)){E.msg="incorrect length check",S.mode=30;break}G=H=0}S.mode=29;case 29:ce=1;break e;case 30:ce=-3;break e;case 31:return-4;case 32:default:return p}return E.next_out=I,E.avail_out=Z,E.next_in=D,E.avail_in=L,S.hold=H,S.bits=G,(S.wsize||oe!==E.avail_out&&S.mode<30&&(S.mode<27||F!==4))&&X(E,E.output,E.next_out,oe-E.avail_out)?(S.mode=31,-4):(ee-=E.avail_in,oe-=E.avail_out,E.total_in+=ee,E.total_out+=oe,S.total+=oe,S.wrap&&oe&&(E.adler=S.check=S.flags?l(S.check,le,oe,E.next_out-oe):o(S.check,le,oe,E.next_out-oe)),E.data_type=S.bits+(S.last?64:0)+(S.mode===12?128:0)+(S.mode===20||S.mode===15?256:0),(ee==0&&oe===0||F===4)&&ce===h&&(ce=-5),ce)},i.inflateEnd=function(E){if(!E||!E.state)return p;var F=E.state;return F.window&&(F.window=null),E.state=null,h},i.inflateGetHeader=function(E,F){var S;return E&&E.state&&2&(S=E.state).wrap?((S.head=F).done=!1,h):p},i.inflateSetDictionary=function(E,F){var S,K=F.length;return E&&E.state?(S=E.state).wrap!==0&&S.mode!==11?p:S.mode===11&&o(1,F,K,0)!==S.check?-3:X(E,F,K,K)?(S.mode=31,-4):(S.havedict=1,h):p},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(r,n,i){var s=r("../utils/common"),o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],d=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(u,f,h,p,g,m,x,v){var y,b,w,k,_,C,N,T,O,X=v.bits,E=0,F=0,S=0,K=0,le=0,D=0,I=0,L=0,Z=0,H=0,G=null,ee=0,oe=new s.Buf16(16),fe=new s.Buf16(16),Oe=null,$e=0;for(E=0;E<=15;E++)oe[E]=0;for(F=0;F<p;F++)oe[f[h+F]]++;for(le=X,K=15;1<=K&&oe[K]===0;K--);if(K<le&&(le=K),K===0)return g[m++]=20971520,g[m++]=20971520,v.bits=1,0;for(S=1;S<K&&oe[S]===0;S++);for(le<S&&(le=S),E=L=1;E<=15;E++)if(L<<=1,(L-=oe[E])<0)return-1;if(0<L&&(u===0||K!==1))return-1;for(fe[1]=0,E=1;E<15;E++)fe[E+1]=fe[E]+oe[E];for(F=0;F<p;F++)f[h+F]!==0&&(x[fe[f[h+F]]++]=F);if(C=u===0?(G=Oe=x,19):u===1?(G=o,ee-=257,Oe=l,$e-=257,256):(G=c,Oe=d,-1),E=S,_=m,I=F=H=0,w=-1,k=(Z=1<<(D=le))-1,u===1&&852<Z||u===2&&592<Z)return 1;for(;;){for(N=E-I,O=x[F]<C?(T=0,x[F]):x[F]>C?(T=Oe[$e+x[F]],G[ee+x[F]]):(T=96,0),y=1<<E-I,S=b=1<<D;g[_+(H>>I)+(b-=y)]=N<<24|T<<16|O|0,b!==0;);for(y=1<<E-1;H&y;)y>>=1;if(y!==0?(H&=y-1,H+=y):H=0,F++,--oe[E]==0){if(E===K)break;E=f[h+x[F]]}if(le<E&&(H&k)!==w){for(I===0&&(I=le),_+=S,L=1<<(D=E-I);D+I<K&&!((L-=oe[D+I])<=0);)D++,L<<=1;if(Z+=1<<D,u===1&&852<Z||u===2&&592<Z)return 1;g[w=H&k]=le<<24|D<<16|_-m|0}}return H!==0&&(g[_+H]=E-I<<24|64<<16|0),v.bits=le,0}},{"../utils/common":41}],51:[function(r,n,i){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(r,n,i){var s=r("../utils/common"),o=0,l=1;function c(R){for(var U=R.length;0<=--U;)R[U]=0}var d=0,u=29,f=256,h=f+1+u,p=30,g=19,m=2*h+1,x=15,v=16,y=7,b=256,w=16,k=17,_=18,C=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],N=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],T=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],X=new Array(2*(h+2));c(X);var E=new Array(2*p);c(E);var F=new Array(512);c(F);var S=new Array(256);c(S);var K=new Array(u);c(K);var le,D,I,L=new Array(p);function Z(R,U,ae,q,M){this.static_tree=R,this.extra_bits=U,this.extra_base=ae,this.elems=q,this.max_length=M,this.has_stree=R&&R.length}function H(R,U){this.dyn_tree=R,this.max_code=0,this.stat_desc=U}function G(R){return R<256?F[R]:F[256+(R>>>7)]}function ee(R,U){R.pending_buf[R.pending++]=255&U,R.pending_buf[R.pending++]=U>>>8&255}function oe(R,U,ae){R.bi_valid>v-ae?(R.bi_buf|=U<<R.bi_valid&65535,ee(R,R.bi_buf),R.bi_buf=U>>v-R.bi_valid,R.bi_valid+=ae-v):(R.bi_buf|=U<<R.bi_valid&65535,R.bi_valid+=ae)}function fe(R,U,ae){oe(R,ae[2*U],ae[2*U+1])}function Oe(R,U){for(var ae=0;ae|=1&R,R>>>=1,ae<<=1,0<--U;);return ae>>>1}function $e(R,U,ae){var q,M,J=new Array(x+1),de=0;for(q=1;q<=x;q++)J[q]=de=de+ae[q-1]<<1;for(M=0;M<=U;M++){var ie=R[2*M+1];ie!==0&&(R[2*M]=Oe(J[ie]++,ie))}}function Ie(R){var U;for(U=0;U<h;U++)R.dyn_ltree[2*U]=0;for(U=0;U<p;U++)R.dyn_dtree[2*U]=0;for(U=0;U<g;U++)R.bl_tree[2*U]=0;R.dyn_ltree[2*b]=1,R.opt_len=R.static_len=0,R.last_lit=R.matches=0}function Ee(R){8<R.bi_valid?ee(R,R.bi_buf):0<R.bi_valid&&(R.pending_buf[R.pending++]=R.bi_buf),R.bi_buf=0,R.bi_valid=0}function ge(R,U,ae,q){var M=2*U,J=2*ae;return R[M]<R[J]||R[M]===R[J]&&q[U]<=q[ae]}function me(R,U,ae){for(var q=R.heap[ae],M=ae<<1;M<=R.heap_len&&(M<R.heap_len&&ge(U,R.heap[M+1],R.heap[M],R.depth)&&M++,!ge(U,q,R.heap[M],R.depth));)R.heap[ae]=R.heap[M],ae=M,M<<=1;R.heap[ae]=q}function He(R,U,ae){var q,M,J,de,ie=0;if(R.last_lit!==0)for(;q=R.pending_buf[R.d_buf+2*ie]<<8|R.pending_buf[R.d_buf+2*ie+1],M=R.pending_buf[R.l_buf+ie],ie++,q===0?fe(R,M,U):(fe(R,(J=S[M])+f+1,U),(de=C[J])!==0&&oe(R,M-=K[J],de),fe(R,J=G(--q),ae),(de=N[J])!==0&&oe(R,q-=L[J],de)),ie<R.last_lit;);fe(R,b,U)}function ue(R,U){var ae,q,M,J=U.dyn_tree,de=U.stat_desc.static_tree,ie=U.stat_desc.has_stree,A=U.stat_desc.elems,Y=-1;for(R.heap_len=0,R.heap_max=m,ae=0;ae<A;ae++)J[2*ae]!==0?(R.heap[++R.heap_len]=Y=ae,R.depth[ae]=0):J[2*ae+1]=0;for(;R.heap_len<2;)J[2*(M=R.heap[++R.heap_len]=Y<2?++Y:0)]=1,R.depth[M]=0,R.opt_len--,ie&&(R.static_len-=de[2*M+1]);for(U.max_code=Y,ae=R.heap_len>>1;1<=ae;ae--)me(R,J,ae);for(M=A;ae=R.heap[1],R.heap[1]=R.heap[R.heap_len--],me(R,J,1),q=R.heap[1],R.heap[--R.heap_max]=ae,R.heap[--R.heap_max]=q,J[2*M]=J[2*ae]+J[2*q],R.depth[M]=(R.depth[ae]>=R.depth[q]?R.depth[ae]:R.depth[q])+1,J[2*ae+1]=J[2*q+1]=M,R.heap[1]=M++,me(R,J,1),2<=R.heap_len;);R.heap[--R.heap_max]=R.heap[1],function(se,we){var ne,Se,ke,Ce,xe,Ye,Ke=we.dyn_tree,ft=we.max_code,ut=we.stat_desc.static_tree,We=we.stat_desc.has_stree,nt=we.stat_desc.extra_bits,ht=we.stat_desc.extra_base,tt=we.stat_desc.max_length,ct=0;for(Ce=0;Ce<=x;Ce++)se.bl_count[Ce]=0;for(Ke[2*se.heap[se.heap_max]+1]=0,ne=se.heap_max+1;ne<m;ne++)tt<(Ce=Ke[2*Ke[2*(Se=se.heap[ne])+1]+1]+1)&&(Ce=tt,ct++),Ke[2*Se+1]=Ce,ft<Se||(se.bl_count[Ce]++,xe=0,ht<=Se&&(xe=nt[Se-ht]),Ye=Ke[2*Se],se.opt_len+=Ye*(Ce+xe),We&&(se.static_len+=Ye*(ut[2*Se+1]+xe)));if(ct!==0){do{for(Ce=tt-1;se.bl_count[Ce]===0;)Ce--;se.bl_count[Ce]--,se.bl_count[Ce+1]+=2,se.bl_count[tt]--,ct-=2}while(0<ct);for(Ce=tt;Ce!==0;Ce--)for(Se=se.bl_count[Ce];Se!==0;)ft<(ke=se.heap[--ne])||(Ke[2*ke+1]!==Ce&&(se.opt_len+=(Ce-Ke[2*ke+1])*Ke[2*ke],Ke[2*ke+1]=Ce),Se--)}}(R,U),$e(J,Y,R.bl_count)}function j(R,U,ae){var q,M,J=-1,de=U[1],ie=0,A=7,Y=4;for(de===0&&(A=138,Y=3),U[2*(ae+1)+1]=65535,q=0;q<=ae;q++)M=de,de=U[2*(q+1)+1],++ie<A&&M===de||(ie<Y?R.bl_tree[2*M]+=ie:M!==0?(M!==J&&R.bl_tree[2*M]++,R.bl_tree[2*w]++):ie<=10?R.bl_tree[2*k]++:R.bl_tree[2*_]++,J=M,Y=(ie=0)===de?(A=138,3):M===de?(A=6,3):(A=7,4))}function ce(R,U,ae){var q,M,J=-1,de=U[1],ie=0,A=7,Y=4;for(de===0&&(A=138,Y=3),q=0;q<=ae;q++)if(M=de,de=U[2*(q+1)+1],!(++ie<A&&M===de)){if(ie<Y)for(;fe(R,M,R.bl_tree),--ie!=0;);else M!==0?(M!==J&&(fe(R,M,R.bl_tree),ie--),fe(R,w,R.bl_tree),oe(R,ie-3,2)):ie<=10?(fe(R,k,R.bl_tree),oe(R,ie-3,3)):(fe(R,_,R.bl_tree),oe(R,ie-11,7));J=M,Y=(ie=0)===de?(A=138,3):M===de?(A=6,3):(A=7,4)}}c(L);var re=!1;function z(R,U,ae,q){oe(R,(d<<1)+(q?1:0),3),function(M,J,de,ie){Ee(M),ee(M,de),ee(M,~de),s.arraySet(M.pending_buf,M.window,J,de,M.pending),M.pending+=de}(R,U,ae)}i._tr_init=function(R){re||(function(){var U,ae,q,M,J,de=new Array(x+1);for(M=q=0;M<u-1;M++)for(K[M]=q,U=0;U<1<<C[M];U++)S[q++]=M;for(S[q-1]=M,M=J=0;M<16;M++)for(L[M]=J,U=0;U<1<<N[M];U++)F[J++]=M;for(J>>=7;M<p;M++)for(L[M]=J<<7,U=0;U<1<<N[M]-7;U++)F[256+J++]=M;for(ae=0;ae<=x;ae++)de[ae]=0;for(U=0;U<=143;)X[2*U+1]=8,U++,de[8]++;for(;U<=255;)X[2*U+1]=9,U++,de[9]++;for(;U<=279;)X[2*U+1]=7,U++,de[7]++;for(;U<=287;)X[2*U+1]=8,U++,de[8]++;for($e(X,h+1,de),U=0;U<p;U++)E[2*U+1]=5,E[2*U]=Oe(U,5);le=new Z(X,C,f+1,h,x),D=new Z(E,N,0,p,x),I=new Z(new Array(0),T,0,g,y)}(),re=!0),R.l_desc=new H(R.dyn_ltree,le),R.d_desc=new H(R.dyn_dtree,D),R.bl_desc=new H(R.bl_tree,I),R.bi_buf=0,R.bi_valid=0,Ie(R)},i._tr_stored_block=z,i._tr_flush_block=function(R,U,ae,q){var M,J,de=0;0<R.level?(R.strm.data_type===2&&(R.strm.data_type=function(ie){var A,Y=4093624447;for(A=0;A<=31;A++,Y>>>=1)if(1&Y&&ie.dyn_ltree[2*A]!==0)return o;if(ie.dyn_ltree[18]!==0||ie.dyn_ltree[20]!==0||ie.dyn_ltree[26]!==0)return l;for(A=32;A<f;A++)if(ie.dyn_ltree[2*A]!==0)return l;return o}(R)),ue(R,R.l_desc),ue(R,R.d_desc),de=function(ie){var A;for(j(ie,ie.dyn_ltree,ie.l_desc.max_code),j(ie,ie.dyn_dtree,ie.d_desc.max_code),ue(ie,ie.bl_desc),A=g-1;3<=A&&ie.bl_tree[2*O[A]+1]===0;A--);return ie.opt_len+=3*(A+1)+5+5+4,A}(R),M=R.opt_len+3+7>>>3,(J=R.static_len+3+7>>>3)<=M&&(M=J)):M=J=ae+5,ae+4<=M&&U!==-1?z(R,U,ae,q):R.strategy===4||J===M?(oe(R,2+(q?1:0),3),He(R,X,E)):(oe(R,4+(q?1:0),3),function(ie,A,Y,se){var we;for(oe(ie,A-257,5),oe(ie,Y-1,5),oe(ie,se-4,4),we=0;we<se;we++)oe(ie,ie.bl_tree[2*O[we]+1],3);ce(ie,ie.dyn_ltree,A-1),ce(ie,ie.dyn_dtree,Y-1)}(R,R.l_desc.max_code+1,R.d_desc.max_code+1,de+1),He(R,R.dyn_ltree,R.dyn_dtree)),Ie(R),q&&Ee(R)},i._tr_tally=function(R,U,ae){return R.pending_buf[R.d_buf+2*R.last_lit]=U>>>8&255,R.pending_buf[R.d_buf+2*R.last_lit+1]=255&U,R.pending_buf[R.l_buf+R.last_lit]=255&ae,R.last_lit++,U===0?R.dyn_ltree[2*ae]++:(R.matches++,U--,R.dyn_ltree[2*(S[ae]+f+1)]++,R.dyn_dtree[2*G(U)]++),R.last_lit===R.lit_bufsize-1},i._tr_align=function(R){oe(R,2,3),fe(R,b,X),function(U){U.bi_valid===16?(ee(U,U.bi_buf),U.bi_buf=0,U.bi_valid=0):8<=U.bi_valid&&(U.pending_buf[U.pending++]=255&U.bi_buf,U.bi_buf>>=8,U.bi_valid-=8)}(R)}},{"../utils/common":41}],53:[function(r,n,i){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(r,n,i){(function(s){(function(o,l){if(!o.setImmediate){var c,d,u,f,h=1,p={},g=!1,m=o.document,x=Object.getPrototypeOf&&Object.getPrototypeOf(o);x=x&&x.setTimeout?x:o,c={}.toString.call(o.process)==="[object process]"?function(w){process.nextTick(function(){y(w)})}:function(){if(o.postMessage&&!o.importScripts){var w=!0,k=o.onmessage;return o.onmessage=function(){w=!1},o.postMessage("","*"),o.onmessage=k,w}}()?(f="setImmediate$"+Math.random()+"$",o.addEventListener?o.addEventListener("message",b,!1):o.attachEvent("onmessage",b),function(w){o.postMessage(f+w,"*")}):o.MessageChannel?((u=new MessageChannel).port1.onmessage=function(w){y(w.data)},function(w){u.port2.postMessage(w)}):m&&"onreadystatechange"in m.createElement("script")?(d=m.documentElement,function(w){var k=m.createElement("script");k.onreadystatechange=function(){y(w),k.onreadystatechange=null,d.removeChild(k),k=null},d.appendChild(k)}):function(w){setTimeout(y,0,w)},x.setImmediate=function(w){typeof w!="function"&&(w=new Function(""+w));for(var k=new Array(arguments.length-1),_=0;_<k.length;_++)k[_]=arguments[_+1];var C={callback:w,args:k};return p[h]=C,c(h),h++},x.clearImmediate=v}function v(w){delete p[w]}function y(w){if(g)setTimeout(y,0,w);else{var k=p[w];if(k){g=!0;try{(function(_){var C=_.callback,N=_.args;switch(N.length){case 0:C();break;case 1:C(N[0]);break;case 2:C(N[0],N[1]);break;case 3:C(N[0],N[1],N[2]);break;default:C.apply(l,N)}})(k)}finally{v(w),g=!1}}}}function b(w){w.source===o&&typeof w.data=="string"&&w.data.indexOf(f)===0&&y(+w.data.slice(f.length))}})(typeof self>"u"?s===void 0?this:s:self)}).call(this,typeof Si<"u"?Si:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(Ww);var Q5=Ww.exports;const eE=id(Q5);function tE(t){let e="",r=t;for(;r>=0;)e=String.fromCharCode(r%26+65)+e,r=Math.floor(r/26)-1;return e}function rE(t,e){return`${tE(t)}${e+1}`}async function Gw(t,e,r="design"){const i=Math.ceil(e.width/1e3),s=Math.ceil(e.length/1e3);console.log(`[SLICER] Creating ${i}${s} grid (${i*s} tiles) for ${e.width}mm  ${e.length}mm design`);const c=new DOMParser().parseFromString(t,"image/svg+xml").querySelector("svg");if(!c)throw new Error("Invalid SVG content");const d=c.getAttribute("viewBox");let u,f;if(d){const C=d.split(/\s+/).map(Number);u=C[2],f=C[3]}else u=parseFloat(c.getAttribute("width"))||1024,f=parseFloat(c.getAttribute("height"))||1024;console.log(`[SLICER] SVG internal dimensions: ${u}  ${f}`);const h=u/e.width,p=f/e.length,g=1e3*h,m=1e3*p;console.log(`[SLICER] Tile size in SVG units: ${g}  ${m}`);const x=c.innerHTML,v=c.getAttribute("xmlns")||"http://www.w3.org/2000/svg",y=new eE,b=y.folder("tiles"),w=[];for(let C=0;C<s;C++){const N=[];for(let T=0;T<i;T++){const O=rE(T,C);N.push(O);const X=T*g,E=C*m,F=`${X} ${E} ${g} ${m}`,S=`<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="${v}" viewBox="${F}" width="1000mm" height="1000mm">
  <defs>
    <clipPath id="tile-clip">
      <rect x="${X}" y="${E}" width="${g}" height="${m}"/>
    </clipPath>
  </defs>
  <g clip-path="url(#tile-clip)">
${x}
  </g>
</svg>`,K=`${Vw(r)}_${O}.svg`;b.file(K,S)}w.push(N)}const k=nE(w,e,r);y.file("layout-guide.txt",k);const _=await y.generateAsync({type:"blob"});return console.log(`[SLICER] Created ZIP with ${i*s} tiles`),_}function nE(t,e,r){const n=t.length,i=t[0].length;let s=`TPV Studio - Tile Layout Guide
================================

Design: ${r}
Total Size: ${e.width}mm  ${e.length}mm (${e.width/1e3}m  ${e.length/1e3}m)
Tile Size: 1000mm  1000mm (1m  1m)
Grid: ${i} columns  ${n} rows (${i*n} tiles)

Layout (view from above):
-------------------------

`;const o=6;s+=""+("".repeat(o)+"").repeat(i-1)+"".repeat(o)+`
`;for(let l=0;l<n;l++){s+="";for(let c=0;c<i;c++){const d=t[l][c],u=o-d.length,f=Math.floor(u/2),h=u-f;s+=" ".repeat(f)+d+" ".repeat(h)+""}s+=`
`,l<n-1?s+=""+("".repeat(o)+"").repeat(i-1)+"".repeat(o)+`
`:s+=""+("".repeat(o)+"").repeat(i-1)+"".repeat(o)+`
`}return s+=`
Installation Notes:
-------------------
- Each tile is exactly 1m  1m
- Tiles are named by column (A-Z) and row (1-${n})
- Start from top-left corner (A1) when laying out
- Tiles align perfectly when placed edge-to-edge
- Edge tiles may contain partial content if design isn't exactly divisible by 1m

Generated by TPV Studio
`,s}function Vw(t){return t.replace(/[<>:"/\\|?*]/g,"_").replace(/\s+/g,"-").substring(0,50)}function qw(t,e){const r=URL.createObjectURL(t),n=document.createElement("a");n.href=r,n.download=e,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(r)}async function iE(t,e,r="design"){try{const n=await fetch(t);if(!n.ok)throw new Error(`Failed to fetch SVG: ${n.statusText}`);const i=await n.text(),s=await Gw(i,e,r),o=`${Vw(r)}-tiles-1mx1m.zip`;return qw(s,o),console.log(`[SLICER] Downloaded ${o}`),!0}catch(n){throw console.error("[SLICER] Failed to download tiles:",n),n}}async function sE(t){const e=Object.values(t||{});return e.length===0?[]:(await Promise.all(e.map(async n=>{try{const i=await cl(n.sourceDesignId),s=(i==null?void 0:i.design)||i;if(!s)return console.warn(`[EXPORT] Could not fetch design for motif ${n.id}`),null;console.log("[EXPORT] Loaded design for motif:",s.name),console.log("[EXPORT] Design has solid_recipes:",!!s.solid_recipes),console.log("[EXPORT] Design has blend_recipes:",!!s.blend_recipes);const o=n.scale||1,l=n.originalWidth_mm*o/1e3,c=n.originalHeight_mm*o/1e3,d=l*c,u=n.viewMode||"solid",f=u==="blend"?s.blend_recipes:s.solid_recipes;return console.log(`[EXPORT] Using ${u} recipes:`,(f==null?void 0:f.length)||0,"recipes"),{id:n.id,name:n.customName||n.sourceDesignName||s.name||"Motif",areaM2:d,viewMode:u,widthM:l,heightM:c,recipes:f||[]}}catch(i){return console.error(`[EXPORT] Error processing motif ${n.id}:`,i),null}}))).filter(Boolean)}function k0({svgRef:t}){const[e,r]=P.useState(!1),[n,i]=P.useState(null),s=P.useRef(null),o=st(m=>m.exportDesignData),l=st(m=>m.surface),c=st(m=>m.designName),d=st(m=>m.motifs);P.useEffect(()=>{const m=x=>{s.current&&!s.current.contains(x.target)&&r(!1)};return e&&document.addEventListener("mousedown",m),()=>{document.removeEventListener("mousedown",m)}},[e]);const u=()=>t!=null&&t.current?t.current:document.querySelector(".court-canvas__svg"),f=async()=>{i("svg");try{const m=u();if(!m)throw new Error("Canvas not found");const x=o(),v=wp(m,x),y=Nu(x.name,"svg");Z5(v,y)}catch(m){console.error("SVG export failed:",m),alert("Failed to export SVG: "+m.message)}finally{i(null),r(!1)}},h=async()=>{i("png");try{const m=u();if(!m)throw new Error("Canvas not found");const x=o(),v=Nu(x.name,"png");await J5(m,x,v,2)}catch(m){console.error("PNG export failed:",m),alert("Failed to export PNG: "+m.message)}finally{i(null),r(!1)}},p=async()=>{i("pdf"),r(!1);try{const m=u();if(!m)throw new Error("Canvas not found");const x=await Pn.getSession();if(!(x!=null&&x.access_token))throw new Error("Authentication required for PDF export");const v=o(),y=v.name||"TPV Design",b=m.cloneNode(!0);b.querySelectorAll('[class*="selected"], .transform-handles, .track-resize-handles, .court-canvas__selection-outline, [class*="selection"], [class*="handle"], [stroke-dasharray]').forEach(O=>O.remove()),b.setAttribute("xmlns","http://www.w3.org/2000/svg"),b.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");const w=new XMLSerializer().serializeToString(b);console.log("[EXPORT] Generating PDF report via API...");const k=await sE(d);console.log("[EXPORT] Motifs for PDF:",k.length);const _=await fetch("/api/export-sports-pdf",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${x.access_token}`},body:JSON.stringify({svgString:w,designName:y,surface:v.surface,courts:v.courts,tracks:v.tracks,motifs:k,dimensions:{widthMM:v.surface.width_mm,lengthMM:v.surface.length_mm}})});if(!_.ok){const O=await _.json().catch(()=>({error:"Unknown error"}));throw new Error(O.error||`Server error: ${_.status}`)}const C=await _.blob(),N=Nu(y,"pdf"),T=document.createElement("a");T.href=URL.createObjectURL(C),T.download=N,document.body.appendChild(T),T.click(),document.body.removeChild(T),URL.revokeObjectURL(T.href),console.log("[EXPORT] PDF downloaded:",N)}catch(m){console.error("PDF export failed:",m),alert("Failed to export PDF: "+m.message)}finally{i(null)}},g=async()=>{i("tiles"),r(!1);try{const m=u();if(!m)throw new Error("Canvas not found");const v=new XMLSerializer().serializeToString(m),y={width:l.width_mm,length:l.length_mm},b=c||"sports-surface",w=await Gw(v,y,b),k=`${b.replace(/[^a-zA-Z0-9-_]/g,"-")}-tiles-1mx1m.zip`;qw(w,k),console.log("[EXPORT] Tiles ZIP downloaded:",k)}catch(m){console.error("Tiles export failed:",m),alert("Failed to export tiles: "+m.message)}finally{i(null)}};return a.jsxs("div",{className:"export-menu",ref:s,children:[a.jsxs("button",{className:"sports-toolbar__btn-export",onClick:()=>r(!e),title:"Export Design",children:["Export",a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:e?"M18 15l-6-6-6 6":"M6 9l6 6 6-6"})})]}),e&&a.jsxs("div",{className:"export-menu__dropdown",children:[a.jsxs("button",{className:"export-menu__item",onClick:f,disabled:n!==null,children:[a.jsx("span",{className:"export-menu__icon",children:""}),a.jsxs("div",{className:"export-menu__item-content",children:[a.jsx("span",{className:"export-menu__item-title",children:n==="svg"?"Exporting...":"Download SVG"}),a.jsx("span",{className:"export-menu__item-desc",children:"Vector format for CAD/printing"})]})]}),a.jsxs("button",{className:"export-menu__item",onClick:h,disabled:n!==null,children:[a.jsx("span",{className:"export-menu__icon",children:""}),a.jsxs("div",{className:"export-menu__item-content",children:[a.jsx("span",{className:"export-menu__item-title",children:n==="png"?"Exporting...":"Download PNG"}),a.jsx("span",{className:"export-menu__item-desc",children:"High-res image for presentations"})]})]}),a.jsxs("button",{className:"export-menu__item",onClick:g,disabled:n!==null,children:[a.jsx("span",{className:"export-menu__icon",children:""}),a.jsxs("div",{className:"export-menu__item-content",children:[a.jsx("span",{className:"export-menu__item-title",children:n==="tiles"?"Generating...":"Download Tiles ZIP"}),a.jsx("span",{className:"export-menu__item-desc",children:"1m1m SVG tiles for large-format printing"})]})]}),a.jsx("div",{className:"export-menu__divider"}),a.jsxs("button",{className:"export-menu__item",onClick:p,disabled:n!==null,children:[a.jsx("span",{className:"export-menu__icon",children:""}),a.jsxs("div",{className:"export-menu__item-content",children:[a.jsx("span",{className:"export-menu__item-title",children:n==="pdf"?"Generating...":"Materials Report (PDF)"}),a.jsx("span",{className:"export-menu__item-desc",children:"TPV quantities & specifications"})]})]})]})]})}function oE({isOpen:t,onClose:e}){if(!t)return null;const r=[{category:"Selection",items:[{keys:["Delete"],description:"Remove selected element"},{keys:["Escape"],description:"Deselect element"}]},{category:"Edit",items:[{keys:["Ctrl","Z"],description:"Undo"},{keys:["Ctrl","Shift","Z"],description:"Redo"},{keys:["Ctrl","D"],description:"Duplicate selected"}]},{category:"Move",items:[{keys:["Arrow Keys"],description:"Nudge element (10mm)"},{keys:["Shift","Arrow Keys"],description:"Large nudge (100mm)"}]},{category:"Layers",items:[{keys:["["],description:"Send backward"},{keys:["]"],description:"Bring forward"}]},{category:"View",items:[{keys:["G"],description:"Toggle snap to grid"},{keys:["?"],description:"Show this help"}]}],i=navigator.platform.toUpperCase().indexOf("MAC")>=0?"":"Ctrl";return a.jsx("div",{className:"keyboard-shortcuts-overlay",onClick:e,style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},children:a.jsxs("div",{className:"keyboard-shortcuts-modal",onClick:s=>s.stopPropagation(),style:{background:"#fff",borderRadius:"8px",padding:"24px",maxWidth:"480px",width:"90%",maxHeight:"80vh",overflow:"auto",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.2)"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[a.jsx("h2",{style:{margin:0,fontSize:"1.25rem",fontWeight:600},children:"Keyboard Shortcuts"}),a.jsx("button",{onClick:e,style:{background:"none",border:"none",fontSize:"1.5rem",cursor:"pointer",padding:"4px 8px",color:"#666"},"aria-label":"Close",children:""})]}),r.map(s=>a.jsxs("div",{style:{marginBottom:"20px"},children:[a.jsx("h3",{style:{fontSize:"0.75rem",fontWeight:600,textTransform:"uppercase",color:"#666",marginBottom:"8px",letterSpacing:"0.5px"},children:s.category}),a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:s.items.map((o,l)=>a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 0"},children:[a.jsx("span",{style:{color:"#333",fontSize:"0.9rem"},children:o.description}),a.jsx("div",{style:{display:"flex",gap:"4px"},children:o.keys.map((c,d)=>a.jsx("kbd",{style:{display:"inline-block",padding:"4px 8px",fontSize:"0.75rem",fontFamily:"system-ui, -apple-system, sans-serif",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:"4px",boxShadow:"0 1px 2px rgba(0,0,0,0.1)",minWidth:"24px",textAlign:"center"},children:c==="Ctrl"?i:c},d))})]},l))})]},s.category)),a.jsxs("p",{style:{fontSize:"0.8rem",color:"#888",marginTop:"16px",paddingTop:"16px",borderTop:"1px solid #eee",marginBottom:0},children:["Press ",a.jsx("kbd",{style:{padding:"2px 6px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:"3px",fontSize:"0.75rem"},children:"?"})," at any time to show this help"]})]})})}class aE{async _getAuthHeaders(){const e=await Pn.getSession(),r={"Content-Type":"application/json"};return e!=null&&e.access_token&&(r.Authorization=`Bearer ${e.access_token}`),r}async generateRecraft(e){const r={prompt:e.prompt,width_mm:e.widthMM||5e3,length_mm:e.lengthMM||5e3,max_colours:e.maxColours||6,seed:e.seed||null},n=await this._getAuthHeaders(),i=await fetch("/api/recraft-generate",{method:"POST",headers:n,body:JSON.stringify(r)});if(!i.ok){const s=await i.json();throw new Error(s.error||"Recraft generation failed")}return i.json()}async vectorizeImage(e){const r={image_url:e.image_url,width_mm:e.width_mm||5e3,length_mm:e.length_mm||5e3,seed:e.seed||null},n=await this._getAuthHeaders(),i=await fetch("/api/recraft-vectorize",{method:"POST",headers:n,body:JSON.stringify(r)});if(!i.ok){const s=await i.json();throw new Error(s.error||"Vectorization failed")}return i.json()}async processUploadedSVG(e){const r={svg_url:e.svg_url,width_mm:e.width_mm||5e3,length_mm:e.length_mm||5e3},n=await this._getAuthHeaders(),i=await fetch("/api/process-uploaded-svg",{method:"POST",headers:n,body:JSON.stringify(r)});if(!i.ok){const s=await i.json();throw new Error(s.error||"SVG processing failed")}return i.json()}async getRecraftStatus(e){const r=await this._getAuthHeaders(),n=await fetch(`/api/studio-job-status?jobId=${e}`,{headers:r});if(!n.ok){const i=await n.json();throw new Error(i.error||"Status fetch failed")}return n.json()}async waitForRecraftCompletion(e,r=null,n=2e3){return new Promise((i,s)=>{const o=async()=>{var l,c,d,u;try{const f=await this.getRecraftStatus(e);r&&r(f),f.status==="completed"?((l=f.result)==null?void 0:l.svg_url)?(console.log("[API] Recraft job complete with SVG output"),i(f)):(console.error("[API] Recraft job completed but no SVG output"),s(new Error("Job completed but no output received"))):f.status==="failed"?(c=f.result)!=null&&c.svg_url?(console.warn("[API] Job failed compliance but has output (non-compliant)"),i(f)):s(new Error(f.error||"Job failed")):(f.status==="retrying"&&console.log(`[API] Retrying: ${(d=f.recraft)==null?void 0:d.attempt_current}/${(u=f.recraft)==null?void 0:u.attempt_max}`),setTimeout(o,n))}catch(f){s(f)}};o()})}async matchColor(e,r=2){const n=await fetch("/api/match-color",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({hex:e,max_components:r})});if(!n.ok){const i=await n.json();throw new Error(i.error||"Color matching failed")}return n.json()}async generateDesignName(e){const r={prompt:e.prompt,colors:e.colors||[],dimensions:e.dimensions||{}},n=await this._getAuthHeaders(),i=await fetch("/api/generate-design-name",{method:"POST",headers:n,body:JSON.stringify(r)});if(!i.ok){const s=await i.json();throw new Error(s.error||"Name generation failed")}return i.json()}async inspireSimpleCreateJob(e){const r={prompt:e.prompt,surface:{width_mm:e.lengthMM||5e3,height_mm:e.widthMM||5e3},max_colours:e.maxColours||6,try_simpler:e.trySimpler||!1};e.seed&&(r.seed=e.seed);const n=await fetch("/api/studio-inspire-simple",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!n.ok){const i=await n.json();throw new Error(i.message||"Unable to start design generation. Please check your connection and try again.")}return n.json()}async inspireSimpleGetStatus(e){const r=await this._getAuthHeaders(),n=await fetch(`/api/studio-job-status?jobId=${e}`,{headers:r});if(!n.ok){const i=await n.json();throw new Error(i.message||"Unable to check generation status. Please try again.")}return n.json()}async inspireSimpleWaitForCompletion(e,r=null,n=2e3){return new Promise((i,s)=>{const o=async()=>{var l;try{const c=await this.inspireSimpleGetStatus(e);r&&r(c),c.status==="completed"?((l=c.result)==null?void 0:l.final_url)?(console.log("[API] Job complete with JPG output, resolving"),i(c)):(console.log("[API] Job completed but no output received"),s(new Error("Job completed but no output received"))):c.status==="failed"?s(new Error(c.error||"Job failed")):setTimeout(o,n)}catch(c){s(c)}};o()})}async draftify(e){const r=await fetch(t0.DRAFTIFY,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!r.ok){const n=await r.json();throw new Error(n.message||"Unable to convert image to vector format. Please try a different image.")}return r.json()}async generateGeometric(e){const r={brief:e.prompt||e.brief,canvas:{width_mm:e.lengthMM||5e3,height_mm:e.widthMM||5e3},options:{mood:e.mood||"playful",composition:e.composition||"mixed",colorCount:e.maxColours||e.colorCount||5,seed:e.seed},validate:!0},n=await fetch(t0.GEOMETRIC_GENERATE,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!n.ok){const i=await n.json();throw new Error(i.message||"Unable to generate design. Please try a different prompt or settings.")}return n.json()}}const Yi=new aE;function lE({recipes:t,onClose:e}){return!t||t.length===0?a.jsxs("div",{className:"blend-recipes-empty",children:[a.jsx("p",{children:"No colours extracted from design."}),a.jsx("button",{onClick:e,className:"close-button",children:"Close"})]}):a.jsxs("div",{className:"blend-recipes-display",children:[a.jsxs("div",{className:"recipes-header",children:[a.jsx("h3",{children:"TPV Blend Recipes"}),a.jsx("button",{onClick:e,className:"close-button-icon",children:""})]}),a.jsx("div",{className:"recipes-grid",children:t.map((r,n)=>{const i=r.chosenRecipe;return a.jsxs("div",{className:"recipe-card",children:[a.jsxs("div",{className:"card-top",children:[a.jsx("div",{className:"swatch-section",children:a.jsx("div",{className:"color-swatch",style:{backgroundColor:r.blendColor.hex},title:`TPV blend: ${r.blendColor.hex}`})}),a.jsxs("div",{className:"card-meta",children:[a.jsxs("div",{className:"meta-row",children:[a.jsx("span",{className:"meta-label",children:"Hex:"}),a.jsx("span",{className:"hex-value",children:r.blendColor.hex})]}),a.jsxs("div",{className:"meta-row",children:[a.jsx("span",{className:"meta-label",children:"Coverage:"}),a.jsxs("span",{className:"coverage-value",children:[r.targetColor.areaPct.toFixed(1),"%"]})]})]})]}),a.jsxs("div",{className:"card-formula",children:[a.jsx("div",{className:"formula-label",children:i.components.length===1?"Pure TPV Colour":"TPV Blend Formula"}),a.jsx("div",{className:"formula-content",children:i.components.length===1?a.jsxs("span",{className:"formula-component solid",children:[a.jsx("strong",{className:"parts",children:"100%"}),a.jsx("span",{className:"comp-code",children:i.components[0].code}),a.jsxs("span",{className:"comp-name",children:["(",i.components[0].name,")"]})]}):i.components.map((s,o)=>a.jsxs("span",{className:"formula-component",children:[a.jsx("strong",{className:"parts",children:s.parts||(s.weight*100).toFixed(0)+"%"}),a.jsx("span",{className:"comp-code",children:s.code}),a.jsxs("span",{className:"comp-name",children:["(",s.name,")"]}),o<i.components.length-1&&a.jsx("span",{className:"separator",children:"+"})]},o))})]})]},n)})}),a.jsx("style",{jsx:!0,children:`
        .blend-recipes-display {
          background: #fff;
          border-radius: 8px;
          border: 1px solid #ddd;
          padding: 2rem;
          margin-top: 1.5rem;
        }

        .blend-recipes-empty {
          text-align: center;
          padding: 2rem;
          background: #f9f9f9;
          border-radius: 8px;
        }

        .recipes-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 1.5rem;
          padding-bottom: 1rem;
          border-bottom: 2px solid #1a365d;
        }

        .recipes-header h3 {
          font-family: 'Space Grotesk', sans-serif;
          margin: 0;
          color: #1e4a7a;
          font-size: 1.5rem;
          font-weight: 600;
        }

        .close-button-icon {
          background: none;
          border: none;
          font-size: 2rem;
          color: #666;
          cursor: pointer;
          padding: 0;
          width: 32px;
          height: 32px;
          line-height: 1;
        }

        .close-button-icon:hover {
          color: #333;
        }

        /* Card Grid Layout */
        .recipes-grid {
          display: grid;
          grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
          gap: 1.5rem;
        }

        .recipe-card {
          background: white;
          border: 2px solid #e0e0e0;
          border-radius: 12px;
          overflow: hidden;
          transition: all 0.3s;
        }

        .recipe-card:hover {
          border-color: #ff6b35;
          transform: translateY(-2px);
          box-shadow: 0 8px 24px rgba(255, 107, 53, 0.15);
        }

        /* Card Top Section */
        .card-top {
          display: flex;
          gap: 1.5rem;
          padding: 1.5rem;
          background: #f9f9f9;
          border-bottom: 2px solid #e8e8e8;
          align-items: center;
        }

        .swatch-section {
          display: flex;
          align-items: center;
          justify-content: center;
        }

        .color-swatch {
          width: 80px;
          height: 80px;
          border-radius: 12px;
          border: 3px solid #ff6b35;
          flex-shrink: 0;
          box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }

        .card-meta {
          flex: 1;
          display: flex;
          flex-direction: column;
          gap: 0.75rem;
          justify-content: center;
        }

        .meta-row {
          display: flex;
          align-items: center;
          gap: 0.75rem;
        }

        .meta-label {
          font-size: 0.85rem;
          font-weight: 600;
          color: #666;
          min-width: 80px;
        }

        .hex-value {
          font-family: 'Courier New', monospace;
          font-size: 1.1rem;
          color: #333;
          font-weight: 700;
          letter-spacing: 0.5px;
        }

        .coverage-value {
          font-size: 1.1rem;
          color: #1a365d;
          font-weight: 700;
        }

        /* Card Formula Section */
        .card-formula {
          padding: 1.5rem;
          background: white;
        }

        .formula-label {
          font-size: 0.85rem;
          font-weight: 700;
          color: #1a365d;
          text-transform: uppercase;
          letter-spacing: 1px;
          margin-bottom: 1rem;
        }

        .formula-content {
          display: flex;
          flex-wrap: wrap;
          gap: 0.75rem;
          align-items: center;
          line-height: 1.8;
        }

        .formula-component {
          display: inline-flex;
          align-items: center;
          gap: 0.4rem;
        }

        .parts {
          color: #333;
          font-size: 1rem;
        }

        .comp-code {
          color: #1a365d;
          font-weight: 700;
          font-size: 1.05rem;
        }

        .comp-name {
          color: #666;
          font-size: 0.9rem;
        }

        .separator {
          color: #ff6b35;
          font-weight: bold;
          font-size: 1rem;
          margin: 0 0.35rem;
        }

        .formula-component.solid {
          background: #fff5f0;
          padding: 0.5rem 0.75rem;
          border-radius: 4px;
          border: 1px solid #ff6b35;
        }

        .close-button {
          padding: 0.75rem 1.5rem;
          background: #e0e0e0;
          color: #333;
          border: none;
          border-radius: 4px;
          font-weight: 600;
          cursor: pointer;
          margin-top: 1rem;
        }

        .close-button:hover {
          background: #d0d0d0;
        }

        @media (max-width: 768px) {
          .blend-recipes-display {
            padding: 1rem;
          }

          .recipes-grid {
            grid-template-columns: 1fr;
          }

          .card-top {
            flex-direction: column;
            gap: 1rem;
            padding: 1rem;
          }

          .color-swatch {
            width: 60px;
            height: 60px;
          }

          .card-meta {
            width: 100%;
          }

          .meta-label {
            min-width: 70px;
          }

          .card-formula {
            padding: 1rem;
          }

          .formula-label {
            font-size: 0.75rem;
          }
        }
      `})]})}function cE({recipes:t,onClose:e}){if(!t||t.length===0)return a.jsxs("div",{className:"solid-summary-empty",children:[a.jsx("p",{children:"No colours in design."}),a.jsx("button",{onClick:e,className:"close-button",children:"Close"})]});const r=t.reduce((n,i)=>n+i.targetColor.areaPct,0);return a.jsxs("div",{className:"solid-color-summary",children:[a.jsxs("div",{className:"summary-header",children:[a.jsx("h3",{children:"TPV Colours Used"}),a.jsx("button",{onClick:e,className:"close-button-icon",children:""})]}),a.jsx("div",{className:"summary-info",children:a.jsxs("p",{className:"summary-description",children:["This design uses ",a.jsx("strong",{children:t.length})," pure TPV colour",t.length!==1?"s":""," (no blending required)"]})}),a.jsx("div",{className:"colors-list",children:t.map((n,i)=>{const s=n.chosenRecipe.components[0],o=n.targetColor.areaPct;return a.jsxs("div",{className:"color-item",children:[a.jsx("div",{className:"color-swatch",style:{backgroundColor:n.blendColor.hex},title:`${s.code} - ${s.name}`}),a.jsxs("div",{className:"color-details",children:[a.jsxs("div",{className:"color-primary",children:[a.jsx("span",{className:"color-code",children:s.code}),a.jsx("span",{className:"color-name",children:s.name})]}),a.jsxs("div",{className:"color-secondary",children:[a.jsx("span",{className:"hex-value",children:n.blendColor.hex}),a.jsxs("span",{className:"coverage-badge",children:[o.toFixed(1),"%"]})]})]})]},i)})}),a.jsxs("div",{className:"summary-footer",children:[a.jsxs("div",{className:"footer-stat",children:[a.jsx("span",{className:"stat-label",children:"Total Coverage:"}),a.jsxs("span",{className:"stat-value",children:[r.toFixed(1),"%"]})]}),a.jsxs("div",{className:"footer-stat",children:[a.jsx("span",{className:"stat-label",children:"TPV Colours:"}),a.jsx("span",{className:"stat-value",children:t.length})]})]}),a.jsx("style",{jsx:!0,children:`
        .solid-color-summary {
          background: #fff;
          border-radius: 8px;
          border: 1px solid #ddd;
          padding: 2rem;
          max-width: 800px;
          margin: 2rem auto;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .solid-summary-empty {
          background: #fff;
          border-radius: 8px;
          padding: 2rem;
          text-align: center;
        }

        .summary-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 1.5rem;
          padding-bottom: 1rem;
          border-bottom: 2px solid #1a365d;
        }

        .summary-header h3 {
          margin: 0;
          color: #1a365d;
          font-size: 1.8rem;
        }

        .close-button-icon {
          background: none;
          border: none;
          font-size: 2rem;
          color: #666;
          cursor: pointer;
          padding: 0;
          width: 32px;
          height: 32px;
          line-height: 1;
          transition: color 0.2s;
        }

        .close-button-icon:hover {
          color: #333;
        }

        .summary-info {
          background: #f9f9f9;
          padding: 1rem;
          border-radius: 6px;
          margin-bottom: 1.5rem;
        }

        .summary-description {
          margin: 0;
          color: #333;
          font-size: 1rem;
          line-height: 1.5;
        }

        /* Colors List */
        .colors-list {
          display: flex;
          flex-direction: column;
          gap: 1rem;
          margin-bottom: 1.5rem;
        }

        .color-item {
          display: flex;
          align-items: center;
          gap: 1rem;
          padding: 1rem;
          background: #f9f9f9;
          border-radius: 6px;
          border: 1px solid #e0e0e0;
          transition: all 0.2s;
        }

        .color-item:hover {
          border-color: #ff6b35;
          box-shadow: 0 2px 8px rgba(255, 107, 53, 0.15);
        }

        .color-swatch {
          width: 60px;
          height: 60px;
          border-radius: 8px;
          border: 2px solid #ddd;
          flex-shrink: 0;
          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .color-details {
          flex: 1;
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .color-primary {
          display: flex;
          align-items: baseline;
          gap: 0.5rem;
        }

        .color-code {
          font-family: 'Courier New', monospace;
          font-weight: 700;
          font-size: 1.2rem;
          color: #1a365d;
        }

        .color-name {
          font-size: 1.1rem;
          color: #333;
          font-weight: 500;
        }

        .color-secondary {
          display: flex;
          align-items: center;
          gap: 1rem;
        }

        .hex-value {
          font-family: 'Courier New', monospace;
          font-size: 0.9rem;
          color: #666;
        }

        .coverage-badge {
          background: #ff6b35;
          color: white;
          padding: 0.25rem 0.75rem;
          border-radius: 12px;
          font-weight: 600;
          font-size: 0.9rem;
        }

        /* Summary Footer */
        .summary-footer {
          display: flex;
          justify-content: space-around;
          padding: 1.5rem;
          background: #f9f9f9;
          border-radius: 6px;
          border: 2px solid #ff6b35;
        }

        .footer-stat {
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 0.5rem;
        }

        .stat-label {
          font-size: 0.9rem;
          color: #666;
          font-weight: 500;
        }

        .stat-value {
          font-size: 1.5rem;
          font-weight: 700;
          color: #1a365d;
        }

        .close-button {
          padding: 0.75rem 1.5rem;
          background: #ff6b35;
          color: white;
          border: none;
          border-radius: 4px;
          font-weight: 600;
          cursor: pointer;
          transition: background 0.2s;
        }

        .close-button:hover {
          background: #e55a25;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
          .solid-color-summary {
            padding: 1rem;
          }

          .summary-header h3 {
            font-size: 1.4rem;
          }

          .color-item {
            flex-direction: column;
            align-items: flex-start;
          }

          .color-swatch {
            width: 100%;
            height: 50px;
          }

          .summary-footer {
            flex-direction: column;
            gap: 1rem;
          }
        }
      `})]})}function _p({content:t,position:e="top"}){const[r,n]=P.useState(!1);return a.jsxs("div",{className:"help-icon-container",children:[a.jsx("button",{className:"help-icon",onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1),onClick:i=>{i.preventDefault(),i.stopPropagation(),n(!r)},type:"button","aria-label":"Help",children:"?"}),r&&a.jsx("div",{className:`help-tooltip help-tooltip-${e}`,children:t}),a.jsx("style",{children:`
        .help-icon-container {
          position: relative;
          display: inline-block;
        }

        .help-icon {
          display: inline-flex;
          align-items: center;
          justify-content: center;
          width: 18px;
          height: 18px;
          border-radius: 50%;
          background: #6b7280;
          color: white;
          border: none;
          font-size: 12px;
          font-weight: 600;
          cursor: help;
          transition: all 0.2s;
          padding: 0;
          line-height: 1;
        }

        .help-icon:hover {
          background: #374151;
          transform: scale(1.1);
        }

        .help-tooltip {
          position: absolute;
          z-index: 1000;
          background: #1f2937;
          color: white;
          padding: 0.75rem 1rem;
          border-radius: 6px;
          font-size: 0.875rem;
          line-height: 1.5;
          max-width: 300px;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
          pointer-events: none;
          white-space: normal;
        }

        .help-tooltip-top {
          bottom: calc(100% + 8px);
          left: 50%;
          transform: translateX(-50%);
        }

        .help-tooltip-top::after {
          content: '';
          position: absolute;
          top: 100%;
          left: 50%;
          transform: translateX(-50%);
          border: 6px solid transparent;
          border-top-color: #1f2937;
        }

        .help-tooltip-bottom {
          top: calc(100% + 8px);
          left: 50%;
          transform: translateX(-50%);
        }

        .help-tooltip-bottom::after {
          content: '';
          position: absolute;
          bottom: 100%;
          left: 50%;
          transform: translateX(-50%);
          border: 6px solid transparent;
          border-bottom-color: #1f2937;
        }

        .help-tooltip-right {
          left: calc(100% + 8px);
          top: 50%;
          transform: translateY(-50%);
        }

        .help-tooltip-right::after {
          content: '';
          position: absolute;
          right: 100%;
          top: 50%;
          transform: translateY(-50%);
          border: 6px solid transparent;
          border-right-color: #1f2937;
        }

        .help-tooltip-left {
          right: calc(100% + 8px);
          top: 50%;
          transform: translateY(-50%);
        }

        .help-tooltip-left::after {
          content: '';
          position: absolute;
          left: 100%;
          top: 50%;
          transform: translateY(-50%);
          border: 6px solid transparent;
          border-left-color: #1f2937;
        }

        @media (max-width: 768px) {
          .help-tooltip {
            max-width: 250px;
            font-size: 0.8125rem;
            padding: 0.625rem 0.875rem;
          }
        }
      `})]})}function dE({recipes:t,mode:e="blend",onColorClick:r,selectedColor:n,editedColors:i,onResetAll:s}){if(!t||t.length===0)return null;const o=h=>!i||i.size===0?!1:i.has(h.originalColor.hex.toLowerCase()),l=h=>{if(!i||i.size===0)return!1;const p=i.get(h.originalColor.hex.toLowerCase());return(p==null?void 0:p.newHex)==="transparent"||(p==null?void 0:p.newHex)==="none"},c=i&&i.size>0,d=h=>{const p=h.toLowerCase();return Sr.find(g=>g.hex.toLowerCase()===p)},u=h=>{if(l(h))return"Transparent";if(e==="solid"){const p=d(h.blendColor.hex);if(p)return`${p.code} - ${p.name}`}return h.blendColor.hex},f=h=>{if(!n)return!1;const p=n.blendHex||n.hex;return h.blendColor.hex===p||h.targetColor.hex===p};return a.jsxs("div",{className:"color-legend",children:[a.jsxs("div",{className:"legend-header",children:[a.jsxs("div",{className:"legend-header-left",children:[a.jsx("span",{className:"legend-title",children:"Colours"}),a.jsx(_p,{content:"Click any colour to edit all instances of that colour across the design. Changes apply to every region using that colour.",position:"right"}),r&&a.jsx("span",{className:"edit-hint",children:"(click to edit)"})]}),c&&s&&a.jsx("button",{onClick:s,className:"reset-all-btn",title:"Reset all colours to original",children:"Reset All"})]}),a.jsx("div",{className:"legend-colors",children:t.map((h,p)=>a.jsxs("div",{className:`color-item ${r?"clickable":""} ${f(h)?"selected":""}`,onClick:()=>{r&&r({hex:h.targetColor.hex,originalHex:h.originalColor.hex,blendHex:h.blendColor.hex,areaPct:h.targetColor.areaPct,recipe:h.chosenRecipe,targetColor:h.targetColor},"palette")},title:r?"Click to edit this colour":"",children:[a.jsxs("div",{className:"color-swatch-wrapper",children:[a.jsx("div",{className:`color-swatch ${l(h)?"transparent-swatch":""}`,style:l(h)?{}:{backgroundColor:h.blendColor.hex}}),l(h)&&a.jsx("span",{className:"transparent-indicator",title:"Made transparent",children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",width:"14",height:"14",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"4",y1:"4",x2:"20",y2:"20"})]})}),o(h)&&!l(h)&&a.jsx("span",{className:"edit-indicator",title:"Colour has been modified",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"12",height:"12",children:a.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"})})})]}),a.jsxs("div",{className:"color-info",children:[a.jsx("span",{className:e==="solid"?"tpv-label":"hex-value",children:u(h)}),a.jsxs("span",{className:"coverage",children:[h.targetColor.areaPct.toFixed(1),"%"]})]})]},p))}),a.jsx("style",{jsx:!0,children:`
        .color-legend {
          background: rgba(255, 255, 255, 0.95);
          border: 1px solid #ddd;
          border-radius: 8px;
          padding: 1rem;
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
          width: 100%;
        }

        .legend-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          gap: 0.5rem;
          margin-bottom: 0.75rem;
          padding-bottom: 0.5rem;
          border-bottom: 1px solid #e0e0e0;
        }

        .legend-header-left {
          display: flex;
          align-items: center;
          gap: 0.5rem;
        }

        .legend-title {
          font-weight: 600;
          color: #1a365d;
          font-size: 0.95rem;
        }

        .edit-hint {
          font-size: 0.75rem;
          color: #ff6b35;
          font-weight: normal;
        }

        .reset-all-btn {
          padding: 0.25rem 0.5rem;
          font-size: 0.7rem;
          font-weight: 600;
          color: #ff6b35;
          background: #fff5f0;
          border: 1px solid #ff6b35;
          border-radius: 4px;
          cursor: pointer;
          transition: all 0.2s;
        }

        .reset-all-btn:hover {
          background: #ff6b35;
          color: white;
        }

        .legend-colors {
          display: grid;
          grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
          gap: 0.75rem;
        }

        .color-item {
          display: flex;
          align-items: center;
          gap: 0.75rem;
          padding: 0.5rem;
          border-radius: 4px;
          background: white;
          border: 1px solid #e8e8e8;
          transition: all 0.2s;
        }

        .color-item.clickable {
          cursor: pointer;
        }

        .color-item.clickable:hover {
          border-color: #ff6b35;
          background: #fff9f7;
          box-shadow: 0 2px 4px rgba(255, 107, 53, 0.15);
          transform: translateY(-2px);
        }

        .color-item.selected {
          border-color: #ff6b35;
          border-width: 2px;
          background: #fff9f7;
          box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.2);
          transform: translateY(-2px);
        }

        .color-swatch-wrapper {
          position: relative;
          flex-shrink: 0;
        }

        .color-swatch {
          width: 40px;
          height: 40px;
          border-radius: 4px;
          border: 2px solid #ddd;
        }

        .color-swatch.transparent-swatch {
          background:
            linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%),
            linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%);
          background-size: 8px 8px;
          background-position: 0 0, 4px 4px;
          background-color: white;
          border-color: #999;
        }

        .transparent-indicator {
          position: absolute;
          top: -4px;
          right: -4px;
          width: 18px;
          height: 18px;
          background: #6b7280;
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          color: white;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }

        .transparent-indicator svg {
          width: 12px;
          height: 12px;
        }

        .edit-indicator {
          position: absolute;
          top: -4px;
          right: -4px;
          width: 16px;
          height: 16px;
          background: #ff6b35;
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          color: white;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }

        .edit-indicator svg {
          width: 10px;
          height: 10px;
        }

        .color-info {
          display: flex;
          flex-direction: column;
          gap: 0.25rem;
          font-size: 0.85rem;
        }

        .hex-value {
          font-family: 'Courier New', monospace;
          font-weight: 600;
          color: #333;
        }

        .tpv-label {
          font-weight: 600;
          color: #1a365d;
          font-size: 0.9rem;
        }

        .coverage {
          color: #666;
          font-size: 0.8rem;
        }

        /* Mobile - compact horizontal grid of swatches */
        @media (max-width: 768px) {
          .color-legend {
            padding: 0.75rem;
          }

          .legend-header {
            margin-bottom: 0.5rem;
            padding-bottom: 0.5rem;
          }

          .legend-title {
            font-size: 0.85rem;
          }

          .edit-hint {
            font-size: 0.7rem;
          }

          .reset-all-btn {
            font-size: 0.65rem;
            padding: 0.2rem 0.4rem;
            min-height: 28px;
          }

          /* Horizontal scrolling grid of swatches */
          .legend-colors {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            justify-content: flex-start;
          }

          .color-item {
            flex-direction: column;
            padding: 0.25rem;
            border-radius: 6px;
            width: auto;
            min-width: 44px;
          }

          /* Hide text info on mobile - just show swatches */
          .color-info {
            display: none;
          }

          .color-swatch {
            width: 44px;
            height: 44px;
            border-radius: 6px;
          }

          .color-item.selected {
            transform: none;
            box-shadow: 0 0 0 2px rgba(255, 107, 53, 0.4);
          }

          .color-item.clickable:hover {
            transform: none;
          }

          .edit-indicator {
            top: -2px;
            right: -2px;
            width: 14px;
            height: 14px;
          }

          .edit-indicator svg {
            width: 8px;
            height: 8px;
          }
        }

        @media (max-width: 480px) {
          .color-legend {
            padding: 0.5rem;
          }

          .legend-colors {
            gap: 0.35rem;
          }

          .color-swatch {
            width: 40px;
            height: 40px;
          }

          .color-item {
            min-width: 40px;
          }
        }
      `})]})}const uE=[{code:"RH01",name:"Standard Red",hex:"#A5362F"},{code:"RH02",name:"Bright Red",hex:"#E21F2F"},{code:"RH10",name:"Standard Green",hex:"#609B63"},{code:"RH11",name:"Bright Green",hex:"#3BB44A"},{code:"RH12",name:"Dark Green",hex:"#006C55"},{code:"RH20",name:"Standard Blue",hex:"#0075BC"},{code:"RH21",name:"Purple",hex:"#493D8C"},{code:"RH22",name:"Light Blue",hex:"#47AFE3"},{code:"RH23",name:"Azure",hex:"#039DC4"},{code:"RH26",name:"Turquoise",hex:"#00A6A3"},{code:"RH30",name:"Standard Beige",hex:"#E4C4AA"},{code:"RH31",name:"Cream",hex:"#E8E3D8"},{code:"RH32",name:"Brown",hex:"#8B5F3C"},{code:"RH90",name:"Funky Pink",hex:"#E8457E"},{code:"RH40",name:"Mustard Yellow",hex:"#E5A144"},{code:"RH41",name:"Bright Yellow",hex:"#FFD833"},{code:"RH50",name:"Orange",hex:"#F15B32"},{code:"RH60",name:"Dark Grey",hex:"#59595B"},{code:"RH61",name:"Light Grey",hex:"#939598"},{code:"RH65",name:"Pale Grey",hex:"#D9D9D6"},{code:"RH70",name:"Black",hex:"#231F20"}];function j0({blendSvgUrl:t,recipes:e,mode:r="blend",onColorClick:n,onRegionClick:i,onEyedropperCancel:s,onMakeTransparent:o,onSelectTPVColor:l,selectedColor:c,editedColors:d,onResetAll:u,designName:f="",onNameChange:h,isNameLoading:p=!1,onInSituClick:g,eyedropperActive:m=!1,eyedropperRegion:x=null,onRegionUndo:v,onRegionRedo:y,canUndo:b=!1,canRedo:w=!1,regionOverridesCount:k=0}){const[_,C]=P.useState(null),[N,T]=P.useState(null),O=P.useRef(null),X=P.useRef(null);P.useRef(null);const[E,F]=P.useState(1),[S,K]=P.useState({x:0,y:0}),[le,D]=P.useState(!1),[I,L]=P.useState({x:0,y:0}),Z=P.useRef(null),H=P.useRef(!1),[G,ee]=P.useState(()=>localStorage.getItem("tpv_color_editing_tip_dismissed")!=="true"),oe=()=>{ee(!1),localStorage.setItem("tpv_color_editing_tip_dismissed","true")};P.useEffect(()=>{if(!t){T(null);return}(async()=>{try{const ae=await(await fetch(t)).text();T(ae);const q=ae.includes("data-region-id"),M=(ae.match(/data-region-id/g)||[]).length;console.log("[SVGPreview] Fetched inline SVG content - length:",ae.length,"hasRegionTags:",q,"regionCount:",M)}catch(U){console.error("[SVGPreview] Failed to fetch SVG content:",U),T(null)}})()},[t]);const fe=P.useMemo(()=>{if(!N)return null;console.log("[SVGPreview] Sanitizing SVG content...");const R=yp(N);return R?(console.log("[SVGPreview] SVG sanitization complete - length:",R.length),console.log("[SVGPreview] Sanitized content preview:",R.substring(0,200)),R.includes("<svg")?R.replace(/<svg([^>]*)>/i,(ae,q)=>(q.includes("width=")||(q+=' width="100%"'),q.includes("height=")||(q+=' height="100%"'),`<svg${q}>`)):(console.error("[SVGPreview] Sanitized SVG does not contain <svg> tag!"),null)):(console.error("[SVGPreview] SVG sanitization failed - content rejected"),null)},[N]);P.useEffect(()=>{if(!c||!t){C(null);return}(async()=>{try{console.log("[SVGPreview] Creating highlight for color:",c);const U=new Image;U.crossOrigin="anonymous";const ae=new Promise((Se,ke)=>{U.onload=()=>{console.log("[SVGPreview] Image loaded:",U.width,"x",U.height),Se()},U.onerror=Ce=>{console.error("[SVGPreview] Image load error:",Ce),ke(Ce)}});U.src=t,await ae;const q=document.createElement("canvas");q.width=U.naturalWidth||U.width||1e3,q.height=U.naturalHeight||U.height||1e3;const M=q.getContext("2d");M.drawImage(U,0,0);const de=M.getImageData(0,0,q.width,q.height).data,ie=c.hex,A=Oe(ie);console.log("[SVGPreview] Target color:",ie,A);const Y=new Set;let se=0;for(let Se=0;Se<q.height;Se++)for(let ke=0;ke<q.width;ke++){const Ce=(Se*q.width+ke)*4,xe=de[Ce],Ye=de[Ce+1],Ke=de[Ce+2];de[Ce+3]>0&&$e(xe,Ye,Ke,A)&&(Y.add(`${ke},${Se}`),se++)}if(console.log("[SVGPreview] Matched pixels:",se),se===0){console.warn("[SVGPreview] No pixels matched the target color"),C(null);return}const we=M.createImageData(q.width,q.height);for(let Se=0;Se<q.height;Se++)for(let ke=0;ke<q.width;ke++){const Ce=(Se*q.width+ke)*4;Y.has(`${ke},${Se}`)&&(!Y.has(`${ke-1},${Se}`)||!Y.has(`${ke+1},${Se}`)||!Y.has(`${ke},${Se-1}`)||!Y.has(`${ke},${Se+1}`))&&(we.data[Ce]=255,we.data[Ce+1]=0,we.data[Ce+2]=255,we.data[Ce+3]=255)}M.clearRect(0,0,q.width,q.height),M.putImageData(we,0,0);const ne=q.toDataURL();console.log("[SVGPreview] Highlight mask created"),C(ne)}catch(U){console.error("[SVGPreview] Failed to create highlight mask:",U),C(null)}})()},[c,t]);const Oe=R=>{const U=R.replace("#","");return{r:parseInt(U.substring(0,2),16),g:parseInt(U.substring(2,4),16),b:parseInt(U.substring(4,6),16)}},$e=(R,U,ae,q)=>Math.abs(R-q.r)<=50&&Math.abs(U-q.g)<=50&&Math.abs(ae-q.b)<=50,Ie=async(R,U)=>{try{if(!O.current||!t)return null;const ae=new Image;ae.crossOrigin="anonymous";const q=new Promise((Se,ke)=>{ae.onload=Se,ae.onerror=ke});ae.src=t,await q;const M=document.createElement("canvas");M.width=ae.naturalWidth||ae.width||1e3,M.height=ae.naturalHeight||ae.height||1e3;const J=M.getContext("2d");J.drawImage(ae,0,0);const de=O.current.getBoundingClientRect(),ie=M.width/de.width,A=M.height/de.height,Y=Math.floor(R*ie),se=Math.floor(U*A),ne=J.getImageData(Y,se,1,1).data;return{r:ne[0],g:ne[1],b:ne[2],a:ne[3]}}catch(ae){return console.error("[SVGPreview] Failed to get color at position:",ae),null}},Ee=()=>{F(R=>Math.min(R*1.5,5))},ge=()=>{F(R=>Math.max(R/1.5,.5))},me=()=>{F(1),K({x:0,y:0})},He=R=>{R.preventDefault();const U=R.deltaY*-.001;F(ae=>Math.min(Math.max(ae+U,.5),5))},ue=R=>{R.button===0&&(D(!0),L({x:R.clientX-S.x,y:R.clientY-S.y}),H.current=!1)},j=R=>{if(!le)return;const U=Math.abs(R.clientX-(I.x+S.x)),ae=Math.abs(R.clientY-(I.y+S.y));(U>5||ae>5)&&(H.current=!0),K({x:R.clientX-I.x,y:R.clientY-I.y})},ce=()=>{D(!1)};P.useEffect(()=>{if(le)return document.addEventListener("mousemove",j),document.addEventListener("mouseup",ce),()=>{document.removeEventListener("mousemove",j),document.removeEventListener("mouseup",ce)}},[le,I,S]);const re=R=>{let U=R;for(;U&&U!==X.current;){if(U.hasAttribute&&U.hasAttribute("data-region-id"))return U;U=U.parentElement}return null},z=async R=>{var ie,A;if(H.current){console.log("[SVGPreview] Click ignored - was dragging");return}if(console.log("[SVGPreview] Click detected - onRegionClick:",!!i,"inlineSvgContent:",!!N,"target:",R.target.tagName),i&&N){console.log("[SVGPreview] Attempting region detection on target:",R.target);const Y=re(R.target);if(console.log("[SVGPreview] Found region element:",Y),Y){const se=Y.getAttribute("data-region-id"),we=Y.getAttribute("fill")||((A=(ie=Y.getAttribute("style"))==null?void 0:ie.match(/fill:\s*([^;]+)/))==null?void 0:A[1]);console.log("[SVGPreview] Region clicked:",se,"fill:",we),i({regionId:se,sourceColor:we,element:Y});return}else console.log("[SVGPreview] No region element found from target")}else console.log("[SVGPreview] Region detection skipped - onRegionClick:",!!i,"inlineSvgContent:",!!N);if(!n||!e||e.length===0)return;const U=R.currentTarget.getBoundingClientRect(),ae=R.clientX-U.left,q=R.clientY-U.top;console.log("[SVGPreview] Clicked at:",ae,q);const M=await Ie(ae,q);if(!M||M.a===0){console.log("[SVGPreview] Clicked on transparent area");return}console.log("[SVGPreview] Clicked color:",M);let J=null,de=1/0;for(const Y of e){const se=Y.targetColor.hex,we=Oe(se);if($e(M.r,M.g,M.b,we)){const ne=Math.sqrt(Math.pow(M.r-we.r,2)+Math.pow(M.g-we.g,2)+Math.pow(M.b-we.b,2));ne<de&&(de=ne,J=Y)}}J?(console.log("[SVGPreview] Matched recipe:",J.targetColor.hex),n({hex:J.targetColor.hex,originalHex:J.originalColor.hex,blendHex:J.blendColor.hex,areaPct:J.targetColor.areaPct,recipe:J.chosenRecipe,targetColor:J.targetColor})):console.log("[SVGPreview] No matching recipe found for clicked color")};return t?a.jsxs("div",{className:"svg-preview",children:[a.jsxs("div",{className:"preview-header",children:[a.jsxs("div",{className:"design-name-container",children:[h?a.jsx("input",{type:"text",className:"design-name-input",value:f,onChange:R=>h(R.target.value),placeholder:p?"Generating name...":"Enter project name"}):a.jsx("h3",{children:f||"TPV Blend Design"}),p&&a.jsx("span",{className:"name-loading",children:"Generating..."})]}),c&&a.jsxs("span",{className:"editing-hint",children:["Editing: ",c.hex||c.blendHex]})]}),G&&n&&a.jsxs("div",{className:"color-editing-tip",children:[a.jsx("div",{className:"tip-icon",children:""}),a.jsxs("div",{className:"tip-content",children:[a.jsx("strong",{children:"Tip:"})," Click colours in the legend below to edit all instances, or click directly on the design to edit individual regions."]}),a.jsx("button",{onClick:oe,className:"tip-close",title:"Dismiss tip",children:""})]}),a.jsxs("div",{className:"svg-display-container",children:[a.jsxs("div",{className:"svg-panel",children:[a.jsxs("div",{className:"zoom-controls",children:[a.jsx("button",{onClick:Ee,className:"zoom-btn",title:"Zoom In",children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"11",y1:"8",x2:"11",y2:"14"}),a.jsx("line",{x1:"8",y1:"11",x2:"14",y2:"11"}),a.jsx("path",{d:"m21 21-4.35-4.35"})]})}),a.jsx("button",{onClick:ge,className:"zoom-btn",title:"Zoom Out",children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"8",y1:"11",x2:"14",y2:"11"}),a.jsx("path",{d:"m21 21-4.35-4.35"})]})}),a.jsx("button",{onClick:me,className:"zoom-btn",title:"Reset View",children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M1 4v6h6"}),a.jsx("path",{d:"M23 20v-6h-6"}),a.jsx("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})]})}),a.jsxs("span",{className:"zoom-level",children:[Math.round(E*100),"%"]})]}),k>0&&a.jsxs("div",{className:"undo-redo-controls",children:[a.jsx("button",{onClick:v,className:"undo-redo-btn",title:"Undo (Ctrl+Z)",disabled:!b,children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 7v6h6"}),a.jsx("path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13"})]})}),a.jsx("button",{onClick:y,className:"undo-redo-btn",title:"Redo (Ctrl+Y)",disabled:!w,children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M21 7v6h-6"}),a.jsx("path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7"})]})})]}),g&&a.jsxs("button",{onClick:g,className:"in-situ-btn",title:"Upload a photo of your installation site and see how this design will look in place with realistic perspective",children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"m21 15-5-5L5 21"})]}),a.jsx("span",{children:"Preview In-Situ"})]}),a.jsx("div",{ref:Z,className:"svg-wrapper",onWheel:He,children:a.jsxs("div",{className:"svg-image-container",onClick:z,onMouseDown:ue,style:{transform:`translate(${S.x}px, ${S.y}px) scale(${E})`,cursor:le?"grabbing":E>1?"grab":m?"crosshair":n?"pointer":"default"},children:[fe?a.jsx("div",{ref:X,className:"svg-inline-container",style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},dangerouslySetInnerHTML:{__html:fe}}):a.jsx("img",{ref:O,src:t,alt:"TPV blend design",className:"svg-image"}),_&&a.jsx("img",{src:_,alt:"Colour highlight",className:"svg-highlight-mask"})]})}),m&&x&&a.jsx("div",{className:"eyedropper-overlay",children:a.jsxs("div",{className:"eyedropper-content",children:[a.jsx("div",{className:"eyedropper-header",children:a.jsxs("div",{className:"eyedropper-color-indicator",children:[a.jsx("div",{className:"eyedropper-color-swatch",style:{backgroundColor:x.sourceColor}}),a.jsx("span",{children:"Click another area to copy its colour, or select a TPV colour:"})]})}),a.jsx("div",{className:"eyedropper-palette",children:a.jsx("div",{className:"palette-grid",children:uE.map(R=>a.jsx("button",{className:"palette-swatch",style:{backgroundColor:R.hex},onClick:U=>{U.stopPropagation(),l&&l(R.hex)},title:`${R.name} (${R.code})`},R.code))})}),a.jsxs("div",{className:"eyedropper-actions",children:[a.jsxs("button",{className:"eyedropper-transparent",onClick:R=>{R.stopPropagation(),o&&o()},title:"Remove fill from this region",children:[a.jsx("span",{className:"transparent-icon",children:""}),"Make Transparent"]}),a.jsx("button",{className:"eyedropper-cancel",onClick:R=>{R.stopPropagation(),s&&s()},children:"Cancel (Esc)"})]})]})})]}),e&&e.length>0&&a.jsx("div",{className:"legend-sidebar",children:a.jsx(dE,{recipes:e,mode:r,onColorClick:n,selectedColor:c,editedColors:d,onResetAll:u})})]}),a.jsx("style",{jsx:!0,children:`
        .svg-preview {
          background: #fff;
          border-radius: 8px;
          border: 1px solid #ddd;
          padding: 1.5rem;
          margin-top: 1.5rem;
        }

        .preview-header {
          margin-bottom: 1.5rem;
          display: flex;
          align-items: center;
          justify-content: space-between;
          flex-wrap: wrap;
          gap: 0.5rem;
        }

        .design-name-container {
          display: flex;
          align-items: center;
          gap: 0.75rem;
          flex: 1;
        }

        .preview-header h3 {
          margin: 0;
          color: #1a365d;
          font-size: 1.5rem;
        }

        .design-name-input {
          font-family: var(--font-heading), 'Space Grotesk', sans-serif;
          font-size: 1.5rem;
          font-weight: 600;
          color: #1a365d;
          border: none;
          border-bottom: 2px solid transparent;
          background: transparent;
          padding: 0.25rem 0;
          width: 100%;
          max-width: 400px;
          transition: border-color 0.2s;
        }

        .design-name-input:hover {
          border-bottom-color: #e5e7eb;
        }

        .design-name-input:focus {
          outline: none;
          border-bottom-color: #ff6b35;
        }

        .design-name-input::placeholder {
          color: #9ca3af;
          font-weight: normal;
        }

        .name-loading {
          font-size: 0.75rem;
          color: #9ca3af;
          font-style: italic;
        }

        /* Color Editing Tip Banner */
        .color-editing-tip {
          display: flex;
          align-items: center;
          gap: 0.75rem;
          padding: 0.875rem 1rem;
          background: linear-gradient(to right, #fff7ed, #fffbeb);
          border: 1px solid #fed7aa;
          border-radius: 6px;
          margin-bottom: 1rem;
          font-size: 0.875rem;
          line-height: 1.5;
        }

        .tip-icon {
          font-size: 1.25rem;
          flex-shrink: 0;
        }

        .tip-content {
          flex: 1;
          color: #78350f;
        }

        .tip-content strong {
          color: #92400e;
        }

        .tip-close {
          background: none;
          border: none;
          font-size: 1.5rem;
          color: #92400e;
          cursor: pointer;
          padding: 0;
          line-height: 1;
          opacity: 0.6;
          transition: opacity 0.2s;
          flex-shrink: 0;
        }

        .tip-close:hover {
          opacity: 1;
        }

        /* SVG Display */
        .svg-display-container {
          display: flex;
          flex-direction: column;
          gap: 1.5rem;
          align-items: stretch;
        }

        .svg-panel {
          position: relative;
          flex: 1;
          border: 1px solid #e0e0e0;
          border-radius: 6px;
          overflow: hidden;
          background: #fafafa;
        }

        /* Zoom Controls */
        .zoom-controls {
          position: absolute;
          top: 1rem;
          right: 1rem;
          display: flex;
          gap: 0.5rem;
          background: white;
          border-radius: 8px;
          padding: 0.5rem;
          box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
          z-index: 10;
          align-items: center;
        }

        .zoom-btn {
          display: flex;
          align-items: center;
          justify-content: center;
          width: 36px;
          height: 36px;
          padding: 0;
          background: white;
          border: 1px solid #e0e0e0;
          border-radius: 6px;
          cursor: pointer;
          color: #1a365d;
          transition: all 0.2s ease;
        }

        .zoom-btn:hover {
          background: #f8fafc;
          border-color: #1e4a7a;
          transform: translateY(-1px);
          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .zoom-btn:active {
          transform: translateY(0);
        }

        .zoom-btn svg {
          width: 20px;
          height: 20px;
        }

        .zoom-level {
          font-size: 0.875rem;
          font-weight: 600;
          color: #1a365d;
          min-width: 50px;
          text-align: center;
          padding: 0 0.5rem;
        }

        /* Undo/Redo Controls */
        .undo-redo-controls {
          position: absolute;
          top: 5rem;
          right: 1rem;
          display: flex;
          gap: 0.5rem;
          background: white;
          border-radius: 8px;
          padding: 0.5rem;
          box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
          z-index: 10;
        }

        .undo-redo-btn {
          display: flex;
          align-items: center;
          justify-content: center;
          width: 36px;
          height: 36px;
          padding: 0;
          background: white;
          border: 1px solid #e0e0e0;
          border-radius: 6px;
          cursor: pointer;
          color: #1a365d;
          transition: all 0.2s ease;
        }

        .undo-redo-btn:hover:not(:disabled) {
          background: #f8fafc;
          border-color: #1e4a7a;
          transform: translateY(-1px);
          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .undo-redo-btn:active:not(:disabled) {
          transform: translateY(0);
        }

        .undo-redo-btn:disabled {
          opacity: 0.4;
          cursor: not-allowed;
        }

        .undo-redo-btn svg {
          width: 20px;
          height: 20px;
        }

        .in-situ-btn {
          position: absolute;
          top: 1rem;
          left: 1rem;
          display: flex;
          align-items: center;
          gap: 0.5rem;
          padding: 0.5rem 1rem;
          background: #ff6b35;
          color: white;
          border: none;
          border-radius: 6px;
          font-size: 0.875rem;
          font-weight: 500;
          cursor: pointer;
          box-shadow: 0 2px 12px rgba(255, 107, 53, 0.3);
          z-index: 10;
          transition: all 0.2s ease;
        }

        .in-situ-btn:hover {
          background: #e55a2b;
          transform: translateY(-1px);
          box-shadow: 0 4px 16px rgba(255, 107, 53, 0.4);
        }

        .in-situ-btn:active {
          transform: translateY(0);
        }

        .in-situ-btn svg {
          width: 18px;
          height: 18px;
        }

        .svg-wrapper {
          padding: 2rem;
          background: white;
          min-height: 400px;
          display: flex;
          align-items: center;
          justify-content: center;
          overflow: hidden;
          position: relative;
        }

        .svg-image-container {
          position: relative;
          display: inline-block;
          user-select: none;
          transition: transform 0.1s ease-out;
          transform-origin: center center;
        }

        .svg-image {
          max-width: 100%;
          height: auto;
          display: block;
          border-radius: 4px;
          pointer-events: ${n?"auto":"none"};
        }

        .svg-inline-container {
          max-width: 100%;
          display: block;
          border-radius: 4px;
        }

        .svg-inline-container svg {
          max-width: 100%;
          height: auto;
          display: block;
        }

        .svg-highlight-mask {
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          pointer-events: none;
          border-radius: 4px;
          filter: drop-shadow(0 0 3px rgba(255, 0, 255, 0.8)) drop-shadow(0 0 1px rgba(0, 0, 0, 0.6));
          animation: pulse 2s ease-in-out infinite;
        }

        .eyedropper-overlay {
          position: absolute;
          top: 20px;
          left: 50%;
          transform: translateX(-50%);
          z-index: 100;
        }

        .eyedropper-content {
          background: white;
          border-radius: 12px;
          padding: 16px 20px;
          box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
          display: flex;
          flex-direction: column;
          gap: 12px;
          border: 2px solid #3b82f6;
          max-width: 320px;
        }

        .eyedropper-header {
          display: flex;
          align-items: center;
          gap: 12px;
        }

        .eyedropper-color-indicator {
          display: flex;
          align-items: center;
          gap: 12px;
          font-size: 0.9rem;
          font-weight: 500;
          color: #111827;
        }

        .eyedropper-color-swatch {
          width: 28px;
          height: 28px;
          border-radius: 6px;
          border: 2px solid #d1d5db;
          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
          flex-shrink: 0;
        }

        .eyedropper-palette {
          padding: 10px;
          background: #f9fafb;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
        }

        .palette-grid {
          display: grid;
          grid-template-columns: repeat(7, 1fr);
          gap: 4px;
        }

        .palette-swatch {
          width: 32px;
          height: 32px;
          border: 2px solid rgba(0, 0, 0, 0.15);
          border-radius: 4px;
          cursor: pointer;
          padding: 0;
          transition: all 0.15s ease;
        }

        .palette-swatch:hover {
          transform: scale(1.15);
          z-index: 1;
          box-shadow: 0 3px 8px rgba(0, 0, 0, 0.25);
          border-color: #3b82f6;
        }

        .eyedropper-cancel {
          padding: 8px 16px;
          background: #ef4444;
          color: white;
          border: none;
          border-radius: 6px;
          font-size: 0.9rem;
          font-weight: 500;
          cursor: pointer;
          transition: all 0.2s;
          white-space: nowrap;
        }

        .eyedropper-cancel:hover {
          background: #dc2626;
          box-shadow: 0 2px 6px rgba(239, 68, 68, 0.3);
        }

        .eyedropper-actions {
          display: flex;
          gap: 8px;
          align-items: center;
          justify-content: center;
        }

        .eyedropper-transparent {
          display: flex;
          align-items: center;
          gap: 6px;
          padding: 8px 14px;
          background: linear-gradient(135deg, #f3f4f6 25%, #d1d5db 25%, #d1d5db 50%, #f3f4f6 50%, #f3f4f6 75%, #d1d5db 75%);
          background-size: 8px 8px;
          color: #374151;
          border: 2px solid #6b7280;
          border-radius: 6px;
          font-size: 0.9rem;
          font-weight: 600;
          cursor: pointer;
          transition: all 0.2s;
          white-space: nowrap;
        }

        .eyedropper-transparent:hover {
          border-color: #374151;
          box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
          transform: translateY(-1px);
        }

        .transparent-icon {
          width: 16px;
          height: 16px;
          background: linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%),
                      linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%);
          background-size: 8px 8px;
          background-position: 0 0, 4px 4px;
          background-color: white;
          border: 1px solid #999;
          border-radius: 2px;
          display: inline-block;
          font-size: 0;
        }

        @keyframes pulse {
          0%, 100% {
            opacity: 0.8;
          }
          50% {
            opacity: 1;
          }
        }

        .editing-hint {
          font-size: 0.9rem;
          color: #ff6b35;
          font-weight: 500;
          margin-left: 1rem;
        }

        .legend-sidebar {
          width: 100%;
        }

        @media (max-width: 768px) {
          .svg-preview {
            padding: 0.5rem;
            margin-top: 0.75rem;
            border-radius: 6px;
          }

          .preview-header {
            flex-direction: column;
            align-items: flex-start;
            gap: 0.25rem;
            margin-bottom: 0.5rem;
          }

          .preview-header h3 {
            font-size: 1.1rem;
          }

          .design-name-input {
            font-size: 1.1rem;
            max-width: 100%;
          }

          .editing-hint {
            margin-left: 0;
            font-size: 0.75rem;
          }

          .svg-panel {
            border: none;
            border-radius: 0;
          }

          .svg-wrapper {
            padding: 0;
            min-height: auto;
          }

          /* Position zoom controls at bottom-right on mobile */
          .zoom-controls {
            position: fixed;
            bottom: 1rem;
            right: 1rem;
            top: auto;
            flex-direction: column;
            gap: 0.25rem;
            padding: 0.25rem;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(8px);
            z-index: 50;
          }

          /* Position undo/redo controls above zoom on mobile */
          .undo-redo-controls {
            position: fixed;
            bottom: 12rem;
            right: 1rem;
            top: auto;
            gap: 0.25rem;
            padding: 0.25rem;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(8px);
            z-index: 50;
          }

          /* Make buttons circular and compact on mobile */
          .zoom-btn,
          .undo-redo-btn {
            width: 44px;
            height: 44px;
            padding: 0;
            border-radius: 50%;
            min-width: unset;
            font-size: 1.1rem;
          }

          /* Hide text labels on mobile */
          .zoom-btn span {
            display: none;
          }

          /* In-situ button - compact on mobile */
          .in-situ-btn {
            padding: 0.4rem;
            font-size: 0;
            top: 0.5rem;
            left: 0.5rem;
            border-radius: 50%;
            width: 36px;
            height: 36px;
          }

          .in-situ-btn span {
            display: none;
          }

          .in-situ-btn svg {
            width: 18px;
            height: 18px;
          }

          .svg-image-container {
            /* Allow zoom on mobile via buttons */
            cursor: default !important;
          }
        }

        /* Extra small screens */
        @media (max-width: 480px) {
          .svg-preview {
            padding: 0.25rem;
            margin-top: 0.5rem;
          }

          .preview-header {
            padding: 0 0.25rem;
          }

          .preview-header h3 {
            font-size: 1rem;
          }

          .design-name-input {
            font-size: 1rem;
          }
        }
      `})]}):null}var qr={},dl={},hE=typeof Si=="object"&&Si&&Si.Object===Object&&Si,Yw=hE,fE=Yw,pE=typeof self=="object"&&self&&self.Object===Object&&self,mE=fE||pE||Function("return this")(),Ln=mE,gE=Ln,vE=gE.Symbol,ul=vE,C0=ul,Xw=Object.prototype,yE=Xw.hasOwnProperty,xE=Xw.toString,aa=C0?C0.toStringTag:void 0;function bE(t){var e=yE.call(t,aa),r=t[aa];try{t[aa]=void 0;var n=!0}catch{}var i=xE.call(t);return n&&(e?t[aa]=r:delete t[aa]),i}var wE=bE,_E=Object.prototype,SE=_E.toString;function kE(t){return SE.call(t)}var jE=kE,E0=ul,CE=wE,EE=jE,TE="[object Null]",NE="[object Undefined]",T0=E0?E0.toStringTag:void 0;function RE(t){return t==null?t===void 0?NE:TE:T0&&T0 in Object(t)?CE(t):EE(t)}var vs=RE,PE=Array.isArray,vn=PE;function OE(t){return t!=null&&typeof t=="object"}var oi=OE,AE=vs,ME=vn,$E=oi,LE="[object String]";function IE(t){return typeof t=="string"||!ME(t)&&$E(t)&&AE(t)==LE}var DE=IE;function zE(t){return function(e,r,n){for(var i=-1,s=Object(e),o=n(e),l=o.length;l--;){var c=o[t?l:++i];if(r(s[c],c,s)===!1)break}return e}}var FE=zE,BE=FE,HE=BE(),UE=HE;function WE(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}var GE=WE,VE=vs,qE=oi,YE="[object Arguments]";function XE(t){return qE(t)&&VE(t)==YE}var KE=XE,N0=KE,ZE=oi,Kw=Object.prototype,JE=Kw.hasOwnProperty,QE=Kw.propertyIsEnumerable,eT=N0(function(){return arguments}())?N0:function(t){return ZE(t)&&JE.call(t,"callee")&&!QE.call(t,"callee")},Zw=eT,qc={exports:{}};function tT(){return!1}var rT=tT;qc.exports;(function(t,e){var r=Ln,n=rT,i=e&&!e.nodeType&&e,s=i&&!0&&t&&!t.nodeType&&t,o=s&&s.exports===i,l=o?r.Buffer:void 0,c=l?l.isBuffer:void 0,d=c||n;t.exports=d})(qc,qc.exports);var Sp=qc.exports,nT=9007199254740991,iT=/^(?:0|[1-9]\d*)$/;function sT(t,e){var r=typeof t;return e=e??nT,!!e&&(r=="number"||r!="symbol"&&iT.test(t))&&t>-1&&t%1==0&&t<e}var Jw=sT,oT=9007199254740991;function aT(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=oT}var kp=aT,lT=vs,cT=kp,dT=oi,uT="[object Arguments]",hT="[object Array]",fT="[object Boolean]",pT="[object Date]",mT="[object Error]",gT="[object Function]",vT="[object Map]",yT="[object Number]",xT="[object Object]",bT="[object RegExp]",wT="[object Set]",_T="[object String]",ST="[object WeakMap]",kT="[object ArrayBuffer]",jT="[object DataView]",CT="[object Float32Array]",ET="[object Float64Array]",TT="[object Int8Array]",NT="[object Int16Array]",RT="[object Int32Array]",PT="[object Uint8Array]",OT="[object Uint8ClampedArray]",AT="[object Uint16Array]",MT="[object Uint32Array]",kt={};kt[CT]=kt[ET]=kt[TT]=kt[NT]=kt[RT]=kt[PT]=kt[OT]=kt[AT]=kt[MT]=!0;kt[uT]=kt[hT]=kt[kT]=kt[fT]=kt[jT]=kt[pT]=kt[mT]=kt[gT]=kt[vT]=kt[yT]=kt[xT]=kt[bT]=kt[wT]=kt[_T]=kt[ST]=!1;function $T(t){return dT(t)&&cT(t.length)&&!!kt[lT(t)]}var LT=$T;function IT(t){return function(e){return t(e)}}var jp=IT,Yc={exports:{}};Yc.exports;(function(t,e){var r=Yw,n=e&&!e.nodeType&&e,i=n&&!0&&t&&!t.nodeType&&t,s=i&&i.exports===n,o=s&&r.process,l=function(){try{var c=i&&i.require&&i.require("util").types;return c||o&&o.binding&&o.binding("util")}catch{}}();t.exports=l})(Yc,Yc.exports);var Cp=Yc.exports,DT=LT,zT=jp,R0=Cp,P0=R0&&R0.isTypedArray,FT=P0?zT(P0):DT,Qw=FT,BT=GE,HT=Zw,UT=vn,WT=Sp,GT=Jw,VT=Qw,qT=Object.prototype,YT=qT.hasOwnProperty;function XT(t,e){var r=UT(t),n=!r&&HT(t),i=!r&&!n&&WT(t),s=!r&&!n&&!i&&VT(t),o=r||n||i||s,l=o?BT(t.length,String):[],c=l.length;for(var d in t)(e||YT.call(t,d))&&!(o&&(d=="length"||i&&(d=="offset"||d=="parent")||s&&(d=="buffer"||d=="byteLength"||d=="byteOffset")||GT(d,c)))&&l.push(d);return l}var e1=XT,KT=Object.prototype;function ZT(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||KT;return t===r}var Ep=ZT;function JT(t,e){return function(r){return t(e(r))}}var t1=JT,QT=t1,eN=QT(Object.keys,Object),tN=eN,rN=Ep,nN=tN,iN=Object.prototype,sN=iN.hasOwnProperty;function oN(t){if(!rN(t))return nN(t);var e=[];for(var r in Object(t))sN.call(t,r)&&r!="constructor"&&e.push(r);return e}var aN=oN;function lN(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var Bo=lN,cN=vs,dN=Bo,uN="[object AsyncFunction]",hN="[object Function]",fN="[object GeneratorFunction]",pN="[object Proxy]";function mN(t){if(!dN(t))return!1;var e=cN(t);return e==hN||e==fN||e==uN||e==pN}var r1=mN,gN=r1,vN=kp;function yN(t){return t!=null&&vN(t.length)&&!gN(t)}var kd=yN,xN=e1,bN=aN,wN=kd;function _N(t){return wN(t)?xN(t):bN(t)}var hl=_N,SN=UE,kN=hl;function jN(t,e){return t&&SN(t,e,kN)}var n1=jN;function CN(t){return t}var i1=CN,EN=i1;function TN(t){return typeof t=="function"?t:EN}var NN=TN,RN=n1,PN=NN;function ON(t,e){return t&&RN(t,PN(e))}var Tp=ON,AN=t1,MN=AN(Object.getPrototypeOf,Object),Np=MN,$N=vs,LN=Np,IN=oi,DN="[object Object]",zN=Function.prototype,FN=Object.prototype,s1=zN.toString,BN=FN.hasOwnProperty,HN=s1.call(Object);function UN(t){if(!IN(t)||$N(t)!=DN)return!1;var e=LN(t);if(e===null)return!0;var r=BN.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&s1.call(r)==HN}var WN=UN;function GN(t,e){for(var r=-1,n=t==null?0:t.length,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i}var o1=GN;function VN(){this.__data__=[],this.size=0}var qN=VN;function YN(t,e){return t===e||t!==t&&e!==e}var Rp=YN,XN=Rp;function KN(t,e){for(var r=t.length;r--;)if(XN(t[r][0],e))return r;return-1}var jd=KN,ZN=jd,JN=Array.prototype,QN=JN.splice;function e3(t){var e=this.__data__,r=ZN(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():QN.call(e,r,1),--this.size,!0}var t3=e3,r3=jd;function n3(t){var e=this.__data__,r=r3(e,t);return r<0?void 0:e[r][1]}var i3=n3,s3=jd;function o3(t){return s3(this.__data__,t)>-1}var a3=o3,l3=jd;function c3(t,e){var r=this.__data__,n=l3(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}var d3=c3,u3=qN,h3=t3,f3=i3,p3=a3,m3=d3;function Ho(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Ho.prototype.clear=u3;Ho.prototype.delete=h3;Ho.prototype.get=f3;Ho.prototype.has=p3;Ho.prototype.set=m3;var Cd=Ho,g3=Cd;function v3(){this.__data__=new g3,this.size=0}var y3=v3;function x3(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}var b3=x3;function w3(t){return this.__data__.get(t)}var _3=w3;function S3(t){return this.__data__.has(t)}var k3=S3,j3=Ln,C3=j3["__core-js_shared__"],E3=C3,Ru=E3,O0=function(){var t=/[^.]+$/.exec(Ru&&Ru.keys&&Ru.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function T3(t){return!!O0&&O0 in t}var N3=T3,R3=Function.prototype,P3=R3.toString;function O3(t){if(t!=null){try{return P3.call(t)}catch{}try{return t+""}catch{}}return""}var a1=O3,A3=r1,M3=N3,$3=Bo,L3=a1,I3=/[\\^$.*+?()[\]{}|]/g,D3=/^\[object .+?Constructor\]$/,z3=Function.prototype,F3=Object.prototype,B3=z3.toString,H3=F3.hasOwnProperty,U3=RegExp("^"+B3.call(H3).replace(I3,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function W3(t){if(!$3(t)||M3(t))return!1;var e=A3(t)?U3:D3;return e.test(L3(t))}var G3=W3;function V3(t,e){return t==null?void 0:t[e]}var q3=V3,Y3=G3,X3=q3;function K3(t,e){var r=X3(t,e);return Y3(r)?r:void 0}var ys=K3,Z3=ys,J3=Ln,Q3=Z3(J3,"Map"),Pp=Q3,eR=ys,tR=eR(Object,"create"),Ed=tR,A0=Ed;function rR(){this.__data__=A0?A0(null):{},this.size=0}var nR=rR;function iR(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var sR=iR,oR=Ed,aR="__lodash_hash_undefined__",lR=Object.prototype,cR=lR.hasOwnProperty;function dR(t){var e=this.__data__;if(oR){var r=e[t];return r===aR?void 0:r}return cR.call(e,t)?e[t]:void 0}var uR=dR,hR=Ed,fR=Object.prototype,pR=fR.hasOwnProperty;function mR(t){var e=this.__data__;return hR?e[t]!==void 0:pR.call(e,t)}var gR=mR,vR=Ed,yR="__lodash_hash_undefined__";function xR(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=vR&&e===void 0?yR:e,this}var bR=xR,wR=nR,_R=sR,SR=uR,kR=gR,jR=bR;function Uo(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Uo.prototype.clear=wR;Uo.prototype.delete=_R;Uo.prototype.get=SR;Uo.prototype.has=kR;Uo.prototype.set=jR;var CR=Uo,M0=CR,ER=Cd,TR=Pp;function NR(){this.size=0,this.__data__={hash:new M0,map:new(TR||ER),string:new M0}}var RR=NR;function PR(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var OR=PR,AR=OR;function MR(t,e){var r=t.__data__;return AR(e)?r[typeof e=="string"?"string":"hash"]:r.map}var Td=MR,$R=Td;function LR(t){var e=$R(this,t).delete(t);return this.size-=e?1:0,e}var IR=LR,DR=Td;function zR(t){return DR(this,t).get(t)}var FR=zR,BR=Td;function HR(t){return BR(this,t).has(t)}var UR=HR,WR=Td;function GR(t,e){var r=WR(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}var VR=GR,qR=RR,YR=IR,XR=FR,KR=UR,ZR=VR;function Wo(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Wo.prototype.clear=qR;Wo.prototype.delete=YR;Wo.prototype.get=XR;Wo.prototype.has=KR;Wo.prototype.set=ZR;var Op=Wo,JR=Cd,QR=Pp,eP=Op,tP=200;function rP(t,e){var r=this.__data__;if(r instanceof JR){var n=r.__data__;if(!QR||n.length<tP-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new eP(n)}return r.set(t,e),this.size=r.size,this}var nP=rP,iP=Cd,sP=y3,oP=b3,aP=_3,lP=k3,cP=nP;function Go(t){var e=this.__data__=new iP(t);this.size=e.size}Go.prototype.clear=sP;Go.prototype.delete=oP;Go.prototype.get=aP;Go.prototype.has=lP;Go.prototype.set=cP;var Ap=Go,dP="__lodash_hash_undefined__";function uP(t){return this.__data__.set(t,dP),this}var hP=uP;function fP(t){return this.__data__.has(t)}var pP=fP,mP=Op,gP=hP,vP=pP;function Xc(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new mP;++e<r;)this.add(t[e])}Xc.prototype.add=Xc.prototype.push=gP;Xc.prototype.has=vP;var yP=Xc;function xP(t,e){for(var r=-1,n=t==null?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}var bP=xP;function wP(t,e){return t.has(e)}var _P=wP,SP=yP,kP=bP,jP=_P,CP=1,EP=2;function TP(t,e,r,n,i,s){var o=r&CP,l=t.length,c=e.length;if(l!=c&&!(o&&c>l))return!1;var d=s.get(t),u=s.get(e);if(d&&u)return d==e&&u==t;var f=-1,h=!0,p=r&EP?new SP:void 0;for(s.set(t,e),s.set(e,t);++f<l;){var g=t[f],m=e[f];if(n)var x=o?n(m,g,f,e,t,s):n(g,m,f,t,e,s);if(x!==void 0){if(x)continue;h=!1;break}if(p){if(!kP(e,function(v,y){if(!jP(p,y)&&(g===v||i(g,v,r,n,s)))return p.push(y)})){h=!1;break}}else if(!(g===m||i(g,m,r,n,s))){h=!1;break}}return s.delete(t),s.delete(e),h}var l1=TP,NP=Ln,RP=NP.Uint8Array,c1=RP;function PP(t){var e=-1,r=Array(t.size);return t.forEach(function(n,i){r[++e]=[i,n]}),r}var OP=PP;function AP(t){var e=-1,r=Array(t.size);return t.forEach(function(n){r[++e]=n}),r}var MP=AP,$0=ul,L0=c1,$P=Rp,LP=l1,IP=OP,DP=MP,zP=1,FP=2,BP="[object Boolean]",HP="[object Date]",UP="[object Error]",WP="[object Map]",GP="[object Number]",VP="[object RegExp]",qP="[object Set]",YP="[object String]",XP="[object Symbol]",KP="[object ArrayBuffer]",ZP="[object DataView]",I0=$0?$0.prototype:void 0,Pu=I0?I0.valueOf:void 0;function JP(t,e,r,n,i,s,o){switch(r){case ZP:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case KP:return!(t.byteLength!=e.byteLength||!s(new L0(t),new L0(e)));case BP:case HP:case GP:return $P(+t,+e);case UP:return t.name==e.name&&t.message==e.message;case VP:case YP:return t==e+"";case WP:var l=IP;case qP:var c=n&zP;if(l||(l=DP),t.size!=e.size&&!c)return!1;var d=o.get(t);if(d)return d==e;n|=FP,o.set(t,e);var u=LP(l(t),l(e),n,i,s,o);return o.delete(t),u;case XP:if(Pu)return Pu.call(t)==Pu.call(e)}return!1}var QP=JP;function eO(t,e){for(var r=-1,n=e.length,i=t.length;++r<n;)t[i+r]=e[r];return t}var d1=eO,tO=d1,rO=vn;function nO(t,e,r){var n=e(t);return rO(t)?n:tO(n,r(t))}var u1=nO;function iO(t,e){for(var r=-1,n=t==null?0:t.length,i=0,s=[];++r<n;){var o=t[r];e(o,r,t)&&(s[i++]=o)}return s}var sO=iO;function oO(){return[]}var h1=oO,aO=sO,lO=h1,cO=Object.prototype,dO=cO.propertyIsEnumerable,D0=Object.getOwnPropertySymbols,uO=D0?function(t){return t==null?[]:(t=Object(t),aO(D0(t),function(e){return dO.call(t,e)}))}:lO,Mp=uO,hO=u1,fO=Mp,pO=hl;function mO(t){return hO(t,pO,fO)}var f1=mO,z0=f1,gO=1,vO=Object.prototype,yO=vO.hasOwnProperty;function xO(t,e,r,n,i,s){var o=r&gO,l=z0(t),c=l.length,d=z0(e),u=d.length;if(c!=u&&!o)return!1;for(var f=c;f--;){var h=l[f];if(!(o?h in e:yO.call(e,h)))return!1}var p=s.get(t),g=s.get(e);if(p&&g)return p==e&&g==t;var m=!0;s.set(t,e),s.set(e,t);for(var x=o;++f<c;){h=l[f];var v=t[h],y=e[h];if(n)var b=o?n(y,v,h,e,t,s):n(v,y,h,t,e,s);if(!(b===void 0?v===y||i(v,y,r,n,s):b)){m=!1;break}x||(x=h=="constructor")}if(m&&!x){var w=t.constructor,k=e.constructor;w!=k&&"constructor"in t&&"constructor"in e&&!(typeof w=="function"&&w instanceof w&&typeof k=="function"&&k instanceof k)&&(m=!1)}return s.delete(t),s.delete(e),m}var bO=xO,wO=ys,_O=Ln,SO=wO(_O,"DataView"),kO=SO,jO=ys,CO=Ln,EO=jO(CO,"Promise"),TO=EO,NO=ys,RO=Ln,PO=NO(RO,"Set"),OO=PO,AO=ys,MO=Ln,$O=AO(MO,"WeakMap"),LO=$O,Qh=kO,ef=Pp,tf=TO,rf=OO,nf=LO,p1=vs,Vo=a1,F0="[object Map]",IO="[object Object]",B0="[object Promise]",H0="[object Set]",U0="[object WeakMap]",W0="[object DataView]",DO=Vo(Qh),zO=Vo(ef),FO=Vo(tf),BO=Vo(rf),HO=Vo(nf),Ji=p1;(Qh&&Ji(new Qh(new ArrayBuffer(1)))!=W0||ef&&Ji(new ef)!=F0||tf&&Ji(tf.resolve())!=B0||rf&&Ji(new rf)!=H0||nf&&Ji(new nf)!=U0)&&(Ji=function(t){var e=p1(t),r=e==IO?t.constructor:void 0,n=r?Vo(r):"";if(n)switch(n){case DO:return W0;case zO:return F0;case FO:return B0;case BO:return H0;case HO:return U0}return e});var Nd=Ji,Ou=Ap,UO=l1,WO=QP,GO=bO,G0=Nd,V0=vn,q0=Sp,VO=Qw,qO=1,Y0="[object Arguments]",X0="[object Array]",Kl="[object Object]",YO=Object.prototype,K0=YO.hasOwnProperty;function XO(t,e,r,n,i,s){var o=V0(t),l=V0(e),c=o?X0:G0(t),d=l?X0:G0(e);c=c==Y0?Kl:c,d=d==Y0?Kl:d;var u=c==Kl,f=d==Kl,h=c==d;if(h&&q0(t)){if(!q0(e))return!1;o=!0,u=!1}if(h&&!u)return s||(s=new Ou),o||VO(t)?UO(t,e,r,n,i,s):WO(t,e,c,r,n,i,s);if(!(r&qO)){var p=u&&K0.call(t,"__wrapped__"),g=f&&K0.call(e,"__wrapped__");if(p||g){var m=p?t.value():t,x=g?e.value():e;return s||(s=new Ou),i(m,x,r,n,s)}}return h?(s||(s=new Ou),GO(t,e,r,n,i,s)):!1}var KO=XO,ZO=KO,Z0=oi;function m1(t,e,r,n,i){return t===e?!0:t==null||e==null||!Z0(t)&&!Z0(e)?t!==t&&e!==e:ZO(t,e,r,n,m1,i)}var g1=m1,JO=Ap,QO=g1,eA=1,tA=2;function rA(t,e,r,n){var i=r.length,s=i,o=!n;if(t==null)return!s;for(t=Object(t);i--;){var l=r[i];if(o&&l[2]?l[1]!==t[l[0]]:!(l[0]in t))return!1}for(;++i<s;){l=r[i];var c=l[0],d=t[c],u=l[1];if(o&&l[2]){if(d===void 0&&!(c in t))return!1}else{var f=new JO;if(n)var h=n(d,u,c,t,e,f);if(!(h===void 0?QO(u,d,eA|tA,n,f):h))return!1}}return!0}var nA=rA,iA=Bo;function sA(t){return t===t&&!iA(t)}var v1=sA,oA=v1,aA=hl;function lA(t){for(var e=aA(t),r=e.length;r--;){var n=e[r],i=t[n];e[r]=[n,i,oA(i)]}return e}var cA=lA;function dA(t,e){return function(r){return r==null?!1:r[t]===e&&(e!==void 0||t in Object(r))}}var y1=dA,uA=nA,hA=cA,fA=y1;function pA(t){var e=hA(t);return e.length==1&&e[0][2]?fA(e[0][0],e[0][1]):function(r){return r===t||uA(r,t,e)}}var mA=pA,gA=vs,vA=oi,yA="[object Symbol]";function xA(t){return typeof t=="symbol"||vA(t)&&gA(t)==yA}var $p=xA,bA=vn,wA=$p,_A=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,SA=/^\w*$/;function kA(t,e){if(bA(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||wA(t)?!0:SA.test(t)||!_A.test(t)||e!=null&&t in Object(e)}var Lp=kA,x1=Op,jA="Expected a function";function Ip(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(jA);var r=function(){var n=arguments,i=e?e.apply(this,n):n[0],s=r.cache;if(s.has(i))return s.get(i);var o=t.apply(this,n);return r.cache=s.set(i,o)||s,o};return r.cache=new(Ip.Cache||x1),r}Ip.Cache=x1;var CA=Ip,EA=CA,TA=500;function NA(t){var e=EA(t,function(n){return r.size===TA&&r.clear(),n}),r=e.cache;return e}var RA=NA,PA=RA,OA=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,AA=/\\(\\)?/g,MA=PA(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(OA,function(r,n,i,s){e.push(i?s.replace(AA,"$1"):n||r)}),e}),$A=MA,J0=ul,LA=o1,IA=vn,DA=$p,Q0=J0?J0.prototype:void 0,ev=Q0?Q0.toString:void 0;function b1(t){if(typeof t=="string")return t;if(IA(t))return LA(t,b1)+"";if(DA(t))return ev?ev.call(t):"";var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}var zA=b1,FA=zA;function BA(t){return t==null?"":FA(t)}var HA=BA,UA=vn,WA=Lp,GA=$A,VA=HA;function qA(t,e){return UA(t)?t:WA(t,e)?[t]:GA(VA(t))}var w1=qA,YA=$p;function XA(t){if(typeof t=="string"||YA(t))return t;var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}var Rd=XA,KA=w1,ZA=Rd;function JA(t,e){e=KA(e,t);for(var r=0,n=e.length;t!=null&&r<n;)t=t[ZA(e[r++])];return r&&r==n?t:void 0}var _1=JA,QA=_1;function e4(t,e,r){var n=t==null?void 0:QA(t,e);return n===void 0?r:n}var t4=e4;function r4(t,e){return t!=null&&e in Object(t)}var n4=r4,i4=w1,s4=Zw,o4=vn,a4=Jw,l4=kp,c4=Rd;function d4(t,e,r){e=i4(e,t);for(var n=-1,i=e.length,s=!1;++n<i;){var o=c4(e[n]);if(!(s=t!=null&&r(t,o)))break;t=t[o]}return s||++n!=i?s:(i=t==null?0:t.length,!!i&&l4(i)&&a4(o,i)&&(o4(t)||s4(t)))}var u4=d4,h4=n4,f4=u4;function p4(t,e){return t!=null&&f4(t,e,h4)}var m4=p4,g4=g1,v4=t4,y4=m4,x4=Lp,b4=v1,w4=y1,_4=Rd,S4=1,k4=2;function j4(t,e){return x4(t)&&b4(e)?w4(_4(t),e):function(r){var n=v4(r,t);return n===void 0&&n===e?y4(r,t):g4(e,n,S4|k4)}}var C4=j4;function E4(t){return function(e){return e==null?void 0:e[t]}}var T4=E4,N4=_1;function R4(t){return function(e){return N4(e,t)}}var P4=R4,O4=T4,A4=P4,M4=Lp,$4=Rd;function L4(t){return M4(t)?O4($4(t)):A4(t)}var I4=L4,D4=mA,z4=C4,F4=i1,B4=vn,H4=I4;function U4(t){return typeof t=="function"?t:t==null?F4:typeof t=="object"?B4(t)?z4(t[0],t[1]):D4(t):H4(t)}var W4=U4,G4=kd;function V4(t,e){return function(r,n){if(r==null)return r;if(!G4(r))return t(r,n);for(var i=r.length,s=e?i:-1,o=Object(r);(e?s--:++s<i)&&n(o[s],s,o)!==!1;);return r}}var q4=V4,Y4=n1,X4=q4,K4=X4(Y4),Z4=K4,J4=Z4,Q4=kd;function eM(t,e){var r=-1,n=Q4(t)?Array(t.length):[];return J4(t,function(i,s,o){n[++r]=e(i,s,o)}),n}var tM=eM,rM=o1,nM=W4,iM=tM,sM=vn;function oM(t,e){var r=sM(t)?rM:iM;return r(t,nM(e))}var aM=oM;Object.defineProperty(dl,"__esModule",{value:!0});dl.flattenNames=void 0;var lM=DE,cM=Pd(lM),dM=Tp,uM=Pd(dM),hM=WN,fM=Pd(hM),pM=aM,mM=Pd(pM);function Pd(t){return t&&t.__esModule?t:{default:t}}var gM=dl.flattenNames=function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=[];return(0,mM.default)(e,function(n){Array.isArray(n)?t(n).map(function(i){return r.push(i)}):(0,fM.default)(n)?(0,uM.default)(n,function(i,s){i===!0&&r.push(s),r.push(s+"-"+i)}):(0,cM.default)(n)&&r.push(n)}),r};dl.default=gM;var fl={};function vM(t,e){for(var r=-1,n=t==null?0:t.length;++r<n&&e(t[r],r,t)!==!1;);return t}var yM=vM,xM=ys,bM=function(){try{var t=xM(Object,"defineProperty");return t({},"",{}),t}catch{}}(),wM=bM,tv=wM;function _M(t,e,r){e=="__proto__"&&tv?tv(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}var S1=_M,SM=S1,kM=Rp,jM=Object.prototype,CM=jM.hasOwnProperty;function EM(t,e,r){var n=t[e];(!(CM.call(t,e)&&kM(n,r))||r===void 0&&!(e in t))&&SM(t,e,r)}var k1=EM,TM=k1,NM=S1;function RM(t,e,r,n){var i=!r;r||(r={});for(var s=-1,o=e.length;++s<o;){var l=e[s],c=n?n(r[l],t[l],l,r,t):void 0;c===void 0&&(c=t[l]),i?NM(r,l,c):TM(r,l,c)}return r}var Od=RM,PM=Od,OM=hl;function AM(t,e){return t&&PM(e,OM(e),t)}var MM=AM;function $M(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}var LM=$M,IM=Bo,DM=Ep,zM=LM,FM=Object.prototype,BM=FM.hasOwnProperty;function HM(t){if(!IM(t))return zM(t);var e=DM(t),r=[];for(var n in t)n=="constructor"&&(e||!BM.call(t,n))||r.push(n);return r}var UM=HM,WM=e1,GM=UM,VM=kd;function qM(t){return VM(t)?WM(t,!0):GM(t)}var Dp=qM,YM=Od,XM=Dp;function KM(t,e){return t&&YM(e,XM(e),t)}var ZM=KM,Kc={exports:{}};Kc.exports;(function(t,e){var r=Ln,n=e&&!e.nodeType&&e,i=n&&!0&&t&&!t.nodeType&&t,s=i&&i.exports===n,o=s?r.Buffer:void 0,l=o?o.allocUnsafe:void 0;function c(d,u){if(u)return d.slice();var f=d.length,h=l?l(f):new d.constructor(f);return d.copy(h),h}t.exports=c})(Kc,Kc.exports);var JM=Kc.exports;function QM(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}var e6=QM,t6=Od,r6=Mp;function n6(t,e){return t6(t,r6(t),e)}var i6=n6,s6=d1,o6=Np,a6=Mp,l6=h1,c6=Object.getOwnPropertySymbols,d6=c6?function(t){for(var e=[];t;)s6(e,a6(t)),t=o6(t);return e}:l6,j1=d6,u6=Od,h6=j1;function f6(t,e){return u6(t,h6(t),e)}var p6=f6,m6=u1,g6=j1,v6=Dp;function y6(t){return m6(t,v6,g6)}var x6=y6,b6=Object.prototype,w6=b6.hasOwnProperty;function _6(t){var e=t.length,r=new t.constructor(e);return e&&typeof t[0]=="string"&&w6.call(t,"index")&&(r.index=t.index,r.input=t.input),r}var S6=_6,rv=c1;function k6(t){var e=new t.constructor(t.byteLength);return new rv(e).set(new rv(t)),e}var zp=k6,j6=zp;function C6(t,e){var r=e?j6(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}var E6=C6,T6=/\w*$/;function N6(t){var e=new t.constructor(t.source,T6.exec(t));return e.lastIndex=t.lastIndex,e}var R6=N6,nv=ul,iv=nv?nv.prototype:void 0,sv=iv?iv.valueOf:void 0;function P6(t){return sv?Object(sv.call(t)):{}}var O6=P6,A6=zp;function M6(t,e){var r=e?A6(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}var $6=M6,L6=zp,I6=E6,D6=R6,z6=O6,F6=$6,B6="[object Boolean]",H6="[object Date]",U6="[object Map]",W6="[object Number]",G6="[object RegExp]",V6="[object Set]",q6="[object String]",Y6="[object Symbol]",X6="[object ArrayBuffer]",K6="[object DataView]",Z6="[object Float32Array]",J6="[object Float64Array]",Q6="[object Int8Array]",e$="[object Int16Array]",t$="[object Int32Array]",r$="[object Uint8Array]",n$="[object Uint8ClampedArray]",i$="[object Uint16Array]",s$="[object Uint32Array]";function o$(t,e,r){var n=t.constructor;switch(e){case X6:return L6(t);case B6:case H6:return new n(+t);case K6:return I6(t,r);case Z6:case J6:case Q6:case e$:case t$:case r$:case n$:case i$:case s$:return F6(t,r);case U6:return new n;case W6:case q6:return new n(t);case G6:return D6(t);case V6:return new n;case Y6:return z6(t)}}var a$=o$,l$=Bo,ov=Object.create,c$=function(){function t(){}return function(e){if(!l$(e))return{};if(ov)return ov(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}(),d$=c$,u$=d$,h$=Np,f$=Ep;function p$(t){return typeof t.constructor=="function"&&!f$(t)?u$(h$(t)):{}}var m$=p$,g$=Nd,v$=oi,y$="[object Map]";function x$(t){return v$(t)&&g$(t)==y$}var b$=x$,w$=b$,_$=jp,av=Cp,lv=av&&av.isMap,S$=lv?_$(lv):w$,k$=S$,j$=Nd,C$=oi,E$="[object Set]";function T$(t){return C$(t)&&j$(t)==E$}var N$=T$,R$=N$,P$=jp,cv=Cp,dv=cv&&cv.isSet,O$=dv?P$(dv):R$,A$=O$,M$=Ap,$$=yM,L$=k1,I$=MM,D$=ZM,z$=JM,F$=e6,B$=i6,H$=p6,U$=f1,W$=x6,G$=Nd,V$=S6,q$=a$,Y$=m$,X$=vn,K$=Sp,Z$=k$,J$=Bo,Q$=A$,eL=hl,tL=Dp,rL=1,nL=2,iL=4,C1="[object Arguments]",sL="[object Array]",oL="[object Boolean]",aL="[object Date]",lL="[object Error]",E1="[object Function]",cL="[object GeneratorFunction]",dL="[object Map]",uL="[object Number]",T1="[object Object]",hL="[object RegExp]",fL="[object Set]",pL="[object String]",mL="[object Symbol]",gL="[object WeakMap]",vL="[object ArrayBuffer]",yL="[object DataView]",xL="[object Float32Array]",bL="[object Float64Array]",wL="[object Int8Array]",_L="[object Int16Array]",SL="[object Int32Array]",kL="[object Uint8Array]",jL="[object Uint8ClampedArray]",CL="[object Uint16Array]",EL="[object Uint32Array]",bt={};bt[C1]=bt[sL]=bt[vL]=bt[yL]=bt[oL]=bt[aL]=bt[xL]=bt[bL]=bt[wL]=bt[_L]=bt[SL]=bt[dL]=bt[uL]=bt[T1]=bt[hL]=bt[fL]=bt[pL]=bt[mL]=bt[kL]=bt[jL]=bt[CL]=bt[EL]=!0;bt[lL]=bt[E1]=bt[gL]=!1;function pc(t,e,r,n,i,s){var o,l=e&rL,c=e&nL,d=e&iL;if(r&&(o=i?r(t,n,i,s):r(t)),o!==void 0)return o;if(!J$(t))return t;var u=X$(t);if(u){if(o=V$(t),!l)return F$(t,o)}else{var f=G$(t),h=f==E1||f==cL;if(K$(t))return z$(t,l);if(f==T1||f==C1||h&&!i){if(o=c||h?{}:Y$(t),!l)return c?H$(t,D$(o,t)):B$(t,I$(o,t))}else{if(!bt[f])return i?t:{};o=q$(t,f,l)}}s||(s=new M$);var p=s.get(t);if(p)return p;s.set(t,o),Q$(t)?t.forEach(function(x){o.add(pc(x,e,r,x,t,s))}):Z$(t)&&t.forEach(function(x,v){o.set(v,pc(x,e,r,v,t,s))});var g=d?c?W$:U$:c?tL:eL,m=u?void 0:g(t);return $$(m||t,function(x,v){m&&(v=x,x=t[v]),L$(o,v,pc(x,e,r,v,t,s))}),o}var TL=pc,NL=TL,RL=1,PL=4;function OL(t){return NL(t,RL|PL)}var AL=OL;Object.defineProperty(fl,"__esModule",{value:!0});fl.mergeClasses=void 0;var ML=Tp,$L=N1(ML),LL=AL,IL=N1(LL),DL=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t};function N1(t){return t&&t.__esModule?t:{default:t}}var zL=fl.mergeClasses=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=e.default&&(0,IL.default)(e.default)||{};return r.map(function(i){var s=e[i];return s&&(0,$L.default)(s,function(o,l){n[l]||(n[l]={}),n[l]=DL({},n[l],s[l])}),i}),n};fl.default=zL;var pl={};Object.defineProperty(pl,"__esModule",{value:!0});pl.autoprefix=void 0;var FL=Tp,uv=HL(FL),BL=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t};function HL(t){return t&&t.__esModule?t:{default:t}}var UL={borderRadius:function(e){return{msBorderRadius:e,MozBorderRadius:e,OBorderRadius:e,WebkitBorderRadius:e,borderRadius:e}},boxShadow:function(e){return{msBoxShadow:e,MozBoxShadow:e,OBoxShadow:e,WebkitBoxShadow:e,boxShadow:e}},userSelect:function(e){return{WebkitTouchCallout:e,KhtmlUserSelect:e,MozUserSelect:e,msUserSelect:e,WebkitUserSelect:e,userSelect:e}},flex:function(e){return{WebkitBoxFlex:e,MozBoxFlex:e,WebkitFlex:e,msFlex:e,flex:e}},flexBasis:function(e){return{WebkitFlexBasis:e,flexBasis:e}},justifyContent:function(e){return{WebkitJustifyContent:e,justifyContent:e}},transition:function(e){return{msTransition:e,MozTransition:e,OTransition:e,WebkitTransition:e,transition:e}},transform:function(e){return{msTransform:e,MozTransform:e,OTransform:e,WebkitTransform:e,transform:e}},absolute:function(e){var r=e&&e.split(" ");return{position:"absolute",top:r&&r[0],right:r&&r[1],bottom:r&&r[2],left:r&&r[3]}},extend:function(e,r){var n=r[e];return n||{extend:e}}},WL=pl.autoprefix=function(e){var r={};return(0,uv.default)(e,function(n,i){var s={};(0,uv.default)(n,function(o,l){var c=UL[l];c?s=BL({},s,c(o)):s[l]=o}),r[i]=s}),r};pl.default=WL;var ml={};Object.defineProperty(ml,"__esModule",{value:!0});ml.hover=void 0;var GL=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},VL=P,Au=qL(VL);function qL(t){return t&&t.__esModule?t:{default:t}}function YL(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function hv(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function XL(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var KL=ml.hover=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"span";return function(n){XL(i,n);function i(){var s,o,l,c;YL(this,i);for(var d=arguments.length,u=Array(d),f=0;f<d;f++)u[f]=arguments[f];return c=(o=(l=hv(this,(s=i.__proto__||Object.getPrototypeOf(i)).call.apply(s,[this].concat(u))),l),l.state={hover:!1},l.handleMouseOver=function(){return l.setState({hover:!0})},l.handleMouseOut=function(){return l.setState({hover:!1})},l.render=function(){return Au.default.createElement(r,{onMouseOver:l.handleMouseOver,onMouseOut:l.handleMouseOut},Au.default.createElement(e,GL({},l.props,l.state)))},o),hv(l,c)}return i}(Au.default.Component)};ml.default=KL;var gl={};Object.defineProperty(gl,"__esModule",{value:!0});gl.active=void 0;var ZL=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},JL=P,Mu=QL(JL);function QL(t){return t&&t.__esModule?t:{default:t}}function eI(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function fv(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function tI(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var rI=gl.active=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"span";return function(n){tI(i,n);function i(){var s,o,l,c;eI(this,i);for(var d=arguments.length,u=Array(d),f=0;f<d;f++)u[f]=arguments[f];return c=(o=(l=fv(this,(s=i.__proto__||Object.getPrototypeOf(i)).call.apply(s,[this].concat(u))),l),l.state={active:!1},l.handleMouseDown=function(){return l.setState({active:!0})},l.handleMouseUp=function(){return l.setState({active:!1})},l.render=function(){return Mu.default.createElement(r,{onMouseDown:l.handleMouseDown,onMouseUp:l.handleMouseUp},Mu.default.createElement(e,ZL({},l.props,l.state)))},o),fv(l,c)}return i}(Mu.default.Component)};gl.default=rI;var Fp={};Object.defineProperty(Fp,"__esModule",{value:!0});var nI=function(e,r){var n={},i=function(o){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;n[o]=l};return e===0&&i("first-child"),e===r-1&&i("last-child"),(e===0||e%2===0)&&i("even"),Math.abs(e%2)===1&&i("odd"),i("nth-child",e),n};Fp.default=nI;Object.defineProperty(qr,"__esModule",{value:!0});qr.ReactCSS=qr.loop=qr.handleActive=Bp=qr.handleHover=qr.hover=void 0;var iI=dl,sI=qo(iI),oI=fl,aI=qo(oI),lI=pl,cI=qo(lI),dI=ml,R1=qo(dI),uI=gl,hI=qo(uI),fI=Fp,pI=qo(fI);function qo(t){return t&&t.__esModule?t:{default:t}}qr.hover=R1.default;var Bp=qr.handleHover=R1.default;qr.handleActive=hI.default;qr.loop=pI.default;var mI=qr.ReactCSS=function(e){for(var r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];var s=(0,sI.default)(n),o=(0,aI.default)(e,s);return(0,cI.default)(o)},Qe=qr.default=mI,gI=function(e,r,n,i,s){var o=s.clientWidth,l=s.clientHeight,c=typeof e.pageX=="number"?e.pageX:e.touches[0].pageX,d=typeof e.pageY=="number"?e.pageY:e.touches[0].pageY,u=c-(s.getBoundingClientRect().left+window.pageXOffset),f=d-(s.getBoundingClientRect().top+window.pageYOffset);if(n==="vertical"){var h=void 0;if(f<0?h=0:f>l?h=1:h=Math.round(f*100/l)/100,r.a!==h)return{h:r.h,s:r.s,l:r.l,a:h,source:"rgb"}}else{var p=void 0;if(u<0?p=0:u>o?p=1:p=Math.round(u*100/o)/100,i!==p)return{h:r.h,s:r.s,l:r.l,a:p,source:"rgb"}}return null},$u={},vI=function(e,r,n,i){if(typeof document>"u"&&!i)return null;var s=i?new i:document.createElement("canvas");s.width=n*2,s.height=n*2;var o=s.getContext("2d");return o?(o.fillStyle=e,o.fillRect(0,0,s.width,s.height),o.fillStyle=r,o.fillRect(0,0,n,n),o.translate(n,n),o.fillRect(0,0,n,n),s.toDataURL()):null},yI=function(e,r,n,i){var s=e+"-"+r+"-"+n+(i?"-server":"");if($u[s])return $u[s];var o=vI(e,r,n,i);return $u[s]=o,o},pv=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Yo=function(e){var r=e.white,n=e.grey,i=e.size,s=e.renderers,o=e.borderRadius,l=e.boxShadow,c=e.children,d=Qe({default:{grid:{borderRadius:o,boxShadow:l,absolute:"0px 0px 0px 0px",background:"url("+yI(r,n,i,s.canvas)+") center left"}}});return P.isValidElement(c)?$.cloneElement(c,pv({},c.props,{style:pv({},c.props.style,d.grid)})):$.createElement("div",{style:d.grid})};Yo.defaultProps={size:8,white:"transparent",grey:"rgba(0,0,0,.08)",renderers:{}};var xI=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},bI=function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();function wI(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function mv(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function _I(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var Hp=function(t){_I(e,t);function e(){var r,n,i,s;wI(this,e);for(var o=arguments.length,l=Array(o),c=0;c<o;c++)l[c]=arguments[c];return s=(n=(i=mv(this,(r=e.__proto__||Object.getPrototypeOf(e)).call.apply(r,[this].concat(l))),i),i.handleChange=function(d){var u=gI(d,i.props.hsl,i.props.direction,i.props.a,i.container);u&&typeof i.props.onChange=="function"&&i.props.onChange(u,d)},i.handleMouseDown=function(d){i.handleChange(d),window.addEventListener("mousemove",i.handleChange),window.addEventListener("mouseup",i.handleMouseUp)},i.handleMouseUp=function(){i.unbindEventListeners()},i.unbindEventListeners=function(){window.removeEventListener("mousemove",i.handleChange),window.removeEventListener("mouseup",i.handleMouseUp)},n),mv(i,s)}return bI(e,[{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"render",value:function(){var n=this,i=this.props.rgb,s=Qe({default:{alpha:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius},checkboard:{absolute:"0px 0px 0px 0px",overflow:"hidden",borderRadius:this.props.radius},gradient:{absolute:"0px 0px 0px 0px",background:"linear-gradient(to right, rgba("+i.r+","+i.g+","+i.b+`, 0) 0%,
           rgba(`+i.r+","+i.g+","+i.b+", 1) 100%)",boxShadow:this.props.shadow,borderRadius:this.props.radius},container:{position:"relative",height:"100%",margin:"0 3px"},pointer:{position:"absolute",left:i.a*100+"%"},slider:{width:"4px",borderRadius:"1px",height:"8px",boxShadow:"0 0 2px rgba(0, 0, 0, .6)",background:"#fff",marginTop:"1px",transform:"translateX(-2px)"}},vertical:{gradient:{background:"linear-gradient(to bottom, rgba("+i.r+","+i.g+","+i.b+`, 0) 0%,
           rgba(`+i.r+","+i.g+","+i.b+", 1) 100%)"},pointer:{left:0,top:i.a*100+"%"}},overwrite:xI({},this.props.style)},{vertical:this.props.direction==="vertical",overwrite:!0});return $.createElement("div",{style:s.alpha},$.createElement("div",{style:s.checkboard},$.createElement(Yo,{renderers:this.props.renderers})),$.createElement("div",{style:s.gradient}),$.createElement("div",{style:s.container,ref:function(l){return n.container=l},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},$.createElement("div",{style:s.pointer},this.props.pointer?$.createElement(this.props.pointer,this.props):$.createElement("div",{style:s.slider}))))}}]),e}(P.PureComponent||P.Component),SI=function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();function kI(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jI(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function CI(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function EI(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var TI=1,P1=38,NI=40,RI=[P1,NI],PI=function(e){return RI.indexOf(e)>-1},OI=function(e){return Number(String(e).replace(/%/g,""))},AI=1,lt=function(t){EI(e,t);function e(r){jI(this,e);var n=CI(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.handleBlur=function(){n.state.blurValue&&n.setState({value:n.state.blurValue,blurValue:null})},n.handleChange=function(i){n.setUpdatedValue(i.target.value,i)},n.handleKeyDown=function(i){var s=OI(i.target.value);if(!isNaN(s)&&PI(i.keyCode)){var o=n.getArrowOffset(),l=i.keyCode===P1?s+o:s-o;n.setUpdatedValue(l,i)}},n.handleDrag=function(i){if(n.props.dragLabel){var s=Math.round(n.props.value+i.movementX);s>=0&&s<=n.props.dragMax&&n.props.onChange&&n.props.onChange(n.getValueObjectWithLabel(s),i)}},n.handleMouseDown=function(i){n.props.dragLabel&&(i.preventDefault(),n.handleDrag(i),window.addEventListener("mousemove",n.handleDrag),window.addEventListener("mouseup",n.handleMouseUp))},n.handleMouseUp=function(){n.unbindEventListeners()},n.unbindEventListeners=function(){window.removeEventListener("mousemove",n.handleDrag),window.removeEventListener("mouseup",n.handleMouseUp)},n.state={value:String(r.value).toUpperCase(),blurValue:String(r.value).toUpperCase()},n.inputId="rc-editable-input-"+AI++,n}return SI(e,[{key:"componentDidUpdate",value:function(n,i){this.props.value!==this.state.value&&(n.value!==this.props.value||i.value!==this.state.value)&&(this.input===document.activeElement?this.setState({blurValue:String(this.props.value).toUpperCase()}):this.setState({value:String(this.props.value).toUpperCase(),blurValue:!this.state.blurValue&&String(this.props.value).toUpperCase()}))}},{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"getValueObjectWithLabel",value:function(n){return kI({},this.props.label,n)}},{key:"getArrowOffset",value:function(){return this.props.arrowOffset||TI}},{key:"setUpdatedValue",value:function(n,i){var s=this.props.label?this.getValueObjectWithLabel(n):n;this.props.onChange&&this.props.onChange(s,i),this.setState({value:n})}},{key:"render",value:function(){var n=this,i=Qe({default:{wrap:{position:"relative"}},"user-override":{wrap:this.props.style&&this.props.style.wrap?this.props.style.wrap:{},input:this.props.style&&this.props.style.input?this.props.style.input:{},label:this.props.style&&this.props.style.label?this.props.style.label:{}},"dragLabel-true":{label:{cursor:"ew-resize"}}},{"user-override":!0},this.props);return $.createElement("div",{style:i.wrap},$.createElement("input",{id:this.inputId,style:i.input,ref:function(o){return n.input=o},value:this.state.value,onKeyDown:this.handleKeyDown,onChange:this.handleChange,onBlur:this.handleBlur,placeholder:this.props.placeholder,spellCheck:"false"}),this.props.label&&!this.props.hideLabel?$.createElement("label",{htmlFor:this.inputId,style:i.label,onMouseDown:this.handleMouseDown},this.props.label):null)}}]),e}(P.PureComponent||P.Component),MI=function(e,r,n,i){var s=i.clientWidth,o=i.clientHeight,l=typeof e.pageX=="number"?e.pageX:e.touches[0].pageX,c=typeof e.pageY=="number"?e.pageY:e.touches[0].pageY,d=l-(i.getBoundingClientRect().left+window.pageXOffset),u=c-(i.getBoundingClientRect().top+window.pageYOffset);if(r==="vertical"){var f=void 0;if(u<0)f=359;else if(u>o)f=0;else{var h=-(u*100/o)+100;f=360*h/100}if(n.h!==f)return{h:f,s:n.s,l:n.l,a:n.a,source:"hsl"}}else{var p=void 0;if(d<0)p=0;else if(d>s)p=359;else{var g=d*100/s;p=360*g/100}if(n.h!==p)return{h:p,s:n.s,l:n.l,a:n.a,source:"hsl"}}return null},$I=function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();function LI(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function gv(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function II(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var Xo=function(t){II(e,t);function e(){var r,n,i,s;LI(this,e);for(var o=arguments.length,l=Array(o),c=0;c<o;c++)l[c]=arguments[c];return s=(n=(i=gv(this,(r=e.__proto__||Object.getPrototypeOf(e)).call.apply(r,[this].concat(l))),i),i.handleChange=function(d){var u=MI(d,i.props.direction,i.props.hsl,i.container);u&&typeof i.props.onChange=="function"&&i.props.onChange(u,d)},i.handleMouseDown=function(d){i.handleChange(d),window.addEventListener("mousemove",i.handleChange),window.addEventListener("mouseup",i.handleMouseUp)},i.handleMouseUp=function(){i.unbindEventListeners()},n),gv(i,s)}return $I(e,[{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"unbindEventListeners",value:function(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}},{key:"render",value:function(){var n=this,i=this.props.direction,s=i===void 0?"horizontal":i,o=Qe({default:{hue:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius,boxShadow:this.props.shadow},container:{padding:"0 2px",position:"relative",height:"100%",borderRadius:this.props.radius},pointer:{position:"absolute",left:this.props.hsl.h*100/360+"%"},slider:{marginTop:"1px",width:"4px",borderRadius:"1px",height:"8px",boxShadow:"0 0 2px rgba(0, 0, 0, .6)",background:"#fff",transform:"translateX(-2px)"}},vertical:{pointer:{left:"0px",top:-(this.props.hsl.h*100/360)+100+"%"}}},{vertical:s==="vertical"});return $.createElement("div",{style:o.hue},$.createElement("div",{className:"hue-"+s,style:o.container,ref:function(c){return n.container=c},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},$.createElement("style",null,`
            .hue-horizontal {
              background: linear-gradient(to right, #f00 0%, #ff0 17%, #0f0
                33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
              background: -webkit-linear-gradient(to right, #f00 0%, #ff0
                17%, #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
            }

            .hue-vertical {
              background: linear-gradient(to top, #f00 0%, #ff0 17%, #0f0 33%,
                #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
              background: -webkit-linear-gradient(to top, #f00 0%, #ff0 17%,
                #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
            }
          `),$.createElement("div",{style:o.pointer},this.props.pointer?$.createElement(this.props.pointer,this.props):$.createElement("div",{style:o.slider}))))}}]),e}(P.PureComponent||P.Component),O1={exports:{}},DI="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",zI=DI,FI=zI;function A1(){}function M1(){}M1.resetWarningCache=A1;var BI=function(){function t(n,i,s,o,l,c){if(c!==FI){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}t.isRequired=t;function e(){return t}var r={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:M1,resetWarningCache:A1};return r.PropTypes=r,r};O1.exports=BI();var HI=O1.exports;const Te=id(HI);function UI(){this.__data__=[],this.size=0}function vl(t,e){return t===e||t!==t&&e!==e}function Ad(t,e){for(var r=t.length;r--;)if(vl(t[r][0],e))return r;return-1}var WI=Array.prototype,GI=WI.splice;function VI(t){var e=this.__data__,r=Ad(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():GI.call(e,r,1),--this.size,!0}function qI(t){var e=this.__data__,r=Ad(e,t);return r<0?void 0:e[r][1]}function YI(t){return Ad(this.__data__,t)>-1}function XI(t,e){var r=this.__data__,n=Ad(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}function ai(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}ai.prototype.clear=UI;ai.prototype.delete=VI;ai.prototype.get=qI;ai.prototype.has=YI;ai.prototype.set=XI;function KI(){this.__data__=new ai,this.size=0}function ZI(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}function JI(t){return this.__data__.get(t)}function QI(t){return this.__data__.has(t)}var $1=typeof global=="object"&&global&&global.Object===Object&&global,e8=typeof self=="object"&&self&&self.Object===Object&&self,yn=$1||e8||Function("return this")(),Li=yn.Symbol,L1=Object.prototype,t8=L1.hasOwnProperty,r8=L1.toString,la=Li?Li.toStringTag:void 0;function n8(t){var e=t8.call(t,la),r=t[la];try{t[la]=void 0;var n=!0}catch{}var i=r8.call(t);return n&&(e?t[la]=r:delete t[la]),i}var i8=Object.prototype,s8=i8.toString;function o8(t){return s8.call(t)}var a8="[object Null]",l8="[object Undefined]",vv=Li?Li.toStringTag:void 0;function xs(t){return t==null?t===void 0?l8:a8:vv&&vv in Object(t)?n8(t):o8(t)}function Jr(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var c8="[object AsyncFunction]",d8="[object Function]",u8="[object GeneratorFunction]",h8="[object Proxy]";function Up(t){if(!Jr(t))return!1;var e=xs(t);return e==d8||e==u8||e==c8||e==h8}var Lu=yn["__core-js_shared__"],yv=function(){var t=/[^.]+$/.exec(Lu&&Lu.keys&&Lu.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function f8(t){return!!yv&&yv in t}var p8=Function.prototype,m8=p8.toString;function bs(t){if(t!=null){try{return m8.call(t)}catch{}try{return t+""}catch{}}return""}var g8=/[\\^$.*+?()[\]{}|]/g,v8=/^\[object .+?Constructor\]$/,y8=Function.prototype,x8=Object.prototype,b8=y8.toString,w8=x8.hasOwnProperty,_8=RegExp("^"+b8.call(w8).replace(g8,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function S8(t){if(!Jr(t)||f8(t))return!1;var e=Up(t)?_8:v8;return e.test(bs(t))}function k8(t,e){return t==null?void 0:t[e]}function ws(t,e){var r=k8(t,e);return S8(r)?r:void 0}var tl=ws(yn,"Map"),rl=ws(Object,"create");function j8(){this.__data__=rl?rl(null):{},this.size=0}function C8(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var E8="__lodash_hash_undefined__",T8=Object.prototype,N8=T8.hasOwnProperty;function R8(t){var e=this.__data__;if(rl){var r=e[t];return r===E8?void 0:r}return N8.call(e,t)?e[t]:void 0}var P8=Object.prototype,O8=P8.hasOwnProperty;function A8(t){var e=this.__data__;return rl?e[t]!==void 0:O8.call(e,t)}var M8="__lodash_hash_undefined__";function $8(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=rl&&e===void 0?M8:e,this}function ps(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}ps.prototype.clear=j8;ps.prototype.delete=C8;ps.prototype.get=R8;ps.prototype.has=A8;ps.prototype.set=$8;function L8(){this.size=0,this.__data__={hash:new ps,map:new(tl||ai),string:new ps}}function I8(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function Md(t,e){var r=t.__data__;return I8(e)?r[typeof e=="string"?"string":"hash"]:r.map}function D8(t){var e=Md(this,t).delete(t);return this.size-=e?1:0,e}function z8(t){return Md(this,t).get(t)}function F8(t){return Md(this,t).has(t)}function B8(t,e){var r=Md(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}function li(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}li.prototype.clear=L8;li.prototype.delete=D8;li.prototype.get=z8;li.prototype.has=F8;li.prototype.set=B8;var H8=200;function U8(t,e){var r=this.__data__;if(r instanceof ai){var n=r.__data__;if(!tl||n.length<H8-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new li(n)}return r.set(t,e),this.size=r.size,this}function $n(t){var e=this.__data__=new ai(t);this.size=e.size}$n.prototype.clear=KI;$n.prototype.delete=ZI;$n.prototype.get=JI;$n.prototype.has=QI;$n.prototype.set=U8;var Zc=function(){try{var t=ws(Object,"defineProperty");return t({},"",{}),t}catch{}}();function Wp(t,e,r){e=="__proto__"&&Zc?Zc(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}function sf(t,e,r){(r!==void 0&&!vl(t[e],r)||r===void 0&&!(e in t))&&Wp(t,e,r)}function W8(t){return function(e,r,n){for(var i=-1,s=Object(e),o=n(e),l=o.length;l--;){var c=o[++i];if(r(s[c],c,s)===!1)break}return e}}var I1=W8(),D1=typeof Mr=="object"&&Mr&&!Mr.nodeType&&Mr,xv=D1&&typeof $r=="object"&&$r&&!$r.nodeType&&$r,G8=xv&&xv.exports===D1,bv=G8?yn.Buffer:void 0;bv&&bv.allocUnsafe;function V8(t,e){return t.slice()}var Jc=yn.Uint8Array;function q8(t){var e=new t.constructor(t.byteLength);return new Jc(e).set(new Jc(t)),e}function Y8(t,e){var r=q8(t.buffer);return new t.constructor(r,t.byteOffset,t.length)}function X8(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}var wv=Object.create,K8=function(){function t(){}return function(e){if(!Jr(e))return{};if(wv)return wv(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}();function z1(t,e){return function(r){return t(e(r))}}var F1=z1(Object.getPrototypeOf,Object),Z8=Object.prototype;function Gp(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||Z8;return t===r}function J8(t){return typeof t.constructor=="function"&&!Gp(t)?K8(F1(t)):{}}function Ii(t){return t!=null&&typeof t=="object"}var Q8="[object Arguments]";function _v(t){return Ii(t)&&xs(t)==Q8}var B1=Object.prototype,eD=B1.hasOwnProperty,tD=B1.propertyIsEnumerable,Qc=_v(function(){return arguments}())?_v:function(t){return Ii(t)&&eD.call(t,"callee")&&!tD.call(t,"callee")},Dr=Array.isArray,rD=9007199254740991;function Vp(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=rD}function Ko(t){return t!=null&&Vp(t.length)&&!Up(t)}function nD(t){return Ii(t)&&Ko(t)}function iD(){return!1}var H1=typeof Mr=="object"&&Mr&&!Mr.nodeType&&Mr,Sv=H1&&typeof $r=="object"&&$r&&!$r.nodeType&&$r,sD=Sv&&Sv.exports===H1,kv=sD?yn.Buffer:void 0,oD=kv?kv.isBuffer:void 0,ed=oD||iD,aD="[object Object]",lD=Function.prototype,cD=Object.prototype,U1=lD.toString,dD=cD.hasOwnProperty,uD=U1.call(Object);function hD(t){if(!Ii(t)||xs(t)!=aD)return!1;var e=F1(t);if(e===null)return!0;var r=dD.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&U1.call(r)==uD}var fD="[object Arguments]",pD="[object Array]",mD="[object Boolean]",gD="[object Date]",vD="[object Error]",yD="[object Function]",xD="[object Map]",bD="[object Number]",wD="[object Object]",_D="[object RegExp]",SD="[object Set]",kD="[object String]",jD="[object WeakMap]",CD="[object ArrayBuffer]",ED="[object DataView]",TD="[object Float32Array]",ND="[object Float64Array]",RD="[object Int8Array]",PD="[object Int16Array]",OD="[object Int32Array]",AD="[object Uint8Array]",MD="[object Uint8ClampedArray]",$D="[object Uint16Array]",LD="[object Uint32Array]",jt={};jt[TD]=jt[ND]=jt[RD]=jt[PD]=jt[OD]=jt[AD]=jt[MD]=jt[$D]=jt[LD]=!0;jt[fD]=jt[pD]=jt[CD]=jt[mD]=jt[ED]=jt[gD]=jt[vD]=jt[yD]=jt[xD]=jt[bD]=jt[wD]=jt[_D]=jt[SD]=jt[kD]=jt[jD]=!1;function ID(t){return Ii(t)&&Vp(t.length)&&!!jt[xs(t)]}function DD(t){return function(e){return t(e)}}var W1=typeof Mr=="object"&&Mr&&!Mr.nodeType&&Mr,Aa=W1&&typeof $r=="object"&&$r&&!$r.nodeType&&$r,zD=Aa&&Aa.exports===W1,Iu=zD&&$1.process,jv=function(){try{var t=Aa&&Aa.require&&Aa.require("util").types;return t||Iu&&Iu.binding&&Iu.binding("util")}catch{}}(),Cv=jv&&jv.isTypedArray,qp=Cv?DD(Cv):ID;function of(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}var FD=Object.prototype,BD=FD.hasOwnProperty;function HD(t,e,r){var n=t[e];(!(BD.call(t,e)&&vl(n,r))||r===void 0&&!(e in t))&&Wp(t,e,r)}function UD(t,e,r,n){var i=!r;r||(r={});for(var s=-1,o=e.length;++s<o;){var l=e[s],c=void 0;c===void 0&&(c=t[l]),i?Wp(r,l,c):HD(r,l,c)}return r}function WD(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}var GD=9007199254740991,VD=/^(?:0|[1-9]\d*)$/;function Yp(t,e){var r=typeof t;return e=e??GD,!!e&&(r=="number"||r!="symbol"&&VD.test(t))&&t>-1&&t%1==0&&t<e}var qD=Object.prototype,YD=qD.hasOwnProperty;function G1(t,e){var r=Dr(t),n=!r&&Qc(t),i=!r&&!n&&ed(t),s=!r&&!n&&!i&&qp(t),o=r||n||i||s,l=o?WD(t.length,String):[],c=l.length;for(var d in t)(e||YD.call(t,d))&&!(o&&(d=="length"||i&&(d=="offset"||d=="parent")||s&&(d=="buffer"||d=="byteLength"||d=="byteOffset")||Yp(d,c)))&&l.push(d);return l}function XD(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}var KD=Object.prototype,ZD=KD.hasOwnProperty;function JD(t){if(!Jr(t))return XD(t);var e=Gp(t),r=[];for(var n in t)n=="constructor"&&(e||!ZD.call(t,n))||r.push(n);return r}function V1(t){return Ko(t)?G1(t,!0):JD(t)}function QD(t){return UD(t,V1(t))}function ez(t,e,r,n,i,s,o){var l=of(t,r),c=of(e,r),d=o.get(c);if(d){sf(t,r,d);return}var u=s?s(l,c,r+"",t,e,o):void 0,f=u===void 0;if(f){var h=Dr(c),p=!h&&ed(c),g=!h&&!p&&qp(c);u=c,h||p||g?Dr(l)?u=l:nD(l)?u=X8(l):p?(f=!1,u=V8(c)):g?(f=!1,u=Y8(c)):u=[]:hD(c)||Qc(c)?(u=l,Qc(l)?u=QD(l):(!Jr(l)||Up(l))&&(u=J8(c))):f=!1}f&&(o.set(c,u),i(u,c,n,s,o),o.delete(c)),sf(t,r,u)}function q1(t,e,r,n,i){t!==e&&I1(e,function(s,o){if(i||(i=new $n),Jr(s))ez(t,e,o,r,q1,n,i);else{var l=n?n(of(t,o),s,o+"",t,e,i):void 0;l===void 0&&(l=s),sf(t,o,l)}},V1)}function $d(t){return t}function tz(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}var Ev=Math.max;function rz(t,e,r){return e=Ev(e===void 0?t.length-1:e,0),function(){for(var n=arguments,i=-1,s=Ev(n.length-e,0),o=Array(s);++i<s;)o[i]=n[e+i];i=-1;for(var l=Array(e+1);++i<e;)l[i]=n[i];return l[e]=r(o),tz(t,this,l)}}function nz(t){return function(){return t}}var iz=Zc?function(t,e){return Zc(t,"toString",{configurable:!0,enumerable:!1,value:nz(e),writable:!0})}:$d,sz=800,oz=16,az=Date.now;function lz(t){var e=0,r=0;return function(){var n=az(),i=oz-(n-r);if(r=n,i>0){if(++e>=sz)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var cz=lz(iz);function dz(t,e){return cz(rz(t,e,$d),t+"")}function uz(t,e,r){if(!Jr(r))return!1;var n=typeof e;return(n=="number"?Ko(r)&&Yp(e,r.length):n=="string"&&e in r)?vl(r[e],t):!1}function hz(t){return dz(function(e,r){var n=-1,i=r.length,s=i>1?r[i-1]:void 0,o=i>2?r[2]:void 0;for(s=t.length>3&&typeof s=="function"?(i--,s):void 0,o&&uz(r[0],r[1],o)&&(s=i<3?void 0:s,i=1),e=Object(e);++n<i;){var l=r[n];l&&t(e,l,n,s)}return e})}var kr=hz(function(t,e,r){q1(t,e,r)}),yl=function(e){var r=e.zDepth,n=e.radius,i=e.background,s=e.children,o=e.styles,l=o===void 0?{}:o,c=Qe(kr({default:{wrap:{position:"relative",display:"inline-block"},content:{position:"relative"},bg:{absolute:"0px 0px 0px 0px",boxShadow:"0 "+r+"px "+r*4+"px rgba(0,0,0,.24)",borderRadius:n,background:i}},"zDepth-0":{bg:{boxShadow:"none"}},"zDepth-1":{bg:{boxShadow:"0 2px 10px rgba(0,0,0,.12), 0 2px 5px rgba(0,0,0,.16)"}},"zDepth-2":{bg:{boxShadow:"0 6px 20px rgba(0,0,0,.19), 0 8px 17px rgba(0,0,0,.2)"}},"zDepth-3":{bg:{boxShadow:"0 17px 50px rgba(0,0,0,.19), 0 12px 15px rgba(0,0,0,.24)"}},"zDepth-4":{bg:{boxShadow:"0 25px 55px rgba(0,0,0,.21), 0 16px 28px rgba(0,0,0,.22)"}},"zDepth-5":{bg:{boxShadow:"0 40px 77px rgba(0,0,0,.22), 0 27px 24px rgba(0,0,0,.2)"}},square:{bg:{borderRadius:"0"}},circle:{bg:{borderRadius:"50%"}}},l),{"zDepth-1":r===1});return $.createElement("div",{style:c.wrap},$.createElement("div",{style:c.bg}),$.createElement("div",{style:c.content},s))};yl.propTypes={background:Te.string,zDepth:Te.oneOf([0,1,2,3,4,5]),radius:Te.number,styles:Te.object};yl.defaultProps={background:"#fff",zDepth:1,radius:2,styles:{}};var Du=function(){return yn.Date.now()},fz=/\s/;function pz(t){for(var e=t.length;e--&&fz.test(t.charAt(e)););return e}var mz=/^\s+/;function gz(t){return t&&t.slice(0,pz(t)+1).replace(mz,"")}var vz="[object Symbol]";function Ld(t){return typeof t=="symbol"||Ii(t)&&xs(t)==vz}var Tv=NaN,yz=/^[-+]0x[0-9a-f]+$/i,xz=/^0b[01]+$/i,bz=/^0o[0-7]+$/i,wz=parseInt;function Nv(t){if(typeof t=="number")return t;if(Ld(t))return Tv;if(Jr(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=Jr(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=gz(t);var r=xz.test(t);return r||bz.test(t)?wz(t.slice(2),r?2:8):yz.test(t)?Tv:+t}var _z="Expected a function",Sz=Math.max,kz=Math.min;function Y1(t,e,r){var n,i,s,o,l,c,d=0,u=!1,f=!1,h=!0;if(typeof t!="function")throw new TypeError(_z);e=Nv(e)||0,Jr(r)&&(u=!!r.leading,f="maxWait"in r,s=f?Sz(Nv(r.maxWait)||0,e):s,h="trailing"in r?!!r.trailing:h);function p(_){var C=n,N=i;return n=i=void 0,d=_,o=t.apply(N,C),o}function g(_){return d=_,l=setTimeout(v,e),u?p(_):o}function m(_){var C=_-c,N=_-d,T=e-C;return f?kz(T,s-N):T}function x(_){var C=_-c,N=_-d;return c===void 0||C>=e||C<0||f&&N>=s}function v(){var _=Du();if(x(_))return y(_);l=setTimeout(v,m(_))}function y(_){return l=void 0,h&&n?p(_):(n=i=void 0,o)}function b(){l!==void 0&&clearTimeout(l),d=0,n=c=i=l=void 0}function w(){return l===void 0?o:y(Du())}function k(){var _=Du(),C=x(_);if(n=arguments,i=this,c=_,C){if(l===void 0)return g(c);if(f)return clearTimeout(l),l=setTimeout(v,e),p(c)}return l===void 0&&(l=setTimeout(v,e)),o}return k.cancel=b,k.flush=w,k}var jz="Expected a function";function Cz(t,e,r){var n=!0,i=!0;if(typeof t!="function")throw new TypeError(jz);return Jr(r)&&(n="leading"in r?!!r.leading:n,i="trailing"in r?!!r.trailing:i),Y1(t,e,{leading:n,maxWait:e,trailing:i})}var Ez=function(e,r,n){var i=n.getBoundingClientRect(),s=i.width,o=i.height,l=typeof e.pageX=="number"?e.pageX:e.touches[0].pageX,c=typeof e.pageY=="number"?e.pageY:e.touches[0].pageY,d=l-(n.getBoundingClientRect().left+window.pageXOffset),u=c-(n.getBoundingClientRect().top+window.pageYOffset);d<0?d=0:d>s&&(d=s),u<0?u=0:u>o&&(u=o);var f=d/s,h=1-u/o;return{h:r.h,s:f,v:h,a:r.a,source:"hsv"}},Tz=function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();function Nz(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Rz(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function Pz(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var Id=function(t){Pz(e,t);function e(r){Nz(this,e);var n=Rz(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,r));return n.handleChange=function(i){typeof n.props.onChange=="function"&&n.throttle(n.props.onChange,Ez(i,n.props.hsl,n.container),i)},n.handleMouseDown=function(i){n.handleChange(i);var s=n.getContainerRenderWindow();s.addEventListener("mousemove",n.handleChange),s.addEventListener("mouseup",n.handleMouseUp)},n.handleMouseUp=function(){n.unbindEventListeners()},n.throttle=Cz(function(i,s,o){i(s,o)},50),n}return Tz(e,[{key:"componentWillUnmount",value:function(){this.throttle.cancel(),this.unbindEventListeners()}},{key:"getContainerRenderWindow",value:function(){for(var n=this.container,i=window;!i.document.contains(n)&&i.parent!==i;)i=i.parent;return i}},{key:"unbindEventListeners",value:function(){var n=this.getContainerRenderWindow();n.removeEventListener("mousemove",this.handleChange),n.removeEventListener("mouseup",this.handleMouseUp)}},{key:"render",value:function(){var n=this,i=this.props.style||{},s=i.color,o=i.white,l=i.black,c=i.pointer,d=i.circle,u=Qe({default:{color:{absolute:"0px 0px 0px 0px",background:"hsl("+this.props.hsl.h+",100%, 50%)",borderRadius:this.props.radius},white:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius},black:{absolute:"0px 0px 0px 0px",boxShadow:this.props.shadow,borderRadius:this.props.radius},pointer:{position:"absolute",top:-(this.props.hsv.v*100)+100+"%",left:this.props.hsv.s*100+"%",cursor:"default"},circle:{width:"4px",height:"4px",boxShadow:`0 0 0 1.5px #fff, inset 0 0 1px 1px rgba(0,0,0,.3),
            0 0 1px 2px rgba(0,0,0,.4)`,borderRadius:"50%",cursor:"hand",transform:"translate(-2px, -2px)"}},custom:{color:s,white:o,black:l,pointer:c,circle:d}},{custom:!!this.props.style});return $.createElement("div",{style:u.color,ref:function(h){return n.container=h},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},$.createElement("style",null,`
          .saturation-white {
            background: -webkit-linear-gradient(to right, #fff, rgba(255,255,255,0));
            background: linear-gradient(to right, #fff, rgba(255,255,255,0));
          }
          .saturation-black {
            background: -webkit-linear-gradient(to top, #000, rgba(0,0,0,0));
            background: linear-gradient(to top, #000, rgba(0,0,0,0));
          }
        `),$.createElement("div",{style:u.white,className:"saturation-white"},$.createElement("div",{style:u.black,className:"saturation-black"}),$.createElement("div",{style:u.pointer},this.props.pointer?$.createElement(this.props.pointer,this.props):$.createElement("div",{style:u.circle}))))}}]),e}(P.PureComponent||P.Component);function Oz(t,e){for(var r=-1,n=t==null?0:t.length;++r<n&&e(t[r],r,t)!==!1;);return t}var Az=z1(Object.keys,Object),Mz=Object.prototype,$z=Mz.hasOwnProperty;function Lz(t){if(!Gp(t))return Az(t);var e=[];for(var r in Object(t))$z.call(t,r)&&r!="constructor"&&e.push(r);return e}function Xp(t){return Ko(t)?G1(t):Lz(t)}function Iz(t,e){return t&&I1(t,e,Xp)}function Dz(t,e){return function(r,n){if(r==null)return r;if(!Ko(r))return t(r,n);for(var i=r.length,s=-1,o=Object(r);++s<i&&n(o[s],s,o)!==!1;);return r}}var X1=Dz(Iz);function zz(t){return typeof t=="function"?t:$d}function Fz(t,e){var r=Dr(t)?Oz:X1;return r(t,zz(e))}function td(t){"@babel/helpers - typeof";return td=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},td(t)}var Bz=/^\s+/,Hz=/\s+$/;function Fe(t,e){if(t=t||"",e=e||{},t instanceof Fe)return t;if(!(this instanceof Fe))return new Fe(t,e);var r=Uz(t);this._originalInput=t,this._r=r.r,this._g=r.g,this._b=r.b,this._a=r.a,this._roundA=Math.round(100*this._a)/100,this._format=e.format||r.format,this._gradientType=e.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=r.ok}Fe.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},getLuminance:function(){var e=this.toRgb(),r,n,i,s,o,l;return r=e.r/255,n=e.g/255,i=e.b/255,r<=.03928?s=r/12.92:s=Math.pow((r+.055)/1.055,2.4),n<=.03928?o=n/12.92:o=Math.pow((n+.055)/1.055,2.4),i<=.03928?l=i/12.92:l=Math.pow((i+.055)/1.055,2.4),.2126*s+.7152*o+.0722*l},setAlpha:function(e){return this._a=K1(e),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var e=Pv(this._r,this._g,this._b);return{h:e.h*360,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=Pv(this._r,this._g,this._b),r=Math.round(e.h*360),n=Math.round(e.s*100),i=Math.round(e.v*100);return this._a==1?"hsv("+r+", "+n+"%, "+i+"%)":"hsva("+r+", "+n+"%, "+i+"%, "+this._roundA+")"},toHsl:function(){var e=Rv(this._r,this._g,this._b);return{h:e.h*360,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=Rv(this._r,this._g,this._b),r=Math.round(e.h*360),n=Math.round(e.s*100),i=Math.round(e.l*100);return this._a==1?"hsl("+r+", "+n+"%, "+i+"%)":"hsla("+r+", "+n+"%, "+i+"%, "+this._roundA+")"},toHex:function(e){return Ov(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return qz(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(Et(this._r,255)*100)+"%",g:Math.round(Et(this._g,255)*100)+"%",b:Math.round(Et(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(Et(this._r,255)*100)+"%, "+Math.round(Et(this._g,255)*100)+"%, "+Math.round(Et(this._b,255)*100)+"%)":"rgba("+Math.round(Et(this._r,255)*100)+"%, "+Math.round(Et(this._g,255)*100)+"%, "+Math.round(Et(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:sF[Ov(this._r,this._g,this._b,!0)]||!1},toFilter:function(e){var r="#"+Av(this._r,this._g,this._b,this._a),n=r,i=this._gradientType?"GradientType = 1, ":"";if(e){var s=Fe(e);n="#"+Av(s._r,s._g,s._b,s._a)}return"progid:DXImageTransform.Microsoft.gradient("+i+"startColorstr="+r+",endColorstr="+n+")"},toString:function(e){var r=!!e;e=e||this._format;var n=!1,i=this._a<1&&this._a>=0,s=!r&&i&&(e==="hex"||e==="hex6"||e==="hex3"||e==="hex4"||e==="hex8"||e==="name");return s?e==="name"&&this._a===0?this.toName():this.toRgbString():(e==="rgb"&&(n=this.toRgbString()),e==="prgb"&&(n=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(n=this.toHexString()),e==="hex3"&&(n=this.toHexString(!0)),e==="hex4"&&(n=this.toHex8String(!0)),e==="hex8"&&(n=this.toHex8String()),e==="name"&&(n=this.toName()),e==="hsl"&&(n=this.toHslString()),e==="hsv"&&(n=this.toHsvString()),n||this.toHexString())},clone:function(){return Fe(this.toString())},_applyModification:function(e,r){var n=e.apply(null,[this].concat([].slice.call(r)));return this._r=n._r,this._g=n._g,this._b=n._b,this.setAlpha(n._a),this},lighten:function(){return this._applyModification(Zz,arguments)},brighten:function(){return this._applyModification(Jz,arguments)},darken:function(){return this._applyModification(Qz,arguments)},desaturate:function(){return this._applyModification(Yz,arguments)},saturate:function(){return this._applyModification(Xz,arguments)},greyscale:function(){return this._applyModification(Kz,arguments)},spin:function(){return this._applyModification(eF,arguments)},_applyCombination:function(e,r){return e.apply(null,[this].concat([].slice.call(r)))},analogous:function(){return this._applyCombination(nF,arguments)},complement:function(){return this._applyCombination(tF,arguments)},monochromatic:function(){return this._applyCombination(iF,arguments)},splitcomplement:function(){return this._applyCombination(rF,arguments)},triad:function(){return this._applyCombination(Mv,[3])},tetrad:function(){return this._applyCombination(Mv,[4])}};Fe.fromRatio=function(t,e){if(td(t)=="object"){var r={};for(var n in t)t.hasOwnProperty(n)&&(n==="a"?r[n]=t[n]:r[n]=ya(t[n]));t=r}return Fe(t,e)};function Uz(t){var e={r:0,g:0,b:0},r=1,n=null,i=null,s=null,o=!1,l=!1;return typeof t=="string"&&(t=cF(t)),td(t)=="object"&&(qn(t.r)&&qn(t.g)&&qn(t.b)?(e=Wz(t.r,t.g,t.b),o=!0,l=String(t.r).substr(-1)==="%"?"prgb":"rgb"):qn(t.h)&&qn(t.s)&&qn(t.v)?(n=ya(t.s),i=ya(t.v),e=Vz(t.h,n,i),o=!0,l="hsv"):qn(t.h)&&qn(t.s)&&qn(t.l)&&(n=ya(t.s),s=ya(t.l),e=Gz(t.h,n,s),o=!0,l="hsl"),t.hasOwnProperty("a")&&(r=t.a)),r=K1(r),{ok:o,format:t.format||l,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:r}}function Wz(t,e,r){return{r:Et(t,255)*255,g:Et(e,255)*255,b:Et(r,255)*255}}function Rv(t,e,r){t=Et(t,255),e=Et(e,255),r=Et(r,255);var n=Math.max(t,e,r),i=Math.min(t,e,r),s,o,l=(n+i)/2;if(n==i)s=o=0;else{var c=n-i;switch(o=l>.5?c/(2-n-i):c/(n+i),n){case t:s=(e-r)/c+(e<r?6:0);break;case e:s=(r-t)/c+2;break;case r:s=(t-e)/c+4;break}s/=6}return{h:s,s:o,l}}function Gz(t,e,r){var n,i,s;t=Et(t,360),e=Et(e,100),r=Et(r,100);function o(d,u,f){return f<0&&(f+=1),f>1&&(f-=1),f<1/6?d+(u-d)*6*f:f<1/2?u:f<2/3?d+(u-d)*(2/3-f)*6:d}if(e===0)n=i=s=r;else{var l=r<.5?r*(1+e):r+e-r*e,c=2*r-l;n=o(c,l,t+1/3),i=o(c,l,t),s=o(c,l,t-1/3)}return{r:n*255,g:i*255,b:s*255}}function Pv(t,e,r){t=Et(t,255),e=Et(e,255),r=Et(r,255);var n=Math.max(t,e,r),i=Math.min(t,e,r),s,o,l=n,c=n-i;if(o=n===0?0:c/n,n==i)s=0;else{switch(n){case t:s=(e-r)/c+(e<r?6:0);break;case e:s=(r-t)/c+2;break;case r:s=(t-e)/c+4;break}s/=6}return{h:s,s:o,v:l}}function Vz(t,e,r){t=Et(t,360)*6,e=Et(e,100),r=Et(r,100);var n=Math.floor(t),i=t-n,s=r*(1-e),o=r*(1-i*e),l=r*(1-(1-i)*e),c=n%6,d=[r,o,s,s,l,r][c],u=[l,r,r,o,s,s][c],f=[s,s,l,r,r,o][c];return{r:d*255,g:u*255,b:f*255}}function Ov(t,e,r,n){var i=[fn(Math.round(t).toString(16)),fn(Math.round(e).toString(16)),fn(Math.round(r).toString(16))];return n&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function qz(t,e,r,n,i){var s=[fn(Math.round(t).toString(16)),fn(Math.round(e).toString(16)),fn(Math.round(r).toString(16)),fn(Z1(n))];return i&&s[0].charAt(0)==s[0].charAt(1)&&s[1].charAt(0)==s[1].charAt(1)&&s[2].charAt(0)==s[2].charAt(1)&&s[3].charAt(0)==s[3].charAt(1)?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0)+s[3].charAt(0):s.join("")}function Av(t,e,r,n){var i=[fn(Z1(n)),fn(Math.round(t).toString(16)),fn(Math.round(e).toString(16)),fn(Math.round(r).toString(16))];return i.join("")}Fe.equals=function(t,e){return!t||!e?!1:Fe(t).toRgbString()==Fe(e).toRgbString()};Fe.random=function(){return Fe.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function Yz(t,e){e=e===0?0:e||10;var r=Fe(t).toHsl();return r.s-=e/100,r.s=Dd(r.s),Fe(r)}function Xz(t,e){e=e===0?0:e||10;var r=Fe(t).toHsl();return r.s+=e/100,r.s=Dd(r.s),Fe(r)}function Kz(t){return Fe(t).desaturate(100)}function Zz(t,e){e=e===0?0:e||10;var r=Fe(t).toHsl();return r.l+=e/100,r.l=Dd(r.l),Fe(r)}function Jz(t,e){e=e===0?0:e||10;var r=Fe(t).toRgb();return r.r=Math.max(0,Math.min(255,r.r-Math.round(255*-(e/100)))),r.g=Math.max(0,Math.min(255,r.g-Math.round(255*-(e/100)))),r.b=Math.max(0,Math.min(255,r.b-Math.round(255*-(e/100)))),Fe(r)}function Qz(t,e){e=e===0?0:e||10;var r=Fe(t).toHsl();return r.l-=e/100,r.l=Dd(r.l),Fe(r)}function eF(t,e){var r=Fe(t).toHsl(),n=(r.h+e)%360;return r.h=n<0?360+n:n,Fe(r)}function tF(t){var e=Fe(t).toHsl();return e.h=(e.h+180)%360,Fe(e)}function Mv(t,e){if(isNaN(e)||e<=0)throw new Error("Argument to polyad must be a positive number");for(var r=Fe(t).toHsl(),n=[Fe(t)],i=360/e,s=1;s<e;s++)n.push(Fe({h:(r.h+s*i)%360,s:r.s,l:r.l}));return n}function rF(t){var e=Fe(t).toHsl(),r=e.h;return[Fe(t),Fe({h:(r+72)%360,s:e.s,l:e.l}),Fe({h:(r+216)%360,s:e.s,l:e.l})]}function nF(t,e,r){e=e||6,r=r||30;var n=Fe(t).toHsl(),i=360/r,s=[Fe(t)];for(n.h=(n.h-(i*e>>1)+720)%360;--e;)n.h=(n.h+i)%360,s.push(Fe(n));return s}function iF(t,e){e=e||6;for(var r=Fe(t).toHsv(),n=r.h,i=r.s,s=r.v,o=[],l=1/e;e--;)o.push(Fe({h:n,s:i,v:s})),s=(s+l)%1;return o}Fe.mix=function(t,e,r){r=r===0?0:r||50;var n=Fe(t).toRgb(),i=Fe(e).toRgb(),s=r/100,o={r:(i.r-n.r)*s+n.r,g:(i.g-n.g)*s+n.g,b:(i.b-n.b)*s+n.b,a:(i.a-n.a)*s+n.a};return Fe(o)};Fe.readability=function(t,e){var r=Fe(t),n=Fe(e);return(Math.max(r.getLuminance(),n.getLuminance())+.05)/(Math.min(r.getLuminance(),n.getLuminance())+.05)};Fe.isReadable=function(t,e,r){var n=Fe.readability(t,e),i,s;switch(s=!1,i=dF(r),i.level+i.size){case"AAsmall":case"AAAlarge":s=n>=4.5;break;case"AAlarge":s=n>=3;break;case"AAAsmall":s=n>=7;break}return s};Fe.mostReadable=function(t,e,r){var n=null,i=0,s,o,l,c;r=r||{},o=r.includeFallbackColors,l=r.level,c=r.size;for(var d=0;d<e.length;d++)s=Fe.readability(t,e[d]),s>i&&(i=s,n=Fe(e[d]));return Fe.isReadable(t,n,{level:l,size:c})||!o?n:(r.includeFallbackColors=!1,Fe.mostReadable(t,["#fff","#000"],r))};var af=Fe.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},sF=Fe.hexNames=oF(af);function oF(t){var e={};for(var r in t)t.hasOwnProperty(r)&&(e[t[r]]=r);return e}function K1(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function Et(t,e){aF(t)&&(t="100%");var r=lF(t);return t=Math.min(e,Math.max(0,parseFloat(t))),r&&(t=parseInt(t*e,10)/100),Math.abs(t-e)<1e-6?1:t%e/parseFloat(e)}function Dd(t){return Math.min(1,Math.max(0,t))}function Nr(t){return parseInt(t,16)}function aF(t){return typeof t=="string"&&t.indexOf(".")!=-1&&parseFloat(t)===1}function lF(t){return typeof t=="string"&&t.indexOf("%")!=-1}function fn(t){return t.length==1?"0"+t:""+t}function ya(t){return t<=1&&(t=t*100+"%"),t}function Z1(t){return Math.round(parseFloat(t)*255).toString(16)}function $v(t){return Nr(t)/255}var an=function(){var t="[-\\+]?\\d+%?",e="[-\\+]?\\d*\\.\\d+%?",r="(?:"+e+")|(?:"+t+")",n="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?",i="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?";return{CSS_UNIT:new RegExp(r),rgb:new RegExp("rgb"+n),rgba:new RegExp("rgba"+i),hsl:new RegExp("hsl"+n),hsla:new RegExp("hsla"+i),hsv:new RegExp("hsv"+n),hsva:new RegExp("hsva"+i),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function qn(t){return!!an.CSS_UNIT.exec(t)}function cF(t){t=t.replace(Bz,"").replace(Hz,"").toLowerCase();var e=!1;if(af[t])t=af[t],e=!0;else if(t=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var r;return(r=an.rgb.exec(t))?{r:r[1],g:r[2],b:r[3]}:(r=an.rgba.exec(t))?{r:r[1],g:r[2],b:r[3],a:r[4]}:(r=an.hsl.exec(t))?{h:r[1],s:r[2],l:r[3]}:(r=an.hsla.exec(t))?{h:r[1],s:r[2],l:r[3],a:r[4]}:(r=an.hsv.exec(t))?{h:r[1],s:r[2],v:r[3]}:(r=an.hsva.exec(t))?{h:r[1],s:r[2],v:r[3],a:r[4]}:(r=an.hex8.exec(t))?{r:Nr(r[1]),g:Nr(r[2]),b:Nr(r[3]),a:$v(r[4]),format:e?"name":"hex8"}:(r=an.hex6.exec(t))?{r:Nr(r[1]),g:Nr(r[2]),b:Nr(r[3]),format:e?"name":"hex"}:(r=an.hex4.exec(t))?{r:Nr(r[1]+""+r[1]),g:Nr(r[2]+""+r[2]),b:Nr(r[3]+""+r[3]),a:$v(r[4]+""+r[4]),format:e?"name":"hex8"}:(r=an.hex3.exec(t))?{r:Nr(r[1]+""+r[1]),g:Nr(r[2]+""+r[2]),b:Nr(r[3]+""+r[3]),format:e?"name":"hex"}:!1}function dF(t){var e,r;return t=t||{level:"AA",size:"small"},e=(t.level||"AA").toUpperCase(),r=(t.size||"small").toLowerCase(),e!=="AA"&&e!=="AAA"&&(e="AA"),r!=="small"&&r!=="large"&&(r="small"),{level:e,size:r}}var Lv=function(e){var r=["r","g","b","a","h","s","l","v"],n=0,i=0;return Fz(r,function(s){if(e[s]&&(n+=1,isNaN(e[s])||(i+=1),s==="s"||s==="l")){var o=/^\d+%$/;o.test(e[s])&&(i+=1)}}),n===i?e:!1},xa=function(e,r){var n=e.hex?Fe(e.hex):Fe(e),i=n.toHsl(),s=n.toHsv(),o=n.toRgb(),l=n.toHex();i.s===0&&(i.h=r||0,s.h=r||0);var c=l==="000000"&&o.a===0;return{hsl:i,hex:c?"transparent":"#"+l,rgb:o,hsv:s,oldHue:e.h||r||i.h,source:e.source}},Hi=function(e){if(e==="transparent")return!0;var r=String(e).charAt(0)==="#"?1:0;return e.length!==4+r&&e.length<7+r&&Fe(e).isValid()},Kp=function(e){if(!e)return"#fff";var r=xa(e);if(r.hex==="transparent")return"rgba(0,0,0,0.4)";var n=(r.rgb.r*299+r.rgb.g*587+r.rgb.b*114)/1e3;return n>=128?"#000":"#fff"},zu=function(e,r){var n=e.replace("","");return Fe(r+" ("+n+")")._ok},ca=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},uF=function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();function hF(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function fF(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function pF(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var jr=function(e){var r=function(n){pF(i,n);function i(s){hF(this,i);var o=fF(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return o.handleChange=function(l,c){var d=Lv(l);if(d){var u=xa(l,l.h||o.state.oldHue);o.setState(u),o.props.onChangeComplete&&o.debounce(o.props.onChangeComplete,u,c),o.props.onChange&&o.props.onChange(u,c)}},o.handleSwatchHover=function(l,c){var d=Lv(l);if(d){var u=xa(l,l.h||o.state.oldHue);o.props.onSwatchHover&&o.props.onSwatchHover(u,c)}},o.state=ca({},xa(s.color,0)),o.debounce=Y1(function(l,c,d){l(c,d)},100),o}return uF(i,[{key:"render",value:function(){var o={};return this.props.onSwatchHover&&(o.onSwatchHover=this.handleSwatchHover),$.createElement(e,ca({},this.props,this.state,{onChange:this.handleChange},o))}}],[{key:"getDerivedStateFromProps",value:function(o,l){return ca({},xa(o.color,l.oldHue))}}]),i}(P.PureComponent||P.Component);return r.propTypes=ca({},e.propTypes),r.defaultProps=ca({},e.defaultProps,{color:{h:250,s:.5,l:.2,a:1}}),r},mF=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},gF=function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();function vF(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Iv(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function yF(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var xF=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"span";return function(n){yF(i,n);function i(){var s,o,l,c;vF(this,i);for(var d=arguments.length,u=Array(d),f=0;f<d;f++)u[f]=arguments[f];return c=(o=(l=Iv(this,(s=i.__proto__||Object.getPrototypeOf(i)).call.apply(s,[this].concat(u))),l),l.state={focus:!1},l.handleFocus=function(){return l.setState({focus:!0})},l.handleBlur=function(){return l.setState({focus:!1})},o),Iv(l,c)}return gF(i,[{key:"render",value:function(){return $.createElement(r,{onFocus:this.handleFocus,onBlur:this.handleBlur},$.createElement(e,mF({},this.props,this.state)))}}]),i}($.Component)},Dv=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},bF=13,wF=function(e){var r=e.color,n=e.style,i=e.onClick,s=i===void 0?function(){}:i,o=e.onHover,l=e.title,c=l===void 0?r:l,d=e.children,u=e.focus,f=e.focusStyle,h=f===void 0?{}:f,p=r==="transparent",g=Qe({default:{swatch:Dv({background:r,height:"100%",width:"100%",cursor:"pointer",position:"relative",outline:"none"},n,u?h:{})}}),m=function(w){return s(r,w)},x=function(w){return w.keyCode===bF&&s(r,w)},v=function(w){return o(r,w)},y={};return o&&(y.onMouseOver=v),$.createElement("div",Dv({style:g.swatch,onClick:m,title:c,tabIndex:0,onKeyDown:x},y),d,p&&$.createElement(Yo,{borderRadius:g.swatch.borderRadius,boxShadow:"inset 0 0 0 1px rgba(0,0,0,0.1)"}))};const _s=xF(wF);var _F=function(e){var r=e.direction,n=Qe({default:{picker:{width:"18px",height:"18px",borderRadius:"50%",transform:"translate(-9px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}},vertical:{picker:{transform:"translate(-3px, -9px)"}}},{vertical:r==="vertical"});return $.createElement("div",{style:n.picker})},SF=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},J1=function(e){var r=e.rgb,n=e.hsl,i=e.width,s=e.height,o=e.onChange,l=e.direction,c=e.style,d=e.renderers,u=e.pointer,f=e.className,h=f===void 0?"":f,p=Qe({default:{picker:{position:"relative",width:i,height:s},alpha:{radius:"2px",style:c}}});return $.createElement("div",{style:p.picker,className:"alpha-picker "+h},$.createElement(Hp,SF({},p.alpha,{rgb:r,hsl:n,pointer:u,renderers:d,onChange:o,direction:l})))};J1.defaultProps={width:"316px",height:"16px",direction:"horizontal",pointer:_F};jr(J1);function Q1(t,e){for(var r=-1,n=t==null?0:t.length,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i}var kF="__lodash_hash_undefined__";function jF(t){return this.__data__.set(t,kF),this}function CF(t){return this.__data__.has(t)}function rd(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new li;++e<r;)this.add(t[e])}rd.prototype.add=rd.prototype.push=jF;rd.prototype.has=CF;function EF(t,e){for(var r=-1,n=t==null?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}function TF(t,e){return t.has(e)}var NF=1,RF=2;function e_(t,e,r,n,i,s){var o=r&NF,l=t.length,c=e.length;if(l!=c&&!(o&&c>l))return!1;var d=s.get(t),u=s.get(e);if(d&&u)return d==e&&u==t;var f=-1,h=!0,p=r&RF?new rd:void 0;for(s.set(t,e),s.set(e,t);++f<l;){var g=t[f],m=e[f];if(n)var x=o?n(m,g,f,e,t,s):n(g,m,f,t,e,s);if(x!==void 0){if(x)continue;h=!1;break}if(p){if(!EF(e,function(v,y){if(!TF(p,y)&&(g===v||i(g,v,r,n,s)))return p.push(y)})){h=!1;break}}else if(!(g===m||i(g,m,r,n,s))){h=!1;break}}return s.delete(t),s.delete(e),h}function PF(t){var e=-1,r=Array(t.size);return t.forEach(function(n,i){r[++e]=[i,n]}),r}function OF(t){var e=-1,r=Array(t.size);return t.forEach(function(n){r[++e]=n}),r}var AF=1,MF=2,$F="[object Boolean]",LF="[object Date]",IF="[object Error]",DF="[object Map]",zF="[object Number]",FF="[object RegExp]",BF="[object Set]",HF="[object String]",UF="[object Symbol]",WF="[object ArrayBuffer]",GF="[object DataView]",zv=Li?Li.prototype:void 0,Fu=zv?zv.valueOf:void 0;function VF(t,e,r,n,i,s,o){switch(r){case GF:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case WF:return!(t.byteLength!=e.byteLength||!s(new Jc(t),new Jc(e)));case $F:case LF:case zF:return vl(+t,+e);case IF:return t.name==e.name&&t.message==e.message;case FF:case HF:return t==e+"";case DF:var l=PF;case BF:var c=n&AF;if(l||(l=OF),t.size!=e.size&&!c)return!1;var d=o.get(t);if(d)return d==e;n|=MF,o.set(t,e);var u=e_(l(t),l(e),n,i,s,o);return o.delete(t),u;case UF:if(Fu)return Fu.call(t)==Fu.call(e)}return!1}function qF(t,e){for(var r=-1,n=e.length,i=t.length;++r<n;)t[i+r]=e[r];return t}function YF(t,e,r){var n=e(t);return Dr(t)?n:qF(n,r(t))}function XF(t,e){for(var r=-1,n=t==null?0:t.length,i=0,s=[];++r<n;){var o=t[r];e(o,r,t)&&(s[i++]=o)}return s}function KF(){return[]}var ZF=Object.prototype,JF=ZF.propertyIsEnumerable,Fv=Object.getOwnPropertySymbols,QF=Fv?function(t){return t==null?[]:(t=Object(t),XF(Fv(t),function(e){return JF.call(t,e)}))}:KF;function Bv(t){return YF(t,Xp,QF)}var eB=1,tB=Object.prototype,rB=tB.hasOwnProperty;function nB(t,e,r,n,i,s){var o=r&eB,l=Bv(t),c=l.length,d=Bv(e),u=d.length;if(c!=u&&!o)return!1;for(var f=c;f--;){var h=l[f];if(!(o?h in e:rB.call(e,h)))return!1}var p=s.get(t),g=s.get(e);if(p&&g)return p==e&&g==t;var m=!0;s.set(t,e),s.set(e,t);for(var x=o;++f<c;){h=l[f];var v=t[h],y=e[h];if(n)var b=o?n(y,v,h,e,t,s):n(v,y,h,t,e,s);if(!(b===void 0?v===y||i(v,y,r,n,s):b)){m=!1;break}x||(x=h=="constructor")}if(m&&!x){var w=t.constructor,k=e.constructor;w!=k&&"constructor"in t&&"constructor"in e&&!(typeof w=="function"&&w instanceof w&&typeof k=="function"&&k instanceof k)&&(m=!1)}return s.delete(t),s.delete(e),m}var lf=ws(yn,"DataView"),cf=ws(yn,"Promise"),df=ws(yn,"Set"),uf=ws(yn,"WeakMap"),Hv="[object Map]",iB="[object Object]",Uv="[object Promise]",Wv="[object Set]",Gv="[object WeakMap]",Vv="[object DataView]",sB=bs(lf),oB=bs(tl),aB=bs(cf),lB=bs(df),cB=bs(uf),yi=xs;(lf&&yi(new lf(new ArrayBuffer(1)))!=Vv||tl&&yi(new tl)!=Hv||cf&&yi(cf.resolve())!=Uv||df&&yi(new df)!=Wv||uf&&yi(new uf)!=Gv)&&(yi=function(t){var e=xs(t),r=e==iB?t.constructor:void 0,n=r?bs(r):"";if(n)switch(n){case sB:return Vv;case oB:return Hv;case aB:return Uv;case lB:return Wv;case cB:return Gv}return e});var dB=1,qv="[object Arguments]",Yv="[object Array]",Zl="[object Object]",uB=Object.prototype,Xv=uB.hasOwnProperty;function hB(t,e,r,n,i,s){var o=Dr(t),l=Dr(e),c=o?Yv:yi(t),d=l?Yv:yi(e);c=c==qv?Zl:c,d=d==qv?Zl:d;var u=c==Zl,f=d==Zl,h=c==d;if(h&&ed(t)){if(!ed(e))return!1;o=!0,u=!1}if(h&&!u)return s||(s=new $n),o||qp(t)?e_(t,e,r,n,i,s):VF(t,e,c,r,n,i,s);if(!(r&dB)){var p=u&&Xv.call(t,"__wrapped__"),g=f&&Xv.call(e,"__wrapped__");if(p||g){var m=p?t.value():t,x=g?e.value():e;return s||(s=new $n),i(m,x,r,n,s)}}return h?(s||(s=new $n),nB(t,e,r,n,i,s)):!1}function Zp(t,e,r,n,i){return t===e?!0:t==null||e==null||!Ii(t)&&!Ii(e)?t!==t&&e!==e:hB(t,e,r,n,Zp,i)}var fB=1,pB=2;function mB(t,e,r,n){var i=r.length,s=i;if(t==null)return!s;for(t=Object(t);i--;){var o=r[i];if(o[2]?o[1]!==t[o[0]]:!(o[0]in t))return!1}for(;++i<s;){o=r[i];var l=o[0],c=t[l],d=o[1];if(o[2]){if(c===void 0&&!(l in t))return!1}else{var u=new $n,f;if(!(f===void 0?Zp(d,c,fB|pB,n,u):f))return!1}}return!0}function t_(t){return t===t&&!Jr(t)}function gB(t){for(var e=Xp(t),r=e.length;r--;){var n=e[r],i=t[n];e[r]=[n,i,t_(i)]}return e}function r_(t,e){return function(r){return r==null?!1:r[t]===e&&(e!==void 0||t in Object(r))}}function vB(t){var e=gB(t);return e.length==1&&e[0][2]?r_(e[0][0],e[0][1]):function(r){return r===t||mB(r,t,e)}}var yB=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,xB=/^\w*$/;function Jp(t,e){if(Dr(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||Ld(t)?!0:xB.test(t)||!yB.test(t)||e!=null&&t in Object(e)}var bB="Expected a function";function Qp(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(bB);var r=function(){var n=arguments,i=e?e.apply(this,n):n[0],s=r.cache;if(s.has(i))return s.get(i);var o=t.apply(this,n);return r.cache=s.set(i,o)||s,o};return r.cache=new(Qp.Cache||li),r}Qp.Cache=li;var wB=500;function _B(t){var e=Qp(t,function(n){return r.size===wB&&r.clear(),n}),r=e.cache;return e}var SB=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,kB=/\\(\\)?/g,jB=_B(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(SB,function(r,n,i,s){e.push(i?s.replace(kB,"$1"):n||r)}),e}),Kv=Li?Li.prototype:void 0,Zv=Kv?Kv.toString:void 0;function n_(t){if(typeof t=="string")return t;if(Dr(t))return Q1(t,n_)+"";if(Ld(t))return Zv?Zv.call(t):"";var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}function CB(t){return t==null?"":n_(t)}function i_(t,e){return Dr(t)?t:Jp(t,e)?[t]:jB(CB(t))}function zd(t){if(typeof t=="string"||Ld(t))return t;var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}function s_(t,e){e=i_(e,t);for(var r=0,n=e.length;t!=null&&r<n;)t=t[zd(e[r++])];return r&&r==n?t:void 0}function EB(t,e,r){var n=t==null?void 0:s_(t,e);return n===void 0?r:n}function TB(t,e){return t!=null&&e in Object(t)}function NB(t,e,r){e=i_(e,t);for(var n=-1,i=e.length,s=!1;++n<i;){var o=zd(e[n]);if(!(s=t!=null&&r(t,o)))break;t=t[o]}return s||++n!=i?s:(i=t==null?0:t.length,!!i&&Vp(i)&&Yp(o,i)&&(Dr(t)||Qc(t)))}function RB(t,e){return t!=null&&NB(t,e,TB)}var PB=1,OB=2;function AB(t,e){return Jp(t)&&t_(e)?r_(zd(t),e):function(r){var n=EB(r,t);return n===void 0&&n===e?RB(r,t):Zp(e,n,PB|OB)}}function MB(t){return function(e){return e==null?void 0:e[t]}}function $B(t){return function(e){return s_(e,t)}}function LB(t){return Jp(t)?MB(zd(t)):$B(t)}function IB(t){return typeof t=="function"?t:t==null?$d:typeof t=="object"?Dr(t)?AB(t[0],t[1]):vB(t):LB(t)}function DB(t,e){var r=-1,n=Ko(t)?Array(t.length):[];return X1(t,function(i,s,o){n[++r]=e(i,s,o)}),n}function Ss(t,e){var r=Dr(t)?Q1:DB;return r(t,IB(e))}var zB=function(e){var r=e.colors,n=e.onClick,i=e.onSwatchHover,s=Qe({default:{swatches:{marginRight:"-10px"},swatch:{width:"22px",height:"22px",float:"left",marginRight:"10px",marginBottom:"10px",borderRadius:"4px"},clear:{clear:"both"}}});return $.createElement("div",{style:s.swatches},Ss(r,function(o){return $.createElement(_s,{key:o,color:o,style:s.swatch,onClick:n,onHover:i,focusStyle:{boxShadow:"0 0 4px "+o}})}),$.createElement("div",{style:s.clear}))},em=function(e){var r=e.onChange,n=e.onSwatchHover,i=e.hex,s=e.colors,o=e.width,l=e.triangle,c=e.styles,d=c===void 0?{}:c,u=e.className,f=u===void 0?"":u,h=i==="transparent",p=function(x,v){Hi(x)&&r({hex:x,source:"hex"},v)},g=Qe(kr({default:{card:{width:o,background:"#fff",boxShadow:"0 1px rgba(0,0,0,.1)",borderRadius:"6px",position:"relative"},head:{height:"110px",background:i,borderRadius:"6px 6px 0 0",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},body:{padding:"10px"},label:{fontSize:"18px",color:Kp(i),position:"relative"},triangle:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 10px 10px 10px",borderColor:"transparent transparent "+i+" transparent",position:"absolute",top:"-10px",left:"50%",marginLeft:"-10px"},input:{width:"100%",fontSize:"12px",color:"#666",border:"0px",outline:"none",height:"22px",boxShadow:"inset 0 0 0 1px #ddd",borderRadius:"4px",padding:"0 7px",boxSizing:"border-box"}},"hide-triangle":{triangle:{display:"none"}}},d),{"hide-triangle":l==="hide"});return $.createElement("div",{style:g.card,className:"block-picker "+f},$.createElement("div",{style:g.triangle}),$.createElement("div",{style:g.head},h&&$.createElement(Yo,{borderRadius:"6px 6px 0 0"}),$.createElement("div",{style:g.label},i)),$.createElement("div",{style:g.body},$.createElement(zB,{colors:s,onClick:p,onSwatchHover:n}),$.createElement(lt,{style:{input:g.input},value:i,onChange:p})))};em.propTypes={width:Te.oneOfType([Te.string,Te.number]),colors:Te.arrayOf(Te.string),triangle:Te.oneOf(["top","hide"]),styles:Te.object};em.defaultProps={width:170,colors:["#D9E3F0","#F47373","#697689","#37D67A","#2CCCE4","#555555","#dce775","#ff8a65","#ba68c8"],triangle:"top",styles:{}};jr(em);var Bs={100:"#ffcdd2",300:"#e57373",500:"#f44336",700:"#d32f2f",900:"#b71c1c"},Hs={100:"#f8bbd0",300:"#f06292",500:"#e91e63",700:"#c2185b",900:"#880e4f"},Us={100:"#e1bee7",300:"#ba68c8",500:"#9c27b0",700:"#7b1fa2",900:"#4a148c"},Ws={100:"#d1c4e9",300:"#9575cd",500:"#673ab7",700:"#512da8",900:"#311b92"},Gs={100:"#c5cae9",300:"#7986cb",500:"#3f51b5",700:"#303f9f",900:"#1a237e"},Vs={100:"#bbdefb",300:"#64b5f6",500:"#2196f3",700:"#1976d2",900:"#0d47a1"},qs={100:"#b3e5fc",300:"#4fc3f7",500:"#03a9f4",700:"#0288d1",900:"#01579b"},Ys={100:"#b2ebf2",300:"#4dd0e1",500:"#00bcd4",700:"#0097a7",900:"#006064"},Xs={100:"#b2dfdb",300:"#4db6ac",500:"#009688",700:"#00796b",900:"#004d40"},ba={100:"#c8e6c9",300:"#81c784",500:"#4caf50",700:"#388e3c"},Ks={100:"#dcedc8",300:"#aed581",500:"#8bc34a",700:"#689f38",900:"#33691e"},Zs={100:"#f0f4c3",300:"#dce775",500:"#cddc39",700:"#afb42b",900:"#827717"},Js={100:"#fff9c4",300:"#fff176",500:"#ffeb3b",700:"#fbc02d",900:"#f57f17"},Qs={100:"#ffecb3",300:"#ffd54f",500:"#ffc107",700:"#ffa000",900:"#ff6f00"},eo={100:"#ffe0b2",300:"#ffb74d",500:"#ff9800",700:"#f57c00",900:"#e65100"},to={100:"#ffccbc",300:"#ff8a65",500:"#ff5722",700:"#e64a19",900:"#bf360c"},ro={100:"#d7ccc8",300:"#a1887f",500:"#795548",700:"#5d4037",900:"#3e2723"},no={100:"#cfd8dc",300:"#90a4ae",500:"#607d8b",700:"#455a64",900:"#263238"},o_=function(e){var r=e.color,n=e.onClick,i=e.onSwatchHover,s=e.hover,o=e.active,l=e.circleSize,c=e.circleSpacing,d=Qe({default:{swatch:{width:l,height:l,marginRight:c,marginBottom:c,transform:"scale(1)",transition:"100ms transform ease"},Swatch:{borderRadius:"50%",background:"transparent",boxShadow:"inset 0 0 0 "+(l/2+1)+"px "+r,transition:"100ms box-shadow ease"}},hover:{swatch:{transform:"scale(1.2)"}},active:{Swatch:{boxShadow:"inset 0 0 0 3px "+r}}},{hover:s,active:o});return $.createElement("div",{style:d.swatch},$.createElement(_s,{style:d.Swatch,color:r,onClick:n,onHover:i,focusStyle:{boxShadow:d.Swatch.boxShadow+", 0 0 5px "+r}}))};o_.defaultProps={circleSize:28,circleSpacing:14};const FB=Bp(o_);var tm=function(e){var r=e.width,n=e.onChange,i=e.onSwatchHover,s=e.colors,o=e.hex,l=e.circleSize,c=e.styles,d=c===void 0?{}:c,u=e.circleSpacing,f=e.className,h=f===void 0?"":f,p=Qe(kr({default:{card:{width:r,display:"flex",flexWrap:"wrap",marginRight:-u,marginBottom:-u}}},d)),g=function(x,v){return n({hex:x,source:"hex"},v)};return $.createElement("div",{style:p.card,className:"circle-picker "+h},Ss(s,function(m){return $.createElement(FB,{key:m,color:m,onClick:g,onSwatchHover:i,active:o===m.toLowerCase(),circleSize:l,circleSpacing:u})}))};tm.propTypes={width:Te.oneOfType([Te.string,Te.number]),circleSize:Te.number,circleSpacing:Te.number,styles:Te.object};tm.defaultProps={width:252,circleSize:28,circleSpacing:14,colors:[Bs[500],Hs[500],Us[500],Ws[500],Gs[500],Vs[500],qs[500],Ys[500],Xs[500],ba[500],Ks[500],Zs[500],Js[500],Qs[500],eo[500],to[500],ro[500],no[500]],styles:{}};jr(tm);function Jv(t){return t===void 0}var a_={};Object.defineProperty(a_,"__esModule",{value:!0});var Qv=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},BB=P,ey=HB(BB);function HB(t){return t&&t.__esModule?t:{default:t}}function UB(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}var Jl=24,WB=a_.default=function(t){var e=t.fill,r=e===void 0?"currentColor":e,n=t.width,i=n===void 0?Jl:n,s=t.height,o=s===void 0?Jl:s,l=t.style,c=l===void 0?{}:l,d=UB(t,["fill","width","height","style"]);return ey.default.createElement("svg",Qv({viewBox:"0 0 "+Jl+" "+Jl,style:Qv({fill:r,width:i,height:o},c)},d),ey.default.createElement("path",{d:"M12,18.17L8.83,15L7.42,16.41L12,21L16.59,16.41L15.17,15M12,5.83L15.17,9L16.58,7.59L12,3L7.41,7.59L8.83,9L12,5.83Z"}))},GB=function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();function VB(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function qB(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function YB(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var l_=function(t){YB(e,t);function e(r){VB(this,e);var n=qB(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.toggleViews=function(){n.state.view==="hex"?n.setState({view:"rgb"}):n.state.view==="rgb"?n.setState({view:"hsl"}):n.state.view==="hsl"&&(n.props.hsl.a===1?n.setState({view:"hex"}):n.setState({view:"rgb"}))},n.handleChange=function(i,s){i.hex?Hi(i.hex)&&n.props.onChange({hex:i.hex,source:"hex"},s):i.r||i.g||i.b?n.props.onChange({r:i.r||n.props.rgb.r,g:i.g||n.props.rgb.g,b:i.b||n.props.rgb.b,source:"rgb"},s):i.a?(i.a<0?i.a=0:i.a>1&&(i.a=1),n.props.onChange({h:n.props.hsl.h,s:n.props.hsl.s,l:n.props.hsl.l,a:Math.round(i.a*100)/100,source:"rgb"},s)):(i.h||i.s||i.l)&&(typeof i.s=="string"&&i.s.includes("%")&&(i.s=i.s.replace("%","")),typeof i.l=="string"&&i.l.includes("%")&&(i.l=i.l.replace("%","")),i.s==1?i.s=.01:i.l==1&&(i.l=.01),n.props.onChange({h:i.h||n.props.hsl.h,s:Number(Jv(i.s)?n.props.hsl.s:i.s),l:Number(Jv(i.l)?n.props.hsl.l:i.l),source:"hsl"},s))},n.showHighlight=function(i){i.currentTarget.style.background="#eee"},n.hideHighlight=function(i){i.currentTarget.style.background="transparent"},r.hsl.a!==1&&r.view==="hex"?n.state={view:"rgb"}:n.state={view:r.view},n}return GB(e,[{key:"render",value:function(){var n=this,i=Qe({default:{wrap:{paddingTop:"16px",display:"flex"},fields:{flex:"1",display:"flex",marginLeft:"-6px"},field:{paddingLeft:"6px",width:"100%"},alpha:{paddingLeft:"6px",width:"100%"},toggle:{width:"32px",textAlign:"right",position:"relative"},icon:{marginRight:"-4px",marginTop:"12px",cursor:"pointer",position:"relative"},iconHighlight:{position:"absolute",width:"24px",height:"28px",background:"#eee",borderRadius:"4px",top:"10px",left:"12px",display:"none"},input:{fontSize:"11px",color:"#333",width:"100%",borderRadius:"2px",border:"none",boxShadow:"inset 0 0 0 1px #dadada",height:"21px",textAlign:"center"},label:{textTransform:"uppercase",fontSize:"11px",lineHeight:"11px",color:"#969696",textAlign:"center",display:"block",marginTop:"12px"},svg:{fill:"#333",width:"24px",height:"24px",border:"1px transparent solid",borderRadius:"5px"}},disableAlpha:{alpha:{display:"none"}}},this.props,this.state),s=void 0;return this.state.view==="hex"?s=$.createElement("div",{style:i.fields,className:"flexbox-fix"},$.createElement("div",{style:i.field},$.createElement(lt,{style:{input:i.input,label:i.label},label:"hex",value:this.props.hex,onChange:this.handleChange}))):this.state.view==="rgb"?s=$.createElement("div",{style:i.fields,className:"flexbox-fix"},$.createElement("div",{style:i.field},$.createElement(lt,{style:{input:i.input,label:i.label},label:"r",value:this.props.rgb.r,onChange:this.handleChange})),$.createElement("div",{style:i.field},$.createElement(lt,{style:{input:i.input,label:i.label},label:"g",value:this.props.rgb.g,onChange:this.handleChange})),$.createElement("div",{style:i.field},$.createElement(lt,{style:{input:i.input,label:i.label},label:"b",value:this.props.rgb.b,onChange:this.handleChange})),$.createElement("div",{style:i.alpha},$.createElement(lt,{style:{input:i.input,label:i.label},label:"a",value:this.props.rgb.a,arrowOffset:.01,onChange:this.handleChange}))):this.state.view==="hsl"&&(s=$.createElement("div",{style:i.fields,className:"flexbox-fix"},$.createElement("div",{style:i.field},$.createElement(lt,{style:{input:i.input,label:i.label},label:"h",value:Math.round(this.props.hsl.h),onChange:this.handleChange})),$.createElement("div",{style:i.field},$.createElement(lt,{style:{input:i.input,label:i.label},label:"s",value:Math.round(this.props.hsl.s*100)+"%",onChange:this.handleChange})),$.createElement("div",{style:i.field},$.createElement(lt,{style:{input:i.input,label:i.label},label:"l",value:Math.round(this.props.hsl.l*100)+"%",onChange:this.handleChange})),$.createElement("div",{style:i.alpha},$.createElement(lt,{style:{input:i.input,label:i.label},label:"a",value:this.props.hsl.a,arrowOffset:.01,onChange:this.handleChange})))),$.createElement("div",{style:i.wrap,className:"flexbox-fix"},s,$.createElement("div",{style:i.toggle},$.createElement("div",{style:i.icon,onClick:this.toggleViews,ref:function(l){return n.icon=l}},$.createElement(WB,{style:i.svg,onMouseOver:this.showHighlight,onMouseEnter:this.showHighlight,onMouseOut:this.hideHighlight}))))}}],[{key:"getDerivedStateFromProps",value:function(n,i){return n.hsl.a!==1&&i.view==="hex"?{view:"rgb"}:null}}]),e}($.Component);l_.defaultProps={view:"hex"};var ty=function(){var e=Qe({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",transform:"translate(-6px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}}});return $.createElement("div",{style:e.picker})},XB=function(){var e=Qe({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",boxShadow:"inset 0 0 0 1px #fff",transform:"translate(-6px, -6px)"}}});return $.createElement("div",{style:e.picker})},rm=function(e){var r=e.width,n=e.onChange,i=e.disableAlpha,s=e.rgb,o=e.hsl,l=e.hsv,c=e.hex,d=e.renderers,u=e.styles,f=u===void 0?{}:u,h=e.className,p=h===void 0?"":h,g=e.defaultView,m=Qe(kr({default:{picker:{width:r,background:"#fff",borderRadius:"2px",boxShadow:"0 0 2px rgba(0,0,0,.3), 0 4px 8px rgba(0,0,0,.3)",boxSizing:"initial",fontFamily:"Menlo"},saturation:{width:"100%",paddingBottom:"55%",position:"relative",borderRadius:"2px 2px 0 0",overflow:"hidden"},Saturation:{radius:"2px 2px 0 0"},body:{padding:"16px 16px 12px"},controls:{display:"flex"},color:{width:"32px"},swatch:{marginTop:"6px",width:"16px",height:"16px",borderRadius:"8px",position:"relative",overflow:"hidden"},active:{absolute:"0px 0px 0px 0px",borderRadius:"8px",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.1)",background:"rgba("+s.r+", "+s.g+", "+s.b+", "+s.a+")",zIndex:"2"},toggles:{flex:"1"},hue:{height:"10px",position:"relative",marginBottom:"8px"},Hue:{radius:"2px"},alpha:{height:"10px",position:"relative"},Alpha:{radius:"2px"}},disableAlpha:{color:{width:"22px"},alpha:{display:"none"},hue:{marginBottom:"0px"},swatch:{width:"10px",height:"10px",marginTop:"0px"}}},f),{disableAlpha:i});return $.createElement("div",{style:m.picker,className:"chrome-picker "+p},$.createElement("div",{style:m.saturation},$.createElement(Id,{style:m.Saturation,hsl:o,hsv:l,pointer:XB,onChange:n})),$.createElement("div",{style:m.body},$.createElement("div",{style:m.controls,className:"flexbox-fix"},$.createElement("div",{style:m.color},$.createElement("div",{style:m.swatch},$.createElement("div",{style:m.active}),$.createElement(Yo,{renderers:d}))),$.createElement("div",{style:m.toggles},$.createElement("div",{style:m.hue},$.createElement(Xo,{style:m.Hue,hsl:o,pointer:ty,onChange:n})),$.createElement("div",{style:m.alpha},$.createElement(Hp,{style:m.Alpha,rgb:s,hsl:o,pointer:ty,renderers:d,onChange:n})))),$.createElement(l_,{rgb:s,hsl:o,hex:c,view:g,onChange:n,disableAlpha:i})))};rm.propTypes={width:Te.oneOfType([Te.string,Te.number]),disableAlpha:Te.bool,styles:Te.object,defaultView:Te.oneOf(["hex","rgb","hsl"])};rm.defaultProps={width:225,disableAlpha:!1,styles:{}};const KB=jr(rm);var ZB=function(e){var r=e.color,n=e.onClick,i=n===void 0?function(){}:n,s=e.onSwatchHover,o=e.active,l=Qe({default:{color:{background:r,width:"15px",height:"15px",float:"left",marginRight:"5px",marginBottom:"5px",position:"relative",cursor:"pointer"},dot:{absolute:"5px 5px 5px 5px",background:Kp(r),borderRadius:"50%",opacity:"0"}},active:{dot:{opacity:"1"}},"color-#FFFFFF":{color:{boxShadow:"inset 0 0 0 1px #ddd"},dot:{background:"#000"}},transparent:{dot:{background:"#000"}}},{active:o,"color-#FFFFFF":r==="#FFFFFF",transparent:r==="transparent"});return $.createElement(_s,{style:l.color,color:r,onClick:i,onHover:s,focusStyle:{boxShadow:"0 0 4px "+r}},$.createElement("div",{style:l.dot}))},JB=function(e){var r=e.hex,n=e.rgb,i=e.onChange,s=Qe({default:{fields:{display:"flex",paddingBottom:"6px",paddingRight:"5px",position:"relative"},active:{position:"absolute",top:"6px",left:"5px",height:"9px",width:"9px",background:r},HEXwrap:{flex:"6",position:"relative"},HEXinput:{width:"80%",padding:"0px",paddingLeft:"20%",border:"none",outline:"none",background:"none",fontSize:"12px",color:"#333",height:"16px"},HEXlabel:{display:"none"},RGBwrap:{flex:"3",position:"relative"},RGBinput:{width:"70%",padding:"0px",paddingLeft:"30%",border:"none",outline:"none",background:"none",fontSize:"12px",color:"#333",height:"16px"},RGBlabel:{position:"absolute",top:"3px",left:"0px",lineHeight:"16px",textTransform:"uppercase",fontSize:"12px",color:"#999"}}}),o=function(c,d){c.r||c.g||c.b?i({r:c.r||n.r,g:c.g||n.g,b:c.b||n.b,source:"rgb"},d):i({hex:c.hex,source:"hex"},d)};return $.createElement("div",{style:s.fields,className:"flexbox-fix"},$.createElement("div",{style:s.active}),$.createElement(lt,{style:{wrap:s.HEXwrap,input:s.HEXinput,label:s.HEXlabel},label:"hex",value:r,onChange:o}),$.createElement(lt,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"r",value:n.r,onChange:o}),$.createElement(lt,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"g",value:n.g,onChange:o}),$.createElement(lt,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"b",value:n.b,onChange:o}))},nm=function(e){var r=e.onChange,n=e.onSwatchHover,i=e.colors,s=e.hex,o=e.rgb,l=e.styles,c=l===void 0?{}:l,d=e.className,u=d===void 0?"":d,f=Qe(kr({default:{Compact:{background:"#f6f6f6",radius:"4px"},compact:{paddingTop:"5px",paddingLeft:"5px",boxSizing:"initial",width:"240px"},clear:{clear:"both"}}},c)),h=function(g,m){g.hex?Hi(g.hex)&&r({hex:g.hex,source:"hex"},m):r(g,m)};return $.createElement(yl,{style:f.Compact,styles:c},$.createElement("div",{style:f.compact,className:"compact-picker "+u},$.createElement("div",null,Ss(i,function(p){return $.createElement(ZB,{key:p,color:p,active:p.toLowerCase()===s,onClick:h,onSwatchHover:n})}),$.createElement("div",{style:f.clear})),$.createElement(JB,{hex:s,rgb:o,onChange:h})))};nm.propTypes={colors:Te.arrayOf(Te.string),styles:Te.object};nm.defaultProps={colors:["#4D4D4D","#999999","#FFFFFF","#F44E3B","#FE9200","#FCDC00","#DBDF00","#A4DD00","#68CCCA","#73D8FF","#AEA1FF","#FDA1FF","#333333","#808080","#cccccc","#D33115","#E27300","#FCC400","#B0BC00","#68BC00","#16A5A5","#009CE0","#7B64FF","#FA28FF","#000000","#666666","#B3B3B3","#9F0500","#C45100","#FB9E00","#808900","#194D33","#0C797D","#0062B1","#653294","#AB149E"],styles:{}};jr(nm);var QB=function(e){var r=e.hover,n=e.color,i=e.onClick,s=e.onSwatchHover,o={position:"relative",zIndex:"2",outline:"2px solid #fff",boxShadow:"0 0 5px 2px rgba(0,0,0,0.25)"},l=Qe({default:{swatch:{width:"25px",height:"25px",fontSize:"0"}},hover:{swatch:o}},{hover:r});return $.createElement("div",{style:l.swatch},$.createElement(_s,{color:n,onClick:i,onHover:s,focusStyle:o}))};const e7=Bp(QB);var im=function(e){var r=e.width,n=e.colors,i=e.onChange,s=e.onSwatchHover,o=e.triangle,l=e.styles,c=l===void 0?{}:l,d=e.className,u=d===void 0?"":d,f=Qe(kr({default:{card:{width:r,background:"#fff",border:"1px solid rgba(0,0,0,0.2)",boxShadow:"0 3px 12px rgba(0,0,0,0.15)",borderRadius:"4px",position:"relative",padding:"5px",display:"flex",flexWrap:"wrap"},triangle:{position:"absolute",border:"7px solid transparent",borderBottomColor:"#fff"},triangleShadow:{position:"absolute",border:"8px solid transparent",borderBottomColor:"rgba(0,0,0,0.15)"}},"hide-triangle":{triangle:{display:"none"},triangleShadow:{display:"none"}},"top-left-triangle":{triangle:{top:"-14px",left:"10px"},triangleShadow:{top:"-16px",left:"9px"}},"top-right-triangle":{triangle:{top:"-14px",right:"10px"},triangleShadow:{top:"-16px",right:"9px"}},"bottom-left-triangle":{triangle:{top:"35px",left:"10px",transform:"rotate(180deg)"},triangleShadow:{top:"37px",left:"9px",transform:"rotate(180deg)"}},"bottom-right-triangle":{triangle:{top:"35px",right:"10px",transform:"rotate(180deg)"},triangleShadow:{top:"37px",right:"9px",transform:"rotate(180deg)"}}},c),{"hide-triangle":o==="hide","top-left-triangle":o==="top-left","top-right-triangle":o==="top-right","bottom-left-triangle":o==="bottom-left","bottom-right-triangle":o==="bottom-right"}),h=function(g,m){return i({hex:g,source:"hex"},m)};return $.createElement("div",{style:f.card,className:"github-picker "+u},$.createElement("div",{style:f.triangleShadow}),$.createElement("div",{style:f.triangle}),Ss(n,function(p){return $.createElement(e7,{color:p,key:p,onClick:h,onSwatchHover:s})}))};im.propTypes={width:Te.oneOfType([Te.string,Te.number]),colors:Te.arrayOf(Te.string),triangle:Te.oneOf(["hide","top-left","top-right","bottom-left","bottom-right"]),styles:Te.object};im.defaultProps={width:200,colors:["#B80000","#DB3E00","#FCCB00","#008B02","#006B76","#1273DE","#004DCF","#5300EB","#EB9694","#FAD0C3","#FEF3BD","#C1E1C5","#BEDADC","#C4DEF6","#BED3F3","#D4C4FB"],triangle:"top-left",styles:{}};jr(im);var t7=function(e){var r=e.direction,n=Qe({default:{picker:{width:"18px",height:"18px",borderRadius:"50%",transform:"translate(-9px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}},vertical:{picker:{transform:"translate(-3px, -9px)"}}},{vertical:r==="vertical"});return $.createElement("div",{style:n.picker})},r7=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},sm=function(e){var r=e.width,n=e.height,i=e.onChange,s=e.hsl,o=e.direction,l=e.pointer,c=e.styles,d=c===void 0?{}:c,u=e.className,f=u===void 0?"":u,h=Qe(kr({default:{picker:{position:"relative",width:r,height:n},hue:{radius:"2px"}}},d)),p=function(m){return i({a:1,h:m.h,l:.5,s:1})};return $.createElement("div",{style:h.picker,className:"hue-picker "+f},$.createElement(Xo,r7({},h.hue,{hsl:s,pointer:l,onChange:p,direction:o})))};sm.propTypes={styles:Te.object};sm.defaultProps={width:"316px",height:"16px",direction:"horizontal",pointer:t7,styles:{}};jr(sm);var n7=function(e){var r=e.onChange,n=e.hex,i=e.rgb,s=e.styles,o=s===void 0?{}:s,l=e.className,c=l===void 0?"":l,d=Qe(kr({default:{material:{width:"98px",height:"98px",padding:"16px",fontFamily:"Roboto"},HEXwrap:{position:"relative"},HEXinput:{width:"100%",marginTop:"12px",fontSize:"15px",color:"#333",padding:"0px",border:"0px",borderBottom:"2px solid "+n,outline:"none",height:"30px"},HEXlabel:{position:"absolute",top:"0px",left:"0px",fontSize:"11px",color:"#999999",textTransform:"capitalize"},Hex:{style:{}},RGBwrap:{position:"relative"},RGBinput:{width:"100%",marginTop:"12px",fontSize:"15px",color:"#333",padding:"0px",border:"0px",borderBottom:"1px solid #eee",outline:"none",height:"30px"},RGBlabel:{position:"absolute",top:"0px",left:"0px",fontSize:"11px",color:"#999999",textTransform:"capitalize"},split:{display:"flex",marginRight:"-10px",paddingTop:"11px"},third:{flex:"1",paddingRight:"10px"}}},o)),u=function(h,p){h.hex?Hi(h.hex)&&r({hex:h.hex,source:"hex"},p):(h.r||h.g||h.b)&&r({r:h.r||i.r,g:h.g||i.g,b:h.b||i.b,source:"rgb"},p)};return $.createElement(yl,{styles:o},$.createElement("div",{style:d.material,className:"material-picker "+c},$.createElement(lt,{style:{wrap:d.HEXwrap,input:d.HEXinput,label:d.HEXlabel},label:"hex",value:n,onChange:u}),$.createElement("div",{style:d.split,className:"flexbox-fix"},$.createElement("div",{style:d.third},$.createElement(lt,{style:{wrap:d.RGBwrap,input:d.RGBinput,label:d.RGBlabel},label:"r",value:i.r,onChange:u})),$.createElement("div",{style:d.third},$.createElement(lt,{style:{wrap:d.RGBwrap,input:d.RGBinput,label:d.RGBlabel},label:"g",value:i.g,onChange:u})),$.createElement("div",{style:d.third},$.createElement(lt,{style:{wrap:d.RGBwrap,input:d.RGBinput,label:d.RGBlabel},label:"b",value:i.b,onChange:u})))))};jr(n7);var i7=function(e){var r=e.onChange,n=e.rgb,i=e.hsv,s=e.hex,o=Qe({default:{fields:{paddingTop:"5px",paddingBottom:"9px",width:"80px",position:"relative"},divider:{height:"5px"},RGBwrap:{position:"relative"},RGBinput:{marginLeft:"40%",width:"40%",height:"18px",border:"1px solid #888888",boxShadow:"inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC",marginBottom:"5px",fontSize:"13px",paddingLeft:"3px",marginRight:"10px"},RGBlabel:{left:"0px",top:"0px",width:"34px",textTransform:"uppercase",fontSize:"13px",height:"18px",lineHeight:"22px",position:"absolute"},HEXwrap:{position:"relative"},HEXinput:{marginLeft:"20%",width:"80%",height:"18px",border:"1px solid #888888",boxShadow:"inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC",marginBottom:"6px",fontSize:"13px",paddingLeft:"3px"},HEXlabel:{position:"absolute",top:"0px",left:"0px",width:"14px",textTransform:"uppercase",fontSize:"13px",height:"18px",lineHeight:"22px"},fieldSymbols:{position:"absolute",top:"5px",right:"-7px",fontSize:"13px"},symbol:{height:"20px",lineHeight:"22px",paddingBottom:"7px"}}}),l=function(d,u){d["#"]?Hi(d["#"])&&r({hex:d["#"],source:"hex"},u):d.r||d.g||d.b?r({r:d.r||n.r,g:d.g||n.g,b:d.b||n.b,source:"rgb"},u):(d.h||d.s||d.v)&&r({h:d.h||i.h,s:d.s||i.s,v:d.v||i.v,source:"hsv"},u)};return $.createElement("div",{style:o.fields},$.createElement(lt,{style:{wrap:o.RGBwrap,input:o.RGBinput,label:o.RGBlabel},label:"h",value:Math.round(i.h),onChange:l}),$.createElement(lt,{style:{wrap:o.RGBwrap,input:o.RGBinput,label:o.RGBlabel},label:"s",value:Math.round(i.s*100),onChange:l}),$.createElement(lt,{style:{wrap:o.RGBwrap,input:o.RGBinput,label:o.RGBlabel},label:"v",value:Math.round(i.v*100),onChange:l}),$.createElement("div",{style:o.divider}),$.createElement(lt,{style:{wrap:o.RGBwrap,input:o.RGBinput,label:o.RGBlabel},label:"r",value:n.r,onChange:l}),$.createElement(lt,{style:{wrap:o.RGBwrap,input:o.RGBinput,label:o.RGBlabel},label:"g",value:n.g,onChange:l}),$.createElement(lt,{style:{wrap:o.RGBwrap,input:o.RGBinput,label:o.RGBlabel},label:"b",value:n.b,onChange:l}),$.createElement("div",{style:o.divider}),$.createElement(lt,{style:{wrap:o.HEXwrap,input:o.HEXinput,label:o.HEXlabel},label:"#",value:s.replace("#",""),onChange:l}),$.createElement("div",{style:o.fieldSymbols},$.createElement("div",{style:o.symbol},""),$.createElement("div",{style:o.symbol},"%"),$.createElement("div",{style:o.symbol},"%")))},s7=function(e){var r=e.hsl,n=Qe({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",boxShadow:"inset 0 0 0 1px #fff",transform:"translate(-6px, -6px)"}},"black-outline":{picker:{boxShadow:"inset 0 0 0 1px #000"}}},{"black-outline":r.l>.5});return $.createElement("div",{style:n.picker})},o7=function(){var e=Qe({default:{triangle:{width:0,height:0,borderStyle:"solid",borderWidth:"4px 0 4px 6px",borderColor:"transparent transparent transparent #fff",position:"absolute",top:"1px",left:"1px"},triangleBorder:{width:0,height:0,borderStyle:"solid",borderWidth:"5px 0 5px 8px",borderColor:"transparent transparent transparent #555"},left:{Extend:"triangleBorder",transform:"translate(-13px, -4px)"},leftInside:{Extend:"triangle",transform:"translate(-8px, -5px)"},right:{Extend:"triangleBorder",transform:"translate(20px, -14px) rotate(180deg)"},rightInside:{Extend:"triangle",transform:"translate(-8px, -5px)"}}});return $.createElement("div",{style:e.pointer},$.createElement("div",{style:e.left},$.createElement("div",{style:e.leftInside})),$.createElement("div",{style:e.right},$.createElement("div",{style:e.rightInside})))},ry=function(e){var r=e.onClick,n=e.label,i=e.children,s=e.active,o=Qe({default:{button:{backgroundImage:"linear-gradient(-180deg, #FFFFFF 0%, #E6E6E6 100%)",border:"1px solid #878787",borderRadius:"2px",height:"20px",boxShadow:"0 1px 0 0 #EAEAEA",fontSize:"14px",color:"#000",lineHeight:"20px",textAlign:"center",marginBottom:"10px",cursor:"pointer"}},active:{button:{boxShadow:"0 0 0 1px #878787"}}},{active:s});return $.createElement("div",{style:o.button,onClick:r},n||i)},a7=function(e){var r=e.rgb,n=e.currentColor,i=Qe({default:{swatches:{border:"1px solid #B3B3B3",borderBottom:"1px solid #F0F0F0",marginBottom:"2px",marginTop:"1px"},new:{height:"34px",background:"rgb("+r.r+","+r.g+", "+r.b+")",boxShadow:"inset 1px 0 0 #000, inset -1px 0 0 #000, inset 0 1px 0 #000"},current:{height:"34px",background:n,boxShadow:"inset 1px 0 0 #000, inset -1px 0 0 #000, inset 0 -1px 0 #000"},label:{fontSize:"14px",color:"#000",textAlign:"center"}}});return $.createElement("div",null,$.createElement("div",{style:i.label},"new"),$.createElement("div",{style:i.swatches},$.createElement("div",{style:i.new}),$.createElement("div",{style:i.current})),$.createElement("div",{style:i.label},"current"))},l7=function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();function c7(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d7(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function u7(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var om=function(t){u7(e,t);function e(r){c7(this,e);var n=d7(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.state={currentColor:r.hex},n}return l7(e,[{key:"render",value:function(){var n=this.props,i=n.styles,s=i===void 0?{}:i,o=n.className,l=o===void 0?"":o,c=Qe(kr({default:{picker:{background:"#DCDCDC",borderRadius:"4px",boxShadow:"0 0 0 1px rgba(0,0,0,.25), 0 8px 16px rgba(0,0,0,.15)",boxSizing:"initial",width:"513px"},head:{backgroundImage:"linear-gradient(-180deg, #F0F0F0 0%, #D4D4D4 100%)",borderBottom:"1px solid #B1B1B1",boxShadow:"inset 0 1px 0 0 rgba(255,255,255,.2), inset 0 -1px 0 0 rgba(0,0,0,.02)",height:"23px",lineHeight:"24px",borderRadius:"4px 4px 0 0",fontSize:"13px",color:"#4D4D4D",textAlign:"center"},body:{padding:"15px 15px 0",display:"flex"},saturation:{width:"256px",height:"256px",position:"relative",border:"2px solid #B3B3B3",borderBottom:"2px solid #F0F0F0",overflow:"hidden"},hue:{position:"relative",height:"256px",width:"19px",marginLeft:"10px",border:"2px solid #B3B3B3",borderBottom:"2px solid #F0F0F0"},controls:{width:"180px",marginLeft:"10px"},top:{display:"flex"},previews:{width:"60px"},actions:{flex:"1",marginLeft:"20px"}}},s));return $.createElement("div",{style:c.picker,className:"photoshop-picker "+l},$.createElement("div",{style:c.head},this.props.header),$.createElement("div",{style:c.body,className:"flexbox-fix"},$.createElement("div",{style:c.saturation},$.createElement(Id,{hsl:this.props.hsl,hsv:this.props.hsv,pointer:s7,onChange:this.props.onChange})),$.createElement("div",{style:c.hue},$.createElement(Xo,{direction:"vertical",hsl:this.props.hsl,pointer:o7,onChange:this.props.onChange})),$.createElement("div",{style:c.controls},$.createElement("div",{style:c.top,className:"flexbox-fix"},$.createElement("div",{style:c.previews},$.createElement(a7,{rgb:this.props.rgb,currentColor:this.state.currentColor})),$.createElement("div",{style:c.actions},$.createElement(ry,{label:"OK",onClick:this.props.onAccept,active:!0}),$.createElement(ry,{label:"Cancel",onClick:this.props.onCancel}),$.createElement(i7,{onChange:this.props.onChange,rgb:this.props.rgb,hsv:this.props.hsv,hex:this.props.hex}))))))}}]),e}($.Component);om.propTypes={header:Te.string,styles:Te.object};om.defaultProps={header:"Color Picker",styles:{}};jr(om);var h7=function(e){var r=e.onChange,n=e.rgb,i=e.hsl,s=e.hex,o=e.disableAlpha,l=Qe({default:{fields:{display:"flex",paddingTop:"4px"},single:{flex:"1",paddingLeft:"6px"},alpha:{flex:"1",paddingLeft:"6px"},double:{flex:"2"},input:{width:"80%",padding:"4px 10% 3px",border:"none",boxShadow:"inset 0 0 0 1px #ccc",fontSize:"11px"},label:{display:"block",textAlign:"center",fontSize:"11px",color:"#222",paddingTop:"3px",paddingBottom:"4px",textTransform:"capitalize"}},disableAlpha:{alpha:{display:"none"}}},{disableAlpha:o}),c=function(u,f){u.hex?Hi(u.hex)&&r({hex:u.hex,source:"hex"},f):u.r||u.g||u.b?r({r:u.r||n.r,g:u.g||n.g,b:u.b||n.b,a:n.a,source:"rgb"},f):u.a&&(u.a<0?u.a=0:u.a>100&&(u.a=100),u.a/=100,r({h:i.h,s:i.s,l:i.l,a:u.a,source:"rgb"},f))};return $.createElement("div",{style:l.fields,className:"flexbox-fix"},$.createElement("div",{style:l.double},$.createElement(lt,{style:{input:l.input,label:l.label},label:"hex",value:s.replace("#",""),onChange:c})),$.createElement("div",{style:l.single},$.createElement(lt,{style:{input:l.input,label:l.label},label:"r",value:n.r,onChange:c,dragLabel:"true",dragMax:"255"})),$.createElement("div",{style:l.single},$.createElement(lt,{style:{input:l.input,label:l.label},label:"g",value:n.g,onChange:c,dragLabel:"true",dragMax:"255"})),$.createElement("div",{style:l.single},$.createElement(lt,{style:{input:l.input,label:l.label},label:"b",value:n.b,onChange:c,dragLabel:"true",dragMax:"255"})),$.createElement("div",{style:l.alpha},$.createElement(lt,{style:{input:l.input,label:l.label},label:"a",value:Math.round(n.a*100),onChange:c,dragLabel:"true",dragMax:"100"})))},f7=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},c_=function(e){var r=e.colors,n=e.onClick,i=n===void 0?function(){}:n,s=e.onSwatchHover,o=Qe({default:{colors:{margin:"0 -10px",padding:"10px 0 0 10px",borderTop:"1px solid #eee",display:"flex",flexWrap:"wrap",position:"relative"},swatchWrap:{width:"16px",height:"16px",margin:"0 10px 10px 0"},swatch:{borderRadius:"3px",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15)"}},"no-presets":{colors:{display:"none"}}},{"no-presets":!r||!r.length}),l=function(d,u){i({hex:d,source:"hex"},u)};return $.createElement("div",{style:o.colors,className:"flexbox-fix"},r.map(function(c){var d=typeof c=="string"?{color:c}:c,u=""+d.color+(d.title||"");return $.createElement("div",{key:u,style:o.swatchWrap},$.createElement(_s,f7({},d,{style:o.swatch,onClick:l,onHover:s,focusStyle:{boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15), 0 0 4px "+d.color}})))}))};c_.propTypes={colors:Te.arrayOf(Te.oneOfType([Te.string,Te.shape({color:Te.string,title:Te.string})])).isRequired};var p7=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},am=function(e){var r=e.width,n=e.rgb,i=e.hex,s=e.hsv,o=e.hsl,l=e.onChange,c=e.onSwatchHover,d=e.disableAlpha,u=e.presetColors,f=e.renderers,h=e.styles,p=h===void 0?{}:h,g=e.className,m=g===void 0?"":g,x=Qe(kr({default:p7({picker:{width:r,padding:"10px 10px 0",boxSizing:"initial",background:"#fff",borderRadius:"4px",boxShadow:"0 0 0 1px rgba(0,0,0,.15), 0 8px 16px rgba(0,0,0,.15)"},saturation:{width:"100%",paddingBottom:"75%",position:"relative",overflow:"hidden"},Saturation:{radius:"3px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},controls:{display:"flex"},sliders:{padding:"4px 0",flex:"1"},color:{width:"24px",height:"24px",position:"relative",marginTop:"4px",marginLeft:"4px",borderRadius:"3px"},activeColor:{absolute:"0px 0px 0px 0px",borderRadius:"2px",background:"rgba("+n.r+","+n.g+","+n.b+","+n.a+")",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},hue:{position:"relative",height:"10px",overflow:"hidden"},Hue:{radius:"2px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},alpha:{position:"relative",height:"10px",marginTop:"4px",overflow:"hidden"},Alpha:{radius:"2px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"}},p),disableAlpha:{color:{height:"10px"},hue:{height:"10px"},alpha:{display:"none"}}},p),{disableAlpha:d});return $.createElement("div",{style:x.picker,className:"sketch-picker "+m},$.createElement("div",{style:x.saturation},$.createElement(Id,{style:x.Saturation,hsl:o,hsv:s,onChange:l})),$.createElement("div",{style:x.controls,className:"flexbox-fix"},$.createElement("div",{style:x.sliders},$.createElement("div",{style:x.hue},$.createElement(Xo,{style:x.Hue,hsl:o,onChange:l})),$.createElement("div",{style:x.alpha},$.createElement(Hp,{style:x.Alpha,rgb:n,hsl:o,renderers:f,onChange:l}))),$.createElement("div",{style:x.color},$.createElement(Yo,null),$.createElement("div",{style:x.activeColor}))),$.createElement(h7,{rgb:n,hsl:o,hex:i,onChange:l,disableAlpha:d}),$.createElement(c_,{colors:u,onClick:l,onSwatchHover:c}))};am.propTypes={disableAlpha:Te.bool,width:Te.oneOfType([Te.string,Te.number]),styles:Te.object};am.defaultProps={disableAlpha:!1,width:200,styles:{},presetColors:["#D0021B","#F5A623","#F8E71C","#8B572A","#7ED321","#417505","#BD10E0","#9013FE","#4A90E2","#50E3C2","#B8E986","#000000","#4A4A4A","#9B9B9B","#FFFFFF"]};jr(am);var da=function(e){var r=e.hsl,n=e.offset,i=e.onClick,s=i===void 0?function(){}:i,o=e.active,l=e.first,c=e.last,d=Qe({default:{swatch:{height:"12px",background:"hsl("+r.h+", 50%, "+n*100+"%)",cursor:"pointer"}},first:{swatch:{borderRadius:"2px 0 0 2px"}},last:{swatch:{borderRadius:"0 2px 2px 0"}},active:{swatch:{transform:"scaleY(1.8)",borderRadius:"3.6px/2px"}}},{active:o,first:l,last:c}),u=function(h){return s({h:r.h,s:.5,l:n,source:"hsl"},h)};return $.createElement("div",{style:d.swatch,onClick:u})},m7=function(e){var r=e.onClick,n=e.hsl,i=Qe({default:{swatches:{marginTop:"20px"},swatch:{boxSizing:"border-box",width:"20%",paddingRight:"1px",float:"left"},clear:{clear:"both"}}}),s=.1;return $.createElement("div",{style:i.swatches},$.createElement("div",{style:i.swatch},$.createElement(da,{hsl:n,offset:".80",active:Math.abs(n.l-.8)<s&&Math.abs(n.s-.5)<s,onClick:r,first:!0})),$.createElement("div",{style:i.swatch},$.createElement(da,{hsl:n,offset:".65",active:Math.abs(n.l-.65)<s&&Math.abs(n.s-.5)<s,onClick:r})),$.createElement("div",{style:i.swatch},$.createElement(da,{hsl:n,offset:".50",active:Math.abs(n.l-.5)<s&&Math.abs(n.s-.5)<s,onClick:r})),$.createElement("div",{style:i.swatch},$.createElement(da,{hsl:n,offset:".35",active:Math.abs(n.l-.35)<s&&Math.abs(n.s-.5)<s,onClick:r})),$.createElement("div",{style:i.swatch},$.createElement(da,{hsl:n,offset:".20",active:Math.abs(n.l-.2)<s&&Math.abs(n.s-.5)<s,onClick:r,last:!0})),$.createElement("div",{style:i.clear}))},g7=function(){var e=Qe({default:{picker:{width:"14px",height:"14px",borderRadius:"6px",transform:"translate(-7px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}}});return $.createElement("div",{style:e.picker})},lm=function(e){var r=e.hsl,n=e.onChange,i=e.pointer,s=e.styles,o=s===void 0?{}:s,l=e.className,c=l===void 0?"":l,d=Qe(kr({default:{hue:{height:"12px",position:"relative"},Hue:{radius:"2px"}}},o));return $.createElement("div",{style:d.wrap||{},className:"slider-picker "+c},$.createElement("div",{style:d.hue},$.createElement(Xo,{style:d.Hue,hsl:r,pointer:i,onChange:n})),$.createElement("div",{style:d.swatches},$.createElement(m7,{hsl:r,onClick:n})))};lm.propTypes={styles:Te.object};lm.defaultProps={pointer:g7,styles:{}};jr(lm);var d_={};Object.defineProperty(d_,"__esModule",{value:!0});var ny=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},v7=P,iy=y7(v7);function y7(t){return t&&t.__esModule?t:{default:t}}function x7(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}var Ql=24,b7=d_.default=function(t){var e=t.fill,r=e===void 0?"currentColor":e,n=t.width,i=n===void 0?Ql:n,s=t.height,o=s===void 0?Ql:s,l=t.style,c=l===void 0?{}:l,d=x7(t,["fill","width","height","style"]);return iy.default.createElement("svg",ny({viewBox:"0 0 "+Ql+" "+Ql,style:ny({fill:r,width:i,height:o},c)},d),iy.default.createElement("path",{d:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"}))},w7=function(e){var r=e.color,n=e.onClick,i=n===void 0?function(){}:n,s=e.onSwatchHover,o=e.first,l=e.last,c=e.active,d=Qe({default:{color:{width:"40px",height:"24px",cursor:"pointer",background:r,marginBottom:"1px"},check:{color:Kp(r),marginLeft:"8px",display:"none"}},first:{color:{overflow:"hidden",borderRadius:"2px 2px 0 0"}},last:{color:{overflow:"hidden",borderRadius:"0 0 2px 2px"}},active:{check:{display:"block"}},"color-#FFFFFF":{color:{boxShadow:"inset 0 0 0 1px #ddd"},check:{color:"#333"}},transparent:{check:{color:"#333"}}},{first:o,last:l,active:c,"color-#FFFFFF":r==="#FFFFFF",transparent:r==="transparent"});return $.createElement(_s,{color:r,style:d.color,onClick:i,onHover:s,focusStyle:{boxShadow:"0 0 4px "+r}},$.createElement("div",{style:d.check},$.createElement(b7,null)))},_7=function(e){var r=e.onClick,n=e.onSwatchHover,i=e.group,s=e.active,o=Qe({default:{group:{paddingBottom:"10px",width:"40px",float:"left",marginRight:"10px"}}});return $.createElement("div",{style:o.group},Ss(i,function(l,c){return $.createElement(w7,{key:l,color:l,active:l.toLowerCase()===s,first:c===0,last:c===i.length-1,onClick:r,onSwatchHover:n})}))},cm=function(e){var r=e.width,n=e.height,i=e.onChange,s=e.onSwatchHover,o=e.colors,l=e.hex,c=e.styles,d=c===void 0?{}:c,u=e.className,f=u===void 0?"":u,h=Qe(kr({default:{picker:{width:r,height:n},overflow:{height:n,overflowY:"scroll"},body:{padding:"16px 0 6px 16px"},clear:{clear:"both"}}},d)),p=function(m,x){return i({hex:m,source:"hex"},x)};return $.createElement("div",{style:h.picker,className:"swatches-picker "+f},$.createElement(yl,null,$.createElement("div",{style:h.overflow},$.createElement("div",{style:h.body},Ss(o,function(g){return $.createElement(_7,{key:g.toString(),group:g,active:l,onClick:p,onSwatchHover:s})}),$.createElement("div",{style:h.clear})))))};cm.propTypes={width:Te.oneOfType([Te.string,Te.number]),height:Te.oneOfType([Te.string,Te.number]),colors:Te.arrayOf(Te.arrayOf(Te.string)),styles:Te.object};cm.defaultProps={width:320,height:240,colors:[[Bs[900],Bs[700],Bs[500],Bs[300],Bs[100]],[Hs[900],Hs[700],Hs[500],Hs[300],Hs[100]],[Us[900],Us[700],Us[500],Us[300],Us[100]],[Ws[900],Ws[700],Ws[500],Ws[300],Ws[100]],[Gs[900],Gs[700],Gs[500],Gs[300],Gs[100]],[Vs[900],Vs[700],Vs[500],Vs[300],Vs[100]],[qs[900],qs[700],qs[500],qs[300],qs[100]],[Ys[900],Ys[700],Ys[500],Ys[300],Ys[100]],[Xs[900],Xs[700],Xs[500],Xs[300],Xs[100]],["#194D33",ba[700],ba[500],ba[300],ba[100]],[Ks[900],Ks[700],Ks[500],Ks[300],Ks[100]],[Zs[900],Zs[700],Zs[500],Zs[300],Zs[100]],[Js[900],Js[700],Js[500],Js[300],Js[100]],[Qs[900],Qs[700],Qs[500],Qs[300],Qs[100]],[eo[900],eo[700],eo[500],eo[300],eo[100]],[to[900],to[700],to[500],to[300],to[100]],[ro[900],ro[700],ro[500],ro[300],ro[100]],[no[900],no[700],no[500],no[300],no[100]],["#000000","#525252","#969696","#D9D9D9","#FFFFFF"]],styles:{}};jr(cm);var dm=function(e){var r=e.onChange,n=e.onSwatchHover,i=e.hex,s=e.colors,o=e.width,l=e.triangle,c=e.styles,d=c===void 0?{}:c,u=e.className,f=u===void 0?"":u,h=Qe(kr({default:{card:{width:o,background:"#fff",border:"0 solid rgba(0,0,0,0.25)",boxShadow:"0 1px 4px rgba(0,0,0,0.25)",borderRadius:"4px",position:"relative"},body:{padding:"15px 9px 9px 15px"},label:{fontSize:"18px",color:"#fff"},triangle:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 9px 10px 9px",borderColor:"transparent transparent #fff transparent",position:"absolute"},triangleShadow:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 9px 10px 9px",borderColor:"transparent transparent rgba(0,0,0,.1) transparent",position:"absolute"},hash:{background:"#F0F0F0",height:"30px",width:"30px",borderRadius:"4px 0 0 4px",float:"left",color:"#98A1A4",display:"flex",alignItems:"center",justifyContent:"center"},input:{width:"100px",fontSize:"14px",color:"#666",border:"0px",outline:"none",height:"28px",boxShadow:"inset 0 0 0 1px #F0F0F0",boxSizing:"content-box",borderRadius:"0 4px 4px 0",float:"left",paddingLeft:"8px"},swatch:{width:"30px",height:"30px",float:"left",borderRadius:"4px",margin:"0 6px 6px 0"},clear:{clear:"both"}},"hide-triangle":{triangle:{display:"none"},triangleShadow:{display:"none"}},"top-left-triangle":{triangle:{top:"-10px",left:"12px"},triangleShadow:{top:"-11px",left:"12px"}},"top-right-triangle":{triangle:{top:"-10px",right:"12px"},triangleShadow:{top:"-11px",right:"12px"}}},d),{"hide-triangle":l==="hide","top-left-triangle":l==="top-left","top-right-triangle":l==="top-right"}),p=function(m,x){Hi(m)&&r({hex:m,source:"hex"},x)};return $.createElement("div",{style:h.card,className:"twitter-picker "+f},$.createElement("div",{style:h.triangleShadow}),$.createElement("div",{style:h.triangle}),$.createElement("div",{style:h.body},Ss(s,function(g,m){return $.createElement(_s,{key:m,color:g,hex:g,style:h.swatch,onClick:p,onHover:n,focusStyle:{boxShadow:"0 0 4px "+g}})}),$.createElement("div",{style:h.hash},"#"),$.createElement(lt,{label:null,style:{input:h.input},value:i.replace("#",""),onChange:p}),$.createElement("div",{style:h.clear})))};dm.propTypes={width:Te.oneOfType([Te.string,Te.number]),triangle:Te.oneOf(["hide","top-left","top-right"]),colors:Te.arrayOf(Te.string),styles:Te.object};dm.defaultProps={width:276,colors:["#FF6900","#FCB900","#7BDCB5","#00D084","#8ED1FC","#0693E3","#ABB8C3","#EB144C","#F78DA7","#9900EF"],triangle:"top-left",styles:{}};jr(dm);var um=function(e){var r=Qe({default:{picker:{width:"20px",height:"20px",borderRadius:"22px",border:"2px #fff solid",transform:"translate(-12px, -13px)",background:"hsl("+Math.round(e.hsl.h)+", "+Math.round(e.hsl.s*100)+"%, "+Math.round(e.hsl.l*100)+"%)"}}});return $.createElement("div",{style:r.picker})};um.propTypes={hsl:Te.shape({h:Te.number,s:Te.number,l:Te.number,a:Te.number})};um.defaultProps={hsl:{a:1,h:249.94,l:.2,s:.5}};var hm=function(e){var r=Qe({default:{picker:{width:"20px",height:"20px",borderRadius:"22px",transform:"translate(-10px, -7px)",background:"hsl("+Math.round(e.hsl.h)+", 100%, 50%)",border:"2px white solid"}}});return $.createElement("div",{style:r.picker})};hm.propTypes={hsl:Te.shape({h:Te.number,s:Te.number,l:Te.number,a:Te.number})};hm.defaultProps={hsl:{a:1,h:249.94,l:.2,s:.5}};var S7=function(e){var r=e.onChange,n=e.rgb,i=e.hsl,s=e.hex,o=e.hsv,l=function(p,g){if(p.hex)Hi(p.hex)&&r({hex:p.hex,source:"hex"},g);else if(p.rgb){var m=p.rgb.split(",");zu(p.rgb,"rgb")&&r({r:m[0],g:m[1],b:m[2],a:1,source:"rgb"},g)}else if(p.hsv){var x=p.hsv.split(",");zu(p.hsv,"hsv")&&(x[2]=x[2].replace("%",""),x[1]=x[1].replace("%",""),x[0]=x[0].replace("",""),x[1]==1?x[1]=.01:x[2]==1&&(x[2]=.01),r({h:Number(x[0]),s:Number(x[1]),v:Number(x[2]),source:"hsv"},g))}else if(p.hsl){var v=p.hsl.split(",");zu(p.hsl,"hsl")&&(v[2]=v[2].replace("%",""),v[1]=v[1].replace("%",""),v[0]=v[0].replace("",""),f[1]==1?f[1]=.01:f[2]==1&&(f[2]=.01),r({h:Number(v[0]),s:Number(v[1]),v:Number(v[2]),source:"hsl"},g))}},c=Qe({default:{wrap:{display:"flex",height:"100px",marginTop:"4px"},fields:{width:"100%"},column:{paddingTop:"10px",display:"flex",justifyContent:"space-between"},double:{padding:"0px 4.4px",boxSizing:"border-box"},input:{width:"100%",height:"38px",boxSizing:"border-box",padding:"4px 10% 3px",textAlign:"center",border:"1px solid #dadce0",fontSize:"11px",textTransform:"lowercase",borderRadius:"5px",outline:"none",fontFamily:"Roboto,Arial,sans-serif"},input2:{height:"38px",width:"100%",border:"1px solid #dadce0",boxSizing:"border-box",fontSize:"11px",textTransform:"lowercase",borderRadius:"5px",outline:"none",paddingLeft:"10px",fontFamily:"Roboto,Arial,sans-serif"},label:{textAlign:"center",fontSize:"12px",background:"#fff",position:"absolute",textTransform:"uppercase",color:"#3c4043",width:"35px",top:"-6px",left:"0",right:"0",marginLeft:"auto",marginRight:"auto",fontFamily:"Roboto,Arial,sans-serif"},label2:{left:"10px",textAlign:"center",fontSize:"12px",background:"#fff",position:"absolute",textTransform:"uppercase",color:"#3c4043",width:"32px",top:"-6px",fontFamily:"Roboto,Arial,sans-serif"},single:{flexGrow:"1",margin:"0px 4.4px"}}}),d=n.r+", "+n.g+", "+n.b,u=Math.round(i.h)+", "+Math.round(i.s*100)+"%, "+Math.round(i.l*100)+"%",f=Math.round(o.h)+", "+Math.round(o.s*100)+"%, "+Math.round(o.v*100)+"%";return $.createElement("div",{style:c.wrap,className:"flexbox-fix"},$.createElement("div",{style:c.fields},$.createElement("div",{style:c.double},$.createElement(lt,{style:{input:c.input,label:c.label},label:"hex",value:s,onChange:l})),$.createElement("div",{style:c.column},$.createElement("div",{style:c.single},$.createElement(lt,{style:{input:c.input2,label:c.label2},label:"rgb",value:d,onChange:l})),$.createElement("div",{style:c.single},$.createElement(lt,{style:{input:c.input2,label:c.label2},label:"hsv",value:f,onChange:l})),$.createElement("div",{style:c.single},$.createElement(lt,{style:{input:c.input2,label:c.label2},label:"hsl",value:u,onChange:l})))))},fm=function(e){var r=e.width,n=e.onChange,i=e.rgb,s=e.hsl,o=e.hsv,l=e.hex,c=e.header,d=e.styles,u=d===void 0?{}:d,f=e.className,h=f===void 0?"":f,p=Qe(kr({default:{picker:{width:r,background:"#fff",border:"1px solid #dfe1e5",boxSizing:"initial",display:"flex",flexWrap:"wrap",borderRadius:"8px 8px 0px 0px"},head:{height:"57px",width:"100%",paddingTop:"16px",paddingBottom:"16px",paddingLeft:"16px",fontSize:"20px",boxSizing:"border-box",fontFamily:"Roboto-Regular,HelveticaNeue,Arial,sans-serif"},saturation:{width:"70%",padding:"0px",position:"relative",overflow:"hidden"},swatch:{width:"30%",height:"228px",padding:"0px",background:"rgba("+i.r+", "+i.g+", "+i.b+", 1)",position:"relative",overflow:"hidden"},body:{margin:"auto",width:"95%"},controls:{display:"flex",boxSizing:"border-box",height:"52px",paddingTop:"22px"},color:{width:"32px"},hue:{height:"8px",position:"relative",margin:"0px 16px 0px 16px",width:"100%"},Hue:{radius:"2px"}}},u));return $.createElement("div",{style:p.picker,className:"google-picker "+h},$.createElement("div",{style:p.head},c),$.createElement("div",{style:p.swatch}),$.createElement("div",{style:p.saturation},$.createElement(Id,{hsl:s,hsv:o,pointer:um,onChange:n})),$.createElement("div",{style:p.body},$.createElement("div",{style:p.controls,className:"flexbox-fix"},$.createElement("div",{style:p.hue},$.createElement(Xo,{style:p.Hue,hsl:s,radius:"4px",pointer:hm,onChange:n}))),$.createElement(S7,{rgb:i,hsl:s,hex:l,hsv:o,onChange:n})))};fm.propTypes={width:Te.oneOfType([Te.string,Te.number]),styles:Te.object,header:Te.string};fm.defaultProps={width:652,styles:{},header:"Color picker"};jr(fm);function k7({color:t,mode:e="blend",onColorChange:r,onClose:n}){var f;const[i,s]=P.useState((t==null?void 0:t.hex)||"#000000");P.useEffect(()=>{t!=null&&t.hex&&s(t.hex)},[t==null?void 0:t.hex]);const o=h=>{const p=h.hex;s(p),r&&r(p)},l=()=>{t!=null&&t.originalHex&&(s(t.originalHex),r&&r(t.originalHex))},c=h=>{const p=h.hex;s(p),r&&r(p)},d=()=>{s("transparent"),r&&r("transparent")},u=i==="transparent"||i==="none";return t?a.jsxs("div",{className:"color-editor-panel",children:[a.jsxs("div",{className:"editor-header",children:[a.jsx("h3",{children:"Edit Colour"}),a.jsx("button",{onClick:n,className:"close-button",children:""})]}),a.jsxs("div",{className:"editor-content",children:[a.jsxs("div",{className:"color-info-section",children:[a.jsx("div",{className:"color-display",children:a.jsxs("div",{className:"swatch-pair",children:[a.jsxs("div",{className:"swatch-group",children:[a.jsx("div",{className:"swatch original",style:{backgroundColor:t.originalHex||t.hex},title:"Original colour"}),a.jsx("span",{className:"swatch-label",children:"Original"})]}),a.jsx("span",{className:"arrow",children:""}),a.jsxs("div",{className:"swatch-group",children:[a.jsx("div",{className:`swatch current ${u?"transparent-preview":""}`,style:u?{}:{backgroundColor:i},title:"Current colour"}),a.jsx("span",{className:"swatch-label",children:u?"Transparent":"Current"})]})]})}),a.jsxs("div",{className:"color-details",children:[a.jsxs("div",{className:"detail-row",children:[a.jsx("span",{className:"label",children:"Hex:"}),a.jsx("span",{className:"value",children:i})]}),a.jsxs("div",{className:"detail-row",children:[a.jsx("span",{className:"label",children:"Coverage:"}),a.jsxs("span",{className:"value",children:[((f=t.areaPct)==null?void 0:f.toFixed(1))||0,"%"]})]})]})]}),a.jsxs("div",{className:"transparent-section",children:[a.jsx("h4",{children:"Remove Fill"}),a.jsxs("button",{className:`transparent-option ${u?"selected":""}`,onClick:d,title:"Make this area transparent (remove fill)",children:[a.jsx("div",{className:"transparent-swatch"}),a.jsx("span",{children:"Make Transparent"})]})]}),a.jsxs("div",{className:"tpv-palette-section",children:[a.jsx("h4",{children:"Standard TPV Colours"}),a.jsx("p",{className:"palette-description",children:"Select a pure TPV colour (no blending required)"}),a.jsx("div",{className:"tpv-color-grid",children:Sr.map(h=>a.jsxs("div",{className:`tpv-color-item ${i.toLowerCase()===h.hex.toLowerCase()?"selected":""}`,onClick:()=>c(h),title:`${h.code} - ${h.name}`,children:[a.jsx("div",{className:"tpv-color-swatch",style:{backgroundColor:h.hex}}),a.jsx("span",{className:"tpv-color-code",children:h.code})]},h.code))})]}),e==="blend"&&a.jsxs("div",{className:"picker-section",children:[a.jsx("h4",{children:"Custom Colour"}),a.jsx("p",{className:"picker-description",children:"Choose any colour (may require blending)"}),a.jsx(KB,{color:i,onChange:o,disableAlpha:!0}),a.jsx("button",{onClick:l,className:"reset-button",children:"Reset to Original Colour"})]}),e==="solid"&&a.jsxs("div",{className:"solid-mode-info",children:[a.jsx("h4",{children:"Solid Mode Editing"}),a.jsx("p",{className:"info-description",children:"In solid mode, you can only select from the standard TPV colours above. Custom colours require blending - switch to Blend Mode for full colour customisation."}),a.jsx("button",{onClick:l,className:"reset-button",children:"Reset to Original Colour"})]})]}),a.jsx("style",{jsx:!0,children:`
        .color-editor-panel {
          position: fixed;
          top: 0;
          right: 0;
          width: 400px;
          height: 100vh;
          background: white;
          box-shadow: -4px 0 12px rgba(0, 0, 0, 0.15);
          z-index: 1000;
          display: flex;
          flex-direction: column;
          overflow: hidden;
        }

        .editor-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 1.5rem;
          border-bottom: 2px solid #1a365d;
          background: #f9f9f9;
        }

        .editor-header h3 {
          font-family: 'Space Grotesk', sans-serif;
          margin: 0;
          color: #1e4a7a;
          font-size: 1.5rem;
          font-weight: 600;
        }

        .close-button {
          background: none;
          border: none;
          font-size: 2rem;
          color: #666;
          cursor: pointer;
          padding: 0;
          width: 32px;
          height: 32px;
          line-height: 1;
          transition: color 0.2s;
        }

        .close-button:hover {
          color: #333;
        }

        .editor-content {
          flex: 1;
          overflow-y: auto;
          padding: 1.5rem;
        }

        /* Color Info Section */
        .color-info-section {
          margin-bottom: 2rem;
          padding: 1rem;
          background: #f9f9f9;
          border-radius: 6px;
        }

        .color-display {
          margin-bottom: 1rem;
        }

        .swatch-pair {
          display: flex;
          align-items: center;
          gap: 1rem;
          justify-content: center;
        }

        .swatch-group {
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 0.5rem;
        }

        .swatch {
          width: 60px;
          height: 60px;
          border-radius: 8px;
          border: 3px solid #ddd;
          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .swatch.original {
          border-color: #999;
        }

        .swatch.current {
          border-color: #ff6b35;
        }

        .swatch.transparent-preview {
          background:
            linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%),
            linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%);
          background-size: 10px 10px;
          background-position: 0 0, 5px 5px;
          background-color: white;
        }

        .swatch-label {
          font-size: 0.85rem;
          color: #666;
          font-weight: 500;
        }

        .arrow {
          font-size: 1.5rem;
          color: #666;
          font-weight: bold;
        }

        .color-details {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .detail-row {
          display: flex;
          justify-content: space-between;
          align-items: center;
          font-size: 0.95rem;
        }

        .detail-row .label {
          font-weight: 600;
          color: #666;
        }

        .detail-row .value {
          font-family: 'Courier New', monospace;
          color: #333;
        }

        /* Transparent Section */
        .transparent-section {
          margin-bottom: 1.5rem;
          padding: 1rem;
          background: #f9f9f9;
          border-radius: 6px;
        }

        .transparent-section h4 {
          margin: 0 0 0.75rem 0;
          color: #1a365d;
          font-size: 1rem;
          font-weight: 600;
        }

        .transparent-option {
          display: flex;
          align-items: center;
          gap: 12px;
          width: 100%;
          padding: 12px 16px;
          background: white;
          border: 2px solid #d1d5db;
          border-radius: 8px;
          cursor: pointer;
          transition: all 0.2s;
          font-size: 0.95rem;
          font-weight: 500;
          color: #374151;
        }

        .transparent-option:hover {
          border-color: #6b7280;
          background: #fafafa;
        }

        .transparent-option.selected {
          border-color: #ff6b35;
          background: #fff5f0;
          box-shadow: 0 0 0 2px rgba(255, 107, 53, 0.2);
        }

        .transparent-swatch {
          width: 32px;
          height: 32px;
          border-radius: 4px;
          border: 1px solid #999;
          background:
            linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%),
            linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%);
          background-size: 8px 8px;
          background-position: 0 0, 4px 4px;
          background-color: white;
        }

        /* TPV Palette Section */
        .tpv-palette-section {
          margin-bottom: 2rem;
          padding: 1rem;
          background: #f9f9f9;
          border-radius: 6px;
        }

        .tpv-palette-section h4 {
          margin: 0 0 0.5rem 0;
          color: #1a365d;
          font-size: 1rem;
          font-weight: 600;
        }

        .palette-description {
          margin: 0 0 1rem 0;
          font-size: 0.85rem;
          color: #666;
        }

        .tpv-color-grid {
          display: grid;
          grid-template-columns: repeat(3, 1fr);
          gap: 0.75rem;
        }

        .tpv-color-item {
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 0.4rem;
          padding: 0.5rem;
          border: 2px solid transparent;
          border-radius: 6px;
          cursor: pointer;
          transition: all 0.2s;
          background: white;
        }

        .tpv-color-item:hover {
          border-color: #ff6b35;
          transform: translateY(-2px);
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .tpv-color-item.selected {
          border-color: #ff6b35;
          background: #fff5f0;
          box-shadow: 0 0 0 2px rgba(255, 107, 53, 0.2);
        }

        .tpv-color-swatch {
          width: 100%;
          height: 50px;
          border-radius: 4px;
          border: 1px solid rgba(0, 0, 0, 0.1);
          box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .tpv-color-code {
          font-size: 0.75rem;
          font-weight: 600;
          color: #1a365d;
          font-family: 'Courier New', monospace;
        }

        /* Picker Section */
        .picker-section {
          margin-bottom: 1rem;
          padding: 1rem;
          background: #f9f9f9;
          border-radius: 6px;
        }

        .picker-section h4 {
          margin: 0 0 0.5rem 0;
          color: #1a365d;
          font-size: 1rem;
          font-weight: 600;
        }

        .picker-description {
          margin: 0 0 1rem 0;
          font-size: 0.85rem;
          color: #666;
        }

        .picker-section :global(.chrome-picker) {
          box-shadow: none !important;
          width: 100% !important;
        }

        .reset-button {
          width: 100%;
          padding: 0.75rem;
          margin-top: 1rem;
          background: #e0e0e0;
          color: #333;
          border: none;
          border-radius: 4px;
          font-weight: 600;
          cursor: pointer;
          transition: background 0.2s;
        }

        .reset-button:hover {
          background: #d0d0d0;
        }

        /* Solid Mode Info */
        .solid-mode-info {
          margin-bottom: 1rem;
          padding: 1rem;
          background: #fff5f0;
          border: 2px solid #ff6b35;
          border-radius: 6px;
        }

        .solid-mode-info h4 {
          margin: 0 0 0.5rem 0;
          color: #1a365d;
          font-size: 1rem;
          font-weight: 600;
        }

        .info-description {
          margin: 0;
          font-size: 0.85rem;
          color: #666;
          line-height: 1.5;
        }

        /* Mobile Responsive - Fullscreen Modal */
        @media (max-width: 768px) {
          .color-editor-panel {
            width: 100%;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 0;
          }

          .editor-header {
            padding: 1rem;
            position: sticky;
            top: 0;
            z-index: 10;
          }

          .editor-header h3 {
            font-size: 1.25rem;
          }

          /* Larger close button for touch */
          .close-button {
            width: 44px;
            height: 44px;
            font-size: 2.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
          }

          .editor-content {
            padding: 1rem;
          }

          /* Color swatches - larger for touch */
          .swatch {
            width: 50px;
            height: 50px;
          }

          .color-info-section {
            padding: 0.75rem;
            margin-bottom: 1.5rem;
          }

          /* TPV color grid - better touch targets */
          .tpv-color-grid {
            grid-template-columns: repeat(4, 1fr);
            gap: 0.5rem;
          }

          .tpv-color-item {
            padding: 0.4rem;
            min-height: 44px;
          }

          .tpv-color-swatch {
            height: 36px;
          }

          .tpv-color-code {
            font-size: 0.65rem;
          }

          .tpv-palette-section {
            padding: 0.75rem;
            margin-bottom: 1.5rem;
          }

          .tpv-palette-section h4 {
            font-size: 0.9rem;
          }

          .palette-description {
            font-size: 0.8rem;
          }

          /* Picker section */
          .picker-section {
            padding: 0.75rem;
          }

          .picker-section h4 {
            font-size: 0.9rem;
          }

          .picker-description {
            font-size: 0.8rem;
          }

          /* Larger reset button for touch */
          .reset-button {
            min-height: 44px;
            font-size: 0.9rem;
          }

          .solid-mode-info {
            padding: 0.75rem;
          }

          .solid-mode-info h4 {
            font-size: 0.9rem;
          }

          .info-description {
            font-size: 0.8rem;
          }
        }

        /* Extra small screens */
        @media (max-width: 400px) {
          .tpv-color-grid {
            grid-template-columns: repeat(3, 1fr);
          }

          .tpv-color-swatch {
            height: 44px;
          }

          .swatch {
            width: 44px;
            height: 44px;
          }

          .swatch-pair {
            gap: 0.5rem;
          }

          .arrow {
            font-size: 1.2rem;
          }
        }
      `})]}):null}const ei=11102230246251565e-32,ir=134217729,j7=(3+8*ei)*ei;function Bu(t,e,r,n,i){let s,o,l,c,d=e[0],u=n[0],f=0,h=0;u>d==u>-d?(s=d,d=e[++f]):(s=u,u=n[++h]);let p=0;if(f<t&&h<r)for(u>d==u>-d?(o=d+s,l=s-(o-d),d=e[++f]):(o=u+s,l=s-(o-u),u=n[++h]),s=o,l!==0&&(i[p++]=l);f<t&&h<r;)u>d==u>-d?(o=s+d,c=o-s,l=s-(o-c)+(d-c),d=e[++f]):(o=s+u,c=o-s,l=s-(o-c)+(u-c),u=n[++h]),s=o,l!==0&&(i[p++]=l);for(;f<t;)o=s+d,c=o-s,l=s-(o-c)+(d-c),d=e[++f],s=o,l!==0&&(i[p++]=l);for(;h<r;)o=s+u,c=o-s,l=s-(o-c)+(u-c),u=n[++h],s=o,l!==0&&(i[p++]=l);return(s!==0||p===0)&&(i[p++]=s),p}function C7(t,e){let r=e[0];for(let n=1;n<t;n++)r+=e[n];return r}function xl(t){return new Float64Array(t)}const E7=(3+16*ei)*ei,T7=(2+12*ei)*ei,N7=(9+64*ei)*ei*ei,Is=xl(4),sy=xl(8),oy=xl(12),ay=xl(16),cr=xl(4);function R7(t,e,r,n,i,s,o){let l,c,d,u,f,h,p,g,m,x,v,y,b,w,k,_,C,N;const T=t-i,O=r-i,X=e-s,E=n-s;w=T*E,h=ir*T,p=h-(h-T),g=T-p,h=ir*E,m=h-(h-E),x=E-m,k=g*x-(w-p*m-g*m-p*x),_=X*O,h=ir*X,p=h-(h-X),g=X-p,h=ir*O,m=h-(h-O),x=O-m,C=g*x-(_-p*m-g*m-p*x),v=k-C,f=k-v,Is[0]=k-(v+f)+(f-C),y=w+v,f=y-w,b=w-(y-f)+(v-f),v=b-_,f=b-v,Is[1]=b-(v+f)+(f-_),N=y+v,f=N-y,Is[2]=y-(N-f)+(v-f),Is[3]=N;let F=C7(4,Is),S=T7*o;if(F>=S||-F>=S||(f=t-T,l=t-(T+f)+(f-i),f=r-O,d=r-(O+f)+(f-i),f=e-X,c=e-(X+f)+(f-s),f=n-E,u=n-(E+f)+(f-s),l===0&&c===0&&d===0&&u===0)||(S=N7*o+j7*Math.abs(F),F+=T*u+E*l-(X*d+O*c),F>=S||-F>=S))return F;w=l*E,h=ir*l,p=h-(h-l),g=l-p,h=ir*E,m=h-(h-E),x=E-m,k=g*x-(w-p*m-g*m-p*x),_=c*O,h=ir*c,p=h-(h-c),g=c-p,h=ir*O,m=h-(h-O),x=O-m,C=g*x-(_-p*m-g*m-p*x),v=k-C,f=k-v,cr[0]=k-(v+f)+(f-C),y=w+v,f=y-w,b=w-(y-f)+(v-f),v=b-_,f=b-v,cr[1]=b-(v+f)+(f-_),N=y+v,f=N-y,cr[2]=y-(N-f)+(v-f),cr[3]=N;const K=Bu(4,Is,4,cr,sy);w=T*u,h=ir*T,p=h-(h-T),g=T-p,h=ir*u,m=h-(h-u),x=u-m,k=g*x-(w-p*m-g*m-p*x),_=X*d,h=ir*X,p=h-(h-X),g=X-p,h=ir*d,m=h-(h-d),x=d-m,C=g*x-(_-p*m-g*m-p*x),v=k-C,f=k-v,cr[0]=k-(v+f)+(f-C),y=w+v,f=y-w,b=w-(y-f)+(v-f),v=b-_,f=b-v,cr[1]=b-(v+f)+(f-_),N=y+v,f=N-y,cr[2]=y-(N-f)+(v-f),cr[3]=N;const le=Bu(K,sy,4,cr,oy);w=l*u,h=ir*l,p=h-(h-l),g=l-p,h=ir*u,m=h-(h-u),x=u-m,k=g*x-(w-p*m-g*m-p*x),_=c*d,h=ir*c,p=h-(h-c),g=c-p,h=ir*d,m=h-(h-d),x=d-m,C=g*x-(_-p*m-g*m-p*x),v=k-C,f=k-v,cr[0]=k-(v+f)+(f-C),y=w+v,f=y-w,b=w-(y-f)+(v-f),v=b-_,f=b-v,cr[1]=b-(v+f)+(f-_),N=y+v,f=N-y,cr[2]=y-(N-f)+(v-f),cr[3]=N;const D=Bu(le,oy,4,cr,ay);return ay[D-1]}function ec(t,e,r,n,i,s){const o=(e-s)*(r-i),l=(t-i)*(n-s),c=o-l,d=Math.abs(o+l);return Math.abs(c)>=E7*d?c:-R7(t,e,r,n,i,s,d)}const ly=Math.pow(2,-52),tc=new Uint32Array(512);class nd{static from(e,r=$7,n=L7){const i=e.length,s=new Float64Array(i*2);for(let o=0;o<i;o++){const l=e[o];s[2*o]=r(l),s[2*o+1]=n(l)}return new nd(s)}constructor(e){const r=e.length>>1;if(r>0&&typeof e[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=e;const n=Math.max(2*r-5,0);this._triangles=new Uint32Array(n*3),this._halfedges=new Int32Array(n*3),this._hashSize=Math.ceil(Math.sqrt(r)),this._hullPrev=new Uint32Array(r),this._hullNext=new Uint32Array(r),this._hullTri=new Uint32Array(r),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(r),this._dists=new Float64Array(r),this.update()}update(){const{coords:e,_hullPrev:r,_hullNext:n,_hullTri:i,_hullHash:s}=this,o=e.length>>1;let l=1/0,c=1/0,d=-1/0,u=-1/0;for(let T=0;T<o;T++){const O=e[2*T],X=e[2*T+1];O<l&&(l=O),X<c&&(c=X),O>d&&(d=O),X>u&&(u=X),this._ids[T]=T}const f=(l+d)/2,h=(c+u)/2;let p,g,m;for(let T=0,O=1/0;T<o;T++){const X=Hu(f,h,e[2*T],e[2*T+1]);X<O&&(p=T,O=X)}const x=e[2*p],v=e[2*p+1];for(let T=0,O=1/0;T<o;T++){if(T===p)continue;const X=Hu(x,v,e[2*T],e[2*T+1]);X<O&&X>0&&(g=T,O=X)}let y=e[2*g],b=e[2*g+1],w=1/0;for(let T=0;T<o;T++){if(T===p||T===g)continue;const O=A7(x,v,y,b,e[2*T],e[2*T+1]);O<w&&(m=T,w=O)}let k=e[2*m],_=e[2*m+1];if(w===1/0){for(let X=0;X<o;X++)this._dists[X]=e[2*X]-e[0]||e[2*X+1]-e[1];yo(this._ids,this._dists,0,o-1);const T=new Uint32Array(o);let O=0;for(let X=0,E=-1/0;X<o;X++){const F=this._ids[X],S=this._dists[F];S>E&&(T[O++]=F,E=S)}this.hull=T.subarray(0,O),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(ec(x,v,y,b,k,_)<0){const T=g,O=y,X=b;g=m,y=k,b=_,m=T,k=O,_=X}const C=M7(x,v,y,b,k,_);this._cx=C.x,this._cy=C.y;for(let T=0;T<o;T++)this._dists[T]=Hu(e[2*T],e[2*T+1],C.x,C.y);yo(this._ids,this._dists,0,o-1),this._hullStart=p;let N=3;n[p]=r[m]=g,n[g]=r[p]=m,n[m]=r[g]=p,i[p]=0,i[g]=1,i[m]=2,s.fill(-1),s[this._hashKey(x,v)]=p,s[this._hashKey(y,b)]=g,s[this._hashKey(k,_)]=m,this.trianglesLen=0,this._addTriangle(p,g,m,-1,-1,-1);for(let T=0,O,X;T<this._ids.length;T++){const E=this._ids[T],F=e[2*E],S=e[2*E+1];if(T>0&&Math.abs(F-O)<=ly&&Math.abs(S-X)<=ly||(O=F,X=S,E===p||E===g||E===m))continue;let K=0;for(let Z=0,H=this._hashKey(F,S);Z<this._hashSize&&(K=s[(H+Z)%this._hashSize],!(K!==-1&&K!==n[K]));Z++);K=r[K];let le=K,D;for(;D=n[le],ec(F,S,e[2*le],e[2*le+1],e[2*D],e[2*D+1])>=0;)if(le=D,le===K){le=-1;break}if(le===-1)continue;let I=this._addTriangle(le,E,n[le],-1,-1,i[le]);i[E]=this._legalize(I+2),i[le]=I,N++;let L=n[le];for(;D=n[L],ec(F,S,e[2*L],e[2*L+1],e[2*D],e[2*D+1])<0;)I=this._addTriangle(L,E,D,i[E],-1,i[L]),i[E]=this._legalize(I+2),n[L]=L,N--,L=D;if(le===K)for(;D=r[le],ec(F,S,e[2*D],e[2*D+1],e[2*le],e[2*le+1])<0;)I=this._addTriangle(D,E,le,-1,i[le],i[D]),this._legalize(I+2),i[D]=I,n[le]=le,N--,le=D;this._hullStart=r[E]=le,n[le]=r[L]=E,n[E]=L,s[this._hashKey(F,S)]=E,s[this._hashKey(e[2*le],e[2*le+1])]=le}this.hull=new Uint32Array(N);for(let T=0,O=this._hullStart;T<N;T++)this.hull[T]=O,O=n[O];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(e,r){return Math.floor(P7(e-this._cx,r-this._cy)*this._hashSize)%this._hashSize}_legalize(e){const{_triangles:r,_halfedges:n,coords:i}=this;let s=0,o=0;for(;;){const l=n[e],c=e-e%3;if(o=c+(e+2)%3,l===-1){if(s===0)break;e=tc[--s];continue}const d=l-l%3,u=c+(e+1)%3,f=d+(l+2)%3,h=r[o],p=r[e],g=r[u],m=r[f];if(O7(i[2*h],i[2*h+1],i[2*p],i[2*p+1],i[2*g],i[2*g+1],i[2*m],i[2*m+1])){r[e]=m,r[l]=h;const v=n[f];if(v===-1){let b=this._hullStart;do{if(this._hullTri[b]===f){this._hullTri[b]=e;break}b=this._hullPrev[b]}while(b!==this._hullStart)}this._link(e,v),this._link(l,n[o]),this._link(o,f);const y=d+(l+1)%3;s<tc.length&&(tc[s++]=y)}else{if(s===0)break;e=tc[--s]}}return o}_link(e,r){this._halfedges[e]=r,r!==-1&&(this._halfedges[r]=e)}_addTriangle(e,r,n,i,s,o){const l=this.trianglesLen;return this._triangles[l]=e,this._triangles[l+1]=r,this._triangles[l+2]=n,this._link(l,i),this._link(l+1,s),this._link(l+2,o),this.trianglesLen+=3,l}}function P7(t,e){const r=t/(Math.abs(t)+Math.abs(e));return(e>0?3-r:1+r)/4}function Hu(t,e,r,n){const i=t-r,s=e-n;return i*i+s*s}function O7(t,e,r,n,i,s,o,l){const c=t-o,d=e-l,u=r-o,f=n-l,h=i-o,p=s-l,g=c*c+d*d,m=u*u+f*f,x=h*h+p*p;return c*(f*x-m*p)-d*(u*x-m*h)+g*(u*p-f*h)<0}function A7(t,e,r,n,i,s){const o=r-t,l=n-e,c=i-t,d=s-e,u=o*o+l*l,f=c*c+d*d,h=.5/(o*d-l*c),p=(d*u-l*f)*h,g=(o*f-c*u)*h;return p*p+g*g}function M7(t,e,r,n,i,s){const o=r-t,l=n-e,c=i-t,d=s-e,u=o*o+l*l,f=c*c+d*d,h=.5/(o*d-l*c),p=t+(d*u-l*f)*h,g=e+(o*f-c*u)*h;return{x:p,y:g}}function yo(t,e,r,n){if(n-r<=20)for(let i=r+1;i<=n;i++){const s=t[i],o=e[s];let l=i-1;for(;l>=r&&e[t[l]]>o;)t[l+1]=t[l--];t[l+1]=s}else{const i=r+n>>1;let s=r+1,o=n;ua(t,i,s),e[t[r]]>e[t[n]]&&ua(t,r,n),e[t[s]]>e[t[n]]&&ua(t,s,n),e[t[r]]>e[t[s]]&&ua(t,r,s);const l=t[s],c=e[l];for(;;){do s++;while(e[t[s]]<c);do o--;while(e[t[o]]>c);if(o<s)break;ua(t,s,o)}t[r+1]=t[o],t[o]=l,n-s+1>=o-r?(yo(t,e,s,n),yo(t,e,r,o-1)):(yo(t,e,r,o-1),yo(t,e,s,n))}}function ua(t,e,r){const n=t[e];t[e]=t[r],t[r]=n}function $7(t){return t[0]}function L7(t){return t[1]}const cy=1e-6;class ss{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(e,r){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(e,r){this._+=`L${this._x1=+e},${this._y1=+r}`}arc(e,r,n){e=+e,r=+r,n=+n;const i=e+n,s=r;if(n<0)throw new Error("negative radius");this._x1===null?this._+=`M${i},${s}`:(Math.abs(this._x1-i)>cy||Math.abs(this._y1-s)>cy)&&(this._+="L"+i+","+s),n&&(this._+=`A${n},${n},0,1,1,${e-n},${r}A${n},${n},0,1,1,${this._x1=i},${this._y1=s}`)}rect(e,r,n,i){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}h${+n}v${+i}h${-n}Z`}value(){return this._||null}}class hf{constructor(){this._=[]}moveTo(e,r){this._.push([e,r])}closePath(){this._.push(this._[0].slice())}lineTo(e,r){this._.push([e,r])}value(){return this._.length?this._:null}}class I7{constructor(e,[r,n,i,s]=[0,0,960,500]){if(!((i=+i)>=(r=+r))||!((s=+s)>=(n=+n)))throw new Error("invalid bounds");this.delaunay=e,this._circumcenters=new Float64Array(e.points.length*2),this.vectors=new Float64Array(e.points.length*2),this.xmax=i,this.xmin=r,this.ymax=s,this.ymin=n,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:e,hull:r,triangles:n},vectors:i}=this;let s,o;const l=this.circumcenters=this._circumcenters.subarray(0,n.length/3*2);for(let m=0,x=0,v=n.length,y,b;m<v;m+=3,x+=2){const w=n[m]*2,k=n[m+1]*2,_=n[m+2]*2,C=e[w],N=e[w+1],T=e[k],O=e[k+1],X=e[_],E=e[_+1],F=T-C,S=O-N,K=X-C,le=E-N,D=(F*le-S*K)*2;if(Math.abs(D)<1e-9){if(s===void 0){s=o=0;for(const L of r)s+=e[L*2],o+=e[L*2+1];s/=r.length,o/=r.length}const I=1e9*Math.sign((s-C)*le-(o-N)*K);y=(C+X)/2-I*le,b=(N+E)/2+I*K}else{const I=1/D,L=F*F+S*S,Z=K*K+le*le;y=C+(le*L-S*Z)*I,b=N+(F*Z-K*L)*I}l[x]=y,l[x+1]=b}let c=r[r.length-1],d,u=c*4,f,h=e[2*c],p,g=e[2*c+1];i.fill(0);for(let m=0;m<r.length;++m)c=r[m],d=u,f=h,p=g,u=c*4,h=e[2*c],g=e[2*c+1],i[d+2]=i[u]=p-g,i[d+3]=i[u+1]=h-f}render(e){const r=e==null?e=new ss:void 0,{delaunay:{halfedges:n,inedges:i,hull:s},circumcenters:o,vectors:l}=this;if(s.length<=1)return null;for(let u=0,f=n.length;u<f;++u){const h=n[u];if(h<u)continue;const p=Math.floor(u/3)*2,g=Math.floor(h/3)*2,m=o[p],x=o[p+1],v=o[g],y=o[g+1];this._renderSegment(m,x,v,y,e)}let c,d=s[s.length-1];for(let u=0;u<s.length;++u){c=d,d=s[u];const f=Math.floor(i[d]/3)*2,h=o[f],p=o[f+1],g=c*4,m=this._project(h,p,l[g+2],l[g+3]);m&&this._renderSegment(h,p,m[0],m[1],e)}return r&&r.value()}renderBounds(e){const r=e==null?e=new ss:void 0;return e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),r&&r.value()}renderCell(e,r){const n=r==null?r=new ss:void 0,i=this._clip(e);if(i===null||!i.length)return;r.moveTo(i[0],i[1]);let s=i.length;for(;i[0]===i[s-2]&&i[1]===i[s-1]&&s>1;)s-=2;for(let o=2;o<s;o+=2)(i[o]!==i[o-2]||i[o+1]!==i[o-1])&&r.lineTo(i[o],i[o+1]);return r.closePath(),n&&n.value()}*cellPolygons(){const{delaunay:{points:e}}=this;for(let r=0,n=e.length/2;r<n;++r){const i=this.cellPolygon(r);i&&(i.index=r,yield i)}}cellPolygon(e){const r=new hf;return this.renderCell(e,r),r.value()}_renderSegment(e,r,n,i,s){let o;const l=this._regioncode(e,r),c=this._regioncode(n,i);l===0&&c===0?(s.moveTo(e,r),s.lineTo(n,i)):(o=this._clipSegment(e,r,n,i,l,c))&&(s.moveTo(o[0],o[1]),s.lineTo(o[2],o[3]))}contains(e,r,n){return r=+r,r!==r||(n=+n,n!==n)?!1:this.delaunay._step(e,r,n)===e}*neighbors(e){const r=this._clip(e);if(r)for(const n of this.delaunay.neighbors(e)){const i=this._clip(n);if(i){e:for(let s=0,o=r.length;s<o;s+=2)for(let l=0,c=i.length;l<c;l+=2)if(r[s]===i[l]&&r[s+1]===i[l+1]&&r[(s+2)%o]===i[(l+c-2)%c]&&r[(s+3)%o]===i[(l+c-1)%c]){yield n;break e}}}}_cell(e){const{circumcenters:r,delaunay:{inedges:n,halfedges:i,triangles:s}}=this,o=n[e];if(o===-1)return null;const l=[];let c=o;do{const d=Math.floor(c/3);if(l.push(r[d*2],r[d*2+1]),c=c%3===2?c-2:c+1,s[c]!==e)break;c=i[c]}while(c!==o&&c!==-1);return l}_clip(e){if(e===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const r=this._cell(e);if(r===null)return null;const{vectors:n}=this,i=e*4;return this._simplify(n[i]||n[i+1]?this._clipInfinite(e,r,n[i],n[i+1],n[i+2],n[i+3]):this._clipFinite(e,r))}_clipFinite(e,r){const n=r.length;let i=null,s,o,l=r[n-2],c=r[n-1],d,u=this._regioncode(l,c),f,h=0;for(let p=0;p<n;p+=2)if(s=l,o=c,l=r[p],c=r[p+1],d=u,u=this._regioncode(l,c),d===0&&u===0)f=h,h=0,i?i.push(l,c):i=[l,c];else{let g,m,x,v,y;if(d===0){if((g=this._clipSegment(s,o,l,c,d,u))===null)continue;[m,x,v,y]=g}else{if((g=this._clipSegment(l,c,s,o,u,d))===null)continue;[v,y,m,x]=g,f=h,h=this._edgecode(m,x),f&&h&&this._edge(e,f,h,i,i.length),i?i.push(m,x):i=[m,x]}f=h,h=this._edgecode(v,y),f&&h&&this._edge(e,f,h,i,i.length),i?i.push(v,y):i=[v,y]}if(i)f=h,h=this._edgecode(i[0],i[1]),f&&h&&this._edge(e,f,h,i,i.length);else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return i}_clipSegment(e,r,n,i,s,o){const l=s<o;for(l&&([e,r,n,i,s,o]=[n,i,e,r,o,s]);;){if(s===0&&o===0)return l?[n,i,e,r]:[e,r,n,i];if(s&o)return null;let c,d,u=s||o;u&8?(c=e+(n-e)*(this.ymax-r)/(i-r),d=this.ymax):u&4?(c=e+(n-e)*(this.ymin-r)/(i-r),d=this.ymin):u&2?(d=r+(i-r)*(this.xmax-e)/(n-e),c=this.xmax):(d=r+(i-r)*(this.xmin-e)/(n-e),c=this.xmin),s?(e=c,r=d,s=this._regioncode(e,r)):(n=c,i=d,o=this._regioncode(n,i))}}_clipInfinite(e,r,n,i,s,o){let l=Array.from(r),c;if((c=this._project(l[0],l[1],n,i))&&l.unshift(c[0],c[1]),(c=this._project(l[l.length-2],l[l.length-1],s,o))&&l.push(c[0],c[1]),l=this._clipFinite(e,l))for(let d=0,u=l.length,f,h=this._edgecode(l[u-2],l[u-1]);d<u;d+=2)f=h,h=this._edgecode(l[d],l[d+1]),f&&h&&(d=this._edge(e,f,h,l,d),u=l.length);else this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(l=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return l}_edge(e,r,n,i,s){for(;r!==n;){let o,l;switch(r){case 5:r=4;continue;case 4:r=6,o=this.xmax,l=this.ymin;break;case 6:r=2;continue;case 2:r=10,o=this.xmax,l=this.ymax;break;case 10:r=8;continue;case 8:r=9,o=this.xmin,l=this.ymax;break;case 9:r=1;continue;case 1:r=5,o=this.xmin,l=this.ymin;break}(i[s]!==o||i[s+1]!==l)&&this.contains(e,o,l)&&(i.splice(s,0,o,l),s+=2)}return s}_project(e,r,n,i){let s=1/0,o,l,c;if(i<0){if(r<=this.ymin)return null;(o=(this.ymin-r)/i)<s&&(c=this.ymin,l=e+(s=o)*n)}else if(i>0){if(r>=this.ymax)return null;(o=(this.ymax-r)/i)<s&&(c=this.ymax,l=e+(s=o)*n)}if(n>0){if(e>=this.xmax)return null;(o=(this.xmax-e)/n)<s&&(l=this.xmax,c=r+(s=o)*i)}else if(n<0){if(e<=this.xmin)return null;(o=(this.xmin-e)/n)<s&&(l=this.xmin,c=r+(s=o)*i)}return[l,c]}_edgecode(e,r){return(e===this.xmin?1:e===this.xmax?2:0)|(r===this.ymin?4:r===this.ymax?8:0)}_regioncode(e,r){return(e<this.xmin?1:e>this.xmax?2:0)|(r<this.ymin?4:r>this.ymax?8:0)}_simplify(e){if(e&&e.length>4){for(let r=0;r<e.length;r+=2){const n=(r+2)%e.length,i=(r+4)%e.length;(e[r]===e[n]&&e[n]===e[i]||e[r+1]===e[n+1]&&e[n+1]===e[i+1])&&(e.splice(n,2),r-=2)}e.length||(e=null)}return e}}const D7=2*Math.PI,Ds=Math.pow;function z7(t){return t[0]}function F7(t){return t[1]}function B7(t){const{triangles:e,coords:r}=t;for(let n=0;n<e.length;n+=3){const i=2*e[n],s=2*e[n+1],o=2*e[n+2];if((r[o]-r[i])*(r[s+1]-r[i+1])-(r[s]-r[i])*(r[o+1]-r[i+1])>1e-10)return!1}return!0}function H7(t,e,r){return[t+Math.sin(t+e)*r,e+Math.cos(t-e)*r]}class pm{static from(e,r=z7,n=F7,i){return new pm("length"in e?U7(e,r,n,i):Float64Array.from(W7(e,r,n,i)))}constructor(e){this._delaunator=new nd(e),this.inedges=new Int32Array(e.length/2),this._hullIndex=new Int32Array(e.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const e=this._delaunator,r=this.points;if(e.hull&&e.hull.length>2&&B7(e)){this.collinear=Int32Array.from({length:r.length/2},(h,p)=>p).sort((h,p)=>r[2*h]-r[2*p]||r[2*h+1]-r[2*p+1]);const c=this.collinear[0],d=this.collinear[this.collinear.length-1],u=[r[2*c],r[2*c+1],r[2*d],r[2*d+1]],f=1e-8*Math.hypot(u[3]-u[1],u[2]-u[0]);for(let h=0,p=r.length/2;h<p;++h){const g=H7(r[2*h],r[2*h+1],f);r[2*h]=g[0],r[2*h+1]=g[1]}this._delaunator=new nd(r)}else delete this.collinear;const n=this.halfedges=this._delaunator.halfedges,i=this.hull=this._delaunator.hull,s=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),l=this._hullIndex.fill(-1);for(let c=0,d=n.length;c<d;++c){const u=s[c%3===2?c-2:c+1];(n[c]===-1||o[u]===-1)&&(o[u]=c)}for(let c=0,d=i.length;c<d;++c)l[i[c]]=c;i.length<=2&&i.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=i[0],o[i[0]]=1,i.length===2&&(o[i[1]]=0,this.triangles[1]=i[1],this.triangles[2]=i[1]))}voronoi(e){return new I7(this,e)}*neighbors(e){const{inedges:r,hull:n,_hullIndex:i,halfedges:s,triangles:o,collinear:l}=this;if(l){const f=l.indexOf(e);f>0&&(yield l[f-1]),f<l.length-1&&(yield l[f+1]);return}const c=r[e];if(c===-1)return;let d=c,u=-1;do{if(yield u=o[d],d=d%3===2?d-2:d+1,o[d]!==e)return;if(d=s[d],d===-1){const f=n[(i[e]+1)%n.length];f!==u&&(yield f);return}}while(d!==c)}find(e,r,n=0){if(e=+e,e!==e||(r=+r,r!==r))return-1;const i=n;let s;for(;(s=this._step(n,e,r))>=0&&s!==n&&s!==i;)n=s;return s}_step(e,r,n){const{inedges:i,hull:s,_hullIndex:o,halfedges:l,triangles:c,points:d}=this;if(i[e]===-1||!d.length)return(e+1)%(d.length>>1);let u=e,f=Ds(r-d[e*2],2)+Ds(n-d[e*2+1],2);const h=i[e];let p=h;do{let g=c[p];const m=Ds(r-d[g*2],2)+Ds(n-d[g*2+1],2);if(m<f&&(f=m,u=g),p=p%3===2?p-2:p+1,c[p]!==e)break;if(p=l[p],p===-1){if(p=s[(o[e]+1)%s.length],p!==g&&Ds(r-d[p*2],2)+Ds(n-d[p*2+1],2)<f)return p;break}}while(p!==h);return u}render(e){const r=e==null?e=new ss:void 0,{points:n,halfedges:i,triangles:s}=this;for(let o=0,l=i.length;o<l;++o){const c=i[o];if(c<o)continue;const d=s[o]*2,u=s[c]*2;e.moveTo(n[d],n[d+1]),e.lineTo(n[u],n[u+1])}return this.renderHull(e),r&&r.value()}renderPoints(e,r){r===void 0&&(!e||typeof e.moveTo!="function")&&(r=e,e=null),r=r==null?2:+r;const n=e==null?e=new ss:void 0,{points:i}=this;for(let s=0,o=i.length;s<o;s+=2){const l=i[s],c=i[s+1];e.moveTo(l+r,c),e.arc(l,c,r,0,D7)}return n&&n.value()}renderHull(e){const r=e==null?e=new ss:void 0,{hull:n,points:i}=this,s=n[0]*2,o=n.length;e.moveTo(i[s],i[s+1]);for(let l=1;l<o;++l){const c=2*n[l];e.lineTo(i[c],i[c+1])}return e.closePath(),r&&r.value()}hullPolygon(){const e=new hf;return this.renderHull(e),e.value()}renderTriangle(e,r){const n=r==null?r=new ss:void 0,{points:i,triangles:s}=this,o=s[e*=3]*2,l=s[e+1]*2,c=s[e+2]*2;return r.moveTo(i[o],i[o+1]),r.lineTo(i[l],i[l+1]),r.lineTo(i[c],i[c+1]),r.closePath(),n&&n.value()}*trianglePolygons(){const{triangles:e}=this;for(let r=0,n=e.length/3;r<n;++r)yield this.trianglePolygon(r)}trianglePolygon(e){const r=new hf;return this.renderTriangle(e,r),r.value()}}function U7(t,e,r,n){const i=t.length,s=new Float64Array(i*2);for(let o=0;o<i;++o){const l=t[o];s[o*2]=e.call(n,l,o,t),s[o*2+1]=r.call(n,l,o,t)}return s}function*W7(t,e,r,n){let i=0;for(const s of t)yield e.call(n,s,i,t),yield r.call(n,s,i,t),++i}const ls=Sr,G7=new Map(ls.map((t,e)=>[t.code,e]));function u_(t){return function(){let e=t+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}}function V7(t,e,r,n=30,i=Math.random){const s=r/Math.sqrt(2),o=Math.ceil(t/s),l=Math.ceil(e/s),c=new Array(o*l).fill(-1),d=[],u=[];function f(p,g){const m=[p,g];d.push(m);const x=Math.floor(p/s),v=Math.floor(g/s);return c[v*o+x]=d.length-1,u.push(d.length-1),m}function h(p,g){const m=Math.floor(p/s),x=Math.floor(g/s);for(let v=Math.max(0,m-2);v<=Math.min(o-1,m+2);v++)for(let y=Math.max(0,x-2);y<=Math.min(l-1,x+2);y++){const b=c[y*o+v];if(b!==-1){const w=p-d[b][0],k=g-d[b][1];if(w*w+k*k<r*r)return!0}}return!1}for(f(t*i(),e*i());u.length>0;){const p=Math.floor(i()*u.length),g=u[p],m=d[g];let x=!1;for(let v=0;v<n;v++){const y=2*Math.PI*i(),b=r+r*i(),w=m[0]+b*Math.cos(y),k=m[1]+b*Math.sin(y);if(w>=0&&w<t&&k>=0&&k<e&&!h(w,k)){f(w,k),x=!0;break}}x||u.splice(p,1)}return d}const Uu={Xn:.95047,Yn:1,Zn:1.08883},q7=[[3.2404542,-1.5371385,-.4985314],[-.969266,1.8760108,.041556],[.0556434,-.2040259,1.0572252]];function Wu(t){return t<=.0031308?t*12.92:1.055*Math.pow(t,1/2.4)-.055}function Y7(t){return{R:Math.round(Wu(t.R)*255),G:Math.round(Wu(t.G)*255),B:Math.round(Wu(t.B)*255)}}function X7(t){const[e,r,n]=q7;return{R:e[0]*t.X+e[1]*t.Y+e[2]*t.Z,G:r[0]*t.X+r[1]*t.Y+r[2]*t.Z,B:n[0]*t.X+n[1]*t.Y+n[2]*t.Z}}function Gu(t){const e=.20689655172413793;return t>e?Math.pow(t,3):3*e*e*(t-4/29)}function K7(t){const e=(t.L+16)/116,r=t.a/500+e,n=e-t.b/200;return{X:Uu.Xn*Gu(r),Y:Uu.Yn*Gu(e),Z:Uu.Zn*Gu(n)}}function Z7(t){const e=K7(t),r=X7(e);return Y7(r)}function J7(t){let e=0;if(t.forEach(c=>e+=c),e===0)return"#FFFFFF";let r=0,n=0,i=0;t.forEach((c,d)=>{const u=ls[d],f=c/e;r+=u.L*f,n+=u.a*f,i+=u.b*f});const o=Z7({L:r,a:n,b:i}),l=c=>Math.round(Math.max(0,Math.min(255,c))).toString(16).padStart(2,"0");return`#${l(o.R)}${l(o.G)}${l(o.B)}`}function Q7(t){const e=parseInt(t.slice(1,3),16),r=parseInt(t.slice(3,5),16),n=parseInt(t.slice(5,7),16);return{r:e,g:r,b:n}}function eH(t){const{r:e,g:r,b:n}=Q7(t);return(e*299+r*587+n*114)/1e3>128?"#000000":"#FFFFFF"}function tH(t){let e=0;const r={},n=[];return t.forEach((i,s)=>{const o=ls[s];e+=i,r[o.code]=i,n.push({code:o.code,name:o.name,weight:0,parts:i})}),n.forEach(i=>{i.weight=i.parts/e}),{parts:r,components:n,total:e}}function dy(t){const e=new Map;return!t||!t.parts||Object.entries(t.parts).forEach(([r,n])=>{const i=G7.get(r);i!==void 0&&e.set(i,n)}),e}function rH(t,e,r,n=12345){const i=u_(n),s=t*e,o=Math.sqrt(s/r)*.8;return V7(t,e,o,30,i)}function nH({parts:t,width:e=400,height:r=400,cellCount:n=1e4,seed:i=12345}){const s=P.useRef(null),[o,l]=P.useState(null),[c,d]=P.useState(!0);return P.useEffect(()=>{(async()=>{d(!0);const f=rH(e,r,n,i),p=pm.from(f).voronoi([0,0,e,r]);l({points:f,voronoi:p,cellCount:f.length}),d(!1)})()},[i,e,r,n]),P.useEffect(()=>{if(!o||!s.current)return;const u=s.current,f=u.getContext("2d");u.width=e,u.height=r,f.fillStyle="#FAFAFA",f.fillRect(0,0,e,r);let h=0;t.forEach(g=>h+=g);const p=iH(o.cellCount,t,h,i);for(let g=0;g<o.cellCount;g++){const m=p[g],x=m===-1?"#FAFAFA":ls[m].hex,v=o.voronoi.cellPolygon(g);if(!(!v||v.length<3)){f.beginPath(),f.moveTo(v[0][0],v[0][1]);for(let y=1;y<v.length;y++)f.lineTo(v[y][0],v[y][1]);f.closePath(),f.fillStyle=x,f.fill()}}f.strokeStyle="rgba(0, 0, 0, 0.05)",f.lineWidth=.5;for(let g=0;g<o.cellCount;g++){const m=o.voronoi.cellPolygon(g);if(!(!m||m.length<3)){f.beginPath(),f.moveTo(m[0][0],m[0][1]);for(let x=1;x<m.length;x++)f.lineTo(m[x][0],m[x][1]);f.closePath(),f.stroke()}}},[o,t,i,e,r]),a.jsxs("div",{style:{position:"relative",width:e,height:r},children:[a.jsx("canvas",{ref:s,style:{width:"100%",height:"100%",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"}}),c&&a.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(255,255,255,0.9)",borderRadius:"8px"},children:a.jsx("div",{style:{textAlign:"center",color:"#666"},children:"Generating granules..."})})]})}function iH(t,e,r,n){const i=new Array(t).fill(-1);if(r===0)return i;const s=n+r,o=u_(s),l=Array.from({length:t},(d,u)=>u);for(let d=l.length-1;d>0;d--){const u=Math.floor(o()*(d+1));[l[d],l[u]]=[l[u],l[d]]}let c=0;return e.forEach((d,u)=>{const f=Math.round(d/r*t);for(let h=0;h<f&&c<t;h++)i[l[c]]=u,c++}),i}function sH({initialRecipe:t=null,onBlendChange:e=null,originalColor:r=null}){const[n,i]=P.useState(new Map),s=P.useRef(!0),o=P.useRef(null);P.useEffect(()=>{if(t){const h=JSON.stringify(t);if(h!==o.current){o.current=h,s.current=!0;const p=dy(t);i(p)}}},[t]);const l=Array.from(n.values()).reduce((h,p)=>h+p,0),c=J7(n);P.useEffect(()=>{if(s.current){s.current=!1;return}if(e){const h=n.size>0?tH(n):null;e({blendHex:c,parts:n,recipe:h})}},[n,c]);const d=P.useCallback(h=>{i(p=>{const g=p.get(h)||0,m=Array.from(p.values()).reduce((v,y)=>v+y,0);if(g>=4||m>=12)return p;const x=new Map(p);return x.set(h,g+1),x})},[]),u=P.useCallback(h=>{const p=n.get(h)||0;p>0&&i(g=>{const m=new Map(g);return p===1?m.delete(h):m.set(h,p-1),m})},[n]),f=P.useCallback(()=>{i(new Map)},[]);return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"mini-mixer-widget",children:[r&&a.jsxs("div",{className:"mixer-header",children:[a.jsx("div",{className:"mixer-title",children:"Customise Blend Recipe"}),a.jsxs("div",{className:"original-color-ref",children:[a.jsx("span",{className:"label",children:"Original:"}),a.jsx("div",{className:"color-swatch",style:{backgroundColor:r,cursor:"pointer"},title:`${r} - Click to reset to original recipe`,onClick:()=>{t&&i(dy(t))}})]})]}),a.jsx("div",{className:"mixer-canvas-section",children:a.jsx(nH,{parts:n,width:700,height:350,cellCount:5e3,seed:12345})}),a.jsx("div",{className:"mix-proportion-bar",children:l===0?a.jsx("div",{className:"proportion-bar-empty"}):Array.from(n.entries()).map(([h,p])=>{const g=p/l*100;return a.jsx("div",{className:"proportion-segment",style:{backgroundColor:ls[h].hex,flexBasis:`${g}%`},title:`${ls[h].name}: ${Math.round(g)}%`},h)})}),a.jsxs("div",{className:"blend-preview",children:[a.jsx("div",{className:"blend-preview-label",children:"Blended Result:"}),a.jsxs("div",{className:"blend-preview-color",children:[a.jsx("div",{className:"blend-swatch",style:{backgroundColor:c,color:eH(c)},children:c}),a.jsxs("div",{className:"blend-parts-count",children:[l," ",l===1?"part":"parts"]})]})]}),a.jsxs("div",{className:"mixer-palette-section",children:[a.jsxs("div",{className:"mixer-palette-header",children:[a.jsx("h3",{children:"TPV Color Palette"}),l>0&&a.jsx("button",{className:"clear-btn",onClick:f,children:"Clear All"})]}),a.jsx("div",{className:"mixer-palette-grid",children:ls.map((h,p)=>{const g=n.get(p)||0;return a.jsxs("div",{className:"mixer-color-item",children:[a.jsx("button",{className:`mixer-color-swatch ${g>0?"has-parts":""}`,style:{backgroundColor:h.hex},onClick:()=>d(p),title:`${h.name} (${h.code})`}),a.jsxs("div",{className:"mixer-color-info",children:[a.jsx("div",{className:"mixer-color-name",children:h.name}),a.jsx("div",{className:"mixer-color-code",children:h.code})]}),a.jsxs("div",{className:"mixer-parts-controls",children:[a.jsx("button",{className:"mixer-parts-btn",onClick:()=>u(p),disabled:g===0,children:""}),a.jsx("div",{className:"mixer-parts-count",children:g}),a.jsx("button",{className:"mixer-parts-btn",onClick:()=>d(p),disabled:g>=4||l>=12,title:g>=4?"Max 4 parts per color":l>=12?"Max 12 total parts":"",children:"+"})]})]},p)})})]}),l===0?a.jsx("div",{className:"mixer-instructions",children:"Click colors above to add parts to your blend. The preview updates in real-time."}):l>=12?a.jsx("div",{className:"mixer-instructions",style:{background:"#fef3c7",borderColor:"#fbbf24"},children:"Maximum of 12 parts reached. Remove parts to adjust your blend."}):null]}),a.jsx("style",{children:`
        .mini-mixer-widget {
          background: white;
          border-radius: 12px;
          padding: 20px;
          margin-top: 20px;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .mixer-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 20px;
          padding-bottom: 16px;
          border-bottom: 2px solid #e5e7eb;
        }

        .mixer-title {
          font-size: 1.25rem;
          font-weight: 600;
          color: #111827;
        }

        .original-color-ref {
          display: flex;
          align-items: center;
          gap: 8px;
          font-size: 0.9rem;
          color: #6b7280;
        }

        .original-color-ref .color-swatch {
          width: 32px;
          height: 32px;
          border-radius: 6px;
          border: 2px solid #d1d5db;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
          cursor: pointer;
          transition: all 0.2s;
        }

        .original-color-ref .color-swatch:hover {
          transform: scale(1.1);
          border-color: #3b82f6;
          box-shadow: 0 2px 6px rgba(59, 130, 246, 0.3);
        }

        .mixer-canvas-section {
          margin-bottom: 20px;
          display: flex;
          justify-content: center;
        }

        .mix-proportion-bar {
          height: 24px;
          border-radius: 12px;
          overflow: hidden;
          display: flex;
          box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
          margin: 16px 0;
          background: #e5e7eb;
        }

        .proportion-segment {
          transition: all 0.2s ease;
        }

        .proportion-segment:hover {
          filter: brightness(1.1);
          cursor: pointer;
        }

        .proportion-bar-empty {
          width: 100%;
          height: 100%;
          background: linear-gradient(90deg, #f3f4f6 0%, #e5e7eb 50%, #f3f4f6 100%);
        }

        .blend-preview {
          margin-bottom: 24px;
          padding: 16px;
          background: #f9fafb;
          border-radius: 10px;
          border: 1px solid #e5e7eb;
        }

        .blend-preview-label {
          font-weight: 600;
          color: #374151;
          margin-bottom: 12px;
          font-size: 0.95rem;
        }

        .blend-preview-color {
          display: flex;
          align-items: center;
          gap: 16px;
        }

        .blend-swatch {
          flex: 1;
          padding: 16px;
          border-radius: 8px;
          text-align: center;
          font-weight: 600;
          font-family: 'Courier New', monospace;
          font-size: 1.1rem;
          border: 2px solid #d1d5db;
          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .blend-parts-count {
          font-size: 0.9rem;
          color: #6b7280;
          font-weight: 500;
          white-space: nowrap;
        }

        .mixer-palette-section {
          margin-bottom: 16px;
        }

        .mixer-palette-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 16px;
        }

        .mixer-palette-header h3 {
          margin: 0;
          font-size: 1.1rem;
          font-weight: 600;
          color: #111827;
        }

        .clear-btn {
          padding: 6px 12px;
          background: #ef4444;
          color: white;
          border: none;
          border-radius: 6px;
          font-size: 0.85rem;
          font-weight: 500;
          cursor: pointer;
          transition: all 0.2s;
        }

        .clear-btn:hover {
          background: #dc2626;
          box-shadow: 0 2px 6px rgba(239, 68, 68, 0.3);
        }

        .mixer-palette-grid {
          display: grid;
          grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
          gap: 12px;
          max-height: 400px;
          overflow-y: auto;
          padding: 4px;
        }

        .mixer-color-item {
          display: flex;
          flex-direction: column;
          gap: 8px;
          padding: 8px;
          background: #f9fafb;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
          transition: all 0.2s;
        }

        .mixer-color-item:hover {
          border-color: #3b82f6;
          box-shadow: 0 2px 6px rgba(59, 130, 246, 0.2);
        }

        .mixer-color-swatch {
          width: 100%;
          height: 48px;
          border-radius: 6px;
          border: 2px solid #d1d5db;
          cursor: pointer;
          transition: all 0.2s;
        }

        .mixer-color-swatch:hover {
          transform: scale(1.05);
          box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .mixer-color-swatch.has-parts {
          border-color: #3b82f6;
          border-width: 3px;
          box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .mixer-color-info {
          text-align: center;
        }

        .mixer-color-name {
          font-size: 0.85rem;
          font-weight: 500;
          color: #374151;
          line-height: 1.2;
        }

        .mixer-color-code {
          font-size: 0.75rem;
          color: #9ca3af;
          font-family: 'Courier New', monospace;
        }

        .mixer-parts-controls {
          display: flex;
          align-items: center;
          justify-content: center;
          gap: 8px;
        }

        .mixer-parts-btn {
          width: 28px;
          height: 28px;
          border-radius: 6px;
          border: 1px solid #d1d5db;
          background: white;
          color: #374151;
          font-size: 1.2rem;
          line-height: 1;
          display: flex;
          align-items: center;
          justify-content: center;
          cursor: pointer;
          transition: all 0.2s;
        }

        .mixer-parts-btn:hover:not(:disabled) {
          background: #f3f4f6;
          border-color: #3b82f6;
          color: #3b82f6;
        }

        .mixer-parts-btn:active:not(:disabled) {
          transform: scale(0.95);
        }

        .mixer-parts-btn:disabled {
          opacity: 0.3;
          cursor: not-allowed;
        }

        .mixer-parts-count {
          min-width: 24px;
          text-align: center;
          font-weight: 600;
          color: #111827;
          font-size: 0.9rem;
        }

        .mixer-instructions {
          text-align: center;
          color: #6b7280;
          font-size: 0.9rem;
          padding: 16px;
          background: #fffbeb;
          border-radius: 8px;
          border: 1px solid #fde68a;
        }

        @media (max-width: 768px) {
          .mini-mixer-widget {
            padding: 16px;
          }

          .mixer-canvas-section canvas {
            max-width: 100%;
            height: auto !important;
          }

          .mixer-palette-grid {
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 8px;
          }

          .blend-preview-color {
            flex-direction: column;
            gap: 12px;
          }

          .blend-swatch {
            width: 100%;
          }
        }
      `})]})}function h_(t){const{inputMode:e,prompt:r,selectedFile:n,lengthMM:i,widthMM:s,result:o,viewMode:l,blendRecipes:c,solidRecipes:d,colorMapping:u,solidColorMapping:f,solidEditedColors:h,blendEditedColors:p,blendSvgUrl:g,solidSvgUrl:m,arMapping:x,jobId:v,inSituData:y,regionOverrides:b,originalTaggedSvg:w}=t;console.log("[SERIALIZE] Serializing design with result:",o),console.log("[SERIALIZE] result.svg_url:",o==null?void 0:o.svg_url),console.log("[SERIALIZE] regionOverrides:",b),console.log("[SERIALIZE] regionOverrides size:",b==null?void 0:b.size),console.log("[SERIALIZE] originalTaggedSvg present:",!!w);const k=_=>_?_ instanceof Map?Object.fromEntries(_):_:null;return{input_mode:e,prompt:r||null,uploaded_file_url:(n==null?void 0:n.url)||null,dimensions:{widthMM:s,lengthMM:i},original_svg_url:(o==null?void 0:o.svg_url)||null,original_png_url:(o==null?void 0:o.png_url)||null,thumbnail_url:(o==null?void 0:o.thumb_url)||null,blend_recipes:c||null,solid_recipes:d||null,color_mapping:k(u),solid_color_mapping:k(f),solid_color_edits:k(h),blend_color_edits:k(p),final_blend_svg_url:g||null,final_solid_svg_url:m||null,preferred_view_mode:l||"solid",aspect_ratio_mapping:x||null,job_id:v||null,in_situ:y?{room_photo_url:y.room_photo_url||null,mask_url:y.mask_url||null,floor_dimensions_m:y.floor_dimensions_m||null,preview_url:y.preview_url||null,blend_opacity:y.blend_opacity||20,perspective_corners:y.perspective_corners||null}:null,region_overrides:k(b),original_tagged_svg:w||null}}function ff(t){var s,o,l,c;console.log("[DESERIALIZE] Incoming savedData keys:",Object.keys(t||{})),console.log("[DESERIALIZE] savedData.region_overrides:",t==null?void 0:t.region_overrides),console.log("[DESERIALIZE] savedData.design_data:",t==null?void 0:t.design_data),console.log("[DESERIALIZE] savedData.design_data?.region_overrides:",(s=t==null?void 0:t.design_data)==null?void 0:s.region_overrides),console.log("[DESERIALIZE] savedData.original_tagged_svg present:",!!(t!=null&&t.original_tagged_svg)),console.log("[DESERIALIZE] savedData.design_data?.original_tagged_svg present:",!!((o=t==null?void 0:t.design_data)!=null&&o.original_tagged_svg));const e=d=>d?d instanceof Map?d:new Map(Object.entries(d)):new Map,r=d=>{var u;return t[d]??((u=t.design_data)==null?void 0:u[d])},n=r("region_overrides"),i=r("original_tagged_svg");return console.log("[DESERIALIZE] Final regionOverridesData:",n),console.log("[DESERIALIZE] Final originalTaggedSvgData present:",!!i),{inputMode:t.input_mode||r("input_mode"),prompt:r("prompt")||"",selectedFile:r("uploaded_file_url")?{url:r("uploaded_file_url"),name:r("uploaded_file_url").split("/").pop()}:null,lengthMM:((l=r("dimensions"))==null?void 0:l.lengthMM)||0,widthMM:((c=r("dimensions"))==null?void 0:c.widthMM)||0,result:{svg_url:r("original_svg_url"),png_url:r("original_png_url"),thumbnail_url:r("thumbnail_url")},blendRecipes:r("blend_recipes")||null,solidRecipes:r("solid_recipes")||null,colorMapping:e(r("color_mapping")),solidColorMapping:e(r("solid_color_mapping")),solidEditedColors:e(r("solid_color_edits")),blendEditedColors:e(r("blend_color_edits")),blendSvgUrl:null,solidSvgUrl:null,viewMode:r("preferred_view_mode")||"solid",arMapping:r("aspect_ratio_mapping"),jobId:r("job_id"),inSituData:r("in_situ")||null,regionOverrides:e(n),originalTaggedSvg:i||null,generating:!1,generatingBlends:!1,showFinalRecipes:!!t.blend_recipes,showSolidSummary:!!t.solid_recipes,colorEditorOpen:!1,selectedColor:null}}function oH(t){var r;const e=[];return t.inputMode||e.push("Input mode is required"),(!(t.widthMM>0)||!(t.lengthMM>0))&&e.push("Surface dimensions are required"),(r=t.result)!=null&&r.svg_url||e.push("No design to save - generate a design first"),{valid:e.length===0,errors:e}}function aH({currentState:t,existingDesignId:e=null,initialName:r="",onClose:n,onSaved:i}){const[s,o]=P.useState(r),[l,c]=P.useState(""),[d,u]=P.useState(""),[f,h]=P.useState(""),[p,g]=P.useState(!1),[m,x]=P.useState([]),[v,y]=P.useState(!1),[b,w]=P.useState(""),[k,_]=P.useState("#1a365d"),[C,N]=P.useState(!1),[T,O]=P.useState(!1),[X,E]=P.useState(!1),[F,S]=P.useState(null);P.useEffect(()=>{K()},[]);const K=async()=>{try{const{projects:L}=await bp();x(L)}catch(L){console.error("Failed to load projects:",L),S("Failed to load projects")}},le=async()=>{if(!b.trim()){S("Project name is required");return}E(!0),S(null);try{const{project:L}=await Uw({name:b.trim(),color:k});x([L,...m]),u(L.id),y(!1),w(""),_("#1a365d")}catch(L){console.error("Failed to create project:",L),S(L.message)}finally{E(!1)}},D=async(L=!1)=>{if(!s.trim()){S("Design name is required");return}const Z=oH(t);if(!Z.valid){S(Z.errors.join(", "));return}L?O(!0):N(!0),S(null);try{const H=h_(t);console.log("[SAVE-MODAL] Serialized design data:",H),console.log("[SAVE-MODAL] SVG URL from serialized data:",H.original_svg_url);const G={name:s.trim(),description:l.trim()||null,project_id:d||null,tags:f.split(",").map(oe=>oe.trim()).filter(oe=>oe),is_public:p,design_data:H};console.log("[SAVE-MODAL] Full save payload:",G),e&&!L&&(G.id=e);const ee=await vp(G);i&&i(ee,s.trim()),n()}catch(H){console.error("Failed to save design:",H),S(H.message)}finally{N(!1),O(!1)}},I=["#1a365d","#ff6b35","#4a90e2","#50c878","#9b59b6","#e74c3c"];return a.jsx("div",{className:"modal-overlay",onClick:n,children:a.jsxs("div",{className:"modal-content save-design-modal",onClick:L=>L.stopPropagation(),children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h2",{children:e?"Update Design":"Save Design"}),a.jsx("button",{onClick:n,className:"close-button",children:""})]}),a.jsxs("div",{className:"modal-body",children:[F&&a.jsx("div",{className:"error-message",children:F}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"design-name",children:"Design Name *"}),a.jsx("input",{id:"design-name",type:"text",value:s,onChange:L=>o(L.target.value),placeholder:"e.g., Playground Design A",autoFocus:!0,disabled:C||T})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"design-description",children:"Description"}),a.jsx("textarea",{id:"design-description",value:l,onChange:L=>c(L.target.value),placeholder:"Optional notes about this design...",rows:3,disabled:C||T})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"design-project",children:"Project"}),v?a.jsxs("div",{className:"new-project-form",children:[a.jsxs("div",{className:"input-row",children:[a.jsx("input",{type:"text",value:b,onChange:L=>w(L.target.value),placeholder:"Project name...",disabled:X}),a.jsx("div",{className:"color-picker-inline",children:I.map(L=>a.jsx("button",{type:"button",className:`color-swatch ${k===L?"active":""}`,style:{backgroundColor:L},onClick:()=>_(L),disabled:X},L))})]}),a.jsxs("div",{className:"button-row",children:[a.jsx("button",{type:"button",onClick:le,className:"btn-primary btn-small",disabled:X,children:X?"Creating...":"Create"}),a.jsx("button",{type:"button",onClick:()=>y(!1),className:"btn-secondary btn-small",disabled:X,children:"Cancel"})]})]}):a.jsxs("div",{className:"project-selector",children:[a.jsxs("select",{id:"design-project",value:d,onChange:L=>u(L.target.value),disabled:C||T,children:[a.jsx("option",{value:"",children:"No Project"}),m.map(L=>a.jsxs("option",{value:L.id,children:[L.name," (",L.design_count," designs)"]},L.id))]}),a.jsx("button",{type:"button",onClick:()=>y(!0),className:"btn-secondary btn-small",disabled:C||T,children:"+ New Project"})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"design-tags",children:"Tags"}),a.jsx("input",{id:"design-tags",type:"text",value:f,onChange:L=>h(L.target.value),placeholder:"e.g., playground, vibrant, geometric (comma-separated)",disabled:C||T}),a.jsx("small",{className:"help-text",children:"Separate tags with commas"})]}),a.jsx("div",{className:"form-group checkbox-group",children:a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:p,onChange:L=>g(L.target.checked),disabled:C||T}),a.jsx("span",{children:"Make this design public (shareable link)"})]})})]}),a.jsxs("div",{className:"modal-footer",children:[a.jsx("button",{onClick:n,className:"btn-secondary",disabled:C||T,children:"Cancel"}),e&&a.jsx("button",{onClick:()=>D(!0),className:"btn-secondary",disabled:C||T,children:T?"Saving...":"Save as New"}),a.jsx("button",{onClick:()=>D(!1),className:"btn-primary",disabled:C||T,children:C?"Saving...":e?"Update":"Save Design"})]})]})})}const lH=10*1024*1024,cH=["image/jpeg","image/png","image/jpg"];function dH({onPhotoUploaded:t,disabled:e=!1}){const[r,n]=P.useState(!1),[i,s]=P.useState(!1),[o,l]=P.useState(null),[c,d]=P.useState(null),u=P.useRef(null),f=y=>{y.preventDefault(),e||n(!0)},h=y=>{y.preventDefault(),n(!1)},p=async y=>{if(y.preventDefault(),n(!1),e)return;const b=y.dataTransfer.files;b.length>0&&await x(b[0])},g=()=>{!e&&u.current&&u.current.click()},m=async y=>{y.target.files.length>0&&await x(y.target.files[0])},x=async y=>{if(l(null),!cH.includes(y.type)){l("Please upload a JPG or PNG image");return}if(y.size>lH){l("Image must be under 10MB");return}const b=URL.createObjectURL(y);d(b),console.log("[IN-SITU-UPLOADER] Loading local file to get dimensions...");const w=await new Promise((k,_)=>{const C=new Image;C.onload=()=>{console.log("[IN-SITU-UPLOADER] Local image loaded, dimensions:",C.naturalWidth,"x",C.naturalHeight),k({width:C.naturalWidth,height:C.naturalHeight})},C.onerror=N=>{console.error("[IN-SITU-UPLOADER] Failed to load local image:",N),_(new Error("Failed to read image dimensions"))},C.src=b});s(!0);try{const _=`in-situ-photos/${`${Date.now()}-${Math.random().toString(36).substr(2,9)}.${y.type.split("/")[1]}`}`,{data:C,error:N}=await Vt.storage.from("tpv-studio-uploads").upload(_,y,{cacheControl:"3600",upsert:!1});if(N)throw N;const{data:{publicUrl:T}}=Vt.storage.from("tpv-studio-uploads").getPublicUrl(_);console.log("[IN-SITU-UPLOADER] Photo uploaded:",T),console.log("[IN-SITU-UPLOADER] Using dimensions from local file:",w),console.log("[IN-SITU-UPLOADER] Passing local blob URL for fast preview"),console.log("[IN-SITU-UPLOADER] Calling onPhotoUploaded callback..."),t({url:b,supabaseUrl:T,width:w.width,height:w.height,filename:y.name})}catch(k){console.error("[IN-SITU-UPLOADER] Upload failed:",k),l(k.message||"Upload failed"),URL.revokeObjectURL(b),d(null)}finally{s(!1)}},v=()=>{c&&URL.revokeObjectURL(c),d(null),l(null)};return a.jsxs("div",{className:"in-situ-uploader",children:[c?a.jsxs("div",{className:"preview-container",children:[a.jsx("img",{src:c,alt:"Site preview",className:"preview-image"}),i&&a.jsxs("div",{className:"upload-overlay",children:[a.jsx("div",{className:"upload-spinner"}),a.jsx("p",{children:"Uploading..."})]}),!i&&a.jsx("button",{className:"clear-button",onClick:v,title:"Remove photo",children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}):a.jsxs("div",{className:`upload-zone ${r?"dragging":""} ${e?"disabled":""}`,onDragOver:f,onDragLeave:h,onDrop:p,onClick:g,children:[a.jsx("input",{ref:u,type:"file",accept:"image/jpeg,image/png",onChange:m,style:{display:"none"},disabled:e}),a.jsx("div",{className:"upload-icon",children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),a.jsx("polyline",{points:"17 8 12 3 7 8"}),a.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]})}),a.jsxs("div",{className:"upload-text",children:[a.jsx("p",{className:"primary",children:r?"Drop photo here":"Upload site photo"}),a.jsx("p",{className:"secondary",children:"Drag & drop or click to browse"}),a.jsx("p",{className:"hint",children:"JPG or PNG, max 10MB"})]})]}),o&&a.jsx("div",{className:"error-message",children:o}),a.jsx("style",{children:`
        .in-situ-uploader {
          width: 100%;
        }

        .upload-zone {
          border: 2px dashed #d1d5db;
          border-radius: 8px;
          padding: 2rem;
          text-align: center;
          cursor: pointer;
          transition: all 0.2s;
          background: #f9fafb;
        }

        .upload-zone:hover {
          border-color: #ff6b35;
          background: #fff7f5;
        }

        .upload-zone.dragging {
          border-color: #ff6b35;
          background: #fff7f5;
          border-style: solid;
        }

        .upload-zone.disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .upload-zone.disabled:hover {
          border-color: #d1d5db;
          background: #f9fafb;
        }

        .upload-icon {
          width: 48px;
          height: 48px;
          margin: 0 auto 1rem;
          color: #9ca3af;
        }

        .upload-zone:hover .upload-icon {
          color: #ff6b35;
        }

        .upload-text .primary {
          font-size: 1rem;
          font-weight: 600;
          color: #374151;
          margin: 0 0 0.25rem;
        }

        .upload-text .secondary {
          font-size: 0.875rem;
          color: #6b7280;
          margin: 0 0 0.5rem;
        }

        .upload-text .hint {
          font-size: 0.75rem;
          color: #9ca3af;
          margin: 0;
        }

        .preview-container {
          position: relative;
          border-radius: 8px;
          overflow: hidden;
        }

        .preview-image {
          width: 100%;
          display: block;
          border-radius: 8px;
        }

        .upload-overlay {
          position: absolute;
          inset: 0;
          background: rgba(0, 0, 0, 0.6);
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          color: white;
        }

        .upload-spinner {
          width: 32px;
          height: 32px;
          border: 3px solid rgba(255, 255, 255, 0.3);
          border-top-color: white;
          border-radius: 50%;
          animation: spin 0.8s linear infinite;
          margin-bottom: 0.5rem;
        }

        @keyframes spin {
          to { transform: rotate(360deg); }
        }

        .clear-button {
          position: absolute;
          top: 0.5rem;
          right: 0.5rem;
          width: 32px;
          height: 32px;
          border-radius: 50%;
          background: rgba(0, 0, 0, 0.6);
          border: none;
          cursor: pointer;
          color: white;
          display: flex;
          align-items: center;
          justify-content: center;
          transition: background 0.2s;
        }

        .clear-button:hover {
          background: rgba(0, 0, 0, 0.8);
        }

        .clear-button svg {
          width: 16px;
          height: 16px;
        }

        .error-message {
          margin-top: 0.75rem;
          padding: 0.5rem 0.75rem;
          background: #fef2f2;
          border: 1px solid #fecaca;
          border-radius: 4px;
          color: #dc2626;
          font-size: 0.875rem;
        }
      `})]})}function uH(t,e){const[r,n,i,s,o,l,c,d]=t,[u,f,h,p,g,m,x,v]=e,y=[[r,n,1,0,0,0,-u*r,-u*n],[0,0,0,r,n,1,-f*r,-f*n],[i,s,1,0,0,0,-h*i,-h*s],[0,0,0,i,s,1,-p*i,-p*s],[o,l,1,0,0,0,-g*o,-g*l],[0,0,0,o,l,1,-m*o,-m*l],[c,d,1,0,0,0,-x*c,-x*d],[0,0,0,c,d,1,-v*c,-v*d]],w=hH(y,[u,f,h,p,g,m,x,v]);return function(_,C){const N=w[6]*_+w[7]*C+1,T=(w[0]*_+w[1]*C+w[2])/N,O=(w[3]*_+w[4]*C+w[5])/N;return[T,O]}}function hH(t,e){const r=t.length,n=t.map((s,o)=>[...s,e[o]]);for(let s=0;s<r;s++){let o=s;for(let l=s+1;l<r;l++)Math.abs(n[l][s])>Math.abs(n[o][s])&&(o=l);[n[s],n[o]]=[n[o],n[s]];for(let l=s+1;l<r;l++){const c=n[l][s]/n[s][s];for(let d=s;d<=r;d++)n[l][d]-=c*n[s][d]}}const i=new Array(r);for(let s=r-1;s>=0;s--){i[s]=n[s][r];for(let o=s+1;o<r;o++)i[s]-=n[s][o]*i[o];i[s]/=n[s][s]}return i}function mm(t){return new Promise((e,r)=>{const n=new Image;!t.startsWith("blob:")&&!t.startsWith("data:")?(n.crossOrigin="anonymous",console.log("[LOAD-IMAGE] Loading external URL with CORS:",t.substring(0,50))):console.log("[LOAD-IMAGE] Loading local URL (blob/data):",t.substring(0,50)),n.onload=()=>{console.log("[LOAD-IMAGE] Successfully loaded image:",t.substring(0,50)),e(n)},n.onerror=()=>{console.error("[LOAD-IMAGE] Failed to load image:",t),r(new Error(`Failed to load image: ${t}`))},n.src=t})}async function f_(t,e=1536){console.log("[RASTERIZE-SVG] Starting SVG rasterization:",t.substring(0,50),"maxSize:",e);const r=await mm(t),{naturalWidth:n,naturalHeight:i}=r;console.log("[RASTERIZE-SVG] SVG loaded with dimensions:",n,"x",i);const s=Math.min(1,e/Math.max(n,i)),o=Math.round(n*s),l=Math.round(i*s);console.log("[RASTERIZE-SVG] Scaling to:",o,"x",l,"(scale:",s.toFixed(2),")");const c=document.createElement("canvas");return c.width=o,c.height=l,c.getContext("2d").drawImage(r,0,0,o,l),console.log("[RASTERIZE-SVG] Drew SVG to canvas"),new Promise((u,f)=>{const h=new Image;h.onload=()=>{console.log("[RASTERIZE-SVG] Successfully rasterized SVG to PNG"),u(h)},h.onerror=p=>{console.error("[RASTERIZE-SVG] Failed to convert canvas to image:",p),f(p)},h.src=c.toDataURL("image/png")})}function p_({photoCtx:t,photoImg:e,designImg:r,quad:n,opacity:i,shape:s,lighting:o}){const l=t.canvas;t.clearRect(0,0,l.width,l.height),t.drawImage(e,0,0,l.width,l.height);const c=r.width,d=r.height,u=[0,0,c,0,c,d,0,d],f=[n[0].x,n[0].y,n[1].x,n[1].y,n[2].x,n[2].y,n[3].x,n[3].y],h=uH(u,f),p=10,g=c/p,m=d/p,x=document.createElement("canvas");if(x.width=c,x.height=d,x.getContext("2d").drawImage(r,0,0),t.save(),t.globalAlpha=i,o&&o.enabled){const b=o.strength||.6,w=1+(o.baseBrightness-1)*b,k=1+(o.baseContrast-1)*b;t.filter=`brightness(${w}) contrast(${k})`}const y=s&&s.length>=3?s:n;t.beginPath(),t.moveTo(y[0].x,y[0].y);for(let b=1;b<y.length;b++)t.lineTo(y[b].x,y[b].y);t.closePath(),t.clip();for(let b=0;b<p;b++)for(let w=0;w<p;w++){const k=b*g,_=w*m,C=(b+1)*g,N=(w+1)*m,T=h(k,_),O=h(C,_),X=h(C,N),E=h(k,N);uy(t,x,k,_,C,_,k,N,T[0],T[1],O[0],O[1],E[0],E[1]),uy(t,x,C,_,C,N,k,N,O[0],O[1],X[0],X[1],E[0],E[1])}t.restore()}function uy(t,e,r,n,i,s,o,l,c,d,u,f,h,p){t.save(),t.beginPath(),t.moveTo(c,d),t.lineTo(u,f),t.lineTo(h,p),t.closePath(),t.clip();const g=(r-o)*(s-l)-(i-o)*(n-l);if(Math.abs(g)<.001){t.restore();return}const m=((c-h)*(s-l)-(u-h)*(n-l))/g,x=((d-p)*(s-l)-(f-p)*(n-l))/g,v=((r-o)*(u-h)-(i-o)*(c-h))/g,y=((r-o)*(f-p)-(i-o)*(d-p))/g,b=c-m*r-v*n,w=d-x*r-y*n;t.setTransform(m,x,v,y,b,w),t.drawImage(e,0,0),t.restore()}function fH(t,e="tpv-in-situ-preview.png"){t.toBlob(r=>{const n=URL.createObjectURL(r),i=document.createElement("a");i.href=n,i.download=e,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(n)},"image/png")}function pH(t,e,r,n){const i=r/n,s=t*.6,o=e*.6;let l,c;i>s/o?(l=s,c=s/i):(c=o,l=o*i);const d=(t-l)/2,u=(e-c)/2;return[{x:d,y:u},{x:d+l,y:u},{x:d+l,y:u+c},{x:d,y:u+c}]}function mH(t,e,r){let n=!1;for(let i=0,s=r.length-1;i<r.length;s=i++){const o=r[i].x,l=r[i].y,c=r[s].x,d=r[s].y;l>e!=d>e&&t<(c-o)*(e-l)/(d-l)+o&&(n=!n)}return n}function gH(t,e,r){t/=255,e/=255,r/=255;const n=Math.max(t,e,r),i=Math.min(t,e,r),s=(n+i)/2;if(n===i)return{h:0,s:0,l:s};const o=n-i,l=s>.5?o/(2-n-i):o/(n+i);let c;switch(n){case t:c=((e-r)/o+(e<r?6:0))/6;break;case e:c=((r-t)/o+2)/6;break;case r:c=((t-e)/o+4)/6;break}return{h:c,s:l,l:s}}function vH(t,e,r=2e3){if(!t||!e||e.length<3)return{avgLightness:.5,avgContrastProxy:.5};const n=Math.floor(Math.min(...e.map(y=>y.x))),i=Math.ceil(Math.max(...e.map(y=>y.x))),s=Math.floor(Math.min(...e.map(y=>y.y))),o=Math.ceil(Math.max(...e.map(y=>y.y))),l=i-n,c=o-s;if(l<=0||c<=0)return{avgLightness:.5,avgContrastProxy:.5};let d;try{d=t.getImageData(n,s,l,c)}catch(y){return console.warn("[LIGHTING] Failed to get image data:",y),{avgLightness:.5,avgContrastProxy:.5}}const u=d.data,f=[];let h=0;const p=r*5;for(;f.length<r&&h<p;){h++;const y=n+Math.random()*l,b=s+Math.random()*c;if(!mH(y,b,e))continue;const w=Math.floor(y-n),_=(Math.floor(b-s)*l+w)*4;if(_<0||_>=u.length-3)continue;const C=u[_],N=u[_+1],T=u[_+2],{l:O}=gH(C,N,T);f.push(O)}if(f.length===0)return{avgLightness:.5,avgContrastProxy:.5};const g=f.reduce((y,b)=>y+b,0)/f.length,m=f.reduce((y,b)=>y+Math.pow(b-g,2),0)/f.length,x=Math.sqrt(m),v=Math.min(1,x/.25);return{avgLightness:g,avgContrastProxy:v}}function yH(t){let e=1,r=1;const i=t.avgLightness-.5;return e+=i*.6,r+=(t.avgContrastProxy-.5)*.4,e=Math.max(.7,Math.min(1.3,e)),r=Math.max(.8,Math.min(1.25,r)),{brightness:e,contrast:r}}const xH=100;function bH({photoUrl:t,svgUrl:e,designSizeMm:r,initialQuad:n,initialShape:i,initialOpacity:s=.8,initialLighting:o,onChange:l}){const[c,d]=P.useState(null),[u,f]=P.useState(null),[h,p]=P.useState(n||null),[g,m]=P.useState(i||null),[x,v]=P.useState(Math.max(.3,Math.min(1,s))),[y,b]=P.useState(o||{enabled:!1,strength:.6,baseBrightness:1,baseContrast:1}),[w,k]=P.useState(!0),[_,C]=P.useState(null),[N,T]=P.useState(1),[O,X]=P.useState("corners"),[E,F]=P.useState(null),[S,K]=P.useState(!1),[le,D]=P.useState(null),[I,L]=P.useState(null),Z=P.useRef(null),H=P.useRef(null),G=P.useRef(null),[ee,oe]=P.useState([]),fe=20;P.useEffect(()=>{Oe()},[t,e]),P.useEffect(()=>{c&&u&&h&&$e()},[c,u,h,g,x,y,O,E,S,I]),P.useEffect(()=>{if(!c||!h||h.length!==4)return;const A=document.createElement("canvas");A.width=c.naturalWidth,A.height=c.naturalHeight;const Y=A.getContext("2d");Y.drawImage(c,0,0);const se=vH(Y,h),{brightness:we,contrast:ne}=yH(se);b(Se=>({...Se,baseBrightness:we,baseContrast:ne}))},[c,JSON.stringify(h)]),P.useEffect(()=>{const A=Y=>{if(O==="shape"&&(Y.key==="Delete"||Y.key==="Backspace")&&I!==null&&g&&g.length>3){Y.preventDefault();const se=g.filter((we,ne)=>ne!==I);m(se),L(null),Ee(h,x,se)}};return window.addEventListener("keydown",A),()=>window.removeEventListener("keydown",A)},[O,I,g,h,x]);const Oe=async()=>{var A;console.log("[FOUR-POINT] Starting to load images - photo:",t==null?void 0:t.substring(0,50),"svg:",e==null?void 0:e.substring(0,50)),k(!0),C(null);try{console.log("[FOUR-POINT] Loading photo and rasterizing SVG...");const[Y,se]=await Promise.all([mm(t),f_(e,1536)]);console.log("[FOUR-POINT] Both images loaded successfully - photo:",Y.naturalWidth,"x",Y.naturalHeight,"design:",se.naturalWidth,"x",se.naturalHeight),d(Y),f(se);const we=((A=H.current)==null?void 0:A.clientWidth)||800,ne=500,Se=we/Y.naturalWidth,ke=ne/Y.naturalHeight,Ce=Math.min(1,Se,ke);if(T(Ce),console.log("[FOUR-POINT] Display scale set to:",Ce.toFixed(3)),n)console.log("[FOUR-POINT] Using provided initial quad");else{const xe=pH(Y.naturalWidth,Y.naturalHeight,r.width_mm,r.length_mm);p(xe),console.log("[FOUR-POINT] Initialized default quad")}}catch(Y){console.error("[FOUR-POINT] Failed to load images:",Y),C(Y.message)}finally{k(!1),console.log("[FOUR-POINT] Loading complete")}},$e=()=>{const A=Z.current;if(!A||!c||!u||!h)return;A.width=c.naturalWidth,A.height=c.naturalHeight;const Y=A.getContext("2d");p_({photoCtx:Y,photoImg:c,designImg:u,quad:h,opacity:x,shape:g,lighting:y}),Ie(Y)},Ie=A=>{if(!h)return;A.setTransform(1,0,0,1,0,0);const Y=Math.max(8,Math.min(15,c.naturalWidth/80));if(O==="corners"){A.strokeStyle="rgba(255, 255, 255, 0.8)",A.lineWidth=2,A.setLineDash([5,5]),A.beginPath(),A.moveTo(h[0].x,h[0].y),A.lineTo(h[1].x,h[1].y),A.lineTo(h[2].x,h[2].y),A.lineTo(h[3].x,h[3].y),A.closePath(),A.stroke(),A.setLineDash([]);const se=["TL","TR","BR","BL"];h.forEach((we,ne)=>{A.beginPath(),A.arc(we.x,we.y,Y,0,Math.PI*2),A.fillStyle=E===ne?"#ff6b35":"rgba(255, 107, 53, 0.9)",A.fill(),A.strokeStyle="white",A.lineWidth=2,A.stroke(),A.fillStyle="white",A.font="10px sans-serif",A.textAlign="center",A.textBaseline="middle",A.fillText(se[ne],we.x,we.y)})}else{const se=g||h;A.strokeStyle="rgba(34, 197, 94, 0.8)",A.lineWidth=2,A.setLineDash([]),A.beginPath(),A.moveTo(se[0].x,se[0].y);for(let we=1;we<se.length;we++)A.lineTo(se[we].x,se[we].y);A.closePath(),A.stroke(),se.forEach((we,ne)=>{A.beginPath(),A.arc(we.x,we.y,Y*.8,0,Math.PI*2),I===ne?A.fillStyle="#22c55e":E===ne?A.fillStyle="#16a34a":A.fillStyle="rgba(34, 197, 94, 0.9)",A.fill(),A.strokeStyle="white",A.lineWidth=2,A.stroke()}),A.strokeStyle="rgba(255, 107, 53, 0.3)",A.lineWidth=1,A.setLineDash([3,3]),A.beginPath(),A.moveTo(h[0].x,h[0].y),A.lineTo(h[1].x,h[1].y),A.lineTo(h[2].x,h[2].y),A.lineTo(h[3].x,h[3].y),A.closePath(),A.stroke(),A.setLineDash([])}},Ee=P.useCallback((A,Y,se,we)=>{G.current&&clearTimeout(G.current),G.current=setTimeout(()=>{l&&l({quad:A,opacity:Y,shape:se,lighting:we||y})},xH)},[l,y]),ge=P.useCallback(()=>{oe(A=>{const Y=[...A,{quad:[...h],shape:g?[...g]:null,opacity:x,lighting:{...y}}];return Y.length>fe?Y.slice(-fe):Y})},[h,g,x,y]),me=()=>{if(ee.length===0)return;const A=ee[ee.length-1];oe(Y=>Y.slice(0,-1)),p(A.quad),m(A.shape),v(A.opacity),b(A.lighting),Ee(A.quad,A.opacity,A.shape,A.lighting)},He=(A,Y)=>({x:A/N,y:Y/N}),ue=(A,Y,se)=>{if(!se)return-1;const we=25/N;for(let ne=0;ne<se.length;ne++){const Se=se[ne].x-A,ke=se[ne].y-Y;if(Math.sqrt(Se*Se+ke*ke)<we)return ne}return-1},j=(A,Y,se)=>{if(!se||se.length<3)return!1;let we=!1;for(let ne=0,Se=se.length-1;ne<se.length;Se=ne++){const ke=se[ne].x,Ce=se[ne].y,xe=se[Se].x,Ye=se[Se].y;Ce>Y!=Ye>Y&&A<(xe-ke)*(Y-Ce)/(Ye-Ce)+ke&&(we=!we)}return we},ce=A=>{if(O!=="shape"||!g||g.length<=3)return;const Y=Z.current;if(!Y)return;const se=Y.getBoundingClientRect(),we=A.clientX-se.left,ne=A.clientY-se.top,{x:Se,y:ke}=He(we,ne),Ce=ue(Se,ke,g);if(Ce>=0){ge();const xe=g.filter((Ke,ft)=>ft!==Ce);m(xe),L(null);const Ye=U(h,xe);Ye!==h?(p(Ye),Ee(Ye,x,xe)):Ee(h,x,xe)}},re=A=>{const Y=Z.current;if(!Y)return;const se=Y.getBoundingClientRect(),we=A.clientX-se.left,ne=A.clientY-se.top,{x:Se,y:ke}=He(we,ne);if(O==="corners"){const Ce=ue(Se,ke,h);Ce>=0?(ge(),F(Ce),Y.setPointerCapture(A.pointerId)):j(Se,ke,h)&&(ge(),K(!0),D({x:Se,y:ke}),Y.setPointerCapture(A.pointerId))}else{const Ce=g||h,xe=ue(Se,ke,Ce);if(xe>=0)ge(),F(xe),L(xe),Y.setPointerCapture(A.pointerId);else{ge();let Ye=0,Ke=1/0;for(let nt=0;nt<Ce.length;nt++){const ht=(nt+1)%Ce.length,tt=q(Se,ke,Ce[nt].x,Ce[nt].y,Ce[ht].x,Ce[ht].y);tt<Ke&&(Ke=tt,Ye=ht)}const ft={x:Se,y:ke},ut=[...Ce];ut.splice(Ye,0,ft),m(ut),L(Ye);const We=U(h,ut);We!==h?(p(We),Ee(We,x,ut)):Ee(h,x,ut)}}},z=A=>{if(E===null&&!S)return;const Y=Z.current;if(!Y)return;const se=Y.getBoundingClientRect(),we=A.clientX-se.left,ne=A.clientY-se.top,{x:Se,y:ke}=He(we,ne),Ce=Math.max(0,Math.min(c.naturalWidth,Se)),xe=Math.max(0,Math.min(c.naturalHeight,ke));if(O==="corners"){if(S&&le){const Ye=Ce-le.x,Ke=xe-le.y,ft=h.map(We=>({x:Math.max(0,Math.min(c.naturalWidth,We.x+Ye)),y:Math.max(0,Math.min(c.naturalHeight,We.y+Ke))}));let ut=g;g&&(ut=g.map(We=>({x:Math.max(0,Math.min(c.naturalWidth,We.x+Ye)),y:Math.max(0,Math.min(c.naturalHeight,We.y+Ke))})),m(ut)),p(ft),D({x:Ce,y:xe}),Ee(ft,x,ut)}else if(E!==null){const Ye=[...h];Ye[E]={x:Ce,y:xe},p(Ye),Ee(Ye,x,g)}}else{const Ke=[...g||h];Ke[E]={x:Ce,y:xe},m(Ke),Ee(h,x,Ke)}},R=A=>{if(E!==null||S){const Y=Z.current;if(Y&&Y.releasePointerCapture(A.pointerId),O==="shape"&&g&&E!==null){const se=U(h,g);se!==h&&(p(se),Ee(se,x,g))}F(null),K(!1),D(null)}},U=(A,Y)=>{if(!Y||Y.length<3||!A)return A;const se=A.reduce((We,nt)=>We+nt.x,0)/4,we=A.reduce((We,nt)=>We+nt.y,0)/4,ne=Y.reduce((We,nt)=>We+nt.x,0)/Y.length,Se=Y.reduce((We,nt)=>We+nt.y,0)/Y.length;let ke=1;for(const We of Y){const nt=We.x-se,ht=We.y-we,tt=Math.sqrt(nt*nt+ht*ht);if(tt<1)continue;const ct=ae(se,we,nt,ht,A);if(ct>0&&tt>ct){const Mt=tt/ct;ke=Math.max(ke,Mt)}}let Ce=1/0;for(const We of Y){const nt=We.x-se,ht=We.y-we,tt=Math.sqrt(nt*nt+ht*ht);if(tt<1)continue;const ct=ae(se,we,nt,ht,A);if(ct>0){const Mt=tt/ct;Ce=Math.min(Ce,Mt)}}let xe=ke;if(ke<=1&&Ce<1/0&&(xe=Ce),Math.abs(xe-1)<.01)return A;const Ye=A.map(We=>({x:se+(We.x-se)*xe,y:we+(We.y-we)*xe})),Ke=ne-se,ft=Se-we;return Ye.map(We=>({x:We.x+Ke,y:We.y+ft}))},ae=(A,Y,se,we,ne)=>{let Se=1/0;for(let ke=0;ke<4;ke++){const Ce=ne[ke],xe=ne[(ke+1)%4],Ye=xe.x-Ce.x,Ke=xe.y-Ce.y,ft=se*Ke-we*Ye;if(Math.abs(ft)<1e-4)continue;const ut=((Ce.x-A)*Ke-(Ce.y-Y)*Ye)/ft,We=((Ce.x-A)*we-(Ce.y-Y)*se)/ft;ut>0&&We>=0&&We<=1&&(Se=Math.min(Se,ut*Math.sqrt(se*se+we*we)))}return Se===1/0?0:Se},q=(A,Y,se,we,ne,Se)=>{const ke=A-se,Ce=Y-we,xe=ne-se,Ye=Se-we,Ke=ke*xe+Ce*Ye,ft=xe*xe+Ye*Ye;let ut=ft!==0?Ke/ft:-1,We,nt;return ut<0?(We=se,nt=we):ut>1?(We=ne,nt=Se):(We=se+ut*xe,nt=we+ut*Ye),Math.sqrt((A-We)**2+(Y-nt)**2)},M=()=>{O==="corners"?(g||m([...h]),X("shape"),L(null)):(X("corners"),L(null))},J=A=>{const Y=Math.max(.3,Math.min(1,parseFloat(A.target.value)/100));v(Y),Ee(h,Y,g)},de=A=>{const Y={...y,enabled:A.target.checked};b(Y),Ee(h,x,g,Y)},ie=A=>{const Y={...y,strength:parseFloat(A.target.value)/100};b(Y),Ee(h,x,g,Y)};return w?a.jsxs("div",{className:"four-point-editor loading",children:[a.jsx("div",{className:"spinner"}),a.jsx("p",{children:"Loading preview..."})]}):_?a.jsx("div",{className:"four-point-editor error",children:a.jsxs("p",{children:["Failed to load: ",_]})}):a.jsxs("div",{className:"four-point-editor",ref:H,children:[a.jsxs("div",{className:"editor-header",children:[a.jsxs("div",{className:"header-title",children:[a.jsx("h3",{children:"Position Your Design"}),a.jsx(_p,{content:a.jsxs("div",{children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Corners Mode:"})," Drag the 4 corner handles (TL, TR, BR, BL) to position your design with perspective. You can also drag inside the design to move all corners at once."]}),a.jsxs("p",{style:{marginTop:"0.5rem"},children:[a.jsx("strong",{children:"Refine Shape Mode:"})," Click anywhere to add new vertices for precise shape control. Drag existing vertices to adjust. Double-click or press Delete/Backspace on a vertex to remove it."]}),a.jsxs("p",{style:{marginTop:"0.5rem"},children:[a.jsx("strong",{children:"Overlay Opacity:"})," Adjust transparency to see how the design blends with your photo."]}),a.jsxs("p",{style:{marginTop:"0.5rem"},children:[a.jsx("strong",{children:"Match Floor Lighting:"})," Automatically adjusts design brightness to match your floor's lighting conditions."]})]}),position:"right"})]}),a.jsx("p",{className:"instructions",children:O==="corners"?"Drag the corner handles (TL, TR, BR, BL) to position the design. Drag inside to move all corners.":"Click to add vertices, drag to move them, double-click or press Delete to remove."})]}),a.jsx("div",{className:"canvas-container",children:a.jsx("canvas",{ref:Z,onPointerDown:re,onPointerMove:z,onPointerUp:R,onPointerLeave:R,onDoubleClick:ce,style:{width:`${((c==null?void 0:c.naturalWidth)||800)*N}px`,height:`${((c==null?void 0:c.naturalHeight)||600)*N}px`,cursor:E!==null||S?"grabbing":O==="shape"?"crosshair":"move",touchAction:"none"}})}),a.jsxs("div",{className:"controls",children:[a.jsxs("div",{className:"mode-toggle",children:[a.jsx("button",{className:`toggle-btn ${O==="corners"?"active":""}`,onClick:()=>X("corners"),children:"Corners"}),a.jsx("button",{className:`toggle-btn ${O==="shape"?"active":""}`,onClick:M,children:"Refine Shape"}),a.jsx("button",{className:"toggle-btn undo-btn",onClick:me,disabled:ee.length===0,title:"Undo last change",children:"Undo"})]}),a.jsxs("div",{className:"opacity-control",children:[a.jsxs("label",{children:["Overlay Opacity",a.jsxs("span",{className:"value",children:[Math.round(x*100),"%"]})]}),a.jsx("input",{type:"range",min:"30",max:"100",value:Math.round(x*100),onChange:J})]}),a.jsxs("div",{className:"lighting-control",children:[a.jsxs("label",{className:"checkbox-label",children:[a.jsx("input",{type:"checkbox",checked:y.enabled,onChange:de}),"Match floor lighting"]}),y.enabled&&a.jsxs("div",{className:"lighting-slider",children:[a.jsxs("label",{children:["Strength",a.jsxs("span",{className:"value",children:[Math.round(y.strength*100),"%"]})]}),a.jsx("input",{type:"range",min:"0",max:"100",value:Math.round(y.strength*100),onChange:ie})]})]})]}),a.jsx("style",{children:`
        .four-point-editor {
          display: flex;
          flex-direction: column;
          height: 100%;
        }

        .four-point-editor.loading,
        .four-point-editor.error {
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          min-height: 400px;
          color: #6b7280;
        }

        .four-point-editor .spinner {
          width: 40px;
          height: 40px;
          border: 3px solid #e5e7eb;
          border-top-color: #ff6b35;
          border-radius: 50%;
          animation: spin 0.8s linear infinite;
          margin-bottom: 1rem;
        }

        @keyframes spin {
          to { transform: rotate(360deg); }
        }

        .editor-header {
          padding-bottom: 1rem;
          border-bottom: 1px solid #e5e7eb;
          margin-bottom: 1rem;
        }

        .editor-header .header-title {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          margin-bottom: 0.5rem;
        }

        .editor-header h3 {
          margin: 0;
          font-size: 1.125rem;
          color: #1e4a7a;
        }

        .editor-header .instructions {
          margin: 0;
          font-size: 0.875rem;
          color: #6b7280;
        }

        .canvas-container {
          flex: 1;
          display: flex;
          align-items: center;
          justify-content: center;
          background: #f3f4f6;
          border-radius: 8px;
          overflow: hidden;
          min-height: 400px;
        }

        .canvas-container canvas {
          display: block;
        }

        .controls {
          padding-top: 1rem;
          border-top: 1px solid #e5e7eb;
          margin-top: 1rem;
          display: flex;
          flex-direction: column;
          gap: 1rem;
        }

        .mode-toggle {
          display: flex;
          gap: 0.5rem;
        }

        .toggle-btn {
          padding: 0.5rem 1rem;
          border: 1px solid #d1d5db;
          background: white;
          border-radius: 4px;
          font-size: 0.875rem;
          cursor: pointer;
          transition: all 0.2s;
        }

        .toggle-btn:hover {
          background: #f9fafb;
        }

        .toggle-btn.active {
          background: #ff6b35;
          color: white;
          border-color: #ff6b35;
        }

        .toggle-btn:disabled {
          opacity: 0.4;
          cursor: not-allowed;
        }

        .toggle-btn:disabled:hover {
          background: white;
        }

        .opacity-control {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .opacity-control label {
          display: flex;
          justify-content: space-between;
          font-size: 0.875rem;
          font-weight: 500;
          color: #374151;
        }

        .opacity-control .value {
          font-weight: 400;
          color: #6b7280;
        }

        .opacity-control input[type="range"] {
          width: 100%;
          height: 6px;
          border-radius: 3px;
          background: #e5e7eb;
          outline: none;
          -webkit-appearance: none;
        }

        .opacity-control input[type="range"]::-webkit-slider-thumb {
          -webkit-appearance: none;
          width: 16px;
          height: 16px;
          border-radius: 50%;
          background: #ff6b35;
          cursor: pointer;
        }

        .lighting-control {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .checkbox-label {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          font-size: 0.875rem;
          font-weight: 500;
          color: #374151;
          cursor: pointer;
        }

        .checkbox-label input[type="checkbox"] {
          width: 16px;
          height: 16px;
          cursor: pointer;
        }

        .lighting-slider {
          display: flex;
          flex-direction: column;
          gap: 0.25rem;
          padding-left: 1.5rem;
        }

        .lighting-slider label {
          display: flex;
          justify-content: space-between;
          font-size: 0.8rem;
          color: #6b7280;
        }

        .lighting-slider .value {
          font-weight: 400;
        }

        .lighting-slider input[type="range"] {
          width: 100%;
          height: 6px;
          border-radius: 3px;
          background: #e5e7eb;
          outline: none;
          -webkit-appearance: none;
        }

        .lighting-slider input[type="range"]::-webkit-slider-thumb {
          -webkit-appearance: none;
          width: 14px;
          height: 14px;
          border-radius: 50%;
          background: #22c55e;
          cursor: pointer;
        }
      `})]})}const Tn={UPLOAD:"upload",POSITION:"position"};function m_({designUrl:t,designDimensions:e,onClose:r,onSaved:n}){const[i,s]=P.useState(Tn.UPLOAD),[o,l]=P.useState(null),[c,d]=P.useState(null),[u,f]=P.useState(null),[h,p]=P.useState(.8),[g,m]=P.useState({enabled:!1,strength:.6,baseBrightness:1,baseContrast:1}),[x,v]=P.useState(!1),y=P.useRef(null);P.useEffect(()=>{if(t){console.log("[IN-SITU-MODAL] Design URL received:",t==null?void 0:t.substring(0,50));const T=new Image;!t.startsWith("blob:")&&!t.startsWith("data:")&&(T.crossOrigin="anonymous"),T.src=t}else console.warn("[IN-SITU-MODAL] No design URL provided")},[t]);const b=T=>{console.log("[IN-SITU-MODAL] Photo uploaded:",T),l(T),console.log("[IN-SITU-MODAL] Advancing to POSITION step, designUrl:",t==null?void 0:t.substring(0,50)),s(Tn.POSITION)},w=({quad:T,opacity:O,shape:X,lighting:E})=>{d(T),p(O),f(X),E&&m(E)},k=async()=>{if(!o||!c)return null;try{console.log("[InSitu] Loading design from URL:",t);const[T,O]=await Promise.all([mm(o.url),f_(t,1536)]);console.log("[InSitu] Successfully loaded design image");const X=document.createElement("canvas");X.width=T.naturalWidth,X.height=T.naturalHeight;const E=X.getContext("2d");return p_({photoCtx:E,photoImg:T,designImg:O,quad:c,opacity:h,shape:u,lighting:g}),X}catch(T){return console.error("[InSitu] Failed to generate canvas:",T),alert(`Failed to load design: ${T.message}`),null}},_=async()=>{const T=await k();T&&fH(T,"tpv-in-situ-preview.png")},C=async()=>{if(!(!c||!o)){v(!0);try{const T=await k();if(!T)throw new Error("Failed to generate preview");const O=await new Promise(K=>T.toBlob(K,"image/png")),E=`in-situ-previews/${`${Date.now()}-${Math.random().toString(36).substr(2,9)}.png`}`,{error:F}=await Vt.storage.from("tpv-studio-uploads").upload(E,O,{contentType:"image/png",cacheControl:"3600"});if(F)throw F;const{data:{publicUrl:S}}=Vt.storage.from("tpv-studio-uploads").getPublicUrl(E);n&&n({photo_url:o.supabaseUrl||o.url,quad:c,shape:u,opacity:h,lighting:g,preview_url:S}),r()}catch(T){console.error("[IN-SITU] Save failed:",T),alert("Failed to save preview: "+T.message)}finally{v(!1)}}},N=()=>{switch(i){case Tn.UPLOAD:return"Upload Site Photo";case Tn.POSITION:return"Position Your Design";default:return"In-Situ Preview"}};return a.jsxs("div",{className:"modal-overlay in-situ-modal-overlay",onClick:r,children:[a.jsxs("div",{className:"modal-content in-situ-modal",onClick:T=>T.stopPropagation(),children:[a.jsxs("div",{className:"modal-header",children:[a.jsxs("div",{className:"header-left",children:[a.jsx("h2",{children:N()}),a.jsxs("div",{className:"step-indicator",children:[a.jsx("span",{className:i===Tn.UPLOAD?"active":"completed",children:"1. Upload"}),a.jsx("span",{className:i===Tn.POSITION?"active":"",children:"2. Position"})]})]}),a.jsx("button",{onClick:r,className:"close-button",children:""})]}),a.jsxs("div",{className:"modal-body",children:[i===Tn.UPLOAD&&a.jsxs("div",{className:"upload-step",children:[a.jsx("p",{className:"step-description",children:"Upload a photo of your site to see how your TPV design will look when installed. For best results, use a photo taken from above or at a slight angle showing the floor area clearly."}),a.jsx(dH,{onPhotoUploaded:b})]}),i===Tn.POSITION&&o&&a.jsx(bH,{ref:y,photoUrl:o.url,svgUrl:t,designSizeMm:{width_mm:e.width,length_mm:e.length},initialOpacity:.8,onChange:w})]}),i===Tn.POSITION&&a.jsxs("div",{className:"modal-footer",children:[a.jsx("button",{onClick:()=>s(Tn.UPLOAD),className:"btn-secondary",children:"Back"}),a.jsxs("div",{className:"footer-actions",children:[a.jsx("button",{onClick:_,disabled:!c,className:"btn-secondary",children:"Download PNG"}),a.jsx("button",{onClick:C,disabled:!c||x,className:"btn-primary",children:x?"Saving...":"Save to Project"})]})]})]}),a.jsx("style",{children:`
        .in-situ-modal-overlay {
          position: fixed;
          inset: 0;
          background: rgba(0, 0, 0, 0.6);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 1000;
          padding: 1rem;
        }

        .in-situ-modal {
          background: white;
          border-radius: 12px;
          width: 100%;
          max-width: 1000px;
          max-height: 90vh;
          display: flex;
          flex-direction: column;
          box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .in-situ-modal .modal-header {
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
          padding: 1.25rem 1.5rem;
          border-bottom: 1px solid #e5e7eb;
        }

        .header-left {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .in-situ-modal .modal-header h2 {
          margin: 0;
          font-size: 1.25rem;
          color: #1e4a7a;
        }

        .step-indicator {
          display: flex;
          gap: 1rem;
          font-size: 0.75rem;
        }

        .step-indicator span {
          color: #9ca3af;
          padding: 0.25rem 0.5rem;
          border-radius: 4px;
        }

        .step-indicator span.active {
          background: #fff7f5;
          color: #ff6b35;
          font-weight: 500;
        }

        .step-indicator span.completed {
          color: #22c55e;
        }

        .close-button {
          background: none;
          border: none;
          font-size: 1.5rem;
          cursor: pointer;
          color: #9ca3af;
          padding: 0;
          line-height: 1;
        }

        .close-button:hover {
          color: #374151;
        }

        .modal-body {
          flex: 1;
          padding: 1.5rem;
          overflow-y: auto;
          min-height: 500px;
        }

        .upload-step {
          display: flex;
          flex-direction: column;
          gap: 1.5rem;
        }

        .step-description {
          margin: 0;
          font-size: 0.875rem;
          color: #6b7280;
          line-height: 1.6;
        }

        .modal-footer {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 1rem 1.5rem;
          border-top: 1px solid #e5e7eb;
          background: #f9fafb;
          border-radius: 0 0 12px 12px;
        }

        .footer-actions {
          display: flex;
          gap: 0.5rem;
        }

        .btn-primary,
        .btn-secondary {
          padding: 0.5rem 1rem;
          border-radius: 4px;
          font-size: 0.875rem;
          font-weight: 500;
          cursor: pointer;
          transition: all 0.2s;
          border: none;
        }

        .btn-primary {
          background: #ff6b35;
          color: white;
        }

        .btn-primary:hover:not(:disabled) {
          background: #e55a2b;
        }

        .btn-primary:disabled {
          background: #d1d5db;
          cursor: not-allowed;
        }

        .btn-secondary {
          background: white;
          color: #374151;
          border: 1px solid #d1d5db;
        }

        .btn-secondary:hover:not(:disabled) {
          background: #f9fafb;
        }

        .btn-secondary:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
          .in-situ-modal {
            max-width: 100%;
            max-height: 100vh;
            border-radius: 0;
          }

          .modal-body {
            padding: 1rem;
          }

          .step-indicator {
            display: none;
          }

          .modal-footer {
            border-radius: 0;
          }
        }
      `})]})}function wH({isOpen:t,onClose:e,onConfirm:r,aspectRatio:n,defaultLongestSide:i=5e3}){const[s,o]=P.useState(i),[l,c]=P.useState(i/1e3),u=(m=>{if(!n||n<=0)return{width:m,length:m};if(n>=1){const x=m,v=Math.round(m/n);return{width:x,length:v}}else{const x=m;return{width:Math.round(m*n),length:x}}})(s),f=n>=1?"landscape":"portrait",h=n>=1?`${n.toFixed(1)}:1`:`1:${(1/n).toFixed(1)}`,p=m=>{const x=parseFloat(m.target.value)||0;c(x),o(Math.round(x*1e3))},g=()=>{r(u.width,u.length),e()};return t?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"dimension-modal-overlay",onClick:e,children:a.jsxs("div",{className:"dimension-modal",onClick:m=>m.stopPropagation(),children:[a.jsxs("div",{className:"dimension-modal-header",children:[a.jsxs("div",{className:"dimension-modal-title",children:[a.jsx("h2",{children:"Set Installation Size"}),a.jsx(_p,{content:a.jsxs("div",{children:[a.jsx("p",{children:a.jsx("strong",{children:"Why specify dimensions?"})}),a.jsx("p",{style:{marginTop:"0.5rem"},children:"Accurate dimensions are essential for:"}),a.jsxs("ul",{style:{marginTop:"0.5rem",marginBottom:0,paddingLeft:"1.25rem"},children:[a.jsx("li",{children:"Calculating exact material quantities"}),a.jsx("li",{children:"Generating PDF specifications for manufacturers"}),a.jsx("li",{children:"Slicing designs into 1m1m installation tiles"})]}),a.jsxs("p",{style:{marginTop:"0.5rem"},children:[a.jsx("strong",{children:"Tip:"})," Typical playground installations range from 3m to 20m on the longest side."]})]}),position:"bottom"})]}),a.jsx("button",{className:"dimension-modal-close",onClick:e,"aria-label":"Close",children:""})]}),a.jsxs("div",{className:"dimension-modal-body",children:[a.jsx("div",{className:"dimension-info",children:a.jsxs("p",{className:"dimension-aspect",children:["Your design has a ",a.jsxs("strong",{children:[h," ",f]})," aspect ratio"]})}),a.jsxs("div",{className:"dimension-input-group",children:[a.jsx("label",{htmlFor:"longest-dimension",children:"Installation Size (Longest Side)"}),a.jsxs("div",{className:"dimension-input-wrapper",children:[a.jsx("input",{id:"longest-dimension",type:"number",min:"0.1",max:"50",step:"0.1",value:l,onChange:p,className:"dimension-input"}),a.jsx("span",{className:"dimension-unit",children:"meters"})]}),a.jsx("p",{className:"dimension-help",children:"Enter the measurement of the longest side of your installation area. The other dimension will be calculated automatically based on your design's aspect ratio."})]}),a.jsxs("div",{className:"dimension-preview",children:[a.jsx("div",{className:"dimension-preview-title",children:"Calculated Dimensions:"}),a.jsxs("div",{className:"dimension-preview-values",children:[a.jsxs("div",{className:"dimension-preview-item",children:[a.jsx("span",{className:"dimension-preview-label",children:"Width:"}),a.jsxs("span",{className:"dimension-preview-value",children:[(u.width/1e3).toFixed(2),"m"]})]}),a.jsxs("div",{className:"dimension-preview-item",children:[a.jsx("span",{className:"dimension-preview-label",children:"Length:"}),a.jsxs("span",{className:"dimension-preview-value",children:[(u.length/1e3).toFixed(2),"m"]})]}),a.jsxs("div",{className:"dimension-preview-item",children:[a.jsx("span",{className:"dimension-preview-label",children:"Total Area:"}),a.jsxs("span",{className:"dimension-preview-value",children:[(u.width*u.length/1e6).toFixed(2),"m"]})]})]})]}),a.jsxs("div",{className:"dimension-note",children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"8",cy:"8",r:"7"}),a.jsx("line",{x1:"8",y1:"11",x2:"8",y2:"8"}),a.jsx("circle",{cx:"8",cy:"5",r:"0.5",fill:"currentColor"})]}),a.jsx("p",{children:"These dimensions will be used to calculate material quantities for your PDF specification and to slice your design into 1m1m installation tiles."})]})]}),a.jsxs("div",{className:"dimension-modal-footer",children:[a.jsx("button",{className:"dimension-btn dimension-btn-secondary",onClick:e,children:"Cancel"}),a.jsx("button",{className:"dimension-btn dimension-btn-primary",onClick:g,disabled:l<=0,children:"Confirm Size"})]})]})}),a.jsx("style",{children:`
        .dimension-modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.6);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 10000;
        padding: 20px;
        backdrop-filter: blur(4px);
      }

      .dimension-modal {
        background: white;
        border-radius: 16px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        max-width: 500px;
        width: 100%;
        max-height: 90vh;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        animation: dimensionModalSlideIn 0.3s ease-out;
      }

      @keyframes dimensionModalSlideIn {
        from {
          opacity: 0;
          transform: translateY(-20px) scale(0.95);
        }
        to {
          opacity: 1;
          transform: translateY(0) scale(1);
        }
      }

      .dimension-modal-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 24px;
        border-bottom: 1px solid #e5e7eb;
      }

      .dimension-modal-title {
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .dimension-modal-header h2 {
        margin: 0;
        font-size: 1.5rem;
        font-weight: 600;
        color: #111827;
      }

      .dimension-modal-close {
        background: none;
        border: none;
        font-size: 2rem;
        line-height: 1;
        color: #9ca3af;
        cursor: pointer;
        padding: 0;
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 8px;
        transition: all 0.2s;
      }

      .dimension-modal-close:hover {
        background: #f3f4f6;
        color: #111827;
      }

      .dimension-modal-body {
        padding: 24px;
        overflow-y: auto;
        flex: 1;
      }

      .dimension-info {
        background: #f0f9ff;
        border: 1px solid #bae6fd;
        border-radius: 12px;
        padding: 16px;
        margin-bottom: 24px;
      }

      .dimension-aspect {
        margin: 0;
        color: #0c4a6e;
        font-size: 0.95rem;
        line-height: 1.5;
      }

      .dimension-input-group {
        margin-bottom: 24px;
      }

      .dimension-input-group label {
        display: block;
        font-weight: 600;
        color: #374151;
        margin-bottom: 8px;
        font-size: 0.95rem;
      }

      .dimension-input-wrapper {
        position: relative;
        display: flex;
        align-items: center;
      }

      .dimension-input {
        width: 100%;
        padding: 12px 16px;
        padding-right: 70px;
        font-size: 1.1rem;
        border: 2px solid #d1d5db;
        border-radius: 10px;
        transition: all 0.2s;
        font-family: inherit;
      }

      .dimension-input:focus {
        outline: none;
        border-color: #3b82f6;
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
      }

      .dimension-unit {
        position: absolute;
        right: 16px;
        color: #6b7280;
        font-weight: 500;
        pointer-events: none;
      }

      .dimension-help {
        margin: 8px 0 0 0;
        font-size: 0.85rem;
        color: #6b7280;
      }

      .dimension-preview {
        background: #f9fafb;
        border: 1px solid #e5e7eb;
        border-radius: 12px;
        padding: 20px;
        margin-bottom: 24px;
      }

      .dimension-preview-title {
        font-weight: 600;
        color: #374151;
        margin-bottom: 16px;
        font-size: 0.95rem;
      }

      .dimension-preview-values {
        display: flex;
        flex-direction: column;
        gap: 12px;
      }

      .dimension-preview-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 12px;
        background: white;
        border-radius: 8px;
      }

      .dimension-preview-label {
        color: #6b7280;
        font-size: 0.9rem;
      }

      .dimension-preview-value {
        font-weight: 600;
        color: #111827;
        font-size: 1.05rem;
      }

      .dimension-note {
        display: flex;
        gap: 12px;
        padding: 16px;
        background: #fffbeb;
        border: 1px solid #fde68a;
        border-radius: 10px;
      }

      .dimension-note svg {
        flex-shrink: 0;
        margin-top: 2px;
        color: #f59e0b;
      }

      .dimension-note p {
        margin: 0;
        font-size: 0.85rem;
        color: #78350f;
        line-height: 1.5;
      }

      .dimension-modal-footer {
        padding: 20px 24px;
        border-top: 1px solid #e5e7eb;
        display: flex;
        gap: 12px;
        justify-content: flex-end;
      }

      .dimension-btn {
        padding: 10px 24px;
        border-radius: 8px;
        font-weight: 600;
        font-size: 0.95rem;
        cursor: pointer;
        transition: all 0.2s;
        border: none;
        font-family: inherit;
      }

      .dimension-btn-secondary {
        background: white;
        border: 1px solid #d1d5db;
        color: #374151;
      }

      .dimension-btn-secondary:hover {
        background: #f9fafb;
        border-color: #9ca3af;
      }

      .dimension-btn-primary {
        background: #3b82f6;
        color: white;
      }

      .dimension-btn-primary:hover {
        background: #2563eb;
        box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
      }

      .dimension-btn-primary:disabled {
        background: #9ca3af;
        cursor: not-allowed;
        box-shadow: none;
      }

      @media (max-width: 640px) {
        .dimension-modal {
          max-width: none;
          width: 100%;
          margin: 0;
          max-height: 100vh;
          border-radius: 0;
        }

        .dimension-modal-header {
          padding: 20px;
        }

        .dimension-modal-header h2 {
          font-size: 1.25rem;
        }

        .dimension-modal-body {
          padding: 20px;
        }

        .dimension-modal-footer {
          flex-direction: column-reverse;
          padding: 16px 20px;
        }

        .dimension-btn {
          width: 100%;
        }
      }
      `})]}):null}const hy={landscape:[{name:"1:1",ratio:1,width:1024,height:1024},{name:"4:3",ratio:4/3,width:1024,height:768},{name:"3:2",ratio:3/2,width:1024,height:683},{name:"16:9",ratio:16/9,width:1024,height:576},{name:"2:1",ratio:2,width:1024,height:512},{name:"3:1",ratio:3,width:1024,height:341}],portrait:[{name:"1:1",ratio:1,width:1024,height:1024},{name:"3:4",ratio:3/4,width:768,height:1024},{name:"2:3",ratio:2/3,width:683,height:1024},{name:"9:16",ratio:9/16,width:576,height:1024},{name:"1:2",ratio:1/2,width:512,height:1024},{name:"1:3",ratio:1/3,width:341,height:1024}]},ha={safeDifference:.3,tilingThreshold:3.5,framingThreshold:2.5};function _H(t,e){return t/e}function SH(t){return t>=.95&&t<=1.05?"square":t>1?"landscape":"portrait"}function kH(t,e){const r=e==="portrait"?hy.portrait:hy.landscape;let n=r[0],i=Math.abs(t-n.ratio);for(const s of r){const o=Math.abs(t-s.ratio);o<i&&(i=o,n=s)}return{...n,difference:i}}function jH(t,e,r){return t>=ha.tilingThreshold||t<=1/ha.tilingThreshold?{mode:"tiling",reason:"Extreme aspect ratio - design will repeat along length",warning:!0}:r>=ha.safeDifference||t>=ha.framingThreshold||t<=1/ha.framingThreshold?{mode:"framing",reason:"Design panel centered with base color surround",warning:!1}:{mode:"full",reason:"Design fills entire surface",warning:!1}}function CH(t,e){const r=_H(t,e),n=SH(r),i=kH(r,n),s=jH(r,i.ratio,i.difference);return{user:{widthMM:t,heightMM:e,aspectRatio:r,orientation:n,formatted:`${(t/1e3).toFixed(1)}m  ${(e/1e3).toFixed(1)}m`},canonical:{name:i.name,ratio:i.ratio,width:i.width,height:i.height,difference:i.difference},layout:s,recraft:{width:i.width,height:i.height,metadata:{targetWidthMM:t,targetHeightMM:e,layoutMode:s.mode}}}}function EH(t){const{user:e,canonical:r,layout:n}=t;let i=`Generating ${r.name} design panel`;return n.mode==="full"?i+=` (fills ${e.formatted} surface)`:n.mode==="framing"?i+=` (centered in ${e.formatted} surface with base color surround)`:n.mode==="tiling"&&(i+=` (will repeat along ${e.formatted} surface)`),i}function TH(t){return t.layout.warning||t.layout.mode!=="full"}async function fy(t,e="tpv-studio-uploads"){try{const r=Date.now(),n=Math.random().toString(36).substring(7),i=t.name.split(".").pop(),o=`uploads/${`${r}-${n}.${i}`}`;console.log("[Upload] Uploading file:",t.name,"",o);const{data:l,error:c}=await Vt.storage.from(e).upload(o,t,{cacheControl:"3600",upsert:!1});if(c)return console.error("[Upload] Error:",c),{success:!1,error:c.message||"Failed to upload file"};const{data:{publicUrl:d}}=Vt.storage.from(e).getPublicUrl(o);return console.log("[Upload] Success:",d),{success:!0,url:d,path:o}}catch(r){return console.error("[Upload] Unexpected error:",r),{success:!1,error:r.message||"Unexpected error during upload"}}}function py(t,e={}){const{maxSizeMB:r=10,allowedTypes:n=["image/png","image/jpeg","image/svg+xml"]}=e;if(!t)return{valid:!1,error:"No file selected"};if(!n.includes(t.type))return{valid:!1,error:`Invalid file type. Allowed: ${n.map(o=>o.split("/")[1].toUpperCase()).join(", ")}`};const i=r*1024*1024;return t.size>i?{valid:!1,error:`File too large. Maximum size: ${r}MB`}:{valid:!0}}function NH({onExportSVG:t,onExportPNG:e,onExportPDF:r,onExportTiles:n,viewMode:i,exporting:s,disabled:o}){const[l,c]=P.useState(!1),d=P.useRef(null);P.useEffect(()=>{const h=p=>{d.current&&!d.current.contains(p.target)&&c(!1)};return l&&document.addEventListener("mousedown",h),()=>document.removeEventListener("mousedown",h)},[l]);const u=i==="solid"?"Solid":"Blend",f=h=>{c(!1),h()};return a.jsxs("div",{className:"playground-export-menu",ref:d,children:[a.jsxs("button",{className:"action-bar__btn action-bar__btn--export",onClick:()=>c(!l),disabled:o||s,children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"}),a.jsx("polyline",{points:"7 10 12 15 17 10"}),a.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),s?"Exporting...":"Export",a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{marginLeft:"0.25rem"},children:a.jsx("path",{d:l?"M18 15l-6-6-6 6":"M6 9l6 6 6-6"})})]}),l&&a.jsxs("div",{className:"playground-export-menu__dropdown",children:[a.jsxs("button",{className:"playground-export-menu__item",onClick:()=>f(t),children:[a.jsx("span",{className:"playground-export-menu__icon",children:""}),a.jsxs("div",{className:"playground-export-menu__content",children:[a.jsxs("span",{className:"playground-export-menu__title",children:["Download ",u," SVG"]}),a.jsx("span",{className:"playground-export-menu__desc",children:"Vector format for CAD/printing"})]})]}),a.jsxs("button",{className:"playground-export-menu__item",onClick:()=>f(e),children:[a.jsx("span",{className:"playground-export-menu__icon",children:""}),a.jsxs("div",{className:"playground-export-menu__content",children:[a.jsxs("span",{className:"playground-export-menu__title",children:["Download ",u," PNG"]}),a.jsx("span",{className:"playground-export-menu__desc",children:"High-res image for presentations"})]})]}),a.jsxs("button",{className:"playground-export-menu__item",onClick:()=>f(n),children:[a.jsx("span",{className:"playground-export-menu__icon",children:""}),a.jsxs("div",{className:"playground-export-menu__content",children:[a.jsx("span",{className:"playground-export-menu__title",children:"Download Tiles ZIP"}),a.jsx("span",{className:"playground-export-menu__desc",children:"1m1m SVG tiles for large printing"})]})]}),a.jsx("div",{className:"playground-export-menu__divider"}),a.jsxs("button",{className:"playground-export-menu__item",onClick:()=>f(r),children:[a.jsx("span",{className:"playground-export-menu__icon",children:""}),a.jsxs("div",{className:"playground-export-menu__content",children:[a.jsxs("span",{className:"playground-export-menu__title",children:[u," Recipe Report (PDF)"]}),a.jsx("span",{className:"playground-export-menu__desc",children:"TPV quantities & specifications"})]})]})]})]})}function RH({loadedDesign:t,onDesignSaved:e,isEmbedded:r=!1}){var Ne;const n=Vc(),{inputMode:i,prompt:s,lengthMM:o,widthMM:l,arMapping:c,uploadedFileUrl:d,result:u,jobId:f,blendRecipes:h,colorMapping:p,blendSvgUrl:g,blendEditedColors:m,solidRecipes:x,solidColorMapping:v,solidSvgUrl:y,solidEditedColors:b,viewMode:w,showFinalRecipes:k,showSolidSummary:_,regionOverrides:C,originalTaggedSvg:N,regionOverridesHistory:T,historyIndex:O,designName:X,currentDesignId:E,hasUnsavedChanges:F,resetDesign:S}=n,K=n.setInputMode,le=n.setPrompt,D=n.setDimensions,I=n.setArMapping;n.setGenerationResult;const L=n.setResult,Z=n.setJobId;n.setBlendState;const H=n.setBlendRecipes,G=n.setColorMapping,ee=n.setBlendSvgUrl;n.setSolidState;const oe=n.setSolidRecipes,fe=n.setSolidColorMapping,Oe=n.setSolidSvgUrl;n.updateBlendSvgUrl,n.updateSolidSvgUrl;const $e=n.setBlendEditedColors,Ie=n.setSolidEditedColors,Ee=n.setViewMode,ge=n.setShowFinalRecipes,me=n.setShowSolidSummary,He=n.setRegionOverrides;n.addRegionOverride;const ue=n.setOriginalTaggedSvg,j=n.setRegionOverridesHistory,ce=n.setHistoryIndex;n.canUndo,n.canRedo,n.undo,n.redo;const re=n.setDesignName,z=n.setCurrentDesignId,R=n.loadDesign,U=Q=>D(Q,o),ae=Q=>D(l,Q),[q,M]=P.useState(null),[J,de]=P.useState(null),[ie,A]=P.useState(!1),[Y,se]=P.useState(!1),[we,ne]=P.useState(null),[Se,ke]=P.useState(null),[Ce,xe]=P.useState(""),[Ye,Ke]=P.useState(null),[ft,ut]=P.useState(!1),[We,nt]=P.useState(null),[ht,tt]=P.useState(!1),[ct,Mt]=P.useState(null),[Br,In]=P.useState([]),[Dn,zn]=P.useState(!1),[Nt,Cr]=P.useState(!1),[Kt,mr]=P.useState(null),[lr,Ht]=P.useState(!1),[tr,Qr]=P.useState(!1),[Fn,Er]=P.useState(!1),[_t,xn]=P.useState(null),[pt,$t]=P.useState(!1),[et,at]=P.useState(null),[Ut,rt]=P.useState(null),[Hr,bn]=P.useState(null),[ks,ci]=P.useState(null),Tr=P.useRef(null);P.useEffect(()=>{(y||g)&&Tr.current&&!Nt&&!ft&&setTimeout(()=>{var Q;(Q=Tr.current)==null||Q.scrollIntoView({behavior:"smooth",block:"start"})},300)},[y,g,Nt,ft]),P.useEffect(()=>{(async()=>{try{const he=await Wc({limit:1,offset:0});ci(he.designs.length>0),console.log("[INSPIRE] Existing designs check:",he.designs.length>0?"User has designs":"No designs found")}catch(he){console.error("[INSPIRE] Failed to check for existing designs:",he),ci(!0)}})()},[]),P.useEffect(()=>{i==="image"||i==="svg"?(D(null,null),console.log("[DIMENSION] Reset dimensions for upload mode:",i)):i==="prompt"&&(l===null||o===null)&&(D(5e3,5e3),console.log("[DIMENSION] Restored default dimensions for prompt mode"))},[i,D]),P.useEffect(()=>()=>{g&&g.startsWith("blob:")&&URL.revokeObjectURL(g),y&&y.startsWith("blob:")&&URL.revokeObjectURL(y)},[]),P.useEffect(()=>{const Q=he=>{he.key==="Escape"&&ht&&(tt(!1),Mt(null))};return window.addEventListener("keydown",Q),()=>window.removeEventListener("keydown",Q)},[ht]),P.useEffect(()=>{Br.length>0&&!Dn&&Jo()},[Br,Dn]),P.useEffect(()=>{if(t){console.log("[INSPIRE] Loading design data:",t);const Q=ff(t);console.log("[INSPIRE] Restored state:",Q),R(Q),t.name&&re(t.name),t.id&&z(t.id),console.log("[INSPIRE] Loaded design:",t.name),setTimeout(async()=>{var he;if((he=Q.result)!=null&&he.svg_url){console.log("[INSPIRE] Regenerating SVGs from loaded design");let be=Q.originalTaggedSvg||null;if(be)console.log("[INSPIRE] Using saved tagged SVG with preserved region IDs"),ue(be);else try{const De=await(await fetch(Q.result.svg_url)).text();be=Co(De),ue(be),console.log("[INSPIRE] Tagged SVG with region IDs for loaded design")}catch(ye){console.error("[INSPIRE] Failed to tag SVG regions:",ye)}try{Q.blendRecipes&&Q.colorMapping&&await qe(Q.result.svg_url,Q.colorMapping,Q.blendRecipes,Q.blendEditedColors,be,Q.regionOverrides),Q.solidRecipes&&Q.solidColorMapping&&await Pe(Q.result.svg_url,Q.solidColorMapping,Q.solidRecipes,Q.solidEditedColors,be,Q.regionOverrides)}catch(ye){console.error("[INSPIRE] Failed to regenerate SVGs:",ye),ke("Failed to restore design preview. Please try reloading.")}}},100)}},[t,R,re,z,ue]);const wn=P.useRef(!1);P.useEffect(()=>{if(t||wn.current||!((u==null?void 0:u.svg_url)&&!g&&!y&&(h||x)))return;wn.current=!0,console.log("[INSPIRE] Detected design loaded directly into store, regenerating SVGs..."),(async()=>{let be=N||null;if(be)console.log("[INSPIRE] Using existing tagged SVG with preserved region IDs");else try{const De=await(await fetch(u.svg_url)).text();be=Co(De),ue(be),console.log("[INSPIRE] Tagged SVG with region IDs")}catch(ye){console.error("[INSPIRE] Failed to tag SVG regions:",ye)}try{h&&p&&await qe(u.svg_url,p,h,m,be,C),x&&v&&await Pe(u.svg_url,v,x,b,be,C)}catch(ye){console.error("[INSPIRE] Failed to regenerate SVGs:",ye),ke("Failed to restore design preview. Please try reloading.")}})()},[u,g,y,h,x,p,v,t,C,N]),P.useEffect(()=>{u||(wn.current=!1)},[u]);const gt=Q=>{var De;const he=(De=Q.target.files)==null?void 0:De[0];if(!he){M(null);return}const ye=py(he,{maxSizeMB:10,allowedTypes:i==="image"?["image/png","image/jpeg"]:["image/svg+xml"]});if(!ye.valid){ke(ye.error),M(null);return}M(he),ke(null)},Bn=Q=>{Q.preventDefault(),Q.stopPropagation(),A(!0)},di=Q=>{Q.preventDefault(),Q.stopPropagation(),Q.currentTarget===Q.target&&A(!1)},Ur=Q=>{Q.preventDefault(),Q.stopPropagation()},Hn=Q=>{Q.preventDefault(),Q.stopPropagation(),A(!1);const he=Q.dataTransfer.files;if(he&&he.length>0){const be=he[0],De=py(be,{maxSizeMB:10,allowedTypes:i==="image"?["image/png","image/jpeg"]:["image/svg+xml"]});if(!De.valid){ke(De.error),M(null);return}M(be),ke(null)}},Un=async()=>{var Q,he;if(i==="prompt"&&!s.trim()){ke("Please enter a design description");return}if((i==="image"||i==="svg")&&!q){ke("Please select a file to upload");return}ke(null),se(!0),ne(null),L(null),Z(null),xe("Initialising..."),Ke(null);try{let be;if(i==="svg"){xe("Uploading SVG file..."),de("Uploading...");const Me=await fy(q);if(!Me.success)throw new Error(Me.error||"Failed to upload file");if(xe("Processing SVG..."),de(null),be=await Yi.processUploadedSVG({svg_url:Me.url}),!be.success)throw new Error(be.error||"Failed to process SVG");Z(be.jobId),xe(" SVG uploaded successfully!"),se(!1);const Ge=await Yi.getRecraftStatus(be.jobId);ne(Ge),L(Ge.result),(Q=Ge.result)!=null&&Q.svg_url&&await Sn(Ge.result.svg_url,be.jobId);return}if(i==="image"){xe("Uploading image..."),de("Uploading...");const Me=await fy(q);if(!Me.success)throw new Error(Me.error||"Failed to upload file");if(xe("Starting vectorisation..."),de(null),be=await Yi.vectorizeImage({image_url:Me.url}),!be.success)throw new Error(be.error||"Failed to start vectorisation");xe(" AI is vectorising your image...")}else{const Me=CH(o,l);if(I(Me),console.log("[TPV-STUDIO] AR Mapping:",Me),console.log("[TPV-STUDIO] Layout:",EH(Me)),TH(Me)?xe(`Generating ${Me.canonical.name} design panel...`):xe("Initialising..."),be=await Yi.generateRecraft({prompt:s.trim(),lengthMM:Me.recraft.height,widthMM:Me.recraft.width}),!be.success)throw new Error(be.error||"Failed to start generation");xe(" AI is creating your design...")}Z(be.jobId),xe("Request submitted, waiting for processing...");let ye=null,De=Date.now();await Yi.waitForRecraftCompletion(be.jobId,Me=>{var Ue,it;ne(Me);const Ge=Math.floor((Date.now()-De)/1e3);if(Me.status==="queued"){const mt=[` Preparing your canvas... (${Ge}s)`,` Warming up the AI brushes... (${Ge}s)`,` Queueing your masterpiece... (${Ge}s)`,` Mixing digital paints... (${Ge}s)`,` AI is contemplating your vision... (${Ge}s)`,` Selecting the perfect colours... (${Ge}s)`,` Calculating vector paths... (${Ge}s)`,` Almost ready to create... (${Ge}s)`],Re=Math.floor(Ge/4)%mt.length;xe(mt[Re])}else if(Me.status==="running")if(ye!=="running")xe(" AI is creating your design..."),ye="running";else{const mt=[` Creating vector shapes... (${Ge}s)`,` Applying colours and patterns... (${Ge}s)`,` Refining design details... (${Ge}s)`,` Finalising artwork... (${Ge}s)`],Re=Math.floor(Ge/5)%mt.length;xe(mt[Re])}else if(Me.status==="retrying"){const mt=((Ue=Me.recraft)==null?void 0:Ue.attempt_current)||0,Re=((it=Me.recraft)==null?void 0:it.attempt_max)||3;xe(` Retrying generation (attempt ${mt}/${Re})...`)}});const Be=await Yi.getRecraftStatus(be.jobId);ne(Be),L(Be.result),Be.status==="completed"&&(xe(" Design ready!"),se(!1),(he=Be.result)!=null&&he.svg_url&&await Sn(Be.result.svg_url,be.jobId))}catch(be){console.error("Generation failed:",be),ke(be.message),xe(""),se(!1)}},js=()=>{const Q=w==="solid"?y:g,he=w==="solid"?"tpv-solid":"tpv-blend";if(Q){const be=document.createElement("a");be.href=Q,be.download=`${he}-${Date.now()}.svg`,document.body.appendChild(be),be.click(),document.body.removeChild(be)}},Wn=async Q=>{try{const be=await(await fetch(Q)).text(),Be=new DOMParser().parseFromString(be,"image/svg+xml").querySelector("svg");if(!Be)return null;let Me,Ge;const Ue=Be.getAttribute("viewBox");if(Ue){const mt=Ue.split(/\s+/).map(Number);Me=mt[2],Ge=mt[3]}else Me=parseFloat(Be.getAttribute("width"))||1024,Ge=parseFloat(Be.getAttribute("height"))||1024;const it=Me/Ge;return console.log(`[DIMENSION] Detected aspect ratio: ${it.toFixed(2)} (${Me}${Ge})`),it}catch(he){return console.error("[DIMENSION] Failed to detect aspect ratio:",he),null}},Zo=(Q,he)=>{console.log(`[DIMENSION] User confirmed dimensions: ${Q}mm  ${he}mm`),U(Q),ae(he),bn({width:Q,height:he}),Ut==="pdf"?setTimeout(()=>ui(Q,he),100):Ut==="tiles"?setTimeout(()=>Gn(Q,he),100):Ut==="insitu"?setTimeout(()=>Er(!0),100):Ut==="save"&&Ht(!0),rt(null)},en=async()=>{const Q=w==="solid"?y:g;if((i==="image"||i==="svg")&&(!l||!o)){console.log("[DIMENSION] No dimensions set for image/SVG upload, showing modal...");const he=await Wn(Q);if(he){at(he),rt("insitu"),$t(!0);return}else{at(1),rt("insitu"),$t(!0);return}}Er(!0)},_n=()=>{const Q=w==="solid"?y:g,he=w==="solid"?"tpv-solid":"tpv-blend";if(Q){const be=new Image;be.onload=()=>{const ye=document.createElement("canvas");ye.width=be.naturalWidth||1e3,ye.height=be.naturalHeight||1e3,ye.getContext("2d").drawImage(be,0,0),ye.toBlob(Be=>{const Me=URL.createObjectURL(Be),Ge=document.createElement("a");Ge.href=Me,Ge.download=`${he}-${Date.now()}.png`,document.body.appendChild(Ge),Ge.click(),document.body.removeChild(Ge),URL.revokeObjectURL(Me)})},be.src=Q}},tn=()=>{F()&&!window.confirm(`Start a new design?

You have unsaved changes that will be lost.`)||(S(),M(null),se(!1),ne(null),ke(null),xe(""),Ke(null),ut(!1),nt(null),tt(!1),Mt(null),Cr(!1),mr(null))},rn=async()=>{const Q=w==="solid"?y:g,he=l>0&&o>0;if((i==="image"||i==="svg")&&!he){console.log("[DIMENSION] No dimensions set for image/SVG upload, showing modal before save...");const ye=await Wn(Q);if(ye){at(ye),rt("save"),$t(!0);return}else{at(1),rt("save"),$t(!0);return}}Ht(!0)},[Ui,Wi]=P.useState(!1),Cs=async()=>{const Q=w==="solid"?y:g;if((i==="image"||i==="svg")&&(!l||!o)){console.log("[DIMENSION] No dimensions set for image/SVG upload, showing modal...");const he=await Wn(Q);if(he){at(he),rt("pdf"),$t(!0);return}else{at(1),rt("pdf"),$t(!0);return}}await ui(l,o)},ui=async(Q,he)=>{const be=w==="solid"?y:g,ye=w==="solid"?x:h,De=w==="solid"?"tpv-solid":"tpv-blend";if(!be||!ye){ke("Cannot generate PDF: missing SVG or recipes");return}Wi(!0),ke(null);try{const Me=await(await fetch(be)).text(),Ge=new AbortController,Ue=setTimeout(()=>Ge.abort(),3e4),it=await Pn.getSession(),mt={"Content-Type":"application/json"};it!=null&&it.access_token&&(mt.Authorization=`Bearer ${it.access_token}`);const Re=await fetch("/api/export-pdf",{method:"POST",headers:mt,signal:Ge.signal,body:JSON.stringify({svgString:Me,designName:X||s||"TPV Design",projectName:"TPV Studio",dimensions:{widthMM:Q,lengthMM:he},recipes:ye,mode:w,designId:f||""})});if(clearTimeout(Ue),!Re.ok){const vt=Re.headers.get("content-type");if(vt&&vt.includes("application/json")){const Dt=await Re.json();throw new Error(Dt.message||"PDF generation failed")}else{const Dt=await Re.text();throw console.error("PDF API error response:",Dt),new Error(`Server error: ${Re.status}`)}}const V=await Re.blob(),pe=URL.createObjectURL(V),_e=document.createElement("a");_e.href=pe,_e.download=`${De}-${Date.now()}.pdf`,document.body.appendChild(_e),_e.click(),document.body.removeChild(_e),URL.revokeObjectURL(pe)}catch(Be){console.error("PDF download error:",Be),Be.name==="AbortError"?ke("PDF generation timed out. Please try again."):ke(`PDF generation failed: ${Be.message}`)}finally{Wi(!1)}},Es=async()=>{const Q=w==="solid"?y:g;if(!Q){ke("No SVG available to slice");return}if((i==="image"||i==="svg")&&(!l||!o)){console.log("[DIMENSION] No dimensions set for image/SVG upload, showing modal...");const he=await Wn(Q);if(he){at(he),rt("tiles"),$t(!0);return}else{at(1),rt("tiles"),$t(!0);return}}await Gn(l,o)},Gn=async(Q,he)=>{const be=w==="solid"?y:g;try{await iE(be,{width:Q,length:he},X||"tpv-design")}catch(ye){console.error("Tile download error:",ye),ke(`Failed to download tiles: ${ye.message}`)}},Sn=async(Q=null,he=null)=>{const be=Q||(u==null?void 0:u.svg_url),ye=he||f;if(!be){ke("No SVG available to analyse");return}ee(null),H(null),G(null),console.log("[TPV-STUDIO] Cleared old blend state, starting new blend generation"),ke(null),xe(" Extracting colours from design..."),await new Promise(De=>setTimeout(De,100));try{const De=await fetch("/api/blend-recipes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({svg_url:be,job_id:ye,max_colors:15,max_components:2})}),Be=await De.json();if(!De.ok)throw new Error(Be.error||"Failed to generate blend recipes");if(Be.success){xe(" Matching TPV granule colours..."),await new Promise(Ue=>setTimeout(Ue,300)),H(Be.recipes);const Me=k5(Be.recipes);console.log("[TPV-STUDIO] Color mapping built with",Me.size,"entries:"),Array.from(Me.entries()).forEach(([Ue,it])=>{console.log(`  ${Ue} -> ${it.blendHex}`)}),G(Me);let Ge=null;try{const it=await(await fetch(be)).text();Ge=Co(it),ue(Ge),console.log("[TPV-STUDIO] Tagged SVG with region IDs for per-element editing")}catch(Ue){console.error("[TPV-STUDIO] Failed to tag SVG regions:",Ue)}try{xe(" Generating TPV blend preview..."),await new Promise(mt=>setTimeout(mt,200)),console.log("[TPV-STUDIO] Generating recoloured SVG from:",be),console.log("[TPV-STUDIO] Using mapping with",Me.size,"colors");const{dataUrl:Ue,stats:it}=await vi(be,Me,Ge);ee(Ue),xe(" TPV blend ready!"),console.log("[TPV-STUDIO] Recolour stats:",{totalColors:it.totalColors,colorsReplaced:it.colorsReplaced,colorsNotMapped:Array.from(it.colorsNotMapped)}),it.colorsNotMapped.size>0&&console.warn("[TPV-STUDIO] Some colors were not mapped:",Array.from(it.colorsNotMapped)),Gi(be,ye,Ge)}catch(Ue){console.error("[TPV-STUDIO] Failed to generate recoloured SVG:",Ue),ke(`Recipes generated successfully, but SVG recolouring failed: ${Ue.message}`)}}else throw new Error(Be.error||"Unknown error generating recipes")}catch(De){console.error("Blend generation failed:",De),ke(De.message),xe("")}},gr=async()=>{ut(!1),nt(null),Cr(!1),mr(null),w==="solid"?Ie(new Map):$e(new Map),u!=null&&u.svg_url&&await Sn(u.svg_url,f)},kn=async Q=>{var he;if(!X){if(!s||i!=="prompt"){q&&re(`TPV Design  ${q.name.replace(/\.[^/.]+$/,"")}`);return}Qr(!0);try{const be=(Q==null?void 0:Q.slice(0,6).map(De=>{var Me,Ge;const Be=(Ge=(Me=De.chosenRecipe)==null?void 0:Me.components)==null?void 0:Ge[0];return(Be==null?void 0:Be.name)||null}).filter(Boolean))||[],ye=await Yi.generateDesignName({prompt:s,colors:be,dimensions:{widthMM:l,lengthMM:o}});ye.success&&((he=ye.names)==null?void 0:he.length)>0?re(ye.names[0]):re(hi(s))}catch(be){console.error("[TPV-STUDIO] Name generation failed:",be),re(hi(s))}finally{Qr(!1)}}},hi=Q=>Q?`TPV Design  ${Q.split(/[,.]/)[0].trim().slice(0,40)}`:"TPV Playground Design",Gi=async(Q=null,he=null,be=null)=>{const ye=Q||(u==null?void 0:u.svg_url),De=he||f,Be=be||N;if(ye)try{console.log("[TPV-STUDIO] Generating solid color version...");const Me=await fetch("/api/solid-recipes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({svg_url:ye,job_id:De,max_colors:15})}),Ge=await Me.json();if(!Me.ok)throw new Error(Ge.error||"Failed to generate solid recipes");if(Ge.success){oe(Ge.recipes);const Ue=new Map(Object.entries(Ge.colorMapping||{}));console.log("[TPV-STUDIO] Using API colorMapping with",Ue.size,"entries"),fe(Ue);try{const{dataUrl:it,stats:mt}=await vi(ye,Ue,Be);Oe(it),console.log("[TPV-STUDIO] Solid color SVG generated:",mt),mt.colorsNotMapped&&mt.colorsNotMapped.size>0&&console.warn("[TPV-STUDIO] Unmapped colors in solid mode:",Array.from(mt.colorsNotMapped)),kn(Ge.recipes)}catch(it){console.error("[TPV-STUDIO] Failed to generate solid SVG:",it)}}}catch(Me){console.error("[TPV-STUDIO] Solid generation failed:",Me)}},Ts=(Q,he="palette")=>{if(console.log("[TPV-STUDIO] Color clicked:",Q,"source:",he,"in mode:",w),ht&&ct&&he==="palette"){Wr(ct.regionId,Q.hex),tt(!1),Mt(null);return}he==="palette"&&(w==="blend"?(mr(Q),Cr(!0),ge(!1)):(nt(Q),ut(!0),me(!1)))},jn=Q=>{console.log("[TPV-STUDIO] Region clicked:",Q),ht?(Wr(ct.regionId,Q.sourceColor),tt(!1),Mt(null)):(tt(!0),Mt(Q))},Wr=(Q,he)=>{console.log("[TPV-STUDIO] Queuing region recolor:",Q,"->",he),In(be=>[...be,{regionId:Q,newHex:he.toLowerCase(),viewMode:w}])},Jo=async()=>{if(Dn||Br.length===0)return;zn(!0);const Q=Br[0];console.log("[TPV-STUDIO] Processing queued region recolor:",Q.regionId,"->",Q.newHex);try{const he=new Map(C);he.set(Q.regionId,Q.newHex),Q.viewMode==="blend"?await Ae(null,null,he):await Ze(null,null,he),He(he);const be=n.historyIndex,De=n.regionOverridesHistory.slice(0,be+1);De.push(new Map(he)),De.length>50&&De.shift(),j(De),ce(De.length-1),console.log("[TPV-STUDIO] Completed region recolor for:",Q.regionId)}catch(he){console.error("[TPV-STUDIO] Failed to process region recolor:",he)}finally{In(he=>he.slice(1)),zn(!1)}},Cn=()=>{console.log("[TPV-STUDIO] Eyedropper cancelled"),tt(!1),Mt(null)},Ns=()=>{ct&&(console.log("[TPV-STUDIO] Making region transparent:",ct.regionId),Wr(ct.regionId,"transparent"),tt(!1),Mt(null))},B=Q=>{ct&&(console.log("[TPV-STUDIO] Selecting TPV color for region:",ct.regionId,Q),Wr(ct.regionId,Q),tt(!1),Mt(null))},te=async()=>{if(O<=0)return;const Q=O-1,he=T[Q];console.log("[TPV-STUDIO] Undoing region override to index:",Q),He(new Map(he)),ce(Q),w==="blend"?await Ae(null,null,he):await Ze(null,null,he)},W=async()=>{if(O>=T.length-1)return;const Q=O+1,he=T[Q];console.log("[TPV-STUDIO] Redoing region override to index:",Q),He(new Map(he)),ce(Q),w==="blend"?await Ae(null,null,he):await Ze(null,null,he)},ve=async Q=>{if(We)if(console.log("[TPV-STUDIO] Color changed:",We.hex,"->",Q,"in mode:",w),w==="solid"){const he=new Map(b),be=x.find(De=>De.targetColor.hex.toLowerCase()===We.hex.toLowerCase()),ye=(be==null?void 0:be.mergedOriginalColors)||[We.originalHex.toLowerCase()];console.log("[TPV-STUDIO] Updating",ye.length,"merged colors:",ye),ye.forEach(De=>{he.set(De,{newHex:Q.toLowerCase()})}),Ie(he),nt({...We,hex:Q,blendHex:Q}),await Ze(he,Q)}else{const he=new Map(m);he.set(We.originalHex.toLowerCase(),{newHex:Q.toLowerCase()}),$e(he),nt({...We,hex:Q,blendHex:Q}),await Ae(he,Q)}},Xe=P.useCallback(async({blendHex:Q,parts:he,recipe:be})=>{if(!Kt)return;console.log("[TPV-STUDIO] Mixer blend changed:",Kt.originalHex,"->",Q,"recipe:",be);const ye=new Map(m);ye.set(Kt.originalHex.toLowerCase(),{newHex:Q.toLowerCase(),recipe:be,parts:he}),$e(ye),mr({...Kt,hex:Q,blendHex:Q}),await Ae(ye,Q)},[Kt,m,u,p]),Ae=async(Q=null,he=null,be=null)=>{if(!(!(u!=null&&u.svg_url)||!p||!h))try{const ye=new Map(p),De=Q||m;De.forEach((V,pe)=>{if(V.newHex){const _e=pe.toLowerCase();ye.set(_e,{...ye.get(_e),blendHex:V.newHex})}});const Be=h.map(V=>{const pe=De.get(V.originalColor.hex.toLowerCase());if(pe!=null&&pe.newHex){const _e={...V,targetColor:{...V.targetColor,hex:pe.newHex},blendColor:{...V.blendColor,hex:pe.newHex}};return pe.recipe&&pe.recipe.components&&(_e.chosenRecipe={...V.chosenRecipe,components:pe.recipe.components,deltaE:0,quality:"Excellent"}),_e}return V}),{svgText:Me,stats:Ge}=await vi(u.svg_url,ye,N),Ue=be!==null?be:C,it=vo(Me,Ue);g&&g.startsWith("blob:")&&(URL.revokeObjectURL(g),console.log("[TPV-STUDIO] Revoked old blend blob URL"));const mt=new Blob([it],{type:"image/svg+xml"}),Re=URL.createObjectURL(mt);console.log("[TPV-STUDIO] Created new blend blob URL, SVG length:",it.length),ee(Re),G(ye),H(Be),console.log("[TPV-STUDIO] Blend SVG regenerated with edits:",Ge),Ue.size>0&&console.log("[TPV-STUDIO] Applied",Ue.size,"region overrides")}catch(ye){console.error("[TPV-STUDIO] Failed to regenerate blend SVG:",ye)}},Ze=async(Q=null,he=null,be=null)=>{if(!(!(u!=null&&u.svg_url)||!v||!x))try{const ye=new Map(v),De=Q||b;De.forEach((V,pe)=>{if(V.newHex){const _e=pe.toLowerCase();ye.set(_e,{...ye.get(_e),blendHex:V.newHex})}});const Be=x.map(V=>{const pe=De.get(V.originalColor.hex.toLowerCase());if(pe!=null&&pe.newHex){const _e=Sr.find(vt=>vt.hex.toLowerCase()===pe.newHex.toLowerCase());return _e?{...V,targetColor:{...V.targetColor,hex:pe.newHex},blendColor:{hex:pe.newHex,rgb:_e.rgb,lab:_e.lab},chosenRecipe:{components:[{code:_e.code,name:_e.name,hex:_e.hex,rgb:_e.rgb,lab:_e.lab,ratio:1}],blendColor:{hex:_e.hex,rgb:_e.rgb,lab:_e.lab},deltaE:0,quality:"Perfect"}}:{...V,targetColor:{...V.targetColor,hex:pe.newHex},blendColor:{...V.blendColor,hex:pe.newHex}}}return V}),{svgText:Me,stats:Ge}=await vi(u.svg_url,ye,N),Ue=be!==null?be:C,it=vo(Me,Ue);y&&y.startsWith("blob:")&&(URL.revokeObjectURL(y),console.log("[TPV-STUDIO] Revoked old solid blob URL"));const mt=new Blob([it],{type:"image/svg+xml"}),Re=URL.createObjectURL(mt);console.log("[TPV-STUDIO] Created new solid blob URL, SVG length:",it.length),Oe(Re),fe(ye),oe(Be),console.log("[TPV-STUDIO] Solid SVG regenerated with edits:",Ge),Ue.size>0&&console.log("[TPV-STUDIO] Applied",Ue.size,"region overrides")}catch(ye){console.error("[TPV-STUDIO] Failed to regenerate solid SVG:",ye)}},qe=async(Q,he,be,ye,De=null,Be=null)=>{try{console.log("[INSPIRE] Regenerating blend SVG from state");const Me=new Map(he);ye&&ye.size>0&&ye.forEach((V,pe)=>{const _e=pe.toLowerCase();Me.has(_e)&&Me.set(_e,{...Me.get(_e),blendHex:V.newHex})});const{dataUrl:Ge,svgText:Ue}=await vi(Q,Me,De);let it=Ue;Be&&Be.size>0&&(console.log("[INSPIRE] Applying",Be.size,"region overrides to blend SVG"),it=vo(Ue,Be));const mt=new Blob([it],{type:"image/svg+xml"}),Re=URL.createObjectURL(mt);ee(Re),console.log("[INSPIRE] Blend SVG regenerated")}catch(Me){console.error("[INSPIRE] Failed to regenerate blend SVG:",Me)}},Pe=async(Q,he,be,ye,De=null,Be=null)=>{try{console.log("[INSPIRE] Regenerating solid SVG from state");const Me=new Map(he);ye&&ye.size>0&&ye.forEach((V,pe)=>{const _e=pe.toLowerCase();Me.has(_e)&&Me.set(_e,{...Me.get(_e),blendHex:V.newHex})});const{dataUrl:Ge,svgText:Ue}=await vi(Q,Me,De);let it=Ue;Be&&Be.size>0&&(console.log("[INSPIRE] Applying",Be.size,"region overrides to solid SVG"),it=vo(Ue,Be));const mt=new Blob([it],{type:"image/svg+xml"}),Re=URL.createObjectURL(mt);Oe(Re),console.log("[INSPIRE] Solid SVG regenerated")}catch(Me){console.error("[INSPIRE] Failed to regenerate solid SVG:",Me)}};return a.jsxs("div",{className:`inspire-panel-recraft${r?" inspire-panel-recraft--embedded":""}`,children:[!r&&a.jsxs("div",{className:"panel-header",children:[a.jsx("h2",{children:"TPV Studio - Vector AI"}),a.jsx("p",{className:"subtitle",children:"AI-powered vector designs for playground surfacing"})]}),!u&&!Y&&ks===!1&&a.jsxs("div",{className:"welcome-guidance",children:[a.jsx("div",{className:"welcome-icon",children:""}),a.jsx("h3",{children:"Create Your First Design"}),a.jsx("p",{children:"Choose how you'd like to create your TPV design below. You can describe what you want, upload an image to convert, or process an existing SVG file. Once generated, you'll be able to edit colours, export PDFs with specifications, and preview designs on-site."})]}),a.jsxs("div",{className:"input-mode-tabs",children:[a.jsxs("button",{className:`input-mode-tab ${i==="prompt"?"active":""}`,onClick:()=>{K("prompt"),M(null),ke(null)},disabled:Y,children:[a.jsxs("svg",{className:"mode-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M12 3l1.545 4.635L18.18 9.18l-4.635 1.545L12 15.36l-1.545-4.635L5.82 9.18l4.635-1.545L12 3z"}),a.jsx("path",{d:"M5 21l1.5-4.5L2 15l4.5-1.5L8 9l1.5 4.5L14 15l-4.5 1.5L8 21z",opacity:"0.5"})]}),a.jsx("span",{className:"mode-title",children:"Text Prompt"}),a.jsx("span",{className:"mode-description",children:"Describe your design"})]}),a.jsxs("button",{className:`input-mode-tab ${i==="image"?"active":""}`,onClick:()=>{K("image"),le(""),ke(null)},disabled:Y,children:[a.jsxs("svg",{className:"mode-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]}),a.jsx("span",{className:"mode-title",children:"Upload Image"}),a.jsx("span",{className:"mode-description",children:"Vectorise PNG/JPG"})]}),a.jsxs("button",{className:`input-mode-tab ${i==="svg"?"active":""}`,onClick:()=>{K("svg"),le(""),ke(null)},disabled:Y,children:[a.jsx("svg",{className:"mode-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),a.jsx("span",{className:"mode-title",children:"Upload SVG"}),a.jsx("span",{className:"mode-description",children:"Process existing vector"})]})]}),a.jsxs("div",{className:"form-section",children:[i==="prompt"&&a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"prompt",children:"Design Description"}),a.jsx("textarea",{id:"prompt",value:s,onChange:Q=>le(Q.target.value),placeholder:"e.g., calm ocean theme with big fish silhouettes and waves",rows:4,disabled:Y,className:"prompt-input"}),a.jsx("p",{className:"helper-text",children:"Describe the design you want to generate. The AI will create a vector illustration based on your description. Perfect for creating completely new designs from scratch - just describe colors, themes, and elements you want."})]}),i==="image"&&a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"image-upload",children:"Upload Image (PNG/JPG)"}),a.jsxs("div",{className:`drop-zone ${ie?"dragging":""} ${q?"has-file":""}`,onDragEnter:Bn,onDragLeave:di,onDragOver:Ur,onDrop:Hn,children:[a.jsx("input",{id:"image-upload",type:"file",accept:"image/png,image/jpeg",onChange:gt,disabled:Y,className:"file-input-hidden"}),a.jsx("label",{htmlFor:"image-upload",className:"drop-zone-content",children:q?a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"upload-icon success",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),a.jsx("span",{className:"file-name",children:q.name}),a.jsx("span",{className:"drop-hint",children:"Click to change file"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"upload-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),a.jsx("polyline",{points:"17 8 12 3 7 8"}),a.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]}),a.jsx("span",{className:"drop-text",children:"Drag & drop your image here"}),a.jsx("span",{className:"drop-hint",children:"or click to browse"})]})})]}),a.jsx("p",{className:"helper-text",children:"Upload a raster image (PNG or JPG). The AI will convert it to vector format (SVG) suitable for TPV surfacing. Best for converting photos, logos, or artwork into clean vectors that can be manufactured with TPV granules."})]}),i==="svg"&&a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"svg-upload",children:"Upload SVG File"}),a.jsxs("div",{className:`drop-zone ${ie?"dragging":""} ${q?"has-file":""}`,onDragEnter:Bn,onDragLeave:di,onDragOver:Ur,onDrop:Hn,children:[a.jsx("input",{id:"svg-upload",type:"file",accept:"image/svg+xml",onChange:gt,disabled:Y,className:"file-input-hidden"}),a.jsx("label",{htmlFor:"svg-upload",className:"drop-zone-content",children:q?a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"upload-icon success",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),a.jsx("span",{className:"file-name",children:q.name}),a.jsx("span",{className:"drop-hint",children:"Click to change file"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"upload-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),a.jsx("polyline",{points:"17 8 12 3 7 8"}),a.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]}),a.jsx("span",{className:"drop-text",children:"Drag & drop your SVG here"}),a.jsx("span",{className:"drop-hint",children:"or click to browse"})]})})]}),a.jsx("p",{className:"helper-text",children:"Upload an existing SVG vector file. It will be processed immediately for TPV colour matching - no AI generation needed. Ideal when you already have a vector design and just need to match colors to available TPV granules."})]}),i==="prompt"&&a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"length",children:"Length (mm)"}),a.jsx("input",{id:"length",type:"number",value:o,onChange:Q=>ae(parseInt(Q.target.value,10)),min:1e3,max:2e4,step:100,disabled:Y})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"width",children:"Width (mm)"}),a.jsx("input",{id:"width",type:"number",value:l,onChange:Q=>U(parseInt(Q.target.value,10)),min:1e3,max:2e4,step:100,disabled:Y})]})]}),Se&&a.jsxs("div",{className:"error-message",children:[a.jsx("strong",{children:"Error:"})," ",Se]}),J&&a.jsx("div",{className:"upload-progress",children:a.jsx("p",{children:J})}),a.jsx("button",{onClick:Un,disabled:Y||i==="prompt"&&!s.trim()||(i==="image"||i==="svg")&&!q,className:"generate-button",children:Y?i==="svg"?"Processing...":"Generating...":i==="prompt"?"Generate Vector Design":i==="image"?"Vectorise & Process":"Process SVG"})]}),Y&&a.jsxs("div",{className:"progress-section",children:[a.jsx("div",{className:"progress-bar",children:a.jsx("div",{className:"progress-bar-fill"})}),a.jsx("p",{className:"progress-message",children:Ce})]}),u&&!Y&&a.jsxs("div",{className:"results-section",children:[c&&a.jsxs("div",{className:`ar-info ${c.layout.mode}`,children:[a.jsxs("div",{className:"ar-info-header",children:[a.jsx("strong",{children:"Layout:"})," ",c.layout.reason]}),a.jsxs("div",{className:"ar-info-details",children:[a.jsxs("span",{children:["Requested: ",c.user.formatted]}),a.jsx("span",{children:""}),a.jsxs("span",{children:["Generated: ",c.canonical.name," panel"]}),c.layout.mode==="framing"&&a.jsxs(a.Fragment,{children:[a.jsx("span",{children:""}),a.jsx("span",{className:"layout-note",children:"Panel centred with base colour surround"})]}),c.layout.mode==="tiling"&&a.jsxs(a.Fragment,{children:[a.jsx("span",{children:""}),a.jsx("span",{className:"layout-note",children:"Pattern will repeat along length"})]})]})]}),g&&h&&a.jsxs("div",{className:"mode-tabs",children:[a.jsxs("button",{className:`mode-tab ${w==="solid"?"active":""}`,onClick:()=>Ee("solid"),disabled:!y,children:[a.jsx("span",{className:"mode-title",children:"Solid Mode"}),a.jsx("span",{className:"mode-description",children:y?"Single TPV colours only":"Generating..."})]}),a.jsxs("button",{className:`mode-tab ${w==="blend"?"active":""}`,onClick:()=>Ee("blend"),children:[a.jsx("span",{className:"mode-title",children:"Blend Mode"}),a.jsx("span",{className:"mode-description",children:"Advanced: Mixed granules"})]})]}),w==="blend"&&g&&h&&a.jsx("div",{ref:Tr,children:a.jsx(j0,{blendSvgUrl:g,recipes:h,mode:"blend",onColorClick:Ts,onRegionClick:jn,onEyedropperCancel:Cn,onMakeTransparent:Ns,onSelectTPVColor:B,selectedColor:We,editedColors:m,onResetAll:gr,designName:X,onNameChange:re,isNameLoading:tr,onInSituClick:en,eyedropperActive:ht,eyedropperRegion:ct,onRegionUndo:te,onRegionRedo:W,canUndo:O>0,canRedo:O<T.length-1,regionOverridesCount:C.size})}),w==="solid"&&y&&x&&a.jsx("div",{ref:Tr,children:a.jsx(j0,{blendSvgUrl:y,recipes:x,mode:"solid",onColorClick:Ts,onRegionClick:jn,onEyedropperCancel:Cn,onMakeTransparent:Ns,onSelectTPVColor:B,selectedColor:We,editedColors:b,onResetAll:gr,designName:X,onNameChange:re,isNameLoading:tr,onInSituClick:en,eyedropperActive:ht,eyedropperRegion:ct,onRegionUndo:te,onRegionRedo:W,canUndo:O>0,canRedo:O<T.length-1,regionOverridesCount:C.size})}),Nt&&Kt&&a.jsxs("div",{className:"mixer-widget-container",children:[a.jsx("div",{className:"mixer-widget-header",children:a.jsx("button",{className:"mixer-close-btn",onClick:()=>{Cr(!1),mr(null)},children:"Close Mixer"})}),a.jsx(sH,{initialRecipe:((Ne=m.get(Kt.originalHex.toLowerCase()))==null?void 0:Ne.recipe)||Kt.recipe||null,onBlendChange:Xe,originalColor:Kt.originalHex})]}),g&&a.jsxs("div",{className:"action-bar",children:[a.jsxs("button",{className:"action-bar__btn action-bar__btn--secondary",onClick:tn,title:"Start a new design",children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 5v14M5 12h14"})}),"New"]}),a.jsxs("button",{className:"action-bar__btn action-bar__btn--primary",onClick:rn,title:"Save this design to your gallery",children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z"}),a.jsx("polyline",{points:"17 21 17 13 7 13 7 21"}),a.jsx("polyline",{points:"7 3 7 8 15 8"})]}),"Save"]}),a.jsx(NH,{onExportSVG:js,onExportPNG:_n,onExportPDF:Cs,onExportTiles:Es,viewMode:w,exporting:Ui,disabled:!g})]})]}),w==="blend"&&g&&h&&!k&&a.jsxs("div",{className:"finalize-section",children:[a.jsx("button",{onClick:()=>ge(!0),className:"finalize-button",children:"View Recipe Details"}),a.jsx("p",{className:"finalize-hint",children:"Click to see detailed blend formulas and quality metrics"})]}),w==="solid"&&y&&x&&!_&&a.jsxs("div",{className:"finalize-section",children:[a.jsx("button",{onClick:()=>me(!0),className:"finalize-button",children:"View TPV Colours Used"}),a.jsx("p",{className:"finalize-hint",children:"See which pure TPV colours are used in this design"})]}),k&&h&&a.jsx(lE,{recipes:h,onClose:()=>{ge(!1)}}),_&&x&&a.jsx(cE,{recipes:x,onClose:()=>{me(!1)}}),ft&&We&&a.jsx(k7,{color:We,mode:w,onColorChange:ve,onClose:()=>{ut(!1),nt(null)}}),lr&&a.jsx(aH,{currentState:{inputMode:i,prompt:s,selectedFile:q,lengthMM:(Hr==null?void 0:Hr.height)||o,widthMM:(Hr==null?void 0:Hr.width)||l,result:u,viewMode:w,blendRecipes:h,solidRecipes:x,colorMapping:p,solidColorMapping:v,solidEditedColors:b,blendEditedColors:m,blendSvgUrl:g,solidSvgUrl:y,arMapping:c,jobId:f,inSituData:_t,regionOverrides:C,originalTaggedSvg:N},existingDesignId:E,initialName:X,onClose:()=>{Ht(!1),bn(null)},onSaved:(Q,he)=>{Ht(!1),bn(null),ci(!0),he&&re(he),e&&e(he),console.log("[INSPIRE] Design saved:",Q)}}),Fn&&a.jsx(m_,{designUrl:w==="solid"?y:g,designDimensions:{width:l,length:o},onClose:()=>Er(!1),onSaved:Q=>{console.log("[INSPIRE] In-situ preview saved:",Q),xn(Q),Er(!1)}}),a.jsx(wH,{isOpen:pt,onClose:()=>{$t(!1),rt(null)},onConfirm:Zo,aspectRatio:et,defaultLongestSide:5e3}),a.jsx("style",{jsx:!0,children:`
        .inspire-panel-recraft {
          max-width: var(--max-width-xl);
          margin: 0 auto;
          padding: var(--space-4);
        }

        .panel-header {
          text-align: center;
          margin-bottom: var(--space-6);
        }

        .panel-header h2 {
          font-family: var(--font-heading);
          font-size: var(--text-3xl);
          margin: 0 0 var(--space-2) 0;
          color: var(--color-primary);
          font-weight: var(--font-bold);
          letter-spacing: var(--tracking-tight);
        }

        .subtitle {
          color: var(--color-text-secondary);
          font-size: var(--text-base);
          line-height: var(--leading-relaxed);
        }

        /* Welcome Guidance */
        .welcome-guidance {
          background: linear-gradient(135deg, #fff5f0 0%, #fff9f7 100%);
          border: 2px solid #ff6b35;
          border-radius: var(--radius-lg);
          padding: var(--space-6);
          margin-bottom: var(--space-6);
          text-align: center;
        }

        .welcome-icon {
          font-size: 3rem;
          margin-bottom: var(--space-2);
        }

        .welcome-guidance h3 {
          margin: 0 0 var(--space-3);
          font-size: var(--text-xl);
          font-weight: var(--font-bold);
          color: var(--color-primary);
        }

        .welcome-guidance p {
          margin: 0;
          color: var(--color-text-secondary);
          font-size: var(--text-base);
          line-height: var(--leading-relaxed);
          max-width: 600px;
          margin-left: auto;
          margin-right: auto;
        }

        /* Input Mode Tabs - Enhanced cards */
        .input-mode-tabs {
          display: flex;
          gap: var(--space-2);
          margin-bottom: var(--space-4);
          background: var(--color-bg-subtle);
          padding: var(--space-1);
          border-radius: var(--radius-lg);
        }

        .input-mode-tab {
          flex: 1;
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: var(--space-2);
          padding: var(--space-4);
          background: var(--color-bg-card);
          border: 1px solid var(--color-border);
          border-radius: var(--radius-md);
          cursor: pointer;
          transition: all var(--transition-base);
        }

        .input-mode-tab:hover:not(:disabled) {
          border-color: var(--color-primary);
          transform: translateY(-2px);
          box-shadow: var(--shadow-md);
        }

        .input-mode-tab.active {
          background: linear-gradient(135deg, var(--color-bg-subtle) 0%, var(--color-bg-card) 100%);
          border-color: var(--color-primary);
          box-shadow: var(--shadow-glow);
        }

        .input-mode-tab:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .mode-icon {
          width: 32px;
          height: 32px;
          color: var(--color-text-secondary);
          transition: all var(--transition-base);
        }

        .input-mode-tab:hover:not(:disabled) .mode-icon {
          color: var(--color-primary);
          transform: scale(1.1);
        }

        .input-mode-tab.active .mode-icon {
          color: var(--color-primary);
        }

        .input-mode-tab .mode-title {
          font-family: var(--font-heading);
          font-size: var(--text-base);
          font-weight: var(--font-semibold);
          color: var(--color-text-primary);
          margin-top: var(--space-1);
        }

        .input-mode-tab .mode-description {
          font-size: var(--text-sm);
          color: var(--color-text-secondary);
          text-align: center;
          line-height: var(--leading-snug);
        }

        .input-mode-tab.active .mode-title {
          color: var(--color-primary);
          font-weight: var(--font-bold);
        }

        /* Helper text */
        .helper-text {
          margin-top: var(--space-1);
          font-size: var(--text-sm);
          color: var(--color-text-tertiary);
          font-style: normal;
          line-height: var(--leading-snug);
        }

        /* Drag & Drop File Upload */
        .file-input-hidden {
          position: absolute;
          width: 1px;
          height: 1px;
          padding: 0;
          margin: -1px;
          overflow: hidden;
          clip: rect(0, 0, 0, 0);
          white-space: nowrap;
          border: 0;
        }

        .drop-zone {
          position: relative;
          width: 100%;
          min-height: 180px;
          border: 2px dashed var(--color-border);
          border-radius: var(--radius-lg);
          background: var(--color-bg-subtle);
          transition: all var(--transition-base);
        }

        .drop-zone.dragging {
          border-color: var(--color-primary);
          background: var(--color-primary-light);
          background: linear-gradient(135deg, rgba(30, 74, 122, 0.05) 0%, rgba(30, 74, 122, 0.1) 100%);
          box-shadow: var(--shadow-glow);
        }

        .drop-zone.has-file {
          border-color: var(--color-success);
          background: var(--color-success-light);
        }

        .drop-zone-content {
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          gap: var(--space-2);
          padding: var(--space-6);
          cursor: pointer;
          min-height: 180px;
        }

        .upload-icon {
          width: 48px;
          height: 48px;
          color: var(--color-text-secondary);
          transition: all var(--transition-base);
        }

        .upload-icon.success {
          color: var(--color-success);
        }

        .drop-zone:hover .upload-icon {
          color: var(--color-primary);
          transform: scale(1.1);
        }

        .drop-zone.has-file:hover .upload-icon.success {
          color: var(--color-success);
        }

        .drop-text {
          font-size: var(--text-base);
          font-weight: var(--font-semibold);
          color: var(--color-text-primary);
        }

        .file-name {
          font-size: var(--text-base);
          font-weight: var(--font-semibold);
          color: var(--color-success);
          max-width: 100%;
          overflow: hidden;
          text-overflow: ellipsis;
          white-space: nowrap;
        }

        .drop-hint {
          font-size: var(--text-sm);
          color: var(--color-text-tertiary);
        }

        .drop-zone.dragging .drop-text,
        .drop-zone.dragging .drop-hint {
          color: var(--color-primary);
        }

        .upload-progress {
          padding: var(--space-2);
          background: var(--color-info-light);
          border: 1px solid var(--color-info);
          border-radius: var(--radius-md);
          color: var(--color-info);
          margin-bottom: var(--space-2);
          text-align: center;
          font-size: var(--text-sm);
        }

        .form-section {
          background: var(--color-bg-card);
          padding: var(--space-4);
          border-radius: var(--radius-lg);
          margin-bottom: var(--space-4);
          border: 1px solid var(--color-border);
          box-shadow: var(--shadow-xs);
        }

        .form-group {
          margin-bottom: var(--space-4);
        }

        .form-group label {
          display: block;
          margin-bottom: var(--space-2);
          font-weight: var(--font-semibold);
          color: var(--color-text-primary);
          font-size: var(--text-sm);
        }

        .prompt-input {
          width: 100%;
          padding: var(--space-3);
          border: 1px solid var(--color-border);
          border-radius: var(--radius-md);
          font-family: inherit;
          font-size: var(--text-base);
          background: var(--color-bg-card);
          color: var(--color-text-primary);
          transition: border-color var(--transition-base);
        }

        .prompt-input:focus {
          outline: none;
          border-color: var(--color-primary);
          box-shadow: var(--shadow-glow);
        }

        .form-row {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: var(--space-3);
        }

        input[type="number"] {
          width: 100%;
          padding: var(--space-2);
          border: 1px solid var(--color-border);
          border-radius: var(--radius-md);
          background: var(--color-bg-card);
          color: var(--color-text-primary);
          font-size: var(--text-base);
          transition: border-color var(--transition-base);
        }

        input[type="number"]:focus {
          outline: none;
          border-color: var(--color-primary);
          box-shadow: var(--shadow-glow);
        }

        .error-message {
          padding: var(--space-3);
          background: var(--color-error-light);
          border: 1px solid var(--color-error);
          border-radius: var(--radius-md);
          color: var(--color-error);
          margin-bottom: var(--space-4);
          font-size: var(--text-sm);
        }

        .generate-button {
          width: 100%;
          padding: var(--space-4);
          background: var(--color-accent);
          color: white;
          border: none;
          border-radius: var(--radius-md);
          font-size: var(--text-lg);
          font-weight: var(--font-semibold);
          cursor: pointer;
          transition: all var(--transition-base);
          box-shadow: var(--shadow-sm);
        }

        .generate-button:hover:not(:disabled) {
          background: var(--color-accent-hover);
          transform: translateY(-2px);
          box-shadow: 0 8px 24px rgba(255, 107, 53, 0.3);
        }

        .generate-button:disabled {
          background: var(--color-bg-subtle);
          color: var(--color-text-tertiary);
          cursor: not-allowed;
          transform: none;
          box-shadow: none;
        }

        .progress-section {
          padding: var(--space-4);
          background: var(--color-info-light);
          border-radius: var(--radius-lg);
          margin-bottom: var(--space-4);
          border: 1px solid var(--color-info);
        }

        .progress-bar {
          height: 4px;
          background: var(--color-border);
          border-radius: var(--radius-full);
          overflow: hidden;
          margin-bottom: var(--space-3);
        }

        .progress-bar-fill {
          height: 100%;
          background: var(--color-accent);
          animation: progress 2s ease-in-out infinite;
        }

        @keyframes progress {
          0% { transform: translateX(-100%); }
          100% { transform: translateX(100%); }
        }

        .progress-message {
          text-align: center;
          color: var(--color-text-secondary);
          font-weight: var(--font-medium);
          font-size: var(--text-base);
        }

        .results-section {
          background: var(--color-bg-card);
          padding: var(--space-4);
          border-radius: var(--radius-lg);
          border: 1px solid var(--color-border);
          box-shadow: var(--shadow-sm);
        }

        .results-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: var(--space-3);
        }

        .results-header h3 {
          font-family: var(--font-heading);
          margin: 0;
          color: var(--color-primary);
          font-size: var(--text-xl);
          font-weight: var(--font-bold);
        }

        /* Aspect Ratio Info */
        .ar-info {
          padding: var(--space-3) var(--space-4);
          border-radius: var(--radius-md);
          margin-bottom: var(--space-3);
          font-size: var(--text-sm);
        }

        .ar-info.full {
          background: var(--color-success-light);
          border: 1px solid var(--color-success);
        }

        .ar-info.framing {
          background: var(--color-warning-light);
          border: 1px solid var(--color-warning);
        }

        .ar-info.tiling {
          background: var(--color-info-light);
          border: 1px solid var(--color-info);
        }

        .ar-info-header {
          color: var(--color-text-primary);
          margin-bottom: var(--space-2);
          font-weight: var(--font-semibold);
        }

        .ar-info-details {
          display: flex;
          flex-wrap: wrap;
          gap: var(--space-2);
          align-items: center;
          color: var(--color-text-secondary);
          font-size: var(--text-sm);
        }

        .ar-info-details span {
          white-space: nowrap;
        }

        .layout-note {
          color: var(--color-accent);
          font-weight: var(--font-medium);
        }

        /* Mode Toggle Tabs */
        .mode-tabs {
          display: flex;
          gap: var(--space-2);
          margin-bottom: var(--space-4);
          background: var(--color-bg-subtle);
          padding: var(--space-1);
          border-radius: var(--radius-lg);
        }

        .mode-tab {
          flex: 1;
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: var(--space-1);
          padding: var(--space-3);
          background: var(--color-bg-card);
          border: 1px solid var(--color-border);
          border-radius: var(--radius-md);
          cursor: pointer;
          transition: all var(--transition-base);
        }

        .mode-tab:hover:not(:disabled) {
          border-color: var(--color-accent);
          transform: translateY(-2px);
          box-shadow: var(--shadow-md);
        }

        .mode-tab.active {
          background: var(--color-accent);
          border-color: var(--color-accent);
          box-shadow: var(--shadow-glow-accent);
        }

        .mode-tab:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .mode-title {
          font-family: var(--font-heading);
          font-size: var(--text-base);
          font-weight: var(--font-semibold);
          color: var(--color-primary);
        }

        .mode-description {
          font-size: var(--text-sm);
          color: var(--color-text-secondary);
          text-align: center;
        }

        .mode-tab.active .mode-title {
          color: white;
          font-weight: var(--font-bold);
        }

        .mode-tab.active .mode-description {
          color: rgba(255, 255, 255, 0.9);
        }

        .svg-preview {
          margin: var(--space-3) 0;
          border: 1px solid var(--color-border);
          border-radius: var(--radius-md);
          background: var(--color-bg-subtle);
          padding: var(--space-3);
        }

        .design-preview {
          width: 100%;
          height: auto;
          display: block;
        }

        /* Finalize Section */
        .finalize-section {
          background: var(--color-accent-light);
          border: 2px solid var(--color-accent);
          border-radius: var(--radius-lg);
          padding: var(--space-4);
          margin-top: var(--space-4);
          text-align: center;
        }

        .finalize-button {
          width: 100%;
          max-width: 400px;
          padding: var(--space-4);
          background: var(--color-accent);
          color: white;
          border: none;
          border-radius: var(--radius-md);
          font-size: var(--text-lg);
          font-weight: var(--font-semibold);
          cursor: pointer;
          transition: all var(--transition-base);
          box-shadow: var(--shadow-sm);
        }

        .finalize-button:hover {
          background: var(--color-accent-hover);
          transform: translateY(-1px);
          box-shadow: var(--shadow-md);
        }

        .finalize-hint {
          margin: var(--space-3) 0 0 0;
          color: var(--color-text-secondary);
          font-size: var(--text-sm);
        }

        /* Mixer Widget Container Styles */
        .mixer-widget-container {
          margin-top: var(--space-4);
          background: white;
          border-radius: 12px;
          padding: var(--space-4);
          box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        }

        .mixer-widget-header {
          display: flex;
          justify-content: flex-end;
          margin-bottom: var(--space-3);
          padding-bottom: var(--space-3);
          border-bottom: 2px solid var(--color-border);
        }

        .mixer-close-btn {
          padding: var(--space-2) var(--space-4);
          background: var(--color-primary);
          color: white;
          border: none;
          border-radius: 8px;
          font-weight: 600;
          font-size: var(--text-sm);
          cursor: pointer;
          transition: all 0.2s;
        }

        .mixer-close-btn:hover {
          background: #2563eb;
          box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
          transform: translateY(-1px);
        }

        /* Mobile Responsive Styles */
        @media (max-width: 768px) {
          .inspire-panel-recraft {
            padding: var(--space-2);
          }

          .panel-header {
            margin-bottom: var(--space-4);
          }

          .panel-header h2 {
            font-size: var(--text-xl);
          }

          .subtitle {
            font-size: var(--text-sm);
          }

          .welcome-guidance {
            padding: var(--space-4);
            margin-bottom: var(--space-4);
          }

          .welcome-icon {
            font-size: 2rem;
          }

          .welcome-guidance h3 {
            font-size: var(--text-lg);
          }

          .welcome-guidance p {
            font-size: var(--text-sm);
          }

          /* Stack input mode tabs vertically on mobile */
          .input-mode-tabs {
            flex-direction: column;
            gap: var(--space-1);
          }

          .input-mode-tab {
            flex-direction: row;
            justify-content: flex-start;
            padding: var(--space-3);
            min-height: 44px;
          }

          .mode-icon {
            width: 24px;
            height: 24px;
            flex-shrink: 0;
          }

          .input-mode-tab .mode-title {
            font-size: var(--text-sm);
            margin-top: 0;
          }

          .input-mode-tab .mode-description {
            display: none;
          }

          /* Form sections */
          .form-section {
            padding: var(--space-3);
          }

          .form-group label {
            font-size: var(--text-xs);
          }

          /* Stack form rows on mobile */
          .form-row {
            grid-template-columns: 1fr;
            gap: var(--space-2);
          }

          /* Drop zone adjustments */
          .drop-zone {
            min-height: 140px;
          }

          .drop-zone-content {
            padding: var(--space-4);
            min-height: 140px;
          }

          .upload-icon {
            width: 36px;
            height: 36px;
          }

          .drop-text {
            font-size: var(--text-sm);
          }

          /* Generate button */
          .generate-button {
            padding: var(--space-3);
            font-size: var(--text-base);
            min-height: 44px;
          }

          /* Results section - minimal padding for max image width */
          .results-section {
            padding: var(--space-2);
            border-radius: var(--radius-md);
          }

          .results-header h3 {
            font-size: var(--text-lg);
          }

          /* Mode tabs */
          .mode-tabs {
            flex-direction: column;
            gap: var(--space-1);
          }

          .mode-tab {
            flex-direction: row;
            justify-content: flex-start;
            padding: var(--space-3);
            min-height: 44px;
          }

          .mode-title {
            font-size: var(--text-sm);
          }

          .mode-description {
            display: none;
          }

          /* AR info */
          .ar-info {
            padding: var(--space-2) var(--space-3);
          }

          .ar-info-details {
            flex-direction: column;
            align-items: flex-start;
            gap: var(--space-1);
          }

          /* Finalize section */
          .finalize-section {
            padding: var(--space-3);
          }

          .finalize-button {
            padding: var(--space-3);
            font-size: var(--text-base);
          }
        }

        /* Extra small screens */
        @media (max-width: 480px) {
          .inspire-panel-recraft {
            padding: var(--space-1);
          }

          .panel-header h2 {
            font-size: var(--text-lg);
          }

          /* Results section - even less padding */
          .results-section {
            padding: var(--space-1);
            margin: 0 calc(-1 * var(--space-1));
            border-radius: 0;
          }

          .input-mode-tab {
            padding: var(--space-2);
          }

          .mode-tab {
            padding: var(--space-2);
          }
        }
      `})]})}function PH({isOpen:t,onClose:e}){const[r,n]=P.useState(!1),[i,s]=P.useState(!1),[o,l]=P.useState(!1),{addMotif:c}=st(),d=Vc(),{currentDesignId:u,blendSvgUrl:f,solidSvgUrl:h,designName:p}=d,g=f||h,m=!!u;P.useEffect(()=>{if(!t)return;const y=b=>{b.key==="Escape"&&e()};return window.addEventListener("keydown",y),()=>window.removeEventListener("keydown",y)},[t,e]),P.useEffect(()=>{t||(l(!1),n(!1),s(!1))},[t]);const x=P.useCallback((y,b)=>{console.log("[EDITOR] Design saved:",y,b),l(!1)},[]),v=async()=>{var y,b;if(!(!g||r)){n(!0);try{const{blendSvgUrl:w,solidSvgUrl:k,widthMM:_,lengthMM:C}=d;let N=null,T=null;if(k)try{N=await(await fetch(k)).text(),console.log("[EDITOR] Fetched solid SVG from blob:",N.length,"chars")}catch(L){console.error("[EDITOR] Failed to fetch solid SVG:",L)}if(w)try{T=await(await fetch(w)).text(),console.log("[EDITOR] Fetched blend SVG from blob:",T.length,"chars")}catch(L){console.error("[EDITOR] Failed to fetch blend SVG:",L)}if(!N&&!T)throw new Error("No SVG content available. Please ensure a design has been generated.");const X=xp(N||T);let E=_||5e3,F=C||5e3;if(X){const L=X.width/X.height;L>1?(E=Math.max(_||5e3,5e3),F=E/L):(F=Math.max(C||5e3,5e3),E=F*L),console.log("[EDITOR] Using SVG aspect ratio:",L,"",E,"x",F,"mm")}s(!0);let S=u;const K=p||`Design ${new Date().toLocaleString("en-GB",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"})}`,le=h_(d);S=(await vp({id:S||void 0,name:K,description:"",tags:[],design_data:le,input_mode:d.inputMode})).design_id,d.setCurrentDesignId(S),d.setDesignName(K),s(!1);const I=((y=d.result)==null?void 0:y.thumb_url)||((b=d.result)==null?void 0:b.png_url)||null;c(S,K,N||T,E,F,I,{solidSvgContent:N,blendSvgContent:T,hasBothVersions:!!(N&&T)}),l(!0),setTimeout(()=>{e()},600)}catch(w){console.error("[EDITOR] Failed to add to canvas:",w),alert("Failed to add design to canvas: "+w.message),s(!1)}finally{n(!1)}}};return t?a.jsx("div",{className:"design-editor-overlay",children:a.jsxs("div",{className:"design-editor-modal",children:[a.jsxs("div",{className:"design-editor__header",children:[a.jsxs("div",{className:"design-editor__title",children:[a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polygon",{points:"12 2 2 7 12 12 22 7 12 2"}),a.jsx("polyline",{points:"2 17 12 22 22 17"}),a.jsx("polyline",{points:"2 12 12 17 22 12"})]}),a.jsx("h2",{children:"Design Editor"})]}),a.jsx("div",{className:"design-editor__hint",children:"Generate a design with AI or upload your own SVG"}),a.jsx("button",{className:"design-editor__close",onClick:e,title:"Close (Esc)",children:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),a.jsx("div",{className:"design-editor__content",children:a.jsx(RH,{onDesignSaved:x,isEmbedded:!0})}),a.jsx("div",{className:`design-editor__footer ${o?"design-editor__footer--success":""}`,children:o?a.jsxs("div",{className:"design-editor__success",children:[a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}),a.jsx("span",{children:"Added to canvas!"})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"design-editor__status",children:g?m?a.jsxs("span",{className:"design-editor__saved-indicator",children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}),"Saved to library"]}):a.jsx("span",{className:"design-editor__unsaved-indicator",children:"Design ready  Will auto-save when added"}):a.jsx("span",{className:"design-editor__no-design",children:"Generate or upload a design to continue"})}),a.jsxs("div",{className:"design-editor__actions",children:[a.jsx("button",{className:"design-editor__btn design-editor__btn--secondary",onClick:e,children:"Cancel"}),a.jsx("button",{className:"design-editor__btn design-editor__btn--primary",onClick:v,disabled:!g||r,children:r?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"design-editor__spinner"}),i?"Saving...":"Adding..."]}):a.jsxs(a.Fragment,{children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"16"}),a.jsx("line",{x1:"8",y1:"12",x2:"16",y2:"12"})]}),"Add to Canvas"]})})]})]})})]})}):null}function OH(){const{addShape:t,addText:e,standaloneMode:r}=st(),[n,i]=P.useState(!1);if(r)return null;const s=[{preset:"rectangle",icon:"",label:"Rectangle"},{preset:"square",icon:"",label:"Square"},{preset:"circle",icon:"",label:"Circle"},{preset:"triangle",icon:"",label:"Triangle"},{preset:"hexagon",icon:"",label:"Hexagon"},{preset:"pentagon",icon:"",label:"Pentagon"},{preset:"blob",icon:"",label:"Blob"}],o=c=>{t(c)},l=()=>{e(),i(!1)};return a.jsxs("div",{className:`shape-toolbar ${n?"shape-toolbar--expanded":""}`,children:[a.jsxs("button",{className:"shape-toolbar__toggle",onClick:()=>i(!n),title:n?"Collapse elements panel":"Add elements",children:[a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("polygon",{points:"12 2 2 7 12 12 22 7 12 2"}),a.jsx("polyline",{points:"2 17 12 22 22 17"}),a.jsx("polyline",{points:"2 12 12 17 22 12"})]}),!n&&a.jsx("span",{className:"shape-toolbar__label",children:"Elements"})]}),n&&a.jsxs("div",{className:"shape-toolbar__shapes",children:[a.jsxs("button",{className:"shape-toolbar__btn shape-toolbar__btn--text",onClick:l,title:"Add Text Label",children:[a.jsx("span",{className:"shape-toolbar__icon",children:"T"}),a.jsx("span",{className:"shape-toolbar__name",children:"Text"})]}),a.jsx("div",{className:"shape-toolbar__divider"}),s.map(c=>a.jsxs("button",{className:"shape-toolbar__btn",onClick:()=>o(c.preset),title:`Add ${c.label}`,children:[a.jsx("span",{className:"shape-toolbar__icon",children:c.icon}),a.jsx("span",{className:"shape-toolbar__name",children:c.label})]},c.preset))]})]})}function AH({loadedDesign:t}){const[e,r]=P.useState(!1),[n,i]=P.useState(()=>{const q=st.getState().surface;return q!=null&&q.width_mm?String(q.width_mm/1e3):"50"}),[s,o]=P.useState(()=>{const q=st.getState().surface;return q!=null&&q.length_mm?String(q.length_mm/1e3):"50"}),[l,c]=P.useState(!1),[d,u]=P.useState(!1),[f,h]=P.useState(!1),[p,g]=P.useState(!1),[m,x]=P.useState(!1),[v,y]=P.useState(null),[b,w]=P.useState(null),[k,_]=P.useState(""),C=P.useRef(null);P.useEffect(()=>{if(t){const q=t.design_data||{},M=t.input_mode||q.input_mode||q.blend_recipes||q.solid_recipes,J=q.courts||q.surface||q.tracks;if(console.log("[TPV] Design detection:",{id:t.id,name:t.name,hasDesignData:!!t.design_data,topLevelInputMode:t.input_mode,isPlaygroundDesign:M,isSportsDesign:J}),M&&!J){console.log("[TPV] Loading playground design into editor:",t.id,t.name);const de=ff(t),ie=Vc.getState();ie.loadDesign(de),t.name&&ie.setDesignName(t.name),ie.setCurrentDesignId(t.id),g(!0)}else t.design_data?(console.log("[SPORTS] Loading design from prop:",t.id,t.name),st.getState().loadDesign(q),w(t.id),_(t.name||""),r(!1)):console.warn("[TPV] Design has no design_data and is not a playground design:",t.id,t.name)}},[t]);const{surface:N,courts:T,tracks:O,selectedCourtId:X,selectedTrackId:E,selectedMotifId:F,selectedShapeId:S,selectedTextId:K,showCourtLibrary:le,showPropertiesPanel:D,toggleCourtLibrary:I,togglePropertiesPanel:L,setSurfaceDimensions:Z,setSurfaceColor:H,resetDesign:G,hasUnsavedChanges:ee,standaloneMode:oe,toggleStandaloneMode:fe,mobileLibraryOpen:Oe,mobilePropertiesOpen:$e,mobileColoursOpen:Ie,mobileActiveTab:Ee,setMobileLibraryOpen:ge,setMobilePropertiesOpen:me,setMobileColoursOpen:He,setMobileActiveTab:ue,closeMobileSheets:j}=st(),ce=q=>{q.preventDefault();const M=parseFloat(n)*1e3,J=parseFloat(s)*1e3;M>0&&J>0&&(Z(M,J),r(!1))},re=q=>{H({tpv_code:q.code,hex:q.hex,name:q.name}),c(!1)},z=()=>{ee()&&!window.confirm(`Start a new design?

You have unsaved changes that will be lost.`)||(G(),w(null),_(""),i("50"),o("50"))},R=()=>{const q=C.current||document.querySelector(".court-canvas__svg");if(!q){alert("Canvas not ready");return}const M=st.getState().exportDesignData(),J=wp(q,M),de=new Blob([J],{type:"image/svg+xml"}),ie=URL.createObjectURL(de);v&&URL.revokeObjectURL(v),y(ie),x(!0)},U=()=>{x(!1),v&&(URL.revokeObjectURL(v),y(null))},ae=async q=>{if(!q){alert("Source design ID not found");return}try{const M=await cl(q),J=(M==null?void 0:M.design)||M;if(!J)throw new Error("Design not found");const de=ff(J),ie=Vc.getState();ie.loadDesign(de),J.name&&ie.setDesignName(J.name),ie.setCurrentDesignId(q),g(!0),console.log("[TPV] Loaded source design for editing:",J.name)}catch(M){console.error("[TPV] Failed to load source design:",M),alert("Failed to load design: "+M.message)}};return P.useEffect(()=>{const q=M=>{const J=M.target.tagName.toLowerCase();if(J==="input"||J==="textarea"||J==="select")return;const{removeCourt:de,removeTrack:ie,removeMotif:A,removeShape:Y,removeText:se,deselectCourt:we,deselectTrack:ne,deselectMotif:Se,deselectShape:ke,deselectText:Ce,stopEditingText:xe,undo:Ye,redo:Ke,canUndo:ft,canRedo:ut,duplicateCourt:We,duplicateMotif:nt,duplicateShape:ht,duplicateText:tt,updateCourtPosition:ct,updateTrackPosition:Mt,updateMotifPosition:Br,updateShapePosition:In,updateTextPosition:Dn,courts:zn,tracks:Nt,motifs:Cr,shapes:Kt,texts:mr,selectedMotifId:lr,selectedShapeId:Ht,selectedTextId:tr,editingTextId:Qr,elementOrder:Fn,setElementOrder:Er,toggleSnapToGrid:_t,snapToGrid:xn,addToHistory:pt}=st.getState(),$t=X||E||lr||Ht||tr;if(M.key==="Delete"&&$t&&!Qr&&(M.preventDefault(),X?de(X):E?ie(E):lr?A(lr):Ht?Y(Ht):tr&&se(tr)),M.key==="Escape"&&(Qr?xe():$t&&(X?we():E?ne():lr?Se():Ht?ke():tr&&Ce())),(M.ctrlKey||M.metaKey)&&M.key==="z"&&!M.shiftKey&&(M.preventDefault(),ft()&&Ye()),(M.ctrlKey||M.metaKey)&&M.key==="z"&&M.shiftKey&&(M.preventDefault(),ut()&&Ke()),(M.ctrlKey||M.metaKey)&&M.key==="d"&&$t&&(M.preventDefault(),X?We(X):lr?nt(lr):Ht?ht(Ht):tr&&tt(tr)),$t&&!Qr&&["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(M.key)){M.preventDefault();const et=M.shiftKey?10:100;let at=0,Ut=0;if(M.key==="ArrowLeft"&&(at=-et),M.key==="ArrowRight"&&(at=et),M.key==="ArrowUp"&&(Ut=-et),M.key==="ArrowDown"&&(Ut=et),X){const rt=zn[X];rt&&(ct(X,{x:rt.position.x+at,y:rt.position.y+Ut}),pt())}else if(E){const rt=Nt[E];rt&&(Mt(E,{x:rt.position.x+at,y:rt.position.y+Ut}),pt())}else if(lr){const rt=Cr[lr];rt&&(Br(lr,{x:rt.position.x+at,y:rt.position.y+Ut}),pt())}else if(Ht){const rt=Kt[Ht];rt&&(In(Ht,{x:rt.position.x+at,y:rt.position.y+Ut}),pt())}else if(tr){const rt=mr[tr];rt&&(Dn(tr,{x:rt.position.x+at,y:rt.position.y+Ut}),pt())}}if($t&&(M.key==="["||M.key==="]")){M.preventDefault();const et=Fn.indexOf($t);if(et===-1)return;const at=[...Fn];M.key==="["&&et>0?([at[et],at[et-1]]=[at[et-1],at[et]],Er(at),pt()):M.key==="]"&&et<Fn.length-1&&([at[et],at[et+1]]=[at[et+1],at[et]],Er(at),pt())}(M.key==="g"||M.key==="G")&&(M.preventDefault(),_t()),(M.key==="?"||M.shiftKey&&M.key==="/")&&(M.preventDefault(),h(!0))};return window.addEventListener("keydown",q),()=>window.removeEventListener("keydown",q)},[X,E,F,S,K]),a.jsxs("div",{className:"sports-designer",children:[e&&a.jsx("div",{className:"sports-designer__modal-overlay",onClick:()=>r(!1),children:a.jsxs("div",{className:"sports-designer__modal",onClick:q=>q.stopPropagation(),children:[a.jsx("h2",{children:"Edit Surface Size"}),a.jsx("p",{children:"Adjust the dimensions of your sports surface"}),a.jsxs("form",{onSubmit:ce,children:[a.jsxs("div",{className:"sports-designer__dimension-inputs",children:[a.jsxs("div",{className:"sports-designer__input-group",children:[a.jsx("label",{htmlFor:"width",children:"Width (metres)"}),a.jsx("input",{id:"width",type:"number",min:"5",max:"100",step:"0.5",value:n,onChange:q=>i(q.target.value),required:!0,autoFocus:!0})]}),a.jsx("span",{className:"sports-designer__dimension-separator",children:""}),a.jsxs("div",{className:"sports-designer__input-group",children:[a.jsx("label",{htmlFor:"length",children:"Length (metres)"}),a.jsx("input",{id:"length",type:"number",min:"5",max:"100",step:"0.5",value:s,onChange:q=>o(q.target.value),required:!0})]})]}),a.jsx("p",{className:"sports-designer__dimension-hint",children:"Common sizes: 37m  34m (tennis), 40m  20m (futsal), 50m  50m (multi-sport)"}),a.jsx("button",{type:"submit",className:"sports-designer__btn-primary",children:"Update Surface"})]})]})}),a.jsxs(a.Fragment,{children:[a.jsxs("header",{className:"sports-designer__mobile-header",children:[a.jsx("span",{className:"sports-designer__mobile-header-title",children:"TPV Designer"}),a.jsxs("div",{className:"sports-designer__mobile-header-actions",children:[a.jsx("button",{className:"sports-designer__mobile-header-btn",onClick:()=>{i(String(N.width_mm/1e3)),o(String(N.length_mm/1e3)),r(!0)},title:"Surface settings",children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z"})]})}),a.jsx(k0,{svgRef:C,mobileMode:!0})]})]}),a.jsxs("nav",{className:"sports-designer__mobile-action-bar",children:[a.jsxs("button",{className:`sports-designer__mobile-action-btn ${Oe?"sports-designer__mobile-action-btn--active":""}`,onClick:()=>{j(),ge(!0)},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"16"}),a.jsx("line",{x1:"8",y1:"12",x2:"16",y2:"12"})]}),a.jsx("span",{children:"Add"})]}),a.jsxs("button",{className:"sports-designer__mobile-action-btn",onClick:()=>{j(),He(!0)},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"13.5",cy:"6.5",r:"2.5"}),a.jsx("circle",{cx:"17.5",cy:"10.5",r:"2.5"}),a.jsx("circle",{cx:"8.5",cy:"7.5",r:"2.5"}),a.jsx("circle",{cx:"6.5",cy:"12.5",r:"2.5"})]}),a.jsx("span",{children:"Colours"})]}),a.jsxs("button",{className:`sports-designer__mobile-action-btn ${X||E||F||S||K?"":"sports-designer__mobile-action-btn--disabled"}`,onClick:()=>{(X||E||F||S||K)&&(j(),me(!0))},disabled:!X&&!E&&!F&&!S&&!K,children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"4",y1:"21",x2:"4",y2:"14"}),a.jsx("line",{x1:"4",y1:"10",x2:"4",y2:"3"}),a.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"12"}),a.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"3"}),a.jsx("line",{x1:"20",y1:"21",x2:"20",y2:"16"}),a.jsx("line",{x1:"20",y1:"12",x2:"20",y2:"3"}),a.jsx("line",{x1:"1",y1:"14",x2:"7",y2:"14"}),a.jsx("line",{x1:"9",y1:"8",x2:"15",y2:"8"}),a.jsx("line",{x1:"17",y1:"16",x2:"23",y2:"16"})]}),a.jsx("span",{children:"Properties"})]}),a.jsxs("button",{className:"sports-designer__mobile-action-btn",onClick:()=>u(!0),children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z"}),a.jsx("polyline",{points:"17 21 17 13 7 13 7 21"}),a.jsx("polyline",{points:"7 3 7 8 15 8"})]}),a.jsx("span",{children:"Save"})]})]}),a.jsx("div",{className:`sports-designer__bottom-sheet-overlay ${Oe?"sports-designer__bottom-sheet-overlay--open":""}`,onClick:()=>ge(!1)}),a.jsxs("div",{className:`sports-designer__bottom-sheet ${Oe?"sports-designer__bottom-sheet--open":""}`,children:[a.jsx("div",{className:"sports-designer__bottom-sheet-handle"}),a.jsxs("div",{className:"sports-designer__bottom-sheet-header",children:[a.jsx("h3",{children:"Add Element"}),a.jsx("button",{className:"sports-designer__bottom-sheet-close",onClick:()=>ge(!1),children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),a.jsxs("div",{className:"sports-designer__mobile-tabs",children:[a.jsx("button",{className:`sports-designer__mobile-tab ${Ee==="courts"?"sports-designer__mobile-tab--active":""}`,onClick:()=>ue("courts"),children:"Courts"}),a.jsx("button",{className:`sports-designer__mobile-tab ${Ee==="tracks"?"sports-designer__mobile-tab--active":""}`,onClick:()=>ue("tracks"),children:"Tracks"}),a.jsx("button",{className:`sports-designer__mobile-tab ${Ee==="shapes"?"sports-designer__mobile-tab--active":""}`,onClick:()=>ue("shapes"),children:"Shapes"}),a.jsx("button",{className:`sports-designer__mobile-tab ${Ee==="designs"?"sports-designer__mobile-tab--active":""}`,onClick:()=>ue("designs"),children:"Designs"})]}),a.jsx("div",{className:"sports-designer__bottom-sheet-content",children:a.jsx(_0,{mobileMode:!0,activeTab:Ee,onItemAdded:()=>ge(!1),onOpenGenerator:()=>{ge(!1),g(!0)}})})]}),a.jsx("div",{className:`sports-designer__bottom-sheet-overlay ${Ie?"sports-designer__bottom-sheet-overlay--open":""}`,onClick:()=>He(!1)}),a.jsxs("div",{className:`sports-designer__bottom-sheet ${Ie?"sports-designer__bottom-sheet--open":""}`,children:[a.jsx("div",{className:"sports-designer__bottom-sheet-handle"}),a.jsxs("div",{className:"sports-designer__bottom-sheet-header",children:[a.jsx("h3",{children:"Surface Colour"}),a.jsx("button",{className:"sports-designer__bottom-sheet-close",onClick:()=>He(!1),children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),a.jsx("div",{className:"sports-designer__bottom-sheet-content",children:a.jsx("div",{className:"sports-designer__color-grid",children:Sr.map(q=>a.jsx("button",{className:`sports-designer__color-swatch ${N.color.tpv_code===q.code?"sports-designer__color-swatch--selected":""}`,style:{backgroundColor:q.hex},onClick:()=>{re(q),He(!1)},title:`${q.code} - ${q.name}`,children:a.jsx("span",{className:"sports-designer__color-code",children:q.code})},q.code))})})]}),a.jsx("div",{className:`sports-designer__bottom-sheet-overlay ${$e?"sports-designer__bottom-sheet-overlay--open":""}`,onClick:()=>me(!1)}),a.jsxs("div",{className:`sports-designer__bottom-sheet ${$e?"sports-designer__bottom-sheet--open":""}`,children:[a.jsx("div",{className:"sports-designer__bottom-sheet-handle"}),a.jsxs("div",{className:"sports-designer__bottom-sheet-header",children:[a.jsx("h3",{children:"Properties"}),a.jsx("button",{className:"sports-designer__bottom-sheet-close",onClick:()=>me(!1),children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),a.jsx("div",{className:"sports-designer__bottom-sheet-content",children:(X||E||F||S||K)&&a.jsx(S0,{mobileMode:!0,onEditSourceDesign:ae})})]}),a.jsxs("div",{className:"sports-designer__content",children:[le&&!oe&&a.jsxs("aside",{className:"sports-designer__sidebar",children:[a.jsx(_0,{onOpenGenerator:()=>g(!0)}),a.jsx(H5,{})]}),a.jsxs("main",{className:"sports-designer__canvas-container",children:[a.jsxs("div",{className:"sports-toolbar",children:[a.jsxs("div",{className:"sports-toolbar__group",children:[a.jsx("button",{className:`sports-toolbar__btn ${le?"sports-toolbar__btn--active":""}`,onClick:I,title:"Element Library",disabled:oe,children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"3",y:"14",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"14",width:"7",height:"7"})]})}),a.jsx("button",{className:`sports-toolbar__btn ${D&&(X||E||F||S||K)?"sports-toolbar__btn--active":""}`,onClick:L,title:"Properties",disabled:!X&&!E&&!F&&!S&&!K||oe,children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("line",{x1:"4",y1:"21",x2:"4",y2:"14"}),a.jsx("line",{x1:"4",y1:"10",x2:"4",y2:"3"}),a.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"12"}),a.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"3"}),a.jsx("line",{x1:"20",y1:"21",x2:"20",y2:"16"}),a.jsx("line",{x1:"20",y1:"12",x2:"20",y2:"3"}),a.jsx("line",{x1:"1",y1:"14",x2:"7",y2:"14"}),a.jsx("line",{x1:"9",y1:"8",x2:"15",y2:"8"}),a.jsx("line",{x1:"17",y1:"16",x2:"23",y2:"16"})]})})]}),a.jsx("div",{className:"sports-toolbar__divider"}),a.jsx("div",{className:"sports-toolbar__group",children:a.jsx("button",{className:`sports-toolbar__mode-toggle ${oe?"sports-toolbar__mode-toggle--active":""}`,onClick:fe,title:oe?"Switch to Edit Mode":"Switch to Focus Mode",children:oe?a.jsxs(a.Fragment,{children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"})}),a.jsx("span",{children:"Focus"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"3",y:"14",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"14",width:"7",height:"7"})]}),a.jsx("span",{children:"Edit"})]})})}),a.jsx("div",{className:"sports-toolbar__divider"}),a.jsxs("div",{className:"sports-toolbar__group",children:[a.jsxs("button",{className:"sports-toolbar__dimensions",onClick:()=>{i(String(N.width_mm/1e3)),o(String(N.length_mm/1e3)),r(!0)},title:"Click to edit surface size",children:[(N.width_mm/1e3).toFixed(0),"m  ",(N.length_mm/1e3).toFixed(0),"m"]}),a.jsx("button",{className:"sports-toolbar__color-swatch",style:{backgroundColor:N.color.hex},onClick:()=>c(!0),title:`${N.color.name} (${N.color.tpv_code}) - Click to change`})]}),a.jsx("div",{className:"sports-toolbar__divider"}),a.jsxs("div",{className:"sports-toolbar__group",children:[a.jsx("button",{className:"sports-toolbar__btn",disabled:!st.getState().canUndo(),onClick:()=>st.getState().undo(),title:"Undo (Ctrl+Z)",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M3 7v6h6"}),a.jsx("path",{d:"M21 17a9 9 0 00-9-9 9 9 0 00-6 2.3L3 13"})]})}),a.jsx("button",{className:"sports-toolbar__btn",disabled:!st.getState().canRedo(),onClick:()=>st.getState().redo(),title:"Redo (Ctrl+Shift+Z)",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M21 7v6h-6"}),a.jsx("path",{d:"M3 17a9 9 0 019-9 9 9 0 016 2.3l3 2.7"})]})})]}),a.jsx("div",{className:"sports-toolbar__divider"}),a.jsxs("div",{className:"sports-toolbar__group",children:[a.jsx("button",{className:"sports-toolbar__btn",onClick:z,title:"Start new design",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),a.jsx("polyline",{points:"14 2 14 8 20 8"}),a.jsx("line",{x1:"12",y1:"18",x2:"12",y2:"12"}),a.jsx("line",{x1:"9",y1:"15",x2:"15",y2:"15"})]})}),a.jsx("button",{className:"sports-toolbar__btn",onClick:R,title:"View In-Situ Preview",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("polyline",{points:"21 15 16 10 5 21"})]})}),a.jsx("button",{className:"sports-toolbar__btn",onClick:()=>h(!0),title:"Keyboard shortcuts (?)",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),a.jsx("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]})}),a.jsx("button",{className:"sports-toolbar__btn-primary",onClick:()=>u(!0),children:"Save"}),a.jsx(k0,{svgRef:C})]})]}),a.jsx(m5,{ref:C}),a.jsx(OH,{})]}),(X||E||F||S||K)&&D&&!oe&&a.jsx("aside",{className:"sports-designer__properties",children:a.jsx(S0,{onEditSourceDesign:ae})})]}),l&&a.jsx("div",{className:"sports-designer__color-modal-overlay",onClick:()=>c(!1),children:a.jsxs("div",{className:"sports-designer__color-modal",onClick:q=>q.stopPropagation(),children:[a.jsxs("div",{className:"sports-designer__color-modal-header",children:[a.jsx("h4",{children:"Select Surface Colour"}),a.jsx("button",{onClick:()=>c(!1),children:""})]}),a.jsx("div",{className:"sports-designer__color-grid",children:Sr.map(q=>a.jsx("button",{className:`sports-designer__color-swatch ${N.color.tpv_code===q.code?"sports-designer__color-swatch--selected":""}`,style:{backgroundColor:q.hex},onClick:()=>re(q),title:`${q.code} - ${q.name}`,children:a.jsx("span",{className:"sports-designer__color-code",children:q.code})},q.code))})]})}),d&&a.jsx(K5,{existingDesignId:b,initialName:k,svgRef:C,onClose:()=>u(!1),onSaved:(q,M)=>{w(q.design_id),_(M),console.log("[SPORTS] Design saved:",q.design_id)}}),a.jsx(oE,{isOpen:f,onClose:()=>h(!1)}),a.jsx(PH,{isOpen:p,onClose:()=>g(!1)}),m&&v&&a.jsx(m_,{designUrl:v,designDimensions:{width:N.width_mm,length:N.length_mm},onClose:U,onSaved:q=>{console.log("[TPV] In-situ preview saved:",q),U()}})]})]})}function MH({onShowDesigns:t,onShowAdmin:e,isAdmin:r,currentDesignName:n}){const[i,s]=P.useState(!1),o=async()=>{confirm("Sign out?")&&(await Pn.signOut(),window.location.reload())};return a.jsx("header",{className:"studio-header",children:a.jsxs("div",{className:"header-content",children:[a.jsxs("div",{className:"header-left",children:[a.jsx("h1",{className:"studio-title",children:"TPV Designer"}),n&&a.jsxs("span",{className:"current-design-indicator",children:[a.jsx("svg",{width:"4",height:"4",viewBox:"0 0 4 4",children:a.jsx("circle",{cx:"2",cy:"2",r:"2",fill:"currentColor"})}),n]})]}),a.jsxs("div",{className:"header-right",children:[a.jsxs("button",{onClick:t,className:"btn-my-designs",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"}),a.jsx("path",{d:"M9 22V12h6v10"})]}),"My Designs"]}),r&&a.jsxs("button",{onClick:e,className:"btn-admin",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M12 15a3 3 0 100-6 3 3 0 000 6z"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z"})]}),"Admin"]}),a.jsxs("div",{className:"user-menu",children:[a.jsx("button",{onClick:()=>s(!i),className:"user-menu-button",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),i&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"user-menu-backdrop",onClick:()=>s(!1)}),a.jsx("div",{className:"user-menu-dropdown",children:a.jsxs("button",{onClick:o,className:"menu-item sign-out",children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4M16 17l5-5-5-5M21 12H9"})}),"Sign Out"]})})]})]})]})]})})}function $H({design:t,onLoad:e,onDelete:r,onUpdateMetadata:n}){var g;const[i,s]=P.useState(!1),[o,l]=P.useState(!1),c=async()=>{if(confirm(`Delete "${t.name}"? This cannot be undone.`)){l(!0);try{await r(t.id)}catch(m){console.error("Failed to delete design:",m),alert(`Failed to delete: ${m.message}`),l(!1)}}},d=m=>{const x=new Date(m),v=new Date,y=v-x,b=Math.floor(y/(1e3*60*60*24));return b===0?"Today":b===1?"Yesterday":b<7?`${b} days ago`:b<30?`${Math.floor(b/7)} weeks ago`:x.toLocaleDateString("en-GB",{day:"numeric",month:"short",year:x.getFullYear()!==v.getFullYear()?"numeric":void 0})},u=t.input_mode==="sports_surface"||((g=t.design_data)==null?void 0:g.type)==="sports_surface",f=t.thumbnail_url||t.original_png_url||t.original_svg_url,p=u?{label:"Surface",icon:"",className:"type-surface"}:{label:"Motif",icon:"",className:"type-motif"};return a.jsxs("div",{className:`design-card ${o?"deleting":""}`,onMouseEnter:()=>s(!0),onMouseLeave:()=>s(!1),children:[a.jsxs("div",{className:`design-type-badge ${p.className}`,children:[a.jsx("span",{className:"type-icon",children:p.icon}),a.jsx("span",{className:"type-label",children:p.label})]}),a.jsxs("div",{className:"card-thumbnail",onClick:()=>e(t.id),children:[f?a.jsx("img",{src:f,alt:t.name}):a.jsx("div",{className:"no-thumbnail",children:a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("polyline",{points:"21 15 16 10 5 21"})]})}),i&&a.jsx("div",{className:"thumbnail-overlay",children:a.jsx("button",{className:"btn-load",children:"Open"})})]}),a.jsxs("div",{className:"card-info",children:[a.jsx("h3",{className:"design-name",title:t.name,children:t.name}),t.description&&a.jsx("p",{className:"design-description",title:t.description,children:t.description}),a.jsxs("div",{className:"card-meta",children:[t.projects&&a.jsx("span",{className:"project-badge",style:{backgroundColor:t.projects.color||"#1a365d"},title:t.projects.name,children:t.projects.name}),a.jsx("span",{className:"design-date",title:new Date(t.updated_at).toLocaleString(),children:d(t.updated_at)})]}),t.tags&&t.tags.length>0&&a.jsxs("div",{className:"design-tags",children:[t.tags.slice(0,3).map((m,x)=>a.jsx("span",{className:"tag",children:m},x)),t.tags.length>3&&a.jsxs("span",{className:"tag more",children:["+",t.tags.length-3]})]})]}),i&&!o&&a.jsxs("div",{className:"card-actions",children:[a.jsx("button",{onClick:()=>e(t.id),className:"action-btn load-btn",title:"Load design",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),a.jsx("circle",{cx:"12",cy:"12",r:"3"})]})}),a.jsx("button",{onClick:c,className:"action-btn delete-btn",title:"Delete design",children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]}),o&&a.jsx("div",{className:"deleting-overlay",children:a.jsx("div",{className:"spinner"})})]})}function LH({onClose:t,onLoadDesign:e}){const[r,n]=P.useState([]),[i,s]=P.useState([]),[o,l]=P.useState(!0),[c,d]=P.useState(null),[u,f]=P.useState(""),[h,p]=P.useState(""),[g,m]=P.useState(!1),[x,v]=P.useState(!1);P.useEffect(()=>{y()},[u,h]);const y=async()=>{l(!0),d(null);try{const[_,C]=await Promise.all([bp(),Wc({project_id:u||void 0,search:h||void 0,limit:12,offset:0})]);s(_.projects),n(C.designs),m(C.pagination.has_more)}catch(_){console.error("Failed to load designs:",_),d(_.message)}finally{l(!1)}},b=async()=>{if(!(x||!g)){v(!0);try{const _=await Wc({project_id:u||void 0,search:h||void 0,limit:12,offset:r.length});n([...r,..._.designs]),m(_.pagination.has_more)}catch(_){console.error("Failed to load more designs:",_),d(_.message)}finally{v(!1)}}},w=async _=>{try{const{design:C}=await cl(_);e(C),t()}catch(C){console.error("Failed to load design:",C),alert(`Failed to load design: ${C.message}`)}},k=async _=>{try{await uC(_),n(r.filter(C=>C.id!==_))}catch(C){throw console.error("Failed to delete design:",C),C}};return a.jsx("div",{className:"modal-overlay",onClick:t,children:a.jsxs("div",{className:"modal-content design-gallery-modal",onClick:_=>_.stopPropagation(),children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h2",{children:"My Designs"}),a.jsx("button",{onClick:t,className:"close-button",children:""})]}),a.jsxs("div",{className:"gallery-filters",children:[a.jsx("div",{className:"filter-group",children:a.jsx("input",{type:"text",placeholder:"Search designs...",value:h,onChange:_=>p(_.target.value),className:"search-input"})}),a.jsx("div",{className:"filter-group",children:a.jsxs("select",{value:u,onChange:_=>f(_.target.value),className:"project-filter",children:[a.jsx("option",{value:"",children:"All Projects"}),i.map(_=>a.jsxs("option",{value:_.id,children:[_.name," (",_.design_count,")"]},_.id))]})})]}),a.jsxs("div",{className:"modal-body",children:[c&&a.jsxs("div",{className:"error-message",children:[c,a.jsx("button",{onClick:y,className:"btn-retry",children:"Retry"})]}),o?a.jsxs("div",{className:"loading-state",children:[a.jsx("div",{className:"spinner-large"}),a.jsx("p",{children:"Loading your designs..."})]}):r.length===0?a.jsxs("div",{className:"empty-state",children:[a.jsxs("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("path",{d:"M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z"}),a.jsx("path",{d:"M17 21v-8H7v8M7 3v5h8"})]}),a.jsx("h3",{children:"No designs yet"}),a.jsx("p",{children:h||u?"No designs match your filters. Try adjusting your search.":"Create your first design to see it here!"})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"designs-grid",children:r.map(_=>a.jsx($H,{design:_,onLoad:w,onDelete:k},_.id))}),g&&a.jsx("div",{className:"load-more-section",children:a.jsx("button",{onClick:b,className:"btn-load-more",disabled:x,children:x?"Loading...":"Load More"})})]})]})]})})}function IH(){const[t,e]=P.useState([]),[r,n]=P.useState(0),[i,s]=P.useState(!1),[o,l]=P.useState(null),[c,d]=P.useState("all"),[u,f]=P.useState("all"),[h,p]=P.useState(""),[g,m]=P.useState(0),x=50,v=async()=>{var N,T;const _=await Vt.auth.getSession();return{"Content-Type":"application/json",Authorization:`Bearer ${(T=(N=_==null?void 0:_.data)==null?void 0:N.session)==null?void 0:T.access_token}`}},y=async()=>{s(!0),l(null);try{const _=await v(),C=new URLSearchParams({limit:x.toString(),offset:g.toString()});c!=="all"&&C.append("status",c),u!=="all"&&C.append("saved_status",u),h&&C.append("search",h);const N=await fetch(`/api/admin/jobs?${C.toString()}`,{headers:_}),T=await N.json();if(!N.ok)throw new Error(T.error||"Failed to fetch jobs");e(T.jobs),n(T.total)}catch(_){console.error("Failed to fetch jobs:",_),l(_.message)}finally{s(!1)}};P.useEffect(()=>{y()},[c,u,h,g]);const b=t.filter(_=>_.status==="completed").length,w=t.filter(_=>!_.is_saved&&_.status==="completed").length,k=t.filter(_=>_.is_saved).length;return a.jsxs("div",{className:"generations-tab",children:[a.jsxs("div",{className:"admin-stats-grid",children:[a.jsxs("div",{className:"admin-stat-card",children:[a.jsx("h3",{children:"Total Generations"}),a.jsx("p",{className:"stat-value",children:r}),a.jsx("span",{className:"stat-label",children:"All time"})]}),a.jsxs("div",{className:"admin-stat-card",children:[a.jsx("h3",{children:"Completed"}),a.jsx("p",{className:"stat-value",children:b}),a.jsx("span",{className:"stat-label",children:"Current page"})]}),a.jsxs("div",{className:"admin-stat-card success",children:[a.jsx("h3",{children:"Saved"}),a.jsx("p",{className:"stat-value",children:k}),a.jsx("span",{className:"stat-label",children:" Linked to designs"})]}),a.jsxs("div",{className:"admin-stat-card warning",children:[a.jsx("h3",{children:"Orphaned"}),a.jsx("p",{className:"stat-value",children:w}),a.jsx("span",{className:"stat-label",children:" Not saved"})]})]}),a.jsxs("div",{className:"admin-filters",children:[a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Status:"}),a.jsxs("select",{value:c,onChange:_=>d(_.target.value),children:[a.jsx("option",{value:"all",children:"All"}),a.jsx("option",{value:"completed",children:"Completed"}),a.jsx("option",{value:"failed",children:"Failed"}),a.jsx("option",{value:"running",children:"Running"}),a.jsx("option",{value:"queued",children:"Queued"})]})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Saved:"}),a.jsxs("select",{value:u,onChange:_=>f(_.target.value),children:[a.jsx("option",{value:"all",children:"All"}),a.jsx("option",{value:"saved",children:"Saved only"}),a.jsx("option",{value:"orphaned",children:"Orphaned only"})]})]}),a.jsxs("div",{className:"filter-group search",children:[a.jsx("label",{children:"Search prompt:"}),a.jsx("input",{type:"text",placeholder:"Search in prompts...",value:h,onChange:_=>p(_.target.value)})]})]}),i&&a.jsxs("div",{className:"admin-loading",children:[a.jsx("div",{className:"spinner"}),a.jsx("p",{children:"Loading jobs..."})]}),o&&a.jsx("div",{className:"admin-error",children:a.jsxs("p",{children:["Error: ",o]})}),!i&&t.length>0&&a.jsx("div",{className:"jobs-table-container",children:a.jsxs("table",{className:"jobs-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Thumbnail"}),a.jsx("th",{children:"Prompt"}),a.jsx("th",{children:"Dimensions"}),a.jsx("th",{children:"Status"}),a.jsx("th",{children:"Saved"}),a.jsx("th",{children:"User"}),a.jsx("th",{children:"Created"})]})}),a.jsx("tbody",{children:t.map(_=>a.jsxs("tr",{className:`job-row ${_.is_saved?"saved":"orphaned"} ${_.status}`,children:[a.jsx("td",{className:"thumbnail-cell",children:_.thumbnail_url?a.jsx("img",{src:_.thumbnail_url,alt:"Design",className:"job-thumbnail"}):a.jsx("div",{className:"thumbnail-placeholder",children:"No image"})}),a.jsx("td",{className:"prompt-cell",children:a.jsx("div",{className:"prompt-text",title:_.prompt,children:_.prompt||a.jsx("em",{children:"No prompt"})})}),a.jsx("td",{className:"dimensions-cell",children:_.width_mm&&_.length_mm?a.jsxs("span",{children:[_.width_mm,"  ",_.length_mm," mm"]}):a.jsx("em",{children:"N/A"})}),a.jsx("td",{className:"status-cell",children:a.jsx("span",{className:`status-badge ${_.status}`,children:_.status})}),a.jsx("td",{className:"saved-cell",children:_.is_saved?a.jsx("span",{className:"saved-badge",children:" Saved"}):a.jsx("span",{className:"orphaned-badge",children:" Orphaned"})}),a.jsx("td",{className:"user-cell",children:_.user_email}),a.jsx("td",{className:"date-cell",children:new Date(_.created_at).toLocaleDateString()})]},_.id))})]})}),!i&&t.length===0&&a.jsx("div",{className:"admin-empty",children:a.jsx("p",{children:"No jobs found matching your filters."})}),r>x&&a.jsxs("div",{className:"admin-pagination",children:[a.jsx("button",{onClick:()=>m(Math.max(0,g-x)),disabled:g===0,children:"Previous"}),a.jsxs("span",{children:["Showing ",g+1," to ",Math.min(g+x,r)," of ",r]}),a.jsx("button",{onClick:()=>m(g+x),disabled:g+x>=r,children:"Next"})]}),a.jsx("style",{children:`
        .jobs-table-container {
          overflow-x: auto;
          background: white;
          border-radius: 8px;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .jobs-table {
          width: 100%;
          border-collapse: collapse;
        }

        .jobs-table th {
          background: #f9fafb;
          padding: 1rem;
          text-align: left;
          font-weight: 600;
          font-size: 0.875rem;
          color: #374151;
          border-bottom: 1px solid #e5e7eb;
        }

        .jobs-table td {
          padding: 1rem;
          border-bottom: 1px solid #e5e7eb;
        }

        .job-row.saved {
          background: rgba(16, 185, 129, 0.03);
        }

        .job-row.orphaned {
          background: rgba(245, 158, 11, 0.03);
        }

        .thumbnail-cell {
          width: 80px;
        }

        .job-thumbnail {
          width: 64px;
          height: 64px;
          object-fit: cover;
          border-radius: 4px;
        }

        .thumbnail-placeholder {
          width: 64px;
          height: 64px;
          background: #f3f4f6;
          border-radius: 4px;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 0.75rem;
          color: #9ca3af;
        }

        .prompt-cell {
          max-width: 300px;
        }

        .prompt-text {
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
        }

        .status-badge {
          display: inline-block;
          padding: 0.25rem 0.75rem;
          border-radius: 9999px;
          font-size: 0.75rem;
          font-weight: 500;
        }

        .status-badge.completed {
          background: #d1fae5;
          color: #065f46;
        }

        .status-badge.failed {
          background: #fee2e2;
          color: #991b1b;
        }

        .status-badge.running {
          background: #dbeafe;
          color: #1e40af;
        }

        .status-badge.queued {
          background: #e0e7ff;
          color: #3730a3;
        }

        .saved-badge {
          color: #059669;
          font-weight: 500;
        }

        .orphaned-badge {
          color: #d97706;
          font-weight: 500;
        }

        .user-cell {
          font-size: 0.875rem;
          color: #6b7280;
        }

        .date-cell {
          font-size: 0.875rem;
          color: #6b7280;
          white-space: nowrap;
        }

        .admin-stat-card.success {
          border-left: 4px solid #10b981;
        }

        .admin-stat-card.warning {
          border-left: 4px solid #f59e0b;
        }
      `})]})}function DH(){const[t,e]=P.useState([]),[r,n]=P.useState(null),[i,s]=P.useState(!1),[o,l]=P.useState(null),[c,d]=P.useState(!1),[u,f]=P.useState(new Set),[h,p]=P.useState("all"),g=async()=>{var _,C;const w=await Vt.auth.getSession();return{"Content-Type":"application/json",Authorization:`Bearer ${(C=(_=w==null?void 0:w.data)==null?void 0:_.session)==null?void 0:C.access_token}`}},m=async()=>{s(!0),l(null);try{const w=await g(),k=new URLSearchParams;h!=="all"&&k.append("age_filter",h);const _=await fetch(`/api/admin/recovery/orphaned?${k.toString()}`,{headers:w}),C=await _.json();if(!_.ok)throw new Error(C.error||"Failed to fetch orphaned jobs");e(C.orphaned_jobs),n(C.age_buckets)}catch(w){console.error("Failed to fetch orphaned jobs:",w),l(w.message)}finally{s(!1)}};P.useEffect(()=>{m()},[h]);const x=w=>{const k=new Set(u);k.has(w)?k.delete(w):k.add(w),f(k)},v=()=>{f(new Set(t.map(w=>w.id)))},y=()=>{f(new Set)},b=async()=>{if(u.size===0){alert("Please select at least one job to recover");return}if(confirm(`Recover ${u.size} orphaned ${u.size===1?"design":"designs"}?`)){d(!0),l(null);try{const w=await g(),k=await fetch("/api/admin/recovery/create",{method:"POST",headers:w,body:JSON.stringify({job_ids:Array.from(u)})}),_=await k.json();if(!k.ok)throw new Error(_.error||"Failed to recover designs");alert(`Successfully recovered ${_.recovered_count} ${_.recovered_count===1?"design":"designs"}!`),y(),await m()}catch(w){console.error("Failed to recover designs:",w),l(w.message),alert(`Recovery failed: ${w.message}`)}finally{d(!1)}}};return a.jsxs("div",{className:"recovery-tab",children:[a.jsxs("div",{className:"admin-stats-grid",children:[a.jsxs("div",{className:"admin-stat-card warning",children:[a.jsx("h3",{children:"Total Orphaned"}),a.jsx("p",{className:"stat-value",children:t.length}),a.jsx("span",{className:"stat-label",children:"Designs not saved"})]}),r&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"admin-stat-card",children:[a.jsx("h3",{children:"<24 hours"}),a.jsx("p",{className:"stat-value",children:r["<24h"]}),a.jsx("span",{className:"stat-label",children:"Recent"})]}),a.jsxs("div",{className:"admin-stat-card",children:[a.jsx("h3",{children:"1-7 days"}),a.jsx("p",{className:"stat-value",children:r["1-7d"]}),a.jsx("span",{className:"stat-label",children:"This week"})]}),a.jsxs("div",{className:"admin-stat-card",children:[a.jsx("h3",{children:">7 days"}),a.jsx("p",{className:"stat-value",children:r["7-30d"]+r[">30d"]}),a.jsx("span",{className:"stat-label",children:"Older"})]})]})]}),a.jsxs("div",{className:"recovery-controls",children:[a.jsx("div",{className:"admin-filters",children:a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Age:"}),a.jsxs("select",{value:h,onChange:w=>p(w.target.value),children:[a.jsx("option",{value:"all",children:"All"}),a.jsx("option",{value:"24h",children:"<24 hours"}),a.jsx("option",{value:"7d",children:"<7 days"}),a.jsx("option",{value:"30d",children:"<30 days"})]})]})}),a.jsxs("div",{className:"bulk-actions",children:[a.jsx("button",{onClick:v,className:"btn-secondary",children:"Select All"}),a.jsxs("button",{onClick:y,className:"btn-secondary",children:["Clear (",u.size,")"]}),a.jsx("button",{onClick:b,disabled:u.size===0||c,className:"btn-primary",children:c?"Recovering...":`Recover Selected (${u.size})`})]})]}),i&&a.jsxs("div",{className:"admin-loading",children:[a.jsx("div",{className:"spinner"}),a.jsx("p",{children:"Loading orphaned jobs..."})]}),o&&a.jsx("div",{className:"admin-error",children:a.jsxs("p",{children:["Error: ",o]})}),!i&&t.length>0&&a.jsx("div",{className:"recovery-table-container",children:a.jsxs("table",{className:"recovery-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{width:"40px"},children:a.jsx("input",{type:"checkbox",checked:u.size===t.length,onChange:w=>w.target.checked?v():y()})}),a.jsx("th",{children:"Thumbnail"}),a.jsx("th",{children:"Prompt / Auto-name"}),a.jsx("th",{children:"Dimensions"}),a.jsx("th",{children:"Age"}),a.jsx("th",{children:"User"})]})}),a.jsx("tbody",{children:t.map(w=>a.jsxs("tr",{className:u.has(w.id)?"selected":"",onClick:()=>x(w.id),children:[a.jsx("td",{onClick:k=>k.stopPropagation(),children:a.jsx("input",{type:"checkbox",checked:u.has(w.id),onChange:()=>x(w.id)})}),a.jsx("td",{className:"thumbnail-cell",children:w.thumbnail_url?a.jsx("img",{src:w.thumbnail_url,alt:"Design",className:"job-thumbnail"}):a.jsx("div",{className:"thumbnail-placeholder",children:"No image"})}),a.jsxs("td",{className:"prompt-cell",children:[a.jsx("div",{className:"prompt-text",title:w.prompt,children:w.auto_name}),w.prompt&&w.prompt.length>50&&a.jsx("div",{className:"prompt-full",children:w.prompt})]}),a.jsx("td",{className:"dimensions-cell",children:w.width_mm&&w.length_mm?a.jsxs("span",{children:[w.width_mm,"  ",w.length_mm," mm"]}):a.jsx("em",{children:"N/A"})}),a.jsx("td",{className:"age-cell",children:a.jsxs("span",{className:`age-badge ${w.age_bucket.replace(/[<>]/g,"")}`,children:[w.age_days," ",w.age_days===1?"day":"days"]})}),a.jsx("td",{className:"user-cell",children:w.user_email})]},w.id))})]})}),!i&&t.length===0&&a.jsx("div",{className:"admin-empty",children:a.jsx("p",{children:"No orphaned jobs found. All designs have been saved!"})}),a.jsx("style",{children:`
        .recovery-controls {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 1.5rem;
          flex-wrap: wrap;
          gap: 1rem;
        }

        .bulk-actions {
          display: flex;
          gap: 0.5rem;
        }

        .btn-primary {
          padding: 0.5rem 1rem;
          background: #ff6b35;
          color: white;
          border: none;
          border-radius: 4px;
          font-weight: 500;
          cursor: pointer;
        }

        .btn-primary:hover:not(:disabled) {
          background: #e55a2b;
        }

        .btn-primary:disabled {
          background: #d1d5db;
          cursor: not-allowed;
        }

        .btn-secondary {
          padding: 0.5rem 1rem;
          background: white;
          color: #374151;
          border: 1px solid #d1d5db;
          border-radius: 4px;
          font-weight: 500;
          cursor: pointer;
        }

        .btn-secondary:hover {
          background: #f9fafb;
        }

        .recovery-table-container {
          overflow-x: auto;
          background: white;
          border-radius: 8px;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .recovery-table {
          width: 100%;
          border-collapse: collapse;
        }

        .recovery-table th {
          background: #f9fafb;
          padding: 1rem;
          text-align: left;
          font-weight: 600;
          font-size: 0.875rem;
          color: #374151;
          border-bottom: 1px solid #e5e7eb;
        }

        .recovery-table td {
          padding: 1rem;
          border-bottom: 1px solid #e5e7eb;
        }

        .recovery-table tbody tr {
          cursor: pointer;
          transition: background 0.15s;
        }

        .recovery-table tbody tr:hover {
          background: #f9fafb;
        }

        .recovery-table tbody tr.selected {
          background: #eff6ff;
        }

        .age-badge {
          display: inline-block;
          padding: 0.25rem 0.75rem;
          border-radius: 9999px;
          font-size: 0.75rem;
          font-weight: 500;
        }

        .age-badge.24h {
          background: #fee2e2;
          color: #991b1b;
        }

        .age-badge.1-7d {
          background: #fed7aa;
          color: #92400e;
        }

        .age-badge.7-30d {
          background: #fef3c7;
          color: #78350f;
        }

        .age-badge.30d {
          background: #e5e7eb;
          color: #374151;
        }

        .prompt-full {
          font-size: 0.75rem;
          color: #6b7280;
          margin-top: 0.25rem;
          display: none;
        }

        .recovery-table tbody tr:hover .prompt-full {
          display: block;
        }
      `})]})}function zH({onClose:t}){const[e,r]=P.useState("overview"),[n,i]=P.useState(!0),[s,o]=P.useState(null),[l,c]=P.useState(null),[d,u]=P.useState([]),[f,h]=P.useState([]),[p,g]=P.useState(0),[m,x]=P.useState(null),v=async()=>{var N,T;const _=await Vt.auth.getSession();return{"Content-Type":"application/json",Authorization:`Bearer ${(T=(N=_==null?void 0:_.data)==null?void 0:N.session)==null?void 0:T.access_token}`}},y=async()=>{try{const _=await v(),C=await fetch("/api/admin/analytics/overview",{headers:_}),N=await C.json();if(!C.ok)throw new Error(N.error||"Failed to fetch overview");c(N.stats)}catch(_){console.error("Failed to fetch overview:",_),o(_.message)}},b=async()=>{try{const _=await v(),C=await fetch("/api/admin/users",{headers:_}),N=await C.json();if(!C.ok)throw new Error(N.error||"Failed to fetch users");u(N.users)}catch(_){console.error("Failed to fetch users:",_),o(_.message)}},w=async()=>{try{const _=await v(),C=await fetch("/api/admin/designs?limit=50",{headers:_}),N=await C.json();if(!C.ok)throw new Error(N.error||"Failed to fetch designs");h(N.designs),g(N.total)}catch(_){console.error("Failed to fetch designs:",_),o(_.message)}},k=async()=>{try{const _=await v(),C=await fetch("/api/admin/analytics/colours",{headers:_}),N=await C.json();if(!C.ok)throw new Error(N.error||"Failed to fetch colour analytics");x(N.analytics)}catch(_){console.error("Failed to fetch colours:",_),o(_.message)}};return P.useEffect(()=>{(async()=>{i(!0),await y(),i(!1)})()},[]),P.useEffect(()=>{e==="users"&&d.length===0?b():e==="designs"&&f.length===0?w():e==="colours"&&!m&&k()},[e]),n?a.jsxs("div",{className:"admin-loading",children:[a.jsx("div",{className:"spinner"}),a.jsx("p",{children:"Loading admin dashboard..."})]}):s?a.jsxs("div",{className:"admin-error",children:[a.jsx("h2",{children:"Access Denied"}),a.jsx("p",{children:s}),a.jsx("p",{children:"You need admin privileges to view this page."})]}):a.jsxs("div",{className:"admin-dashboard",children:[a.jsxs("header",{className:"admin-header",children:[a.jsxs("div",{className:"admin-header-left",children:[a.jsxs("button",{onClick:t,className:"btn-back",children:[a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7"})}),"Back to Studio"]}),a.jsx("h1",{children:"TPV Studio Admin"})]}),a.jsxs("nav",{className:"admin-nav",children:[a.jsx("button",{className:e==="overview"?"active":"",onClick:()=>r("overview"),children:"Overview"}),a.jsx("button",{className:e==="generations"?"active":"",onClick:()=>r("generations"),children:"Generations"}),a.jsx("button",{className:e==="recovery"?"active":"",onClick:()=>r("recovery"),children:"Recovery"}),a.jsx("button",{className:e==="users"?"active":"",onClick:()=>r("users"),children:"Users"}),a.jsx("button",{className:e==="designs"?"active":"",onClick:()=>r("designs"),children:"Designs"}),a.jsx("button",{className:e==="colours"?"active":"",onClick:()=>r("colours"),children:"Colour Analytics"})]})]}),a.jsxs("main",{className:"admin-content",children:[e==="overview"&&l&&a.jsx(FH,{stats:l}),e==="generations"&&a.jsx(IH,{}),e==="recovery"&&a.jsx(DH,{}),e==="users"&&a.jsx(BH,{users:d}),e==="designs"&&a.jsx(HH,{designs:f,total:p}),e==="colours"&&m&&a.jsx(UH,{analytics:m})]}),a.jsx("style",{jsx:!0,children:`
        .admin-dashboard {
          min-height: 100vh;
          background: #f8fafc;
        }

        .admin-header {
          background: white;
          border-bottom: 1px solid #e5e7eb;
          padding: 20px 40px;
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
        }

        .admin-header-left {
          display: flex;
          flex-direction: column;
          gap: 8px;
        }

        .btn-back {
          display: inline-flex;
          align-items: center;
          gap: 6px;
          padding: 6px 12px;
          background: #f3f4f6;
          border: 1px solid #e5e7eb;
          border-radius: 6px;
          font-size: 13px;
          color: #6b7280;
          cursor: pointer;
          transition: all 0.2s;
          width: fit-content;
        }

        .btn-back:hover {
          background: #e5e7eb;
          color: #374151;
        }

        .admin-header h1 {
          margin: 0;
          font-size: 24px;
          color: #1e4a7a;
        }

        .admin-nav {
          display: flex;
          gap: 8px;
        }

        .admin-nav button {
          padding: 8px 16px;
          border: 1px solid #e5e7eb;
          background: white;
          border-radius: 6px;
          cursor: pointer;
          font-size: 14px;
          color: #64748b;
          transition: all 0.2s;
        }

        .admin-nav button:hover {
          background: #f8fafc;
          color: #1e4a7a;
        }

        .admin-nav button.active {
          background: #1e4a7a;
          color: white;
          border-color: #1e4a7a;
        }

        .admin-content {
          padding: 24px 40px;
        }

        .admin-loading,
        .admin-error {
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          min-height: 50vh;
          text-align: center;
        }

        .admin-error h2 {
          color: #dc2626;
        }

        .spinner {
          width: 40px;
          height: 40px;
          border: 3px solid #e5e7eb;
          border-top-color: #1e4a7a;
          border-radius: 50%;
          animation: spin 0.8s linear infinite;
          margin-bottom: 16px;
        }

        @keyframes spin {
          to { transform: rotate(360deg); }
        }
      `})]})}function FH({stats:t}){return a.jsxs("div",{className:"overview-panel",children:[a.jsx("h2",{children:"Dashboard Overview"}),a.jsxs("div",{className:"stats-grid",children:[a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-value",children:t.totals.users}),a.jsx("div",{className:"stat-label",children:"Total Users"})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-value",children:t.totals.designs}),a.jsx("div",{className:"stat-label",children:"Total Designs"})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-value",children:t.totals.projects}),a.jsx("div",{className:"stat-label",children:"Total Projects"})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-value",children:t.totals.jobs}),a.jsx("div",{className:"stat-label",children:"AI Jobs Run"})]})]}),a.jsxs("div",{className:"stats-grid",children:[a.jsxs("div",{className:"stat-card highlight",children:[a.jsx("div",{className:"stat-value",children:t.activity.active_users_30d}),a.jsx("div",{className:"stat-label",children:"Active Users (30d)"})]}),a.jsxs("div",{className:"stat-card highlight",children:[a.jsx("div",{className:"stat-value",children:t.activity.designs_7d}),a.jsx("div",{className:"stat-label",children:"Designs This Week"})]}),a.jsxs("div",{className:"stat-card highlight",children:[a.jsx("div",{className:"stat-value",children:t.activity.designs_30d}),a.jsx("div",{className:"stat-label",children:"Designs This Month"})]}),a.jsxs("div",{className:"stat-card highlight",children:[a.jsxs("div",{className:"stat-value",children:[t.activity.job_success_rate,"%"]}),a.jsx("div",{className:"stat-label",children:"Job Success Rate"})]})]}),a.jsx("h3",{children:"Activity Timeline (14 Days)"}),a.jsx("div",{className:"activity-chart",children:t.timeline.map((e,r)=>a.jsxs("div",{className:"bar-container",children:[a.jsx("div",{className:"bar",style:{height:`${Math.max(4,e.count*20)}px`},title:`${e.date}: ${e.count} designs`}),a.jsx("div",{className:"bar-label",children:e.date.split("-")[2]})]},r))}),a.jsxs("div",{className:"breakdowns",children:[a.jsxs("div",{className:"breakdown-card",children:[a.jsx("h4",{children:"Input Mode"}),a.jsxs("div",{className:"breakdown-items",children:[a.jsxs("div",{className:"breakdown-item",children:[a.jsx("span",{children:"Prompt"}),a.jsx("strong",{children:t.breakdowns.input_mode.prompt})]}),a.jsxs("div",{className:"breakdown-item",children:[a.jsx("span",{children:"Image Upload"}),a.jsx("strong",{children:t.breakdowns.input_mode.image})]}),a.jsxs("div",{className:"breakdown-item",children:[a.jsx("span",{children:"SVG Upload"}),a.jsx("strong",{children:t.breakdowns.input_mode.svg})]})]})]}),a.jsxs("div",{className:"breakdown-card",children:[a.jsx("h4",{children:"View Mode Preference"}),a.jsxs("div",{className:"breakdown-items",children:[a.jsxs("div",{className:"breakdown-item",children:[a.jsx("span",{children:"Solid TPV"}),a.jsx("strong",{children:t.breakdowns.view_mode.solid})]}),a.jsxs("div",{className:"breakdown-item",children:[a.jsx("span",{children:"Blend TPV"}),a.jsx("strong",{children:t.breakdowns.view_mode.blend})]})]})]})]}),a.jsx("style",{jsx:!0,children:`
        .overview-panel h2 {
          margin: 0 0 24px 0;
          color: #1a202c;
        }

        .overview-panel h3 {
          margin: 32px 0 16px 0;
          color: #1a202c;
        }

        .stats-grid {
          display: grid;
          grid-template-columns: repeat(4, 1fr);
          gap: 16px;
          margin-bottom: 16px;
        }

        .stat-card {
          background: white;
          padding: 20px;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
        }

        .stat-card.highlight {
          border-color: #1e4a7a;
          border-width: 2px;
        }

        .stat-value {
          font-size: 32px;
          font-weight: 700;
          color: #1e4a7a;
        }

        .stat-label {
          font-size: 14px;
          color: #64748b;
          margin-top: 4px;
        }

        .activity-chart {
          display: flex;
          align-items: flex-end;
          gap: 8px;
          height: 120px;
          padding: 16px;
          background: white;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
        }

        .bar-container {
          flex: 1;
          display: flex;
          flex-direction: column;
          align-items: center;
        }

        .bar {
          width: 100%;
          background: #1e4a7a;
          border-radius: 4px 4px 0 0;
          min-height: 4px;
        }

        .bar-label {
          font-size: 10px;
          color: #64748b;
          margin-top: 4px;
        }

        .breakdowns {
          display: grid;
          grid-template-columns: repeat(2, 1fr);
          gap: 16px;
          margin-top: 24px;
        }

        .breakdown-card {
          background: white;
          padding: 20px;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
        }

        .breakdown-card h4 {
          margin: 0 0 12px 0;
          color: #1a202c;
        }

        .breakdown-item {
          display: flex;
          justify-content: space-between;
          padding: 8px 0;
          border-bottom: 1px solid #f3f4f6;
        }

        .breakdown-item:last-child {
          border-bottom: none;
        }

        .breakdown-item span {
          color: #64748b;
        }

        .breakdown-item strong {
          color: #1a202c;
        }
      `})]})}function BH({users:t}){return a.jsxs("div",{className:"users-panel",children:[a.jsxs("h2",{children:["User Management (",t.length," users)"]}),a.jsxs("table",{className:"users-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Email"}),a.jsx("th",{children:"Role"}),a.jsx("th",{children:"Designs"}),a.jsx("th",{children:"Projects"}),a.jsx("th",{children:"Jobs"}),a.jsx("th",{children:"Last Design"}),a.jsx("th",{children:"Joined"})]})}),a.jsx("tbody",{children:t.map(e=>a.jsxs("tr",{children:[a.jsx("td",{children:e.email}),a.jsx("td",{children:a.jsx("span",{className:`role-badge ${e.role}`,children:e.role})}),a.jsx("td",{children:e.design_count}),a.jsx("td",{children:e.project_count}),a.jsx("td",{children:e.job_count}),a.jsx("td",{children:e.last_design_at?new Date(e.last_design_at).toLocaleDateString():"-"}),a.jsx("td",{children:new Date(e.created_at).toLocaleDateString()})]},e.id))})]}),a.jsx("style",{jsx:!0,children:`
        .users-panel h2 {
          margin: 0 0 24px 0;
          color: #1a202c;
        }

        .users-table {
          width: 100%;
          background: white;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
          border-collapse: collapse;
        }

        .users-table th,
        .users-table td {
          padding: 12px 16px;
          text-align: left;
          border-bottom: 1px solid #e5e7eb;
        }

        .users-table th {
          background: #f8fafc;
          font-weight: 600;
          color: #64748b;
          font-size: 12px;
          text-transform: uppercase;
        }

        .users-table td {
          font-size: 14px;
          color: #1a202c;
        }

        .role-badge {
          padding: 4px 8px;
          border-radius: 4px;
          font-size: 12px;
          font-weight: 500;
        }

        .role-badge.user {
          background: #f3f4f6;
          color: #64748b;
        }

        .role-badge.admin {
          background: #dbeafe;
          color: #1e40af;
        }

        .role-badge.superadmin {
          background: #fef3c7;
          color: #92400e;
        }
      `})]})}function HH({designs:t,total:e}){return a.jsxs("div",{className:"designs-panel",children:[a.jsxs("h2",{children:["All Designs (",e," total)"]}),a.jsx("div",{className:"designs-grid",children:t.map(r=>a.jsxs("div",{className:"design-card",children:[a.jsx("div",{className:"design-thumbnail",children:r.thumbnail_url||r.original_png_url?a.jsx("img",{src:r.thumbnail_url||r.original_png_url,alt:r.name}):a.jsx("div",{className:"no-image",children:"No preview"})}),a.jsxs("div",{className:"design-info",children:[a.jsx("h4",{children:r.name}),a.jsx("p",{className:"design-user",children:r.user_email}),a.jsx("p",{className:"design-date",children:new Date(r.created_at).toLocaleDateString()}),r.project&&a.jsx("span",{className:"project-badge",style:{backgroundColor:r.project.color||"#64748b"},children:r.project.name})]})]},r.id))}),a.jsx("style",{jsx:!0,children:`
        .designs-panel h2 {
          margin: 0 0 24px 0;
          color: #1a202c;
        }

        .designs-grid {
          display: grid;
          grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
          gap: 16px;
        }

        .design-card {
          background: white;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
          overflow: hidden;
        }

        .design-thumbnail {
          aspect-ratio: 1;
          background: #f3f4f6;
          overflow: hidden;
        }

        .design-thumbnail img {
          width: 100%;
          height: 100%;
          object-fit: cover;
        }

        .no-image {
          width: 100%;
          height: 100%;
          display: flex;
          align-items: center;
          justify-content: center;
          color: #9ca3af;
          font-size: 14px;
        }

        .design-info {
          padding: 12px;
        }

        .design-info h4 {
          margin: 0 0 4px 0;
          font-size: 14px;
          color: #1a202c;
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
        }

        .design-user {
          margin: 0;
          font-size: 12px;
          color: #64748b;
        }

        .design-date {
          margin: 4px 0;
          font-size: 12px;
          color: #9ca3af;
        }

        .project-badge {
          display: inline-block;
          padding: 2px 8px;
          border-radius: 10px;
          font-size: 10px;
          color: white;
        }
      `})]})}function UH({analytics:t}){return a.jsxs("div",{className:"colours-panel",children:[a.jsx("h2",{children:"Colour Usage Analytics"}),a.jsxs("div",{className:"colour-stats",children:[a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-value",children:t.totals.designs_analysed}),a.jsx("div",{className:"stat-label",children:"Designs Analysed"})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-value",children:t.totals.colour_usages}),a.jsx("div",{className:"stat-label",children:"Total Colour Uses"})]})]}),a.jsx("h3",{children:"Top 10 TPV Colours"}),a.jsx("div",{className:"colour-list",children:t.top_colours.map((e,r)=>a.jsxs("div",{className:"colour-item",children:[a.jsxs("span",{className:"colour-rank",children:["#",r+1]}),a.jsx("div",{className:"colour-swatch",style:{backgroundColor:e.hex}}),a.jsxs("div",{className:"colour-info",children:[a.jsx("strong",{children:e.code}),a.jsx("span",{children:e.name})]}),a.jsxs("div",{className:"colour-count",children:[e.count," uses"]})]},e.code))}),a.jsx("h3",{children:"Colour Family Breakdown"}),a.jsx("div",{className:"family-bars",children:Object.entries(t.families).map(([e,r])=>a.jsxs("div",{className:"family-bar",children:[a.jsx("span",{className:"family-name",children:e}),a.jsx("div",{className:"bar-bg",children:a.jsx("div",{className:"bar-fill",style:{width:`${r/t.totals.colour_usages*100}%`,backgroundColor:WH(e)}})}),a.jsx("span",{className:"family-count",children:r})]},e))}),t.top_blends.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{children:"Top Blend Combinations"}),a.jsx("div",{className:"blend-list",children:t.top_blends.map((e,r)=>a.jsxs("div",{className:"blend-item",children:[a.jsx("div",{className:"blend-swatches",children:e.components.map((n,i)=>a.jsx("div",{className:"blend-swatch",style:{backgroundColor:n.hex},title:`${n.code} - ${n.name}`},i))}),a.jsx("div",{className:"blend-codes",children:e.components.map(n=>n.code).join(" + ")}),a.jsxs("div",{className:"blend-count",children:[e.count," uses"]})]},r))})]}),a.jsx("style",{jsx:!0,children:`
        .colours-panel h2 {
          margin: 0 0 24px 0;
          color: #1a202c;
        }

        .colours-panel h3 {
          margin: 32px 0 16px 0;
          color: #1a202c;
        }

        .colour-stats {
          display: grid;
          grid-template-columns: repeat(2, 1fr);
          gap: 16px;
          margin-bottom: 24px;
        }

        .stat-card {
          background: white;
          padding: 20px;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
        }

        .stat-value {
          font-size: 32px;
          font-weight: 700;
          color: #1e4a7a;
        }

        .stat-label {
          font-size: 14px;
          color: #64748b;
          margin-top: 4px;
        }

        .colour-list {
          background: white;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
          overflow: hidden;
        }

        .colour-item {
          display: flex;
          align-items: center;
          gap: 12px;
          padding: 12px 16px;
          border-bottom: 1px solid #f3f4f6;
        }

        .colour-item:last-child {
          border-bottom: none;
        }

        .colour-rank {
          width: 30px;
          font-size: 12px;
          color: #9ca3af;
        }

        .colour-swatch {
          width: 32px;
          height: 32px;
          border-radius: 6px;
          border: 1px solid #e5e7eb;
        }

        .colour-info {
          flex: 1;
        }

        .colour-info strong {
          display: block;
          color: #1a202c;
        }

        .colour-info span {
          font-size: 12px;
          color: #64748b;
        }

        .colour-count {
          font-weight: 600;
          color: #1e4a7a;
        }

        .family-bars {
          background: white;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
          padding: 16px;
        }

        .family-bar {
          display: flex;
          align-items: center;
          gap: 12px;
          margin-bottom: 12px;
        }

        .family-bar:last-child {
          margin-bottom: 0;
        }

        .family-name {
          width: 80px;
          font-size: 14px;
          color: #64748b;
          text-transform: capitalize;
        }

        .bar-bg {
          flex: 1;
          height: 20px;
          background: #f3f4f6;
          border-radius: 4px;
          overflow: hidden;
        }

        .bar-fill {
          height: 100%;
          border-radius: 4px;
        }

        .family-count {
          width: 50px;
          text-align: right;
          font-weight: 600;
          color: #1a202c;
        }

        .blend-list {
          background: white;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
          overflow: hidden;
        }

        .blend-item {
          display: flex;
          align-items: center;
          gap: 12px;
          padding: 12px 16px;
          border-bottom: 1px solid #f3f4f6;
        }

        .blend-item:last-child {
          border-bottom: none;
        }

        .blend-swatches {
          display: flex;
          gap: 4px;
        }

        .blend-swatch {
          width: 24px;
          height: 24px;
          border-radius: 4px;
          border: 1px solid #e5e7eb;
        }

        .blend-codes {
          flex: 1;
          font-size: 14px;
          color: #1a202c;
        }

        .blend-count {
          font-weight: 600;
          color: #1e4a7a;
        }
      `})]})}function WH(t){return{reds:"#dc2626",greens:"#16a34a",blues:"#2563eb",yellows:"#ca8a04",neutrals:"#6b7280"}[t]||"#6b7280"}const Vu=[{code:"RH30",name:"Beige",hex:"#E4C4AA"},{code:"RH31",name:"Cream",hex:"#E8E3D8"},{code:"RH41",name:"Bright Yellow",hex:"#FFD833"},{code:"RH40",name:"Mustard",hex:"#E5A144"},{code:"RH50",name:"Orange",hex:"#F15B32"},{code:"RH01",name:"Standard Red",hex:"#A5362F"},{code:"RH02",name:"Bright Red",hex:"#E21F2F"},{code:"RH90",name:"Funky Pink",hex:"#E8457E"},{code:"RH21",name:"Purple",hex:"#493D8C"},{code:"RH20",name:"Standard Blue",hex:"#0075BC"},{code:"RH22",name:"Light Blue",hex:"#47AFE3"},{code:"RH23",name:"Azure",hex:"#039DC4"},{code:"RH26",name:"Turquoise",hex:"#00A6A3"},{code:"RH12",name:"Dark Green",hex:"#006C55"},{code:"RH10",name:"Standard Green",hex:"#609B63"},{code:"RH11",name:"Bright Green",hex:"#3BB44A"},{code:"RH32",name:"Brown",hex:"#8B5F3C"},{code:"RH65",name:"Pale Grey",hex:"#D9D9D6"},{code:"RH61",name:"Light Grey",hex:"#939598"},{code:"RH60",name:"Dark Grey",hex:"#59595B"},{code:"RH70",name:"Black",hex:"#231F20"}],my=["ocean theme with dolphins and waves","jungle adventure with parrots","solar system with planets","garden with butterflies and flowers","racing track with cars","underwater coral reef scene","dinosaur footprints trail","rainbow with clouds"],GH=[...Array(60)].map(t=>({delay:`${Math.random()*3}s`,x:`${Math.random()*100}%`,y:`${Math.random()*100}%`,size:`${8+Math.random()*12}px`}));function VH(){const[t,e]=P.useState(""),[r,n]=P.useState(""),[i,s]=P.useState(""),[o,l]=P.useState(!1),[c,d]=P.useState(!1),[u,f]=P.useState(0);P.useEffect(()=>{const g=setInterval(()=>{f(m=>(m+1)%my.length)},5e3);return()=>clearInterval(g)},[]);const h=async g=>{g.preventDefault(),s(""),l(!0);try{await Pn.signIn(t,r)}catch(m){s(m.message||"Sign in failed")}finally{l(!1)}},p=g=>{var m;(m=document.getElementById(g))==null||m.scrollIntoView({behavior:"smooth"})};return a.jsxs("div",{className:"landing-page",children:[a.jsxs("nav",{className:"landing-nav",children:[a.jsxs("div",{className:"nav-logo",children:[a.jsx("span",{className:"logo-text",children:"TPV"}),a.jsx("span",{className:"logo-accent",children:"Studio"})]}),a.jsxs("div",{className:"nav-links",children:[a.jsx("button",{onClick:()=>p("features"),children:"Features"}),a.jsx("button",{onClick:()=>p("palette"),children:"Colours"}),a.jsx("button",{onClick:()=>d(!0),className:"nav-cta",children:"Sign In"})]})]}),a.jsxs("section",{className:"hero",children:[a.jsx("div",{className:"hero-background",children:a.jsx("div",{className:"granule-field",children:GH.map((g,m)=>a.jsx("div",{className:"granule",style:{"--delay":g.delay,"--x":g.x,"--y":g.y,"--color":Vu[m%Vu.length].hex,"--size":g.size}},m))})}),a.jsxs("div",{className:"hero-content",children:[a.jsx("div",{className:"hero-badge",children:"TPV Surface Design Platform"}),a.jsxs("h1",{children:[a.jsx("span",{className:"hero-line-1",children:"Design Any"}),a.jsx("span",{className:"hero-line-2",children:"TPV Surface"})]}),a.jsx("p",{className:"hero-subtitle",children:"From AI-generated playground art to professional sports courts  one powerful design platform for all your TPV surfaces."}),a.jsxs("div",{className:"hero-ctas",children:[a.jsxs("button",{onClick:()=>d(!0),className:"cta-primary",children:["Start Designing",a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M5 12h14M12 5l7 7-7 7"})})]}),a.jsx("button",{onClick:()=>p("how-it-works"),className:"cta-secondary",children:"See How It Works"})]})]}),a.jsx("div",{className:"hero-visual",children:a.jsx("div",{className:"mockup-container",children:a.jsxs("div",{className:"mockup-screen",children:[a.jsx("div",{className:"mockup-header",children:a.jsxs("div",{className:"mockup-dots",children:[a.jsx("span",{}),a.jsx("span",{}),a.jsx("span",{})]})}),a.jsxs("div",{className:"mockup-content",children:[a.jsx("div",{className:"mockup-input",children:a.jsx("span",{className:"typing-text",children:my[u]},u)}),a.jsxs("div",{className:"mockup-preview",children:[a.jsx("div",{className:"preview-shape shape-1"}),a.jsx("div",{className:"preview-shape shape-2"}),a.jsx("div",{className:"preview-shape shape-3"})]})]})]})})})]}),a.jsxs("section",{className:"unified-showcase",children:[a.jsxs("div",{className:"section-header",children:[a.jsx("span",{className:"section-tag",children:"One Powerful Tool"}),a.jsx("h2",{children:"Design Any Surface"}),a.jsx("p",{className:"section-subtitle",children:"Courts, tracks, playgrounds, and custom graphics  all in one canvas"})]}),a.jsx("div",{className:"showcase-container",children:a.jsxs("div",{className:"showcase-card",children:[a.jsxs("div",{className:"showcase-canvas",children:[a.jsxs("div",{className:"canvas-preview",children:[a.jsx("div",{className:"canvas-grid"}),a.jsxs("div",{className:"canvas-surface",children:[a.jsx("div",{className:"surface-court"}),a.jsx("div",{className:"surface-motif"})]})]}),a.jsxs("div",{className:"capability-pill pill-courts",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("rect",{x:"2",y:"4",width:"20",height:"16",rx:"2"}),a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M2 12h4M18 12h4"})]}),a.jsx("span",{children:"Courts & Tracks"})]}),a.jsxs("div",{className:"capability-pill pill-ai",children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2z"})}),a.jsx("span",{children:"AI Artwork"})]}),a.jsxs("div",{className:"capability-pill pill-upload",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]}),a.jsx("span",{children:"Custom Images"})]}),a.jsxs("div",{className:"capability-pill pill-layers",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5z"}),a.jsx("path",{d:"M2 17l10 5 10-5"}),a.jsx("path",{d:"M2 12l10 5 10-5"})]}),a.jsx("span",{children:"Layer & Combine"})]})]}),a.jsx("div",{className:"showcase-tagline",children:"One canvas. Unlimited possibilities."}),a.jsxs("div",{className:"showcase-features",children:[a.jsxs("div",{className:"showcase-feature",children:[a.jsx("div",{className:"feature-badge ai-badge",children:"AI-POWERED"}),a.jsx("span",{children:"Generate motifs from text descriptions"})]}),a.jsxs("div",{className:"showcase-feature",children:[a.jsx("div",{className:"feature-badge template-badge",children:"TEMPLATES"}),a.jsx("span",{children:"15+ professional court layouts"})]}),a.jsxs("div",{className:"showcase-feature",children:[a.jsx("div",{className:"feature-badge compose-badge",children:"COMPOSE"}),a.jsx("span",{children:"Mix courts, tracks & artwork freely"})]})]}),a.jsxs("button",{onClick:()=>d(!0),className:"cta-primary showcase-cta",children:["Start Designing",a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M5 12h14M12 5l7 7-7 7"})})]})]})})]}),a.jsxs("section",{id:"how-it-works",className:"how-it-works",children:[a.jsxs("div",{className:"section-header",children:[a.jsx("span",{className:"section-tag",children:"Process"}),a.jsx("h2",{children:"Three Steps to Production-Ready Designs"})]}),a.jsxs("div",{className:"steps-container",children:[a.jsxs("div",{className:"step",children:[a.jsx("div",{className:"step-number",children:"01"}),a.jsx("div",{className:"step-icon",children:a.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("path",{d:"M3 9h18M9 21V9"})]})}),a.jsx("h3",{children:"Set Up Your Surface"}),a.jsx("p",{children:"Define your dimensions and choose your base colour. Start with any size from small playgrounds to full athletic facilities."})]}),a.jsx("div",{className:"step-connector",children:a.jsx("svg",{viewBox:"0 0 100 20",preserveAspectRatio:"none",children:a.jsx("path",{d:"M0 10 Q50 10 100 10",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeDasharray:"4 4"})})}),a.jsxs("div",{className:"step",children:[a.jsx("div",{className:"step-number",children:"02"}),a.jsx("div",{className:"step-icon",children:a.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5z"}),a.jsx("path",{d:"M2 17l10 5 10-5"}),a.jsx("path",{d:"M2 12l10 5 10-5"})]})}),a.jsx("h3",{children:"Add Elements"}),a.jsx("p",{children:"Drop in courts and tracks from the library, generate AI artwork, upload your own designs  layer and combine freely."})]}),a.jsx("div",{className:"step-connector",children:a.jsx("svg",{viewBox:"0 0 100 20",preserveAspectRatio:"none",children:a.jsx("path",{d:"M0 10 Q50 10 100 10",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeDasharray:"4 4"})})}),a.jsxs("div",{className:"step",children:[a.jsx("div",{className:"step-number",children:"03"}),a.jsx("div",{className:"step-icon",children:a.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("path",{d:"M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"}),a.jsx("path",{d:"M14 2v6h6M12 18v-6M9 15l3 3 3-3"})]})}),a.jsx("h3",{children:"Export & Build"}),a.jsx("p",{children:"Generate professional PDFs with material specifications, TPV blend recipes, and exact quantities for installation."})]})]})]}),a.jsxs("section",{id:"features",className:"features",children:[a.jsxs("div",{className:"section-header",children:[a.jsx("span",{className:"section-tag",children:"Capabilities"}),a.jsx("h2",{children:"Everything You Need to Design TPV Surfaces"})]}),a.jsxs("div",{className:"features-grid unified-features",children:[a.jsxs("div",{className:"feature-card feature-highlight",children:[a.jsx("div",{className:"feature-icon",children:a.jsx("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2z"})})}),a.jsx("h3",{children:"AI Text-to-Vector"}),a.jsx("p",{children:"Describe any concept in natural language. Our AI transforms your words into production-ready vector designs optimised for TPV surfaces."}),a.jsx("div",{className:"feature-example",children:'"vibrant underwater scene with coral reef"'})]}),a.jsxs("div",{className:"feature-card",children:[a.jsx("div",{className:"feature-icon",children:a.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("rect",{x:"2",y:"4",width:"20",height:"16",rx:"2"}),a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M2 12h4M18 12h4"})]})}),a.jsx("h3",{children:"Court & Track Library"}),a.jsx("p",{children:"15+ professional templates including basketball, tennis, netball, futsal, and running tracks."})]}),a.jsxs("div",{className:"feature-card",children:[a.jsx("div",{className:"feature-icon",children:a.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),a.jsx("h3",{children:"Image Vectorisation"}),a.jsx("p",{children:"Upload any image and convert it to clean vectors optimised for TPV production."})]}),a.jsxs("div",{className:"feature-card",children:[a.jsx("div",{className:"feature-icon",children:a.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("circle",{cx:"13.5",cy:"6.5",r:"2.5"}),a.jsx("circle",{cx:"17.5",cy:"10.5",r:"2.5"}),a.jsx("circle",{cx:"8.5",cy:"7.5",r:"2.5"}),a.jsx("circle",{cx:"6.5",cy:"12.5",r:"2.5"})]})}),a.jsx("h3",{children:"Blend Colour Matching"}),a.jsx("p",{children:"Automatic TPV recipe generation with precise blend ratios for perfect colour accuracy."})]}),a.jsxs("div",{className:"feature-card",children:[a.jsx("div",{className:"feature-icon",children:a.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5z"}),a.jsx("path",{d:"M2 17l10 5 10-5"}),a.jsx("path",{d:"M2 12l10 5 10-5"})]})}),a.jsx("h3",{children:"Layer Management"}),a.jsx("p",{children:"Combine courts, tracks, and motifs freely. Drag, rotate, and layer with precision controls."})]}),a.jsxs("div",{className:"feature-card",children:[a.jsx("div",{className:"feature-icon",children:a.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("path",{d:"M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"}),a.jsx("path",{d:"M14 2v6h6M12 18v-6M9 15l3 3 3-3"})]})}),a.jsx("h3",{children:"PDF Specifications"}),a.jsx("p",{children:"Export production-ready material specs with blend recipes and installation guides."})]})]})]}),a.jsxs("section",{id:"palette",className:"palette-section",children:[a.jsxs("div",{className:"section-header light",children:[a.jsx("span",{className:"section-tag",children:"Palette"}),a.jsx("h2",{children:"21 Standard TPV Colours"}),a.jsx("p",{className:"section-subtitle",children:"The complete Rosehill TPV granule palette at your fingertips"})]}),a.jsx("div",{className:"palette-grid",children:Vu.map((g,m)=>a.jsxs("div",{className:"palette-swatch",style:{"--swatch-color":g.hex,"--delay":`${m*.03}s`},children:[a.jsx("div",{className:"swatch-color"}),a.jsxs("div",{className:"swatch-info",children:[a.jsx("span",{className:"swatch-name",children:g.name}),a.jsx("span",{className:"swatch-code",children:g.code})]})]},g.code))})]}),a.jsx("section",{className:"benefits",children:a.jsxs("div",{className:"benefits-grid benefits-grid-4",children:[a.jsxs("div",{className:"benefit",children:[a.jsx("div",{className:"benefit-metric",children:"10x"}),a.jsx("div",{className:"benefit-label",children:"Faster Design"}),a.jsx("p",{children:"What took hours now takes minutes with AI and templates."})]}),a.jsxs("div",{className:"benefit",children:[a.jsx("div",{className:"benefit-metric",children:"100%"}),a.jsx("div",{className:"benefit-label",children:"Production Accurate"}),a.jsx("p",{children:"Exact TPV granule specs with precise ratio specifications."})]}),a.jsxs("div",{className:"benefit",children:[a.jsx("div",{className:"benefit-metric infinite-symbol",children:""}),a.jsx("div",{className:"benefit-label",children:"Combinations"}),a.jsx("p",{children:"Mix courts, tracks, and artwork in unlimited configurations."})]}),a.jsxs("div",{className:"benefit",children:[a.jsx("div",{className:"benefit-metric",children:"21"}),a.jsx("div",{className:"benefit-label",children:"Standard Colours"}),a.jsx("p",{children:"Complete Rosehill TPV palette with blend combinations."})]})]})}),a.jsx("section",{className:"cta-footer",children:a.jsxs("div",{className:"cta-content",children:[a.jsx("h2",{children:"Ready to Design Your Surface?"}),a.jsx("p",{children:"Create playgrounds or sports facilities with production-ready TPV specifications."}),a.jsxs("button",{onClick:()=>d(!0),className:"cta-primary large",children:["Sign In to TPV Studio",a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M5 12h14M12 5l7 7-7 7"})})]}),a.jsxs("p",{className:"cta-note",children:["Need an account? Contact ",a.jsx("a",{href:"mailto:info@rosehill.group",children:"info@rosehill.group"})]})]})}),c&&a.jsx("div",{className:"modal-overlay",onClick:()=>d(!1),children:a.jsxs("div",{className:"sign-in-modal",onClick:g=>g.stopPropagation(),children:[a.jsx("button",{className:"modal-close",onClick:()=>d(!1),children:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})}),a.jsxs("div",{className:"modal-header",children:[a.jsx("h2",{children:"Sign In"}),a.jsx("p",{children:"Access your TPV Studio account"})]}),i&&a.jsx("div",{className:"form-error",children:i}),a.jsxs("form",{onSubmit:h,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Email"}),a.jsx("input",{type:"email",value:t,onChange:g=>e(g.target.value),placeholder:"your.email@company.com",required:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Password"}),a.jsx("input",{type:"password",value:r,onChange:g=>n(g.target.value),required:!0})]}),a.jsx("button",{type:"submit",disabled:o,className:"submit-btn",children:o?"Signing in...":"Sign In"})]}),a.jsx("p",{className:"modal-footer-text",children:"Don't have an account? Contact your administrator."})]})}),a.jsx("style",{jsx:!0,children:`
        /* ============================================
           TPV STUDIO LANDING PAGE
           Aesthetic: Sophisticated Industrial-Creative
           ============================================ */

        @import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=DM+Sans:wght@400;500;600&display=swap');

        .landing-page {
          --primary: #1e4a7a;
          --primary-light: #2a5a8e;
          --accent: #ff6b35;
          --accent-hover: #e55a2a;
          --text: #1a202c;
          --text-secondary: #64748b;
          --text-light: #94a3b8;
          --bg: #fafbfc;
          --bg-dark: #0f172a;
          --card: #ffffff;
          --border: #e2e8f0;

          font-family: 'DM Sans', sans-serif;
          background: var(--bg);
          color: var(--text);
          overflow-x: hidden;
        }

        /* Navigation */
        .landing-nav {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          z-index: 1000;
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 1rem 3rem;
          background: rgba(255, 255, 255, 0.9);
          backdrop-filter: blur(12px);
          border-bottom: 1px solid var(--border);
        }

        .nav-logo {
          font-family: 'Space Grotesk', sans-serif;
          font-size: 1.5rem;
          font-weight: 700;
        }

        .logo-text {
          color: var(--primary);
        }

        .logo-accent {
          color: var(--accent);
        }

        .nav-links {
          display: flex;
          align-items: center;
          gap: 2rem;
        }

        .nav-links button {
          background: none;
          border: none;
          font-family: inherit;
          font-size: 0.875rem;
          font-weight: 500;
          color: var(--text-secondary);
          cursor: pointer;
          transition: color 0.2s;
        }

        .nav-links button:hover {
          color: var(--text);
        }

        .nav-cta {
          background: var(--primary) !important;
          color: white !important;
          padding: 0.5rem 1.25rem !important;
          border-radius: 6px !important;
        }

        .nav-cta:hover {
          background: var(--primary-light) !important;
        }

        /* Hero Section */
        .hero {
          min-height: 100vh;
          display: grid;
          grid-template-columns: 1fr 1fr;
          align-items: center;
          padding: 8rem 4rem 4rem;
          position: relative;
          overflow: hidden;
        }

        .hero-background {
          position: absolute;
          inset: 0;
          pointer-events: none;
        }

        .granule-field {
          position: absolute;
          inset: 0;
        }

        .granule {
          position: absolute;
          left: var(--x);
          top: var(--y);
          width: var(--size);
          height: var(--size);
          background: var(--color);
          border-radius: 50%;
          opacity: 0.15;
          animation: float 8s ease-in-out infinite;
          animation-delay: var(--delay);
        }

        @keyframes float {
          0%, 100% { transform: translateY(0) scale(1); }
          50% { transform: translateY(-20px) scale(1.1); }
        }

        .hero-content {
          position: relative;
          z-index: 10;
        }

        .hero-badge {
          display: inline-block;
          padding: 0.5rem 1rem;
          background: rgba(30, 74, 122, 0.1);
          color: var(--primary);
          font-size: 0.75rem;
          font-weight: 600;
          text-transform: uppercase;
          letter-spacing: 0.1em;
          border-radius: 50px;
          margin-bottom: 1.5rem;
        }

        .hero h1 {
          font-family: 'Space Grotesk', sans-serif;
          font-size: 3.5rem;
          font-weight: 700;
          line-height: 1.1;
          margin: 0 0 1.5rem;
        }

        .hero-line-1 {
          display: block;
          color: var(--text-secondary);
        }

        .hero-line-2 {
          display: block;
          color: var(--primary);
        }

        .hero-subtitle {
          font-size: 1.125rem;
          color: var(--text-secondary);
          line-height: 1.7;
          max-width: 480px;
          margin-bottom: 2rem;
        }

        .hero-ctas {
          display: flex;
          gap: 1rem;
        }

        .cta-primary {
          display: inline-flex;
          align-items: center;
          gap: 0.5rem;
          padding: 0.875rem 1.5rem;
          background: var(--accent);
          color: white;
          border: none;
          border-radius: 8px;
          font-family: inherit;
          font-size: 0.9375rem;
          font-weight: 600;
          cursor: pointer;
          transition: all 0.2s;
        }

        .cta-primary:hover {
          background: var(--accent-hover);
          transform: translateY(-2px);
          box-shadow: 0 8px 24px rgba(255, 107, 53, 0.3);
        }

        .cta-primary.large {
          padding: 1rem 2rem;
          font-size: 1rem;
        }

        .cta-secondary {
          padding: 0.875rem 1.5rem;
          background: white;
          color: var(--text);
          border: 2px solid var(--border);
          border-radius: 8px;
          font-family: inherit;
          font-size: 0.9375rem;
          font-weight: 600;
          cursor: pointer;
          transition: all 0.2s;
        }

        .cta-secondary:hover {
          border-color: var(--primary);
          color: var(--primary);
        }

        /* Hero Visual / Mockup */
        .hero-visual {
          position: relative;
          z-index: 10;
          display: flex;
          justify-content: center;
        }

        .mockup-container {
          perspective: 1000px;
        }

        .mockup-screen {
          width: 400px;
          background: white;
          border-radius: 12px;
          box-shadow: 0 24px 80px rgba(0, 0, 0, 0.15);
          overflow: hidden;
          transform: rotateY(-5deg) rotateX(2deg);
          animation: mockupFloat 6s ease-in-out infinite;
        }

        @keyframes mockupFloat {
          0%, 100% { transform: rotateY(-5deg) rotateX(2deg) translateY(0); }
          50% { transform: rotateY(-5deg) rotateX(2deg) translateY(-10px); }
        }

        .mockup-header {
          padding: 0.75rem 1rem;
          background: #f8f8f8;
          border-bottom: 1px solid #eee;
        }

        .mockup-dots {
          display: flex;
          gap: 6px;
        }

        .mockup-dots span {
          width: 10px;
          height: 10px;
          border-radius: 50%;
          background: #ddd;
        }

        .mockup-dots span:nth-child(1) { background: #ff5f56; }
        .mockup-dots span:nth-child(2) { background: #ffbd2e; }
        .mockup-dots span:nth-child(3) { background: #27ca41; }

        .mockup-content {
          padding: 1.5rem;
        }

        .mockup-input {
          background: #f5f5f5;
          padding: 1rem;
          border-radius: 8px;
          font-size: 0.875rem;
          color: var(--text-secondary);
          margin-bottom: 1.5rem;
          display: flex;
          align-items: center;
        }

        .typing-text {
          display: inline-block;
          overflow: hidden;
          white-space: nowrap;
          border-right: 2px solid var(--primary);
          animation: typing 5s steps(40, end) forwards, blink 0.7s step-end infinite;
        }

        @keyframes typing {
          0% { max-width: 0; }
          35% { max-width: 500px; }
          65% { max-width: 500px; }
          100% { max-width: 0; }
        }

        @keyframes blink {
          50% { border-color: transparent; }
        }

        .mockup-preview {
          height: 180px;
          background: linear-gradient(135deg, #e8f4f8, #f0f4ff);
          border-radius: 8px;
          position: relative;
          overflow: hidden;
        }

        .preview-shape {
          position: absolute;
          border-radius: 50%;
          animation: shapeReveal 4s ease-out infinite;
        }

        .shape-1 {
          width: 80px;
          height: 80px;
          background: var(--accent);
          opacity: 0.8;
          top: 20%;
          left: 15%;
          animation-delay: 0s;
        }

        .shape-2 {
          width: 60px;
          height: 60px;
          background: #30D5C8;
          opacity: 0.8;
          top: 40%;
          left: 50%;
          animation-delay: 0.3s;
        }

        .shape-3 {
          width: 100px;
          height: 100px;
          background: var(--primary);
          opacity: 0.8;
          top: 50%;
          right: 10%;
          animation-delay: 0.6s;
        }

        @keyframes shapeReveal {
          0%, 100% { transform: scale(0.8); opacity: 0.4; }
          50% { transform: scale(1); opacity: 0.8; }
        }

        /* Section Headers */
        .section-header {
          text-align: center;
          margin-bottom: 4rem;
        }

        .section-header.light h2,
        .section-header.light .section-subtitle {
          color: white;
        }

        .section-header.light .section-tag {
          background: rgba(255, 255, 255, 0.1);
          color: rgba(255, 255, 255, 0.9);
        }

        .section-tag {
          display: inline-block;
          padding: 0.375rem 0.875rem;
          background: rgba(30, 74, 122, 0.1);
          color: var(--primary);
          font-size: 0.6875rem;
          font-weight: 600;
          text-transform: uppercase;
          letter-spacing: 0.15em;
          border-radius: 50px;
          margin-bottom: 1rem;
        }

        .section-header h2 {
          font-family: 'Space Grotesk', sans-serif;
          font-size: 2.5rem;
          font-weight: 700;
          color: var(--text);
          margin: 0;
        }

        .section-subtitle {
          margin-top: 1rem;
          font-size: 1.125rem;
          color: var(--text-secondary);
        }

        /* How It Works */
        .how-it-works {
          padding: 6rem 4rem;
          background: white;
        }

        .steps-container {
          display: flex;
          align-items: flex-start;
          justify-content: center;
          gap: 1rem;
        }

        .step {
          flex: 1;
          max-width: 280px;
          text-align: center;
          padding: 2rem 1.5rem;
        }

        .step-number {
          font-family: 'Space Grotesk', sans-serif;
          font-size: 3rem;
          font-weight: 700;
          color: rgba(30, 74, 122, 0.1);
          margin-bottom: 1rem;
        }

        .step-icon {
          width: 64px;
          height: 64px;
          margin: 0 auto 1.5rem;
          display: flex;
          align-items: center;
          justify-content: center;
          background: rgba(255, 107, 53, 0.1);
          border-radius: 16px;
          color: var(--accent);
        }

        .step h3 {
          font-family: 'Space Grotesk', sans-serif;
          font-size: 1.25rem;
          font-weight: 600;
          margin: 0 0 0.75rem;
          color: var(--text);
        }

        .step p {
          font-size: 0.9375rem;
          color: var(--text-secondary);
          line-height: 1.6;
          margin: 0;
        }

        .step-connector {
          width: 100px;
          padding-top: 5rem;
          color: var(--border);
        }

        /* Features */
        .features {
          padding: 6rem 4rem;
          background: var(--bg);
        }

        .features-grid {
          display: grid;
          grid-template-columns: repeat(3, 1fr);
          gap: 1.5rem;
          max-width: 1200px;
          margin: 0 auto;
        }

        .feature-card {
          background: white;
          padding: 2rem;
          border-radius: 12px;
          border: 1px solid var(--border);
          transition: all 0.3s;
        }

        .feature-card:hover {
          transform: translateY(-4px);
          box-shadow: 0 12px 40px rgba(0, 0, 0, 0.08);
        }

        .feature-highlight {
          grid-column: span 2;
          background: linear-gradient(135deg, var(--primary), var(--primary-light));
          color: white;
          border: none;
        }

        .feature-highlight .feature-icon {
          background: rgba(255, 255, 255, 0.2);
          color: white;
        }

        .feature-highlight h3 {
          color: white;
        }

        .feature-highlight p {
          color: rgba(255, 255, 255, 0.9);
        }

        .feature-icon {
          width: 56px;
          height: 56px;
          display: flex;
          align-items: center;
          justify-content: center;
          background: rgba(30, 74, 122, 0.1);
          border-radius: 12px;
          color: var(--primary);
          margin-bottom: 1.25rem;
        }

        .feature-card h3 {
          font-family: 'Space Grotesk', sans-serif;
          font-size: 1.125rem;
          font-weight: 600;
          margin: 0 0 0.5rem;
        }

        .feature-card p {
          font-size: 0.875rem;
          color: var(--text-secondary);
          line-height: 1.6;
          margin: 0;
        }

        .feature-example {
          margin-top: 1.5rem;
          padding: 0.875rem 1rem;
          background: rgba(255, 255, 255, 0.1);
          border-radius: 8px;
          font-size: 0.8125rem;
          font-style: italic;
          opacity: 0.9;
        }

        /* Unified Showcase Section */
        .unified-showcase {
          padding: 6rem 4rem;
          background: white;
        }

        .showcase-container {
          max-width: 900px;
          margin: 0 auto;
        }

        .showcase-card {
          background: linear-gradient(135deg, #f8fafc, #f1f5f9);
          border-radius: 24px;
          padding: 3rem;
          border: 1px solid var(--border);
          text-align: center;
        }

        .showcase-canvas {
          position: relative;
          height: 280px;
          margin-bottom: 2rem;
        }

        .canvas-preview {
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 240px;
          height: 160px;
          background: white;
          border-radius: 12px;
          border: 2px solid var(--border);
          box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08);
          overflow: hidden;
        }

        .canvas-grid {
          position: absolute;
          inset: 0;
          background-image:
            linear-gradient(rgba(30, 74, 122, 0.05) 1px, transparent 1px),
            linear-gradient(90deg, rgba(30, 74, 122, 0.05) 1px, transparent 1px);
          background-size: 20px 20px;
        }

        .canvas-surface {
          position: absolute;
          inset: 10px;
          background: #e8f4f8;
          border-radius: 4px;
        }

        .surface-court {
          position: absolute;
          top: 20%;
          left: 15%;
          width: 70%;
          height: 60%;
          border: 2px solid #00a6a3;
          border-radius: 4px;
          opacity: 0.8;
        }

        .surface-court::before {
          content: '';
          position: absolute;
          top: 50%;
          left: 0;
          right: 0;
          height: 2px;
          background: #00a6a3;
        }

        .surface-court::after {
          content: '';
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 20px;
          height: 20px;
          border: 2px solid #00a6a3;
          border-radius: 50%;
        }

        .surface-motif {
          position: absolute;
          bottom: 10%;
          right: 10%;
          width: 35px;
          height: 35px;
          background: var(--accent);
          border-radius: 50%;
          opacity: 0.8;
          animation: motifPulse 3s ease-in-out infinite;
        }

        @keyframes motifPulse {
          0%, 100% { transform: scale(1); opacity: 0.8; }
          50% { transform: scale(1.1); opacity: 1; }
        }

        .capability-pill {
          position: absolute;
          display: flex;
          align-items: center;
          gap: 0.5rem;
          padding: 0.625rem 1rem;
          background: white;
          border-radius: 50px;
          box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
          font-size: 0.8125rem;
          font-weight: 500;
          color: var(--text);
          animation: pillFloat 4s ease-in-out infinite;
        }

        .pill-courts {
          top: 10%;
          left: 5%;
          animation-delay: 0s;
        }

        .pill-courts svg {
          color: #00a6a3;
        }

        .pill-ai {
          top: 5%;
          right: 10%;
          animation-delay: 0.5s;
        }

        .pill-ai svg {
          color: var(--accent);
        }

        .pill-upload {
          bottom: 15%;
          left: 8%;
          animation-delay: 1s;
        }

        .pill-upload svg {
          color: var(--primary);
        }

        .pill-layers {
          bottom: 10%;
          right: 5%;
          animation-delay: 1.5s;
        }

        .pill-layers svg {
          color: #30D5C8;
        }

        @keyframes pillFloat {
          0%, 100% { transform: translateY(0); }
          50% { transform: translateY(-8px); }
        }

        .showcase-tagline {
          font-family: 'Space Grotesk', sans-serif;
          font-size: 1.5rem;
          font-weight: 600;
          color: var(--text);
          margin-bottom: 2rem;
        }

        .showcase-features {
          display: flex;
          justify-content: center;
          gap: 2rem;
          flex-wrap: wrap;
          margin-bottom: 2rem;
        }

        .showcase-feature {
          display: flex;
          align-items: center;
          gap: 0.625rem;
          font-size: 0.875rem;
          color: var(--text-secondary);
        }

        .feature-badge {
          padding: 0.25rem 0.625rem;
          border-radius: 50px;
          font-size: 0.625rem;
          font-weight: 700;
          letter-spacing: 0.05em;
        }

        .ai-badge {
          background: rgba(255, 107, 53, 0.1);
          color: var(--accent);
        }

        .template-badge {
          background: rgba(0, 166, 163, 0.1);
          color: #00a6a3;
        }

        .compose-badge {
          background: rgba(30, 74, 122, 0.1);
          color: var(--primary);
        }

        .showcase-cta {
          margin: 0 auto;
        }

        /* Unified Features Grid */
        .unified-features {
          grid-template-columns: repeat(3, 1fr);
        }

        /* Infinite symbol styling */
        .infinite-symbol {
          font-size: 3.5rem;
          line-height: 1;
        }

        /* Benefits Grid 4 columns */
        .benefits-grid-4 {
          grid-template-columns: repeat(4, 1fr);
        }

        /* Palette Section */
        .palette-section {
          padding: 6rem 4rem;
          background: var(--bg-dark);
        }

        .palette-grid {
          display: grid;
          grid-template-columns: repeat(7, 1fr);
          gap: 1rem;
          max-width: 1000px;
          margin: 0 auto;
        }

        .palette-swatch {
          animation: swatchReveal 0.5s ease-out forwards;
          animation-delay: var(--delay);
          opacity: 0;
          transform: translateY(20px);
        }

        @keyframes swatchReveal {
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        .swatch-color {
          aspect-ratio: 1;
          background: var(--swatch-color);
          border-radius: 8px;
          margin-bottom: 0.5rem;
          transition: transform 0.2s;
        }

        .palette-swatch:hover .swatch-color {
          transform: scale(1.1);
        }

        .swatch-info {
          text-align: center;
        }

        .swatch-name {
          display: block;
          font-size: 0.6875rem;
          font-weight: 500;
          color: white;
        }

        .swatch-code {
          display: block;
          font-size: 0.625rem;
          color: rgba(255, 255, 255, 0.5);
        }

        /* Benefits */
        .benefits {
          padding: 6rem 4rem;
          background: white;
        }

        .benefits-grid {
          display: grid;
          grid-template-columns: repeat(3, 1fr);
          gap: 3rem;
          max-width: 1000px;
          margin: 0 auto;
          text-align: center;
        }

        .benefit-metric {
          font-family: 'Space Grotesk', sans-serif;
          font-size: 4rem;
          font-weight: 700;
          color: var(--accent);
          line-height: 1;
        }

        .benefit-label {
          font-family: 'Space Grotesk', sans-serif;
          font-size: 1.125rem;
          font-weight: 600;
          color: var(--text);
          margin: 0.5rem 0 1rem;
        }

        .benefit p {
          font-size: 0.875rem;
          color: var(--text-secondary);
          line-height: 1.6;
          margin: 0;
        }

        /* CTA Footer */
        .cta-footer {
          padding: 6rem 4rem;
          background: var(--bg);
          text-align: center;
        }

        .cta-content h2 {
          font-family: 'Space Grotesk', sans-serif;
          font-size: 2.5rem;
          font-weight: 700;
          color: var(--text);
          margin: 0 0 1rem;
        }

        .cta-content > p {
          font-size: 1.125rem;
          color: var(--text-secondary);
          margin-bottom: 2rem;
        }

        .cta-note {
          margin-top: 1.5rem;
          font-size: 0.875rem;
          color: var(--text-light);
        }

        .cta-note a {
          color: var(--primary);
          text-decoration: none;
        }

        .cta-note a:hover {
          text-decoration: underline;
        }

        /* Modal */
        .modal-overlay {
          position: fixed;
          inset: 0;
          background: rgba(0, 0, 0, 0.5);
          backdrop-filter: blur(4px);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 2000;
          padding: 2rem;
        }

        .sign-in-modal {
          background: white;
          border-radius: 16px;
          padding: 2.5rem;
          width: 100%;
          max-width: 400px;
          position: relative;
          animation: modalSlide 0.3s ease-out;
        }

        @keyframes modalSlide {
          from {
            opacity: 0;
            transform: translateY(-20px);
          }
        }

        .modal-close {
          position: absolute;
          top: 1rem;
          right: 1rem;
          width: 32px;
          height: 32px;
          display: flex;
          align-items: center;
          justify-content: center;
          background: none;
          border: none;
          color: var(--text-light);
          cursor: pointer;
          border-radius: 6px;
          transition: all 0.2s;
        }

        .modal-close:hover {
          background: var(--bg);
          color: var(--text);
        }

        .modal-header {
          text-align: center;
          margin-bottom: 1.5rem;
        }

        .modal-header h2 {
          font-family: 'Space Grotesk', sans-serif;
          font-size: 1.5rem;
          font-weight: 600;
          margin: 0 0 0.25rem;
        }

        .modal-header p {
          font-size: 0.875rem;
          color: var(--text-secondary);
          margin: 0;
        }

        .form-error {
          padding: 0.75rem 1rem;
          background: #fef2f2;
          color: #dc2626;
          border-radius: 8px;
          font-size: 0.875rem;
          margin-bottom: 1rem;
        }

        .form-group {
          margin-bottom: 1rem;
        }

        .form-group label {
          display: block;
          font-size: 0.875rem;
          font-weight: 500;
          margin-bottom: 0.5rem;
        }

        .form-group input {
          width: 100%;
          padding: 0.75rem 1rem;
          border: 1px solid var(--border);
          border-radius: 8px;
          font-family: inherit;
          font-size: 0.9375rem;
          transition: all 0.2s;
        }

        .form-group input:focus {
          outline: none;
          border-color: var(--primary);
          box-shadow: 0 0 0 3px rgba(30, 74, 122, 0.1);
        }

        .submit-btn {
          width: 100%;
          padding: 0.875rem;
          background: var(--accent);
          color: white;
          border: none;
          border-radius: 8px;
          font-family: inherit;
          font-size: 0.9375rem;
          font-weight: 600;
          cursor: pointer;
          transition: all 0.2s;
        }

        .submit-btn:hover:not(:disabled) {
          background: var(--accent-hover);
        }

        .submit-btn:disabled {
          opacity: 0.6;
          cursor: not-allowed;
        }

        .modal-footer-text {
          text-align: center;
          font-size: 0.8125rem;
          color: var(--text-light);
          margin: 1.5rem 0 0;
        }

        /* Responsive */
        @media (max-width: 1024px) {
          .hero {
            grid-template-columns: 1fr;
            text-align: center;
          }

          .hero-content {
            max-width: 600px;
            margin: 0 auto;
          }

          .hero-subtitle {
            margin-left: auto;
            margin-right: auto;
          }

          .hero-ctas {
            justify-content: center;
          }

          .hero-visual {
            display: none;
          }

          .showcase-canvas {
            height: 240px;
          }

          .capability-pill {
            padding: 0.5rem 0.75rem;
            font-size: 0.75rem;
          }

          .features-grid {
            grid-template-columns: repeat(2, 1fr);
          }

          .unified-features {
            grid-template-columns: repeat(2, 1fr);
          }

          .feature-highlight {
            grid-column: span 2;
          }

          .benefits-grid-4 {
            grid-template-columns: repeat(2, 1fr);
          }

          .palette-grid {
            grid-template-columns: repeat(5, 1fr);
          }
        }

        @media (max-width: 768px) {
          .landing-nav {
            padding: 1rem 1.5rem;
          }

          .nav-links {
            gap: 1rem;
          }

          .hero {
            padding: 6rem 1.5rem 3rem;
          }

          .hero h1 {
            font-size: 2.5rem;
          }

          .steps-container {
            flex-direction: column;
            gap: 0;
          }

          .step-connector {
            display: none;
          }

          .features-grid,
          .unified-features {
            grid-template-columns: 1fr;
          }

          .feature-highlight {
            grid-column: span 1;
          }

          .section-header h2 {
            font-size: 2rem;
          }

          .how-it-works,
          .features,
          .palette-section,
          .benefits,
          .cta-footer,
          .unified-showcase {
            padding: 4rem 1.5rem;
          }

          .showcase-card {
            padding: 2rem 1.5rem;
          }

          .showcase-canvas {
            height: 200px;
          }

          .canvas-preview {
            width: 180px;
            height: 120px;
          }

          .capability-pill {
            display: none;
          }

          .showcase-features {
            flex-direction: column;
            gap: 1rem;
          }

          .showcase-tagline {
            font-size: 1.25rem;
          }

          .benefits-grid,
          .benefits-grid-4 {
            grid-template-columns: 1fr;
            gap: 2rem;
          }

          .palette-grid {
            grid-template-columns: repeat(4, 1fr);
          }
        }

        @media (max-width: 480px) {
          .nav-links button:not(.nav-cta) {
            display: none;
          }

          .hero h1 {
            font-size: 2rem;
          }

          .cta-content h2 {
            font-size: 1.75rem;
          }

          .palette-grid {
            grid-template-columns: repeat(3, 1fr);
          }
        }
      `})]})}function qH({user:t,onPasswordSet:e}){const[r,n]=P.useState(""),[i,s]=P.useState(""),[o,l]=P.useState(!1),[c,d]=P.useState(""),u=async f=>{if(f.preventDefault(),d(""),r.length<8){d("Password must be at least 8 characters long");return}if(!/[A-Z]/.test(r)){d("Password must contain at least one uppercase letter");return}if(!/[a-z]/.test(r)){d("Password must contain at least one lowercase letter");return}if(!/[0-9]/.test(r)){d("Password must contain at least one number");return}if(r!==i){d("Passwords do not match");return}l(!0);try{await Pn.updatePassword(r),e()}catch(h){d(h.message||"Failed to set password. Please try again.")}finally{l(!1)}};return a.jsx("div",{className:"tpv-studio",children:a.jsx("div",{className:"tpv-studio__container",style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh"},children:a.jsxs("div",{style:{maxWidth:"400px",width:"100%",padding:"2rem",background:"#fff",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[a.jsx("h2",{style:{marginBottom:"0.5rem",fontSize:"1.5rem"},children:"Welcome to TPV Studio"}),a.jsxs("p",{style:{marginBottom:"1.5rem",color:"#666",fontSize:"0.9rem"},children:["Please set a password for your account: ",a.jsx("strong",{children:t.email})]}),a.jsxs("form",{onSubmit:u,children:[a.jsxs("div",{style:{marginBottom:"1rem"},children:[a.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.9rem",fontWeight:"500"},children:"New Password"}),a.jsx("input",{type:"password",value:r,onChange:f=>n(f.target.value),placeholder:"Enter your password",required:!0,minLength:8,style:{width:"100%",padding:"0.75rem",border:"1px solid #ddd",borderRadius:"4px",fontSize:"1rem"}}),a.jsx("small",{style:{display:"block",marginTop:"0.25rem",color:"#666"},children:"At least 8 characters with uppercase, lowercase, and a number"})]}),a.jsxs("div",{style:{marginBottom:"1.5rem"},children:[a.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.9rem",fontWeight:"500"},children:"Confirm Password"}),a.jsx("input",{type:"password",value:i,onChange:f=>s(f.target.value),placeholder:"Confirm your password",required:!0,minLength:8,style:{width:"100%",padding:"0.75rem",border:"1px solid #ddd",borderRadius:"4px",fontSize:"1rem"}})]}),c&&a.jsx("div",{style:{padding:"0.75rem",marginBottom:"1rem",background:"#fee",border:"1px solid #fcc",borderRadius:"4px",color:"#c00",fontSize:"0.9rem"},children:c}),a.jsx("button",{type:"submit",disabled:o,style:{width:"100%",padding:"0.75rem",background:o?"#ccc":"#007bff",color:"#fff",border:"none",borderRadius:"4px",fontSize:"1rem",fontWeight:"500",cursor:o?"not-allowed":"pointer"},children:o?"Setting Password...":"Set Password"})]})]})})})}function YH(){const[t,e]=P.useState(null),[r,n]=P.useState(!0),[i,s]=P.useState(!1),[o,l]=P.useState(!1),[c,d]=P.useState(!1),[u,f]=P.useState(!1),[h,p]=P.useState(null),[g,m]=P.useState(null),x=async()=>{try{const w=await Pn.getSession();if(!(w!=null&&w.access_token)){d(!1);return}const k=await fetch("/api/admin/users",{headers:{Authorization:`Bearer ${w.access_token}`}});d(k.ok)}catch{console.error("[APP] Admin check failed"),d(!1)}},v=async w=>{try{console.log("[APP] Loading design from URL:",w);const{design:k}=await cl(w);if(k){y(k);const _=new URL(window.location);_.searchParams.delete("design"),window.history.replaceState({},"",_)}}catch(k){console.error("[APP] Failed to load design from URL:",k)}};P.useEffect(()=>{Pn.getSession().then(k=>{var C;const _=(k==null?void 0:k.user)||null;if(e(_),n(!1),_){const N=(C=_.user_metadata)==null?void 0:C.password_setup_complete;f(!N),x();const O=new URLSearchParams(window.location.search).get("design");O&&v(O)}});const{data:w}=Pn.onAuthStateChange((k,_)=>{var N;const C=(_==null?void 0:_.user)||null;if(e(C),C){const T=(N=C.user_metadata)==null?void 0:N.password_setup_complete;f(!T),x()}else d(!1),f(!1)});return()=>w==null?void 0:w.unsubscribe()},[]);const y=w=>{p(w),m(w.name)},b=async()=>{f(!1);const w=await Pn.getSession();e((w==null?void 0:w.user)||null)};return r?a.jsx("div",{className:"tpv-studio",children:a.jsx("div",{className:"tpv-studio__container",children:a.jsxs("div",{className:"tpv-studio__empty",children:[a.jsx("div",{className:"tpv-studio__spinner"}),a.jsx("p",{children:"Loading..."})]})})}):t?u?a.jsx(qH,{user:t,onPasswordSet:b}):o?a.jsx("div",{className:"tpv-studio",children:a.jsx(zH,{onClose:()=>l(!1)})}):a.jsx(hC,{children:a.jsxs("div",{className:"tpv-studio",children:[a.jsx(MH,{onShowDesigns:()=>s(!0),onShowAdmin:()=>l(!0),isAdmin:c,currentDesignName:g}),a.jsx("main",{className:"tpv-studio__container tpv-studio__container--full",children:a.jsx(AH,{loadedDesign:h})}),i&&a.jsx(LH,{onClose:()=>s(!1),onLoadDesign:y})]})}):a.jsx(VH,{})}qu.createRoot(document.getElementById("root")).render(a.jsx($.StrictMode,{children:a.jsx(YH,{})}))});export default XH();
//# sourceMappingURL=index-_uhNPj22.js.map
