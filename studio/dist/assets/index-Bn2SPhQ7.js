var C_=Object.defineProperty;var E_=(e,t,n)=>t in e?C_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var T_=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var km=(e,t,n)=>E_(e,typeof t!="symbol"?t+"":t,n);var z7=T_((Xn,Zn)=>{function N_(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in e)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(e,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var Mi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function gd(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function P_(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var i=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return e[r]}})}),n}var by={exports:{}},vd={},wy={exports:{}},ct={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gl=Symbol.for("react.element"),R_=Symbol.for("react.portal"),O_=Symbol.for("react.fragment"),A_=Symbol.for("react.strict_mode"),M_=Symbol.for("react.profiler"),$_=Symbol.for("react.provider"),L_=Symbol.for("react.context"),I_=Symbol.for("react.forward_ref"),D_=Symbol.for("react.suspense"),z_=Symbol.for("react.memo"),F_=Symbol.for("react.lazy"),jm=Symbol.iterator;function B_(e){return e===null||typeof e!="object"?null:(e=jm&&e[jm]||e["@@iterator"],typeof e=="function"?e:null)}var _y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Sy=Object.assign,ky={};function Wo(e,t,n){this.props=e,this.context=t,this.refs=ky,this.updater=n||_y}Wo.prototype.isReactComponent={};Wo.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Wo.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function jy(){}jy.prototype=Wo.prototype;function yp(e,t,n){this.props=e,this.context=t,this.refs=ky,this.updater=n||_y}var xp=yp.prototype=new jy;xp.constructor=yp;Sy(xp,Wo.prototype);xp.isPureReactComponent=!0;var Cm=Array.isArray,Cy=Object.prototype.hasOwnProperty,bp={current:null},Ey={key:!0,ref:!0,__self:!0,__source:!0};function Ty(e,t,n){var r,i={},s=null,a=null;if(t!=null)for(r in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(s=""+t.key),t)Cy.call(t,r)&&!Ey.hasOwnProperty(r)&&(i[r]=t[r]);var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];i.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:gl,type:e,key:s,ref:a,props:i,_owner:bp.current}}function H_(e,t){return{$$typeof:gl,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function wp(e){return typeof e=="object"&&e!==null&&e.$$typeof===gl}function U_(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Em=/\/+/g;function Qd(e,t){return typeof e=="object"&&e!==null&&e.key!=null?U_(""+e.key):t.toString(36)}function mc(e,t,n,r,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case gl:case R_:a=!0}}if(a)return a=e,i=i(a),e=r===""?"."+Qd(a,0):r,Cm(i)?(n="",e!=null&&(n=e.replace(Em,"$&/")+"/"),mc(i,t,n,"",function(d){return d})):i!=null&&(wp(i)&&(i=H_(i,n+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(Em,"$&/")+"/")+e)),t.push(i)),1;if(a=0,r=r===""?".":r+":",Cm(e))for(var l=0;l<e.length;l++){s=e[l];var c=r+Qd(s,l);a+=mc(s,t,n,c,i)}else if(c=B_(e),typeof c=="function")for(e=c.call(e),l=0;!(s=e.next()).done;)s=s.value,c=r+Qd(s,l++),a+=mc(s,t,n,c,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function Ml(e,t,n){if(e==null)return e;var r=[],i=0;return mc(e,r,"","",function(s){return t.call(n,s,i++)}),r}function W_(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Cn={current:null},gc={transition:null},G_={ReactCurrentDispatcher:Cn,ReactCurrentBatchConfig:gc,ReactCurrentOwner:bp};function Ny(){throw Error("act(...) is not supported in production builds of React.")}ct.Children={map:Ml,forEach:function(e,t,n){Ml(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Ml(e,function(){t++}),t},toArray:function(e){return Ml(e,function(t){return t})||[]},only:function(e){if(!wp(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ct.Component=Wo;ct.Fragment=O_;ct.Profiler=M_;ct.PureComponent=yp;ct.StrictMode=A_;ct.Suspense=D_;ct.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=G_;ct.act=Ny;ct.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Sy({},e.props),i=e.key,s=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,a=bp.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)Cy.call(t,c)&&!Ey.hasOwnProperty(c)&&(r[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:gl,type:e.type,key:i,ref:s,props:r,_owner:a}};ct.createContext=function(e){return e={$$typeof:L_,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:$_,_context:e},e.Consumer=e};ct.createElement=Ty;ct.createFactory=function(e){var t=Ty.bind(null,e);return t.type=e,t};ct.createRef=function(){return{current:null}};ct.forwardRef=function(e){return{$$typeof:I_,render:e}};ct.isValidElement=wp;ct.lazy=function(e){return{$$typeof:F_,_payload:{_status:-1,_result:e},_init:W_}};ct.memo=function(e,t){return{$$typeof:z_,type:e,compare:t===void 0?null:t}};ct.startTransition=function(e){var t=gc.transition;gc.transition={};try{e()}finally{gc.transition=t}};ct.unstable_act=Ny;ct.useCallback=function(e,t){return Cn.current.useCallback(e,t)};ct.useContext=function(e){return Cn.current.useContext(e)};ct.useDebugValue=function(){};ct.useDeferredValue=function(e){return Cn.current.useDeferredValue(e)};ct.useEffect=function(e,t){return Cn.current.useEffect(e,t)};ct.useId=function(){return Cn.current.useId()};ct.useImperativeHandle=function(e,t,n){return Cn.current.useImperativeHandle(e,t,n)};ct.useInsertionEffect=function(e,t){return Cn.current.useInsertionEffect(e,t)};ct.useLayoutEffect=function(e,t){return Cn.current.useLayoutEffect(e,t)};ct.useMemo=function(e,t){return Cn.current.useMemo(e,t)};ct.useReducer=function(e,t,n){return Cn.current.useReducer(e,t,n)};ct.useRef=function(e){return Cn.current.useRef(e)};ct.useState=function(e){return Cn.current.useState(e)};ct.useSyncExternalStore=function(e,t,n){return Cn.current.useSyncExternalStore(e,t,n)};ct.useTransition=function(){return Cn.current.useTransition()};ct.version="18.3.1";wy.exports=ct;var R=wy.exports;const L=gd(R);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var V_=R,q_=Symbol.for("react.element"),Y_=Symbol.for("react.fragment"),X_=Object.prototype.hasOwnProperty,Z_=V_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,K_={key:!0,ref:!0,__self:!0,__source:!0};function Py(e,t,n){var r,i={},s=null,a=null;n!==void 0&&(s=""+n),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(a=t.ref);for(r in t)X_.call(t,r)&&!K_.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)i[r]===void 0&&(i[r]=t[r]);return{$$typeof:q_,type:e,key:s,ref:a,props:i,_owner:Z_.current}}vd.Fragment=Y_;vd.jsx=Py;vd.jsxs=Py;by.exports=vd;var o=by.exports,Qu={},Ry={exports:{}},er={},Oy={exports:{}},Ay={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(K,H){var X=K.length;K.push(H);e:for(;0<X;){var F=X-1>>>1,W=K[F];if(0<i(W,H))K[F]=H,K[X]=W,X=F;else break e}}function n(K){return K.length===0?null:K[0]}function r(K){if(K.length===0)return null;var H=K[0],X=K.pop();if(X!==H){K[0]=X;e:for(var F=0,W=K.length,re=W>>>1;F<re;){var se=2*(F+1)-1,me=K[se],ke=se+1,pe=K[ke];if(0>i(me,X))ke<W&&0>i(pe,me)?(K[F]=pe,K[ke]=X,F=ke):(K[F]=me,K[se]=X,F=se);else if(ke<W&&0>i(pe,X))K[F]=pe,K[ke]=X,F=ke;else break e}}return H}function i(K,H){var X=K.sortIndex-H.sortIndex;return X!==0?X:K.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var a=Date,l=a.now();e.unstable_now=function(){return a.now()-l}}var c=[],d=[],u=1,p=null,h=3,f=!1,m=!1,g=!1,x=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(K){for(var H=n(d);H!==null;){if(H.callback===null)r(d);else if(H.startTime<=K)r(d),H.sortIndex=H.expirationTime,t(c,H);else break;H=n(d)}}function w(K){if(g=!1,b(K),!m)if(n(c)!==null)m=!0,he(C);else{var H=n(d);H!==null&&Z(w,H.startTime-K)}}function C(K,H){m=!1,g&&(g=!1,y(E),E=-1),f=!0;var X=h;try{for(b(H),p=n(c);p!==null&&(!(p.expirationTime>H)||K&&!J());){var F=p.callback;if(typeof F=="function"){p.callback=null,h=p.priorityLevel;var W=F(p.expirationTime<=H);H=e.unstable_now(),typeof W=="function"?p.callback=W:p===n(c)&&r(c),b(H)}else r(c);p=n(c)}if(p!==null)var re=!0;else{var se=n(d);se!==null&&Z(w,se.startTime-H),re=!1}return re}finally{p=null,h=X,f=!1}}var _=!1,j=null,E=-1,T=5,M=-1;function J(){return!(e.unstable_now()-M<T)}function P(){if(j!==null){var K=e.unstable_now();M=K;var H=!0;try{H=j(!0,K)}finally{H?q():(_=!1,j=null)}}else _=!1}var q;if(typeof v=="function")q=function(){v(P)};else if(typeof MessageChannel<"u"){var k=new MessageChannel,z=k.port2;k.port1.onmessage=P,q=function(){z.postMessage(null)}}else q=function(){x(P,0)};function he(K){j=K,_||(_=!0,q())}function Z(K,H){E=x(function(){K(e.unstable_now())},H)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(K){K.callback=null},e.unstable_continueExecution=function(){m||f||(m=!0,he(C))},e.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<K?Math.floor(1e3/K):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(K){switch(h){case 1:case 2:case 3:var H=3;break;default:H=h}var X=h;h=H;try{return K()}finally{h=X}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(K,H){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var X=h;h=K;try{return H()}finally{h=X}},e.unstable_scheduleCallback=function(K,H,X){var F=e.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?F+X:F):X=F,K){case 1:var W=-1;break;case 2:W=250;break;case 5:W=1073741823;break;case 4:W=1e4;break;default:W=5e3}return W=X+W,K={id:u++,callback:H,priorityLevel:K,startTime:X,expirationTime:W,sortIndex:-1},X>F?(K.sortIndex=X,t(d,K),n(c)===null&&K===n(d)&&(g?(y(E),E=-1):g=!0,Z(w,X-F))):(K.sortIndex=W,t(c,K),m||f||(m=!0,he(C))),K},e.unstable_shouldYield=J,e.unstable_wrapCallback=function(K){var H=h;return function(){var X=h;h=H;try{return K.apply(this,arguments)}finally{h=X}}}})(Ay);Oy.exports=Ay;var J_=Oy.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Q_=R,Jn=J_;function Ee(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var My=new Set,qa={};function Rs(e,t){Lo(e,t),Lo(e+"Capture",t)}function Lo(e,t){for(qa[e]=t,e=0;e<t.length;e++)My.add(t[e])}var li=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),eh=Object.prototype.hasOwnProperty,e2=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Tm={},Nm={};function t2(e){return eh.call(Nm,e)?!0:eh.call(Tm,e)?!1:e2.test(e)?Nm[e]=!0:(Tm[e]=!0,!1)}function n2(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function r2(e,t,n,r){if(t===null||typeof t>"u"||n2(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function En(e,t,n,r,i,s,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=a}var un={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){un[e]=new En(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];un[t]=new En(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){un[e]=new En(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){un[e]=new En(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){un[e]=new En(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){un[e]=new En(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){un[e]=new En(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){un[e]=new En(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){un[e]=new En(e,5,!1,e.toLowerCase(),null,!1,!1)});var _p=/[\-:]([a-z])/g;function Sp(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(_p,Sp);un[t]=new En(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(_p,Sp);un[t]=new En(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(_p,Sp);un[t]=new En(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){un[e]=new En(e,1,!1,e.toLowerCase(),null,!1,!1)});un.xlinkHref=new En("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){un[e]=new En(e,1,!1,e.toLowerCase(),null,!0,!0)});function kp(e,t,n,r){var i=un.hasOwnProperty(t)?un[t]:null;(i!==null?i.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(r2(t,n,i,r)&&(n=null),r||i===null?t2(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=n===null?i.type===3?!1:"":n:(t=i.attributeName,r=i.attributeNamespace,n===null?e.removeAttribute(t):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var hi=Q_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,$l=Symbol.for("react.element"),mo=Symbol.for("react.portal"),go=Symbol.for("react.fragment"),jp=Symbol.for("react.strict_mode"),th=Symbol.for("react.profiler"),$y=Symbol.for("react.provider"),Ly=Symbol.for("react.context"),Cp=Symbol.for("react.forward_ref"),nh=Symbol.for("react.suspense"),rh=Symbol.for("react.suspense_list"),Ep=Symbol.for("react.memo"),Ei=Symbol.for("react.lazy"),Iy=Symbol.for("react.offscreen"),Pm=Symbol.iterator;function ha(e){return e===null||typeof e!="object"?null:(e=Pm&&e[Pm]||e["@@iterator"],typeof e=="function"?e:null)}var Bt=Object.assign,eu;function Ca(e){if(eu===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);eu=t&&t[1]||""}return`
`+eu+e}var tu=!1;function nu(e,t){if(!e||tu)return"";tu=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var r=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){r=d}e.call(t.prototype)}else{try{throw Error()}catch(d){r=d}e()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var i=d.stack.split(`
`),s=r.stack.split(`
`),a=i.length-1,l=s.length-1;1<=a&&0<=l&&i[a]!==s[l];)l--;for(;1<=a&&0<=l;a--,l--)if(i[a]!==s[l]){if(a!==1||l!==1)do if(a--,l--,0>l||i[a]!==s[l]){var c=`
`+i[a].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=a&&0<=l);break}}}finally{tu=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Ca(e):""}function i2(e){switch(e.tag){case 5:return Ca(e.type);case 16:return Ca("Lazy");case 13:return Ca("Suspense");case 19:return Ca("SuspenseList");case 0:case 2:case 15:return e=nu(e.type,!1),e;case 11:return e=nu(e.type.render,!1),e;case 1:return e=nu(e.type,!0),e;default:return""}}function ih(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case go:return"Fragment";case mo:return"Portal";case th:return"Profiler";case jp:return"StrictMode";case nh:return"Suspense";case rh:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Ly:return(e.displayName||"Context")+".Consumer";case $y:return(e._context.displayName||"Context")+".Provider";case Cp:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Ep:return t=e.displayName||null,t!==null?t:ih(e.type)||"Memo";case Ei:t=e._payload,e=e._init;try{return ih(e(t))}catch{}}return null}function s2(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ih(t);case 8:return t===jp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Gi(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Dy(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function o2(e){var t=Dy(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(a){r=""+a,s.call(this,a)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ll(e){e._valueTracker||(e._valueTracker=o2(e))}function zy(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=Dy(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Tc(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function sh(e,t){var n=t.checked;return Bt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Rm(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Gi(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Fy(e,t){t=t.checked,t!=null&&kp(e,"checked",t,!1)}function oh(e,t){Fy(e,t);var n=Gi(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?ah(e,t.type,n):t.hasOwnProperty("defaultValue")&&ah(e,t.type,Gi(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Om(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function ah(e,t,n){(t!=="number"||Tc(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Ea=Array.isArray;function To(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Gi(n),t=null,i=0;i<e.length;i++){if(e[i].value===n){e[i].selected=!0,r&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function lh(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Ee(91));return Bt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Am(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(Ee(92));if(Ea(n)){if(1<n.length)throw Error(Ee(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Gi(n)}}function By(e,t){var n=Gi(t.value),r=Gi(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function Mm(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Hy(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ch(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Hy(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Il,Uy=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Il=Il||document.createElement("div"),Il.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Il.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Ya(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Ma={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},a2=["Webkit","ms","Moz","O"];Object.keys(Ma).forEach(function(e){a2.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Ma[t]=Ma[e]})});function Wy(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Ma.hasOwnProperty(e)&&Ma[e]?(""+t).trim():t+"px"}function Gy(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=Wy(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}var l2=Bt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function dh(e,t){if(t){if(l2[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Ee(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Ee(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Ee(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Ee(62))}}function uh(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var hh=null;function Tp(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ph=null,No=null,Po=null;function $m(e){if(e=xl(e)){if(typeof ph!="function")throw Error(Ee(280));var t=e.stateNode;t&&(t=_d(t),ph(e.stateNode,e.type,t))}}function Vy(e){No?Po?Po.push(e):Po=[e]:No=e}function qy(){if(No){var e=No,t=Po;if(Po=No=null,$m(e),t)for(e=0;e<t.length;e++)$m(t[e])}}function Yy(e,t){return e(t)}function Xy(){}var ru=!1;function Zy(e,t,n){if(ru)return e(t,n);ru=!0;try{return Yy(e,t,n)}finally{ru=!1,(No!==null||Po!==null)&&(Xy(),qy())}}function Xa(e,t){var n=e.stateNode;if(n===null)return null;var r=_d(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(Ee(231,t,typeof n));return n}var fh=!1;if(li)try{var pa={};Object.defineProperty(pa,"passive",{get:function(){fh=!0}}),window.addEventListener("test",pa,pa),window.removeEventListener("test",pa,pa)}catch{fh=!1}function c2(e,t,n,r,i,s,a,l,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(n,d)}catch(u){this.onError(u)}}var $a=!1,Nc=null,Pc=!1,mh=null,d2={onError:function(e){$a=!0,Nc=e}};function u2(e,t,n,r,i,s,a,l,c){$a=!1,Nc=null,c2.apply(d2,arguments)}function h2(e,t,n,r,i,s,a,l,c){if(u2.apply(this,arguments),$a){if($a){var d=Nc;$a=!1,Nc=null}else throw Error(Ee(198));Pc||(Pc=!0,mh=d)}}function Os(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Ky(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Lm(e){if(Os(e)!==e)throw Error(Ee(188))}function p2(e){var t=e.alternate;if(!t){if(t=Os(e),t===null)throw Error(Ee(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Lm(i),e;if(s===r)return Lm(i),t;s=s.sibling}throw Error(Ee(188))}if(n.return!==r.return)n=i,r=s;else{for(var a=!1,l=i.child;l;){if(l===n){a=!0,n=i,r=s;break}if(l===r){a=!0,r=i,n=s;break}l=l.sibling}if(!a){for(l=s.child;l;){if(l===n){a=!0,n=s,r=i;break}if(l===r){a=!0,r=s,n=i;break}l=l.sibling}if(!a)throw Error(Ee(189))}}if(n.alternate!==r)throw Error(Ee(190))}if(n.tag!==3)throw Error(Ee(188));return n.stateNode.current===n?e:t}function Jy(e){return e=p2(e),e!==null?Qy(e):null}function Qy(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Qy(e);if(t!==null)return t;e=e.sibling}return null}var ex=Jn.unstable_scheduleCallback,Im=Jn.unstable_cancelCallback,f2=Jn.unstable_shouldYield,m2=Jn.unstable_requestPaint,Ut=Jn.unstable_now,g2=Jn.unstable_getCurrentPriorityLevel,Np=Jn.unstable_ImmediatePriority,tx=Jn.unstable_UserBlockingPriority,Rc=Jn.unstable_NormalPriority,v2=Jn.unstable_LowPriority,nx=Jn.unstable_IdlePriority,yd=null,Ur=null;function y2(e){if(Ur&&typeof Ur.onCommitFiberRoot=="function")try{Ur.onCommitFiberRoot(yd,e,void 0,(e.current.flags&128)===128)}catch{}}var jr=Math.clz32?Math.clz32:w2,x2=Math.log,b2=Math.LN2;function w2(e){return e>>>=0,e===0?32:31-(x2(e)/b2|0)|0}var Dl=64,zl=4194304;function Ta(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Oc(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,i=e.suspendedLanes,s=e.pingedLanes,a=n&268435455;if(a!==0){var l=a&~i;l!==0?r=Ta(l):(s&=a,s!==0&&(r=Ta(s)))}else a=n&~i,a!==0?r=Ta(a):s!==0&&(r=Ta(s));if(r===0)return 0;if(t!==0&&t!==r&&!(t&i)&&(i=r&-r,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-jr(t),i=1<<n,r|=e[n],t&=~i;return r}function _2(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function S2(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var a=31-jr(s),l=1<<a,c=i[a];c===-1?(!(l&n)||l&r)&&(i[a]=_2(l,t)):c<=t&&(e.expiredLanes|=l),s&=~l}}function gh(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function rx(){var e=Dl;return Dl<<=1,!(Dl&4194240)&&(Dl=64),e}function iu(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vl(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-jr(t),e[t]=n}function k2(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-jr(n),s=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~s}}function Pp(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-jr(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var xt=0;function ix(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var sx,Rp,ox,ax,lx,vh=!1,Fl=[],Ii=null,Di=null,zi=null,Za=new Map,Ka=new Map,Pi=[],j2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Dm(e,t){switch(e){case"focusin":case"focusout":Ii=null;break;case"dragenter":case"dragleave":Di=null;break;case"mouseover":case"mouseout":zi=null;break;case"pointerover":case"pointerout":Za.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ka.delete(t.pointerId)}}function fa(e,t,n,r,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},t!==null&&(t=xl(t),t!==null&&Rp(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function C2(e,t,n,r,i){switch(t){case"focusin":return Ii=fa(Ii,e,t,n,r,i),!0;case"dragenter":return Di=fa(Di,e,t,n,r,i),!0;case"mouseover":return zi=fa(zi,e,t,n,r,i),!0;case"pointerover":var s=i.pointerId;return Za.set(s,fa(Za.get(s)||null,e,t,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Ka.set(s,fa(Ka.get(s)||null,e,t,n,r,i)),!0}return!1}function cx(e){var t=ys(e.target);if(t!==null){var n=Os(t);if(n!==null){if(t=n.tag,t===13){if(t=Ky(n),t!==null){e.blockedOn=t,lx(e.priority,function(){ox(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function vc(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=yh(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);hh=r,n.target.dispatchEvent(r),hh=null}else return t=xl(n),t!==null&&Rp(t),e.blockedOn=n,!1;t.shift()}return!0}function zm(e,t,n){vc(e)&&n.delete(t)}function E2(){vh=!1,Ii!==null&&vc(Ii)&&(Ii=null),Di!==null&&vc(Di)&&(Di=null),zi!==null&&vc(zi)&&(zi=null),Za.forEach(zm),Ka.forEach(zm)}function ma(e,t){e.blockedOn===t&&(e.blockedOn=null,vh||(vh=!0,Jn.unstable_scheduleCallback(Jn.unstable_NormalPriority,E2)))}function Ja(e){function t(i){return ma(i,e)}if(0<Fl.length){ma(Fl[0],e);for(var n=1;n<Fl.length;n++){var r=Fl[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Ii!==null&&ma(Ii,e),Di!==null&&ma(Di,e),zi!==null&&ma(zi,e),Za.forEach(t),Ka.forEach(t),n=0;n<Pi.length;n++)r=Pi[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Pi.length&&(n=Pi[0],n.blockedOn===null);)cx(n),n.blockedOn===null&&Pi.shift()}var Ro=hi.ReactCurrentBatchConfig,Ac=!0;function T2(e,t,n,r){var i=xt,s=Ro.transition;Ro.transition=null;try{xt=1,Op(e,t,n,r)}finally{xt=i,Ro.transition=s}}function N2(e,t,n,r){var i=xt,s=Ro.transition;Ro.transition=null;try{xt=4,Op(e,t,n,r)}finally{xt=i,Ro.transition=s}}function Op(e,t,n,r){if(Ac){var i=yh(e,t,n,r);if(i===null)fu(e,t,r,Mc,n),Dm(e,r);else if(C2(i,e,t,n,r))r.stopPropagation();else if(Dm(e,r),t&4&&-1<j2.indexOf(e)){for(;i!==null;){var s=xl(i);if(s!==null&&sx(s),s=yh(e,t,n,r),s===null&&fu(e,t,r,Mc,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else fu(e,t,r,null,n)}}var Mc=null;function yh(e,t,n,r){if(Mc=null,e=Tp(r),e=ys(e),e!==null)if(t=Os(e),t===null)e=null;else if(n=t.tag,n===13){if(e=Ky(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Mc=e,null}function dx(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(g2()){case Np:return 1;case tx:return 4;case Rc:case v2:return 16;case nx:return 536870912;default:return 16}default:return 16}}var $i=null,Ap=null,yc=null;function ux(){if(yc)return yc;var e,t=Ap,n=t.length,r,i="value"in $i?$i.value:$i.textContent,s=i.length;for(e=0;e<n&&t[e]===i[e];e++);var a=n-e;for(r=1;r<=a&&t[n-r]===i[s-r];r++);return yc=i.slice(e,1<r?1-r:void 0)}function xc(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Bl(){return!0}function Fm(){return!1}function tr(e){function t(n,r,i,s,a){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(n=e[l],this[l]=n?n(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Bl:Fm,this.isPropagationStopped=Fm,this}return Bt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Bl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Bl)},persist:function(){},isPersistent:Bl}),t}var Go={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Mp=tr(Go),yl=Bt({},Go,{view:0,detail:0}),P2=tr(yl),su,ou,ga,xd=Bt({},yl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:$p,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ga&&(ga&&e.type==="mousemove"?(su=e.screenX-ga.screenX,ou=e.screenY-ga.screenY):ou=su=0,ga=e),su)},movementY:function(e){return"movementY"in e?e.movementY:ou}}),Bm=tr(xd),R2=Bt({},xd,{dataTransfer:0}),O2=tr(R2),A2=Bt({},yl,{relatedTarget:0}),au=tr(A2),M2=Bt({},Go,{animationName:0,elapsedTime:0,pseudoElement:0}),$2=tr(M2),L2=Bt({},Go,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),I2=tr(L2),D2=Bt({},Go,{data:0}),Hm=tr(D2),z2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},F2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},B2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function H2(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=B2[e])?!!t[e]:!1}function $p(){return H2}var U2=Bt({},yl,{key:function(e){if(e.key){var t=z2[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=xc(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?F2[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:$p,charCode:function(e){return e.type==="keypress"?xc(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?xc(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),W2=tr(U2),G2=Bt({},xd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Um=tr(G2),V2=Bt({},yl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:$p}),q2=tr(V2),Y2=Bt({},Go,{propertyName:0,elapsedTime:0,pseudoElement:0}),X2=tr(Y2),Z2=Bt({},xd,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),K2=tr(Z2),J2=[9,13,27,32],Lp=li&&"CompositionEvent"in window,La=null;li&&"documentMode"in document&&(La=document.documentMode);var Q2=li&&"TextEvent"in window&&!La,hx=li&&(!Lp||La&&8<La&&11>=La),Wm=" ",Gm=!1;function px(e,t){switch(e){case"keyup":return J2.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function fx(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var vo=!1;function eS(e,t){switch(e){case"compositionend":return fx(t);case"keypress":return t.which!==32?null:(Gm=!0,Wm);case"textInput":return e=t.data,e===Wm&&Gm?null:e;default:return null}}function tS(e,t){if(vo)return e==="compositionend"||!Lp&&px(e,t)?(e=ux(),yc=Ap=$i=null,vo=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return hx&&t.locale!=="ko"?null:t.data;default:return null}}var nS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vm(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!nS[e.type]:t==="textarea"}function mx(e,t,n,r){Vy(r),t=$c(t,"onChange"),0<t.length&&(n=new Mp("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Ia=null,Qa=null;function rS(e){Cx(e,0)}function bd(e){var t=bo(e);if(zy(t))return e}function iS(e,t){if(e==="change")return t}var gx=!1;if(li){var lu;if(li){var cu="oninput"in document;if(!cu){var qm=document.createElement("div");qm.setAttribute("oninput","return;"),cu=typeof qm.oninput=="function"}lu=cu}else lu=!1;gx=lu&&(!document.documentMode||9<document.documentMode)}function Ym(){Ia&&(Ia.detachEvent("onpropertychange",vx),Qa=Ia=null)}function vx(e){if(e.propertyName==="value"&&bd(Qa)){var t=[];mx(t,Qa,e,Tp(e)),Zy(rS,t)}}function sS(e,t,n){e==="focusin"?(Ym(),Ia=t,Qa=n,Ia.attachEvent("onpropertychange",vx)):e==="focusout"&&Ym()}function oS(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return bd(Qa)}function aS(e,t){if(e==="click")return bd(t)}function lS(e,t){if(e==="input"||e==="change")return bd(t)}function cS(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Er=typeof Object.is=="function"?Object.is:cS;function el(e,t){if(Er(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!eh.call(t,i)||!Er(e[i],t[i]))return!1}return!0}function Xm(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Zm(e,t){var n=Xm(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Xm(n)}}function yx(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?yx(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function xx(){for(var e=window,t=Tc();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Tc(e.document)}return t}function Ip(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function dS(e){var t=xx(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&yx(n.ownerDocument.documentElement,n)){if(r!==null&&Ip(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!e.extend&&s>r&&(i=r,r=s,s=i),i=Zm(n,s);var a=Zm(n,r);i&&a&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var uS=li&&"documentMode"in document&&11>=document.documentMode,yo=null,xh=null,Da=null,bh=!1;function Km(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;bh||yo==null||yo!==Tc(r)||(r=yo,"selectionStart"in r&&Ip(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Da&&el(Da,r)||(Da=r,r=$c(xh,"onSelect"),0<r.length&&(t=new Mp("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=yo)))}function Hl(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var xo={animationend:Hl("Animation","AnimationEnd"),animationiteration:Hl("Animation","AnimationIteration"),animationstart:Hl("Animation","AnimationStart"),transitionend:Hl("Transition","TransitionEnd")},du={},bx={};li&&(bx=document.createElement("div").style,"AnimationEvent"in window||(delete xo.animationend.animation,delete xo.animationiteration.animation,delete xo.animationstart.animation),"TransitionEvent"in window||delete xo.transitionend.transition);function wd(e){if(du[e])return du[e];if(!xo[e])return e;var t=xo[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in bx)return du[e]=t[n];return e}var wx=wd("animationend"),_x=wd("animationiteration"),Sx=wd("animationstart"),kx=wd("transitionend"),jx=new Map,Jm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Xi(e,t){jx.set(e,t),Rs(t,[e])}for(var uu=0;uu<Jm.length;uu++){var hu=Jm[uu],hS=hu.toLowerCase(),pS=hu[0].toUpperCase()+hu.slice(1);Xi(hS,"on"+pS)}Xi(wx,"onAnimationEnd");Xi(_x,"onAnimationIteration");Xi(Sx,"onAnimationStart");Xi("dblclick","onDoubleClick");Xi("focusin","onFocus");Xi("focusout","onBlur");Xi(kx,"onTransitionEnd");Lo("onMouseEnter",["mouseout","mouseover"]);Lo("onMouseLeave",["mouseout","mouseover"]);Lo("onPointerEnter",["pointerout","pointerover"]);Lo("onPointerLeave",["pointerout","pointerover"]);Rs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Rs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Rs("onBeforeInput",["compositionend","keypress","textInput","paste"]);Rs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Rs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Rs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Na="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),fS=new Set("cancel close invalid load scroll toggle".split(" ").concat(Na));function Qm(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,h2(r,t,void 0,e),e.currentTarget=null}function Cx(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var a=r.length-1;0<=a;a--){var l=r[a],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==s&&i.isPropagationStopped())break e;Qm(i,l,d),s=c}else for(a=0;a<r.length;a++){if(l=r[a],c=l.instance,d=l.currentTarget,l=l.listener,c!==s&&i.isPropagationStopped())break e;Qm(i,l,d),s=c}}}if(Pc)throw e=mh,Pc=!1,mh=null,e}function Rt(e,t){var n=t[jh];n===void 0&&(n=t[jh]=new Set);var r=e+"__bubble";n.has(r)||(Ex(t,e,2,!1),n.add(r))}function pu(e,t,n){var r=0;t&&(r|=4),Ex(n,e,r,t)}var Ul="_reactListening"+Math.random().toString(36).slice(2);function tl(e){if(!e[Ul]){e[Ul]=!0,My.forEach(function(n){n!=="selectionchange"&&(fS.has(n)||pu(n,!1,e),pu(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ul]||(t[Ul]=!0,pu("selectionchange",!1,t))}}function Ex(e,t,n,r){switch(dx(t)){case 1:var i=T2;break;case 4:i=N2;break;default:i=Op}n=i.bind(null,t,n,e),i=void 0,!fh||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),r?i!==void 0?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):i!==void 0?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function fu(e,t,n,r,i){var s=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(a===4)for(a=r.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;a=a.return}for(;l!==null;){if(a=ys(l),a===null)return;if(c=a.tag,c===5||c===6){r=s=a;continue e}l=l.parentNode}}r=r.return}Zy(function(){var d=s,u=Tp(n),p=[];e:{var h=jx.get(e);if(h!==void 0){var f=Mp,m=e;switch(e){case"keypress":if(xc(n)===0)break e;case"keydown":case"keyup":f=W2;break;case"focusin":m="focus",f=au;break;case"focusout":m="blur",f=au;break;case"beforeblur":case"afterblur":f=au;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=Bm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=O2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=q2;break;case wx:case _x:case Sx:f=$2;break;case kx:f=X2;break;case"scroll":f=P2;break;case"wheel":f=K2;break;case"copy":case"cut":case"paste":f=I2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=Um}var g=(t&4)!==0,x=!g&&e==="scroll",y=g?h!==null?h+"Capture":null:h;g=[];for(var v=d,b;v!==null;){b=v;var w=b.stateNode;if(b.tag===5&&w!==null&&(b=w,y!==null&&(w=Xa(v,y),w!=null&&g.push(nl(v,w,b)))),x)break;v=v.return}0<g.length&&(h=new f(h,m,null,n,u),p.push({event:h,listeners:g}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",f=e==="mouseout"||e==="pointerout",h&&n!==hh&&(m=n.relatedTarget||n.fromElement)&&(ys(m)||m[ci]))break e;if((f||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,f?(m=n.relatedTarget||n.toElement,f=d,m=m?ys(m):null,m!==null&&(x=Os(m),m!==x||m.tag!==5&&m.tag!==6)&&(m=null)):(f=null,m=d),f!==m)){if(g=Bm,w="onMouseLeave",y="onMouseEnter",v="mouse",(e==="pointerout"||e==="pointerover")&&(g=Um,w="onPointerLeave",y="onPointerEnter",v="pointer"),x=f==null?h:bo(f),b=m==null?h:bo(m),h=new g(w,v+"leave",f,n,u),h.target=x,h.relatedTarget=b,w=null,ys(u)===d&&(g=new g(y,v+"enter",m,n,u),g.target=b,g.relatedTarget=x,w=g),x=w,f&&m)t:{for(g=f,y=m,v=0,b=g;b;b=Us(b))v++;for(b=0,w=y;w;w=Us(w))b++;for(;0<v-b;)g=Us(g),v--;for(;0<b-v;)y=Us(y),b--;for(;v--;){if(g===y||y!==null&&g===y.alternate)break t;g=Us(g),y=Us(y)}g=null}else g=null;f!==null&&eg(p,h,f,g,!1),m!==null&&x!==null&&eg(p,x,m,g,!0)}}e:{if(h=d?bo(d):window,f=h.nodeName&&h.nodeName.toLowerCase(),f==="select"||f==="input"&&h.type==="file")var C=iS;else if(Vm(h))if(gx)C=lS;else{C=oS;var _=sS}else(f=h.nodeName)&&f.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(C=aS);if(C&&(C=C(e,d))){mx(p,C,n,u);break e}_&&_(e,h,d),e==="focusout"&&(_=h._wrapperState)&&_.controlled&&h.type==="number"&&ah(h,"number",h.value)}switch(_=d?bo(d):window,e){case"focusin":(Vm(_)||_.contentEditable==="true")&&(yo=_,xh=d,Da=null);break;case"focusout":Da=xh=yo=null;break;case"mousedown":bh=!0;break;case"contextmenu":case"mouseup":case"dragend":bh=!1,Km(p,n,u);break;case"selectionchange":if(uS)break;case"keydown":case"keyup":Km(p,n,u)}var j;if(Lp)e:{switch(e){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else vo?px(e,n)&&(E="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(E="onCompositionStart");E&&(hx&&n.locale!=="ko"&&(vo||E!=="onCompositionStart"?E==="onCompositionEnd"&&vo&&(j=ux()):($i=u,Ap="value"in $i?$i.value:$i.textContent,vo=!0)),_=$c(d,E),0<_.length&&(E=new Hm(E,e,null,n,u),p.push({event:E,listeners:_}),j?E.data=j:(j=fx(n),j!==null&&(E.data=j)))),(j=Q2?eS(e,n):tS(e,n))&&(d=$c(d,"onBeforeInput"),0<d.length&&(u=new Hm("onBeforeInput","beforeinput",null,n,u),p.push({event:u,listeners:d}),u.data=j))}Cx(p,t)})}function nl(e,t,n){return{instance:e,listener:t,currentTarget:n}}function $c(e,t){for(var n=t+"Capture",r=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Xa(e,n),s!=null&&r.unshift(nl(e,s,i)),s=Xa(e,t),s!=null&&r.push(nl(e,s,i))),e=e.return}return r}function Us(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function eg(e,t,n,r,i){for(var s=t._reactName,a=[];n!==null&&n!==r;){var l=n,c=l.alternate,d=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&d!==null&&(l=d,i?(c=Xa(n,s),c!=null&&a.unshift(nl(n,c,l))):i||(c=Xa(n,s),c!=null&&a.push(nl(n,c,l)))),n=n.return}a.length!==0&&e.push({event:t,listeners:a})}var mS=/\r\n?/g,gS=/\u0000|\uFFFD/g;function tg(e){return(typeof e=="string"?e:""+e).replace(mS,`
`).replace(gS,"")}function Wl(e,t,n){if(t=tg(t),tg(e)!==t&&n)throw Error(Ee(425))}function Lc(){}var wh=null,_h=null;function Sh(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var kh=typeof setTimeout=="function"?setTimeout:void 0,vS=typeof clearTimeout=="function"?clearTimeout:void 0,ng=typeof Promise=="function"?Promise:void 0,yS=typeof queueMicrotask=="function"?queueMicrotask:typeof ng<"u"?function(e){return ng.resolve(null).then(e).catch(xS)}:kh;function xS(e){setTimeout(function(){throw e})}function mu(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){e.removeChild(i),Ja(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Ja(t)}function Fi(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function rg(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Vo=Math.random().toString(36).slice(2),Fr="__reactFiber$"+Vo,rl="__reactProps$"+Vo,ci="__reactContainer$"+Vo,jh="__reactEvents$"+Vo,bS="__reactListeners$"+Vo,wS="__reactHandles$"+Vo;function ys(e){var t=e[Fr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ci]||n[Fr]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=rg(e);e!==null;){if(n=e[Fr])return n;e=rg(e)}return t}e=n,n=e.parentNode}return null}function xl(e){return e=e[Fr]||e[ci],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function bo(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Ee(33))}function _d(e){return e[rl]||null}var Ch=[],wo=-1;function Zi(e){return{current:e}}function Mt(e){0>wo||(e.current=Ch[wo],Ch[wo]=null,wo--)}function Tt(e,t){wo++,Ch[wo]=e.current,e.current=t}var Vi={},bn=Zi(Vi),Mn=Zi(!1),js=Vi;function Io(e,t){var n=e.type.contextTypes;if(!n)return Vi;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=t[s];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function $n(e){return e=e.childContextTypes,e!=null}function Ic(){Mt(Mn),Mt(bn)}function ig(e,t,n){if(bn.current!==Vi)throw Error(Ee(168));Tt(bn,t),Tt(Mn,n)}function Tx(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in t))throw Error(Ee(108,s2(e)||"Unknown",i));return Bt({},n,r)}function Dc(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Vi,js=bn.current,Tt(bn,e),Tt(Mn,Mn.current),!0}function sg(e,t,n){var r=e.stateNode;if(!r)throw Error(Ee(169));n?(e=Tx(e,t,js),r.__reactInternalMemoizedMergedChildContext=e,Mt(Mn),Mt(bn),Tt(bn,e)):Mt(Mn),Tt(Mn,n)}var ii=null,Sd=!1,gu=!1;function Nx(e){ii===null?ii=[e]:ii.push(e)}function _S(e){Sd=!0,Nx(e)}function Ki(){if(!gu&&ii!==null){gu=!0;var e=0,t=xt;try{var n=ii;for(xt=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}ii=null,Sd=!1}catch(i){throw ii!==null&&(ii=ii.slice(e+1)),ex(Np,Ki),i}finally{xt=t,gu=!1}}return null}var _o=[],So=0,zc=null,Fc=0,ar=[],lr=0,Cs=null,si=1,oi="";function ds(e,t){_o[So++]=Fc,_o[So++]=zc,zc=e,Fc=t}function Px(e,t,n){ar[lr++]=si,ar[lr++]=oi,ar[lr++]=Cs,Cs=e;var r=si;e=oi;var i=32-jr(r)-1;r&=~(1<<i),n+=1;var s=32-jr(t)+i;if(30<s){var a=i-i%5;s=(r&(1<<a)-1).toString(32),r>>=a,i-=a,si=1<<32-jr(t)+i|n<<i|r,oi=s+e}else si=1<<s|n<<i|r,oi=e}function Dp(e){e.return!==null&&(ds(e,1),Px(e,1,0))}function zp(e){for(;e===zc;)zc=_o[--So],_o[So]=null,Fc=_o[--So],_o[So]=null;for(;e===Cs;)Cs=ar[--lr],ar[lr]=null,oi=ar[--lr],ar[lr]=null,si=ar[--lr],ar[lr]=null}var Kn=null,Yn=null,It=!1,Sr=null;function Rx(e,t){var n=dr(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function og(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Kn=e,Yn=Fi(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Kn=e,Yn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Cs!==null?{id:si,overflow:oi}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=dr(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Kn=e,Yn=null,!0):!1;default:return!1}}function Eh(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Th(e){if(It){var t=Yn;if(t){var n=t;if(!og(e,t)){if(Eh(e))throw Error(Ee(418));t=Fi(n.nextSibling);var r=Kn;t&&og(e,t)?Rx(r,n):(e.flags=e.flags&-4097|2,It=!1,Kn=e)}}else{if(Eh(e))throw Error(Ee(418));e.flags=e.flags&-4097|2,It=!1,Kn=e}}}function ag(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Kn=e}function Gl(e){if(e!==Kn)return!1;if(!It)return ag(e),It=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Sh(e.type,e.memoizedProps)),t&&(t=Yn)){if(Eh(e))throw Ox(),Error(Ee(418));for(;t;)Rx(e,t),t=Fi(t.nextSibling)}if(ag(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Ee(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Yn=Fi(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Yn=null}}else Yn=Kn?Fi(e.stateNode.nextSibling):null;return!0}function Ox(){for(var e=Yn;e;)e=Fi(e.nextSibling)}function Do(){Yn=Kn=null,It=!1}function Fp(e){Sr===null?Sr=[e]:Sr.push(e)}var SS=hi.ReactCurrentBatchConfig;function va(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Ee(309));var r=n.stateNode}if(!r)throw Error(Ee(147,e));var i=r,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(a){var l=i.refs;a===null?delete l[s]:l[s]=a},t._stringRef=s,t)}if(typeof e!="string")throw Error(Ee(284));if(!n._owner)throw Error(Ee(290,e))}return e}function Vl(e,t){throw e=Object.prototype.toString.call(t),Error(Ee(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function lg(e){var t=e._init;return t(e._payload)}function Ax(e){function t(y,v){if(e){var b=y.deletions;b===null?(y.deletions=[v],y.flags|=16):b.push(v)}}function n(y,v){if(!e)return null;for(;v!==null;)t(y,v),v=v.sibling;return null}function r(y,v){for(y=new Map;v!==null;)v.key!==null?y.set(v.key,v):y.set(v.index,v),v=v.sibling;return y}function i(y,v){return y=Wi(y,v),y.index=0,y.sibling=null,y}function s(y,v,b){return y.index=b,e?(b=y.alternate,b!==null?(b=b.index,b<v?(y.flags|=2,v):b):(y.flags|=2,v)):(y.flags|=1048576,v)}function a(y){return e&&y.alternate===null&&(y.flags|=2),y}function l(y,v,b,w){return v===null||v.tag!==6?(v=Su(b,y.mode,w),v.return=y,v):(v=i(v,b),v.return=y,v)}function c(y,v,b,w){var C=b.type;return C===go?u(y,v,b.props.children,w,b.key):v!==null&&(v.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Ei&&lg(C)===v.type)?(w=i(v,b.props),w.ref=va(y,v,b),w.return=y,w):(w=Cc(b.type,b.key,b.props,null,y.mode,w),w.ref=va(y,v,b),w.return=y,w)}function d(y,v,b,w){return v===null||v.tag!==4||v.stateNode.containerInfo!==b.containerInfo||v.stateNode.implementation!==b.implementation?(v=ku(b,y.mode,w),v.return=y,v):(v=i(v,b.children||[]),v.return=y,v)}function u(y,v,b,w,C){return v===null||v.tag!==7?(v=Ss(b,y.mode,w,C),v.return=y,v):(v=i(v,b),v.return=y,v)}function p(y,v,b){if(typeof v=="string"&&v!==""||typeof v=="number")return v=Su(""+v,y.mode,b),v.return=y,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case $l:return b=Cc(v.type,v.key,v.props,null,y.mode,b),b.ref=va(y,null,v),b.return=y,b;case mo:return v=ku(v,y.mode,b),v.return=y,v;case Ei:var w=v._init;return p(y,w(v._payload),b)}if(Ea(v)||ha(v))return v=Ss(v,y.mode,b,null),v.return=y,v;Vl(y,v)}return null}function h(y,v,b,w){var C=v!==null?v.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return C!==null?null:l(y,v,""+b,w);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case $l:return b.key===C?c(y,v,b,w):null;case mo:return b.key===C?d(y,v,b,w):null;case Ei:return C=b._init,h(y,v,C(b._payload),w)}if(Ea(b)||ha(b))return C!==null?null:u(y,v,b,w,null);Vl(y,b)}return null}function f(y,v,b,w,C){if(typeof w=="string"&&w!==""||typeof w=="number")return y=y.get(b)||null,l(v,y,""+w,C);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case $l:return y=y.get(w.key===null?b:w.key)||null,c(v,y,w,C);case mo:return y=y.get(w.key===null?b:w.key)||null,d(v,y,w,C);case Ei:var _=w._init;return f(y,v,b,_(w._payload),C)}if(Ea(w)||ha(w))return y=y.get(b)||null,u(v,y,w,C,null);Vl(v,w)}return null}function m(y,v,b,w){for(var C=null,_=null,j=v,E=v=0,T=null;j!==null&&E<b.length;E++){j.index>E?(T=j,j=null):T=j.sibling;var M=h(y,j,b[E],w);if(M===null){j===null&&(j=T);break}e&&j&&M.alternate===null&&t(y,j),v=s(M,v,E),_===null?C=M:_.sibling=M,_=M,j=T}if(E===b.length)return n(y,j),It&&ds(y,E),C;if(j===null){for(;E<b.length;E++)j=p(y,b[E],w),j!==null&&(v=s(j,v,E),_===null?C=j:_.sibling=j,_=j);return It&&ds(y,E),C}for(j=r(y,j);E<b.length;E++)T=f(j,y,E,b[E],w),T!==null&&(e&&T.alternate!==null&&j.delete(T.key===null?E:T.key),v=s(T,v,E),_===null?C=T:_.sibling=T,_=T);return e&&j.forEach(function(J){return t(y,J)}),It&&ds(y,E),C}function g(y,v,b,w){var C=ha(b);if(typeof C!="function")throw Error(Ee(150));if(b=C.call(b),b==null)throw Error(Ee(151));for(var _=C=null,j=v,E=v=0,T=null,M=b.next();j!==null&&!M.done;E++,M=b.next()){j.index>E?(T=j,j=null):T=j.sibling;var J=h(y,j,M.value,w);if(J===null){j===null&&(j=T);break}e&&j&&J.alternate===null&&t(y,j),v=s(J,v,E),_===null?C=J:_.sibling=J,_=J,j=T}if(M.done)return n(y,j),It&&ds(y,E),C;if(j===null){for(;!M.done;E++,M=b.next())M=p(y,M.value,w),M!==null&&(v=s(M,v,E),_===null?C=M:_.sibling=M,_=M);return It&&ds(y,E),C}for(j=r(y,j);!M.done;E++,M=b.next())M=f(j,y,E,M.value,w),M!==null&&(e&&M.alternate!==null&&j.delete(M.key===null?E:M.key),v=s(M,v,E),_===null?C=M:_.sibling=M,_=M);return e&&j.forEach(function(P){return t(y,P)}),It&&ds(y,E),C}function x(y,v,b,w){if(typeof b=="object"&&b!==null&&b.type===go&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case $l:e:{for(var C=b.key,_=v;_!==null;){if(_.key===C){if(C=b.type,C===go){if(_.tag===7){n(y,_.sibling),v=i(_,b.props.children),v.return=y,y=v;break e}}else if(_.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Ei&&lg(C)===_.type){n(y,_.sibling),v=i(_,b.props),v.ref=va(y,_,b),v.return=y,y=v;break e}n(y,_);break}else t(y,_);_=_.sibling}b.type===go?(v=Ss(b.props.children,y.mode,w,b.key),v.return=y,y=v):(w=Cc(b.type,b.key,b.props,null,y.mode,w),w.ref=va(y,v,b),w.return=y,y=w)}return a(y);case mo:e:{for(_=b.key;v!==null;){if(v.key===_)if(v.tag===4&&v.stateNode.containerInfo===b.containerInfo&&v.stateNode.implementation===b.implementation){n(y,v.sibling),v=i(v,b.children||[]),v.return=y,y=v;break e}else{n(y,v);break}else t(y,v);v=v.sibling}v=ku(b,y.mode,w),v.return=y,y=v}return a(y);case Ei:return _=b._init,x(y,v,_(b._payload),w)}if(Ea(b))return m(y,v,b,w);if(ha(b))return g(y,v,b,w);Vl(y,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,v!==null&&v.tag===6?(n(y,v.sibling),v=i(v,b),v.return=y,y=v):(n(y,v),v=Su(b,y.mode,w),v.return=y,y=v),a(y)):n(y,v)}return x}var zo=Ax(!0),Mx=Ax(!1),Bc=Zi(null),Hc=null,ko=null,Bp=null;function Hp(){Bp=ko=Hc=null}function Up(e){var t=Bc.current;Mt(Bc),e._currentValue=t}function Nh(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Oo(e,t){Hc=e,Bp=ko=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(An=!0),e.firstContext=null)}function hr(e){var t=e._currentValue;if(Bp!==e)if(e={context:e,memoizedValue:t,next:null},ko===null){if(Hc===null)throw Error(Ee(308));ko=e,Hc.dependencies={lanes:0,firstContext:e}}else ko=ko.next=e;return t}var xs=null;function Wp(e){xs===null?xs=[e]:xs.push(e)}function $x(e,t,n,r){var i=t.interleaved;return i===null?(n.next=n,Wp(t)):(n.next=i.next,i.next=n),t.interleaved=n,di(e,r)}function di(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Ti=!1;function Gp(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Lx(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ai(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Bi(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,mt&2){var i=r.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),r.pending=t,di(e,n)}return i=r.interleaved,i===null?(t.next=t,Wp(r)):(t.next=i.next,i.next=t),r.interleaved=t,di(e,n)}function bc(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Pp(e,n)}}function cg(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=a:s=s.next=a,n=n.next}while(n!==null);s===null?i=s=t:s=s.next=t}else i=s=t;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Uc(e,t,n,r){var i=e.updateQueue;Ti=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var c=l,d=c.next;c.next=null,a===null?s=d:a.next=d,a=c;var u=e.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==a&&(l===null?u.firstBaseUpdate=d:l.next=d,u.lastBaseUpdate=c))}if(s!==null){var p=i.baseState;a=0,u=d=c=null,l=s;do{var h=l.lane,f=l.eventTime;if((r&h)===h){u!==null&&(u=u.next={eventTime:f,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var m=e,g=l;switch(h=t,f=n,g.tag){case 1:if(m=g.payload,typeof m=="function"){p=m.call(f,p,h);break e}p=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=g.payload,h=typeof m=="function"?m.call(f,p,h):m,h==null)break e;p=Bt({},p,h);break e;case 2:Ti=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,h=i.effects,h===null?i.effects=[l]:h.push(l))}else f={eventTime:f,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(d=u=f,c=p):u=u.next=f,a|=h;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;h=l,l=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(u===null&&(c=p),i.baseState=c,i.firstBaseUpdate=d,i.lastBaseUpdate=u,t=i.shared.interleaved,t!==null){i=t;do a|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);Ts|=a,e.lanes=a,e.memoizedState=p}}function dg(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(Ee(191,i));i.call(r)}}}var bl={},Wr=Zi(bl),il=Zi(bl),sl=Zi(bl);function bs(e){if(e===bl)throw Error(Ee(174));return e}function Vp(e,t){switch(Tt(sl,t),Tt(il,e),Tt(Wr,bl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ch(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=ch(t,e)}Mt(Wr),Tt(Wr,t)}function Fo(){Mt(Wr),Mt(il),Mt(sl)}function Ix(e){bs(sl.current);var t=bs(Wr.current),n=ch(t,e.type);t!==n&&(Tt(il,e),Tt(Wr,n))}function qp(e){il.current===e&&(Mt(Wr),Mt(il))}var zt=Zi(0);function Wc(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var vu=[];function Yp(){for(var e=0;e<vu.length;e++)vu[e]._workInProgressVersionPrimary=null;vu.length=0}var wc=hi.ReactCurrentDispatcher,yu=hi.ReactCurrentBatchConfig,Es=0,Ft=null,Kt=null,en=null,Gc=!1,za=!1,ol=0,kS=0;function gn(){throw Error(Ee(321))}function Xp(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Er(e[n],t[n]))return!1;return!0}function Zp(e,t,n,r,i,s){if(Es=s,Ft=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,wc.current=e===null||e.memoizedState===null?TS:NS,e=n(r,i),za){s=0;do{if(za=!1,ol=0,25<=s)throw Error(Ee(301));s+=1,en=Kt=null,t.updateQueue=null,wc.current=PS,e=n(r,i)}while(za)}if(wc.current=Vc,t=Kt!==null&&Kt.next!==null,Es=0,en=Kt=Ft=null,Gc=!1,t)throw Error(Ee(300));return e}function Kp(){var e=ol!==0;return ol=0,e}function zr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return en===null?Ft.memoizedState=en=e:en=en.next=e,en}function pr(){if(Kt===null){var e=Ft.alternate;e=e!==null?e.memoizedState:null}else e=Kt.next;var t=en===null?Ft.memoizedState:en.next;if(t!==null)en=t,Kt=e;else{if(e===null)throw Error(Ee(310));Kt=e,e={memoizedState:Kt.memoizedState,baseState:Kt.baseState,baseQueue:Kt.baseQueue,queue:Kt.queue,next:null},en===null?Ft.memoizedState=en=e:en=en.next=e}return en}function al(e,t){return typeof t=="function"?t(e):t}function xu(e){var t=pr(),n=t.queue;if(n===null)throw Error(Ee(311));n.lastRenderedReducer=e;var r=Kt,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var l=a=null,c=null,d=s;do{var u=d.lane;if((Es&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:e(r,d.action);else{var p={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=p,a=r):c=c.next=p,Ft.lanes|=u,Ts|=u}d=d.next}while(d!==null&&d!==s);c===null?a=r:c.next=l,Er(r,t.memoizedState)||(An=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=c,n.lastRenderedState=r}if(e=n.interleaved,e!==null){i=e;do s=i.lane,Ft.lanes|=s,Ts|=s,i=i.next;while(i!==e)}else i===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function bu(e){var t=pr(),n=t.queue;if(n===null)throw Error(Ee(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,s=t.memoizedState;if(i!==null){n.pending=null;var a=i=i.next;do s=e(s,a.action),a=a.next;while(a!==i);Er(s,t.memoizedState)||(An=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function Dx(){}function zx(e,t){var n=Ft,r=pr(),i=t(),s=!Er(r.memoizedState,i);if(s&&(r.memoizedState=i,An=!0),r=r.queue,Jp(Hx.bind(null,n,r,e),[e]),r.getSnapshot!==t||s||en!==null&&en.memoizedState.tag&1){if(n.flags|=2048,ll(9,Bx.bind(null,n,r,i,t),void 0,null),tn===null)throw Error(Ee(349));Es&30||Fx(n,t,i)}return i}function Fx(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Ft.updateQueue,t===null?(t={lastEffect:null,stores:null},Ft.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Bx(e,t,n,r){t.value=n,t.getSnapshot=r,Ux(t)&&Wx(e)}function Hx(e,t,n){return n(function(){Ux(t)&&Wx(e)})}function Ux(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Er(e,n)}catch{return!0}}function Wx(e){var t=di(e,1);t!==null&&Cr(t,e,1,-1)}function ug(e){var t=zr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:al,lastRenderedState:e},t.queue=e,e=e.dispatch=ES.bind(null,Ft,e),[t.memoizedState,e]}function ll(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Ft.updateQueue,t===null?(t={lastEffect:null,stores:null},Ft.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function Gx(){return pr().memoizedState}function _c(e,t,n,r){var i=zr();Ft.flags|=e,i.memoizedState=ll(1|t,n,void 0,r===void 0?null:r)}function kd(e,t,n,r){var i=pr();r=r===void 0?null:r;var s=void 0;if(Kt!==null){var a=Kt.memoizedState;if(s=a.destroy,r!==null&&Xp(r,a.deps)){i.memoizedState=ll(t,n,s,r);return}}Ft.flags|=e,i.memoizedState=ll(1|t,n,s,r)}function hg(e,t){return _c(8390656,8,e,t)}function Jp(e,t){return kd(2048,8,e,t)}function Vx(e,t){return kd(4,2,e,t)}function qx(e,t){return kd(4,4,e,t)}function Yx(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Xx(e,t,n){return n=n!=null?n.concat([e]):null,kd(4,4,Yx.bind(null,t,e),n)}function Qp(){}function Zx(e,t){var n=pr();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Xp(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Kx(e,t){var n=pr();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Xp(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Jx(e,t,n){return Es&21?(Er(n,t)||(n=rx(),Ft.lanes|=n,Ts|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,An=!0),e.memoizedState=n)}function jS(e,t){var n=xt;xt=n!==0&&4>n?n:4,e(!0);var r=yu.transition;yu.transition={};try{e(!1),t()}finally{xt=n,yu.transition=r}}function Qx(){return pr().memoizedState}function CS(e,t,n){var r=Ui(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},eb(e))tb(t,n);else if(n=$x(e,t,n,r),n!==null){var i=jn();Cr(n,e,r,i),nb(n,t,r)}}function ES(e,t,n){var r=Ui(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(eb(e))tb(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var a=t.lastRenderedState,l=s(a,n);if(i.hasEagerState=!0,i.eagerState=l,Er(l,a)){var c=t.interleaved;c===null?(i.next=i,Wp(t)):(i.next=c.next,c.next=i),t.interleaved=i;return}}catch{}finally{}n=$x(e,t,i,r),n!==null&&(i=jn(),Cr(n,e,r,i),nb(n,t,r))}}function eb(e){var t=e.alternate;return e===Ft||t!==null&&t===Ft}function tb(e,t){za=Gc=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function nb(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Pp(e,n)}}var Vc={readContext:hr,useCallback:gn,useContext:gn,useEffect:gn,useImperativeHandle:gn,useInsertionEffect:gn,useLayoutEffect:gn,useMemo:gn,useReducer:gn,useRef:gn,useState:gn,useDebugValue:gn,useDeferredValue:gn,useTransition:gn,useMutableSource:gn,useSyncExternalStore:gn,useId:gn,unstable_isNewReconciler:!1},TS={readContext:hr,useCallback:function(e,t){return zr().memoizedState=[e,t===void 0?null:t],e},useContext:hr,useEffect:hg,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,_c(4194308,4,Yx.bind(null,t,e),n)},useLayoutEffect:function(e,t){return _c(4194308,4,e,t)},useInsertionEffect:function(e,t){return _c(4,2,e,t)},useMemo:function(e,t){var n=zr();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=zr();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=CS.bind(null,Ft,e),[r.memoizedState,e]},useRef:function(e){var t=zr();return e={current:e},t.memoizedState=e},useState:ug,useDebugValue:Qp,useDeferredValue:function(e){return zr().memoizedState=e},useTransition:function(){var e=ug(!1),t=e[0];return e=jS.bind(null,e[1]),zr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Ft,i=zr();if(It){if(n===void 0)throw Error(Ee(407));n=n()}else{if(n=t(),tn===null)throw Error(Ee(349));Es&30||Fx(r,t,n)}i.memoizedState=n;var s={value:n,getSnapshot:t};return i.queue=s,hg(Hx.bind(null,r,s,e),[e]),r.flags|=2048,ll(9,Bx.bind(null,r,s,n,t),void 0,null),n},useId:function(){var e=zr(),t=tn.identifierPrefix;if(It){var n=oi,r=si;n=(r&~(1<<32-jr(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=ol++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=kS++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},NS={readContext:hr,useCallback:Zx,useContext:hr,useEffect:Jp,useImperativeHandle:Xx,useInsertionEffect:Vx,useLayoutEffect:qx,useMemo:Kx,useReducer:xu,useRef:Gx,useState:function(){return xu(al)},useDebugValue:Qp,useDeferredValue:function(e){var t=pr();return Jx(t,Kt.memoizedState,e)},useTransition:function(){var e=xu(al)[0],t=pr().memoizedState;return[e,t]},useMutableSource:Dx,useSyncExternalStore:zx,useId:Qx,unstable_isNewReconciler:!1},PS={readContext:hr,useCallback:Zx,useContext:hr,useEffect:Jp,useImperativeHandle:Xx,useInsertionEffect:Vx,useLayoutEffect:qx,useMemo:Kx,useReducer:bu,useRef:Gx,useState:function(){return bu(al)},useDebugValue:Qp,useDeferredValue:function(e){var t=pr();return Kt===null?t.memoizedState=e:Jx(t,Kt.memoizedState,e)},useTransition:function(){var e=bu(al)[0],t=pr().memoizedState;return[e,t]},useMutableSource:Dx,useSyncExternalStore:zx,useId:Qx,unstable_isNewReconciler:!1};function xr(e,t){if(e&&e.defaultProps){t=Bt({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Ph(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Bt({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var jd={isMounted:function(e){return(e=e._reactInternals)?Os(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=jn(),i=Ui(e),s=ai(r,i);s.payload=t,n!=null&&(s.callback=n),t=Bi(e,s,i),t!==null&&(Cr(t,e,i,r),bc(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=jn(),i=Ui(e),s=ai(r,i);s.tag=1,s.payload=t,n!=null&&(s.callback=n),t=Bi(e,s,i),t!==null&&(Cr(t,e,i,r),bc(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=jn(),r=Ui(e),i=ai(n,r);i.tag=2,t!=null&&(i.callback=t),t=Bi(e,i,r),t!==null&&(Cr(t,e,r,n),bc(t,e,r))}};function pg(e,t,n,r,i,s,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,s,a):t.prototype&&t.prototype.isPureReactComponent?!el(n,r)||!el(i,s):!0}function rb(e,t,n){var r=!1,i=Vi,s=t.contextType;return typeof s=="object"&&s!==null?s=hr(s):(i=$n(t)?js:bn.current,r=t.contextTypes,s=(r=r!=null)?Io(e,i):Vi),t=new t(n,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=jd,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function fg(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&jd.enqueueReplaceState(t,t.state,null)}function Rh(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},Gp(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=hr(s):(s=$n(t)?js:bn.current,i.context=Io(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(Ph(e,t,s,n),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&jd.enqueueReplaceState(i,i.state,null),Uc(e,n,i,r),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function Bo(e,t){try{var n="",r=t;do n+=i2(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function wu(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Oh(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var RS=typeof WeakMap=="function"?WeakMap:Map;function ib(e,t,n){n=ai(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Yc||(Yc=!0,Hh=r),Oh(e,t)},n}function sb(e,t,n){n=ai(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){Oh(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){Oh(e,t),typeof r!="function"&&(Hi===null?Hi=new Set([this]):Hi.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),n}function mg(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new RS;var i=new Set;r.set(t,i)}else i=r.get(t),i===void 0&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=GS.bind(null,e,t,n),t.then(e,e))}function gg(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function vg(e,t,n,r,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=ai(-1,1),t.tag=2,Bi(n,t,1))),n.lanes|=1),e)}var OS=hi.ReactCurrentOwner,An=!1;function Sn(e,t,n,r){t.child=e===null?Mx(t,null,n,r):zo(t,e.child,n,r)}function yg(e,t,n,r,i){n=n.render;var s=t.ref;return Oo(t,i),r=Zp(e,t,n,r,s,i),n=Kp(),e!==null&&!An?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,ui(e,t,i)):(It&&n&&Dp(t),t.flags|=1,Sn(e,t,r,i),t.child)}function xg(e,t,n,r,i){if(e===null){var s=n.type;return typeof s=="function"&&!lf(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=s,ob(e,t,s,r,i)):(e=Cc(n.type,null,r,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var a=s.memoizedProps;if(n=n.compare,n=n!==null?n:el,n(a,r)&&e.ref===t.ref)return ui(e,t,i)}return t.flags|=1,e=Wi(s,r),e.ref=t.ref,e.return=t,t.child=e}function ob(e,t,n,r,i){if(e!==null){var s=e.memoizedProps;if(el(s,r)&&e.ref===t.ref)if(An=!1,t.pendingProps=r=s,(e.lanes&i)!==0)e.flags&131072&&(An=!0);else return t.lanes=e.lanes,ui(e,t,i)}return Ah(e,t,n,r,i)}function ab(e,t,n){var r=t.pendingProps,i=r.children,s=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Tt(Co,Gn),Gn|=n;else{if(!(n&1073741824))return e=s!==null?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Tt(Co,Gn),Gn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Tt(Co,Gn),Gn|=r}else s!==null?(r=s.baseLanes|n,t.memoizedState=null):r=n,Tt(Co,Gn),Gn|=r;return Sn(e,t,i,n),t.child}function lb(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ah(e,t,n,r,i){var s=$n(n)?js:bn.current;return s=Io(t,s),Oo(t,i),n=Zp(e,t,n,r,s,i),r=Kp(),e!==null&&!An?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,ui(e,t,i)):(It&&r&&Dp(t),t.flags|=1,Sn(e,t,n,i),t.child)}function bg(e,t,n,r,i){if($n(n)){var s=!0;Dc(t)}else s=!1;if(Oo(t,i),t.stateNode===null)Sc(e,t),rb(t,n,r),Rh(t,n,r,i),r=!0;else if(e===null){var a=t.stateNode,l=t.memoizedProps;a.props=l;var c=a.context,d=n.contextType;typeof d=="object"&&d!==null?d=hr(d):(d=$n(n)?js:bn.current,d=Io(t,d));var u=n.getDerivedStateFromProps,p=typeof u=="function"||typeof a.getSnapshotBeforeUpdate=="function";p||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==r||c!==d)&&fg(t,a,r,d),Ti=!1;var h=t.memoizedState;a.state=h,Uc(t,r,a,i),c=t.memoizedState,l!==r||h!==c||Mn.current||Ti?(typeof u=="function"&&(Ph(t,n,u,r),c=t.memoizedState),(l=Ti||pg(t,n,l,r,h,c,d))?(p||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),a.props=r,a.state=c,a.context=d,r=l):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,Lx(e,t),l=t.memoizedProps,d=t.type===t.elementType?l:xr(t.type,l),a.props=d,p=t.pendingProps,h=a.context,c=n.contextType,typeof c=="object"&&c!==null?c=hr(c):(c=$n(n)?js:bn.current,c=Io(t,c));var f=n.getDerivedStateFromProps;(u=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==p||h!==c)&&fg(t,a,r,c),Ti=!1,h=t.memoizedState,a.state=h,Uc(t,r,a,i);var m=t.memoizedState;l!==p||h!==m||Mn.current||Ti?(typeof f=="function"&&(Ph(t,n,f,r),m=t.memoizedState),(d=Ti||pg(t,n,d,r,h,m,c)||!1)?(u||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,m,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,m,c)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=m),a.props=r,a.state=m,a.context=c,r=d):(typeof a.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return Mh(e,t,n,r,s,i)}function Mh(e,t,n,r,i,s){lb(e,t);var a=(t.flags&128)!==0;if(!r&&!a)return i&&sg(t,n,!1),ui(e,t,s);r=t.stateNode,OS.current=t;var l=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&a?(t.child=zo(t,e.child,null,s),t.child=zo(t,null,l,s)):Sn(e,t,l,s),t.memoizedState=r.state,i&&sg(t,n,!0),t.child}function cb(e){var t=e.stateNode;t.pendingContext?ig(e,t.pendingContext,t.pendingContext!==t.context):t.context&&ig(e,t.context,!1),Vp(e,t.containerInfo)}function wg(e,t,n,r,i){return Do(),Fp(i),t.flags|=256,Sn(e,t,n,r),t.child}var $h={dehydrated:null,treeContext:null,retryLane:0};function Lh(e){return{baseLanes:e,cachePool:null,transitions:null}}function db(e,t,n){var r=t.pendingProps,i=zt.current,s=!1,a=(t.flags&128)!==0,l;if((l=a)||(l=e!==null&&e.memoizedState===null?!1:(i&2)!==0),l?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),Tt(zt,i&1),e===null)return Th(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=r.children,e=r.fallback,s?(r=t.mode,s=t.child,a={mode:"hidden",children:a},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=Td(a,r,0,null),e=Ss(e,r,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Lh(n),t.memoizedState=$h,e):ef(t,a));if(i=e.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return AS(e,t,a,r,l,i,n);if(s){s=r.fallback,a=t.mode,i=e.child,l=i.sibling;var c={mode:"hidden",children:r.children};return!(a&1)&&t.child!==i?(r=t.child,r.childLanes=0,r.pendingProps=c,t.deletions=null):(r=Wi(i,c),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=Wi(l,s):(s=Ss(s,a,n,null),s.flags|=2),s.return=t,r.return=t,r.sibling=s,t.child=r,r=s,s=t.child,a=e.child.memoizedState,a=a===null?Lh(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=e.childLanes&~n,t.memoizedState=$h,r}return s=e.child,e=s.sibling,r=Wi(s,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function ef(e,t){return t=Td({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function ql(e,t,n,r){return r!==null&&Fp(r),zo(t,e.child,null,n),e=ef(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function AS(e,t,n,r,i,s,a){if(n)return t.flags&256?(t.flags&=-257,r=wu(Error(Ee(422))),ql(e,t,a,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=r.fallback,i=t.mode,r=Td({mode:"visible",children:r.children},i,0,null),s=Ss(s,i,a,null),s.flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,t.mode&1&&zo(t,e.child,null,a),t.child.memoizedState=Lh(a),t.memoizedState=$h,s);if(!(t.mode&1))return ql(e,t,a,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,s=Error(Ee(419)),r=wu(s,r,void 0),ql(e,t,a,r)}if(l=(a&e.childLanes)!==0,An||l){if(r=tn,r!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,di(e,i),Cr(r,e,i,-1))}return af(),r=wu(Error(Ee(421))),ql(e,t,a,r)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=VS.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,Yn=Fi(i.nextSibling),Kn=t,It=!0,Sr=null,e!==null&&(ar[lr++]=si,ar[lr++]=oi,ar[lr++]=Cs,si=e.id,oi=e.overflow,Cs=t),t=ef(t,r.children),t.flags|=4096,t)}function _g(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Nh(e.return,t,n)}function _u(e,t,n,r,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function ub(e,t,n){var r=t.pendingProps,i=r.revealOrder,s=r.tail;if(Sn(e,t,r.children,n),r=zt.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&_g(e,n,t);else if(e.tag===19)_g(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Tt(zt,r),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;n!==null;)e=n.alternate,e!==null&&Wc(e)===null&&(i=n),n=n.sibling;n=i,n===null?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),_u(t,!1,i,n,s);break;case"backwards":for(n=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&Wc(e)===null){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}_u(t,!0,n,null,s);break;case"together":_u(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Sc(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ui(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Ts|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Ee(153));if(t.child!==null){for(e=t.child,n=Wi(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Wi(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function MS(e,t,n){switch(t.tag){case 3:cb(t),Do();break;case 5:Ix(t);break;case 1:$n(t.type)&&Dc(t);break;case 4:Vp(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Tt(Bc,r._currentValue),r._currentValue=i;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Tt(zt,zt.current&1),t.flags|=128,null):n&t.child.childLanes?db(e,t,n):(Tt(zt,zt.current&1),e=ui(e,t,n),e!==null?e.sibling:null);Tt(zt,zt.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return ub(e,t,n);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Tt(zt,zt.current),r)break;return null;case 22:case 23:return t.lanes=0,ab(e,t,n)}return ui(e,t,n)}var hb,Ih,pb,fb;hb=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Ih=function(){};pb=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,bs(Wr.current);var s=null;switch(n){case"input":i=sh(e,i),r=sh(e,r),s=[];break;case"select":i=Bt({},i,{value:void 0}),r=Bt({},r,{value:void 0}),s=[];break;case"textarea":i=lh(e,i),r=lh(e,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Lc)}dh(n,r);var a;n=null;for(d in i)if(!r.hasOwnProperty(d)&&i.hasOwnProperty(d)&&i[d]!=null)if(d==="style"){var l=i[d];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(qa.hasOwnProperty(d)?s||(s=[]):(s=s||[]).push(d,null));for(d in r){var c=r[d];if(l=i!=null?i[d]:void 0,r.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(s||(s=[]),s.push(d,n)),n=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(s=s||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(qa.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Rt("scroll",e),s||l===c||(s=[])):(s=s||[]).push(d,c))}n&&(s=s||[]).push("style",n);var d=s;(t.updateQueue=d)&&(t.flags|=4)}};fb=function(e,t,n,r){n!==r&&(t.flags|=4)};function ya(e,t){if(!It)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function vn(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function $S(e,t,n){var r=t.pendingProps;switch(zp(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return vn(t),null;case 1:return $n(t.type)&&Ic(),vn(t),null;case 3:return r=t.stateNode,Fo(),Mt(Mn),Mt(bn),Yp(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Gl(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Sr!==null&&(Gh(Sr),Sr=null))),Ih(e,t),vn(t),null;case 5:qp(t);var i=bs(sl.current);if(n=t.type,e!==null&&t.stateNode!=null)pb(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(Ee(166));return vn(t),null}if(e=bs(Wr.current),Gl(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[Fr]=t,r[rl]=s,e=(t.mode&1)!==0,n){case"dialog":Rt("cancel",r),Rt("close",r);break;case"iframe":case"object":case"embed":Rt("load",r);break;case"video":case"audio":for(i=0;i<Na.length;i++)Rt(Na[i],r);break;case"source":Rt("error",r);break;case"img":case"image":case"link":Rt("error",r),Rt("load",r);break;case"details":Rt("toggle",r);break;case"input":Rm(r,s),Rt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Rt("invalid",r);break;case"textarea":Am(r,s),Rt("invalid",r)}dh(n,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var l=s[a];a==="children"?typeof l=="string"?r.textContent!==l&&(s.suppressHydrationWarning!==!0&&Wl(r.textContent,l,e),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&Wl(r.textContent,l,e),i=["children",""+l]):qa.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&Rt("scroll",r)}switch(n){case"input":Ll(r),Om(r,s,!0);break;case"textarea":Ll(r),Mm(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Lc)}r=i,t.updateQueue=r,r!==null&&(t.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Hy(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=a.createElement(n,{is:r.is}):(e=a.createElement(n),n==="select"&&(a=e,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):e=a.createElementNS(e,n),e[Fr]=t,e[rl]=r,hb(e,t,!1,!1),t.stateNode=e;e:{switch(a=uh(n,r),n){case"dialog":Rt("cancel",e),Rt("close",e),i=r;break;case"iframe":case"object":case"embed":Rt("load",e),i=r;break;case"video":case"audio":for(i=0;i<Na.length;i++)Rt(Na[i],e);i=r;break;case"source":Rt("error",e),i=r;break;case"img":case"image":case"link":Rt("error",e),Rt("load",e),i=r;break;case"details":Rt("toggle",e),i=r;break;case"input":Rm(e,r),i=sh(e,r),Rt("invalid",e);break;case"option":i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=Bt({},r,{value:void 0}),Rt("invalid",e);break;case"textarea":Am(e,r),i=lh(e,r),Rt("invalid",e);break;default:i=r}dh(n,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var c=l[s];s==="style"?Gy(e,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Uy(e,c)):s==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Ya(e,c):typeof c=="number"&&Ya(e,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(qa.hasOwnProperty(s)?c!=null&&s==="onScroll"&&Rt("scroll",e):c!=null&&kp(e,s,c,a))}switch(n){case"input":Ll(e),Om(e,r,!1);break;case"textarea":Ll(e),Mm(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Gi(r.value));break;case"select":e.multiple=!!r.multiple,s=r.value,s!=null?To(e,!!r.multiple,s,!1):r.defaultValue!=null&&To(e,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=Lc)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return vn(t),null;case 6:if(e&&t.stateNode!=null)fb(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(Ee(166));if(n=bs(sl.current),bs(Wr.current),Gl(t)){if(r=t.stateNode,n=t.memoizedProps,r[Fr]=t,(s=r.nodeValue!==n)&&(e=Kn,e!==null))switch(e.tag){case 3:Wl(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Wl(r.nodeValue,n,(e.mode&1)!==0)}s&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Fr]=t,t.stateNode=r}return vn(t),null;case 13:if(Mt(zt),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(It&&Yn!==null&&t.mode&1&&!(t.flags&128))Ox(),Do(),t.flags|=98560,s=!1;else if(s=Gl(t),r!==null&&r.dehydrated!==null){if(e===null){if(!s)throw Error(Ee(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Ee(317));s[Fr]=t}else Do(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;vn(t),s=!1}else Sr!==null&&(Gh(Sr),Sr=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||zt.current&1?Qt===0&&(Qt=3):af())),t.updateQueue!==null&&(t.flags|=4),vn(t),null);case 4:return Fo(),Ih(e,t),e===null&&tl(t.stateNode.containerInfo),vn(t),null;case 10:return Up(t.type._context),vn(t),null;case 17:return $n(t.type)&&Ic(),vn(t),null;case 19:if(Mt(zt),s=t.memoizedState,s===null)return vn(t),null;if(r=(t.flags&128)!==0,a=s.rendering,a===null)if(r)ya(s,!1);else{if(Qt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=Wc(e),a!==null){for(t.flags|=128,ya(s,!1),r=a.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)s=n,e=r,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,e=a.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Tt(zt,zt.current&1|2),t.child}e=e.sibling}s.tail!==null&&Ut()>Ho&&(t.flags|=128,r=!0,ya(s,!1),t.lanes=4194304)}else{if(!r)if(e=Wc(a),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),ya(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!It)return vn(t),null}else 2*Ut()-s.renderingStartTime>Ho&&n!==1073741824&&(t.flags|=128,r=!0,ya(s,!1),t.lanes=4194304);s.isBackwards?(a.sibling=t.child,t.child=a):(n=s.last,n!==null?n.sibling=a:t.child=a,s.last=a)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Ut(),t.sibling=null,n=zt.current,Tt(zt,r?n&1|2:n&1),t):(vn(t),null);case 22:case 23:return of(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Gn&1073741824&&(vn(t),t.subtreeFlags&6&&(t.flags|=8192)):vn(t),null;case 24:return null;case 25:return null}throw Error(Ee(156,t.tag))}function LS(e,t){switch(zp(t),t.tag){case 1:return $n(t.type)&&Ic(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Fo(),Mt(Mn),Mt(bn),Yp(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return qp(t),null;case 13:if(Mt(zt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Ee(340));Do()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Mt(zt),null;case 4:return Fo(),null;case 10:return Up(t.type._context),null;case 22:case 23:return of(),null;case 24:return null;default:return null}}var Yl=!1,xn=!1,IS=typeof WeakSet=="function"?WeakSet:Set,Fe=null;function jo(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ht(e,t,r)}else n.current=null}function Dh(e,t,n){try{n()}catch(r){Ht(e,t,r)}}var Sg=!1;function DS(e,t){if(wh=Ac,e=xx(),Ip(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var a=0,l=-1,c=-1,d=0,u=0,p=e,h=null;t:for(;;){for(var f;p!==n||i!==0&&p.nodeType!==3||(l=a+i),p!==s||r!==0&&p.nodeType!==3||(c=a+r),p.nodeType===3&&(a+=p.nodeValue.length),(f=p.firstChild)!==null;)h=p,p=f;for(;;){if(p===e)break t;if(h===n&&++d===i&&(l=a),h===s&&++u===r&&(c=a),(f=p.nextSibling)!==null)break;p=h,h=p.parentNode}p=f}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(_h={focusedElem:e,selectionRange:n},Ac=!1,Fe=t;Fe!==null;)if(t=Fe,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Fe=e;else for(;Fe!==null;){t=Fe;try{var m=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var g=m.memoizedProps,x=m.memoizedState,y=t.stateNode,v=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:xr(t.type,g),x);y.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ee(163))}}catch(w){Ht(t,t.return,w)}if(e=t.sibling,e!==null){e.return=t.return,Fe=e;break}Fe=t.return}return m=Sg,Sg=!1,m}function Fa(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&Dh(t,n,s)}i=i.next}while(i!==r)}}function Cd(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function zh(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function mb(e){var t=e.alternate;t!==null&&(e.alternate=null,mb(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Fr],delete t[rl],delete t[jh],delete t[bS],delete t[wS])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function gb(e){return e.tag===5||e.tag===3||e.tag===4}function kg(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||gb(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Fh(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Lc));else if(r!==4&&(e=e.child,e!==null))for(Fh(e,t,n),e=e.sibling;e!==null;)Fh(e,t,n),e=e.sibling}function Bh(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Bh(e,t,n),e=e.sibling;e!==null;)Bh(e,t,n),e=e.sibling}var ln=null,wr=!1;function ji(e,t,n){for(n=n.child;n!==null;)vb(e,t,n),n=n.sibling}function vb(e,t,n){if(Ur&&typeof Ur.onCommitFiberUnmount=="function")try{Ur.onCommitFiberUnmount(yd,n)}catch{}switch(n.tag){case 5:xn||jo(n,t);case 6:var r=ln,i=wr;ln=null,ji(e,t,n),ln=r,wr=i,ln!==null&&(wr?(e=ln,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):ln.removeChild(n.stateNode));break;case 18:ln!==null&&(wr?(e=ln,n=n.stateNode,e.nodeType===8?mu(e.parentNode,n):e.nodeType===1&&mu(e,n),Ja(e)):mu(ln,n.stateNode));break;case 4:r=ln,i=wr,ln=n.stateNode.containerInfo,wr=!0,ji(e,t,n),ln=r,wr=i;break;case 0:case 11:case 14:case 15:if(!xn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&Dh(n,t,a),i=i.next}while(i!==r)}ji(e,t,n);break;case 1:if(!xn&&(jo(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Ht(n,t,l)}ji(e,t,n);break;case 21:ji(e,t,n);break;case 22:n.mode&1?(xn=(r=xn)||n.memoizedState!==null,ji(e,t,n),xn=r):ji(e,t,n);break;default:ji(e,t,n)}}function jg(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new IS),t.forEach(function(r){var i=qS.bind(null,e,r);n.has(r)||(n.add(r),r.then(i,i))})}}function mr(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=e,a=t,l=a;e:for(;l!==null;){switch(l.tag){case 5:ln=l.stateNode,wr=!1;break e;case 3:ln=l.stateNode.containerInfo,wr=!0;break e;case 4:ln=l.stateNode.containerInfo,wr=!0;break e}l=l.return}if(ln===null)throw Error(Ee(160));vb(s,a,i),ln=null,wr=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(d){Ht(i,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)yb(t,e),t=t.sibling}function yb(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(mr(t,e),Ir(e),r&4){try{Fa(3,e,e.return),Cd(3,e)}catch(g){Ht(e,e.return,g)}try{Fa(5,e,e.return)}catch(g){Ht(e,e.return,g)}}break;case 1:mr(t,e),Ir(e),r&512&&n!==null&&jo(n,n.return);break;case 5:if(mr(t,e),Ir(e),r&512&&n!==null&&jo(n,n.return),e.flags&32){var i=e.stateNode;try{Ya(i,"")}catch(g){Ht(e,e.return,g)}}if(r&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,a=n!==null?n.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&Fy(i,s),uh(l,a);var d=uh(l,s);for(a=0;a<c.length;a+=2){var u=c[a],p=c[a+1];u==="style"?Gy(i,p):u==="dangerouslySetInnerHTML"?Uy(i,p):u==="children"?Ya(i,p):kp(i,u,p,d)}switch(l){case"input":oh(i,s);break;case"textarea":By(i,s);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var f=s.value;f!=null?To(i,!!s.multiple,f,!1):h!==!!s.multiple&&(s.defaultValue!=null?To(i,!!s.multiple,s.defaultValue,!0):To(i,!!s.multiple,s.multiple?[]:"",!1))}i[rl]=s}catch(g){Ht(e,e.return,g)}}break;case 6:if(mr(t,e),Ir(e),r&4){if(e.stateNode===null)throw Error(Ee(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(g){Ht(e,e.return,g)}}break;case 3:if(mr(t,e),Ir(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ja(t.containerInfo)}catch(g){Ht(e,e.return,g)}break;case 4:mr(t,e),Ir(e);break;case 13:mr(t,e),Ir(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(rf=Ut())),r&4&&jg(e);break;case 22:if(u=n!==null&&n.memoizedState!==null,e.mode&1?(xn=(d=xn)||u,mr(t,e),xn=d):mr(t,e),Ir(e),r&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!u&&e.mode&1)for(Fe=e,u=e.child;u!==null;){for(p=Fe=u;Fe!==null;){switch(h=Fe,f=h.child,h.tag){case 0:case 11:case 14:case 15:Fa(4,h,h.return);break;case 1:jo(h,h.return);var m=h.stateNode;if(typeof m.componentWillUnmount=="function"){r=h,n=h.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Ht(r,n,g)}}break;case 5:jo(h,h.return);break;case 22:if(h.memoizedState!==null){Eg(p);continue}}f!==null?(f.return=h,Fe=f):Eg(p)}u=u.sibling}e:for(u=null,p=e;;){if(p.tag===5){if(u===null){u=p;try{i=p.stateNode,d?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=p.stateNode,c=p.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=Wy("display",a))}catch(g){Ht(e,e.return,g)}}}else if(p.tag===6){if(u===null)try{p.stateNode.nodeValue=d?"":p.memoizedProps}catch(g){Ht(e,e.return,g)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===e)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;p.sibling===null;){if(p.return===null||p.return===e)break e;u===p&&(u=null),p=p.return}u===p&&(u=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:mr(t,e),Ir(e),r&4&&jg(e);break;case 21:break;default:mr(t,e),Ir(e)}}function Ir(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(gb(n)){var r=n;break e}n=n.return}throw Error(Ee(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Ya(i,""),r.flags&=-33);var s=kg(e);Bh(e,s,i);break;case 3:case 4:var a=r.stateNode.containerInfo,l=kg(e);Fh(e,l,a);break;default:throw Error(Ee(161))}}catch(c){Ht(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function zS(e,t,n){Fe=e,xb(e)}function xb(e,t,n){for(var r=(e.mode&1)!==0;Fe!==null;){var i=Fe,s=i.child;if(i.tag===22&&r){var a=i.memoizedState!==null||Yl;if(!a){var l=i.alternate,c=l!==null&&l.memoizedState!==null||xn;l=Yl;var d=xn;if(Yl=a,(xn=c)&&!d)for(Fe=i;Fe!==null;)a=Fe,c=a.child,a.tag===22&&a.memoizedState!==null?Tg(i):c!==null?(c.return=a,Fe=c):Tg(i);for(;s!==null;)Fe=s,xb(s),s=s.sibling;Fe=i,Yl=l,xn=d}Cg(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Fe=s):Cg(e)}}function Cg(e){for(;Fe!==null;){var t=Fe;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:xn||Cd(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!xn)if(n===null)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:xr(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&dg(t,s,r);break;case 3:var a=t.updateQueue;if(a!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}dg(t,a,n)}break;case 5:var l=t.stateNode;if(n===null&&t.flags&4){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var p=u.dehydrated;p!==null&&Ja(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ee(163))}xn||t.flags&512&&zh(t)}catch(h){Ht(t,t.return,h)}}if(t===e){Fe=null;break}if(n=t.sibling,n!==null){n.return=t.return,Fe=n;break}Fe=t.return}}function Eg(e){for(;Fe!==null;){var t=Fe;if(t===e){Fe=null;break}var n=t.sibling;if(n!==null){n.return=t.return,Fe=n;break}Fe=t.return}}function Tg(e){for(;Fe!==null;){var t=Fe;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Cd(4,t)}catch(c){Ht(t,n,c)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var i=t.return;try{r.componentDidMount()}catch(c){Ht(t,i,c)}}var s=t.return;try{zh(t)}catch(c){Ht(t,s,c)}break;case 5:var a=t.return;try{zh(t)}catch(c){Ht(t,a,c)}}}catch(c){Ht(t,t.return,c)}if(t===e){Fe=null;break}var l=t.sibling;if(l!==null){l.return=t.return,Fe=l;break}Fe=t.return}}var FS=Math.ceil,qc=hi.ReactCurrentDispatcher,tf=hi.ReactCurrentOwner,ur=hi.ReactCurrentBatchConfig,mt=0,tn=null,qt=null,cn=0,Gn=0,Co=Zi(0),Qt=0,cl=null,Ts=0,Ed=0,nf=0,Ba=null,On=null,rf=0,Ho=1/0,ni=null,Yc=!1,Hh=null,Hi=null,Xl=!1,Li=null,Xc=0,Ha=0,Uh=null,kc=-1,jc=0;function jn(){return mt&6?Ut():kc!==-1?kc:kc=Ut()}function Ui(e){return e.mode&1?mt&2&&cn!==0?cn&-cn:SS.transition!==null?(jc===0&&(jc=rx()),jc):(e=xt,e!==0||(e=window.event,e=e===void 0?16:dx(e.type)),e):1}function Cr(e,t,n,r){if(50<Ha)throw Ha=0,Uh=null,Error(Ee(185));vl(e,n,r),(!(mt&2)||e!==tn)&&(e===tn&&(!(mt&2)&&(Ed|=n),Qt===4&&Ri(e,cn)),Ln(e,r),n===1&&mt===0&&!(t.mode&1)&&(Ho=Ut()+500,Sd&&Ki()))}function Ln(e,t){var n=e.callbackNode;S2(e,t);var r=Oc(e,e===tn?cn:0);if(r===0)n!==null&&Im(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&Im(n),t===1)e.tag===0?_S(Ng.bind(null,e)):Nx(Ng.bind(null,e)),yS(function(){!(mt&6)&&Ki()}),n=null;else{switch(ix(r)){case 1:n=Np;break;case 4:n=tx;break;case 16:n=Rc;break;case 536870912:n=nx;break;default:n=Rc}n=Eb(n,bb.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function bb(e,t){if(kc=-1,jc=0,mt&6)throw Error(Ee(327));var n=e.callbackNode;if(Ao()&&e.callbackNode!==n)return null;var r=Oc(e,e===tn?cn:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Zc(e,r);else{t=r;var i=mt;mt|=2;var s=_b();(tn!==e||cn!==t)&&(ni=null,Ho=Ut()+500,_s(e,t));do try{US();break}catch(l){wb(e,l)}while(!0);Hp(),qc.current=s,mt=i,qt!==null?t=0:(tn=null,cn=0,t=Qt)}if(t!==0){if(t===2&&(i=gh(e),i!==0&&(r=i,t=Wh(e,i))),t===1)throw n=cl,_s(e,0),Ri(e,r),Ln(e,Ut()),n;if(t===6)Ri(e,r);else{if(i=e.current.alternate,!(r&30)&&!BS(i)&&(t=Zc(e,r),t===2&&(s=gh(e),s!==0&&(r=s,t=Wh(e,s))),t===1))throw n=cl,_s(e,0),Ri(e,r),Ln(e,Ut()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(Ee(345));case 2:us(e,On,ni);break;case 3:if(Ri(e,r),(r&130023424)===r&&(t=rf+500-Ut(),10<t)){if(Oc(e,0)!==0)break;if(i=e.suspendedLanes,(i&r)!==r){jn(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=kh(us.bind(null,e,On,ni),t);break}us(e,On,ni);break;case 4:if(Ri(e,r),(r&4194240)===r)break;for(t=e.eventTimes,i=-1;0<r;){var a=31-jr(r);s=1<<a,a=t[a],a>i&&(i=a),r&=~s}if(r=i,r=Ut()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*FS(r/1960))-r,10<r){e.timeoutHandle=kh(us.bind(null,e,On,ni),r);break}us(e,On,ni);break;case 5:us(e,On,ni);break;default:throw Error(Ee(329))}}}return Ln(e,Ut()),e.callbackNode===n?bb.bind(null,e):null}function Wh(e,t){var n=Ba;return e.current.memoizedState.isDehydrated&&(_s(e,t).flags|=256),e=Zc(e,t),e!==2&&(t=On,On=n,t!==null&&Gh(t)),e}function Gh(e){On===null?On=e:On.push.apply(On,e)}function BS(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Er(s(),i))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Ri(e,t){for(t&=~nf,t&=~Ed,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-jr(t),r=1<<n;e[n]=-1,t&=~r}}function Ng(e){if(mt&6)throw Error(Ee(327));Ao();var t=Oc(e,0);if(!(t&1))return Ln(e,Ut()),null;var n=Zc(e,t);if(e.tag!==0&&n===2){var r=gh(e);r!==0&&(t=r,n=Wh(e,r))}if(n===1)throw n=cl,_s(e,0),Ri(e,t),Ln(e,Ut()),n;if(n===6)throw Error(Ee(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,us(e,On,ni),Ln(e,Ut()),null}function sf(e,t){var n=mt;mt|=1;try{return e(t)}finally{mt=n,mt===0&&(Ho=Ut()+500,Sd&&Ki())}}function Ns(e){Li!==null&&Li.tag===0&&!(mt&6)&&Ao();var t=mt;mt|=1;var n=ur.transition,r=xt;try{if(ur.transition=null,xt=1,e)return e()}finally{xt=r,ur.transition=n,mt=t,!(mt&6)&&Ki()}}function of(){Gn=Co.current,Mt(Co)}function _s(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,vS(n)),qt!==null)for(n=qt.return;n!==null;){var r=n;switch(zp(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Ic();break;case 3:Fo(),Mt(Mn),Mt(bn),Yp();break;case 5:qp(r);break;case 4:Fo();break;case 13:Mt(zt);break;case 19:Mt(zt);break;case 10:Up(r.type._context);break;case 22:case 23:of()}n=n.return}if(tn=e,qt=e=Wi(e.current,null),cn=Gn=t,Qt=0,cl=null,nf=Ed=Ts=0,On=Ba=null,xs!==null){for(t=0;t<xs.length;t++)if(n=xs[t],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var a=s.next;s.next=i,r.next=a}n.pending=r}xs=null}return e}function wb(e,t){do{var n=qt;try{if(Hp(),wc.current=Vc,Gc){for(var r=Ft.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Gc=!1}if(Es=0,en=Kt=Ft=null,za=!1,ol=0,tf.current=null,n===null||n.return===null){Qt=1,cl=t,qt=null;break}e:{var s=e,a=n.return,l=n,c=t;if(t=cn,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=l,p=u.tag;if(!(u.mode&1)&&(p===0||p===11||p===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=gg(a);if(f!==null){f.flags&=-257,vg(f,a,l,s,t),f.mode&1&&mg(s,d,t),t=f,c=d;var m=t.updateQueue;if(m===null){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}else{if(!(t&1)){mg(s,d,t),af();break e}c=Error(Ee(426))}}else if(It&&l.mode&1){var x=gg(a);if(x!==null){!(x.flags&65536)&&(x.flags|=256),vg(x,a,l,s,t),Fp(Bo(c,l));break e}}s=c=Bo(c,l),Qt!==4&&(Qt=2),Ba===null?Ba=[s]:Ba.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var y=ib(s,c,t);cg(s,y);break e;case 1:l=c;var v=s.type,b=s.stateNode;if(!(s.flags&128)&&(typeof v.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Hi===null||!Hi.has(b)))){s.flags|=65536,t&=-t,s.lanes|=t;var w=sb(s,l,t);cg(s,w);break e}}s=s.return}while(s!==null)}kb(n)}catch(C){t=C,qt===n&&n!==null&&(qt=n=n.return);continue}break}while(!0)}function _b(){var e=qc.current;return qc.current=Vc,e===null?Vc:e}function af(){(Qt===0||Qt===3||Qt===2)&&(Qt=4),tn===null||!(Ts&268435455)&&!(Ed&268435455)||Ri(tn,cn)}function Zc(e,t){var n=mt;mt|=2;var r=_b();(tn!==e||cn!==t)&&(ni=null,_s(e,t));do try{HS();break}catch(i){wb(e,i)}while(!0);if(Hp(),mt=n,qc.current=r,qt!==null)throw Error(Ee(261));return tn=null,cn=0,Qt}function HS(){for(;qt!==null;)Sb(qt)}function US(){for(;qt!==null&&!f2();)Sb(qt)}function Sb(e){var t=Cb(e.alternate,e,Gn);e.memoizedProps=e.pendingProps,t===null?kb(e):qt=t,tf.current=null}function kb(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=LS(n,t),n!==null){n.flags&=32767,qt=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Qt=6,qt=null;return}}else if(n=$S(n,t,Gn),n!==null){qt=n;return}if(t=t.sibling,t!==null){qt=t;return}qt=t=e}while(t!==null);Qt===0&&(Qt=5)}function us(e,t,n){var r=xt,i=ur.transition;try{ur.transition=null,xt=1,WS(e,t,n,r)}finally{ur.transition=i,xt=r}return null}function WS(e,t,n,r){do Ao();while(Li!==null);if(mt&6)throw Error(Ee(327));n=e.finishedWork;var i=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(Ee(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(k2(e,s),e===tn&&(qt=tn=null,cn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Xl||(Xl=!0,Eb(Rc,function(){return Ao(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=ur.transition,ur.transition=null;var a=xt;xt=1;var l=mt;mt|=4,tf.current=null,DS(e,n),yb(n,e),dS(_h),Ac=!!wh,_h=wh=null,e.current=n,zS(n),m2(),mt=l,xt=a,ur.transition=s}else e.current=n;if(Xl&&(Xl=!1,Li=e,Xc=i),s=e.pendingLanes,s===0&&(Hi=null),y2(n.stateNode),Ln(e,Ut()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Yc)throw Yc=!1,e=Hh,Hh=null,e;return Xc&1&&e.tag!==0&&Ao(),s=e.pendingLanes,s&1?e===Uh?Ha++:(Ha=0,Uh=e):Ha=0,Ki(),null}function Ao(){if(Li!==null){var e=ix(Xc),t=ur.transition,n=xt;try{if(ur.transition=null,xt=16>e?16:e,Li===null)var r=!1;else{if(e=Li,Li=null,Xc=0,mt&6)throw Error(Ee(331));var i=mt;for(mt|=4,Fe=e.current;Fe!==null;){var s=Fe,a=s.child;if(Fe.flags&16){var l=s.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(Fe=d;Fe!==null;){var u=Fe;switch(u.tag){case 0:case 11:case 15:Fa(8,u,s)}var p=u.child;if(p!==null)p.return=u,Fe=p;else for(;Fe!==null;){u=Fe;var h=u.sibling,f=u.return;if(mb(u),u===d){Fe=null;break}if(h!==null){h.return=f,Fe=h;break}Fe=f}}}var m=s.alternate;if(m!==null){var g=m.child;if(g!==null){m.child=null;do{var x=g.sibling;g.sibling=null,g=x}while(g!==null)}}Fe=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,Fe=a;else e:for(;Fe!==null;){if(s=Fe,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Fa(9,s,s.return)}var y=s.sibling;if(y!==null){y.return=s.return,Fe=y;break e}Fe=s.return}}var v=e.current;for(Fe=v;Fe!==null;){a=Fe;var b=a.child;if(a.subtreeFlags&2064&&b!==null)b.return=a,Fe=b;else e:for(a=v;Fe!==null;){if(l=Fe,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Cd(9,l)}}catch(C){Ht(l,l.return,C)}if(l===a){Fe=null;break e}var w=l.sibling;if(w!==null){w.return=l.return,Fe=w;break e}Fe=l.return}}if(mt=i,Ki(),Ur&&typeof Ur.onPostCommitFiberRoot=="function")try{Ur.onPostCommitFiberRoot(yd,e)}catch{}r=!0}return r}finally{xt=n,ur.transition=t}}return!1}function Pg(e,t,n){t=Bo(n,t),t=ib(e,t,1),e=Bi(e,t,1),t=jn(),e!==null&&(vl(e,1,t),Ln(e,t))}function Ht(e,t,n){if(e.tag===3)Pg(e,e,n);else for(;t!==null;){if(t.tag===3){Pg(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Hi===null||!Hi.has(r))){e=Bo(n,e),e=sb(t,e,1),t=Bi(t,e,1),e=jn(),t!==null&&(vl(t,1,e),Ln(t,e));break}}t=t.return}}function GS(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=jn(),e.pingedLanes|=e.suspendedLanes&n,tn===e&&(cn&n)===n&&(Qt===4||Qt===3&&(cn&130023424)===cn&&500>Ut()-rf?_s(e,0):nf|=n),Ln(e,t)}function jb(e,t){t===0&&(e.mode&1?(t=zl,zl<<=1,!(zl&130023424)&&(zl=4194304)):t=1);var n=jn();e=di(e,t),e!==null&&(vl(e,t,n),Ln(e,n))}function VS(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),jb(e,n)}function qS(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(Ee(314))}r!==null&&r.delete(t),jb(e,n)}var Cb;Cb=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Mn.current)An=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return An=!1,MS(e,t,n);An=!!(e.flags&131072)}else An=!1,It&&t.flags&1048576&&Px(t,Fc,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Sc(e,t),e=t.pendingProps;var i=Io(t,bn.current);Oo(t,n),i=Zp(null,t,r,e,i,n);var s=Kp();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,$n(r)?(s=!0,Dc(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Gp(t),i.updater=jd,t.stateNode=i,i._reactInternals=t,Rh(t,r,e,n),t=Mh(null,t,r,!0,s,n)):(t.tag=0,It&&s&&Dp(t),Sn(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Sc(e,t),e=t.pendingProps,i=r._init,r=i(r._payload),t.type=r,i=t.tag=XS(r),e=xr(r,e),i){case 0:t=Ah(null,t,r,e,n);break e;case 1:t=bg(null,t,r,e,n);break e;case 11:t=yg(null,t,r,e,n);break e;case 14:t=xg(null,t,r,xr(r.type,e),n);break e}throw Error(Ee(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:xr(r,i),Ah(e,t,r,i,n);case 1:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:xr(r,i),bg(e,t,r,i,n);case 3:e:{if(cb(t),e===null)throw Error(Ee(387));r=t.pendingProps,s=t.memoizedState,i=s.element,Lx(e,t),Uc(t,r,null,n);var a=t.memoizedState;if(r=a.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=Bo(Error(Ee(423)),t),t=wg(e,t,r,n,i);break e}else if(r!==i){i=Bo(Error(Ee(424)),t),t=wg(e,t,r,n,i);break e}else for(Yn=Fi(t.stateNode.containerInfo.firstChild),Kn=t,It=!0,Sr=null,n=Mx(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Do(),r===i){t=ui(e,t,n);break e}Sn(e,t,r,n)}t=t.child}return t;case 5:return Ix(t),e===null&&Th(t),r=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,a=i.children,Sh(r,i)?a=null:s!==null&&Sh(r,s)&&(t.flags|=32),lb(e,t),Sn(e,t,a,n),t.child;case 6:return e===null&&Th(t),null;case 13:return db(e,t,n);case 4:return Vp(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=zo(t,null,r,n):Sn(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:xr(r,i),yg(e,t,r,i,n);case 7:return Sn(e,t,t.pendingProps,n),t.child;case 8:return Sn(e,t,t.pendingProps.children,n),t.child;case 12:return Sn(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,s=t.memoizedProps,a=i.value,Tt(Bc,r._currentValue),r._currentValue=a,s!==null)if(Er(s.value,a)){if(s.children===i.children&&!Mn.current){t=ui(e,t,n);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var l=s.dependencies;if(l!==null){a=s.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(s.tag===1){c=ai(-1,n&-n),c.tag=2;var d=s.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}s.lanes|=n,c=s.alternate,c!==null&&(c.lanes|=n),Nh(s.return,n,t),l.lanes|=n;break}c=c.next}}else if(s.tag===10)a=s.type===t.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(Ee(341));a.lanes|=n,l=a.alternate,l!==null&&(l.lanes|=n),Nh(a,n,t),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===t){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}Sn(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Oo(t,n),i=hr(i),r=r(i),t.flags|=1,Sn(e,t,r,n),t.child;case 14:return r=t.type,i=xr(r,t.pendingProps),i=xr(r.type,i),xg(e,t,r,i,n);case 15:return ob(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:xr(r,i),Sc(e,t),t.tag=1,$n(r)?(e=!0,Dc(t)):e=!1,Oo(t,n),rb(t,r,i),Rh(t,r,i,n),Mh(null,t,r,!0,e,n);case 19:return ub(e,t,n);case 22:return ab(e,t,n)}throw Error(Ee(156,t.tag))};function Eb(e,t){return ex(e,t)}function YS(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function dr(e,t,n,r){return new YS(e,t,n,r)}function lf(e){return e=e.prototype,!(!e||!e.isReactComponent)}function XS(e){if(typeof e=="function")return lf(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Cp)return 11;if(e===Ep)return 14}return 2}function Wi(e,t){var n=e.alternate;return n===null?(n=dr(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Cc(e,t,n,r,i,s){var a=2;if(r=e,typeof e=="function")lf(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case go:return Ss(n.children,i,s,t);case jp:a=8,i|=8;break;case th:return e=dr(12,n,t,i|2),e.elementType=th,e.lanes=s,e;case nh:return e=dr(13,n,t,i),e.elementType=nh,e.lanes=s,e;case rh:return e=dr(19,n,t,i),e.elementType=rh,e.lanes=s,e;case Iy:return Td(n,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case $y:a=10;break e;case Ly:a=9;break e;case Cp:a=11;break e;case Ep:a=14;break e;case Ei:a=16,r=null;break e}throw Error(Ee(130,e==null?e:typeof e,""))}return t=dr(a,n,t,i),t.elementType=e,t.type=r,t.lanes=s,t}function Ss(e,t,n,r){return e=dr(7,e,r,t),e.lanes=n,e}function Td(e,t,n,r){return e=dr(22,e,r,t),e.elementType=Iy,e.lanes=n,e.stateNode={isHidden:!1},e}function Su(e,t,n){return e=dr(6,e,null,t),e.lanes=n,e}function ku(e,t,n){return t=dr(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function ZS(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=iu(0),this.expirationTimes=iu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=iu(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function cf(e,t,n,r,i,s,a,l,c){return e=new ZS(e,t,n,l,c),t===1?(t=1,s===!0&&(t|=8)):t=0,s=dr(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Gp(s),e}function KS(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:mo,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function Tb(e){if(!e)return Vi;e=e._reactInternals;e:{if(Os(e)!==e||e.tag!==1)throw Error(Ee(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if($n(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Ee(171))}if(e.tag===1){var n=e.type;if($n(n))return Tx(e,n,t)}return t}function Nb(e,t,n,r,i,s,a,l,c){return e=cf(n,r,!0,e,i,s,a,l,c),e.context=Tb(null),n=e.current,r=jn(),i=Ui(n),s=ai(r,i),s.callback=t??null,Bi(n,s,i),e.current.lanes=i,vl(e,i,r),Ln(e,r),e}function Nd(e,t,n,r){var i=t.current,s=jn(),a=Ui(i);return n=Tb(n),t.context===null?t.context=n:t.pendingContext=n,t=ai(s,a),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Bi(i,t,a),e!==null&&(Cr(e,i,a,s),bc(e,i,a)),a}function Kc(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Rg(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function df(e,t){Rg(e,t),(e=e.alternate)&&Rg(e,t)}function JS(){return null}var Pb=typeof reportError=="function"?reportError:function(e){console.error(e)};function uf(e){this._internalRoot=e}Pd.prototype.render=uf.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Ee(409));Nd(e,t,null,null)};Pd.prototype.unmount=uf.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ns(function(){Nd(null,e,null,null)}),t[ci]=null}};function Pd(e){this._internalRoot=e}Pd.prototype.unstable_scheduleHydration=function(e){if(e){var t=ax();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Pi.length&&t!==0&&t<Pi[n].priority;n++);Pi.splice(n,0,e),n===0&&cx(e)}};function hf(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Rd(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Og(){}function QS(e,t,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var d=Kc(a);s.call(d)}}var a=Nb(t,r,e,0,null,!1,!1,"",Og);return e._reactRootContainer=a,e[ci]=a.current,tl(e.nodeType===8?e.parentNode:e),Ns(),a}for(;i=e.lastChild;)e.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var d=Kc(c);l.call(d)}}var c=cf(e,0,!1,null,null,!1,!1,"",Og);return e._reactRootContainer=c,e[ci]=c.current,tl(e.nodeType===8?e.parentNode:e),Ns(function(){Nd(t,c,n,r)}),c}function Od(e,t,n,r,i){var s=n._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var l=i;i=function(){var c=Kc(a);l.call(c)}}Nd(t,a,e,i)}else a=QS(n,t,e,i,r);return Kc(a)}sx=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Ta(t.pendingLanes);n!==0&&(Pp(t,n|1),Ln(t,Ut()),!(mt&6)&&(Ho=Ut()+500,Ki()))}break;case 13:Ns(function(){var r=di(e,1);if(r!==null){var i=jn();Cr(r,e,1,i)}}),df(e,1)}};Rp=function(e){if(e.tag===13){var t=di(e,134217728);if(t!==null){var n=jn();Cr(t,e,134217728,n)}df(e,134217728)}};ox=function(e){if(e.tag===13){var t=Ui(e),n=di(e,t);if(n!==null){var r=jn();Cr(n,e,t,r)}df(e,t)}};ax=function(){return xt};lx=function(e,t){var n=xt;try{return xt=e,t()}finally{xt=n}};ph=function(e,t,n){switch(t){case"input":if(oh(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=_d(r);if(!i)throw Error(Ee(90));zy(r),oh(r,i)}}}break;case"textarea":By(e,n);break;case"select":t=n.value,t!=null&&To(e,!!n.multiple,t,!1)}};Yy=sf;Xy=Ns;var ek={usingClientEntryPoint:!1,Events:[xl,bo,_d,Vy,qy,sf]},xa={findFiberByHostInstance:ys,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},tk={bundleType:xa.bundleType,version:xa.version,rendererPackageName:xa.rendererPackageName,rendererConfig:xa.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:hi.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Jy(e),e===null?null:e.stateNode},findFiberByHostInstance:xa.findFiberByHostInstance||JS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Zl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Zl.isDisabled&&Zl.supportsFiber)try{yd=Zl.inject(tk),Ur=Zl}catch{}}er.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ek;er.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!hf(t))throw Error(Ee(200));return KS(e,t,null,n)};er.createRoot=function(e,t){if(!hf(e))throw Error(Ee(299));var n=!1,r="",i=Pb;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=cf(e,1,!1,null,null,n,!1,r,i),e[ci]=t.current,tl(e.nodeType===8?e.parentNode:e),new uf(t)};er.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Ee(188)):(e=Object.keys(e).join(","),Error(Ee(268,e)));return e=Jy(t),e=e===null?null:e.stateNode,e};er.flushSync=function(e){return Ns(e)};er.hydrate=function(e,t,n){if(!Rd(t))throw Error(Ee(200));return Od(null,e,t,!0,n)};er.hydrateRoot=function(e,t,n){if(!hf(e))throw Error(Ee(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",a=Pb;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),t=Nb(t,null,e,1,n??null,i,!1,s,a),e[ci]=t.current,tl(e),r)for(e=0;e<r.length;e++)n=r[e],i=n._getVersion,i=i(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Pd(t)};er.render=function(e,t,n){if(!Rd(t))throw Error(Ee(200));return Od(null,e,t,!1,n)};er.unmountComponentAtNode=function(e){if(!Rd(e))throw Error(Ee(40));return e._reactRootContainer?(Ns(function(){Od(null,null,e,!1,function(){e._reactRootContainer=null,e[ci]=null})}),!0):!1};er.unstable_batchedUpdates=sf;er.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Rd(n))throw Error(Ee(200));if(e==null||e._reactInternals===void 0)throw Error(Ee(38));return Od(e,t,n,!1,r)};er.version="18.3.1-next-f1338f8080-20240426";function Rb(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Rb)}catch(e){console.error(e)}}Rb(),Ry.exports=er;var nk=Ry.exports,Ag=nk;Qu.createRoot=Ag.createRoot,Qu.hydrateRoot=Ag.hydrateRoot;var Vh=function(e,t){return Vh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},Vh(e,t)};function Ob(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Vh(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var Jc=function(){return Jc=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Jc.apply(this,arguments)};function qo(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}function Ab(e,t,n,r){var i=arguments.length,s=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(s=(i<3?a(s):i>3?a(t,n,s):a(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s}function Mb(e,t){return function(n,r){t(n,r,e)}}function $b(e,t,n,r,i,s){function a(y){if(y!==void 0&&typeof y!="function")throw new TypeError("Function expected");return y}for(var l=r.kind,c=l==="getter"?"get":l==="setter"?"set":"value",d=!t&&e?r.static?e:e.prototype:null,u=t||(d?Object.getOwnPropertyDescriptor(d,r.name):{}),p,h=!1,f=n.length-1;f>=0;f--){var m={};for(var g in r)m[g]=g==="access"?{}:r[g];for(var g in r.access)m.access[g]=r.access[g];m.addInitializer=function(y){if(h)throw new TypeError("Cannot add initializers after decoration has completed");s.push(a(y||null))};var x=(0,n[f])(l==="accessor"?{get:u.get,set:u.set}:u[c],m);if(l==="accessor"){if(x===void 0)continue;if(x===null||typeof x!="object")throw new TypeError("Object expected");(p=a(x.get))&&(u.get=p),(p=a(x.set))&&(u.set=p),(p=a(x.init))&&i.unshift(p)}else(p=a(x))&&(l==="field"?i.unshift(p):u[c]=p)}d&&Object.defineProperty(d,r.name,u),h=!0}function Lb(e,t,n){for(var r=arguments.length>2,i=0;i<t.length;i++)n=r?t[i].call(e,n):t[i].call(e);return r?n:void 0}function Ib(e){return typeof e=="symbol"?e:"".concat(e)}function Db(e,t,n){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})}function zb(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function Ue(e,t,n,r){function i(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function l(u){try{d(r.next(u))}catch(p){a(p)}}function c(u){try{d(r.throw(u))}catch(p){a(p)}}function d(u){u.done?s(u.value):i(u.value).then(l,c)}d((r=r.apply(e,t||[])).next())})}function Fb(e,t){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,a=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return a.next=l(0),a.throw=l(1),a.return=l(2),typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function l(d){return function(u){return c([d,u])}}function c(d){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,d[0]&&(n=0)),n;)try{if(r=1,i&&(s=d[0]&2?i.return:d[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,d[1])).done)return s;switch(i=0,s&&(d=[d[0]&2,s.value]),d[0]){case 0:case 1:s=d;break;case 4:return n.label++,{value:d[1],done:!1};case 5:n.label++,i=d[1],d=[0];continue;case 7:d=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(d[0]===6||d[0]===2)){n=0;continue}if(d[0]===3&&(!s||d[1]>s[0]&&d[1]<s[3])){n.label=d[1];break}if(d[0]===6&&n.label<s[1]){n.label=s[1],s=d;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(d);break}s[2]&&n.ops.pop(),n.trys.pop();continue}d=t.call(e,n)}catch(u){d=[6,u],i=0}finally{r=s=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}var Ad=Object.create?function(e,t,n,r){r===void 0&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]};function Bb(e,t){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&Ad(t,e,n)}function Qc(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function pf(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),i,s=[],a;try{for(;(t===void 0||t-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(l){a={error:l}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return s}function Hb(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(pf(arguments[t]));return e}function Ub(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var r=Array(e),i=0,t=0;t<n;t++)for(var s=arguments[t],a=0,l=s.length;a<l;a++,i++)r[i]=s[a];return r}function Wb(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,s;r<i;r++)(s||!(r in t))&&(s||(s=Array.prototype.slice.call(t,0,r)),s[r]=t[r]);return e.concat(s||Array.prototype.slice.call(t))}function Uo(e){return this instanceof Uo?(this.v=e,this):new Uo(e)}function Gb(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",a),i[Symbol.asyncIterator]=function(){return this},i;function a(f){return function(m){return Promise.resolve(m).then(f,p)}}function l(f,m){r[f]&&(i[f]=function(g){return new Promise(function(x,y){s.push([f,g,x,y])>1||c(f,g)})},m&&(i[f]=m(i[f])))}function c(f,m){try{d(r[f](m))}catch(g){h(s[0][3],g)}}function d(f){f.value instanceof Uo?Promise.resolve(f.value.v).then(u,p):h(s[0][2],f)}function u(f){c("next",f)}function p(f){c("throw",f)}function h(f,m){f(m),s.shift(),s.length&&c(s[0][0],s[0][1])}}function Vb(e){var t,n;return t={},r("next"),r("throw",function(i){throw i}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(i,s){t[i]=e[i]?function(a){return(n=!n)?{value:Uo(e[i](a)),done:!1}:s?s(a):a}:s}}function qb(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof Qc=="function"?Qc(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=e[s]&&function(a){return new Promise(function(l,c){a=e[s](a),i(l,c,a.done,a.value)})}}function i(s,a,l,c){Promise.resolve(c).then(function(d){s({value:d,done:l})},a)}}function Yb(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var rk=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},qh=function(e){return qh=Object.getOwnPropertyNames||function(t){var n=[];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[n.length]=r);return n},qh(e)};function Xb(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n=qh(e),r=0;r<n.length;r++)n[r]!=="default"&&Ad(t,e,n[r]);return rk(t,e),t}function Zb(e){return e&&e.__esModule?e:{default:e}}function Kb(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)}function Jb(e,t,n,r,i){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?i.call(e,n):i?i.value=n:t.set(e,n),n}function Qb(e,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof e=="function"?t===e:e.has(t)}function ew(e,t,n){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var r,i;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],n&&(i=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");i&&(r=function(){try{i.call(this)}catch(s){return Promise.reject(s)}}),e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t}var ik=typeof SuppressedError=="function"?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r};function tw(e){function t(s){e.error=e.hasError?new ik(s,e.error,"An error was suppressed during disposal."):s,e.hasError=!0}var n,r=0;function i(){for(;n=e.stack.pop();)try{if(!n.async&&r===1)return r=0,e.stack.push(n),Promise.resolve().then(i);if(n.dispose){var s=n.dispose.call(n.value);if(n.async)return r|=2,Promise.resolve(s).then(i,function(a){return t(a),i()})}else r|=1}catch(a){t(a)}if(r===1)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}return i()}function nw(e,t){return typeof e=="string"&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(n,r,i,s,a){return r?t?".jsx":".js":i&&(!s||!a)?n:i+s+"."+a.toLowerCase()+"js"}):e}const sk={__extends:Ob,__assign:Jc,__rest:qo,__decorate:Ab,__param:Mb,__esDecorate:$b,__runInitializers:Lb,__propKey:Ib,__setFunctionName:Db,__metadata:zb,__awaiter:Ue,__generator:Fb,__createBinding:Ad,__exportStar:Bb,__values:Qc,__read:pf,__spread:Hb,__spreadArrays:Ub,__spreadArray:Wb,__await:Uo,__asyncGenerator:Gb,__asyncDelegator:Vb,__asyncValues:qb,__makeTemplateObject:Yb,__importStar:Xb,__importDefault:Zb,__classPrivateFieldGet:Kb,__classPrivateFieldSet:Jb,__classPrivateFieldIn:Qb,__addDisposableResource:ew,__disposeResources:tw,__rewriteRelativeImportExtension:nw},ok=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:ew,get __assign(){return Jc},__asyncDelegator:Vb,__asyncGenerator:Gb,__asyncValues:qb,__await:Uo,__awaiter:Ue,__classPrivateFieldGet:Kb,__classPrivateFieldIn:Qb,__classPrivateFieldSet:Jb,__createBinding:Ad,__decorate:Ab,__disposeResources:tw,__esDecorate:$b,__exportStar:Bb,__extends:Ob,__generator:Fb,__importDefault:Zb,__importStar:Xb,__makeTemplateObject:Yb,__metadata:zb,__param:Mb,__propKey:Ib,__read:pf,__rest:qo,__rewriteRelativeImportExtension:nw,__runInitializers:Lb,__setFunctionName:Db,__spread:Hb,__spreadArray:Wb,__spreadArrays:Ub,__values:Qc,default:sk},Symbol.toStringTag,{value:"Module"})),ak=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class ff extends Error{constructor(t,n="FunctionsError",r){super(t),this.name=n,this.context=r}}class Mg extends ff{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class $g extends ff{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Lg extends ff{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Yh;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Yh||(Yh={}));class lk{constructor(t,{headers:n={},customFetch:r,region:i=Yh.Any}={}){this.url=t,this.headers=n,this.region=i,this.fetch=ak(r)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return Ue(this,arguments,void 0,function*(n,r={}){var i;try{const{headers:s,method:a,body:l,signal:c}=r;let d={},{region:u}=r;u||(u=this.region);const p=new URL(`${this.url}/${n}`);u&&u!=="any"&&(d["x-region"]=u,p.searchParams.set("forceFunctionRegion",u));let h;l&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)?typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(d["Content-Type"]="application/octet-stream",h=l):typeof l=="string"?(d["Content-Type"]="text/plain",h=l):typeof FormData<"u"&&l instanceof FormData?h=l:(d["Content-Type"]="application/json",h=JSON.stringify(l)):h=l;const f=yield this.fetch(p.toString(),{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},d),this.headers),s),body:h,signal:c}).catch(y=>{throw y.name==="AbortError"?y:new Mg(y)}),m=f.headers.get("x-relay-error");if(m&&m==="true")throw new $g(f);if(!f.ok)throw new Lg(f);let g=((i=f.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),x;return g==="application/json"?x=yield f.json():g==="application/octet-stream"||g==="application/pdf"?x=yield f.blob():g==="text/event-stream"?x=f:g==="multipart/form-data"?x=yield f.formData():x=yield f.text(),{data:x,error:null,response:f}}catch(s){return s instanceof Error&&s.name==="AbortError"?{data:null,error:new Mg(s)}:{data:null,error:s,response:s instanceof Lg||s instanceof $g?s.context:void 0}}})}}var kn={};const Yo=P_(ok);var Kl={},Jl={},Ql={},ec={},tc={},nc={},Ig;function rw(){if(Ig)return nc;Ig=1,Object.defineProperty(nc,"__esModule",{value:!0});class e extends Error{constructor(n){super(n.message),this.name="PostgrestError",this.details=n.details,this.hint=n.hint,this.code=n.code}}return nc.default=e,nc}var Dg;function iw(){if(Dg)return tc;Dg=1,Object.defineProperty(tc,"__esModule",{value:!0});const t=Yo.__importDefault(rw());class n{constructor(i){var s,a;this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=new Headers(i.headers),this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=(s=i.shouldThrowOnError)!==null&&s!==void 0?s:!1,this.signal=i.signal,this.isMaybeSingle=(a=i.isMaybeSingle)!==null&&a!==void 0?a:!1,i.fetch?this.fetch=i.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,s){return this.headers=new Headers(this.headers),this.headers.set(i,s),this}then(i,s){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const a=this.fetch;let l=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var d,u,p,h;let f=null,m=null,g=null,x=c.status,y=c.statusText;if(c.ok){if(this.method!=="HEAD"){const C=await c.text();C===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((d=this.headers.get("Accept"))===null||d===void 0)&&d.includes("application/vnd.pgrst.plan+text"))?m=C:m=JSON.parse(C))}const b=(u=this.headers.get("Prefer"))===null||u===void 0?void 0:u.match(/count=(exact|planned|estimated)/),w=(p=c.headers.get("content-range"))===null||p===void 0?void 0:p.split("/");b&&w&&w.length>1&&(g=parseInt(w[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(m)&&(m.length>1?(f={code:"PGRST116",details:`Results contain ${m.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},m=null,g=null,x=406,y="Not Acceptable"):m.length===1?m=m[0]:m=null)}else{const b=await c.text();try{f=JSON.parse(b),Array.isArray(f)&&c.status===404&&(m=[],f=null,x=200,y="OK")}catch{c.status===404&&b===""?(x=204,y="No Content"):f={message:b}}if(f&&this.isMaybeSingle&&(!((h=f==null?void 0:f.details)===null||h===void 0)&&h.includes("0 rows"))&&(f=null,x=200,y="OK"),f&&this.shouldThrowOnError)throw new t.default(f)}return{error:f,data:m,count:g,status:x,statusText:y}});return this.shouldThrowOnError||(l=l.catch(c=>{var d,u,p;return{error:{message:`${(d=c==null?void 0:c.name)!==null&&d!==void 0?d:"FetchError"}: ${c==null?void 0:c.message}`,details:`${(u=c==null?void 0:c.stack)!==null&&u!==void 0?u:""}`,hint:"",code:`${(p=c==null?void 0:c.code)!==null&&p!==void 0?p:""}`},data:null,count:null,status:0,statusText:""}})),l.then(i,s)}returns(){return this}overrideTypes(){return this}}return tc.default=n,tc}var zg;function sw(){if(zg)return ec;zg=1,Object.defineProperty(ec,"__esModule",{value:!0});const t=Yo.__importDefault(iw());class n extends t.default{select(i){let s=!1;const a=(i??"*").split("").map(l=>/\s/.test(l)&&!s?"":(l==='"'&&(s=!s),l)).join("");return this.url.searchParams.set("select",a),this.headers.append("Prefer","return=representation"),this}order(i,{ascending:s=!0,nullsFirst:a,foreignTable:l,referencedTable:c=l}={}){const d=c?`${c}.order`:"order",u=this.url.searchParams.get(d);return this.url.searchParams.set(d,`${u?`${u},`:""}${i}.${s?"asc":"desc"}${a===void 0?"":a?".nullsfirst":".nullslast"}`),this}limit(i,{foreignTable:s,referencedTable:a=s}={}){const l=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(l,`${i}`),this}range(i,s,{foreignTable:a,referencedTable:l=a}={}){const c=typeof l>"u"?"offset":`${l}.offset`,d=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${i}`),this.url.searchParams.set(d,`${s-i+1}`),this}abortSignal(i){return this.signal=i,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:i=!1,verbose:s=!1,settings:a=!1,buffers:l=!1,wal:c=!1,format:d="text"}={}){var u;const p=[i?"analyze":null,s?"verbose":null,a?"settings":null,l?"buffers":null,c?"wal":null].filter(Boolean).join("|"),h=(u=this.headers.get("Accept"))!==null&&u!==void 0?u:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${d}; for="${h}"; options=${p};`),d==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(i){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${i}`),this}}return ec.default=n,ec}var Fg;function mf(){if(Fg)return Ql;Fg=1,Object.defineProperty(Ql,"__esModule",{value:!0});const t=Yo.__importDefault(sw()),n=new RegExp("[,()]");class r extends t.default{eq(s,a){return this.url.searchParams.append(s,`eq.${a}`),this}neq(s,a){return this.url.searchParams.append(s,`neq.${a}`),this}gt(s,a){return this.url.searchParams.append(s,`gt.${a}`),this}gte(s,a){return this.url.searchParams.append(s,`gte.${a}`),this}lt(s,a){return this.url.searchParams.append(s,`lt.${a}`),this}lte(s,a){return this.url.searchParams.append(s,`lte.${a}`),this}like(s,a){return this.url.searchParams.append(s,`like.${a}`),this}likeAllOf(s,a){return this.url.searchParams.append(s,`like(all).{${a.join(",")}}`),this}likeAnyOf(s,a){return this.url.searchParams.append(s,`like(any).{${a.join(",")}}`),this}ilike(s,a){return this.url.searchParams.append(s,`ilike.${a}`),this}ilikeAllOf(s,a){return this.url.searchParams.append(s,`ilike(all).{${a.join(",")}}`),this}ilikeAnyOf(s,a){return this.url.searchParams.append(s,`ilike(any).{${a.join(",")}}`),this}is(s,a){return this.url.searchParams.append(s,`is.${a}`),this}in(s,a){const l=Array.from(new Set(a)).map(c=>typeof c=="string"&&n.test(c)?`"${c}"`:`${c}`).join(",");return this.url.searchParams.append(s,`in.(${l})`),this}contains(s,a){return typeof a=="string"?this.url.searchParams.append(s,`cs.${a}`):Array.isArray(a)?this.url.searchParams.append(s,`cs.{${a.join(",")}}`):this.url.searchParams.append(s,`cs.${JSON.stringify(a)}`),this}containedBy(s,a){return typeof a=="string"?this.url.searchParams.append(s,`cd.${a}`):Array.isArray(a)?this.url.searchParams.append(s,`cd.{${a.join(",")}}`):this.url.searchParams.append(s,`cd.${JSON.stringify(a)}`),this}rangeGt(s,a){return this.url.searchParams.append(s,`sr.${a}`),this}rangeGte(s,a){return this.url.searchParams.append(s,`nxl.${a}`),this}rangeLt(s,a){return this.url.searchParams.append(s,`sl.${a}`),this}rangeLte(s,a){return this.url.searchParams.append(s,`nxr.${a}`),this}rangeAdjacent(s,a){return this.url.searchParams.append(s,`adj.${a}`),this}overlaps(s,a){return typeof a=="string"?this.url.searchParams.append(s,`ov.${a}`):this.url.searchParams.append(s,`ov.{${a.join(",")}}`),this}textSearch(s,a,{config:l,type:c}={}){let d="";c==="plain"?d="pl":c==="phrase"?d="ph":c==="websearch"&&(d="w");const u=l===void 0?"":`(${l})`;return this.url.searchParams.append(s,`${d}fts${u}.${a}`),this}match(s){return Object.entries(s).forEach(([a,l])=>{this.url.searchParams.append(a,`eq.${l}`)}),this}not(s,a,l){return this.url.searchParams.append(s,`not.${a}.${l}`),this}or(s,{foreignTable:a,referencedTable:l=a}={}){const c=l?`${l}.or`:"or";return this.url.searchParams.append(c,`(${s})`),this}filter(s,a,l){return this.url.searchParams.append(s,`${a}.${l}`),this}}return Ql.default=r,Ql}var Bg;function ow(){if(Bg)return Jl;Bg=1,Object.defineProperty(Jl,"__esModule",{value:!0});const t=Yo.__importDefault(mf());class n{constructor(i,{headers:s={},schema:a,fetch:l}){this.url=i,this.headers=new Headers(s),this.schema=a,this.fetch=l}select(i,s){const{head:a=!1,count:l}=s??{},c=a?"HEAD":"GET";let d=!1;const u=(i??"*").split("").map(p=>/\s/.test(p)&&!d?"":(p==='"'&&(d=!d),p)).join("");return this.url.searchParams.set("select",u),l&&this.headers.append("Prefer",`count=${l}`),new t.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(i,{count:s,defaultToNull:a=!0}={}){var l;const c="POST";if(s&&this.headers.append("Prefer",`count=${s}`),a||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const d=i.reduce((u,p)=>u.concat(Object.keys(p)),[]);if(d.length>0){const u=[...new Set(d)].map(p=>`"${p}"`);this.url.searchParams.set("columns",u.join(","))}}return new t.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}upsert(i,{onConflict:s,ignoreDuplicates:a=!1,count:l,defaultToNull:c=!0}={}){var d;const u="POST";if(this.headers.append("Prefer",`resolution=${a?"ignore":"merge"}-duplicates`),s!==void 0&&this.url.searchParams.set("on_conflict",s),l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const p=i.reduce((h,f)=>h.concat(Object.keys(f)),[]);if(p.length>0){const h=[...new Set(p)].map(f=>`"${f}"`);this.url.searchParams.set("columns",h.join(","))}}return new t.default({method:u,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}update(i,{count:s}={}){var a;const l="PATCH";return s&&this.headers.append("Prefer",`count=${s}`),new t.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}delete({count:i}={}){var s;const a="DELETE";return i&&this.headers.append("Prefer",`count=${i}`),new t.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}}return Jl.default=n,Jl}var Hg;function ck(){if(Hg)return Kl;Hg=1,Object.defineProperty(Kl,"__esModule",{value:!0});const e=Yo,t=e.__importDefault(ow()),n=e.__importDefault(mf());class r{constructor(s,{headers:a={},schema:l,fetch:c}={}){this.url=s,this.headers=new Headers(a),this.schemaName=l,this.fetch=c}from(s){const a=new URL(`${this.url}/${s}`);return new t.default(a,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(s){return new r(this.url,{headers:this.headers,schema:s,fetch:this.fetch})}rpc(s,a={},{head:l=!1,get:c=!1,count:d}={}){var u;let p;const h=new URL(`${this.url}/rpc/${s}`);let f;l||c?(p=l?"HEAD":"GET",Object.entries(a).filter(([g,x])=>x!==void 0).map(([g,x])=>[g,Array.isArray(x)?`{${x.join(",")}}`:`${x}`]).forEach(([g,x])=>{h.searchParams.append(g,x)})):(p="POST",f=a);const m=new Headers(this.headers);return d&&m.set("Prefer",`count=${d}`),new n.default({method:p,url:h,headers:m,schema:this.schemaName,body:f,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}}return Kl.default=r,Kl}Object.defineProperty(kn,"__esModule",{value:!0});var aw=kn.PostgrestError=vw=kn.PostgrestBuilder=mw=kn.PostgrestTransformBuilder=pw=kn.PostgrestFilterBuilder=uw=kn.PostgrestQueryBuilder=cw=kn.PostgrestClient=void 0;const Xo=Yo,lw=Xo.__importDefault(ck());var cw=kn.PostgrestClient=lw.default;const dw=Xo.__importDefault(ow());var uw=kn.PostgrestQueryBuilder=dw.default;const hw=Xo.__importDefault(mf());var pw=kn.PostgrestFilterBuilder=hw.default;const fw=Xo.__importDefault(sw());var mw=kn.PostgrestTransformBuilder=fw.default;const gw=Xo.__importDefault(iw());var vw=kn.PostgrestBuilder=gw.default;const yw=Xo.__importDefault(rw());aw=kn.PostgrestError=yw.default;var xw=kn.default={PostgrestClient:lw.default,PostgrestQueryBuilder:dw.default,PostgrestFilterBuilder:hw.default,PostgrestTransformBuilder:fw.default,PostgrestBuilder:gw.default,PostgrestError:yw.default};const dk=N_({__proto__:null,get PostgrestBuilder(){return vw},get PostgrestClient(){return cw},get PostgrestError(){return aw},get PostgrestFilterBuilder(){return pw},get PostgrestQueryBuilder(){return uw},get PostgrestTransformBuilder(){return mw},default:xw},[kn]),{PostgrestClient:uk,PostgrestQueryBuilder:U7,PostgrestFilterBuilder:W7,PostgrestTransformBuilder:G7,PostgrestBuilder:V7,PostgrestError:q7}=xw||dk;class hk{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const n=process.versions;if(n&&n.node){const r=n.node,i=parseInt(r.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let n=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(n+=`

Suggested solution: ${t.workaround}`),new Error(n)}static createWebSocket(t,n){const r=this.getWebSocketConstructor();return new r(t,n)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const pk="2.79.0",fk=`realtime-js/${pk}`,mk="1.0.0",Xh=1e4,gk=1e3,vk=100;var Ua;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Ua||(Ua={}));var Zt;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Zt||(Zt={}));var _r;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(_r||(_r={}));var Zh;(function(e){e.websocket="websocket"})(Zh||(Zh={}));var fs;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(fs||(fs={}));class yk{constructor(){this.HEADER_LENGTH=1}decode(t,n){return t.constructor===ArrayBuffer?n(this._binaryDecode(t)):n(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const n=new DataView(t),r=new TextDecoder;return this._decodeBroadcast(t,n,r)}_decodeBroadcast(t,n,r){const i=n.getUint8(1),s=n.getUint8(2);let a=this.HEADER_LENGTH+2;const l=r.decode(t.slice(a,a+i));a=a+i;const c=r.decode(t.slice(a,a+s));a=a+s;const d=JSON.parse(r.decode(t.slice(a,t.byteLength)));return{ref:null,topic:l,event:c,payload:d}}}class bw{constructor(t,n){this.callback=t,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ct;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Ct||(Ct={}));const Ug=(e,t,n={})=>{var r;const i=(r=n.skipTypes)!==null&&r!==void 0?r:[];return t?Object.keys(t).reduce((s,a)=>(s[a]=xk(a,e,t,i),s),{}):{}},xk=(e,t,n,r)=>{const i=t.find(l=>l.name===e),s=i==null?void 0:i.type,a=n[e];return s&&!r.includes(s)?ww(s,a):Kh(a)},ww=(e,t)=>{if(e.charAt(0)==="_"){const n=e.slice(1,e.length);return Sk(t,n)}switch(e){case Ct.bool:return bk(t);case Ct.float4:case Ct.float8:case Ct.int2:case Ct.int4:case Ct.int8:case Ct.numeric:case Ct.oid:return wk(t);case Ct.json:case Ct.jsonb:return _k(t);case Ct.timestamp:return kk(t);case Ct.abstime:case Ct.date:case Ct.daterange:case Ct.int4range:case Ct.int8range:case Ct.money:case Ct.reltime:case Ct.text:case Ct.time:case Ct.timestamptz:case Ct.timetz:case Ct.tsrange:case Ct.tstzrange:return Kh(t);default:return Kh(t)}},Kh=e=>e,bk=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},wk=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},_k=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},Sk=(e,t)=>{if(typeof e!="string")return e;const n=e.length-1,r=e[n];if(e[0]==="{"&&r==="}"){let s;const a=e.slice(1,n);try{s=JSON.parse("["+a+"]")}catch{s=a?a.split(","):[]}return s.map(l=>ww(t,l))}return e},kk=e=>typeof e=="string"?e.replace(" ","T"):e,_w=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class ju{constructor(t,n,r={},i=Xh){this.channel=t,this.event=n,this.payload=r,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,n){var r;return this._hasReceived(t)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:t,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:n}){this.recHooks.filter(r=>r.status===t).forEach(r=>r.callback(n))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Wg;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Wg||(Wg={}));class Wa{constructor(t,n){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},i=>{const{onJoin:s,onLeave:a,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Wa.syncState(this.state,i,s,a),this.pendingDiffs.forEach(c=>{this.state=Wa.syncDiff(this.state,c,s,a)}),this.pendingDiffs=[],l()}),this.channel._on(r.diff,{},i=>{const{onJoin:s,onLeave:a,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=Wa.syncDiff(this.state,i,s,a),l())}),this.onJoin((i,s,a)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:s,newPresences:a})}),this.onLeave((i,s,a)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:s,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,n,r,i){const s=this.cloneDeep(t),a=this.transformState(n),l={},c={};return this.map(s,(d,u)=>{a[d]||(c[d]=u)}),this.map(a,(d,u)=>{const p=s[d];if(p){const h=u.map(x=>x.presence_ref),f=p.map(x=>x.presence_ref),m=u.filter(x=>f.indexOf(x.presence_ref)<0),g=p.filter(x=>h.indexOf(x.presence_ref)<0);m.length>0&&(l[d]=m),g.length>0&&(c[d]=g)}else l[d]=u}),this.syncDiff(s,{joins:l,leaves:c},r,i)}static syncDiff(t,n,r,i){const{joins:s,leaves:a}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),i||(i=()=>{}),this.map(s,(l,c)=>{var d;const u=(d=t[l])!==null&&d!==void 0?d:[];if(t[l]=this.cloneDeep(c),u.length>0){const p=t[l].map(f=>f.presence_ref),h=u.filter(f=>p.indexOf(f.presence_ref)<0);t[l].unshift(...h)}r(l,u,c)}),this.map(a,(l,c)=>{let d=t[l];if(!d)return;const u=c.map(p=>p.presence_ref);d=d.filter(p=>u.indexOf(p.presence_ref)<0),t[l]=d,i(l,d,c),d.length===0&&delete t[l]}),t}static map(t,n){return Object.getOwnPropertyNames(t).map(r=>n(r,t[r]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((n,r)=>{const i=t[r];return"metas"in i?n[r]=i.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):n[r]=i,n},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Gg;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Gg||(Gg={}));var Ga;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Ga||(Ga={}));var ri;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(ri||(ri={}));class gf{constructor(t,n={config:{}},r){var i,s;if(this.topic=t,this.params=n,this.socket=r,this.bindings={},this.state=Zt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new ju(this,_r.join,this.params,this.timeout),this.rejoinTimer=new bw(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Zt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Zt.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Zt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Zt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Zt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(_r.reply,{},(a,l)=>{this._trigger(this._replyEventName(l),a)}),this.presence=new Wa(this),this.broadcastEndpointURL=_w(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((s=(i=this.params.config)===null||i===void 0?void 0:i.broadcast)===null||s===void 0)&&s.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,n=this.timeout){var r,i,s;if(this.socket.isConnected()||this.socket.connect(),this.state==Zt.closed){const{config:{broadcast:a,presence:l,private:c}}=this.params,d=(i=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(f=>f.filter))!==null&&i!==void 0?i:[],u=!!this.bindings[Ga.PRESENCE]&&this.bindings[Ga.PRESENCE].length>0||((s=this.params.config.presence)===null||s===void 0?void 0:s.enabled)===!0,p={},h={broadcast:a,presence:Object.assign(Object.assign({},l),{enabled:u}),postgres_changes:d,private:c};this.socket.accessTokenValue&&(p.access_token=this.socket.accessTokenValue),this._onError(f=>t==null?void 0:t(ri.CHANNEL_ERROR,f)),this._onClose(()=>t==null?void 0:t(ri.CLOSED)),this.updateJoinPayload(Object.assign({config:h},p)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:f})=>{var m;if(this.socket.setAuth(),f===void 0){t==null||t(ri.SUBSCRIBED);return}else{const g=this.bindings.postgres_changes,x=(m=g==null?void 0:g.length)!==null&&m!==void 0?m:0,y=[];for(let v=0;v<x;v++){const b=g[v],{filter:{event:w,schema:C,table:_,filter:j}}=b,E=f&&f[v];if(E&&E.event===w&&E.schema===C&&E.table===_&&E.filter===j)y.push(Object.assign(Object.assign({},b),{id:E.id}));else{this.unsubscribe(),this.state=Zt.errored,t==null||t(ri.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=y,t&&t(ri.SUBSCRIBED);return}}).receive("error",f=>{this.state=Zt.errored,t==null||t(ri.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(f).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(ri.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,n={}){return await this.send({type:"presence",event:"track",payload:t},n.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,n,r){return this.state===Zt.joined&&t===Ga.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,n,r)}async httpSend(t,n,r={}){var i;const s=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(n==null)return Promise.reject("Payload is required for httpSend()");const a={method:"POST",headers:{Authorization:s,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:n,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,a,(i=r.timeout)!==null&&i!==void 0?i:this.timeout);if(l.status===202)return{success:!0};let c=l.statusText;try{const d=await l.json();c=d.error||d.message||c}catch{}return Promise.reject(new Error(c))}async send(t,n={}){var r,i;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:s,payload:a}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:a,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((i=d.body)===null||i===void 0?void 0:i.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var a,l,c;const d=this._push(t.type,t,n.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(l=(a=this.params)===null||a===void 0?void 0:a.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&s("ok"),d.receive("ok",()=>s("ok")),d.receive("error",()=>s("error")),d.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Zt.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(_r.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(i=>{r=new ju(this,_r.leave,{},t),r.receive("ok",()=>{n(),i("ok")}).receive("timeout",()=>{n(),i("timed out")}).receive("error",()=>{i("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Zt.closed,this.bindings={}}async _fetchWithTimeout(t,n,r){const i=new AbortController,s=setTimeout(()=>i.abort(),r),a=await this.socket.fetch(t,Object.assign(Object.assign({},n),{signal:i.signal}));return clearTimeout(s),a}_push(t,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new ju(this,t,n,r);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>vk){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(t,n,r){return n}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,n,r){var i,s;const a=t.toLocaleLowerCase(),{close:l,error:c,leave:d,join:u}=_r;if(r&&[l,c,d,u].indexOf(a)>=0&&r!==this._joinRef())return;let h=this._onMessage(a,n,r);if(n&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(f=>{var m,g,x;return((m=f.filter)===null||m===void 0?void 0:m.event)==="*"||((x=(g=f.filter)===null||g===void 0?void 0:g.event)===null||x===void 0?void 0:x.toLocaleLowerCase())===a}).map(f=>f.callback(h,r)):(s=this.bindings[a])===null||s===void 0||s.filter(f=>{var m,g,x,y,v,b;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in f){const w=f.id,C=(m=f.filter)===null||m===void 0?void 0:m.event;return w&&((g=n.ids)===null||g===void 0?void 0:g.includes(w))&&(C==="*"||(C==null?void 0:C.toLocaleLowerCase())===((x=n.data)===null||x===void 0?void 0:x.type.toLocaleLowerCase()))}else{const w=(v=(y=f==null?void 0:f.filter)===null||y===void 0?void 0:y.event)===null||v===void 0?void 0:v.toLocaleLowerCase();return w==="*"||w===((b=n==null?void 0:n.event)===null||b===void 0?void 0:b.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===a}).map(f=>{if(typeof h=="object"&&"ids"in h){const m=h.data,{schema:g,table:x,commit_timestamp:y,type:v,errors:b}=m;h=Object.assign(Object.assign({},{schema:g,table:x,commit_timestamp:y,eventType:v,new:{},old:{},errors:b}),this._getPayloadRecords(m))}f.callback(h,r)})}_isClosed(){return this.state===Zt.closed}_isJoined(){return this.state===Zt.joined}_isJoining(){return this.state===Zt.joining}_isLeaving(){return this.state===Zt.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,n,r){const i=t.toLocaleLowerCase(),s={type:i,filter:n,callback:r};return this.bindings[i]?this.bindings[i].push(s):this.bindings[i]=[s],this}_off(t,n){const r=t.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(i=>{var s;return!(((s=i.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===r&&gf.isEqual(i.filter,n))})),this}static isEqual(t,n){if(Object.keys(t).length!==Object.keys(n).length)return!1;for(const r in t)if(t[r]!==n[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(_r.close,{},t)}_onError(t){this._on(_r.error,{},n=>t(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Zt.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const n={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(n.new=Ug(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(n.old=Ug(t.columns,t.old_record)),n}}const Cu=()=>{},rc={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},jk=[1e3,2e3,5e3,1e4],Ck=1e4,Ek=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Tk{constructor(t,n){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Xh,this.transport=null,this.heartbeatIntervalMs=rc.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Cu,this.ref=0,this.reconnectTimer=null,this.logger=Cu,this.conn=null,this.sendBuffer=[],this.serializer=new yk,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=i=>i?(...s)=>i(...s):(...s)=>fetch(...s),!(!((r=n==null?void 0:n.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${t}/${Zh.websocket}`,this.httpEndpoint=_w(t),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=hk.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const n=t.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:mk}))}disconnect(t,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},t?this.conn.close(t,n??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const n=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const t=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,n,r){this.logger(t,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Ua.connecting:return fs.Connecting;case Ua.open:return fs.Open;case Ua.closing:return fs.Closing;default:return fs.Closed}}isConnected(){return this.connectionState()===fs.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,n={config:{}}){const r=`realtime:${t}`,i=this.getChannels().find(s=>s.topic===r);if(i)return i;{const s=new gf(`realtime:${t}`,n,this);return this.channels.push(s),s}}push(t){const{topic:n,event:r,payload:i,ref:s}=t,a=()=>{this.encode(t,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${n} ${r} (${s})`,i),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(gk,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},rc.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let n=this.channels.find(r=>r.topic===t&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${t}"`),n.unsubscribe())}_remove(t){this.channels=this.channels.filter(n=>n.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply")try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:i,payload:s,ref:a}=n,l=a?`(${a})`:"",c=s.status||"";this.log("receive",`${c} ${r} ${i} ${l}`.trim(),s),this.channels.filter(d=>d._isMember(r)).forEach(d=>d._trigger(i,s,a)),this._triggerStateCallbacks("message",n)})}_clearTimer(t){var n;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var n;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(_r.error))}_appendParams(t,n){if(Object.keys(n).length===0)return t;const r=t.match(/\?/)?"&":"?",i=new URLSearchParams(n);return`${t}${r}${i}`}_workerObjectUrl(t){let n;if(t)n=t;else{const r=new Blob([Ek],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}_setConnectionState(t,n=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(t=null){let n;t?n=t:this.accessToken?n=await this.accessToken():n=this.accessTokenValue,this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(r=>{const i={access_token:n,version:fk};n&&r.updateJoinPayload(i),r.joinedOnce&&r._isJoined()&&r._push(_r.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(n=>{this.log("error",`error setting auth in ${t}`,n)})}_triggerStateCallbacks(t,n){try{this.stateChangeCallbacks[t].forEach(r=>{try{r(n)}catch(i){this.log("error",`error in ${t} callback`,i)}})}catch(r){this.log("error",`error triggering ${t} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new bw(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},rc.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var n,r,i,s,a,l,c,d,u;if(this.transport=(n=t==null?void 0:t.transport)!==null&&n!==void 0?n:null,this.timeout=(r=t==null?void 0:t.timeout)!==null&&r!==void 0?r:Xh,this.heartbeatIntervalMs=(i=t==null?void 0:t.heartbeatIntervalMs)!==null&&i!==void 0?i:rc.HEARTBEAT_INTERVAL,this.worker=(s=t==null?void 0:t.worker)!==null&&s!==void 0?s:!1,this.accessToken=(a=t==null?void 0:t.accessToken)!==null&&a!==void 0?a:null,this.heartbeatCallback=(l=t==null?void 0:t.heartbeatCallback)!==null&&l!==void 0?l:Cu,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t==null?void 0:t.reconnectAfterMs)!==null&&c!==void 0?c:p=>jk[p-1]||Ck,this.encode=(d=t==null?void 0:t.encode)!==null&&d!==void 0?d:(p,h)=>h(JSON.stringify(p)),this.decode=(u=t==null?void 0:t.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class vf extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Dt(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class Nk extends vf{constructor(t,n,r){super(t),this.name="StorageApiError",this.status=n,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Jh extends vf{constructor(t,n){super(t),this.name="StorageUnknownError",this.originalError=n}}const yf=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),Pk=()=>Response,Qh=e=>{if(Array.isArray(e))return e.map(n=>Qh(n));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([n,r])=>{const i=n.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[i]=Qh(r)}),t},Rk=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},Eu=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},Ok=(e,t,n)=>Ue(void 0,void 0,void 0,function*(){const r=yield Pk();e instanceof r&&!(n!=null&&n.noResolveJson)?e.json().then(i=>{const s=e.status||500,a=(i==null?void 0:i.statusCode)||s+"";t(new Nk(Eu(i),s,a))}).catch(i=>{t(new Jh(Eu(i),i))}):t(new Jh(Eu(e),e))}),Ak=(e,t,n,r)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!r?i:(Rk(r)?(i.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),i.body=JSON.stringify(r)):i.body=r,t!=null&&t.duplex&&(i.duplex=t.duplex),Object.assign(Object.assign({},i),n))};function wl(e,t,n,r,i,s){return Ue(this,void 0,void 0,function*(){return new Promise((a,l)=>{e(n,Ak(t,r,i,s)).then(c=>{if(!c.ok)throw c;return r!=null&&r.noResolveJson?c:c.json()}).then(c=>a(c)).catch(c=>Ok(c,l,r))})})}function dl(e,t,n,r){return Ue(this,void 0,void 0,function*(){return wl(e,"GET",t,n,r)})}function br(e,t,n,r,i){return Ue(this,void 0,void 0,function*(){return wl(e,"POST",t,r,i,n)})}function ep(e,t,n,r,i){return Ue(this,void 0,void 0,function*(){return wl(e,"PUT",t,r,i,n)})}function Mk(e,t,n,r){return Ue(this,void 0,void 0,function*(){return wl(e,"HEAD",t,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)})}function xf(e,t,n,r,i){return Ue(this,void 0,void 0,function*(){return wl(e,"DELETE",t,r,i,n)})}class $k{constructor(t,n){this.downloadFn=t,this.shouldThrowOnError=n}then(t,n){return this.execute().then(t,n)}execute(){return Ue(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Dt(t))return{data:null,error:t};throw t}})}}var Sw;class Lk{constructor(t,n){this.downloadFn=t,this.shouldThrowOnError=n,this[Sw]="BlobDownloadBuilder",this.promise=null}asStream(){return new $k(this.downloadFn,this.shouldThrowOnError)}then(t,n){return this.getPromise().then(t,n)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return Ue(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Dt(t))return{data:null,error:t};throw t}})}}Sw=Symbol.toStringTag;const Ik={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Vg={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Dk{constructor(t,n={},r,i){this.shouldThrowOnError=!1,this.url=t,this.headers=n,this.bucketId=r,this.fetch=yf(i)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,n,r,i){return Ue(this,void 0,void 0,function*(){try{let s;const a=Object.assign(Object.assign({},Vg),i);let l=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(a.upsert)});const c=a.metadata;typeof Blob<"u"&&r instanceof Blob?(s=new FormData,s.append("cacheControl",a.cacheControl),c&&s.append("metadata",this.encodeMetadata(c)),s.append("",r)):typeof FormData<"u"&&r instanceof FormData?(s=r,s.has("cacheControl")||s.append("cacheControl",a.cacheControl),c&&!s.has("metadata")&&s.append("metadata",this.encodeMetadata(c))):(s=r,l["cache-control"]=`max-age=${a.cacheControl}`,l["content-type"]=a.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c))),(typeof ReadableStream<"u"&&s instanceof ReadableStream||s&&typeof s=="object"&&"pipe"in s&&typeof s.pipe=="function")&&!a.duplex&&(a.duplex="half")),i!=null&&i.headers&&(l=Object.assign(Object.assign({},l),i.headers));const d=this._removeEmptyFolders(n),u=this._getFinalPath(d),p=yield(t=="PUT"?ep:br)(this.fetch,`${this.url}/object/${u}`,s,Object.assign({headers:l},a!=null&&a.duplex?{duplex:a.duplex}:{}));return{data:{path:d,id:p.Id,fullPath:p.Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Dt(s))return{data:null,error:s};throw s}})}upload(t,n,r){return Ue(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,n,r)})}uploadToSignedUrl(t,n,r,i){return Ue(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(t),a=this._getFinalPath(s),l=new URL(this.url+`/object/upload/sign/${a}`);l.searchParams.set("token",n);try{let c;const d=Object.assign({upsert:Vg.upsert},i),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&r instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",r)):typeof FormData<"u"&&r instanceof FormData?(c=r,c.append("cacheControl",d.cacheControl)):(c=r,u["cache-control"]=`max-age=${d.cacheControl}`,u["content-type"]=d.contentType);const p=yield ep(this.fetch,l.toString(),c,{headers:u});return{data:{path:s,fullPath:p.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(Dt(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,n){return Ue(this,void 0,void 0,function*(){try{let r=this._getFinalPath(t);const i=Object.assign({},this.headers);n!=null&&n.upsert&&(i["x-upsert"]="true");const s=yield br(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:i}),a=new URL(this.url+s.url),l=a.searchParams.get("token");if(!l)throw new vf("No token returned by API");return{data:{signedUrl:a.toString(),path:t,token:l},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Dt(r))return{data:null,error:r};throw r}})}update(t,n,r){return Ue(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,n,r)})}move(t,n,r){return Ue(this,void 0,void 0,function*(){try{return{data:yield br(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Dt(i))return{data:null,error:i};throw i}})}copy(t,n,r){return Ue(this,void 0,void 0,function*(){try{return{data:{path:(yield br(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Dt(i))return{data:null,error:i};throw i}})}createSignedUrl(t,n,r){return Ue(this,void 0,void 0,function*(){try{let i=this._getFinalPath(t),s=yield br(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:n},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const a=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${a}`)},{data:s,error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Dt(i))return{data:null,error:i};throw i}})}createSignedUrls(t,n,r){return Ue(this,void 0,void 0,function*(){try{const i=yield br(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:t},{headers:this.headers}),s=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:i.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${s}`):null})),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Dt(i))return{data:null,error:i};throw i}})}download(t,n){const i=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),a=s?`?${s}`:"",l=this._getFinalPath(t),c=()=>dl(this.fetch,`${this.url}/${i}/${l}${a}`,{headers:this.headers,noResolveJson:!0});return new Lk(c,this.shouldThrowOnError)}info(t){return Ue(this,void 0,void 0,function*(){const n=this._getFinalPath(t);try{const r=yield dl(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:Qh(r),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Dt(r))return{data:null,error:r};throw r}})}exists(t){return Ue(this,void 0,void 0,function*(){const n=this._getFinalPath(t);try{return yield Mk(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Dt(r)&&r instanceof Jh){const i=r.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:r}}throw r}})}getPublicUrl(t,n){const r=this._getFinalPath(t),i=[],s=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";s!==""&&i.push(s);const l=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});c!==""&&i.push(c);let d=i.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${r}${d}`)}}}remove(t){return Ue(this,void 0,void 0,function*(){try{return{data:yield xf(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Dt(n))return{data:null,error:n};throw n}})}list(t,n,r){return Ue(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},Ik),n),{prefix:t||""});return{data:yield br(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},r),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Dt(i))return{data:null,error:i};throw i}})}listV2(t,n){return Ue(this,void 0,void 0,function*(){try{const r=Object.assign({},t);return{data:yield br(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},n),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Dt(r))return{data:null,error:r};throw r}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const n=[];return t.width&&n.push(`width=${t.width}`),t.height&&n.push(`height=${t.height}`),t.resize&&n.push(`resize=${t.resize}`),t.format&&n.push(`format=${t.format}`),t.quality&&n.push(`quality=${t.quality}`),n.join("&")}}const kw="2.79.0",jw={"X-Client-Info":`storage-js/${kw}`};class zk{constructor(t,n={},r,i){this.shouldThrowOnError=!1;const s=new URL(t);i!=null&&i.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},jw),n),this.fetch=yf(r)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(t){return Ue(this,void 0,void 0,function*(){try{const n=this.listBucketOptionsToQueryString(t);return{data:yield dl(this.fetch,`${this.url}/bucket${n}`,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Dt(n))return{data:null,error:n};throw n}})}getBucket(t){return Ue(this,void 0,void 0,function*(){try{return{data:yield dl(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Dt(n))return{data:null,error:n};throw n}})}createBucket(t){return Ue(this,arguments,void 0,function*(n,r={public:!1}){try{return{data:yield br(this.fetch,`${this.url}/bucket`,{id:n,name:n,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Dt(i))return{data:null,error:i};throw i}})}updateBucket(t,n){return Ue(this,void 0,void 0,function*(){try{return{data:yield ep(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Dt(r))return{data:null,error:r};throw r}})}emptyBucket(t){return Ue(this,void 0,void 0,function*(){try{return{data:yield br(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Dt(n))return{data:null,error:n};throw n}})}deleteBucket(t){return Ue(this,void 0,void 0,function*(){try{return{data:yield xf(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Dt(n))return{data:null,error:n};throw n}})}listBucketOptionsToQueryString(t){const n={};return t&&("limit"in t&&(n.limit=String(t.limit)),"offset"in t&&(n.offset=String(t.offset)),t.search&&(n.search=t.search),t.sortColumn&&(n.sortColumn=t.sortColumn),t.sortOrder&&(n.sortOrder=t.sortOrder)),Object.keys(n).length>0?"?"+new URLSearchParams(n).toString():""}}class Fk{constructor(t,n={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},jw),n),this.fetch=yf(r)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return Ue(this,void 0,void 0,function*(){try{return{data:yield br(this.fetch,`${this.url}/bucket`,{name:t},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Dt(n))return{data:null,error:n};throw n}})}listBuckets(t){return Ue(this,void 0,void 0,function*(){try{const n=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&n.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&n.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&n.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&n.set("sortOrder",t.sortOrder),t!=null&&t.search&&n.set("search",t.search);const r=n.toString(),i=r?`${this.url}/bucket?${r}`:`${this.url}/bucket`;return{data:yield dl(this.fetch,i,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Dt(n))return{data:null,error:n};throw n}})}deleteBucket(t){return Ue(this,void 0,void 0,function*(){try{return{data:yield xf(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Dt(n))return{data:null,error:n};throw n}})}}const bf={"X-Client-Info":`storage-js/${kw}`,"Content-Type":"application/json"};class Cw extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function Vn(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}class Tu extends Cw{constructor(t,n,r){super(t),this.name="StorageVectorsApiError",this.status=n,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Bk extends Cw{constructor(t,n){super(t),this.name="StorageVectorsUnknownError",this.originalError=n}}var qg;(function(e){e.InternalError="InternalError",e.S3VectorConflictException="S3VectorConflictException",e.S3VectorNotFoundException="S3VectorNotFoundException",e.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",e.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",e.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(qg||(qg={}));const wf=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),Hk=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},Yg=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Uk=(e,t,n)=>Ue(void 0,void 0,void 0,function*(){if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(n!=null&&n.noResolveJson)){const i=e.status||500,s=e;if(typeof s.json=="function")s.json().then(a=>{const l=(a==null?void 0:a.statusCode)||(a==null?void 0:a.code)||i+"";t(new Tu(Yg(a),i,l))}).catch(()=>{const a=i+"",l=s.statusText||`HTTP ${i} error`;t(new Tu(l,i,a))});else{const a=i+"",l=s.statusText||`HTTP ${i} error`;t(new Tu(l,i,a))}}else t(new Bk(Yg(e),e))}),Wk=(e,t,n,r)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return r?(Hk(r)?(i.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),i.body=JSON.stringify(r)):i.body=r,Object.assign(Object.assign({},i),n)):i};function Gk(e,t,n,r,i,s){return Ue(this,void 0,void 0,function*(){return new Promise((a,l)=>{e(n,Wk(t,r,i,s)).then(c=>{if(!c.ok)throw c;if(r!=null&&r.noResolveJson)return c;const d=c.headers.get("content-type");return!d||!d.includes("application/json")?{}:c.json()}).then(c=>a(c)).catch(c=>Uk(c,l,r))})})}function qn(e,t,n,r,i){return Ue(this,void 0,void 0,function*(){return Gk(e,"POST",t,r,i,n)})}class Vk{constructor(t,n={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},bf),n),this.fetch=wf(r)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(t){return Ue(this,void 0,void 0,function*(){try{return{data:(yield qn(this.fetch,`${this.url}/CreateIndex`,t,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Vn(n))return{data:null,error:n};throw n}})}getIndex(t,n){return Ue(this,void 0,void 0,function*(){try{return{data:yield qn(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:t,indexName:n},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Vn(r))return{data:null,error:r};throw r}})}listIndexes(t){return Ue(this,void 0,void 0,function*(){try{return{data:yield qn(this.fetch,`${this.url}/ListIndexes`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Vn(n))return{data:null,error:n};throw n}})}deleteIndex(t,n){return Ue(this,void 0,void 0,function*(){try{return{data:(yield qn(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:t,indexName:n},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Vn(r))return{data:null,error:r};throw r}})}}class qk{constructor(t,n={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},bf),n),this.fetch=wf(r)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(t){return Ue(this,void 0,void 0,function*(){try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield qn(this.fetch,`${this.url}/PutVectors`,t,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Vn(n))return{data:null,error:n};throw n}})}getVectors(t){return Ue(this,void 0,void 0,function*(){try{return{data:yield qn(this.fetch,`${this.url}/GetVectors`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Vn(n))return{data:null,error:n};throw n}})}listVectors(t){return Ue(this,void 0,void 0,function*(){try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:yield qn(this.fetch,`${this.url}/ListVectors`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Vn(n))return{data:null,error:n};throw n}})}queryVectors(t){return Ue(this,void 0,void 0,function*(){try{return{data:yield qn(this.fetch,`${this.url}/QueryVectors`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Vn(n))return{data:null,error:n};throw n}})}deleteVectors(t){return Ue(this,void 0,void 0,function*(){try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield qn(this.fetch,`${this.url}/DeleteVectors`,t,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Vn(n))return{data:null,error:n};throw n}})}}class Yk{constructor(t,n={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},bf),n),this.fetch=wf(r)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return Ue(this,void 0,void 0,function*(){try{return{data:(yield qn(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Vn(n))return{data:null,error:n};throw n}})}getBucket(t){return Ue(this,void 0,void 0,function*(){try{return{data:yield qn(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:t},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Vn(n))return{data:null,error:n};throw n}})}listBuckets(){return Ue(this,arguments,void 0,function*(t={}){try{return{data:yield qn(this.fetch,`${this.url}/ListVectorBuckets`,t,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Vn(n))return{data:null,error:n};throw n}})}deleteBucket(t){return Ue(this,void 0,void 0,function*(){try{return{data:(yield qn(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Vn(n))return{data:null,error:n};throw n}})}}class Xk extends Yk{constructor(t,n={}){super(t,n.headers||{},n.fetch)}from(t){return new Zk(this.url,this.headers,t,this.fetch)}}class Zk extends Vk{constructor(t,n,r,i){super(t,n,i),this.vectorBucketName=r}createIndex(t){const n=Object.create(null,{createIndex:{get:()=>super.createIndex}});return Ue(this,void 0,void 0,function*(){return n.createIndex.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const t=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return Ue(this,arguments,void 0,function*(n={}){return t.listIndexes.call(this,Object.assign(Object.assign({},n),{vectorBucketName:this.vectorBucketName}))})}getIndex(t){const n=Object.create(null,{getIndex:{get:()=>super.getIndex}});return Ue(this,void 0,void 0,function*(){return n.getIndex.call(this,this.vectorBucketName,t)})}deleteIndex(t){const n=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return Ue(this,void 0,void 0,function*(){return n.deleteIndex.call(this,this.vectorBucketName,t)})}index(t){return new Kk(this.url,this.headers,this.vectorBucketName,t,this.fetch)}}class Kk extends qk{constructor(t,n,r,i,s){super(t,n,s),this.vectorBucketName=r,this.indexName=i}putVectors(t){const n=Object.create(null,{putVectors:{get:()=>super.putVectors}});return Ue(this,void 0,void 0,function*(){return n.putVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(t){const n=Object.create(null,{getVectors:{get:()=>super.getVectors}});return Ue(this,void 0,void 0,function*(){return n.getVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const t=Object.create(null,{listVectors:{get:()=>super.listVectors}});return Ue(this,arguments,void 0,function*(n={}){return t.listVectors.call(this,Object.assign(Object.assign({},n),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(t){const n=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return Ue(this,void 0,void 0,function*(){return n.queryVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(t){const n=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return Ue(this,void 0,void 0,function*(){return n.deleteVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class Jk extends zk{constructor(t,n={},r,i){super(t,n,r,i)}from(t){return new Dk(this.url,this.headers,t,this.fetch)}get vectors(){return new Xk(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new Fk(this.url+"/iceberg",this.headers,this.fetch)}}const Qk="2.79.0";let Pa="";typeof Deno<"u"?Pa="deno":typeof document<"u"?Pa="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Pa="react-native":Pa="node";const ej={"X-Client-Info":`supabase-js-${Pa}/${Qk}`},tj={headers:ej},nj={schema:"public"},rj={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},ij={},sj=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),oj=()=>Headers,aj=(e,t,n)=>{const r=sj(n),i=oj();return async(s,a)=>{var l;const c=(l=await t())!==null&&l!==void 0?l:e;let d=new i(a==null?void 0:a.headers);return d.has("apikey")||d.set("apikey",e),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),r(s,Object.assign(Object.assign({},a),{headers:d}))}};function lj(e){return e.endsWith("/")?e:e+"/"}function cj(e,t){var n,r;const{db:i,auth:s,realtime:a,global:l}=e,{db:c,auth:d,realtime:u,global:p}=t,h={db:Object.assign(Object.assign({},c),i),auth:Object.assign(Object.assign({},d),s),realtime:Object.assign(Object.assign({},u),a),storage:{},global:Object.assign(Object.assign(Object.assign({},p),l),{headers:Object.assign(Object.assign({},(n=p==null?void 0:p.headers)!==null&&n!==void 0?n:{}),(r=l==null?void 0:l.headers)!==null&&r!==void 0?r:{})}),accessToken:async()=>""};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}function dj(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(lj(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const Ew="2.79.0",Xs=30*1e3,tp=3,Nu=tp*Xs,uj="http://localhost:9999",hj="supabase.auth.token",pj={"X-Client-Info":`gotrue-js/${Ew}`},np="X-Supabase-Api-Version",Tw={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},fj=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,mj=10*60*1e3;class ul extends Error{constructor(t,n,r){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function qe(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class gj extends ul{constructor(t,n,r){super(t,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function vj(e){return qe(e)&&e.name==="AuthApiError"}class ms extends ul{constructor(t,n){super(t),this.name="AuthUnknownError",this.originalError=n}}class Ji extends ul{constructor(t,n,r,i){super(t,r,i),this.name=n,this.status=r}}class gr extends Ji{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function yj(e){return qe(e)&&e.name==="AuthSessionMissingError"}class Ws extends Ji{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class ic extends Ji{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class sc extends Ji{constructor(t,n=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function xj(e){return qe(e)&&e.name==="AuthImplicitGrantRedirectError"}class Xg extends Ji{constructor(t,n=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class rp extends Ji{constructor(t,n){super(t,"AuthRetryableFetchError",n,void 0)}}function Pu(e){return qe(e)&&e.name==="AuthRetryableFetchError"}class Zg extends Ji{constructor(t,n,r){super(t,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}class ip extends Ji{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const ed="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Kg=` 	
\r=`.split(""),bj=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Kg.length;t+=1)e[Kg[t].charCodeAt(0)]=-2;for(let t=0;t<ed.length;t+=1)e[ed[t].charCodeAt(0)]=t;return e})();function Jg(e,t,n){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const r=t.queue>>t.queuedBits-6&63;n(ed[r]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const r=t.queue>>t.queuedBits-6&63;n(ed[r]),t.queuedBits-=6}}function Nw(e,t,n){const r=bj[e];if(r>-1)for(t.queue=t.queue<<6|r,t.queuedBits+=6;t.queuedBits>=8;)n(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Qg(e){const t=[],n=a=>{t.push(String.fromCodePoint(a))},r={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},s=a=>{Sj(a,r,n)};for(let a=0;a<e.length;a+=1)Nw(e.charCodeAt(a),i,s);return t.join("")}function wj(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function _j(e,t){for(let n=0;n<e.length;n+=1){let r=e.charCodeAt(n);if(r>55295&&r<=56319){const i=(r-55296)*1024&65535;r=(e.charCodeAt(n+1)-56320&65535|i)+65536,n+=1}wj(r,t)}}function Sj(e,t,n){if(t.utf8seq===0){if(e<=127){n(e);return}for(let r=1;r<6;r+=1)if(!(e>>7-r&1)){t.utf8seq=r;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&n(t.codepoint)}}function Mo(e){const t=[],n={queue:0,queuedBits:0},r=i=>{t.push(i)};for(let i=0;i<e.length;i+=1)Nw(e.charCodeAt(i),n,r);return new Uint8Array(t)}function kj(e){const t=[];return _j(e,n=>t.push(n)),new Uint8Array(t)}function ws(e){const t=[],n={queue:0,queuedBits:0},r=i=>{t.push(i)};return e.forEach(i=>Jg(i,n,r)),Jg(null,n,r),t.join("")}function jj(e){return Math.round(Date.now()/1e3)+e}function Cj(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const yn=()=>typeof window<"u"&&typeof document<"u",as={tested:!1,writable:!1},Pw=()=>{if(!yn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(as.tested)return as.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),as.tested=!0,as.writable=!0}catch{as.tested=!0,as.writable=!1}return as.writable};function Ej(e){const t={},n=new URL(e);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((i,s)=>{t[s]=i})}catch{}return n.searchParams.forEach((r,i)=>{t[i]=r}),t}const Rw=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),Tj=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Zs=async(e,t,n)=>{await e.setItem(t,JSON.stringify(n))},ls=async(e,t)=>{const n=await e.getItem(t);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Ci=async(e,t)=>{await e.removeItem(t)};class Md{constructor(){this.promise=new Md.promiseConstructor((t,n)=>{this.resolve=t,this.reject=n})}}Md.promiseConstructor=Promise;function Ru(e){const t=e.split(".");if(t.length!==3)throw new ip("Invalid JWT structure");for(let r=0;r<t.length;r++)if(!fj.test(t[r]))throw new ip("JWT not in base64url format");return{header:JSON.parse(Qg(t[0])),payload:JSON.parse(Qg(t[1])),signature:Mo(t[2]),raw:{header:t[0],payload:t[1]}}}async function Nj(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function Pj(e,t){return new Promise((r,i)=>{(async()=>{for(let s=0;s<1/0;s++)try{const a=await e(s);if(!t(s,null,a)){r(a);return}}catch(a){if(!t(s,a)){i(a);return}}})()})}function Rj(e){return("0"+e.toString(16)).substr(-2)}function Oj(){const t=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let i="";for(let s=0;s<56;s++)i+=n.charAt(Math.floor(Math.random()*r));return i}return crypto.getRandomValues(t),Array.from(t,Rj).join("")}async function Aj(e){const n=new TextEncoder().encode(e),r=await crypto.subtle.digest("SHA-256",n),i=new Uint8Array(r);return Array.from(i).map(s=>String.fromCharCode(s)).join("")}async function Mj(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const n=await Aj(e);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Gs(e,t,n=!1){const r=Oj();let i=r;n&&(i+="/PASSWORD_RECOVERY"),await Zs(e,`${t}-code-verifier`,i);const s=await Mj(r);return[s,r===s?"plain":"s256"]}const $j=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Lj(e){const t=e.headers.get(np);if(!t||!t.match($j))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function Ij(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function Dj(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const zj=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Vs(e){if(!zj.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Ou(){const e={};return new Proxy(e,{get:(t,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const r=n.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Fj(e,t){return new Proxy(e,{get:(n,r,i)=>{if(r==="__isInsecureUserWarningProxy")return!0;if(typeof r=="symbol"){const s=r.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)"||s==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(n,r,i)}return!t.value&&typeof r=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(n,r,i)}})}function e0(e){return JSON.parse(JSON.stringify(e))}const hs=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Bj=[502,503,504];async function t0(e){var t;if(!Tj(e))throw new rp(hs(e),0);if(Bj.includes(e.status))throw new rp(hs(e),e.status);let n;try{n=await e.json()}catch(s){throw new ms(hs(s),s)}let r;const i=Lj(e);if(i&&i.getTime()>=Tw["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new Zg(hs(n),e.status,((t=n.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(r==="session_not_found")throw new gr}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((s,a)=>s&&typeof a=="string",!0))throw new Zg(hs(n),e.status,n.weak_password.reasons);throw new gj(hs(n),e.status||500,r)}const Hj=(e,t,n,r)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),i.body=JSON.stringify(r),Object.assign(Object.assign({},i),n))};async function tt(e,t,n,r){var i;const s=Object.assign({},r==null?void 0:r.headers);s[np]||(s[np]=Tw["2024-01-01"].name),r!=null&&r.jwt&&(s.Authorization=`Bearer ${r.jwt}`);const a=(i=r==null?void 0:r.query)!==null&&i!==void 0?i:{};r!=null&&r.redirectTo&&(a.redirect_to=r.redirectTo);const l=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",c=await Uj(e,t,n+l,{headers:s,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(c):{data:Object.assign({},c),error:null}}async function Uj(e,t,n,r,i,s){const a=Hj(t,r,i,s);let l;try{l=await e(n,Object.assign({},a))}catch(c){throw console.error(c),new rp(hs(c),0)}if(l.ok||await t0(l),r!=null&&r.noResolveJson)return l;try{return await l.json()}catch(c){await t0(c)}}function vr(e){var t;let n=null;Vj(e)&&(n=Object.assign({},e),e.expires_at||(n.expires_at=jj(e.expires_in)));const r=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:n,user:r},error:null}}function n0(e){const t=vr(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Oi(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function Wj(e){return{data:e,error:null}}function Gj(e){const{action_link:t,email_otp:n,hashed_token:r,redirect_to:i,verification_type:s}=e,a=qo(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:n,hashed_token:r,redirect_to:i,verification_type:s},c=Object.assign({},a);return{data:{properties:l,user:c},error:null}}function r0(e){return e}function Vj(e){return e.access_token&&e.refresh_token&&e.expires_in}const Au=["global","local","others"];class qj{constructor({url:t="",headers:n={},fetch:r}){this.url=t,this.headers=n,this.fetch=Rw(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,n=Au[0]){if(Au.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Au.join(", ")}`);try{return await tt(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(r){if(qe(r))return{data:null,error:r};throw r}}async inviteUserByEmail(t,n={}){try{return await tt(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:Oi})}catch(r){if(qe(r))return{data:{user:null},error:r};throw r}}async generateLink(t){try{const{options:n}=t,r=qo(t,["options"]),i=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(i.new_email=r==null?void 0:r.newEmail,delete i.newEmail),await tt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:Gj,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(qe(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(t){try{return await tt(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Oi})}catch(n){if(qe(n))return{data:{user:null},error:n};throw n}}async listUsers(t){var n,r,i,s,a,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await tt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=t==null?void 0:t.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(s=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:r0});if(u.error)throw u.error;const p=await u.json(),h=(a=u.headers.get("x-total-count"))!==null&&a!==void 0?a:0,f=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return f.length>0&&(f.forEach(m=>{const g=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(m.split(";")[1].split("=")[1]);d[`${x}Page`]=g}),d.total=parseInt(h)),{data:Object.assign(Object.assign({},p),d),error:null}}catch(d){if(qe(d))return{data:{users:[]},error:d};throw d}}async getUserById(t){Vs(t);try{return await tt(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Oi})}catch(n){if(qe(n))return{data:{user:null},error:n};throw n}}async updateUserById(t,n){Vs(t);try{return await tt(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:n,headers:this.headers,xform:Oi})}catch(r){if(qe(r))return{data:{user:null},error:r};throw r}}async deleteUser(t,n=!1){Vs(t);try{return await tt(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:n},xform:Oi})}catch(r){if(qe(r))return{data:{user:null},error:r};throw r}}async _listFactors(t){Vs(t.userId);try{const{data:n,error:r}=await tt(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:n,error:r}}catch(n){if(qe(n))return{data:null,error:n};throw n}}async _deleteFactor(t){Vs(t.userId),Vs(t.id);try{return{data:await tt(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(n){if(qe(n))return{data:null,error:n};throw n}}async _listOAuthClients(t){var n,r,i,s,a,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await tt(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=t==null?void 0:t.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(s=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:r0});if(u.error)throw u.error;const p=await u.json(),h=(a=u.headers.get("x-total-count"))!==null&&a!==void 0?a:0,f=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return f.length>0&&(f.forEach(m=>{const g=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(m.split(";")[1].split("=")[1]);d[`${x}Page`]=g}),d.total=parseInt(h)),{data:Object.assign(Object.assign({},p),d),error:null}}catch(d){if(qe(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(t){try{return await tt(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(qe(n))return{data:null,error:n};throw n}}async _getOAuthClient(t){try{return await tt(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(qe(n))return{data:null,error:n};throw n}}async _updateOAuthClient(t,n){try{return await tt(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:n,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(qe(r))return{data:null,error:r};throw r}}async _deleteOAuthClient(t){try{return await tt(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(n){if(qe(n))return{data:null,error:n};throw n}}async _regenerateOAuthClientSecret(t){try{return await tt(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(qe(n))return{data:null,error:n};throw n}}}function i0(e={}){return{getItem:t=>e[t]||null,setItem:(t,n)=>{e[t]=n},removeItem:t=>{delete e[t]}}}const qs={debug:!!(globalThis&&Pw()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Ow extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class Yj extends Ow{}async function Xj(e,t,n){qs.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const r=new globalThis.AbortController;return t>0&&setTimeout(()=>{r.abort(),qs.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async i=>{if(i){qs.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,i.name);try{return await n()}finally{qs.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,i.name)}}else{if(t===0)throw qs.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new Yj(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(qs.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}function Zj(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Aw(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function Kj(e){return parseInt(e,16)}function Jj(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,r=>r.toString(16).padStart(2,"0")).join("")}function Qj(e){var t;const{chainId:n,domain:r,expirationTime:i,issuedAt:s=new Date,nonce:a,notBefore:l,requestId:c,resources:d,scheme:u,uri:p,version:h}=e;{if(!Number.isInteger(n))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${n}`);if(!r)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(a&&a.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${a}`);if(!p)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(h!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${h}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const f=Aw(e.address),m=u?`${u}://${r}`:r,g=e.statement?`${e.statement}
`:"",x=`${m} wants you to sign in with your Ethereum account:
${f}

${g}`;let y=`URI: ${p}
Version: ${h}
Chain ID: ${n}${a?`
Nonce: ${a}`:""}
Issued At: ${s.toISOString()}`;if(i&&(y+=`
Expiration Time: ${i.toISOString()}`),l&&(y+=`
Not Before: ${l.toISOString()}`),c&&(y+=`
Request ID: ${c}`),d){let v=`
Resources:`;for(const b of d){if(!b||typeof b!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${b}`);v+=`
- ${b}`}y+=v}return`${x}
${y}`}class Vt extends Error{constructor({message:t,code:n,cause:r,name:i}){var s;super(t,{cause:r}),this.__isWebAuthnError=!0,this.name=(s=i??(r instanceof Error?r.name:void 0))!==null&&s!==void 0?s:"Unknown Error",this.code=n}}class td extends Vt{constructor(t,n){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n,message:t}),this.name="WebAuthnUnknownError",this.originalError=n}}function eC({error:e,options:t}){var n,r,i;const{publicKey:s}=t;if(!s)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Vt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((n=s.authenticatorSelection)===null||n===void 0?void 0:n.requireResidentKey)===!0)return new Vt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((r=s.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new Vt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((i=s.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new Vt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new Vt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new Vt({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return s.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new Vt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new Vt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const a=window.location.hostname;if(Mw(a)){if(s.rp.id!==a)return new Vt({message:`The RP ID "${s.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Vt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(s.user.id.byteLength<1||s.user.id.byteLength>64)return new Vt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new Vt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Vt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function tC({error:e,options:t}){const{publicKey:n}=t;if(!n)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Vt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new Vt({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const r=window.location.hostname;if(Mw(r)){if(n.rpId!==r)return new Vt({message:`The RP ID "${n.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Vt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new Vt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Vt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class nC{createNewAbortSignal(){if(this.controller){const n=new Error("Cancelling existing WebAuthn API call for new one");n.name="AbortError",this.controller.abort(n)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const rC=new nC;function iC(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:n,excludeCredentials:r}=e,i=qo(e,["challenge","user","excludeCredentials"]),s=Mo(t).buffer,a=Object.assign(Object.assign({},n),{id:Mo(n.id).buffer}),l=Object.assign(Object.assign({},i),{challenge:s,user:a});if(r&&r.length>0){l.excludeCredentials=new Array(r.length);for(let c=0;c<r.length;c++){const d=r[c];l.excludeCredentials[c]=Object.assign(Object.assign({},d),{id:Mo(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return l}function sC(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:n}=e,r=qo(e,["challenge","allowCredentials"]),i=Mo(t).buffer,s=Object.assign(Object.assign({},r),{challenge:i});if(n&&n.length>0){s.allowCredentials=new Array(n.length);for(let a=0;a<n.length;a++){const l=n[a];s.allowCredentials[a]=Object.assign(Object.assign({},l),{id:Mo(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return s}function oC(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const n=e;return{id:e.id,rawId:e.id,response:{attestationObject:ws(new Uint8Array(e.response.attestationObject)),clientDataJSON:ws(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=n.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function aC(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const n=e,r=e.getClientExtensionResults(),i=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:ws(new Uint8Array(i.authenticatorData)),clientDataJSON:ws(new Uint8Array(i.clientDataJSON)),signature:ws(new Uint8Array(i.signature)),userHandle:i.userHandle?ws(new Uint8Array(i.userHandle)):void 0},type:"public-key",clientExtensionResults:r,authenticatorAttachment:(t=n.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function Mw(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function s0(){var e,t;return!!(yn()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function lC(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new td("Browser returned unexpected credential type",t)}:{data:null,error:new td("Empty credential response",t)}}catch(t){return{data:null,error:eC({error:t,options:e})}}}async function cC(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new td("Browser returned unexpected credential type",t)}:{data:null,error:new td("Empty credential response",t)}}catch(t){return{data:null,error:tC({error:t,options:e})}}}const dC={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},uC={userVerification:"preferred",hints:["security-key"]};function nd(...e){const t=i=>i!==null&&typeof i=="object"&&!Array.isArray(i),n=i=>i instanceof ArrayBuffer||ArrayBuffer.isView(i),r={};for(const i of e)if(i)for(const s in i){const a=i[s];if(a!==void 0)if(Array.isArray(a))r[s]=a;else if(n(a))r[s]=a;else if(t(a)){const l=r[s];t(l)?r[s]=nd(l,a):r[s]=nd(a)}else r[s]=a}return r}function hC(e,t){return nd(dC,e,t||{})}function pC(e,t){return nd(uC,e,t||{})}class fC{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:n,friendlyName:r,signal:i},s){try{const{data:a,error:l}=await this.client.mfa.challenge({factorId:t,webauthn:n});if(!a)return{data:null,error:l};const c=i??rC.createNewAbortSignal();if(a.webauthn.type==="create"){const{user:d}=a.webauthn.credential_options.publicKey;d.name||(d.name=`${d.id}:${r}`),d.displayName||(d.displayName=d.name)}switch(a.webauthn.type){case"create":{const d=hC(a.webauthn.credential_options.publicKey,s==null?void 0:s.create),{data:u,error:p}=await lC({publicKey:d,signal:c});return u?{data:{factorId:t,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:u}},error:null}:{data:null,error:p}}case"request":{const d=pC(a.webauthn.credential_options.publicKey,s==null?void 0:s.request),{data:u,error:p}=await cC(Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:d,signal:c}));return u?{data:{factorId:t,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:u}},error:null}:{data:null,error:p}}}}catch(a){return qe(a)?{data:null,error:a}:{data:null,error:new ms("Unexpected error in challenge",a)}}}async _verify({challengeId:t,factorId:n,webauthn:r}){return this.client.mfa.verify({factorId:n,challengeId:t,webauthn:r})}async _authenticate({factorId:t,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:i}},s){if(!n)return{data:null,error:new ul("rpId is required for WebAuthn authentication")};try{if(!s0())return{data:null,error:new ms("Browser does not support WebAuthn",null)};const{data:a,error:l}=await this.challenge({factorId:t,webauthn:{rpId:n,rpOrigins:r},signal:i},{request:s});if(!a)return{data:null,error:l};const{webauthn:c}=a;return this._verify({factorId:t,challengeId:a.challengeId,webauthn:{type:c.type,rpId:n,rpOrigins:r,credential_response:c.credential_response}})}catch(a){return qe(a)?{data:null,error:a}:{data:null,error:new ms("Unexpected error in authenticate",a)}}}async _register({friendlyName:t,rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:i},s){if(!n)return{data:null,error:new ul("rpId is required for WebAuthn registration")};try{if(!s0())return{data:null,error:new ms("Browser does not support WebAuthn",null)};const{data:a,error:l}=await this._enroll({friendlyName:t});if(!a)return await this.client.mfa.listFactors().then(u=>{var p;return(p=u.data)===null||p===void 0?void 0:p.all.find(h=>h.factor_type==="webauthn"&&h.friendly_name===t&&h.status!=="unverified")}).then(u=>u?this.client.mfa.unenroll({factorId:u==null?void 0:u.id}):void 0),{data:null,error:l};const{data:c,error:d}=await this._challenge({factorId:a.id,friendlyName:a.friendly_name,webauthn:{rpId:n,rpOrigins:r},signal:i},{create:s});return c?this._verify({factorId:a.id,challengeId:c.challengeId,webauthn:{rpId:n,rpOrigins:r,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:d}}catch(a){return qe(a)?{data:null,error:a}:{data:null,error:new ms("Unexpected error in register",a)}}}}Zj();const mC={url:uj,storageKey:hj,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:pj,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function o0(e,t,n){return await n()}const Ys={};class hl{get jwks(){var t,n;return(n=(t=Ys[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(t){Ys[this.storageKey]=Object.assign(Object.assign({},Ys[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,n;return(n=(t=Ys[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Ys[this.storageKey]=Object.assign(Object.assign({},Ys[this.storageKey]),{cachedAt:t})}constructor(t){var n,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=hl.nextInstanceID,hl.nextInstanceID+=1,this.instanceID>0&&yn()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},mC),t);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new qj({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=Rw(i.fetch),this.lock=i.lock||o0,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,i.lock?this.lock=i.lock:yn()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=Xj:this.lock=o0,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new fC(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:Pw()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=i0(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=i0(this.memoryStorage)),yn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Ew}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let n={},r="none";if(yn()&&(n=Ej(window.location.href),this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce")),yn()&&this.detectSessionInUrl&&r!=="none"){const{data:i,error:s}=await this._getSessionFromURL(n,r);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),xj(s)){const c=(t=s.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:a,redirectType:l}=i;return this._debug("#_initialize()","detected session in URL",a,"redirect type",l),await this._saveSession(a),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return qe(n)?this._returnResult({error:n}):this._returnResult({error:new ms("Unexpected error during initialization",n)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var n,r,i;try{const s=await tt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=t==null?void 0:t.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(i=t==null?void 0:t.options)===null||i===void 0?void 0:i.captchaToken}},xform:vr}),{data:a,error:l}=s;if(l||!a)return this._returnResult({data:{user:null,session:null},error:l});const c=a.session,d=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(s){if(qe(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signUp(t){var n,r,i;try{let s;if("email"in t){const{email:u,password:p,options:h}=t;let f=null,m=null;this.flowType==="pkce"&&([f,m]=await Gs(this.storage,this.storageKey)),s=await tt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:u,password:p,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:f,code_challenge_method:m},xform:vr})}else if("phone"in t){const{phone:u,password:p,options:h}=t;s=await tt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:p,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},channel:(i=h==null?void 0:h.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:vr})}else throw new ic("You must provide either an email or phone number and a password");const{data:a,error:l}=s;if(l||!a)return this._returnResult({data:{user:null,session:null},error:l});const c=a.session,d=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(s){if(qe(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithPassword(t){try{let n;if("email"in t){const{email:s,password:a,options:l}=t;n=await tt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:n0})}else if("phone"in t){const{phone:s,password:a,options:l}=t;n=await tt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:n0})}else throw new ic("You must provide either an email or phone number and a password");const{data:r,error:i}=n;if(i)return this._returnResult({data:{user:null,session:null},error:i});if(!r||!r.session||!r.user){const s=new Ws;return this._returnResult({data:{user:null,session:null},error:s})}return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),this._returnResult({data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:i})}catch(n){if(qe(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOAuth(t){var n,r,i,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(n=t.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=t.options)===null||r===void 0?void 0:r.scopes,queryParams:(i=t.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:n}=t;switch(n){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}}async signInWithEthereum(t){var n,r,i,s,a,l,c,d,u,p,h;let f,m;if("message"in t)f=t.message,m=t.signature;else{const{chain:g,wallet:x,statement:y,options:v}=t;let b;if(yn())if(typeof x=="object")b=x;else{const T=window;if("ethereum"in T&&typeof T.ethereum=="object"&&"request"in T.ethereum&&typeof T.ethereum.request=="function")b=T.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(v!=null&&v.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");b=x}const w=new URL((n=v==null?void 0:v.url)!==null&&n!==void 0?n:window.location.href),C=await b.request({method:"eth_requestAccounts"}).then(T=>T).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!C||C.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const _=Aw(C[0]);let j=(r=v==null?void 0:v.signInWithEthereum)===null||r===void 0?void 0:r.chainId;if(!j){const T=await b.request({method:"eth_chainId"});j=Kj(T)}const E={domain:w.host,address:_,statement:y,uri:w.href,version:"1",chainId:j,nonce:(i=v==null?void 0:v.signInWithEthereum)===null||i===void 0?void 0:i.nonce,issuedAt:(a=(s=v==null?void 0:v.signInWithEthereum)===null||s===void 0?void 0:s.issuedAt)!==null&&a!==void 0?a:new Date,expirationTime:(l=v==null?void 0:v.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=v==null?void 0:v.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(d=v==null?void 0:v.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(u=v==null?void 0:v.signInWithEthereum)===null||u===void 0?void 0:u.resources};f=Qj(E),m=await b.request({method:"personal_sign",params:[Jj(f),_]})}try{const{data:g,error:x}=await tt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:f,signature:m},!((p=t.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(h=t.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:vr});if(x)throw x;if(!g||!g.session||!g.user){const y=new Ws;return this._returnResult({data:{user:null,session:null},error:y})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:Object.assign({},g),error:x})}catch(g){if(qe(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async signInWithSolana(t){var n,r,i,s,a,l,c,d,u,p,h,f;let m,g;if("message"in t)m=t.message,g=t.signature;else{const{chain:x,wallet:y,statement:v,options:b}=t;let w;if(yn())if(typeof y=="object")w=y;else{const _=window;if("solana"in _&&typeof _.solana=="object"&&("signIn"in _.solana&&typeof _.solana.signIn=="function"||"signMessage"in _.solana&&typeof _.solana.signMessage=="function"))w=_.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!(b!=null&&b.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=y}const C=new URL((n=b==null?void 0:b.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in w&&w.signIn){const _=await w.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},b==null?void 0:b.signInWithSolana),{version:"1",domain:C.host,uri:C.href}),v?{statement:v}:null));let j;if(Array.isArray(_)&&_[0]&&typeof _[0]=="object")j=_[0];else if(_&&typeof _=="object"&&"signedMessage"in _&&"signature"in _)j=_;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in j&&"signature"in j&&(typeof j.signedMessage=="string"||j.signedMessage instanceof Uint8Array)&&j.signature instanceof Uint8Array)m=typeof j.signedMessage=="string"?j.signedMessage:new TextDecoder().decode(j.signedMessage),g=j.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in w)||typeof w.signMessage!="function"||!("publicKey"in w)||typeof w!="object"||!w.publicKey||!("toBase58"in w.publicKey)||typeof w.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");m=[`${C.host} wants you to sign in with your Solana account:`,w.publicKey.toBase58(),...v?["",v,""]:[""],"Version: 1",`URI: ${C.href}`,`Issued At: ${(i=(r=b==null?void 0:b.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((s=b==null?void 0:b.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${b.signInWithSolana.notBefore}`]:[],...!((a=b==null?void 0:b.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${b.signInWithSolana.expirationTime}`]:[],...!((l=b==null?void 0:b.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${b.signInWithSolana.chainId}`]:[],...!((c=b==null?void 0:b.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${b.signInWithSolana.nonce}`]:[],...!((d=b==null?void 0:b.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${b.signInWithSolana.requestId}`]:[],...!((p=(u=b==null?void 0:b.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||p===void 0)&&p.length?["Resources",...b.signInWithSolana.resources.map(j=>`- ${j}`)]:[]].join(`
`);const _=await w.signMessage(new TextEncoder().encode(m),"utf8");if(!_||!(_ instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");g=_}}try{const{data:x,error:y}=await tt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:m,signature:ws(g)},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(f=t.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:vr});if(y)throw y;if(!x||!x.session||!x.user){const v=new Ws;return this._returnResult({data:{user:null,session:null},error:v})}return x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",x.session)),this._returnResult({data:Object.assign({},x),error:y})}catch(x){if(qe(x))return this._returnResult({data:{user:null,session:null},error:x});throw x}}async _exchangeCodeForSession(t){const n=await ls(this.storage,`${this.storageKey}-code-verifier`),[r,i]=(n??"").split("/");try{const{data:s,error:a}=await tt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:r},xform:vr});if(await Ci(this.storage,`${this.storageKey}-code-verifier`),a)throw a;if(!s||!s.session||!s.user){const l=new Ws;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign(Object.assign({},s),{redirectType:i??null}),error:a})}catch(s){if(qe(s))return this._returnResult({data:{user:null,session:null,redirectType:null},error:s});throw s}}async signInWithIdToken(t){try{const{options:n,provider:r,token:i,access_token:s,nonce:a}=t,l=await tt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:i,access_token:s,nonce:a,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:vr}),{data:c,error:d}=l;if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!c||!c.session||!c.user){const u=new Ws;return this._returnResult({data:{user:null,session:null},error:u})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:d})}catch(n){if(qe(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOtp(t){var n,r,i,s,a;try{if("email"in t){const{email:l,options:c}=t;let d=null,u=null;this.flowType==="pkce"&&([d,u]=await Gs(this.storage,this.storageKey));const{error:p}=await tt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(n=c==null?void 0:c.data)!==null&&n!==void 0?n:{},create_user:(r=c==null?void 0:c.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:d,code_challenge_method:u},redirectTo:c==null?void 0:c.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:p})}if("phone"in t){const{phone:l,options:c}=t,{data:d,error:u}=await tt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(i=c==null?void 0:c.data)!==null&&i!==void 0?i:{},create_user:(s=c==null?void 0:c.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(a=c==null?void 0:c.channel)!==null&&a!==void 0?a:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:u})}throw new ic("You must provide either an email or phone number.")}catch(l){if(qe(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(t){var n,r;try{let i,s;"options"in t&&(i=(n=t.options)===null||n===void 0?void 0:n.redirectTo,s=(r=t.options)===null||r===void 0?void 0:r.captchaToken);const{data:a,error:l}=await tt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:i,xform:vr});if(l)throw l;if(!a)throw new Error("An error occurred on token verification.");const c=a.session,d=a.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(i){if(qe(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithSSO(t){var n,r,i;try{let s=null,a=null;this.flowType==="pkce"&&([s,a]=await Gs(this.storage,this.storageKey));const l=await tt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(r=(n=t.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((i=t==null?void 0:t.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:a}),headers:this.headers,xform:Wj});return this._returnResult(l)}catch(s){if(qe(s))return this._returnResult({data:null,error:s});throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:n},error:r}=t;if(r)throw r;if(!n)throw new gr;const{error:i}=await tt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return this._returnResult({data:{user:null,session:null},error:i})})}catch(t){if(qe(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const n=`${this.url}/resend`;if("email"in t){const{email:r,type:i,options:s}=t,{error:a}=await tt(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:a})}else if("phone"in t){const{phone:r,type:i,options:s}=t,{data:a,error:l}=await tt(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:l})}throw new ic("You must provide either an email or phone number and a type")}catch(n){if(qe(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(t,n){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await t(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const n=await ls(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?t=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const r=t.expires_at?t.expires_at*1e3-Date.now()<Nu:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",t.expires_at),!r){if(this.userStorage){const a=await ls(this.userStorage,this.storageKey+"-user");a!=null&&a.user?t.user=a.user:t.user=Ou()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const a={value:this.suppressGetSessionWarning};t.user=Fj(t.user,a),a.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:i,error:s}=await this._callRefreshToken(t.refresh_token);return s?this._returnResult({data:{session:null},error:s}):this._returnResult({data:{session:i},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await tt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Oi}):await this._useSession(async n=>{var r,i,s;const{data:a,error:l}=n;if(l)throw l;return!(!((r=a.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new gr}:await tt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(i=a.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0,xform:Oi})})}catch(n){if(qe(n))return yj(n)&&(await this._removeSession(),await Ci(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:n});throw n}}async updateUser(t,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,n))}async _updateUser(t,n={}){try{return await this._useSession(async r=>{const{data:i,error:s}=r;if(s)throw s;if(!i.session)throw new gr;const a=i.session;let l=null,c=null;this.flowType==="pkce"&&t.email!=null&&([l,c]=await Gs(this.storage,this.storageKey));const{data:d,error:u}=await tt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:c}),jwt:a.access_token,xform:Oi});if(u)throw u;return a.user=d.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),this._returnResult({data:{user:a.user},error:null})})}catch(r){if(qe(r))return this._returnResult({data:{user:null},error:r});throw r}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new gr;const n=Date.now()/1e3;let r=n,i=!0,s=null;const{payload:a}=Ru(t.access_token);if(a.exp&&(r=a.exp,i=r<=n),i){const{data:l,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l)return{data:{user:null,session:null},error:null};s=l}else{const{data:l,error:c}=await this._getUser(t.access_token);if(c)throw c;s={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return this._returnResult({data:{user:s.user,session:s},error:null})}catch(n){if(qe(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async n=>{var r;if(!t){const{data:a,error:l}=n;if(l)throw l;t=(r=a.session)!==null&&r!==void 0?r:void 0}if(!(t!=null&&t.refresh_token))throw new gr;const{data:i,error:s}=await this._callRefreshToken(t.refresh_token);return s?this._returnResult({data:{user:null,session:null},error:s}):i?this._returnResult({data:{user:i.user,session:i},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(n){if(qe(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async _getSessionFromURL(t,n){try{if(!yn())throw new sc("No browser detected.");if(t.error||t.error_description||t.error_code)throw new sc(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new Xg("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new sc("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Xg("No code detected.");const{data:v,error:b}=await this._exchangeCodeForSession(t.code);if(b)throw b;const w=new URL(window.location.href);return w.searchParams.delete("code"),window.history.replaceState(window.history.state,"",w.toString()),{data:{session:v.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:i,access_token:s,refresh_token:a,expires_in:l,expires_at:c,token_type:d}=t;if(!s||!l||!a||!d)throw new sc("No session defined in URL");const u=Math.round(Date.now()/1e3),p=parseInt(l);let h=u+p;c&&(h=parseInt(c));const f=h-u;f*1e3<=Xs&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${p}s`);const m=h-p;u-m>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",m,h,u):u-m<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",m,h,u);const{data:g,error:x}=await this._getUser(s);if(x)throw x;const y={provider_token:r,provider_refresh_token:i,access_token:s,expires_in:p,expires_at:h,refresh_token:a,token_type:d,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:y,redirectType:t.type},error:null})}catch(r){if(qe(r))return this._returnResult({data:{session:null,redirectType:null},error:r});throw r}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const n=await ls(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&n)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:i,error:s}=n;if(s)return this._returnResult({error:s});const a=(r=i.session)===null||r===void 0?void 0:r.access_token;if(a){const{error:l}=await this.admin.signOut(a,t);if(l&&!(vj(l)&&(l.status===404||l.status===401||l.status===403)))return this._returnResult({error:l})}return t!=="others"&&(await this._removeSession(),await Ci(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const n=Cj(),r={id:n,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(t){return await this._useSession(async n=>{var r,i;try{const{data:{session:s},error:a}=n;if(a)throw a;await((r=this.stateChangeEmitters.get(t))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,n={}){let r=null,i=null;this.flowType==="pkce"&&([r,i]=await Gs(this.storage,this.storageKey,!0));try{return await tt(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:r,code_challenge_method:i,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(s){if(qe(s))return this._returnResult({data:null,error:s});throw s}}async getUserIdentities(){var t;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return this._returnResult({data:{identities:(t=n.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(n){if(qe(n))return this._returnResult({data:null,error:n});throw n}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var n;try{const{data:r,error:i}=await this._useSession(async s=>{var a,l,c,d,u;const{data:p,error:h}=s;if(h)throw h;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(a=t.options)===null||a===void 0?void 0:a.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await tt(this.fetch,"GET",f,{headers:this.headers,jwt:(u=(d=p.session)===null||d===void 0?void 0:d.access_token)!==null&&u!==void 0?u:void 0})});if(i)throw i;return yn()&&!(!((n=t.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),this._returnResult({data:{provider:t.provider,url:r==null?void 0:r.url},error:null})}catch(r){if(qe(r))return this._returnResult({data:{provider:t.provider,url:null},error:r});throw r}}async linkIdentityIdToken(t){return await this._useSession(async n=>{var r;try{const{error:i,data:{session:s}}=n;if(i)throw i;const{options:a,provider:l,token:c,access_token:d,nonce:u}=t,p=await tt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(r=s==null?void 0:s.access_token)!==null&&r!==void 0?r:void 0,body:{provider:l,id_token:c,access_token:d,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:vr}),{data:h,error:f}=p;return f?this._returnResult({data:{user:null,session:null},error:f}):!h||!h.session||!h.user?this._returnResult({data:{user:null,session:null},error:new Ws}):(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("USER_UPDATED",h.session)),this._returnResult({data:h,error:f}))}catch(i){if(qe(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}})}async unlinkIdentity(t){try{return await this._useSession(async n=>{var r,i;const{data:s,error:a}=n;if(a)throw a;return await tt(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(i=(r=s.session)===null||r===void 0?void 0:r.access_token)!==null&&i!==void 0?i:void 0})})}catch(n){if(qe(n))return this._returnResult({data:null,error:n});throw n}}async _refreshAccessToken(t){const n=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await Pj(async i=>(i>0&&await Nj(200*Math.pow(2,i-1)),this._debug(n,"refreshing attempt",i),await tt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:vr})),(i,s)=>{const a=200*Math.pow(2,i);return s&&Pu(s)&&Date.now()+a-r<Xs})}catch(r){if(this._debug(n,"error",r),qe(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}finally{this._debug(n,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",n,"url",r),yn()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:t,url:r},error:null}}async _recoverAndRefresh(){var t,n;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const i=await ls(this.storage,this.storageKey);if(i&&this.userStorage){let a=await ls(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:i.user},await Zs(this.userStorage,this.storageKey+"-user",a)),i.user=(t=a==null?void 0:a.user)!==null&&t!==void 0?t:Ou()}else if(i&&!i.user&&!i.user){const a=await ls(this.storage,this.storageKey+"-user");a&&(a!=null&&a.user)?(i.user=a.user,await Ci(this.storage,this.storageKey+"-user"),await Zs(this.storage,this.storageKey,i)):i.user=Ou()}if(this._debug(r,"session from storage",i),!this._isValidSession(i)){this._debug(r,"session is not valid"),i!==null&&await this._removeSession();return}const s=((n=i.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<Nu;if(this._debug(r,`session has${s?"":" not"} expired with margin of ${Nu}s`),s){if(this.autoRefreshToken&&i.refresh_token){const{error:a}=await this._callRefreshToken(i.refresh_token);a&&(console.error(a),Pu(a)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:l}=await this._getUser(i.access_token);!l&&(a!=null&&a.user)?(i.user=a.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(r,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(r,"error",i),console.error(i);return}finally{this._debug(r,"end")}}async _callRefreshToken(t){var n,r;if(!t)throw new gr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new Md;const{data:s,error:a}=await this._refreshAccessToken(t);if(a)throw a;if(!s.session)throw new gr;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const l={data:s.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(s){if(this._debug(i,"error",s),qe(s)){const a={data:null,error:s};return Pu(s)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(a),a}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(s),s}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(t,n,r=!0){const i=`#_notifyAllSubscribers(${t})`;this._debug(i,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:t,session:n});const s=[],a=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,n)}catch(c){s.push(c)}});if(await Promise.all(a),s.length>0){for(let l=0;l<s.length;l+=1)console.error(s[l]);throw s[0]}}finally{this._debug(i,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const n=Object.assign({},t),r=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&n.user&&await Zs(this.userStorage,this.storageKey+"-user",{user:n.user});const i=Object.assign({},n);delete i.user;const s=e0(i);await Zs(this.storage,this.storageKey,s)}else{const i=e0(n);await Zs(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),await Ci(this.storage,this.storageKey),await Ci(this.storage,this.storageKey+"-code-verifier"),await Ci(this.storage,this.storageKey+"-user"),this.userStorage&&await Ci(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&yn()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Xs);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((r.expires_at*1e3-t)/Xs);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${Xs}ms, refresh threshold is ${tp} ticks`),i<=tp&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Ow)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!yn()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const n=`#_onVisibilityChanged(${t})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,n,r){const i=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&i.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&i.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[s,a]=await Gs(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(a)}`});i.push(l.toString())}if(r!=null&&r.queryParams){const s=new URLSearchParams(r.queryParams);i.push(s.toString())}return r!=null&&r.skipBrowserRedirect&&i.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${t}?${i.join("&")}`}async _unenroll(t){try{return await this._useSession(async n=>{var r;const{data:i,error:s}=n;return s?this._returnResult({data:null,error:s}):await tt(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(qe(n))return this._returnResult({data:null,error:n});throw n}}async _enroll(t){try{return await this._useSession(async n=>{var r,i;const{data:s,error:a}=n;if(a)return this._returnResult({data:null,error:a});const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:c,error:d}=await tt(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return d?this._returnResult({data:null,error:d}):(t.factorType==="totp"&&c.type==="totp"&&(!((i=c==null?void 0:c.totp)===null||i===void 0)&&i.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(n){if(qe(n))return this._returnResult({data:null,error:n});throw n}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:i,error:s}=n;if(s)return this._returnResult({data:null,error:s});const a=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?oC(t.webauthn.credential_response):aC(t.webauthn.credential_response)})}:{code:t.code}),{data:l,error:c}=await tt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:a,headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:c}))})}catch(n){if(qe(n))return this._returnResult({data:null,error:n});throw n}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:i,error:s}=n;if(s)return this._returnResult({data:null,error:s});const a=await tt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});if(a.error)return a;const{data:l}=a;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:iC(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:sC(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(n){if(qe(n))return this._returnResult({data:null,error:n});throw n}})}async _challengeAndVerify(t){const{data:n,error:r}=await this._challenge({factorId:t.factorId});return r?this._returnResult({data:null,error:r}):await this._verify({factorId:t.factorId,challengeId:n.id,code:t.code})}async _listFactors(){var t;const{data:{user:n},error:r}=await this.getUser();if(r)return{data:null,error:r};const i={all:[],phone:[],totp:[],webauthn:[]};for(const s of(t=n==null?void 0:n.factors)!==null&&t!==void 0?t:[])i.all.push(s),s.status==="verified"&&i[s.factor_type].push(s);return{data:i,error:null}}async _getAuthenticatorAssuranceLevel(){var t,n;const{data:{session:r},error:i}=await this.getSession();if(i)return this._returnResult({data:null,error:i});if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:s}=Ru(r.access_token);let a=null;s.aal&&(a=s.aal);let l=a;((n=(t=r.user.factors)===null||t===void 0?void 0:t.filter(u=>u.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const d=s.amr||[];return{data:{currentLevel:a,nextLevel:l,currentAuthenticationMethods:d},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async n=>{const{data:{session:r},error:i}=n;return i?this._returnResult({data:null,error:i}):r?await tt(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:r.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new gr})})}catch(n){if(qe(n))return this._returnResult({data:null,error:n});throw n}}async _approveAuthorization(t,n){try{return await this._useSession(async r=>{const{data:{session:i},error:s}=r;if(s)return this._returnResult({data:null,error:s});if(!i)return this._returnResult({data:null,error:new gr});const a=await tt(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return a.data&&a.data.redirect_url&&yn()&&!(n!=null&&n.skipBrowserRedirect)&&window.location.assign(a.data.redirect_url),a})}catch(r){if(qe(r))return this._returnResult({data:null,error:r});throw r}}async _denyAuthorization(t,n){try{return await this._useSession(async r=>{const{data:{session:i},error:s}=r;if(s)return this._returnResult({data:null,error:s});if(!i)return this._returnResult({data:null,error:new gr});const a=await tt(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return a.data&&a.data.redirect_url&&yn()&&!(n!=null&&n.skipBrowserRedirect)&&window.location.assign(a.data.redirect_url),a})}catch(r){if(qe(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,n={keys:[]}){let r=n.keys.find(l=>l.kid===t);if(r)return r;const i=Date.now();if(r=this.jwks.keys.find(l=>l.kid===t),r&&this.jwks_cached_at+mj>i)return r;const{data:s,error:a}=await tt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=i,r=s.keys.find(l=>l.kid===t),!r)?null:r}async getClaims(t,n={}){try{let r=t;if(!r){const{data:f,error:m}=await this.getSession();if(m||!f.session)return this._returnResult({data:null,error:m});r=f.session.access_token}const{header:i,payload:s,signature:a,raw:{header:l,payload:c}}=Ru(r);n!=null&&n.allowExpired||Ij(s.exp);const d=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!d){const{error:f}=await this.getUser(r);if(f)throw f;return{data:{claims:s,header:i,signature:a},error:null}}const u=Dj(i.alg),p=await crypto.subtle.importKey("jwk",d,u,!0,["verify"]);if(!await crypto.subtle.verify(u,p,a,kj(`${l}.${c}`)))throw new ip("Invalid JWT signature");return{data:{claims:s,header:i,signature:a},error:null}}catch(r){if(qe(r))return this._returnResult({data:null,error:r});throw r}}}hl.nextInstanceID=0;const gC=hl;class vC extends gC{constructor(t){super(t)}}class yC{constructor(t,n,r){var i,s,a;this.supabaseUrl=t,this.supabaseKey=n;const l=dj(t);if(!n)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,d={db:nj,realtime:ij,auth:Object.assign(Object.assign({},rj),{storageKey:c}),global:tj},u=cj(r??{},d);this.storageKey=(i=u.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(s=u.global.headers)!==null&&s!==void 0?s:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(p,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=u.auth)!==null&&a!==void 0?a:{},this.headers,u.global.fetch),this.fetch=aj(n,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new uk(new URL("rest/v1",l).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new Jk(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new lk(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,n={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,n,r)}channel(t,n={config:{}}){return this.realtime.channel(t,n)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t,n;if(this.accessToken)return await this.accessToken();const{data:r}=await this.auth.getSession();return(n=(t=r.session)===null||t===void 0?void 0:t.access_token)!==null&&n!==void 0?n:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:n,detectSessionInUrl:r,storage:i,userStorage:s,storageKey:a,flowType:l,lock:c,debug:d,throwOnError:u},p,h){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new vC({url:this.authUrl.href,headers:Object.assign(Object.assign({},f),p),storageKey:a,autoRefreshToken:t,persistSession:n,detectSessionInUrl:r,storage:i,userStorage:s,flowType:l,lock:c,debug:d,throwOnError:u,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(m=>m.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new Tk(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,r)=>{this._handleTokenChanged(n,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(t,n,r){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const xC=(e,t,n)=>new yC(e,t,n);function bC(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}bC()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const a0={DRAFTIFY:"/api/studio-draftify",GEOMETRIC_GENERATE:"/api/studio-generate-geometric"},l0={URL:"https://okakomwfikxmwllvliva.supabase.co",ANON_KEY:""},c0={AUTH_SESSION:"studio_auth_session"},gs={BLEND_MODE_ENABLED:!1},Jt=xC(l0.URL,l0.ANON_KEY),Br={async signIn(e,t){const{data:n,error:r}=await Jt.auth.signInWithPassword({email:e,password:t});if(r)throw r;return localStorage.setItem(c0.AUTH_SESSION,JSON.stringify(n.session)),n},async signOut(){await Jt.auth.signOut(),localStorage.removeItem(c0.AUTH_SESSION)},async getSession(){const{data:e}=await Jt.auth.getSession();return e.session},async updatePassword(e){const{data:t,error:n}=await Jt.auth.updateUser({password:e});if(n)throw n;return await Jt.auth.updateUser({data:{password_setup_complete:!0}}),t},onAuthStateChange(e){return Jt.auth.onAuthStateChange(e)}};async function $d(){var n,r;const e=await Jt.auth.getSession(),t=(r=(n=e==null?void 0:e.data)==null?void 0:n.session)==null?void 0:r.access_token;if(!t)throw new Error("Not authenticated");return{"Content-Type":"application/json",Authorization:`Bearer ${t}`}}async function _f(e){const t=await $d(),n=await fetch("/api/designs/save",{method:"POST",headers:t,body:JSON.stringify(e)});if(!n.ok){const r=await n.json();throw new Error(r.error||"Unable to save your design. Please check your connection and try again.")}return n.json()}async function rd({project_id:e,limit:t=50,offset:n=0,search:r}={}){const i=await $d(),s=new URLSearchParams;e&&s.append("project_id",e),s.append("limit",t),s.append("offset",n),r&&s.append("search",r);const a=await fetch(`/api/designs/list?${s}`,{method:"GET",headers:i});if(!a.ok){const l=await a.json();throw new Error(l.error||"Unable to load your designs. Please refresh the page and try again.")}return a.json()}async function _l(e){const t=await $d(),n=await fetch(`/api/designs/by-id?id=${e}`,{method:"GET",headers:t});if(!n.ok){const r=await n.json();throw new Error(r.error||"Unable to open this design. It may have been deleted or you may not have permission to view it.")}return n.json()}async function wC(e){const t=await $d(),n=await fetch(`/api/designs/by-id?id=${e}`,{method:"DELETE",headers:t});if(!n.ok){const r=await n.json();throw new Error(r.error||"Unable to delete this design. Please check your connection and try again.")}return n.json()}class _C extends L.Component{constructor(n){super(n);km(this,"handleReset",()=>{this.setState({hasError:!1,error:null,errorInfo:null})});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(n){return{hasError:!0}}componentDidCatch(n,r){console.error("[ErrorBoundary] Caught error:",n,r),this.setState({error:n,errorInfo:r})}render(){return this.state.hasError?o.jsxs("div",{className:"error-boundary",children:[o.jsxs("div",{className:"error-content",children:[o.jsx("h1",{children:"Something went wrong"}),o.jsx("p",{children:"We're sorry, but something unexpected happened. Please try refreshing the page."}),o.jsxs("div",{className:"error-actions",children:[o.jsx("button",{onClick:this.handleReset,className:"btn-primary",children:"Try Again"}),o.jsx("button",{onClick:()=>window.location.reload(),className:"btn-secondary",children:"Refresh Page"})]}),!1]}),o.jsx("style",{jsx:!0,children:`
            .error-boundary {
              min-height: 100vh;
              display: flex;
              align-items: center;
              justify-content: center;
              padding: 2rem;
              background: #f9fafb;
            }

            .error-content {
              max-width: 500px;
              text-align: center;
              background: white;
              padding: 3rem;
              border-radius: 12px;
              box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            }

            h1 {
              color: #1e4a7a;
              margin: 0 0 1rem 0;
              font-size: 1.75rem;
            }

            p {
              color: #6b7280;
              margin: 0 0 2rem 0;
              line-height: 1.6;
            }

            .error-actions {
              display: flex;
              gap: 1rem;
              justify-content: center;
            }

            .btn-primary,
            .btn-secondary {
              padding: 0.75rem 1.5rem;
              border-radius: 6px;
              font-weight: 500;
              cursor: pointer;
              transition: all 0.2s;
              border: none;
            }

            .btn-primary {
              background: #ff6b35;
              color: white;
            }

            .btn-primary:hover {
              background: #e55a2b;
              transform: translateY(-1px);
            }

            .btn-secondary {
              background: white;
              color: #374151;
              border: 1px solid #d1d5db;
            }

            .btn-secondary:hover {
              background: #f9fafb;
            }

            .error-details {
              margin-top: 2rem;
              text-align: left;
              font-size: 0.875rem;
            }

            .error-details summary {
              cursor: pointer;
              color: #6b7280;
              margin-bottom: 0.5rem;
            }

            .error-details pre {
              background: #f3f4f6;
              padding: 1rem;
              border-radius: 4px;
              overflow-x: auto;
              font-size: 0.75rem;
              color: #dc2626;
            }
          `})]}):this.props.children}}const SC="modulepreload",kC=function(e){return"/"+e},d0={},jC=function(t,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),l=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=Promise.allSettled(n.map(c=>{if(c=kC(c),c in d0)return;d0[c]=!0;const d=c.endsWith(".css"),u=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const p=document.createElement("link");if(p.rel=d?"stylesheet":SC,d||(p.as="script"),p.crossOrigin="",p.href=c,l&&p.setAttribute("nonce",l),document.head.appendChild(p),d)return new Promise((h,f)=>{p.addEventListener("load",h),p.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(a){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=a,window.dispatchEvent(l),!l.defaultPrevented)throw a}return i.then(a=>{for(const l of a||[])l.status==="rejected"&&s(l.reason);return t().catch(s)})},u0=e=>{let t;const n=new Set,r=(d,u)=>{const p=typeof d=="function"?d(t):d;if(!Object.is(p,t)){const h=t;t=u??(typeof p!="object"||p===null)?p:Object.assign({},t,p),n.forEach(f=>f(t,h))}},i=()=>t,l={setState:r,getState:i,getInitialState:()=>c,subscribe:d=>(n.add(d),()=>n.delete(d))},c=t=e(r,i,l);return l},CC=e=>e?u0(e):u0,EC=e=>e;function TC(e,t=EC){const n=L.useSyncExternalStore(e.subscribe,L.useCallback(()=>t(e.getState()),[e,t]),L.useCallback(()=>t(e.getInitialState()),[e,t]));return L.useDebugValue(n),n}const h0=e=>{const t=CC(e),n=r=>TC(t,r);return Object.assign(n,t),n},$w=e=>e?h0(e):h0,p0={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},pl=new Map,oc=e=>{const t=pl.get(e);return t?Object.fromEntries(Object.entries(t.stores).map(([n,r])=>[n,r.getState()])):{}},NC=(e,t,n)=>{if(e===void 0)return{type:"untracked",connection:t.connect(n)};const r=pl.get(n.name);if(r)return{type:"tracked",store:e,...r};const i={connection:t.connect(n),stores:{}};return pl.set(n.name,i),{type:"tracked",store:e,...i}},PC=(e,t)=>{if(t===void 0)return;const n=pl.get(e);n&&(delete n.stores[t],Object.keys(n.stores).length===0&&pl.delete(e))},RC=e=>{var t,n;if(!e)return;const r=e.split(`
`),i=r.findIndex(a=>a.includes("api.setState"));if(i<0)return;const s=((t=r[i+1])==null?void 0:t.trim())||"";return(n=/.+ (.+) .+/.exec(s))==null?void 0:n[1]},OC=(e,t={})=>(n,r,i)=>{const{enabled:s,anonymousActionType:a,store:l,...c}=t;let d;try{d=(s??(p0?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!d)return e(n,r,i);const{connection:u,...p}=NC(l,d,c);let h=!0;i.setState=(g,x,y)=>{const v=n(g,x);if(!h)return v;const b=y===void 0?{type:a||RC(new Error().stack)||"anonymous"}:typeof y=="string"?{type:y}:y;return l===void 0?(u==null||u.send(b,r()),v):(u==null||u.send({...b,type:`${l}/${b.type}`},{...oc(c.name),[l]:i.getState()}),v)},i.devtools={cleanup:()=>{u&&typeof u.unsubscribe=="function"&&u.unsubscribe(),PC(c.name,l)}};const f=(...g)=>{const x=h;h=!1,n(...g),h=x},m=e(i.setState,r,i);if(p.type==="untracked"?u==null||u.init(m):(p.stores[p.store]=i,u==null||u.init(Object.fromEntries(Object.entries(p.stores).map(([g,x])=>[g,g===p.store?m:x.getState()])))),i.dispatchFromDevtools&&typeof i.dispatch=="function"){let g=!1;const x=i.dispatch;i.dispatch=(...y)=>{(p0?"production":void 0)!=="production"&&y[0].type==="__setState"&&!g&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),g=!0),x(...y)}}return u.subscribe(g=>{var x;switch(g.type){case"ACTION":if(typeof g.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return Mu(g.payload,y=>{if(y.type==="__setState"){if(l===void 0){f(y.state);return}Object.keys(y.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format.
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const v=y.state[l];if(v==null)return;JSON.stringify(i.getState())!==JSON.stringify(v)&&f(v);return}i.dispatchFromDevtools&&typeof i.dispatch=="function"&&i.dispatch(y)});case"DISPATCH":switch(g.payload.type){case"RESET":return f(m),l===void 0?u==null?void 0:u.init(i.getState()):u==null?void 0:u.init(oc(c.name));case"COMMIT":if(l===void 0){u==null||u.init(i.getState());return}return u==null?void 0:u.init(oc(c.name));case"ROLLBACK":return Mu(g.state,y=>{if(l===void 0){f(y),u==null||u.init(i.getState());return}f(y[l]),u==null||u.init(oc(c.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return Mu(g.state,y=>{if(l===void 0){f(y);return}JSON.stringify(i.getState())!==JSON.stringify(y[l])&&f(y[l])});case"IMPORT_STATE":{const{nextLiftedState:y}=g.payload,v=(x=y.computedStates.slice(-1)[0])==null?void 0:x.state;if(!v)return;f(l===void 0?v:v[l]),u==null||u.send(null,y);return}case"PAUSE_RECORDING":return h=!h}return}}),m},Lw=OC,Mu=(e,t)=>{let n;try{n=JSON.parse(e)}catch(r){console.error("[zustand devtools middleware] Could not parse the received json",r)}n!==void 0&&t(n)};function Iw(e){let t=e%2147483647;return t<=0&&(t+=2147483646),function(){return t=t*16807%2147483647,(t-1)/2147483646}}function f0(e,t,n){const r=Iw(n),i=[],s=.4,a=.5,l=.5;for(let c=0;c<e;c++){const d=c/e*Math.PI*2-Math.PI/2,u=(r()-.5)*.4*t,p=d+u,h=1+(r()-.5)*t*.8,f=s*h,m=a+f*Math.cos(p),g=l+f*Math.sin(p),x=.35/e*(1+t*(r()-.5)),y=p+Math.PI/2,v=(r()-.5)*.3*t,b=y+Math.PI+v,w=y+v;i.push({x:m,y:g,handleIn:{x:Math.cos(b)*x,y:Math.sin(b)*x},handleOut:{x:Math.cos(w)*x,y:Math.sin(w)*x}})}return i}function AC(e,t,n){if(!e||e.length<3)return MC(t,n);const r=[],i=e.length;for(let s=0;s<i;s++){const a=e[s],l=e[(s+1)%i],c=a.x*t,d=a.y*n,u=l.x*t,p=l.y*n,h=c+a.handleOut.x*t,f=d+a.handleOut.y*n,m=u+l.handleIn.x*t,g=p+l.handleIn.y*n;s===0&&r.push(`M ${c.toFixed(2)},${d.toFixed(2)}`),r.push(`C ${h.toFixed(2)},${f.toFixed(2)} ${m.toFixed(2)},${g.toFixed(2)} ${u.toFixed(2)},${p.toFixed(2)}`)}return r.push("Z"),r.join(" ")}function MC(e,t){const n=e/2,r=t/2,i=n,s=r;return`M ${i-n},${s} A ${n},${r} 0 1,1 ${i+n},${s} A ${n},${r} 0 1,1 ${i-n},${s} Z`}function $C(){const n=[];for(let a=0;a<8;a++){const l=a/8*Math.PI*2-Math.PI/2,c=.5+.4*Math.cos(l),d=.5+.4*Math.sin(l),u=l+Math.PI/2;n.push({x:c,y:d,handleIn:{x:Math.cos(u+Math.PI)*.2,y:Math.sin(u+Math.PI)*.2},handleOut:{x:Math.cos(u)*.2,y:Math.sin(u)*.2}})}return n}const id={organic:{name:"Organic",description:"Smooth, gentle curves like a pebble",minPoints:6,maxPoints:8,blobinessMin:.15,blobinessMax:.25,handleLengthFactor:.4,radiusVariation:.15},splashy:{name:"Splashy",description:"Irregular edges, some spikes like paint splatter",minPoints:10,maxPoints:12,blobinessMin:.3,blobinessMax:.5,handleLengthFactor:.25,radiusVariation:.35},cloudy:{name:"Cloudy",description:"Soft bumps, fluffy cloud-like appearance",minPoints:8,maxPoints:10,blobinessMin:.2,blobinessMax:.3,handleLengthFactor:.5,radiusVariation:.2},rocky:{name:"Rocky",description:"Angular variations, irregular stone-like edges",minPoints:8,maxPoints:12,blobinessMin:.25,blobinessMax:.4,handleLengthFactor:.2,radiusVariation:.3}};function $u(e,t){const n=id[e]||id.organic,r=Iw(t),i=Math.floor(r()*(n.maxPoints-n.minPoints+1))+n.minPoints,s=n.blobinessMin+r()*(n.blobinessMax-n.blobinessMin),a=[],l=.4,c=.5,d=.5;for(let u=0;u<i;u++){const p=u/i*Math.PI*2-Math.PI/2,h=(r()-.5)*.4*s,f=p+h,m=1+(r()-.5)*n.radiusVariation*2,g=l*m,x=c+g*Math.cos(f),y=d+g*Math.sin(f),b=n.handleLengthFactor/i*(.8+r()*.4),w=f+Math.PI/2,C=(r()-.5)*.3*s,_=w+Math.PI+C,j=w+C;a.push({x,y,handleIn:{x:Math.cos(_)*b,y:Math.sin(_)*b},handleOut:{x:Math.cos(j)*b,y:Math.sin(j)*b}})}return a}function LC(e,t,n,r){return{x:n?.5-(e-.5):e,y:r?.5-(t-.5):t}}function IC(e,t,n,r){return{x:n?-e:e,y:r?-t:t}}function Dw(e,t,n,r=4){const i=[{index:e,mirrorX:!1,mirrorY:!1,rotationAngle:0}];if(n==="none"||!n)return i;if(n==="horizontal"){const s=(t-e)%t;return s!==e&&i.push({index:s,mirrorX:!0,mirrorY:!1,rotationAngle:0}),i}if(n==="vertical"){const s=(Math.floor(t/2)-e+t)%t;return s!==e&&i.push({index:s,mirrorX:!1,mirrorY:!0,rotationAngle:0}),i}if(n==="radial"){for(let s=1;s<r;s++){const a=Math.round(e+s*t/r)%t;if(a!==e){const l=s*2*Math.PI/r;i.push({index:a,mirrorX:!1,mirrorY:!1,rotationAngle:l})}}return i}return i}function DC(e,t,n,r,i,s=4){if(i==="none"||!i)return e.map((l,c)=>c!==t?l:{...l,x:n,y:r});const a=Dw(t,e.length,i,s);return e.map((l,c)=>{const d=a.find(p=>p.index===c);if(!d)return l;if(d.rotationAngle!==0){const f=n-.5,m=r-.5,g=Math.cos(d.rotationAngle),x=Math.sin(d.rotationAngle);return{...l,x:.5+f*g-m*x,y:.5+f*x+m*g}}const u=LC(n,r,d.mirrorX,d.mirrorY);return{...l,x:u.x,y:u.y}})}function zC(e,t,n,r,i,s,a=4){if(s==="none"||!s)return e.map((c,d)=>d!==t?c:{...c,[n]:{x:r,y:i}});const l=Dw(t,e.length,s,a);return e.map((c,d)=>{const u=l.find(m=>m.index===d);if(!u)return c;let p=n,h=r,f=i;if(u.rotationAngle!==0){const m=Math.cos(u.rotationAngle),g=Math.sin(u.rotationAngle);h=r*m-i*g,f=r*g+i*m}else{const m=IC(r,i,u.mirrorX,u.mirrorY);h=m.x,f=m.y}return{...c,[p]:{x:h,y:f}}})}function zw(e,t,n,r=!0,i=!1){if(!e||e.length<2)return"";const s=[],a=e.length;for(let l=0;l<a;l++){const c=e[l],d=l===a-1,u=r?e[(l+1)%a]:d?null:e[l+1],p=c.x*t,h=c.y*n;if(l===0&&s.push(`M ${p.toFixed(2)},${h.toFixed(2)}`),!u)continue;const f=u.x*t,m=u.y*n;if(i&&c.handleOut&&u.handleIn){const g=p+c.handleOut.x*t,x=h+c.handleOut.y*n,y=f+u.handleIn.x*t,v=m+u.handleIn.y*n;s.push(`C ${g.toFixed(2)},${x.toFixed(2)} ${y.toFixed(2)},${v.toFixed(2)} ${f.toFixed(2)},${m.toFixed(2)}`)}else s.push(`L ${f.toFixed(2)},${m.toFixed(2)}`)}return r&&s.push("Z"),s.join(" ")}function Lu(e,t=!0,n=.3){if(!e||e.length<2)return e;const r=e.length,i=e.map(s=>({...s,handleIn:{x:0,y:0},handleOut:{x:0,y:0}}));for(let s=0;s<r;s++){const a=t?e[(s-1+r)%r]:s>0?e[s-1]:e[s];e[s];const l=t?e[(s+1)%r]:s<r-1?e[s+1]:e[s],c=l.x-a.x,d=l.y-a.y,u=n*.5;!t&&s===0?(i[s].handleIn={x:0,y:0},i[s].handleOut={x:c*u,y:d*u}):!t&&s===r-1?(i[s].handleIn={x:-c*u,y:-d*u},i[s].handleOut={x:0,y:0}):(i[s].handleIn={x:-c*u,y:-d*u},i[s].handleOut={x:c*u,y:d*u})}return i}function FC(e,t,n,r){const i={x:n,y:r,handleIn:{x:0,y:0},handleOut:{x:0,y:0}},s=[...e];return s.splice(t,0,i),s}function BC(e,t,n=3){if(e.length<=n)return null;const r=[...e];return r.splice(t,1),r}function HC(e){switch(e){case"l-shape":return[{x:0,y:0,handleIn:{x:0,y:0},handleOut:{x:0,y:0}},{x:.5,y:0,handleIn:{x:0,y:0},handleOut:{x:0,y:0}},{x:.5,y:.5,handleIn:{x:0,y:0},handleOut:{x:0,y:0}},{x:1,y:.5,handleIn:{x:0,y:0},handleOut:{x:0,y:0}},{x:1,y:1,handleIn:{x:0,y:0},handleOut:{x:0,y:0}},{x:0,y:1,handleIn:{x:0,y:0},handleOut:{x:0,y:0}}];case"custom":default:return[{x:0,y:0,handleIn:{x:0,y:0},handleOut:{x:0,y:0}},{x:1,y:0,handleIn:{x:0,y:0},handleOut:{x:0,y:0}},{x:1,y:1,handleIn:{x:0,y:0},handleOut:{x:0,y:0}},{x:0,y:1,handleIn:{x:0,y:0},handleOut:{x:0,y:0}}]}}function UC(e){switch(e){case"l-shape":return[{x:0,y:0},{x:.6,y:0},{x:.6,y:.4},{x:1,y:.4},{x:1,y:1},{x:0,y:1}];case"u-shape":return[{x:0,y:0},{x:.35,y:0},{x:.35,y:.4},{x:.65,y:.4},{x:.65,y:0},{x:1,y:0},{x:1,y:1},{x:0,y:1}];case"t-shape":return[{x:0,y:0},{x:1,y:0},{x:1,y:.4},{x:.7,y:.4},{x:.7,y:1},{x:.3,y:1},{x:.3,y:.4},{x:0,y:.4}];case"rectangle":default:return null}}const Iu={surface:{width_mm:5e4,length_mm:5e4,color:{tpv_code:"RH12",hex:"#006C55",name:"Dark Green"},boundary:{type:"rectangle",controlPoints:null}},courts:{},selectedCourtId:null,tracks:{},selectedTrackId:null,motifs:{},selectedMotifId:null,shapes:{},selectedShapeId:null,texts:{},selectedTextId:null,editingTextId:null,exclusionZones:{},selectedExclusionZoneId:null,elementOrder:[],customMarkings:[],backgroundZones:[],designName:"Untitled Design",designDescription:"",designTags:[],history:[],historyIndex:-1,maxHistory:50,showCourtLibrary:!0,showPropertiesPanel:!0,propertiesPanelUserClosed:!1,showColorEditor:!1,snapToGrid:!0,gridSize_mm:100,mobileLibraryOpen:!1,mobilePropertiesOpen:!1,mobileColoursOpen:!1,mobileActiveTab:"courts",standaloneMode:!1,standaloneDesignId:null,pathDrawingMode:!1,activePathId:null,isSaving:!1,lastSaved:null},st=$w(Lw((e,t)=>({...Iu,setSurfaceDimensions:(n,r)=>{e(i=>({surface:{...i.surface,width_mm:n,length_mm:r}})),t().addToHistory()},setSurfaceColor:n=>{e(r=>({surface:{...r.surface,color:n}})),t().addToHistory()},setSurfaceBoundaryPreset:n=>{const r=UC(n);e(i=>({surface:{...i.surface,boundary:{type:n,controlPoints:r}}})),t().addToHistory()},setSurfaceBoundaryPoints:n=>{e(r=>({surface:{...r.surface,boundary:{type:"custom",controlPoints:n}}})),t().addToHistory()},resetSurfaceBoundary:()=>{e(n=>({surface:{...n.surface,boundary:{type:"rectangle",controlPoints:null}}})),t().addToHistory()},addCourt:(n,r)=>{const i=`court-${Date.now()}`,s=u=>({RH01:{tpv_code:"RH01",hex:"#A5362F",name:"Standard Red"},RH02:{tpv_code:"RH02",hex:"#E21F2F",name:"Bright Red"},RH10:{tpv_code:"RH10",hex:"#609B63",name:"Standard Green"},RH11:{tpv_code:"RH11",hex:"#3BB44A",name:"Bright Green"},RH12:{tpv_code:"RH12",hex:"#006C55",name:"Dark Green"},RH20:{tpv_code:"RH20",hex:"#0075BC",name:"Standard Blue"},RH21:{tpv_code:"RH21",hex:"#493D8C",name:"Purple"},RH22:{tpv_code:"RH22",hex:"#47AFE3",name:"Light Blue"},RH23:{tpv_code:"RH23",hex:"#039DC4",name:"Azure"},RH26:{tpv_code:"RH26",hex:"#00A6A3",name:"Turquoise"},RH30:{tpv_code:"RH30",hex:"#E4C4AA",name:"Standard Beige"},RH31:{tpv_code:"RH31",hex:"#E8E3D8",name:"Cream"},RH32:{tpv_code:"RH32",hex:"#8B5F3C",name:"Brown"},RH40:{tpv_code:"RH40",hex:"#E5A144",name:"Mustard Yellow"},RH41:{tpv_code:"RH41",hex:"#FFD833",name:"Bright Yellow"},RH50:{tpv_code:"RH50",hex:"#F15B32",name:"Orange"},RH60:{tpv_code:"RH60",hex:"#59595B",name:"Dark Grey"},RH61:{tpv_code:"RH61",hex:"#939598",name:"Light Grey"},RH65:{tpv_code:"RH65",hex:"#D9D9D6",name:"Pale Grey"},RH70:{tpv_code:"RH70",hex:"#231F20",name:"Black"},RH90:{tpv_code:"RH90",hex:"#E8457E",name:"Funky Pink"}})[u]||{tpv_code:"RH31",hex:"#E8E3D8",name:"Cream"},a={};if(r.defaultLineColor){const u=s(r.defaultLineColor);r.markings.forEach(p=>{a[p.id]=u})}const l={};if(r.defaultLineColor&&r.zones){const u=s(r.defaultLineColor);r.zones.forEach(p=>{l[p.id]=u})}const c=r.defaultSurfaceColor?s(r.defaultSurfaceColor):null,d={id:i,templateId:n,template:r,position:{x:t().surface.width_mm/2-r.dimensions.width_mm/2,y:t().surface.length_mm/2-r.dimensions.length_mm/2},rotation:0,scale:1,lineColorOverrides:a,zoneColorOverrides:l,courtSurfaceColor:c};e(u=>({courts:{...u.courts,[i]:d},elementOrder:[...u.elementOrder,i],selectedCourtId:i,selectedTrackId:null})),t().addToHistory()},removeCourt:n=>{const{[n]:r,...i}=t().courts;e(s=>({courts:i,elementOrder:s.elementOrder.filter(a=>a!==n),selectedCourtId:s.selectedCourtId===n?null:s.selectedCourtId})),t().addToHistory()},updateCourtPosition:(n,r)=>{e(i=>({courts:{...i.courts,[n]:{...i.courts[n],position:r}}}))},updateCourtRotation:(n,r)=>{e(i=>({courts:{...i.courts,[n]:{...i.courts[n],rotation:r}}}))},updateCourtScale:(n,r)=>{e(i=>({courts:{...i.courts,[n]:{...i.courts[n],scale:r}}}))},duplicateCourt:n=>{const r=t().courts[n];if(!r)return;const i=`court-${Date.now()}`,s={...r,id:i,position:{x:r.position.x+500,y:r.position.y+500}};e(a=>({courts:{...a.courts,[i]:s},elementOrder:[...a.elementOrder,i],selectedCourtId:i,selectedTrackId:null})),t().addToHistory()},duplicateTrack:n=>{const r=t().tracks[n];if(!r)return;const i=`track-${Date.now()}`,s={...r,id:i,position:{x:r.position.x+500,y:r.position.y+500}};e(a=>({tracks:{...a.tracks,[i]:s},elementOrder:[...a.elementOrder,i],selectedTrackId:i,selectedCourtId:null})),t().addToHistory()},renameElement:(n,r)=>{n.startsWith("court-")?e(i=>({courts:{...i.courts,[n]:{...i.courts[n],customName:r}}})):n.startsWith("track-")?e(i=>({tracks:{...i.tracks,[n]:{...i.tracks[n],customName:r}}})):n.startsWith("motif-")?e(i=>({motifs:{...i.motifs,[n]:{...i.motifs[n],customName:r}}})):n.startsWith("shape-")?e(i=>({shapes:{...i.shapes,[n]:{...i.shapes[n],customName:r}}})):n.startsWith("text-")?e(i=>({texts:{...i.texts,[n]:{...i.texts[n],customName:r}}})):n.startsWith("exclusion-")&&e(i=>({exclusionZones:{...i.exclusionZones,[n]:{...i.exclusionZones[n],customName:r}}})),t().addToHistory()},toggleElementLock:n=>{n.startsWith("court-")?e(r=>{var i;return{courts:{...r.courts,[n]:{...r.courts[n],locked:!((i=r.courts[n])!=null&&i.locked)}}}}):n.startsWith("track-")?e(r=>{var i;return{tracks:{...r.tracks,[n]:{...r.tracks[n],locked:!((i=r.tracks[n])!=null&&i.locked)}}}}):n.startsWith("motif-")?e(r=>{var i;return{motifs:{...r.motifs,[n]:{...r.motifs[n],locked:!((i=r.motifs[n])!=null&&i.locked)}}}}):n.startsWith("shape-")?e(r=>{var i;return{shapes:{...r.shapes,[n]:{...r.shapes[n],locked:!((i=r.shapes[n])!=null&&i.locked)}}}}):n.startsWith("text-")?e(r=>{var i;return{texts:{...r.texts,[n]:{...r.texts[n],locked:!((i=r.texts[n])!=null&&i.locked)}}}}):n.startsWith("exclusion-")&&e(r=>{var i;return{exclusionZones:{...r.exclusionZones,[n]:{...r.exclusionZones[n],locked:!((i=r.exclusionZones[n])!=null&&i.locked)}}}}),t().addToHistory()},toggleElementVisibility:n=>{n.startsWith("court-")?e(r=>{var i;return{courts:{...r.courts,[n]:{...r.courts[n],visible:((i=r.courts[n])==null?void 0:i.visible)===!1}}}}):n.startsWith("track-")?e(r=>{var i;return{tracks:{...r.tracks,[n]:{...r.tracks[n],visible:((i=r.tracks[n])==null?void 0:i.visible)===!1}}}}):n.startsWith("motif-")?e(r=>{var i;return{motifs:{...r.motifs,[n]:{...r.motifs[n],visible:((i=r.motifs[n])==null?void 0:i.visible)===!1}}}}):n.startsWith("shape-")?e(r=>{var i;return{shapes:{...r.shapes,[n]:{...r.shapes[n],visible:((i=r.shapes[n])==null?void 0:i.visible)===!1}}}}):n.startsWith("text-")?e(r=>{var i;return{texts:{...r.texts,[n]:{...r.texts[n],visible:((i=r.texts[n])==null?void 0:i.visible)===!1}}}}):n.startsWith("exclusion-")&&e(r=>{var i;return{exclusionZones:{...r.exclusionZones,[n]:{...r.exclusionZones[n],visible:((i=r.exclusionZones[n])==null?void 0:i.visible)===!1}}}}),t().addToHistory()},setLineColor:(n,r,i)=>{e(s=>({courts:{...s.courts,[n]:{...s.courts[n],lineColorOverrides:{...s.courts[n].lineColorOverrides,[r]:i}}}})),t().addToHistory()},setZoneColor:(n,r,i)=>{e(s=>({courts:{...s.courts,[n]:{...s.courts[n],zoneColorOverrides:{...s.courts[n].zoneColorOverrides,[r]:i}}}})),t().addToHistory()},resetCourtColors:n=>{e(r=>({courts:{...r.courts,[n]:{...r.courts[n],lineColorOverrides:{},zoneColorOverrides:{}}}})),t().addToHistory()},setCourtSurfaceColor:(n,r)=>{e(i=>({courts:{...i.courts,[n]:{...i.courts[n],courtSurfaceColor:r}}})),t().addToHistory()},selectCourt:n=>{const{propertiesPanelUserClosed:r}=t();e(r?{selectedCourtId:n,selectedTrackId:null,selectedMotifId:null,selectedShapeId:null,selectedTextId:null,selectedExclusionZoneId:null,editingTextId:null}:{selectedCourtId:n,selectedTrackId:null,selectedMotifId:null,selectedShapeId:null,selectedTextId:null,selectedExclusionZoneId:null,editingTextId:null,showPropertiesPanel:!0})},deselectCourt:()=>{e({selectedCourtId:null,showPropertiesPanel:!1,propertiesPanelUserClosed:!0})},setElementOrder:n=>{e({elementOrder:n})},moveElementUp:n=>{const{elementOrder:r}=t(),i=r.indexOf(n);if(i<r.length-1){const s=[...r];[s[i],s[i+1]]=[s[i+1],s[i]],e({elementOrder:s}),t().addToHistory()}},moveElementDown:n=>{const{elementOrder:r}=t(),i=r.indexOf(n);if(i>0){const s=[...r];[s[i],s[i-1]]=[s[i-1],s[i]],e({elementOrder:s}),t().addToHistory()}},bringToFront:n=>{const{elementOrder:r}=t(),i=r.filter(s=>s!==n);i.push(n),e({elementOrder:i}),t().addToHistory()},sendToBack:n=>{const{elementOrder:r}=t(),i=r.filter(s=>s!==n);i.unshift(n),e({elementOrder:i}),t().addToHistory()},addTrack:(n,r)=>{const i=`track-${Date.now()}`,s=t().surface,a=s.width_mm,l=s.length_mm,c=y=>({RH01:{tpv_code:"RH01",hex:"#A5362F",name:"Standard Red"},RH31:{tpv_code:"RH31",hex:"#E8E3D8",name:"Cream"},RH30:{tpv_code:"RH30",hex:"#E4C4AA",name:"Standard Beige"},RH20:{tpv_code:"RH20",hex:"#0075BC",name:"Standard Blue"},RH12:{tpv_code:"RH12",hex:"#006C55",name:"Dark Green"}})[y]||{tpv_code:y,hex:"#A5362F",name:"Standard Red"},d=r.defaultTrackSurfaceColor?c(r.defaultTrackSurfaceColor):c("RH01"),u=c("RH31"),p=r.trackType==="straight";let h,f,m;const g={enabled:!1,depth_mm:800,lineWidth_mm:50,style:"staggered",direction:"counterclockwise",startPosition:0};if(p){const y=r.parameters.numLanes,v=r.parameters.laneWidth_mm,b=y*v,w=Math.max(a,l)*.9,C=r.parameters.height_mm||1e5,_=Math.min(C,w);h={...r.parameters,width_mm:b,height_mm:_,cornerRadius:{topLeft:0,topRight:0,bottomLeft:0,bottomRight:0},laneWidth_mm:v,startingBoxes:{...g,...r.parameters.startingBoxes}},m=90,f={x:a/2-b/2,y:l/2-_/2}}else{const y=a*.9,v=l*.9,b=r.parameters.width_mm||25e3,w=r.parameters.height_mm||15e3,C=y/b,_=v/w,j=Math.min(C,_),E=r.parameters.cornerRadius||{topLeft:3e3,topRight:3e3,bottomLeft:3e3,bottomRight:3e3},T={topLeft:E.topLeft*j,topRight:E.topRight*j,bottomLeft:E.bottomLeft*j,bottomRight:E.bottomRight*j};h={...r.parameters,width_mm:y,height_mm:v,cornerRadius:T,laneWidth_mm:r.parameters.laneWidth_mm,startingBoxes:{...g,...r.parameters.startingBoxes}},m=0,f={x:a/2-y/2,y:l/2-v/2}}const x={id:i,templateId:n,template:r,position:f,rotation:m,parameters:h,trackSurfaceColor:d,trackLineColor:u};e(y=>({tracks:{...y.tracks,[i]:x},elementOrder:[...y.elementOrder,i],selectedTrackId:i,selectedCourtId:null})),t().addToHistory()},removeTrack:n=>{const{[n]:r,...i}=t().tracks;e(s=>({tracks:i,elementOrder:s.elementOrder.filter(a=>a!==n),selectedTrackId:s.selectedTrackId===n?null:s.selectedTrackId})),t().addToHistory()},updateTrackParameters:(n,r)=>{e(i=>{var u;const s=i.tracks[n];if(!s)return i;const a=s.parameters,l={...a,...r},c=((u=s.template)==null?void 0:u.trackType)==="straight";let d=s.position;if(c&&r.numLanes!==void 0&&r.numLanes!==a.numLanes){const p=a.laneWidth_mm,h=a.numLanes*p,f=r.numLanes*p;l.width_mm=f;const m=s.position.x+h/2,g=s.position.y+a.height_mm/2;d={x:m-f/2,y:g-l.height_mm/2}}return{tracks:{...i.tracks,[n]:{...s,parameters:l,position:d}}}}),t().addToHistory()},updateTrackPosition:(n,r)=>{e(i=>({tracks:{...i.tracks,[n]:{...i.tracks[n],position:r}}}))},updateTrackRotation:(n,r)=>{e(i=>({tracks:{...i.tracks,[n]:{...i.tracks[n],rotation:r}}}))},setTrackSurfaceColor:(n,r)=>{e(i=>({tracks:{...i.tracks,[n]:{...i.tracks[n],trackSurfaceColor:r}}})),t().addToHistory()},setTrackLineColor:(n,r)=>{e(i=>({tracks:{...i.tracks,[n]:{...i.tracks[n],trackLineColor:r}}})),t().addToHistory()},selectTrack:n=>{const{propertiesPanelUserClosed:r}=t();e(r?{selectedTrackId:n,selectedCourtId:null,selectedMotifId:null,selectedShapeId:null,selectedTextId:null,selectedExclusionZoneId:null,editingTextId:null}:{selectedTrackId:n,selectedCourtId:null,selectedMotifId:null,selectedShapeId:null,selectedTextId:null,selectedExclusionZoneId:null,editingTextId:null,showPropertiesPanel:!0})},deselectTrack:()=>{e({selectedTrackId:null,showPropertiesPanel:!1,propertiesPanelUserClosed:!0})},addMotif:(n,r,i,s,a,l=null,c={})=>{const d=`motif-${Date.now()}`,u=t().surface,p={id:d,type:"motif",sourceDesignId:n,sourceDesignName:r,sourceThumbnailUrl:l,solidSvgContent:c.solidSvgContent||i,blendSvgContent:c.blendSvgContent||null,hasBothVersions:c.hasBothVersions||!1,viewMode:"solid",svgContent:c.solidSvgContent||i,originalWidth_mm:s,originalHeight_mm:a,position:{x:u.width_mm/2-s/2,y:u.length_mm/2-a/2},rotation:0,scale:1};e(h=>({motifs:{...h.motifs,[d]:p},elementOrder:[...h.elementOrder,d],selectedMotifId:d,selectedCourtId:null,selectedTrackId:null})),t().addToHistory()},removeMotif:n=>{const{[n]:r,...i}=t().motifs;e(s=>({motifs:i,elementOrder:s.elementOrder.filter(a=>a!==n),selectedMotifId:s.selectedMotifId===n?null:s.selectedMotifId})),t().addToHistory()},updateMotifPosition:(n,r)=>{e(i=>({motifs:{...i.motifs,[n]:{...i.motifs[n],position:r}}}))},updateMotifRotation:(n,r)=>{e(i=>({motifs:{...i.motifs,[n]:{...i.motifs[n],rotation:r}}}))},updateMotifScale:(n,r)=>{e(i=>({motifs:{...i.motifs,[n]:{...i.motifs[n],scale:r}}}))},setMotifViewMode:(n,r)=>{const i=t().motifs[n];if(!i)return;const s=r==="blend"?i.blendSvgContent||i.solidSvgContent:i.solidSvgContent||i.blendSvgContent;e(a=>({motifs:{...a.motifs,[n]:{...a.motifs[n],viewMode:r,svgContent:s}}})),t().addToHistory()},duplicateMotif:n=>{const r=t().motifs[n];if(!r)return;const i=`motif-${Date.now()}`,s={...r,id:i,position:{x:r.position.x+500,y:r.position.y+500}};e(a=>({motifs:{...a.motifs,[i]:s},elementOrder:[...a.elementOrder,i],selectedMotifId:i,selectedCourtId:null,selectedTrackId:null})),t().addToHistory()},refreshMotif:async n=>{const r=t().motifs[n];if(!r)return{success:!1,error:"Motif not found"};try{const{fetchMotifFromDesign:i}=await jC(async()=>{const{fetchMotifFromDesign:c}=await Promise.resolve().then(()=>YE);return{fetchMotifFromDesign:c}},void 0),s=await i(r.sourceDesignId),l=(r.viewMode||"solid")==="blend"?s.blendSvgContent||s.solidSvgContent:s.solidSvgContent||s.blendSvgContent;return e(c=>({motifs:{...c.motifs,[n]:{...c.motifs[n],solidSvgContent:s.solidSvgContent,blendSvgContent:s.blendSvgContent,hasBothVersions:s.hasBothVersions,svgContent:l,sourceThumbnailUrl:s.sourceThumbnailUrl,sourceDesignName:s.sourceDesignName,originalWidth_mm:s.originalWidth_mm,originalHeight_mm:s.originalHeight_mm}},lastModified:Date.now()})),t().addToHistory(),{success:!0}}catch(i){return console.error("[MOTIF] Failed to refresh:",i),{success:!1,error:i.message}}},selectMotif:n=>{const{propertiesPanelUserClosed:r}=t();e(r?{selectedMotifId:n,selectedCourtId:null,selectedTrackId:null,selectedShapeId:null,selectedTextId:null,selectedExclusionZoneId:null,editingTextId:null}:{selectedMotifId:n,selectedCourtId:null,selectedTrackId:null,selectedShapeId:null,selectedTextId:null,selectedExclusionZoneId:null,editingTextId:null,showPropertiesPanel:!0})},deselectMotif:()=>{e({selectedMotifId:null,showPropertiesPanel:!1,propertiesPanelUserClosed:!0})},addShape:(n="rectangle")=>{const r=`shape-${Date.now()}`,i=t().surface,s=t().shapes,a={rectangle:{sides:4,aspectLocked:!1,width:3e3,height:2e3},square:{sides:4,aspectLocked:!0,width:2e3,height:2e3},circle:{sides:32,aspectLocked:!0,width:2e3,height:2e3},triangle:{sides:3,aspectLocked:!0,width:2e3,height:2e3},pentagon:{sides:5,aspectLocked:!0,width:2e3,height:2e3},hexagon:{sides:6,aspectLocked:!0,width:2e3,height:2e3},polygon:{sides:6,aspectLocked:!0,width:2e3,height:2e3}},l=[{tpv_code:"RH20",hex:"#0075BC",name:"Standard Blue"},{tpv_code:"RH50",hex:"#F15B32",name:"Orange"},{tpv_code:"RH10",hex:"#609B63",name:"Standard Green"},{tpv_code:"RH21",hex:"#493D8C",name:"Purple"},{tpv_code:"RH41",hex:"#FFD833",name:"Bright Yellow"},{tpv_code:"RH26",hex:"#00A6A3",name:"Turquoise"},{tpv_code:"RH02",hex:"#E21F2F",name:"Bright Red"},{tpv_code:"RH90",hex:"#E8457E",name:"Funky Pink"}],c=Object.keys(s).length,d=l[c%l.length];if(n==="blob"){const h=Math.floor(Math.random()*1e5),f="organic",m=$u(f,h),g={id:r,type:"shape",shapeType:"blob",blobStyle:f,seed:h,controlPoints:m,editPointsVisible:!1,numPoints:m.length,blobiness:.2,symmetryMode:"none",radialSymmetryCount:4,width_mm:2e3,height_mm:2e3,position:{x:i.width_mm/2-1e3,y:i.length_mm/2-1e3},rotation:0,fillColor:d,strokeEnabled:!1,strokeColor:null,strokeWidth_mm:50,aspectLocked:!1,locked:!1,visible:!0};e(x=>({shapes:{...x.shapes,[r]:g},elementOrder:[...x.elementOrder,r],selectedShapeId:r,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null})),t().addToHistory();return}const u=a[n]||a.rectangle,p={id:r,type:"shape",shapeType:"polygon",sides:u.sides,width_mm:u.width,height_mm:u.height,cornerRadius:0,position:{x:i.width_mm/2-u.width/2,y:i.length_mm/2-u.height/2},rotation:0,fillColor:d,strokeEnabled:!1,strokeColor:null,strokeWidth_mm:50,aspectLocked:u.aspectLocked,locked:!1,visible:!0};e(h=>({shapes:{...h.shapes,[r]:p},elementOrder:[...h.elementOrder,r],selectedShapeId:r,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null})),t().addToHistory()},removeShape:n=>{const{[n]:r,...i}=t().shapes;e(s=>({shapes:i,elementOrder:s.elementOrder.filter(a=>a!==n),selectedShapeId:s.selectedShapeId===n?null:s.selectedShapeId})),t().addToHistory()},updateShapePosition:(n,r)=>{e(i=>({shapes:{...i.shapes,[n]:{...i.shapes[n],position:r}}}))},updateShapeDimensions:(n,r,i)=>{e(s=>({shapes:{...s.shapes,[n]:{...s.shapes[n],width_mm:r,height_mm:i}}}))},updateShapeSides:(n,r)=>{e(i=>{const s=i.shapes[n];if(!s)return i;const a=Math.max(3,Math.min(32,r));let l=s.width_mm,c=s.height_mm;if(a!==4){const d=Math.min(s.width_mm,s.height_mm);l=d,c=d}return{shapes:{...i.shapes,[n]:{...s,sides:a,width_mm:l,height_mm:c,aspectLocked:a!==4}}}}),t().addToHistory()},updateShapeCornerRadius:(n,r)=>{e(i=>({shapes:{...i.shapes,[n]:{...i.shapes[n],cornerRadius:Math.max(0,Math.min(100,r))}}})),t().addToHistory()},updateShapeRotation:(n,r)=>{e(i=>({shapes:{...i.shapes,[n]:{...i.shapes[n],rotation:r}}}))},setShapeFillColor:(n,r)=>{e(i=>({shapes:{...i.shapes,[n]:{...i.shapes[n],fillColor:r}}})),t().addToHistory()},setShapeStroke:(n,r,i=null,s=50)=>{e(a=>({shapes:{...a.shapes,[n]:{...a.shapes[n],strokeEnabled:r,strokeColor:i,strokeWidth_mm:s}}})),t().addToHistory()},setShapeAspectLock:(n,r)=>{e(i=>{const s=i.shapes[n];return{shapes:{...i.shapes,[n]:{...s,aspectLocked:r}}}}),t().addToHistory()},updateBlobPoints:(n,r)=>{e(i=>{const s=i.shapes[n];if(!s||s.shapeType!=="blob")return i;const a=f0(r,s.blobiness,s.seed);return{shapes:{...i.shapes,[n]:{...s,numPoints:r,controlPoints:a}}}}),t().addToHistory()},updateBlobiness:(n,r)=>{e(i=>{const s=i.shapes[n];if(!s||s.shapeType!=="blob")return i;const a=f0(s.numPoints,r,s.seed);return{shapes:{...i.shapes,[n]:{...s,blobiness:r,controlPoints:a}}}}),t().addToHistory()},randomizeBlob:n=>{e(r=>{const i=r.shapes[n];if(!i||i.shapeType!=="blob")return r;const s=Math.floor(Math.random()*1e5),a=i.blobStyle||"organic",l=$u(a,s);return{shapes:{...r.shapes,[n]:{...i,seed:s,controlPoints:l,numPoints:l.length}}}}),t().addToHistory()},setBlobStyle:(n,r)=>{e(i=>{const s=i.shapes[n];if(!s||s.shapeType!=="blob")return i;const a=$u(r,s.seed);return{shapes:{...i.shapes,[n]:{...s,blobStyle:r,controlPoints:a,numPoints:a.length}}}}),t().addToHistory()},setEditPointsVisible:(n,r)=>{e(i=>{const s=i.shapes[n];return!s||s.shapeType!=="blob"&&s.shapeType!=="path"?i:{shapes:{...i.shapes,[n]:{...s,editPointsVisible:r}}}})},resetBlob:n=>{e(r=>{const i=r.shapes[n];if(!i||i.shapeType!=="blob")return r;const s=$C();return{shapes:{...r.shapes,[n]:{...i,blobiness:0,controlPoints:s}}}}),t().addToHistory()},updateBlobControlPoint:(n,r,i,s)=>{e(a=>{const l=a.shapes[n];if(!l||l.shapeType!=="blob"||!l.controlPoints)return a;const c=Math.max(0,Math.min(1,i)),d=Math.max(0,Math.min(1,s)),u=DC(l.controlPoints,r,c,d,l.symmetryMode||"none",l.radialSymmetryCount||4);return{shapes:{...a.shapes,[n]:{...l,controlPoints:u}}}})},updateBlobHandle:(n,r,i,s,a)=>{e(l=>{const c=l.shapes[n];if(!c||c.shapeType!=="blob"||!c.controlPoints)return l;const d=zC(c.controlPoints,r,i,s,a,c.symmetryMode||"none",c.radialSymmetryCount||4);return{shapes:{...l.shapes,[n]:{...c,controlPoints:d}}}})},commitBlobEdit:()=>{t().addToHistory()},setBlobSymmetry:(n,r,i=4)=>{e(s=>{const a=s.shapes[n];return!a||a.shapeType!=="blob"?s:{shapes:{...s.shapes,[n]:{...a,symmetryMode:r,radialSymmetryCount:i}}}}),t().addToHistory()},applyBlobPreset:(n,r)=>{const i=BLOB_PRESETS[r];!i||!i.controlPoints||(e(s=>{const a=s.shapes[n];return!a||a.shapeType!=="blob"?s:{shapes:{...s.shapes,[n]:{...a,numPoints:i.controlPoints.length,blobiness:0,controlPoints:JSON.parse(JSON.stringify(i.controlPoints))}}}}),t().addToHistory())},duplicateShape:n=>{const r=t().shapes[n];if(!r)return;const i=`shape-${Date.now()}`,s={...r,id:i,position:{x:r.position.x+500,y:r.position.y+500}};e(a=>({shapes:{...a.shapes,[i]:s},elementOrder:[...a.elementOrder,i],selectedShapeId:i,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null})),t().addToHistory()},selectShape:n=>{const{propertiesPanelUserClosed:r}=t();e(r?{selectedShapeId:n,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,selectedTextId:null,selectedExclusionZoneId:null,editingTextId:null}:{selectedShapeId:n,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,selectedTextId:null,selectedExclusionZoneId:null,editingTextId:null,showPropertiesPanel:!0})},deselectShape:()=>{e({selectedShapeId:null,showPropertiesPanel:!1,propertiesPanelUserClosed:!0})},startPathDrawing:()=>{const n=`shape-path-${Date.now()}`,r=t().surface,i=t().shapes,s=[{tpv_code:"RH20",hex:"#0075BC",name:"Standard Blue"},{tpv_code:"RH50",hex:"#F15B32",name:"Orange"},{tpv_code:"RH10",hex:"#609B63",name:"Standard Green"},{tpv_code:"RH21",hex:"#493D8C",name:"Purple"}],a=Object.keys(i).length,l=s[a%s.length],c={id:n,type:"shape",shapeType:"path",controlPoints:[],closed:!0,smooth:!1,editPointsVisible:!1,width_mm:r.width_mm,height_mm:r.length_mm,position:{x:0,y:0},rotation:0,fillColor:l,strokeEnabled:!0,strokeColor:{tpv_code:"RH70",hex:"#A8A9AD",name:"Light Grey"},strokeWidth_mm:20,aspectLocked:!1,locked:!1,visible:!0};e({pathDrawingMode:!0,activePathId:n,shapes:{...t().shapes,[n]:c},elementOrder:[...t().elementOrder,n],selectedShapeId:n,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,selectedTextId:null})},addPointToPath:(n,r)=>{const{activePathId:i,shapes:s,pathDrawingMode:a}=t();if(!a||!i)return;const l=s[i];if(!l||l.shapeType!=="path")return;const c={x:n,y:r,handleIn:{x:0,y:0},handleOut:{x:0,y:0}};e({shapes:{...s,[i]:{...l,controlPoints:[...l.controlPoints,c]}}})},finishPath:()=>{const{activePathId:n,shapes:r,pathDrawingMode:i}=t();if(!i||!n)return;const s=r[n];if(!s)return;if(s.controlPoints.length<3){t().cancelPath();return}const a=s.controlPoints;let l=1/0,c=1/0,d=-1/0,u=-1/0;for(const w of a)l=Math.min(l,w.x),c=Math.min(c,w.y),d=Math.max(d,w.x),u=Math.max(u,w.y);const p=d-l||1,h=u-c||1,f=.05,m=a.map(w=>({...w,x:f+(w.x-l)/p*(1-2*f),y:f+(w.y-c)/h*(1-2*f)})),g=t().surface,x=p*g.width_mm,y=h*g.length_mm,v=l*g.width_mm,b=c*g.length_mm;e({pathDrawingMode:!1,activePathId:null,shapes:{...r,[n]:{...s,controlPoints:m,width_mm:Math.max(500,x),height_mm:Math.max(500,y),position:{x:v,y:b},strokeEnabled:!1}}}),t().addToHistory()},cancelPath:()=>{const{activePathId:n,shapes:r,elementOrder:i}=t();if(!n){e({pathDrawingMode:!1});return}const s={...r};delete s[n],e({pathDrawingMode:!1,activePathId:null,shapes:s,elementOrder:i.filter(a=>a!==n),selectedShapeId:null})},setPathClosed:(n,r)=>{const i=t().shapes[n];!i||i.shapeType!=="path"||(e({shapes:{...t().shapes,[n]:{...i,closed:r}}}),t().addToHistory())},setPathSmooth:(n,r)=>{const i=t().shapes[n];if(!i||i.shapeType!=="path")return;let s=i.controlPoints;r&&i.controlPoints.length>=2?s=Lu(i.controlPoints,i.closed,.3):s=i.controlPoints.map(a=>({...a,handleIn:{x:0,y:0},handleOut:{x:0,y:0}})),e({shapes:{...t().shapes,[n]:{...i,smooth:r,controlPoints:s}}}),t().addToHistory()},updatePathControlPoint:(n,r,i,s)=>{const a=t().shapes[n];if(!a||a.shapeType!=="path")return;const l=[...a.controlPoints];l[r]={...l[r],x:i,y:s},e({shapes:{...t().shapes,[n]:{...a,controlPoints:l}}})},updatePathHandle:(n,r,i,s,a)=>{const l=t().shapes[n];if(!l||l.shapeType!=="path")return;const c=[...l.controlPoints];c[r]={...c[r],[i]:{x:s,y:a}},e({shapes:{...t().shapes,[n]:{...l,controlPoints:c}}})},addPointToExistingPath:(n,r,i,s)=>{const a=t().shapes[n];if(!a||a.shapeType!=="path")return;const l=FC(a.controlPoints,r,i,s),c=a.smooth?Lu(l,a.closed,.3):l;e({shapes:{...t().shapes,[n]:{...a,controlPoints:c}}}),t().addToHistory()},removePointFromPath:(n,r)=>{const i=t().shapes[n];if(!i||i.shapeType!=="path")return;const s=i.closed?3:2,a=BC(i.controlPoints,r,s);if(!a){console.log("[STORE] Cannot remove point - minimum reached");return}const l=i.smooth?Lu(a,i.closed,.3):a;e({shapes:{...t().shapes,[n]:{...i,controlPoints:l}}}),t().addToHistory()},commitPathEdit:()=>{t().addToHistory()},addText:()=>{const{surface:n}=t(),r=`text-${Date.now()}`,i={id:r,type:"text",content:"",fontFamily:"Open Sans, sans-serif",fontSize_mm:500,fontWeight:"normal",fontStyle:"normal",textAlign:"left",position:{x:n.width_mm/2,y:n.length_mm/2},rotation:0,fillColor:{tpv_code:"RH70",hex:"#1C1C1C",name:"Black"},strokeColor:null,strokeWidth_mm:0,locked:!1,visible:!0,customName:null};e(s=>({texts:{...s.texts,[r]:i},elementOrder:[...s.elementOrder,r],selectedTextId:r,editingTextId:r,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,selectedShapeId:null})),t().addToHistory()},removeText:n=>{e(r=>{const{[n]:i,...s}=r.texts;return{texts:s,elementOrder:r.elementOrder.filter(a=>a!==n),selectedTextId:r.selectedTextId===n?null:r.selectedTextId,editingTextId:r.editingTextId===n?null:r.editingTextId}}),t().addToHistory()},selectText:n=>{const{propertiesPanelUserClosed:r}=t();e(r?{selectedTextId:n,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,selectedShapeId:null,selectedExclusionZoneId:null}:{selectedTextId:n,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,selectedShapeId:null,selectedExclusionZoneId:null,showPropertiesPanel:!0})},deselectText:()=>{e({selectedTextId:null,editingTextId:null,showPropertiesPanel:!1,propertiesPanelUserClosed:!0})},startEditingText:n=>{e({editingTextId:n})},stopEditingText:()=>{e({editingTextId:null}),t().addToHistory()},updateTextContent:(n,r)=>{e(i=>({texts:{...i.texts,[n]:{...i.texts[n],content:r}}}))},updateTextPosition:(n,r)=>{e(i=>({texts:{...i.texts,[n]:{...i.texts[n],position:r}}}))},updateTextFontSize:(n,r)=>{e(i=>({texts:{...i.texts,[n]:{...i.texts[n],fontSize_mm:Math.max(50,r)}}})),t().addToHistory()},updateTextFont:(n,r,i,s)=>{e(a=>({texts:{...a.texts,[n]:{...a.texts[n],fontFamily:r,fontWeight:i,fontStyle:s}}})),t().addToHistory()},updateTextAlign:(n,r)=>{e(i=>({texts:{...i.texts,[n]:{...i.texts[n],textAlign:r}}})),t().addToHistory()},updateTextRotation:(n,r)=>{e(i=>({texts:{...i.texts,[n]:{...i.texts[n],rotation:r}}}))},setTextFillColor:(n,r)=>{e(i=>({texts:{...i.texts,[n]:{...i.texts[n],fillColor:r}}})),t().addToHistory()},setTextStrokeColor:(n,r)=>{e(i=>({texts:{...i.texts,[n]:{...i.texts[n],strokeColor:r}}})),t().addToHistory()},updateTextStrokeWidth:(n,r)=>{e(i=>({texts:{...i.texts,[n]:{...i.texts[n],strokeWidth_mm:r}}}))},duplicateText:n=>{const{texts:r}=t(),i=r[n];if(!i)return;const s=`text-${Date.now()}`,a={...i,id:s,position:{x:i.position.x+500,y:i.position.y+500},customName:i.customName?`${i.customName} (copy)`:null};e(l=>({texts:{...l.texts,[s]:a},elementOrder:[...l.elementOrder,s],selectedTextId:s,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,selectedShapeId:null})),t().addToHistory()},addExclusionZone:(n="rectangle")=>{const r=`exclusion-${Date.now()}`,i=t().surface,s={rectangle:{shapeType:"polygon",sides:4,width:3e3,height:2e3},square:{shapeType:"polygon",sides:4,width:2e3,height:2e3},circle:{shapeType:"polygon",sides:32,width:2e3,height:2e3},"l-shape":{shapeType:"path",width:4e3,height:3e3},custom:{shapeType:"path",width:3e3,height:3e3}},a=s[n]||s.rectangle,l={id:r,type:"exclusion",shapeType:a.shapeType,sides:a.sides||4,width_mm:a.width,height_mm:a.height,position:{x:i.width_mm/2-a.width/2,y:i.length_mm/2-a.height/2},rotation:0,cornerRadius:0,locked:!1,visible:!0,customName:null,controlPoints:a.shapeType==="path"?HC(n):null};e(c=>({exclusionZones:{...c.exclusionZones,[r]:l},selectedExclusionZoneId:r,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,selectedShapeId:null,selectedTextId:null,editingTextId:null})),t().addToHistory()},removeExclusionZone:n=>{const{[n]:r,...i}=t().exclusionZones;e(s=>({exclusionZones:i,selectedExclusionZoneId:s.selectedExclusionZoneId===n?null:s.selectedExclusionZoneId})),t().addToHistory()},updateExclusionZonePosition:(n,r)=>{e(i=>({exclusionZones:{...i.exclusionZones,[n]:{...i.exclusionZones[n],position:r}}}))},updateExclusionZoneDimensions:(n,r,i)=>{e(s=>({exclusionZones:{...s.exclusionZones,[n]:{...s.exclusionZones[n],width_mm:r,height_mm:i}}}))},updateExclusionZoneRotation:(n,r)=>{e(i=>({exclusionZones:{...i.exclusionZones,[n]:{...i.exclusionZones[n],rotation:r}}}))},updateExclusionZoneCornerRadius:(n,r)=>{e(i=>({exclusionZones:{...i.exclusionZones,[n]:{...i.exclusionZones[n],cornerRadius:Math.max(0,Math.min(100,r))}}})),t().addToHistory()},selectExclusionZone:n=>{const{propertiesPanelUserClosed:r}=t();e(r?{selectedExclusionZoneId:n,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,selectedShapeId:null,selectedTextId:null,editingTextId:null}:{selectedExclusionZoneId:n,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,selectedShapeId:null,selectedTextId:null,editingTextId:null,showPropertiesPanel:!0})},deselectExclusionZone:()=>{e({selectedExclusionZoneId:null,showPropertiesPanel:!1,propertiesPanelUserClosed:!0})},duplicateExclusionZone:n=>{const r=t().exclusionZones[n];if(!r)return;const i=`exclusion-${Date.now()}`,s={...r,id:i,position:{x:r.position.x+500,y:r.position.y+500},customName:r.customName?`${r.customName} (copy)`:null};e(a=>({exclusionZones:{...a.exclusionZones,[i]:s},selectedExclusionZoneId:i,selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,selectedShapeId:null,selectedTextId:null})),t().addToHistory()},addCustomMarking:n=>{e(r=>({customMarkings:[...r.customMarkings,{...n,id:`custom-${Date.now()}`}]})),t().addToHistory()},removeCustomMarking:n=>{e(r=>({customMarkings:r.customMarkings.filter(i=>i.id!==n)})),t().addToHistory()},addBackgroundZone:n=>{e(r=>({backgroundZones:[...r.backgroundZones,{...n,id:`zone-${Date.now()}`}]})),t().addToHistory()},removeBackgroundZone:n=>{e(r=>({backgroundZones:r.backgroundZones.filter(i=>i.id!==n)})),t().addToHistory()},setDesignName:n=>{e({designName:n})},setDesignDescription:n=>{e({designDescription:n})},setDesignTags:n=>{e({designTags:n})},addToHistory:()=>{const n=t(),r={surface:n.surface,courts:n.courts,tracks:n.tracks,motifs:n.motifs,shapes:n.shapes,texts:n.texts,exclusionZones:n.exclusionZones,elementOrder:n.elementOrder,customMarkings:n.customMarkings,backgroundZones:n.backgroundZones};e(i=>{const s=i.history.slice(0,i.historyIndex+1);return s.push(r),s.length>i.maxHistory&&s.shift(),{history:s,historyIndex:s.length-1}})},undo:()=>{const{history:n,historyIndex:r}=t();if(r>0){const i=n[r-1];e({...i,historyIndex:r-1})}},redo:()=>{const{history:n,historyIndex:r}=t();if(r<n.length-1){const i=n[r+1];e({...i,historyIndex:r+1})}},canUndo:()=>t().historyIndex>0,canRedo:()=>t().historyIndex<t().history.length-1,toggleCourtLibrary:()=>{e(n=>({showCourtLibrary:!n.showCourtLibrary}))},togglePropertiesPanel:()=>{e(n=>({showPropertiesPanel:!n.showPropertiesPanel,propertiesPanelUserClosed:!!n.showPropertiesPanel}))},setMobileLibraryOpen:n=>e({mobileLibraryOpen:n}),setMobilePropertiesOpen:n=>e({mobilePropertiesOpen:n}),setMobileColoursOpen:n=>e({mobileColoursOpen:n}),setMobileActiveTab:n=>e({mobileActiveTab:n}),closeMobileSheets:()=>e({mobileLibraryOpen:!1,mobilePropertiesOpen:!1,mobileColoursOpen:!1}),toggleColorEditor:()=>{e(n=>({showColorEditor:!n.showColorEditor}))},toggleSnapToGrid:()=>{e(n=>({snapToGrid:!n.snapToGrid}))},setGridSize:n=>{e({gridSize_mm:n})},toggleStandaloneMode:()=>{e(n=>({standaloneMode:!n.standaloneMode}))},setStandaloneMode:(n,r=null)=>{e({standaloneMode:n,standaloneDesignId:r})},setSaving:n=>{e({isSaving:n})},setLastSaved:n=>{e({lastSaved:n})},loadDesign:n=>{let r=n.elementOrder;!r&&(n.courtOrder||n.trackOrder)&&(r=[...n.trackOrder||[],...n.courtOrder||[]]),e({surface:n.surface||Iu.surface,courts:n.courts||{},tracks:n.tracks||{},motifs:n.motifs||{},shapes:n.shapes||{},texts:n.texts||{},exclusionZones:n.exclusionZones||{},elementOrder:r||[],customMarkings:n.customMarkings||[],backgroundZones:n.backgroundZones||[],designName:n.name||"Untitled Design",designDescription:n.description||"",designTags:n.tags||[],selectedCourtId:null,selectedTrackId:null,selectedMotifId:null,selectedShapeId:null,selectedTextId:null,selectedExclusionZoneId:null,editingTextId:null,history:[],historyIndex:-1}),t().addToHistory()},exportDesignData:()=>{const n=t();return{surface:n.surface,courts:n.courts,tracks:n.tracks,motifs:n.motifs,shapes:n.shapes,texts:n.texts,exclusionZones:n.exclusionZones,elementOrder:n.elementOrder,customMarkings:n.customMarkings,backgroundZones:n.backgroundZones,name:n.designName,description:n.designDescription,tags:n.designTags}},resetDesign:()=>{e(Iu)},hasUnsavedChanges:()=>{const n=t();return Object.keys(n.courts).length>0||Object.keys(n.tracks).length>0||Object.keys(n.motifs).length>0||Object.keys(n.shapes).length>0||Object.keys(n.texts).length>0||Object.keys(n.exclusionZones).length>0}}),{name:"SportsDesignStore"})),m0={inputMode:"prompt",prompt:"",lengthMM:5e3,widthMM:5e3,selectedFileName:null,uploadedFileUrl:null,arMapping:null,result:null,jobId:null,blendRecipes:null,blendSvgUrl:null,colorMapping:null,blendEditedColors:new Map,solidRecipes:null,solidSvgUrl:null,solidColorMapping:null,solidEditedColors:new Map,viewMode:"solid",showFinalRecipes:!1,showSolidSummary:!1,regionOverrides:new Map,originalTaggedSvg:null,regionOverridesHistory:[new Map],historyIndex:0,designName:"",currentDesignId:null,hasGeneratedContent:!1,lastModified:null},sd=$w(Lw((e,t)=>({...m0,setInputMode:n=>e({inputMode:n}),setPrompt:n=>e({prompt:n,lastModified:Date.now()}),setDimensions:(n,r)=>e({widthMM:n,lengthMM:r,lastModified:Date.now()}),setArMapping:n=>e({arMapping:n}),setSelectedFile:(n,r)=>e({selectedFileName:n,uploadedFileUrl:r,lastModified:Date.now()}),clearSelectedFile:()=>e({selectedFileName:null,uploadedFileUrl:null}),setGenerationResult:(n,r)=>e({result:n,jobId:r,hasGeneratedContent:!0,lastModified:Date.now()}),setResult:n=>e({result:n,hasGeneratedContent:!!n,lastModified:Date.now()}),setJobId:n=>e({jobId:n}),setBlendState:(n,r,i)=>e({blendRecipes:n,colorMapping:r,blendSvgUrl:i,lastModified:Date.now()}),setBlendRecipes:n=>e({blendRecipes:n,lastModified:Date.now()}),setColorMapping:n=>e({colorMapping:n,lastModified:Date.now()}),setBlendSvgUrl:n=>e({blendSvgUrl:n}),setBlendEditedColors:n=>e({blendEditedColors:n,lastModified:Date.now()}),updateBlendSvgUrl:n=>e({blendSvgUrl:n}),setSolidState:(n,r,i)=>e({solidRecipes:n,solidColorMapping:r,solidSvgUrl:i,lastModified:Date.now()}),setSolidRecipes:n=>e({solidRecipes:n,lastModified:Date.now()}),setSolidColorMapping:n=>e({solidColorMapping:n,lastModified:Date.now()}),setSolidSvgUrl:n=>e({solidSvgUrl:n}),setSolidEditedColors:n=>e({solidEditedColors:n,lastModified:Date.now()}),updateSolidSvgUrl:n=>e({solidSvgUrl:n}),setViewMode:n=>{if(n==="blend"){console.log("[STORE] Blend mode disabled - forcing solid mode");return}e({viewMode:n})},setShowFinalRecipes:n=>e({showFinalRecipes:n}),setShowSolidSummary:n=>e({showSolidSummary:n}),setOriginalTaggedSvg:n=>e({originalTaggedSvg:n}),setRegionOverrides:n=>e({regionOverrides:n,lastModified:Date.now()}),addRegionOverride:(n,r)=>{const i=new Map(t().regionOverrides),s=typeof r=="string"?{hex:r}:r;i.set(n,s);const a=t().regionOverridesHistory,l=t().historyIndex,c=a.slice(0,l+1);c.push(new Map(i)),c.length>50&&c.shift(),e({regionOverrides:i,regionOverridesHistory:c,historyIndex:c.length-1,lastModified:Date.now()})},setRegionOverridesHistory:n=>{e(typeof n=="function"?{regionOverridesHistory:n(t().regionOverridesHistory)}:{regionOverridesHistory:n})},setHistoryIndex:n=>{e(typeof n=="function"?{historyIndex:n(t().historyIndex)}:{historyIndex:n})},canUndo:()=>t().historyIndex>0,canRedo:()=>t().historyIndex<t().regionOverridesHistory.length-1,undo:()=>{const{historyIndex:n,regionOverridesHistory:r}=t();if(n>0){const i=n-1;e({historyIndex:i,regionOverrides:new Map(r[i])})}},redo:()=>{const{historyIndex:n,regionOverridesHistory:r}=t();if(n<r.length-1){const i=n+1;e({historyIndex:i,regionOverrides:new Map(r[i])})}},setRegionOverridesHistory:(n,r)=>e({regionOverridesHistory:n,historyIndex:r}),setDesignName:n=>e({designName:n}),setCurrentDesignId:n=>e({currentDesignId:n}),loadDesign:n=>{const r=n.regionOverrides||new Map,i=r.size>0?[new Map,new Map(r)]:[new Map],s=r.size>0?1:0;e({inputMode:n.inputMode||"prompt",prompt:n.prompt||"",lengthMM:n.lengthMM||5e3,widthMM:n.widthMM||5e3,uploadedFileUrl:n.selectedFile||null,result:n.result||null,blendRecipes:n.blendRecipes||null,solidRecipes:n.solidRecipes||null,colorMapping:n.colorMapping||null,solidColorMapping:n.solidColorMapping||null,solidEditedColors:n.solidEditedColors||new Map,blendEditedColors:n.blendEditedColors||new Map,blendSvgUrl:n.blendSvgUrl||null,solidSvgUrl:n.solidSvgUrl||null,viewMode:"solid",arMapping:n.arMapping||null,jobId:n.jobId||null,showFinalRecipes:n.showFinalRecipes||!1,showSolidSummary:n.showSolidSummary||!1,hasGeneratedContent:!!n.result,regionOverrides:r,originalTaggedSvg:n.originalTaggedSvg||null,regionOverridesHistory:i,historyIndex:s,lastModified:Date.now()})},exportDesignData:()=>{const n=t();return{inputMode:n.inputMode,prompt:n.prompt,lengthMM:n.lengthMM,widthMM:n.widthMM,uploadedFileUrl:n.uploadedFileUrl,result:n.result,blendRecipes:n.blendRecipes,solidRecipes:n.solidRecipes,colorMapping:n.colorMapping,solidColorMapping:n.solidColorMapping,solidEditedColors:n.solidEditedColors,blendEditedColors:n.blendEditedColors,viewMode:n.viewMode,arMapping:n.arMapping,jobId:n.jobId,showFinalRecipes:n.showFinalRecipes,showSolidSummary:n.showSolidSummary,regionOverrides:n.regionOverrides,designName:n.designName,currentDesignId:n.currentDesignId}},resetDesign:()=>{const{blendSvgUrl:n,solidSvgUrl:r}=t();n&&n.startsWith("blob:")&&URL.revokeObjectURL(n),r&&r.startsWith("blob:")&&URL.revokeObjectURL(r),e({...m0,blendEditedColors:new Map,solidEditedColors:new Map,regionOverrides:new Map,regionOverridesHistory:[new Map]})},hasUnsavedChanges:()=>{const n=t();return n.hasGeneratedContent||n.prompt.trim()!==""||n.selectedFileName!==null}}),{name:"PlaygroundDesignStore"})),Fw={"basketball-full":{id:"basketball-full",name:"Basketball (Full Court)",sport:"basketball",standard:"FIBA 2020",category:"court",description:"Official FIBA standard full basketball court with all markings",dimensions:{length_mm:28e3,width_mm:15e3,min_surround_mm:2e3},defaultSurfaceColor:"RH20",defaultLineColor:"RH31",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:15e3,height:28e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"center-line",name:"Center Line",type:"line",params:{x1:0,y1:14e3,x2:15e3,y2:14e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-circle",name:"Center Circle",type:"circle",params:{cx:7500,cy:14e3,radius:1800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"three-point-arc-top",name:"Three-Point Arc (Top)",type:"arc",params:{cx:7500,cy:26425,radius:6750,startAngle:192,endAngle:348},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"three-point-arc-bottom",name:"Three-Point Arc (Bottom)",type:"arc",params:{cx:7500,cy:1575,radius:6750,startAngle:12,endAngle:168},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"three-point-line-bottom-left",name:"Three-Point Line Bottom Left",type:"line",params:{x1:900,y1:0,x2:900,y2:2990},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"three-point-line-bottom-right",name:"Three-Point Line Bottom Right",type:"line",params:{x1:14100,y1:0,x2:14100,y2:2990},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"three-point-line-top-left",name:"Three-Point Line Top Left",type:"line",params:{x1:900,y1:25010,x2:900,y2:28e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"three-point-line-top-right",name:"Three-Point Line Top Right",type:"line",params:{x1:14100,y1:25010,x2:14100,y2:28e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"free-throw-line-top",name:"Free Throw Line (Top)",type:"line",params:{x1:5050,y1:22200,x2:9950,y2:22200},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"free-throw-line-bottom",name:"Free Throw Line (Bottom)",type:"line",params:{x1:5050,y1:5800,x2:9950,y2:5800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"free-throw-circle-top",name:"Free Throw Circle (Top)",type:"circle",params:{cx:7500,cy:22200,radius:1800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"free-throw-circle-bottom",name:"Free Throw Circle (Bottom)",type:"circle",params:{cx:7500,cy:5800,radius:1800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"key-lane-top",name:"Key Lane (Top)",type:"rectangle",params:{x:5050,y:22200,width:4900,height:5800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"key-lane-bottom",name:"Key Lane (Bottom)",type:"rectangle",params:{x:5050,y:0,width:4900,height:5800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"restricted-area-top",name:"Restricted Area (Top)",type:"arc",params:{cx:7500,cy:28e3,radius:1250,startAngle:180,endAngle:360},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"restricted-area-bottom",name:"Restricted Area (Bottom)",type:"arc",params:{cx:7500,cy:0,radius:1250,startAngle:0,endAngle:180},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[{id:"key-area-top",name:"Key Area (Top)",type:"rectangle",params:{x:5050,y:22200,width:4900,height:5800},defaultColor:"RH20",paintable:!0,area_m2:28.42},{id:"key-area-bottom",name:"Key Area (Bottom)",type:"rectangle",params:{x:5050,y:0,width:4900,height:5800},defaultColor:"RH20",paintable:!0,area_m2:28.42}]},"netball-full":{id:"netball-full",name:"Netball (Full Court)",sport:"netball",standard:"World Netball 2020",category:"court",description:"Official World Netball standard court with goal circles and thirds",dimensions:{length_mm:30500,width_mm:15250,min_surround_mm:3050},defaultSurfaceColor:"RH01",defaultLineColor:"RH31",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:15250,height:30500},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"transverse-line-1",name:"Transverse Line 1",type:"line",params:{x1:0,y1:10167,x2:15250,y2:10167},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"transverse-line-2",name:"Transverse Line 2",type:"line",params:{x1:0,y1:20333,x2:15250,y2:20333},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-circle",name:"Center Circle",type:"circle",params:{cx:7625,cy:15250,radius:450},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"goal-circle-bottom",name:"Goal Circle (Bottom)",type:"arc",params:{cx:7625,cy:0,radius:4900,startAngle:0,endAngle:180},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"goal-circle-top",name:"Goal Circle (Top)",type:"arc",params:{cx:7625,cy:30500,radius:4900,startAngle:180,endAngle:360},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"tennis-doubles":{id:"tennis-doubles",name:"Tennis (Doubles)",sport:"tennis",standard:"ITF 2020",category:"court",description:"Official ITF standard doubles tennis court with all service boxes",dimensions:{length_mm:23770,width_mm:10970,min_surround_mm:3660},defaultSurfaceColor:"RH22",defaultLineColor:"RH29",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:10970,height:23770},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"singles-sideline-left",name:"Singles Sideline (Left)",type:"line",params:{x1:1370,y1:0,x2:1370,y2:23770},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"singles-sideline-right",name:"Singles Sideline (Right)",type:"line",params:{x1:9600,y1:0,x2:9600,y2:23770},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"service-line-bottom",name:"Service Line (Bottom)",type:"line",params:{x1:0,y1:6400,x2:10970,y2:6400},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"service-line-top",name:"Service Line (Top)",type:"line",params:{x1:0,y1:17370,x2:10970,y2:17370},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-service-line",name:"Center Service Line",type:"line",params:{x1:5485,y1:6400,x2:5485,y2:17370},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-mark-bottom",name:"Center Mark (Bottom)",type:"line",params:{x1:5485,y1:0,x2:5485,y2:100},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-mark-top",name:"Center Mark (Top)",type:"line",params:{x1:5485,y1:23670,x2:5485,y2:23770},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"futsal-standard":{id:"futsal-standard",name:"Futsal (5-a-side)",sport:"futsal",standard:"FIFA 2020",category:"court",description:"Official FIFA standard futsal court for international matches",dimensions:{length_mm:4e4,width_mm:2e4,min_surround_mm:1e3},defaultSurfaceColor:"RH50",defaultLineColor:"RH30",defaultLineWidth_mm:80,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:2e4,height:4e4},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"boundary"},{id:"center-line",name:"Center Line",type:"line",params:{x1:0,y1:2e4,x2:2e4,y2:2e4},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"center-circle",name:"Center Circle",type:"circle",params:{cx:1e4,cy:2e4,radius:3e3},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"center-spot",name:"Center Spot",type:"circle",params:{cx:1e4,cy:2e4,radius:100},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"penalty-area-bottom",name:"Penalty Area (Bottom)",type:"arc",params:{cx:1e4,cy:0,radius:6e3,startAngle:0,endAngle:180},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"penalty-area-top",name:"Penalty Area (Top)",type:"arc",params:{cx:1e4,cy:4e4,radius:6e3,startAngle:180,endAngle:360},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"penalty-mark-bottom",name:"Penalty Mark (Bottom)",type:"circle",params:{cx:1e4,cy:6e3,radius:100},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"penalty-mark-top",name:"Penalty Mark (Top)",type:"circle",params:{cx:1e4,cy:34e3,radius:100},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"second-penalty-mark-bottom",name:"Second Penalty Mark (Bottom)",type:"circle",params:{cx:1e4,cy:1e4,radius:100},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"second-penalty-mark-top",name:"Second Penalty Mark (Top)",type:"circle",params:{cx:1e4,cy:3e4,radius:100},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"corner-arc-bl",name:"Corner Arc (Bottom Left)",type:"arc",params:{cx:0,cy:0,radius:250,startAngle:0,endAngle:90},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"corner-arc-br",name:"Corner Arc (Bottom Right)",type:"arc",params:{cx:2e4,cy:0,radius:250,startAngle:90,endAngle:180},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"corner-arc-tl",name:"Corner Arc (Top Left)",type:"arc",params:{cx:0,cy:4e4,radius:250,startAngle:270,endAngle:360},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"},{id:"corner-arc-tr",name:"Corner Arc (Top Right)",type:"arc",params:{cx:2e4,cy:4e4,radius:250,startAngle:180,endAngle:270},defaultColor:"RH31",lineWidth_mm:80,required:!0,category:"court-marking"}],zones:[]},"volleyball-indoor":{id:"volleyball-indoor",name:"Volleyball (Indoor)",sport:"volleyball",standard:"FIVB",category:"court",description:"Official FIVB standard indoor volleyball court with attack lines",dimensions:{length_mm:18e3,width_mm:9e3,min_surround_mm:3e3},defaultSurfaceColor:"RH40",defaultLineColor:"RH29",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:9e3,height:18e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"center-line",name:"Center Line",type:"line",params:{x1:0,y1:9e3,x2:9e3,y2:9e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"attack-line-bottom",name:"Attack Line (Bottom)",type:"line",params:{x1:0,y1:6e3,x2:9e3,y2:6e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"attack-line-top",name:"Attack Line (Top)",type:"line",params:{x1:0,y1:12e3,x2:9e3,y2:12e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"badminton-full":{id:"badminton-full",name:"Badminton (Full Court)",sport:"badminton",standard:"BWF",category:"court",description:"Official BWF standard full badminton court with singles and doubles lines",dimensions:{length_mm:13400,width_mm:6100,min_surround_mm:1e3},defaultSurfaceColor:"RH26",defaultLineColor:"RH12",defaultLineWidth_mm:40,markings:[{id:"boundary",name:"Boundary Lines (Doubles)",type:"rectangle",params:{x:0,y:0,width:6100,height:13400},defaultColor:"RH31",lineWidth_mm:40,required:!0,category:"boundary"},{id:"singles-sideline-left",name:"Singles Sideline (Left)",type:"line",params:{x1:460,y1:0,x2:460,y2:13400},defaultColor:"RH31",lineWidth_mm:40,required:!0,category:"court-marking"},{id:"singles-sideline-right",name:"Singles Sideline (Right)",type:"line",params:{x1:5640,y1:0,x2:5640,y2:13400},defaultColor:"RH31",lineWidth_mm:40,required:!0,category:"court-marking"},{id:"short-service-line-bottom",name:"Short Service Line (Bottom)",type:"line",params:{x1:0,y1:1980,x2:6100,y2:1980},defaultColor:"RH31",lineWidth_mm:40,required:!0,category:"court-marking"},{id:"short-service-line-top",name:"Short Service Line (Top)",type:"line",params:{x1:0,y1:11420,x2:6100,y2:11420},defaultColor:"RH31",lineWidth_mm:40,required:!0,category:"court-marking"},{id:"doubles-long-service-line-bottom",name:"Doubles Long Service Line (Bottom)",type:"line",params:{x1:0,y1:760,x2:6100,y2:760},defaultColor:"RH31",lineWidth_mm:40,required:!0,category:"court-marking"},{id:"doubles-long-service-line-top",name:"Doubles Long Service Line (Top)",type:"line",params:{x1:0,y1:12640,x2:6100,y2:12640},defaultColor:"RH31",lineWidth_mm:40,required:!0,category:"court-marking"},{id:"center-service-line",name:"Center Service Line",type:"line",params:{x1:3050,y1:1980,x2:3050,y2:11420},defaultColor:"RH31",lineWidth_mm:40,required:!0,category:"court-marking"}],zones:[]},"pickleball-standard":{id:"pickleball-standard",name:"Pickleball",sport:"pickleball",standard:"USA Pickleball",category:"court",description:"Official USA Pickleball standard court with non-volley zone (kitchen)",dimensions:{length_mm:13410,width_mm:6100,min_surround_mm:1e3},defaultSurfaceColor:"RH11",defaultLineColor:"RH31",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:6100,height:13410},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"non-volley-zone-line-bottom",name:"Non-Volley Zone Line (Bottom)",type:"line",params:{x1:0,y1:2130,x2:6100,y2:2130},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"non-volley-zone-line-top",name:"Non-Volley Zone Line (Top)",type:"line",params:{x1:0,y1:11280,x2:6100,y2:11280},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-line",name:"Center Line (Net)",type:"line",params:{x1:0,y1:6705,x2:6100,y2:6705},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-service-line",name:"Center Service Line",type:"line",params:{x1:3050,y1:0,x2:3050,y2:13410},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"basketball-half":{id:"basketball-half",name:"Basketball (Half Court / 3x3)",sport:"basketball",standard:"FIBA 3x3",category:"court",description:"Half-court basketball for 3x3 games, practice, or space-constrained areas",dimensions:{length_mm:11e3,width_mm:15e3,min_surround_mm:2e3},defaultSurfaceColor:"RH20",defaultLineColor:"RH31",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:15e3,height:11e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"three-point-arc",name:"Three-Point Arc",type:"arc",params:{cx:7500,cy:1575,radius:6750,startAngle:12,endAngle:168},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"three-point-line-left",name:"Three-Point Line (Left)",type:"line",params:{x1:900,y1:0,x2:900,y2:2990},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"three-point-line-right",name:"Three-Point Line (Right)",type:"line",params:{x1:14100,y1:0,x2:14100,y2:2990},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"free-throw-line",name:"Free Throw Line",type:"line",params:{x1:5050,y1:5800,x2:9950,y2:5800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"free-throw-circle",name:"Free Throw Circle",type:"circle",params:{cx:7500,cy:5800,radius:1800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"key-lane",name:"Key Lane",type:"rectangle",params:{x:5050,y:0,width:4900,height:5800},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"restricted-area",name:"Restricted Area",type:"arc",params:{cx:7500,cy:0,radius:1250,startAngle:0,endAngle:180},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[{id:"key-area",name:"Key Area",type:"rectangle",params:{x:5050,y:0,width:4900,height:5800},defaultColor:"RH20",paintable:!0,area_m2:28.42}]},"tennis-singles":{id:"tennis-singles",name:"Tennis (Singles)",sport:"tennis",standard:"ITF",category:"court",description:"Singles-only tennis court without doubles alleys",dimensions:{length_mm:23770,width_mm:8230,min_surround_mm:3660},defaultSurfaceColor:"RH22",defaultLineColor:"RH29",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:8230,height:23770},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"service-line-bottom",name:"Service Line (Bottom)",type:"line",params:{x1:0,y1:6400,x2:8230,y2:6400},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"service-line-top",name:"Service Line (Top)",type:"line",params:{x1:0,y1:17370,x2:8230,y2:17370},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-service-line",name:"Center Service Line",type:"line",params:{x1:4115,y1:6400,x2:4115,y2:17370},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-mark-bottom",name:"Center Mark (Bottom)",type:"line",params:{x1:4115,y1:0,x2:4115,y2:100},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-mark-top",name:"Center Mark (Top)",type:"line",params:{x1:4115,y1:23670,x2:4115,y2:23770},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"mini-tennis-red":{id:"mini-tennis-red",name:"Mini Tennis (Red Court)",sport:"tennis",standard:"ITF Play+Stay",category:"court",description:"Beginner/youth court for red stage tennis coaching (36ft)",dimensions:{length_mm:10970,width_mm:5490,min_surround_mm:2e3},defaultSurfaceColor:"RH02",defaultLineColor:"RH29",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:5490,height:10970},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"net-line",name:"Net Line",type:"line",params:{x1:0,y1:5485,x2:5490,y2:5485},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"service-line-bottom",name:"Service Line (Bottom)",type:"line",params:{x1:0,y1:2745,x2:5490,y2:2745},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"service-line-top",name:"Service Line (Top)",type:"line",params:{x1:0,y1:8225,x2:5490,y2:8225},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-service-line",name:"Center Service Line",type:"line",params:{x1:2745,y1:2745,x2:2745,y2:8225},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"padel-standard":{id:"padel-standard",name:"Padel",sport:"padel",standard:"FIP",category:"court",description:"Official FIP padel court with service boxes",dimensions:{length_mm:2e4,width_mm:1e4,min_surround_mm:0},defaultSurfaceColor:"RH60",defaultLineColor:"RH29",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:1e4,height:2e4},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"net-line",name:"Net Line",type:"line",params:{x1:0,y1:1e4,x2:1e4,y2:1e4},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"service-line-bottom",name:"Service Line (Bottom)",type:"line",params:{x1:0,y1:3e3,x2:1e4,y2:3e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"service-line-top",name:"Service Line (Top)",type:"line",params:{x1:0,y1:17e3,x2:1e4,y2:17e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-service-line-bottom",name:"Center Service Line (Bottom)",type:"line",params:{x1:5e3,y1:0,x2:5e3,y2:3e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-service-line-top",name:"Center Service Line (Top)",type:"line",params:{x1:5e3,y1:17e3,x2:5e3,y2:2e4},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-line",name:"Center Line",type:"line",params:{x1:5e3,y1:3e3,x2:5e3,y2:17e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"handball-standard":{id:"handball-standard",name:"Handball",sport:"handball",standard:"IHF",category:"court",description:"Official IHF handball court with goal areas and penalty lines",dimensions:{length_mm:4e4,width_mm:2e4,min_surround_mm:1e3},defaultSurfaceColor:"RH10",defaultLineColor:"RH31",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:2e4,height:4e4},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"center-line",name:"Center Line",type:"line",params:{x1:0,y1:2e4,x2:2e4,y2:2e4},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"goal-area-bottom",name:"Goal Area (Bottom)",type:"arc",params:{cx:1e4,cy:0,radius:6e3,startAngle:0,endAngle:180},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"goal-area-top",name:"Goal Area (Top)",type:"arc",params:{cx:1e4,cy:4e4,radius:6e3,startAngle:180,endAngle:360},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"free-throw-line-bottom",name:"Free-Throw Line (Bottom)",type:"arc",params:{cx:1e4,cy:0,radius:9e3,startAngle:0,endAngle:180,dashed:!0,dashPattern:"300 150"},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"free-throw-line-top",name:"Free-Throw Line (Top)",type:"arc",params:{cx:1e4,cy:4e4,radius:9e3,startAngle:180,endAngle:360,dashed:!0,dashPattern:"300 150"},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"7m-line-bottom",name:"7m Penalty Line (Bottom)",type:"line",params:{x1:9e3,y1:7e3,x2:11e3,y2:7e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"7m-line-top",name:"7m Penalty Line (Top)",type:"line",params:{x1:9e3,y1:33e3,x2:11e3,y2:33e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"goalkeeper-line-bottom",name:"Goalkeeper Restriction Line (Bottom)",type:"line",params:{x1:9500,y1:4e3,x2:10500,y2:4e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"goalkeeper-line-top",name:"Goalkeeper Restriction Line (Top)",type:"line",params:{x1:9500,y1:36e3,x2:10500,y2:36e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"hockey-d":{id:"hockey-d",name:"Field Hockey D",sport:"hockey",standard:"FIH",category:"overlay",description:"Hockey shooting circle (D) for overlay on sports surfaces",dimensions:{length_mm:14630,width_mm:29260,min_surround_mm:0},defaultSurfaceColor:"RH23",defaultLineColor:"RH29",defaultLineWidth_mm:50,markings:[{id:"shooting-circle",name:"Shooting Circle (D)",type:"arc",params:{cx:14630,cy:0,radius:14630,startAngle:0,endAngle:180},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"goal-line",name:"Goal Line",type:"line",params:{x1:0,y1:0,x2:29260,y2:0},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"penalty-spot",name:"Penalty Spot",type:"circle",params:{cx:14630,cy:6400,radius:150},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]},"hockey-5s":{id:"hockey-5s",name:"Hockey 5s",sport:"hockey",standard:"England Hockey",category:"court",description:"Scaled-down hockey pitch for 5-a-side games",dimensions:{length_mm:55e3,width_mm:41100,min_surround_mm:2e3},defaultSurfaceColor:"RH23",defaultLineColor:"RH29",defaultLineWidth_mm:50,markings:[{id:"boundary",name:"Boundary Lines",type:"rectangle",params:{x:0,y:0,width:41100,height:55e3},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"boundary"},{id:"center-line",name:"Center Line",type:"line",params:{x1:0,y1:27500,x2:41100,y2:27500},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"center-spot",name:"Center Spot",type:"circle",params:{cx:20550,cy:27500,radius:150},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"shooting-circle-bottom",name:"Shooting Circle (Bottom)",type:"arc",params:{cx:20550,cy:0,radius:9e3,startAngle:0,endAngle:180},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"shooting-circle-top",name:"Shooting Circle (Top)",type:"arc",params:{cx:20550,cy:55e3,radius:9e3,startAngle:180,endAngle:360},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"penalty-spot-bottom",name:"Penalty Spot (Bottom)",type:"circle",params:{cx:20550,cy:6400,radius:150},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"},{id:"penalty-spot-top",name:"Penalty Spot (Top)",type:"circle",params:{cx:20550,cy:48600,radius:150},defaultColor:"RH31",lineWidth_mm:50,required:!0,category:"court-marking"}],zones:[]}},dn=[{code:"RH01",name:"Standard Red",hex:"#A5362F",R:165,G:54,B:47,L:39.4,a:58.5,b:29},{code:"RH02",name:"Bright Red",hex:"#E21F2F",R:226,G:31,B:47,L:47.4,a:70.1,b:44},{code:"RH10",name:"Standard Green",hex:"#609B63",R:96,G:155,B:99,L:40.5,a:-42.2,b:17.9},{code:"RH11",name:"Bright Green",hex:"#3BB44A",R:59,G:180,B:74,L:62.1,a:-47.7,b:47.2},{code:"RH12",name:"Dark Green",hex:"#006C55",R:0,G:108,B:85,L:39.6,a:-38.3,b:13.1},{code:"RH20",name:"Standard Blue",hex:"#0075BC",R:0,G:117,B:188,L:36.4,a:14.2,b:-46.7},{code:"RH21",name:"Purple",hex:"#493D8C",R:73,G:61,B:140,L:31.5,a:41.9,b:-40.9},{code:"RH22",name:"Light Blue",hex:"#47AFE3",R:71,G:175,B:227,L:55.3,a:-19.1,b:-37.3},{code:"RH23",name:"Azure",hex:"#039DC4",R:3,G:157,B:196,L:47.7,a:-4.8,b:-34.8},{code:"RH26",name:"Turquoise",hex:"#00A6A3",R:0,G:166,B:163,L:58.8,a:-38.4,b:-3},{code:"RH30",name:"Standard Beige",hex:"#E4C4AA",R:228,G:196,B:170,L:75.2,a:3.8,b:24.8},{code:"RH31",name:"Cream",hex:"#E8E3D8",R:232,G:227,B:216,L:91.8,a:-.5,b:12.5},{code:"RH32",name:"Brown",hex:"#8B5F3C",R:139,G:95,B:60,L:40,a:15.9,b:27.1},{code:"RH90",name:"Funky Pink",hex:"#E8457E",R:232,G:69,B:126,L:55,a:66.1,b:4.9},{code:"RH40",name:"Mustard Yellow",hex:"#E5A144",R:229,G:161,B:68,L:66,a:8.4,b:56.3},{code:"RH41",name:"Bright Yellow",hex:"#FFD833",R:255,G:216,B:51,L:86.9,a:-1,b:90.6},{code:"RH50",name:"Orange",hex:"#F15B32",R:241,G:91,B:50,L:63.2,a:49.8,b:60.2},{code:"RH60",name:"Dark Grey",hex:"#59595B",R:89,G:89,B:91,L:34.1,a:-.4,b:-2.4},{code:"RH61",name:"Light Grey",hex:"#939598",R:147,G:149,B:152,L:69,a:-.5,b:-1},{code:"RH65",name:"Pale Grey",hex:"#D9D9D6",R:217,G:217,B:214,L:87.6,a:-.2,b:-.7},{code:"RH70",name:"Black",hex:"#231F20",R:35,G:31,B:32,L:9.1,a:-.3,b:-6.3}];function WC(){return Object.values(Fw)}function GC(e){return Fw[e]||null}function VC(e,t,n){const{type:r,params:i}=e;switch(r){case"line":return YC(i,t,n);case"rectangle":return XC(i,t,n);case"circle":return ZC(i,t,n);case"arc":return KC(i,t,n);case"polyline":return JC(i,t,n);default:return console.warn(`Unknown marking type: ${r}`),null}}function qC(e,t){const{type:n,params:r}=e;switch(n){case"rectangle":return{type:"rect",x:r.x,y:r.y,width:r.width,height:r.height,fill:t};case"circle":return{type:"circle",cx:r.cx,cy:r.cy,r:r.radius,fill:t};case"polygon":return{type:"polygon",points:r.points,fill:t};default:return console.warn(`Unknown zone type: ${n}`),null}}function YC(e,t,n){const r={type:"line",x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,stroke:t,strokeWidth:n};return e.dashed&&(r.strokeDasharray=e.dashPattern||"200 100"),r}function XC(e,t,n){return{type:"rect",x:e.x,y:e.y,width:e.width,height:e.height,stroke:t,strokeWidth:n,fill:"none"}}function ZC(e,t,n){return{type:"circle",cx:e.cx,cy:e.cy,r:e.radius,stroke:t,strokeWidth:n,fill:"none"}}function KC(e,t,n){const{cx:r,cy:i,radius:s,startAngle:a,endAngle:l}=e,c=a*Math.PI/180,d=l*Math.PI/180,u=r+s*Math.cos(c),p=i+s*Math.sin(c),h=r+s*Math.cos(d),f=i+s*Math.sin(d),m=l-a>180?1:0,x={type:"path",d:`M ${u} ${p} A ${s} ${s} 0 ${m} 1 ${h} ${f}`,stroke:t,strokeWidth:n,fill:"none"};return e.dashed&&(x.strokeDasharray=e.dashPattern||"200 100"),x}function JC(e,t,n){return{type:"polyline",points:e.points.map(i=>`${i[0]},${i[1]}`).join(" "),stroke:t,strokeWidth:n,fill:"none"}}function g0(e){if(e&&e.startsWith("#"))return e;const t=dn.find(n=>n.code===e);return t?t.hex:"#000000"}function QC(e){var a;const{template:t,lineColorOverrides:n,zoneColorOverrides:r}=e;if(!t)return console.error("No template provided for court"),{markings:[],zones:[]};const i=t.markings.map(l=>{var p;const c=((p=n[l.id])==null?void 0:p.hex)||t.defaultLineColor,d=g0(c),u=l.lineWidth_mm||t.defaultLineWidth_mm;return{id:l.id,name:l.name,...VC(l,d,u)}}).filter(Boolean),s=((a=t.zones)==null?void 0:a.map(l=>{var u;const c=((u=r[l.id])==null?void 0:u.hex)||l.defaultColor,d=g0(c);return{id:l.id,name:l.name,...qC(l,d)}}).filter(Boolean))||[];return{markings:i,zones:s}}function v0(e,t){return Math.round(e/t)*t}function eE(e,t){return{x:v0(e.x,t),y:v0(e.y,t)}}function Bw(e){let t=e%360;return t<0&&(t+=360),t}function ac(e,t,n){const{width_mm:r,length_mm:i}=t,{width_mm:s,length_mm:a}=n,l=500,c=-(r-l),d=s-l,u=-(i-l),p=a-l;return{x:Math.max(c,Math.min(e.x,d)),y:Math.max(u,Math.min(e.y,p))}}function tE(e){const{position:t,rotation:n,scale:r,template:i}=e,s=i.dimensions.width_mm/2,a=i.dimensions.length_mm/2;return`translate(${t.x}, ${t.y}) scale(${r}) rotate(${n}, ${s}, ${a})`}function nE({court:e,svgRef:t}){const{updateCourtRotation:n,updateCourtScale:r,updateCourtPosition:i,addToHistory:s}=st(),[a,l]=R.useState(!1),[c,d]=R.useState(!1),[u,p]=R.useState(null),[h,f]=R.useState(null),{template:m,position:g,rotation:x,scale:y}=e,v=m.dimensions.width_mm*y,b=m.dimensions.length_mm*y,w=g.x+m.dimensions.width_mm*y/2,C=g.y+m.dimensions.length_mm*y/2,_=m.dimensions.width_mm/2,j=-1e3,E=(k,z)=>{if(!t.current)return{x:0,y:0};const he=t.current.createSVGPoint();he.x=k,he.y=z;const Z=he.matrixTransform(t.current.getScreenCTM().inverse());return{x:Z.x,y:Z.y}},T=k=>{k.stopPropagation(),l(!0),f({x:k.clientX,y:k.clientY})},M=(k,z)=>{k.stopPropagation(),d(!0),p(z),f({x:k.clientX,y:k.clientY,initialScale:y,initialWidth:v,initialHeight:b,initialPosition:{...g}})};R.useEffect(()=>{if(!a&&!c)return;const k=he=>{if(a){const Z=E(he.clientX,he.clientY),K=Z.x-w,H=Z.y-C;let X=Math.atan2(H,K)*(180/Math.PI)+90;X=Bw(X),he.shiftKey&&(X=Math.round(X/15)*15),n(e.id,X)}else if(c&&h){const Z=E(he.clientX,he.clientY),K=E(h.x,h.y),H=Z.x-K.x,X=Z.y-K.y;let F=h.initialScale,W={...g};switch(u){case"se":F=Math.max(.3,h.initialScale+H/m.dimensions.width_mm);break;case"nw":F=Math.max(.3,h.initialScale-H/m.dimensions.width_mm),W.x=h.initialPosition.x+(h.initialWidth-m.dimensions.width_mm*F),W.y=h.initialPosition.y+(h.initialHeight-m.dimensions.length_mm*F);break;case"ne":F=Math.max(.3,h.initialScale+H/m.dimensions.width_mm),W.y=h.initialPosition.y+(h.initialHeight-m.dimensions.length_mm*F);break;case"sw":F=Math.max(.3,h.initialScale-H/m.dimensions.width_mm),W.x=h.initialPosition.x+(h.initialWidth-m.dimensions.width_mm*F);break;case"e":F=Math.max(.3,h.initialScale+H/m.dimensions.width_mm);break;case"w":F=Math.max(.3,h.initialScale-H/m.dimensions.width_mm),W.x=h.initialPosition.x+(h.initialWidth-m.dimensions.width_mm*F);break;case"n":F=Math.max(.3,h.initialScale-X/m.dimensions.length_mm),W.y=h.initialPosition.y+(h.initialHeight-m.dimensions.length_mm*F);break;case"s":F=Math.max(.3,h.initialScale+X/m.dimensions.length_mm);break}F=Math.min(3,Math.max(.3,F)),r(e.id,F),(W.x!==g.x||W.y!==g.y)&&i(e.id,W)}},z=()=>{(a||c)&&s(),l(!1),d(!1),p(null),f(null)};return window.addEventListener("mousemove",k),window.addEventListener("mouseup",z),()=>{window.removeEventListener("mousemove",k),window.removeEventListener("mouseup",z)}},[a,c,h,w,C,e.id,g,y,u]);const J=[{type:"nw",x:0,y:0,cursor:"nwse-resize"},{type:"n",x:m.dimensions.width_mm/2,y:0,cursor:"ns-resize"},{type:"ne",x:m.dimensions.width_mm,y:0,cursor:"nesw-resize"},{type:"e",x:m.dimensions.width_mm,y:m.dimensions.length_mm/2,cursor:"ew-resize"},{type:"se",x:m.dimensions.width_mm,y:m.dimensions.length_mm,cursor:"nwse-resize"},{type:"s",x:m.dimensions.width_mm/2,y:m.dimensions.length_mm,cursor:"ns-resize"},{type:"sw",x:0,y:m.dimensions.length_mm,cursor:"nesw-resize"},{type:"w",x:0,y:m.dimensions.length_mm/2,cursor:"ew-resize"}],P=300,q=250;return o.jsxs("g",{className:"transform-handles",children:[o.jsxs("g",{className:"rotation-handle",onMouseDown:T,style:{cursor:a?"grabbing":"grab"},children:[o.jsx("line",{x1:_,y1:0,x2:_,y2:j+q,stroke:"#007bff",strokeWidth:30,strokeDasharray:"100 50"}),o.jsx("circle",{cx:_,cy:j,r:q,fill:"white",stroke:"#007bff",strokeWidth:40}),o.jsx("path",{d:`M ${_-q*.4} ${j}
              A ${q*.5} ${q*.5} 0 1 1 ${_+q*.4} ${j}`,fill:"none",stroke:"#007bff",strokeWidth:30,strokeLinecap:"round"}),o.jsx("path",{d:`M ${_+q*.4} ${j}
              L ${_+q*.6} ${j-q*.2}
              M ${_+q*.4} ${j}
              L ${_+q*.6} ${j+q*.2}`,fill:"none",stroke:"#007bff",strokeWidth:30,strokeLinecap:"round"})]}),J.map(k=>o.jsx("rect",{className:`scale-handle scale-handle--${k.type}`,x:k.x-P/2,y:k.y-P/2,width:P,height:P,fill:"white",stroke:"#007bff",strokeWidth:40,rx:30,ry:30,style:{cursor:c&&u===k.type?"grabbing":k.cursor,pointerEvents:"all"},onMouseDown:z=>M(z,k.type)},k.type)),a&&o.jsxs("text",{x:m.dimensions.width_mm/2,y:-1e3-q-200,textAnchor:"middle",fontSize:400,fill:"#007bff",fontWeight:"bold",style:{pointerEvents:"none"},children:[Math.round(x),""]}),c&&o.jsxs("text",{x:m.dimensions.width_mm/2,y:m.dimensions.length_mm+600,textAnchor:"middle",fontSize:400,fill:"#007bff",fontWeight:"bold",style:{pointerEvents:"none"},children:[(y*100).toFixed(0),"%"]})]})}function Hw(e){const{width_mm:t,height_mm:n,numLanes:r,laneWidth_mm:i,cornerRadius:s={topLeft:3e3,topRight:3e3,bottomLeft:3e3,bottomRight:3e3},lineWidth_mm:a=50}=e,l=[];if(s.topLeft===0&&s.topRight===0&&s.bottomLeft===0&&s.bottomRight===0){const d=r*i;for(let u=0;u<r;u++){const p=u*i;l.push({laneNumber:u+1,innerPath:null,outerPath:rE(i,n,u),perimeter:2*n/1e3,isParallel:!0,laneX:p,laneWidth:i})}return{lanes:l,totalWidth:d,totalLength:n,usableWidth:d,usableHeight:n,isStraightTrack:!0}}else for(let d=0;d<r;d++){const u=d*i,p=(d+1)*i,h=Math.max(0,t-p*2),f=Math.max(0,n-p*2),m=Math.max(0,t-u*2),g=Math.max(0,n-u*2),x={topLeft:Math.max(0,s.topLeft-p),topRight:Math.max(0,s.topRight-p),bottomLeft:Math.max(0,s.bottomLeft-p),bottomRight:Math.max(0,s.bottomRight-p)},y={topLeft:Math.max(0,s.topLeft-u),topRight:Math.max(0,s.topRight-u),bottomLeft:Math.max(0,s.bottomLeft-u),bottomRight:Math.max(0,s.bottomRight-u)};l.push({laneNumber:d+1,innerPath:y0(h,f,x,p),outerPath:y0(m,g,y,u),perimeter:iE(m,g,y),isParallel:!1})}return{lanes:l,totalWidth:t,totalLength:n,usableWidth:t-r*i*2,usableHeight:n-r*i*2}}function y0(e,t,n,r=0){if(e<=0||t<=0)return`M ${r} ${r} L ${r} ${r}`;const i=Math.min(e/2,t/2),s=Math.min(n.topLeft,i),a=Math.min(n.topRight,i),l=Math.min(n.bottomRight,i),c=Math.min(n.bottomLeft,i),d=r,u=r+e,p=r,h=r+t;return`
    M ${d+s} ${p}
    L ${u-a} ${p}
    ${a>0?`A ${a} ${a} 0 0 1 ${u} ${p+a}`:""}
    L ${u} ${h-l}
    ${l>0?`A ${l} ${l} 0 0 1 ${u-l} ${h}`:""}
    L ${d+c} ${h}
    ${c>0?`A ${c} ${c} 0 0 1 ${d} ${h-c}`:""}
    L ${d} ${p+s}
    ${s>0?`A ${s} ${s} 0 0 1 ${d+s} ${p}`:""}
    Z
  `.trim().replace(/\s+/g," ")}function rE(e,t,n){const r=n*e;return`M ${r} 0 L ${r+e} 0 L ${r+e} ${t} L ${r} ${t} Z`}function iE(e,t,n){if(e<=0||t<=0)return 0;const r=Math.min(e/2,t/2),i=Math.min(n.topLeft,r),s=Math.min(n.topRight,r),a=Math.min(n.bottomRight,r),l=Math.min(n.bottomLeft,r),c=e-i-s,d=t-s-a,u=e-a-l,p=t-l-i,h=Math.PI*i/2,f=Math.PI*s/2,m=Math.PI*a/2,g=Math.PI*l/2;return(c+d+u+p+h+f+m+g)/1e3}function Uw(e){if(!e||!e.lanes||e.lanes.length===0)return[];const t=e.lanes.length-1,n=e.lanes[t].perimeter;return e.lanes.map((r,i)=>r.perimeter-n)}function x0(e,t,n){const{width_mm:r,height_mm:i,laneWidth_mm:s,cornerRadius:a={topLeft:3e3,topRight:3e3,bottomLeft:3e3,bottomRight:3e3}}=n,l=e*s,c=Math.max(0,r-l*2),d=Math.max(0,i-l*2),u=Math.min(c/2,d/2),p=Math.min(Math.max(0,a.topLeft-l),u),h=Math.min(Math.max(0,a.topRight-l),u),f=Math.min(Math.max(0,a.bottomRight-l),u),m=Math.min(Math.max(0,a.bottomLeft-l),u),g=l,x=l+c,y=l,v=l+d,b=[{type:"arc",length:Math.PI*m/2,radius:m,corner:"bottomLeft"},{type:"straight",length:d-m-p,dir:"up"},{type:"arc",length:Math.PI*p/2,radius:p,corner:"topLeft"},{type:"straight",length:c-p-h,dir:"right"},{type:"arc",length:Math.PI*h/2,radius:h,corner:"topRight"},{type:"straight",length:d-h-f,dir:"down"},{type:"arc",length:Math.PI*f/2,radius:f,corner:"bottomRight"},{type:"straight",length:c-f-m,dir:"left"}];let w=t;const C=b.reduce((j,E)=>j+E.length,0);for(;w<0;)w+=C;for(;w>=C;)w-=C;let _=0;for(const j of b){if(w<=_+j.length){const E=w-_,T=j.length>0?E/j.length:0;return j.type==="arc"?sE(j,T,{left:g,right:x,top:y,bottom:v,tl:p,tr:h,br:f,bl:m}):oE(j,T,{left:g,right:x,top:y,bottom:v,tl:p,tr:h,br:f,bl:m})}_+=j.length}return{x:g,y:v-m,angle:-Math.PI/2}}function sE(e,t,n){const{left:r,right:i,top:s,bottom:a,tl:l,tr:c,br:d,bl:u}=n,p=t*(Math.PI/2);switch(e.corner){case"bottomLeft":{const h=r+u,f=a-u,g=Math.PI/2+p;return{x:h+u*Math.cos(g),y:f+u*Math.sin(g),angle:g+Math.PI/2}}case"topLeft":{const h=r+l,f=s+l,g=Math.PI+p;return{x:h+l*Math.cos(g),y:f+l*Math.sin(g),angle:g+Math.PI/2}}case"topRight":{const h=i-c,f=s+c,g=-Math.PI/2+p;return{x:h+c*Math.cos(g),y:f+c*Math.sin(g),angle:g+Math.PI/2}}case"bottomRight":{const h=i-d,f=a-d,g=0+p;return{x:h+d*Math.cos(g),y:f+d*Math.sin(g),angle:g+Math.PI/2}}default:return{x:r,y:s,angle:0}}}function oE(e,t,n){const{left:r,right:i,top:s,bottom:a,tl:l,tr:c,br:d,bl:u}=n;switch(e.dir){case"up":{const p=a-u,h=s+l;return{x:r,y:p+t*(h-p),angle:-Math.PI/2}}case"right":{const p=r+l,h=i-c;return{x:p+t*(h-p),y:s,angle:0}}case"down":{const p=s+c,h=a-d;return{x:i,y:p+t*(h-p),angle:Math.PI/2}}case"left":{const p=i-d,h=r+u;return{x:p+t*(h-p),y:a,angle:Math.PI}}default:return{x:r,y:s,angle:0}}}function b0(e,t,n){const r=x0(e,t,n),i=x0(e+1,t,n);return{x:(r.x+i.x)/2,y:(r.y+i.y)/2,angle:r.angle,innerX:i.x,innerY:i.y,outerX:r.x,outerY:r.y}}function w0(e,t,n){const{width_mm:r,height_mm:i,laneWidth_mm:s,cornerRadius:a={topLeft:3e3,topRight:3e3,bottomLeft:3e3,bottomRight:3e3}}=n,l=e*s,c=Math.max(0,r-l*2),d=Math.max(0,i-l*2),u=Math.min(c/2,d/2),p=Math.min(Math.max(0,a.topLeft-l),u),h=Math.min(Math.max(0,a.topRight-l),u),f=Math.min(Math.max(0,a.bottomRight-l),u),m=Math.min(Math.max(0,a.bottomLeft-l),u),g=[{type:"arc",length:Math.PI*m/2,corner:"bottomLeft"},{type:"straight",length:d-m-p,dir:"up"},{type:"arc",length:Math.PI*p/2,corner:"topLeft"},{type:"straight",length:c-p-h,dir:"right"},{type:"arc",length:Math.PI*h/2,corner:"topRight"},{type:"straight",length:d-h-f,dir:"down"},{type:"arc",length:Math.PI*f/2,corner:"bottomRight"},{type:"straight",length:c-f-m,dir:"left"}],x=g.reduce((b,w)=>b+w.length,0);let y=t;for(;y<0;)y+=x;for(;y>=x;)y-=x;let v=0;for(let b=0;b<g.length;b++){if(y<=v+g[b].length){const w=y-v,C=g[b].length>0?w/g[b].length:0;return{segmentIndex:b,t:C,segments:g,totalPerimeter:x}}v+=g[b].length}return{segmentIndex:0,t:0,segments:g,totalPerimeter:x}}function _0(e,t,n,r){const i=w0(n,t,r),s=w0(e,0,r);let a=0;for(let d=0;d<i.segmentIndex;d++)a+=s.segments[d].length;const l=s.segments[i.segmentIndex].length;return a+i.t*l}function aE({track:e,svgRef:t}){var k;const{updateTrackParameters:n,updateTrackPosition:r,updateTrackRotation:i,addToHistory:s}=st(),[a,l]=R.useState(!1),[c,d]=R.useState(!1),[u,p]=R.useState(null),[h,f]=R.useState(null),{parameters:m,position:g,rotation:x}=e,y=m.width_mm,v=m.height_mm,b=g.x+y/2,w=g.y+v/2,C=y/2,_=-1e3,j=(z,he)=>{if(!t.current)return{x:0,y:0};const Z=t.current.createSVGPoint();Z.x=z,Z.y=he;const K=Z.matrixTransform(t.current.getScreenCTM().inverse());return{x:K.x,y:K.y}},E=z=>{z.stopPropagation();const he=z.touches?z.touches[0].clientX:z.clientX,Z=z.touches?z.touches[0].clientY:z.clientY;d(!0),f({x:he,y:Z})},T=(z,he)=>{var W;z.stopPropagation(),l(!0),p(he);const Z=z.touches?z.touches[0].clientX:z.clientX,K=z.touches?z.touches[0].clientY:z.clientY,H=j(Z,K),X=((W=e.template)==null?void 0:W.trackType)==="straight";let F={};if(X){const re=x*Math.PI/180,se=Math.sin(re),me=Math.cos(re),ke=g.x+y/2,pe=g.y+v/2,Pe=he==="n"||he==="nw"||he==="ne";F={fixedEdgeCenter:Pe?{x:ke-v/2*se,y:pe+v/2*me}:{x:ke+v/2*se,y:pe-v/2*me},fixedEdgeIsSouth:Pe,sinR:se,cosR:me}}f({screenX:Z,screenY:K,svgX:H.x,svgY:H.y,initialWidth:y,initialHeight:v,initialPosition:{...g},initialCornerRadius:{...m.cornerRadius},...F})};R.useEffect(()=>{if(!a&&!c)return;const z=Z=>{var Ge;const K=Z.touches?Z.touches[0].clientX:Z.clientX,H=Z.touches?Z.touches[0].clientY:Z.clientY;if(c){const $e=j(K,H),we=$e.x-b,xe=$e.y-w;let S=Math.atan2(xe,we)*(180/Math.PI)+90;S=Bw(S),Z.shiftKey&&(S=Math.round(S/15)*15),i(e.id,S);return}if(!h)return;const X=j(K,H),F=X.x-h.svgX,W=X.y-h.svgY;let re=h.initialWidth,se=h.initialHeight,me={...g},ke={...h.initialCornerRadius};const pe=3e3,Pe=((Ge=e.template)==null?void 0:Ge.trackType)==="straight";if(Pe&&(u==="e"||u==="w"))return;if(Pe&&h.fixedEdgeCenter){const{fixedEdgeCenter:$e,fixedEdgeIsSouth:we,sinR:xe,cosR:S}=h,ue=X.x-$e.x,ce=X.y-$e.y,I=we?xe:-xe,N=we?-S:S,B=ue*I+ce*N;se=Math.max(pe,B);const oe=$e.x+se/2*I,de=$e.y+se/2*N;me={x:oe-re/2,y:de-se/2}}else switch(u){case"se":re=Math.max(pe,h.initialWidth+F),se=Math.max(pe,h.initialHeight+W);const $e=Math.min(re/h.initialWidth,se/h.initialHeight);ke={topLeft:h.initialCornerRadius.topLeft*$e,topRight:h.initialCornerRadius.topRight*$e,bottomLeft:h.initialCornerRadius.bottomLeft*$e,bottomRight:h.initialCornerRadius.bottomRight*$e};break;case"nw":re=Math.max(pe,h.initialWidth-F),se=Math.max(pe,h.initialHeight-W),me.x=h.initialPosition.x+(h.initialWidth-re),me.y=h.initialPosition.y+(h.initialHeight-se);const we=Math.min(re/h.initialWidth,se/h.initialHeight);ke={topLeft:h.initialCornerRadius.topLeft*we,topRight:h.initialCornerRadius.topRight*we,bottomLeft:h.initialCornerRadius.bottomLeft*we,bottomRight:h.initialCornerRadius.bottomRight*we};break;case"ne":re=Math.max(pe,h.initialWidth+F),se=Math.max(pe,h.initialHeight-W),me.y=h.initialPosition.y+(h.initialHeight-se);const xe=Math.min(re/h.initialWidth,se/h.initialHeight);ke={topLeft:h.initialCornerRadius.topLeft*xe,topRight:h.initialCornerRadius.topRight*xe,bottomLeft:h.initialCornerRadius.bottomLeft*xe,bottomRight:h.initialCornerRadius.bottomRight*xe};break;case"sw":re=Math.max(pe,h.initialWidth-F),se=Math.max(pe,h.initialHeight+W),me.x=h.initialPosition.x+(h.initialWidth-re);const S=Math.min(re/h.initialWidth,se/h.initialHeight);ke={topLeft:h.initialCornerRadius.topLeft*S,topRight:h.initialCornerRadius.topRight*S,bottomLeft:h.initialCornerRadius.bottomLeft*S,bottomRight:h.initialCornerRadius.bottomRight*S};break;case"e":re=Math.max(pe,h.initialWidth+F);const ue=re/h.initialWidth;ke={topLeft:h.initialCornerRadius.topLeft*ue,topRight:h.initialCornerRadius.topRight*ue,bottomLeft:h.initialCornerRadius.bottomLeft*ue,bottomRight:h.initialCornerRadius.bottomRight*ue};break;case"w":re=Math.max(pe,h.initialWidth-F),me.x=h.initialPosition.x+(h.initialWidth-re);const ce=re/h.initialWidth;ke={topLeft:h.initialCornerRadius.topLeft*ce,topRight:h.initialCornerRadius.topRight*ce,bottomLeft:h.initialCornerRadius.bottomLeft*ce,bottomRight:h.initialCornerRadius.bottomRight*ce};break;case"n":se=Math.max(pe,h.initialHeight-W),me.y=h.initialPosition.y+(h.initialHeight-se);const I=se/h.initialHeight;ke={topLeft:h.initialCornerRadius.topLeft*I,topRight:h.initialCornerRadius.topRight*I,bottomLeft:h.initialCornerRadius.bottomLeft*I,bottomRight:h.initialCornerRadius.bottomRight*I};break;case"s":se=Math.max(pe,h.initialHeight+W);const N=se/h.initialHeight;ke={topLeft:h.initialCornerRadius.topLeft*N,topRight:h.initialCornerRadius.topRight*N,bottomLeft:h.initialCornerRadius.bottomLeft*N,bottomRight:h.initialCornerRadius.bottomRight*N};break}const Re=Math.min(re,se)/2;ke={topLeft:Math.min(ke.topLeft,Re),topRight:Math.min(ke.topRight,Re),bottomLeft:Math.min(ke.bottomLeft,Re),bottomRight:Math.min(ke.bottomRight,Re)},n(e.id,{width_mm:re,height_mm:se,cornerRadius:ke}),(me.x!==g.x||me.y!==g.y)&&r(e.id,me)},he=()=>{(a||c)&&s(),l(!1),d(!1),p(null),f(null)};return window.addEventListener("mousemove",z),window.addEventListener("mouseup",he),window.addEventListener("touchmove",z,{passive:!1}),window.addEventListener("touchend",he),window.addEventListener("touchcancel",he),()=>{window.removeEventListener("mousemove",z),window.removeEventListener("mouseup",he),window.removeEventListener("touchmove",z),window.removeEventListener("touchend",he),window.removeEventListener("touchcancel",he)}},[a,h,u,e.id,g,m,n,r,s]);const M=((k=e.template)==null?void 0:k.trackType)==="straight",J=[{type:"nw",x:0,y:0,cursor:"nwse-resize"},{type:"n",x:y/2,y:0,cursor:"ns-resize"},{type:"ne",x:y,y:0,cursor:"nesw-resize"},{type:"e",x:y,y:v/2,cursor:"ew-resize"},{type:"se",x:y,y:v,cursor:"nwse-resize"},{type:"s",x:y/2,y:v,cursor:"ns-resize"},{type:"sw",x:0,y:v,cursor:"nesw-resize"},{type:"w",x:0,y:v/2,cursor:"ew-resize"}],P=M?J.filter(z=>z.type==="n"||z.type==="s"):J,q=400;return o.jsxs("g",{className:"track-resize-handles",children:[o.jsxs("g",{className:"rotation-handle-group",children:[o.jsx("line",{x1:C,y1:0,x2:C,y2:_,stroke:"#0066CC",strokeWidth:30,strokeDasharray:"100 100",opacity:.5,style:{pointerEvents:"none"}}),o.jsx("circle",{className:"rotation-handle",cx:C,cy:_,r:q/2,fill:"white",stroke:"#0066CC",strokeWidth:50,style:{cursor:c?"grabbing":"grab",pointerEvents:"all"},onMouseDown:E,onTouchStart:E}),o.jsx("path",{d:`M ${C-100} ${_-50}
              A 100 100 0 1 1 ${C+100} ${_-50}`,fill:"none",stroke:"#0066CC",strokeWidth:40,strokeLinecap:"round",style:{pointerEvents:"none"}}),o.jsx("path",{d:`M ${C+100} ${_-50}
              L ${C+80} ${_-120}
              L ${C+150} ${_-80}
              Z`,fill:"#0066CC",style:{pointerEvents:"none"}})]}),P.map(z=>o.jsx("rect",{className:`resize-handle resize-handle--${z.type}`,x:z.x-q/2,y:z.y-q/2,width:q,height:q,fill:"white",stroke:"#0066CC",strokeWidth:50,rx:40,ry:40,style:{cursor:a&&u===z.type?"grabbing":z.cursor,pointerEvents:"all"},onMouseDown:he=>T(he,z.type),onTouchStart:he=>T(he,z.type)},z.type)),a&&o.jsxs("text",{x:y/2,y:v+800,textAnchor:"middle",fontSize:400,fill:"#0066CC",fontWeight:"bold",style:{pointerEvents:"none"},children:[(y/1e3).toFixed(1),"m  ",(v/1e3).toFixed(1),"m"]}),c&&o.jsxs("text",{x:y/2,y:-1500,textAnchor:"middle",fontSize:400,fill:"#0066CC",fontWeight:"bold",style:{pointerEvents:"none"},children:[x.toFixed(0),""]})]})}function lE({geometry:e,parameters:t,boxConfig:n,surfaceColor:r,lineColor:i,isStraightTrack:s}){if(!n||!n.enabled)return null;const{depth_mm:a=800,lineWidth_mm:l=50,perLaneOffsets:c=[],style:d="staggered",direction:u="counterclockwise",startPosition:p=0}=n,h="'Black Ops One', 'Impact', sans-serif",f=r||"#A5362F",m=i||"#E8E3D8",g=d==="staggered"||d==="both",x=d==="straight"||d==="both";return o.jsx("g",{className:"starting-boxes",children:e.lanes.map((y,v)=>{const b=v+1;return s?cE(v,b,t,e,a,l,f,m,h,g,x,c,u):dE(v,b,t,e,a,l,f,m,h,g,x,c,u,p)})})}function cE(e,t,n,r,i,s,a,l,c,d,u,p,h){const f=e*n.laneWidth_mm,m=n.laneWidth_mm,g=h==="clockwise",x=g?r.totalLength-i:0,y=g?0:r.totalLength-i,v=(p[e]||0)*1e3,b=[];if(d&&!u){const w=g?x-v:x+v;b.push(o.jsx(lc,{x:f,y:w,width:m,height:i,laneNumber:t,boxFillColor:a,lineColor:l,lineWidth:s,fontFamily:c,flipLine:!g},`stagger-${t}`))}else if(u&&!d)b.push(o.jsx(lc,{x:f,y:x,width:m,height:i,laneNumber:t,boxFillColor:a,lineColor:l,lineWidth:s,fontFamily:c,flipLine:!g},`straight-${t}`));else if(d&&u){const w=g?x-v:x+v;b.push(o.jsx(lc,{x:f,y:w,width:m,height:i,laneNumber:t,boxFillColor:a,lineColor:l,lineWidth:s,fontFamily:c,flipLine:!g},`stagger-${t}`)),b.push(o.jsx(lc,{x:f,y,width:m,height:i,laneNumber:t,boxFillColor:a,lineColor:l,lineWidth:s,fontFamily:c,flipLine:g},`straight-${t}`))}return o.jsx("g",{children:b},`lane-boxes-${t}`)}function lc({x:e,y:t,width:n,height:r,laneNumber:i,boxFillColor:s,lineColor:a,lineWidth:l,fontFamily:c,flipLine:d}){const u=d?t+r:t;return o.jsxs("g",{children:[o.jsx("line",{x1:e,y1:u,x2:e+n,y2:u,stroke:a,strokeWidth:l,strokeLinecap:"butt",pointerEvents:"none"}),o.jsx("text",{x:e+n/2,y:t+r/2,fontSize:Math.min(r*.6,n*.5),fill:a,textAnchor:"middle",dominantBaseline:"middle",fontFamily:c,fontWeight:"bold",pointerEvents:"none",opacity:"0.9",children:i})]})}function dE(e,t,n,r,i,s,a,l,c,d,u,p,h,f=0){var E,T;const m=h==="clockwise",g=r.lanes.length-1,x=(((E=r.lanes[g])==null?void 0:E.perimeter)||0)*1e3,y=x/2,v=f/100*x,b=_0(e,v,g,n),C=(((T=r.lanes[e])==null?void 0:T.perimeter)||0)*1e3/2,_=(p[e]||0)*1e3,j=[];if(d&&!u){const M=m?b+C+_:b+_;j.push(o.jsx(cc,{index:e,laneNumber:t,distance:M,depth_mm:i,parameters:n,boxFillColor:a,lineColor:l,lineWidth:s,fontFamily:c},`stagger-${t}`))}else if(u&&!d){const M=m?b+C:b;j.push(o.jsx(cc,{index:e,laneNumber:t,distance:M,depth_mm:i,parameters:n,boxFillColor:a,lineColor:l,lineWidth:s,fontFamily:c},`straight-${t}`))}else if(d&&u){const M=m?b+C+_:b+_,J=m?v:v+y,P=_0(e,J,g,n),q=P;j.push(o.jsx(cc,{index:e,laneNumber:t,distance:M,depth_mm:i,parameters:n,boxFillColor:a,lineColor:l,lineWidth:s,fontFamily:c},`stagger-${t}`)),j.push(o.jsx(cc,{index:e,laneNumber:t,distance:q,depth_mm:i,parameters:n,boxFillColor:a,lineColor:l,lineWidth:s,fontFamily:c},`straight-${t}`))}return o.jsx("g",{children:j},`lane-boxes-${t}`)}function cc({index:e,laneNumber:t,distance:n,depth_mm:r,parameters:i,boxFillColor:s,lineColor:a,lineWidth:l,fontFamily:c}){const d=b0(e,n,i),u=d.angle+Math.PI/2,p=i.laneWidth_mm/2,h=d.x+Math.cos(u)*p,f=d.y+Math.sin(u)*p,m=d.x-Math.cos(u)*p,g=d.y-Math.sin(u)*p,x=b0(e,n+r/2,i);return o.jsxs("g",{children:[o.jsx("line",{x1:h,y1:f,x2:m,y2:g,stroke:a,strokeWidth:l,strokeLinecap:"butt",pointerEvents:"none"}),o.jsx("text",{x:x.x,y:x.y,fontSize:Math.min(r*.6,i.laneWidth_mm*.5),fill:a,textAnchor:"middle",dominantBaseline:"middle",fontFamily:c,fontWeight:"bold",pointerEvents:"none",opacity:"0.9",transform:`rotate(${x.angle*180/Math.PI+90}, ${x.x}, ${x.y})`,children:t})]})}function uE({track:e,isSelected:t,onMouseDown:n,onTouchStart:r,onDoubleClick:i,svgRef:s}){var C,_,j;const{parameters:a,position:l,rotation:c,trackSurfaceColor:d,trackLineColor:u}=e,p=Hw(a),h=p.lanes.length>0&&p.lanes[0].isParallel===!0,f=p.totalWidth,m=p.totalLength,g=f/2,x=m/2,y=`translate(${l.x}, ${l.y}) rotate(${c}, ${g}, ${x})`,v=(d==null?void 0:d.hex)||"#A5362F",b=(u==null?void 0:u.hex)||"#E8E3D8",w=a.lineWidth_mm||50;return console.log("TrackRenderer - trackSurfaceColor:",d),console.log("TrackRenderer - surfaceColor:",v),console.log("TrackRenderer - geometry.lanes.length:",p.lanes.length),o.jsxs("g",{className:`track-element ${t?"track-element--selected":""}`,transform:y,style:{cursor:"move"},children:[h?o.jsxs(o.Fragment,{children:[o.jsx("rect",{x:"0",y:"0",width:f,height:m,fill:"transparent",pointerEvents:"all",onMouseDown:n,onTouchStart:r,onDoubleClick:i,style:{cursor:"move"}}),p.lanes.map(E=>o.jsx("path",{d:E.outerPath,fill:v,stroke:"none",pointerEvents:"none"},`lane-fill-${E.laneNumber}`))]}):o.jsx("path",{d:`${p.lanes[0].outerPath} ${p.lanes[p.lanes.length-1].innerPath}`,fill:v,fillRule:"evenodd",stroke:"none",pointerEvents:"all",onMouseDown:n,onTouchStart:r,onDoubleClick:i,style:{cursor:"move"}}),p.lanes.map((E,T)=>o.jsx(hE,{lane:E,lineColor:b,lineWidth:w,isLastLane:T===p.lanes.length-1,isStraightTrack:h,geometry:p},`stroke-${E.laneNumber}`)),((C=a.startingBoxes)==null?void 0:C.enabled)&&o.jsx(lE,{geometry:p,parameters:a,boxConfig:{...a.startingBoxes,perLaneOffsets:((_=e.template)==null?void 0:_.trackType)==="curved"?Uw(p):[]},surfaceColor:v,lineColor:b,isStraightTrack:((j=e.template)==null?void 0:j.trackType)==="straight"}),t&&o.jsxs(o.Fragment,{children:[o.jsx("rect",{x:"-10",y:"-10",width:f+20,height:m+20,fill:"none",stroke:"#0066CC",strokeWidth:"80",strokeDasharray:"400 400",opacity:"0.5",pointerEvents:"none"}),o.jsx(aE,{track:e,svgRef:s})]})]})}function hE({lane:e,lineColor:t,lineWidth:n,isLastLane:r,isStraightTrack:i,geometry:s}){const{innerPath:a,outerPath:l}=e,c=50;return i?o.jsxs("g",{className:"track-lane-stroke",children:[e.laneNumber===1&&o.jsx("line",{x1:e.laneX,y1:0,x2:e.laneX,y2:s.totalLength,stroke:t,strokeWidth:c,pointerEvents:"none"}),o.jsx("line",{x1:e.laneX+e.laneWidth,y1:0,x2:e.laneX+e.laneWidth,y2:s.totalLength,stroke:t,strokeWidth:c,pointerEvents:"none"})]}):o.jsxs("g",{className:"track-lane-stroke",children:[o.jsx("path",{d:l,fill:"none",stroke:t,strokeWidth:c,pointerEvents:"none"}),r&&o.jsx("path",{d:a,fill:"none",stroke:t,strokeWidth:c,pointerEvents:"none"})]})}function pE({motif:e,isSelected:t,onMouseDown:n,onTouchStart:r,onDoubleClick:i,onScaleStart:s,onRotateStart:a}){const{svgContent:l,originalWidth_mm:c,originalHeight_mm:d,position:u,rotation:p,scale:h}=e,f=R.useMemo(()=>{if(!l)return null;const _=l.match(/viewBox=["']([^"']+)["']/i);if(_){const T=_[1].split(/\s+/).map(Number);if(T.length>=4)return{width:T[2],height:T[3]}}const j=l.match(/\bwidth=["']?(\d+(?:\.\d+)?)/i),E=l.match(/\bheight=["']?(\d+(?:\.\d+)?)/i);return j&&E?{width:parseFloat(j[1]),height:parseFloat(E[1])}:null},[l]),m=R.useMemo(()=>{if(!f)return{width:c,height:d};const _=f.width/f.height,j=c/d,E=_>=1,T=j>=1;if(E!==T){console.warn("[MOTIF] Orientation mismatch detected - using SVG viewBox aspect ratio"),console.log("[MOTIF] SVG viewBox:",f,"AR:",_.toFixed(2)),console.log("[MOTIF] Physical dims:",c,"",d,"AR:",j.toFixed(2));const M=c*d,J=Math.sqrt(M*_),P=J/_;return{width:J,height:P}}return{width:c,height:d}},[f,c,d]),g=m.width*(h||1),x=m.height*(h||1),y=g/2,v=x/2,b=`translate(${u.x}, ${u.y}) rotate(${p||0}, ${y}, ${v})`,w=R.useMemo(()=>{if(!l)return null;try{let _=l;return _=_.replace(/\s+(width|height)=["'][^"']*["']/gi,""),_.includes("viewBox")||(_=_.replace("<svg",`<svg viewBox="0 0 ${m.width} ${m.height}"`)),_}catch(_){return console.error("[MOTIF] Error processing SVG:",_),l}},[l,m]),C=R.useMemo(()=>{if(!w)return null;try{return`data:image/svg+xml,${encodeURIComponent(w).replace(/'/g,"%27").replace(/"/g,"%22")}`}catch(_){return console.error("[MOTIF] Error creating data URL:",_),null}},[w]);return C?o.jsxs("g",{className:`motif-element ${t?"motif-element--selected":""}`,transform:b,style:{cursor:"move"},children:[o.jsx("image",{href:C,x:"0",y:"0",width:g,height:x,preserveAspectRatio:"xMidYMid meet",pointerEvents:"none"}),o.jsx("rect",{x:"0",y:"0",width:g,height:x,fill:"transparent",pointerEvents:"all",onMouseDown:n,onTouchStart:r,onDoubleClick:i,style:{cursor:"move"}}),t&&o.jsx("rect",{x:"-10",y:"-10",width:g+20,height:x+20,fill:"none",stroke:"#9333EA",strokeWidth:"80",strokeDasharray:"400 400",opacity:"0.7",pointerEvents:"none"}),t&&o.jsx(fE,{width:g,height:x,onScaleStart:s,onRotateStart:a})]}):o.jsxs("g",{transform:b,children:[o.jsx("rect",{x:"0",y:"0",width:g,height:x,fill:"#f0f0f0",stroke:"#ccc",strokeWidth:"50",strokeDasharray:"200 200"}),o.jsx("text",{x:g/2,y:x/2,textAnchor:"middle",dominantBaseline:"middle",fontSize:Math.min(g,x)/10,fill:"#999",children:"Motif Error"})]})}function fE({width:e,height:t,onScaleStart:n,onRotateStart:r}){const i=Math.min(e,t)*.08,l=Math.max(150,Math.min(400,i)),c=[{x:-l/2,y:-l/2,corner:"nw",cursor:"nwse-resize"},{x:e-l/2,y:-l/2,corner:"ne",cursor:"nesw-resize"},{x:-l/2,y:t-l/2,corner:"sw",cursor:"nesw-resize"},{x:e-l/2,y:t-l/2,corner:"se",cursor:"nwse-resize"}],d=l*2.5,u=l*.8;return o.jsxs("g",{className:"motif-handles",children:[c.map(p=>o.jsx("rect",{x:p.x,y:p.y,width:l,height:l,fill:"#9333EA",stroke:"#fff",strokeWidth:"20",rx:l/4,style:{cursor:p.cursor},pointerEvents:"all",onMouseDown:h=>{h.stopPropagation(),n==null||n(h,p.corner)},onTouchStart:h=>{h.stopPropagation(),n==null||n(h,p.corner)}},p.corner)),o.jsx("line",{x1:e/2,y1:0,x2:e/2,y2:-d+u/2,stroke:"#9333EA",strokeWidth:"30",pointerEvents:"none"}),o.jsx("circle",{cx:e/2,cy:-d,r:u,fill:"#9333EA",stroke:"#fff",strokeWidth:"20",style:{cursor:"grab"},pointerEvents:"all",onMouseDown:p=>{p.stopPropagation(),r==null||r(p)},onTouchStart:p=>{p.stopPropagation(),r==null||r(p)}}),o.jsx("path",{d:`M ${e/2-u*.4} ${-d}
            A ${u*.4} ${u*.4} 0 1 1
            ${e/2+u*.4} ${-d}`,fill:"none",stroke:"#fff",strokeWidth:"25",strokeLinecap:"round",pointerEvents:"none"}),o.jsx("polygon",{points:`${e/2+u*.4},${-d-u*.25}
                 ${e/2+u*.4},${-d+u*.25}
                 ${e/2+u*.65},${-d}`,fill:"#fff",pointerEvents:"none"})]})}function Ww(e,t,n,r=0){if(e>=32)return gE(t,n);const i=mE(e,t,n);return r>0?vE(i,r):`M ${i.map(s=>`${s.x},${s.y}`).join(" L ")} Z`}function mE(e,t,n){if(e===4)return[{x:0,y:0},{x:t,y:0},{x:t,y:n},{x:0,y:n}];const r=[],i=2*Math.PI/e,s=-Math.PI/2;for(let m=0;m<e;m++){const g=s+i*m;r.push({x:Math.cos(g),y:Math.sin(g)})}let a=1/0,l=-1/0,c=1/0,d=-1/0;for(const m of r)a=Math.min(a,m.x),l=Math.max(l,m.x),c=Math.min(c,m.y),d=Math.max(d,m.y);const u=l-a,p=d-c,h=t/u,f=n/p;return r.map(m=>({x:(m.x-a)*h,y:(m.y-c)*f}))}function gE(e,t){const n=e/2,r=t/2,i=n,s=r;return`M ${i-n},${s} A ${n},${r} 0 1,1 ${i+n},${s} A ${n},${r} 0 1,1 ${i-n},${s} Z`}function vE(e,t,n,r){if(e.length<3)return"";let i=1/0;for(let h=0;h<e.length;h++){const f=e[h],m=e[(h+1)%e.length],g=Math.sqrt(Math.pow(m.x-f.x,2)+Math.pow(m.y-f.y,2));i=Math.min(i,g)}const s=i/2,a=t/100*s;if(a<1)return`M ${e.map(h=>`${h.x},${h.y}`).join(" L ")} Z`;const l=[];for(let h=0;h<e.length;h++){const f=e[(h-1+e.length)%e.length],m=e[h],g=e[(h+1)%e.length],x=Du({x:f.x-m.x,y:f.y-m.y}),y=Du({x:g.x-m.x,y:g.y-m.y}),v={x:m.x+x.x*a,y:m.y+x.y*a},b={x:m.x+y.x*a,y:m.y+y.y*a};h===0?l.push(`M ${v.x},${v.y}`):l.push(`L ${v.x},${v.y}`),l.push(`Q ${m.x},${m.y} ${b.x},${b.y}`)}const c=e[e.length-1],d=e[0],u=Du({x:c.x-d.x,y:c.y-d.y}),p={x:d.x+u.x*a,y:d.y+u.y*a};return l.push(`L ${p.x},${p.y}`),l.push("Z"),l.join(" ")}function Du(e){const t=Math.sqrt(e.x*e.x+e.y*e.y);return t===0?{x:0,y:0}:{x:e.x/t,y:e.y/t}}function yE(e){const t={3:"Triangle",4:"Rectangle",5:"Pentagon",6:"Hexagon",7:"Heptagon",8:"Octagon",9:"Nonagon",10:"Decagon",12:"Dodecagon"};return e>=32?"Circle":t[e]?t[e]:`${e}-gon`}function xE(e){return e>=32?"":e===3?"":e===4?"":e===5?"":e===6?"":`${e}`}function bE({shape:e,isSelected:t,onMouseDown:n,onTouchStart:r,onDoubleClick:i,onScaleStart:s,onRotateStart:a}){const{sides:l,width_mm:c,height_mm:d,cornerRadius:u,position:p,rotation:h,fillColor:f,strokeEnabled:m,strokeColor:g,strokeWidth_mm:x}=e,y=R.useMemo(()=>Ww(l,c,d,u),[l,c,d,u]),v=c/2,b=d/2,w=`translate(${p.x}, ${p.y}) rotate(${h||0}, ${v}, ${b})`;return o.jsxs("g",{className:`shape-element ${t?"shape-element--selected":""}`,transform:w,style:{cursor:"move"},children:[o.jsx("path",{d:y,fill:(f==null?void 0:f.hex)||"#609B63",stroke:m&&g?g.hex:"none",strokeWidth:m?x:0,pointerEvents:"none"}),o.jsx("path",{d:y,fill:"transparent",stroke:"transparent",strokeWidth:Math.max(x,100),pointerEvents:"all",onMouseDown:n,onTouchStart:r,onDoubleClick:i,style:{cursor:"move"}}),t&&o.jsx("rect",{x:"-10",y:"-10",width:c+20,height:d+20,fill:"none",stroke:"#3b82f6",strokeWidth:"80",strokeDasharray:"400 400",opacity:"0.7",pointerEvents:"none"}),t&&o.jsx(wE,{width:c,height:d,onScaleStart:s,onRotateStart:a})]})}function wE({width:e,height:t,onScaleStart:n,onRotateStart:r}){const i=Math.min(e,t)*.08,l=Math.max(150,Math.min(400,i)),c=[{x:e/2-l/2,y:-l/2,corner:"n",cursor:"ns-resize"},{x:e/2-l/2,y:t-l/2,corner:"s",cursor:"ns-resize"},{x:e-l/2,y:t/2-l/2,corner:"e",cursor:"ew-resize"},{x:-l/2,y:t/2-l/2,corner:"w",cursor:"ew-resize"}],d=l*2.5,u=l*.8;return o.jsxs("g",{className:"shape-handles",children:[c.map(p=>o.jsx("rect",{x:p.x,y:p.y,width:l,height:l,fill:"#3b82f6",stroke:"#fff",strokeWidth:"20",rx:l/4,style:{cursor:p.cursor},pointerEvents:"all",onMouseDown:h=>{h.stopPropagation(),n==null||n(h,p.corner)},onTouchStart:h=>{h.stopPropagation(),n==null||n(h,p.corner)}},p.corner)),o.jsx("line",{x1:e/2,y1:0,x2:e/2,y2:-d+u/2,stroke:"#3b82f6",strokeWidth:"30",pointerEvents:"none"}),o.jsx("circle",{cx:e/2,cy:-d,r:u,fill:"#3b82f6",stroke:"#fff",strokeWidth:"20",style:{cursor:"grab"},pointerEvents:"all",onMouseDown:p=>{p.stopPropagation(),r==null||r(p)},onTouchStart:p=>{p.stopPropagation(),r==null||r(p)}}),o.jsx("path",{d:`M ${e/2-u*.4} ${-d}
            A ${u*.4} ${u*.4} 0 1 1
            ${e/2+u*.4} ${-d}`,fill:"none",stroke:"#fff",strokeWidth:"25",strokeLinecap:"round",pointerEvents:"none"}),o.jsx("polygon",{points:`${e/2+u*.4},${-d-u*.25}
                 ${e/2+u*.4},${-d+u*.25}
                 ${e/2+u*.65},${-d}`,fill:"#fff",pointerEvents:"none"})]})}function Gw({controlPoints:e,width:t,height:n,onPointDrag:r,onHandleDrag:i,onDragEnd:s,showHandles:a=!0,selectedPointIndex:l,onPointSelect:c,onPointDelete:d}){const[u,p]=R.useState(null),[h,f]=R.useState(null),m=Math.min(t,n)*.03,y=Math.max(60,Math.min(120,m)),v=y*.7,b=R.useCallback((_,j)=>{_.stopPropagation(),_.preventDefault(),c==null||c(j),p({type:"point",index:j}),f({x:_.clientX,y:_.clientY})},[c]),w=R.useCallback((_,j)=>{_.preventDefault(),_.stopPropagation(),d==null||d(j)},[d]),C=R.useCallback((_,j,E)=>{_.stopPropagation(),_.preventDefault(),p({type:"handle",index:j,handleType:E}),f({x:_.clientX,y:_.clientY})},[]);return R.useEffect(()=>{if(!u)return;const _=E=>{if(!h)return;const T=document.querySelector(".court-canvas__svg");if(!T)return;const M=T.getBoundingClientRect(),J=T.viewBox.baseVal,P=J.width/M.width,q=J.height/M.height,k=(E.clientX-h.x)*P,z=(E.clientY-h.y)*q;if(u.type==="point"){const he=e[u.index],Z=he.x+k/t,K=he.y+z/n;r==null||r(u.index,Z,K)}else if(u.type==="handle"){const Z=e[u.index][u.handleType],K=Z.x+k/t,H=Z.y+z/n;i==null||i(u.index,u.handleType,K,H)}f({x:E.clientX,y:E.clientY})},j=()=>{p(null),f(null),s==null||s()};return window.addEventListener("mousemove",_),window.addEventListener("mouseup",j),()=>{window.removeEventListener("mousemove",_),window.removeEventListener("mouseup",j)}},[u,h,e,t,n,r,i,s]),!e||e.length===0?null:o.jsx("g",{className:"blob-edit-handles",children:e.map((_,j)=>{const E=_.x*t,T=_.y*n,M=E+_.handleIn.x*t,J=T+_.handleIn.y*n,P=E+_.handleOut.x*t,q=T+_.handleOut.y*n,k=(u==null?void 0:u.type)==="point"&&(u==null?void 0:u.index)===j,z=(u==null?void 0:u.type)==="handle"&&(u==null?void 0:u.index)===j&&(u==null?void 0:u.handleType)==="handleIn",he=(u==null?void 0:u.type)==="handle"&&(u==null?void 0:u.index)===j&&(u==null?void 0:u.handleType)==="handleOut",Z=l===j;return o.jsxs("g",{className:"blob-control-point-group",children:[a&&o.jsxs(o.Fragment,{children:[o.jsx("line",{x1:E,y1:T,x2:M,y2:J,stroke:"#94a3b8",strokeWidth:"20",strokeDasharray:"60 40",pointerEvents:"none",opacity:"0.8"}),o.jsx("line",{x1:E,y1:T,x2:P,y2:q,stroke:"#94a3b8",strokeWidth:"20",strokeDasharray:"60 40",pointerEvents:"none",opacity:"0.8"}),o.jsx("circle",{cx:M,cy:J,r:v,fill:z?"#f97316":"#ffffff",stroke:"#64748b",strokeWidth:"15",style:{cursor:"crosshair"},pointerEvents:"all",onMouseDown:K=>C(K,j,"handleIn")}),o.jsx("circle",{cx:P,cy:q,r:v,fill:he?"#f97316":"#ffffff",stroke:"#64748b",strokeWidth:"15",style:{cursor:"crosshair"},pointerEvents:"all",onMouseDown:K=>C(K,j,"handleOut")})]}),o.jsx("circle",{cx:E,cy:T,r:y,fill:Z?"#ef4444":k?"#f97316":"#3b82f6",stroke:"#ffffff",strokeWidth:"20",style:{cursor:"move"},pointerEvents:"all",onMouseDown:K=>b(K,j),onContextMenu:K=>w(K,j)}),o.jsx("text",{x:E,y:T+y*.35,textAnchor:"middle",fontSize:y*.8,fill:"#ffffff",fontWeight:"bold",pointerEvents:"none",children:j+1})]},j)})})}function _E({shape:e,isSelected:t,onMouseDown:n,onTouchStart:r,onDoubleClick:i,onScaleStart:s,onRotateStart:a,onPointDrag:l,onHandleDrag:c,onDragEnd:d,selectedPointIndex:u,onPointSelect:p,onPointDelete:h}){const{controlPoints:f,width_mm:m,height_mm:g,position:x,rotation:y,fillColor:v,strokeEnabled:b,strokeColor:w,strokeWidth_mm:C,editPointsVisible:_}=e,j=R.useMemo(()=>AC(f,m,g),[f,m,g]),E=m/2,T=g/2,M=`translate(${x.x}, ${x.y}) rotate(${y||0}, ${E}, ${T})`;return o.jsxs("g",{className:`blob-element ${t?"blob-element--selected":""}`,transform:M,style:{cursor:"move"},children:[o.jsx("path",{d:j,fill:(v==null?void 0:v.hex)||"#609B63",stroke:b&&w?w.hex:"none",strokeWidth:b?C:0,pointerEvents:"none"}),o.jsx("path",{d:j,fill:"transparent",stroke:"transparent",strokeWidth:Math.max(C||0,100),pointerEvents:"all",onTouchStart:r,onMouseDown:n,onDoubleClick:i,style:{cursor:"move"}}),t&&o.jsx("rect",{x:"-10",y:"-10",width:m+20,height:g+20,fill:"none",stroke:"#3b82f6",strokeWidth:"80",strokeDasharray:"400 400",opacity:"0.7",pointerEvents:"none"}),t&&o.jsx(SE,{width:m,height:g,onScaleStart:s,onRotateStart:a}),t&&f&&_&&o.jsx(Gw,{controlPoints:f,width:m,height:g,onPointDrag:l,onHandleDrag:c,onDragEnd:d,showHandles:!0,selectedPointIndex:u,onPointSelect:p,onPointDelete:h})]})}function SE({width:e,height:t,onScaleStart:n,onRotateStart:r}){const i=Math.min(e,t)*.08,l=Math.max(150,Math.min(400,i)),c=[{x:-l/2,y:-l/2,corner:"nw",cursor:"nwse-resize"},{x:e-l/2,y:-l/2,corner:"ne",cursor:"nesw-resize"},{x:-l/2,y:t-l/2,corner:"sw",cursor:"nesw-resize"},{x:e-l/2,y:t-l/2,corner:"se",cursor:"nwse-resize"}],d=l*2.5,u=l*.8;return o.jsxs("g",{className:"blob-resize-handles",children:[c.map(p=>o.jsx("rect",{x:p.x,y:p.y,width:l,height:l,fill:"#3b82f6",stroke:"#fff",strokeWidth:"20",rx:l/4,style:{cursor:p.cursor},pointerEvents:"all",onMouseDown:h=>{h.stopPropagation(),n==null||n(h,p.corner)},onTouchStart:h=>{h.stopPropagation(),n==null||n(h,p.corner)}},p.corner)),o.jsx("line",{x1:e/2,y1:0,x2:e/2,y2:-d+u/2,stroke:"#3b82f6",strokeWidth:"30",pointerEvents:"none"}),o.jsx("circle",{cx:e/2,cy:-d,r:u,fill:"#3b82f6",stroke:"#fff",strokeWidth:"20",style:{cursor:"grab"},pointerEvents:"all",onMouseDown:p=>{p.stopPropagation(),r==null||r(p)},onTouchStart:p=>{p.stopPropagation(),r==null||r(p)}}),o.jsx("path",{d:`M ${e/2-u*.4} ${-d}
            A ${u*.4} ${u*.4} 0 1 1
            ${e/2+u*.4} ${-d}`,fill:"none",stroke:"#fff",strokeWidth:"25",strokeLinecap:"round",pointerEvents:"none"}),o.jsx("polygon",{points:`${e/2+u*.4},${-d-u*.25}
                 ${e/2+u*.4},${-d+u*.25}
                 ${e/2+u*.65},${-d}`,fill:"#fff",pointerEvents:"none"})]})}function kE({shape:e,isSelected:t,onMouseDown:n,onTouchStart:r,onDoubleClick:i,onScaleStart:s,onRotateStart:a,onPointDrag:l,onHandleDrag:c,onDragEnd:d,selectedPointIndex:u,onPointSelect:p,onPointDelete:h}){const{controlPoints:f,width_mm:m,height_mm:g,position:x,rotation:y,fillColor:v,strokeEnabled:b,strokeColor:w,strokeWidth_mm:C,editPointsVisible:_,closed:j,smooth:E}=e,T=R.useMemo(()=>!f||f.length<2?"":zw(f,m,g,j,E),[f,m,g,j,E]),M=m/2,J=g/2,P=`translate(${x.x}, ${x.y}) rotate(${y||0}, ${M}, ${J})`;return T?o.jsxs("g",{className:`path-element ${t?"path-element--selected":""}`,transform:P,style:{cursor:"move"},children:[o.jsx("path",{d:T,fill:j?(v==null?void 0:v.hex)||"#609B63":"none",stroke:b&&w?w.hex:j?"none":(v==null?void 0:v.hex)||"#609B63",strokeWidth:b?C:j?0:50,strokeLinecap:"round",strokeLinejoin:"round",pointerEvents:"none"}),o.jsx("path",{d:T,fill:"transparent",stroke:"transparent",strokeWidth:Math.max(C||0,200),pointerEvents:"all",onTouchStart:r,onMouseDown:n,onDoubleClick:i,style:{cursor:"move"}}),t&&o.jsx("rect",{x:"-10",y:"-10",width:m+20,height:g+20,fill:"none",stroke:"#3b82f6",strokeWidth:"80",strokeDasharray:"400 400",opacity:"0.7",pointerEvents:"none"}),t&&o.jsx(jE,{width:m,height:g,onScaleStart:s,onRotateStart:a}),t&&f&&_&&o.jsx(Gw,{controlPoints:f,width:m,height:g,onPointDrag:l,onHandleDrag:c,onDragEnd:d,showHandles:E,selectedPointIndex:u,onPointSelect:p,onPointDelete:h})]}):null}function jE({width:e,height:t,onScaleStart:n,onRotateStart:r}){const i=Math.min(e,t)*.08,l=Math.max(150,Math.min(400,i)),c=[{x:-l/2,y:-l/2,corner:"nw",cursor:"nwse-resize"},{x:e-l/2,y:-l/2,corner:"ne",cursor:"nesw-resize"},{x:-l/2,y:t-l/2,corner:"sw",cursor:"nesw-resize"},{x:e-l/2,y:t-l/2,corner:"se",cursor:"nwse-resize"}],d=l*2.5,u=l*.8;return o.jsxs("g",{className:"path-resize-handles",children:[c.map(p=>o.jsx("rect",{x:p.x,y:p.y,width:l,height:l,fill:"#3b82f6",stroke:"#fff",strokeWidth:"20",rx:l/4,style:{cursor:p.cursor},pointerEvents:"all",onMouseDown:h=>{h.stopPropagation(),n==null||n(h,p.corner)},onTouchStart:h=>{h.stopPropagation(),n==null||n(h,p.corner)}},p.corner)),o.jsx("line",{x1:e/2,y1:0,x2:e/2,y2:-d+u/2,stroke:"#3b82f6",strokeWidth:"30",pointerEvents:"none"}),o.jsx("circle",{cx:e/2,cy:-d,r:u,fill:"#3b82f6",stroke:"#fff",strokeWidth:"20",style:{cursor:"grab"},pointerEvents:"all",onMouseDown:p=>{p.stopPropagation(),r==null||r(p)},onTouchStart:p=>{p.stopPropagation(),r==null||r(p)}}),o.jsx("path",{d:`M ${e/2-u*.4} ${-d}
            A ${u*.4} ${u*.4} 0 1 1
            ${e/2+u*.4} ${-d}`,fill:"none",stroke:"#fff",strokeWidth:"25",strokeLinecap:"round",pointerEvents:"none"}),o.jsx("polygon",{points:`${e/2+u*.4},${-d-u*.25}
                 ${e/2+u*.4},${-d+u*.25}
                 ${e/2+u*.65},${-d}`,fill:"#fff",pointerEvents:"none"})]})}function Ai(e,t,n,r="normal",i="normal"){Ai._canvas||(Ai._canvas=document.createElement("canvas"),Ai._ctx=Ai._canvas.getContext("2d"));const s=Ai._ctx,a=i==="italic"?"italic ":"",l=r==="bold"?"bold ":"";s.font=`${a}${l}${n}px ${t}`;const c=s.measureText(e||"Double-click to edit");return{width:Math.max(c.width,100),height:n*1.2}}function CE(){return[{name:"Open Sans",family:"Open Sans, sans-serif"},{name:"Roboto",family:"Roboto, sans-serif"},{name:"Montserrat",family:"Montserrat, sans-serif"},{name:"Oswald",family:"Oswald, sans-serif"},{name:"Black Ops One",family:"Black Ops One, sans-serif"},{name:"Playfair Display",family:"Playfair Display, serif"},{name:"Arial",family:"Arial, sans-serif"},{name:"Georgia",family:"Georgia, serif"},{name:"Impact",family:"Impact, sans-serif"}]}function EE({text:e,isSelected:t,isEditing:n,onMouseDown:r,onTouchStart:i,onDoubleClick:s,onScaleStart:a,onRotateStart:l,onContentChange:c,onEditComplete:d}){const u=R.useRef(null),{content:p,fontFamily:h,fontSize_mm:f,fontWeight:m,fontStyle:g,textAlign:x,position:y,rotation:v,fillColor:b,strokeColor:w,strokeWidth_mm:C}=e,_=R.useMemo(()=>Ai(p,h,f,m,g),[p,h,f,m,g]),j=R.useMemo(()=>{switch(x){case"center":return-_.width/2;case"right":return-_.width;default:return 0}},[x,_.width]),E=`translate(${y.x}, ${y.y}) rotate(${v||0})`;R.useEffect(()=>{n&&u.current&&(u.current.focus(),u.current.select())},[n]);const T=J=>{(J.key==="Enter"||J.key==="Escape")&&(J.preventDefault(),d==null||d())},M=p||"Double-click to edit";return o.jsxs("g",{className:`text-element ${t?"text-element--selected":""} ${n?"text-element--editing":""}`,transform:E,children:[n?o.jsx("foreignObject",{x:j-10,y:-f*.85,width:Math.max(_.width+200,500),height:f*1.5,style:{overflow:"visible"},children:o.jsx("input",{ref:u,type:"text",value:p,onChange:J=>c==null?void 0:c(J.target.value),onBlur:d,onKeyDown:T,style:{fontFamily:h,fontSize:`${f}px`,fontWeight:m,fontStyle:g,color:(b==null?void 0:b.hex)||"#1C1C1C",background:"rgba(255,255,255,0.95)",border:"4px solid #3b82f6",borderRadius:"4px",outline:"none",padding:"4px 8px",width:"100%",boxSizing:"border-box",lineHeight:1}})}):o.jsxs(o.Fragment,{children:[o.jsx("text",{x:"0",y:"0",fontFamily:h,fontSize:f,fontWeight:m,fontStyle:g,textAnchor:x==="center"?"middle":x==="right"?"end":"start",fill:(b==null?void 0:b.hex)||"#1C1C1C",stroke:(w==null?void 0:w.hex)||"none",strokeWidth:C||0,strokeLinejoin:"round",strokeLinecap:"round",paintOrder:"stroke fill",style:{cursor:"move",userSelect:"none"},pointerEvents:"none",children:M}),o.jsx("rect",{x:j-20,y:-f*.85,width:_.width+40,height:f*1.2,fill:"transparent",onMouseDown:r,onTouchStart:i,onDoubleClick:s,style:{cursor:"move"}})]}),t&&!n&&o.jsx("rect",{x:j-40,y:-f-40,width:_.width+80,height:f*1.2+80,fill:"none",stroke:"#3b82f6",strokeWidth:"60",strokeDasharray:"300 300",opacity:"0.7",pointerEvents:"none"}),t&&!n&&o.jsx(TE,{bounds:_,fontSize:f,alignOffset:j,onScaleStart:a,onRotateStart:l})]})}function TE({bounds:e,fontSize:t,alignOffset:n,onScaleStart:r,onRotateStart:i}){const s=Math.min(e.width,t)*.15,c=Math.max(100,Math.min(300,s)),d=n-20,u=-t-20,p=e.width+40,h=t*1.2+40,f=[{x:d-c/2,y:u-c/2,corner:"nw",cursor:"nwse-resize"},{x:d+p-c/2,y:u-c/2,corner:"ne",cursor:"nesw-resize"},{x:d-c/2,y:u+h-c/2,corner:"sw",cursor:"nesw-resize"},{x:d+p-c/2,y:u+h-c/2,corner:"se",cursor:"nwse-resize"}],m=c*2.5,g=c*.8,x=d+p/2;return o.jsxs("g",{className:"text-handles",children:[f.map(y=>o.jsx("rect",{x:y.x,y:y.y,width:c,height:c,fill:"#3b82f6",stroke:"#fff",strokeWidth:"15",rx:c/4,style:{cursor:y.cursor},pointerEvents:"all",onMouseDown:v=>{v.stopPropagation(),r==null||r(v,y.corner)},onTouchStart:v=>{v.stopPropagation(),r==null||r(v,y.corner)}},y.corner)),o.jsx("line",{x1:x,y1:u,x2:x,y2:u-m+g/2,stroke:"#3b82f6",strokeWidth:"25",pointerEvents:"none"}),o.jsx("circle",{cx:x,cy:u-m,r:g,fill:"#3b82f6",stroke:"#fff",strokeWidth:"15",style:{cursor:"grab"},pointerEvents:"all",onMouseDown:y=>{y.stopPropagation(),i==null||i(y)},onTouchStart:y=>{y.stopPropagation(),i==null||i(y)}}),o.jsx("path",{d:`M ${x-g*.4} ${u-m}
            A ${g*.4} ${g*.4} 0 1 1
            ${x+g*.4} ${u-m}`,fill:"none",stroke:"#fff",strokeWidth:"20",strokeLinecap:"round",pointerEvents:"none"}),o.jsx("polygon",{points:`${x+g*.4},${u-m-g*.25}
                 ${x+g*.4},${u-m+g*.25}
                 ${x+g*.65},${u-m}`,fill:"#fff",pointerEvents:"none"})]})}function NE({zone:e,isSelected:t,onMouseDown:n,onTouchStart:r,onDoubleClick:i,onScaleStart:s,onRotateStart:a}){const{id:l,shapeType:c,sides:d,width_mm:u,height_mm:p,cornerRadius:h,position:f,rotation:m,controlPoints:g}=e,x=`exclusion-crosshatch-${l}`,y=R.useMemo(()=>c==="path"&&g?zw(g,u,p,!0):Ww(d||4,u,p,h||0),[c,d,u,p,h,g]),v=u/2,b=p/2,w=`translate(${f.x}, ${f.y}) rotate(${m||0}, ${v}, ${b})`,C=Math.min(u,p)*.02,E=Math.max(100,Math.min(500,C)),T=E*.15;return o.jsxs("g",{className:`exclusion-zone-element ${t?"exclusion-zone-element--selected":""}`,transform:w,style:{cursor:"move"},children:[o.jsx("defs",{children:o.jsxs("pattern",{id:x,patternUnits:"userSpaceOnUse",width:E,height:E,patternTransform:"rotate(45)",children:[o.jsx("rect",{width:E,height:E,fill:"#e5e5e5"}),o.jsx("line",{x1:"0",y1:"0",x2:"0",y2:E,stroke:"#999",strokeWidth:T}),o.jsx("line",{x1:E/2,y1:"0",x2:E/2,y2:E,stroke:"#999",strokeWidth:T})]})}),o.jsx("path",{d:y,fill:`url(#${x})`,stroke:"#666",strokeWidth:"60",strokeDasharray:"200 100",pointerEvents:"none"}),o.jsx("path",{d:y,fill:"transparent",stroke:"transparent",strokeWidth:"200",pointerEvents:"all",onMouseDown:n,onTouchStart:r,onDoubleClick:i,style:{cursor:"move"}}),t&&o.jsx("rect",{x:"-10",y:"-10",width:u+20,height:p+20,fill:"none",stroke:"#ef4444",strokeWidth:"80",strokeDasharray:"400 400",opacity:"0.7",pointerEvents:"none"}),t&&o.jsx(PE,{width:u,height:p,onScaleStart:s,onRotateStart:a})]})}function PE({width:e,height:t,onScaleStart:n,onRotateStart:r}){const i=Math.min(e,t)*.08,l=Math.max(150,Math.min(400,i)),c=[{x:e/2-l/2,y:-l/2,corner:"n",cursor:"ns-resize"},{x:e/2-l/2,y:t-l/2,corner:"s",cursor:"ns-resize"},{x:e-l/2,y:t/2-l/2,corner:"e",cursor:"ew-resize"},{x:-l/2,y:t/2-l/2,corner:"w",cursor:"ew-resize"}],d=l*2.5,u=l*.8;return o.jsxs("g",{className:"exclusion-zone-handles",children:[c.map(p=>o.jsx("rect",{x:p.x,y:p.y,width:l,height:l,fill:"#ef4444",stroke:"#fff",strokeWidth:"20",rx:l/4,style:{cursor:p.cursor},pointerEvents:"all",onMouseDown:h=>{h.stopPropagation(),n==null||n(h,p.corner)},onTouchStart:h=>{h.stopPropagation(),n==null||n(h,p.corner)}},p.corner)),o.jsx("line",{x1:e/2,y1:0,x2:e/2,y2:-d+u/2,stroke:"#ef4444",strokeWidth:"30",pointerEvents:"none"}),o.jsx("circle",{cx:e/2,cy:-d,r:u,fill:"#ef4444",stroke:"#fff",strokeWidth:"20",style:{cursor:"grab"},pointerEvents:"all",onMouseDown:p=>{p.stopPropagation(),r==null||r(p)},onTouchStart:p=>{p.stopPropagation(),r==null||r(p)}}),o.jsx("path",{d:`M ${e/2-u*.4} ${-d}
            A ${u*.4} ${u*.4} 0 1 1
            ${e/2+u*.4} ${-d}`,fill:"none",stroke:"#fff",strokeWidth:"25",strokeLinecap:"round",pointerEvents:"none"}),o.jsx("polygon",{points:`${e/2+u*.4},${-d-u*.25}
                 ${e/2+u*.4},${-d+u*.25}
                 ${e/2+u*.65},${-d}`,fill:"#fff",pointerEvents:"none"})]})}function S0(e,t,n){if(!e||e.type==="rectangle"||!e.controlPoints)return null;const r=e.controlPoints;if(!r||r.length<3)return null;const i=r.map(a=>({x:a.x*t,y:a.y*n}));let s=`M ${i[0].x} ${i[0].y}`;for(let a=1;a<i.length;a++)s+=` L ${i[a].x} ${i[a].y}`;return s+=" Z",s}const RE=R.forwardRef(function(t,n){var _m,Sm;const r=R.useRef(null),i=R.useRef(null);R.useImperativeHandle(n,()=>r.current);const[s,a]=R.useState(1),[l,c]=R.useState({x:0,y:0}),[d,u]=R.useState(!1),[p,h]=R.useState({x:0,y:0}),[f,m]=R.useState(!1),[g,x]=R.useState({active:!1,initialDistance:0,initialZoom:1,initialPan:{x:0,y:0},initialCenter:{x:0,y:0}}),[y,v]=R.useState(!1),[b,w]=R.useState(null),[C,_]=R.useState(null),[j,E]=R.useState(null),[T,M]=R.useState(null),[J,P]=R.useState(null),[q,k]=R.useState(null),[z,he]=R.useState(null),[Z,K]=R.useState(!1),[H,X]=R.useState(null),[F,W]=R.useState(null),[re,se]=R.useState(!1),[me,ke]=R.useState(null),[pe,Pe]=R.useState(null),[Re,Ge]=R.useState(!1),[$e,we]=R.useState(null),[xe,S]=R.useState(null),[ue,ce]=R.useState(!1),[I,N]=R.useState(null),[B,oe]=R.useState(null),[de,G]=R.useState(!1),[te,ge]=R.useState(null),[V,$]=R.useState(null),[D,ae]=R.useState(!1),[Se,le]=R.useState(null),[ie,je]=R.useState(null),[Y,ne]=R.useState(!1),[Ie,Ke]=R.useState(null),[Je,De]=R.useState(null),[Ye,at]=R.useState(!1),[ht,et]=R.useState(null),[dt,nn]=R.useState(null),[Pr,qr]=R.useState(null),[gi,vi]=R.useState(0),[wt,Wt]=R.useState(null),{surface:lt,courts:nr,tracks:rr,motifs:Tn,shapes:Yt,texts:Nn,exclusionZones:Nt,elementOrder:rn,selectedCourtId:gt,selectedTrackId:Rr,selectedMotifId:ft,selectedShapeId:sn,selectedTextId:pt,selectedExclusionZoneId:zn,editingTextId:Pt,snapToGrid:$t,gridSize_mm:_t,selectCourt:St,deselectCourt:on,selectTrack:vt,deselectTrack:Fn,selectMotif:Yr,deselectMotif:ir,selectShape:yi,deselectShape:Xr,selectText:Bn,deselectText:Or,selectExclusionZone:Zr,deselectExclusionZone:Fs,startEditingText:Bs,stopEditingText:oa,updateCourtPosition:xi,updateTrackPosition:Ar,updateMotifPosition:Hn,updateMotifScale:Pn,updateMotifRotation:es,updateShapePosition:Kr,updateShapeDimensions:ts,updateShapeRotation:bi,updateTextPosition:Jr,updateTextFontSize:Qr,updateTextRotation:Mr,updateTextContent:Un,updateExclusionZonePosition:Rn,updateExclusionZoneDimensions:wi,updateExclusionZoneRotation:ei,updateBlobControlPoint:ns,updateBlobHandle:_i,commitBlobEdit:Si,pathDrawingMode:wn,activePathId:hn,addPointToPath:aa,finishPath:rs,cancelPath:kt,updatePathControlPoint:$r,updatePathHandle:la,commitPathEdit:Hs,removePointFromPath:Lr}=st(),yt=(O,ee)=>{const A=r.current,fe=A.createSVGPoint();fe.x=O,fe.y=ee;const Be=fe.matrixTransform(A.getScreenCTM().inverse());return{x:Be.x,y:Be.y}},is=(O,ee)=>{O.stopPropagation(),St(ee);const A=nr[ee];if(A!=null&&A.locked)return;const fe=O.touches?O.touches[0].clientX:O.clientX,Be=O.touches?O.touches[0].clientY:O.clientY,Me=yt(fe,Be);w({x:Me.x-A.position.x,y:Me.y-A.position.y}),_(ee),v(!0)},ca=(O,ee)=>{O.stopPropagation(),St(ee),st.setState({showPropertiesPanel:!0,propertiesPanelUserClosed:!1})},Gt=(O,ee)=>{O.stopPropagation(),vt(ee);const A=rr[ee];if(A!=null&&A.locked)return;const fe=O.touches?O.touches[0].clientX:O.clientX,Be=O.touches?O.touches[0].clientY:O.clientY,Me=yt(fe,Be);w({x:Me.x-A.position.x,y:Me.y-A.position.y}),E(ee),v(!0)},_n=(O,ee)=>{O.stopPropagation(),vt(ee),st.setState({showPropertiesPanel:!0,propertiesPanelUserClosed:!1})},ss=(O,ee)=>{O.stopPropagation(),Yr(ee);const A=Tn[ee];if(A!=null&&A.locked)return;const fe=O.touches?O.touches[0].clientX:O.clientX,Be=O.touches?O.touches[0].clientY:O.clientY,Me=yt(fe,Be);w({x:Me.x-A.position.x,y:Me.y-A.position.y}),M(ee),v(!0)},os=(O,ee)=>{O.stopPropagation(),Yr(ee),st.setState({showPropertiesPanel:!0,propertiesPanelUserClosed:!1})},ki=(O,ee,A)=>{O.stopPropagation();const fe=Tn[ee];if(!fe||fe.locked)return;const Be=O.touches?O.touches[0].clientX:O.clientX,Me=O.touches?O.touches[0].clientY:O.clientY,Ve=yt(Be,Me),ze=fe.originalWidth_mm*(fe.scale||1),Ne=fe.originalHeight_mm*(fe.scale||1);let Ae;switch(A){case"nw":Ae={x:fe.position.x+ze,y:fe.position.y+Ne};break;case"ne":Ae={x:fe.position.x,y:fe.position.y+Ne};break;case"sw":Ae={x:fe.position.x+ze,y:fe.position.y};break;case"se":default:Ae={x:fe.position.x,y:fe.position.y};break}const ot=Math.sqrt(Math.pow(Ve.x-Ae.x,2)+Math.pow(Ve.y-Ae.y,2));W({initialDistance:ot,originalScale:fe.scale||1,originalWidth:ze,originalHeight:Ne,corner:A,anchorPoint:Ae}),X(ee),K(!0)},Q=(O,ee)=>{O.stopPropagation();const A=Tn[ee];if(!A||A.locked)return;const fe=O.touches?O.touches[0].clientX:O.clientX,Be=O.touches?O.touches[0].clientY:O.clientY,Me=yt(fe,Be),Ve=A.originalWidth_mm*(A.scale||1),ze=A.originalHeight_mm*(A.scale||1),Ne={x:A.position.x+Ve/2,y:A.position.y+ze/2},Ae=Math.atan2(Me.y-Ne.y,Me.x-Ne.x)*(180/Math.PI);Pe({initialAngle:Ae,originalRotation:A.rotation||0,motifCenter:Ne}),ke(ee),se(!0)},ve=(O,ee)=>{O.stopPropagation(),yi(ee);const A=Yt[ee];if(A!=null&&A.locked)return;const fe=O.touches?O.touches[0].clientX:O.clientX,Be=O.touches?O.touches[0].clientY:O.clientY,Me=yt(fe,Be);w({x:Me.x-A.position.x,y:Me.y-A.position.y}),P(ee),v(!0)},be=(O,ee)=>{O.stopPropagation(),yi(ee),st.setState({showPropertiesPanel:!0,propertiesPanelUserClosed:!1})},Ce=(O,ee,A)=>{O.stopPropagation();const fe=Yt[ee];if(!fe||fe.locked)return;const Be=O.touches?O.touches[0].clientX:O.clientX,Me=O.touches?O.touches[0].clientY:O.clientY,Ve=yt(Be,Me),{width_mm:ze,height_mm:Ne}=fe;let Ae;switch(A){case"n":Ae={x:fe.position.x+ze/2,y:fe.position.y+Ne};break;case"s":Ae={x:fe.position.x+ze/2,y:fe.position.y};break;case"e":Ae={x:fe.position.x,y:fe.position.y+Ne/2};break;case"w":Ae={x:fe.position.x+ze,y:fe.position.y+Ne/2};break;case"nw":Ae={x:fe.position.x+ze,y:fe.position.y+Ne};break;case"ne":Ae={x:fe.position.x,y:fe.position.y+Ne};break;case"sw":Ae={x:fe.position.x+ze,y:fe.position.y};break;case"se":default:Ae={x:fe.position.x,y:fe.position.y};break}const ot=Math.sqrt(Math.pow(Ve.x-Ae.x,2)+Math.pow(Ve.y-Ae.y,2));S({initialDistance:ot,originalWidth:ze,originalHeight:Ne,aspectLocked:fe.aspectLocked,corner:A,anchorPoint:Ae}),we(ee),Ge(!0)},Qe=(O,ee)=>{O.stopPropagation();const A=Yt[ee];if(!A||A.locked)return;const fe=O.touches?O.touches[0].clientX:O.clientX,Be=O.touches?O.touches[0].clientY:O.clientY,Me=yt(fe,Be),{width_mm:Ve,height_mm:ze}=A,Ne={x:A.position.x+Ve/2,y:A.position.y+ze/2},Ae=Math.atan2(Me.y-Ne.y,Me.x-Ne.x)*(180/Math.PI);oe({initialAngle:Ae,originalRotation:A.rotation||0,shapeCenter:Ne}),N(ee),ce(!0)},He=(O,ee)=>{if(O.stopPropagation(),Pt===ee)return;Bn(ee);const A=Nn[ee];if(A!=null&&A.locked)return;const fe=O.touches?O.touches[0].clientX:O.clientX,Be=O.touches?O.touches[0].clientY:O.clientY,Me=yt(fe,Be);w({x:Me.x-A.position.x,y:Me.y-A.position.y}),k(ee),v(!0)},Le=(O,ee)=>{O.stopPropagation(),Bn(ee),Bs(ee)},_e=(O,ee,A)=>{O.stopPropagation();const fe=Nn[ee];if(!fe||fe.locked)return;const Be=O.touches?O.touches[0].clientX:O.clientX,Me=O.touches?O.touches[0].clientY:O.clientY,Ve=yt(Be,Me),ze=Ai(fe.content,fe.fontFamily,fe.fontSize_mm,fe.fontWeight,fe.fontStyle);let Ne=fe.position.x;fe.textAlign==="center"?Ne-=ze.width/2:fe.textAlign==="right"&&(Ne-=ze.width);const Ae=fe.position.y-fe.fontSize_mm;let ot;switch(A){case"nw":ot={x:Ne+ze.width,y:Ae+fe.fontSize_mm*1.2};break;case"ne":ot={x:Ne,y:Ae+fe.fontSize_mm*1.2};break;case"sw":ot={x:Ne+ze.width,y:Ae};break;case"se":default:ot={x:Ne,y:Ae};break}const bt=Math.sqrt(Math.pow(Ve.x-ot.x,2)+Math.pow(Ve.y-ot.y,2));$({initialDistance:bt,originalFontSize:fe.fontSize_mm,originalPosition:{...fe.position},originalBounds:ze,textAlign:fe.textAlign,corner:A,anchorPoint:ot}),ge(ee),G(!0)},U=(O,ee)=>{O.stopPropagation();const A=Nn[ee];if(!A||A.locked)return;const fe=O.touches?O.touches[0].clientX:O.clientX,Be=O.touches?O.touches[0].clientY:O.clientY,Me=yt(fe,Be),Ve=Ai(A.content,A.fontFamily,A.fontSize_mm,A.fontWeight,A.fontStyle);let ze=A.position.x;A.textAlign==="center"?ze=A.position.x:A.textAlign==="right"?ze=A.position.x-Ve.width/2:ze=A.position.x+Ve.width/2;const Ne={x:ze,y:A.position.y-A.fontSize_mm*.4},Ae=Math.atan2(Me.y-Ne.y,Me.x-Ne.x)*(180/Math.PI);je({initialAngle:Ae,originalRotation:A.rotation||0,textCenter:Ne}),le(ee),ae(!0)},ye=(O,ee)=>{O.stopPropagation(),Zr(ee);const A=Nt[ee];if(A!=null&&A.locked)return;const fe=O.touches?O.touches[0].clientX:O.clientX,Be=O.touches?O.touches[0].clientY:O.clientY,Me=yt(fe,Be);w({x:Me.x-A.position.x,y:Me.y-A.position.y}),he(ee),v(!0)},Te=(O,ee)=>{O.stopPropagation(),Zr(ee),st.setState({showPropertiesPanel:!0,propertiesPanelUserClosed:!1})},nt=(O,ee,A)=>{O.stopPropagation();const fe=Nt[ee];if(!fe||fe.locked)return;const Be=O.touches?O.touches[0].clientX:O.clientX,Me=O.touches?O.touches[0].clientY:O.clientY,Ve=yt(Be,Me),{width_mm:ze,height_mm:Ne}=fe;let Ae;switch(A){case"n":Ae={x:fe.position.x+ze/2,y:fe.position.y+Ne};break;case"s":Ae={x:fe.position.x+ze/2,y:fe.position.y};break;case"e":Ae={x:fe.position.x,y:fe.position.y+Ne/2};break;case"w":Ae={x:fe.position.x+ze,y:fe.position.y+Ne/2};break;default:Ae={x:fe.position.x,y:fe.position.y};break}const ot=Math.sqrt(Math.pow(Ve.x-Ae.x,2)+Math.pow(Ve.y-Ae.y,2));De({initialDistance:ot,originalWidth:ze,originalHeight:Ne,corner:A,anchorPoint:Ae}),Ke(ee),ne(!0)},it=(O,ee)=>{O.stopPropagation();const A=Nt[ee];if(!A||A.locked)return;const fe=O.touches?O.touches[0].clientX:O.clientX,Be=O.touches?O.touches[0].clientY:O.clientY,Me=yt(fe,Be),{width_mm:Ve,height_mm:ze}=A,Ne={x:A.position.x+Ve/2,y:A.position.y+ze/2},Ae=Math.atan2(Me.y-Ne.y,Me.x-Ne.x)*(180/Math.PI);nn({initialAngle:Ae,originalRotation:A.rotation||0,zoneCenter:Ne}),et(ee),at(!0)};R.useEffect(()=>{v(!1),_(null),E(null),M(null),P(null),k(null),he(null),w(null)},[lt.width_mm,lt.length_mm]),R.useEffect(()=>{if(!y||!C&&!j&&!T&&!J&&!q&&!z)return;const O=A=>{const fe=A.touches?A.touches[0].clientX:A.clientX,Be=A.touches?A.touches[0].clientY:A.clientY,Me=yt(fe,Be);let Ve={x:Me.x-b.x,y:Me.y-b.y};if($t&&(Ve=eE(Ve,_t)),C){const ze=nr[C],Ne={width_mm:ze.template.dimensions.width_mm*ze.scale,length_mm:ze.template.dimensions.length_mm*ze.scale};Ve=ac(Ve,Ne,lt),xi(C,Ve)}else if(j)Ar(j,Ve);else if(T){const ze=Tn[T],Ne={width_mm:ze.originalWidth_mm*(ze.scale||1),length_mm:ze.originalHeight_mm*(ze.scale||1)};Ve=ac(Ve,Ne,lt),Hn(T,Ve)}else if(J){const ze=Yt[J],Ne={width_mm:ze.width_mm,length_mm:ze.height_mm};Ve=ac(Ve,Ne,lt),Kr(J,Ve)}else if(q)Jr(q,Ve);else if(z){const ze=Nt[z],Ne={width_mm:ze.width_mm,length_mm:ze.height_mm};Ve=ac(Ve,Ne,lt),Rn(z,Ve)}},ee=()=>{if(C||j||T||J||q||z){const{addToHistory:A}=st.getState();A()}v(!1),_(null),E(null),M(null),P(null),k(null),he(null),w(null)};return window.addEventListener("mousemove",O),window.addEventListener("mouseup",ee),window.addEventListener("touchmove",O,{passive:!1}),window.addEventListener("touchend",ee),window.addEventListener("touchcancel",ee),()=>{window.removeEventListener("mousemove",O),window.removeEventListener("mouseup",ee),window.removeEventListener("touchmove",O),window.removeEventListener("touchend",ee),window.removeEventListener("touchcancel",ee)}},[y,C,j,T,J,q,z,b,nr,rr,Tn,Yt,Nn,Nt,$t,_t,lt,xi,Ar,Hn,Kr,Jr,Rn]),R.useEffect(()=>{if(!Z||!H||!F)return;const O=A=>{const fe=A.touches?A.touches[0].clientX:A.clientX,Be=A.touches?A.touches[0].clientY:A.clientY,Me=yt(fe,Be),Ve=Tn[H];if(!Ve)return;const Ne=Math.sqrt(Math.pow(Me.x-F.anchorPoint.x,2)+Math.pow(Me.y-F.anchorPoint.y,2))/F.initialDistance;let Ae=F.originalScale*Ne;Ae=Math.max(.1,Ae),Ae=Math.round(Ae*100)/100;const ot=Ve.originalWidth_mm*Ae,bt=Ve.originalHeight_mm*Ae;let mn;switch(F.corner){case"nw":mn={x:F.anchorPoint.x-ot,y:F.anchorPoint.y-bt};break;case"ne":mn={x:F.anchorPoint.x,y:F.anchorPoint.y-bt};break;case"sw":mn={x:F.anchorPoint.x-ot,y:F.anchorPoint.y};break;case"se":default:mn={x:F.anchorPoint.x,y:F.anchorPoint.y};break}Pn(H,Ae),Hn(H,mn)},ee=()=>{const{addToHistory:A}=st.getState();A(),K(!1),X(null),W(null)};return window.addEventListener("mousemove",O),window.addEventListener("mouseup",ee),window.addEventListener("touchmove",O,{passive:!1}),window.addEventListener("touchend",ee),window.addEventListener("touchcancel",ee),()=>{window.removeEventListener("mousemove",O),window.removeEventListener("mouseup",ee),window.removeEventListener("touchmove",O),window.removeEventListener("touchend",ee),window.removeEventListener("touchcancel",ee)}},[Z,H,F,Tn,Pn,Hn]),R.useEffect(()=>{if(!re||!me||!pe)return;const O=A=>{const fe=A.touches?A.touches[0].clientX:A.clientX,Be=A.touches?A.touches[0].clientY:A.clientY,Me=yt(fe,Be),ze=Math.atan2(Me.y-pe.motifCenter.y,Me.x-pe.motifCenter.x)*(180/Math.PI)-pe.initialAngle;let Ne=pe.originalRotation+ze;Ne=(Ne%360+360)%360,A.shiftKey&&(Ne=Math.round(Ne/15)*15),Ne=Math.round(Ne*10)/10,es(me,Ne)},ee=()=>{const{addToHistory:A}=st.getState();A(),se(!1),ke(null),Pe(null)};return window.addEventListener("mousemove",O),window.addEventListener("mouseup",ee),window.addEventListener("touchmove",O,{passive:!1}),window.addEventListener("touchend",ee),window.addEventListener("touchcancel",ee),()=>{window.removeEventListener("mousemove",O),window.removeEventListener("mouseup",ee),window.removeEventListener("touchmove",O),window.removeEventListener("touchend",ee),window.removeEventListener("touchcancel",ee)}},[re,me,pe,es]),R.useEffect(()=>{if(!Re||!$e||!xe)return;const O=A=>{const fe=A.touches?A.touches[0].clientX:A.clientX,Be=A.touches?A.touches[0].clientY:A.clientY,Me=yt(fe,Be);if(!Yt[$e])return;const Ne=Math.sqrt(Math.pow(Me.x-xe.anchorPoint.x,2)+Math.pow(Me.y-xe.anchorPoint.y,2))/xe.initialDistance;let Ae,ot;const bt=xe.corner,mn=["n","s","e","w"].includes(bt);if(xe.aspectLocked)Ae=xe.originalWidth*Ne,ot=xe.originalHeight*Ne;else if(mn){const or=Math.abs(Me.y-xe.anchorPoint.y),ua=Math.abs(Me.x-xe.anchorPoint.x);bt==="n"||bt==="s"?(Ae=xe.originalWidth,ot=Math.max(100,or)):(Ae=Math.max(100,ua),ot=xe.originalHeight)}else{const or=Math.abs(Me.x-xe.anchorPoint.x),ua=Math.abs(Me.y-xe.anchorPoint.y);Ae=Math.max(100,or),ot=Math.max(100,ua)}Ae=Math.round(Ae),ot=Math.round(ot);let jt;switch(bt){case"n":jt={x:xe.anchorPoint.x-Ae/2,y:xe.anchorPoint.y-ot};break;case"s":jt={x:xe.anchorPoint.x-Ae/2,y:xe.anchorPoint.y};break;case"e":jt={x:xe.anchorPoint.x,y:xe.anchorPoint.y-ot/2};break;case"w":jt={x:xe.anchorPoint.x-Ae,y:xe.anchorPoint.y-ot/2};break;case"nw":jt={x:xe.anchorPoint.x-Ae,y:xe.anchorPoint.y-ot};break;case"ne":jt={x:xe.anchorPoint.x,y:xe.anchorPoint.y-ot};break;case"sw":jt={x:xe.anchorPoint.x-Ae,y:xe.anchorPoint.y};break;case"se":default:jt={x:xe.anchorPoint.x,y:xe.anchorPoint.y};break}ts($e,Ae,ot),Kr($e,jt)},ee=()=>{const{addToHistory:A}=st.getState();A(),Ge(!1),we(null),S(null)};return window.addEventListener("mousemove",O),window.addEventListener("mouseup",ee),window.addEventListener("touchmove",O,{passive:!1}),window.addEventListener("touchend",ee),window.addEventListener("touchcancel",ee),()=>{window.removeEventListener("mousemove",O),window.removeEventListener("mouseup",ee),window.removeEventListener("touchmove",O),window.removeEventListener("touchend",ee),window.removeEventListener("touchcancel",ee)}},[Re,$e,xe,Yt,ts,Kr]),R.useEffect(()=>{if(!ue||!I||!B)return;const O=A=>{const fe=A.touches?A.touches[0].clientX:A.clientX,Be=A.touches?A.touches[0].clientY:A.clientY,Me=yt(fe,Be),ze=Math.atan2(Me.y-B.shapeCenter.y,Me.x-B.shapeCenter.x)*(180/Math.PI)-B.initialAngle;let Ne=B.originalRotation+ze;Ne=(Ne%360+360)%360,A.shiftKey&&(Ne=Math.round(Ne/15)*15),Ne=Math.round(Ne*10)/10,bi(I,Ne)},ee=()=>{const{addToHistory:A}=st.getState();A(),ce(!1),N(null),oe(null)};return window.addEventListener("mousemove",O),window.addEventListener("mouseup",ee),window.addEventListener("touchmove",O,{passive:!1}),window.addEventListener("touchend",ee),window.addEventListener("touchcancel",ee),()=>{window.removeEventListener("mousemove",O),window.removeEventListener("mouseup",ee),window.removeEventListener("touchmove",O),window.removeEventListener("touchend",ee),window.removeEventListener("touchcancel",ee)}},[ue,I,B,bi]),R.useEffect(()=>{if(!de||!te||!V)return;const O=A=>{const fe=A.touches?A.touches[0].clientX:A.clientX,Be=A.touches?A.touches[0].clientY:A.clientY,Me=yt(fe,Be);if(!Nn[te])return;const Ne=Math.sqrt(Math.pow(Me.x-V.anchorPoint.x,2)+Math.pow(Me.y-V.anchorPoint.y,2))/V.initialDistance;let Ae=V.originalFontSize*Ne;Ae=Math.max(50,Ae),Ae=Math.round(Ae);const ot=Ae/V.originalFontSize,bt=V.originalBounds.width*ot,{corner:mn,anchorPoint:jt,textAlign:or,originalPosition:ua,originalBounds:F7,originalFontSize:B7}=V;let an={...ua};switch(mn){case"nw":or==="left"?an.x=jt.x-bt:or==="center"?an.x=jt.x-bt/2:an.x=jt.x,an.y=jt.y-Ae*.2;break;case"ne":or==="left"?an.x=jt.x:or==="center"?an.x=jt.x+bt/2:an.x=jt.x+bt,an.y=jt.y-Ae*.2;break;case"sw":or==="left"?an.x=jt.x-bt:or==="center"?an.x=jt.x-bt/2:an.x=jt.x,an.y=jt.y+Ae;break;case"se":default:or==="left"?an.x=jt.x:or==="center"?an.x=jt.x+bt/2:an.x=jt.x+bt,an.y=jt.y+Ae;break}Qr(te,Ae),Jr(te,an)},ee=()=>{const{addToHistory:A}=st.getState();A(),G(!1),ge(null),$(null)};return window.addEventListener("mousemove",O),window.addEventListener("mouseup",ee),window.addEventListener("touchmove",O,{passive:!1}),window.addEventListener("touchend",ee),window.addEventListener("touchcancel",ee),()=>{window.removeEventListener("mousemove",O),window.removeEventListener("mouseup",ee),window.removeEventListener("touchmove",O),window.removeEventListener("touchend",ee),window.removeEventListener("touchcancel",ee)}},[de,te,V,Nn,Qr,Jr]),R.useEffect(()=>{if(!D||!Se||!ie)return;const O=A=>{const fe=A.touches?A.touches[0].clientX:A.clientX,Be=A.touches?A.touches[0].clientY:A.clientY,Me=yt(fe,Be),ze=Math.atan2(Me.y-ie.textCenter.y,Me.x-ie.textCenter.x)*(180/Math.PI)-ie.initialAngle;let Ne=ie.originalRotation+ze;Ne=(Ne%360+360)%360,A.shiftKey&&(Ne=Math.round(Ne/15)*15),Ne=Math.round(Ne*10)/10,Mr(Se,Ne)},ee=()=>{const{addToHistory:A}=st.getState();A(),ae(!1),le(null),je(null)};return window.addEventListener("mousemove",O),window.addEventListener("mouseup",ee),window.addEventListener("touchmove",O,{passive:!1}),window.addEventListener("touchend",ee),window.addEventListener("touchcancel",ee),()=>{window.removeEventListener("mousemove",O),window.removeEventListener("mouseup",ee),window.removeEventListener("touchmove",O),window.removeEventListener("touchend",ee),window.removeEventListener("touchcancel",ee)}},[D,Se,ie,Mr]),R.useEffect(()=>{if(!Y||!Ie||!Je)return;const O=A=>{const fe=A.touches?A.touches[0].clientX:A.clientX,Be=A.touches?A.touches[0].clientY:A.clientY,Me=yt(fe,Be);if(!Nt[Ie])return;const ze=Je.corner,Ne=Math.abs(Me.y-Je.anchorPoint.y),Ae=Math.abs(Me.x-Je.anchorPoint.x);let ot,bt;ze==="n"||ze==="s"?(ot=Je.originalWidth,bt=Math.max(500,Ne)):ze==="e"||ze==="w"?(ot=Math.max(500,Ae),bt=Je.originalHeight):(ot=Math.max(500,Ae),bt=Math.max(500,Ne)),ot=Math.round(ot),bt=Math.round(bt);let mn;switch(ze){case"n":mn={x:Je.anchorPoint.x-ot/2,y:Je.anchorPoint.y-bt};break;case"s":mn={x:Je.anchorPoint.x-ot/2,y:Je.anchorPoint.y};break;case"e":mn={x:Je.anchorPoint.x,y:Je.anchorPoint.y-bt/2};break;case"w":mn={x:Je.anchorPoint.x-ot,y:Je.anchorPoint.y-bt/2};break;default:mn={x:Je.anchorPoint.x,y:Je.anchorPoint.y};break}wi(Ie,ot,bt),Rn(Ie,mn)},ee=()=>{const{addToHistory:A}=st.getState();A(),ne(!1),Ke(null),De(null)};return window.addEventListener("mousemove",O),window.addEventListener("mouseup",ee),window.addEventListener("touchmove",O,{passive:!1}),window.addEventListener("touchend",ee),window.addEventListener("touchcancel",ee),()=>{window.removeEventListener("mousemove",O),window.removeEventListener("mouseup",ee),window.removeEventListener("touchmove",O),window.removeEventListener("touchend",ee),window.removeEventListener("touchcancel",ee)}},[Y,Ie,Je,Nt,wi,Rn]),R.useEffect(()=>{if(!Ye||!ht||!dt)return;const O=A=>{const fe=A.touches?A.touches[0].clientX:A.clientX,Be=A.touches?A.touches[0].clientY:A.clientY,Me=yt(fe,Be),ze=Math.atan2(Me.y-dt.zoneCenter.y,Me.x-dt.zoneCenter.x)*(180/Math.PI)-dt.initialAngle;let Ne=dt.originalRotation+ze;Ne=(Ne%360+360)%360,A.shiftKey&&(Ne=Math.round(Ne/15)*15),Ne=Math.round(Ne*10)/10,ei(ht,Ne)},ee=()=>{const{addToHistory:A}=st.getState();A(),at(!1),et(null),nn(null)};return window.addEventListener("mousemove",O),window.addEventListener("mouseup",ee),window.addEventListener("touchmove",O,{passive:!1}),window.addEventListener("touchend",ee),window.addEventListener("touchcancel",ee),()=>{window.removeEventListener("mousemove",O),window.removeEventListener("mouseup",ee),window.removeEventListener("touchmove",O),window.removeEventListener("touchend",ee),window.removeEventListener("touchcancel",ee)}},[Ye,ht,dt,ei]);const Xe=O=>{if(wn&&hn&&(O.target===O.currentTarget||O.target.tagName==="svg"||O.target.closest("svg"))){O.preventDefault(),O.stopPropagation();const ee=Date.now(),A=ee-gi;if(vi(ee),A<300&&A>0){rs();return}const fe=O.clientX,Be=O.clientY,Me=yt(fe,Be),Ve=Yt[hn];if(Ve){const ze=(Me.x-Ve.position.x)/Ve.width_mm,Ne=(Me.y-Ve.position.y)/Ve.height_mm,Ae=Math.max(-.5,Math.min(1.5,ze)),ot=Math.max(-.5,Math.min(1.5,Ne));aa(Ae,ot)}return}O.target===O.currentTarget&&(on(),Fn(),ir(),Xr(),Or(),Fs(),Wt(null))},Ze=()=>{a(O=>Math.min(O*1.25,5))},pn=()=>{a(O=>Math.max(O/1.25,.25))},sr=()=>{a(1),c({x:0,y:0})},da=O=>{if(O.ctrlKey||O.metaKey){O.preventDefault();const ee=O.deltaY*-.002;a(A=>Math.min(Math.max(A+A*ee,.25),5))}else{O.preventDefault();const ee=1;c(A=>({x:A.x-O.deltaX*ee,y:A.y-O.deltaY*ee}))}},Xt=O=>{(O.button===1||O.button===0&&f)&&(O.preventDefault(),O.stopPropagation(),u(!0),h({x:O.clientX-l.x,y:O.clientY-l.y}))},Ol=O=>{d&&c({x:O.clientX-p.x,y:O.clientY-p.y})},Al=()=>{u(!1)},bm=O=>{const ee=O[0].clientX-O[1].clientX,A=O[0].clientY-O[1].clientY;return Math.sqrt(ee*ee+A*A)},wm=O=>({x:(O[0].clientX+O[1].clientX)/2,y:(O[0].clientY+O[1].clientY)/2}),__=O=>{if(O.touches.length===2){O.preventDefault();const ee=bm(O.touches),A=wm(O.touches);x({active:!0,initialDistance:ee,initialZoom:s,initialPan:{...l},initialCenter:A})}},S_=O=>{if(O.touches.length===2&&g.active){O.preventDefault();const A=bm(O.touches)/g.initialDistance;let fe=g.initialZoom*A;fe=Math.min(Math.max(fe,.25),5);const Be=wm(O.touches),Me=Be.x-g.initialCenter.x,Ve=Be.y-g.initialCenter.y;a(fe),c({x:g.initialPan.x+Me,y:g.initialPan.y+Ve})}},k_=O=>{O.touches.length<2&&x({active:!1,initialDistance:0,initialZoom:1,initialPan:{x:0,y:0},initialCenter:{x:0,y:0}})};R.useEffect(()=>{if(d){const O=A=>Ol(A),ee=()=>Al();return window.addEventListener("mousemove",O),window.addEventListener("mouseup",ee),()=>{window.removeEventListener("mousemove",O),window.removeEventListener("mouseup",ee)}}},[d,p]),R.useEffect(()=>{const O=A=>{if(A.code==="Space"&&!A.repeat){if(A.target.tagName==="INPUT"||A.target.tagName==="TEXTAREA")return;A.preventDefault(),m(!0)}if(A.code==="Escape"&&wn&&hn&&(A.preventDefault(),kt()),A.code==="Enter"&&wn&&hn&&(A.preventDefault(),rs()),(A.code==="Delete"||A.code==="Backspace")&&sn&&wt!==null){if(A.target.tagName==="INPUT"||A.target.tagName==="TEXTAREA")return;const fe=Yt[sn];fe&&(fe.shapeType==="path"||fe.shapeType==="blob")&&fe.editPointsVisible&&(A.preventDefault(),Lr(sn,wt),Wt(null))}},ee=A=>{A.code==="Space"&&(m(!1),u(!1))};return window.addEventListener("keydown",O),window.addEventListener("keyup",ee),()=>{window.removeEventListener("keydown",O),window.removeEventListener("keyup",ee)}},[wn,hn,kt,rs,sn,wt,Yt,Lr]);const j_=O=>{if(wn&&hn){const ee=yt(O.clientX,O.clientY);qr(ee)}},fn=wn&&hn?Yt[hn]:null,Jd=((_m=fn==null?void 0:fn.controlPoints)==null?void 0:_m.length)>0?fn.controlPoints[fn.controlPoints.length-1]:null;return o.jsxs("div",{className:`court-canvas ${wn?"court-canvas--drawing":""}`,onClick:Xe,onMouseMove:j_,children:[wn&&o.jsx("div",{className:"court-canvas__drawing-indicator",children:"Click to add points  Double-click or Enter to finish  Escape to cancel"}),o.jsxs("div",{className:"court-canvas__zoom-controls",children:[o.jsx("button",{onClick:Ze,className:"court-canvas__zoom-btn",title:"Zoom In (Ctrl + Scroll)",children:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"11",cy:"11",r:"8"}),o.jsx("line",{x1:"11",y1:"8",x2:"11",y2:"14"}),o.jsx("line",{x1:"8",y1:"11",x2:"14",y2:"11"}),o.jsx("path",{d:"m21 21-4.35-4.35"})]})}),o.jsx("button",{onClick:pn,className:"court-canvas__zoom-btn",title:"Zoom Out (Ctrl + Scroll)",children:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"11",cy:"11",r:"8"}),o.jsx("line",{x1:"8",y1:"11",x2:"14",y2:"11"}),o.jsx("path",{d:"m21 21-4.35-4.35"})]})}),o.jsx("button",{onClick:sr,className:"court-canvas__zoom-btn",title:"Reset View",children:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M1 4v6h6"}),o.jsx("path",{d:"M23 20v-6h-6"}),o.jsx("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})]})}),o.jsxs("span",{className:"court-canvas__zoom-level",title:"Scroll to pan, Ctrl+Scroll to zoom, Space+Drag to pan",children:[Math.round(s*100),"%"]})]}),o.jsx("div",{ref:i,className:"court-canvas__viewport",onWheel:da,onMouseDown:Xt,onTouchStart:__,onTouchMove:S_,onTouchEnd:k_,style:{cursor:d?"grabbing":f?"grab":void 0,touchAction:"none"},children:o.jsx("div",{className:"court-canvas__transform-wrapper",style:{transform:`translate(${l.x}px, ${l.y}px) scale(${s})`,transformOrigin:"center center"},children:o.jsxs("svg",{ref:r,className:"court-canvas__svg",viewBox:`0 0 ${lt.width_mm} ${lt.length_mm}`,preserveAspectRatio:"xMidYMid meet",children:[o.jsx("defs",{children:lt.boundary&&lt.boundary.type!=="rectangle"&&lt.boundary.controlPoints&&o.jsx("clipPath",{id:"surface-boundary-clip",children:o.jsx("path",{d:S0(lt.boundary,lt.width_mm,lt.length_mm)})})}),o.jsx("g",{clipPath:lt.boundary&&lt.boundary.type!=="rectangle"&&lt.boundary.controlPoints?"url(#surface-boundary-clip)":void 0,children:o.jsx("rect",{x:"0",y:"0",width:lt.width_mm,height:lt.length_mm,fill:lt.color.hex,className:"court-canvas__surface"})}),lt.boundary&&lt.boundary.type!=="rectangle"&&lt.boundary.controlPoints&&o.jsx("path",{d:S0(lt.boundary,lt.width_mm,lt.length_mm),fill:"none",stroke:"#94a3b8",strokeWidth:"60",strokeDasharray:"300 200",pointerEvents:"none"}),Object.values(Nt).map(O=>O.visible===!1?null:o.jsx(NE,{zone:O,isSelected:O.id===zn,onMouseDown:ee=>ye(ee,O.id),onTouchStart:ee=>ye(ee,O.id),onDoubleClick:ee=>Te(ee,O.id),onScaleStart:(ee,A)=>nt(ee,O.id,A),onRotateStart:ee=>it(ee,O.id)},O.id)),rn.map(O=>{if(O.startsWith("court-")){const ee=nr[O];return!ee||ee.visible===!1?null:o.jsx(OE,{court:ee,isSelected:O===gt,onMouseDown:A=>is(A,O),onTouchStart:A=>is(A,O),onDoubleClick:A=>ca(A,O),svgRef:r},O)}if(O.startsWith("track-")){const ee=rr[O];return!ee||ee.visible===!1?null:o.jsx(uE,{track:ee,isSelected:O===Rr,onMouseDown:A=>Gt(A,O),onTouchStart:A=>Gt(A,O),onDoubleClick:A=>_n(A,O),svgRef:r},O)}if(O.startsWith("motif-")){const ee=Tn[O];return!ee||ee.visible===!1?null:o.jsx(pE,{motif:ee,isSelected:O===ft,onMouseDown:A=>ss(A,O),onTouchStart:A=>ss(A,O),onDoubleClick:A=>os(A,O),onScaleStart:(A,fe)=>ki(A,O,fe),onRotateStart:A=>Q(A,O)},O)}if(O.startsWith("shape-")){const ee=Yt[O];return!ee||ee.visible===!1?null:ee.shapeType==="blob"?o.jsx(_E,{shape:ee,isSelected:O===sn,onMouseDown:A=>ve(A,O),onTouchStart:A=>ve(A,O),onDoubleClick:A=>be(A,O),onScaleStart:(A,fe)=>Ce(A,O,fe),onRotateStart:A=>Qe(A,O),onPointDrag:(A,fe,Be)=>ns(O,A,fe,Be),onHandleDrag:(A,fe,Be,Me)=>_i(O,A,fe,Be,Me),onDragEnd:()=>Si(),selectedPointIndex:O===sn?wt:null,onPointSelect:A=>Wt(A),onPointDelete:A=>Lr(O,A)},O):ee.shapeType==="path"?o.jsx(kE,{shape:ee,isSelected:O===sn,onMouseDown:A=>ve(A,O),onTouchStart:A=>ve(A,O),onDoubleClick:A=>be(A,O),onScaleStart:(A,fe)=>Ce(A,O,fe),onRotateStart:A=>Qe(A,O),onPointDrag:(A,fe,Be)=>$r(O,A,fe,Be),onHandleDrag:(A,fe,Be,Me)=>la(O,A,fe,Be,Me),onDragEnd:()=>Hs(),selectedPointIndex:O===sn?wt:null,onPointSelect:A=>Wt(A),onPointDelete:A=>Lr(O,A)},O):o.jsx(bE,{shape:ee,isSelected:O===sn,onMouseDown:A=>ve(A,O),onTouchStart:A=>ve(A,O),onDoubleClick:A=>be(A,O),onScaleStart:(A,fe)=>Ce(A,O,fe),onRotateStart:A=>Qe(A,O)},O)}if(O.startsWith("text-")){const ee=Nn[O];return!ee||ee.visible===!1?null:o.jsx(EE,{text:ee,isSelected:O===pt,isEditing:O===Pt,onMouseDown:A=>He(A,O),onTouchStart:A=>He(A,O),onDoubleClick:A=>Le(A,O),onScaleStart:(A,fe)=>_e(A,O,fe),onRotateStart:A=>U(A,O),onContentChange:A=>Un(O,A),onEditComplete:()=>oa()},O)}return null}),wn&&fn&&Jd&&Pr&&o.jsx("line",{x1:fn.position.x+Jd.x*fn.width_mm,y1:fn.position.y+Jd.y*fn.height_mm,x2:Pr.x,y2:Pr.y,stroke:"#3b82f6",strokeWidth:"50",strokeDasharray:"100 100",opacity:"0.6",pointerEvents:"none"}),wn&&fn&&((Sm=fn.controlPoints)==null?void 0:Sm.map((O,ee)=>o.jsx("circle",{cx:fn.position.x+O.x*fn.width_mm,cy:fn.position.y+O.y*fn.height_mm,r:"80",fill:"#3b82f6",stroke:"#fff",strokeWidth:"20",pointerEvents:"none"},`preview-point-${ee}`)))]})})}),o.jsxs("div",{className:"court-canvas__info",children:[o.jsxs("span",{children:[(lt.width_mm/1e3).toFixed(1),"m  ",(lt.length_mm/1e3).toFixed(1),"m"]}),$t&&o.jsxs("span",{className:"court-canvas__grid-indicator",children:["Grid: ",_t,"mm"]})]}),rn.length===0&&o.jsxs("div",{className:"court-canvas__empty-state",children:[o.jsx("div",{className:"court-canvas__empty-icon",children:o.jsxs("svg",{width:"72",height:"72",viewBox:"0 0 24 24",fill:"none",children:[o.jsx("path",{d:"M12 2L14.4 8.4L21 9.6L16.2 14.4L17.6 21L12 17.6L6.4 21L7.8 14.4L3 9.6L9.6 8.4L12 2Z",fill:"rgba(255,255,255,0.15)",stroke:"currentColor",strokeWidth:"1.5",strokeLinejoin:"round"}),o.jsx("circle",{cx:"19",cy:"5",r:"1.5",fill:"currentColor",opacity:"0.6"}),o.jsx("circle",{cx:"5",cy:"18",r:"1",fill:"currentColor",opacity:"0.4"}),o.jsx("circle",{cx:"20",cy:"16",r:"0.8",fill:"currentColor",opacity:"0.5"})]})}),o.jsx("h3",{className:"court-canvas__empty-title",children:"Your canvas is ready"}),o.jsx("p",{className:"court-canvas__empty-text",children:"Design your perfect TPV surface in minutes"}),o.jsxs("div",{className:"court-canvas__empty-hints",children:[o.jsxs("div",{className:"court-canvas__hint",children:[o.jsx("span",{className:"court-canvas__hint-icon",children:o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),o.jsx("line",{x1:"9",y1:"3",x2:"9",y2:"21"})]})}),o.jsxs("span",{children:["Add ",o.jsx("strong",{children:"Courts"}),", ",o.jsx("strong",{children:"Tracks"}),", ",o.jsx("strong",{children:"Shapes"})," or ",o.jsx("strong",{children:"Designs"})]})]}),o.jsxs("div",{className:"court-canvas__hint",children:[o.jsx("span",{className:"court-canvas__hint-icon",children:o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M12 5v14M5 12h14"})})}),o.jsx("span",{children:"Click elements in the library to place them"})]}),o.jsxs("div",{className:"court-canvas__hint",children:[o.jsx("span",{className:"court-canvas__hint-icon",children:o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M5 9l4 4-4 4"}),o.jsx("path",{d:"M12 4h7a2 2 0 012 2v12a2 2 0 01-2 2h-7"})]})}),o.jsx("span",{children:"Arrange, customise colours and export"})]})]})]})]})});function OE({court:e,isSelected:t,onMouseDown:n,onTouchStart:r,onDoubleClick:i,svgRef:s}){var d;const{markings:a,zones:l}=QC(e),c=((d=e.courtSurfaceColor)==null?void 0:d.hex)||null;return o.jsxs("g",{className:`court-canvas__court ${t?"court-canvas__court--selected":""}`,transform:tE(e),style:{cursor:"move"},children:[c&&o.jsx("rect",{x:"0",y:"0",width:e.template.dimensions.width_mm,height:e.template.dimensions.length_mm,fill:c,className:"court-canvas__court-surface"}),o.jsx("rect",{x:"0",y:"0",width:e.template.dimensions.width_mm,height:e.template.dimensions.length_mm,fill:"none",pointerEvents:"all",onMouseDown:n,onTouchStart:r,onDoubleClick:i,style:{cursor:"move"}}),l.map(u=>o.jsx(AE,{zone:u},u.id)),a.map(u=>o.jsx(ME,{marking:u},u.id)),t&&o.jsxs(o.Fragment,{children:[o.jsx("rect",{x:"0",y:"0",width:e.template.dimensions.width_mm,height:e.template.dimensions.length_mm,fill:"none",stroke:"#007bff",strokeWidth:"100",strokeDasharray:"400 400",className:"court-canvas__selection-outline"}),o.jsx(nE,{court:e,svgRef:s})]})]})}function AE({zone:e}){switch(e.type){case"rect":return o.jsx("rect",{x:e.x,y:e.y,width:e.width,height:e.height,fill:e.fill});case"circle":return o.jsx("circle",{cx:e.cx,cy:e.cy,r:e.r,fill:e.fill});case"polygon":return o.jsx("polygon",{points:e.points,fill:e.fill});default:return null}}function ME({marking:e}){switch(e.type){case"line":return o.jsx("line",{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,stroke:e.stroke,strokeWidth:e.strokeWidth});case"rect":return o.jsx("rect",{x:e.x,y:e.y,width:e.width,height:e.height,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill});case"circle":return o.jsx("circle",{cx:e.cx,cy:e.cy,r:e.r,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill});case"path":return o.jsx("path",{d:e.d,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill});case"polyline":return o.jsx("polyline",{points:e.points,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill});default:return null}}const Vw={"track-flexible":{id:"track-flexible",name:"Running Track",type:"running-track",trackType:"curved",standard:"Flexible Design",category:"track",description:"Flexible running track - adjust size, lanes, and corner radius to fit your surface",parameters:{numLanes:4,laneWidth_mm:1220,width_mm:25e3,height_mm:15e3,cornerRadius:{topLeft:3e3,topRight:3e3,bottomLeft:3e3,bottomRight:3e3},lineWidth_mm:50,startingBoxes:{enabled:!1,depth_mm:400,lineWidth_mm:50}},defaultLineColor:"RH31",defaultTrackSurfaceColor:"RH01",calculatedDimensions:{totalWidth_mm:25e3,totalLength_mm:15e3}},"track-straight":{id:"track-straight",name:"Straight Track",type:"running-track",trackType:"straight",standard:"Sprint Track",category:"track",description:"Straight sprint track - perfect for 60m, 100m, or custom length sprints",parameters:{numLanes:6,laneWidth_mm:1220,width_mm:7320,height_mm:1e5,cornerRadius:{topLeft:0,topRight:0,bottomLeft:0,bottomRight:0},lineWidth_mm:50,startingBoxes:{enabled:!1,depth_mm:400,lineWidth_mm:50}},defaultLineColor:"RH31",defaultTrackSurfaceColor:"RH01",calculatedDimensions:{totalWidth_mm:7320,totalLength_mm:1e5}}};function $E(){return Object.values(Vw)}function LE(e){return Vw[e]||null}/*! @license DOMPurify 3.3.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.0/LICENSE */var zu,k0;function j0(){if(k0)return zu;k0=1;const{entries:e,setPrototypeOf:t,isFrozen:n,getPrototypeOf:r,getOwnPropertyDescriptor:i}=Object;let{freeze:s,seal:a,create:l}=Object,{apply:c,construct:d}=typeof Reflect<"u"&&Reflect;s||(s=function(te){return te}),a||(a=function(te){return te}),c||(c=function(te,ge){for(var V=arguments.length,$=new Array(V>2?V-2:0),D=2;D<V;D++)$[D-2]=arguments[D];return te.apply(ge,$)}),d||(d=function(te){for(var ge=arguments.length,V=new Array(ge>1?ge-1:0),$=1;$<ge;$++)V[$-1]=arguments[$];return new te(...V)});const u=E(Array.prototype.forEach),p=E(Array.prototype.lastIndexOf),h=E(Array.prototype.pop),f=E(Array.prototype.push),m=E(Array.prototype.splice),g=E(String.prototype.toLowerCase),x=E(String.prototype.toString),y=E(String.prototype.match),v=E(String.prototype.replace),b=E(String.prototype.indexOf),w=E(String.prototype.trim),C=E(Object.prototype.hasOwnProperty),_=E(RegExp.prototype.test),j=T(TypeError);function E(G){return function(te){te instanceof RegExp&&(te.lastIndex=0);for(var ge=arguments.length,V=new Array(ge>1?ge-1:0),$=1;$<ge;$++)V[$-1]=arguments[$];return c(G,te,V)}}function T(G){return function(){for(var te=arguments.length,ge=new Array(te),V=0;V<te;V++)ge[V]=arguments[V];return d(G,ge)}}function M(G,te){let ge=arguments.length>2&&arguments[2]!==void 0?arguments[2]:g;t&&t(G,null);let V=te.length;for(;V--;){let $=te[V];if(typeof $=="string"){const D=ge($);D!==$&&(n(te)||(te[V]=D),$=D)}G[$]=!0}return G}function J(G){for(let te=0;te<G.length;te++)C(G,te)||(G[te]=null);return G}function P(G){const te=l(null);for(const[ge,V]of e(G))C(G,ge)&&(Array.isArray(V)?te[ge]=J(V):V&&typeof V=="object"&&V.constructor===Object?te[ge]=P(V):te[ge]=V);return te}function q(G,te){for(;G!==null;){const V=i(G,te);if(V){if(V.get)return E(V.get);if(typeof V.value=="function")return E(V.value)}G=r(G)}function ge(){return null}return ge}const k=s(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),z=s(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),he=s(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Z=s(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),K=s(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),H=s(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),X=s(["#text"]),F=s(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),W=s(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),re=s(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),se=s(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),me=a(/\{\{[\w\W]*|[\w\W]*\}\}/gm),ke=a(/<%[\w\W]*|[\w\W]*%>/gm),pe=a(/\$\{[\w\W]*/gm),Pe=a(/^data-[\-\w.\u00B7-\uFFFF]+$/),Re=a(/^aria-[\-\w]+$/),Ge=a(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),$e=a(/^(?:\w+script|data):/i),we=a(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),xe=a(/^html$/i),S=a(/^[a-z][.\w]*(-[.\w]+)+$/i);var ue=Object.freeze({__proto__:null,ARIA_ATTR:Re,ATTR_WHITESPACE:we,CUSTOM_ELEMENT:S,DATA_ATTR:Pe,DOCTYPE_NAME:xe,ERB_EXPR:ke,IS_ALLOWED_URI:Ge,IS_SCRIPT_OR_DATA:$e,MUSTACHE_EXPR:me,TMPLIT_EXPR:pe});const ce={element:1,text:3,progressingInstruction:7,comment:8,document:9},I=function(){return typeof window>"u"?null:window},N=function(te,ge){if(typeof te!="object"||typeof te.createPolicy!="function")return null;let V=null;const $="data-tt-policy-suffix";ge&&ge.hasAttribute($)&&(V=ge.getAttribute($));const D="dompurify"+(V?"#"+V:"");try{return te.createPolicy(D,{createHTML(ae){return ae},createScriptURL(ae){return ae}})}catch{return console.warn("TrustedTypes policy "+D+" could not be created."),null}},B=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function oe(){let G=arguments.length>0&&arguments[0]!==void 0?arguments[0]:I();const te=_e=>oe(_e);if(te.version="3.3.0",te.removed=[],!G||!G.document||G.document.nodeType!==ce.document||!G.Element)return te.isSupported=!1,te;let{document:ge}=G;const V=ge,$=V.currentScript,{DocumentFragment:D,HTMLTemplateElement:ae,Node:Se,Element:le,NodeFilter:ie,NamedNodeMap:je=G.NamedNodeMap||G.MozNamedAttrMap,HTMLFormElement:Y,DOMParser:ne,trustedTypes:Ie}=G,Ke=le.prototype,Je=q(Ke,"cloneNode"),De=q(Ke,"remove"),Ye=q(Ke,"nextSibling"),at=q(Ke,"childNodes"),ht=q(Ke,"parentNode");if(typeof ae=="function"){const _e=ge.createElement("template");_e.content&&_e.content.ownerDocument&&(ge=_e.content.ownerDocument)}let et,dt="";const{implementation:nn,createNodeIterator:Pr,createDocumentFragment:qr,getElementsByTagName:gi}=ge,{importNode:vi}=V;let wt=B();te.isSupported=typeof e=="function"&&typeof ht=="function"&&nn&&nn.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:Wt,ERB_EXPR:lt,TMPLIT_EXPR:nr,DATA_ATTR:rr,ARIA_ATTR:Tn,IS_SCRIPT_OR_DATA:Yt,ATTR_WHITESPACE:Nn,CUSTOM_ELEMENT:Nt}=ue;let{IS_ALLOWED_URI:rn}=ue,gt=null;const Rr=M({},[...k,...z,...he,...K,...X]);let ft=null;const sn=M({},[...F,...W,...re,...se]);let pt=Object.seal(l(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),zn=null,Pt=null;const $t=Object.seal(l(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let _t=!0,St=!0,on=!1,vt=!0,Fn=!1,Yr=!0,ir=!1,yi=!1,Xr=!1,Bn=!1,Or=!1,Zr=!1,Fs=!0,Bs=!1;const oa="user-content-";let xi=!0,Ar=!1,Hn={},Pn=null;const es=M({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Kr=null;const ts=M({},["audio","video","img","source","image","track"]);let bi=null;const Jr=M({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Qr="http://www.w3.org/1998/Math/MathML",Mr="http://www.w3.org/2000/svg",Un="http://www.w3.org/1999/xhtml";let Rn=Un,wi=!1,ei=null;const ns=M({},[Qr,Mr,Un],x);let _i=M({},["mi","mo","mn","ms","mtext"]),Si=M({},["annotation-xml"]);const wn=M({},["title","style","font","a","script"]);let hn=null;const aa=["application/xhtml+xml","text/html"],rs="text/html";let kt=null,$r=null;const la=ge.createElement("form"),Hs=function(U){return U instanceof RegExp||U instanceof Function},Lr=function(){let U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!($r&&$r===U)){if((!U||typeof U!="object")&&(U={}),U=P(U),hn=aa.indexOf(U.PARSER_MEDIA_TYPE)===-1?rs:U.PARSER_MEDIA_TYPE,kt=hn==="application/xhtml+xml"?x:g,gt=C(U,"ALLOWED_TAGS")?M({},U.ALLOWED_TAGS,kt):Rr,ft=C(U,"ALLOWED_ATTR")?M({},U.ALLOWED_ATTR,kt):sn,ei=C(U,"ALLOWED_NAMESPACES")?M({},U.ALLOWED_NAMESPACES,x):ns,bi=C(U,"ADD_URI_SAFE_ATTR")?M(P(Jr),U.ADD_URI_SAFE_ATTR,kt):Jr,Kr=C(U,"ADD_DATA_URI_TAGS")?M(P(ts),U.ADD_DATA_URI_TAGS,kt):ts,Pn=C(U,"FORBID_CONTENTS")?M({},U.FORBID_CONTENTS,kt):es,zn=C(U,"FORBID_TAGS")?M({},U.FORBID_TAGS,kt):P({}),Pt=C(U,"FORBID_ATTR")?M({},U.FORBID_ATTR,kt):P({}),Hn=C(U,"USE_PROFILES")?U.USE_PROFILES:!1,_t=U.ALLOW_ARIA_ATTR!==!1,St=U.ALLOW_DATA_ATTR!==!1,on=U.ALLOW_UNKNOWN_PROTOCOLS||!1,vt=U.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Fn=U.SAFE_FOR_TEMPLATES||!1,Yr=U.SAFE_FOR_XML!==!1,ir=U.WHOLE_DOCUMENT||!1,Bn=U.RETURN_DOM||!1,Or=U.RETURN_DOM_FRAGMENT||!1,Zr=U.RETURN_TRUSTED_TYPE||!1,Xr=U.FORCE_BODY||!1,Fs=U.SANITIZE_DOM!==!1,Bs=U.SANITIZE_NAMED_PROPS||!1,xi=U.KEEP_CONTENT!==!1,Ar=U.IN_PLACE||!1,rn=U.ALLOWED_URI_REGEXP||Ge,Rn=U.NAMESPACE||Un,_i=U.MATHML_TEXT_INTEGRATION_POINTS||_i,Si=U.HTML_INTEGRATION_POINTS||Si,pt=U.CUSTOM_ELEMENT_HANDLING||{},U.CUSTOM_ELEMENT_HANDLING&&Hs(U.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(pt.tagNameCheck=U.CUSTOM_ELEMENT_HANDLING.tagNameCheck),U.CUSTOM_ELEMENT_HANDLING&&Hs(U.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(pt.attributeNameCheck=U.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),U.CUSTOM_ELEMENT_HANDLING&&typeof U.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(pt.allowCustomizedBuiltInElements=U.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Fn&&(St=!1),Or&&(Bn=!0),Hn&&(gt=M({},X),ft=[],Hn.html===!0&&(M(gt,k),M(ft,F)),Hn.svg===!0&&(M(gt,z),M(ft,W),M(ft,se)),Hn.svgFilters===!0&&(M(gt,he),M(ft,W),M(ft,se)),Hn.mathMl===!0&&(M(gt,K),M(ft,re),M(ft,se))),U.ADD_TAGS&&(typeof U.ADD_TAGS=="function"?$t.tagCheck=U.ADD_TAGS:(gt===Rr&&(gt=P(gt)),M(gt,U.ADD_TAGS,kt))),U.ADD_ATTR&&(typeof U.ADD_ATTR=="function"?$t.attributeCheck=U.ADD_ATTR:(ft===sn&&(ft=P(ft)),M(ft,U.ADD_ATTR,kt))),U.ADD_URI_SAFE_ATTR&&M(bi,U.ADD_URI_SAFE_ATTR,kt),U.FORBID_CONTENTS&&(Pn===es&&(Pn=P(Pn)),M(Pn,U.FORBID_CONTENTS,kt)),xi&&(gt["#text"]=!0),ir&&M(gt,["html","head","body"]),gt.table&&(M(gt,["tbody"]),delete zn.tbody),U.TRUSTED_TYPES_POLICY){if(typeof U.TRUSTED_TYPES_POLICY.createHTML!="function")throw j('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof U.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw j('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');et=U.TRUSTED_TYPES_POLICY,dt=et.createHTML("")}else et===void 0&&(et=N(Ie,$)),et!==null&&typeof dt=="string"&&(dt=et.createHTML(""));s&&s(U),$r=U}},yt=M({},[...z,...he,...Z]),is=M({},[...K,...H]),ca=function(U){let ye=ht(U);(!ye||!ye.tagName)&&(ye={namespaceURI:Rn,tagName:"template"});const Te=g(U.tagName),nt=g(ye.tagName);return ei[U.namespaceURI]?U.namespaceURI===Mr?ye.namespaceURI===Un?Te==="svg":ye.namespaceURI===Qr?Te==="svg"&&(nt==="annotation-xml"||_i[nt]):!!yt[Te]:U.namespaceURI===Qr?ye.namespaceURI===Un?Te==="math":ye.namespaceURI===Mr?Te==="math"&&Si[nt]:!!is[Te]:U.namespaceURI===Un?ye.namespaceURI===Mr&&!Si[nt]||ye.namespaceURI===Qr&&!_i[nt]?!1:!is[Te]&&(wn[Te]||!yt[Te]):!!(hn==="application/xhtml+xml"&&ei[U.namespaceURI]):!1},Gt=function(U){f(te.removed,{element:U});try{ht(U).removeChild(U)}catch{De(U)}},_n=function(U,ye){try{f(te.removed,{attribute:ye.getAttributeNode(U),from:ye})}catch{f(te.removed,{attribute:null,from:ye})}if(ye.removeAttribute(U),U==="is")if(Bn||Or)try{Gt(ye)}catch{}else try{ye.setAttribute(U,"")}catch{}},ss=function(U){let ye=null,Te=null;if(Xr)U="<remove></remove>"+U;else{const Xe=y(U,/^[\r\n\t ]+/);Te=Xe&&Xe[0]}hn==="application/xhtml+xml"&&Rn===Un&&(U='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+U+"</body></html>");const nt=et?et.createHTML(U):U;if(Rn===Un)try{ye=new ne().parseFromString(nt,hn)}catch{}if(!ye||!ye.documentElement){ye=nn.createDocument(Rn,"template",null);try{ye.documentElement.innerHTML=wi?dt:nt}catch{}}const it=ye.body||ye.documentElement;return U&&Te&&it.insertBefore(ge.createTextNode(Te),it.childNodes[0]||null),Rn===Un?gi.call(ye,ir?"html":"body")[0]:ir?ye.documentElement:it},os=function(U){return Pr.call(U.ownerDocument||U,U,ie.SHOW_ELEMENT|ie.SHOW_COMMENT|ie.SHOW_TEXT|ie.SHOW_PROCESSING_INSTRUCTION|ie.SHOW_CDATA_SECTION,null)},ki=function(U){return U instanceof Y&&(typeof U.nodeName!="string"||typeof U.textContent!="string"||typeof U.removeChild!="function"||!(U.attributes instanceof je)||typeof U.removeAttribute!="function"||typeof U.setAttribute!="function"||typeof U.namespaceURI!="string"||typeof U.insertBefore!="function"||typeof U.hasChildNodes!="function")},Q=function(U){return typeof Se=="function"&&U instanceof Se};function ve(_e,U,ye){u(_e,Te=>{Te.call(te,U,ye,$r)})}const be=function(U){let ye=null;if(ve(wt.beforeSanitizeElements,U,null),ki(U))return Gt(U),!0;const Te=kt(U.nodeName);if(ve(wt.uponSanitizeElement,U,{tagName:Te,allowedTags:gt}),Yr&&U.hasChildNodes()&&!Q(U.firstElementChild)&&_(/<[/\w!]/g,U.innerHTML)&&_(/<[/\w!]/g,U.textContent)||U.nodeType===ce.progressingInstruction||Yr&&U.nodeType===ce.comment&&_(/<[/\w]/g,U.data))return Gt(U),!0;if(!($t.tagCheck instanceof Function&&$t.tagCheck(Te))&&(!gt[Te]||zn[Te])){if(!zn[Te]&&Qe(Te)&&(pt.tagNameCheck instanceof RegExp&&_(pt.tagNameCheck,Te)||pt.tagNameCheck instanceof Function&&pt.tagNameCheck(Te)))return!1;if(xi&&!Pn[Te]){const nt=ht(U)||U.parentNode,it=at(U)||U.childNodes;if(it&&nt){const Xe=it.length;for(let Ze=Xe-1;Ze>=0;--Ze){const pn=Je(it[Ze],!0);pn.__removalCount=(U.__removalCount||0)+1,nt.insertBefore(pn,Ye(U))}}}return Gt(U),!0}return U instanceof le&&!ca(U)||(Te==="noscript"||Te==="noembed"||Te==="noframes")&&_(/<\/no(script|embed|frames)/i,U.innerHTML)?(Gt(U),!0):(Fn&&U.nodeType===ce.text&&(ye=U.textContent,u([Wt,lt,nr],nt=>{ye=v(ye,nt," ")}),U.textContent!==ye&&(f(te.removed,{element:U.cloneNode()}),U.textContent=ye)),ve(wt.afterSanitizeElements,U,null),!1)},Ce=function(U,ye,Te){if(Fs&&(ye==="id"||ye==="name")&&(Te in ge||Te in la))return!1;if(!(St&&!Pt[ye]&&_(rr,ye))){if(!(_t&&_(Tn,ye))){if(!($t.attributeCheck instanceof Function&&$t.attributeCheck(ye,U))){if(!ft[ye]||Pt[ye]){if(!(Qe(U)&&(pt.tagNameCheck instanceof RegExp&&_(pt.tagNameCheck,U)||pt.tagNameCheck instanceof Function&&pt.tagNameCheck(U))&&(pt.attributeNameCheck instanceof RegExp&&_(pt.attributeNameCheck,ye)||pt.attributeNameCheck instanceof Function&&pt.attributeNameCheck(ye,U))||ye==="is"&&pt.allowCustomizedBuiltInElements&&(pt.tagNameCheck instanceof RegExp&&_(pt.tagNameCheck,Te)||pt.tagNameCheck instanceof Function&&pt.tagNameCheck(Te))))return!1}else if(!bi[ye]){if(!_(rn,v(Te,Nn,""))){if(!((ye==="src"||ye==="xlink:href"||ye==="href")&&U!=="script"&&b(Te,"data:")===0&&Kr[U])){if(!(on&&!_(Yt,v(Te,Nn,"")))){if(Te)return!1}}}}}}}return!0},Qe=function(U){return U!=="annotation-xml"&&y(U,Nt)},He=function(U){ve(wt.beforeSanitizeAttributes,U,null);const{attributes:ye}=U;if(!ye||ki(U))return;const Te={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ft,forceKeepAttr:void 0};let nt=ye.length;for(;nt--;){const it=ye[nt],{name:Xe,namespaceURI:Ze,value:pn}=it,sr=kt(Xe),da=pn;let Xt=Xe==="value"?da:w(da);if(Te.attrName=sr,Te.attrValue=Xt,Te.keepAttr=!0,Te.forceKeepAttr=void 0,ve(wt.uponSanitizeAttribute,U,Te),Xt=Te.attrValue,Bs&&(sr==="id"||sr==="name")&&(_n(Xe,U),Xt=oa+Xt),Yr&&_(/((--!?|])>)|<\/(style|title|textarea)/i,Xt)){_n(Xe,U);continue}if(sr==="attributename"&&y(Xt,"href")){_n(Xe,U);continue}if(Te.forceKeepAttr)continue;if(!Te.keepAttr){_n(Xe,U);continue}if(!vt&&_(/\/>/i,Xt)){_n(Xe,U);continue}Fn&&u([Wt,lt,nr],Al=>{Xt=v(Xt,Al," ")});const Ol=kt(U.nodeName);if(!Ce(Ol,sr,Xt)){_n(Xe,U);continue}if(et&&typeof Ie=="object"&&typeof Ie.getAttributeType=="function"&&!Ze)switch(Ie.getAttributeType(Ol,sr)){case"TrustedHTML":{Xt=et.createHTML(Xt);break}case"TrustedScriptURL":{Xt=et.createScriptURL(Xt);break}}if(Xt!==da)try{Ze?U.setAttributeNS(Ze,Xe,Xt):U.setAttribute(Xe,Xt),ki(U)?Gt(U):h(te.removed)}catch{_n(Xe,U)}}ve(wt.afterSanitizeAttributes,U,null)},Le=function _e(U){let ye=null;const Te=os(U);for(ve(wt.beforeSanitizeShadowDOM,U,null);ye=Te.nextNode();)ve(wt.uponSanitizeShadowNode,ye,null),be(ye),He(ye),ye.content instanceof D&&_e(ye.content);ve(wt.afterSanitizeShadowDOM,U,null)};return te.sanitize=function(_e){let U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ye=null,Te=null,nt=null,it=null;if(wi=!_e,wi&&(_e="<!-->"),typeof _e!="string"&&!Q(_e))if(typeof _e.toString=="function"){if(_e=_e.toString(),typeof _e!="string")throw j("dirty is not a string, aborting")}else throw j("toString is not a function");if(!te.isSupported)return _e;if(yi||Lr(U),te.removed=[],typeof _e=="string"&&(Ar=!1),Ar){if(_e.nodeName){const pn=kt(_e.nodeName);if(!gt[pn]||zn[pn])throw j("root node is forbidden and cannot be sanitized in-place")}}else if(_e instanceof Se)ye=ss("<!---->"),Te=ye.ownerDocument.importNode(_e,!0),Te.nodeType===ce.element&&Te.nodeName==="BODY"||Te.nodeName==="HTML"?ye=Te:ye.appendChild(Te);else{if(!Bn&&!Fn&&!ir&&_e.indexOf("<")===-1)return et&&Zr?et.createHTML(_e):_e;if(ye=ss(_e),!ye)return Bn?null:Zr?dt:""}ye&&Xr&&Gt(ye.firstChild);const Xe=os(Ar?_e:ye);for(;nt=Xe.nextNode();)be(nt),He(nt),nt.content instanceof D&&Le(nt.content);if(Ar)return _e;if(Bn){if(Or)for(it=qr.call(ye.ownerDocument);ye.firstChild;)it.appendChild(ye.firstChild);else it=ye;return(ft.shadowroot||ft.shadowrootmode)&&(it=vi.call(V,it,!0)),it}let Ze=ir?ye.outerHTML:ye.innerHTML;return ir&&gt["!doctype"]&&ye.ownerDocument&&ye.ownerDocument.doctype&&ye.ownerDocument.doctype.name&&_(xe,ye.ownerDocument.doctype.name)&&(Ze="<!DOCTYPE "+ye.ownerDocument.doctype.name+`>
`+Ze),Fn&&u([Wt,lt,nr],pn=>{Ze=v(Ze,pn," ")}),et&&Zr?et.createHTML(Ze):Ze},te.setConfig=function(){let _e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Lr(_e),yi=!0},te.clearConfig=function(){$r=null,yi=!1},te.isValidAttribute=function(_e,U,ye){$r||Lr({});const Te=kt(_e),nt=kt(U);return Ce(Te,nt,ye)},te.addHook=function(_e,U){typeof U=="function"&&f(wt[_e],U)},te.removeHook=function(_e,U){if(U!==void 0){const ye=p(wt[_e],U);return ye===-1?void 0:m(wt[_e],ye,1)[0]}return h(wt[_e])},te.removeHooks=function(_e){wt[_e]=[]},te.removeAllHooks=function(){wt=B()},te}var de=oe();return zu=de,zu}var IE=self.DOMPurify||(self.DOMPurify=j0().default||j0());const DE=gd(IE);function Sf(e,t={}){if(!e||typeof e!="string")return console.warn("[SVG-SANITIZE] Invalid input:",typeof e),"";const n={USE_PROFILES:{svg:!0,svgFilters:!0},FORBID_TAGS:["script","foreignObject","iframe","embed"],FORBID_ATTR:["onload","onerror","onclick","onmouseover","onmouseout","onmouseenter","onmouseleave","onmousemove","onmousedown","onmouseup","onfocus","onblur","onkeydown","onkeyup","onkeypress","onsubmit","onreset","onselect","onchange","oninput","onanimationstart","onanimationend","onanimationiteration","ontransitionend","ontransitionrun","ontransitionstart","ontransitioncancel","xlink:href",...t.additionalForbiddenAttrs||[]],ALLOW_DATA_ATTR:!0,ALLOW_COMMENTS:!1,RETURN_DOM:!1,RETURN_DOM_FRAGMENT:!1,ALLOWED_URI_REGEXP:/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,HOOKS:{afterSanitizeAttributes:r=>{if(r.hasAttribute("href")){const i=r.getAttribute("href");i&&i.toLowerCase().trim().startsWith("javascript:")&&(r.removeAttribute("href"),console.warn("[SVG-SANITIZE] Removed javascript: href"))}if(r.hasAttribute("xlink:href")){const i=r.getAttribute("xlink:href");i&&(i.toLowerCase().trim().startsWith("javascript:")||i.toLowerCase().trim().startsWith("data:text/html"))&&(r.removeAttribute("xlink:href"),console.warn("[SVG-SANITIZE] Removed dangerous xlink:href"))}}},...t};try{const r=DE.sanitize(e,n);if(!r||!r.includes("<svg"))return console.error("[SVG-SANITIZE] Sanitization removed SVG content - input may be malicious"),"";const i=e.length,s=r.length,a=(i-s)/i*100;return a>10&&console.warn(`[SVG-SANITIZE] Removed ${a.toFixed(1)}% of content (${i-s} chars) - possible malicious SVG detected`),r}catch(r){return console.error("[SVG-SANITIZE] Sanitization failed:",r),""}}function zE(e){if(!e||typeof e!="string")return!1;const t=e.toLowerCase(),n=["<script","javascript:","onload=","onerror=","onclick=","onmouseover=","<foreignobject","<iframe","<embed","data:text/html"];for(const r of n)if(t.includes(r))return console.warn(`[SVG-VALIDATE] Dangerous pattern detected: ${r}`),!1;return t.includes("<svg")?!0:(console.warn("[SVG-VALIDATE] Content does not appear to be valid SVG (no <svg> tag found)"),!1)}function FE(e){return e.replace("#","").toLowerCase()}async function vs(e,t,n=null){try{let r;if(n)r=n,console.log(`[SVG-RECOLOR] Using provided SVG text (${r.length} chars)`);else{console.log("[SVG-RECOLOR] Fetching SVG from:",e);const m=await fetch(e);if(!m.ok)throw new Error(`Failed to fetch SVG: ${m.status} ${m.statusText}`);r=await m.text(),console.log(`[SVG-RECOLOR] Fetched SVG (${r.length} chars)`)}console.log("[SVG-RECOLOR] Sanitizing SVG...");const i=Sf(r);if(!i)throw new Error("SVG sanitization failed - content rejected");const a=new DOMParser().parseFromString(i,"image/svg+xml"),l=a.querySelector("parsererror");if(l)throw new Error(`SVG parse error: ${l.textContent}`);const c=a.documentElement;if(c.tagName!=="svg")throw new Error("Invalid SVG: root element is not <svg>");const d=BE(c,t);console.log("[SVG-RECOLOR] Recoloring complete:",d);const p=new XMLSerializer().serializeToString(a),h=new Blob([p],{type:"image/svg+xml"});return{dataUrl:URL.createObjectURL(h),svgText:p,stats:d}}catch(r){throw console.error("[SVG-RECOLOR] Error:",r),r}}function BE(e,t){const n={totalElements:0,fillsReplaced:0,strokesReplaced:0,stopColorsReplaced:0,stylesProcessed:0,colorsNotMapped:new Set},r=e.querySelectorAll("*");n.totalElements=r.length;for(const a of r){const l=a.getAttribute("fill");if(l&&l!=="none"){const p=Hr(l,t,n.colorsNotMapped);p!==l&&(p==="transparent"||p==="none"?(a.setAttribute("fill","none"),a.setAttribute("fill-opacity","0")):a.setAttribute("fill",p),n.fillsReplaced++)}const c=a.getAttribute("stroke");if(c&&c!=="none"){const p=Hr(c,t,n.colorsNotMapped);p!==c&&(p==="transparent"||p==="none"?(a.setAttribute("stroke","none"),a.setAttribute("stroke-opacity","0")):a.setAttribute("stroke",p),n.strokesReplaced++)}const d=a.getAttribute("stop-color");if(d&&d!=="none"){const p=Hr(d,t,n.colorsNotMapped);p!==d&&(a.setAttribute("stop-color",p),n.stopColorsReplaced++)}const u=a.getAttribute("style");if(u){const p=T0(u,t,n);p!==u&&(a.setAttribute("style",p),n.stylesProcessed++)}}const i=e.querySelectorAll("style");for(const a of i){const l=a.textContent,c=UE(l,t,n);c!==l&&(a.textContent=c,n.stylesProcessed++)}const s=e.querySelectorAll("stop");for(const a of s){const l=a.getAttribute("stop-color");if(l&&l!=="none"){const d=Hr(l,t,n.colorsNotMapped);d!==l&&(a.setAttribute("stop-color",d),n.stopColorsReplaced++)}const c=a.getAttribute("style");if(c&&c.includes("stop-color")){const d=T0(c,t,n);d!==c&&(a.setAttribute("style",d),n.stylesProcessed++)}}return n}function Hr(e,t,n){const r=WE(e);if(!r)return e;const i=`#${r}`,s=t.get(i);if(s)return s.blendHex;const a=C0(r);if(!a)return e;const l=E0(a);let c=null,d=1/0;for(const[u,p]of t.entries()){const h=C0(u.replace("#",""));if(!h)continue;const f=E0(h),m=HE(l,f);if(m<d&&(d=m,c=p),m<=9)return console.log(`[SVG-RECOLOR] Tolerance match: ${i}  ${u} (E=${m.toFixed(2)})`),p.blendHex}return c?(console.log(`[SVG-RECOLOR] Fallback to nearest: ${i}  ${c.blendHex} (E=${d.toFixed(2)})`),n&&n.add(e),c.blendHex):(console.warn(`[SVG-RECOLOR] No mapping found: ${i}`),e)}function C0(e){if(e.length!==6)return null;const t=parseInt(e.substring(0,2),16),n=parseInt(e.substring(2,4),16),r=parseInt(e.substring(4,6),16);return isNaN(t)||isNaN(n)||isNaN(r)?null:{r:t,g:n,b:r}}function E0(e){let t=e.r/255,n=e.g/255,r=e.b/255;t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92,n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92,r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92;const i=(t*.4124+n*.3576+r*.1805)*100,s=(t*.2126+n*.7152+r*.0722)*100,a=(t*.0193+n*.1192+r*.9505)*100,l=95.047,c=100,d=108.883;let u=i/l,p=s/c,h=a/d;return u=u>.008856?Math.pow(u,1/3):7.787*u+16/116,p=p>.008856?Math.pow(p,1/3):7.787*p+16/116,h=h>.008856?Math.pow(h,1/3):7.787*h+16/116,{L:116*p-16,a:500*(u-p),b:200*(p-h)}}function HE(e,t){const s=Math.PI*2,a=Math.PI,l=(e.L+t.L)/2,c=Math.sqrt(e.a*e.a+e.b*e.b),d=Math.sqrt(t.a*t.a+t.b*t.b),u=(c+d)/2,p=.5*(1-Math.sqrt(Math.pow(u,7)/(Math.pow(u,7)+Math.pow(25,7)))),h=e.a*(1+p),f=t.a*(1+p),m=Math.sqrt(h*h+e.b*e.b),g=Math.sqrt(f*f+t.b*t.b),x=(m+g)/2;let y=Math.atan2(e.b,h);y<0&&(y+=s);let v=Math.atan2(t.b,f);v<0&&(v+=s);const b=Math.abs(y-v)>a?(y+v+s)/2:(y+v)/2,w=1-.17*Math.cos(b-Math.PI/6)+.24*Math.cos(2*b)+.32*Math.cos(3*b+Math.PI/30)-.2*Math.cos(4*b-63*Math.PI/180);let C=v-y;Math.abs(C)>a&&(C=C>0?C-s:C+s);const _=t.L-e.L,j=g-m,E=2*Math.sqrt(m*g)*Math.sin(C/2),T=1+.015*Math.pow(l-50,2)/Math.sqrt(20+Math.pow(l-50,2)),M=1+.045*x,J=1+.015*x*w,P=30*Math.PI/180*Math.exp(-Math.pow((b-275*Math.PI/180)/(25*Math.PI/180),2)),k=-(2*Math.sqrt(Math.pow(x,7)/(Math.pow(x,7)+Math.pow(25,7))))*Math.sin(2*P);return Math.sqrt(Math.pow(_/(1*T),2)+Math.pow(j/(1*M),2)+Math.pow(E/(1*J),2)+k*(j/(1*M))*(E/(1*J)))}function T0(e,t,n){let r=e;return r=r.replace(/fill:\s*([^;]+)/gi,(i,s)=>`fill: ${Hr(s.trim(),t,n.colorsNotMapped)}`),r=r.replace(/stroke:\s*([^;]+)/gi,(i,s)=>`stroke: ${Hr(s.trim(),t,n.colorsNotMapped)}`),r=r.replace(/stop-color:\s*([^;]+)/gi,(i,s)=>`stop-color: ${Hr(s.trim(),t,n.colorsNotMapped)}`),r}function UE(e,t,n){let r=e,i=0;return r=r.replace(/fill:\s*([^;}\s]+)/gi,(s,a)=>{const l=a.trim(),c=Hr(l,t,n.colorsNotMapped);return c!==l&&(i++,console.log(`[SVG-RECOLOR-CSS] Replaced fill: ${l}  ${c}`)),`fill: ${c}`}),r=r.replace(/stroke:\s*([^;}\s]+)/gi,(s,a)=>{const l=a.trim(),c=Hr(l,t,n.colorsNotMapped);return c!==l&&(i++,console.log(`[SVG-RECOLOR-CSS] Replaced stroke: ${l}  ${c}`)),`stroke: ${c}`}),r=r.replace(/stop-color:\s*([^;}\s]+)/gi,(s,a)=>{const l=a.trim(),c=Hr(l,t,n.colorsNotMapped);return c!==l&&(i++,console.log(`[SVG-RECOLOR-CSS] Replaced stop-color: ${l}  ${c}`)),`stop-color: ${c}`}),i>0&&console.log(`[SVG-RECOLOR-CSS] Total CSS color replacements: ${i}`),r}function WE(e){const t=e.trim().toLowerCase();if(t.match(/^#?[0-9a-f]{6}$/))return FE(t);const n=t.match(/^#?([0-9a-f]{3})$/);if(n)return n[1].split("").map(a=>a+a).join("");const r=t.match(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/);if(r){const s=parseInt(r[1],10),a=parseInt(r[2],10),l=parseInt(r[3],10);return GE(s,a,l)}const i={white:"ffffff",black:"000000",red:"ff0000",green:"008000",blue:"0000ff",yellow:"ffff00",cyan:"00ffff",magenta:"ff00ff",gray:"808080",grey:"808080",orange:"ffa500",purple:"800080"};return i[t]?i[t]:null}function GE(e,t,n){const r=i=>Math.max(0,Math.min(255,i)).toString(16).padStart(2,"0");return`${r(e)}${r(t)}${r(n)}`}function $o(e){const n=new DOMParser().parseFromString(e,"image/svg+xml"),r=n.querySelector("parsererror");if(r)return console.error("[SVG-REGION-TAGGER] Parse error:",r.textContent),e;const i=n.documentElement;if(!i.hasAttribute("viewBox")){const l=i.getAttribute("width"),c=i.getAttribute("height");if(l&&c){const d=parseFloat(l),u=parseFloat(c);!isNaN(d)&&!isNaN(u)&&(i.setAttribute("viewBox",`0 0 ${d} ${u}`),console.log(`[SVG-REGION-TAGGER] Added viewBox from dimensions: 0 0 ${d} ${u}`))}else{const d=VE(n);d&&(i.setAttribute("viewBox",`${d.x} ${d.y} ${d.width} ${d.height}`),console.log(`[SVG-REGION-TAGGER] Added viewBox from content bounds: ${d.x} ${d.y} ${d.width} ${d.height}`))}}let s=0;return n.querySelectorAll("path, rect, circle, ellipse, polygon, polyline, line").forEach(l=>{l.hasAttribute("data-region-id")||l.setAttribute("data-region-id",`region-${s++}`)}),console.log(`[SVG-REGION-TAGGER] Tagged ${s} regions`),new XMLSerializer().serializeToString(n)}function VE(e){try{const t=e.documentElement.cloneNode(!0),n=document.createElement("div");n.style.position="absolute",n.style.visibility="hidden",document.body.appendChild(n),n.appendChild(t);const r=t.getBBox();if(document.body.removeChild(n),r.width>0&&r.height>0)return{x:Math.floor(r.x),y:Math.floor(r.y),width:Math.ceil(r.width),height:Math.ceil(r.height)}}catch(t){console.warn("[SVG-REGION-TAGGER] Could not calculate content bounds:",t)}return null}function Eo(e,t){if(!t||t.size===0)return e;const r=new DOMParser().parseFromString(e,"image/svg+xml"),i=r.querySelector("parsererror");if(i)return console.error("[SVG-REGION-OVERRIDES] Parse error:",i.textContent),e;let s=0;return t.forEach((a,l)=>{const c=typeof a=="string"?a:a.hex,d=r.querySelector(`[data-region-id="${l}"]`);if(d){const u=c==="transparent"||c==="none";if((d.hasAttribute("fill")||u)&&(u?(d.setAttribute("fill","none"),d.setAttribute("fill-opacity","0")):(d.setAttribute("fill",c),d.removeAttribute("fill-opacity")),s++),d.hasAttribute("stroke")&&d.getAttribute("stroke")!=="none"){const h=d.getAttribute("stroke");h&&h!=="#000"&&h!=="#000000"&&h!=="#fff"&&h!=="#ffffff"&&(u?(d.setAttribute("stroke","none"),d.setAttribute("stroke-opacity","0")):d.setAttribute("stroke",c))}const p=d.getAttribute("style");if(p&&p.includes("fill:"))if(u){const h=p.replace(/fill:\s*[^;]+/,"fill: none");d.setAttribute("style",h)}else{const h=p.replace(/fill:\s*[^;]+/,`fill: ${c}`);d.setAttribute("style",h)}}else console.warn(`[SVG-REGION-OVERRIDES] Region not found: ${l}`)}),console.log(`[SVG-REGION-OVERRIDES] Applied ${s} region overrides`),new XMLSerializer().serializeToString(r)}async function qw(e){var y,v;const t=await _l(e),n=(t==null?void 0:t.design)||t;if(!n)throw new Error("Design not found");if(n.input_mode==="sports_surface")throw new Error("Cannot use a sports surface design as a motif");const r=n.original_svg_url;if(!r||r.startsWith("blob:"))throw new Error("Design does not have a valid original SVG. Please ensure the design was saved after generation.");if(!n.solid_color_mapping&&!n.color_mapping)throw new Error("Design does not have color mappings. Please ensure the design was saved after color mapping.");console.log("[MOTIF] Fetching original SVG from:",r);const i=((y=n.design_data)==null?void 0:y.region_overrides)||n.region_overrides||null,s=((v=n.design_data)==null?void 0:v.original_tagged_svg)||n.original_tagged_svg||null;console.log("[MOTIF] Region overrides:",i?Object.keys(i).length:0,"regions"),console.log("[MOTIF] Original tagged SVG:",s?"present":"not present");const a=i?new Map(Object.entries(i)):null,l=await qE(r);if(!l)throw new Error("Failed to load or sanitize the original SVG.");console.log("[MOTIF] Original SVG loaded, regenerating recolored versions...");let c=null,d=null;if(n.solid_color_mapping&&Object.keys(n.solid_color_mapping).length>0)try{const b=N0(n.solid_color_mapping);console.log("[MOTIF] Solid mapping has",b.size,"colors");const{svgText:w}=await vs(null,b,l);if(c=w,console.log("[MOTIF] Generated solid SVG:",c.length,"chars"),a&&a.size>0&&c){console.log("[MOTIF] Applying",a.size,"region overrides to solid SVG");let C=c;C=$o(c),c=Eo(C,a),console.log("[MOTIF] Applied region overrides to solid SVG")}}catch(b){console.error("[MOTIF] Failed to generate solid SVG:",b)}if(n.color_mapping&&Object.keys(n.color_mapping).length>0)try{const b=N0(n.color_mapping);console.log("[MOTIF] Blend mapping has",b.size,"colors");const{svgText:w}=await vs(null,b,l);if(d=w,console.log("[MOTIF] Generated blend SVG:",d.length,"chars"),a&&a.size>0&&d){console.log("[MOTIF] Applying",a.size,"region overrides to blend SVG");let C=$o(d);d=Eo(C,a),console.log("[MOTIF] Applied region overrides to blend SVG")}}catch(b){console.error("[MOTIF] Failed to generate blend SVG:",b)}if(!c&&!d)throw new Error("Failed to regenerate TPV-recolored SVG versions.");const u=n.dimensions||{};let p=u.widthMM||u.width_mm||5e3,h=u.lengthMM||u.length_mm||5e3;const f=p===5e3&&h===5e3,m=c||d;if(m){const b=kf(m);if(b&&b.width&&b.height){const w=b.width/b.height;(f||Math.abs(w-1)>.01)&&(w>1?(p=5e3,h=Math.round(5e3/w)):w<1&&(h=5e3,p=Math.round(5e3*w)),console.log("[MOTIF] Corrected dimensions from SVG viewBox:",p,"x",h,"mm (aspect ratio:",w.toFixed(3),")"))}}const g=n.thumbnail_url||n.original_png_url||null,x=c&&d;return{sourceDesignId:e,sourceDesignName:n.name||"Unnamed Design",sourceThumbnailUrl:g,solidSvgContent:c,blendSvgContent:d,svgContent:c||d,hasBothVersions:x,originalWidth_mm:p,originalHeight_mm:h}}function N0(e){const t=new Map;if(!e||typeof e!="object")return t;for(const[n,r]of Object.entries(e)){const i=n.startsWith("#")?n:`#${n}`;t.set(i,r)}return t}async function qE(e){try{console.log("[MOTIF] Fetching SVG from:",e);const t=await fetch(e);if(!t.ok)return console.error("[MOTIF] Failed to fetch SVG:",t.status,t.statusText),null;const n=await t.text();if(console.log("[MOTIF] Fetched content length:",n.length,"chars"),console.log("[MOTIF] Content starts with:",n.substring(0,100)),!zE(n))return console.error("[MOTIF] SVG failed quick validation"),null;const r=Sf(n);return r?(console.log("[MOTIF] Sanitized SVG length:",r.length,"chars"),r):(console.error("[MOTIF] SVG sanitization failed"),null)}catch(t){return console.error("[MOTIF] Error fetching SVG:",t),null}}async function Yw(e={}){const t=await rd(e);return{designs:(t.designs||[]).filter(r=>r.input_mode==="sports_surface"?!1:r.thumbnail_url||r.original_svg_url||r.original_png_url),pagination:t.pagination}}function kf(e){if(!e)return null;const t=e.match(/viewBox=["']([^"']+)["']/i);if(t){const i=t[1].split(/\s+/).map(Number);if(i.length>=4)return{width:i[2],height:i[3]}}const n=e.match(/\bwidth=["']?(\d+(?:\.\d+)?)/i),r=e.match(/\bheight=["']?(\d+(?:\.\d+)?)/i);return n&&r?{width:parseFloat(n[1]),height:parseFloat(r[1])}:null}const YE=Object.freeze(Object.defineProperty({__proto__:null,extractSVGDimensions:kf,fetchMotifFromDesign:qw,listPlaygroundDesigns:Yw},Symbol.toStringTag,{value:"Module"}));function P0({onOpenGenerator:e,mobileMode:t=!1,activeTab:n,onItemAdded:r}){const[i,s]=R.useState(null),[a,l]=R.useState("courts"),c=t?n:a,d=t?()=>{}:l,[u,p]=R.useState([]),[h,f]=R.useState(!1),[m,g]=R.useState(null),[x,y]=R.useState(null),{addCourt:v,addTrack:b,addMotif:w,addShape:C,courts:_,tracks:j,motifs:E,shapes:T}=st(),M=Object.keys(_).length,J=Object.keys(j).length,P=Object.keys(E).length,q=WC(),k=$E();R.useEffect(()=>{c==="designs"&&u.length===0&&!h&&z()},[c]);const z=async()=>{f(!0),g(null);try{const re=await Yw({limit:50});p(re.designs||[])}catch(re){console.error("[MOTIFS] Failed to load designs:",re),g(re.message||"Failed to load designs")}finally{f(!1)}},he=re=>{const se=GC(re);se&&(v(re,se),t&&r&&r())},Z=re=>{const se=LE(re);se&&(b(re,se),t&&r&&r())},K=async re=>{if(!x){y(re);try{const se=await qw(re);w(se.sourceDesignId,se.sourceDesignName,se.svgContent,se.originalWidth_mm,se.originalHeight_mm,se.sourceThumbnailUrl,{solidSvgContent:se.solidSvgContent,blendSvgContent:se.blendSvgContent,hasBothVersions:se.hasBothVersions}),t&&r&&r()}catch(se){console.error("[MOTIFS] Failed to add motif:",se),alert(`Failed to add motif: ${se.message}`)}finally{y(null)}}},H=[{id:"rectangle",name:"Rectangle",icon:""},{id:"square",name:"Square",icon:""},{id:"circle",name:"Circle",icon:""},{id:"triangle",name:"Triangle",icon:""},{id:"pentagon",name:"Pentagon",icon:""},{id:"hexagon",name:"Hexagon",icon:""},{id:"blob",name:"Blob",icon:""}],X=Object.keys(T||{}).length,W=(()=>{switch(c){case"courts":return{title:"Courts",count:M,hint:"Select a court to add"};case"tracks":return{title:"Tracks",count:J,hint:"Select a track to add"};case"shapes":return{title:"Shapes",count:X,hint:"Tap a shape to add it"};case"designs":return{title:"Designs",count:P,hint:"Add your saved designs as motifs"};default:return{title:"Library",count:0,hint:""}}})();return o.jsxs("div",{className:`court-library ${t?"court-library--mobile":""}`,children:[!t&&o.jsxs("div",{className:"court-library__header",children:[o.jsxs("div",{className:"court-library__header-row",children:[o.jsx("h2",{children:W.title}),o.jsxs("span",{className:"court-library__count",children:[W.count," on canvas"]})]}),o.jsx("p",{children:W.hint})]}),!t&&o.jsxs("div",{className:"court-library__tabs",children:[o.jsx("button",{className:`court-library__tab ${c==="courts"?"court-library__tab--active":""}`,onClick:()=>{d("courts"),s(null)},children:"Courts"}),o.jsx("button",{className:`court-library__tab ${c==="tracks"?"court-library__tab--active":""}`,onClick:()=>{d("tracks"),s(null)},children:"Tracks"}),o.jsx("button",{className:`court-library__tab ${c==="designs"?"court-library__tab--active":""}`,onClick:()=>{d("designs"),s(null)},children:"Designs"})]}),o.jsxs("div",{className:`court-library__list ${t?"court-library__list--mobile":""}`,children:[c==="courts"&&q.map(re=>o.jsxs("div",{className:`court-library__item ${i===re.id?"court-library__item--selected":""}`,onClick:()=>t?he(re.id):s(re.id),onDoubleClick:()=>!t&&he(re.id),children:[o.jsx("div",{className:"court-library__preview",children:o.jsx(XE,{template:re})}),o.jsxs("div",{className:"court-library__info",children:[o.jsx("div",{className:"court-library__name",children:re.name}),o.jsxs("div",{className:"court-library__dimensions",children:[(re.dimensions.width_mm/1e3).toFixed(1),"m  ",(re.dimensions.length_mm/1e3).toFixed(1),"m"]}),o.jsx("div",{className:"court-library__standard",children:re.standard})]}),i===re.id&&o.jsx("button",{className:"court-library__add-btn",onClick:se=>{se.stopPropagation(),he(re.id)},children:"+ ADD"})]},re.id)),c==="tracks"&&k.map(re=>o.jsxs("div",{className:`court-library__item ${i===re.id?"court-library__item--selected":""}`,onClick:()=>t?Z(re.id):s(re.id),onDoubleClick:()=>!t&&Z(re.id),children:[o.jsx("div",{className:"court-library__preview",children:o.jsx(KE,{template:re})}),o.jsxs("div",{className:"court-library__info",children:[o.jsx("div",{className:"court-library__name",children:re.name}),o.jsxs("div",{className:"court-library__standard",children:[re.parameters.numLanes," Lanes  ",re.standard]}),o.jsx("div",{className:"court-library__note",children:"Scales to fit canvas"})]}),i===re.id&&o.jsx("button",{className:"court-library__add-btn",onClick:se=>{se.stopPropagation(),Z(re.id)},children:"+ ADD"})]},re.id)),c==="shapes"&&o.jsx("div",{className:`court-library__shapes-grid ${t?"court-library__shapes-grid--mobile":""}`,children:H.map(re=>o.jsxs("button",{className:"court-library__shape-btn",onClick:()=>{C(re.id),t&&r&&r()},children:[o.jsx("span",{className:"court-library__shape-icon",children:re.icon}),o.jsx("span",{className:"court-library__shape-name",children:re.name})]},re.id))}),c==="designs"&&o.jsxs(o.Fragment,{children:[h&&o.jsxs("div",{className:"court-library__loading",children:[o.jsx("div",{className:"court-library__spinner"}),o.jsx("p",{children:"Loading your designs..."})]}),m&&o.jsxs("div",{className:"court-library__error",children:[o.jsx("p",{children:m}),o.jsx("button",{onClick:z,children:"Try Again"})]}),!h&&!m&&u.length===0&&o.jsxs("div",{className:"court-library__empty",children:[o.jsx("p",{children:"No designs found."}),o.jsx("p",{className:"court-library__empty-hint",children:"Generate new designs or save them to use as motifs."})]}),!h&&u.map(re=>{var se,me;return o.jsxs("div",{className:`court-library__item ${i===re.id?"court-library__item--selected":""} ${x===re.id?"court-library__item--loading":""}`,onClick:()=>t?K(re.id):s(re.id),onDoubleClick:()=>!t&&K(re.id),children:[o.jsx("div",{className:"court-library__preview",children:o.jsx(JE,{design:re})}),o.jsxs("div",{className:"court-library__info",children:[o.jsx("div",{className:"court-library__name",children:re.name||"Unnamed Design"}),o.jsxs("div",{className:"court-library__dimensions",children:[((((se=re.design_data)==null?void 0:se.widthMM)||5e3)/1e3).toFixed(1),"m  ",((((me=re.design_data)==null?void 0:me.lengthMM)||5e3)/1e3).toFixed(1),"m"]}),o.jsx("div",{className:"court-library__note",children:"Playground Design"})]}),i===re.id&&o.jsx("button",{className:"court-library__add-btn",onClick:ke=>{ke.stopPropagation(),K(re.id)},disabled:x===re.id,children:x===re.id?"Adding...":"+ ADD"})]},re.id)})]})]}),!t&&o.jsx("div",{className:"court-library__generate",children:o.jsxs("button",{className:"court-library__generate-btn",onClick:e,children:[o.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M12 5v14M5 12h14"})}),"Generate New Design"]})}),!t&&o.jsx("div",{className:"court-library__footer",children:o.jsxs("p",{className:"court-library__hint",children:[c==="courts"&&"Double-click a court to add it instantly",c==="tracks"&&"Double-click a track to add it instantly",c==="designs"&&"Double-click a design to add it as a motif"]})})]})}function XE({template:e}){const t=e.dimensions.width_mm,n=e.dimensions.length_mm,r=Math.min(62/t,62/n),i=t*r,s=n*r;return o.jsxs("svg",{width:"62",height:"62",viewBox:"0 0 62 62",className:"court-library__svg-preview",children:[o.jsx("rect",{x:(62-i)/2,y:(62-s)/2,width:i,height:s,fill:"#e5e7eb",stroke:"#9ca3af",strokeWidth:"1.5"}),e.markings.map((a,l)=>o.jsx(ZE,{marking:a,scale:r,offsetX:(62-i)/2,offsetY:(62-s)/2},l))]})}function ZE({marking:e,scale:t,offsetX:n,offsetY:r}){const{type:i,params:s}=e;switch(i){case"line":return o.jsx("line",{x1:s.x1*t+n,y1:s.y1*t+r,x2:s.x2*t+n,y2:s.y2*t+r,stroke:"#1e293b",strokeWidth:"1.5"});case"rectangle":return o.jsx("rect",{x:s.x*t+n,y:s.y*t+r,width:s.width*t,height:s.height*t,stroke:"#1e293b",strokeWidth:"1.5",fill:"none"});case"circle":return o.jsx("circle",{cx:s.cx*t+n,cy:s.cy*t+r,r:s.radius*t,stroke:"#1e293b",strokeWidth:"1.5",fill:"none"});case"arc":{const{cx:a,cy:l,radius:c,startAngle:d,endAngle:u}=s,p=d*Math.PI/180,h=u*Math.PI/180,f=(a+c*Math.cos(p))*t+n,m=(l+c*Math.sin(p))*t+r,g=(a+c*Math.cos(h))*t+n,x=(l+c*Math.sin(h))*t+r,y=u-d>180?1:0,v=`M ${f} ${m} A ${c*t} ${c*t} 0 ${y} 1 ${g} ${x}`;return o.jsx("path",{d:v,stroke:"#1e293b",strokeWidth:"1.5",fill:"none"})}default:return null}}function KE({template:e}){const{parameters:t}=e,n=t.width_mm,r=t.height_mm,i=Math.min(58/n,58/r),s=n*i,a=r*i,l=t.numLanes,c=t.laneWidth_mm*i,d=t.cornerRadius,p=(d.topLeft+d.topRight+d.bottomLeft+d.bottomRight)/4*i,h=(62-s)/2,f=(62-a)/2;return o.jsxs("svg",{width:"62",height:"62",viewBox:"0 0 62 62",className:"court-library__svg-preview",children:[o.jsx("rect",{x:h,y:f,width:s,height:a,rx:p,fill:"#e5e7eb"}),Array.from({length:l}).map((m,g)=>{const x=g*c,y=Math.max(0,p-x);return o.jsx("rect",{x:h+x,y:f+x,width:Math.max(0,s-x*2),height:Math.max(0,a-x*2),rx:y,stroke:"#1e293b",strokeWidth:"1",fill:"none"},g)})]})}function JE({design:e}){const t=e.thumbnail_url||e.original_png_url;return t?o.jsx("img",{src:t,alt:e.name||"Design preview",className:"court-library__motif-img",style:{width:"62px",height:"62px",objectFit:"contain",borderRadius:"4px",backgroundColor:"#f3f4f6"},onError:n=>{n.target.style.display="none",n.target.nextSibling&&(n.target.nextSibling.style.display="flex")}}):o.jsx("div",{className:"court-library__motif-placeholder",style:{width:"62px",height:"62px",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#e5e7eb",borderRadius:"4px",color:"#9ca3af",fontSize:"10px",textAlign:"center"},children:"No Preview"})}function R0({onEditSourceDesign:e}){var Ge,$e;const{courts:t,tracks:n,motifs:r,shapes:i,texts:s,exclusionZones:a,selectedCourtId:l,selectedTrackId:c,selectedMotifId:d,selectedShapeId:u,selectedTextId:p,selectedExclusionZoneId:h,updateCourtPosition:f,updateCourtRotation:m,updateCourtScale:g,setLineColor:x,setZoneColor:y,setCourtSurfaceColor:v,resetCourtColors:b,removeCourt:w,removeTrack:C,removeMotif:_,updateMotifPosition:j,updateMotifRotation:E,updateMotifScale:T,updateTrackParameters:M,addToHistory:J}=st(),[P,q]=R.useState("transform"),[k,z]=R.useState(null);if(h){const we=a[h];return we?o.jsx(r5,{zone:we,zoneId:h}):null}if(p){const we=s[p];return we?o.jsx(n5,{text:we,textId:p}):null}if(u){const we=i[u];return we?o.jsx(t5,{shape:we,shapeId:u}):null}if(d){const we=r[d];return we?o.jsx(e5,{motif:we,motifId:d,onEditSourceDesign:e}):null}if(c){const we=n[c];return we?o.jsx(QE,{track:we,trackId:c}):null}if(!l)return o.jsx("div",{className:"properties-panel properties-panel--empty",children:o.jsxs("div",{className:"properties-panel__empty-state",children:[o.jsx("p",{children:"No element selected"}),o.jsx("span",{className:"properties-panel__hint",children:"Click on a court, track, or motif to view and edit its properties"})]})});const he=t[l];if(!he)return null;const{position:Z,rotation:K,scale:H,template:X,lineColorOverrides:F,zoneColorOverrides:W}=he,re=(we,xe)=>{const S=parseFloat(xe);isNaN(S)||f(l,{...Z,[we]:S})},se=we=>{const xe=parseFloat(we);isNaN(xe)||m(l,xe)},me=we=>{const xe=parseFloat(we);isNaN(xe)||xe<=0||g(l,xe)},ke=()=>{window.confirm(`Delete ${X.name}? This action cannot be undone.`)&&w(l)},pe=we=>{if(!k)return;if(k.type==="courtSurface"&&we===null){v(l,null),z(null);return}if(!we)return;const xe={tpv_code:we.code,hex:we.hex,name:we.name};k.type==="line"?x(l,k.id,xe):k.type==="zone"?y(l,k.id,xe):k.type==="courtSurface"?v(l,xe):k.type==="allLines"&&X.markings.forEach(S=>{x(l,S.id,xe)}),z(null)},Pe=we=>{const xe=F[we.id];if(xe)return{code:xe.tpv_code,hex:xe.hex,name:xe.name};const S=dn.find(ue=>ue.code===X.defaultLineColor);return S?{code:S.code,hex:S.hex,name:S.name}:null},Re=we=>{const xe=W[we.id];if(xe)return{code:xe.tpv_code,hex:xe.hex,name:xe.name};const S=dn.find(ue=>ue.code===we.defaultColor);return S?{code:S.code,hex:S.hex,name:S.name}:null};return o.jsxs("div",{className:"properties-panel",children:[o.jsxs("div",{className:"properties-panel__header",children:[o.jsx("h3",{children:"Properties"}),o.jsxs("div",{className:"properties-panel__court-info",children:[o.jsx("span",{className:"court-name",children:X.name}),o.jsx("span",{className:"court-standard",children:X.standard})]})]}),o.jsxs("div",{className:"properties-panel__tabs",children:[o.jsx("button",{className:`tab ${P==="transform"?"tab--active":""}`,onClick:()=>q("transform"),children:"Transform"}),o.jsx("button",{className:`tab ${P==="lines"?"tab--active":""}`,onClick:()=>q("lines"),children:"Lines"}),o.jsx("button",{className:`tab ${P==="zones"?"tab--active":""}`,onClick:()=>q("zones"),children:"Zones"})]}),o.jsxs("div",{className:"properties-panel__content",children:[P==="transform"&&o.jsxs("div",{className:"properties-section",children:[o.jsx("div",{className:"properties-section__header",children:o.jsx("h4",{children:"Transform"})}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Position"}),o.jsxs("div",{className:"property-input-row",children:[o.jsxs("div",{className:"property-input-group",children:[o.jsx("span",{className:"property-label",children:"X"}),o.jsx("input",{type:"number",value:Math.round(Z.x),onChange:we=>re("x",we.target.value),step:"100"}),o.jsx("span",{className:"property-unit",children:"mm"})]}),o.jsxs("div",{className:"property-input-group",children:[o.jsx("span",{className:"property-label",children:"Y"}),o.jsx("input",{type:"number",value:Math.round(Z.y),onChange:we=>re("y",we.target.value),step:"100"}),o.jsx("span",{className:"property-unit",children:"mm"})]})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Rotation"}),o.jsxs("div",{className:"property-input-row",children:[o.jsx("input",{type:"range",min:"0",max:"360",value:K,onChange:we=>se(we.target.value),className:"property-slider"}),o.jsxs("div",{className:"property-input-group property-input-group--compact",children:[o.jsx("input",{type:"number",value:Math.round(K),onChange:we=>se(we.target.value),min:"0",max:"360"}),o.jsx("span",{className:"property-unit",children:""})]})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Scale"}),o.jsxs("div",{className:"property-input-row",children:[o.jsx("input",{type:"range",min:"0.5",max:"2.0",step:"0.1",value:H,onChange:we=>me(we.target.value),className:"property-slider"}),o.jsxs("div",{className:"property-input-group property-input-group--compact",children:[o.jsx("input",{type:"number",value:H.toFixed(2),onChange:we=>me(we.target.value),min:"0.5",max:"2.0",step:"0.1"}),o.jsx("span",{className:"property-unit",children:""})]})]})]}),o.jsxs("div",{className:"property-group property-group--info",children:[o.jsx("label",{children:"Dimensions"}),o.jsx("div",{className:"property-info",children:o.jsxs("span",{children:[(X.dimensions.width_mm*H/1e3).toFixed(1),"m  ",(X.dimensions.length_mm*H/1e3).toFixed(1),"m"]})})]}),o.jsx("div",{className:"property-group property-group--actions",children:o.jsx("button",{className:"btn-delete",onClick:ke,title:"Delete court (Delete key)",children:" Delete Court"})})]}),P==="lines"&&o.jsxs("div",{className:"properties-section",children:[o.jsxs("div",{className:"properties-section__header",children:[o.jsx("h4",{children:"Line Markings"}),o.jsx("button",{className:"btn-reset",onClick:()=>b(l),title:"Reset all colours to defaults",children:"Reset"})]}),o.jsxs("div",{className:"color-item color-item--all-lines",children:[o.jsxs("div",{className:"color-item__info",children:[o.jsx("span",{className:"color-item__name",children:"Change All Lines"}),o.jsx("span",{className:"color-item__hint",children:"Set all lines to same colour"})]}),o.jsx("button",{className:"color-item__swatch color-item__swatch--all",onClick:()=>z({type:"allLines"}),title:"Change all line colours at once",children:o.jsx("span",{style:{fontSize:"1rem"},children:""})})]}),o.jsx("div",{className:"color-list",children:X.markings.map(we=>{const xe=Pe(we);return o.jsxs("div",{className:"color-item",children:[o.jsxs("div",{className:"color-item__info",children:[o.jsx("span",{className:"color-item__name",children:we.name}),xe&&o.jsx("span",{className:"color-item__code",children:xe.code})]}),o.jsx("button",{className:"color-item__swatch",style:{backgroundColor:(xe==null?void 0:xe.hex)||"#000"},onClick:()=>z({type:"line",id:we.id}),title:(xe==null?void 0:xe.name)||"Select colour"})]},we.id)})})]}),P==="zones"&&o.jsxs("div",{className:"properties-section",children:[o.jsx("div",{className:"properties-section__header",children:o.jsx("h4",{children:"Fill Colours"})}),o.jsxs("div",{className:"color-item color-item--surface-fill",children:[o.jsxs("div",{className:"color-item__info",children:[o.jsx("span",{className:"color-item__name",children:"Court Surface"}),o.jsx("span",{className:"color-item__hint",children:he.courtSurfaceColor?he.courtSurfaceColor.name:"No Fill (transparent)"}),he.courtSurfaceColor&&o.jsx("span",{className:"color-item__code",children:he.courtSurfaceColor.tpv_code})]}),o.jsx("button",{className:`color-item__swatch ${he.courtSurfaceColor?"":"color-item__swatch--no-fill"}`,style:{backgroundColor:((Ge=he.courtSurfaceColor)==null?void 0:Ge.hex)||"transparent"},onClick:()=>z({type:"courtSurface"}),title:(($e=he.courtSurfaceColor)==null?void 0:$e.name)||"No Fill - Click to select colour"})]}),X.zones&&X.zones.length>0&&o.jsx("div",{className:"properties-section__divider",children:o.jsx("span",{children:"Paint Zones"})}),X.zones&&X.zones.length>0&&o.jsx("div",{className:"color-list",children:X.zones.map(we=>{var S;const xe=Re(we);return o.jsxs("div",{className:"color-item",children:[o.jsxs("div",{className:"color-item__info",children:[o.jsx("span",{className:"color-item__name",children:we.name}),o.jsxs("span",{className:"color-item__area",children:[((S=we.area_m2)==null?void 0:S.toFixed(1))||0," m"]}),xe&&o.jsx("span",{className:"color-item__code",children:xe.code})]}),o.jsx("button",{className:"color-item__swatch",style:{backgroundColor:(xe==null?void 0:xe.hex)||"#000"},onClick:()=>z({type:"zone",id:we.id}),title:(xe==null?void 0:xe.name)||"Select colour"})]},we.id)})})]})]}),k&&o.jsx("div",{className:"color-picker-modal",onClick:()=>z(null),children:o.jsxs("div",{className:"color-picker-modal__content",onClick:we=>we.stopPropagation(),children:[o.jsxs("div",{className:"color-picker-modal__header",children:[o.jsx("h4",{children:k.type==="allLines"?"Change All Line Colours":k.type==="courtSurface"?"Select Court Fill Colour":"Select TPV Colour"}),o.jsx("button",{onClick:()=>z(null),children:""})]}),o.jsxs("div",{className:"color-picker-grid",children:[k.type==="courtSurface"&&o.jsx("button",{className:"color-picker-swatch color-picker-swatch--no-fill",onClick:()=>pe(null),title:"No Fill (transparent)",children:o.jsx("span",{className:"color-picker-swatch__code",children:"None"})}),dn.map(we=>o.jsx("button",{className:"color-picker-swatch",style:{backgroundColor:we.hex},onClick:()=>pe(we),title:`${we.code} - ${we.name}`,children:o.jsx("span",{className:"color-picker-swatch__code",children:we.code})},we.code))]})]})})]})}function QE({track:e,trackId:t}){var ge,V,$;const{updateTrackParameters:n,updateTrackRotation:r,removeTrack:i,setTrackSurfaceColor:s,setTrackLineColor:a,addToHistory:l}=st(),{parameters:c,template:d,trackSurfaceColor:u,trackLineColor:p,rotation:h}=e,[f,m]=L.useState(!0),[g,x]=L.useState(!1),[y,v]=L.useState(!1),[b,w]=L.useState(""),[C,_]=L.useState(""),[j,E]=L.useState(""),[T,M]=L.useState(!1),[J,P]=L.useState(!1),[q,k]=L.useState(!1),z=d.trackType==="straight",he=Hw(c),Z=((ge=he.lanes[0])==null?void 0:ge.perimeter)||0,K=he.lanes[he.lanes.length-1],H=(K==null?void 0:K.perimeter)||0,X=z?[]:Uw(he),F=D=>{const ae=parseInt(D);if(!(isNaN(ae)||ae<1||ae>8))if(z){const Se=ae*c.laneWidth_mm;n(t,{numLanes:ae,width_mm:Se})}else n(t,{numLanes:ae})},W=D=>{const ae=parseFloat(D)*1e3;return isNaN(ae)||ae<3e3?!1:(n(t,{width_mm:ae}),!0)},re=D=>{const ae=parseFloat(D)*1e3;return isNaN(ae)||ae<3e3?!1:(n(t,{height_mm:ae}),!0)},se=()=>{M(!0),w((c.width_mm/1e3).toFixed(1))},me=()=>{M(!1),W(b)},ke=D=>{D.key==="Enter"?D.target.blur():D.key==="Escape"&&(M(!1),w((c.width_mm/1e3).toFixed(1)))},pe=()=>{P(!0),_((c.height_mm/1e3).toFixed(1))},Pe=()=>{P(!1),re(C)},Re=D=>{D.key==="Enter"?D.target.blur():D.key==="Escape"&&(P(!1),_((c.height_mm/1e3).toFixed(1)))},Ge=D=>{let ae=parseFloat(D);return isNaN(ae)?!1:(ae=(ae%360+360)%360,r(t,ae),l(),!0)},$e=()=>{k(!0),E(h.toFixed(0))},we=()=>{k(!1),Ge(j)},xe=D=>{D.key==="Enter"?D.target.blur():D.key==="Escape"&&(k(!1),E(h.toFixed(0)))},S=(D,ae)=>{const Se=parseFloat(ae)*1e3;if(isNaN(Se)||Se<0)return;const le=Math.min(c.width_mm,c.height_mm)/2,ie=Math.min(Se,le);f?n(t,{cornerRadius:{topLeft:ie,topRight:ie,bottomLeft:ie,bottomRight:ie}}):n(t,{cornerRadius:{...c.cornerRadius,[D]:ie}})},ue=()=>{window.confirm(`Delete ${d.name}? This action cannot be undone.`)&&i(t)},ce=D=>{s(t,{tpv_code:D.code,hex:D.hex,name:D.name}),x(!1)},I=D=>{a(t,{tpv_code:D.code,hex:D.hex,name:D.name}),v(!1)},N=D=>{n(t,{startingBoxes:{...c.startingBoxes,enabled:D}})},B=D=>{const ae=parseFloat(D)*1e3;isNaN(ae)||ae<100||n(t,{startingBoxes:{...c.startingBoxes,depth_mm:ae}})},oe=D=>{n(t,{startingBoxes:{...c.startingBoxes,style:D}})},de=D=>{n(t,{startingBoxes:{...c.startingBoxes,direction:D}})},G=D=>{const ae=parseFloat(D);isNaN(ae)||ae<0||ae>100||n(t,{startingBoxes:{...c.startingBoxes,startPosition:ae}})},te=(c.cornerRadius.topLeft+c.cornerRadius.topRight+c.cornerRadius.bottomLeft+c.cornerRadius.bottomRight)/4;return o.jsxs("div",{className:"properties-panel",children:[o.jsxs("div",{className:"properties-panel__header",children:[o.jsx("h3",{children:"Track Properties"}),o.jsxs("div",{className:"properties-panel__court-info",children:[o.jsx("span",{className:"court-name",children:d.name}),o.jsx("span",{className:"court-standard",children:d.standard})]})]}),o.jsx("div",{className:"properties-panel__content",children:o.jsxs("div",{className:"properties-section",children:[o.jsx("div",{className:"properties-section__header",children:o.jsx("h4",{children:"Track Parameters"})}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Number of Lanes"}),o.jsxs("div",{className:"property-input-row",children:[o.jsx("input",{type:"range",min:"1",max:"8",value:c.numLanes,onChange:D=>F(D.target.value),className:"property-slider"}),o.jsxs("div",{className:"property-input-group property-input-group--compact",children:[o.jsx("input",{type:"number",value:c.numLanes,onChange:D=>F(D.target.value),min:"1",max:"8"}),o.jsx("span",{className:"property-unit",children:"lanes"})]})]})]}),z?o.jsxs("div",{className:"property-group property-group--info",children:[o.jsx("label",{children:"Track Width"}),o.jsx("div",{className:"property-info",children:o.jsxs("span",{children:[(c.width_mm/1e3).toFixed(1),"m (Auto-calculated from lanes)"]})})]}):o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Track Width"}),o.jsxs("div",{className:"property-input-group",children:[o.jsx("input",{type:"number",value:T?b:(c.width_mm/1e3).toFixed(1),onChange:D=>w(D.target.value),onFocus:se,onBlur:me,onKeyDown:ke,min:"3",max:"100",step:"0.5"}),o.jsx("span",{className:"property-unit",children:"m"})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:z?"Track Length":"Track Height"}),o.jsxs("div",{className:"property-input-group",children:[o.jsx("input",{type:"number",value:J?C:(c.height_mm/1e3).toFixed(1),onChange:D=>_(D.target.value),onFocus:pe,onBlur:Pe,onKeyDown:Re,min:"3",max:"100",step:"0.5"}),o.jsx("span",{className:"property-unit",children:"m"})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Rotation"}),o.jsxs("div",{className:"property-input-group",children:[o.jsx("input",{type:"number",value:q?j:h.toFixed(0),onChange:D=>E(D.target.value),onFocus:$e,onBlur:we,onKeyDown:xe,min:"0",max:"360",step:"15"}),o.jsx("span",{className:"property-unit",children:""})]})]}),!z&&o.jsxs("div",{className:"property-group",children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[o.jsx("label",{children:"Corner Radius"}),o.jsx("button",{className:"btn-toggle",onClick:()=>m(!f),style:{padding:"0.25rem 0.5rem",fontSize:"0.75rem",background:f?"#0066CC":"#6b7280",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},title:f?"Click to edit corners independently":"Click to lock all corners together",children:f?" Locked":" Independent"})]}),f?o.jsxs("div",{className:"property-input-group",children:[o.jsx("input",{type:"number",value:(te/1e3).toFixed(2),onChange:D=>S("topLeft",D.target.value),min:"0",max:(Math.min(c.width_mm,c.height_mm)/2e3).toFixed(0),step:"0.5"}),o.jsx("span",{className:"property-unit",children:"m"})]}):o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[o.jsxs("div",{children:[o.jsx("label",{style:{fontSize:"0.75rem",color:"#64748b"},children:"Top Left"}),o.jsxs("div",{className:"property-input-group",children:[o.jsx("input",{type:"number",value:(c.cornerRadius.topLeft/1e3).toFixed(2),onChange:D=>S("topLeft",D.target.value),min:"0",max:(Math.min(c.width_mm,c.height_mm)/2e3).toFixed(0),step:"0.5"}),o.jsx("span",{className:"property-unit",children:"m"})]})]}),o.jsxs("div",{children:[o.jsx("label",{style:{fontSize:"0.75rem",color:"#64748b"},children:"Top Right"}),o.jsxs("div",{className:"property-input-group",children:[o.jsx("input",{type:"number",value:(c.cornerRadius.topRight/1e3).toFixed(2),onChange:D=>S("topRight",D.target.value),min:"0",max:(Math.min(c.width_mm,c.height_mm)/2e3).toFixed(0),step:"0.5"}),o.jsx("span",{className:"property-unit",children:"m"})]})]}),o.jsxs("div",{children:[o.jsx("label",{style:{fontSize:"0.75rem",color:"#64748b"},children:"Bottom Left"}),o.jsxs("div",{className:"property-input-group",children:[o.jsx("input",{type:"number",value:(c.cornerRadius.bottomLeft/1e3).toFixed(2),onChange:D=>S("bottomLeft",D.target.value),min:"0",max:(Math.min(c.width_mm,c.height_mm)/2e3).toFixed(0),step:"0.5"}),o.jsx("span",{className:"property-unit",children:"m"})]})]}),o.jsxs("div",{children:[o.jsx("label",{style:{fontSize:"0.75rem",color:"#64748b"},children:"Bottom Right"}),o.jsxs("div",{className:"property-input-group",children:[o.jsx("input",{type:"number",value:(c.cornerRadius.bottomRight/1e3).toFixed(2),onChange:D=>S("bottomRight",D.target.value),min:"0",max:(Math.min(c.width_mm,c.height_mm)/2e3).toFixed(0),step:"0.5"}),o.jsx("span",{className:"property-unit",children:"m"})]})]})]})]}),o.jsxs("div",{className:"property-group property-group--info",children:[o.jsx("label",{children:"Lane Width"}),o.jsx("div",{className:"property-info",children:o.jsxs("span",{children:[(c.laneWidth_mm/1e3).toFixed(2),"m (Fixed)"]})})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Track Surface Colour"}),o.jsxs("div",{className:"color-item",children:[o.jsxs("div",{className:"color-item__info",children:[o.jsx("span",{className:"color-item__name",children:(u==null?void 0:u.name)||"Select Colour"}),u&&o.jsx("span",{className:"color-item__code",children:u.tpv_code})]}),o.jsx("button",{className:"color-item__swatch",style:{backgroundColor:(u==null?void 0:u.hex)||"#A5362F"},onClick:()=>x(!0),title:(u==null?void 0:u.name)||"Select colour"})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Line Colour"}),o.jsxs("div",{className:"color-item",children:[o.jsxs("div",{className:"color-item__info",children:[o.jsx("span",{className:"color-item__name",children:(p==null?void 0:p.name)||"Cream"}),p&&o.jsx("span",{className:"color-item__code",children:p.tpv_code})]}),o.jsx("button",{className:"color-item__swatch",style:{backgroundColor:(p==null?void 0:p.hex)||"#E8E3D8"},onClick:()=>v(!0),title:(p==null?void 0:p.name)||"Select colour"})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[o.jsx("input",{type:"checkbox",checked:((V=c.startingBoxes)==null?void 0:V.enabled)||!1,onChange:D=>N(D.target.checked)}),"Show Starting Boxes"]}),(($=c.startingBoxes)==null?void 0:$.enabled)&&o.jsxs("div",{style:{marginTop:"0.75rem"},children:[o.jsxs("div",{className:"property-input-group",style:{marginBottom:"0.75rem"},children:[o.jsx("span",{className:"property-label",style:{fontSize:"0.875rem"},children:"Depth"}),o.jsx("input",{type:"number",value:(c.startingBoxes.depth_mm/1e3).toFixed(2),onChange:D=>B(D.target.value),min:"0.1",max:"1.0",step:"0.05"}),o.jsx("span",{className:"property-unit",children:"m"})]}),!z&&o.jsxs("div",{style:{marginBottom:"0.75rem"},children:[o.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#64748b",marginBottom:"0.375rem"},children:"Start Style"}),o.jsxs("select",{value:c.startingBoxes.style||"staggered",onChange:D=>oe(D.target.value),style:{width:"100%",padding:"0.5rem",border:"1px solid #e4e9f0",borderRadius:"6px",fontSize:"0.875rem",fontFamily:"inherit",background:"white"},children:[o.jsx("option",{value:"straight",children:"Straight Start"}),o.jsx("option",{value:"staggered",children:"Staggered Start"}),o.jsx("option",{value:"both",children:"Both (opposite ends)"})]})]}),o.jsxs("div",{style:{marginBottom:"0.75rem"},children:[o.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#64748b",marginBottom:"0.375rem"},children:"Direction of Travel"}),o.jsxs("select",{value:c.startingBoxes.direction||"counterclockwise",onChange:D=>de(D.target.value),style:{width:"100%",padding:"0.5rem",border:"1px solid #e4e9f0",borderRadius:"6px",fontSize:"0.875rem",fontFamily:"inherit",background:"white"},children:[o.jsx("option",{value:"counterclockwise",children:"Counterclockwise (Standard)"}),o.jsx("option",{value:"clockwise",children:"Clockwise"})]})]}),!z&&o.jsxs("div",{style:{marginBottom:"0.75rem"},children:[o.jsxs("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#64748b",marginBottom:"0.375rem"},children:["Start Position (",c.startingBoxes.startPosition||0,"%)"]}),o.jsx("input",{type:"range",min:"0",max:"100",step:"1",value:c.startingBoxes.startPosition||0,onChange:D=>G(D.target.value),className:"property-slider",style:{width:"100%"}}),o.jsx("div",{style:{fontSize:"0.7rem",color:"#94a3b8",marginTop:"0.25rem"},children:"Slide to adjust where the start line appears around the track"})]}),o.jsx("div",{className:"property-info",style:{fontSize:"0.75rem",color:"#64748b",marginTop:"0.5rem"},children:"Boxes use track surface colour with white starting line and lane numbers"}),!z&&X.length>0&&(c.startingBoxes.style==="staggered"||c.startingBoxes.style==="both")&&o.jsxs("div",{style:{marginTop:"0.75rem",padding:"0.5rem",background:"#f8fafc",borderRadius:"4px"},children:[o.jsx("div",{style:{fontSize:"0.75rem",fontWeight:"600",color:"#1e293b",marginBottom:"0.25rem"},children:"Auto-Calculated Staggers:"}),o.jsx("div",{style:{fontSize:"0.7rem",color:"#64748b",lineHeight:"1.4"},children:X.map((D,ae)=>o.jsxs("div",{children:["Lane ",ae+1,": ",(D/1e3).toFixed(2),"m"]},ae))}),o.jsx("div",{style:{fontSize:"0.65rem",color:"#64748b",marginTop:"0.25rem",fontStyle:"italic"},children:"Outer lanes start ahead to equalize distance"})]})]})]}),o.jsx("div",{className:"property-divider"}),o.jsx("div",{className:"properties-section__header",children:o.jsx("h4",{children:"Calculated Dimensions"})}),o.jsxs("div",{className:"property-group property-group--info",children:[o.jsx("label",{children:"Usable Infield"}),o.jsx("div",{className:"property-info",children:o.jsxs("span",{children:[(he.usableWidth/1e3).toFixed(1),"m  ",(he.usableHeight/1e3).toFixed(1),"m"]})})]}),o.jsxs("div",{className:"property-group property-group--info",children:[o.jsx("label",{children:"Lane 1 Perimeter"}),o.jsx("div",{className:"property-info",children:o.jsxs("span",{children:[Z.toFixed(2),"m"]})})]}),c.numLanes>1&&!z&&o.jsxs("div",{className:"property-group property-group--info",children:[o.jsxs("label",{children:["Lane ",c.numLanes," Perimeter"]}),o.jsx("div",{className:"property-info",children:o.jsxs("span",{children:[H.toFixed(2),"m"]})})]}),o.jsx("div",{className:"property-group",children:o.jsx("div",{className:"property-hint",style:{fontStyle:"normal",color:"#64748b",fontSize:"0.75rem",marginTop:"1rem"},children:" Tip: Use drag handles on the canvas or edit values here. Corner radius auto-adjusts when locked."})}),o.jsx("div",{className:"property-group property-group--actions",children:o.jsx("button",{className:"btn-delete",onClick:ue,title:"Delete track (Delete key)",children:" Delete Track"})})]})}),g&&o.jsx("div",{className:"color-picker-modal",onClick:()=>x(!1),children:o.jsxs("div",{className:"color-picker-modal__content",onClick:D=>D.stopPropagation(),children:[o.jsxs("div",{className:"color-picker-modal__header",children:[o.jsx("h4",{children:"Select Track Surface Colour"}),o.jsx("button",{onClick:()=>x(!1),children:""})]}),o.jsx("div",{className:"color-picker-grid",children:dn.map(D=>o.jsx("button",{className:"color-picker-swatch",style:{backgroundColor:D.hex},onClick:()=>ce(D),title:`${D.code} - ${D.name}`,children:o.jsx("span",{className:"color-picker-swatch__code",children:D.code})},D.code))})]})}),y&&o.jsx("div",{className:"color-picker-modal",onClick:()=>v(!1),children:o.jsxs("div",{className:"color-picker-modal__content",onClick:D=>D.stopPropagation(),children:[o.jsxs("div",{className:"color-picker-modal__header",children:[o.jsx("h4",{children:"Select Line Colour"}),o.jsx("button",{onClick:()=>v(!1),children:""})]}),o.jsx("div",{className:"color-picker-grid",children:dn.map(D=>o.jsx("button",{className:"color-picker-swatch",style:{backgroundColor:D.hex},onClick:()=>I(D),title:`${D.code} - ${D.name}`,children:o.jsx("span",{className:"color-picker-swatch__code",children:D.code})},D.code))})]})})]})}function e5({motif:e,motifId:t,onEditSourceDesign:n}){const{updateMotifPosition:r,updateMotifRotation:i,updateMotifScale:s,removeMotif:a,duplicateMotif:l,refreshMotif:c,setMotifViewMode:d}=st(),{position:u,rotation:p,scale:h,sourceDesignName:f,sourceDesignId:m,originalWidth_mm:g,originalHeight_mm:x,sourceThumbnailUrl:y,viewMode:v,hasBothVersions:b}=e,[w,C]=L.useState(!1),[_,j]=L.useState(null),E=(Z,K)=>{const H=parseFloat(K);isNaN(H)||r(t,{...u,[Z]:H})},T=Z=>{const K=parseFloat(Z);isNaN(K)||i(t,K)},M=Z=>{const K=parseFloat(Z);isNaN(K)||K<=0||s(t,K)},J=()=>{window.confirm("Delete this motif? This action cannot be undone.")&&a(t)},P=()=>{l(t)},q=()=>{if(n)n(m);else{if(!m){alert("Source design ID not found");return}window.open(`/studio/?design=${m}`,"_blank")}},k=async()=>{if(!w){C(!0),j(null);try{const Z=await c(t);Z.success||j(Z.error||"Failed to refresh")}catch(Z){j(Z.message||"Failed to refresh")}finally{C(!1)}}},z=g*(h||1)/1e3,he=x*(h||1)/1e3;return o.jsxs("div",{className:"properties-panel",children:[o.jsxs("div",{className:"properties-panel__header",children:[o.jsx("h3",{children:"Motif Properties"}),o.jsxs("div",{className:"properties-panel__court-info",children:[o.jsx("span",{className:"court-name",children:f||"Unnamed Motif"}),o.jsx("span",{className:"court-standard",children:"Playground Design"})]})]}),o.jsx("div",{className:"properties-panel__content",children:o.jsxs("div",{className:"properties-section",children:[y&&o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Preview"}),o.jsx("div",{style:{width:"100%",height:"80px",background:"#f3f4f6",borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden"},children:o.jsx("img",{src:y,alt:f,style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})})]}),gs.BLEND_MODE_ENABLED,o.jsx("div",{className:"properties-section__header",children:o.jsx("h4",{children:"Transform"})}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Position"}),o.jsxs("div",{className:"property-input-row",children:[o.jsxs("div",{className:"property-input-group",children:[o.jsx("span",{className:"property-label",children:"X"}),o.jsx("input",{type:"number",value:Math.round(u.x),onChange:Z=>E("x",Z.target.value),step:"100"}),o.jsx("span",{className:"property-unit",children:"mm"})]}),o.jsxs("div",{className:"property-input-group",children:[o.jsx("span",{className:"property-label",children:"Y"}),o.jsx("input",{type:"number",value:Math.round(u.y),onChange:Z=>E("y",Z.target.value),step:"100"}),o.jsx("span",{className:"property-unit",children:"mm"})]})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Rotation"}),o.jsxs("div",{className:"property-input-row",children:[o.jsx("input",{type:"range",min:"0",max:"360",value:p||0,onChange:Z=>T(Z.target.value),className:"property-slider"}),o.jsxs("div",{className:"property-input-group property-input-group--compact",children:[o.jsx("input",{type:"number",value:Math.round(p||0),onChange:Z=>T(Z.target.value),min:"0",max:"360"}),o.jsx("span",{className:"property-unit",children:""})]})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsxs("label",{children:["Scale",o.jsx("span",{style:{fontSize:"0.7rem",color:"#64748b",marginLeft:"0.5rem"},children:"(aspect locked)"})]}),o.jsxs("div",{className:"property-input-row",children:[o.jsx("input",{type:"range",min:"0.1",max:"10",step:"0.1",value:Math.min(h||1,10),onChange:Z=>M(Z.target.value),className:"property-slider"}),o.jsxs("div",{className:"property-input-group property-input-group--compact",children:[o.jsx("input",{type:"number",value:(h||1).toFixed(2),onChange:Z=>M(Z.target.value),min:"0.1",step:"0.1"}),o.jsx("span",{className:"property-unit",children:""})]})]})]}),o.jsxs("div",{className:"property-group property-group--info",children:[o.jsx("label",{children:"Current Size"}),o.jsx("div",{className:"property-info",children:o.jsxs("span",{children:[z.toFixed(2),"m  ",he.toFixed(2),"m"]})})]}),o.jsxs("div",{className:"property-group property-group--info",children:[o.jsx("label",{children:"Original Size"}),o.jsx("div",{className:"property-info",children:o.jsxs("span",{children:[(g/1e3).toFixed(2),"m  ",(x/1e3).toFixed(2),"m"]})})]}),o.jsx("div",{className:"properties-section__divider",style:{margin:"1rem 0"},children:o.jsx("span",{children:"Source Design"})}),o.jsx("div",{className:"property-group property-group--actions",children:o.jsx("button",{className:"btn-primary",onClick:q,title:"Edit the source playground design in a new tab",style:{width:"100%",padding:"0.5rem",background:"var(--color-primary, #1e4a7a)",color:"white",border:"none",borderRadius:"6px",fontSize:"0.875rem",fontFamily:"inherit",cursor:"pointer",marginBottom:"0.5rem",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem"},children:" Edit Source Design"})}),o.jsxs("div",{className:"property-group property-group--actions",children:[o.jsx("button",{className:"btn-secondary",onClick:k,disabled:w,title:"Refresh this motif with the latest version from the source design",style:{width:"100%",padding:"0.5rem",background:w?"#e5e7eb":"#f3f4f6",border:"1px solid #e4e9f0",borderRadius:"6px",fontSize:"0.875rem",fontFamily:"inherit",cursor:w?"not-allowed":"pointer",marginBottom:"0.5rem",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem"},children:w?" Refreshing...":" Refresh from Source"}),_&&o.jsx("div",{style:{fontSize:"0.75rem",color:"#dc2626",marginTop:"0.25rem"},children:_}),o.jsx("div",{style:{fontSize:"0.7rem",color:"#64748b",marginTop:"0.25rem"},children:"Click after editing the source design to update this motif"})]}),o.jsx("div",{className:"properties-section__divider",style:{margin:"1rem 0"},children:o.jsx("span",{children:"Actions"})}),o.jsx("div",{className:"property-group property-group--actions",children:o.jsx("button",{className:"btn-secondary",onClick:P,title:"Duplicate motif (Ctrl+D)",style:{width:"100%",padding:"0.5rem",background:"#f3f4f6",border:"1px solid #e4e9f0",borderRadius:"6px",fontSize:"0.875rem",fontFamily:"inherit",cursor:"pointer",marginBottom:"0.5rem"},children:" Duplicate Motif"})}),o.jsx("div",{className:"property-group property-group--actions",children:o.jsx("button",{className:"btn-delete",onClick:J,title:"Delete motif (Delete key)",children:" Delete Motif"})}),o.jsx("div",{className:"property-group",children:o.jsx("div",{className:"property-hint",style:{fontStyle:"normal",color:"#64748b",fontSize:"0.75rem",marginTop:"1rem"},children:' Tip: Drag the motif on the canvas to reposition. Edit the source design and click "Refresh" to update.'})})]})})]})}function t5({shape:e,shapeId:t}){var je;const{updateShapePosition:n,updateShapeDimensions:r,updateShapeSides:i,updateShapeCornerRadius:s,updateShapeRotation:a,setShapeFillColor:l,setShapeStroke:c,setShapeAspectLock:d,removeShape:u,duplicateShape:p,randomizeBlob:h,setBlobStyle:f,setEditPointsVisible:m,setPathClosed:g,setPathSmooth:x}=st(),[y,v]=L.useState(!1),[b,w]=L.useState(!1),[C,_]=L.useState(""),[j,E]=L.useState(""),[T,M]=L.useState(!1),[J,P]=L.useState(!1),{shapeType:q,sides:k,width_mm:z,height_mm:he,cornerRadius:Z,position:K,rotation:H,fillColor:X,strokeEnabled:F,strokeColor:W,strokeWidth_mm:re,aspectLocked:se,blobStyle:me,editPointsVisible:ke,closed:pe,smooth:Pe,controlPoints:Re}=e,Ge=q==="blob",$e=q==="path",we=(Y,ne)=>{const Ie=parseFloat(ne);isNaN(Ie)||n(t,{...K,[Y]:Ie})},xe=Y=>{const ne=parseFloat(Y);if(isNaN(ne)||ne<100)return!1;if(se){const Ie=he/z;r(t,ne,ne*Ie)}else r(t,ne,he);return!0},S=Y=>{const ne=parseFloat(Y);if(isNaN(ne)||ne<100)return!1;if(se){const Ie=z/he;r(t,ne*Ie,ne)}else r(t,z,ne);return!0},ue=()=>{M(!0),_(z.toFixed(0))},ce=()=>{M(!1),xe(C)},I=Y=>{Y.key==="Enter"?Y.target.blur():Y.key==="Escape"&&(M(!1),_(z.toFixed(0)))},N=()=>{P(!0),E(he.toFixed(0))},B=()=>{P(!1),S(j)},oe=Y=>{Y.key==="Enter"?Y.target.blur():Y.key==="Escape"&&(P(!1),E(he.toFixed(0)))},de=Y=>{const ne=parseInt(Y);isNaN(ne)||ne<3||i(t,ne)},G=Y=>{const ne=parseFloat(Y);isNaN(ne)||ne<0||ne>100||s(t,ne)},te=Y=>{const ne=parseFloat(Y);isNaN(ne)||a(t,ne)},ge=Y=>{l(t,{tpv_code:Y.code,hex:Y.hex,name:Y.name}),v(!1)},V=Y=>{c(t,!0,{tpv_code:Y.code,hex:Y.hex,name:Y.name},re),w(!1)},$=Y=>{Y&&!W?c(t,!0,{tpv_code:"RH31",hex:"#E8E3D8",name:"Cream"},re):c(t,Y,W,re)},D=Y=>{const ne=parseFloat(Y);isNaN(ne)||ne<10||c(t,F,W,ne)},ae=()=>{d(t,!se)},Se=()=>{window.confirm("Delete this shape? This action cannot be undone.")&&u(t)},le=()=>{p(t)},ie=[{sides:3,name:"Triangle",icon:""},{sides:4,name:"Rectangle",icon:""},{sides:5,name:"Pentagon",icon:""},{sides:6,name:"Hexagon",icon:""},{sides:8,name:"Octagon",icon:""},{sides:32,name:"Circle",icon:""}];return o.jsxs("div",{className:"properties-panel",children:[o.jsxs("div",{className:"properties-panel__header",children:[o.jsx("h3",{children:Ge?"Blob Shape":$e?"Pen Path":"Shape Properties"}),o.jsxs("div",{className:"properties-panel__court-info",children:[o.jsx("span",{className:"court-name",children:Ge?((je=id[me||"organic"])==null?void 0:je.name)||"Organic":$e?pe?"Closed Path":"Open Path":yE(k)}),o.jsx("span",{className:"court-standard",children:Ge?" Blob":$e?` ${(Re==null?void 0:Re.length)||0} points`:`${xE(k)} ${k} sides`})]})]}),o.jsx("div",{className:"properties-panel__content",children:o.jsxs("div",{className:"properties-section",children:[Ge?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Style"}),o.jsx("select",{value:me||"organic",onChange:Y=>f(t,Y.target.value),style:{width:"100%",padding:"0.5rem 0.75rem",border:"1px solid #e4e9f0",borderRadius:"6px",fontSize:"0.875rem",cursor:"pointer",background:"#fff"},children:Object.entries(id).map(([Y,ne])=>o.jsxs("option",{value:Y,children:[ne.name," - ",ne.description]},Y))})]}),o.jsxs("div",{className:"property-group",children:[o.jsxs("button",{onClick:()=>h(t),style:{width:"100%",padding:"0.75rem 1rem",background:"#3b82f6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"0.875rem",fontWeight:"600",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem"},children:[o.jsx("span",{style:{fontSize:"1.1rem"},children:""})," New Shape"]}),o.jsx("div",{style:{fontSize:"0.7rem",color:"#64748b",marginTop:"0.5rem",textAlign:"center"},children:"Generate a new random shape in the selected style"})]}),o.jsxs("div",{className:"property-group",children:[o.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",padding:"0.5rem",border:"1px solid #e4e9f0",borderRadius:"6px",background:ke?"#eff6ff":"#fff"},children:[o.jsx("input",{type:"checkbox",checked:ke||!1,onChange:Y=>m(t,Y.target.checked),style:{width:"16px",height:"16px",cursor:"pointer"}}),o.jsx("span",{style:{fontSize:"0.875rem"},children:"Edit Points"})]}),ke&&o.jsx("div",{style:{fontSize:"0.7rem",color:"#64748b",marginTop:"0.5rem"},children:"Drag points and handles on canvas for precise control"})]})]}):$e?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"property-group",children:[o.jsx("label",{style:{marginBottom:"0.5rem",display:"block"},children:"Path Options"}),o.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",padding:"0.5rem",border:"1px solid #e4e9f0",borderRadius:"6px",background:pe?"#eff6ff":"#fff",marginBottom:"0.5rem"},children:[o.jsx("input",{type:"checkbox",checked:pe||!1,onChange:Y=>g(t,Y.target.checked),style:{width:"16px",height:"16px",cursor:"pointer"}}),o.jsx("span",{style:{fontSize:"0.875rem"},children:"Closed Path"})]}),o.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",padding:"0.5rem",border:"1px solid #e4e9f0",borderRadius:"6px",background:Pe?"#eff6ff":"#fff"},children:[o.jsx("input",{type:"checkbox",checked:Pe||!1,onChange:Y=>x(t,Y.target.checked),style:{width:"16px",height:"16px",cursor:"pointer"}}),o.jsx("span",{style:{fontSize:"0.875rem"},children:"Smooth Curves"})]}),Pe&&o.jsx("div",{style:{fontSize:"0.7rem",color:"#64748b",marginTop:"0.5rem"},children:"Uses bezier curves for smooth transitions"})]}),o.jsxs("div",{className:"property-group",children:[o.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",padding:"0.5rem",border:"1px solid #e4e9f0",borderRadius:"6px",background:ke?"#eff6ff":"#fff"},children:[o.jsx("input",{type:"checkbox",checked:ke||!1,onChange:Y=>m(t,Y.target.checked),style:{width:"16px",height:"16px",cursor:"pointer"}}),o.jsx("span",{style:{fontSize:"0.875rem"},children:"Edit Points"})]}),ke&&o.jsxs("div",{style:{fontSize:"0.7rem",color:"#64748b",marginTop:"0.5rem"},children:["Drag points to reshape. ",Pe?"Drag handles for curve control.":"Enable smooth curves for bezier handles."]})]}),o.jsx("div",{className:"property-group",style:{background:"#f8fafc",padding:"0.75rem",borderRadius:"6px"},children:o.jsxs("div",{style:{fontSize:"0.8125rem",color:"#475569"},children:[o.jsx("strong",{children:(Re==null?void 0:Re.length)||0})," control points"]})})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Shape Type"}),o.jsx("div",{className:"shape-presets",style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"0.5rem",marginTop:"0.5rem"},children:ie.map(Y=>o.jsxs("button",{onClick:()=>de(Y.sides),title:Y.name,style:{padding:"0.5rem",border:k===Y.sides?"2px solid #3b82f6":"1px solid #e4e9f0",borderRadius:"6px",background:k===Y.sides?"#eff6ff":"#fff",cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",gap:"0.25rem",fontSize:"1.25rem"},children:[o.jsx("span",{children:Y.icon}),o.jsx("span",{style:{fontSize:"0.65rem",color:"#64748b"},children:Y.name})]},Y.sides))})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Number of Sides"}),o.jsxs("div",{className:"property-input-row",children:[o.jsx("input",{type:"range",min:"3",max:"32",value:k,onChange:Y=>de(Y.target.value),className:"property-slider"}),o.jsx("div",{className:"property-input-group property-input-group--compact",children:o.jsx("input",{type:"number",value:k,onChange:Y=>de(Y.target.value),min:"3",max:"32"})})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Corner Smoothing"}),o.jsxs("div",{className:"property-input-row",children:[o.jsx("input",{type:"range",min:"0",max:"100",value:Z,onChange:Y=>G(Y.target.value),className:"property-slider"}),o.jsxs("div",{className:"property-input-group property-input-group--compact",children:[o.jsx("input",{type:"number",value:Z,onChange:Y=>G(Y.target.value),min:"0",max:"100"}),o.jsx("span",{className:"property-unit",children:"%"})]})]})]})]}),o.jsx("div",{className:"properties-section__divider",style:{margin:"1rem 0"},children:o.jsx("span",{children:"Dimensions"})}),o.jsxs("div",{className:"property-group",children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[o.jsx("label",{style:{margin:0},children:"Size"}),o.jsx("button",{onClick:ae,style:{padding:"0.25rem 0.5rem",fontSize:"0.75rem",background:se?"#3b82f6":"#6b7280",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},title:se?"Aspect ratio locked":"Aspect ratio unlocked",children:se?" Locked":" Free"})]}),o.jsxs("div",{className:"property-input-row",children:[o.jsxs("div",{className:"property-input-group",children:[o.jsx("span",{className:"property-label",children:"W"}),o.jsx("input",{type:"number",value:T?C:z.toFixed(0),onChange:Y=>_(Y.target.value),onFocus:ue,onBlur:ce,onKeyDown:I,step:"100",min:"100"}),o.jsx("span",{className:"property-unit",children:"mm"})]}),o.jsxs("div",{className:"property-input-group",children:[o.jsx("span",{className:"property-label",children:"H"}),o.jsx("input",{type:"number",value:J?j:he.toFixed(0),onChange:Y=>E(Y.target.value),onFocus:N,onBlur:B,onKeyDown:oe,step:"100",min:"100"}),o.jsx("span",{className:"property-unit",children:"mm"})]})]}),o.jsxs("div",{style:{fontSize:"0.7rem",color:"#64748b",marginTop:"0.25rem"},children:[(z/1e3).toFixed(2),"m  ",(he/1e3).toFixed(2),"m"]})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Position"}),o.jsxs("div",{className:"property-input-row",children:[o.jsxs("div",{className:"property-input-group",children:[o.jsx("span",{className:"property-label",children:"X"}),o.jsx("input",{type:"number",value:Math.round(K.x),onChange:Y=>we("x",Y.target.value),step:"100"}),o.jsx("span",{className:"property-unit",children:"mm"})]}),o.jsxs("div",{className:"property-input-group",children:[o.jsx("span",{className:"property-label",children:"Y"}),o.jsx("input",{type:"number",value:Math.round(K.y),onChange:Y=>we("y",Y.target.value),step:"100"}),o.jsx("span",{className:"property-unit",children:"mm"})]})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Rotation"}),o.jsxs("div",{className:"property-input-row",children:[o.jsx("input",{type:"range",min:"0",max:"360",value:H||0,onChange:Y=>te(Y.target.value),className:"property-slider"}),o.jsxs("div",{className:"property-input-group property-input-group--compact",children:[o.jsx("input",{type:"number",value:Math.round(H||0),onChange:Y=>te(Y.target.value),min:"0",max:"360"}),o.jsx("span",{className:"property-unit",children:""})]})]})]}),o.jsx("div",{className:"properties-section__divider",style:{margin:"1rem 0"},children:o.jsx("span",{children:"Appearance"})}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Fill Colour"}),o.jsxs("div",{className:"color-item",children:[o.jsxs("div",{className:"color-item__info",children:[o.jsx("span",{className:"color-item__name",children:(X==null?void 0:X.name)||"Select Colour"}),X&&o.jsx("span",{className:"color-item__code",children:X.tpv_code})]}),o.jsx("button",{className:"color-item__swatch",style:{backgroundColor:(X==null?void 0:X.hex)||"#609B63"},onClick:()=>v(!0),title:(X==null?void 0:X.name)||"Select colour"})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[o.jsx("input",{type:"checkbox",checked:F||!1,onChange:Y=>$(Y.target.checked)}),"Border"]}),F&&o.jsxs("div",{style:{marginTop:"0.5rem"},children:[o.jsxs("div",{className:"color-item",style:{marginBottom:"0.5rem"},children:[o.jsxs("div",{className:"color-item__info",children:[o.jsx("span",{className:"color-item__name",children:(W==null?void 0:W.name)||"Select Colour"}),W&&o.jsx("span",{className:"color-item__code",children:W.tpv_code})]}),o.jsx("button",{className:"color-item__swatch",style:{backgroundColor:(W==null?void 0:W.hex)||"#FFFFFF"},onClick:()=>w(!0),title:(W==null?void 0:W.name)||"Select colour"})]}),o.jsxs("div",{className:"property-input-group",children:[o.jsx("span",{className:"property-label",style:{fontSize:"0.8rem"},children:"Width"}),o.jsx("input",{type:"number",value:re,onChange:Y=>D(Y.target.value),step:"10",min:"10"}),o.jsx("span",{className:"property-unit",children:"mm"})]})]})]}),o.jsx("div",{className:"properties-section__divider",style:{margin:"1rem 0"},children:o.jsx("span",{children:"Actions"})}),o.jsx("div",{className:"property-group property-group--actions",children:o.jsx("button",{className:"btn-secondary",onClick:le,title:"Duplicate shape (Ctrl+D)",style:{width:"100%",padding:"0.5rem",background:"#f3f4f6",border:"1px solid #e4e9f0",borderRadius:"6px",fontSize:"0.875rem",fontFamily:"inherit",cursor:"pointer",marginBottom:"0.5rem"},children:" Duplicate Shape"})}),o.jsx("div",{className:"property-group property-group--actions",children:o.jsx("button",{className:"btn-delete",onClick:Se,title:"Delete shape (Delete key)",children:" Delete Shape"})}),o.jsx("div",{className:"property-group",children:o.jsx("div",{className:"property-hint",style:{fontStyle:"normal",color:"#64748b",fontSize:"0.75rem",marginTop:"1rem"},children:" Tip: Drag corners to resize, drag the rotation handle above the shape to rotate. Hold Shift to snap rotation to 15 increments."})})]})}),y&&o.jsx("div",{className:"color-picker-modal",onClick:()=>v(!1),children:o.jsxs("div",{className:"color-picker-modal__content",onClick:Y=>Y.stopPropagation(),children:[o.jsxs("div",{className:"color-picker-modal__header",children:[o.jsx("h4",{children:"Select Fill Colour"}),o.jsx("button",{onClick:()=>v(!1),children:""})]}),o.jsx("div",{className:"color-picker-grid",children:dn.map(Y=>o.jsx("button",{className:"color-picker-swatch",style:{backgroundColor:Y.hex},onClick:()=>ge(Y),title:`${Y.code} - ${Y.name}`,children:o.jsx("span",{className:"color-picker-swatch__code",children:Y.code})},Y.code))})]})}),b&&o.jsx("div",{className:"color-picker-modal",onClick:()=>w(!1),children:o.jsxs("div",{className:"color-picker-modal__content",onClick:Y=>Y.stopPropagation(),children:[o.jsxs("div",{className:"color-picker-modal__header",children:[o.jsx("h4",{children:"Select Border Colour"}),o.jsx("button",{onClick:()=>w(!1),children:""})]}),o.jsx("div",{className:"color-picker-grid",children:dn.map(Y=>o.jsx("button",{className:"color-picker-swatch",style:{backgroundColor:Y.hex},onClick:()=>V(Y),title:`${Y.code} - ${Y.name}`,children:o.jsx("span",{className:"color-picker-swatch__code",children:Y.code})},Y.code))})]})})]})}function n5({text:e,textId:t}){const{updateTextContent:n,updateTextPosition:r,updateTextFontSize:i,updateTextFont:s,updateTextAlign:a,updateTextRotation:l,setTextFillColor:c,setTextStrokeColor:d,updateTextStrokeWidth:u,removeText:p,duplicateText:h}=st(),[f,m]=L.useState(!1),[g,x]=L.useState(!1),{content:y,fontFamily:v,fontSize_mm:b,fontWeight:w,fontStyle:C,textAlign:_,position:j,rotation:E,fillColor:T,strokeColor:M,strokeWidth_mm:J}=e,P=CE(),q=pe=>{n(t,pe)},k=(pe,Pe)=>{const Re=parseFloat(Pe);isNaN(Re)||r(t,{...j,[pe]:Re})},z=pe=>{const Pe=parseFloat(pe);isNaN(Pe)||Pe<50||i(t,Pe)},he=pe=>{s(t,pe,w,C)},Z=()=>{s(t,v,w==="bold"?"normal":"bold",C)},K=()=>{s(t,v,w,C==="italic"?"normal":"italic")},H=pe=>{a(t,pe)},X=pe=>{const Pe=parseFloat(pe);isNaN(Pe)||l(t,Pe)},F=pe=>{c(t,{tpv_code:pe.code,hex:pe.hex,name:pe.name}),m(!1)},W=pe=>{d(t,{tpv_code:pe.code,hex:pe.hex,name:pe.name}),(!J||J===0)&&u(t,Math.round(b*.05)),x(!1)},re=pe=>{const Pe=parseFloat(pe);isNaN(Pe)||Pe<0||u(t,Pe)},se=()=>{d(t,null),u(t,0)},me=()=>{window.confirm("Delete this text? This action cannot be undone.")&&p(t)},ke=()=>{h(t)};return o.jsxs("div",{className:"properties-panel",children:[o.jsxs("div",{className:"properties-panel__header",children:[o.jsx("h3",{children:"Text Properties"}),o.jsxs("div",{className:"properties-panel__court-info",children:[o.jsx("span",{className:"court-name",style:{fontFamily:v},children:y||"Text Label"}),o.jsx("span",{className:"court-standard",children:"T Text Element"})]})]}),o.jsx("div",{className:"properties-panel__content",children:o.jsxs("div",{className:"properties-section",children:[o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Text Content"}),o.jsx("input",{type:"text",value:y,onChange:pe=>q(pe.target.value),placeholder:"Enter text...",style:{width:"100%",padding:"0.5rem",border:"1px solid #e4e9f0",borderRadius:"6px",fontFamily:v,fontSize:"1rem"}})]}),o.jsx("div",{className:"properties-section__divider",style:{margin:"1rem 0"},children:o.jsx("span",{children:"Typography"})}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Font Family"}),o.jsx("select",{value:v,onChange:pe=>he(pe.target.value),style:{width:"100%",padding:"0.5rem",border:"1px solid #e4e9f0",borderRadius:"6px",fontFamily:"inherit",fontSize:"0.875rem"},children:P.map(pe=>o.jsx("option",{value:pe.family,style:{fontFamily:pe.family},children:pe.name},pe.name))})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Font Size"}),o.jsxs("div",{className:"property-input-row",children:[o.jsx("input",{type:"range",min:"100",max:"2000",step:"50",value:b,onChange:pe=>z(pe.target.value),className:"property-slider"}),o.jsxs("div",{className:"property-input-group property-input-group--compact",children:[o.jsx("input",{type:"number",value:b.toFixed(0),onChange:pe=>z(pe.target.value),min:"50",step:"50"}),o.jsx("span",{className:"property-unit",children:"mm"})]})]}),o.jsxs("div",{style:{fontSize:"0.7rem",color:"#64748b",marginTop:"0.25rem"},children:[" ",(b/1e3).toFixed(2),"m height"]})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Style"}),o.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[o.jsx("button",{onClick:Z,style:{flex:1,padding:"0.5rem",border:w==="bold"?"2px solid #3b82f6":"1px solid #e4e9f0",borderRadius:"6px",background:w==="bold"?"#eff6ff":"#fff",fontWeight:"bold",fontSize:"1rem",cursor:"pointer"},title:"Bold",children:"B"}),o.jsx("button",{onClick:K,style:{flex:1,padding:"0.5rem",border:C==="italic"?"2px solid #3b82f6":"1px solid #e4e9f0",borderRadius:"6px",background:C==="italic"?"#eff6ff":"#fff",fontStyle:"italic",fontSize:"1rem",cursor:"pointer"},title:"Italic",children:"I"})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Alignment"}),o.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[o.jsx("button",{onClick:()=>H("left"),style:{flex:1,padding:"0.5rem",border:_==="left"?"2px solid #3b82f6":"1px solid #e4e9f0",borderRadius:"6px",background:_==="left"?"#eff6ff":"#fff",cursor:"pointer"},title:"Align Left",children:""}),o.jsx("button",{onClick:()=>H("center"),style:{flex:1,padding:"0.5rem",border:_==="center"?"2px solid #3b82f6":"1px solid #e4e9f0",borderRadius:"6px",background:_==="center"?"#eff6ff":"#fff",cursor:"pointer"},title:"Align Center",children:""}),o.jsx("button",{onClick:()=>H("right"),style:{flex:1,padding:"0.5rem",border:_==="right"?"2px solid #3b82f6":"1px solid #e4e9f0",borderRadius:"6px",background:_==="right"?"#eff6ff":"#fff",cursor:"pointer"},title:"Align Right",children:""})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Text Colour"}),o.jsxs("div",{className:"color-item",children:[o.jsxs("div",{className:"color-item__info",children:[o.jsx("span",{className:"color-item__name",children:(T==null?void 0:T.name)||"Select Colour"}),T&&o.jsx("span",{className:"color-item__code",children:T.tpv_code})]}),o.jsx("button",{className:"color-item__swatch",style:{backgroundColor:(T==null?void 0:T.hex)||"#1C1C1C"},onClick:()=>m(!0),title:(T==null?void 0:T.name)||"Select colour"})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Outline"}),M?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"color-item",children:[o.jsxs("div",{className:"color-item__info",children:[o.jsx("span",{className:"color-item__name",children:M.name}),o.jsx("span",{className:"color-item__code",children:M.tpv_code})]}),o.jsx("button",{className:"color-item__swatch",style:{backgroundColor:M.hex},onClick:()=>x(!0),title:M.name})]}),o.jsxs("div",{className:"property-input-row",style:{marginTop:"0.5rem"},children:[o.jsx("input",{type:"range",min:"1",max:Math.round(b*.2),step:"1",value:J||0,onChange:pe=>re(pe.target.value),className:"property-slider"}),o.jsxs("div",{className:"property-input-group property-input-group--compact",children:[o.jsx("input",{type:"number",value:Math.round(J||0),onChange:pe=>re(pe.target.value),min:"0",step:"1"}),o.jsx("span",{className:"property-unit",children:"mm"})]})]}),o.jsx("button",{onClick:se,style:{marginTop:"0.5rem",padding:"0.25rem 0.5rem",fontSize:"0.75rem",background:"#fee2e2",border:"1px solid #fecaca",borderRadius:"4px",color:"#dc2626",cursor:"pointer"},children:"Remove Outline"})]}):o.jsx("button",{onClick:()=>x(!0),style:{width:"100%",padding:"0.5rem",background:"#f3f4f6",border:"1px dashed #d1d5db",borderRadius:"6px",fontSize:"0.875rem",color:"#6b7280",cursor:"pointer"},children:"+ Add Outline"})]}),o.jsx("div",{className:"properties-section__divider",style:{margin:"1rem 0"},children:o.jsx("span",{children:"Transform"})}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Position"}),o.jsxs("div",{className:"property-input-row",children:[o.jsxs("div",{className:"property-input-group",children:[o.jsx("span",{className:"property-label",children:"X"}),o.jsx("input",{type:"number",value:Math.round(j.x),onChange:pe=>k("x",pe.target.value),step:"100"}),o.jsx("span",{className:"property-unit",children:"mm"})]}),o.jsxs("div",{className:"property-input-group",children:[o.jsx("span",{className:"property-label",children:"Y"}),o.jsx("input",{type:"number",value:Math.round(j.y),onChange:pe=>k("y",pe.target.value),step:"100"}),o.jsx("span",{className:"property-unit",children:"mm"})]})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Rotation"}),o.jsxs("div",{className:"property-input-row",children:[o.jsx("input",{type:"range",min:"0",max:"360",value:E||0,onChange:pe=>X(pe.target.value),className:"property-slider"}),o.jsxs("div",{className:"property-input-group property-input-group--compact",children:[o.jsx("input",{type:"number",value:Math.round(E||0),onChange:pe=>X(pe.target.value),min:"0",max:"360"}),o.jsx("span",{className:"property-unit",children:""})]})]})]}),o.jsx("div",{className:"properties-section__divider",style:{margin:"1rem 0"},children:o.jsx("span",{children:"Actions"})}),o.jsx("div",{className:"property-group property-group--actions",children:o.jsx("button",{className:"btn-secondary",onClick:ke,title:"Duplicate text (Ctrl+D)",style:{width:"100%",padding:"0.5rem",background:"#f3f4f6",border:"1px solid #e4e9f0",borderRadius:"6px",fontSize:"0.875rem",fontFamily:"inherit",cursor:"pointer",marginBottom:"0.5rem"},children:" Duplicate Text"})}),o.jsx("div",{className:"property-group property-group--actions",children:o.jsx("button",{className:"btn-delete",onClick:me,title:"Delete text (Delete key)",children:" Delete Text"})}),o.jsx("div",{className:"property-group",children:o.jsx("div",{className:"property-hint",style:{fontStyle:"normal",color:"#64748b",fontSize:"0.75rem",marginTop:"1rem"},children:" Tip: Double-click text on canvas to edit inline. Drag corners to change font size. Hold Shift while rotating to snap to 15 increments."})})]})}),f&&o.jsx("div",{className:"color-picker-modal",onClick:()=>m(!1),children:o.jsxs("div",{className:"color-picker-modal__content",onClick:pe=>pe.stopPropagation(),children:[o.jsxs("div",{className:"color-picker-modal__header",children:[o.jsx("h4",{children:"Select Text Colour"}),o.jsx("button",{onClick:()=>m(!1),children:""})]}),o.jsx("div",{className:"color-picker-grid",children:dn.map(pe=>o.jsx("button",{className:"color-picker-swatch",style:{backgroundColor:pe.hex},onClick:()=>F(pe),title:`${pe.code} - ${pe.name}`,children:o.jsx("span",{className:"color-picker-swatch__code",children:pe.code})},pe.code))})]})}),g&&o.jsx("div",{className:"color-picker-modal",onClick:()=>x(!1),children:o.jsxs("div",{className:"color-picker-modal__content",onClick:pe=>pe.stopPropagation(),children:[o.jsxs("div",{className:"color-picker-modal__header",children:[o.jsx("h4",{children:"Select Outline Colour"}),o.jsx("button",{onClick:()=>x(!1),children:""})]}),o.jsx("div",{className:"color-picker-grid",children:dn.map(pe=>o.jsx("button",{className:"color-picker-swatch",style:{backgroundColor:pe.hex},onClick:()=>W(pe),title:`${pe.code} - ${pe.name}`,children:o.jsx("span",{className:"color-picker-swatch__code",children:pe.code})},pe.code))})]})})]})}function r5({zone:e,zoneId:t}){const{updateExclusionZonePosition:n,updateExclusionZoneDimensions:r,updateExclusionZoneRotation:i,updateExclusionZoneCornerRadius:s,removeExclusionZone:a,duplicateExclusionZone:l,addToHistory:c}=st(),{position:d,rotation:u,width_mm:p,height_mm:h,sides:f,cornerRadius:m,customName:g}=e,x=(T,M)=>{const J=parseFloat(M);isNaN(J)||n(t,{...d,[T]:J})},y=(T,M)=>{const J=parseFloat(M);isNaN(J)||J<500||(T==="width"?r(t,J,h):r(t,p,J),c())},v=T=>{const M=parseFloat(T);isNaN(M)||(i(t,M),c())},b=T=>{const M=parseFloat(T);isNaN(M)||s(t,M)},w=()=>{window.confirm("Delete this exclusion zone? This action cannot be undone.")&&a(t)},C=()=>{l(t)},_=p*h/1e6,j=g||"Exclusion Zone",E=f===4?"Rectangle":f>=32?"Circle":`${f}-sided`;return o.jsxs("div",{className:"properties-panel",children:[o.jsxs("div",{className:"properties-panel__header",children:[o.jsx("h3",{children:"Exclusion Zone"}),o.jsxs("div",{className:"properties-panel__court-info",children:[o.jsx("span",{className:"court-name",children:j}),o.jsx("span",{className:"court-standard",style:{background:"#f87171",color:"white"},children:"Excluded Area"})]})]}),o.jsx("div",{className:"properties-panel__content",children:o.jsxs("div",{className:"properties-section",children:[o.jsx("div",{className:"property-group",style:{background:"#fef2f2",padding:"0.75rem",borderRadius:"6px",marginBottom:"1rem",border:"1px solid #fecaca"},children:o.jsx("p",{style:{fontSize:"0.75rem",color:"#991b1b",margin:0},children:"This area represents a building, planter, or other obstacle. It is excluded from material calculations."})}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Dimensions"}),o.jsxs("div",{className:"property-input-row",children:[o.jsxs("div",{className:"property-input-group",children:[o.jsx("span",{className:"property-label",children:"W"}),o.jsx("input",{type:"number",value:Math.round(p),onChange:T=>y("width",T.target.value),step:"100",min:"500"}),o.jsx("span",{className:"property-unit",children:"mm"})]}),o.jsxs("div",{className:"property-input-group",children:[o.jsx("span",{className:"property-label",children:"H"}),o.jsx("input",{type:"number",value:Math.round(h),onChange:T=>y("height",T.target.value),step:"100",min:"500"}),o.jsx("span",{className:"property-unit",children:"mm"})]})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Position"}),o.jsxs("div",{className:"property-input-row",children:[o.jsxs("div",{className:"property-input-group",children:[o.jsx("span",{className:"property-label",children:"X"}),o.jsx("input",{type:"number",value:Math.round(d.x),onChange:T=>x("x",T.target.value),step:"100"}),o.jsx("span",{className:"property-unit",children:"mm"})]}),o.jsxs("div",{className:"property-input-group",children:[o.jsx("span",{className:"property-label",children:"Y"}),o.jsx("input",{type:"number",value:Math.round(d.y),onChange:T=>x("y",T.target.value),step:"100"}),o.jsx("span",{className:"property-unit",children:"mm"})]})]})]}),o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Rotation"}),o.jsxs("div",{className:"property-input-row",children:[o.jsx("input",{type:"range",min:"0",max:"360",value:u||0,onChange:T=>v(T.target.value),className:"property-slider"}),o.jsxs("div",{className:"property-input-group property-input-group--compact",children:[o.jsx("input",{type:"number",value:Math.round(u||0),onChange:T=>v(T.target.value),min:"0",max:"360"}),o.jsx("span",{className:"property-unit",children:""})]})]})]}),f===4&&o.jsxs("div",{className:"property-group",children:[o.jsx("label",{children:"Corner Radius"}),o.jsxs("div",{className:"property-input-row",children:[o.jsx("input",{type:"range",min:"0",max:"100",value:m||0,onChange:T=>b(T.target.value),className:"property-slider"}),o.jsxs("div",{className:"property-input-group property-input-group--compact",children:[o.jsx("input",{type:"number",value:Math.round(m||0),onChange:T=>b(T.target.value),min:"0",max:"100"}),o.jsx("span",{className:"property-unit",children:"%"})]})]})]}),o.jsx("div",{className:"properties-section__divider",style:{margin:"1rem 0"},children:o.jsx("span",{children:"Exclusion Info"})}),o.jsxs("div",{className:"property-group property-group--info",children:[o.jsx("label",{children:"Shape"}),o.jsx("div",{className:"property-info",children:o.jsx("span",{children:E})})]}),o.jsxs("div",{className:"property-group property-group--info",children:[o.jsx("label",{children:"Excluded Area"}),o.jsx("div",{className:"property-info",style:{color:"#dc2626"},children:o.jsxs("span",{children:[_.toFixed(2)," m"]})})]}),o.jsx("div",{className:"properties-section__divider",style:{margin:"1rem 0"},children:o.jsx("span",{children:"Actions"})}),o.jsx("div",{className:"property-group property-group--actions",children:o.jsx("button",{className:"btn-secondary",onClick:C,title:"Duplicate exclusion zone",style:{width:"100%",padding:"0.5rem",background:"#f3f4f6",border:"1px solid #e4e9f0",borderRadius:"6px",fontSize:"0.875rem",fontFamily:"inherit",cursor:"pointer",marginBottom:"0.5rem"},children:"Duplicate Zone"})}),o.jsx("div",{className:"property-group property-group--actions",children:o.jsx("button",{className:"btn-delete",onClick:w,title:"Delete exclusion zone",children:"Delete Zone"})}),o.jsx("div",{className:"property-group",children:o.jsx("div",{className:"property-hint",style:{fontStyle:"normal",color:"#64748b",fontSize:"0.75rem",marginTop:"1rem"},children:"Drag the zone on the canvas to reposition. Use handles to resize."})})]})})]})}function i5(){const{courts:e,tracks:t,motifs:n,shapes:r,texts:i,exclusionZones:s,elementOrder:a,selectedCourtId:l,selectedTrackId:c,selectedMotifId:d,selectedShapeId:u,selectedTextId:p,selectedExclusionZoneId:h,setElementOrder:f,selectCourt:m,selectTrack:g,selectMotif:x,selectShape:y,selectText:v,selectExclusionZone:b,bringToFront:w,sendToBack:C,duplicateCourt:_,duplicateTrack:j,duplicateMotif:E,duplicateShape:T,duplicateText:M,removeCourt:J,removeTrack:P,removeMotif:q,removeShape:k,removeText:z,removeExclusionZone:he,renameElement:Z,toggleElementLock:K,toggleElementVisibility:H,addToHistory:X}=st(),[F,W]=R.useState(null),[re,se]=R.useState(null),[me,ke]=R.useState(null),[pe,Pe]=R.useState(null),[Re,Ge]=R.useState("");R.useEffect(()=>{const le=()=>ke(null);if(me)return document.addEventListener("click",le),()=>document.removeEventListener("click",le)},[me]);const $e=[...a].reverse(),we=le=>{var ie,je,Y;if(le.startsWith("court-")){const ne=e[le];return{type:"court",name:(ne==null?void 0:ne.customName)||((ie=ne==null?void 0:ne.template)==null?void 0:ie.name)||"Unknown Court",icon:"",sport:((je=ne==null?void 0:ne.template)==null?void 0:je.sport)||"",locked:(ne==null?void 0:ne.locked)||!1,visible:(ne==null?void 0:ne.visible)!==!1}}else if(le.startsWith("track-")){const ne=t[le];return{type:"track",name:(ne==null?void 0:ne.customName)||((Y=ne==null?void 0:ne.template)==null?void 0:Y.name)||"Unknown Track",icon:"",sport:"athletics",locked:(ne==null?void 0:ne.locked)||!1,visible:(ne==null?void 0:ne.visible)!==!1}}else if(le.startsWith("motif-")){const ne=n[le];return{type:"motif",name:(ne==null?void 0:ne.customName)||(ne==null?void 0:ne.sourceDesignName)||"Unknown Motif",icon:"",sport:"playground",locked:(ne==null?void 0:ne.locked)||!1,visible:(ne==null?void 0:ne.visible)!==!1}}else if(le.startsWith("shape-")){const ne=r[le],Ie=(ne==null?void 0:ne.sides)>=32?"Circle":(ne==null?void 0:ne.sides)===3?"Triangle":(ne==null?void 0:ne.sides)===4?"Rectangle":`${ne==null?void 0:ne.sides}-gon`;return{type:"shape",name:(ne==null?void 0:ne.customName)||Ie||"Unknown Shape",icon:(ne==null?void 0:ne.sides)>=32?"":(ne==null?void 0:ne.sides)===3?"":(ne==null?void 0:ne.sides)===4?"":"",sport:"shape",locked:(ne==null?void 0:ne.locked)||!1,visible:(ne==null?void 0:ne.visible)!==!1}}else if(le.startsWith("text-")){const ne=i[le],Ie=(ne==null?void 0:ne.content)||"Text Label",Ke=Ie.length>20?Ie.substring(0,20)+"...":Ie;return{type:"text",name:(ne==null?void 0:ne.customName)||Ke,icon:"T",sport:"text",locked:(ne==null?void 0:ne.locked)||!1,visible:(ne==null?void 0:ne.visible)!==!1}}else if(le.startsWith("exclusion-")){const ne=s[le];return{type:"exclusion",name:(ne==null?void 0:ne.customName)||"Exclusion Zone",icon:"",sport:"exclusion",locked:(ne==null?void 0:ne.locked)||!1,visible:(ne==null?void 0:ne.visible)!==!1}}return{type:"unknown",name:"Unknown",icon:"",sport:"",locked:!1,visible:!0}},xe=le=>le===l||le===c||le===d||le===u||le===p||le===h,S=le=>{le.startsWith("court-")?m(le):le.startsWith("track-")?g(le):le.startsWith("motif-")?x(le):le.startsWith("shape-")?y(le):le.startsWith("text-")?v(le):le.startsWith("exclusion-")&&b(le)},ue=(le,ie)=>{W(ie),le.dataTransfer.effectAllowed="move",le.dataTransfer.setData("text/plain",ie),setTimeout(()=>{le.target.classList.add("layer-item--dragging")},0)},ce=le=>{le.target.classList.remove("layer-item--dragging"),W(null),se(null)},I=(le,ie)=>{le.preventDefault(),le.dataTransfer.dropEffect="move",ie!==F&&se(ie)},N=()=>{se(null)},B=(le,ie)=>{if(le.preventDefault(),!F||F===ie){W(null),se(null);return}const je=[...a],Y=je.indexOf(F),ne=je.indexOf(ie);if(Y===-1||ne===-1)return;je.splice(Y,1);const Ie=$e.indexOf(F),Ke=$e.indexOf(ie);Ie<Ke,je.splice(ne,0,F),f(je),X(),W(null),se(null)},oe=(le,ie)=>{le.stopPropagation(),w(ie),ke(null)},de=(le,ie)=>{le.stopPropagation(),C(ie),ke(null)},G=(le,ie)=>{le.stopPropagation(),ie.startsWith("court-")?_(ie):ie.startsWith("track-")?j(ie):ie.startsWith("motif-")?E(ie):ie.startsWith("shape-")?T(ie):ie.startsWith("text-")&&M(ie),ke(null)},te=(le,ie)=>{le.stopPropagation();const je=we(ie);confirm(`Delete "${je.name}"?`)&&(ie.startsWith("court-")?J(ie):ie.startsWith("track-")?P(ie):ie.startsWith("motif-")?q(ie):ie.startsWith("shape-")?k(ie):ie.startsWith("text-")?z(ie):ie.startsWith("exclusion-")&&he(ie)),ke(null)},ge=(le,ie)=>{le.stopPropagation();const je=we(ie);Pe(ie),Ge(je.name),ke(null)},V=le=>{Re.trim()&&Z(le,Re.trim()),Pe(null),Ge("")},$=(le,ie)=>{le.key==="Enter"?V(ie):le.key==="Escape"&&(Pe(null),Ge(""))},D=(le,ie)=>{le.stopPropagation(),K(ie),ke(null)},ae=(le,ie)=>{le.stopPropagation(),H(ie),ke(null)},Se=(le,ie)=>{le.stopPropagation(),ke(me===ie?null:ie)};return a.length===0?o.jsx("div",{className:"layers-panel layers-panel--empty",children:o.jsxs("div",{className:"layers-panel__empty-state",children:[o.jsx("span",{className:"layers-panel__empty-icon",children:""}),o.jsx("p",{children:"No elements yet"}),o.jsx("span",{className:"layers-panel__empty-hint",children:"Add courts, tracks, motifs, shapes, or text"})]})}):o.jsxs("div",{className:"layers-panel",children:[o.jsxs("div",{className:"layers-panel__header",children:[o.jsx("h4",{children:"Layers"}),o.jsx("span",{className:"layers-panel__count",children:a.length})]}),o.jsx("div",{className:"layers-panel__hint",children:"Drag to reorder layers. Top = front, bottom = back."}),o.jsx("div",{className:"layers-panel__list",children:$e.map((le,ie)=>{const je=we(le),Y=xe(le),ne=le===re,Ie=ie===0,Ke=ie===$e.length-1,Je=pe===le;return o.jsxs("div",{className:`layer-item ${Y?"layer-item--selected":""} ${ne?"layer-item--drag-over":""} ${je.locked?"layer-item--locked":""} ${je.visible?"":"layer-item--hidden"}`,draggable:!je.locked&&!Je,onDragStart:De=>ue(De,le),onDragEnd:ce,onDragOver:De=>I(De,le),onDragLeave:N,onDrop:De=>B(De,le),onClick:()=>!Je&&S(le),children:[o.jsx("span",{className:`layer-item__handle ${je.locked?"layer-item__handle--disabled":""}`,title:je.locked?"Locked":"Drag to reorder",children:je.locked?"":""}),Je?o.jsx("input",{type:"text",className:"layer-item__rename-input",value:Re,onChange:De=>Ge(De.target.value),onBlur:()=>V(le),onKeyDown:De=>$(De,le),autoFocus:!0,onClick:De=>De.stopPropagation()}):o.jsx("span",{className:`layer-item__name ${je.visible?"":"layer-item__name--hidden"}`,children:je.name}),o.jsx("div",{className:"layer-item__indicators",children:!je.visible&&o.jsx("span",{className:"layer-item__indicator",title:"Hidden",children:""})}),o.jsxs("div",{className:"layer-item__actions",children:[o.jsx("button",{className:"layer-item__menu-btn",onClick:De=>Se(De,le),title:"More actions",children:""}),me===le&&o.jsxs("div",{className:"layer-item__menu",children:[o.jsx("button",{onClick:De=>oe(De,le),disabled:Ie,children:" Bring to Front"}),o.jsx("button",{onClick:De=>de(De,le),disabled:Ke,children:" Send to Back"}),o.jsx("div",{className:"layer-item__menu-divider"}),o.jsx("button",{onClick:De=>G(De,le),children:" Duplicate"}),o.jsx("button",{onClick:De=>ge(De,le),children:" Rename"}),o.jsx("div",{className:"layer-item__menu-divider"}),o.jsx("button",{onClick:De=>D(De,le),children:je.locked?" Unlock":" Lock"}),o.jsx("button",{onClick:De=>ae(De,le),children:je.visible?" Hide":" Show"}),o.jsx("div",{className:"layer-item__menu-divider"}),o.jsx("button",{onClick:De=>te(De,le),className:"layer-item__menu-delete",children:" Delete"})]})]})]},le)})}),Object.keys(s).length>0&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"layers-panel__section-divider",children:o.jsx("span",{children:"Exclusion Zones"})}),o.jsx("div",{className:"layers-panel__list layers-panel__list--exclusions",children:Object.keys(s).map(le=>{const ie=we(le),je=xe(le);return o.jsxs("div",{className:`layer-item layer-item--exclusion ${je?"layer-item--selected":""} ${ie.locked?"layer-item--locked":""} ${ie.visible?"":"layer-item--hidden"}`,onClick:()=>S(le),children:[o.jsx("span",{className:"layer-item__handle layer-item__handle--disabled",children:ie.icon}),o.jsx("span",{className:`layer-item__name ${ie.visible?"":"layer-item__name--hidden"}`,children:ie.name}),o.jsx("div",{className:"layer-item__indicators",children:!ie.visible&&o.jsx("span",{className:"layer-item__indicator",title:"Hidden",children:""})}),o.jsxs("div",{className:"layer-item__actions",children:[o.jsx("button",{className:"layer-item__menu-btn",onClick:Y=>Se(Y,le),title:"More actions",children:""}),me===le&&o.jsxs("div",{className:"layer-item__menu",children:[o.jsx("button",{onClick:Y=>ge(Y,le),children:" Rename"}),o.jsx("div",{className:"layer-item__menu-divider"}),o.jsx("button",{onClick:Y=>D(Y,le),children:ie.locked?" Unlock":" Lock"}),o.jsx("button",{onClick:Y=>ae(Y,le),children:ie.visible?" Hide":" Show"}),o.jsx("div",{className:"layer-item__menu-divider"}),o.jsx("button",{onClick:Y=>te(Y,le),className:"layer-item__menu-delete",children:" Delete"})]})]})]},le)})})]}),o.jsx("div",{className:"layers-panel__footer",children:o.jsx("span",{className:"layers-panel__shortcut-hint",children:"Tip: Use [ and ] keys to reorder selected element"})})]})}async function Xw(){var n,r;const e=await Jt.auth.getSession(),t=(r=(n=e==null?void 0:e.data)==null?void 0:n.session)==null?void 0:r.access_token;if(!t)throw new Error("Not authenticated");return{"Content-Type":"application/json",Authorization:`Bearer ${t}`}}async function Zw(e){const t=await Xw(),n=await fetch("/api/projects/create",{method:"POST",headers:t,body:JSON.stringify(e)});if(!n.ok){const r=await n.json();throw new Error(r.error||"Unable to create project. Please check your connection and try again.")}return n.json()}async function jf(){const e=await Xw(),t=await fetch("/api/projects/list",{method:"GET",headers:e});if(!t.ok){const n=await t.json();throw new Error(n.error||"Unable to load your projects. Please refresh the page and try again.")}return t.json()}function s5(e,t={}){var n,r;return{type:"sports_surface",version:"1.0",name:t.name||e.name||"Untitled Design",description:t.description||e.description||"",tags:t.tags||e.tags||[],surface:e.surface,courts:o5(e.courts),tracks:a5(e.tracks),motifs:l5(e.motifs),exclusionZones:c5(e.exclusionZones),elementOrder:e.elementOrder||[],customMarkings:e.customMarkings||[],backgroundZones:e.backgroundZones||[],dimensions:{width_mm:((n=e.surface)==null?void 0:n.width_mm)||5e4,length_mm:((r=e.surface)==null?void 0:r.length_mm)||5e4}}}function o5(e){return e?Object.fromEntries(Object.entries(e).map(([t,n])=>[t,{id:n.id,templateId:n.templateId,template:n.template,position:n.position,rotation:n.rotation,scale:n.scale,lineColorOverrides:n.lineColorOverrides||{},zoneColorOverrides:n.zoneColorOverrides||{},courtSurfaceColor:n.courtSurfaceColor}])):{}}function a5(e){return e?Object.fromEntries(Object.entries(e).map(([t,n])=>[t,{id:n.id,templateId:n.templateId,template:n.template,position:n.position,rotation:n.rotation,parameters:n.parameters,trackSurfaceColor:n.trackSurfaceColor,trackLineColor:n.trackLineColor}])):{}}function l5(e){return e?Object.fromEntries(Object.entries(e).map(([t,n])=>[t,{id:n.id,type:"motif",sourceDesignId:n.sourceDesignId,sourceDesignName:n.sourceDesignName,sourceThumbnailUrl:n.sourceThumbnailUrl,svgContent:n.svgContent,originalWidth_mm:n.originalWidth_mm,originalHeight_mm:n.originalHeight_mm,position:n.position,rotation:n.rotation,scale:n.scale}])):{}}function c5(e){return e?Object.fromEntries(Object.entries(e).map(([t,n])=>[t,{id:n.id,type:"exclusion",shapeType:n.shapeType,sides:n.sides,width_mm:n.width_mm,height_mm:n.height_mm,position:n.position,rotation:n.rotation,cornerRadius:n.cornerRadius,locked:n.locked,visible:n.visible,customName:n.customName,controlPoints:n.controlPoints}])):{}}function d5(e){var r,i;const t=[];return e.surface||t.push("Surface configuration is required"),(!((r=e.surface)!=null&&r.width_mm)||!((i=e.surface)!=null&&i.length_mm))&&t.push("Surface dimensions are required"),e.courts&&Object.keys(e.courts).length>0||e.tracks&&Object.keys(e.tracks).length>0||e.motifs&&Object.keys(e.motifs).length>0||t.push("Add at least one court, track, or motif to save"),{valid:t.length===0,errors:t}}async function u5(e,t=400){return new Promise((n,r)=>{try{const i=e.cloneNode(!0);i.querySelectorAll(".court-canvas__court--selected, .transform-handles").forEach(m=>{m.classList.remove("court-canvas__court--selected")}),i.querySelectorAll(".transform-handles").forEach(m=>m.remove());const s=e.getAttribute("viewBox").split(" ").map(Number),a=s[2],l=s[3];let c,d;a>l?(c=t,d=Math.round(l/a*t)):(d=t,c=Math.round(a/l*t)),i.setAttribute("width",c),i.setAttribute("height",d);const u=new XMLSerializer().serializeToString(i),p=new Blob([u],{type:"image/svg+xml;charset=utf-8"}),h=URL.createObjectURL(p),f=new Image;f.onload=()=>{const m=document.createElement("canvas");m.width=c,m.height=d;const g=m.getContext("2d");g.fillStyle="#ffffff",g.fillRect(0,0,c,d),g.drawImage(f,0,0,c,d),m.toBlob(x=>{URL.revokeObjectURL(h),n(x)},"image/png",.9)},f.onerror=m=>{URL.revokeObjectURL(h),r(new Error("Failed to load SVG for thumbnail"))},f.src=h}catch(i){r(i)}})}async function h5(e){const n=`thumbnails/sports/${`sports-${Date.now()}-${Math.random().toString(36).substr(2,9)}.png`}`,{data:r,error:i}=await Jt.storage.from("tpv-studio-uploads").upload(n,e,{cacheControl:"3600",contentType:"image/png",upsert:!1});if(i)throw i;const{data:{publicUrl:s}}=Jt.storage.from("tpv-studio-uploads").getPublicUrl(n);return s}function p5({existingDesignId:e=null,initialName:t="",svgRef:n=null,onClose:r,onSaved:i}){const s=st(X=>X.exportDesignData),[a,l]=R.useState(t),[c,d]=R.useState(""),[u,p]=R.useState(""),[h,f]=R.useState(""),[m,g]=R.useState(!1),[x,y]=R.useState([]),[v,b]=R.useState(!1),[w,C]=R.useState(""),[_,j]=R.useState("#1a365d"),[E,T]=R.useState(!1),[M,J]=R.useState(!1),[P,q]=R.useState(!1),[k,z]=R.useState(null);R.useEffect(()=>{he()},[]);const he=async()=>{try{const{projects:X}=await jf();y(X)}catch(X){console.error("Failed to load projects:",X),z("Failed to load projects")}},Z=async()=>{if(!w.trim()){z("Project name is required");return}q(!0),z(null);try{const{project:X}=await Zw({name:w.trim(),color:_});y([X,...x]),p(X.id),b(!1),C(""),j("#1a365d")}catch(X){console.error("Failed to create project:",X),z(X.message)}finally{q(!1)}},K=async(X=!1)=>{if(!a.trim()){z("Design name is required");return}const F=s(),W=d5(F);if(!W.valid){z(W.errors.join(", "));return}X?J(!0):T(!0),z(null);try{let re=null;if(n!=null&&n.current)try{console.log("[SPORTS-SAVE] Generating thumbnail...");const pe=await u5(n.current);console.log("[SPORTS-SAVE] Uploading thumbnail..."),re=await h5(pe),console.log("[SPORTS-SAVE] Thumbnail uploaded:",re)}catch(pe){console.warn("[SPORTS-SAVE] Thumbnail generation failed, continuing without:",pe)}const se=s5(F,{name:a.trim(),description:c.trim()||"",tags:h.split(",").map(pe=>pe.trim()).filter(pe=>pe)});console.log("[SPORTS-SAVE] Serialized design data:",se);const me={name:a.trim(),description:c.trim()||null,project_id:u||null,tags:h.split(",").map(pe=>pe.trim()).filter(pe=>pe),is_public:m,design_data:se,thumbnail_url:re};e&&!X&&(me.id=e);const ke=await _f(me);i&&i(ke,a.trim()),r()}catch(re){console.error("Failed to save design:",re),z(re.message)}finally{T(!1),J(!1)}},H=["#1a365d","#ff6b35","#4a90e2","#50c878","#9b59b6","#e74c3c"];return o.jsx("div",{className:"modal-overlay",onClick:r,children:o.jsxs("div",{className:"modal-content save-design-modal",onClick:X=>X.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsx("h2",{children:e?"Update Design":"Save Design"}),o.jsx("button",{onClick:r,className:"close-button",children:""})]}),o.jsxs("div",{className:"modal-body",children:[k&&o.jsx("div",{className:"error-message",children:k}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"design-name",children:"Design Name *"}),o.jsx("input",{id:"design-name",type:"text",value:a,onChange:X=>l(X.target.value),placeholder:"e.g., Multi-Sport Court Design",autoFocus:!0,disabled:E||M})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"design-description",children:"Description"}),o.jsx("textarea",{id:"design-description",value:c,onChange:X=>d(X.target.value),placeholder:"Optional notes about this sports surface design...",rows:3,disabled:E||M})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"design-project",children:"Project"}),v?o.jsxs("div",{className:"new-project-form",children:[o.jsxs("div",{className:"input-row",children:[o.jsx("input",{type:"text",value:w,onChange:X=>C(X.target.value),placeholder:"Project name...",disabled:P}),o.jsx("div",{className:"color-picker-inline",children:H.map(X=>o.jsx("button",{type:"button",className:`color-swatch ${_===X?"active":""}`,style:{backgroundColor:X},onClick:()=>j(X),disabled:P},X))})]}),o.jsxs("div",{className:"button-row",children:[o.jsx("button",{type:"button",onClick:Z,className:"btn-primary btn-small",disabled:P,children:P?"Creating...":"Create"}),o.jsx("button",{type:"button",onClick:()=>b(!1),className:"btn-secondary btn-small",disabled:P,children:"Cancel"})]})]}):o.jsxs("div",{className:"project-selector",children:[o.jsxs("select",{id:"design-project",value:u,onChange:X=>p(X.target.value),disabled:E||M,children:[o.jsx("option",{value:"",children:"No Project"}),x.map(X=>o.jsxs("option",{value:X.id,children:[X.name," (",X.design_count," designs)"]},X.id))]}),o.jsx("button",{type:"button",onClick:()=>b(!0),className:"btn-secondary btn-small",disabled:E||M,children:"+ New Project"})]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"design-tags",children:"Tags"}),o.jsx("input",{id:"design-tags",type:"text",value:h,onChange:X=>f(X.target.value),placeholder:"e.g., tennis, multi-sport, school (comma-separated)",disabled:E||M}),o.jsx("small",{className:"help-text",children:"Separate tags with commas"})]}),o.jsx("div",{className:"form-group checkbox-group",children:o.jsxs("label",{children:[o.jsx("input",{type:"checkbox",checked:m,onChange:X=>g(X.target.checked),disabled:E||M}),o.jsx("span",{children:"Make this design public (shareable link)"})]})})]}),o.jsxs("div",{className:"modal-footer",children:[o.jsx("button",{onClick:r,className:"btn-secondary",disabled:E||M,children:"Cancel"}),e&&o.jsx("button",{onClick:()=>K(!0),className:"btn-secondary",disabled:E||M,children:M?"Saving...":"Save as New"}),o.jsx("button",{onClick:()=>K(!1),className:"btn-primary",disabled:E||M,children:E?"Saving...":e?"Update":"Save Design"})]})]})})}function Cf(e,t){var p,h,f,m;if(!e)throw new Error("SVG element not found");const n=e.cloneNode(!0);n.querySelectorAll('.court-canvas__selection-outline, .transform-handles, [class*="selection"], [class*="handle"]').forEach(g=>g.remove()),n.querySelectorAll("[stroke-dasharray]").forEach(g=>{g.getAttribute("stroke-dasharray")&&g.remove()});const s=document.createElementNS("http://www.w3.org/2000/svg","title");s.textContent=(t==null?void 0:t.name)||"Sports Surface Design",n.insertBefore(s,n.firstChild);const a=document.createElementNS("http://www.w3.org/2000/svg","desc");a.textContent=`Generated by TPV Designer. Dimensions: ${(((p=t==null?void 0:t.surface)==null?void 0:p.width_mm)/1e3).toFixed(1)}m  ${(((h=t==null?void 0:t.surface)==null?void 0:h.length_mm)/1e3).toFixed(1)}m`,n.insertBefore(a,n.firstChild.nextSibling),n.setAttribute("xmlns","http://www.w3.org/2000/svg"),n.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");const l=((f=t==null?void 0:t.surface)==null?void 0:f.width_mm)||5e4,c=((m=t==null?void 0:t.surface)==null?void 0:m.length_mm)||5e4;n.setAttribute("width",`${l}mm`),n.setAttribute("height",`${c}mm`),n.setAttribute("data-tpv-studio","1.0"),n.setAttribute("data-design-type","sports_surface");let u=new XMLSerializer().serializeToString(n);return u=`<?xml version="1.0" encoding="UTF-8"?>
`+u,u}function f5(e,t="sports-surface.svg"){const n=new Blob([e],{type:"image/svg+xml"}),r=URL.createObjectURL(n),i=document.createElement("a");i.href=r,i.download=t,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(r)}async function m5(e,t,n="sports-surface.png",r=2){return new Promise((i,s)=>{try{const a=Cf(e,t),l=document.createElement("canvas"),c=l.getContext("2d"),d=e.getAttribute("viewBox");let u=1200,p=1200;if(d){const[,,g,x]=d.split(" ").map(Number),y=2400,v=x/g;u=Math.min(g/10,y),p=u*v}l.width=u*r,l.height=p*r;const h=new Image,f=new Blob([a],{type:"image/svg+xml;charset=utf-8"}),m=URL.createObjectURL(f);h.onload=()=>{c.fillStyle="#ffffff",c.fillRect(0,0,l.width,l.height),c.drawImage(h,0,0,l.width,l.height),l.toBlob(g=>{if(!g){s(new Error("Failed to create PNG blob"));return}const x=URL.createObjectURL(g),y=document.createElement("a");y.href=x,y.download=n,document.body.appendChild(y),y.click(),document.body.removeChild(y),URL.revokeObjectURL(m),URL.revokeObjectURL(x),i()},"image/png",.95)},h.onerror=g=>{URL.revokeObjectURL(m),s(new Error("Failed to load SVG for PNG conversion"))},h.src=m}catch(a){s(a)}})}function Fu(e,t){const n=(e||"sports-surface").toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"").substring(0,50),r=new Date().toISOString().split("T")[0];return`${n}_${r}.${t}`}function dc(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Kw={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(e,t){(function(n){e.exports=n()})(function(){return function n(r,i,s){function a(d,u){if(!i[d]){if(!r[d]){var p=typeof dc=="function"&&dc;if(!u&&p)return p(d,!0);if(l)return l(d,!0);var h=new Error("Cannot find module '"+d+"'");throw h.code="MODULE_NOT_FOUND",h}var f=i[d]={exports:{}};r[d][0].call(f.exports,function(m){var g=r[d][1][m];return a(g||m)},f,f.exports,n,r,i,s)}return i[d].exports}for(var l=typeof dc=="function"&&dc,c=0;c<s.length;c++)a(s[c]);return a}({1:[function(n,r,i){var s=n("./utils"),a=n("./support"),l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(c){for(var d,u,p,h,f,m,g,x=[],y=0,v=c.length,b=v,w=s.getTypeOf(c)!=="string";y<c.length;)b=v-y,p=w?(d=c[y++],u=y<v?c[y++]:0,y<v?c[y++]:0):(d=c.charCodeAt(y++),u=y<v?c.charCodeAt(y++):0,y<v?c.charCodeAt(y++):0),h=d>>2,f=(3&d)<<4|u>>4,m=1<b?(15&u)<<2|p>>6:64,g=2<b?63&p:64,x.push(l.charAt(h)+l.charAt(f)+l.charAt(m)+l.charAt(g));return x.join("")},i.decode=function(c){var d,u,p,h,f,m,g=0,x=0,y="data:";if(c.substr(0,y.length)===y)throw new Error("Invalid base64 input, it looks like a data url.");var v,b=3*(c=c.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(c.charAt(c.length-1)===l.charAt(64)&&b--,c.charAt(c.length-2)===l.charAt(64)&&b--,b%1!=0)throw new Error("Invalid base64 input, bad content length.");for(v=a.uint8array?new Uint8Array(0|b):new Array(0|b);g<c.length;)d=l.indexOf(c.charAt(g++))<<2|(h=l.indexOf(c.charAt(g++)))>>4,u=(15&h)<<4|(f=l.indexOf(c.charAt(g++)))>>2,p=(3&f)<<6|(m=l.indexOf(c.charAt(g++))),v[x++]=d,f!==64&&(v[x++]=u),m!==64&&(v[x++]=p);return v}},{"./support":30,"./utils":32}],2:[function(n,r,i){var s=n("./external"),a=n("./stream/DataWorker"),l=n("./stream/Crc32Probe"),c=n("./stream/DataLengthProbe");function d(u,p,h,f,m){this.compressedSize=u,this.uncompressedSize=p,this.crc32=h,this.compression=f,this.compressedContent=m}d.prototype={getContentWorker:function(){var u=new a(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new c("data_length")),p=this;return u.on("end",function(){if(this.streamInfo.data_length!==p.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),u},getCompressedWorker:function(){return new a(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},d.createWorkerFrom=function(u,p,h){return u.pipe(new l).pipe(new c("uncompressedSize")).pipe(p.compressWorker(h)).pipe(new c("compressedSize")).withStreamInfo("compression",p)},r.exports=d},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(n,r,i){var s=n("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},i.DEFLATE=n("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(n,r,i){var s=n("./utils"),a=function(){for(var l,c=[],d=0;d<256;d++){l=d;for(var u=0;u<8;u++)l=1&l?3988292384^l>>>1:l>>>1;c[d]=l}return c}();r.exports=function(l,c){return l!==void 0&&l.length?s.getTypeOf(l)!=="string"?function(d,u,p,h){var f=a,m=h+p;d^=-1;for(var g=h;g<m;g++)d=d>>>8^f[255&(d^u[g])];return-1^d}(0|c,l,l.length,0):function(d,u,p,h){var f=a,m=h+p;d^=-1;for(var g=h;g<m;g++)d=d>>>8^f[255&(d^u.charCodeAt(g))];return-1^d}(0|c,l,l.length,0):0}},{"./utils":32}],5:[function(n,r,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(n,r,i){var s=null;s=typeof Promise<"u"?Promise:n("lie"),r.exports={Promise:s}},{lie:37}],7:[function(n,r,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=n("pako"),l=n("./utils"),c=n("./stream/GenericWorker"),d=s?"uint8array":"array";function u(p,h){c.call(this,"FlateWorker/"+p),this._pako=null,this._pakoAction=p,this._pakoOptions=h,this.meta={}}i.magic="\b\0",l.inherits(u,c),u.prototype.processChunk=function(p){this.meta=p.meta,this._pako===null&&this._createPako(),this._pako.push(l.transformTo(d,p.data),!1)},u.prototype.flush=function(){c.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},u.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this._pako=null},u.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var p=this;this._pako.onData=function(h){p.push({data:h,meta:p.meta})}},i.compressWorker=function(p){return new u("Deflate",p)},i.uncompressWorker=function(){return new u("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(n,r,i){function s(f,m){var g,x="";for(g=0;g<m;g++)x+=String.fromCharCode(255&f),f>>>=8;return x}function a(f,m,g,x,y,v){var b,w,C=f.file,_=f.compression,j=v!==d.utf8encode,E=l.transformTo("string",v(C.name)),T=l.transformTo("string",d.utf8encode(C.name)),M=C.comment,J=l.transformTo("string",v(M)),P=l.transformTo("string",d.utf8encode(M)),q=T.length!==C.name.length,k=P.length!==M.length,z="",he="",Z="",K=C.dir,H=C.date,X={crc32:0,compressedSize:0,uncompressedSize:0};m&&!g||(X.crc32=f.crc32,X.compressedSize=f.compressedSize,X.uncompressedSize=f.uncompressedSize);var F=0;m&&(F|=8),j||!q&&!k||(F|=2048);var W=0,re=0;K&&(W|=16),y==="UNIX"?(re=798,W|=function(me,ke){var pe=me;return me||(pe=ke?16893:33204),(65535&pe)<<16}(C.unixPermissions,K)):(re=20,W|=function(me){return 63&(me||0)}(C.dosPermissions)),b=H.getUTCHours(),b<<=6,b|=H.getUTCMinutes(),b<<=5,b|=H.getUTCSeconds()/2,w=H.getUTCFullYear()-1980,w<<=4,w|=H.getUTCMonth()+1,w<<=5,w|=H.getUTCDate(),q&&(he=s(1,1)+s(u(E),4)+T,z+="up"+s(he.length,2)+he),k&&(Z=s(1,1)+s(u(J),4)+P,z+="uc"+s(Z.length,2)+Z);var se="";return se+=`
\0`,se+=s(F,2),se+=_.magic,se+=s(b,2),se+=s(w,2),se+=s(X.crc32,4),se+=s(X.compressedSize,4),se+=s(X.uncompressedSize,4),se+=s(E.length,2),se+=s(z.length,2),{fileRecord:p.LOCAL_FILE_HEADER+se+E+z,dirRecord:p.CENTRAL_FILE_HEADER+s(re,2)+se+s(J.length,2)+"\0\0\0\0"+s(W,4)+s(x,4)+E+z+J}}var l=n("../utils"),c=n("../stream/GenericWorker"),d=n("../utf8"),u=n("../crc32"),p=n("../signature");function h(f,m,g,x){c.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=m,this.zipPlatform=g,this.encodeFileName=x,this.streamFiles=f,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}l.inherits(h,c),h.prototype.push=function(f){var m=f.meta.percent||0,g=this.entriesCount,x=this._sources.length;this.accumulate?this.contentBuffer.push(f):(this.bytesWritten+=f.data.length,c.prototype.push.call(this,{data:f.data,meta:{currentFile:this.currentFile,percent:g?(m+100*(g-x-1))/g:100}}))},h.prototype.openedSource=function(f){this.currentSourceOffset=this.bytesWritten,this.currentFile=f.file.name;var m=this.streamFiles&&!f.file.dir;if(m){var g=a(f,m,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:g.fileRecord,meta:{percent:0}})}else this.accumulate=!0},h.prototype.closedSource=function(f){this.accumulate=!1;var m=this.streamFiles&&!f.file.dir,g=a(f,m,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(g.dirRecord),m)this.push({data:function(x){return p.DATA_DESCRIPTOR+s(x.crc32,4)+s(x.compressedSize,4)+s(x.uncompressedSize,4)}(f),meta:{percent:100}});else for(this.push({data:g.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},h.prototype.flush=function(){for(var f=this.bytesWritten,m=0;m<this.dirRecords.length;m++)this.push({data:this.dirRecords[m],meta:{percent:100}});var g=this.bytesWritten-f,x=function(y,v,b,w,C){var _=l.transformTo("string",C(w));return p.CENTRAL_DIRECTORY_END+"\0\0\0\0"+s(y,2)+s(y,2)+s(v,4)+s(b,4)+s(_.length,2)+_}(this.dirRecords.length,g,f,this.zipComment,this.encodeFileName);this.push({data:x,meta:{percent:100}})},h.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},h.prototype.registerPrevious=function(f){this._sources.push(f);var m=this;return f.on("data",function(g){m.processChunk(g)}),f.on("end",function(){m.closedSource(m.previous.streamInfo),m._sources.length?m.prepareNextSource():m.end()}),f.on("error",function(g){m.error(g)}),this},h.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},h.prototype.error=function(f){var m=this._sources;if(!c.prototype.error.call(this,f))return!1;for(var g=0;g<m.length;g++)try{m[g].error(f)}catch{}return!0},h.prototype.lock=function(){c.prototype.lock.call(this);for(var f=this._sources,m=0;m<f.length;m++)f[m].lock()},r.exports=h},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(n,r,i){var s=n("../compressions"),a=n("./ZipFileWorker");i.generateWorker=function(l,c,d){var u=new a(c.streamFiles,d,c.platform,c.encodeFileName),p=0;try{l.forEach(function(h,f){p++;var m=function(v,b){var w=v||b,C=s[w];if(!C)throw new Error(w+" is not a valid compression method !");return C}(f.options.compression,c.compression),g=f.options.compressionOptions||c.compressionOptions||{},x=f.dir,y=f.date;f._compressWorker(m,g).withStreamInfo("file",{name:h,dir:x,date:y,comment:f.comment||"",unixPermissions:f.unixPermissions,dosPermissions:f.dosPermissions}).pipe(u)}),u.entriesCount=p}catch(h){u.error(h)}return u}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(n,r,i){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new s;for(var l in this)typeof this[l]!="function"&&(a[l]=this[l]);return a}}(s.prototype=n("./object")).loadAsync=n("./load"),s.support=n("./support"),s.defaults=n("./defaults"),s.version="3.10.1",s.loadAsync=function(a,l){return new s().loadAsync(a,l)},s.external=n("./external"),r.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(n,r,i){var s=n("./utils"),a=n("./external"),l=n("./utf8"),c=n("./zipEntries"),d=n("./stream/Crc32Probe"),u=n("./nodejsUtils");function p(h){return new a.Promise(function(f,m){var g=h.decompressed.getContentWorker().pipe(new d);g.on("error",function(x){m(x)}).on("end",function(){g.streamInfo.crc32!==h.decompressed.crc32?m(new Error("Corrupted zip : CRC32 mismatch")):f()}).resume()})}r.exports=function(h,f){var m=this;return f=s.extend(f||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:l.utf8decode}),u.isNode&&u.isStream(h)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",h,!0,f.optimizedBinaryString,f.base64).then(function(g){var x=new c(f);return x.load(g),x}).then(function(g){var x=[a.Promise.resolve(g)],y=g.files;if(f.checkCRC32)for(var v=0;v<y.length;v++)x.push(p(y[v]));return a.Promise.all(x)}).then(function(g){for(var x=g.shift(),y=x.files,v=0;v<y.length;v++){var b=y[v],w=b.fileNameStr,C=s.resolve(b.fileNameStr);m.file(C,b.decompressed,{binary:!0,optimizedBinaryString:!0,date:b.date,dir:b.dir,comment:b.fileCommentStr.length?b.fileCommentStr:null,unixPermissions:b.unixPermissions,dosPermissions:b.dosPermissions,createFolders:f.createFolders}),b.dir||(m.file(C).unsafeOriginalName=w)}return x.zipComment.length&&(m.comment=x.zipComment),m})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(n,r,i){var s=n("../utils"),a=n("../stream/GenericWorker");function l(c,d){a.call(this,"Nodejs stream input adapter for "+c),this._upstreamEnded=!1,this._bindStream(d)}s.inherits(l,a),l.prototype._bindStream=function(c){var d=this;(this._stream=c).pause(),c.on("data",function(u){d.push({data:u,meta:{percent:0}})}).on("error",function(u){d.isPaused?this.generatedError=u:d.error(u)}).on("end",function(){d.isPaused?d._upstreamEnded=!0:d.end()})},l.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},l.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},r.exports=l},{"../stream/GenericWorker":28,"../utils":32}],13:[function(n,r,i){var s=n("readable-stream").Readable;function a(l,c,d){s.call(this,c),this._helper=l;var u=this;l.on("data",function(p,h){u.push(p)||u._helper.pause(),d&&d(h)}).on("error",function(p){u.emit("error",p)}).on("end",function(){u.push(null)})}n("../utils").inherits(a,s),a.prototype._read=function(){this._helper.resume()},r.exports=a},{"../utils":32,"readable-stream":16}],14:[function(n,r,i){r.exports={isNode:typeof Buffer<"u",newBufferFrom:function(s,a){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(s,a);if(typeof s=="number")throw new Error('The "data" argument must not be a number');return new Buffer(s,a)},allocBuffer:function(s){if(Buffer.alloc)return Buffer.alloc(s);var a=new Buffer(s);return a.fill(0),a},isBuffer:function(s){return Buffer.isBuffer(s)},isStream:function(s){return s&&typeof s.on=="function"&&typeof s.pause=="function"&&typeof s.resume=="function"}}},{}],15:[function(n,r,i){function s(C,_,j){var E,T=l.getTypeOf(_),M=l.extend(j||{},u);M.date=M.date||new Date,M.compression!==null&&(M.compression=M.compression.toUpperCase()),typeof M.unixPermissions=="string"&&(M.unixPermissions=parseInt(M.unixPermissions,8)),M.unixPermissions&&16384&M.unixPermissions&&(M.dir=!0),M.dosPermissions&&16&M.dosPermissions&&(M.dir=!0),M.dir&&(C=y(C)),M.createFolders&&(E=x(C))&&v.call(this,E,!0);var J=T==="string"&&M.binary===!1&&M.base64===!1;j&&j.binary!==void 0||(M.binary=!J),(_ instanceof p&&_.uncompressedSize===0||M.dir||!_||_.length===0)&&(M.base64=!1,M.binary=!0,_="",M.compression="STORE",T="string");var P=null;P=_ instanceof p||_ instanceof c?_:m.isNode&&m.isStream(_)?new g(C,_):l.prepareContent(C,_,M.binary,M.optimizedBinaryString,M.base64);var q=new h(C,P,M);this.files[C]=q}var a=n("./utf8"),l=n("./utils"),c=n("./stream/GenericWorker"),d=n("./stream/StreamHelper"),u=n("./defaults"),p=n("./compressedObject"),h=n("./zipObject"),f=n("./generate"),m=n("./nodejsUtils"),g=n("./nodejs/NodejsStreamInputAdapter"),x=function(C){C.slice(-1)==="/"&&(C=C.substring(0,C.length-1));var _=C.lastIndexOf("/");return 0<_?C.substring(0,_):""},y=function(C){return C.slice(-1)!=="/"&&(C+="/"),C},v=function(C,_){return _=_!==void 0?_:u.createFolders,C=y(C),this.files[C]||s.call(this,C,null,{dir:!0,createFolders:_}),this.files[C]};function b(C){return Object.prototype.toString.call(C)==="[object RegExp]"}var w={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(C){var _,j,E;for(_ in this.files)E=this.files[_],(j=_.slice(this.root.length,_.length))&&_.slice(0,this.root.length)===this.root&&C(j,E)},filter:function(C){var _=[];return this.forEach(function(j,E){C(j,E)&&_.push(E)}),_},file:function(C,_,j){if(arguments.length!==1)return C=this.root+C,s.call(this,C,_,j),this;if(b(C)){var E=C;return this.filter(function(M,J){return!J.dir&&E.test(M)})}var T=this.files[this.root+C];return T&&!T.dir?T:null},folder:function(C){if(!C)return this;if(b(C))return this.filter(function(T,M){return M.dir&&C.test(T)});var _=this.root+C,j=v.call(this,_),E=this.clone();return E.root=j.name,E},remove:function(C){C=this.root+C;var _=this.files[C];if(_||(C.slice(-1)!=="/"&&(C+="/"),_=this.files[C]),_&&!_.dir)delete this.files[C];else for(var j=this.filter(function(T,M){return M.name.slice(0,C.length)===C}),E=0;E<j.length;E++)delete this.files[j[E].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(C){var _,j={};try{if((j=l.extend(C||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=j.type.toLowerCase(),j.compression=j.compression.toUpperCase(),j.type==="binarystring"&&(j.type="string"),!j.type)throw new Error("No output type specified.");l.checkSupport(j.type),j.platform!=="darwin"&&j.platform!=="freebsd"&&j.platform!=="linux"&&j.platform!=="sunos"||(j.platform="UNIX"),j.platform==="win32"&&(j.platform="DOS");var E=j.comment||this.comment||"";_=f.generateWorker(this,j,E)}catch(T){(_=new c("error")).error(T)}return new d(_,j.type||"string",j.mimeType)},generateAsync:function(C,_){return this.generateInternalStream(C).accumulate(_)},generateNodeStream:function(C,_){return(C=C||{}).type||(C.type="nodebuffer"),this.generateInternalStream(C).toNodejsStream(_)}};r.exports=w},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(n,r,i){r.exports=n("stream")},{stream:void 0}],17:[function(n,r,i){var s=n("./DataReader");function a(l){s.call(this,l);for(var c=0;c<this.data.length;c++)l[c]=255&l[c]}n("../utils").inherits(a,s),a.prototype.byteAt=function(l){return this.data[this.zero+l]},a.prototype.lastIndexOfSignature=function(l){for(var c=l.charCodeAt(0),d=l.charCodeAt(1),u=l.charCodeAt(2),p=l.charCodeAt(3),h=this.length-4;0<=h;--h)if(this.data[h]===c&&this.data[h+1]===d&&this.data[h+2]===u&&this.data[h+3]===p)return h-this.zero;return-1},a.prototype.readAndCheckSignature=function(l){var c=l.charCodeAt(0),d=l.charCodeAt(1),u=l.charCodeAt(2),p=l.charCodeAt(3),h=this.readData(4);return c===h[0]&&d===h[1]&&u===h[2]&&p===h[3]},a.prototype.readData=function(l){if(this.checkOffset(l),l===0)return[];var c=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},r.exports=a},{"../utils":32,"./DataReader":18}],18:[function(n,r,i){var s=n("../utils");function a(l){this.data=l,this.length=l.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(l){this.checkIndex(this.index+l)},checkIndex:function(l){if(this.length<this.zero+l||l<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+l+"). Corrupted zip ?")},setIndex:function(l){this.checkIndex(l),this.index=l},skip:function(l){this.setIndex(this.index+l)},byteAt:function(){},readInt:function(l){var c,d=0;for(this.checkOffset(l),c=this.index+l-1;c>=this.index;c--)d=(d<<8)+this.byteAt(c);return this.index+=l,d},readString:function(l){return s.transformTo("string",this.readData(l))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var l=this.readInt(4);return new Date(Date.UTC(1980+(l>>25&127),(l>>21&15)-1,l>>16&31,l>>11&31,l>>5&63,(31&l)<<1))}},r.exports=a},{"../utils":32}],19:[function(n,r,i){var s=n("./Uint8ArrayReader");function a(l){s.call(this,l)}n("../utils").inherits(a,s),a.prototype.readData=function(l){this.checkOffset(l);var c=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},r.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(n,r,i){var s=n("./DataReader");function a(l){s.call(this,l)}n("../utils").inherits(a,s),a.prototype.byteAt=function(l){return this.data.charCodeAt(this.zero+l)},a.prototype.lastIndexOfSignature=function(l){return this.data.lastIndexOf(l)-this.zero},a.prototype.readAndCheckSignature=function(l){return l===this.readData(4)},a.prototype.readData=function(l){this.checkOffset(l);var c=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},r.exports=a},{"../utils":32,"./DataReader":18}],21:[function(n,r,i){var s=n("./ArrayReader");function a(l){s.call(this,l)}n("../utils").inherits(a,s),a.prototype.readData=function(l){if(this.checkOffset(l),l===0)return new Uint8Array(0);var c=this.data.subarray(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},r.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(n,r,i){var s=n("../utils"),a=n("../support"),l=n("./ArrayReader"),c=n("./StringReader"),d=n("./NodeBufferReader"),u=n("./Uint8ArrayReader");r.exports=function(p){var h=s.getTypeOf(p);return s.checkSupport(h),h!=="string"||a.uint8array?h==="nodebuffer"?new d(p):a.uint8array?new u(s.transformTo("uint8array",p)):new l(s.transformTo("array",p)):new c(p)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(n,r,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(n,r,i){var s=n("./GenericWorker"),a=n("../utils");function l(c){s.call(this,"ConvertWorker to "+c),this.destType=c}a.inherits(l,s),l.prototype.processChunk=function(c){this.push({data:a.transformTo(this.destType,c.data),meta:c.meta})},r.exports=l},{"../utils":32,"./GenericWorker":28}],25:[function(n,r,i){var s=n("./GenericWorker"),a=n("../crc32");function l(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n("../utils").inherits(l,s),l.prototype.processChunk=function(c){this.streamInfo.crc32=a(c.data,this.streamInfo.crc32||0),this.push(c)},r.exports=l},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(n,r,i){var s=n("../utils"),a=n("./GenericWorker");function l(c){a.call(this,"DataLengthProbe for "+c),this.propName=c,this.withStreamInfo(c,0)}s.inherits(l,a),l.prototype.processChunk=function(c){if(c){var d=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=d+c.data.length}a.prototype.processChunk.call(this,c)},r.exports=l},{"../utils":32,"./GenericWorker":28}],27:[function(n,r,i){var s=n("../utils"),a=n("./GenericWorker");function l(c){a.call(this,"DataWorker");var d=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,c.then(function(u){d.dataIsReady=!0,d.data=u,d.max=u&&u.length||0,d.type=s.getTypeOf(u),d.isPaused||d._tickAndRepeat()},function(u){d.error(u)})}s.inherits(l,a),l.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},l.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0)},l.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},l.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var c=null,d=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":c=this.data.substring(this.index,d);break;case"uint8array":c=this.data.subarray(this.index,d);break;case"array":case"nodebuffer":c=this.data.slice(this.index,d)}return this.index=d,this.push({data:c,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=l},{"../utils":32,"./GenericWorker":28}],28:[function(n,r,i){function s(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return!this.isFinished&&(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,l){return this._listeners[a].push(l),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,l){if(this._listeners[a])for(var c=0;c<this._listeners[a].length;c++)this._listeners[a][c].call(this,l)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var l=this;return a.on("data",function(c){l.processChunk(c)}),a.on("end",function(){l.end()}),a.on("error",function(c){l.error(c)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var a=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,l){return this.extraStreamInfo[a]=l,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},r.exports=s},{}],29:[function(n,r,i){var s=n("../utils"),a=n("./ConvertWorker"),l=n("./GenericWorker"),c=n("../base64"),d=n("../support"),u=n("../external"),p=null;if(d.nodestream)try{p=n("../nodejs/NodejsStreamOutputAdapter")}catch{}function h(m,g){return new u.Promise(function(x,y){var v=[],b=m._internalType,w=m._outputType,C=m._mimeType;m.on("data",function(_,j){v.push(_),g&&g(j)}).on("error",function(_){v=[],y(_)}).on("end",function(){try{var _=function(j,E,T){switch(j){case"blob":return s.newBlob(s.transformTo("arraybuffer",E),T);case"base64":return c.encode(E);default:return s.transformTo(j,E)}}(w,function(j,E){var T,M=0,J=null,P=0;for(T=0;T<E.length;T++)P+=E[T].length;switch(j){case"string":return E.join("");case"array":return Array.prototype.concat.apply([],E);case"uint8array":for(J=new Uint8Array(P),T=0;T<E.length;T++)J.set(E[T],M),M+=E[T].length;return J;case"nodebuffer":return Buffer.concat(E);default:throw new Error("concat : unsupported type '"+j+"'")}}(b,v),C);x(_)}catch(j){y(j)}v=[]}).resume()})}function f(m,g,x){var y=g;switch(g){case"blob":case"arraybuffer":y="uint8array";break;case"base64":y="string"}try{this._internalType=y,this._outputType=g,this._mimeType=x,s.checkSupport(y),this._worker=m.pipe(new a(y)),m.lock()}catch(v){this._worker=new l("error"),this._worker.error(v)}}f.prototype={accumulate:function(m){return h(this,m)},on:function(m,g){var x=this;return m==="data"?this._worker.on(m,function(y){g.call(x,y.data,y.meta)}):this._worker.on(m,function(){s.delay(g,arguments,x)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(m){if(s.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new p(this,{objectMode:this._outputType!=="nodebuffer"},m)}},r.exports=f},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(n,r,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof Buffer<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var s=new ArrayBuffer(0);try{i.blob=new Blob([s],{type:"application/zip"}).size===0}catch{try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(s),i.blob=a.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!n("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(n,r,i){for(var s=n("./utils"),a=n("./support"),l=n("./nodejsUtils"),c=n("./stream/GenericWorker"),d=new Array(256),u=0;u<256;u++)d[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;d[254]=d[254]=1;function p(){c.call(this,"utf-8 decode"),this.leftOver=null}function h(){c.call(this,"utf-8 encode")}i.utf8encode=function(f){return a.nodebuffer?l.newBufferFrom(f,"utf-8"):function(m){var g,x,y,v,b,w=m.length,C=0;for(v=0;v<w;v++)(64512&(x=m.charCodeAt(v)))==55296&&v+1<w&&(64512&(y=m.charCodeAt(v+1)))==56320&&(x=65536+(x-55296<<10)+(y-56320),v++),C+=x<128?1:x<2048?2:x<65536?3:4;for(g=a.uint8array?new Uint8Array(C):new Array(C),v=b=0;b<C;v++)(64512&(x=m.charCodeAt(v)))==55296&&v+1<w&&(64512&(y=m.charCodeAt(v+1)))==56320&&(x=65536+(x-55296<<10)+(y-56320),v++),x<128?g[b++]=x:(x<2048?g[b++]=192|x>>>6:(x<65536?g[b++]=224|x>>>12:(g[b++]=240|x>>>18,g[b++]=128|x>>>12&63),g[b++]=128|x>>>6&63),g[b++]=128|63&x);return g}(f)},i.utf8decode=function(f){return a.nodebuffer?s.transformTo("nodebuffer",f).toString("utf-8"):function(m){var g,x,y,v,b=m.length,w=new Array(2*b);for(g=x=0;g<b;)if((y=m[g++])<128)w[x++]=y;else if(4<(v=d[y]))w[x++]=65533,g+=v-1;else{for(y&=v===2?31:v===3?15:7;1<v&&g<b;)y=y<<6|63&m[g++],v--;1<v?w[x++]=65533:y<65536?w[x++]=y:(y-=65536,w[x++]=55296|y>>10&1023,w[x++]=56320|1023&y)}return w.length!==x&&(w.subarray?w=w.subarray(0,x):w.length=x),s.applyFromCharCode(w)}(f=s.transformTo(a.uint8array?"uint8array":"array",f))},s.inherits(p,c),p.prototype.processChunk=function(f){var m=s.transformTo(a.uint8array?"uint8array":"array",f.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var g=m;(m=new Uint8Array(g.length+this.leftOver.length)).set(this.leftOver,0),m.set(g,this.leftOver.length)}else m=this.leftOver.concat(m);this.leftOver=null}var x=function(v,b){var w;for((b=b||v.length)>v.length&&(b=v.length),w=b-1;0<=w&&(192&v[w])==128;)w--;return w<0||w===0?b:w+d[v[w]]>b?w:b}(m),y=m;x!==m.length&&(a.uint8array?(y=m.subarray(0,x),this.leftOver=m.subarray(x,m.length)):(y=m.slice(0,x),this.leftOver=m.slice(x,m.length))),this.push({data:i.utf8decode(y),meta:f.meta})},p.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=p,s.inherits(h,c),h.prototype.processChunk=function(f){this.push({data:i.utf8encode(f.data),meta:f.meta})},i.Utf8EncodeWorker=h},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(n,r,i){var s=n("./support"),a=n("./base64"),l=n("./nodejsUtils"),c=n("./external");function d(g){return g}function u(g,x){for(var y=0;y<g.length;++y)x[y]=255&g.charCodeAt(y);return x}n("setimmediate"),i.newBlob=function(g,x){i.checkSupport("blob");try{return new Blob([g],{type:x})}catch{try{var y=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return y.append(g),y.getBlob(x)}catch{throw new Error("Bug : can't construct the Blob.")}}};var p={stringifyByChunk:function(g,x,y){var v=[],b=0,w=g.length;if(w<=y)return String.fromCharCode.apply(null,g);for(;b<w;)x==="array"||x==="nodebuffer"?v.push(String.fromCharCode.apply(null,g.slice(b,Math.min(b+y,w)))):v.push(String.fromCharCode.apply(null,g.subarray(b,Math.min(b+y,w)))),b+=y;return v.join("")},stringifyByChar:function(g){for(var x="",y=0;y<g.length;y++)x+=String.fromCharCode(g[y]);return x},applyCanBeUsed:{uint8array:function(){try{return s.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return s.nodebuffer&&String.fromCharCode.apply(null,l.allocBuffer(1)).length===1}catch{return!1}}()}};function h(g){var x=65536,y=i.getTypeOf(g),v=!0;if(y==="uint8array"?v=p.applyCanBeUsed.uint8array:y==="nodebuffer"&&(v=p.applyCanBeUsed.nodebuffer),v)for(;1<x;)try{return p.stringifyByChunk(g,y,x)}catch{x=Math.floor(x/2)}return p.stringifyByChar(g)}function f(g,x){for(var y=0;y<g.length;y++)x[y]=g[y];return x}i.applyFromCharCode=h;var m={};m.string={string:d,array:function(g){return u(g,new Array(g.length))},arraybuffer:function(g){return m.string.uint8array(g).buffer},uint8array:function(g){return u(g,new Uint8Array(g.length))},nodebuffer:function(g){return u(g,l.allocBuffer(g.length))}},m.array={string:h,array:d,arraybuffer:function(g){return new Uint8Array(g).buffer},uint8array:function(g){return new Uint8Array(g)},nodebuffer:function(g){return l.newBufferFrom(g)}},m.arraybuffer={string:function(g){return h(new Uint8Array(g))},array:function(g){return f(new Uint8Array(g),new Array(g.byteLength))},arraybuffer:d,uint8array:function(g){return new Uint8Array(g)},nodebuffer:function(g){return l.newBufferFrom(new Uint8Array(g))}},m.uint8array={string:h,array:function(g){return f(g,new Array(g.length))},arraybuffer:function(g){return g.buffer},uint8array:d,nodebuffer:function(g){return l.newBufferFrom(g)}},m.nodebuffer={string:h,array:function(g){return f(g,new Array(g.length))},arraybuffer:function(g){return m.nodebuffer.uint8array(g).buffer},uint8array:function(g){return f(g,new Uint8Array(g.length))},nodebuffer:d},i.transformTo=function(g,x){if(x=x||"",!g)return x;i.checkSupport(g);var y=i.getTypeOf(x);return m[y][g](x)},i.resolve=function(g){for(var x=g.split("/"),y=[],v=0;v<x.length;v++){var b=x[v];b==="."||b===""&&v!==0&&v!==x.length-1||(b===".."?y.pop():y.push(b))}return y.join("/")},i.getTypeOf=function(g){return typeof g=="string"?"string":Object.prototype.toString.call(g)==="[object Array]"?"array":s.nodebuffer&&l.isBuffer(g)?"nodebuffer":s.uint8array&&g instanceof Uint8Array?"uint8array":s.arraybuffer&&g instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(g){if(!s[g.toLowerCase()])throw new Error(g+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(g){var x,y,v="";for(y=0;y<(g||"").length;y++)v+="\\x"+((x=g.charCodeAt(y))<16?"0":"")+x.toString(16).toUpperCase();return v},i.delay=function(g,x,y){setImmediate(function(){g.apply(y||null,x||[])})},i.inherits=function(g,x){function y(){}y.prototype=x.prototype,g.prototype=new y},i.extend=function(){var g,x,y={};for(g=0;g<arguments.length;g++)for(x in arguments[g])Object.prototype.hasOwnProperty.call(arguments[g],x)&&y[x]===void 0&&(y[x]=arguments[g][x]);return y},i.prepareContent=function(g,x,y,v,b){return c.Promise.resolve(x).then(function(w){return s.blob&&(w instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(w))!==-1)&&typeof FileReader<"u"?new c.Promise(function(C,_){var j=new FileReader;j.onload=function(E){C(E.target.result)},j.onerror=function(E){_(E.target.error)},j.readAsArrayBuffer(w)}):w}).then(function(w){var C=i.getTypeOf(w);return C?(C==="arraybuffer"?w=i.transformTo("uint8array",w):C==="string"&&(b?w=a.decode(w):y&&v!==!0&&(w=function(_){return u(_,s.uint8array?new Uint8Array(_.length):new Array(_.length))}(w))),w):c.Promise.reject(new Error("Can't read the data of '"+g+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(n,r,i){var s=n("./reader/readerFor"),a=n("./utils"),l=n("./signature"),c=n("./zipEntry"),d=n("./support");function u(p){this.files=[],this.loadOptions=p}u.prototype={checkSignature:function(p){if(!this.reader.readAndCheckSignature(p)){this.reader.index-=4;var h=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(h)+", expected "+a.pretty(p)+")")}},isSignature:function(p,h){var f=this.reader.index;this.reader.setIndex(p);var m=this.reader.readString(4)===h;return this.reader.setIndex(f),m},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var p=this.reader.readData(this.zipCommentLength),h=d.uint8array?"uint8array":"array",f=a.transformTo(h,p);this.zipComment=this.loadOptions.decodeFileName(f)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var p,h,f,m=this.zip64EndOfCentralSize-44;0<m;)p=this.reader.readInt(2),h=this.reader.readInt(4),f=this.reader.readData(h),this.zip64ExtensibleData[p]={id:p,length:h,value:f}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var p,h;for(p=0;p<this.files.length;p++)h=this.files[p],this.reader.setIndex(h.localHeaderOffset),this.checkSignature(l.LOCAL_FILE_HEADER),h.readLocalPart(this.reader),h.handleUTF8(),h.processAttributes()},readCentralDir:function(){var p;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(l.CENTRAL_FILE_HEADER);)(p=new c({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(p);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var p=this.reader.lastIndexOfSignature(l.CENTRAL_DIRECTORY_END);if(p<0)throw this.isSignature(0,l.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(p);var h=p;if(this.checkSignature(l.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(p=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(p),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,l.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var f=this.centralDirOffset+this.centralDirSize;this.zip64&&(f+=20,f+=12+this.zip64EndOfCentralSize);var m=h-f;if(0<m)this.isSignature(h,l.CENTRAL_FILE_HEADER)||(this.reader.zero=m);else if(m<0)throw new Error("Corrupted zip: missing "+Math.abs(m)+" bytes.")},prepareReader:function(p){this.reader=s(p)},load:function(p){this.prepareReader(p),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=u},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(n,r,i){var s=n("./reader/readerFor"),a=n("./utils"),l=n("./compressedObject"),c=n("./crc32"),d=n("./utf8"),u=n("./compressions"),p=n("./support");function h(f,m){this.options=f,this.loadOptions=m}h.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(f){var m,g;if(f.skip(22),this.fileNameLength=f.readInt(2),g=f.readInt(2),this.fileName=f.readData(this.fileNameLength),f.skip(g),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((m=function(x){for(var y in u)if(Object.prototype.hasOwnProperty.call(u,y)&&u[y].magic===x)return u[y];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new l(this.compressedSize,this.uncompressedSize,this.crc32,m,f.readData(this.compressedSize))},readCentralPart:function(f){this.versionMadeBy=f.readInt(2),f.skip(2),this.bitFlag=f.readInt(2),this.compressionMethod=f.readString(2),this.date=f.readDate(),this.crc32=f.readInt(4),this.compressedSize=f.readInt(4),this.uncompressedSize=f.readInt(4);var m=f.readInt(2);if(this.extraFieldsLength=f.readInt(2),this.fileCommentLength=f.readInt(2),this.diskNumberStart=f.readInt(2),this.internalFileAttributes=f.readInt(2),this.externalFileAttributes=f.readInt(4),this.localHeaderOffset=f.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");f.skip(m),this.readExtraFields(f),this.parseZIP64ExtraField(f),this.fileComment=f.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var f=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),f==0&&(this.dosPermissions=63&this.externalFileAttributes),f==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var f=s(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=f.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=f.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=f.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=f.readInt(4))}},readExtraFields:function(f){var m,g,x,y=f.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});f.index+4<y;)m=f.readInt(2),g=f.readInt(2),x=f.readData(g),this.extraFields[m]={id:m,length:g,value:x};f.setIndex(y)},handleUTF8:function(){var f=p.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=d.utf8decode(this.fileName),this.fileCommentStr=d.utf8decode(this.fileComment);else{var m=this.findExtraFieldUnicodePath();if(m!==null)this.fileNameStr=m;else{var g=a.transformTo(f,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(g)}var x=this.findExtraFieldUnicodeComment();if(x!==null)this.fileCommentStr=x;else{var y=a.transformTo(f,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(y)}}},findExtraFieldUnicodePath:function(){var f=this.extraFields[28789];if(f){var m=s(f.value);return m.readInt(1)!==1||c(this.fileName)!==m.readInt(4)?null:d.utf8decode(m.readData(f.length-5))}return null},findExtraFieldUnicodeComment:function(){var f=this.extraFields[25461];if(f){var m=s(f.value);return m.readInt(1)!==1||c(this.fileComment)!==m.readInt(4)?null:d.utf8decode(m.readData(f.length-5))}return null}},r.exports=h},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(n,r,i){function s(m,g,x){this.name=m,this.dir=x.dir,this.date=x.date,this.comment=x.comment,this.unixPermissions=x.unixPermissions,this.dosPermissions=x.dosPermissions,this._data=g,this._dataBinary=x.binary,this.options={compression:x.compression,compressionOptions:x.compressionOptions}}var a=n("./stream/StreamHelper"),l=n("./stream/DataWorker"),c=n("./utf8"),d=n("./compressedObject"),u=n("./stream/GenericWorker");s.prototype={internalStream:function(m){var g=null,x="string";try{if(!m)throw new Error("No output type specified.");var y=(x=m.toLowerCase())==="string"||x==="text";x!=="binarystring"&&x!=="text"||(x="string"),g=this._decompressWorker();var v=!this._dataBinary;v&&!y&&(g=g.pipe(new c.Utf8EncodeWorker)),!v&&y&&(g=g.pipe(new c.Utf8DecodeWorker))}catch(b){(g=new u("error")).error(b)}return new a(g,x,"")},async:function(m,g){return this.internalStream(m).accumulate(g)},nodeStream:function(m,g){return this.internalStream(m||"nodebuffer").toNodejsStream(g)},_compressWorker:function(m,g){if(this._data instanceof d&&this._data.compression.magic===m.magic)return this._data.getCompressedWorker();var x=this._decompressWorker();return this._dataBinary||(x=x.pipe(new c.Utf8EncodeWorker)),d.createWorkerFrom(x,m,g)},_decompressWorker:function(){return this._data instanceof d?this._data.getContentWorker():this._data instanceof u?this._data:new l(this._data)}};for(var p=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],h=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},f=0;f<p.length;f++)s.prototype[p[f]]=h;r.exports=s},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(n,r,i){(function(s){var a,l,c=s.MutationObserver||s.WebKitMutationObserver;if(c){var d=0,u=new c(m),p=s.document.createTextNode("");u.observe(p,{characterData:!0}),a=function(){p.data=d=++d%2}}else if(s.setImmediate||s.MessageChannel===void 0)a="document"in s&&"onreadystatechange"in s.document.createElement("script")?function(){var g=s.document.createElement("script");g.onreadystatechange=function(){m(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},s.document.documentElement.appendChild(g)}:function(){setTimeout(m,0)};else{var h=new s.MessageChannel;h.port1.onmessage=m,a=function(){h.port2.postMessage(0)}}var f=[];function m(){var g,x;l=!0;for(var y=f.length;y;){for(x=f,f=[],g=-1;++g<y;)x[g]();y=f.length}l=!1}r.exports=function(g){f.push(g)!==1||l||a()}}).call(this,typeof Mi<"u"?Mi:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(n,r,i){var s=n("immediate");function a(){}var l={},c=["REJECTED"],d=["FULFILLED"],u=["PENDING"];function p(y){if(typeof y!="function")throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,y!==a&&g(this,y)}function h(y,v,b){this.promise=y,typeof v=="function"&&(this.onFulfilled=v,this.callFulfilled=this.otherCallFulfilled),typeof b=="function"&&(this.onRejected=b,this.callRejected=this.otherCallRejected)}function f(y,v,b){s(function(){var w;try{w=v(b)}catch(C){return l.reject(y,C)}w===y?l.reject(y,new TypeError("Cannot resolve promise with itself")):l.resolve(y,w)})}function m(y){var v=y&&y.then;if(y&&(typeof y=="object"||typeof y=="function")&&typeof v=="function")return function(){v.apply(y,arguments)}}function g(y,v){var b=!1;function w(j){b||(b=!0,l.reject(y,j))}function C(j){b||(b=!0,l.resolve(y,j))}var _=x(function(){v(C,w)});_.status==="error"&&w(_.value)}function x(y,v){var b={};try{b.value=y(v),b.status="success"}catch(w){b.status="error",b.value=w}return b}(r.exports=p).prototype.finally=function(y){if(typeof y!="function")return this;var v=this.constructor;return this.then(function(b){return v.resolve(y()).then(function(){return b})},function(b){return v.resolve(y()).then(function(){throw b})})},p.prototype.catch=function(y){return this.then(null,y)},p.prototype.then=function(y,v){if(typeof y!="function"&&this.state===d||typeof v!="function"&&this.state===c)return this;var b=new this.constructor(a);return this.state!==u?f(b,this.state===d?y:v,this.outcome):this.queue.push(new h(b,y,v)),b},h.prototype.callFulfilled=function(y){l.resolve(this.promise,y)},h.prototype.otherCallFulfilled=function(y){f(this.promise,this.onFulfilled,y)},h.prototype.callRejected=function(y){l.reject(this.promise,y)},h.prototype.otherCallRejected=function(y){f(this.promise,this.onRejected,y)},l.resolve=function(y,v){var b=x(m,v);if(b.status==="error")return l.reject(y,b.value);var w=b.value;if(w)g(y,w);else{y.state=d,y.outcome=v;for(var C=-1,_=y.queue.length;++C<_;)y.queue[C].callFulfilled(v)}return y},l.reject=function(y,v){y.state=c,y.outcome=v;for(var b=-1,w=y.queue.length;++b<w;)y.queue[b].callRejected(v);return y},p.resolve=function(y){return y instanceof this?y:l.resolve(new this(a),y)},p.reject=function(y){var v=new this(a);return l.reject(v,y)},p.all=function(y){var v=this;if(Object.prototype.toString.call(y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var b=y.length,w=!1;if(!b)return this.resolve([]);for(var C=new Array(b),_=0,j=-1,E=new this(a);++j<b;)T(y[j],j);return E;function T(M,J){v.resolve(M).then(function(P){C[J]=P,++_!==b||w||(w=!0,l.resolve(E,C))},function(P){w||(w=!0,l.reject(E,P))})}},p.race=function(y){var v=this;if(Object.prototype.toString.call(y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var b=y.length,w=!1;if(!b)return this.resolve([]);for(var C=-1,_=new this(a);++C<b;)j=y[C],v.resolve(j).then(function(E){w||(w=!0,l.resolve(_,E))},function(E){w||(w=!0,l.reject(_,E))});var j;return _}},{immediate:36}],38:[function(n,r,i){var s={};(0,n("./lib/utils/common").assign)(s,n("./lib/deflate"),n("./lib/inflate"),n("./lib/zlib/constants")),r.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(n,r,i){var s=n("./zlib/deflate"),a=n("./utils/common"),l=n("./utils/strings"),c=n("./zlib/messages"),d=n("./zlib/zstream"),u=Object.prototype.toString,p=0,h=-1,f=0,m=8;function g(y){if(!(this instanceof g))return new g(y);this.options=a.assign({level:h,method:m,chunkSize:16384,windowBits:15,memLevel:8,strategy:f,to:""},y||{});var v=this.options;v.raw&&0<v.windowBits?v.windowBits=-v.windowBits:v.gzip&&0<v.windowBits&&v.windowBits<16&&(v.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var b=s.deflateInit2(this.strm,v.level,v.method,v.windowBits,v.memLevel,v.strategy);if(b!==p)throw new Error(c[b]);if(v.header&&s.deflateSetHeader(this.strm,v.header),v.dictionary){var w;if(w=typeof v.dictionary=="string"?l.string2buf(v.dictionary):u.call(v.dictionary)==="[object ArrayBuffer]"?new Uint8Array(v.dictionary):v.dictionary,(b=s.deflateSetDictionary(this.strm,w))!==p)throw new Error(c[b]);this._dict_set=!0}}function x(y,v){var b=new g(v);if(b.push(y,!0),b.err)throw b.msg||c[b.err];return b.result}g.prototype.push=function(y,v){var b,w,C=this.strm,_=this.options.chunkSize;if(this.ended)return!1;w=v===~~v?v:v===!0?4:0,typeof y=="string"?C.input=l.string2buf(y):u.call(y)==="[object ArrayBuffer]"?C.input=new Uint8Array(y):C.input=y,C.next_in=0,C.avail_in=C.input.length;do{if(C.avail_out===0&&(C.output=new a.Buf8(_),C.next_out=0,C.avail_out=_),(b=s.deflate(C,w))!==1&&b!==p)return this.onEnd(b),!(this.ended=!0);C.avail_out!==0&&(C.avail_in!==0||w!==4&&w!==2)||(this.options.to==="string"?this.onData(l.buf2binstring(a.shrinkBuf(C.output,C.next_out))):this.onData(a.shrinkBuf(C.output,C.next_out)))}while((0<C.avail_in||C.avail_out===0)&&b!==1);return w===4?(b=s.deflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===p):w!==2||(this.onEnd(p),!(C.avail_out=0))},g.prototype.onData=function(y){this.chunks.push(y)},g.prototype.onEnd=function(y){y===p&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=y,this.msg=this.strm.msg},i.Deflate=g,i.deflate=x,i.deflateRaw=function(y,v){return(v=v||{}).raw=!0,x(y,v)},i.gzip=function(y,v){return(v=v||{}).gzip=!0,x(y,v)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(n,r,i){var s=n("./zlib/inflate"),a=n("./utils/common"),l=n("./utils/strings"),c=n("./zlib/constants"),d=n("./zlib/messages"),u=n("./zlib/zstream"),p=n("./zlib/gzheader"),h=Object.prototype.toString;function f(g){if(!(this instanceof f))return new f(g);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},g||{});var x=this.options;x.raw&&0<=x.windowBits&&x.windowBits<16&&(x.windowBits=-x.windowBits,x.windowBits===0&&(x.windowBits=-15)),!(0<=x.windowBits&&x.windowBits<16)||g&&g.windowBits||(x.windowBits+=32),15<x.windowBits&&x.windowBits<48&&!(15&x.windowBits)&&(x.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var y=s.inflateInit2(this.strm,x.windowBits);if(y!==c.Z_OK)throw new Error(d[y]);this.header=new p,s.inflateGetHeader(this.strm,this.header)}function m(g,x){var y=new f(x);if(y.push(g,!0),y.err)throw y.msg||d[y.err];return y.result}f.prototype.push=function(g,x){var y,v,b,w,C,_,j=this.strm,E=this.options.chunkSize,T=this.options.dictionary,M=!1;if(this.ended)return!1;v=x===~~x?x:x===!0?c.Z_FINISH:c.Z_NO_FLUSH,typeof g=="string"?j.input=l.binstring2buf(g):h.call(g)==="[object ArrayBuffer]"?j.input=new Uint8Array(g):j.input=g,j.next_in=0,j.avail_in=j.input.length;do{if(j.avail_out===0&&(j.output=new a.Buf8(E),j.next_out=0,j.avail_out=E),(y=s.inflate(j,c.Z_NO_FLUSH))===c.Z_NEED_DICT&&T&&(_=typeof T=="string"?l.string2buf(T):h.call(T)==="[object ArrayBuffer]"?new Uint8Array(T):T,y=s.inflateSetDictionary(this.strm,_)),y===c.Z_BUF_ERROR&&M===!0&&(y=c.Z_OK,M=!1),y!==c.Z_STREAM_END&&y!==c.Z_OK)return this.onEnd(y),!(this.ended=!0);j.next_out&&(j.avail_out!==0&&y!==c.Z_STREAM_END&&(j.avail_in!==0||v!==c.Z_FINISH&&v!==c.Z_SYNC_FLUSH)||(this.options.to==="string"?(b=l.utf8border(j.output,j.next_out),w=j.next_out-b,C=l.buf2string(j.output,b),j.next_out=w,j.avail_out=E-w,w&&a.arraySet(j.output,j.output,b,w,0),this.onData(C)):this.onData(a.shrinkBuf(j.output,j.next_out)))),j.avail_in===0&&j.avail_out===0&&(M=!0)}while((0<j.avail_in||j.avail_out===0)&&y!==c.Z_STREAM_END);return y===c.Z_STREAM_END&&(v=c.Z_FINISH),v===c.Z_FINISH?(y=s.inflateEnd(this.strm),this.onEnd(y),this.ended=!0,y===c.Z_OK):v!==c.Z_SYNC_FLUSH||(this.onEnd(c.Z_OK),!(j.avail_out=0))},f.prototype.onData=function(g){this.chunks.push(g)},f.prototype.onEnd=function(g){g===c.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=g,this.msg=this.strm.msg},i.Inflate=f,i.inflate=m,i.inflateRaw=function(g,x){return(x=x||{}).raw=!0,m(g,x)},i.ungzip=m},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(n,r,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(c){for(var d=Array.prototype.slice.call(arguments,1);d.length;){var u=d.shift();if(u){if(typeof u!="object")throw new TypeError(u+"must be non-object");for(var p in u)u.hasOwnProperty(p)&&(c[p]=u[p])}}return c},i.shrinkBuf=function(c,d){return c.length===d?c:c.subarray?c.subarray(0,d):(c.length=d,c)};var a={arraySet:function(c,d,u,p,h){if(d.subarray&&c.subarray)c.set(d.subarray(u,u+p),h);else for(var f=0;f<p;f++)c[h+f]=d[u+f]},flattenChunks:function(c){var d,u,p,h,f,m;for(d=p=0,u=c.length;d<u;d++)p+=c[d].length;for(m=new Uint8Array(p),d=h=0,u=c.length;d<u;d++)f=c[d],m.set(f,h),h+=f.length;return m}},l={arraySet:function(c,d,u,p,h){for(var f=0;f<p;f++)c[h+f]=d[u+f]},flattenChunks:function(c){return[].concat.apply([],c)}};i.setTyped=function(c){c?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,a)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,l))},i.setTyped(s)},{}],42:[function(n,r,i){var s=n("./common"),a=!0,l=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{l=!1}for(var c=new s.Buf8(256),d=0;d<256;d++)c[d]=252<=d?6:248<=d?5:240<=d?4:224<=d?3:192<=d?2:1;function u(p,h){if(h<65537&&(p.subarray&&l||!p.subarray&&a))return String.fromCharCode.apply(null,s.shrinkBuf(p,h));for(var f="",m=0;m<h;m++)f+=String.fromCharCode(p[m]);return f}c[254]=c[254]=1,i.string2buf=function(p){var h,f,m,g,x,y=p.length,v=0;for(g=0;g<y;g++)(64512&(f=p.charCodeAt(g)))==55296&&g+1<y&&(64512&(m=p.charCodeAt(g+1)))==56320&&(f=65536+(f-55296<<10)+(m-56320),g++),v+=f<128?1:f<2048?2:f<65536?3:4;for(h=new s.Buf8(v),g=x=0;x<v;g++)(64512&(f=p.charCodeAt(g)))==55296&&g+1<y&&(64512&(m=p.charCodeAt(g+1)))==56320&&(f=65536+(f-55296<<10)+(m-56320),g++),f<128?h[x++]=f:(f<2048?h[x++]=192|f>>>6:(f<65536?h[x++]=224|f>>>12:(h[x++]=240|f>>>18,h[x++]=128|f>>>12&63),h[x++]=128|f>>>6&63),h[x++]=128|63&f);return h},i.buf2binstring=function(p){return u(p,p.length)},i.binstring2buf=function(p){for(var h=new s.Buf8(p.length),f=0,m=h.length;f<m;f++)h[f]=p.charCodeAt(f);return h},i.buf2string=function(p,h){var f,m,g,x,y=h||p.length,v=new Array(2*y);for(f=m=0;f<y;)if((g=p[f++])<128)v[m++]=g;else if(4<(x=c[g]))v[m++]=65533,f+=x-1;else{for(g&=x===2?31:x===3?15:7;1<x&&f<y;)g=g<<6|63&p[f++],x--;1<x?v[m++]=65533:g<65536?v[m++]=g:(g-=65536,v[m++]=55296|g>>10&1023,v[m++]=56320|1023&g)}return u(v,m)},i.utf8border=function(p,h){var f;for((h=h||p.length)>p.length&&(h=p.length),f=h-1;0<=f&&(192&p[f])==128;)f--;return f<0||f===0?h:f+c[p[f]]>h?f:h}},{"./common":41}],43:[function(n,r,i){r.exports=function(s,a,l,c){for(var d=65535&s|0,u=s>>>16&65535|0,p=0;l!==0;){for(l-=p=2e3<l?2e3:l;u=u+(d=d+a[c++]|0)|0,--p;);d%=65521,u%=65521}return d|u<<16|0}},{}],44:[function(n,r,i){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(n,r,i){var s=function(){for(var a,l=[],c=0;c<256;c++){a=c;for(var d=0;d<8;d++)a=1&a?3988292384^a>>>1:a>>>1;l[c]=a}return l}();r.exports=function(a,l,c,d){var u=s,p=d+c;a^=-1;for(var h=d;h<p;h++)a=a>>>8^u[255&(a^l[h])];return-1^a}},{}],46:[function(n,r,i){var s,a=n("../utils/common"),l=n("./trees"),c=n("./adler32"),d=n("./crc32"),u=n("./messages"),p=0,h=4,f=0,m=-2,g=-1,x=4,y=2,v=8,b=9,w=286,C=30,_=19,j=2*w+1,E=15,T=3,M=258,J=M+T+1,P=42,q=113,k=1,z=2,he=3,Z=4;function K(S,ue){return S.msg=u[ue],ue}function H(S){return(S<<1)-(4<S?9:0)}function X(S){for(var ue=S.length;0<=--ue;)S[ue]=0}function F(S){var ue=S.state,ce=ue.pending;ce>S.avail_out&&(ce=S.avail_out),ce!==0&&(a.arraySet(S.output,ue.pending_buf,ue.pending_out,ce,S.next_out),S.next_out+=ce,ue.pending_out+=ce,S.total_out+=ce,S.avail_out-=ce,ue.pending-=ce,ue.pending===0&&(ue.pending_out=0))}function W(S,ue){l._tr_flush_block(S,0<=S.block_start?S.block_start:-1,S.strstart-S.block_start,ue),S.block_start=S.strstart,F(S.strm)}function re(S,ue){S.pending_buf[S.pending++]=ue}function se(S,ue){S.pending_buf[S.pending++]=ue>>>8&255,S.pending_buf[S.pending++]=255&ue}function me(S,ue){var ce,I,N=S.max_chain_length,B=S.strstart,oe=S.prev_length,de=S.nice_match,G=S.strstart>S.w_size-J?S.strstart-(S.w_size-J):0,te=S.window,ge=S.w_mask,V=S.prev,$=S.strstart+M,D=te[B+oe-1],ae=te[B+oe];S.prev_length>=S.good_match&&(N>>=2),de>S.lookahead&&(de=S.lookahead);do if(te[(ce=ue)+oe]===ae&&te[ce+oe-1]===D&&te[ce]===te[B]&&te[++ce]===te[B+1]){B+=2,ce++;do;while(te[++B]===te[++ce]&&te[++B]===te[++ce]&&te[++B]===te[++ce]&&te[++B]===te[++ce]&&te[++B]===te[++ce]&&te[++B]===te[++ce]&&te[++B]===te[++ce]&&te[++B]===te[++ce]&&B<$);if(I=M-($-B),B=$-M,oe<I){if(S.match_start=ue,de<=(oe=I))break;D=te[B+oe-1],ae=te[B+oe]}}while((ue=V[ue&ge])>G&&--N!=0);return oe<=S.lookahead?oe:S.lookahead}function ke(S){var ue,ce,I,N,B,oe,de,G,te,ge,V=S.w_size;do{if(N=S.window_size-S.lookahead-S.strstart,S.strstart>=V+(V-J)){for(a.arraySet(S.window,S.window,V,V,0),S.match_start-=V,S.strstart-=V,S.block_start-=V,ue=ce=S.hash_size;I=S.head[--ue],S.head[ue]=V<=I?I-V:0,--ce;);for(ue=ce=V;I=S.prev[--ue],S.prev[ue]=V<=I?I-V:0,--ce;);N+=V}if(S.strm.avail_in===0)break;if(oe=S.strm,de=S.window,G=S.strstart+S.lookahead,te=N,ge=void 0,ge=oe.avail_in,te<ge&&(ge=te),ce=ge===0?0:(oe.avail_in-=ge,a.arraySet(de,oe.input,oe.next_in,ge,G),oe.state.wrap===1?oe.adler=c(oe.adler,de,ge,G):oe.state.wrap===2&&(oe.adler=d(oe.adler,de,ge,G)),oe.next_in+=ge,oe.total_in+=ge,ge),S.lookahead+=ce,S.lookahead+S.insert>=T)for(B=S.strstart-S.insert,S.ins_h=S.window[B],S.ins_h=(S.ins_h<<S.hash_shift^S.window[B+1])&S.hash_mask;S.insert&&(S.ins_h=(S.ins_h<<S.hash_shift^S.window[B+T-1])&S.hash_mask,S.prev[B&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=B,B++,S.insert--,!(S.lookahead+S.insert<T)););}while(S.lookahead<J&&S.strm.avail_in!==0)}function pe(S,ue){for(var ce,I;;){if(S.lookahead<J){if(ke(S),S.lookahead<J&&ue===p)return k;if(S.lookahead===0)break}if(ce=0,S.lookahead>=T&&(S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+T-1])&S.hash_mask,ce=S.prev[S.strstart&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=S.strstart),ce!==0&&S.strstart-ce<=S.w_size-J&&(S.match_length=me(S,ce)),S.match_length>=T)if(I=l._tr_tally(S,S.strstart-S.match_start,S.match_length-T),S.lookahead-=S.match_length,S.match_length<=S.max_lazy_match&&S.lookahead>=T){for(S.match_length--;S.strstart++,S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+T-1])&S.hash_mask,ce=S.prev[S.strstart&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=S.strstart,--S.match_length!=0;);S.strstart++}else S.strstart+=S.match_length,S.match_length=0,S.ins_h=S.window[S.strstart],S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+1])&S.hash_mask;else I=l._tr_tally(S,0,S.window[S.strstart]),S.lookahead--,S.strstart++;if(I&&(W(S,!1),S.strm.avail_out===0))return k}return S.insert=S.strstart<T-1?S.strstart:T-1,ue===h?(W(S,!0),S.strm.avail_out===0?he:Z):S.last_lit&&(W(S,!1),S.strm.avail_out===0)?k:z}function Pe(S,ue){for(var ce,I,N;;){if(S.lookahead<J){if(ke(S),S.lookahead<J&&ue===p)return k;if(S.lookahead===0)break}if(ce=0,S.lookahead>=T&&(S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+T-1])&S.hash_mask,ce=S.prev[S.strstart&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=S.strstart),S.prev_length=S.match_length,S.prev_match=S.match_start,S.match_length=T-1,ce!==0&&S.prev_length<S.max_lazy_match&&S.strstart-ce<=S.w_size-J&&(S.match_length=me(S,ce),S.match_length<=5&&(S.strategy===1||S.match_length===T&&4096<S.strstart-S.match_start)&&(S.match_length=T-1)),S.prev_length>=T&&S.match_length<=S.prev_length){for(N=S.strstart+S.lookahead-T,I=l._tr_tally(S,S.strstart-1-S.prev_match,S.prev_length-T),S.lookahead-=S.prev_length-1,S.prev_length-=2;++S.strstart<=N&&(S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+T-1])&S.hash_mask,ce=S.prev[S.strstart&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=S.strstart),--S.prev_length!=0;);if(S.match_available=0,S.match_length=T-1,S.strstart++,I&&(W(S,!1),S.strm.avail_out===0))return k}else if(S.match_available){if((I=l._tr_tally(S,0,S.window[S.strstart-1]))&&W(S,!1),S.strstart++,S.lookahead--,S.strm.avail_out===0)return k}else S.match_available=1,S.strstart++,S.lookahead--}return S.match_available&&(I=l._tr_tally(S,0,S.window[S.strstart-1]),S.match_available=0),S.insert=S.strstart<T-1?S.strstart:T-1,ue===h?(W(S,!0),S.strm.avail_out===0?he:Z):S.last_lit&&(W(S,!1),S.strm.avail_out===0)?k:z}function Re(S,ue,ce,I,N){this.good_length=S,this.max_lazy=ue,this.nice_length=ce,this.max_chain=I,this.func=N}function Ge(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=v,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*j),this.dyn_dtree=new a.Buf16(2*(2*C+1)),this.bl_tree=new a.Buf16(2*(2*_+1)),X(this.dyn_ltree),X(this.dyn_dtree),X(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(E+1),this.heap=new a.Buf16(2*w+1),X(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*w+1),X(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function $e(S){var ue;return S&&S.state?(S.total_in=S.total_out=0,S.data_type=y,(ue=S.state).pending=0,ue.pending_out=0,ue.wrap<0&&(ue.wrap=-ue.wrap),ue.status=ue.wrap?P:q,S.adler=ue.wrap===2?0:1,ue.last_flush=p,l._tr_init(ue),f):K(S,m)}function we(S){var ue=$e(S);return ue===f&&function(ce){ce.window_size=2*ce.w_size,X(ce.head),ce.max_lazy_match=s[ce.level].max_lazy,ce.good_match=s[ce.level].good_length,ce.nice_match=s[ce.level].nice_length,ce.max_chain_length=s[ce.level].max_chain,ce.strstart=0,ce.block_start=0,ce.lookahead=0,ce.insert=0,ce.match_length=ce.prev_length=T-1,ce.match_available=0,ce.ins_h=0}(S.state),ue}function xe(S,ue,ce,I,N,B){if(!S)return m;var oe=1;if(ue===g&&(ue=6),I<0?(oe=0,I=-I):15<I&&(oe=2,I-=16),N<1||b<N||ce!==v||I<8||15<I||ue<0||9<ue||B<0||x<B)return K(S,m);I===8&&(I=9);var de=new Ge;return(S.state=de).strm=S,de.wrap=oe,de.gzhead=null,de.w_bits=I,de.w_size=1<<de.w_bits,de.w_mask=de.w_size-1,de.hash_bits=N+7,de.hash_size=1<<de.hash_bits,de.hash_mask=de.hash_size-1,de.hash_shift=~~((de.hash_bits+T-1)/T),de.window=new a.Buf8(2*de.w_size),de.head=new a.Buf16(de.hash_size),de.prev=new a.Buf16(de.w_size),de.lit_bufsize=1<<N+6,de.pending_buf_size=4*de.lit_bufsize,de.pending_buf=new a.Buf8(de.pending_buf_size),de.d_buf=1*de.lit_bufsize,de.l_buf=3*de.lit_bufsize,de.level=ue,de.strategy=B,de.method=ce,we(S)}s=[new Re(0,0,0,0,function(S,ue){var ce=65535;for(ce>S.pending_buf_size-5&&(ce=S.pending_buf_size-5);;){if(S.lookahead<=1){if(ke(S),S.lookahead===0&&ue===p)return k;if(S.lookahead===0)break}S.strstart+=S.lookahead,S.lookahead=0;var I=S.block_start+ce;if((S.strstart===0||S.strstart>=I)&&(S.lookahead=S.strstart-I,S.strstart=I,W(S,!1),S.strm.avail_out===0)||S.strstart-S.block_start>=S.w_size-J&&(W(S,!1),S.strm.avail_out===0))return k}return S.insert=0,ue===h?(W(S,!0),S.strm.avail_out===0?he:Z):(S.strstart>S.block_start&&(W(S,!1),S.strm.avail_out),k)}),new Re(4,4,8,4,pe),new Re(4,5,16,8,pe),new Re(4,6,32,32,pe),new Re(4,4,16,16,Pe),new Re(8,16,32,32,Pe),new Re(8,16,128,128,Pe),new Re(8,32,128,256,Pe),new Re(32,128,258,1024,Pe),new Re(32,258,258,4096,Pe)],i.deflateInit=function(S,ue){return xe(S,ue,v,15,8,0)},i.deflateInit2=xe,i.deflateReset=we,i.deflateResetKeep=$e,i.deflateSetHeader=function(S,ue){return S&&S.state?S.state.wrap!==2?m:(S.state.gzhead=ue,f):m},i.deflate=function(S,ue){var ce,I,N,B;if(!S||!S.state||5<ue||ue<0)return S?K(S,m):m;if(I=S.state,!S.output||!S.input&&S.avail_in!==0||I.status===666&&ue!==h)return K(S,S.avail_out===0?-5:m);if(I.strm=S,ce=I.last_flush,I.last_flush=ue,I.status===P)if(I.wrap===2)S.adler=0,re(I,31),re(I,139),re(I,8),I.gzhead?(re(I,(I.gzhead.text?1:0)+(I.gzhead.hcrc?2:0)+(I.gzhead.extra?4:0)+(I.gzhead.name?8:0)+(I.gzhead.comment?16:0)),re(I,255&I.gzhead.time),re(I,I.gzhead.time>>8&255),re(I,I.gzhead.time>>16&255),re(I,I.gzhead.time>>24&255),re(I,I.level===9?2:2<=I.strategy||I.level<2?4:0),re(I,255&I.gzhead.os),I.gzhead.extra&&I.gzhead.extra.length&&(re(I,255&I.gzhead.extra.length),re(I,I.gzhead.extra.length>>8&255)),I.gzhead.hcrc&&(S.adler=d(S.adler,I.pending_buf,I.pending,0)),I.gzindex=0,I.status=69):(re(I,0),re(I,0),re(I,0),re(I,0),re(I,0),re(I,I.level===9?2:2<=I.strategy||I.level<2?4:0),re(I,3),I.status=q);else{var oe=v+(I.w_bits-8<<4)<<8;oe|=(2<=I.strategy||I.level<2?0:I.level<6?1:I.level===6?2:3)<<6,I.strstart!==0&&(oe|=32),oe+=31-oe%31,I.status=q,se(I,oe),I.strstart!==0&&(se(I,S.adler>>>16),se(I,65535&S.adler)),S.adler=1}if(I.status===69)if(I.gzhead.extra){for(N=I.pending;I.gzindex<(65535&I.gzhead.extra.length)&&(I.pending!==I.pending_buf_size||(I.gzhead.hcrc&&I.pending>N&&(S.adler=d(S.adler,I.pending_buf,I.pending-N,N)),F(S),N=I.pending,I.pending!==I.pending_buf_size));)re(I,255&I.gzhead.extra[I.gzindex]),I.gzindex++;I.gzhead.hcrc&&I.pending>N&&(S.adler=d(S.adler,I.pending_buf,I.pending-N,N)),I.gzindex===I.gzhead.extra.length&&(I.gzindex=0,I.status=73)}else I.status=73;if(I.status===73)if(I.gzhead.name){N=I.pending;do{if(I.pending===I.pending_buf_size&&(I.gzhead.hcrc&&I.pending>N&&(S.adler=d(S.adler,I.pending_buf,I.pending-N,N)),F(S),N=I.pending,I.pending===I.pending_buf_size)){B=1;break}B=I.gzindex<I.gzhead.name.length?255&I.gzhead.name.charCodeAt(I.gzindex++):0,re(I,B)}while(B!==0);I.gzhead.hcrc&&I.pending>N&&(S.adler=d(S.adler,I.pending_buf,I.pending-N,N)),B===0&&(I.gzindex=0,I.status=91)}else I.status=91;if(I.status===91)if(I.gzhead.comment){N=I.pending;do{if(I.pending===I.pending_buf_size&&(I.gzhead.hcrc&&I.pending>N&&(S.adler=d(S.adler,I.pending_buf,I.pending-N,N)),F(S),N=I.pending,I.pending===I.pending_buf_size)){B=1;break}B=I.gzindex<I.gzhead.comment.length?255&I.gzhead.comment.charCodeAt(I.gzindex++):0,re(I,B)}while(B!==0);I.gzhead.hcrc&&I.pending>N&&(S.adler=d(S.adler,I.pending_buf,I.pending-N,N)),B===0&&(I.status=103)}else I.status=103;if(I.status===103&&(I.gzhead.hcrc?(I.pending+2>I.pending_buf_size&&F(S),I.pending+2<=I.pending_buf_size&&(re(I,255&S.adler),re(I,S.adler>>8&255),S.adler=0,I.status=q)):I.status=q),I.pending!==0){if(F(S),S.avail_out===0)return I.last_flush=-1,f}else if(S.avail_in===0&&H(ue)<=H(ce)&&ue!==h)return K(S,-5);if(I.status===666&&S.avail_in!==0)return K(S,-5);if(S.avail_in!==0||I.lookahead!==0||ue!==p&&I.status!==666){var de=I.strategy===2?function(G,te){for(var ge;;){if(G.lookahead===0&&(ke(G),G.lookahead===0)){if(te===p)return k;break}if(G.match_length=0,ge=l._tr_tally(G,0,G.window[G.strstart]),G.lookahead--,G.strstart++,ge&&(W(G,!1),G.strm.avail_out===0))return k}return G.insert=0,te===h?(W(G,!0),G.strm.avail_out===0?he:Z):G.last_lit&&(W(G,!1),G.strm.avail_out===0)?k:z}(I,ue):I.strategy===3?function(G,te){for(var ge,V,$,D,ae=G.window;;){if(G.lookahead<=M){if(ke(G),G.lookahead<=M&&te===p)return k;if(G.lookahead===0)break}if(G.match_length=0,G.lookahead>=T&&0<G.strstart&&(V=ae[$=G.strstart-1])===ae[++$]&&V===ae[++$]&&V===ae[++$]){D=G.strstart+M;do;while(V===ae[++$]&&V===ae[++$]&&V===ae[++$]&&V===ae[++$]&&V===ae[++$]&&V===ae[++$]&&V===ae[++$]&&V===ae[++$]&&$<D);G.match_length=M-(D-$),G.match_length>G.lookahead&&(G.match_length=G.lookahead)}if(G.match_length>=T?(ge=l._tr_tally(G,1,G.match_length-T),G.lookahead-=G.match_length,G.strstart+=G.match_length,G.match_length=0):(ge=l._tr_tally(G,0,G.window[G.strstart]),G.lookahead--,G.strstart++),ge&&(W(G,!1),G.strm.avail_out===0))return k}return G.insert=0,te===h?(W(G,!0),G.strm.avail_out===0?he:Z):G.last_lit&&(W(G,!1),G.strm.avail_out===0)?k:z}(I,ue):s[I.level].func(I,ue);if(de!==he&&de!==Z||(I.status=666),de===k||de===he)return S.avail_out===0&&(I.last_flush=-1),f;if(de===z&&(ue===1?l._tr_align(I):ue!==5&&(l._tr_stored_block(I,0,0,!1),ue===3&&(X(I.head),I.lookahead===0&&(I.strstart=0,I.block_start=0,I.insert=0))),F(S),S.avail_out===0))return I.last_flush=-1,f}return ue!==h?f:I.wrap<=0?1:(I.wrap===2?(re(I,255&S.adler),re(I,S.adler>>8&255),re(I,S.adler>>16&255),re(I,S.adler>>24&255),re(I,255&S.total_in),re(I,S.total_in>>8&255),re(I,S.total_in>>16&255),re(I,S.total_in>>24&255)):(se(I,S.adler>>>16),se(I,65535&S.adler)),F(S),0<I.wrap&&(I.wrap=-I.wrap),I.pending!==0?f:1)},i.deflateEnd=function(S){var ue;return S&&S.state?(ue=S.state.status)!==P&&ue!==69&&ue!==73&&ue!==91&&ue!==103&&ue!==q&&ue!==666?K(S,m):(S.state=null,ue===q?K(S,-3):f):m},i.deflateSetDictionary=function(S,ue){var ce,I,N,B,oe,de,G,te,ge=ue.length;if(!S||!S.state||(B=(ce=S.state).wrap)===2||B===1&&ce.status!==P||ce.lookahead)return m;for(B===1&&(S.adler=c(S.adler,ue,ge,0)),ce.wrap=0,ge>=ce.w_size&&(B===0&&(X(ce.head),ce.strstart=0,ce.block_start=0,ce.insert=0),te=new a.Buf8(ce.w_size),a.arraySet(te,ue,ge-ce.w_size,ce.w_size,0),ue=te,ge=ce.w_size),oe=S.avail_in,de=S.next_in,G=S.input,S.avail_in=ge,S.next_in=0,S.input=ue,ke(ce);ce.lookahead>=T;){for(I=ce.strstart,N=ce.lookahead-(T-1);ce.ins_h=(ce.ins_h<<ce.hash_shift^ce.window[I+T-1])&ce.hash_mask,ce.prev[I&ce.w_mask]=ce.head[ce.ins_h],ce.head[ce.ins_h]=I,I++,--N;);ce.strstart=I,ce.lookahead=T-1,ke(ce)}return ce.strstart+=ce.lookahead,ce.block_start=ce.strstart,ce.insert=ce.lookahead,ce.lookahead=0,ce.match_length=ce.prev_length=T-1,ce.match_available=0,S.next_in=de,S.input=G,S.avail_in=oe,ce.wrap=B,f},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(n,r,i){r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(n,r,i){r.exports=function(s,a){var l,c,d,u,p,h,f,m,g,x,y,v,b,w,C,_,j,E,T,M,J,P,q,k,z;l=s.state,c=s.next_in,k=s.input,d=c+(s.avail_in-5),u=s.next_out,z=s.output,p=u-(a-s.avail_out),h=u+(s.avail_out-257),f=l.dmax,m=l.wsize,g=l.whave,x=l.wnext,y=l.window,v=l.hold,b=l.bits,w=l.lencode,C=l.distcode,_=(1<<l.lenbits)-1,j=(1<<l.distbits)-1;e:do{b<15&&(v+=k[c++]<<b,b+=8,v+=k[c++]<<b,b+=8),E=w[v&_];t:for(;;){if(v>>>=T=E>>>24,b-=T,(T=E>>>16&255)===0)z[u++]=65535&E;else{if(!(16&T)){if(!(64&T)){E=w[(65535&E)+(v&(1<<T)-1)];continue t}if(32&T){l.mode=12;break e}s.msg="invalid literal/length code",l.mode=30;break e}M=65535&E,(T&=15)&&(b<T&&(v+=k[c++]<<b,b+=8),M+=v&(1<<T)-1,v>>>=T,b-=T),b<15&&(v+=k[c++]<<b,b+=8,v+=k[c++]<<b,b+=8),E=C[v&j];n:for(;;){if(v>>>=T=E>>>24,b-=T,!(16&(T=E>>>16&255))){if(!(64&T)){E=C[(65535&E)+(v&(1<<T)-1)];continue n}s.msg="invalid distance code",l.mode=30;break e}if(J=65535&E,b<(T&=15)&&(v+=k[c++]<<b,(b+=8)<T&&(v+=k[c++]<<b,b+=8)),f<(J+=v&(1<<T)-1)){s.msg="invalid distance too far back",l.mode=30;break e}if(v>>>=T,b-=T,(T=u-p)<J){if(g<(T=J-T)&&l.sane){s.msg="invalid distance too far back",l.mode=30;break e}if(q=y,(P=0)===x){if(P+=m-T,T<M){for(M-=T;z[u++]=y[P++],--T;);P=u-J,q=z}}else if(x<T){if(P+=m+x-T,(T-=x)<M){for(M-=T;z[u++]=y[P++],--T;);if(P=0,x<M){for(M-=T=x;z[u++]=y[P++],--T;);P=u-J,q=z}}}else if(P+=x-T,T<M){for(M-=T;z[u++]=y[P++],--T;);P=u-J,q=z}for(;2<M;)z[u++]=q[P++],z[u++]=q[P++],z[u++]=q[P++],M-=3;M&&(z[u++]=q[P++],1<M&&(z[u++]=q[P++]))}else{for(P=u-J;z[u++]=z[P++],z[u++]=z[P++],z[u++]=z[P++],2<(M-=3););M&&(z[u++]=z[P++],1<M&&(z[u++]=z[P++]))}break}}break}}while(c<d&&u<h);c-=M=b>>3,v&=(1<<(b-=M<<3))-1,s.next_in=c,s.next_out=u,s.avail_in=c<d?d-c+5:5-(c-d),s.avail_out=u<h?h-u+257:257-(u-h),l.hold=v,l.bits=b}},{}],49:[function(n,r,i){var s=n("../utils/common"),a=n("./adler32"),l=n("./crc32"),c=n("./inffast"),d=n("./inftrees"),u=1,p=2,h=0,f=-2,m=1,g=852,x=592;function y(P){return(P>>>24&255)+(P>>>8&65280)+((65280&P)<<8)+((255&P)<<24)}function v(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function b(P){var q;return P&&P.state?(q=P.state,P.total_in=P.total_out=q.total=0,P.msg="",q.wrap&&(P.adler=1&q.wrap),q.mode=m,q.last=0,q.havedict=0,q.dmax=32768,q.head=null,q.hold=0,q.bits=0,q.lencode=q.lendyn=new s.Buf32(g),q.distcode=q.distdyn=new s.Buf32(x),q.sane=1,q.back=-1,h):f}function w(P){var q;return P&&P.state?((q=P.state).wsize=0,q.whave=0,q.wnext=0,b(P)):f}function C(P,q){var k,z;return P&&P.state?(z=P.state,q<0?(k=0,q=-q):(k=1+(q>>4),q<48&&(q&=15)),q&&(q<8||15<q)?f:(z.window!==null&&z.wbits!==q&&(z.window=null),z.wrap=k,z.wbits=q,w(P))):f}function _(P,q){var k,z;return P?(z=new v,(P.state=z).window=null,(k=C(P,q))!==h&&(P.state=null),k):f}var j,E,T=!0;function M(P){if(T){var q;for(j=new s.Buf32(512),E=new s.Buf32(32),q=0;q<144;)P.lens[q++]=8;for(;q<256;)P.lens[q++]=9;for(;q<280;)P.lens[q++]=7;for(;q<288;)P.lens[q++]=8;for(d(u,P.lens,0,288,j,0,P.work,{bits:9}),q=0;q<32;)P.lens[q++]=5;d(p,P.lens,0,32,E,0,P.work,{bits:5}),T=!1}P.lencode=j,P.lenbits=9,P.distcode=E,P.distbits=5}function J(P,q,k,z){var he,Z=P.state;return Z.window===null&&(Z.wsize=1<<Z.wbits,Z.wnext=0,Z.whave=0,Z.window=new s.Buf8(Z.wsize)),z>=Z.wsize?(s.arraySet(Z.window,q,k-Z.wsize,Z.wsize,0),Z.wnext=0,Z.whave=Z.wsize):(z<(he=Z.wsize-Z.wnext)&&(he=z),s.arraySet(Z.window,q,k-z,he,Z.wnext),(z-=he)?(s.arraySet(Z.window,q,k-z,z,0),Z.wnext=z,Z.whave=Z.wsize):(Z.wnext+=he,Z.wnext===Z.wsize&&(Z.wnext=0),Z.whave<Z.wsize&&(Z.whave+=he))),0}i.inflateReset=w,i.inflateReset2=C,i.inflateResetKeep=b,i.inflateInit=function(P){return _(P,15)},i.inflateInit2=_,i.inflate=function(P,q){var k,z,he,Z,K,H,X,F,W,re,se,me,ke,pe,Pe,Re,Ge,$e,we,xe,S,ue,ce,I,N=0,B=new s.Buf8(4),oe=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!P||!P.state||!P.output||!P.input&&P.avail_in!==0)return f;(k=P.state).mode===12&&(k.mode=13),K=P.next_out,he=P.output,X=P.avail_out,Z=P.next_in,z=P.input,H=P.avail_in,F=k.hold,W=k.bits,re=H,se=X,ue=h;e:for(;;)switch(k.mode){case m:if(k.wrap===0){k.mode=13;break}for(;W<16;){if(H===0)break e;H--,F+=z[Z++]<<W,W+=8}if(2&k.wrap&&F===35615){B[k.check=0]=255&F,B[1]=F>>>8&255,k.check=l(k.check,B,2,0),W=F=0,k.mode=2;break}if(k.flags=0,k.head&&(k.head.done=!1),!(1&k.wrap)||(((255&F)<<8)+(F>>8))%31){P.msg="incorrect header check",k.mode=30;break}if((15&F)!=8){P.msg="unknown compression method",k.mode=30;break}if(W-=4,S=8+(15&(F>>>=4)),k.wbits===0)k.wbits=S;else if(S>k.wbits){P.msg="invalid window size",k.mode=30;break}k.dmax=1<<S,P.adler=k.check=1,k.mode=512&F?10:12,W=F=0;break;case 2:for(;W<16;){if(H===0)break e;H--,F+=z[Z++]<<W,W+=8}if(k.flags=F,(255&k.flags)!=8){P.msg="unknown compression method",k.mode=30;break}if(57344&k.flags){P.msg="unknown header flags set",k.mode=30;break}k.head&&(k.head.text=F>>8&1),512&k.flags&&(B[0]=255&F,B[1]=F>>>8&255,k.check=l(k.check,B,2,0)),W=F=0,k.mode=3;case 3:for(;W<32;){if(H===0)break e;H--,F+=z[Z++]<<W,W+=8}k.head&&(k.head.time=F),512&k.flags&&(B[0]=255&F,B[1]=F>>>8&255,B[2]=F>>>16&255,B[3]=F>>>24&255,k.check=l(k.check,B,4,0)),W=F=0,k.mode=4;case 4:for(;W<16;){if(H===0)break e;H--,F+=z[Z++]<<W,W+=8}k.head&&(k.head.xflags=255&F,k.head.os=F>>8),512&k.flags&&(B[0]=255&F,B[1]=F>>>8&255,k.check=l(k.check,B,2,0)),W=F=0,k.mode=5;case 5:if(1024&k.flags){for(;W<16;){if(H===0)break e;H--,F+=z[Z++]<<W,W+=8}k.length=F,k.head&&(k.head.extra_len=F),512&k.flags&&(B[0]=255&F,B[1]=F>>>8&255,k.check=l(k.check,B,2,0)),W=F=0}else k.head&&(k.head.extra=null);k.mode=6;case 6:if(1024&k.flags&&(H<(me=k.length)&&(me=H),me&&(k.head&&(S=k.head.extra_len-k.length,k.head.extra||(k.head.extra=new Array(k.head.extra_len)),s.arraySet(k.head.extra,z,Z,me,S)),512&k.flags&&(k.check=l(k.check,z,me,Z)),H-=me,Z+=me,k.length-=me),k.length))break e;k.length=0,k.mode=7;case 7:if(2048&k.flags){if(H===0)break e;for(me=0;S=z[Z+me++],k.head&&S&&k.length<65536&&(k.head.name+=String.fromCharCode(S)),S&&me<H;);if(512&k.flags&&(k.check=l(k.check,z,me,Z)),H-=me,Z+=me,S)break e}else k.head&&(k.head.name=null);k.length=0,k.mode=8;case 8:if(4096&k.flags){if(H===0)break e;for(me=0;S=z[Z+me++],k.head&&S&&k.length<65536&&(k.head.comment+=String.fromCharCode(S)),S&&me<H;);if(512&k.flags&&(k.check=l(k.check,z,me,Z)),H-=me,Z+=me,S)break e}else k.head&&(k.head.comment=null);k.mode=9;case 9:if(512&k.flags){for(;W<16;){if(H===0)break e;H--,F+=z[Z++]<<W,W+=8}if(F!==(65535&k.check)){P.msg="header crc mismatch",k.mode=30;break}W=F=0}k.head&&(k.head.hcrc=k.flags>>9&1,k.head.done=!0),P.adler=k.check=0,k.mode=12;break;case 10:for(;W<32;){if(H===0)break e;H--,F+=z[Z++]<<W,W+=8}P.adler=k.check=y(F),W=F=0,k.mode=11;case 11:if(k.havedict===0)return P.next_out=K,P.avail_out=X,P.next_in=Z,P.avail_in=H,k.hold=F,k.bits=W,2;P.adler=k.check=1,k.mode=12;case 12:if(q===5||q===6)break e;case 13:if(k.last){F>>>=7&W,W-=7&W,k.mode=27;break}for(;W<3;){if(H===0)break e;H--,F+=z[Z++]<<W,W+=8}switch(k.last=1&F,W-=1,3&(F>>>=1)){case 0:k.mode=14;break;case 1:if(M(k),k.mode=20,q!==6)break;F>>>=2,W-=2;break e;case 2:k.mode=17;break;case 3:P.msg="invalid block type",k.mode=30}F>>>=2,W-=2;break;case 14:for(F>>>=7&W,W-=7&W;W<32;){if(H===0)break e;H--,F+=z[Z++]<<W,W+=8}if((65535&F)!=(F>>>16^65535)){P.msg="invalid stored block lengths",k.mode=30;break}if(k.length=65535&F,W=F=0,k.mode=15,q===6)break e;case 15:k.mode=16;case 16:if(me=k.length){if(H<me&&(me=H),X<me&&(me=X),me===0)break e;s.arraySet(he,z,Z,me,K),H-=me,Z+=me,X-=me,K+=me,k.length-=me;break}k.mode=12;break;case 17:for(;W<14;){if(H===0)break e;H--,F+=z[Z++]<<W,W+=8}if(k.nlen=257+(31&F),F>>>=5,W-=5,k.ndist=1+(31&F),F>>>=5,W-=5,k.ncode=4+(15&F),F>>>=4,W-=4,286<k.nlen||30<k.ndist){P.msg="too many length or distance symbols",k.mode=30;break}k.have=0,k.mode=18;case 18:for(;k.have<k.ncode;){for(;W<3;){if(H===0)break e;H--,F+=z[Z++]<<W,W+=8}k.lens[oe[k.have++]]=7&F,F>>>=3,W-=3}for(;k.have<19;)k.lens[oe[k.have++]]=0;if(k.lencode=k.lendyn,k.lenbits=7,ce={bits:k.lenbits},ue=d(0,k.lens,0,19,k.lencode,0,k.work,ce),k.lenbits=ce.bits,ue){P.msg="invalid code lengths set",k.mode=30;break}k.have=0,k.mode=19;case 19:for(;k.have<k.nlen+k.ndist;){for(;Re=(N=k.lencode[F&(1<<k.lenbits)-1])>>>16&255,Ge=65535&N,!((Pe=N>>>24)<=W);){if(H===0)break e;H--,F+=z[Z++]<<W,W+=8}if(Ge<16)F>>>=Pe,W-=Pe,k.lens[k.have++]=Ge;else{if(Ge===16){for(I=Pe+2;W<I;){if(H===0)break e;H--,F+=z[Z++]<<W,W+=8}if(F>>>=Pe,W-=Pe,k.have===0){P.msg="invalid bit length repeat",k.mode=30;break}S=k.lens[k.have-1],me=3+(3&F),F>>>=2,W-=2}else if(Ge===17){for(I=Pe+3;W<I;){if(H===0)break e;H--,F+=z[Z++]<<W,W+=8}W-=Pe,S=0,me=3+(7&(F>>>=Pe)),F>>>=3,W-=3}else{for(I=Pe+7;W<I;){if(H===0)break e;H--,F+=z[Z++]<<W,W+=8}W-=Pe,S=0,me=11+(127&(F>>>=Pe)),F>>>=7,W-=7}if(k.have+me>k.nlen+k.ndist){P.msg="invalid bit length repeat",k.mode=30;break}for(;me--;)k.lens[k.have++]=S}}if(k.mode===30)break;if(k.lens[256]===0){P.msg="invalid code -- missing end-of-block",k.mode=30;break}if(k.lenbits=9,ce={bits:k.lenbits},ue=d(u,k.lens,0,k.nlen,k.lencode,0,k.work,ce),k.lenbits=ce.bits,ue){P.msg="invalid literal/lengths set",k.mode=30;break}if(k.distbits=6,k.distcode=k.distdyn,ce={bits:k.distbits},ue=d(p,k.lens,k.nlen,k.ndist,k.distcode,0,k.work,ce),k.distbits=ce.bits,ue){P.msg="invalid distances set",k.mode=30;break}if(k.mode=20,q===6)break e;case 20:k.mode=21;case 21:if(6<=H&&258<=X){P.next_out=K,P.avail_out=X,P.next_in=Z,P.avail_in=H,k.hold=F,k.bits=W,c(P,se),K=P.next_out,he=P.output,X=P.avail_out,Z=P.next_in,z=P.input,H=P.avail_in,F=k.hold,W=k.bits,k.mode===12&&(k.back=-1);break}for(k.back=0;Re=(N=k.lencode[F&(1<<k.lenbits)-1])>>>16&255,Ge=65535&N,!((Pe=N>>>24)<=W);){if(H===0)break e;H--,F+=z[Z++]<<W,W+=8}if(Re&&!(240&Re)){for($e=Pe,we=Re,xe=Ge;Re=(N=k.lencode[xe+((F&(1<<$e+we)-1)>>$e)])>>>16&255,Ge=65535&N,!($e+(Pe=N>>>24)<=W);){if(H===0)break e;H--,F+=z[Z++]<<W,W+=8}F>>>=$e,W-=$e,k.back+=$e}if(F>>>=Pe,W-=Pe,k.back+=Pe,k.length=Ge,Re===0){k.mode=26;break}if(32&Re){k.back=-1,k.mode=12;break}if(64&Re){P.msg="invalid literal/length code",k.mode=30;break}k.extra=15&Re,k.mode=22;case 22:if(k.extra){for(I=k.extra;W<I;){if(H===0)break e;H--,F+=z[Z++]<<W,W+=8}k.length+=F&(1<<k.extra)-1,F>>>=k.extra,W-=k.extra,k.back+=k.extra}k.was=k.length,k.mode=23;case 23:for(;Re=(N=k.distcode[F&(1<<k.distbits)-1])>>>16&255,Ge=65535&N,!((Pe=N>>>24)<=W);){if(H===0)break e;H--,F+=z[Z++]<<W,W+=8}if(!(240&Re)){for($e=Pe,we=Re,xe=Ge;Re=(N=k.distcode[xe+((F&(1<<$e+we)-1)>>$e)])>>>16&255,Ge=65535&N,!($e+(Pe=N>>>24)<=W);){if(H===0)break e;H--,F+=z[Z++]<<W,W+=8}F>>>=$e,W-=$e,k.back+=$e}if(F>>>=Pe,W-=Pe,k.back+=Pe,64&Re){P.msg="invalid distance code",k.mode=30;break}k.offset=Ge,k.extra=15&Re,k.mode=24;case 24:if(k.extra){for(I=k.extra;W<I;){if(H===0)break e;H--,F+=z[Z++]<<W,W+=8}k.offset+=F&(1<<k.extra)-1,F>>>=k.extra,W-=k.extra,k.back+=k.extra}if(k.offset>k.dmax){P.msg="invalid distance too far back",k.mode=30;break}k.mode=25;case 25:if(X===0)break e;if(me=se-X,k.offset>me){if((me=k.offset-me)>k.whave&&k.sane){P.msg="invalid distance too far back",k.mode=30;break}ke=me>k.wnext?(me-=k.wnext,k.wsize-me):k.wnext-me,me>k.length&&(me=k.length),pe=k.window}else pe=he,ke=K-k.offset,me=k.length;for(X<me&&(me=X),X-=me,k.length-=me;he[K++]=pe[ke++],--me;);k.length===0&&(k.mode=21);break;case 26:if(X===0)break e;he[K++]=k.length,X--,k.mode=21;break;case 27:if(k.wrap){for(;W<32;){if(H===0)break e;H--,F|=z[Z++]<<W,W+=8}if(se-=X,P.total_out+=se,k.total+=se,se&&(P.adler=k.check=k.flags?l(k.check,he,se,K-se):a(k.check,he,se,K-se)),se=X,(k.flags?F:y(F))!==k.check){P.msg="incorrect data check",k.mode=30;break}W=F=0}k.mode=28;case 28:if(k.wrap&&k.flags){for(;W<32;){if(H===0)break e;H--,F+=z[Z++]<<W,W+=8}if(F!==(4294967295&k.total)){P.msg="incorrect length check",k.mode=30;break}W=F=0}k.mode=29;case 29:ue=1;break e;case 30:ue=-3;break e;case 31:return-4;case 32:default:return f}return P.next_out=K,P.avail_out=X,P.next_in=Z,P.avail_in=H,k.hold=F,k.bits=W,(k.wsize||se!==P.avail_out&&k.mode<30&&(k.mode<27||q!==4))&&J(P,P.output,P.next_out,se-P.avail_out)?(k.mode=31,-4):(re-=P.avail_in,se-=P.avail_out,P.total_in+=re,P.total_out+=se,k.total+=se,k.wrap&&se&&(P.adler=k.check=k.flags?l(k.check,he,se,P.next_out-se):a(k.check,he,se,P.next_out-se)),P.data_type=k.bits+(k.last?64:0)+(k.mode===12?128:0)+(k.mode===20||k.mode===15?256:0),(re==0&&se===0||q===4)&&ue===h&&(ue=-5),ue)},i.inflateEnd=function(P){if(!P||!P.state)return f;var q=P.state;return q.window&&(q.window=null),P.state=null,h},i.inflateGetHeader=function(P,q){var k;return P&&P.state&&2&(k=P.state).wrap?((k.head=q).done=!1,h):f},i.inflateSetDictionary=function(P,q){var k,z=q.length;return P&&P.state?(k=P.state).wrap!==0&&k.mode!==11?f:k.mode===11&&a(1,q,z,0)!==k.check?-3:J(P,q,z,z)?(k.mode=31,-4):(k.havedict=1,h):f},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(n,r,i){var s=n("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],d=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(u,p,h,f,m,g,x,y){var v,b,w,C,_,j,E,T,M,J=y.bits,P=0,q=0,k=0,z=0,he=0,Z=0,K=0,H=0,X=0,F=0,W=null,re=0,se=new s.Buf16(16),me=new s.Buf16(16),ke=null,pe=0;for(P=0;P<=15;P++)se[P]=0;for(q=0;q<f;q++)se[p[h+q]]++;for(he=J,z=15;1<=z&&se[z]===0;z--);if(z<he&&(he=z),z===0)return m[g++]=20971520,m[g++]=20971520,y.bits=1,0;for(k=1;k<z&&se[k]===0;k++);for(he<k&&(he=k),P=H=1;P<=15;P++)if(H<<=1,(H-=se[P])<0)return-1;if(0<H&&(u===0||z!==1))return-1;for(me[1]=0,P=1;P<15;P++)me[P+1]=me[P]+se[P];for(q=0;q<f;q++)p[h+q]!==0&&(x[me[p[h+q]]++]=q);if(j=u===0?(W=ke=x,19):u===1?(W=a,re-=257,ke=l,pe-=257,256):(W=c,ke=d,-1),P=k,_=g,K=q=F=0,w=-1,C=(X=1<<(Z=he))-1,u===1&&852<X||u===2&&592<X)return 1;for(;;){for(E=P-K,M=x[q]<j?(T=0,x[q]):x[q]>j?(T=ke[pe+x[q]],W[re+x[q]]):(T=96,0),v=1<<P-K,k=b=1<<Z;m[_+(F>>K)+(b-=v)]=E<<24|T<<16|M|0,b!==0;);for(v=1<<P-1;F&v;)v>>=1;if(v!==0?(F&=v-1,F+=v):F=0,q++,--se[P]==0){if(P===z)break;P=p[h+x[q]]}if(he<P&&(F&C)!==w){for(K===0&&(K=he),_+=k,H=1<<(Z=P-K);Z+K<z&&!((H-=se[Z+K])<=0);)Z++,H<<=1;if(X+=1<<Z,u===1&&852<X||u===2&&592<X)return 1;m[w=F&C]=he<<24|Z<<16|_-g|0}}return F!==0&&(m[_+F]=P-K<<24|64<<16|0),y.bits=he,0}},{"../utils/common":41}],51:[function(n,r,i){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(n,r,i){var s=n("../utils/common"),a=0,l=1;function c(N){for(var B=N.length;0<=--B;)N[B]=0}var d=0,u=29,p=256,h=p+1+u,f=30,m=19,g=2*h+1,x=15,y=16,v=7,b=256,w=16,C=17,_=18,j=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],E=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],T=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],M=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],J=new Array(2*(h+2));c(J);var P=new Array(2*f);c(P);var q=new Array(512);c(q);var k=new Array(256);c(k);var z=new Array(u);c(z);var he,Z,K,H=new Array(f);function X(N,B,oe,de,G){this.static_tree=N,this.extra_bits=B,this.extra_base=oe,this.elems=de,this.max_length=G,this.has_stree=N&&N.length}function F(N,B){this.dyn_tree=N,this.max_code=0,this.stat_desc=B}function W(N){return N<256?q[N]:q[256+(N>>>7)]}function re(N,B){N.pending_buf[N.pending++]=255&B,N.pending_buf[N.pending++]=B>>>8&255}function se(N,B,oe){N.bi_valid>y-oe?(N.bi_buf|=B<<N.bi_valid&65535,re(N,N.bi_buf),N.bi_buf=B>>y-N.bi_valid,N.bi_valid+=oe-y):(N.bi_buf|=B<<N.bi_valid&65535,N.bi_valid+=oe)}function me(N,B,oe){se(N,oe[2*B],oe[2*B+1])}function ke(N,B){for(var oe=0;oe|=1&N,N>>>=1,oe<<=1,0<--B;);return oe>>>1}function pe(N,B,oe){var de,G,te=new Array(x+1),ge=0;for(de=1;de<=x;de++)te[de]=ge=ge+oe[de-1]<<1;for(G=0;G<=B;G++){var V=N[2*G+1];V!==0&&(N[2*G]=ke(te[V]++,V))}}function Pe(N){var B;for(B=0;B<h;B++)N.dyn_ltree[2*B]=0;for(B=0;B<f;B++)N.dyn_dtree[2*B]=0;for(B=0;B<m;B++)N.bl_tree[2*B]=0;N.dyn_ltree[2*b]=1,N.opt_len=N.static_len=0,N.last_lit=N.matches=0}function Re(N){8<N.bi_valid?re(N,N.bi_buf):0<N.bi_valid&&(N.pending_buf[N.pending++]=N.bi_buf),N.bi_buf=0,N.bi_valid=0}function Ge(N,B,oe,de){var G=2*B,te=2*oe;return N[G]<N[te]||N[G]===N[te]&&de[B]<=de[oe]}function $e(N,B,oe){for(var de=N.heap[oe],G=oe<<1;G<=N.heap_len&&(G<N.heap_len&&Ge(B,N.heap[G+1],N.heap[G],N.depth)&&G++,!Ge(B,de,N.heap[G],N.depth));)N.heap[oe]=N.heap[G],oe=G,G<<=1;N.heap[oe]=de}function we(N,B,oe){var de,G,te,ge,V=0;if(N.last_lit!==0)for(;de=N.pending_buf[N.d_buf+2*V]<<8|N.pending_buf[N.d_buf+2*V+1],G=N.pending_buf[N.l_buf+V],V++,de===0?me(N,G,B):(me(N,(te=k[G])+p+1,B),(ge=j[te])!==0&&se(N,G-=z[te],ge),me(N,te=W(--de),oe),(ge=E[te])!==0&&se(N,de-=H[te],ge)),V<N.last_lit;);me(N,b,B)}function xe(N,B){var oe,de,G,te=B.dyn_tree,ge=B.stat_desc.static_tree,V=B.stat_desc.has_stree,$=B.stat_desc.elems,D=-1;for(N.heap_len=0,N.heap_max=g,oe=0;oe<$;oe++)te[2*oe]!==0?(N.heap[++N.heap_len]=D=oe,N.depth[oe]=0):te[2*oe+1]=0;for(;N.heap_len<2;)te[2*(G=N.heap[++N.heap_len]=D<2?++D:0)]=1,N.depth[G]=0,N.opt_len--,V&&(N.static_len-=ge[2*G+1]);for(B.max_code=D,oe=N.heap_len>>1;1<=oe;oe--)$e(N,te,oe);for(G=$;oe=N.heap[1],N.heap[1]=N.heap[N.heap_len--],$e(N,te,1),de=N.heap[1],N.heap[--N.heap_max]=oe,N.heap[--N.heap_max]=de,te[2*G]=te[2*oe]+te[2*de],N.depth[G]=(N.depth[oe]>=N.depth[de]?N.depth[oe]:N.depth[de])+1,te[2*oe+1]=te[2*de+1]=G,N.heap[1]=G++,$e(N,te,1),2<=N.heap_len;);N.heap[--N.heap_max]=N.heap[1],function(ae,Se){var le,ie,je,Y,ne,Ie,Ke=Se.dyn_tree,Je=Se.max_code,De=Se.stat_desc.static_tree,Ye=Se.stat_desc.has_stree,at=Se.stat_desc.extra_bits,ht=Se.stat_desc.extra_base,et=Se.stat_desc.max_length,dt=0;for(Y=0;Y<=x;Y++)ae.bl_count[Y]=0;for(Ke[2*ae.heap[ae.heap_max]+1]=0,le=ae.heap_max+1;le<g;le++)et<(Y=Ke[2*Ke[2*(ie=ae.heap[le])+1]+1]+1)&&(Y=et,dt++),Ke[2*ie+1]=Y,Je<ie||(ae.bl_count[Y]++,ne=0,ht<=ie&&(ne=at[ie-ht]),Ie=Ke[2*ie],ae.opt_len+=Ie*(Y+ne),Ye&&(ae.static_len+=Ie*(De[2*ie+1]+ne)));if(dt!==0){do{for(Y=et-1;ae.bl_count[Y]===0;)Y--;ae.bl_count[Y]--,ae.bl_count[Y+1]+=2,ae.bl_count[et]--,dt-=2}while(0<dt);for(Y=et;Y!==0;Y--)for(ie=ae.bl_count[Y];ie!==0;)Je<(je=ae.heap[--le])||(Ke[2*je+1]!==Y&&(ae.opt_len+=(Y-Ke[2*je+1])*Ke[2*je],Ke[2*je+1]=Y),ie--)}}(N,B),pe(te,D,N.bl_count)}function S(N,B,oe){var de,G,te=-1,ge=B[1],V=0,$=7,D=4;for(ge===0&&($=138,D=3),B[2*(oe+1)+1]=65535,de=0;de<=oe;de++)G=ge,ge=B[2*(de+1)+1],++V<$&&G===ge||(V<D?N.bl_tree[2*G]+=V:G!==0?(G!==te&&N.bl_tree[2*G]++,N.bl_tree[2*w]++):V<=10?N.bl_tree[2*C]++:N.bl_tree[2*_]++,te=G,D=(V=0)===ge?($=138,3):G===ge?($=6,3):($=7,4))}function ue(N,B,oe){var de,G,te=-1,ge=B[1],V=0,$=7,D=4;for(ge===0&&($=138,D=3),de=0;de<=oe;de++)if(G=ge,ge=B[2*(de+1)+1],!(++V<$&&G===ge)){if(V<D)for(;me(N,G,N.bl_tree),--V!=0;);else G!==0?(G!==te&&(me(N,G,N.bl_tree),V--),me(N,w,N.bl_tree),se(N,V-3,2)):V<=10?(me(N,C,N.bl_tree),se(N,V-3,3)):(me(N,_,N.bl_tree),se(N,V-11,7));te=G,D=(V=0)===ge?($=138,3):G===ge?($=6,3):($=7,4)}}c(H);var ce=!1;function I(N,B,oe,de){se(N,(d<<1)+(de?1:0),3),function(G,te,ge,V){Re(G),re(G,ge),re(G,~ge),s.arraySet(G.pending_buf,G.window,te,ge,G.pending),G.pending+=ge}(N,B,oe)}i._tr_init=function(N){ce||(function(){var B,oe,de,G,te,ge=new Array(x+1);for(G=de=0;G<u-1;G++)for(z[G]=de,B=0;B<1<<j[G];B++)k[de++]=G;for(k[de-1]=G,G=te=0;G<16;G++)for(H[G]=te,B=0;B<1<<E[G];B++)q[te++]=G;for(te>>=7;G<f;G++)for(H[G]=te<<7,B=0;B<1<<E[G]-7;B++)q[256+te++]=G;for(oe=0;oe<=x;oe++)ge[oe]=0;for(B=0;B<=143;)J[2*B+1]=8,B++,ge[8]++;for(;B<=255;)J[2*B+1]=9,B++,ge[9]++;for(;B<=279;)J[2*B+1]=7,B++,ge[7]++;for(;B<=287;)J[2*B+1]=8,B++,ge[8]++;for(pe(J,h+1,ge),B=0;B<f;B++)P[2*B+1]=5,P[2*B]=ke(B,5);he=new X(J,j,p+1,h,x),Z=new X(P,E,0,f,x),K=new X(new Array(0),T,0,m,v)}(),ce=!0),N.l_desc=new F(N.dyn_ltree,he),N.d_desc=new F(N.dyn_dtree,Z),N.bl_desc=new F(N.bl_tree,K),N.bi_buf=0,N.bi_valid=0,Pe(N)},i._tr_stored_block=I,i._tr_flush_block=function(N,B,oe,de){var G,te,ge=0;0<N.level?(N.strm.data_type===2&&(N.strm.data_type=function(V){var $,D=4093624447;for($=0;$<=31;$++,D>>>=1)if(1&D&&V.dyn_ltree[2*$]!==0)return a;if(V.dyn_ltree[18]!==0||V.dyn_ltree[20]!==0||V.dyn_ltree[26]!==0)return l;for($=32;$<p;$++)if(V.dyn_ltree[2*$]!==0)return l;return a}(N)),xe(N,N.l_desc),xe(N,N.d_desc),ge=function(V){var $;for(S(V,V.dyn_ltree,V.l_desc.max_code),S(V,V.dyn_dtree,V.d_desc.max_code),xe(V,V.bl_desc),$=m-1;3<=$&&V.bl_tree[2*M[$]+1]===0;$--);return V.opt_len+=3*($+1)+5+5+4,$}(N),G=N.opt_len+3+7>>>3,(te=N.static_len+3+7>>>3)<=G&&(G=te)):G=te=oe+5,oe+4<=G&&B!==-1?I(N,B,oe,de):N.strategy===4||te===G?(se(N,2+(de?1:0),3),we(N,J,P)):(se(N,4+(de?1:0),3),function(V,$,D,ae){var Se;for(se(V,$-257,5),se(V,D-1,5),se(V,ae-4,4),Se=0;Se<ae;Se++)se(V,V.bl_tree[2*M[Se]+1],3);ue(V,V.dyn_ltree,$-1),ue(V,V.dyn_dtree,D-1)}(N,N.l_desc.max_code+1,N.d_desc.max_code+1,ge+1),we(N,N.dyn_ltree,N.dyn_dtree)),Pe(N),de&&Re(N)},i._tr_tally=function(N,B,oe){return N.pending_buf[N.d_buf+2*N.last_lit]=B>>>8&255,N.pending_buf[N.d_buf+2*N.last_lit+1]=255&B,N.pending_buf[N.l_buf+N.last_lit]=255&oe,N.last_lit++,B===0?N.dyn_ltree[2*oe]++:(N.matches++,B--,N.dyn_ltree[2*(k[oe]+p+1)]++,N.dyn_dtree[2*W(B)]++),N.last_lit===N.lit_bufsize-1},i._tr_align=function(N){se(N,2,3),me(N,b,J),function(B){B.bi_valid===16?(re(B,B.bi_buf),B.bi_buf=0,B.bi_valid=0):8<=B.bi_valid&&(B.pending_buf[B.pending++]=255&B.bi_buf,B.bi_buf>>=8,B.bi_valid-=8)}(N)}},{"../utils/common":41}],53:[function(n,r,i){r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(n,r,i){(function(s){(function(a,l){if(!a.setImmediate){var c,d,u,p,h=1,f={},m=!1,g=a.document,x=Object.getPrototypeOf&&Object.getPrototypeOf(a);x=x&&x.setTimeout?x:a,c={}.toString.call(a.process)==="[object process]"?function(w){process.nextTick(function(){v(w)})}:function(){if(a.postMessage&&!a.importScripts){var w=!0,C=a.onmessage;return a.onmessage=function(){w=!1},a.postMessage("","*"),a.onmessage=C,w}}()?(p="setImmediate$"+Math.random()+"$",a.addEventListener?a.addEventListener("message",b,!1):a.attachEvent("onmessage",b),function(w){a.postMessage(p+w,"*")}):a.MessageChannel?((u=new MessageChannel).port1.onmessage=function(w){v(w.data)},function(w){u.port2.postMessage(w)}):g&&"onreadystatechange"in g.createElement("script")?(d=g.documentElement,function(w){var C=g.createElement("script");C.onreadystatechange=function(){v(w),C.onreadystatechange=null,d.removeChild(C),C=null},d.appendChild(C)}):function(w){setTimeout(v,0,w)},x.setImmediate=function(w){typeof w!="function"&&(w=new Function(""+w));for(var C=new Array(arguments.length-1),_=0;_<C.length;_++)C[_]=arguments[_+1];var j={callback:w,args:C};return f[h]=j,c(h),h++},x.clearImmediate=y}function y(w){delete f[w]}function v(w){if(m)setTimeout(v,0,w);else{var C=f[w];if(C){m=!0;try{(function(_){var j=_.callback,E=_.args;switch(E.length){case 0:j();break;case 1:j(E[0]);break;case 2:j(E[0],E[1]);break;case 3:j(E[0],E[1],E[2]);break;default:j.apply(l,E)}})(C)}finally{y(w),m=!1}}}}function b(w){w.source===a&&typeof w.data=="string"&&w.data.indexOf(p)===0&&v(+w.data.slice(p.length))}})(typeof self>"u"?s===void 0?this:s:self)}).call(this,typeof Mi<"u"?Mi:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(Kw);var g5=Kw.exports;const v5=gd(g5);function y5(e){let t="",n=e;for(;n>=0;)t=String.fromCharCode(n%26+65)+t,n=Math.floor(n/26)-1;return t}function x5(e,t){return`${y5(e)}${t+1}`}async function Jw(e,t,n="design"){const i=Math.ceil(t.width/1e3),s=Math.ceil(t.length/1e3);console.log(`[SLICER] Creating ${i}${s} grid (${i*s} tiles) for ${t.width}mm  ${t.length}mm design`);const c=new DOMParser().parseFromString(e,"image/svg+xml").querySelector("svg");if(!c)throw new Error("Invalid SVG content");const d=c.getAttribute("viewBox");let u,p;if(d){const j=d.split(/\s+/).map(Number);u=j[2],p=j[3]}else u=parseFloat(c.getAttribute("width"))||1024,p=parseFloat(c.getAttribute("height"))||1024;console.log(`[SLICER] SVG internal dimensions: ${u}  ${p}`);const h=u/t.width,f=p/t.length,m=1e3*h,g=1e3*f;console.log(`[SLICER] Tile size in SVG units: ${m}  ${g}`);const x=c.innerHTML,y=c.getAttribute("xmlns")||"http://www.w3.org/2000/svg",v=new v5,b=v.folder("tiles"),w=[];for(let j=0;j<s;j++){const E=[];for(let T=0;T<i;T++){const M=x5(T,j);E.push(M);const J=T*m,P=j*g,q=`${J} ${P} ${m} ${g}`,k=`<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="${y}" viewBox="${q}" width="1000mm" height="1000mm">
  <defs>
    <clipPath id="tile-clip">
      <rect x="${J}" y="${P}" width="${m}" height="${g}"/>
    </clipPath>
  </defs>
  <g clip-path="url(#tile-clip)">
${x}
  </g>
</svg>`,z=`${Qw(n)}_${M}.svg`;b.file(z,k)}w.push(E)}const C=b5(w,t,n);v.file("layout-guide.txt",C);const _=await v.generateAsync({type:"blob"});return console.log(`[SLICER] Created ZIP with ${i*s} tiles`),_}function b5(e,t,n){const r=e.length,i=e[0].length;let s=`TPV Studio - Tile Layout Guide
================================

Design: ${n}
Total Size: ${t.width}mm  ${t.length}mm (${t.width/1e3}m  ${t.length/1e3}m)
Tile Size: 1000mm  1000mm (1m  1m)
Grid: ${i} columns  ${r} rows (${i*r} tiles)

Layout (view from above):
-------------------------

`;const a=6;s+=""+("".repeat(a)+"").repeat(i-1)+"".repeat(a)+`
`;for(let l=0;l<r;l++){s+="";for(let c=0;c<i;c++){const d=e[l][c],u=a-d.length,p=Math.floor(u/2),h=u-p;s+=" ".repeat(p)+d+" ".repeat(h)+""}s+=`
`,l<r-1?s+=""+("".repeat(a)+"").repeat(i-1)+"".repeat(a)+`
`:s+=""+("".repeat(a)+"").repeat(i-1)+"".repeat(a)+`
`}return s+=`
Installation Notes:
-------------------
- Each tile is exactly 1m  1m
- Tiles are named by column (A-Z) and row (1-${r})
- Start from top-left corner (A1) when laying out
- Tiles align perfectly when placed edge-to-edge
- Edge tiles may contain partial content if design isn't exactly divisible by 1m

Generated by TPV Studio
`,s}function Qw(e){return e.replace(/[<>:"/\\|?*]/g,"_").replace(/\s+/g,"-").substring(0,50)}function e1(e,t){const n=URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)}async function w5(e,t,n="design"){try{const r=await fetch(e);if(!r.ok)throw new Error(`Failed to fetch SVG: ${r.statusText}`);const i=await r.text(),s=await Jw(i,t,n),a=`${Qw(n)}-tiles-1mx1m.zip`;return e1(s,a),console.log(`[SLICER] Downloaded ${a}`),!0}catch(r){throw console.error("[SLICER] Failed to download tiles:",r),r}}async function _5(e){const t=Object.values(e||{});return t.length===0?[]:(await Promise.all(t.map(async r=>{try{const i=await _l(r.sourceDesignId),s=(i==null?void 0:i.design)||i;if(!s)return console.warn(`[EXPORT] Could not fetch design for motif ${r.id}`),null;console.log("[EXPORT] Loaded design for motif:",s.name),console.log("[EXPORT] Design has solid_recipes:",!!s.solid_recipes),console.log("[EXPORT] Design has blend_recipes:",!!s.blend_recipes);const a=r.scale||1,l=r.originalWidth_mm*a/1e3,c=r.originalHeight_mm*a/1e3,d=l*c,u=r.viewMode||"solid",p=u==="blend"?s.blend_recipes:s.solid_recipes;return console.log(`[EXPORT] Using ${u} recipes:`,(p==null?void 0:p.length)||0,"recipes"),{id:r.id,name:r.customName||r.sourceDesignName||s.name||"Motif",areaM2:d,viewMode:u,widthM:l,heightM:c,recipes:p||[]}}catch(i){return console.error(`[EXPORT] Error processing motif ${r.id}:`,i),null}}))).filter(Boolean)}function O0({svgRef:e}){const[t,n]=R.useState(!1),[r,i]=R.useState(null),s=R.useRef(null),a=st(v=>v.exportDesignData),l=st(v=>v.surface),c=st(v=>v.designName),d=st(v=>v.motifs),u=st(v=>v.shapes),p=st(v=>v.texts),h=st(v=>v.exclusionZones);R.useEffect(()=>{const v=b=>{s.current&&!s.current.contains(b.target)&&n(!1)};return t&&document.addEventListener("mousedown",v),()=>{document.removeEventListener("mousedown",v)}},[t]);const f=()=>e!=null&&e.current?e.current:document.querySelector(".court-canvas__svg"),m=async()=>{i("svg");try{const v=f();if(!v)throw new Error("Canvas not found");const b=a(),w=Cf(v,b),C=Fu(b.name,"svg");f5(w,C)}catch(v){console.error("SVG export failed:",v),alert("Failed to export SVG: "+v.message)}finally{i(null),n(!1)}},g=async()=>{i("png");try{const v=f();if(!v)throw new Error("Canvas not found");const b=a(),w=Fu(b.name,"png");await m5(v,b,w,2)}catch(v){console.error("PNG export failed:",v),alert("Failed to export PNG: "+v.message)}finally{i(null),n(!1)}},x=async()=>{i("pdf"),n(!1);try{const v=f();if(!v)throw new Error("Canvas not found");const b=await Br.getSession();if(!(b!=null&&b.access_token))throw new Error("Authentication required for PDF export");const w=a(),C=w.name||"TPV Design",_=v.cloneNode(!0);_.querySelectorAll('[class*="selected"], .transform-handles, .track-resize-handles, .court-canvas__selection-outline, [class*="selection"], [class*="handle"], [stroke-dasharray]').forEach(q=>q.remove()),_.setAttribute("xmlns","http://www.w3.org/2000/svg"),_.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");const j=new XMLSerializer().serializeToString(_);console.log("[EXPORT] Generating PDF report via API...");const E=await _5(d);console.log("[EXPORT] Motifs for PDF:",E.length);const T=await fetch("/api/export-sports-pdf",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${b.access_token}`},body:JSON.stringify({svgString:j,designName:C,surface:w.surface,courts:w.courts,tracks:w.tracks,shapes:u,texts:p,motifs:E,exclusionZones:h,dimensions:{widthMM:w.surface.width_mm,lengthMM:w.surface.length_mm}})});if(!T.ok){const q=await T.json().catch(()=>({error:"Unknown error"}));throw new Error(q.error||`Server error: ${T.status}`)}const M=await T.blob(),J=Fu(C,"pdf"),P=document.createElement("a");P.href=URL.createObjectURL(M),P.download=J,document.body.appendChild(P),P.click(),document.body.removeChild(P),URL.revokeObjectURL(P.href),console.log("[EXPORT] PDF downloaded:",J)}catch(v){console.error("PDF export failed:",v),alert("Failed to export PDF: "+v.message)}finally{i(null)}},y=async()=>{i("tiles"),n(!1);try{const v=f();if(!v)throw new Error("Canvas not found");const w=new XMLSerializer().serializeToString(v),C={width:l.width_mm,length:l.length_mm},_=c||"sports-surface",j=await Jw(w,C,_),E=`${_.replace(/[^a-zA-Z0-9-_]/g,"-")}-tiles-1mx1m.zip`;e1(j,E),console.log("[EXPORT] Tiles ZIP downloaded:",E)}catch(v){console.error("Tiles export failed:",v),alert("Failed to export tiles: "+v.message)}finally{i(null)}};return o.jsxs("div",{className:"export-menu",ref:s,children:[o.jsxs("button",{className:"sports-toolbar__btn-export",onClick:()=>n(!t),title:"Export Design",children:["Export",o.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:t?"M18 15l-6-6-6 6":"M6 9l6 6 6-6"})})]}),t&&o.jsxs("div",{className:"export-menu__dropdown",children:[o.jsxs("button",{className:"export-menu__item",onClick:m,disabled:r!==null,children:[o.jsx("span",{className:"export-menu__icon",children:""}),o.jsxs("div",{className:"export-menu__item-content",children:[o.jsx("span",{className:"export-menu__item-title",children:r==="svg"?"Exporting...":"Download SVG"}),o.jsx("span",{className:"export-menu__item-desc",children:"Vector format for CAD/printing"})]})]}),o.jsxs("button",{className:"export-menu__item",onClick:g,disabled:r!==null,children:[o.jsx("span",{className:"export-menu__icon",children:""}),o.jsxs("div",{className:"export-menu__item-content",children:[o.jsx("span",{className:"export-menu__item-title",children:r==="png"?"Exporting...":"Download PNG"}),o.jsx("span",{className:"export-menu__item-desc",children:"High-res image for presentations"})]})]}),o.jsxs("button",{className:"export-menu__item",onClick:y,disabled:r!==null,children:[o.jsx("span",{className:"export-menu__icon",children:""}),o.jsxs("div",{className:"export-menu__item-content",children:[o.jsx("span",{className:"export-menu__item-title",children:r==="tiles"?"Generating...":"Download Tiles ZIP"}),o.jsx("span",{className:"export-menu__item-desc",children:"1m1m SVG tiles for large-format printing"})]})]}),o.jsx("div",{className:"export-menu__divider"}),o.jsxs("button",{className:"export-menu__item",onClick:x,disabled:r!==null,children:[o.jsx("span",{className:"export-menu__icon",children:""}),o.jsxs("div",{className:"export-menu__item-content",children:[o.jsx("span",{className:"export-menu__item-title",children:r==="pdf"?"Generating...":"Materials Report (PDF)"}),o.jsx("span",{className:"export-menu__item-desc",children:"TPV quantities & specifications"})]})]})]})]})}function S5({isOpen:e,onClose:t}){if(!e)return null;const n=[{category:"Selection",items:[{keys:["Delete"],description:"Remove selected element"},{keys:["Escape"],description:"Deselect element"}]},{category:"Edit",items:[{keys:["Ctrl","Z"],description:"Undo"},{keys:["Ctrl","Shift","Z"],description:"Redo"},{keys:["Ctrl","D"],description:"Duplicate selected"}]},{category:"Move",items:[{keys:["Arrow Keys"],description:"Nudge element (10mm)"},{keys:["Shift","Arrow Keys"],description:"Large nudge (100mm)"}]},{category:"Layers",items:[{keys:["["],description:"Send backward"},{keys:["]"],description:"Bring forward"}]},{category:"View",items:[{keys:["G"],description:"Toggle snap to grid"},{keys:["?"],description:"Show this help"}]}],i=navigator.platform.toUpperCase().indexOf("MAC")>=0?"":"Ctrl";return o.jsx("div",{className:"keyboard-shortcuts-overlay",onClick:t,style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},children:o.jsxs("div",{className:"keyboard-shortcuts-modal",onClick:s=>s.stopPropagation(),style:{background:"#fff",borderRadius:"8px",padding:"24px",maxWidth:"480px",width:"90%",maxHeight:"80vh",overflow:"auto",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.2)"},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[o.jsx("h2",{style:{margin:0,fontSize:"1.25rem",fontWeight:600},children:"Keyboard Shortcuts"}),o.jsx("button",{onClick:t,style:{background:"none",border:"none",fontSize:"1.5rem",cursor:"pointer",padding:"4px 8px",color:"#666"},"aria-label":"Close",children:""})]}),n.map(s=>o.jsxs("div",{style:{marginBottom:"20px"},children:[o.jsx("h3",{style:{fontSize:"0.75rem",fontWeight:600,textTransform:"uppercase",color:"#666",marginBottom:"8px",letterSpacing:"0.5px"},children:s.category}),o.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:s.items.map((a,l)=>o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 0"},children:[o.jsx("span",{style:{color:"#333",fontSize:"0.9rem"},children:a.description}),o.jsx("div",{style:{display:"flex",gap:"4px"},children:a.keys.map((c,d)=>o.jsx("kbd",{style:{display:"inline-block",padding:"4px 8px",fontSize:"0.75rem",fontFamily:"system-ui, -apple-system, sans-serif",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:"4px",boxShadow:"0 1px 2px rgba(0,0,0,0.1)",minWidth:"24px",textAlign:"center"},children:c==="Ctrl"?i:c},d))})]},l))})]},s.category)),o.jsxs("p",{style:{fontSize:"0.8rem",color:"#888",marginTop:"16px",paddingTop:"16px",borderTop:"1px solid #eee",marginBottom:0},children:["Press ",o.jsx("kbd",{style:{padding:"2px 6px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:"3px",fontSize:"0.75rem"},children:"?"})," at any time to show this help"]})]})})}class k5{async _getAuthHeaders(){const t=await Br.getSession(),n={"Content-Type":"application/json"};return t!=null&&t.access_token&&(n.Authorization=`Bearer ${t.access_token}`),n}async generateRecraft(t){const n={prompt:t.prompt,width_mm:t.widthMM||5e3,length_mm:t.lengthMM||5e3,max_colours:t.maxColours||6,seed:t.seed||null},r=await this._getAuthHeaders(),i=await fetch("/api/recraft-generate",{method:"POST",headers:r,body:JSON.stringify(n)});if(!i.ok){const s=await i.json();throw new Error(s.error||"Recraft generation failed")}return i.json()}async vectorizeImage(t){const n={image_url:t.image_url,width_mm:t.width_mm||5e3,length_mm:t.length_mm||5e3,seed:t.seed||null},r=await this._getAuthHeaders(),i=await fetch("/api/recraft-vectorize",{method:"POST",headers:r,body:JSON.stringify(n)});if(!i.ok){const s=await i.json();throw new Error(s.error||"Vectorization failed")}return i.json()}async processUploadedSVG(t){const n={svg_url:t.svg_url,width_mm:t.width_mm||5e3,length_mm:t.length_mm||5e3},r=await this._getAuthHeaders(),i=await fetch("/api/process-uploaded-svg",{method:"POST",headers:r,body:JSON.stringify(n)});if(!i.ok){const s=await i.json();throw new Error(s.error||"SVG processing failed")}return i.json()}async getRecraftStatus(t){const n=await this._getAuthHeaders(),r=await fetch(`/api/studio-job-status?jobId=${t}`,{headers:n});if(!r.ok){const i=await r.json();throw new Error(i.error||"Status fetch failed")}return r.json()}async waitForRecraftCompletion(t,n=null,r=2e3){return new Promise((i,s)=>{const a=async()=>{var l,c,d,u;try{const p=await this.getRecraftStatus(t);n&&n(p),p.status==="completed"?((l=p.result)==null?void 0:l.svg_url)?(console.log("[API] Recraft job complete with SVG output"),i(p)):(console.error("[API] Recraft job completed but no SVG output"),s(new Error("Job completed but no output received"))):p.status==="failed"?(c=p.result)!=null&&c.svg_url?(console.warn("[API] Job failed compliance but has output (non-compliant)"),i(p)):s(new Error(p.error||"Job failed")):(p.status==="retrying"&&console.log(`[API] Retrying: ${(d=p.recraft)==null?void 0:d.attempt_current}/${(u=p.recraft)==null?void 0:u.attempt_max}`),setTimeout(a,r))}catch(p){s(p)}};a()})}async matchColor(t,n=2){const r=await fetch("/api/match-color",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({hex:t,max_components:n})});if(!r.ok){const i=await r.json();throw new Error(i.error||"Color matching failed")}return r.json()}async generateDesignName(t){const n={prompt:t.prompt,colors:t.colors||[],dimensions:t.dimensions||{}},r=await this._getAuthHeaders(),i=await fetch("/api/generate-design-name",{method:"POST",headers:r,body:JSON.stringify(n)});if(!i.ok){const s=await i.json();throw new Error(s.error||"Name generation failed")}return i.json()}async inspireSimpleCreateJob(t){const n={prompt:t.prompt,surface:{width_mm:t.lengthMM||5e3,height_mm:t.widthMM||5e3},max_colours:t.maxColours||6,try_simpler:t.trySimpler||!1};t.seed&&(n.seed=t.seed);const r=await fetch("/api/studio-inspire-simple",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!r.ok){const i=await r.json();throw new Error(i.message||"Unable to start design generation. Please check your connection and try again.")}return r.json()}async inspireSimpleGetStatus(t){const n=await this._getAuthHeaders(),r=await fetch(`/api/studio-job-status?jobId=${t}`,{headers:n});if(!r.ok){const i=await r.json();throw new Error(i.message||"Unable to check generation status. Please try again.")}return r.json()}async inspireSimpleWaitForCompletion(t,n=null,r=2e3){return new Promise((i,s)=>{const a=async()=>{var l;try{const c=await this.inspireSimpleGetStatus(t);n&&n(c),c.status==="completed"?((l=c.result)==null?void 0:l.final_url)?(console.log("[API] Job complete with JPG output, resolving"),i(c)):(console.log("[API] Job completed but no output received"),s(new Error("Job completed but no output received"))):c.status==="failed"?s(new Error(c.error||"Job failed")):setTimeout(a,r)}catch(c){s(c)}};a()})}async draftify(t){const n=await fetch(a0.DRAFTIFY,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok){const r=await n.json();throw new Error(r.message||"Unable to convert image to vector format. Please try a different image.")}return n.json()}async generateGeometric(t){const n={brief:t.prompt||t.brief,canvas:{width_mm:t.lengthMM||5e3,height_mm:t.widthMM||5e3},options:{mood:t.mood||"playful",composition:t.composition||"mixed",colorCount:t.maxColours||t.colorCount||5,seed:t.seed},validate:!0},r=await fetch(a0.GEOMETRIC_GENERATE,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!r.ok){const i=await r.json();throw new Error(i.message||"Unable to generate design. Please try a different prompt or settings.")}return r.json()}}const cs=new k5;function j5({recipes:e,onClose:t}){if(!e||e.length===0)return o.jsxs("div",{className:"solid-summary-empty",children:[o.jsx("p",{children:"No colours in design."}),o.jsx("button",{onClick:t,className:"close-button",children:"Close"})]});const n=e.reduce((r,i)=>r+i.targetColor.areaPct,0);return o.jsxs("div",{className:"solid-color-summary",children:[o.jsxs("div",{className:"summary-header",children:[o.jsx("h3",{children:"TPV Colours Used"}),o.jsx("button",{onClick:t,className:"close-button-icon",children:""})]}),o.jsx("div",{className:"summary-info",children:o.jsxs("p",{className:"summary-description",children:["This design uses ",o.jsx("strong",{children:e.length})," pure TPV colour",e.length!==1?"s":""," (no blending required)"]})}),o.jsx("div",{className:"colors-list",children:e.map((r,i)=>{const s=r.chosenRecipe.components[0],a=r.targetColor.areaPct;return o.jsxs("div",{className:"color-item",children:[o.jsx("div",{className:"color-swatch",style:{backgroundColor:r.blendColor.hex},title:`${s.code} - ${s.name}`}),o.jsxs("div",{className:"color-details",children:[o.jsxs("div",{className:"color-primary",children:[o.jsx("span",{className:"color-code",children:s.code}),o.jsx("span",{className:"color-name",children:s.name})]}),o.jsxs("div",{className:"color-secondary",children:[o.jsx("span",{className:"hex-value",children:r.blendColor.hex}),o.jsxs("span",{className:"coverage-badge",children:[a.toFixed(1),"%"]})]})]})]},i)})}),o.jsxs("div",{className:"summary-footer",children:[o.jsxs("div",{className:"footer-stat",children:[o.jsx("span",{className:"stat-label",children:"Total Coverage:"}),o.jsxs("span",{className:"stat-value",children:[n.toFixed(1),"%"]})]}),o.jsxs("div",{className:"footer-stat",children:[o.jsx("span",{className:"stat-label",children:"TPV Colours:"}),o.jsx("span",{className:"stat-value",children:e.length})]})]}),o.jsx("style",{jsx:!0,children:`
        .solid-color-summary {
          background: #fff;
          border-radius: 8px;
          border: 1px solid #ddd;
          padding: 2rem;
          max-width: 800px;
          margin: 2rem auto;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .solid-summary-empty {
          background: #fff;
          border-radius: 8px;
          padding: 2rem;
          text-align: center;
        }

        .summary-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 1.5rem;
          padding-bottom: 1rem;
          border-bottom: 2px solid #1a365d;
        }

        .summary-header h3 {
          margin: 0;
          color: #1a365d;
          font-size: 1.8rem;
        }

        .close-button-icon {
          background: none;
          border: none;
          font-size: 2rem;
          color: #666;
          cursor: pointer;
          padding: 0;
          width: 32px;
          height: 32px;
          line-height: 1;
          transition: color 0.2s;
        }

        .close-button-icon:hover {
          color: #333;
        }

        .summary-info {
          background: #f9f9f9;
          padding: 1rem;
          border-radius: 6px;
          margin-bottom: 1.5rem;
        }

        .summary-description {
          margin: 0;
          color: #333;
          font-size: 1rem;
          line-height: 1.5;
        }

        /* Colors List */
        .colors-list {
          display: flex;
          flex-direction: column;
          gap: 1rem;
          margin-bottom: 1.5rem;
        }

        .color-item {
          display: flex;
          align-items: center;
          gap: 1rem;
          padding: 1rem;
          background: #f9f9f9;
          border-radius: 6px;
          border: 1px solid #e0e0e0;
          transition: all 0.2s;
        }

        .color-item:hover {
          border-color: #ff6b35;
          box-shadow: 0 2px 8px rgba(255, 107, 53, 0.15);
        }

        .color-swatch {
          width: 60px;
          height: 60px;
          border-radius: 8px;
          border: 2px solid #ddd;
          flex-shrink: 0;
          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .color-details {
          flex: 1;
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .color-primary {
          display: flex;
          align-items: baseline;
          gap: 0.5rem;
        }

        .color-code {
          font-family: 'Courier New', monospace;
          font-weight: 700;
          font-size: 1.2rem;
          color: #1a365d;
        }

        .color-name {
          font-size: 1.1rem;
          color: #333;
          font-weight: 500;
        }

        .color-secondary {
          display: flex;
          align-items: center;
          gap: 1rem;
        }

        .hex-value {
          font-family: 'Courier New', monospace;
          font-size: 0.9rem;
          color: #666;
        }

        .coverage-badge {
          background: #ff6b35;
          color: white;
          padding: 0.25rem 0.75rem;
          border-radius: 12px;
          font-weight: 600;
          font-size: 0.9rem;
        }

        /* Summary Footer */
        .summary-footer {
          display: flex;
          justify-content: space-around;
          padding: 1.5rem;
          background: #f9f9f9;
          border-radius: 6px;
          border: 2px solid #ff6b35;
        }

        .footer-stat {
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 0.5rem;
        }

        .stat-label {
          font-size: 0.9rem;
          color: #666;
          font-weight: 500;
        }

        .stat-value {
          font-size: 1.5rem;
          font-weight: 700;
          color: #1a365d;
        }

        .close-button {
          padding: 0.75rem 1.5rem;
          background: #ff6b35;
          color: white;
          border: none;
          border-radius: 4px;
          font-weight: 600;
          cursor: pointer;
          transition: background 0.2s;
        }

        .close-button:hover {
          background: #e55a25;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
          .solid-color-summary {
            padding: 1rem;
          }

          .summary-header h3 {
            font-size: 1.4rem;
          }

          .color-item {
            flex-direction: column;
            align-items: flex-start;
          }

          .color-swatch {
            width: 100%;
            height: 50px;
          }

          .summary-footer {
            flex-direction: column;
            gap: 1rem;
          }
        }
      `})]})}function Ef({content:e,position:t="top"}){const[n,r]=R.useState(!1);return o.jsxs("div",{className:"help-icon-container",children:[o.jsx("button",{className:"help-icon",onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),onClick:i=>{i.preventDefault(),i.stopPropagation(),r(!n)},type:"button","aria-label":"Help",children:"?"}),n&&o.jsx("div",{className:`help-tooltip help-tooltip-${t}`,children:e}),o.jsx("style",{children:`
        .help-icon-container {
          position: relative;
          display: inline-block;
        }

        .help-icon {
          display: inline-flex;
          align-items: center;
          justify-content: center;
          width: 18px;
          height: 18px;
          border-radius: 50%;
          background: #6b7280;
          color: white;
          border: none;
          font-size: 12px;
          font-weight: 600;
          cursor: help;
          transition: all 0.2s;
          padding: 0;
          line-height: 1;
        }

        .help-icon:hover {
          background: #374151;
          transform: scale(1.1);
        }

        .help-tooltip {
          position: absolute;
          z-index: 1000;
          background: #1f2937;
          color: white;
          padding: 0.75rem 1rem;
          border-radius: 6px;
          font-size: 0.875rem;
          line-height: 1.5;
          max-width: 300px;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
          pointer-events: none;
          white-space: normal;
        }

        .help-tooltip-top {
          bottom: calc(100% + 8px);
          left: 50%;
          transform: translateX(-50%);
        }

        .help-tooltip-top::after {
          content: '';
          position: absolute;
          top: 100%;
          left: 50%;
          transform: translateX(-50%);
          border: 6px solid transparent;
          border-top-color: #1f2937;
        }

        .help-tooltip-bottom {
          top: calc(100% + 8px);
          left: 50%;
          transform: translateX(-50%);
        }

        .help-tooltip-bottom::after {
          content: '';
          position: absolute;
          bottom: 100%;
          left: 50%;
          transform: translateX(-50%);
          border: 6px solid transparent;
          border-bottom-color: #1f2937;
        }

        .help-tooltip-right {
          left: calc(100% + 8px);
          top: 50%;
          transform: translateY(-50%);
        }

        .help-tooltip-right::after {
          content: '';
          position: absolute;
          right: 100%;
          top: 50%;
          transform: translateY(-50%);
          border: 6px solid transparent;
          border-right-color: #1f2937;
        }

        .help-tooltip-left {
          right: calc(100% + 8px);
          top: 50%;
          transform: translateY(-50%);
        }

        .help-tooltip-left::after {
          content: '';
          position: absolute;
          left: 100%;
          top: 50%;
          transform: translateY(-50%);
          border: 6px solid transparent;
          border-left-color: #1f2937;
        }

        @media (max-width: 768px) {
          .help-tooltip {
            max-width: 250px;
            font-size: 0.8125rem;
            padding: 0.625rem 0.875rem;
          }
        }
      `})]})}function C5({recipes:e,mode:t="blend",onColorClick:n,selectedColor:r,editedColors:i,onResetAll:s}){if(!e||e.length===0)return null;const a=h=>!i||i.size===0?!1:i.has(h.originalColor.hex.toLowerCase()),l=h=>{if(!i||i.size===0)return!1;const f=i.get(h.originalColor.hex.toLowerCase());return(f==null?void 0:f.newHex)==="transparent"||(f==null?void 0:f.newHex)==="none"},c=i&&i.size>0,d=h=>{const f=h.toLowerCase();return dn.find(m=>m.hex.toLowerCase()===f)},u=h=>{if(l(h))return"Transparent";if(t==="solid"){const f=d(h.blendColor.hex);if(f)return`${f.code} - ${f.name}`}return h.blendColor.hex},p=h=>{if(!r)return!1;const f=r.blendHex||r.hex;return h.blendColor.hex===f||h.targetColor.hex===f};return o.jsxs("div",{className:"color-legend",children:[o.jsxs("div",{className:"legend-header",children:[o.jsxs("div",{className:"legend-header-left",children:[o.jsx("span",{className:"legend-title",children:"Colours"}),o.jsx(Ef,{content:"Click any colour to edit all instances of that colour across the design. Changes apply to every region using that colour.",position:"right"}),n&&o.jsx("span",{className:"edit-hint",children:"(click to edit)"})]}),c&&s&&o.jsx("button",{onClick:s,className:"reset-all-btn",title:"Reset all colours to original",children:"Reset All"})]}),o.jsx("div",{className:"legend-colors",children:e.map((h,f)=>o.jsxs("div",{className:`color-item ${n?"clickable":""} ${p(h)?"selected":""}`,onClick:()=>{n&&n({hex:h.targetColor.hex,originalHex:h.originalColor.hex,blendHex:h.blendColor.hex,areaPct:h.targetColor.areaPct,recipe:h.chosenRecipe,targetColor:h.targetColor,isAddedFromEdit:h.isAddedFromEdit||!1,chosenRecipe:h.chosenRecipe},"palette")},title:n?"Click to edit this colour":"",children:[o.jsxs("div",{className:"color-swatch-wrapper",children:[o.jsx("div",{className:`color-swatch ${l(h)?"transparent-swatch":""}`,style:l(h)?{}:{backgroundColor:h.blendColor.hex}}),l(h)&&o.jsx("span",{className:"transparent-indicator",title:"Made transparent",children:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",width:"14",height:"14",children:[o.jsx("circle",{cx:"12",cy:"12",r:"10"}),o.jsx("line",{x1:"4",y1:"4",x2:"20",y2:"20"})]})}),a(h)&&!l(h)&&o.jsx("span",{className:"edit-indicator",title:"Colour has been modified",children:o.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"12",height:"12",children:o.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"})})})]}),o.jsxs("div",{className:"color-info",children:[o.jsx("span",{className:t==="solid"?"tpv-label":"hex-value",children:u(h)}),o.jsxs("span",{className:"coverage",children:[h.targetColor.areaPct.toFixed(1),"%"]})]})]},f))}),o.jsx("style",{jsx:!0,children:`
        .color-legend {
          background: rgba(255, 255, 255, 0.95);
          border: 1px solid #ddd;
          border-radius: 8px;
          padding: 1rem;
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
          width: 100%;
        }

        .legend-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          gap: 0.5rem;
          margin-bottom: 0.75rem;
          padding-bottom: 0.5rem;
          border-bottom: 1px solid #e0e0e0;
        }

        .legend-header-left {
          display: flex;
          align-items: center;
          gap: 0.5rem;
        }

        .legend-title {
          font-weight: 600;
          color: #1a365d;
          font-size: 0.95rem;
        }

        .edit-hint {
          font-size: 0.75rem;
          color: #ff6b35;
          font-weight: normal;
        }

        .reset-all-btn {
          padding: 0.25rem 0.5rem;
          font-size: 0.7rem;
          font-weight: 600;
          color: #ff6b35;
          background: #fff5f0;
          border: 1px solid #ff6b35;
          border-radius: 4px;
          cursor: pointer;
          transition: all 0.2s;
        }

        .reset-all-btn:hover {
          background: #ff6b35;
          color: white;
        }

        .legend-colors {
          display: grid;
          grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
          gap: 0.75rem;
        }

        .color-item {
          display: flex;
          align-items: center;
          gap: 0.75rem;
          padding: 0.5rem;
          border-radius: 4px;
          background: white;
          border: 1px solid #e8e8e8;
          transition: all 0.2s;
        }

        .color-item.clickable {
          cursor: pointer;
        }

        .color-item.clickable:hover {
          border-color: #ff6b35;
          background: #fff9f7;
          box-shadow: 0 2px 4px rgba(255, 107, 53, 0.15);
          transform: translateY(-2px);
        }

        .color-item.selected {
          border-color: #ff6b35;
          border-width: 2px;
          background: #fff9f7;
          box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.2);
          transform: translateY(-2px);
        }

        .color-swatch-wrapper {
          position: relative;
          flex-shrink: 0;
        }

        .color-swatch {
          width: 40px;
          height: 40px;
          border-radius: 4px;
          border: 2px solid #ddd;
        }

        .color-swatch.transparent-swatch {
          background:
            linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%),
            linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%);
          background-size: 8px 8px;
          background-position: 0 0, 4px 4px;
          background-color: white;
          border-color: #999;
        }

        .transparent-indicator {
          position: absolute;
          top: -4px;
          right: -4px;
          width: 18px;
          height: 18px;
          background: #6b7280;
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          color: white;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }

        .transparent-indicator svg {
          width: 12px;
          height: 12px;
        }

        .edit-indicator {
          position: absolute;
          top: -4px;
          right: -4px;
          width: 16px;
          height: 16px;
          background: #ff6b35;
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          color: white;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }

        .edit-indicator svg {
          width: 10px;
          height: 10px;
        }

        .color-info {
          display: flex;
          flex-direction: column;
          gap: 0.25rem;
          font-size: 0.85rem;
        }

        .hex-value {
          font-family: 'Courier New', monospace;
          font-weight: 600;
          color: #333;
        }

        .tpv-label {
          font-weight: 600;
          color: #1a365d;
          font-size: 0.9rem;
        }

        .coverage {
          color: #666;
          font-size: 0.8rem;
        }

        /* Mobile - compact horizontal grid of swatches */
        @media (max-width: 768px) {
          .color-legend {
            padding: 0.75rem;
          }

          .legend-header {
            margin-bottom: 0.5rem;
            padding-bottom: 0.5rem;
          }

          .legend-title {
            font-size: 0.85rem;
          }

          .edit-hint {
            font-size: 0.7rem;
          }

          .reset-all-btn {
            font-size: 0.65rem;
            padding: 0.2rem 0.4rem;
            min-height: 28px;
          }

          /* Horizontal scrolling grid of swatches */
          .legend-colors {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            justify-content: flex-start;
          }

          .color-item {
            flex-direction: column;
            padding: 0.25rem;
            border-radius: 6px;
            width: auto;
            min-width: 44px;
          }

          /* Hide text info on mobile - just show swatches */
          .color-info {
            display: none;
          }

          .color-swatch {
            width: 44px;
            height: 44px;
            border-radius: 6px;
          }

          .color-item.selected {
            transform: none;
            box-shadow: 0 0 0 2px rgba(255, 107, 53, 0.4);
          }

          .color-item.clickable:hover {
            transform: none;
          }

          .edit-indicator {
            top: -2px;
            right: -2px;
            width: 14px;
            height: 14px;
          }

          .edit-indicator svg {
            width: 8px;
            height: 8px;
          }
        }

        @media (max-width: 480px) {
          .color-legend {
            padding: 0.5rem;
          }

          .legend-colors {
            gap: 0.35rem;
          }

          .color-swatch {
            width: 40px;
            height: 40px;
          }

          .color-item {
            min-width: 40px;
          }
        }
      `})]})}const E5=[{code:"RH01",name:"Standard Red",hex:"#A5362F"},{code:"RH02",name:"Bright Red",hex:"#E21F2F"},{code:"RH10",name:"Standard Green",hex:"#609B63"},{code:"RH11",name:"Bright Green",hex:"#3BB44A"},{code:"RH12",name:"Dark Green",hex:"#006C55"},{code:"RH20",name:"Standard Blue",hex:"#0075BC"},{code:"RH21",name:"Purple",hex:"#493D8C"},{code:"RH22",name:"Light Blue",hex:"#47AFE3"},{code:"RH23",name:"Azure",hex:"#039DC4"},{code:"RH26",name:"Turquoise",hex:"#00A6A3"},{code:"RH30",name:"Standard Beige",hex:"#E4C4AA"},{code:"RH31",name:"Cream",hex:"#E8E3D8"},{code:"RH32",name:"Brown",hex:"#8B5F3C"},{code:"RH90",name:"Funky Pink",hex:"#E8457E"},{code:"RH40",name:"Mustard Yellow",hex:"#E5A144"},{code:"RH41",name:"Bright Yellow",hex:"#FFD833"},{code:"RH50",name:"Orange",hex:"#F15B32"},{code:"RH60",name:"Dark Grey",hex:"#59595B"},{code:"RH61",name:"Light Grey",hex:"#939598"},{code:"RH65",name:"Pale Grey",hex:"#D9D9D6"},{code:"RH70",name:"Black",hex:"#231F20"}];function T5({blendSvgUrl:e,recipes:t,mode:n="blend",onColorClick:r,onRegionClick:i,onEyedropperCancel:s,onMakeTransparent:a,onSelectTPVColor:l,selectedColor:c,editedColors:d,onResetAll:u,designName:p="",onNameChange:h,isNameLoading:f=!1,onInSituClick:m,eyedropperActive:g=!1,eyedropperRegion:x=null,onRegionUndo:y,onRegionRedo:v,canUndo:b=!1,canRedo:w=!1,regionOverridesCount:C=0}){const[_,j]=R.useState(null),[E,T]=R.useState(null),M=R.useRef(null),J=R.useRef(null);R.useRef(null);const[P,q]=R.useState(1),[k,z]=R.useState({x:0,y:0}),[he,Z]=R.useState(!1),[K,H]=R.useState({x:0,y:0}),X=R.useRef(null),F=R.useRef(!1),[W,re]=R.useState(()=>localStorage.getItem("tpv_color_editing_tip_dismissed")!=="true"),se=()=>{re(!1),localStorage.setItem("tpv_color_editing_tip_dismissed","true")};R.useEffect(()=>{if(!e){T(null);return}(async()=>{try{const oe=await(await fetch(e)).text();T(oe);const de=oe.includes("data-region-id"),G=(oe.match(/data-region-id/g)||[]).length;console.log("[SVGPreview] Fetched inline SVG content - length:",oe.length,"hasRegionTags:",de,"regionCount:",G)}catch(B){console.error("[SVGPreview] Failed to fetch SVG content:",B),T(null)}})()},[e]);const me=R.useMemo(()=>{if(!E)return null;console.log("[SVGPreview] Sanitizing SVG content...");const N=Sf(E);return N?(console.log("[SVGPreview] SVG sanitization complete - length:",N.length),console.log("[SVGPreview] Sanitized content preview:",N.substring(0,200)),N.includes("<svg")?N.replace(/<svg([^>]*)>/i,(oe,de)=>(de.includes("width=")||(de+=' width="100%"'),de.includes("height=")||(de+=' height="100%"'),`<svg${de}>`)):(console.error("[SVGPreview] Sanitized SVG does not contain <svg> tag!"),null)):(console.error("[SVGPreview] SVG sanitization failed - content rejected"),null)},[E]);R.useEffect(()=>{if(!c||!e){j(null);return}(async()=>{try{console.log("[SVGPreview] Creating highlight for color:",c);const B=new Image;B.crossOrigin="anonymous";const oe=new Promise((ie,je)=>{B.onload=()=>{console.log("[SVGPreview] Image loaded:",B.width,"x",B.height),ie()},B.onerror=Y=>{console.error("[SVGPreview] Image load error:",Y),je(Y)}});B.src=e,await oe;const de=document.createElement("canvas");de.width=B.naturalWidth||B.width||1e3,de.height=B.naturalHeight||B.height||1e3;const G=de.getContext("2d");G.drawImage(B,0,0);const ge=G.getImageData(0,0,de.width,de.height).data,V=c.hex,$=ke(V);console.log("[SVGPreview] Target color:",V,$);const D=new Set;let ae=0;for(let ie=0;ie<de.height;ie++)for(let je=0;je<de.width;je++){const Y=(ie*de.width+je)*4,ne=ge[Y],Ie=ge[Y+1],Ke=ge[Y+2];ge[Y+3]>0&&pe(ne,Ie,Ke,$)&&(D.add(`${je},${ie}`),ae++)}if(console.log("[SVGPreview] Matched pixels:",ae),ae===0){console.warn("[SVGPreview] No pixels matched the target color"),j(null);return}const Se=G.createImageData(de.width,de.height);for(let ie=0;ie<de.height;ie++)for(let je=0;je<de.width;je++){const Y=(ie*de.width+je)*4;D.has(`${je},${ie}`)&&(!D.has(`${je-1},${ie}`)||!D.has(`${je+1},${ie}`)||!D.has(`${je},${ie-1}`)||!D.has(`${je},${ie+1}`))&&(Se.data[Y]=255,Se.data[Y+1]=0,Se.data[Y+2]=255,Se.data[Y+3]=255)}G.clearRect(0,0,de.width,de.height),G.putImageData(Se,0,0);const le=de.toDataURL();console.log("[SVGPreview] Highlight mask created"),j(le)}catch(B){console.error("[SVGPreview] Failed to create highlight mask:",B),j(null)}})()},[c,e]);const ke=N=>{const B=N.replace("#","");return{r:parseInt(B.substring(0,2),16),g:parseInt(B.substring(2,4),16),b:parseInt(B.substring(4,6),16)}},pe=(N,B,oe,de)=>Math.abs(N-de.r)<=50&&Math.abs(B-de.g)<=50&&Math.abs(oe-de.b)<=50,Pe=async(N,B)=>{try{if(!M.current||!e)return null;const oe=new Image;oe.crossOrigin="anonymous";const de=new Promise((ie,je)=>{oe.onload=ie,oe.onerror=je});oe.src=e,await de;const G=document.createElement("canvas");G.width=oe.naturalWidth||oe.width||1e3,G.height=oe.naturalHeight||oe.height||1e3;const te=G.getContext("2d");te.drawImage(oe,0,0);const ge=M.current.getBoundingClientRect(),V=G.width/ge.width,$=G.height/ge.height,D=Math.floor(N*V),ae=Math.floor(B*$),le=te.getImageData(D,ae,1,1).data;return{r:le[0],g:le[1],b:le[2],a:le[3]}}catch(oe){return console.error("[SVGPreview] Failed to get color at position:",oe),null}},Re=()=>{q(N=>Math.min(N*1.5,5))},Ge=()=>{q(N=>Math.max(N/1.5,.5))},$e=()=>{q(1),z({x:0,y:0})},we=N=>{N.preventDefault();const B=N.deltaY*-.001;q(oe=>Math.min(Math.max(oe+B,.5),5))},xe=N=>{N.button===0&&(Z(!0),H({x:N.clientX-k.x,y:N.clientY-k.y}),F.current=!1)},S=N=>{if(!he)return;const B=Math.abs(N.clientX-(K.x+k.x)),oe=Math.abs(N.clientY-(K.y+k.y));(B>5||oe>5)&&(F.current=!0),z({x:N.clientX-K.x,y:N.clientY-K.y})},ue=()=>{Z(!1)};R.useEffect(()=>{if(he)return document.addEventListener("mousemove",S),document.addEventListener("mouseup",ue),()=>{document.removeEventListener("mousemove",S),document.removeEventListener("mouseup",ue)}},[he,K,k]);const ce=N=>{let B=N;for(;B&&B!==J.current;){if(B.hasAttribute&&B.hasAttribute("data-region-id"))return B;B=B.parentElement}return null},I=async N=>{var V,$;if(F.current){console.log("[SVGPreview] Click ignored - was dragging");return}if(console.log("[SVGPreview] Click detected - onRegionClick:",!!i,"inlineSvgContent:",!!E,"target:",N.target.tagName),i&&E){console.log("[SVGPreview] Attempting region detection on target:",N.target);const D=ce(N.target);if(console.log("[SVGPreview] Found region element:",D),D){const ae=D.getAttribute("data-region-id"),Se=D.getAttribute("fill")||(($=(V=D.getAttribute("style"))==null?void 0:V.match(/fill:\s*([^;]+)/))==null?void 0:$[1]);console.log("[SVGPreview] Region clicked:",ae,"fill:",Se),i({regionId:ae,sourceColor:Se,element:D});return}else console.log("[SVGPreview] No region element found from target")}else console.log("[SVGPreview] Region detection skipped - onRegionClick:",!!i,"inlineSvgContent:",!!E);if(!r||!t||t.length===0)return;const B=N.currentTarget.getBoundingClientRect(),oe=N.clientX-B.left,de=N.clientY-B.top;console.log("[SVGPreview] Clicked at:",oe,de);const G=await Pe(oe,de);if(!G||G.a===0){console.log("[SVGPreview] Clicked on transparent area");return}console.log("[SVGPreview] Clicked color:",G);let te=null,ge=1/0;for(const D of t){const ae=D.targetColor.hex,Se=ke(ae);if(pe(G.r,G.g,G.b,Se)){const le=Math.sqrt(Math.pow(G.r-Se.r,2)+Math.pow(G.g-Se.g,2)+Math.pow(G.b-Se.b,2));le<ge&&(ge=le,te=D)}}te?(console.log("[SVGPreview] Matched recipe:",te.targetColor.hex),r({hex:te.targetColor.hex,originalHex:te.originalColor.hex,blendHex:te.blendColor.hex,areaPct:te.targetColor.areaPct,recipe:te.chosenRecipe,targetColor:te.targetColor,isAddedFromEdit:te.isAddedFromEdit||!1,chosenRecipe:te.chosenRecipe})):console.log("[SVGPreview] No matching recipe found for clicked color")};return e?o.jsxs("div",{className:"svg-preview",children:[o.jsxs("div",{className:"preview-header",children:[o.jsxs("div",{className:"design-name-container",children:[h?o.jsx("input",{type:"text",className:"design-name-input",value:p,onChange:N=>h(N.target.value),placeholder:f?"Generating name...":"Enter project name"}):o.jsx("h3",{children:p||"TPV Blend Design"}),f&&o.jsx("span",{className:"name-loading",children:"Generating..."})]}),c&&o.jsxs("span",{className:"editing-hint",children:["Editing: ",c.hex||c.blendHex]})]}),W&&r&&o.jsxs("div",{className:"color-editing-tip",children:[o.jsx("div",{className:"tip-icon",children:""}),o.jsxs("div",{className:"tip-content",children:[o.jsx("strong",{children:"Tip:"})," Click colours in the legend below to edit all instances, or click directly on the design to edit individual regions."]}),o.jsx("button",{onClick:se,className:"tip-close",title:"Dismiss tip",children:""})]}),o.jsxs("div",{className:"svg-display-container",children:[o.jsxs("div",{className:"svg-panel",children:[o.jsxs("div",{className:"zoom-controls",children:[o.jsx("button",{onClick:Re,className:"zoom-btn",title:"Zoom In",children:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"11",cy:"11",r:"8"}),o.jsx("line",{x1:"11",y1:"8",x2:"11",y2:"14"}),o.jsx("line",{x1:"8",y1:"11",x2:"14",y2:"11"}),o.jsx("path",{d:"m21 21-4.35-4.35"})]})}),o.jsx("button",{onClick:Ge,className:"zoom-btn",title:"Zoom Out",children:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"11",cy:"11",r:"8"}),o.jsx("line",{x1:"8",y1:"11",x2:"14",y2:"11"}),o.jsx("path",{d:"m21 21-4.35-4.35"})]})}),o.jsx("button",{onClick:$e,className:"zoom-btn",title:"Reset View",children:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M1 4v6h6"}),o.jsx("path",{d:"M23 20v-6h-6"}),o.jsx("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})]})}),o.jsxs("span",{className:"zoom-level",children:[Math.round(P*100),"%"]})]}),C>0&&o.jsxs("div",{className:"undo-redo-controls",children:[o.jsx("button",{onClick:y,className:"undo-redo-btn",title:"Undo (Ctrl+Z)",disabled:!b,children:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M3 7v6h6"}),o.jsx("path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13"})]})}),o.jsx("button",{onClick:v,className:"undo-redo-btn",title:"Redo (Ctrl+Y)",disabled:!w,children:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M21 7v6h-6"}),o.jsx("path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7"})]})})]}),m&&o.jsxs("button",{onClick:m,className:"in-situ-btn",title:"Upload a photo of your installation site and see how this design will look in place with realistic perspective",children:[o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),o.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),o.jsx("path",{d:"m21 15-5-5L5 21"})]}),o.jsx("span",{children:"Preview In-Situ"})]}),o.jsx("div",{ref:X,className:"svg-wrapper",onWheel:we,children:o.jsxs("div",{className:"svg-image-container",onClick:I,onMouseDown:xe,style:{transform:`translate(${k.x}px, ${k.y}px) scale(${P})`,cursor:he?"grabbing":P>1?"grab":g?"crosshair":r?"pointer":"default"},children:[me?o.jsx("div",{ref:J,className:"svg-inline-container",style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},dangerouslySetInnerHTML:{__html:me}}):o.jsx("img",{ref:M,src:e,alt:"TPV blend design",className:"svg-image"}),_&&o.jsx("img",{src:_,alt:"Colour highlight",className:"svg-highlight-mask"})]})}),g&&x&&o.jsx("div",{className:"eyedropper-overlay",children:o.jsxs("div",{className:"eyedropper-content",children:[o.jsx("div",{className:"eyedropper-header",children:o.jsxs("div",{className:"eyedropper-color-indicator",children:[o.jsx("div",{className:"eyedropper-color-swatch",style:{backgroundColor:x.sourceColor}}),o.jsx("span",{children:"Click another area to copy its colour, or select a TPV colour:"})]})}),o.jsx("div",{className:"eyedropper-palette",children:o.jsx("div",{className:"palette-grid",children:E5.map(N=>o.jsx("button",{className:"palette-swatch",style:{backgroundColor:N.hex},onClick:B=>{B.stopPropagation(),l&&l({hex:N.hex,code:N.code,name:N.name})},title:`${N.name} (${N.code})`},N.code))})}),o.jsxs("div",{className:"eyedropper-actions",children:[o.jsxs("button",{className:"eyedropper-transparent",onClick:N=>{N.stopPropagation(),a&&a()},title:"Remove fill from this region",children:[o.jsx("span",{className:"transparent-icon",children:""}),"Make Transparent"]}),o.jsx("button",{className:"eyedropper-cancel",onClick:N=>{N.stopPropagation(),s&&s()},children:"Cancel (Esc)"})]})]})})]}),t&&t.length>0&&o.jsx("div",{className:"legend-sidebar",children:o.jsx(C5,{recipes:t,mode:n,onColorClick:r,selectedColor:c,editedColors:d,onResetAll:u})})]}),o.jsx("style",{jsx:!0,children:`
        .svg-preview {
          background: #fff;
          border-radius: 8px;
          border: 1px solid #ddd;
          padding: 1.5rem;
          margin-top: 1.5rem;
        }

        .preview-header {
          margin-bottom: 1.5rem;
          display: flex;
          align-items: center;
          justify-content: space-between;
          flex-wrap: wrap;
          gap: 0.5rem;
        }

        .design-name-container {
          display: flex;
          align-items: center;
          gap: 0.75rem;
          flex: 1;
        }

        .preview-header h3 {
          margin: 0;
          color: #1a365d;
          font-size: 1.5rem;
        }

        .design-name-input {
          font-family: var(--font-heading), 'Overpass', sans-serif;
          font-size: 1.5rem;
          font-weight: 600;
          color: #1a365d;
          border: none;
          border-bottom: 2px solid transparent;
          background: transparent;
          padding: 0.25rem 0;
          width: 100%;
          max-width: 400px;
          transition: border-color 0.2s;
        }

        .design-name-input:hover {
          border-bottom-color: #e5e7eb;
        }

        .design-name-input:focus {
          outline: none;
          border-bottom-color: #ff6b35;
        }

        .design-name-input::placeholder {
          color: #9ca3af;
          font-weight: normal;
        }

        .name-loading {
          font-size: 0.75rem;
          color: #9ca3af;
          font-style: italic;
        }

        /* Color Editing Tip Banner */
        .color-editing-tip {
          display: flex;
          align-items: center;
          gap: 0.75rem;
          padding: 0.875rem 1rem;
          background: linear-gradient(to right, #fff7ed, #fffbeb);
          border: 1px solid #fed7aa;
          border-radius: 6px;
          margin-bottom: 1rem;
          font-size: 0.875rem;
          line-height: 1.5;
        }

        .tip-icon {
          font-size: 1.25rem;
          flex-shrink: 0;
        }

        .tip-content {
          flex: 1;
          color: #78350f;
        }

        .tip-content strong {
          color: #92400e;
        }

        .tip-close {
          background: none;
          border: none;
          font-size: 1.5rem;
          color: #92400e;
          cursor: pointer;
          padding: 0;
          line-height: 1;
          opacity: 0.6;
          transition: opacity 0.2s;
          flex-shrink: 0;
        }

        .tip-close:hover {
          opacity: 1;
        }

        /* SVG Display */
        .svg-display-container {
          display: flex;
          flex-direction: column;
          gap: 1.5rem;
          align-items: stretch;
        }

        .svg-panel {
          position: relative;
          flex: 1;
          border: 1px solid #e0e0e0;
          border-radius: 6px;
          overflow: hidden;
          background: #fafafa;
        }

        /* Zoom Controls */
        .zoom-controls {
          position: absolute;
          top: 1rem;
          right: 1rem;
          display: flex;
          gap: 0.5rem;
          background: white;
          border-radius: 8px;
          padding: 0.5rem;
          box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
          z-index: 10;
          align-items: center;
        }

        .zoom-btn {
          display: flex;
          align-items: center;
          justify-content: center;
          width: 36px;
          height: 36px;
          padding: 0;
          background: white;
          border: 1px solid #e0e0e0;
          border-radius: 6px;
          cursor: pointer;
          color: #1a365d;
          transition: all 0.2s ease;
        }

        .zoom-btn:hover {
          background: #f8fafc;
          border-color: #1e4a7a;
          transform: translateY(-1px);
          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .zoom-btn:active {
          transform: translateY(0);
        }

        .zoom-btn svg {
          width: 20px;
          height: 20px;
        }

        .zoom-level {
          font-size: 0.875rem;
          font-weight: 600;
          color: #1a365d;
          min-width: 50px;
          text-align: center;
          padding: 0 0.5rem;
        }

        /* Undo/Redo Controls */
        .undo-redo-controls {
          position: absolute;
          top: 5rem;
          right: 1rem;
          display: flex;
          gap: 0.5rem;
          background: white;
          border-radius: 8px;
          padding: 0.5rem;
          box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
          z-index: 10;
        }

        .undo-redo-btn {
          display: flex;
          align-items: center;
          justify-content: center;
          width: 36px;
          height: 36px;
          padding: 0;
          background: white;
          border: 1px solid #e0e0e0;
          border-radius: 6px;
          cursor: pointer;
          color: #1a365d;
          transition: all 0.2s ease;
        }

        .undo-redo-btn:hover:not(:disabled) {
          background: #f8fafc;
          border-color: #1e4a7a;
          transform: translateY(-1px);
          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .undo-redo-btn:active:not(:disabled) {
          transform: translateY(0);
        }

        .undo-redo-btn:disabled {
          opacity: 0.4;
          cursor: not-allowed;
        }

        .undo-redo-btn svg {
          width: 20px;
          height: 20px;
        }

        .in-situ-btn {
          position: absolute;
          top: 1rem;
          left: 1rem;
          display: flex;
          align-items: center;
          gap: 0.5rem;
          padding: 0.5rem 1rem;
          background: #ff6b35;
          color: white;
          border: none;
          border-radius: 6px;
          font-size: 0.875rem;
          font-weight: 500;
          cursor: pointer;
          box-shadow: 0 2px 12px rgba(255, 107, 53, 0.3);
          z-index: 10;
          transition: all 0.2s ease;
        }

        .in-situ-btn:hover {
          background: #e55a2b;
          transform: translateY(-1px);
          box-shadow: 0 4px 16px rgba(255, 107, 53, 0.4);
        }

        .in-situ-btn:active {
          transform: translateY(0);
        }

        .in-situ-btn svg {
          width: 18px;
          height: 18px;
        }

        .svg-wrapper {
          padding: 2rem;
          background: white;
          min-height: 400px;
          display: flex;
          align-items: center;
          justify-content: center;
          overflow: hidden;
          position: relative;
        }

        .svg-image-container {
          position: relative;
          display: inline-block;
          user-select: none;
          transition: transform 0.1s ease-out;
          transform-origin: center center;
        }

        .svg-image {
          max-width: 100%;
          height: auto;
          display: block;
          border-radius: 4px;
          pointer-events: ${r?"auto":"none"};
        }

        .svg-inline-container {
          max-width: 100%;
          display: block;
          border-radius: 4px;
        }

        .svg-inline-container svg {
          max-width: 100%;
          height: auto;
          display: block;
        }

        .svg-highlight-mask {
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          pointer-events: none;
          border-radius: 4px;
          filter: drop-shadow(0 0 3px rgba(255, 0, 255, 0.8)) drop-shadow(0 0 1px rgba(0, 0, 0, 0.6));
          animation: pulse 2s ease-in-out infinite;
        }

        .eyedropper-overlay {
          position: absolute;
          top: 20px;
          left: 50%;
          transform: translateX(-50%);
          z-index: 100;
        }

        .eyedropper-content {
          background: white;
          border-radius: 12px;
          padding: 16px 20px;
          box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
          display: flex;
          flex-direction: column;
          gap: 12px;
          border: 2px solid #3b82f6;
          max-width: 320px;
        }

        .eyedropper-header {
          display: flex;
          align-items: center;
          gap: 12px;
        }

        .eyedropper-color-indicator {
          display: flex;
          align-items: center;
          gap: 12px;
          font-size: 0.9rem;
          font-weight: 500;
          color: #111827;
        }

        .eyedropper-color-swatch {
          width: 28px;
          height: 28px;
          border-radius: 6px;
          border: 2px solid #d1d5db;
          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
          flex-shrink: 0;
        }

        .eyedropper-palette {
          padding: 10px;
          background: #f9fafb;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
        }

        .palette-grid {
          display: grid;
          grid-template-columns: repeat(7, 1fr);
          gap: 4px;
        }

        .palette-swatch {
          width: 32px;
          height: 32px;
          border: 2px solid rgba(0, 0, 0, 0.15);
          border-radius: 4px;
          cursor: pointer;
          padding: 0;
          transition: all 0.15s ease;
        }

        .palette-swatch:hover {
          transform: scale(1.15);
          z-index: 1;
          box-shadow: 0 3px 8px rgba(0, 0, 0, 0.25);
          border-color: #3b82f6;
        }

        .eyedropper-cancel {
          padding: 8px 16px;
          background: #ef4444;
          color: white;
          border: none;
          border-radius: 6px;
          font-size: 0.9rem;
          font-weight: 500;
          cursor: pointer;
          transition: all 0.2s;
          white-space: nowrap;
        }

        .eyedropper-cancel:hover {
          background: #dc2626;
          box-shadow: 0 2px 6px rgba(239, 68, 68, 0.3);
        }

        .eyedropper-actions {
          display: flex;
          gap: 8px;
          align-items: center;
          justify-content: center;
        }

        .eyedropper-transparent {
          display: flex;
          align-items: center;
          gap: 6px;
          padding: 8px 14px;
          background: linear-gradient(135deg, #f3f4f6 25%, #d1d5db 25%, #d1d5db 50%, #f3f4f6 50%, #f3f4f6 75%, #d1d5db 75%);
          background-size: 8px 8px;
          color: #374151;
          border: 2px solid #6b7280;
          border-radius: 6px;
          font-size: 0.9rem;
          font-weight: 600;
          cursor: pointer;
          transition: all 0.2s;
          white-space: nowrap;
        }

        .eyedropper-transparent:hover {
          border-color: #374151;
          box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
          transform: translateY(-1px);
        }

        .transparent-icon {
          width: 16px;
          height: 16px;
          background: linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%),
                      linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%);
          background-size: 8px 8px;
          background-position: 0 0, 4px 4px;
          background-color: white;
          border: 1px solid #999;
          border-radius: 2px;
          display: inline-block;
          font-size: 0;
        }

        @keyframes pulse {
          0%, 100% {
            opacity: 0.8;
          }
          50% {
            opacity: 1;
          }
        }

        .editing-hint {
          font-size: 0.9rem;
          color: #ff6b35;
          font-weight: 500;
          margin-left: 1rem;
        }

        .legend-sidebar {
          width: 100%;
        }

        @media (max-width: 768px) {
          .svg-preview {
            padding: 0.5rem;
            margin-top: 0.75rem;
            border-radius: 6px;
          }

          .preview-header {
            flex-direction: column;
            align-items: flex-start;
            gap: 0.25rem;
            margin-bottom: 0.5rem;
          }

          .preview-header h3 {
            font-size: 1.1rem;
          }

          .design-name-input {
            font-size: 1.1rem;
            max-width: 100%;
          }

          .editing-hint {
            margin-left: 0;
            font-size: 0.75rem;
          }

          .svg-panel {
            border: none;
            border-radius: 0;
          }

          .svg-wrapper {
            padding: 0;
            min-height: auto;
          }

          /* Position zoom controls at bottom-right on mobile */
          .zoom-controls {
            position: fixed;
            bottom: 1rem;
            right: 1rem;
            top: auto;
            flex-direction: column;
            gap: 0.25rem;
            padding: 0.25rem;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(8px);
            z-index: 50;
          }

          /* Position undo/redo controls above zoom on mobile */
          .undo-redo-controls {
            position: fixed;
            bottom: 12rem;
            right: 1rem;
            top: auto;
            gap: 0.25rem;
            padding: 0.25rem;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(8px);
            z-index: 50;
          }

          /* Make buttons circular and compact on mobile */
          .zoom-btn,
          .undo-redo-btn {
            width: 44px;
            height: 44px;
            padding: 0;
            border-radius: 50%;
            min-width: unset;
            font-size: 1.1rem;
          }

          /* Hide text labels on mobile */
          .zoom-btn span {
            display: none;
          }

          /* In-situ button - compact on mobile */
          .in-situ-btn {
            padding: 0.4rem;
            font-size: 0;
            top: 0.5rem;
            left: 0.5rem;
            border-radius: 50%;
            width: 36px;
            height: 36px;
          }

          .in-situ-btn span {
            display: none;
          }

          .in-situ-btn svg {
            width: 18px;
            height: 18px;
          }

          .svg-image-container {
            /* Allow zoom on mobile via buttons */
            cursor: default !important;
          }
        }

        /* Extra small screens */
        @media (max-width: 480px) {
          .svg-preview {
            padding: 0.25rem;
            margin-top: 0.5rem;
          }

          .preview-header {
            padding: 0 0.25rem;
          }

          .preview-header h3 {
            font-size: 1rem;
          }

          .design-name-input {
            font-size: 1rem;
          }
        }
      `})]}):null}var cr={},Sl={},N5=typeof Mi=="object"&&Mi&&Mi.Object===Object&&Mi,t1=N5,P5=t1,R5=typeof self=="object"&&self&&self.Object===Object&&self,O5=P5||R5||Function("return this")(),Vr=O5,A5=Vr,M5=A5.Symbol,kl=M5,A0=kl,n1=Object.prototype,$5=n1.hasOwnProperty,L5=n1.toString,ba=A0?A0.toStringTag:void 0;function I5(e){var t=$5.call(e,ba),n=e[ba];try{e[ba]=void 0;var r=!0}catch{}var i=L5.call(e);return r&&(t?e[ba]=n:delete e[ba]),i}var D5=I5,z5=Object.prototype,F5=z5.toString;function B5(e){return F5.call(e)}var H5=B5,M0=kl,U5=D5,W5=H5,G5="[object Null]",V5="[object Undefined]",$0=M0?M0.toStringTag:void 0;function q5(e){return e==null?e===void 0?V5:G5:$0&&$0 in Object(e)?U5(e):W5(e)}var As=q5,Y5=Array.isArray,Tr=Y5;function X5(e){return e!=null&&typeof e=="object"}var pi=X5,Z5=As,K5=Tr,J5=pi,Q5="[object String]";function eT(e){return typeof e=="string"||!K5(e)&&J5(e)&&Z5(e)==Q5}var tT=eT;function nT(e){return function(t,n,r){for(var i=-1,s=Object(t),a=r(t),l=a.length;l--;){var c=a[e?l:++i];if(n(s[c],c,s)===!1)break}return t}}var rT=nT,iT=rT,sT=iT(),oT=sT;function aT(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}var lT=aT,cT=As,dT=pi,uT="[object Arguments]";function hT(e){return dT(e)&&cT(e)==uT}var pT=hT,L0=pT,fT=pi,r1=Object.prototype,mT=r1.hasOwnProperty,gT=r1.propertyIsEnumerable,vT=L0(function(){return arguments}())?L0:function(e){return fT(e)&&mT.call(e,"callee")&&!gT.call(e,"callee")},i1=vT,od={exports:{}};function yT(){return!1}var xT=yT;od.exports;(function(e,t){var n=Vr,r=xT,i=t&&!t.nodeType&&t,s=i&&!0&&e&&!e.nodeType&&e,a=s&&s.exports===i,l=a?n.Buffer:void 0,c=l?l.isBuffer:void 0,d=c||r;e.exports=d})(od,od.exports);var Tf=od.exports,bT=9007199254740991,wT=/^(?:0|[1-9]\d*)$/;function _T(e,t){var n=typeof e;return t=t??bT,!!t&&(n=="number"||n!="symbol"&&wT.test(e))&&e>-1&&e%1==0&&e<t}var s1=_T,ST=9007199254740991;function kT(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=ST}var Nf=kT,jT=As,CT=Nf,ET=pi,TT="[object Arguments]",NT="[object Array]",PT="[object Boolean]",RT="[object Date]",OT="[object Error]",AT="[object Function]",MT="[object Map]",$T="[object Number]",LT="[object Object]",IT="[object RegExp]",DT="[object Set]",zT="[object String]",FT="[object WeakMap]",BT="[object ArrayBuffer]",HT="[object DataView]",UT="[object Float32Array]",WT="[object Float64Array]",GT="[object Int8Array]",VT="[object Int16Array]",qT="[object Int32Array]",YT="[object Uint8Array]",XT="[object Uint8ClampedArray]",ZT="[object Uint16Array]",KT="[object Uint32Array]",Ot={};Ot[UT]=Ot[WT]=Ot[GT]=Ot[VT]=Ot[qT]=Ot[YT]=Ot[XT]=Ot[ZT]=Ot[KT]=!0;Ot[TT]=Ot[NT]=Ot[BT]=Ot[PT]=Ot[HT]=Ot[RT]=Ot[OT]=Ot[AT]=Ot[MT]=Ot[$T]=Ot[LT]=Ot[IT]=Ot[DT]=Ot[zT]=Ot[FT]=!1;function JT(e){return ET(e)&&CT(e.length)&&!!Ot[jT(e)]}var QT=JT;function eN(e){return function(t){return e(t)}}var Pf=eN,ad={exports:{}};ad.exports;(function(e,t){var n=t1,r=t&&!t.nodeType&&t,i=r&&!0&&e&&!e.nodeType&&e,s=i&&i.exports===r,a=s&&n.process,l=function(){try{var c=i&&i.require&&i.require("util").types;return c||a&&a.binding&&a.binding("util")}catch{}}();e.exports=l})(ad,ad.exports);var Rf=ad.exports,tN=QT,nN=Pf,I0=Rf,D0=I0&&I0.isTypedArray,rN=D0?nN(D0):tN,o1=rN,iN=lT,sN=i1,oN=Tr,aN=Tf,lN=s1,cN=o1,dN=Object.prototype,uN=dN.hasOwnProperty;function hN(e,t){var n=oN(e),r=!n&&sN(e),i=!n&&!r&&aN(e),s=!n&&!r&&!i&&cN(e),a=n||r||i||s,l=a?iN(e.length,String):[],c=l.length;for(var d in e)(t||uN.call(e,d))&&!(a&&(d=="length"||i&&(d=="offset"||d=="parent")||s&&(d=="buffer"||d=="byteLength"||d=="byteOffset")||lN(d,c)))&&l.push(d);return l}var a1=hN,pN=Object.prototype;function fN(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||pN;return e===n}var Of=fN;function mN(e,t){return function(n){return e(t(n))}}var l1=mN,gN=l1,vN=gN(Object.keys,Object),yN=vN,xN=Of,bN=yN,wN=Object.prototype,_N=wN.hasOwnProperty;function SN(e){if(!xN(e))return bN(e);var t=[];for(var n in Object(e))_N.call(e,n)&&n!="constructor"&&t.push(n);return t}var kN=SN;function jN(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Zo=jN,CN=As,EN=Zo,TN="[object AsyncFunction]",NN="[object Function]",PN="[object GeneratorFunction]",RN="[object Proxy]";function ON(e){if(!EN(e))return!1;var t=CN(e);return t==NN||t==PN||t==TN||t==RN}var c1=ON,AN=c1,MN=Nf;function $N(e){return e!=null&&MN(e.length)&&!AN(e)}var Ld=$N,LN=a1,IN=kN,DN=Ld;function zN(e){return DN(e)?LN(e):IN(e)}var jl=zN,FN=oT,BN=jl;function HN(e,t){return e&&FN(e,t,BN)}var d1=HN;function UN(e){return e}var u1=UN,WN=u1;function GN(e){return typeof e=="function"?e:WN}var VN=GN,qN=d1,YN=VN;function XN(e,t){return e&&qN(e,YN(t))}var Af=XN,ZN=l1,KN=ZN(Object.getPrototypeOf,Object),Mf=KN,JN=As,QN=Mf,eP=pi,tP="[object Object]",nP=Function.prototype,rP=Object.prototype,h1=nP.toString,iP=rP.hasOwnProperty,sP=h1.call(Object);function oP(e){if(!eP(e)||JN(e)!=tP)return!1;var t=QN(e);if(t===null)return!0;var n=iP.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&h1.call(n)==sP}var aP=oP;function lP(e,t){for(var n=-1,r=e==null?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}var p1=lP;function cP(){this.__data__=[],this.size=0}var dP=cP;function uP(e,t){return e===t||e!==e&&t!==t}var $f=uP,hP=$f;function pP(e,t){for(var n=e.length;n--;)if(hP(e[n][0],t))return n;return-1}var Id=pP,fP=Id,mP=Array.prototype,gP=mP.splice;function vP(e){var t=this.__data__,n=fP(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():gP.call(t,n,1),--this.size,!0}var yP=vP,xP=Id;function bP(e){var t=this.__data__,n=xP(t,e);return n<0?void 0:t[n][1]}var wP=bP,_P=Id;function SP(e){return _P(this.__data__,e)>-1}var kP=SP,jP=Id;function CP(e,t){var n=this.__data__,r=jP(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}var EP=CP,TP=dP,NP=yP,PP=wP,RP=kP,OP=EP;function Ko(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Ko.prototype.clear=TP;Ko.prototype.delete=NP;Ko.prototype.get=PP;Ko.prototype.has=RP;Ko.prototype.set=OP;var Dd=Ko,AP=Dd;function MP(){this.__data__=new AP,this.size=0}var $P=MP;function LP(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}var IP=LP;function DP(e){return this.__data__.get(e)}var zP=DP;function FP(e){return this.__data__.has(e)}var BP=FP,HP=Vr,UP=HP["__core-js_shared__"],WP=UP,Bu=WP,z0=function(){var e=/[^.]+$/.exec(Bu&&Bu.keys&&Bu.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function GP(e){return!!z0&&z0 in e}var VP=GP,qP=Function.prototype,YP=qP.toString;function XP(e){if(e!=null){try{return YP.call(e)}catch{}try{return e+""}catch{}}return""}var f1=XP,ZP=c1,KP=VP,JP=Zo,QP=f1,eR=/[\\^$.*+?()[\]{}|]/g,tR=/^\[object .+?Constructor\]$/,nR=Function.prototype,rR=Object.prototype,iR=nR.toString,sR=rR.hasOwnProperty,oR=RegExp("^"+iR.call(sR).replace(eR,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function aR(e){if(!JP(e)||KP(e))return!1;var t=ZP(e)?oR:tR;return t.test(QP(e))}var lR=aR;function cR(e,t){return e==null?void 0:e[t]}var dR=cR,uR=lR,hR=dR;function pR(e,t){var n=hR(e,t);return uR(n)?n:void 0}var Ms=pR,fR=Ms,mR=Vr,gR=fR(mR,"Map"),Lf=gR,vR=Ms,yR=vR(Object,"create"),zd=yR,F0=zd;function xR(){this.__data__=F0?F0(null):{},this.size=0}var bR=xR;function wR(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var _R=wR,SR=zd,kR="__lodash_hash_undefined__",jR=Object.prototype,CR=jR.hasOwnProperty;function ER(e){var t=this.__data__;if(SR){var n=t[e];return n===kR?void 0:n}return CR.call(t,e)?t[e]:void 0}var TR=ER,NR=zd,PR=Object.prototype,RR=PR.hasOwnProperty;function OR(e){var t=this.__data__;return NR?t[e]!==void 0:RR.call(t,e)}var AR=OR,MR=zd,$R="__lodash_hash_undefined__";function LR(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=MR&&t===void 0?$R:t,this}var IR=LR,DR=bR,zR=_R,FR=TR,BR=AR,HR=IR;function Jo(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Jo.prototype.clear=DR;Jo.prototype.delete=zR;Jo.prototype.get=FR;Jo.prototype.has=BR;Jo.prototype.set=HR;var UR=Jo,B0=UR,WR=Dd,GR=Lf;function VR(){this.size=0,this.__data__={hash:new B0,map:new(GR||WR),string:new B0}}var qR=VR;function YR(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var XR=YR,ZR=XR;function KR(e,t){var n=e.__data__;return ZR(t)?n[typeof t=="string"?"string":"hash"]:n.map}var Fd=KR,JR=Fd;function QR(e){var t=JR(this,e).delete(e);return this.size-=t?1:0,t}var e3=QR,t3=Fd;function n3(e){return t3(this,e).get(e)}var r3=n3,i3=Fd;function s3(e){return i3(this,e).has(e)}var o3=s3,a3=Fd;function l3(e,t){var n=a3(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}var c3=l3,d3=qR,u3=e3,h3=r3,p3=o3,f3=c3;function Qo(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Qo.prototype.clear=d3;Qo.prototype.delete=u3;Qo.prototype.get=h3;Qo.prototype.has=p3;Qo.prototype.set=f3;var If=Qo,m3=Dd,g3=Lf,v3=If,y3=200;function x3(e,t){var n=this.__data__;if(n instanceof m3){var r=n.__data__;if(!g3||r.length<y3-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new v3(r)}return n.set(e,t),this.size=n.size,this}var b3=x3,w3=Dd,_3=$P,S3=IP,k3=zP,j3=BP,C3=b3;function ea(e){var t=this.__data__=new w3(e);this.size=t.size}ea.prototype.clear=_3;ea.prototype.delete=S3;ea.prototype.get=k3;ea.prototype.has=j3;ea.prototype.set=C3;var Df=ea,E3="__lodash_hash_undefined__";function T3(e){return this.__data__.set(e,E3),this}var N3=T3;function P3(e){return this.__data__.has(e)}var R3=P3,O3=If,A3=N3,M3=R3;function ld(e){var t=-1,n=e==null?0:e.length;for(this.__data__=new O3;++t<n;)this.add(e[t])}ld.prototype.add=ld.prototype.push=A3;ld.prototype.has=M3;var $3=ld;function L3(e,t){for(var n=-1,r=e==null?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var I3=L3;function D3(e,t){return e.has(t)}var z3=D3,F3=$3,B3=I3,H3=z3,U3=1,W3=2;function G3(e,t,n,r,i,s){var a=n&U3,l=e.length,c=t.length;if(l!=c&&!(a&&c>l))return!1;var d=s.get(e),u=s.get(t);if(d&&u)return d==t&&u==e;var p=-1,h=!0,f=n&W3?new F3:void 0;for(s.set(e,t),s.set(t,e);++p<l;){var m=e[p],g=t[p];if(r)var x=a?r(g,m,p,t,e,s):r(m,g,p,e,t,s);if(x!==void 0){if(x)continue;h=!1;break}if(f){if(!B3(t,function(y,v){if(!H3(f,v)&&(m===y||i(m,y,n,r,s)))return f.push(v)})){h=!1;break}}else if(!(m===g||i(m,g,n,r,s))){h=!1;break}}return s.delete(e),s.delete(t),h}var m1=G3,V3=Vr,q3=V3.Uint8Array,g1=q3;function Y3(e){var t=-1,n=Array(e.size);return e.forEach(function(r,i){n[++t]=[i,r]}),n}var X3=Y3;function Z3(e){var t=-1,n=Array(e.size);return e.forEach(function(r){n[++t]=r}),n}var K3=Z3,H0=kl,U0=g1,J3=$f,Q3=m1,eO=X3,tO=K3,nO=1,rO=2,iO="[object Boolean]",sO="[object Date]",oO="[object Error]",aO="[object Map]",lO="[object Number]",cO="[object RegExp]",dO="[object Set]",uO="[object String]",hO="[object Symbol]",pO="[object ArrayBuffer]",fO="[object DataView]",W0=H0?H0.prototype:void 0,Hu=W0?W0.valueOf:void 0;function mO(e,t,n,r,i,s,a){switch(n){case fO:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case pO:return!(e.byteLength!=t.byteLength||!s(new U0(e),new U0(t)));case iO:case sO:case lO:return J3(+e,+t);case oO:return e.name==t.name&&e.message==t.message;case cO:case uO:return e==t+"";case aO:var l=eO;case dO:var c=r&nO;if(l||(l=tO),e.size!=t.size&&!c)return!1;var d=a.get(e);if(d)return d==t;r|=rO,a.set(e,t);var u=Q3(l(e),l(t),r,i,s,a);return a.delete(e),u;case hO:if(Hu)return Hu.call(e)==Hu.call(t)}return!1}var gO=mO;function vO(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}var v1=vO,yO=v1,xO=Tr;function bO(e,t,n){var r=t(e);return xO(e)?r:yO(r,n(e))}var y1=bO;function wO(e,t){for(var n=-1,r=e==null?0:e.length,i=0,s=[];++n<r;){var a=e[n];t(a,n,e)&&(s[i++]=a)}return s}var _O=wO;function SO(){return[]}var x1=SO,kO=_O,jO=x1,CO=Object.prototype,EO=CO.propertyIsEnumerable,G0=Object.getOwnPropertySymbols,TO=G0?function(e){return e==null?[]:(e=Object(e),kO(G0(e),function(t){return EO.call(e,t)}))}:jO,zf=TO,NO=y1,PO=zf,RO=jl;function OO(e){return NO(e,RO,PO)}var b1=OO,V0=b1,AO=1,MO=Object.prototype,$O=MO.hasOwnProperty;function LO(e,t,n,r,i,s){var a=n&AO,l=V0(e),c=l.length,d=V0(t),u=d.length;if(c!=u&&!a)return!1;for(var p=c;p--;){var h=l[p];if(!(a?h in t:$O.call(t,h)))return!1}var f=s.get(e),m=s.get(t);if(f&&m)return f==t&&m==e;var g=!0;s.set(e,t),s.set(t,e);for(var x=a;++p<c;){h=l[p];var y=e[h],v=t[h];if(r)var b=a?r(v,y,h,t,e,s):r(y,v,h,e,t,s);if(!(b===void 0?y===v||i(y,v,n,r,s):b)){g=!1;break}x||(x=h=="constructor")}if(g&&!x){var w=e.constructor,C=t.constructor;w!=C&&"constructor"in e&&"constructor"in t&&!(typeof w=="function"&&w instanceof w&&typeof C=="function"&&C instanceof C)&&(g=!1)}return s.delete(e),s.delete(t),g}var IO=LO,DO=Ms,zO=Vr,FO=DO(zO,"DataView"),BO=FO,HO=Ms,UO=Vr,WO=HO(UO,"Promise"),GO=WO,VO=Ms,qO=Vr,YO=VO(qO,"Set"),XO=YO,ZO=Ms,KO=Vr,JO=ZO(KO,"WeakMap"),QO=JO,sp=BO,op=Lf,ap=GO,lp=XO,cp=QO,w1=As,ta=f1,q0="[object Map]",eA="[object Object]",Y0="[object Promise]",X0="[object Set]",Z0="[object WeakMap]",K0="[object DataView]",tA=ta(sp),nA=ta(op),rA=ta(ap),iA=ta(lp),sA=ta(cp),ps=w1;(sp&&ps(new sp(new ArrayBuffer(1)))!=K0||op&&ps(new op)!=q0||ap&&ps(ap.resolve())!=Y0||lp&&ps(new lp)!=X0||cp&&ps(new cp)!=Z0)&&(ps=function(e){var t=w1(e),n=t==eA?e.constructor:void 0,r=n?ta(n):"";if(r)switch(r){case tA:return K0;case nA:return q0;case rA:return Y0;case iA:return X0;case sA:return Z0}return t});var Bd=ps,Uu=Df,oA=m1,aA=gO,lA=IO,J0=Bd,Q0=Tr,ev=Tf,cA=o1,dA=1,tv="[object Arguments]",nv="[object Array]",uc="[object Object]",uA=Object.prototype,rv=uA.hasOwnProperty;function hA(e,t,n,r,i,s){var a=Q0(e),l=Q0(t),c=a?nv:J0(e),d=l?nv:J0(t);c=c==tv?uc:c,d=d==tv?uc:d;var u=c==uc,p=d==uc,h=c==d;if(h&&ev(e)){if(!ev(t))return!1;a=!0,u=!1}if(h&&!u)return s||(s=new Uu),a||cA(e)?oA(e,t,n,r,i,s):aA(e,t,c,n,r,i,s);if(!(n&dA)){var f=u&&rv.call(e,"__wrapped__"),m=p&&rv.call(t,"__wrapped__");if(f||m){var g=f?e.value():e,x=m?t.value():t;return s||(s=new Uu),i(g,x,n,r,s)}}return h?(s||(s=new Uu),lA(e,t,n,r,i,s)):!1}var pA=hA,fA=pA,iv=pi;function _1(e,t,n,r,i){return e===t?!0:e==null||t==null||!iv(e)&&!iv(t)?e!==e&&t!==t:fA(e,t,n,r,_1,i)}var S1=_1,mA=Df,gA=S1,vA=1,yA=2;function xA(e,t,n,r){var i=n.length,s=i,a=!r;if(e==null)return!s;for(e=Object(e);i--;){var l=n[i];if(a&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++i<s;){l=n[i];var c=l[0],d=e[c],u=l[1];if(a&&l[2]){if(d===void 0&&!(c in e))return!1}else{var p=new mA;if(r)var h=r(d,u,c,e,t,p);if(!(h===void 0?gA(u,d,vA|yA,r,p):h))return!1}}return!0}var bA=xA,wA=Zo;function _A(e){return e===e&&!wA(e)}var k1=_A,SA=k1,kA=jl;function jA(e){for(var t=kA(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,SA(i)]}return t}var CA=jA;function EA(e,t){return function(n){return n==null?!1:n[e]===t&&(t!==void 0||e in Object(n))}}var j1=EA,TA=bA,NA=CA,PA=j1;function RA(e){var t=NA(e);return t.length==1&&t[0][2]?PA(t[0][0],t[0][1]):function(n){return n===e||TA(n,e,t)}}var OA=RA,AA=As,MA=pi,$A="[object Symbol]";function LA(e){return typeof e=="symbol"||MA(e)&&AA(e)==$A}var Ff=LA,IA=Tr,DA=Ff,zA=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,FA=/^\w*$/;function BA(e,t){if(IA(e))return!1;var n=typeof e;return n=="number"||n=="symbol"||n=="boolean"||e==null||DA(e)?!0:FA.test(e)||!zA.test(e)||t!=null&&e in Object(t)}var Bf=BA,C1=If,HA="Expected a function";function Hf(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(HA);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],s=n.cache;if(s.has(i))return s.get(i);var a=e.apply(this,r);return n.cache=s.set(i,a)||s,a};return n.cache=new(Hf.Cache||C1),n}Hf.Cache=C1;var UA=Hf,WA=UA,GA=500;function VA(e){var t=WA(e,function(r){return n.size===GA&&n.clear(),r}),n=t.cache;return t}var qA=VA,YA=qA,XA=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ZA=/\\(\\)?/g,KA=YA(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(XA,function(n,r,i,s){t.push(i?s.replace(ZA,"$1"):r||n)}),t}),JA=KA,sv=kl,QA=p1,e4=Tr,t4=Ff,ov=sv?sv.prototype:void 0,av=ov?ov.toString:void 0;function E1(e){if(typeof e=="string")return e;if(e4(e))return QA(e,E1)+"";if(t4(e))return av?av.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var n4=E1,r4=n4;function i4(e){return e==null?"":r4(e)}var s4=i4,o4=Tr,a4=Bf,l4=JA,c4=s4;function d4(e,t){return o4(e)?e:a4(e,t)?[e]:l4(c4(e))}var T1=d4,u4=Ff;function h4(e){if(typeof e=="string"||u4(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var Hd=h4,p4=T1,f4=Hd;function m4(e,t){t=p4(t,e);for(var n=0,r=t.length;e!=null&&n<r;)e=e[f4(t[n++])];return n&&n==r?e:void 0}var N1=m4,g4=N1;function v4(e,t,n){var r=e==null?void 0:g4(e,t);return r===void 0?n:r}var y4=v4;function x4(e,t){return e!=null&&t in Object(e)}var b4=x4,w4=T1,_4=i1,S4=Tr,k4=s1,j4=Nf,C4=Hd;function E4(e,t,n){t=w4(t,e);for(var r=-1,i=t.length,s=!1;++r<i;){var a=C4(t[r]);if(!(s=e!=null&&n(e,a)))break;e=e[a]}return s||++r!=i?s:(i=e==null?0:e.length,!!i&&j4(i)&&k4(a,i)&&(S4(e)||_4(e)))}var T4=E4,N4=b4,P4=T4;function R4(e,t){return e!=null&&P4(e,t,N4)}var O4=R4,A4=S1,M4=y4,$4=O4,L4=Bf,I4=k1,D4=j1,z4=Hd,F4=1,B4=2;function H4(e,t){return L4(e)&&I4(t)?D4(z4(e),t):function(n){var r=M4(n,e);return r===void 0&&r===t?$4(n,e):A4(t,r,F4|B4)}}var U4=H4;function W4(e){return function(t){return t==null?void 0:t[e]}}var G4=W4,V4=N1;function q4(e){return function(t){return V4(t,e)}}var Y4=q4,X4=G4,Z4=Y4,K4=Bf,J4=Hd;function Q4(e){return K4(e)?X4(J4(e)):Z4(e)}var eM=Q4,tM=OA,nM=U4,rM=u1,iM=Tr,sM=eM;function oM(e){return typeof e=="function"?e:e==null?rM:typeof e=="object"?iM(e)?nM(e[0],e[1]):tM(e):sM(e)}var aM=oM,lM=Ld;function cM(e,t){return function(n,r){if(n==null)return n;if(!lM(n))return e(n,r);for(var i=n.length,s=t?i:-1,a=Object(n);(t?s--:++s<i)&&r(a[s],s,a)!==!1;);return n}}var dM=cM,uM=d1,hM=dM,pM=hM(uM),fM=pM,mM=fM,gM=Ld;function vM(e,t){var n=-1,r=gM(e)?Array(e.length):[];return mM(e,function(i,s,a){r[++n]=t(i,s,a)}),r}var yM=vM,xM=p1,bM=aM,wM=yM,_M=Tr;function SM(e,t){var n=_M(e)?xM:wM;return n(e,bM(t))}var kM=SM;Object.defineProperty(Sl,"__esModule",{value:!0});Sl.flattenNames=void 0;var jM=tT,CM=Ud(jM),EM=Af,TM=Ud(EM),NM=aP,PM=Ud(NM),RM=kM,OM=Ud(RM);function Ud(e){return e&&e.__esModule?e:{default:e}}var AM=Sl.flattenNames=function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=[];return(0,OM.default)(t,function(r){Array.isArray(r)?e(r).map(function(i){return n.push(i)}):(0,PM.default)(r)?(0,TM.default)(r,function(i,s){i===!0&&n.push(s),n.push(s+"-"+i)}):(0,CM.default)(r)&&n.push(r)}),n};Sl.default=AM;var Cl={};function MM(e,t){for(var n=-1,r=e==null?0:e.length;++n<r&&t(e[n],n,e)!==!1;);return e}var $M=MM,LM=Ms,IM=function(){try{var e=LM(Object,"defineProperty");return e({},"",{}),e}catch{}}(),DM=IM,lv=DM;function zM(e,t,n){t=="__proto__"&&lv?lv(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}var P1=zM,FM=P1,BM=$f,HM=Object.prototype,UM=HM.hasOwnProperty;function WM(e,t,n){var r=e[t];(!(UM.call(e,t)&&BM(r,n))||n===void 0&&!(t in e))&&FM(e,t,n)}var R1=WM,GM=R1,VM=P1;function qM(e,t,n,r){var i=!n;n||(n={});for(var s=-1,a=t.length;++s<a;){var l=t[s],c=r?r(n[l],e[l],l,n,e):void 0;c===void 0&&(c=e[l]),i?VM(n,l,c):GM(n,l,c)}return n}var Wd=qM,YM=Wd,XM=jl;function ZM(e,t){return e&&YM(t,XM(t),e)}var KM=ZM;function JM(e){var t=[];if(e!=null)for(var n in Object(e))t.push(n);return t}var QM=JM,e6=Zo,t6=Of,n6=QM,r6=Object.prototype,i6=r6.hasOwnProperty;function s6(e){if(!e6(e))return n6(e);var t=t6(e),n=[];for(var r in e)r=="constructor"&&(t||!i6.call(e,r))||n.push(r);return n}var o6=s6,a6=a1,l6=o6,c6=Ld;function d6(e){return c6(e)?a6(e,!0):l6(e)}var Uf=d6,u6=Wd,h6=Uf;function p6(e,t){return e&&u6(t,h6(t),e)}var f6=p6,cd={exports:{}};cd.exports;(function(e,t){var n=Vr,r=t&&!t.nodeType&&t,i=r&&!0&&e&&!e.nodeType&&e,s=i&&i.exports===r,a=s?n.Buffer:void 0,l=a?a.allocUnsafe:void 0;function c(d,u){if(u)return d.slice();var p=d.length,h=l?l(p):new d.constructor(p);return d.copy(h),h}e.exports=c})(cd,cd.exports);var m6=cd.exports;function g6(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}var v6=g6,y6=Wd,x6=zf;function b6(e,t){return y6(e,x6(e),t)}var w6=b6,_6=v1,S6=Mf,k6=zf,j6=x1,C6=Object.getOwnPropertySymbols,E6=C6?function(e){for(var t=[];e;)_6(t,k6(e)),e=S6(e);return t}:j6,O1=E6,T6=Wd,N6=O1;function P6(e,t){return T6(e,N6(e),t)}var R6=P6,O6=y1,A6=O1,M6=Uf;function $6(e){return O6(e,M6,A6)}var L6=$6,I6=Object.prototype,D6=I6.hasOwnProperty;function z6(e){var t=e.length,n=new e.constructor(t);return t&&typeof e[0]=="string"&&D6.call(e,"index")&&(n.index=e.index,n.input=e.input),n}var F6=z6,cv=g1;function B6(e){var t=new e.constructor(e.byteLength);return new cv(t).set(new cv(e)),t}var Wf=B6,H6=Wf;function U6(e,t){var n=t?H6(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}var W6=U6,G6=/\w*$/;function V6(e){var t=new e.constructor(e.source,G6.exec(e));return t.lastIndex=e.lastIndex,t}var q6=V6,dv=kl,uv=dv?dv.prototype:void 0,hv=uv?uv.valueOf:void 0;function Y6(e){return hv?Object(hv.call(e)):{}}var X6=Y6,Z6=Wf;function K6(e,t){var n=t?Z6(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}var J6=K6,Q6=Wf,e$=W6,t$=q6,n$=X6,r$=J6,i$="[object Boolean]",s$="[object Date]",o$="[object Map]",a$="[object Number]",l$="[object RegExp]",c$="[object Set]",d$="[object String]",u$="[object Symbol]",h$="[object ArrayBuffer]",p$="[object DataView]",f$="[object Float32Array]",m$="[object Float64Array]",g$="[object Int8Array]",v$="[object Int16Array]",y$="[object Int32Array]",x$="[object Uint8Array]",b$="[object Uint8ClampedArray]",w$="[object Uint16Array]",_$="[object Uint32Array]";function S$(e,t,n){var r=e.constructor;switch(t){case h$:return Q6(e);case i$:case s$:return new r(+e);case p$:return e$(e,n);case f$:case m$:case g$:case v$:case y$:case x$:case b$:case w$:case _$:return r$(e,n);case o$:return new r;case a$:case d$:return new r(e);case l$:return t$(e);case c$:return new r;case u$:return n$(e)}}var k$=S$,j$=Zo,pv=Object.create,C$=function(){function e(){}return function(t){if(!j$(t))return{};if(pv)return pv(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}(),E$=C$,T$=E$,N$=Mf,P$=Of;function R$(e){return typeof e.constructor=="function"&&!P$(e)?T$(N$(e)):{}}var O$=R$,A$=Bd,M$=pi,$$="[object Map]";function L$(e){return M$(e)&&A$(e)==$$}var I$=L$,D$=I$,z$=Pf,fv=Rf,mv=fv&&fv.isMap,F$=mv?z$(mv):D$,B$=F$,H$=Bd,U$=pi,W$="[object Set]";function G$(e){return U$(e)&&H$(e)==W$}var V$=G$,q$=V$,Y$=Pf,gv=Rf,vv=gv&&gv.isSet,X$=vv?Y$(vv):q$,Z$=X$,K$=Df,J$=$M,Q$=R1,eL=KM,tL=f6,nL=m6,rL=v6,iL=w6,sL=R6,oL=b1,aL=L6,lL=Bd,cL=F6,dL=k$,uL=O$,hL=Tr,pL=Tf,fL=B$,mL=Zo,gL=Z$,vL=jl,yL=Uf,xL=1,bL=2,wL=4,A1="[object Arguments]",_L="[object Array]",SL="[object Boolean]",kL="[object Date]",jL="[object Error]",M1="[object Function]",CL="[object GeneratorFunction]",EL="[object Map]",TL="[object Number]",$1="[object Object]",NL="[object RegExp]",PL="[object Set]",RL="[object String]",OL="[object Symbol]",AL="[object WeakMap]",ML="[object ArrayBuffer]",$L="[object DataView]",LL="[object Float32Array]",IL="[object Float64Array]",DL="[object Int8Array]",zL="[object Int16Array]",FL="[object Int32Array]",BL="[object Uint8Array]",HL="[object Uint8ClampedArray]",UL="[object Uint16Array]",WL="[object Uint32Array]",Et={};Et[A1]=Et[_L]=Et[ML]=Et[$L]=Et[SL]=Et[kL]=Et[LL]=Et[IL]=Et[DL]=Et[zL]=Et[FL]=Et[EL]=Et[TL]=Et[$1]=Et[NL]=Et[PL]=Et[RL]=Et[OL]=Et[BL]=Et[HL]=Et[UL]=Et[WL]=!0;Et[jL]=Et[M1]=Et[AL]=!1;function Ec(e,t,n,r,i,s){var a,l=t&xL,c=t&bL,d=t&wL;if(n&&(a=i?n(e,r,i,s):n(e)),a!==void 0)return a;if(!mL(e))return e;var u=hL(e);if(u){if(a=cL(e),!l)return rL(e,a)}else{var p=lL(e),h=p==M1||p==CL;if(pL(e))return nL(e,l);if(p==$1||p==A1||h&&!i){if(a=c||h?{}:uL(e),!l)return c?sL(e,tL(a,e)):iL(e,eL(a,e))}else{if(!Et[p])return i?e:{};a=dL(e,p,l)}}s||(s=new K$);var f=s.get(e);if(f)return f;s.set(e,a),gL(e)?e.forEach(function(x){a.add(Ec(x,t,n,x,e,s))}):fL(e)&&e.forEach(function(x,y){a.set(y,Ec(x,t,n,y,e,s))});var m=d?c?aL:oL:c?yL:vL,g=u?void 0:m(e);return J$(g||e,function(x,y){g&&(y=x,x=e[y]),Q$(a,y,Ec(x,t,n,y,e,s))}),a}var GL=Ec,VL=GL,qL=1,YL=4;function XL(e){return VL(e,qL|YL)}var ZL=XL;Object.defineProperty(Cl,"__esModule",{value:!0});Cl.mergeClasses=void 0;var KL=Af,JL=L1(KL),QL=ZL,eI=L1(QL),tI=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function L1(e){return e&&e.__esModule?e:{default:e}}var nI=Cl.mergeClasses=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=t.default&&(0,eI.default)(t.default)||{};return n.map(function(i){var s=t[i];return s&&(0,JL.default)(s,function(a,l){r[l]||(r[l]={}),r[l]=tI({},r[l],s[l])}),i}),r};Cl.default=nI;var El={};Object.defineProperty(El,"__esModule",{value:!0});El.autoprefix=void 0;var rI=Af,yv=sI(rI),iI=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function sI(e){return e&&e.__esModule?e:{default:e}}var oI={borderRadius:function(t){return{msBorderRadius:t,MozBorderRadius:t,OBorderRadius:t,WebkitBorderRadius:t,borderRadius:t}},boxShadow:function(t){return{msBoxShadow:t,MozBoxShadow:t,OBoxShadow:t,WebkitBoxShadow:t,boxShadow:t}},userSelect:function(t){return{WebkitTouchCallout:t,KhtmlUserSelect:t,MozUserSelect:t,msUserSelect:t,WebkitUserSelect:t,userSelect:t}},flex:function(t){return{WebkitBoxFlex:t,MozBoxFlex:t,WebkitFlex:t,msFlex:t,flex:t}},flexBasis:function(t){return{WebkitFlexBasis:t,flexBasis:t}},justifyContent:function(t){return{WebkitJustifyContent:t,justifyContent:t}},transition:function(t){return{msTransition:t,MozTransition:t,OTransition:t,WebkitTransition:t,transition:t}},transform:function(t){return{msTransform:t,MozTransform:t,OTransform:t,WebkitTransform:t,transform:t}},absolute:function(t){var n=t&&t.split(" ");return{position:"absolute",top:n&&n[0],right:n&&n[1],bottom:n&&n[2],left:n&&n[3]}},extend:function(t,n){var r=n[t];return r||{extend:t}}},aI=El.autoprefix=function(t){var n={};return(0,yv.default)(t,function(r,i){var s={};(0,yv.default)(r,function(a,l){var c=oI[l];c?s=iI({},s,c(a)):s[l]=a}),n[i]=s}),n};El.default=aI;var Tl={};Object.defineProperty(Tl,"__esModule",{value:!0});Tl.hover=void 0;var lI=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},cI=R,Wu=dI(cI);function dI(e){return e&&e.__esModule?e:{default:e}}function uI(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xv(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e}function hI(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var pI=Tl.hover=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"span";return function(r){hI(i,r);function i(){var s,a,l,c;uI(this,i);for(var d=arguments.length,u=Array(d),p=0;p<d;p++)u[p]=arguments[p];return c=(a=(l=xv(this,(s=i.__proto__||Object.getPrototypeOf(i)).call.apply(s,[this].concat(u))),l),l.state={hover:!1},l.handleMouseOver=function(){return l.setState({hover:!0})},l.handleMouseOut=function(){return l.setState({hover:!1})},l.render=function(){return Wu.default.createElement(n,{onMouseOver:l.handleMouseOver,onMouseOut:l.handleMouseOut},Wu.default.createElement(t,lI({},l.props,l.state)))},a),xv(l,c)}return i}(Wu.default.Component)};Tl.default=pI;var Nl={};Object.defineProperty(Nl,"__esModule",{value:!0});Nl.active=void 0;var fI=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},mI=R,Gu=gI(mI);function gI(e){return e&&e.__esModule?e:{default:e}}function vI(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bv(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e}function yI(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var xI=Nl.active=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"span";return function(r){yI(i,r);function i(){var s,a,l,c;vI(this,i);for(var d=arguments.length,u=Array(d),p=0;p<d;p++)u[p]=arguments[p];return c=(a=(l=bv(this,(s=i.__proto__||Object.getPrototypeOf(i)).call.apply(s,[this].concat(u))),l),l.state={active:!1},l.handleMouseDown=function(){return l.setState({active:!0})},l.handleMouseUp=function(){return l.setState({active:!1})},l.render=function(){return Gu.default.createElement(n,{onMouseDown:l.handleMouseDown,onMouseUp:l.handleMouseUp},Gu.default.createElement(t,fI({},l.props,l.state)))},a),bv(l,c)}return i}(Gu.default.Component)};Nl.default=xI;var Gf={};Object.defineProperty(Gf,"__esModule",{value:!0});var bI=function(t,n){var r={},i=function(a){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;r[a]=l};return t===0&&i("first-child"),t===n-1&&i("last-child"),(t===0||t%2===0)&&i("even"),Math.abs(t%2)===1&&i("odd"),i("nth-child",t),r};Gf.default=bI;Object.defineProperty(cr,"__esModule",{value:!0});cr.ReactCSS=cr.loop=cr.handleActive=Vf=cr.handleHover=cr.hover=void 0;var wI=Sl,_I=na(wI),SI=Cl,kI=na(SI),jI=El,CI=na(jI),EI=Tl,I1=na(EI),TI=Nl,NI=na(TI),PI=Gf,RI=na(PI);function na(e){return e&&e.__esModule?e:{default:e}}cr.hover=I1.default;var Vf=cr.handleHover=I1.default;cr.handleActive=NI.default;cr.loop=RI.default;var OI=cr.ReactCSS=function(t){for(var n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var s=(0,_I.default)(r),a=(0,kI.default)(t,s);return(0,CI.default)(a)},rt=cr.default=OI,AI=function(t,n,r,i,s){var a=s.clientWidth,l=s.clientHeight,c=typeof t.pageX=="number"?t.pageX:t.touches[0].pageX,d=typeof t.pageY=="number"?t.pageY:t.touches[0].pageY,u=c-(s.getBoundingClientRect().left+window.pageXOffset),p=d-(s.getBoundingClientRect().top+window.pageYOffset);if(r==="vertical"){var h=void 0;if(p<0?h=0:p>l?h=1:h=Math.round(p*100/l)/100,n.a!==h)return{h:n.h,s:n.s,l:n.l,a:h,source:"rgb"}}else{var f=void 0;if(u<0?f=0:u>a?f=1:f=Math.round(u*100/a)/100,i!==f)return{h:n.h,s:n.s,l:n.l,a:f,source:"rgb"}}return null},Vu={},MI=function(t,n,r,i){if(typeof document>"u"&&!i)return null;var s=i?new i:document.createElement("canvas");s.width=r*2,s.height=r*2;var a=s.getContext("2d");return a?(a.fillStyle=t,a.fillRect(0,0,s.width,s.height),a.fillStyle=n,a.fillRect(0,0,r,r),a.translate(r,r),a.fillRect(0,0,r,r),s.toDataURL()):null},$I=function(t,n,r,i){var s=t+"-"+n+"-"+r+(i?"-server":"");if(Vu[s])return Vu[s];var a=MI(t,n,r,i);return Vu[s]=a,a},wv=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ra=function(t){var n=t.white,r=t.grey,i=t.size,s=t.renderers,a=t.borderRadius,l=t.boxShadow,c=t.children,d=rt({default:{grid:{borderRadius:a,boxShadow:l,absolute:"0px 0px 0px 0px",background:"url("+$I(n,r,i,s.canvas)+") center left"}}});return R.isValidElement(c)?L.cloneElement(c,wv({},c.props,{style:wv({},c.props.style,d.grid)})):L.createElement("div",{style:d.grid})};ra.defaultProps={size:8,white:"transparent",grey:"rgba(0,0,0,.08)",renderers:{}};var LI=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},II=function(){function e(t,n){for(var r=0;r<n.length;r++){var i=n[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function DI(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _v(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e}function zI(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var qf=function(e){zI(t,e);function t(){var n,r,i,s;DI(this,t);for(var a=arguments.length,l=Array(a),c=0;c<a;c++)l[c]=arguments[c];return s=(r=(i=_v(this,(n=t.__proto__||Object.getPrototypeOf(t)).call.apply(n,[this].concat(l))),i),i.handleChange=function(d){var u=AI(d,i.props.hsl,i.props.direction,i.props.a,i.container);u&&typeof i.props.onChange=="function"&&i.props.onChange(u,d)},i.handleMouseDown=function(d){i.handleChange(d),window.addEventListener("mousemove",i.handleChange),window.addEventListener("mouseup",i.handleMouseUp)},i.handleMouseUp=function(){i.unbindEventListeners()},i.unbindEventListeners=function(){window.removeEventListener("mousemove",i.handleChange),window.removeEventListener("mouseup",i.handleMouseUp)},r),_v(i,s)}return II(t,[{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"render",value:function(){var r=this,i=this.props.rgb,s=rt({default:{alpha:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius},checkboard:{absolute:"0px 0px 0px 0px",overflow:"hidden",borderRadius:this.props.radius},gradient:{absolute:"0px 0px 0px 0px",background:"linear-gradient(to right, rgba("+i.r+","+i.g+","+i.b+`, 0) 0%,
           rgba(`+i.r+","+i.g+","+i.b+", 1) 100%)",boxShadow:this.props.shadow,borderRadius:this.props.radius},container:{position:"relative",height:"100%",margin:"0 3px"},pointer:{position:"absolute",left:i.a*100+"%"},slider:{width:"4px",borderRadius:"1px",height:"8px",boxShadow:"0 0 2px rgba(0, 0, 0, .6)",background:"#fff",marginTop:"1px",transform:"translateX(-2px)"}},vertical:{gradient:{background:"linear-gradient(to bottom, rgba("+i.r+","+i.g+","+i.b+`, 0) 0%,
           rgba(`+i.r+","+i.g+","+i.b+", 1) 100%)"},pointer:{left:0,top:i.a*100+"%"}},overwrite:LI({},this.props.style)},{vertical:this.props.direction==="vertical",overwrite:!0});return L.createElement("div",{style:s.alpha},L.createElement("div",{style:s.checkboard},L.createElement(ra,{renderers:this.props.renderers})),L.createElement("div",{style:s.gradient}),L.createElement("div",{style:s.container,ref:function(l){return r.container=l},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},L.createElement("div",{style:s.pointer},this.props.pointer?L.createElement(this.props.pointer,this.props):L.createElement("div",{style:s.slider}))))}}]),t}(R.PureComponent||R.Component),FI=function(){function e(t,n){for(var r=0;r<n.length;r++){var i=n[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function BI(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function HI(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UI(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e}function WI(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var GI=1,D1=38,VI=40,qI=[D1,VI],YI=function(t){return qI.indexOf(t)>-1},XI=function(t){return Number(String(t).replace(/%/g,""))},ZI=1,ut=function(e){WI(t,e);function t(n){HI(this,t);var r=UI(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.handleBlur=function(){r.state.blurValue&&r.setState({value:r.state.blurValue,blurValue:null})},r.handleChange=function(i){r.setUpdatedValue(i.target.value,i)},r.handleKeyDown=function(i){var s=XI(i.target.value);if(!isNaN(s)&&YI(i.keyCode)){var a=r.getArrowOffset(),l=i.keyCode===D1?s+a:s-a;r.setUpdatedValue(l,i)}},r.handleDrag=function(i){if(r.props.dragLabel){var s=Math.round(r.props.value+i.movementX);s>=0&&s<=r.props.dragMax&&r.props.onChange&&r.props.onChange(r.getValueObjectWithLabel(s),i)}},r.handleMouseDown=function(i){r.props.dragLabel&&(i.preventDefault(),r.handleDrag(i),window.addEventListener("mousemove",r.handleDrag),window.addEventListener("mouseup",r.handleMouseUp))},r.handleMouseUp=function(){r.unbindEventListeners()},r.unbindEventListeners=function(){window.removeEventListener("mousemove",r.handleDrag),window.removeEventListener("mouseup",r.handleMouseUp)},r.state={value:String(n.value).toUpperCase(),blurValue:String(n.value).toUpperCase()},r.inputId="rc-editable-input-"+ZI++,r}return FI(t,[{key:"componentDidUpdate",value:function(r,i){this.props.value!==this.state.value&&(r.value!==this.props.value||i.value!==this.state.value)&&(this.input===document.activeElement?this.setState({blurValue:String(this.props.value).toUpperCase()}):this.setState({value:String(this.props.value).toUpperCase(),blurValue:!this.state.blurValue&&String(this.props.value).toUpperCase()}))}},{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"getValueObjectWithLabel",value:function(r){return BI({},this.props.label,r)}},{key:"getArrowOffset",value:function(){return this.props.arrowOffset||GI}},{key:"setUpdatedValue",value:function(r,i){var s=this.props.label?this.getValueObjectWithLabel(r):r;this.props.onChange&&this.props.onChange(s,i),this.setState({value:r})}},{key:"render",value:function(){var r=this,i=rt({default:{wrap:{position:"relative"}},"user-override":{wrap:this.props.style&&this.props.style.wrap?this.props.style.wrap:{},input:this.props.style&&this.props.style.input?this.props.style.input:{},label:this.props.style&&this.props.style.label?this.props.style.label:{}},"dragLabel-true":{label:{cursor:"ew-resize"}}},{"user-override":!0},this.props);return L.createElement("div",{style:i.wrap},L.createElement("input",{id:this.inputId,style:i.input,ref:function(a){return r.input=a},value:this.state.value,onKeyDown:this.handleKeyDown,onChange:this.handleChange,onBlur:this.handleBlur,placeholder:this.props.placeholder,spellCheck:"false"}),this.props.label&&!this.props.hideLabel?L.createElement("label",{htmlFor:this.inputId,style:i.label,onMouseDown:this.handleMouseDown},this.props.label):null)}}]),t}(R.PureComponent||R.Component),KI=function(t,n,r,i){var s=i.clientWidth,a=i.clientHeight,l=typeof t.pageX=="number"?t.pageX:t.touches[0].pageX,c=typeof t.pageY=="number"?t.pageY:t.touches[0].pageY,d=l-(i.getBoundingClientRect().left+window.pageXOffset),u=c-(i.getBoundingClientRect().top+window.pageYOffset);if(n==="vertical"){var p=void 0;if(u<0)p=359;else if(u>a)p=0;else{var h=-(u*100/a)+100;p=360*h/100}if(r.h!==p)return{h:p,s:r.s,l:r.l,a:r.a,source:"hsl"}}else{var f=void 0;if(d<0)f=0;else if(d>s)f=359;else{var m=d*100/s;f=360*m/100}if(r.h!==f)return{h:f,s:r.s,l:r.l,a:r.a,source:"hsl"}}return null},JI=function(){function e(t,n){for(var r=0;r<n.length;r++){var i=n[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function QI(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Sv(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e}function eD(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var ia=function(e){eD(t,e);function t(){var n,r,i,s;QI(this,t);for(var a=arguments.length,l=Array(a),c=0;c<a;c++)l[c]=arguments[c];return s=(r=(i=Sv(this,(n=t.__proto__||Object.getPrototypeOf(t)).call.apply(n,[this].concat(l))),i),i.handleChange=function(d){var u=KI(d,i.props.direction,i.props.hsl,i.container);u&&typeof i.props.onChange=="function"&&i.props.onChange(u,d)},i.handleMouseDown=function(d){i.handleChange(d),window.addEventListener("mousemove",i.handleChange),window.addEventListener("mouseup",i.handleMouseUp)},i.handleMouseUp=function(){i.unbindEventListeners()},r),Sv(i,s)}return JI(t,[{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"unbindEventListeners",value:function(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}},{key:"render",value:function(){var r=this,i=this.props.direction,s=i===void 0?"horizontal":i,a=rt({default:{hue:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius,boxShadow:this.props.shadow},container:{padding:"0 2px",position:"relative",height:"100%",borderRadius:this.props.radius},pointer:{position:"absolute",left:this.props.hsl.h*100/360+"%"},slider:{marginTop:"1px",width:"4px",borderRadius:"1px",height:"8px",boxShadow:"0 0 2px rgba(0, 0, 0, .6)",background:"#fff",transform:"translateX(-2px)"}},vertical:{pointer:{left:"0px",top:-(this.props.hsl.h*100/360)+100+"%"}}},{vertical:s==="vertical"});return L.createElement("div",{style:a.hue},L.createElement("div",{className:"hue-"+s,style:a.container,ref:function(c){return r.container=c},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},L.createElement("style",null,`
            .hue-horizontal {
              background: linear-gradient(to right, #f00 0%, #ff0 17%, #0f0
                33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
              background: -webkit-linear-gradient(to right, #f00 0%, #ff0
                17%, #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
            }

            .hue-vertical {
              background: linear-gradient(to top, #f00 0%, #ff0 17%, #0f0 33%,
                #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
              background: -webkit-linear-gradient(to top, #f00 0%, #ff0 17%,
                #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
            }
          `),L.createElement("div",{style:a.pointer},this.props.pointer?L.createElement(this.props.pointer,this.props):L.createElement("div",{style:a.slider}))))}}]),t}(R.PureComponent||R.Component),z1={exports:{}},tD="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",nD=tD,rD=nD;function F1(){}function B1(){}B1.resetWarningCache=F1;var iD=function(){function e(r,i,s,a,l,c){if(c!==rD){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}e.isRequired=e;function t(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:B1,resetWarningCache:F1};return n.PropTypes=n,n};z1.exports=iD();var sD=z1.exports;const Oe=gd(sD);function oD(){this.__data__=[],this.size=0}function Pl(e,t){return e===t||e!==e&&t!==t}function Gd(e,t){for(var n=e.length;n--;)if(Pl(e[n][0],t))return n;return-1}var aD=Array.prototype,lD=aD.splice;function cD(e){var t=this.__data__,n=Gd(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():lD.call(t,n,1),--this.size,!0}function dD(e){var t=this.__data__,n=Gd(t,e);return n<0?void 0:t[n][1]}function uD(e){return Gd(this.__data__,e)>-1}function hD(e,t){var n=this.__data__,r=Gd(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}function fi(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}fi.prototype.clear=oD;fi.prototype.delete=cD;fi.prototype.get=dD;fi.prototype.has=uD;fi.prototype.set=hD;function pD(){this.__data__=new fi,this.size=0}function fD(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function mD(e){return this.__data__.get(e)}function gD(e){return this.__data__.has(e)}var H1=typeof global=="object"&&global&&global.Object===Object&&global,vD=typeof self=="object"&&self&&self.Object===Object&&self,Nr=H1||vD||Function("return this")(),qi=Nr.Symbol,U1=Object.prototype,yD=U1.hasOwnProperty,xD=U1.toString,wa=qi?qi.toStringTag:void 0;function bD(e){var t=yD.call(e,wa),n=e[wa];try{e[wa]=void 0;var r=!0}catch{}var i=xD.call(e);return r&&(t?e[wa]=n:delete e[wa]),i}var wD=Object.prototype,_D=wD.toString;function SD(e){return _D.call(e)}var kD="[object Null]",jD="[object Undefined]",kv=qi?qi.toStringTag:void 0;function $s(e){return e==null?e===void 0?jD:kD:kv&&kv in Object(e)?bD(e):SD(e)}function fr(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var CD="[object AsyncFunction]",ED="[object Function]",TD="[object GeneratorFunction]",ND="[object Proxy]";function Yf(e){if(!fr(e))return!1;var t=$s(e);return t==ED||t==TD||t==CD||t==ND}var qu=Nr["__core-js_shared__"],jv=function(){var e=/[^.]+$/.exec(qu&&qu.keys&&qu.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function PD(e){return!!jv&&jv in e}var RD=Function.prototype,OD=RD.toString;function Ls(e){if(e!=null){try{return OD.call(e)}catch{}try{return e+""}catch{}}return""}var AD=/[\\^$.*+?()[\]{}|]/g,MD=/^\[object .+?Constructor\]$/,$D=Function.prototype,LD=Object.prototype,ID=$D.toString,DD=LD.hasOwnProperty,zD=RegExp("^"+ID.call(DD).replace(AD,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function FD(e){if(!fr(e)||PD(e))return!1;var t=Yf(e)?zD:MD;return t.test(Ls(e))}function BD(e,t){return e==null?void 0:e[t]}function Is(e,t){var n=BD(e,t);return FD(n)?n:void 0}var fl=Is(Nr,"Map"),ml=Is(Object,"create");function HD(){this.__data__=ml?ml(null):{},this.size=0}function UD(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var WD="__lodash_hash_undefined__",GD=Object.prototype,VD=GD.hasOwnProperty;function qD(e){var t=this.__data__;if(ml){var n=t[e];return n===WD?void 0:n}return VD.call(t,e)?t[e]:void 0}var YD=Object.prototype,XD=YD.hasOwnProperty;function ZD(e){var t=this.__data__;return ml?t[e]!==void 0:XD.call(t,e)}var KD="__lodash_hash_undefined__";function JD(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=ml&&t===void 0?KD:t,this}function Ps(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Ps.prototype.clear=HD;Ps.prototype.delete=UD;Ps.prototype.get=qD;Ps.prototype.has=ZD;Ps.prototype.set=JD;function QD(){this.size=0,this.__data__={hash:new Ps,map:new(fl||fi),string:new Ps}}function e8(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function Vd(e,t){var n=e.__data__;return e8(t)?n[typeof t=="string"?"string":"hash"]:n.map}function t8(e){var t=Vd(this,e).delete(e);return this.size-=t?1:0,t}function n8(e){return Vd(this,e).get(e)}function r8(e){return Vd(this,e).has(e)}function i8(e,t){var n=Vd(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}function mi(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}mi.prototype.clear=QD;mi.prototype.delete=t8;mi.prototype.get=n8;mi.prototype.has=r8;mi.prototype.set=i8;var s8=200;function o8(e,t){var n=this.__data__;if(n instanceof fi){var r=n.__data__;if(!fl||r.length<s8-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new mi(r)}return n.set(e,t),this.size=n.size,this}function Gr(e){var t=this.__data__=new fi(e);this.size=t.size}Gr.prototype.clear=pD;Gr.prototype.delete=fD;Gr.prototype.get=mD;Gr.prototype.has=gD;Gr.prototype.set=o8;var dd=function(){try{var e=Is(Object,"defineProperty");return e({},"",{}),e}catch{}}();function Xf(e,t,n){t=="__proto__"&&dd?dd(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function dp(e,t,n){(n!==void 0&&!Pl(e[t],n)||n===void 0&&!(t in e))&&Xf(e,t,n)}function a8(e){return function(t,n,r){for(var i=-1,s=Object(t),a=r(t),l=a.length;l--;){var c=a[++i];if(n(s[c],c,s)===!1)break}return t}}var W1=a8(),G1=typeof Xn=="object"&&Xn&&!Xn.nodeType&&Xn,Cv=G1&&typeof Zn=="object"&&Zn&&!Zn.nodeType&&Zn,l8=Cv&&Cv.exports===G1,Ev=l8?Nr.Buffer:void 0;Ev&&Ev.allocUnsafe;function c8(e,t){return e.slice()}var ud=Nr.Uint8Array;function d8(e){var t=new e.constructor(e.byteLength);return new ud(t).set(new ud(e)),t}function u8(e,t){var n=d8(e.buffer);return new e.constructor(n,e.byteOffset,e.length)}function h8(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}var Tv=Object.create,p8=function(){function e(){}return function(t){if(!fr(t))return{};if(Tv)return Tv(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function V1(e,t){return function(n){return e(t(n))}}var q1=V1(Object.getPrototypeOf,Object),f8=Object.prototype;function Zf(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||f8;return e===n}function m8(e){return typeof e.constructor=="function"&&!Zf(e)?p8(q1(e)):{}}function Yi(e){return e!=null&&typeof e=="object"}var g8="[object Arguments]";function Nv(e){return Yi(e)&&$s(e)==g8}var Y1=Object.prototype,v8=Y1.hasOwnProperty,y8=Y1.propertyIsEnumerable,hd=Nv(function(){return arguments}())?Nv:function(e){return Yi(e)&&v8.call(e,"callee")&&!y8.call(e,"callee")},Qn=Array.isArray,x8=9007199254740991;function Kf(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=x8}function sa(e){return e!=null&&Kf(e.length)&&!Yf(e)}function b8(e){return Yi(e)&&sa(e)}function w8(){return!1}var X1=typeof Xn=="object"&&Xn&&!Xn.nodeType&&Xn,Pv=X1&&typeof Zn=="object"&&Zn&&!Zn.nodeType&&Zn,_8=Pv&&Pv.exports===X1,Rv=_8?Nr.Buffer:void 0,S8=Rv?Rv.isBuffer:void 0,pd=S8||w8,k8="[object Object]",j8=Function.prototype,C8=Object.prototype,Z1=j8.toString,E8=C8.hasOwnProperty,T8=Z1.call(Object);function N8(e){if(!Yi(e)||$s(e)!=k8)return!1;var t=q1(e);if(t===null)return!0;var n=E8.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&Z1.call(n)==T8}var P8="[object Arguments]",R8="[object Array]",O8="[object Boolean]",A8="[object Date]",M8="[object Error]",$8="[object Function]",L8="[object Map]",I8="[object Number]",D8="[object Object]",z8="[object RegExp]",F8="[object Set]",B8="[object String]",H8="[object WeakMap]",U8="[object ArrayBuffer]",W8="[object DataView]",G8="[object Float32Array]",V8="[object Float64Array]",q8="[object Int8Array]",Y8="[object Int16Array]",X8="[object Int32Array]",Z8="[object Uint8Array]",K8="[object Uint8ClampedArray]",J8="[object Uint16Array]",Q8="[object Uint32Array]",At={};At[G8]=At[V8]=At[q8]=At[Y8]=At[X8]=At[Z8]=At[K8]=At[J8]=At[Q8]=!0;At[P8]=At[R8]=At[U8]=At[O8]=At[W8]=At[A8]=At[M8]=At[$8]=At[L8]=At[I8]=At[D8]=At[z8]=At[F8]=At[B8]=At[H8]=!1;function ez(e){return Yi(e)&&Kf(e.length)&&!!At[$s(e)]}function tz(e){return function(t){return e(t)}}var K1=typeof Xn=="object"&&Xn&&!Xn.nodeType&&Xn,Va=K1&&typeof Zn=="object"&&Zn&&!Zn.nodeType&&Zn,nz=Va&&Va.exports===K1,Yu=nz&&H1.process,Ov=function(){try{var e=Va&&Va.require&&Va.require("util").types;return e||Yu&&Yu.binding&&Yu.binding("util")}catch{}}(),Av=Ov&&Ov.isTypedArray,Jf=Av?tz(Av):ez;function up(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var rz=Object.prototype,iz=rz.hasOwnProperty;function sz(e,t,n){var r=e[t];(!(iz.call(e,t)&&Pl(r,n))||n===void 0&&!(t in e))&&Xf(e,t,n)}function oz(e,t,n,r){var i=!n;n||(n={});for(var s=-1,a=t.length;++s<a;){var l=t[s],c=void 0;c===void 0&&(c=e[l]),i?Xf(n,l,c):sz(n,l,c)}return n}function az(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}var lz=9007199254740991,cz=/^(?:0|[1-9]\d*)$/;function Qf(e,t){var n=typeof e;return t=t??lz,!!t&&(n=="number"||n!="symbol"&&cz.test(e))&&e>-1&&e%1==0&&e<t}var dz=Object.prototype,uz=dz.hasOwnProperty;function J1(e,t){var n=Qn(e),r=!n&&hd(e),i=!n&&!r&&pd(e),s=!n&&!r&&!i&&Jf(e),a=n||r||i||s,l=a?az(e.length,String):[],c=l.length;for(var d in e)(t||uz.call(e,d))&&!(a&&(d=="length"||i&&(d=="offset"||d=="parent")||s&&(d=="buffer"||d=="byteLength"||d=="byteOffset")||Qf(d,c)))&&l.push(d);return l}function hz(e){var t=[];if(e!=null)for(var n in Object(e))t.push(n);return t}var pz=Object.prototype,fz=pz.hasOwnProperty;function mz(e){if(!fr(e))return hz(e);var t=Zf(e),n=[];for(var r in e)r=="constructor"&&(t||!fz.call(e,r))||n.push(r);return n}function Q1(e){return sa(e)?J1(e,!0):mz(e)}function gz(e){return oz(e,Q1(e))}function vz(e,t,n,r,i,s,a){var l=up(e,n),c=up(t,n),d=a.get(c);if(d){dp(e,n,d);return}var u=s?s(l,c,n+"",e,t,a):void 0,p=u===void 0;if(p){var h=Qn(c),f=!h&&pd(c),m=!h&&!f&&Jf(c);u=c,h||f||m?Qn(l)?u=l:b8(l)?u=h8(l):f?(p=!1,u=c8(c)):m?(p=!1,u=u8(c)):u=[]:N8(c)||hd(c)?(u=l,hd(l)?u=gz(l):(!fr(l)||Yf(l))&&(u=m8(c))):p=!1}p&&(a.set(c,u),i(u,c,r,s,a),a.delete(c)),dp(e,n,u)}function e_(e,t,n,r,i){e!==t&&W1(t,function(s,a){if(i||(i=new Gr),fr(s))vz(e,t,a,n,e_,r,i);else{var l=r?r(up(e,a),s,a+"",e,t,i):void 0;l===void 0&&(l=s),dp(e,a,l)}},Q1)}function qd(e){return e}function yz(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}var Mv=Math.max;function xz(e,t,n){return t=Mv(t===void 0?e.length-1:t,0),function(){for(var r=arguments,i=-1,s=Mv(r.length-t,0),a=Array(s);++i<s;)a[i]=r[t+i];i=-1;for(var l=Array(t+1);++i<t;)l[i]=r[i];return l[t]=n(a),yz(e,this,l)}}function bz(e){return function(){return e}}var wz=dd?function(e,t){return dd(e,"toString",{configurable:!0,enumerable:!1,value:bz(t),writable:!0})}:qd,_z=800,Sz=16,kz=Date.now;function jz(e){var t=0,n=0;return function(){var r=kz(),i=Sz-(r-n);if(n=r,i>0){if(++t>=_z)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var Cz=jz(wz);function Ez(e,t){return Cz(xz(e,t,qd),e+"")}function Tz(e,t,n){if(!fr(n))return!1;var r=typeof t;return(r=="number"?sa(n)&&Qf(t,n.length):r=="string"&&t in n)?Pl(n[t],e):!1}function Nz(e){return Ez(function(t,n){var r=-1,i=n.length,s=i>1?n[i-1]:void 0,a=i>2?n[2]:void 0;for(s=e.length>3&&typeof s=="function"?(i--,s):void 0,a&&Tz(n[0],n[1],a)&&(s=i<3?void 0:s,i=1),t=Object(t);++r<i;){var l=n[r];l&&e(t,l,r,s)}return t})}var In=Nz(function(e,t,n){e_(e,t,n)}),Rl=function(t){var n=t.zDepth,r=t.radius,i=t.background,s=t.children,a=t.styles,l=a===void 0?{}:a,c=rt(In({default:{wrap:{position:"relative",display:"inline-block"},content:{position:"relative"},bg:{absolute:"0px 0px 0px 0px",boxShadow:"0 "+n+"px "+n*4+"px rgba(0,0,0,.24)",borderRadius:r,background:i}},"zDepth-0":{bg:{boxShadow:"none"}},"zDepth-1":{bg:{boxShadow:"0 2px 10px rgba(0,0,0,.12), 0 2px 5px rgba(0,0,0,.16)"}},"zDepth-2":{bg:{boxShadow:"0 6px 20px rgba(0,0,0,.19), 0 8px 17px rgba(0,0,0,.2)"}},"zDepth-3":{bg:{boxShadow:"0 17px 50px rgba(0,0,0,.19), 0 12px 15px rgba(0,0,0,.24)"}},"zDepth-4":{bg:{boxShadow:"0 25px 55px rgba(0,0,0,.21), 0 16px 28px rgba(0,0,0,.22)"}},"zDepth-5":{bg:{boxShadow:"0 40px 77px rgba(0,0,0,.22), 0 27px 24px rgba(0,0,0,.2)"}},square:{bg:{borderRadius:"0"}},circle:{bg:{borderRadius:"50%"}}},l),{"zDepth-1":n===1});return L.createElement("div",{style:c.wrap},L.createElement("div",{style:c.bg}),L.createElement("div",{style:c.content},s))};Rl.propTypes={background:Oe.string,zDepth:Oe.oneOf([0,1,2,3,4,5]),radius:Oe.number,styles:Oe.object};Rl.defaultProps={background:"#fff",zDepth:1,radius:2,styles:{}};var Xu=function(){return Nr.Date.now()},Pz=/\s/;function Rz(e){for(var t=e.length;t--&&Pz.test(e.charAt(t)););return t}var Oz=/^\s+/;function Az(e){return e&&e.slice(0,Rz(e)+1).replace(Oz,"")}var Mz="[object Symbol]";function Yd(e){return typeof e=="symbol"||Yi(e)&&$s(e)==Mz}var $v=NaN,$z=/^[-+]0x[0-9a-f]+$/i,Lz=/^0b[01]+$/i,Iz=/^0o[0-7]+$/i,Dz=parseInt;function Lv(e){if(typeof e=="number")return e;if(Yd(e))return $v;if(fr(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=fr(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Az(e);var n=Lz.test(e);return n||Iz.test(e)?Dz(e.slice(2),n?2:8):$z.test(e)?$v:+e}var zz="Expected a function",Fz=Math.max,Bz=Math.min;function t_(e,t,n){var r,i,s,a,l,c,d=0,u=!1,p=!1,h=!0;if(typeof e!="function")throw new TypeError(zz);t=Lv(t)||0,fr(n)&&(u=!!n.leading,p="maxWait"in n,s=p?Fz(Lv(n.maxWait)||0,t):s,h="trailing"in n?!!n.trailing:h);function f(_){var j=r,E=i;return r=i=void 0,d=_,a=e.apply(E,j),a}function m(_){return d=_,l=setTimeout(y,t),u?f(_):a}function g(_){var j=_-c,E=_-d,T=t-j;return p?Bz(T,s-E):T}function x(_){var j=_-c,E=_-d;return c===void 0||j>=t||j<0||p&&E>=s}function y(){var _=Xu();if(x(_))return v(_);l=setTimeout(y,g(_))}function v(_){return l=void 0,h&&r?f(_):(r=i=void 0,a)}function b(){l!==void 0&&clearTimeout(l),d=0,r=c=i=l=void 0}function w(){return l===void 0?a:v(Xu())}function C(){var _=Xu(),j=x(_);if(r=arguments,i=this,c=_,j){if(l===void 0)return m(c);if(p)return clearTimeout(l),l=setTimeout(y,t),f(c)}return l===void 0&&(l=setTimeout(y,t)),a}return C.cancel=b,C.flush=w,C}var Hz="Expected a function";function Uz(e,t,n){var r=!0,i=!0;if(typeof e!="function")throw new TypeError(Hz);return fr(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),t_(e,t,{leading:r,maxWait:t,trailing:i})}var Wz=function(t,n,r){var i=r.getBoundingClientRect(),s=i.width,a=i.height,l=typeof t.pageX=="number"?t.pageX:t.touches[0].pageX,c=typeof t.pageY=="number"?t.pageY:t.touches[0].pageY,d=l-(r.getBoundingClientRect().left+window.pageXOffset),u=c-(r.getBoundingClientRect().top+window.pageYOffset);d<0?d=0:d>s&&(d=s),u<0?u=0:u>a&&(u=a);var p=d/s,h=1-u/a;return{h:n.h,s:p,v:h,a:n.a,source:"hsv"}},Gz=function(){function e(t,n){for(var r=0;r<n.length;r++){var i=n[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function Vz(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qz(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e}function Yz(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var Xd=function(e){Yz(t,e);function t(n){Vz(this,t);var r=qz(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return r.handleChange=function(i){typeof r.props.onChange=="function"&&r.throttle(r.props.onChange,Wz(i,r.props.hsl,r.container),i)},r.handleMouseDown=function(i){r.handleChange(i);var s=r.getContainerRenderWindow();s.addEventListener("mousemove",r.handleChange),s.addEventListener("mouseup",r.handleMouseUp)},r.handleMouseUp=function(){r.unbindEventListeners()},r.throttle=Uz(function(i,s,a){i(s,a)},50),r}return Gz(t,[{key:"componentWillUnmount",value:function(){this.throttle.cancel(),this.unbindEventListeners()}},{key:"getContainerRenderWindow",value:function(){for(var r=this.container,i=window;!i.document.contains(r)&&i.parent!==i;)i=i.parent;return i}},{key:"unbindEventListeners",value:function(){var r=this.getContainerRenderWindow();r.removeEventListener("mousemove",this.handleChange),r.removeEventListener("mouseup",this.handleMouseUp)}},{key:"render",value:function(){var r=this,i=this.props.style||{},s=i.color,a=i.white,l=i.black,c=i.pointer,d=i.circle,u=rt({default:{color:{absolute:"0px 0px 0px 0px",background:"hsl("+this.props.hsl.h+",100%, 50%)",borderRadius:this.props.radius},white:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius},black:{absolute:"0px 0px 0px 0px",boxShadow:this.props.shadow,borderRadius:this.props.radius},pointer:{position:"absolute",top:-(this.props.hsv.v*100)+100+"%",left:this.props.hsv.s*100+"%",cursor:"default"},circle:{width:"4px",height:"4px",boxShadow:`0 0 0 1.5px #fff, inset 0 0 1px 1px rgba(0,0,0,.3),
            0 0 1px 2px rgba(0,0,0,.4)`,borderRadius:"50%",cursor:"hand",transform:"translate(-2px, -2px)"}},custom:{color:s,white:a,black:l,pointer:c,circle:d}},{custom:!!this.props.style});return L.createElement("div",{style:u.color,ref:function(h){return r.container=h},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},L.createElement("style",null,`
          .saturation-white {
            background: -webkit-linear-gradient(to right, #fff, rgba(255,255,255,0));
            background: linear-gradient(to right, #fff, rgba(255,255,255,0));
          }
          .saturation-black {
            background: -webkit-linear-gradient(to top, #000, rgba(0,0,0,0));
            background: linear-gradient(to top, #000, rgba(0,0,0,0));
          }
        `),L.createElement("div",{style:u.white,className:"saturation-white"},L.createElement("div",{style:u.black,className:"saturation-black"}),L.createElement("div",{style:u.pointer},this.props.pointer?L.createElement(this.props.pointer,this.props):L.createElement("div",{style:u.circle}))))}}]),t}(R.PureComponent||R.Component);function Xz(e,t){for(var n=-1,r=e==null?0:e.length;++n<r&&t(e[n],n,e)!==!1;);return e}var Zz=V1(Object.keys,Object),Kz=Object.prototype,Jz=Kz.hasOwnProperty;function Qz(e){if(!Zf(e))return Zz(e);var t=[];for(var n in Object(e))Jz.call(e,n)&&n!="constructor"&&t.push(n);return t}function em(e){return sa(e)?J1(e):Qz(e)}function eF(e,t){return e&&W1(e,t,em)}function tF(e,t){return function(n,r){if(n==null)return n;if(!sa(n))return e(n,r);for(var i=n.length,s=-1,a=Object(n);++s<i&&r(a[s],s,a)!==!1;);return n}}var n_=tF(eF);function nF(e){return typeof e=="function"?e:qd}function rF(e,t){var n=Qn(e)?Xz:n_;return n(e,nF(t))}function fd(e){"@babel/helpers - typeof";return fd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fd(e)}var iF=/^\s+/,sF=/\s+$/;function We(e,t){if(e=e||"",t=t||{},e instanceof We)return e;if(!(this instanceof We))return new We(e,t);var n=oF(e);this._originalInput=e,this._r=n.r,this._g=n.g,this._b=n.b,this._a=n.a,this._roundA=Math.round(100*this._a)/100,this._format=t.format||n.format,this._gradientType=t.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=n.ok}We.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var t=this.toRgb();return(t.r*299+t.g*587+t.b*114)/1e3},getLuminance:function(){var t=this.toRgb(),n,r,i,s,a,l;return n=t.r/255,r=t.g/255,i=t.b/255,n<=.03928?s=n/12.92:s=Math.pow((n+.055)/1.055,2.4),r<=.03928?a=r/12.92:a=Math.pow((r+.055)/1.055,2.4),i<=.03928?l=i/12.92:l=Math.pow((i+.055)/1.055,2.4),.2126*s+.7152*a+.0722*l},setAlpha:function(t){return this._a=r_(t),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var t=Dv(this._r,this._g,this._b);return{h:t.h*360,s:t.s,v:t.v,a:this._a}},toHsvString:function(){var t=Dv(this._r,this._g,this._b),n=Math.round(t.h*360),r=Math.round(t.s*100),i=Math.round(t.v*100);return this._a==1?"hsv("+n+", "+r+"%, "+i+"%)":"hsva("+n+", "+r+"%, "+i+"%, "+this._roundA+")"},toHsl:function(){var t=Iv(this._r,this._g,this._b);return{h:t.h*360,s:t.s,l:t.l,a:this._a}},toHslString:function(){var t=Iv(this._r,this._g,this._b),n=Math.round(t.h*360),r=Math.round(t.s*100),i=Math.round(t.l*100);return this._a==1?"hsl("+n+", "+r+"%, "+i+"%)":"hsla("+n+", "+r+"%, "+i+"%, "+this._roundA+")"},toHex:function(t){return zv(this._r,this._g,this._b,t)},toHexString:function(t){return"#"+this.toHex(t)},toHex8:function(t){return dF(this._r,this._g,this._b,this._a,t)},toHex8String:function(t){return"#"+this.toHex8(t)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(Lt(this._r,255)*100)+"%",g:Math.round(Lt(this._g,255)*100)+"%",b:Math.round(Lt(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(Lt(this._r,255)*100)+"%, "+Math.round(Lt(this._g,255)*100)+"%, "+Math.round(Lt(this._b,255)*100)+"%)":"rgba("+Math.round(Lt(this._r,255)*100)+"%, "+Math.round(Lt(this._g,255)*100)+"%, "+Math.round(Lt(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:_F[zv(this._r,this._g,this._b,!0)]||!1},toFilter:function(t){var n="#"+Fv(this._r,this._g,this._b,this._a),r=n,i=this._gradientType?"GradientType = 1, ":"";if(t){var s=We(t);r="#"+Fv(s._r,s._g,s._b,s._a)}return"progid:DXImageTransform.Microsoft.gradient("+i+"startColorstr="+n+",endColorstr="+r+")"},toString:function(t){var n=!!t;t=t||this._format;var r=!1,i=this._a<1&&this._a>=0,s=!n&&i&&(t==="hex"||t==="hex6"||t==="hex3"||t==="hex4"||t==="hex8"||t==="name");return s?t==="name"&&this._a===0?this.toName():this.toRgbString():(t==="rgb"&&(r=this.toRgbString()),t==="prgb"&&(r=this.toPercentageRgbString()),(t==="hex"||t==="hex6")&&(r=this.toHexString()),t==="hex3"&&(r=this.toHexString(!0)),t==="hex4"&&(r=this.toHex8String(!0)),t==="hex8"&&(r=this.toHex8String()),t==="name"&&(r=this.toName()),t==="hsl"&&(r=this.toHslString()),t==="hsv"&&(r=this.toHsvString()),r||this.toHexString())},clone:function(){return We(this.toString())},_applyModification:function(t,n){var r=t.apply(null,[this].concat([].slice.call(n)));return this._r=r._r,this._g=r._g,this._b=r._b,this.setAlpha(r._a),this},lighten:function(){return this._applyModification(fF,arguments)},brighten:function(){return this._applyModification(mF,arguments)},darken:function(){return this._applyModification(gF,arguments)},desaturate:function(){return this._applyModification(uF,arguments)},saturate:function(){return this._applyModification(hF,arguments)},greyscale:function(){return this._applyModification(pF,arguments)},spin:function(){return this._applyModification(vF,arguments)},_applyCombination:function(t,n){return t.apply(null,[this].concat([].slice.call(n)))},analogous:function(){return this._applyCombination(bF,arguments)},complement:function(){return this._applyCombination(yF,arguments)},monochromatic:function(){return this._applyCombination(wF,arguments)},splitcomplement:function(){return this._applyCombination(xF,arguments)},triad:function(){return this._applyCombination(Bv,[3])},tetrad:function(){return this._applyCombination(Bv,[4])}};We.fromRatio=function(e,t){if(fd(e)=="object"){var n={};for(var r in e)e.hasOwnProperty(r)&&(r==="a"?n[r]=e[r]:n[r]=Ra(e[r]));e=n}return We(e,t)};function oF(e){var t={r:0,g:0,b:0},n=1,r=null,i=null,s=null,a=!1,l=!1;return typeof e=="string"&&(e=CF(e)),fd(e)=="object"&&(ti(e.r)&&ti(e.g)&&ti(e.b)?(t=aF(e.r,e.g,e.b),a=!0,l=String(e.r).substr(-1)==="%"?"prgb":"rgb"):ti(e.h)&&ti(e.s)&&ti(e.v)?(r=Ra(e.s),i=Ra(e.v),t=cF(e.h,r,i),a=!0,l="hsv"):ti(e.h)&&ti(e.s)&&ti(e.l)&&(r=Ra(e.s),s=Ra(e.l),t=lF(e.h,r,s),a=!0,l="hsl"),e.hasOwnProperty("a")&&(n=e.a)),n=r_(n),{ok:a,format:e.format||l,r:Math.min(255,Math.max(t.r,0)),g:Math.min(255,Math.max(t.g,0)),b:Math.min(255,Math.max(t.b,0)),a:n}}function aF(e,t,n){return{r:Lt(e,255)*255,g:Lt(t,255)*255,b:Lt(n,255)*255}}function Iv(e,t,n){e=Lt(e,255),t=Lt(t,255),n=Lt(n,255);var r=Math.max(e,t,n),i=Math.min(e,t,n),s,a,l=(r+i)/2;if(r==i)s=a=0;else{var c=r-i;switch(a=l>.5?c/(2-r-i):c/(r+i),r){case e:s=(t-n)/c+(t<n?6:0);break;case t:s=(n-e)/c+2;break;case n:s=(e-t)/c+4;break}s/=6}return{h:s,s:a,l}}function lF(e,t,n){var r,i,s;e=Lt(e,360),t=Lt(t,100),n=Lt(n,100);function a(d,u,p){return p<0&&(p+=1),p>1&&(p-=1),p<1/6?d+(u-d)*6*p:p<1/2?u:p<2/3?d+(u-d)*(2/3-p)*6:d}if(t===0)r=i=s=n;else{var l=n<.5?n*(1+t):n+t-n*t,c=2*n-l;r=a(c,l,e+1/3),i=a(c,l,e),s=a(c,l,e-1/3)}return{r:r*255,g:i*255,b:s*255}}function Dv(e,t,n){e=Lt(e,255),t=Lt(t,255),n=Lt(n,255);var r=Math.max(e,t,n),i=Math.min(e,t,n),s,a,l=r,c=r-i;if(a=r===0?0:c/r,r==i)s=0;else{switch(r){case e:s=(t-n)/c+(t<n?6:0);break;case t:s=(n-e)/c+2;break;case n:s=(e-t)/c+4;break}s/=6}return{h:s,s:a,v:l}}function cF(e,t,n){e=Lt(e,360)*6,t=Lt(t,100),n=Lt(n,100);var r=Math.floor(e),i=e-r,s=n*(1-t),a=n*(1-i*t),l=n*(1-(1-i)*t),c=r%6,d=[n,a,s,s,l,n][c],u=[l,n,n,a,s,s][c],p=[s,s,l,n,n,a][c];return{r:d*255,g:u*255,b:p*255}}function zv(e,t,n,r){var i=[kr(Math.round(e).toString(16)),kr(Math.round(t).toString(16)),kr(Math.round(n).toString(16))];return r&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function dF(e,t,n,r,i){var s=[kr(Math.round(e).toString(16)),kr(Math.round(t).toString(16)),kr(Math.round(n).toString(16)),kr(i_(r))];return i&&s[0].charAt(0)==s[0].charAt(1)&&s[1].charAt(0)==s[1].charAt(1)&&s[2].charAt(0)==s[2].charAt(1)&&s[3].charAt(0)==s[3].charAt(1)?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0)+s[3].charAt(0):s.join("")}function Fv(e,t,n,r){var i=[kr(i_(r)),kr(Math.round(e).toString(16)),kr(Math.round(t).toString(16)),kr(Math.round(n).toString(16))];return i.join("")}We.equals=function(e,t){return!e||!t?!1:We(e).toRgbString()==We(t).toRgbString()};We.random=function(){return We.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function uF(e,t){t=t===0?0:t||10;var n=We(e).toHsl();return n.s-=t/100,n.s=Zd(n.s),We(n)}function hF(e,t){t=t===0?0:t||10;var n=We(e).toHsl();return n.s+=t/100,n.s=Zd(n.s),We(n)}function pF(e){return We(e).desaturate(100)}function fF(e,t){t=t===0?0:t||10;var n=We(e).toHsl();return n.l+=t/100,n.l=Zd(n.l),We(n)}function mF(e,t){t=t===0?0:t||10;var n=We(e).toRgb();return n.r=Math.max(0,Math.min(255,n.r-Math.round(255*-(t/100)))),n.g=Math.max(0,Math.min(255,n.g-Math.round(255*-(t/100)))),n.b=Math.max(0,Math.min(255,n.b-Math.round(255*-(t/100)))),We(n)}function gF(e,t){t=t===0?0:t||10;var n=We(e).toHsl();return n.l-=t/100,n.l=Zd(n.l),We(n)}function vF(e,t){var n=We(e).toHsl(),r=(n.h+t)%360;return n.h=r<0?360+r:r,We(n)}function yF(e){var t=We(e).toHsl();return t.h=(t.h+180)%360,We(t)}function Bv(e,t){if(isNaN(t)||t<=0)throw new Error("Argument to polyad must be a positive number");for(var n=We(e).toHsl(),r=[We(e)],i=360/t,s=1;s<t;s++)r.push(We({h:(n.h+s*i)%360,s:n.s,l:n.l}));return r}function xF(e){var t=We(e).toHsl(),n=t.h;return[We(e),We({h:(n+72)%360,s:t.s,l:t.l}),We({h:(n+216)%360,s:t.s,l:t.l})]}function bF(e,t,n){t=t||6,n=n||30;var r=We(e).toHsl(),i=360/n,s=[We(e)];for(r.h=(r.h-(i*t>>1)+720)%360;--t;)r.h=(r.h+i)%360,s.push(We(r));return s}function wF(e,t){t=t||6;for(var n=We(e).toHsv(),r=n.h,i=n.s,s=n.v,a=[],l=1/t;t--;)a.push(We({h:r,s:i,v:s})),s=(s+l)%1;return a}We.mix=function(e,t,n){n=n===0?0:n||50;var r=We(e).toRgb(),i=We(t).toRgb(),s=n/100,a={r:(i.r-r.r)*s+r.r,g:(i.g-r.g)*s+r.g,b:(i.b-r.b)*s+r.b,a:(i.a-r.a)*s+r.a};return We(a)};We.readability=function(e,t){var n=We(e),r=We(t);return(Math.max(n.getLuminance(),r.getLuminance())+.05)/(Math.min(n.getLuminance(),r.getLuminance())+.05)};We.isReadable=function(e,t,n){var r=We.readability(e,t),i,s;switch(s=!1,i=EF(n),i.level+i.size){case"AAsmall":case"AAAlarge":s=r>=4.5;break;case"AAlarge":s=r>=3;break;case"AAAsmall":s=r>=7;break}return s};We.mostReadable=function(e,t,n){var r=null,i=0,s,a,l,c;n=n||{},a=n.includeFallbackColors,l=n.level,c=n.size;for(var d=0;d<t.length;d++)s=We.readability(e,t[d]),s>i&&(i=s,r=We(t[d]));return We.isReadable(e,r,{level:l,size:c})||!a?r:(n.includeFallbackColors=!1,We.mostReadable(e,["#fff","#000"],n))};var hp=We.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},_F=We.hexNames=SF(hp);function SF(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t}function r_(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function Lt(e,t){kF(e)&&(e="100%");var n=jF(e);return e=Math.min(t,Math.max(0,parseFloat(e))),n&&(e=parseInt(e*t,10)/100),Math.abs(e-t)<1e-6?1:e%t/parseFloat(t)}function Zd(e){return Math.min(1,Math.max(0,e))}function Wn(e){return parseInt(e,16)}function kF(e){return typeof e=="string"&&e.indexOf(".")!=-1&&parseFloat(e)===1}function jF(e){return typeof e=="string"&&e.indexOf("%")!=-1}function kr(e){return e.length==1?"0"+e:""+e}function Ra(e){return e<=1&&(e=e*100+"%"),e}function i_(e){return Math.round(parseFloat(e)*255).toString(16)}function Hv(e){return Wn(e)/255}var yr=function(){var e="[-\\+]?\\d+%?",t="[-\\+]?\\d*\\.\\d+%?",n="(?:"+t+")|(?:"+e+")",r="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?",i="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?";return{CSS_UNIT:new RegExp(n),rgb:new RegExp("rgb"+r),rgba:new RegExp("rgba"+i),hsl:new RegExp("hsl"+r),hsla:new RegExp("hsla"+i),hsv:new RegExp("hsv"+r),hsva:new RegExp("hsva"+i),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function ti(e){return!!yr.CSS_UNIT.exec(e)}function CF(e){e=e.replace(iF,"").replace(sF,"").toLowerCase();var t=!1;if(hp[e])e=hp[e],t=!0;else if(e=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var n;return(n=yr.rgb.exec(e))?{r:n[1],g:n[2],b:n[3]}:(n=yr.rgba.exec(e))?{r:n[1],g:n[2],b:n[3],a:n[4]}:(n=yr.hsl.exec(e))?{h:n[1],s:n[2],l:n[3]}:(n=yr.hsla.exec(e))?{h:n[1],s:n[2],l:n[3],a:n[4]}:(n=yr.hsv.exec(e))?{h:n[1],s:n[2],v:n[3]}:(n=yr.hsva.exec(e))?{h:n[1],s:n[2],v:n[3],a:n[4]}:(n=yr.hex8.exec(e))?{r:Wn(n[1]),g:Wn(n[2]),b:Wn(n[3]),a:Hv(n[4]),format:t?"name":"hex8"}:(n=yr.hex6.exec(e))?{r:Wn(n[1]),g:Wn(n[2]),b:Wn(n[3]),format:t?"name":"hex"}:(n=yr.hex4.exec(e))?{r:Wn(n[1]+""+n[1]),g:Wn(n[2]+""+n[2]),b:Wn(n[3]+""+n[3]),a:Hv(n[4]+""+n[4]),format:t?"name":"hex8"}:(n=yr.hex3.exec(e))?{r:Wn(n[1]+""+n[1]),g:Wn(n[2]+""+n[2]),b:Wn(n[3]+""+n[3]),format:t?"name":"hex"}:!1}function EF(e){var t,n;return e=e||{level:"AA",size:"small"},t=(e.level||"AA").toUpperCase(),n=(e.size||"small").toLowerCase(),t!=="AA"&&t!=="AAA"&&(t="AA"),n!=="small"&&n!=="large"&&(n="small"),{level:t,size:n}}var Uv=function(t){var n=["r","g","b","a","h","s","l","v"],r=0,i=0;return rF(n,function(s){if(t[s]&&(r+=1,isNaN(t[s])||(i+=1),s==="s"||s==="l")){var a=/^\d+%$/;a.test(t[s])&&(i+=1)}}),r===i?t:!1},Oa=function(t,n){var r=t.hex?We(t.hex):We(t),i=r.toHsl(),s=r.toHsv(),a=r.toRgb(),l=r.toHex();i.s===0&&(i.h=n||0,s.h=n||0);var c=l==="000000"&&a.a===0;return{hsl:i,hex:c?"transparent":"#"+l,rgb:a,hsv:s,oldHue:t.h||n||i.h,source:t.source}},Qi=function(t){if(t==="transparent")return!0;var n=String(t).charAt(0)==="#"?1:0;return t.length!==4+n&&t.length<7+n&&We(t).isValid()},tm=function(t){if(!t)return"#fff";var n=Oa(t);if(n.hex==="transparent")return"rgba(0,0,0,0.4)";var r=(n.rgb.r*299+n.rgb.g*587+n.rgb.b*114)/1e3;return r>=128?"#000":"#fff"},Zu=function(t,n){var r=t.replace("","");return We(n+" ("+r+")")._ok},_a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},TF=function(){function e(t,n){for(var r=0;r<n.length;r++){var i=n[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function NF(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PF(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e}function RF(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var Dn=function(t){var n=function(r){RF(i,r);function i(s){NF(this,i);var a=PF(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return a.handleChange=function(l,c){var d=Uv(l);if(d){var u=Oa(l,l.h||a.state.oldHue);a.setState(u),a.props.onChangeComplete&&a.debounce(a.props.onChangeComplete,u,c),a.props.onChange&&a.props.onChange(u,c)}},a.handleSwatchHover=function(l,c){var d=Uv(l);if(d){var u=Oa(l,l.h||a.state.oldHue);a.props.onSwatchHover&&a.props.onSwatchHover(u,c)}},a.state=_a({},Oa(s.color,0)),a.debounce=t_(function(l,c,d){l(c,d)},100),a}return TF(i,[{key:"render",value:function(){var a={};return this.props.onSwatchHover&&(a.onSwatchHover=this.handleSwatchHover),L.createElement(t,_a({},this.props,this.state,{onChange:this.handleChange},a))}}],[{key:"getDerivedStateFromProps",value:function(a,l){return _a({},Oa(a.color,l.oldHue))}}]),i}(R.PureComponent||R.Component);return n.propTypes=_a({},t.propTypes),n.defaultProps=_a({},t.defaultProps,{color:{h:250,s:.5,l:.2,a:1}}),n},OF=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},AF=function(){function e(t,n){for(var r=0;r<n.length;r++){var i=n[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function MF(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Wv(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e}function $F(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var LF=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"span";return function(r){$F(i,r);function i(){var s,a,l,c;MF(this,i);for(var d=arguments.length,u=Array(d),p=0;p<d;p++)u[p]=arguments[p];return c=(a=(l=Wv(this,(s=i.__proto__||Object.getPrototypeOf(i)).call.apply(s,[this].concat(u))),l),l.state={focus:!1},l.handleFocus=function(){return l.setState({focus:!0})},l.handleBlur=function(){return l.setState({focus:!1})},a),Wv(l,c)}return AF(i,[{key:"render",value:function(){return L.createElement(n,{onFocus:this.handleFocus,onBlur:this.handleBlur},L.createElement(t,OF({},this.props,this.state)))}}]),i}(L.Component)},Gv=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},IF=13,DF=function(t){var n=t.color,r=t.style,i=t.onClick,s=i===void 0?function(){}:i,a=t.onHover,l=t.title,c=l===void 0?n:l,d=t.children,u=t.focus,p=t.focusStyle,h=p===void 0?{}:p,f=n==="transparent",m=rt({default:{swatch:Gv({background:n,height:"100%",width:"100%",cursor:"pointer",position:"relative",outline:"none"},r,u?h:{})}}),g=function(w){return s(n,w)},x=function(w){return w.keyCode===IF&&s(n,w)},y=function(w){return a(n,w)},v={};return a&&(v.onMouseOver=y),L.createElement("div",Gv({style:m.swatch,onClick:g,title:c,tabIndex:0,onKeyDown:x},v),d,f&&L.createElement(ra,{borderRadius:m.swatch.borderRadius,boxShadow:"inset 0 0 0 1px rgba(0,0,0,0.1)"}))};const Ds=LF(DF);var zF=function(t){var n=t.direction,r=rt({default:{picker:{width:"18px",height:"18px",borderRadius:"50%",transform:"translate(-9px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}},vertical:{picker:{transform:"translate(-3px, -9px)"}}},{vertical:n==="vertical"});return L.createElement("div",{style:r.picker})},FF=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s_=function(t){var n=t.rgb,r=t.hsl,i=t.width,s=t.height,a=t.onChange,l=t.direction,c=t.style,d=t.renderers,u=t.pointer,p=t.className,h=p===void 0?"":p,f=rt({default:{picker:{position:"relative",width:i,height:s},alpha:{radius:"2px",style:c}}});return L.createElement("div",{style:f.picker,className:"alpha-picker "+h},L.createElement(qf,FF({},f.alpha,{rgb:n,hsl:r,pointer:u,renderers:d,onChange:a,direction:l})))};s_.defaultProps={width:"316px",height:"16px",direction:"horizontal",pointer:zF};Dn(s_);function o_(e,t){for(var n=-1,r=e==null?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}var BF="__lodash_hash_undefined__";function HF(e){return this.__data__.set(e,BF),this}function UF(e){return this.__data__.has(e)}function md(e){var t=-1,n=e==null?0:e.length;for(this.__data__=new mi;++t<n;)this.add(e[t])}md.prototype.add=md.prototype.push=HF;md.prototype.has=UF;function WF(e,t){for(var n=-1,r=e==null?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}function GF(e,t){return e.has(t)}var VF=1,qF=2;function a_(e,t,n,r,i,s){var a=n&VF,l=e.length,c=t.length;if(l!=c&&!(a&&c>l))return!1;var d=s.get(e),u=s.get(t);if(d&&u)return d==t&&u==e;var p=-1,h=!0,f=n&qF?new md:void 0;for(s.set(e,t),s.set(t,e);++p<l;){var m=e[p],g=t[p];if(r)var x=a?r(g,m,p,t,e,s):r(m,g,p,e,t,s);if(x!==void 0){if(x)continue;h=!1;break}if(f){if(!WF(t,function(y,v){if(!GF(f,v)&&(m===y||i(m,y,n,r,s)))return f.push(v)})){h=!1;break}}else if(!(m===g||i(m,g,n,r,s))){h=!1;break}}return s.delete(e),s.delete(t),h}function YF(e){var t=-1,n=Array(e.size);return e.forEach(function(r,i){n[++t]=[i,r]}),n}function XF(e){var t=-1,n=Array(e.size);return e.forEach(function(r){n[++t]=r}),n}var ZF=1,KF=2,JF="[object Boolean]",QF="[object Date]",eB="[object Error]",tB="[object Map]",nB="[object Number]",rB="[object RegExp]",iB="[object Set]",sB="[object String]",oB="[object Symbol]",aB="[object ArrayBuffer]",lB="[object DataView]",Vv=qi?qi.prototype:void 0,Ku=Vv?Vv.valueOf:void 0;function cB(e,t,n,r,i,s,a){switch(n){case lB:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case aB:return!(e.byteLength!=t.byteLength||!s(new ud(e),new ud(t)));case JF:case QF:case nB:return Pl(+e,+t);case eB:return e.name==t.name&&e.message==t.message;case rB:case sB:return e==t+"";case tB:var l=YF;case iB:var c=r&ZF;if(l||(l=XF),e.size!=t.size&&!c)return!1;var d=a.get(e);if(d)return d==t;r|=KF,a.set(e,t);var u=a_(l(e),l(t),r,i,s,a);return a.delete(e),u;case oB:if(Ku)return Ku.call(e)==Ku.call(t)}return!1}function dB(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}function uB(e,t,n){var r=t(e);return Qn(e)?r:dB(r,n(e))}function hB(e,t){for(var n=-1,r=e==null?0:e.length,i=0,s=[];++n<r;){var a=e[n];t(a,n,e)&&(s[i++]=a)}return s}function pB(){return[]}var fB=Object.prototype,mB=fB.propertyIsEnumerable,qv=Object.getOwnPropertySymbols,gB=qv?function(e){return e==null?[]:(e=Object(e),hB(qv(e),function(t){return mB.call(e,t)}))}:pB;function Yv(e){return uB(e,em,gB)}var vB=1,yB=Object.prototype,xB=yB.hasOwnProperty;function bB(e,t,n,r,i,s){var a=n&vB,l=Yv(e),c=l.length,d=Yv(t),u=d.length;if(c!=u&&!a)return!1;for(var p=c;p--;){var h=l[p];if(!(a?h in t:xB.call(t,h)))return!1}var f=s.get(e),m=s.get(t);if(f&&m)return f==t&&m==e;var g=!0;s.set(e,t),s.set(t,e);for(var x=a;++p<c;){h=l[p];var y=e[h],v=t[h];if(r)var b=a?r(v,y,h,t,e,s):r(y,v,h,e,t,s);if(!(b===void 0?y===v||i(y,v,n,r,s):b)){g=!1;break}x||(x=h=="constructor")}if(g&&!x){var w=e.constructor,C=t.constructor;w!=C&&"constructor"in e&&"constructor"in t&&!(typeof w=="function"&&w instanceof w&&typeof C=="function"&&C instanceof C)&&(g=!1)}return s.delete(e),s.delete(t),g}var pp=Is(Nr,"DataView"),fp=Is(Nr,"Promise"),mp=Is(Nr,"Set"),gp=Is(Nr,"WeakMap"),Xv="[object Map]",wB="[object Object]",Zv="[object Promise]",Kv="[object Set]",Jv="[object WeakMap]",Qv="[object DataView]",_B=Ls(pp),SB=Ls(fl),kB=Ls(fp),jB=Ls(mp),CB=Ls(gp),Ni=$s;(pp&&Ni(new pp(new ArrayBuffer(1)))!=Qv||fl&&Ni(new fl)!=Xv||fp&&Ni(fp.resolve())!=Zv||mp&&Ni(new mp)!=Kv||gp&&Ni(new gp)!=Jv)&&(Ni=function(e){var t=$s(e),n=t==wB?e.constructor:void 0,r=n?Ls(n):"";if(r)switch(r){case _B:return Qv;case SB:return Xv;case kB:return Zv;case jB:return Kv;case CB:return Jv}return t});var EB=1,ey="[object Arguments]",ty="[object Array]",hc="[object Object]",TB=Object.prototype,ny=TB.hasOwnProperty;function NB(e,t,n,r,i,s){var a=Qn(e),l=Qn(t),c=a?ty:Ni(e),d=l?ty:Ni(t);c=c==ey?hc:c,d=d==ey?hc:d;var u=c==hc,p=d==hc,h=c==d;if(h&&pd(e)){if(!pd(t))return!1;a=!0,u=!1}if(h&&!u)return s||(s=new Gr),a||Jf(e)?a_(e,t,n,r,i,s):cB(e,t,c,n,r,i,s);if(!(n&EB)){var f=u&&ny.call(e,"__wrapped__"),m=p&&ny.call(t,"__wrapped__");if(f||m){var g=f?e.value():e,x=m?t.value():t;return s||(s=new Gr),i(g,x,n,r,s)}}return h?(s||(s=new Gr),bB(e,t,n,r,i,s)):!1}function nm(e,t,n,r,i){return e===t?!0:e==null||t==null||!Yi(e)&&!Yi(t)?e!==e&&t!==t:NB(e,t,n,r,nm,i)}var PB=1,RB=2;function OB(e,t,n,r){var i=n.length,s=i;if(e==null)return!s;for(e=Object(e);i--;){var a=n[i];if(a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++i<s;){a=n[i];var l=a[0],c=e[l],d=a[1];if(a[2]){if(c===void 0&&!(l in e))return!1}else{var u=new Gr,p;if(!(p===void 0?nm(d,c,PB|RB,r,u):p))return!1}}return!0}function l_(e){return e===e&&!fr(e)}function AB(e){for(var t=em(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,l_(i)]}return t}function c_(e,t){return function(n){return n==null?!1:n[e]===t&&(t!==void 0||e in Object(n))}}function MB(e){var t=AB(e);return t.length==1&&t[0][2]?c_(t[0][0],t[0][1]):function(n){return n===e||OB(n,e,t)}}var $B=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,LB=/^\w*$/;function rm(e,t){if(Qn(e))return!1;var n=typeof e;return n=="number"||n=="symbol"||n=="boolean"||e==null||Yd(e)?!0:LB.test(e)||!$B.test(e)||t!=null&&e in Object(t)}var IB="Expected a function";function im(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(IB);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],s=n.cache;if(s.has(i))return s.get(i);var a=e.apply(this,r);return n.cache=s.set(i,a)||s,a};return n.cache=new(im.Cache||mi),n}im.Cache=mi;var DB=500;function zB(e){var t=im(e,function(r){return n.size===DB&&n.clear(),r}),n=t.cache;return t}var FB=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,BB=/\\(\\)?/g,HB=zB(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(FB,function(n,r,i,s){t.push(i?s.replace(BB,"$1"):r||n)}),t}),ry=qi?qi.prototype:void 0,iy=ry?ry.toString:void 0;function d_(e){if(typeof e=="string")return e;if(Qn(e))return o_(e,d_)+"";if(Yd(e))return iy?iy.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}function UB(e){return e==null?"":d_(e)}function u_(e,t){return Qn(e)?e:rm(e,t)?[e]:HB(UB(e))}function Kd(e){if(typeof e=="string"||Yd(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}function h_(e,t){t=u_(t,e);for(var n=0,r=t.length;e!=null&&n<r;)e=e[Kd(t[n++])];return n&&n==r?e:void 0}function WB(e,t,n){var r=e==null?void 0:h_(e,t);return r===void 0?n:r}function GB(e,t){return e!=null&&t in Object(e)}function VB(e,t,n){t=u_(t,e);for(var r=-1,i=t.length,s=!1;++r<i;){var a=Kd(t[r]);if(!(s=e!=null&&n(e,a)))break;e=e[a]}return s||++r!=i?s:(i=e==null?0:e.length,!!i&&Kf(i)&&Qf(a,i)&&(Qn(e)||hd(e)))}function qB(e,t){return e!=null&&VB(e,t,GB)}var YB=1,XB=2;function ZB(e,t){return rm(e)&&l_(t)?c_(Kd(e),t):function(n){var r=WB(n,e);return r===void 0&&r===t?qB(n,e):nm(t,r,YB|XB)}}function KB(e){return function(t){return t==null?void 0:t[e]}}function JB(e){return function(t){return h_(t,e)}}function QB(e){return rm(e)?KB(Kd(e)):JB(e)}function eH(e){return typeof e=="function"?e:e==null?qd:typeof e=="object"?Qn(e)?ZB(e[0],e[1]):MB(e):QB(e)}function tH(e,t){var n=-1,r=sa(e)?Array(e.length):[];return n_(e,function(i,s,a){r[++n]=t(i,s,a)}),r}function zs(e,t){var n=Qn(e)?o_:tH;return n(e,eH(t))}var nH=function(t){var n=t.colors,r=t.onClick,i=t.onSwatchHover,s=rt({default:{swatches:{marginRight:"-10px"},swatch:{width:"22px",height:"22px",float:"left",marginRight:"10px",marginBottom:"10px",borderRadius:"4px"},clear:{clear:"both"}}});return L.createElement("div",{style:s.swatches},zs(n,function(a){return L.createElement(Ds,{key:a,color:a,style:s.swatch,onClick:r,onHover:i,focusStyle:{boxShadow:"0 0 4px "+a}})}),L.createElement("div",{style:s.clear}))},sm=function(t){var n=t.onChange,r=t.onSwatchHover,i=t.hex,s=t.colors,a=t.width,l=t.triangle,c=t.styles,d=c===void 0?{}:c,u=t.className,p=u===void 0?"":u,h=i==="transparent",f=function(x,y){Qi(x)&&n({hex:x,source:"hex"},y)},m=rt(In({default:{card:{width:a,background:"#fff",boxShadow:"0 1px rgba(0,0,0,.1)",borderRadius:"6px",position:"relative"},head:{height:"110px",background:i,borderRadius:"6px 6px 0 0",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},body:{padding:"10px"},label:{fontSize:"18px",color:tm(i),position:"relative"},triangle:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 10px 10px 10px",borderColor:"transparent transparent "+i+" transparent",position:"absolute",top:"-10px",left:"50%",marginLeft:"-10px"},input:{width:"100%",fontSize:"12px",color:"#666",border:"0px",outline:"none",height:"22px",boxShadow:"inset 0 0 0 1px #ddd",borderRadius:"4px",padding:"0 7px",boxSizing:"border-box"}},"hide-triangle":{triangle:{display:"none"}}},d),{"hide-triangle":l==="hide"});return L.createElement("div",{style:m.card,className:"block-picker "+p},L.createElement("div",{style:m.triangle}),L.createElement("div",{style:m.head},h&&L.createElement(ra,{borderRadius:"6px 6px 0 0"}),L.createElement("div",{style:m.label},i)),L.createElement("div",{style:m.body},L.createElement(nH,{colors:s,onClick:f,onSwatchHover:r}),L.createElement(ut,{style:{input:m.input},value:i,onChange:f})))};sm.propTypes={width:Oe.oneOfType([Oe.string,Oe.number]),colors:Oe.arrayOf(Oe.string),triangle:Oe.oneOf(["top","hide"]),styles:Oe.object};sm.defaultProps={width:170,colors:["#D9E3F0","#F47373","#697689","#37D67A","#2CCCE4","#555555","#dce775","#ff8a65","#ba68c8"],triangle:"top",styles:{}};Dn(sm);var Ks={100:"#ffcdd2",300:"#e57373",500:"#f44336",700:"#d32f2f",900:"#b71c1c"},Js={100:"#f8bbd0",300:"#f06292",500:"#e91e63",700:"#c2185b",900:"#880e4f"},Qs={100:"#e1bee7",300:"#ba68c8",500:"#9c27b0",700:"#7b1fa2",900:"#4a148c"},eo={100:"#d1c4e9",300:"#9575cd",500:"#673ab7",700:"#512da8",900:"#311b92"},to={100:"#c5cae9",300:"#7986cb",500:"#3f51b5",700:"#303f9f",900:"#1a237e"},no={100:"#bbdefb",300:"#64b5f6",500:"#2196f3",700:"#1976d2",900:"#0d47a1"},ro={100:"#b3e5fc",300:"#4fc3f7",500:"#03a9f4",700:"#0288d1",900:"#01579b"},io={100:"#b2ebf2",300:"#4dd0e1",500:"#00bcd4",700:"#0097a7",900:"#006064"},so={100:"#b2dfdb",300:"#4db6ac",500:"#009688",700:"#00796b",900:"#004d40"},Aa={100:"#c8e6c9",300:"#81c784",500:"#4caf50",700:"#388e3c"},oo={100:"#dcedc8",300:"#aed581",500:"#8bc34a",700:"#689f38",900:"#33691e"},ao={100:"#f0f4c3",300:"#dce775",500:"#cddc39",700:"#afb42b",900:"#827717"},lo={100:"#fff9c4",300:"#fff176",500:"#ffeb3b",700:"#fbc02d",900:"#f57f17"},co={100:"#ffecb3",300:"#ffd54f",500:"#ffc107",700:"#ffa000",900:"#ff6f00"},uo={100:"#ffe0b2",300:"#ffb74d",500:"#ff9800",700:"#f57c00",900:"#e65100"},ho={100:"#ffccbc",300:"#ff8a65",500:"#ff5722",700:"#e64a19",900:"#bf360c"},po={100:"#d7ccc8",300:"#a1887f",500:"#795548",700:"#5d4037",900:"#3e2723"},fo={100:"#cfd8dc",300:"#90a4ae",500:"#607d8b",700:"#455a64",900:"#263238"},p_=function(t){var n=t.color,r=t.onClick,i=t.onSwatchHover,s=t.hover,a=t.active,l=t.circleSize,c=t.circleSpacing,d=rt({default:{swatch:{width:l,height:l,marginRight:c,marginBottom:c,transform:"scale(1)",transition:"100ms transform ease"},Swatch:{borderRadius:"50%",background:"transparent",boxShadow:"inset 0 0 0 "+(l/2+1)+"px "+n,transition:"100ms box-shadow ease"}},hover:{swatch:{transform:"scale(1.2)"}},active:{Swatch:{boxShadow:"inset 0 0 0 3px "+n}}},{hover:s,active:a});return L.createElement("div",{style:d.swatch},L.createElement(Ds,{style:d.Swatch,color:n,onClick:r,onHover:i,focusStyle:{boxShadow:d.Swatch.boxShadow+", 0 0 5px "+n}}))};p_.defaultProps={circleSize:28,circleSpacing:14};const rH=Vf(p_);var om=function(t){var n=t.width,r=t.onChange,i=t.onSwatchHover,s=t.colors,a=t.hex,l=t.circleSize,c=t.styles,d=c===void 0?{}:c,u=t.circleSpacing,p=t.className,h=p===void 0?"":p,f=rt(In({default:{card:{width:n,display:"flex",flexWrap:"wrap",marginRight:-u,marginBottom:-u}}},d)),m=function(x,y){return r({hex:x,source:"hex"},y)};return L.createElement("div",{style:f.card,className:"circle-picker "+h},zs(s,function(g){return L.createElement(rH,{key:g,color:g,onClick:m,onSwatchHover:i,active:a===g.toLowerCase(),circleSize:l,circleSpacing:u})}))};om.propTypes={width:Oe.oneOfType([Oe.string,Oe.number]),circleSize:Oe.number,circleSpacing:Oe.number,styles:Oe.object};om.defaultProps={width:252,circleSize:28,circleSpacing:14,colors:[Ks[500],Js[500],Qs[500],eo[500],to[500],no[500],ro[500],io[500],so[500],Aa[500],oo[500],ao[500],lo[500],co[500],uo[500],ho[500],po[500],fo[500]],styles:{}};Dn(om);function sy(e){return e===void 0}var f_={};Object.defineProperty(f_,"__esModule",{value:!0});var oy=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},iH=R,ay=sH(iH);function sH(e){return e&&e.__esModule?e:{default:e}}function oH(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}var pc=24,aH=f_.default=function(e){var t=e.fill,n=t===void 0?"currentColor":t,r=e.width,i=r===void 0?pc:r,s=e.height,a=s===void 0?pc:s,l=e.style,c=l===void 0?{}:l,d=oH(e,["fill","width","height","style"]);return ay.default.createElement("svg",oy({viewBox:"0 0 "+pc+" "+pc,style:oy({fill:n,width:i,height:a},c)},d),ay.default.createElement("path",{d:"M12,18.17L8.83,15L7.42,16.41L12,21L16.59,16.41L15.17,15M12,5.83L15.17,9L16.58,7.59L12,3L7.41,7.59L8.83,9L12,5.83Z"}))},lH=function(){function e(t,n){for(var r=0;r<n.length;r++){var i=n[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function cH(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dH(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e}function uH(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var m_=function(e){uH(t,e);function t(n){cH(this,t);var r=dH(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.toggleViews=function(){r.state.view==="hex"?r.setState({view:"rgb"}):r.state.view==="rgb"?r.setState({view:"hsl"}):r.state.view==="hsl"&&(r.props.hsl.a===1?r.setState({view:"hex"}):r.setState({view:"rgb"}))},r.handleChange=function(i,s){i.hex?Qi(i.hex)&&r.props.onChange({hex:i.hex,source:"hex"},s):i.r||i.g||i.b?r.props.onChange({r:i.r||r.props.rgb.r,g:i.g||r.props.rgb.g,b:i.b||r.props.rgb.b,source:"rgb"},s):i.a?(i.a<0?i.a=0:i.a>1&&(i.a=1),r.props.onChange({h:r.props.hsl.h,s:r.props.hsl.s,l:r.props.hsl.l,a:Math.round(i.a*100)/100,source:"rgb"},s)):(i.h||i.s||i.l)&&(typeof i.s=="string"&&i.s.includes("%")&&(i.s=i.s.replace("%","")),typeof i.l=="string"&&i.l.includes("%")&&(i.l=i.l.replace("%","")),i.s==1?i.s=.01:i.l==1&&(i.l=.01),r.props.onChange({h:i.h||r.props.hsl.h,s:Number(sy(i.s)?r.props.hsl.s:i.s),l:Number(sy(i.l)?r.props.hsl.l:i.l),source:"hsl"},s))},r.showHighlight=function(i){i.currentTarget.style.background="#eee"},r.hideHighlight=function(i){i.currentTarget.style.background="transparent"},n.hsl.a!==1&&n.view==="hex"?r.state={view:"rgb"}:r.state={view:n.view},r}return lH(t,[{key:"render",value:function(){var r=this,i=rt({default:{wrap:{paddingTop:"16px",display:"flex"},fields:{flex:"1",display:"flex",marginLeft:"-6px"},field:{paddingLeft:"6px",width:"100%"},alpha:{paddingLeft:"6px",width:"100%"},toggle:{width:"32px",textAlign:"right",position:"relative"},icon:{marginRight:"-4px",marginTop:"12px",cursor:"pointer",position:"relative"},iconHighlight:{position:"absolute",width:"24px",height:"28px",background:"#eee",borderRadius:"4px",top:"10px",left:"12px",display:"none"},input:{fontSize:"11px",color:"#333",width:"100%",borderRadius:"2px",border:"none",boxShadow:"inset 0 0 0 1px #dadada",height:"21px",textAlign:"center"},label:{textTransform:"uppercase",fontSize:"11px",lineHeight:"11px",color:"#969696",textAlign:"center",display:"block",marginTop:"12px"},svg:{fill:"#333",width:"24px",height:"24px",border:"1px transparent solid",borderRadius:"5px"}},disableAlpha:{alpha:{display:"none"}}},this.props,this.state),s=void 0;return this.state.view==="hex"?s=L.createElement("div",{style:i.fields,className:"flexbox-fix"},L.createElement("div",{style:i.field},L.createElement(ut,{style:{input:i.input,label:i.label},label:"hex",value:this.props.hex,onChange:this.handleChange}))):this.state.view==="rgb"?s=L.createElement("div",{style:i.fields,className:"flexbox-fix"},L.createElement("div",{style:i.field},L.createElement(ut,{style:{input:i.input,label:i.label},label:"r",value:this.props.rgb.r,onChange:this.handleChange})),L.createElement("div",{style:i.field},L.createElement(ut,{style:{input:i.input,label:i.label},label:"g",value:this.props.rgb.g,onChange:this.handleChange})),L.createElement("div",{style:i.field},L.createElement(ut,{style:{input:i.input,label:i.label},label:"b",value:this.props.rgb.b,onChange:this.handleChange})),L.createElement("div",{style:i.alpha},L.createElement(ut,{style:{input:i.input,label:i.label},label:"a",value:this.props.rgb.a,arrowOffset:.01,onChange:this.handleChange}))):this.state.view==="hsl"&&(s=L.createElement("div",{style:i.fields,className:"flexbox-fix"},L.createElement("div",{style:i.field},L.createElement(ut,{style:{input:i.input,label:i.label},label:"h",value:Math.round(this.props.hsl.h),onChange:this.handleChange})),L.createElement("div",{style:i.field},L.createElement(ut,{style:{input:i.input,label:i.label},label:"s",value:Math.round(this.props.hsl.s*100)+"%",onChange:this.handleChange})),L.createElement("div",{style:i.field},L.createElement(ut,{style:{input:i.input,label:i.label},label:"l",value:Math.round(this.props.hsl.l*100)+"%",onChange:this.handleChange})),L.createElement("div",{style:i.alpha},L.createElement(ut,{style:{input:i.input,label:i.label},label:"a",value:this.props.hsl.a,arrowOffset:.01,onChange:this.handleChange})))),L.createElement("div",{style:i.wrap,className:"flexbox-fix"},s,L.createElement("div",{style:i.toggle},L.createElement("div",{style:i.icon,onClick:this.toggleViews,ref:function(l){return r.icon=l}},L.createElement(aH,{style:i.svg,onMouseOver:this.showHighlight,onMouseEnter:this.showHighlight,onMouseOut:this.hideHighlight}))))}}],[{key:"getDerivedStateFromProps",value:function(r,i){return r.hsl.a!==1&&i.view==="hex"?{view:"rgb"}:null}}]),t}(L.Component);m_.defaultProps={view:"hex"};var ly=function(){var t=rt({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",transform:"translate(-6px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}}});return L.createElement("div",{style:t.picker})},hH=function(){var t=rt({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",boxShadow:"inset 0 0 0 1px #fff",transform:"translate(-6px, -6px)"}}});return L.createElement("div",{style:t.picker})},am=function(t){var n=t.width,r=t.onChange,i=t.disableAlpha,s=t.rgb,a=t.hsl,l=t.hsv,c=t.hex,d=t.renderers,u=t.styles,p=u===void 0?{}:u,h=t.className,f=h===void 0?"":h,m=t.defaultView,g=rt(In({default:{picker:{width:n,background:"#fff",borderRadius:"2px",boxShadow:"0 0 2px rgba(0,0,0,.3), 0 4px 8px rgba(0,0,0,.3)",boxSizing:"initial",fontFamily:"Menlo"},saturation:{width:"100%",paddingBottom:"55%",position:"relative",borderRadius:"2px 2px 0 0",overflow:"hidden"},Saturation:{radius:"2px 2px 0 0"},body:{padding:"16px 16px 12px"},controls:{display:"flex"},color:{width:"32px"},swatch:{marginTop:"6px",width:"16px",height:"16px",borderRadius:"8px",position:"relative",overflow:"hidden"},active:{absolute:"0px 0px 0px 0px",borderRadius:"8px",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.1)",background:"rgba("+s.r+", "+s.g+", "+s.b+", "+s.a+")",zIndex:"2"},toggles:{flex:"1"},hue:{height:"10px",position:"relative",marginBottom:"8px"},Hue:{radius:"2px"},alpha:{height:"10px",position:"relative"},Alpha:{radius:"2px"}},disableAlpha:{color:{width:"22px"},alpha:{display:"none"},hue:{marginBottom:"0px"},swatch:{width:"10px",height:"10px",marginTop:"0px"}}},p),{disableAlpha:i});return L.createElement("div",{style:g.picker,className:"chrome-picker "+f},L.createElement("div",{style:g.saturation},L.createElement(Xd,{style:g.Saturation,hsl:a,hsv:l,pointer:hH,onChange:r})),L.createElement("div",{style:g.body},L.createElement("div",{style:g.controls,className:"flexbox-fix"},L.createElement("div",{style:g.color},L.createElement("div",{style:g.swatch},L.createElement("div",{style:g.active}),L.createElement(ra,{renderers:d}))),L.createElement("div",{style:g.toggles},L.createElement("div",{style:g.hue},L.createElement(ia,{style:g.Hue,hsl:a,pointer:ly,onChange:r})),L.createElement("div",{style:g.alpha},L.createElement(qf,{style:g.Alpha,rgb:s,hsl:a,pointer:ly,renderers:d,onChange:r})))),L.createElement(m_,{rgb:s,hsl:a,hex:c,view:m,onChange:r,disableAlpha:i})))};am.propTypes={width:Oe.oneOfType([Oe.string,Oe.number]),disableAlpha:Oe.bool,styles:Oe.object,defaultView:Oe.oneOf(["hex","rgb","hsl"])};am.defaultProps={width:225,disableAlpha:!1,styles:{}};Dn(am);var pH=function(t){var n=t.color,r=t.onClick,i=r===void 0?function(){}:r,s=t.onSwatchHover,a=t.active,l=rt({default:{color:{background:n,width:"15px",height:"15px",float:"left",marginRight:"5px",marginBottom:"5px",position:"relative",cursor:"pointer"},dot:{absolute:"5px 5px 5px 5px",background:tm(n),borderRadius:"50%",opacity:"0"}},active:{dot:{opacity:"1"}},"color-#FFFFFF":{color:{boxShadow:"inset 0 0 0 1px #ddd"},dot:{background:"#000"}},transparent:{dot:{background:"#000"}}},{active:a,"color-#FFFFFF":n==="#FFFFFF",transparent:n==="transparent"});return L.createElement(Ds,{style:l.color,color:n,onClick:i,onHover:s,focusStyle:{boxShadow:"0 0 4px "+n}},L.createElement("div",{style:l.dot}))},fH=function(t){var n=t.hex,r=t.rgb,i=t.onChange,s=rt({default:{fields:{display:"flex",paddingBottom:"6px",paddingRight:"5px",position:"relative"},active:{position:"absolute",top:"6px",left:"5px",height:"9px",width:"9px",background:n},HEXwrap:{flex:"6",position:"relative"},HEXinput:{width:"80%",padding:"0px",paddingLeft:"20%",border:"none",outline:"none",background:"none",fontSize:"12px",color:"#333",height:"16px"},HEXlabel:{display:"none"},RGBwrap:{flex:"3",position:"relative"},RGBinput:{width:"70%",padding:"0px",paddingLeft:"30%",border:"none",outline:"none",background:"none",fontSize:"12px",color:"#333",height:"16px"},RGBlabel:{position:"absolute",top:"3px",left:"0px",lineHeight:"16px",textTransform:"uppercase",fontSize:"12px",color:"#999"}}}),a=function(c,d){c.r||c.g||c.b?i({r:c.r||r.r,g:c.g||r.g,b:c.b||r.b,source:"rgb"},d):i({hex:c.hex,source:"hex"},d)};return L.createElement("div",{style:s.fields,className:"flexbox-fix"},L.createElement("div",{style:s.active}),L.createElement(ut,{style:{wrap:s.HEXwrap,input:s.HEXinput,label:s.HEXlabel},label:"hex",value:n,onChange:a}),L.createElement(ut,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"r",value:r.r,onChange:a}),L.createElement(ut,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"g",value:r.g,onChange:a}),L.createElement(ut,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"b",value:r.b,onChange:a}))},lm=function(t){var n=t.onChange,r=t.onSwatchHover,i=t.colors,s=t.hex,a=t.rgb,l=t.styles,c=l===void 0?{}:l,d=t.className,u=d===void 0?"":d,p=rt(In({default:{Compact:{background:"#f6f6f6",radius:"4px"},compact:{paddingTop:"5px",paddingLeft:"5px",boxSizing:"initial",width:"240px"},clear:{clear:"both"}}},c)),h=function(m,g){m.hex?Qi(m.hex)&&n({hex:m.hex,source:"hex"},g):n(m,g)};return L.createElement(Rl,{style:p.Compact,styles:c},L.createElement("div",{style:p.compact,className:"compact-picker "+u},L.createElement("div",null,zs(i,function(f){return L.createElement(pH,{key:f,color:f,active:f.toLowerCase()===s,onClick:h,onSwatchHover:r})}),L.createElement("div",{style:p.clear})),L.createElement(fH,{hex:s,rgb:a,onChange:h})))};lm.propTypes={colors:Oe.arrayOf(Oe.string),styles:Oe.object};lm.defaultProps={colors:["#4D4D4D","#999999","#FFFFFF","#F44E3B","#FE9200","#FCDC00","#DBDF00","#A4DD00","#68CCCA","#73D8FF","#AEA1FF","#FDA1FF","#333333","#808080","#cccccc","#D33115","#E27300","#FCC400","#B0BC00","#68BC00","#16A5A5","#009CE0","#7B64FF","#FA28FF","#000000","#666666","#B3B3B3","#9F0500","#C45100","#FB9E00","#808900","#194D33","#0C797D","#0062B1","#653294","#AB149E"],styles:{}};Dn(lm);var mH=function(t){var n=t.hover,r=t.color,i=t.onClick,s=t.onSwatchHover,a={position:"relative",zIndex:"2",outline:"2px solid #fff",boxShadow:"0 0 5px 2px rgba(0,0,0,0.25)"},l=rt({default:{swatch:{width:"25px",height:"25px",fontSize:"0"}},hover:{swatch:a}},{hover:n});return L.createElement("div",{style:l.swatch},L.createElement(Ds,{color:r,onClick:i,onHover:s,focusStyle:a}))};const gH=Vf(mH);var cm=function(t){var n=t.width,r=t.colors,i=t.onChange,s=t.onSwatchHover,a=t.triangle,l=t.styles,c=l===void 0?{}:l,d=t.className,u=d===void 0?"":d,p=rt(In({default:{card:{width:n,background:"#fff",border:"1px solid rgba(0,0,0,0.2)",boxShadow:"0 3px 12px rgba(0,0,0,0.15)",borderRadius:"4px",position:"relative",padding:"5px",display:"flex",flexWrap:"wrap"},triangle:{position:"absolute",border:"7px solid transparent",borderBottomColor:"#fff"},triangleShadow:{position:"absolute",border:"8px solid transparent",borderBottomColor:"rgba(0,0,0,0.15)"}},"hide-triangle":{triangle:{display:"none"},triangleShadow:{display:"none"}},"top-left-triangle":{triangle:{top:"-14px",left:"10px"},triangleShadow:{top:"-16px",left:"9px"}},"top-right-triangle":{triangle:{top:"-14px",right:"10px"},triangleShadow:{top:"-16px",right:"9px"}},"bottom-left-triangle":{triangle:{top:"35px",left:"10px",transform:"rotate(180deg)"},triangleShadow:{top:"37px",left:"9px",transform:"rotate(180deg)"}},"bottom-right-triangle":{triangle:{top:"35px",right:"10px",transform:"rotate(180deg)"},triangleShadow:{top:"37px",right:"9px",transform:"rotate(180deg)"}}},c),{"hide-triangle":a==="hide","top-left-triangle":a==="top-left","top-right-triangle":a==="top-right","bottom-left-triangle":a==="bottom-left","bottom-right-triangle":a==="bottom-right"}),h=function(m,g){return i({hex:m,source:"hex"},g)};return L.createElement("div",{style:p.card,className:"github-picker "+u},L.createElement("div",{style:p.triangleShadow}),L.createElement("div",{style:p.triangle}),zs(r,function(f){return L.createElement(gH,{color:f,key:f,onClick:h,onSwatchHover:s})}))};cm.propTypes={width:Oe.oneOfType([Oe.string,Oe.number]),colors:Oe.arrayOf(Oe.string),triangle:Oe.oneOf(["hide","top-left","top-right","bottom-left","bottom-right"]),styles:Oe.object};cm.defaultProps={width:200,colors:["#B80000","#DB3E00","#FCCB00","#008B02","#006B76","#1273DE","#004DCF","#5300EB","#EB9694","#FAD0C3","#FEF3BD","#C1E1C5","#BEDADC","#C4DEF6","#BED3F3","#D4C4FB"],triangle:"top-left",styles:{}};Dn(cm);var vH=function(t){var n=t.direction,r=rt({default:{picker:{width:"18px",height:"18px",borderRadius:"50%",transform:"translate(-9px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}},vertical:{picker:{transform:"translate(-3px, -9px)"}}},{vertical:n==="vertical"});return L.createElement("div",{style:r.picker})},yH=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},dm=function(t){var n=t.width,r=t.height,i=t.onChange,s=t.hsl,a=t.direction,l=t.pointer,c=t.styles,d=c===void 0?{}:c,u=t.className,p=u===void 0?"":u,h=rt(In({default:{picker:{position:"relative",width:n,height:r},hue:{radius:"2px"}}},d)),f=function(g){return i({a:1,h:g.h,l:.5,s:1})};return L.createElement("div",{style:h.picker,className:"hue-picker "+p},L.createElement(ia,yH({},h.hue,{hsl:s,pointer:l,onChange:f,direction:a})))};dm.propTypes={styles:Oe.object};dm.defaultProps={width:"316px",height:"16px",direction:"horizontal",pointer:vH,styles:{}};Dn(dm);var xH=function(t){var n=t.onChange,r=t.hex,i=t.rgb,s=t.styles,a=s===void 0?{}:s,l=t.className,c=l===void 0?"":l,d=rt(In({default:{material:{width:"98px",height:"98px",padding:"16px",fontFamily:"Roboto"},HEXwrap:{position:"relative"},HEXinput:{width:"100%",marginTop:"12px",fontSize:"15px",color:"#333",padding:"0px",border:"0px",borderBottom:"2px solid "+r,outline:"none",height:"30px"},HEXlabel:{position:"absolute",top:"0px",left:"0px",fontSize:"11px",color:"#999999",textTransform:"capitalize"},Hex:{style:{}},RGBwrap:{position:"relative"},RGBinput:{width:"100%",marginTop:"12px",fontSize:"15px",color:"#333",padding:"0px",border:"0px",borderBottom:"1px solid #eee",outline:"none",height:"30px"},RGBlabel:{position:"absolute",top:"0px",left:"0px",fontSize:"11px",color:"#999999",textTransform:"capitalize"},split:{display:"flex",marginRight:"-10px",paddingTop:"11px"},third:{flex:"1",paddingRight:"10px"}}},a)),u=function(h,f){h.hex?Qi(h.hex)&&n({hex:h.hex,source:"hex"},f):(h.r||h.g||h.b)&&n({r:h.r||i.r,g:h.g||i.g,b:h.b||i.b,source:"rgb"},f)};return L.createElement(Rl,{styles:a},L.createElement("div",{style:d.material,className:"material-picker "+c},L.createElement(ut,{style:{wrap:d.HEXwrap,input:d.HEXinput,label:d.HEXlabel},label:"hex",value:r,onChange:u}),L.createElement("div",{style:d.split,className:"flexbox-fix"},L.createElement("div",{style:d.third},L.createElement(ut,{style:{wrap:d.RGBwrap,input:d.RGBinput,label:d.RGBlabel},label:"r",value:i.r,onChange:u})),L.createElement("div",{style:d.third},L.createElement(ut,{style:{wrap:d.RGBwrap,input:d.RGBinput,label:d.RGBlabel},label:"g",value:i.g,onChange:u})),L.createElement("div",{style:d.third},L.createElement(ut,{style:{wrap:d.RGBwrap,input:d.RGBinput,label:d.RGBlabel},label:"b",value:i.b,onChange:u})))))};Dn(xH);var bH=function(t){var n=t.onChange,r=t.rgb,i=t.hsv,s=t.hex,a=rt({default:{fields:{paddingTop:"5px",paddingBottom:"9px",width:"80px",position:"relative"},divider:{height:"5px"},RGBwrap:{position:"relative"},RGBinput:{marginLeft:"40%",width:"40%",height:"18px",border:"1px solid #888888",boxShadow:"inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC",marginBottom:"5px",fontSize:"13px",paddingLeft:"3px",marginRight:"10px"},RGBlabel:{left:"0px",top:"0px",width:"34px",textTransform:"uppercase",fontSize:"13px",height:"18px",lineHeight:"22px",position:"absolute"},HEXwrap:{position:"relative"},HEXinput:{marginLeft:"20%",width:"80%",height:"18px",border:"1px solid #888888",boxShadow:"inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC",marginBottom:"6px",fontSize:"13px",paddingLeft:"3px"},HEXlabel:{position:"absolute",top:"0px",left:"0px",width:"14px",textTransform:"uppercase",fontSize:"13px",height:"18px",lineHeight:"22px"},fieldSymbols:{position:"absolute",top:"5px",right:"-7px",fontSize:"13px"},symbol:{height:"20px",lineHeight:"22px",paddingBottom:"7px"}}}),l=function(d,u){d["#"]?Qi(d["#"])&&n({hex:d["#"],source:"hex"},u):d.r||d.g||d.b?n({r:d.r||r.r,g:d.g||r.g,b:d.b||r.b,source:"rgb"},u):(d.h||d.s||d.v)&&n({h:d.h||i.h,s:d.s||i.s,v:d.v||i.v,source:"hsv"},u)};return L.createElement("div",{style:a.fields},L.createElement(ut,{style:{wrap:a.RGBwrap,input:a.RGBinput,label:a.RGBlabel},label:"h",value:Math.round(i.h),onChange:l}),L.createElement(ut,{style:{wrap:a.RGBwrap,input:a.RGBinput,label:a.RGBlabel},label:"s",value:Math.round(i.s*100),onChange:l}),L.createElement(ut,{style:{wrap:a.RGBwrap,input:a.RGBinput,label:a.RGBlabel},label:"v",value:Math.round(i.v*100),onChange:l}),L.createElement("div",{style:a.divider}),L.createElement(ut,{style:{wrap:a.RGBwrap,input:a.RGBinput,label:a.RGBlabel},label:"r",value:r.r,onChange:l}),L.createElement(ut,{style:{wrap:a.RGBwrap,input:a.RGBinput,label:a.RGBlabel},label:"g",value:r.g,onChange:l}),L.createElement(ut,{style:{wrap:a.RGBwrap,input:a.RGBinput,label:a.RGBlabel},label:"b",value:r.b,onChange:l}),L.createElement("div",{style:a.divider}),L.createElement(ut,{style:{wrap:a.HEXwrap,input:a.HEXinput,label:a.HEXlabel},label:"#",value:s.replace("#",""),onChange:l}),L.createElement("div",{style:a.fieldSymbols},L.createElement("div",{style:a.symbol},""),L.createElement("div",{style:a.symbol},"%"),L.createElement("div",{style:a.symbol},"%")))},wH=function(t){var n=t.hsl,r=rt({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",boxShadow:"inset 0 0 0 1px #fff",transform:"translate(-6px, -6px)"}},"black-outline":{picker:{boxShadow:"inset 0 0 0 1px #000"}}},{"black-outline":n.l>.5});return L.createElement("div",{style:r.picker})},_H=function(){var t=rt({default:{triangle:{width:0,height:0,borderStyle:"solid",borderWidth:"4px 0 4px 6px",borderColor:"transparent transparent transparent #fff",position:"absolute",top:"1px",left:"1px"},triangleBorder:{width:0,height:0,borderStyle:"solid",borderWidth:"5px 0 5px 8px",borderColor:"transparent transparent transparent #555"},left:{Extend:"triangleBorder",transform:"translate(-13px, -4px)"},leftInside:{Extend:"triangle",transform:"translate(-8px, -5px)"},right:{Extend:"triangleBorder",transform:"translate(20px, -14px) rotate(180deg)"},rightInside:{Extend:"triangle",transform:"translate(-8px, -5px)"}}});return L.createElement("div",{style:t.pointer},L.createElement("div",{style:t.left},L.createElement("div",{style:t.leftInside})),L.createElement("div",{style:t.right},L.createElement("div",{style:t.rightInside})))},cy=function(t){var n=t.onClick,r=t.label,i=t.children,s=t.active,a=rt({default:{button:{backgroundImage:"linear-gradient(-180deg, #FFFFFF 0%, #E6E6E6 100%)",border:"1px solid #878787",borderRadius:"2px",height:"20px",boxShadow:"0 1px 0 0 #EAEAEA",fontSize:"14px",color:"#000",lineHeight:"20px",textAlign:"center",marginBottom:"10px",cursor:"pointer"}},active:{button:{boxShadow:"0 0 0 1px #878787"}}},{active:s});return L.createElement("div",{style:a.button,onClick:n},r||i)},SH=function(t){var n=t.rgb,r=t.currentColor,i=rt({default:{swatches:{border:"1px solid #B3B3B3",borderBottom:"1px solid #F0F0F0",marginBottom:"2px",marginTop:"1px"},new:{height:"34px",background:"rgb("+n.r+","+n.g+", "+n.b+")",boxShadow:"inset 1px 0 0 #000, inset -1px 0 0 #000, inset 0 1px 0 #000"},current:{height:"34px",background:r,boxShadow:"inset 1px 0 0 #000, inset -1px 0 0 #000, inset 0 -1px 0 #000"},label:{fontSize:"14px",color:"#000",textAlign:"center"}}});return L.createElement("div",null,L.createElement("div",{style:i.label},"new"),L.createElement("div",{style:i.swatches},L.createElement("div",{style:i.new}),L.createElement("div",{style:i.current})),L.createElement("div",{style:i.label},"current"))},kH=function(){function e(t,n){for(var r=0;r<n.length;r++){var i=n[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function jH(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CH(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e}function EH(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var um=function(e){EH(t,e);function t(n){jH(this,t);var r=CH(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.state={currentColor:n.hex},r}return kH(t,[{key:"render",value:function(){var r=this.props,i=r.styles,s=i===void 0?{}:i,a=r.className,l=a===void 0?"":a,c=rt(In({default:{picker:{background:"#DCDCDC",borderRadius:"4px",boxShadow:"0 0 0 1px rgba(0,0,0,.25), 0 8px 16px rgba(0,0,0,.15)",boxSizing:"initial",width:"513px"},head:{backgroundImage:"linear-gradient(-180deg, #F0F0F0 0%, #D4D4D4 100%)",borderBottom:"1px solid #B1B1B1",boxShadow:"inset 0 1px 0 0 rgba(255,255,255,.2), inset 0 -1px 0 0 rgba(0,0,0,.02)",height:"23px",lineHeight:"24px",borderRadius:"4px 4px 0 0",fontSize:"13px",color:"#4D4D4D",textAlign:"center"},body:{padding:"15px 15px 0",display:"flex"},saturation:{width:"256px",height:"256px",position:"relative",border:"2px solid #B3B3B3",borderBottom:"2px solid #F0F0F0",overflow:"hidden"},hue:{position:"relative",height:"256px",width:"19px",marginLeft:"10px",border:"2px solid #B3B3B3",borderBottom:"2px solid #F0F0F0"},controls:{width:"180px",marginLeft:"10px"},top:{display:"flex"},previews:{width:"60px"},actions:{flex:"1",marginLeft:"20px"}}},s));return L.createElement("div",{style:c.picker,className:"photoshop-picker "+l},L.createElement("div",{style:c.head},this.props.header),L.createElement("div",{style:c.body,className:"flexbox-fix"},L.createElement("div",{style:c.saturation},L.createElement(Xd,{hsl:this.props.hsl,hsv:this.props.hsv,pointer:wH,onChange:this.props.onChange})),L.createElement("div",{style:c.hue},L.createElement(ia,{direction:"vertical",hsl:this.props.hsl,pointer:_H,onChange:this.props.onChange})),L.createElement("div",{style:c.controls},L.createElement("div",{style:c.top,className:"flexbox-fix"},L.createElement("div",{style:c.previews},L.createElement(SH,{rgb:this.props.rgb,currentColor:this.state.currentColor})),L.createElement("div",{style:c.actions},L.createElement(cy,{label:"OK",onClick:this.props.onAccept,active:!0}),L.createElement(cy,{label:"Cancel",onClick:this.props.onCancel}),L.createElement(bH,{onChange:this.props.onChange,rgb:this.props.rgb,hsv:this.props.hsv,hex:this.props.hex}))))))}}]),t}(L.Component);um.propTypes={header:Oe.string,styles:Oe.object};um.defaultProps={header:"Color Picker",styles:{}};Dn(um);var TH=function(t){var n=t.onChange,r=t.rgb,i=t.hsl,s=t.hex,a=t.disableAlpha,l=rt({default:{fields:{display:"flex",paddingTop:"4px"},single:{flex:"1",paddingLeft:"6px"},alpha:{flex:"1",paddingLeft:"6px"},double:{flex:"2"},input:{width:"80%",padding:"4px 10% 3px",border:"none",boxShadow:"inset 0 0 0 1px #ccc",fontSize:"11px"},label:{display:"block",textAlign:"center",fontSize:"11px",color:"#222",paddingTop:"3px",paddingBottom:"4px",textTransform:"capitalize"}},disableAlpha:{alpha:{display:"none"}}},{disableAlpha:a}),c=function(u,p){u.hex?Qi(u.hex)&&n({hex:u.hex,source:"hex"},p):u.r||u.g||u.b?n({r:u.r||r.r,g:u.g||r.g,b:u.b||r.b,a:r.a,source:"rgb"},p):u.a&&(u.a<0?u.a=0:u.a>100&&(u.a=100),u.a/=100,n({h:i.h,s:i.s,l:i.l,a:u.a,source:"rgb"},p))};return L.createElement("div",{style:l.fields,className:"flexbox-fix"},L.createElement("div",{style:l.double},L.createElement(ut,{style:{input:l.input,label:l.label},label:"hex",value:s.replace("#",""),onChange:c})),L.createElement("div",{style:l.single},L.createElement(ut,{style:{input:l.input,label:l.label},label:"r",value:r.r,onChange:c,dragLabel:"true",dragMax:"255"})),L.createElement("div",{style:l.single},L.createElement(ut,{style:{input:l.input,label:l.label},label:"g",value:r.g,onChange:c,dragLabel:"true",dragMax:"255"})),L.createElement("div",{style:l.single},L.createElement(ut,{style:{input:l.input,label:l.label},label:"b",value:r.b,onChange:c,dragLabel:"true",dragMax:"255"})),L.createElement("div",{style:l.alpha},L.createElement(ut,{style:{input:l.input,label:l.label},label:"a",value:Math.round(r.a*100),onChange:c,dragLabel:"true",dragMax:"100"})))},NH=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},g_=function(t){var n=t.colors,r=t.onClick,i=r===void 0?function(){}:r,s=t.onSwatchHover,a=rt({default:{colors:{margin:"0 -10px",padding:"10px 0 0 10px",borderTop:"1px solid #eee",display:"flex",flexWrap:"wrap",position:"relative"},swatchWrap:{width:"16px",height:"16px",margin:"0 10px 10px 0"},swatch:{borderRadius:"3px",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15)"}},"no-presets":{colors:{display:"none"}}},{"no-presets":!n||!n.length}),l=function(d,u){i({hex:d,source:"hex"},u)};return L.createElement("div",{style:a.colors,className:"flexbox-fix"},n.map(function(c){var d=typeof c=="string"?{color:c}:c,u=""+d.color+(d.title||"");return L.createElement("div",{key:u,style:a.swatchWrap},L.createElement(Ds,NH({},d,{style:a.swatch,onClick:l,onHover:s,focusStyle:{boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15), 0 0 4px "+d.color}})))}))};g_.propTypes={colors:Oe.arrayOf(Oe.oneOfType([Oe.string,Oe.shape({color:Oe.string,title:Oe.string})])).isRequired};var PH=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},hm=function(t){var n=t.width,r=t.rgb,i=t.hex,s=t.hsv,a=t.hsl,l=t.onChange,c=t.onSwatchHover,d=t.disableAlpha,u=t.presetColors,p=t.renderers,h=t.styles,f=h===void 0?{}:h,m=t.className,g=m===void 0?"":m,x=rt(In({default:PH({picker:{width:n,padding:"10px 10px 0",boxSizing:"initial",background:"#fff",borderRadius:"4px",boxShadow:"0 0 0 1px rgba(0,0,0,.15), 0 8px 16px rgba(0,0,0,.15)"},saturation:{width:"100%",paddingBottom:"75%",position:"relative",overflow:"hidden"},Saturation:{radius:"3px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},controls:{display:"flex"},sliders:{padding:"4px 0",flex:"1"},color:{width:"24px",height:"24px",position:"relative",marginTop:"4px",marginLeft:"4px",borderRadius:"3px"},activeColor:{absolute:"0px 0px 0px 0px",borderRadius:"2px",background:"rgba("+r.r+","+r.g+","+r.b+","+r.a+")",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},hue:{position:"relative",height:"10px",overflow:"hidden"},Hue:{radius:"2px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},alpha:{position:"relative",height:"10px",marginTop:"4px",overflow:"hidden"},Alpha:{radius:"2px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"}},f),disableAlpha:{color:{height:"10px"},hue:{height:"10px"},alpha:{display:"none"}}},f),{disableAlpha:d});return L.createElement("div",{style:x.picker,className:"sketch-picker "+g},L.createElement("div",{style:x.saturation},L.createElement(Xd,{style:x.Saturation,hsl:a,hsv:s,onChange:l})),L.createElement("div",{style:x.controls,className:"flexbox-fix"},L.createElement("div",{style:x.sliders},L.createElement("div",{style:x.hue},L.createElement(ia,{style:x.Hue,hsl:a,onChange:l})),L.createElement("div",{style:x.alpha},L.createElement(qf,{style:x.Alpha,rgb:r,hsl:a,renderers:p,onChange:l}))),L.createElement("div",{style:x.color},L.createElement(ra,null),L.createElement("div",{style:x.activeColor}))),L.createElement(TH,{rgb:r,hsl:a,hex:i,onChange:l,disableAlpha:d}),L.createElement(g_,{colors:u,onClick:l,onSwatchHover:c}))};hm.propTypes={disableAlpha:Oe.bool,width:Oe.oneOfType([Oe.string,Oe.number]),styles:Oe.object};hm.defaultProps={disableAlpha:!1,width:200,styles:{},presetColors:["#D0021B","#F5A623","#F8E71C","#8B572A","#7ED321","#417505","#BD10E0","#9013FE","#4A90E2","#50E3C2","#B8E986","#000000","#4A4A4A","#9B9B9B","#FFFFFF"]};Dn(hm);var Sa=function(t){var n=t.hsl,r=t.offset,i=t.onClick,s=i===void 0?function(){}:i,a=t.active,l=t.first,c=t.last,d=rt({default:{swatch:{height:"12px",background:"hsl("+n.h+", 50%, "+r*100+"%)",cursor:"pointer"}},first:{swatch:{borderRadius:"2px 0 0 2px"}},last:{swatch:{borderRadius:"0 2px 2px 0"}},active:{swatch:{transform:"scaleY(1.8)",borderRadius:"3.6px/2px"}}},{active:a,first:l,last:c}),u=function(h){return s({h:n.h,s:.5,l:r,source:"hsl"},h)};return L.createElement("div",{style:d.swatch,onClick:u})},RH=function(t){var n=t.onClick,r=t.hsl,i=rt({default:{swatches:{marginTop:"20px"},swatch:{boxSizing:"border-box",width:"20%",paddingRight:"1px",float:"left"},clear:{clear:"both"}}}),s=.1;return L.createElement("div",{style:i.swatches},L.createElement("div",{style:i.swatch},L.createElement(Sa,{hsl:r,offset:".80",active:Math.abs(r.l-.8)<s&&Math.abs(r.s-.5)<s,onClick:n,first:!0})),L.createElement("div",{style:i.swatch},L.createElement(Sa,{hsl:r,offset:".65",active:Math.abs(r.l-.65)<s&&Math.abs(r.s-.5)<s,onClick:n})),L.createElement("div",{style:i.swatch},L.createElement(Sa,{hsl:r,offset:".50",active:Math.abs(r.l-.5)<s&&Math.abs(r.s-.5)<s,onClick:n})),L.createElement("div",{style:i.swatch},L.createElement(Sa,{hsl:r,offset:".35",active:Math.abs(r.l-.35)<s&&Math.abs(r.s-.5)<s,onClick:n})),L.createElement("div",{style:i.swatch},L.createElement(Sa,{hsl:r,offset:".20",active:Math.abs(r.l-.2)<s&&Math.abs(r.s-.5)<s,onClick:n,last:!0})),L.createElement("div",{style:i.clear}))},OH=function(){var t=rt({default:{picker:{width:"14px",height:"14px",borderRadius:"6px",transform:"translate(-7px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}}});return L.createElement("div",{style:t.picker})},pm=function(t){var n=t.hsl,r=t.onChange,i=t.pointer,s=t.styles,a=s===void 0?{}:s,l=t.className,c=l===void 0?"":l,d=rt(In({default:{hue:{height:"12px",position:"relative"},Hue:{radius:"2px"}}},a));return L.createElement("div",{style:d.wrap||{},className:"slider-picker "+c},L.createElement("div",{style:d.hue},L.createElement(ia,{style:d.Hue,hsl:n,pointer:i,onChange:r})),L.createElement("div",{style:d.swatches},L.createElement(RH,{hsl:n,onClick:r})))};pm.propTypes={styles:Oe.object};pm.defaultProps={pointer:OH,styles:{}};Dn(pm);var v_={};Object.defineProperty(v_,"__esModule",{value:!0});var dy=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},AH=R,uy=MH(AH);function MH(e){return e&&e.__esModule?e:{default:e}}function $H(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}var fc=24,LH=v_.default=function(e){var t=e.fill,n=t===void 0?"currentColor":t,r=e.width,i=r===void 0?fc:r,s=e.height,a=s===void 0?fc:s,l=e.style,c=l===void 0?{}:l,d=$H(e,["fill","width","height","style"]);return uy.default.createElement("svg",dy({viewBox:"0 0 "+fc+" "+fc,style:dy({fill:n,width:i,height:a},c)},d),uy.default.createElement("path",{d:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"}))},IH=function(t){var n=t.color,r=t.onClick,i=r===void 0?function(){}:r,s=t.onSwatchHover,a=t.first,l=t.last,c=t.active,d=rt({default:{color:{width:"40px",height:"24px",cursor:"pointer",background:n,marginBottom:"1px"},check:{color:tm(n),marginLeft:"8px",display:"none"}},first:{color:{overflow:"hidden",borderRadius:"2px 2px 0 0"}},last:{color:{overflow:"hidden",borderRadius:"0 0 2px 2px"}},active:{check:{display:"block"}},"color-#FFFFFF":{color:{boxShadow:"inset 0 0 0 1px #ddd"},check:{color:"#333"}},transparent:{check:{color:"#333"}}},{first:a,last:l,active:c,"color-#FFFFFF":n==="#FFFFFF",transparent:n==="transparent"});return L.createElement(Ds,{color:n,style:d.color,onClick:i,onHover:s,focusStyle:{boxShadow:"0 0 4px "+n}},L.createElement("div",{style:d.check},L.createElement(LH,null)))},DH=function(t){var n=t.onClick,r=t.onSwatchHover,i=t.group,s=t.active,a=rt({default:{group:{paddingBottom:"10px",width:"40px",float:"left",marginRight:"10px"}}});return L.createElement("div",{style:a.group},zs(i,function(l,c){return L.createElement(IH,{key:l,color:l,active:l.toLowerCase()===s,first:c===0,last:c===i.length-1,onClick:n,onSwatchHover:r})}))},fm=function(t){var n=t.width,r=t.height,i=t.onChange,s=t.onSwatchHover,a=t.colors,l=t.hex,c=t.styles,d=c===void 0?{}:c,u=t.className,p=u===void 0?"":u,h=rt(In({default:{picker:{width:n,height:r},overflow:{height:r,overflowY:"scroll"},body:{padding:"16px 0 6px 16px"},clear:{clear:"both"}}},d)),f=function(g,x){return i({hex:g,source:"hex"},x)};return L.createElement("div",{style:h.picker,className:"swatches-picker "+p},L.createElement(Rl,null,L.createElement("div",{style:h.overflow},L.createElement("div",{style:h.body},zs(a,function(m){return L.createElement(DH,{key:m.toString(),group:m,active:l,onClick:f,onSwatchHover:s})}),L.createElement("div",{style:h.clear})))))};fm.propTypes={width:Oe.oneOfType([Oe.string,Oe.number]),height:Oe.oneOfType([Oe.string,Oe.number]),colors:Oe.arrayOf(Oe.arrayOf(Oe.string)),styles:Oe.object};fm.defaultProps={width:320,height:240,colors:[[Ks[900],Ks[700],Ks[500],Ks[300],Ks[100]],[Js[900],Js[700],Js[500],Js[300],Js[100]],[Qs[900],Qs[700],Qs[500],Qs[300],Qs[100]],[eo[900],eo[700],eo[500],eo[300],eo[100]],[to[900],to[700],to[500],to[300],to[100]],[no[900],no[700],no[500],no[300],no[100]],[ro[900],ro[700],ro[500],ro[300],ro[100]],[io[900],io[700],io[500],io[300],io[100]],[so[900],so[700],so[500],so[300],so[100]],["#194D33",Aa[700],Aa[500],Aa[300],Aa[100]],[oo[900],oo[700],oo[500],oo[300],oo[100]],[ao[900],ao[700],ao[500],ao[300],ao[100]],[lo[900],lo[700],lo[500],lo[300],lo[100]],[co[900],co[700],co[500],co[300],co[100]],[uo[900],uo[700],uo[500],uo[300],uo[100]],[ho[900],ho[700],ho[500],ho[300],ho[100]],[po[900],po[700],po[500],po[300],po[100]],[fo[900],fo[700],fo[500],fo[300],fo[100]],["#000000","#525252","#969696","#D9D9D9","#FFFFFF"]],styles:{}};Dn(fm);var mm=function(t){var n=t.onChange,r=t.onSwatchHover,i=t.hex,s=t.colors,a=t.width,l=t.triangle,c=t.styles,d=c===void 0?{}:c,u=t.className,p=u===void 0?"":u,h=rt(In({default:{card:{width:a,background:"#fff",border:"0 solid rgba(0,0,0,0.25)",boxShadow:"0 1px 4px rgba(0,0,0,0.25)",borderRadius:"4px",position:"relative"},body:{padding:"15px 9px 9px 15px"},label:{fontSize:"18px",color:"#fff"},triangle:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 9px 10px 9px",borderColor:"transparent transparent #fff transparent",position:"absolute"},triangleShadow:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 9px 10px 9px",borderColor:"transparent transparent rgba(0,0,0,.1) transparent",position:"absolute"},hash:{background:"#F0F0F0",height:"30px",width:"30px",borderRadius:"4px 0 0 4px",float:"left",color:"#98A1A4",display:"flex",alignItems:"center",justifyContent:"center"},input:{width:"100px",fontSize:"14px",color:"#666",border:"0px",outline:"none",height:"28px",boxShadow:"inset 0 0 0 1px #F0F0F0",boxSizing:"content-box",borderRadius:"0 4px 4px 0",float:"left",paddingLeft:"8px"},swatch:{width:"30px",height:"30px",float:"left",borderRadius:"4px",margin:"0 6px 6px 0"},clear:{clear:"both"}},"hide-triangle":{triangle:{display:"none"},triangleShadow:{display:"none"}},"top-left-triangle":{triangle:{top:"-10px",left:"12px"},triangleShadow:{top:"-11px",left:"12px"}},"top-right-triangle":{triangle:{top:"-10px",right:"12px"},triangleShadow:{top:"-11px",right:"12px"}}},d),{"hide-triangle":l==="hide","top-left-triangle":l==="top-left","top-right-triangle":l==="top-right"}),f=function(g,x){Qi(g)&&n({hex:g,source:"hex"},x)};return L.createElement("div",{style:h.card,className:"twitter-picker "+p},L.createElement("div",{style:h.triangleShadow}),L.createElement("div",{style:h.triangle}),L.createElement("div",{style:h.body},zs(s,function(m,g){return L.createElement(Ds,{key:g,color:m,hex:m,style:h.swatch,onClick:f,onHover:r,focusStyle:{boxShadow:"0 0 4px "+m}})}),L.createElement("div",{style:h.hash},"#"),L.createElement(ut,{label:null,style:{input:h.input},value:i.replace("#",""),onChange:f}),L.createElement("div",{style:h.clear})))};mm.propTypes={width:Oe.oneOfType([Oe.string,Oe.number]),triangle:Oe.oneOf(["hide","top-left","top-right"]),colors:Oe.arrayOf(Oe.string),styles:Oe.object};mm.defaultProps={width:276,colors:["#FF6900","#FCB900","#7BDCB5","#00D084","#8ED1FC","#0693E3","#ABB8C3","#EB144C","#F78DA7","#9900EF"],triangle:"top-left",styles:{}};Dn(mm);var gm=function(t){var n=rt({default:{picker:{width:"20px",height:"20px",borderRadius:"22px",border:"2px #fff solid",transform:"translate(-12px, -13px)",background:"hsl("+Math.round(t.hsl.h)+", "+Math.round(t.hsl.s*100)+"%, "+Math.round(t.hsl.l*100)+"%)"}}});return L.createElement("div",{style:n.picker})};gm.propTypes={hsl:Oe.shape({h:Oe.number,s:Oe.number,l:Oe.number,a:Oe.number})};gm.defaultProps={hsl:{a:1,h:249.94,l:.2,s:.5}};var vm=function(t){var n=rt({default:{picker:{width:"20px",height:"20px",borderRadius:"22px",transform:"translate(-10px, -7px)",background:"hsl("+Math.round(t.hsl.h)+", 100%, 50%)",border:"2px white solid"}}});return L.createElement("div",{style:n.picker})};vm.propTypes={hsl:Oe.shape({h:Oe.number,s:Oe.number,l:Oe.number,a:Oe.number})};vm.defaultProps={hsl:{a:1,h:249.94,l:.2,s:.5}};var zH=function(t){var n=t.onChange,r=t.rgb,i=t.hsl,s=t.hex,a=t.hsv,l=function(f,m){if(f.hex)Qi(f.hex)&&n({hex:f.hex,source:"hex"},m);else if(f.rgb){var g=f.rgb.split(",");Zu(f.rgb,"rgb")&&n({r:g[0],g:g[1],b:g[2],a:1,source:"rgb"},m)}else if(f.hsv){var x=f.hsv.split(",");Zu(f.hsv,"hsv")&&(x[2]=x[2].replace("%",""),x[1]=x[1].replace("%",""),x[0]=x[0].replace("",""),x[1]==1?x[1]=.01:x[2]==1&&(x[2]=.01),n({h:Number(x[0]),s:Number(x[1]),v:Number(x[2]),source:"hsv"},m))}else if(f.hsl){var y=f.hsl.split(",");Zu(f.hsl,"hsl")&&(y[2]=y[2].replace("%",""),y[1]=y[1].replace("%",""),y[0]=y[0].replace("",""),p[1]==1?p[1]=.01:p[2]==1&&(p[2]=.01),n({h:Number(y[0]),s:Number(y[1]),v:Number(y[2]),source:"hsl"},m))}},c=rt({default:{wrap:{display:"flex",height:"100px",marginTop:"4px"},fields:{width:"100%"},column:{paddingTop:"10px",display:"flex",justifyContent:"space-between"},double:{padding:"0px 4.4px",boxSizing:"border-box"},input:{width:"100%",height:"38px",boxSizing:"border-box",padding:"4px 10% 3px",textAlign:"center",border:"1px solid #dadce0",fontSize:"11px",textTransform:"lowercase",borderRadius:"5px",outline:"none",fontFamily:"Roboto,Arial,sans-serif"},input2:{height:"38px",width:"100%",border:"1px solid #dadce0",boxSizing:"border-box",fontSize:"11px",textTransform:"lowercase",borderRadius:"5px",outline:"none",paddingLeft:"10px",fontFamily:"Roboto,Arial,sans-serif"},label:{textAlign:"center",fontSize:"12px",background:"#fff",position:"absolute",textTransform:"uppercase",color:"#3c4043",width:"35px",top:"-6px",left:"0",right:"0",marginLeft:"auto",marginRight:"auto",fontFamily:"Roboto,Arial,sans-serif"},label2:{left:"10px",textAlign:"center",fontSize:"12px",background:"#fff",position:"absolute",textTransform:"uppercase",color:"#3c4043",width:"32px",top:"-6px",fontFamily:"Roboto,Arial,sans-serif"},single:{flexGrow:"1",margin:"0px 4.4px"}}}),d=r.r+", "+r.g+", "+r.b,u=Math.round(i.h)+", "+Math.round(i.s*100)+"%, "+Math.round(i.l*100)+"%",p=Math.round(a.h)+", "+Math.round(a.s*100)+"%, "+Math.round(a.v*100)+"%";return L.createElement("div",{style:c.wrap,className:"flexbox-fix"},L.createElement("div",{style:c.fields},L.createElement("div",{style:c.double},L.createElement(ut,{style:{input:c.input,label:c.label},label:"hex",value:s,onChange:l})),L.createElement("div",{style:c.column},L.createElement("div",{style:c.single},L.createElement(ut,{style:{input:c.input2,label:c.label2},label:"rgb",value:d,onChange:l})),L.createElement("div",{style:c.single},L.createElement(ut,{style:{input:c.input2,label:c.label2},label:"hsv",value:p,onChange:l})),L.createElement("div",{style:c.single},L.createElement(ut,{style:{input:c.input2,label:c.label2},label:"hsl",value:u,onChange:l})))))},ym=function(t){var n=t.width,r=t.onChange,i=t.rgb,s=t.hsl,a=t.hsv,l=t.hex,c=t.header,d=t.styles,u=d===void 0?{}:d,p=t.className,h=p===void 0?"":p,f=rt(In({default:{picker:{width:n,background:"#fff",border:"1px solid #dfe1e5",boxSizing:"initial",display:"flex",flexWrap:"wrap",borderRadius:"8px 8px 0px 0px"},head:{height:"57px",width:"100%",paddingTop:"16px",paddingBottom:"16px",paddingLeft:"16px",fontSize:"20px",boxSizing:"border-box",fontFamily:"Roboto-Regular,HelveticaNeue,Arial,sans-serif"},saturation:{width:"70%",padding:"0px",position:"relative",overflow:"hidden"},swatch:{width:"30%",height:"228px",padding:"0px",background:"rgba("+i.r+", "+i.g+", "+i.b+", 1)",position:"relative",overflow:"hidden"},body:{margin:"auto",width:"95%"},controls:{display:"flex",boxSizing:"border-box",height:"52px",paddingTop:"22px"},color:{width:"32px"},hue:{height:"8px",position:"relative",margin:"0px 16px 0px 16px",width:"100%"},Hue:{radius:"2px"}}},u));return L.createElement("div",{style:f.picker,className:"google-picker "+h},L.createElement("div",{style:f.head},c),L.createElement("div",{style:f.swatch}),L.createElement("div",{style:f.saturation},L.createElement(Xd,{hsl:s,hsv:a,pointer:gm,onChange:r})),L.createElement("div",{style:f.body},L.createElement("div",{style:f.controls,className:"flexbox-fix"},L.createElement("div",{style:f.hue},L.createElement(ia,{style:f.Hue,hsl:s,radius:"4px",pointer:vm,onChange:r}))),L.createElement(zH,{rgb:i,hsl:s,hex:l,hsv:a,onChange:r})))};ym.propTypes={width:Oe.oneOfType([Oe.string,Oe.number]),styles:Oe.object,header:Oe.string};ym.defaultProps={width:652,styles:{},header:"Color picker"};Dn(ym);function FH({color:e,mode:t="blend",onColorChange:n,onClose:r}){var u;const[i,s]=R.useState((e==null?void 0:e.hex)||"#000000");R.useEffect(()=>{e!=null&&e.hex&&s(e.hex)},[e==null?void 0:e.hex]);const a=()=>{e!=null&&e.originalHex&&(s(e.originalHex),n&&n(e.originalHex))},l=p=>{const h=p.hex;s(h),n&&n(h)},c=()=>{s("transparent"),n&&n("transparent")},d=i==="transparent"||i==="none";return e?o.jsxs("div",{className:"color-editor-panel",children:[o.jsxs("div",{className:"editor-header",children:[o.jsx("h3",{children:"Edit Colour"}),o.jsx("button",{onClick:r,className:"close-button",children:""})]}),o.jsxs("div",{className:"editor-content",children:[o.jsxs("div",{className:"color-info-section",children:[o.jsx("div",{className:"color-display",children:o.jsxs("div",{className:"swatch-pair",children:[o.jsxs("div",{className:"swatch-group",children:[o.jsx("div",{className:"swatch original",style:{backgroundColor:e.originalHex||e.hex},title:"Original colour"}),o.jsx("span",{className:"swatch-label",children:"Original"})]}),o.jsx("span",{className:"arrow",children:""}),o.jsxs("div",{className:"swatch-group",children:[o.jsx("div",{className:`swatch current ${d?"transparent-preview":""}`,style:d?{}:{backgroundColor:i},title:"Current colour"}),o.jsx("span",{className:"swatch-label",children:d?"Transparent":"Current"})]})]})}),o.jsxs("div",{className:"color-details",children:[o.jsxs("div",{className:"detail-row",children:[o.jsx("span",{className:"label",children:"Hex:"}),o.jsx("span",{className:"value",children:i})]}),o.jsxs("div",{className:"detail-row",children:[o.jsx("span",{className:"label",children:"Coverage:"}),o.jsxs("span",{className:"value",children:[((u=e.areaPct)==null?void 0:u.toFixed(1))||0,"%"]})]})]})]}),o.jsxs("div",{className:"transparent-section",children:[o.jsx("h4",{children:"Remove Fill"}),o.jsxs("button",{className:`transparent-option ${d?"selected":""}`,onClick:c,title:"Make this area transparent (remove fill)",children:[o.jsx("div",{className:"transparent-swatch"}),o.jsx("span",{children:"Make Transparent"})]})]}),o.jsxs("div",{className:"tpv-palette-section",children:[o.jsx("h4",{children:"Standard TPV Colours"}),o.jsx("p",{className:"palette-description",children:"Select a pure TPV colour (no blending required)"}),o.jsx("div",{className:"tpv-color-grid",children:dn.map(p=>o.jsxs("div",{className:`tpv-color-item ${i.toLowerCase()===p.hex.toLowerCase()?"selected":""}`,onClick:()=>l(p),title:`${p.code} - ${p.name}`,children:[o.jsx("div",{className:"tpv-color-swatch",style:{backgroundColor:p.hex}}),o.jsx("span",{className:"tpv-color-code",children:p.code})]},p.code))})]}),gs.BLEND_MODE_ENABLED,o.jsxs("div",{className:"solid-mode-info",children:[o.jsx("h4",{children:"Solid Mode Editing"}),o.jsx("p",{className:"info-description",children:"Select from the standard TPV colours above. Only solid TPV colours are available."}),o.jsx("button",{onClick:a,className:"reset-button",children:"Reset to Original Colour"})]})]}),o.jsx("style",{jsx:!0,children:`
        .color-editor-panel {
          position: fixed;
          top: 0;
          right: 0;
          width: 400px;
          height: 100vh;
          background: white;
          box-shadow: -4px 0 12px rgba(0, 0, 0, 0.15);
          z-index: 1000;
          display: flex;
          flex-direction: column;
          overflow: hidden;
        }

        .editor-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 1.5rem;
          border-bottom: 2px solid #1a365d;
          background: #f9f9f9;
        }

        .editor-header h3 {
          font-family: 'Overpass', sans-serif;
          margin: 0;
          color: #1e4a7a;
          font-size: 1.5rem;
          font-weight: 600;
        }

        .close-button {
          background: none;
          border: none;
          font-size: 2rem;
          color: #666;
          cursor: pointer;
          padding: 0;
          width: 32px;
          height: 32px;
          line-height: 1;
          transition: color 0.2s;
        }

        .close-button:hover {
          color: #333;
        }

        .editor-content {
          flex: 1;
          overflow-y: auto;
          padding: 1.5rem;
        }

        /* Color Info Section */
        .color-info-section {
          margin-bottom: 2rem;
          padding: 1rem;
          background: #f9f9f9;
          border-radius: 6px;
        }

        .color-display {
          margin-bottom: 1rem;
        }

        .swatch-pair {
          display: flex;
          align-items: center;
          gap: 1rem;
          justify-content: center;
        }

        .swatch-group {
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 0.5rem;
        }

        .swatch {
          width: 60px;
          height: 60px;
          border-radius: 8px;
          border: 3px solid #ddd;
          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .swatch.original {
          border-color: #999;
        }

        .swatch.current {
          border-color: #ff6b35;
        }

        .swatch.transparent-preview {
          background:
            linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%),
            linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%);
          background-size: 10px 10px;
          background-position: 0 0, 5px 5px;
          background-color: white;
        }

        .swatch-label {
          font-size: 0.85rem;
          color: #666;
          font-weight: 500;
        }

        .arrow {
          font-size: 1.5rem;
          color: #666;
          font-weight: bold;
        }

        .color-details {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .detail-row {
          display: flex;
          justify-content: space-between;
          align-items: center;
          font-size: 0.95rem;
        }

        .detail-row .label {
          font-weight: 600;
          color: #666;
        }

        .detail-row .value {
          font-family: 'Courier New', monospace;
          color: #333;
        }

        /* Transparent Section */
        .transparent-section {
          margin-bottom: 1.5rem;
          padding: 1rem;
          background: #f9f9f9;
          border-radius: 6px;
        }

        .transparent-section h4 {
          margin: 0 0 0.75rem 0;
          color: #1a365d;
          font-size: 1rem;
          font-weight: 600;
        }

        .transparent-option {
          display: flex;
          align-items: center;
          gap: 12px;
          width: 100%;
          padding: 12px 16px;
          background: white;
          border: 2px solid #d1d5db;
          border-radius: 8px;
          cursor: pointer;
          transition: all 0.2s;
          font-size: 0.95rem;
          font-weight: 500;
          color: #374151;
        }

        .transparent-option:hover {
          border-color: #6b7280;
          background: #fafafa;
        }

        .transparent-option.selected {
          border-color: #ff6b35;
          background: #fff5f0;
          box-shadow: 0 0 0 2px rgba(255, 107, 53, 0.2);
        }

        .transparent-swatch {
          width: 32px;
          height: 32px;
          border-radius: 4px;
          border: 1px solid #999;
          background:
            linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%),
            linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%);
          background-size: 8px 8px;
          background-position: 0 0, 4px 4px;
          background-color: white;
        }

        /* TPV Palette Section */
        .tpv-palette-section {
          margin-bottom: 2rem;
          padding: 1rem;
          background: #f9f9f9;
          border-radius: 6px;
        }

        .tpv-palette-section h4 {
          margin: 0 0 0.5rem 0;
          color: #1a365d;
          font-size: 1rem;
          font-weight: 600;
        }

        .palette-description {
          margin: 0 0 1rem 0;
          font-size: 0.85rem;
          color: #666;
        }

        .tpv-color-grid {
          display: grid;
          grid-template-columns: repeat(3, 1fr);
          gap: 0.75rem;
        }

        .tpv-color-item {
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 0.4rem;
          padding: 0.5rem;
          border: 2px solid transparent;
          border-radius: 6px;
          cursor: pointer;
          transition: all 0.2s;
          background: white;
        }

        .tpv-color-item:hover {
          border-color: #ff6b35;
          transform: translateY(-2px);
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .tpv-color-item.selected {
          border-color: #ff6b35;
          background: #fff5f0;
          box-shadow: 0 0 0 2px rgba(255, 107, 53, 0.2);
        }

        .tpv-color-swatch {
          width: 100%;
          height: 50px;
          border-radius: 4px;
          border: 1px solid rgba(0, 0, 0, 0.1);
          box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .tpv-color-code {
          font-size: 0.75rem;
          font-weight: 600;
          color: #1a365d;
          font-family: 'Courier New', monospace;
        }

        /* Picker Section */
        .picker-section {
          margin-bottom: 1rem;
          padding: 1rem;
          background: #f9f9f9;
          border-radius: 6px;
        }

        .picker-section h4 {
          margin: 0 0 0.5rem 0;
          color: #1a365d;
          font-size: 1rem;
          font-weight: 600;
        }

        .picker-description {
          margin: 0 0 1rem 0;
          font-size: 0.85rem;
          color: #666;
        }

        .picker-section :global(.chrome-picker) {
          box-shadow: none !important;
          width: 100% !important;
        }

        .reset-button {
          width: 100%;
          padding: 0.75rem;
          margin-top: 1rem;
          background: #e0e0e0;
          color: #333;
          border: none;
          border-radius: 4px;
          font-weight: 600;
          cursor: pointer;
          transition: background 0.2s;
        }

        .reset-button:hover {
          background: #d0d0d0;
        }

        /* Solid Mode Info */
        .solid-mode-info {
          margin-bottom: 1rem;
          padding: 1rem;
          background: #fff5f0;
          border: 2px solid #ff6b35;
          border-radius: 6px;
        }

        .solid-mode-info h4 {
          margin: 0 0 0.5rem 0;
          color: #1a365d;
          font-size: 1rem;
          font-weight: 600;
        }

        .info-description {
          margin: 0;
          font-size: 0.85rem;
          color: #666;
          line-height: 1.5;
        }

        /* Mobile Responsive - Fullscreen Modal */
        @media (max-width: 768px) {
          .color-editor-panel {
            width: 100%;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 0;
          }

          .editor-header {
            padding: 1rem;
            position: sticky;
            top: 0;
            z-index: 10;
          }

          .editor-header h3 {
            font-size: 1.25rem;
          }

          /* Larger close button for touch */
          .close-button {
            width: 44px;
            height: 44px;
            font-size: 2.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
          }

          .editor-content {
            padding: 1rem;
          }

          /* Color swatches - larger for touch */
          .swatch {
            width: 50px;
            height: 50px;
          }

          .color-info-section {
            padding: 0.75rem;
            margin-bottom: 1.5rem;
          }

          /* TPV color grid - better touch targets */
          .tpv-color-grid {
            grid-template-columns: repeat(4, 1fr);
            gap: 0.5rem;
          }

          .tpv-color-item {
            padding: 0.4rem;
            min-height: 44px;
          }

          .tpv-color-swatch {
            height: 36px;
          }

          .tpv-color-code {
            font-size: 0.65rem;
          }

          .tpv-palette-section {
            padding: 0.75rem;
            margin-bottom: 1.5rem;
          }

          .tpv-palette-section h4 {
            font-size: 0.9rem;
          }

          .palette-description {
            font-size: 0.8rem;
          }

          /* Picker section */
          .picker-section {
            padding: 0.75rem;
          }

          .picker-section h4 {
            font-size: 0.9rem;
          }

          .picker-description {
            font-size: 0.8rem;
          }

          /* Larger reset button for touch */
          .reset-button {
            min-height: 44px;
            font-size: 0.9rem;
          }

          .solid-mode-info {
            padding: 0.75rem;
          }

          .solid-mode-info h4 {
            font-size: 0.9rem;
          }

          .info-description {
            font-size: 0.8rem;
          }
        }

        /* Extra small screens */
        @media (max-width: 400px) {
          .tpv-color-grid {
            grid-template-columns: repeat(3, 1fr);
          }

          .tpv-color-swatch {
            height: 44px;
          }

          .swatch {
            width: 44px;
            height: 44px;
          }

          .swatch-pair {
            gap: 0.5rem;
          }

          .arrow {
            font-size: 1.2rem;
          }
        }
      `})]}):null}const BH=dn;new Map(BH.map((e,t)=>[e.code,t]));function y_(e){const{inputMode:t,prompt:n,selectedFile:r,lengthMM:i,widthMM:s,result:a,viewMode:l,blendRecipes:c,solidRecipes:d,colorMapping:u,solidColorMapping:p,solidEditedColors:h,blendEditedColors:f,blendSvgUrl:m,solidSvgUrl:g,arMapping:x,jobId:y,inSituData:v,regionOverrides:b,originalTaggedSvg:w}=e;console.log("[SERIALIZE] Serializing design with result:",a),console.log("[SERIALIZE] result.svg_url:",a==null?void 0:a.svg_url),console.log("[SERIALIZE] regionOverrides:",b),console.log("[SERIALIZE] regionOverrides size:",b==null?void 0:b.size),console.log("[SERIALIZE] originalTaggedSvg present:",!!w);const C=_=>_?_ instanceof Map?Object.fromEntries(_):_:null;return{input_mode:t,prompt:n||null,uploaded_file_url:(r==null?void 0:r.url)||null,dimensions:{widthMM:s,lengthMM:i},original_svg_url:(a==null?void 0:a.svg_url)||null,original_png_url:(a==null?void 0:a.png_url)||null,thumbnail_url:(a==null?void 0:a.thumb_url)||null,blend_recipes:c||null,solid_recipes:d||null,color_mapping:C(u),solid_color_mapping:C(p),solid_color_edits:C(h),blend_color_edits:C(f),final_blend_svg_url:m||null,final_solid_svg_url:g||null,preferred_view_mode:l||"solid",aspect_ratio_mapping:x||null,job_id:y||null,in_situ:v?{room_photo_url:v.room_photo_url||null,mask_url:v.mask_url||null,floor_dimensions_m:v.floor_dimensions_m||null,preview_url:v.preview_url||null,blend_opacity:v.blend_opacity||20,perspective_corners:v.perspective_corners||null}:null,region_overrides:C(b),original_tagged_svg:w||null}}function vp(e){var s,a,l,c;console.log("[DESERIALIZE] Incoming savedData keys:",Object.keys(e||{})),console.log("[DESERIALIZE] savedData.region_overrides:",e==null?void 0:e.region_overrides),console.log("[DESERIALIZE] savedData.design_data:",e==null?void 0:e.design_data),console.log("[DESERIALIZE] savedData.design_data?.region_overrides:",(s=e==null?void 0:e.design_data)==null?void 0:s.region_overrides),console.log("[DESERIALIZE] savedData.original_tagged_svg present:",!!(e!=null&&e.original_tagged_svg)),console.log("[DESERIALIZE] savedData.design_data?.original_tagged_svg present:",!!((a=e==null?void 0:e.design_data)!=null&&a.original_tagged_svg));const t=d=>d?d instanceof Map?d:new Map(Object.entries(d)):new Map,n=d=>{var u;return e[d]??((u=e.design_data)==null?void 0:u[d])},r=n("region_overrides"),i=n("original_tagged_svg");return console.log("[DESERIALIZE] Final regionOverridesData:",r),console.log("[DESERIALIZE] Final originalTaggedSvgData present:",!!i),{inputMode:e.input_mode||n("input_mode"),prompt:n("prompt")||"",selectedFile:n("uploaded_file_url")?{url:n("uploaded_file_url"),name:n("uploaded_file_url").split("/").pop()}:null,lengthMM:((l=n("dimensions"))==null?void 0:l.lengthMM)||0,widthMM:((c=n("dimensions"))==null?void 0:c.widthMM)||0,result:{svg_url:n("original_svg_url"),png_url:n("original_png_url"),thumbnail_url:n("thumbnail_url")},blendRecipes:n("blend_recipes")||null,solidRecipes:n("solid_recipes")||null,colorMapping:t(n("color_mapping")),solidColorMapping:t(n("solid_color_mapping")),solidEditedColors:t(n("solid_color_edits")),blendEditedColors:t(n("blend_color_edits")),blendSvgUrl:null,solidSvgUrl:null,viewMode:"solid",arMapping:n("aspect_ratio_mapping"),jobId:n("job_id"),inSituData:n("in_situ")||null,regionOverrides:t(r),originalTaggedSvg:i||null,generating:!1,generatingBlends:!1,showFinalRecipes:!!e.blend_recipes,showSolidSummary:!!e.solid_recipes,colorEditorOpen:!1,selectedColor:null}}function HH(e){var n;const t=[];return e.inputMode||t.push("Input mode is required"),(!(e.widthMM>0)||!(e.lengthMM>0))&&t.push("Surface dimensions are required"),(n=e.result)!=null&&n.svg_url||t.push("No design to save - generate a design first"),{valid:t.length===0,errors:t}}function UH({currentState:e,existingDesignId:t=null,initialName:n="",onClose:r,onSaved:i}){const[s,a]=R.useState(n),[l,c]=R.useState(""),[d,u]=R.useState(""),[p,h]=R.useState(""),[f,m]=R.useState(!1),[g,x]=R.useState([]),[y,v]=R.useState(!1),[b,w]=R.useState(""),[C,_]=R.useState("#1a365d"),[j,E]=R.useState(!1),[T,M]=R.useState(!1),[J,P]=R.useState(!1),[q,k]=R.useState(null);R.useEffect(()=>{z()},[]);const z=async()=>{try{const{projects:H}=await jf();x(H)}catch(H){console.error("Failed to load projects:",H),k("Failed to load projects")}},he=async()=>{if(!b.trim()){k("Project name is required");return}P(!0),k(null);try{const{project:H}=await Zw({name:b.trim(),color:C});x([H,...g]),u(H.id),v(!1),w(""),_("#1a365d")}catch(H){console.error("Failed to create project:",H),k(H.message)}finally{P(!1)}},Z=async(H=!1)=>{if(!s.trim()){k("Design name is required");return}const X=HH(e);if(!X.valid){k(X.errors.join(", "));return}H?M(!0):E(!0),k(null);try{const F=y_(e);console.log("[SAVE-MODAL] Serialized design data:",F),console.log("[SAVE-MODAL] SVG URL from serialized data:",F.original_svg_url);const W={name:s.trim(),description:l.trim()||null,project_id:d||null,tags:p.split(",").map(se=>se.trim()).filter(se=>se),is_public:f,design_data:F};console.log("[SAVE-MODAL] Full save payload:",W),t&&!H&&(W.id=t);const re=await _f(W);i&&i(re,s.trim()),r()}catch(F){console.error("Failed to save design:",F),k(F.message)}finally{E(!1),M(!1)}},K=["#1a365d","#ff6b35","#4a90e2","#50c878","#9b59b6","#e74c3c"];return o.jsx("div",{className:"modal-overlay",onClick:r,children:o.jsxs("div",{className:"modal-content save-design-modal",onClick:H=>H.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsx("h2",{children:t?"Update Design":"Save Design"}),o.jsx("button",{onClick:r,className:"close-button",children:""})]}),o.jsxs("div",{className:"modal-body",children:[q&&o.jsx("div",{className:"error-message",children:q}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"design-name",children:"Design Name *"}),o.jsx("input",{id:"design-name",type:"text",value:s,onChange:H=>a(H.target.value),placeholder:"e.g., Playground Design A",autoFocus:!0,disabled:j||T})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"design-description",children:"Description"}),o.jsx("textarea",{id:"design-description",value:l,onChange:H=>c(H.target.value),placeholder:"Optional notes about this design...",rows:3,disabled:j||T})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"design-project",children:"Project"}),y?o.jsxs("div",{className:"new-project-form",children:[o.jsxs("div",{className:"input-row",children:[o.jsx("input",{type:"text",value:b,onChange:H=>w(H.target.value),placeholder:"Project name...",disabled:J}),o.jsx("div",{className:"color-picker-inline",children:K.map(H=>o.jsx("button",{type:"button",className:`color-swatch ${C===H?"active":""}`,style:{backgroundColor:H},onClick:()=>_(H),disabled:J},H))})]}),o.jsxs("div",{className:"button-row",children:[o.jsx("button",{type:"button",onClick:he,className:"btn-primary btn-small",disabled:J,children:J?"Creating...":"Create"}),o.jsx("button",{type:"button",onClick:()=>v(!1),className:"btn-secondary btn-small",disabled:J,children:"Cancel"})]})]}):o.jsxs("div",{className:"project-selector",children:[o.jsxs("select",{id:"design-project",value:d,onChange:H=>u(H.target.value),disabled:j||T,children:[o.jsx("option",{value:"",children:"No Project"}),g.map(H=>o.jsxs("option",{value:H.id,children:[H.name," (",H.design_count," designs)"]},H.id))]}),o.jsx("button",{type:"button",onClick:()=>v(!0),className:"btn-secondary btn-small",disabled:j||T,children:"+ New Project"})]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"design-tags",children:"Tags"}),o.jsx("input",{id:"design-tags",type:"text",value:p,onChange:H=>h(H.target.value),placeholder:"e.g., playground, vibrant, geometric (comma-separated)",disabled:j||T}),o.jsx("small",{className:"help-text",children:"Separate tags with commas"})]}),o.jsx("div",{className:"form-group checkbox-group",children:o.jsxs("label",{children:[o.jsx("input",{type:"checkbox",checked:f,onChange:H=>m(H.target.checked),disabled:j||T}),o.jsx("span",{children:"Make this design public (shareable link)"})]})})]}),o.jsxs("div",{className:"modal-footer",children:[o.jsx("button",{onClick:r,className:"btn-secondary",disabled:j||T,children:"Cancel"}),t&&o.jsx("button",{onClick:()=>Z(!0),className:"btn-secondary",disabled:j||T,children:T?"Saving...":"Save as New"}),o.jsx("button",{onClick:()=>Z(!1),className:"btn-primary",disabled:j||T,children:j?"Saving...":t?"Update":"Save Design"})]})]})})}const WH=10*1024*1024,GH=["image/jpeg","image/png","image/jpg"];function VH({onPhotoUploaded:e,disabled:t=!1}){const[n,r]=R.useState(!1),[i,s]=R.useState(!1),[a,l]=R.useState(null),[c,d]=R.useState(null),u=R.useRef(null),p=v=>{v.preventDefault(),t||r(!0)},h=v=>{v.preventDefault(),r(!1)},f=async v=>{if(v.preventDefault(),r(!1),t)return;const b=v.dataTransfer.files;b.length>0&&await x(b[0])},m=()=>{!t&&u.current&&u.current.click()},g=async v=>{v.target.files.length>0&&await x(v.target.files[0])},x=async v=>{if(l(null),!GH.includes(v.type)){l("Please upload a JPG or PNG image");return}if(v.size>WH){l("Image must be under 10MB");return}const b=URL.createObjectURL(v);d(b),console.log("[IN-SITU-UPLOADER] Loading local file to get dimensions...");const w=await new Promise((C,_)=>{const j=new Image;j.onload=()=>{console.log("[IN-SITU-UPLOADER] Local image loaded, dimensions:",j.naturalWidth,"x",j.naturalHeight),C({width:j.naturalWidth,height:j.naturalHeight})},j.onerror=E=>{console.error("[IN-SITU-UPLOADER] Failed to load local image:",E),_(new Error("Failed to read image dimensions"))},j.src=b});s(!0);try{const _=`in-situ-photos/${`${Date.now()}-${Math.random().toString(36).substr(2,9)}.${v.type.split("/")[1]}`}`,{data:j,error:E}=await Jt.storage.from("tpv-studio-uploads").upload(_,v,{cacheControl:"3600",upsert:!1});if(E)throw E;const{data:{publicUrl:T}}=Jt.storage.from("tpv-studio-uploads").getPublicUrl(_);console.log("[IN-SITU-UPLOADER] Photo uploaded:",T),console.log("[IN-SITU-UPLOADER] Using dimensions from local file:",w),console.log("[IN-SITU-UPLOADER] Passing local blob URL for fast preview"),console.log("[IN-SITU-UPLOADER] Calling onPhotoUploaded callback..."),e({url:b,supabaseUrl:T,width:w.width,height:w.height,filename:v.name})}catch(C){console.error("[IN-SITU-UPLOADER] Upload failed:",C),l(C.message||"Upload failed"),URL.revokeObjectURL(b),d(null)}finally{s(!1)}},y=()=>{c&&URL.revokeObjectURL(c),d(null),l(null)};return o.jsxs("div",{className:"in-situ-uploader",children:[c?o.jsxs("div",{className:"preview-container",children:[o.jsx("img",{src:c,alt:"Site preview",className:"preview-image"}),i&&o.jsxs("div",{className:"upload-overlay",children:[o.jsx("div",{className:"upload-spinner"}),o.jsx("p",{children:"Uploading..."})]}),!i&&o.jsx("button",{className:"clear-button",onClick:y,title:"Remove photo",children:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),o.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}):o.jsxs("div",{className:`upload-zone ${n?"dragging":""} ${t?"disabled":""}`,onDragOver:p,onDragLeave:h,onDrop:f,onClick:m,children:[o.jsx("input",{ref:u,type:"file",accept:"image/jpeg,image/png",onChange:g,style:{display:"none"},disabled:t}),o.jsx("div",{className:"upload-icon",children:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),o.jsx("polyline",{points:"17 8 12 3 7 8"}),o.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]})}),o.jsxs("div",{className:"upload-text",children:[o.jsx("p",{className:"primary",children:n?"Drop photo here":"Upload site photo"}),o.jsx("p",{className:"secondary",children:"Drag & drop or click to browse"}),o.jsx("p",{className:"hint",children:"JPG or PNG, max 10MB"})]})]}),a&&o.jsx("div",{className:"error-message",children:a}),o.jsx("style",{children:`
        .in-situ-uploader {
          width: 100%;
        }

        .upload-zone {
          border: 2px dashed #d1d5db;
          border-radius: 8px;
          padding: 2rem;
          text-align: center;
          cursor: pointer;
          transition: all 0.2s;
          background: #f9fafb;
        }

        .upload-zone:hover {
          border-color: #ff6b35;
          background: #fff7f5;
        }

        .upload-zone.dragging {
          border-color: #ff6b35;
          background: #fff7f5;
          border-style: solid;
        }

        .upload-zone.disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .upload-zone.disabled:hover {
          border-color: #d1d5db;
          background: #f9fafb;
        }

        .upload-icon {
          width: 48px;
          height: 48px;
          margin: 0 auto 1rem;
          color: #9ca3af;
        }

        .upload-zone:hover .upload-icon {
          color: #ff6b35;
        }

        .upload-text .primary {
          font-size: 1rem;
          font-weight: 600;
          color: #374151;
          margin: 0 0 0.25rem;
        }

        .upload-text .secondary {
          font-size: 0.875rem;
          color: #6b7280;
          margin: 0 0 0.5rem;
        }

        .upload-text .hint {
          font-size: 0.75rem;
          color: #9ca3af;
          margin: 0;
        }

        .preview-container {
          position: relative;
          border-radius: 8px;
          overflow: hidden;
        }

        .preview-image {
          width: 100%;
          display: block;
          border-radius: 8px;
        }

        .upload-overlay {
          position: absolute;
          inset: 0;
          background: rgba(0, 0, 0, 0.6);
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          color: white;
        }

        .upload-spinner {
          width: 32px;
          height: 32px;
          border: 3px solid rgba(255, 255, 255, 0.3);
          border-top-color: white;
          border-radius: 50%;
          animation: spin 0.8s linear infinite;
          margin-bottom: 0.5rem;
        }

        @keyframes spin {
          to { transform: rotate(360deg); }
        }

        .clear-button {
          position: absolute;
          top: 0.5rem;
          right: 0.5rem;
          width: 32px;
          height: 32px;
          border-radius: 50%;
          background: rgba(0, 0, 0, 0.6);
          border: none;
          cursor: pointer;
          color: white;
          display: flex;
          align-items: center;
          justify-content: center;
          transition: background 0.2s;
        }

        .clear-button:hover {
          background: rgba(0, 0, 0, 0.8);
        }

        .clear-button svg {
          width: 16px;
          height: 16px;
        }

        .error-message {
          margin-top: 0.75rem;
          padding: 0.5rem 0.75rem;
          background: #fef2f2;
          border: 1px solid #fecaca;
          border-radius: 4px;
          color: #dc2626;
          font-size: 0.875rem;
        }
      `})]})}function qH(e,t){const[n,r,i,s,a,l,c,d]=e,[u,p,h,f,m,g,x,y]=t,v=[[n,r,1,0,0,0,-u*n,-u*r],[0,0,0,n,r,1,-p*n,-p*r],[i,s,1,0,0,0,-h*i,-h*s],[0,0,0,i,s,1,-f*i,-f*s],[a,l,1,0,0,0,-m*a,-m*l],[0,0,0,a,l,1,-g*a,-g*l],[c,d,1,0,0,0,-x*c,-x*d],[0,0,0,c,d,1,-y*c,-y*d]],w=YH(v,[u,p,h,f,m,g,x,y]);return function(_,j){const E=w[6]*_+w[7]*j+1,T=(w[0]*_+w[1]*j+w[2])/E,M=(w[3]*_+w[4]*j+w[5])/E;return[T,M]}}function YH(e,t){const n=e.length,r=e.map((s,a)=>[...s,t[a]]);for(let s=0;s<n;s++){let a=s;for(let l=s+1;l<n;l++)Math.abs(r[l][s])>Math.abs(r[a][s])&&(a=l);[r[s],r[a]]=[r[a],r[s]];for(let l=s+1;l<n;l++){const c=r[l][s]/r[s][s];for(let d=s;d<=n;d++)r[l][d]-=c*r[s][d]}}const i=new Array(n);for(let s=n-1;s>=0;s--){i[s]=r[s][n];for(let a=s+1;a<n;a++)i[s]-=r[s][a]*i[a];i[s]/=r[s][s]}return i}function xm(e){return new Promise((t,n)=>{const r=new Image;!e.startsWith("blob:")&&!e.startsWith("data:")?(r.crossOrigin="anonymous",console.log("[LOAD-IMAGE] Loading external URL with CORS:",e.substring(0,50))):console.log("[LOAD-IMAGE] Loading local URL (blob/data):",e.substring(0,50)),r.onload=()=>{console.log("[LOAD-IMAGE] Successfully loaded image:",e.substring(0,50)),t(r)},r.onerror=()=>{console.error("[LOAD-IMAGE] Failed to load image:",e),n(new Error(`Failed to load image: ${e}`))},r.src=e})}async function x_(e,t=1536){console.log("[RASTERIZE-SVG] Starting SVG rasterization:",e.substring(0,50),"maxSize:",t);const n=await xm(e),{naturalWidth:r,naturalHeight:i}=n;console.log("[RASTERIZE-SVG] SVG loaded with dimensions:",r,"x",i);const s=Math.min(1,t/Math.max(r,i)),a=Math.round(r*s),l=Math.round(i*s);console.log("[RASTERIZE-SVG] Scaling to:",a,"x",l,"(scale:",s.toFixed(2),")");const c=document.createElement("canvas");return c.width=a,c.height=l,c.getContext("2d").drawImage(n,0,0,a,l),console.log("[RASTERIZE-SVG] Drew SVG to canvas"),new Promise((u,p)=>{const h=new Image;h.onload=()=>{console.log("[RASTERIZE-SVG] Successfully rasterized SVG to PNG"),u(h)},h.onerror=f=>{console.error("[RASTERIZE-SVG] Failed to convert canvas to image:",f),p(f)},h.src=c.toDataURL("image/png")})}function b_({photoCtx:e,photoImg:t,designImg:n,quad:r,opacity:i,shape:s,lighting:a}){const l=e.canvas;e.clearRect(0,0,l.width,l.height),e.drawImage(t,0,0,l.width,l.height);const c=n.width,d=n.height,u=[0,0,c,0,c,d,0,d],p=[r[0].x,r[0].y,r[1].x,r[1].y,r[2].x,r[2].y,r[3].x,r[3].y],h=qH(u,p),f=10,m=c/f,g=d/f,x=document.createElement("canvas");if(x.width=c,x.height=d,x.getContext("2d").drawImage(n,0,0),e.save(),e.globalAlpha=i,a&&a.enabled){const b=a.strength||.6,w=1+(a.baseBrightness-1)*b,C=1+(a.baseContrast-1)*b;e.filter=`brightness(${w}) contrast(${C})`}const v=s&&s.length>=3?s:r;e.beginPath(),e.moveTo(v[0].x,v[0].y);for(let b=1;b<v.length;b++)e.lineTo(v[b].x,v[b].y);e.closePath(),e.clip();for(let b=0;b<f;b++)for(let w=0;w<f;w++){const C=b*m,_=w*g,j=(b+1)*m,E=(w+1)*g,T=h(C,_),M=h(j,_),J=h(j,E),P=h(C,E);hy(e,x,C,_,j,_,C,E,T[0],T[1],M[0],M[1],P[0],P[1]),hy(e,x,j,_,j,E,C,E,M[0],M[1],J[0],J[1],P[0],P[1])}e.restore()}function hy(e,t,n,r,i,s,a,l,c,d,u,p,h,f){e.save(),e.beginPath(),e.moveTo(c,d),e.lineTo(u,p),e.lineTo(h,f),e.closePath(),e.clip();const m=(n-a)*(s-l)-(i-a)*(r-l);if(Math.abs(m)<.001){e.restore();return}const g=((c-h)*(s-l)-(u-h)*(r-l))/m,x=((d-f)*(s-l)-(p-f)*(r-l))/m,y=((n-a)*(u-h)-(i-a)*(c-h))/m,v=((n-a)*(p-f)-(i-a)*(d-f))/m,b=c-g*n-y*r,w=d-x*n-v*r;e.setTransform(g,x,y,v,b,w),e.drawImage(t,0,0),e.restore()}function XH(e,t="tpv-in-situ-preview.png"){e.toBlob(n=>{const r=URL.createObjectURL(n),i=document.createElement("a");i.href=r,i.download=t,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(r)},"image/png")}function ZH(e,t,n,r){const i=n/r,s=e*.6,a=t*.6;let l,c;i>s/a?(l=s,c=s/i):(c=a,l=a*i);const d=(e-l)/2,u=(t-c)/2;return[{x:d,y:u},{x:d+l,y:u},{x:d+l,y:u+c},{x:d,y:u+c}]}function KH(e,t,n){let r=!1;for(let i=0,s=n.length-1;i<n.length;s=i++){const a=n[i].x,l=n[i].y,c=n[s].x,d=n[s].y;l>t!=d>t&&e<(c-a)*(t-l)/(d-l)+a&&(r=!r)}return r}function JH(e,t,n){e/=255,t/=255,n/=255;const r=Math.max(e,t,n),i=Math.min(e,t,n),s=(r+i)/2;if(r===i)return{h:0,s:0,l:s};const a=r-i,l=s>.5?a/(2-r-i):a/(r+i);let c;switch(r){case e:c=((t-n)/a+(t<n?6:0))/6;break;case t:c=((n-e)/a+2)/6;break;case n:c=((e-t)/a+4)/6;break}return{h:c,s:l,l:s}}function QH(e,t,n=2e3){if(!e||!t||t.length<3)return{avgLightness:.5,avgContrastProxy:.5};const r=Math.floor(Math.min(...t.map(v=>v.x))),i=Math.ceil(Math.max(...t.map(v=>v.x))),s=Math.floor(Math.min(...t.map(v=>v.y))),a=Math.ceil(Math.max(...t.map(v=>v.y))),l=i-r,c=a-s;if(l<=0||c<=0)return{avgLightness:.5,avgContrastProxy:.5};let d;try{d=e.getImageData(r,s,l,c)}catch(v){return console.warn("[LIGHTING] Failed to get image data:",v),{avgLightness:.5,avgContrastProxy:.5}}const u=d.data,p=[];let h=0;const f=n*5;for(;p.length<n&&h<f;){h++;const v=r+Math.random()*l,b=s+Math.random()*c;if(!KH(v,b,t))continue;const w=Math.floor(v-r),_=(Math.floor(b-s)*l+w)*4;if(_<0||_>=u.length-3)continue;const j=u[_],E=u[_+1],T=u[_+2],{l:M}=JH(j,E,T);p.push(M)}if(p.length===0)return{avgLightness:.5,avgContrastProxy:.5};const m=p.reduce((v,b)=>v+b,0)/p.length,g=p.reduce((v,b)=>v+Math.pow(b-m,2),0)/p.length,x=Math.sqrt(g),y=Math.min(1,x/.25);return{avgLightness:m,avgContrastProxy:y}}function e7(e){let t=1,n=1;const i=e.avgLightness-.5;return t+=i*.6,n+=(e.avgContrastProxy-.5)*.4,t=Math.max(.7,Math.min(1.3,t)),n=Math.max(.8,Math.min(1.25,n)),{brightness:t,contrast:n}}const t7=100;function n7({photoUrl:e,svgUrl:t,designSizeMm:n,initialQuad:r,initialShape:i,initialOpacity:s=.8,initialLighting:a,onChange:l}){const[c,d]=R.useState(null),[u,p]=R.useState(null),[h,f]=R.useState(r||null),[m,g]=R.useState(i||null),[x,y]=R.useState(Math.max(.3,Math.min(1,s))),[v,b]=R.useState(a||{enabled:!1,strength:.6,baseBrightness:1,baseContrast:1}),[w,C]=R.useState(!0),[_,j]=R.useState(null),[E,T]=R.useState(1),[M,J]=R.useState("corners"),[P,q]=R.useState(null),[k,z]=R.useState(!1),[he,Z]=R.useState(null),[K,H]=R.useState(null),X=R.useRef(null),F=R.useRef(null),W=R.useRef(null),[re,se]=R.useState([]),me=20;R.useEffect(()=>{ke()},[e,t]),R.useEffect(()=>{c&&u&&h&&pe()},[c,u,h,m,x,v,M,P,k,K]),R.useEffect(()=>{if(!c||!h||h.length!==4)return;const $=document.createElement("canvas");$.width=c.naturalWidth,$.height=c.naturalHeight;const D=$.getContext("2d");D.drawImage(c,0,0);const ae=QH(D,h),{brightness:Se,contrast:le}=e7(ae);b(ie=>({...ie,baseBrightness:Se,baseContrast:le}))},[c,JSON.stringify(h)]),R.useEffect(()=>{const $=D=>{if(M==="shape"&&(D.key==="Delete"||D.key==="Backspace")&&K!==null&&m&&m.length>3){D.preventDefault();const ae=m.filter((Se,le)=>le!==K);g(ae),H(null),Re(h,x,ae)}};return window.addEventListener("keydown",$),()=>window.removeEventListener("keydown",$)},[M,K,m,h,x]);const ke=async()=>{var $;console.log("[FOUR-POINT] Starting to load images - photo:",e==null?void 0:e.substring(0,50),"svg:",t==null?void 0:t.substring(0,50)),C(!0),j(null);try{console.log("[FOUR-POINT] Loading photo and rasterizing SVG...");const[D,ae]=await Promise.all([xm(e),x_(t,1536)]);console.log("[FOUR-POINT] Both images loaded successfully - photo:",D.naturalWidth,"x",D.naturalHeight,"design:",ae.naturalWidth,"x",ae.naturalHeight),d(D),p(ae);const Se=(($=F.current)==null?void 0:$.clientWidth)||800,le=500,ie=Se/D.naturalWidth,je=le/D.naturalHeight,Y=Math.min(1,ie,je);if(T(Y),console.log("[FOUR-POINT] Display scale set to:",Y.toFixed(3)),r)console.log("[FOUR-POINT] Using provided initial quad");else{const ne=ZH(D.naturalWidth,D.naturalHeight,n.width_mm,n.length_mm);f(ne),console.log("[FOUR-POINT] Initialized default quad")}}catch(D){console.error("[FOUR-POINT] Failed to load images:",D),j(D.message)}finally{C(!1),console.log("[FOUR-POINT] Loading complete")}},pe=()=>{const $=X.current;if(!$||!c||!u||!h)return;$.width=c.naturalWidth,$.height=c.naturalHeight;const D=$.getContext("2d");b_({photoCtx:D,photoImg:c,designImg:u,quad:h,opacity:x,shape:m,lighting:v}),Pe(D)},Pe=$=>{if(!h)return;$.setTransform(1,0,0,1,0,0);const D=Math.max(8,Math.min(15,c.naturalWidth/80));if(M==="corners"){$.strokeStyle="rgba(255, 255, 255, 0.8)",$.lineWidth=2,$.setLineDash([5,5]),$.beginPath(),$.moveTo(h[0].x,h[0].y),$.lineTo(h[1].x,h[1].y),$.lineTo(h[2].x,h[2].y),$.lineTo(h[3].x,h[3].y),$.closePath(),$.stroke(),$.setLineDash([]);const ae=["TL","TR","BR","BL"];h.forEach((Se,le)=>{$.beginPath(),$.arc(Se.x,Se.y,D,0,Math.PI*2),$.fillStyle=P===le?"#ff6b35":"rgba(255, 107, 53, 0.9)",$.fill(),$.strokeStyle="white",$.lineWidth=2,$.stroke(),$.fillStyle="white",$.font="10px sans-serif",$.textAlign="center",$.textBaseline="middle",$.fillText(ae[le],Se.x,Se.y)})}else{const ae=m||h;$.strokeStyle="rgba(34, 197, 94, 0.8)",$.lineWidth=2,$.setLineDash([]),$.beginPath(),$.moveTo(ae[0].x,ae[0].y);for(let Se=1;Se<ae.length;Se++)$.lineTo(ae[Se].x,ae[Se].y);$.closePath(),$.stroke(),ae.forEach((Se,le)=>{$.beginPath(),$.arc(Se.x,Se.y,D*.8,0,Math.PI*2),K===le?$.fillStyle="#22c55e":P===le?$.fillStyle="#16a34a":$.fillStyle="rgba(34, 197, 94, 0.9)",$.fill(),$.strokeStyle="white",$.lineWidth=2,$.stroke()}),$.strokeStyle="rgba(255, 107, 53, 0.3)",$.lineWidth=1,$.setLineDash([3,3]),$.beginPath(),$.moveTo(h[0].x,h[0].y),$.lineTo(h[1].x,h[1].y),$.lineTo(h[2].x,h[2].y),$.lineTo(h[3].x,h[3].y),$.closePath(),$.stroke(),$.setLineDash([])}},Re=R.useCallback(($,D,ae,Se)=>{W.current&&clearTimeout(W.current),W.current=setTimeout(()=>{l&&l({quad:$,opacity:D,shape:ae,lighting:Se||v})},t7)},[l,v]),Ge=R.useCallback(()=>{se($=>{const D=[...$,{quad:[...h],shape:m?[...m]:null,opacity:x,lighting:{...v}}];return D.length>me?D.slice(-me):D})},[h,m,x,v]),$e=()=>{if(re.length===0)return;const $=re[re.length-1];se(D=>D.slice(0,-1)),f($.quad),g($.shape),y($.opacity),b($.lighting),Re($.quad,$.opacity,$.shape,$.lighting)},we=($,D)=>({x:$/E,y:D/E}),xe=($,D,ae)=>{if(!ae)return-1;const Se=25/E;for(let le=0;le<ae.length;le++){const ie=ae[le].x-$,je=ae[le].y-D;if(Math.sqrt(ie*ie+je*je)<Se)return le}return-1},S=($,D,ae)=>{if(!ae||ae.length<3)return!1;let Se=!1;for(let le=0,ie=ae.length-1;le<ae.length;ie=le++){const je=ae[le].x,Y=ae[le].y,ne=ae[ie].x,Ie=ae[ie].y;Y>D!=Ie>D&&$<(ne-je)*(D-Y)/(Ie-Y)+je&&(Se=!Se)}return Se},ue=$=>{if(M!=="shape"||!m||m.length<=3)return;const D=X.current;if(!D)return;const ae=D.getBoundingClientRect(),Se=$.clientX-ae.left,le=$.clientY-ae.top,{x:ie,y:je}=we(Se,le),Y=xe(ie,je,m);if(Y>=0){Ge();const ne=m.filter((Ke,Je)=>Je!==Y);g(ne),H(null);const Ie=B(h,ne);Ie!==h?(f(Ie),Re(Ie,x,ne)):Re(h,x,ne)}},ce=$=>{const D=X.current;if(!D)return;const ae=D.getBoundingClientRect(),Se=$.clientX-ae.left,le=$.clientY-ae.top,{x:ie,y:je}=we(Se,le);if(M==="corners"){const Y=xe(ie,je,h);Y>=0?(Ge(),q(Y),D.setPointerCapture($.pointerId)):S(ie,je,h)&&(Ge(),z(!0),Z({x:ie,y:je}),D.setPointerCapture($.pointerId))}else{const Y=m||h,ne=xe(ie,je,Y);if(ne>=0)Ge(),q(ne),H(ne),D.setPointerCapture($.pointerId);else{Ge();let Ie=0,Ke=1/0;for(let at=0;at<Y.length;at++){const ht=(at+1)%Y.length,et=de(ie,je,Y[at].x,Y[at].y,Y[ht].x,Y[ht].y);et<Ke&&(Ke=et,Ie=ht)}const Je={x:ie,y:je},De=[...Y];De.splice(Ie,0,Je),g(De),H(Ie);const Ye=B(h,De);Ye!==h?(f(Ye),Re(Ye,x,De)):Re(h,x,De)}}},I=$=>{if(P===null&&!k)return;const D=X.current;if(!D)return;const ae=D.getBoundingClientRect(),Se=$.clientX-ae.left,le=$.clientY-ae.top,{x:ie,y:je}=we(Se,le),Y=Math.max(0,Math.min(c.naturalWidth,ie)),ne=Math.max(0,Math.min(c.naturalHeight,je));if(M==="corners"){if(k&&he){const Ie=Y-he.x,Ke=ne-he.y,Je=h.map(Ye=>({x:Math.max(0,Math.min(c.naturalWidth,Ye.x+Ie)),y:Math.max(0,Math.min(c.naturalHeight,Ye.y+Ke))}));let De=m;m&&(De=m.map(Ye=>({x:Math.max(0,Math.min(c.naturalWidth,Ye.x+Ie)),y:Math.max(0,Math.min(c.naturalHeight,Ye.y+Ke))})),g(De)),f(Je),Z({x:Y,y:ne}),Re(Je,x,De)}else if(P!==null){const Ie=[...h];Ie[P]={x:Y,y:ne},f(Ie),Re(Ie,x,m)}}else{const Ke=[...m||h];Ke[P]={x:Y,y:ne},g(Ke),Re(h,x,Ke)}},N=$=>{if(P!==null||k){const D=X.current;if(D&&D.releasePointerCapture($.pointerId),M==="shape"&&m&&P!==null){const ae=B(h,m);ae!==h&&(f(ae),Re(ae,x,m))}q(null),z(!1),Z(null)}},B=($,D)=>{if(!D||D.length<3||!$)return $;const ae=$.reduce((Ye,at)=>Ye+at.x,0)/4,Se=$.reduce((Ye,at)=>Ye+at.y,0)/4,le=D.reduce((Ye,at)=>Ye+at.x,0)/D.length,ie=D.reduce((Ye,at)=>Ye+at.y,0)/D.length;let je=1;for(const Ye of D){const at=Ye.x-ae,ht=Ye.y-Se,et=Math.sqrt(at*at+ht*ht);if(et<1)continue;const dt=oe(ae,Se,at,ht,$);if(dt>0&&et>dt){const nn=et/dt;je=Math.max(je,nn)}}let Y=1/0;for(const Ye of D){const at=Ye.x-ae,ht=Ye.y-Se,et=Math.sqrt(at*at+ht*ht);if(et<1)continue;const dt=oe(ae,Se,at,ht,$);if(dt>0){const nn=et/dt;Y=Math.min(Y,nn)}}let ne=je;if(je<=1&&Y<1/0&&(ne=Y),Math.abs(ne-1)<.01)return $;const Ie=$.map(Ye=>({x:ae+(Ye.x-ae)*ne,y:Se+(Ye.y-Se)*ne})),Ke=le-ae,Je=ie-Se;return Ie.map(Ye=>({x:Ye.x+Ke,y:Ye.y+Je}))},oe=($,D,ae,Se,le)=>{let ie=1/0;for(let je=0;je<4;je++){const Y=le[je],ne=le[(je+1)%4],Ie=ne.x-Y.x,Ke=ne.y-Y.y,Je=ae*Ke-Se*Ie;if(Math.abs(Je)<1e-4)continue;const De=((Y.x-$)*Ke-(Y.y-D)*Ie)/Je,Ye=((Y.x-$)*Se-(Y.y-D)*ae)/Je;De>0&&Ye>=0&&Ye<=1&&(ie=Math.min(ie,De*Math.sqrt(ae*ae+Se*Se)))}return ie===1/0?0:ie},de=($,D,ae,Se,le,ie)=>{const je=$-ae,Y=D-Se,ne=le-ae,Ie=ie-Se,Ke=je*ne+Y*Ie,Je=ne*ne+Ie*Ie;let De=Je!==0?Ke/Je:-1,Ye,at;return De<0?(Ye=ae,at=Se):De>1?(Ye=le,at=ie):(Ye=ae+De*ne,at=Se+De*Ie),Math.sqrt(($-Ye)**2+(D-at)**2)},G=()=>{M==="corners"?(m||g([...h]),J("shape"),H(null)):(J("corners"),H(null))},te=$=>{const D=Math.max(.3,Math.min(1,parseFloat($.target.value)/100));y(D),Re(h,D,m)},ge=$=>{const D={...v,enabled:$.target.checked};b(D),Re(h,x,m,D)},V=$=>{const D={...v,strength:parseFloat($.target.value)/100};b(D),Re(h,x,m,D)};return w?o.jsxs("div",{className:"four-point-editor loading",children:[o.jsx("div",{className:"spinner"}),o.jsx("p",{children:"Loading preview..."})]}):_?o.jsx("div",{className:"four-point-editor error",children:o.jsxs("p",{children:["Failed to load: ",_]})}):o.jsxs("div",{className:"four-point-editor",ref:F,children:[o.jsxs("div",{className:"editor-header",children:[o.jsxs("div",{className:"header-title",children:[o.jsx("h3",{children:"Position Your Design"}),o.jsx(Ef,{content:o.jsxs("div",{children:[o.jsxs("p",{children:[o.jsx("strong",{children:"Corners Mode:"})," Drag the 4 corner handles (TL, TR, BR, BL) to position your design with perspective. You can also drag inside the design to move all corners at once."]}),o.jsxs("p",{style:{marginTop:"0.5rem"},children:[o.jsx("strong",{children:"Refine Shape Mode:"})," Click anywhere to add new vertices for precise shape control. Drag existing vertices to adjust. Double-click or press Delete/Backspace on a vertex to remove it."]}),o.jsxs("p",{style:{marginTop:"0.5rem"},children:[o.jsx("strong",{children:"Overlay Opacity:"})," Adjust transparency to see how the design blends with your photo."]}),o.jsxs("p",{style:{marginTop:"0.5rem"},children:[o.jsx("strong",{children:"Match Floor Lighting:"})," Automatically adjusts design brightness to match your floor's lighting conditions."]})]}),position:"right"})]}),o.jsx("p",{className:"instructions",children:M==="corners"?"Drag the corner handles (TL, TR, BR, BL) to position the design. Drag inside to move all corners.":"Click to add vertices, drag to move them, double-click or press Delete to remove."})]}),o.jsx("div",{className:"canvas-container",children:o.jsx("canvas",{ref:X,onPointerDown:ce,onPointerMove:I,onPointerUp:N,onPointerLeave:N,onDoubleClick:ue,style:{width:`${((c==null?void 0:c.naturalWidth)||800)*E}px`,height:`${((c==null?void 0:c.naturalHeight)||600)*E}px`,cursor:P!==null||k?"grabbing":M==="shape"?"crosshair":"move",touchAction:"none"}})}),o.jsxs("div",{className:"controls",children:[o.jsxs("div",{className:"mode-toggle",children:[o.jsx("button",{className:`toggle-btn ${M==="corners"?"active":""}`,onClick:()=>J("corners"),children:"Corners"}),o.jsx("button",{className:`toggle-btn ${M==="shape"?"active":""}`,onClick:G,children:"Refine Shape"}),o.jsx("button",{className:"toggle-btn undo-btn",onClick:$e,disabled:re.length===0,title:"Undo last change",children:"Undo"})]}),o.jsxs("div",{className:"opacity-control",children:[o.jsxs("label",{children:["Overlay Opacity",o.jsxs("span",{className:"value",children:[Math.round(x*100),"%"]})]}),o.jsx("input",{type:"range",min:"30",max:"100",value:Math.round(x*100),onChange:te})]}),o.jsxs("div",{className:"lighting-control",children:[o.jsxs("label",{className:"checkbox-label",children:[o.jsx("input",{type:"checkbox",checked:v.enabled,onChange:ge}),"Match floor lighting"]}),v.enabled&&o.jsxs("div",{className:"lighting-slider",children:[o.jsxs("label",{children:["Strength",o.jsxs("span",{className:"value",children:[Math.round(v.strength*100),"%"]})]}),o.jsx("input",{type:"range",min:"0",max:"100",value:Math.round(v.strength*100),onChange:V})]})]})]}),o.jsx("style",{children:`
        .four-point-editor {
          display: flex;
          flex-direction: column;
          height: 100%;
        }

        .four-point-editor.loading,
        .four-point-editor.error {
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          min-height: 400px;
          color: #6b7280;
        }

        .four-point-editor .spinner {
          width: 40px;
          height: 40px;
          border: 3px solid #e5e7eb;
          border-top-color: #ff6b35;
          border-radius: 50%;
          animation: spin 0.8s linear infinite;
          margin-bottom: 1rem;
        }

        @keyframes spin {
          to { transform: rotate(360deg); }
        }

        .editor-header {
          padding-bottom: 1rem;
          border-bottom: 1px solid #e5e7eb;
          margin-bottom: 1rem;
        }

        .editor-header .header-title {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          margin-bottom: 0.5rem;
        }

        .editor-header h3 {
          margin: 0;
          font-size: 1.125rem;
          color: #1e4a7a;
        }

        .editor-header .instructions {
          margin: 0;
          font-size: 0.875rem;
          color: #6b7280;
        }

        .canvas-container {
          flex: 1;
          display: flex;
          align-items: center;
          justify-content: center;
          background: #f3f4f6;
          border-radius: 8px;
          overflow: hidden;
          min-height: 400px;
        }

        .canvas-container canvas {
          display: block;
        }

        .controls {
          padding-top: 1rem;
          border-top: 1px solid #e5e7eb;
          margin-top: 1rem;
          display: flex;
          flex-direction: column;
          gap: 1rem;
        }

        .mode-toggle {
          display: flex;
          gap: 0.5rem;
        }

        .toggle-btn {
          padding: 0.5rem 1rem;
          border: 1px solid #d1d5db;
          background: white;
          border-radius: 4px;
          font-size: 0.875rem;
          cursor: pointer;
          transition: all 0.2s;
        }

        .toggle-btn:hover {
          background: #f9fafb;
        }

        .toggle-btn.active {
          background: #ff6b35;
          color: white;
          border-color: #ff6b35;
        }

        .toggle-btn:disabled {
          opacity: 0.4;
          cursor: not-allowed;
        }

        .toggle-btn:disabled:hover {
          background: white;
        }

        .opacity-control {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .opacity-control label {
          display: flex;
          justify-content: space-between;
          font-size: 0.875rem;
          font-weight: 500;
          color: #374151;
        }

        .opacity-control .value {
          font-weight: 400;
          color: #6b7280;
        }

        .opacity-control input[type="range"] {
          width: 100%;
          height: 6px;
          border-radius: 3px;
          background: #e5e7eb;
          outline: none;
          -webkit-appearance: none;
        }

        .opacity-control input[type="range"]::-webkit-slider-thumb {
          -webkit-appearance: none;
          width: 16px;
          height: 16px;
          border-radius: 50%;
          background: #ff6b35;
          cursor: pointer;
        }

        .lighting-control {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .checkbox-label {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          font-size: 0.875rem;
          font-weight: 500;
          color: #374151;
          cursor: pointer;
        }

        .checkbox-label input[type="checkbox"] {
          width: 16px;
          height: 16px;
          cursor: pointer;
        }

        .lighting-slider {
          display: flex;
          flex-direction: column;
          gap: 0.25rem;
          padding-left: 1.5rem;
        }

        .lighting-slider label {
          display: flex;
          justify-content: space-between;
          font-size: 0.8rem;
          color: #6b7280;
        }

        .lighting-slider .value {
          font-weight: 400;
        }

        .lighting-slider input[type="range"] {
          width: 100%;
          height: 6px;
          border-radius: 3px;
          background: #e5e7eb;
          outline: none;
          -webkit-appearance: none;
        }

        .lighting-slider input[type="range"]::-webkit-slider-thumb {
          -webkit-appearance: none;
          width: 14px;
          height: 14px;
          border-radius: 50%;
          background: #22c55e;
          cursor: pointer;
        }
      `})]})}const Dr={UPLOAD:"upload",POSITION:"position"};function w_({designUrl:e,designDimensions:t,onClose:n,onSaved:r}){const[i,s]=R.useState(Dr.UPLOAD),[a,l]=R.useState(null),[c,d]=R.useState(null),[u,p]=R.useState(null),[h,f]=R.useState(.8),[m,g]=R.useState({enabled:!1,strength:.6,baseBrightness:1,baseContrast:1}),[x,y]=R.useState(!1),v=R.useRef(null);R.useEffect(()=>{if(e){console.log("[IN-SITU-MODAL] Design URL received:",e==null?void 0:e.substring(0,50));const T=new Image;!e.startsWith("blob:")&&!e.startsWith("data:")&&(T.crossOrigin="anonymous"),T.src=e}else console.warn("[IN-SITU-MODAL] No design URL provided")},[e]);const b=T=>{console.log("[IN-SITU-MODAL] Photo uploaded:",T),l(T),console.log("[IN-SITU-MODAL] Advancing to POSITION step, designUrl:",e==null?void 0:e.substring(0,50)),s(Dr.POSITION)},w=({quad:T,opacity:M,shape:J,lighting:P})=>{d(T),f(M),p(J),P&&g(P)},C=async()=>{if(!a||!c)return null;try{console.log("[InSitu] Loading design from URL:",e);const[T,M]=await Promise.all([xm(a.url),x_(e,1536)]);console.log("[InSitu] Successfully loaded design image");const J=document.createElement("canvas");J.width=T.naturalWidth,J.height=T.naturalHeight;const P=J.getContext("2d");return b_({photoCtx:P,photoImg:T,designImg:M,quad:c,opacity:h,shape:u,lighting:m}),J}catch(T){return console.error("[InSitu] Failed to generate canvas:",T),alert(`Failed to load design: ${T.message}`),null}},_=async()=>{const T=await C();T&&XH(T,"tpv-in-situ-preview.png")},j=async()=>{if(!(!c||!a)){y(!0);try{const T=await C();if(!T)throw new Error("Failed to generate preview");const M=await new Promise(z=>T.toBlob(z,"image/png")),P=`in-situ-previews/${`${Date.now()}-${Math.random().toString(36).substr(2,9)}.png`}`,{error:q}=await Jt.storage.from("tpv-studio-uploads").upload(P,M,{contentType:"image/png",cacheControl:"3600"});if(q)throw q;const{data:{publicUrl:k}}=Jt.storage.from("tpv-studio-uploads").getPublicUrl(P);r&&r({photo_url:a.supabaseUrl||a.url,quad:c,shape:u,opacity:h,lighting:m,preview_url:k}),n()}catch(T){console.error("[IN-SITU] Save failed:",T),alert("Failed to save preview: "+T.message)}finally{y(!1)}}},E=()=>{switch(i){case Dr.UPLOAD:return"Upload Site Photo";case Dr.POSITION:return"Position Your Design";default:return"In-Situ Preview"}};return o.jsxs("div",{className:"modal-overlay in-situ-modal-overlay",onClick:n,children:[o.jsxs("div",{className:"modal-content in-situ-modal",onClick:T=>T.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsxs("div",{className:"header-left",children:[o.jsx("h2",{children:E()}),o.jsxs("div",{className:"step-indicator",children:[o.jsx("span",{className:i===Dr.UPLOAD?"active":"completed",children:"1. Upload"}),o.jsx("span",{className:i===Dr.POSITION?"active":"",children:"2. Position"})]})]}),o.jsx("button",{onClick:n,className:"close-button",children:""})]}),o.jsxs("div",{className:"modal-body",children:[i===Dr.UPLOAD&&o.jsxs("div",{className:"upload-step",children:[o.jsx("p",{className:"step-description",children:"Upload a photo of your site to see how your TPV design will look when installed. For best results, use a photo taken from above or at a slight angle showing the floor area clearly."}),o.jsx(VH,{onPhotoUploaded:b})]}),i===Dr.POSITION&&a&&o.jsx(n7,{ref:v,photoUrl:a.url,svgUrl:e,designSizeMm:{width_mm:t.width,length_mm:t.length},initialOpacity:.8,onChange:w})]}),i===Dr.POSITION&&o.jsxs("div",{className:"modal-footer",children:[o.jsx("button",{onClick:()=>s(Dr.UPLOAD),className:"btn-secondary",children:"Back"}),o.jsxs("div",{className:"footer-actions",children:[o.jsx("button",{onClick:_,disabled:!c,className:"btn-secondary",children:"Download PNG"}),o.jsx("button",{onClick:j,disabled:!c||x,className:"btn-primary",children:x?"Saving...":"Save to Project"})]})]})]}),o.jsx("style",{children:`
        .in-situ-modal-overlay {
          position: fixed;
          inset: 0;
          background: rgba(0, 0, 0, 0.6);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 1000;
          padding: 1rem;
        }

        .in-situ-modal {
          background: white;
          border-radius: 12px;
          width: 100%;
          max-width: 1000px;
          max-height: 90vh;
          display: flex;
          flex-direction: column;
          box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .in-situ-modal .modal-header {
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
          padding: 1.25rem 1.5rem;
          border-bottom: 1px solid #e5e7eb;
        }

        .header-left {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .in-situ-modal .modal-header h2 {
          margin: 0;
          font-size: 1.25rem;
          color: #1e4a7a;
        }

        .step-indicator {
          display: flex;
          gap: 1rem;
          font-size: 0.75rem;
        }

        .step-indicator span {
          color: #9ca3af;
          padding: 0.25rem 0.5rem;
          border-radius: 4px;
        }

        .step-indicator span.active {
          background: #fff7f5;
          color: #ff6b35;
          font-weight: 500;
        }

        .step-indicator span.completed {
          color: #22c55e;
        }

        .close-button {
          background: none;
          border: none;
          font-size: 1.5rem;
          cursor: pointer;
          color: #9ca3af;
          padding: 0;
          line-height: 1;
        }

        .close-button:hover {
          color: #374151;
        }

        .modal-body {
          flex: 1;
          padding: 1.5rem;
          overflow-y: auto;
          min-height: 500px;
        }

        .upload-step {
          display: flex;
          flex-direction: column;
          gap: 1.5rem;
        }

        .step-description {
          margin: 0;
          font-size: 0.875rem;
          color: #6b7280;
          line-height: 1.6;
        }

        .modal-footer {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 1rem 1.5rem;
          border-top: 1px solid #e5e7eb;
          background: #f9fafb;
          border-radius: 0 0 12px 12px;
        }

        .footer-actions {
          display: flex;
          gap: 0.5rem;
        }

        .btn-primary,
        .btn-secondary {
          padding: 0.5rem 1rem;
          border-radius: 4px;
          font-size: 0.875rem;
          font-weight: 500;
          cursor: pointer;
          transition: all 0.2s;
          border: none;
        }

        .btn-primary {
          background: #ff6b35;
          color: white;
        }

        .btn-primary:hover:not(:disabled) {
          background: #e55a2b;
        }

        .btn-primary:disabled {
          background: #d1d5db;
          cursor: not-allowed;
        }

        .btn-secondary {
          background: white;
          color: #374151;
          border: 1px solid #d1d5db;
        }

        .btn-secondary:hover:not(:disabled) {
          background: #f9fafb;
        }

        .btn-secondary:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
          .in-situ-modal {
            max-width: 100%;
            max-height: 100vh;
            border-radius: 0;
          }

          .modal-body {
            padding: 1rem;
          }

          .step-indicator {
            display: none;
          }

          .modal-footer {
            border-radius: 0;
          }
        }
      `})]})}function r7({isOpen:e,onClose:t,onConfirm:n,aspectRatio:r,defaultLongestSide:i=5e3}){const[s,a]=R.useState(i),[l,c]=R.useState(i/1e3),u=(g=>{if(!r||r<=0)return{width:g,length:g};if(r>=1){const x=g,y=Math.round(g/r);return{width:x,length:y}}else{const x=g;return{width:Math.round(g*r),length:x}}})(s),p=r>=1?"landscape":"portrait",h=r>=1?`${r.toFixed(1)}:1`:`1:${(1/r).toFixed(1)}`,f=g=>{const x=parseFloat(g.target.value)||0;c(x),a(Math.round(x*1e3))},m=()=>{n(u.width,u.length),t()};return e?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"dimension-modal-overlay",onClick:t,children:o.jsxs("div",{className:"dimension-modal",onClick:g=>g.stopPropagation(),children:[o.jsxs("div",{className:"dimension-modal-header",children:[o.jsxs("div",{className:"dimension-modal-title",children:[o.jsx("h2",{children:"Set Installation Size"}),o.jsx(Ef,{content:o.jsxs("div",{children:[o.jsx("p",{children:o.jsx("strong",{children:"Why specify dimensions?"})}),o.jsx("p",{style:{marginTop:"0.5rem"},children:"Accurate dimensions are essential for:"}),o.jsxs("ul",{style:{marginTop:"0.5rem",marginBottom:0,paddingLeft:"1.25rem"},children:[o.jsx("li",{children:"Calculating exact material quantities"}),o.jsx("li",{children:"Generating PDF specifications for manufacturers"}),o.jsx("li",{children:"Slicing designs into 1m1m installation tiles"})]}),o.jsxs("p",{style:{marginTop:"0.5rem"},children:[o.jsx("strong",{children:"Tip:"})," Typical playground installations range from 3m to 20m on the longest side."]})]}),position:"bottom"})]}),o.jsx("button",{className:"dimension-modal-close",onClick:t,"aria-label":"Close",children:""})]}),o.jsxs("div",{className:"dimension-modal-body",children:[o.jsx("div",{className:"dimension-info",children:o.jsxs("p",{className:"dimension-aspect",children:["Your design has a ",o.jsxs("strong",{children:[h," ",p]})," aspect ratio"]})}),o.jsxs("div",{className:"dimension-input-group",children:[o.jsx("label",{htmlFor:"longest-dimension",children:"Installation Size (Longest Side)"}),o.jsxs("div",{className:"dimension-input-wrapper",children:[o.jsx("input",{id:"longest-dimension",type:"number",min:"0.1",max:"50",step:"0.1",value:l,onChange:f,className:"dimension-input"}),o.jsx("span",{className:"dimension-unit",children:"meters"})]}),o.jsx("p",{className:"dimension-help",children:"Enter the measurement of the longest side of your installation area. The other dimension will be calculated automatically based on your design's aspect ratio."})]}),o.jsxs("div",{className:"dimension-preview",children:[o.jsx("div",{className:"dimension-preview-title",children:"Calculated Dimensions:"}),o.jsxs("div",{className:"dimension-preview-values",children:[o.jsxs("div",{className:"dimension-preview-item",children:[o.jsx("span",{className:"dimension-preview-label",children:"Width:"}),o.jsxs("span",{className:"dimension-preview-value",children:[(u.width/1e3).toFixed(2),"m"]})]}),o.jsxs("div",{className:"dimension-preview-item",children:[o.jsx("span",{className:"dimension-preview-label",children:"Length:"}),o.jsxs("span",{className:"dimension-preview-value",children:[(u.length/1e3).toFixed(2),"m"]})]}),o.jsxs("div",{className:"dimension-preview-item",children:[o.jsx("span",{className:"dimension-preview-label",children:"Total Area:"}),o.jsxs("span",{className:"dimension-preview-value",children:[(u.width*u.length/1e6).toFixed(2),"m"]})]})]})]}),o.jsxs("div",{className:"dimension-note",children:[o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"8",cy:"8",r:"7"}),o.jsx("line",{x1:"8",y1:"11",x2:"8",y2:"8"}),o.jsx("circle",{cx:"8",cy:"5",r:"0.5",fill:"currentColor"})]}),o.jsx("p",{children:"These dimensions will be used to calculate material quantities for your PDF specification and to slice your design into 1m1m installation tiles."})]})]}),o.jsxs("div",{className:"dimension-modal-footer",children:[o.jsx("button",{className:"dimension-btn dimension-btn-secondary",onClick:t,children:"Cancel"}),o.jsx("button",{className:"dimension-btn dimension-btn-primary",onClick:m,disabled:l<=0,children:"Confirm Size"})]})]})}),o.jsx("style",{children:`
        .dimension-modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.6);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 10000;
        padding: 20px;
        backdrop-filter: blur(4px);
      }

      .dimension-modal {
        background: white;
        border-radius: 16px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        max-width: 500px;
        width: 100%;
        max-height: 90vh;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        animation: dimensionModalSlideIn 0.3s ease-out;
      }

      @keyframes dimensionModalSlideIn {
        from {
          opacity: 0;
          transform: translateY(-20px) scale(0.95);
        }
        to {
          opacity: 1;
          transform: translateY(0) scale(1);
        }
      }

      .dimension-modal-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 24px;
        border-bottom: 1px solid #e5e7eb;
      }

      .dimension-modal-title {
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .dimension-modal-header h2 {
        margin: 0;
        font-size: 1.5rem;
        font-weight: 600;
        color: #111827;
      }

      .dimension-modal-close {
        background: none;
        border: none;
        font-size: 2rem;
        line-height: 1;
        color: #9ca3af;
        cursor: pointer;
        padding: 0;
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 8px;
        transition: all 0.2s;
      }

      .dimension-modal-close:hover {
        background: #f3f4f6;
        color: #111827;
      }

      .dimension-modal-body {
        padding: 24px;
        overflow-y: auto;
        flex: 1;
      }

      .dimension-info {
        background: #f0f9ff;
        border: 1px solid #bae6fd;
        border-radius: 12px;
        padding: 16px;
        margin-bottom: 24px;
      }

      .dimension-aspect {
        margin: 0;
        color: #0c4a6e;
        font-size: 0.95rem;
        line-height: 1.5;
      }

      .dimension-input-group {
        margin-bottom: 24px;
      }

      .dimension-input-group label {
        display: block;
        font-weight: 600;
        color: #374151;
        margin-bottom: 8px;
        font-size: 0.95rem;
      }

      .dimension-input-wrapper {
        position: relative;
        display: flex;
        align-items: center;
      }

      .dimension-input {
        width: 100%;
        padding: 12px 16px;
        padding-right: 70px;
        font-size: 1.1rem;
        border: 2px solid #d1d5db;
        border-radius: 10px;
        transition: all 0.2s;
        font-family: inherit;
      }

      .dimension-input:focus {
        outline: none;
        border-color: #3b82f6;
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
      }

      .dimension-unit {
        position: absolute;
        right: 16px;
        color: #6b7280;
        font-weight: 500;
        pointer-events: none;
      }

      .dimension-help {
        margin: 8px 0 0 0;
        font-size: 0.85rem;
        color: #6b7280;
      }

      .dimension-preview {
        background: #f9fafb;
        border: 1px solid #e5e7eb;
        border-radius: 12px;
        padding: 20px;
        margin-bottom: 24px;
      }

      .dimension-preview-title {
        font-weight: 600;
        color: #374151;
        margin-bottom: 16px;
        font-size: 0.95rem;
      }

      .dimension-preview-values {
        display: flex;
        flex-direction: column;
        gap: 12px;
      }

      .dimension-preview-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 12px;
        background: white;
        border-radius: 8px;
      }

      .dimension-preview-label {
        color: #6b7280;
        font-size: 0.9rem;
      }

      .dimension-preview-value {
        font-weight: 600;
        color: #111827;
        font-size: 1.05rem;
      }

      .dimension-note {
        display: flex;
        gap: 12px;
        padding: 16px;
        background: #fffbeb;
        border: 1px solid #fde68a;
        border-radius: 10px;
      }

      .dimension-note svg {
        flex-shrink: 0;
        margin-top: 2px;
        color: #f59e0b;
      }

      .dimension-note p {
        margin: 0;
        font-size: 0.85rem;
        color: #78350f;
        line-height: 1.5;
      }

      .dimension-modal-footer {
        padding: 20px 24px;
        border-top: 1px solid #e5e7eb;
        display: flex;
        gap: 12px;
        justify-content: flex-end;
      }

      .dimension-btn {
        padding: 10px 24px;
        border-radius: 8px;
        font-weight: 600;
        font-size: 0.95rem;
        cursor: pointer;
        transition: all 0.2s;
        border: none;
        font-family: inherit;
      }

      .dimension-btn-secondary {
        background: white;
        border: 1px solid #d1d5db;
        color: #374151;
      }

      .dimension-btn-secondary:hover {
        background: #f9fafb;
        border-color: #9ca3af;
      }

      .dimension-btn-primary {
        background: #3b82f6;
        color: white;
      }

      .dimension-btn-primary:hover {
        background: #2563eb;
        box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
      }

      .dimension-btn-primary:disabled {
        background: #9ca3af;
        cursor: not-allowed;
        box-shadow: none;
      }

      @media (max-width: 640px) {
        .dimension-modal {
          max-width: none;
          width: 100%;
          margin: 0;
          max-height: 100vh;
          border-radius: 0;
        }

        .dimension-modal-header {
          padding: 20px;
        }

        .dimension-modal-header h2 {
          font-size: 1.25rem;
        }

        .dimension-modal-body {
          padding: 20px;
        }

        .dimension-modal-footer {
          flex-direction: column-reverse;
          padding: 16px 20px;
        }

        .dimension-btn {
          width: 100%;
        }
      }
      `})]}):null}function i7(e,t,n){return"#"+[e,t,n].map(r=>r.toString(16).padStart(2,"0")).join("").toUpperCase()}async function s7(e,t={}){const{canvasSize:n=500,ignoreWhite:r=!0,ignoreTransparent:i=!0}=t;return new Promise((s,a)=>{const l=document.createElement("canvas");l.width=n,l.height=n;const c=l.getContext("2d",{willReadFrequently:!0}),d=new Image,u=new Blob([e],{type:"image/svg+xml"}),p=URL.createObjectURL(u);d.onload=()=>{try{c.clearRect(0,0,n,n);const h=Math.min(n/d.width,n/d.height),f=d.width*h,m=d.height*h,g=(n-f)/2,x=(n-m)/2;c.drawImage(d,g,x,f,m);const v=c.getImageData(0,0,n,n).data,b=new Map;let w=0;for(let _=0;_<v.length;_+=4){const j=v[_],E=v[_+1],T=v[_+2],M=v[_+3];if(i&&M<128||r&&j>250&&E>250&&T>250)continue;const J=i7(j,E,T),P=b.get(J)||0;b.set(J,P+1),w++}const C=new Map;for(const[_,j]of b)C.set(_,{coverage:w>0?j/w*100:0,pixelCount:j});URL.revokeObjectURL(p),s(C)}catch(h){URL.revokeObjectURL(p),a(h)}},d.onerror=h=>{URL.revokeObjectURL(p),a(new Error("Failed to load SVG for coverage analysis"))},d.src=p})}function ks(e){if(!e)return null;let t=e.replace("#","").toUpperCase();return t.length===3&&(t=t.split("").map(n=>n+n).join("")),"#"+t}function o7(e,t=10){const n=Array.from(e.entries()),r=new Map,i=new Set;for(const[s,a]of n){if(i.has(s))continue;let l=a.coverage,c=a.pixelCount;const d=py(s);for(const[u,p]of n){if(s===u||i.has(u))continue;const h=py(u);Math.max(Math.abs(d.r-h.r),Math.abs(d.g-h.g),Math.abs(d.b-h.b))<=t&&(l+=p.coverage,c+=p.pixelCount,i.add(u))}i.add(s),r.set(s,{coverage:l,pixelCount:c})}return r}function py(e){const t=e.replace("#","");return{r:parseInt(t.substring(0,2),16),g:parseInt(t.substring(2,4),16),b:parseInt(t.substring(4,6),16)}}async function a7(e,t={}){try{const r=await(await fetch(e)).text();return s7(r,t)}catch(n){throw console.error("[CoverageAnalyzer] Failed to fetch SVG from URL:",n),n}}const l7=[{code:"RH01",name:"Standard Red",hex:"#A5362F"},{code:"RH02",name:"Bright Red",hex:"#E21F2F"},{code:"RH10",name:"Standard Green",hex:"#609B63"},{code:"RH11",name:"Bright Green",hex:"#3BB44A"},{code:"RH12",name:"Dark Green",hex:"#006C55"},{code:"RH20",name:"Standard Blue",hex:"#0075BC"},{code:"RH21",name:"Purple",hex:"#493D8C"},{code:"RH22",name:"Light Blue",hex:"#47AFE3"},{code:"RH23",name:"Azure",hex:"#039DC4"},{code:"RH26",name:"Turquoise",hex:"#00A6A3"},{code:"RH30",name:"Standard Beige",hex:"#E4C4AA"},{code:"RH31",name:"Cream",hex:"#E8E3D8"},{code:"RH32",name:"Brown",hex:"#8B5F3C"},{code:"RH90",name:"Funky Pink",hex:"#E8457E"},{code:"RH40",name:"Mustard Yellow",hex:"#E5A144"},{code:"RH41",name:"Bright Yellow",hex:"#FFD833"},{code:"RH50",name:"Orange",hex:"#F15B32"},{code:"RH60",name:"Dark Grey",hex:"#59595B"},{code:"RH61",name:"Light Grey",hex:"#939598"},{code:"RH65",name:"Pale Grey",hex:"#D9D9D6"},{code:"RH70",name:"Black",hex:"#231F20"}];function c7(e){if(!e)return null;const t=ks(e);return l7.find(n=>ks(n.hex)===t)||null}function fy(e){const t=e.replace("#","");return{r:parseInt(t.substring(0,2),16),g:parseInt(t.substring(2,4),16),b:parseInt(t.substring(4,6),16)}}function my(e,t,n=10){const r=ks(t);if(!r)return 0;for(const[l,c]of e)if(ks(l)===r)return c.coverage;const i=fy(r);let s=null,a=1/0;for(const[l,c]of e){const d=fy(ks(l)),u=Math.max(Math.abs(i.r-d.r),Math.abs(i.g-d.g),Math.abs(i.b-d.b));u<=n&&u<a&&(a=u,s=c)}return s?s.coverage:0}async function gy(e,t,n,r="solid"){var i,s;if(!e||!t)return t||[];try{const a=await a7(e,{canvasSize:600,ignoreWhite:!0,ignoreTransparent:!0}),l=o7(a,5);console.log("[deriveCurrentColors] Coverage analysis:",l);const c=new Map;n&&n.size>0&&n.forEach(p=>{const h=typeof p=="string"?p:p.hex,f=ks(h);f&&h!=="transparent"&&h!=="none"&&(!c.has(f)||p.tpvCode)&&c.set(f,{hex:f,tpvCode:p.tpvCode||null,tpvName:p.tpvName||null,editType:p.editType||"unknown",blendComponents:p.blendComponents||null})});const d=new Map;for(const p of t){const h=ks(((i=p.blendColor)==null?void 0:i.hex)||((s=p.targetColor)==null?void 0:s.hex));if(!h)continue;const f=my(l,h,10);f>.1&&d.set(h,{...p,targetColor:{...p.targetColor,areaPct:f}})}for(const[p,h]of c)if(!d.has(p)){const f=my(l,p,10);if(f>.1){const m=h.tpvCode?{code:h.tpvCode,name:h.tpvName}:c7(p);d.set(p,{originalColor:{hex:p},targetColor:{hex:p,areaPct:f},blendColor:{hex:p},chosenRecipe:h.blendComponents?{components:h.blendComponents,deltaE:0,quality:"Custom Blend"}:{components:m?[{code:m.code,name:m.name,percentage:100,parts:10}]:[{code:"CUSTOM",name:"Custom Color",percentage:100,parts:10}],deltaE:0,quality:m?"Pure TPV Colour":"Custom"},tpvCode:h.tpvCode||(m==null?void 0:m.code)||null,tpvName:h.tpvName||(m==null?void 0:m.name)||null,isAddedFromEdit:!0})}}const u=Array.from(d.values()).sort((p,h)=>{var f,m;return(((f=h.targetColor)==null?void 0:f.areaPct)||0)-(((m=p.targetColor)==null?void 0:m.areaPct)||0)});return console.log("[deriveCurrentColors] Derived colors:",u.length,"colors"),u}catch(a){return console.error("[deriveCurrentColors] Failed to analyze coverage:",a),t}}function d7(e){if(!e||e.size===0)return!1;for(const t of e.values()){const n=typeof t=="string"?t:t.hex;if(n&&n!=="transparent"&&n!=="none")return!0}return!1}const vy={landscape:[{name:"1:1",ratio:1,width:1024,height:1024},{name:"4:3",ratio:4/3,width:1024,height:768},{name:"3:2",ratio:3/2,width:1024,height:683},{name:"16:9",ratio:16/9,width:1024,height:576},{name:"2:1",ratio:2,width:1024,height:512},{name:"3:1",ratio:3,width:1024,height:341}],portrait:[{name:"1:1",ratio:1,width:1024,height:1024},{name:"3:4",ratio:3/4,width:768,height:1024},{name:"2:3",ratio:2/3,width:683,height:1024},{name:"9:16",ratio:9/16,width:576,height:1024},{name:"1:2",ratio:1/2,width:512,height:1024},{name:"1:3",ratio:1/3,width:341,height:1024}]},ka={safeDifference:.3,tilingThreshold:3.5,framingThreshold:2.5};function u7(e,t){return e/t}function h7(e){return e>=.95&&e<=1.05?"square":e>1?"landscape":"portrait"}function p7(e,t){const n=t==="portrait"?vy.portrait:vy.landscape;let r=n[0],i=Math.abs(e-r.ratio);for(const s of n){const a=Math.abs(e-s.ratio);a<i&&(i=a,r=s)}return{...r,difference:i}}function f7(e,t,n){return e>=ka.tilingThreshold||e<=1/ka.tilingThreshold?{mode:"tiling",reason:"Extreme aspect ratio - design will repeat along length",warning:!0}:n>=ka.safeDifference||e>=ka.framingThreshold||e<=1/ka.framingThreshold?{mode:"framing",reason:"Design panel centered with base color surround",warning:!1}:{mode:"full",reason:"Design fills entire surface",warning:!1}}function m7(e,t){const n=u7(e,t),r=h7(n),i=p7(n,r),s=f7(n,i.ratio,i.difference);return{user:{widthMM:e,heightMM:t,aspectRatio:n,orientation:r,formatted:`${(e/1e3).toFixed(1)}m  ${(t/1e3).toFixed(1)}m`},canonical:{name:i.name,ratio:i.ratio,width:i.width,height:i.height,difference:i.difference},layout:s,recraft:{width:i.width,height:i.height,metadata:{targetWidthMM:e,targetHeightMM:t,layoutMode:s.mode}}}}function g7(e){const{user:t,canonical:n,layout:r}=e;let i=`Generating ${n.name} design panel`;return r.mode==="full"?i+=` (fills ${t.formatted} surface)`:r.mode==="framing"?i+=` (centered in ${t.formatted} surface with base color surround)`:r.mode==="tiling"&&(i+=` (will repeat along ${t.formatted} surface)`),i}function v7(e){return e.layout.warning||e.layout.mode!=="full"}async function y7(e,t="tpv-studio-uploads"){try{const n=Date.now(),r=Math.random().toString(36).substring(7),i=e.name.split(".").pop(),a=`uploads/${`${n}-${r}.${i}`}`;console.log("[Upload] Uploading file:",e.name,"",a);const{data:l,error:c}=await Jt.storage.from(t).upload(a,e,{cacheControl:"3600",upsert:!1});if(c)return console.error("[Upload] Error:",c),{success:!1,error:c.message||"Failed to upload file"};const{data:{publicUrl:d}}=Jt.storage.from(t).getPublicUrl(a);return console.log("[Upload] Success:",d),{success:!0,url:d,path:a}}catch(n){return console.error("[Upload] Unexpected error:",n),{success:!1,error:n.message||"Unexpected error during upload"}}}function yy(e,t={}){const{maxSizeMB:n=10,allowedTypes:r=["image/png","image/jpeg","image/svg+xml"]}=t;if(!e)return{valid:!1,error:"No file selected"};if(!r.includes(e.type))return{valid:!1,error:`Invalid file type. Allowed: ${r.map(a=>a.split("/")[1].toUpperCase()).join(", ")}`};const i=n*1024*1024;return e.size>i?{valid:!1,error:`File too large. Maximum size: ${n}MB`}:{valid:!0}}function x7({onExportSVG:e,onExportPNG:t,onExportPDF:n,onExportTiles:r,viewMode:i,exporting:s,disabled:a}){const[l,c]=R.useState(!1),d=R.useRef(null);R.useEffect(()=>{const h=f=>{d.current&&!d.current.contains(f.target)&&c(!1)};return l&&document.addEventListener("mousedown",h),()=>document.removeEventListener("mousedown",h)},[l]);const u=i==="solid"?"Solid":"Blend",p=h=>{c(!1),h()};return o.jsxs("div",{className:"playground-export-menu",ref:d,children:[o.jsxs("button",{className:"action-bar__btn action-bar__btn--export",onClick:()=>c(!l),disabled:a||s,children:[o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"}),o.jsx("polyline",{points:"7 10 12 15 17 10"}),o.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),s?"Exporting...":"Export",o.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{marginLeft:"0.25rem"},children:o.jsx("path",{d:l?"M18 15l-6-6-6 6":"M6 9l6 6 6-6"})})]}),l&&o.jsxs("div",{className:"playground-export-menu__dropdown",children:[o.jsxs("button",{className:"playground-export-menu__item",onClick:()=>p(e),children:[o.jsx("span",{className:"playground-export-menu__icon",children:""}),o.jsxs("div",{className:"playground-export-menu__content",children:[o.jsxs("span",{className:"playground-export-menu__title",children:["Download ",u," SVG"]}),o.jsx("span",{className:"playground-export-menu__desc",children:"Vector format for CAD/printing"})]})]}),o.jsxs("button",{className:"playground-export-menu__item",onClick:()=>p(t),children:[o.jsx("span",{className:"playground-export-menu__icon",children:""}),o.jsxs("div",{className:"playground-export-menu__content",children:[o.jsxs("span",{className:"playground-export-menu__title",children:["Download ",u," PNG"]}),o.jsx("span",{className:"playground-export-menu__desc",children:"High-res image for presentations"})]})]}),o.jsxs("button",{className:"playground-export-menu__item",onClick:()=>p(r),children:[o.jsx("span",{className:"playground-export-menu__icon",children:""}),o.jsxs("div",{className:"playground-export-menu__content",children:[o.jsx("span",{className:"playground-export-menu__title",children:"Download Tiles ZIP"}),o.jsx("span",{className:"playground-export-menu__desc",children:"1m1m SVG tiles for large printing"})]})]}),o.jsx("div",{className:"playground-export-menu__divider"}),o.jsxs("button",{className:"playground-export-menu__item",onClick:()=>p(n),children:[o.jsx("span",{className:"playground-export-menu__icon",children:""}),o.jsxs("div",{className:"playground-export-menu__content",children:[o.jsxs("span",{className:"playground-export-menu__title",children:[u," Recipe Report (PDF)"]}),o.jsx("span",{className:"playground-export-menu__desc",children:"TPV quantities & specifications"})]})]})]})]})}function ja(e){var n;if(!e)return null;if(e.type==="image/svg+xml")return"svg";if(e.type==="image/png"||e.type==="image/jpeg")return"image";const t=(n=e.name.split(".").pop())==null?void 0:n.toLowerCase();return t==="svg"?"svg":["png","jpg","jpeg"].includes(t)?"image":null}function b7({loadedDesign:e,onDesignSaved:t,isEmbedded:n=!1}){const r=sd(),{inputMode:i,prompt:s,lengthMM:a,widthMM:l,arMapping:c,uploadedFileUrl:d,result:u,jobId:p,blendRecipes:h,colorMapping:f,blendSvgUrl:m,blendEditedColors:g,solidRecipes:x,solidColorMapping:y,solidSvgUrl:v,solidEditedColors:b,viewMode:w,showFinalRecipes:C,showSolidSummary:_,regionOverrides:j,originalTaggedSvg:E,regionOverridesHistory:T,historyIndex:M,designName:J,currentDesignId:P,hasUnsavedChanges:q,resetDesign:k}=r,z=r.setInputMode,he=r.setPrompt,Z=r.setDimensions,K=r.setArMapping;r.setGenerationResult;const H=r.setResult,X=r.setJobId;r.setBlendState;const F=r.setBlendRecipes,W=r.setColorMapping,re=r.setBlendSvgUrl;r.setSolidState;const se=r.setSolidRecipes,me=r.setSolidColorMapping,ke=r.setSolidSvgUrl;r.updateBlendSvgUrl,r.updateSolidSvgUrl;const pe=r.setBlendEditedColors,Pe=r.setSolidEditedColors;r.setViewMode;const Re=r.setShowFinalRecipes,Ge=r.setShowSolidSummary,$e=r.setRegionOverrides;r.addRegionOverride;const we=r.setOriginalTaggedSvg,xe=r.setRegionOverridesHistory,S=r.setHistoryIndex;r.canUndo,r.canRedo,r.undo,r.redo;const ue=r.setDesignName,ce=r.setCurrentDesignId,I=r.loadDesign,N=Q=>Z(Q,a),B=Q=>Z(l,Q),[oe,de]=R.useState(null),[G,te]=R.useState(null),[ge,V]=R.useState(!1),[$,D]=R.useState(!1),[ae,Se]=R.useState(null),[le,ie]=R.useState(null),[je,Y]=R.useState(""),[ne,Ie]=R.useState(null),[Ke,Je]=R.useState(!1),[De,Ye]=R.useState(null),[at,ht]=R.useState(!1),[et,dt]=R.useState(null),[nn,Pr]=R.useState([]),[qr,gi]=R.useState(!1),[vi,wt]=R.useState(!1),[Wt,lt]=R.useState(null),[nr,rr]=R.useState(!1),[Tn,Yt]=R.useState(!1),[Nn,Nt]=R.useState(!1),[rn,gt]=R.useState(null),[Rr,ft]=R.useState(!1),[sn,pt]=R.useState(null),[zn,Pt]=R.useState(null),[$t,_t]=R.useState(null),[St,on]=R.useState(null),[vt,Fn]=R.useState(null),[Yr,ir]=R.useState(!1),[yi,Xr]=R.useState(null),Bn=R.useRef(null);R.useEffect(()=>{(v||m)&&Bn.current&&!vi&&!Ke&&setTimeout(()=>{var Q;(Q=Bn.current)==null||Q.scrollIntoView({behavior:"smooth",block:"start"})},300)},[v,m,vi,Ke]),R.useEffect(()=>{(async()=>{try{const ve=await rd({limit:1,offset:0});Xr(ve.designs.length>0),console.log("[INSPIRE] Existing designs check:",ve.designs.length>0?"User has designs":"No designs found")}catch(ve){console.error("[INSPIRE] Failed to check for existing designs:",ve),Xr(!0)}})()},[]),R.useEffect(()=>{i==="upload"?(Z(null,null),console.log("[DIMENSION] Reset dimensions for upload mode")):i==="prompt"&&(l===null||a===null)&&(Z(5e3,5e3),console.log("[DIMENSION] Restored default dimensions for prompt mode"))},[i,Z]),R.useEffect(()=>()=>{m&&m.startsWith("blob:")&&URL.revokeObjectURL(m),v&&v.startsWith("blob:")&&URL.revokeObjectURL(v)},[]),R.useEffect(()=>{const Q=ve=>{ve.key==="Escape"&&at&&(ht(!1),dt(null))};return window.addEventListener("keydown",Q),()=>window.removeEventListener("keydown",Q)},[at]),R.useEffect(()=>{nn.length>0&&!qr&&$r()},[nn,qr]),R.useEffect(()=>{(async()=>{if(!m&&!v){on(null),Fn(null);return}if(!d7(j)){on(h),Fn(x);return}ir(!0),console.log("[INSPIRE] Recalculating current recipes from edited SVG...");try{if(m&&h){const ve=await gy(m,h,j,"blend");on(ve),console.log("[INSPIRE] Derived blend recipes:",ve.length)}if(v&&x){const ve=await gy(v,x,j,"solid");Fn(ve),console.log("[INSPIRE] Derived solid recipes:",ve.length)}}catch(ve){console.error("[INSPIRE] Failed to recalculate recipes:",ve),on(h),Fn(x)}finally{ir(!1)}})()},[m,v,j,h,x]),R.useEffect(()=>{if(e){console.log("[INSPIRE] Loading design data:",e);const Q=vp(e);console.log("[INSPIRE] Restored state:",Q),I(Q),e.name&&ue(e.name),e.id&&ce(e.id),console.log("[INSPIRE] Loaded design:",e.name),setTimeout(async()=>{var ve;if((ve=Q.result)!=null&&ve.svg_url){console.log("[INSPIRE] Regenerating SVGs from loaded design");let be=Q.originalTaggedSvg||null;if(be)console.log("[INSPIRE] Using saved tagged SVG with preserved region IDs"),we(be);else try{const Qe=await(await fetch(Q.result.svg_url)).text();be=$o(Qe),we(be),console.log("[INSPIRE] Tagged SVG with region IDs for loaded design")}catch(Ce){console.error("[INSPIRE] Failed to tag SVG regions:",Ce)}try{Q.blendRecipes&&Q.colorMapping&&await os(Q.result.svg_url,Q.colorMapping,Q.blendRecipes,Q.blendEditedColors,be,Q.regionOverrides),Q.solidRecipes&&Q.solidColorMapping&&await ki(Q.result.svg_url,Q.solidColorMapping,Q.solidRecipes,Q.solidEditedColors,be,Q.regionOverrides)}catch(Ce){console.error("[INSPIRE] Failed to regenerate SVGs:",Ce),ie("Failed to restore design preview. Please try reloading.")}}},100)}},[e,I,ue,ce,we]);const Or=R.useRef(!1);R.useEffect(()=>{if(e||Or.current||!((u==null?void 0:u.svg_url)&&!m&&!v&&(h||x)))return;Or.current=!0,console.log("[INSPIRE] Detected design loaded directly into store, regenerating SVGs..."),(async()=>{let be=E||null;if(be)console.log("[INSPIRE] Using existing tagged SVG with preserved region IDs");else try{const Qe=await(await fetch(u.svg_url)).text();be=$o(Qe),we(be),console.log("[INSPIRE] Tagged SVG with region IDs")}catch(Ce){console.error("[INSPIRE] Failed to tag SVG regions:",Ce)}try{h&&f&&await os(u.svg_url,f,h,g,be,j),x&&y&&await ki(u.svg_url,y,x,b,be,j)}catch(Ce){console.error("[INSPIRE] Failed to regenerate SVGs:",Ce),ie("Failed to restore design preview. Please try reloading.")}})()},[u,m,v,h,x,f,y,e,j,E]),R.useEffect(()=>{u||(Or.current=!1)},[u]);const Zr=Q=>{var Ce;const ve=(Ce=Q.target.files)==null?void 0:Ce[0];if(!ve){de(null);return}const be=yy(ve,{maxSizeMB:10,allowedTypes:["image/png","image/jpeg","image/svg+xml"]});if(!be.valid){ie(be.error),de(null);return}de(ve),ie(null)},Fs=Q=>{Q.preventDefault(),Q.stopPropagation(),V(!0)},Bs=Q=>{Q.preventDefault(),Q.stopPropagation(),Q.currentTarget===Q.target&&V(!1)},oa=Q=>{Q.preventDefault(),Q.stopPropagation()},xi=Q=>{Q.preventDefault(),Q.stopPropagation(),V(!1);const ve=Q.dataTransfer.files;if(ve&&ve.length>0){const be=ve[0],Ce=yy(be,{maxSizeMB:10,allowedTypes:["image/png","image/jpeg","image/svg+xml"]});if(!Ce.valid){ie(Ce.error),de(null);return}de(be),ie(null)}},Ar=async()=>{var Q,ve;if(i==="prompt"&&!s.trim()){ie("Please enter a design description");return}if(i==="upload"&&!oe){ie("Please select a file to upload");return}if(i==="upload"&&oe&&!ja(oe)){ie("Unsupported file type. Please upload PNG, JPG, or SVG.");return}ie(null),D(!0),Se(null),H(null),X(null),Y("Initialising..."),Ie(null);try{let be;if(i==="upload"&&oe){const Le=ja(oe);Y(Le==="svg"?"Uploading SVG file...":"Uploading image..."),te("Uploading...");const _e=await y7(oe);if(!_e.success)throw new Error(_e.error||"Failed to upload file");if(te(null),Le==="svg"){if(Y("Processing SVG..."),be=await cs.processUploadedSVG({svg_url:_e.url}),!be.success)throw new Error(be.error||"Failed to process SVG");X(be.jobId),Y(" SVG uploaded successfully!"),D(!1);const U=await cs.getRecraftStatus(be.jobId);Se(U),H(U.result),(Q=U.result)!=null&&Q.svg_url&&await ns(U.result.svg_url,be.jobId);return}else{if(Y("Starting vectorisation..."),be=await cs.vectorizeImage({image_url:_e.url}),!be.success)throw new Error(be.error||"Failed to start vectorisation");Y(" AI is vectorising your image...")}}else if(i==="prompt"){const Le=m7(a,l);if(K(Le),console.log("[TPV-STUDIO] AR Mapping:",Le),console.log("[TPV-STUDIO] Layout:",g7(Le)),v7(Le)?Y(`Generating ${Le.canonical.name} design panel...`):Y("Initialising..."),be=await cs.generateRecraft({prompt:s.trim(),lengthMM:Le.recraft.height,widthMM:Le.recraft.width}),!be.success)throw new Error(be.error||"Failed to start generation");Y(" AI is creating your design...")}X(be.jobId),Y("Request submitted, waiting for processing...");let Ce=null,Qe=Date.now();await cs.waitForRecraftCompletion(be.jobId,Le=>{var U,ye;Se(Le);const _e=Math.floor((Date.now()-Qe)/1e3);if(Le.status==="queued"){const Te=[` Preparing your canvas... (${_e}s)`,` Warming up the AI brushes... (${_e}s)`,` Queueing your masterpiece... (${_e}s)`,` Mixing digital paints... (${_e}s)`,` AI is contemplating your vision... (${_e}s)`,` Selecting the perfect colours... (${_e}s)`,` Calculating vector paths... (${_e}s)`,` Almost ready to create... (${_e}s)`],nt=Math.floor(_e/4)%Te.length;Y(Te[nt])}else if(Le.status==="running")if(Ce!=="running")Y(" AI is creating your design..."),Ce="running";else{const Te=[` Creating vector shapes... (${_e}s)`,` Applying colours and patterns... (${_e}s)`,` Refining design details... (${_e}s)`,` Finalising artwork... (${_e}s)`],nt=Math.floor(_e/5)%Te.length;Y(Te[nt])}else if(Le.status==="retrying"){const Te=((U=Le.recraft)==null?void 0:U.attempt_current)||0,nt=((ye=Le.recraft)==null?void 0:ye.attempt_max)||3;Y(` Retrying generation (attempt ${Te}/${nt})...`)}});const He=await cs.getRecraftStatus(be.jobId);Se(He),H(He.result),He.status==="completed"&&(Y(" Design ready!"),D(!1),(ve=He.result)!=null&&ve.svg_url&&await ns(He.result.svg_url,be.jobId))}catch(be){console.error("Generation failed:",be),ie(be.message),Y(""),D(!1)}},Hn=()=>{const Q=w==="solid"?v:m,ve=w==="solid"?"tpv-solid":"tpv-blend";if(Q){const be=document.createElement("a");be.href=Q,be.download=`${ve}-${Date.now()}.svg`,document.body.appendChild(be),be.click(),document.body.removeChild(be)}},Pn=async Q=>{try{const be=await(await fetch(Q)).text(),He=new DOMParser().parseFromString(be,"image/svg+xml").querySelector("svg");if(!He)return null;let Le,_e;const U=He.getAttribute("viewBox");if(U){const Te=U.split(/\s+/).map(Number);Le=Te[2],_e=Te[3]}else Le=parseFloat(He.getAttribute("width"))||1024,_e=parseFloat(He.getAttribute("height"))||1024;const ye=Le/_e;return console.log(`[DIMENSION] Detected aspect ratio: ${ye.toFixed(2)} (${Le}${_e})`),ye}catch(ve){return console.error("[DIMENSION] Failed to detect aspect ratio:",ve),null}},es=(Q,ve)=>{console.log(`[DIMENSION] User confirmed dimensions: ${Q}mm  ${ve}mm`),N(Q),B(ve),_t({width:Q,height:ve}),zn==="pdf"?setTimeout(()=>Rn(Q,ve),100):zn==="tiles"?setTimeout(()=>ei(Q,ve),100):zn==="insitu"?setTimeout(()=>Nt(!0),100):zn==="save"&&rr(!0),Pt(null)},Kr=async()=>{const Q=w==="solid"?v:m;if(i==="upload"&&(!l||!a)){console.log("[DIMENSION] No dimensions set for upload, showing modal...");const ve=await Pn(Q);if(ve){pt(ve),Pt("insitu"),ft(!0);return}else{pt(1),Pt("insitu"),ft(!0);return}}Nt(!0)},ts=()=>{const Q=w==="solid"?v:m,ve=w==="solid"?"tpv-solid":"tpv-blend";if(Q){const be=new Image;be.onload=()=>{const Ce=document.createElement("canvas");Ce.width=be.naturalWidth||1e3,Ce.height=be.naturalHeight||1e3,Ce.getContext("2d").drawImage(be,0,0),Ce.toBlob(He=>{const Le=URL.createObjectURL(He),_e=document.createElement("a");_e.href=Le,_e.download=`${ve}-${Date.now()}.png`,document.body.appendChild(_e),_e.click(),document.body.removeChild(_e),URL.revokeObjectURL(Le)})},be.src=Q}},bi=()=>{q()&&!window.confirm(`Start a new design?

You have unsaved changes that will be lost.`)||(k(),de(null),D(!1),Se(null),ie(null),Y(""),Ie(null),Je(!1),Ye(null),ht(!1),dt(null),wt(!1),lt(null))},Jr=async()=>{const Q=w==="solid"?v:m,ve=l>0&&a>0;if(i==="upload"&&!ve){console.log("[DIMENSION] No dimensions set for upload, showing modal before save...");const Ce=await Pn(Q);if(Ce){pt(Ce),Pt("save"),ft(!0);return}else{pt(1),Pt("save"),ft(!0);return}}rr(!0)},[Qr,Mr]=R.useState(!1),Un=async()=>{const Q=w==="solid"?v:m;if(i==="upload"&&(!l||!a)){console.log("[DIMENSION] No dimensions set for upload, showing modal...");const ve=await Pn(Q);if(ve){pt(ve),Pt("pdf"),ft(!0);return}else{pt(1),Pt("pdf"),ft(!0);return}}await Rn(l,a)},Rn=async(Q,ve)=>{const be=w==="solid"?v:m,Ce=w==="solid"?vt||x:St||h,Qe=w==="solid"?"tpv-solid":"tpv-blend";if(!be||!Ce){ie("Cannot generate PDF: missing SVG or recipes");return}Mr(!0),ie(null);try{const Le=await(await fetch(be)).text(),_e=new AbortController,U=setTimeout(()=>_e.abort(),3e4),ye=await Br.getSession(),Te={"Content-Type":"application/json"};ye!=null&&ye.access_token&&(Te.Authorization=`Bearer ${ye.access_token}`);const nt=await fetch("/api/export-pdf",{method:"POST",headers:Te,signal:_e.signal,body:JSON.stringify({svgString:Le,designName:J||s||"TPV Design",projectName:"TPV Studio",dimensions:{widthMM:Q,lengthMM:ve},recipes:Ce,mode:w,designId:p||""})});if(clearTimeout(U),!nt.ok){const pn=nt.headers.get("content-type");if(pn&&pn.includes("application/json")){const sr=await nt.json();throw new Error(sr.message||"PDF generation failed")}else{const sr=await nt.text();throw console.error("PDF API error response:",sr),new Error(`Server error: ${nt.status}`)}}const it=await nt.blob(),Xe=URL.createObjectURL(it),Ze=document.createElement("a");Ze.href=Xe,Ze.download=`${Qe}-${Date.now()}.pdf`,document.body.appendChild(Ze),Ze.click(),document.body.removeChild(Ze),URL.revokeObjectURL(Xe)}catch(He){console.error("PDF download error:",He),He.name==="AbortError"?ie("PDF generation timed out. Please try again."):ie(`PDF generation failed: ${He.message}`)}finally{Mr(!1)}},wi=async()=>{const Q=w==="solid"?v:m;if(!Q){ie("No SVG available to slice");return}if(i==="upload"&&(!l||!a)){console.log("[DIMENSION] No dimensions set for upload, showing modal...");const ve=await Pn(Q);if(ve){pt(ve),Pt("tiles"),ft(!0);return}else{pt(1),Pt("tiles"),ft(!0);return}}await ei(l,a)},ei=async(Q,ve)=>{const be=w==="solid"?v:m;try{await w5(be,{width:Q,length:ve},J||"tpv-design")}catch(Ce){console.error("Tile download error:",Ce),ie(`Failed to download tiles: ${Ce.message}`)}},ns=async(Q=null,ve=null)=>{const be=Q||(u==null?void 0:u.svg_url),Ce=ve||p;if(!be){ie("No SVG available to analyse");return}{console.log("[TPV-STUDIO] Blend mode disabled - skipping blend recipes, generating solid only"),ie(null),Y(" Processing design colours...");let Qe=null;try{const Le=await(await fetch(be)).text();Qe=$o(Le),we(Qe),console.log("[TPV-STUDIO] Tagged SVG with region IDs")}catch(He){console.error("[TPV-STUDIO] Failed to tag SVG regions:",He)}await hn(be,Ce,Qe);return}},_i=async()=>{Je(!1),Ye(null),wt(!1),lt(null),w==="solid"?Pe(new Map):pe(new Map),u!=null&&u.svg_url&&await ns(u.svg_url,p)},Si=async Q=>{var ve;if(!J){if(!s||i!=="prompt"){oe&&ue(`TPV Design  ${oe.name.replace(/\.[^/.]+$/,"")}`);return}Yt(!0);try{const be=(Q==null?void 0:Q.slice(0,6).map(Qe=>{var Le,_e;const He=(_e=(Le=Qe.chosenRecipe)==null?void 0:Le.components)==null?void 0:_e[0];return(He==null?void 0:He.name)||null}).filter(Boolean))||[],Ce=await cs.generateDesignName({prompt:s,colors:be,dimensions:{widthMM:l,lengthMM:a}});Ce.success&&((ve=Ce.names)==null?void 0:ve.length)>0?ue(Ce.names[0]):ue(wn(s))}catch(be){console.error("[TPV-STUDIO] Name generation failed:",be),ue(wn(s))}finally{Yt(!1)}}},wn=Q=>Q?`TPV Design  ${Q.split(/[,.]/)[0].trim().slice(0,40)}`:"TPV Playground Design",hn=async(Q=null,ve=null,be=null)=>{const Ce=Q||(u==null?void 0:u.svg_url),Qe=ve||p,He=be||E;if(Ce)try{console.log("[TPV-STUDIO] Generating solid color version...");const Le=await fetch("/api/solid-recipes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({svg_url:Ce,job_id:Qe,max_colors:15})}),_e=await Le.json();if(!Le.ok)throw new Error(_e.error||"Failed to generate solid recipes");if(_e.success){se(_e.recipes);const U=new Map(Object.entries(_e.colorMapping||{}));console.log("[TPV-STUDIO] Using API colorMapping with",U.size,"entries"),me(U);try{const{dataUrl:ye,stats:Te}=await vs(Ce,U,He);ke(ye),console.log("[TPV-STUDIO] Solid color SVG generated:",Te),Te.colorsNotMapped&&Te.colorsNotMapped.size>0&&console.warn("[TPV-STUDIO] Unmapped colors in solid mode:",Array.from(Te.colorsNotMapped)),Si(_e.recipes)}catch(ye){console.error("[TPV-STUDIO] Failed to generate solid SVG:",ye)}}}catch(Le){console.error("[TPV-STUDIO] Solid generation failed:",Le)}},aa=(Q,ve="palette")=>{if(console.log("[TPV-STUDIO] Color clicked:",Q,"source:",ve,"in mode:",w),at&&et&&ve==="palette"){kt(et.regionId,Q.hex),ht(!1),dt(null);return}ve==="palette"&&(w==="blend"?(lt(Q),wt(!0),Re(!1)):(Ye(Q),Je(!0),Ge(!1)))},rs=Q=>{console.log("[TPV-STUDIO] Region clicked:",Q),at?(kt(et.regionId,Q.sourceColor),ht(!1),dt(null)):(ht(!0),dt(Q))},kt=(Q,ve)=>{const be=typeof ve=="string"?{hex:ve,editType:"eyedrop"}:ve;console.log("[TPV-STUDIO] Queuing region recolor:",Q,"->",be),Pr(Ce=>[...Ce,{regionId:Q,colorData:{...be,hex:be.hex.toLowerCase()},viewMode:w}])},$r=async()=>{if(qr||nn.length===0)return;gi(!0);const Q=nn[0],ve=Q.colorData;console.log("[TPV-STUDIO] Processing queued region recolor:",Q.regionId,"->",ve);try{const be=new Map(j);be.set(Q.regionId,ve),Q.viewMode==="blend"?await Gt(null,null,be):await _n(null,null,be),$e(be);const Ce=r.historyIndex,He=r.regionOverridesHistory.slice(0,Ce+1);He.push(new Map(be)),He.length>50&&He.shift(),xe(He),S(He.length-1),console.log("[TPV-STUDIO] Completed region recolor for:",Q.regionId)}catch(be){console.error("[TPV-STUDIO] Failed to process region recolor:",be)}finally{Pr(be=>be.slice(1)),gi(!1)}},la=()=>{console.log("[TPV-STUDIO] Eyedropper cancelled"),ht(!1),dt(null)},Hs=()=>{et&&(console.log("[TPV-STUDIO] Making region transparent:",et.regionId),kt(et.regionId,"transparent"),ht(!1),dt(null))},Lr=Q=>{if(!et)return;console.log("[TPV-STUDIO] Selecting TPV color for region:",et.regionId,Q);const ve={hex:Q.hex,tpvCode:Q.code,tpvName:Q.name,originalHex:et.sourceColor,editType:"solid"};kt(et.regionId,ve),ht(!1),dt(null)},yt=async()=>{if(M<=0)return;const Q=M-1,ve=T[Q];console.log("[TPV-STUDIO] Undoing region override to index:",Q),$e(new Map(ve)),S(Q),w==="blend"?await Gt(null,null,ve):await _n(null,null,ve)},is=async()=>{if(M>=T.length-1)return;const Q=M+1,ve=T[Q];console.log("[TPV-STUDIO] Redoing region override to index:",Q),$e(new Map(ve)),S(Q),w==="blend"?await Gt(null,null,ve):await _n(null,null,ve)},ca=async Q=>{if(De)if(console.log("[TPV-STUDIO] Color changed:",De.hex,"->",Q,"in mode:",w),w==="solid"){const be=(vt||x).find(Ce=>Ce.targetColor.hex.toLowerCase()===De.hex.toLowerCase());if(be!=null&&be.isAddedFromEdit){const Ce=De.hex.toLowerCase(),Qe=new Map(j);let He=0;const Le=dn.find(U=>U.hex.toLowerCase()===Q.toLowerCase());j.forEach((U,ye)=>{(typeof U=="string"?U:U.hex).toLowerCase()===Ce&&(Qe.set(ye,{hex:Q,tpvCode:(Le==null?void 0:Le.code)||null,tpvName:(Le==null?void 0:Le.name)||null,originalHex:U.originalHex||Ce,editType:"solid"}),He++)}),console.log("[TPV-STUDIO] Updated",He,"region overrides for derived color:",Ce,"->",Q);const _e=T.slice(0,M+1);_e.push(new Map(Qe)),_e.length>50&&_e.shift(),$e(Qe),xe(_e),S(_e.length-1),Ye({...De,hex:Q,blendHex:Q}),await _n(b,Q,Qe)}else{const Ce=new Map(b),Qe=(be==null?void 0:be.mergedOriginalColors)||[De.originalHex.toLowerCase()];console.log("[TPV-STUDIO] Updating",Qe.length,"original colors:",Qe),Qe.forEach(He=>{Ce.set(He,{newHex:Q.toLowerCase()})}),Pe(Ce),Ye({...De,hex:Q,blendHex:Q}),await _n(Ce,Q)}}else{const ve=new Map(g);ve.set(De.originalHex.toLowerCase(),{newHex:Q.toLowerCase()}),pe(ve),Ye({...De,hex:Q,blendHex:Q}),await Gt(ve,Q)}};R.useCallback(async({blendHex:Q,parts:ve,recipe:be})=>{if(Wt)if(console.log("[TPV-STUDIO] Mixer blend changed:",Wt.originalHex,"->",Q,"recipe:",be,"isAddedFromEdit:",Wt.isAddedFromEdit),Wt.isAddedFromEdit){const Ce=Wt.hex.toLowerCase(),Qe=new Map(j);let He=0;j.forEach((_e,U)=>{(typeof _e=="string"?_e:_e.hex).toLowerCase()===Ce&&(Qe.set(U,{hex:Q,originalHex:_e.originalHex||Ce,editType:"blend",blendComponents:(be==null?void 0:be.components)||null}),He++)}),console.log("[TPV-STUDIO] Updated",He,"region overrides for derived blend color:",Ce,"->",Q),lt({...Wt,hex:Q,blendHex:Q}),await Gt(g,Q,Qe);const Le=T.slice(0,M+1);Le.push(new Map(Qe)),Le.length>50&&Le.shift(),$e(Qe),xe(Le),S(Le.length-1)}else{const Ce=new Map(g);Ce.set(Wt.originalHex.toLowerCase(),{newHex:Q.toLowerCase(),recipe:be,parts:ve}),pe(Ce),lt({...Wt,hex:Q,blendHex:Q}),await Gt(Ce,Q)}},[Wt,g,j,T,M,u,f]);const Gt=async(Q=null,ve=null,be=null)=>{if(!(!(u!=null&&u.svg_url)||!f||!h))try{const Ce=new Map(f),Qe=Q||g;Qe.forEach((it,Xe)=>{if(it.newHex){const Ze=Xe.toLowerCase();Ce.set(Ze,{...Ce.get(Ze),blendHex:it.newHex})}});const He=h.map(it=>{const Xe=Qe.get(it.originalColor.hex.toLowerCase());if(Xe!=null&&Xe.newHex){const Ze={...it,targetColor:{...it.targetColor,hex:Xe.newHex},blendColor:{...it.blendColor,hex:Xe.newHex}};return Xe.recipe&&Xe.recipe.components&&(Ze.chosenRecipe={...it.chosenRecipe,components:Xe.recipe.components,deltaE:0,quality:"Excellent"}),Ze}return it}),{svgText:Le,stats:_e}=await vs(u.svg_url,Ce,E),U=be!==null?be:j,ye=Eo(Le,U);m&&m.startsWith("blob:")&&(URL.revokeObjectURL(m),console.log("[TPV-STUDIO] Revoked old blend blob URL"));const Te=new Blob([ye],{type:"image/svg+xml"}),nt=URL.createObjectURL(Te);console.log("[TPV-STUDIO] Created new blend blob URL, SVG length:",ye.length),re(nt),W(Ce),F(He),console.log("[TPV-STUDIO] Blend SVG regenerated with edits:",_e),U.size>0&&console.log("[TPV-STUDIO] Applied",U.size,"region overrides")}catch(Ce){console.error("[TPV-STUDIO] Failed to regenerate blend SVG:",Ce)}},_n=async(Q=null,ve=null,be=null)=>{if(!(!(u!=null&&u.svg_url)||!y||!x))try{const Ce=new Map(y),Qe=Q||b;Qe.forEach((it,Xe)=>{if(it.newHex){const Ze=Xe.toLowerCase();Ce.set(Ze,{...Ce.get(Ze),blendHex:it.newHex})}});const He=x.map(it=>{const Xe=Qe.get(it.originalColor.hex.toLowerCase());if(Xe!=null&&Xe.newHex){const Ze=dn.find(pn=>pn.hex.toLowerCase()===Xe.newHex.toLowerCase());return Ze?{...it,targetColor:{...it.targetColor,hex:Xe.newHex},blendColor:{hex:Xe.newHex,rgb:Ze.rgb,lab:Ze.lab},chosenRecipe:{components:[{code:Ze.code,name:Ze.name,hex:Ze.hex,rgb:Ze.rgb,lab:Ze.lab,ratio:1}],blendColor:{hex:Ze.hex,rgb:Ze.rgb,lab:Ze.lab},deltaE:0,quality:"Perfect"}}:{...it,targetColor:{...it.targetColor,hex:Xe.newHex},blendColor:{...it.blendColor,hex:Xe.newHex}}}return it}),{svgText:Le,stats:_e}=await vs(u.svg_url,Ce,E),U=be!==null?be:j,ye=Eo(Le,U);v&&v.startsWith("blob:")&&(URL.revokeObjectURL(v),console.log("[TPV-STUDIO] Revoked old solid blob URL"));const Te=new Blob([ye],{type:"image/svg+xml"}),nt=URL.createObjectURL(Te);console.log("[TPV-STUDIO] Created new solid blob URL, SVG length:",ye.length),ke(nt),me(Ce),se(He),console.log("[TPV-STUDIO] Solid SVG regenerated with edits:",_e),U.size>0&&console.log("[TPV-STUDIO] Applied",U.size,"region overrides")}catch(Ce){console.error("[TPV-STUDIO] Failed to regenerate solid SVG:",Ce)}},ss=Q=>{if(!(Q!=null&&Q.components))return null;const ve={};return Q.components.forEach(be=>{be.code&&be.parts&&(ve[be.code]=be.parts)}),Object.keys(ve).length>0?{parts:ve}:null};R.useCallback(Q=>{var be;if(!Q)return null;const ve=g.get((be=Q.originalHex)==null?void 0:be.toLowerCase());return ve!=null&&ve.recipe?ve.recipe:Q.isAddedFromEdit&&Q.chosenRecipe?ss(Q.chosenRecipe):Q.recipe||null},[g]);const os=async(Q,ve,be,Ce,Qe=null,He=null)=>{try{console.log("[INSPIRE] Regenerating blend SVG from state");const Le=new Map(ve);Ce&&Ce.size>0&&Ce.forEach((it,Xe)=>{const Ze=Xe.toLowerCase();Le.has(Ze)&&Le.set(Ze,{...Le.get(Ze),blendHex:it.newHex})});const{dataUrl:_e,svgText:U}=await vs(Q,Le,Qe);let ye=U;He&&He.size>0&&(console.log("[INSPIRE] Applying",He.size,"region overrides to blend SVG"),ye=Eo(U,He));const Te=new Blob([ye],{type:"image/svg+xml"}),nt=URL.createObjectURL(Te);re(nt),console.log("[INSPIRE] Blend SVG regenerated")}catch(Le){console.error("[INSPIRE] Failed to regenerate blend SVG:",Le)}},ki=async(Q,ve,be,Ce,Qe=null,He=null)=>{try{console.log("[INSPIRE] Regenerating solid SVG from state");const Le=new Map(ve);Ce&&Ce.size>0&&Ce.forEach((it,Xe)=>{const Ze=Xe.toLowerCase();Le.has(Ze)&&Le.set(Ze,{...Le.get(Ze),blendHex:it.newHex})});const{dataUrl:_e,svgText:U}=await vs(Q,Le,Qe);let ye=U;He&&He.size>0&&(console.log("[INSPIRE] Applying",He.size,"region overrides to solid SVG"),ye=Eo(U,He));const Te=new Blob([ye],{type:"image/svg+xml"}),nt=URL.createObjectURL(Te);ke(nt),console.log("[INSPIRE] Solid SVG regenerated")}catch(Le){console.error("[INSPIRE] Failed to regenerate solid SVG:",Le)}};return o.jsxs("div",{className:`inspire-panel-recraft${n?" inspire-panel-recraft--embedded":""}`,children:[!n&&o.jsxs("div",{className:"panel-header",children:[o.jsx("h2",{children:"TPV Studio - Vector AI"}),o.jsx("p",{className:"subtitle",children:"AI-powered vector designs for playground surfacing"})]}),!u&&!$&&yi===!1&&o.jsxs("div",{className:"welcome-guidance",children:[o.jsx("div",{className:"welcome-icon",children:""}),o.jsx("h3",{children:"Create Your First Design"}),o.jsx("p",{children:"Choose how you'd like to create your TPV design below. You can describe what you want, upload an image to convert, or process an existing SVG file. Once generated, you'll be able to edit colours, export PDFs with specifications, and preview designs on-site."})]}),o.jsxs("div",{className:"input-mode-tabs",children:[o.jsxs("button",{className:`input-mode-tab ${i==="prompt"?"active":""}`,onClick:()=>{z("prompt"),de(null),ie(null)},disabled:$,children:[o.jsxs("svg",{className:"mode-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M12 3l1.545 4.635L18.18 9.18l-4.635 1.545L12 15.36l-1.545-4.635L5.82 9.18l4.635-1.545L12 3z"}),o.jsx("path",{d:"M5 21l1.5-4.5L2 15l4.5-1.5L8 9l1.5 4.5L14 15l-4.5 1.5L8 21z",opacity:"0.5"})]}),o.jsx("span",{className:"mode-title",children:"Text Prompt"}),o.jsx("span",{className:"mode-description",children:"Describe your design"})]}),o.jsxs("button",{className:`input-mode-tab ${i==="upload"?"active":""}`,onClick:()=>{z("upload"),he(""),ie(null)},disabled:$,children:[o.jsxs("svg",{className:"mode-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),o.jsx("polyline",{points:"17 8 12 3 7 8"}),o.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]}),o.jsx("span",{className:"mode-title",children:"Upload Design"}),o.jsx("span",{className:"mode-description",children:"PNG, JPG, or SVG"})]})]}),o.jsxs("div",{className:"form-section",children:[i==="prompt"&&o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"prompt",children:"Design Description"}),o.jsx("textarea",{id:"prompt",value:s,onChange:Q=>he(Q.target.value),placeholder:"e.g., calm ocean theme with big fish silhouettes and waves",rows:4,disabled:$,className:"prompt-input"}),o.jsx("p",{className:"helper-text",children:"Describe the design you want to generate. The AI will create a vector illustration based on your description. Perfect for creating completely new designs from scratch - just describe colors, themes, and elements you want."})]}),i==="upload"&&o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"design-upload",children:"Upload Design File"}),o.jsxs("div",{className:`drop-zone ${ge?"dragging":""} ${oe?"has-file":""}`,onDragEnter:Fs,onDragLeave:Bs,onDragOver:oa,onDrop:xi,children:[o.jsx("input",{id:"design-upload",type:"file",accept:".png,.jpg,.jpeg,.svg,image/png,image/jpeg,image/svg+xml",onChange:Zr,disabled:$,className:"file-input-hidden"}),o.jsx("label",{htmlFor:"design-upload",className:"drop-zone-content",children:oe?o.jsxs(o.Fragment,{children:[o.jsxs("svg",{className:"upload-icon success",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),o.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),o.jsx("span",{className:"file-name",children:oe.name}),o.jsx("span",{className:"file-type-badge",children:ja(oe)==="svg"?"SVG - will process immediately":"Image - will vectorise with AI"}),o.jsx("span",{className:"drop-hint",children:"Click to change file"})]}):o.jsxs(o.Fragment,{children:[o.jsxs("svg",{className:"upload-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),o.jsx("polyline",{points:"17 8 12 3 7 8"}),o.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]}),o.jsx("span",{className:"drop-text",children:"Drag & drop your design here"}),o.jsx("span",{className:"drop-hint",children:"or click to browse"}),o.jsx("span",{className:"supported-formats",children:"PNG, JPG, or SVG"})]})})]}),o.jsxs("p",{className:"helper-text",children:["Upload your design file. ",o.jsx("strong",{children:"PNG/JPG"})," images will be vectorised with AI (~30 seconds). ",o.jsx("strong",{children:"SVG"})," files are processed immediately for TPV colour matching."]})]}),i==="prompt"&&o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"length",children:"Length (mm)"}),o.jsx("input",{id:"length",type:"number",value:a,onChange:Q=>B(parseInt(Q.target.value,10)),min:1e3,max:2e4,step:100,disabled:$})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"width",children:"Width (mm)"}),o.jsx("input",{id:"width",type:"number",value:l,onChange:Q=>N(parseInt(Q.target.value,10)),min:1e3,max:2e4,step:100,disabled:$})]})]}),le&&o.jsxs("div",{className:"error-message",children:[o.jsx("strong",{children:"Error:"})," ",le]}),G&&o.jsx("div",{className:"upload-progress",children:o.jsx("p",{children:G})}),o.jsx("button",{onClick:Ar,disabled:$||i==="prompt"&&!s.trim()||i==="upload"&&!oe,className:"generate-button",children:$?i==="upload"&&oe&&ja(oe)==="svg"?"Processing...":"Generating...":i==="prompt"?"Generate Vector Design":oe&&ja(oe)==="svg"?"Process SVG":"Vectorise & Process"})]}),$&&o.jsxs("div",{className:"progress-section",children:[o.jsx("div",{className:"progress-bar",children:o.jsx("div",{className:"progress-bar-fill"})}),o.jsx("p",{className:"progress-message",children:je})]}),u&&!$&&o.jsxs("div",{className:"results-section",children:[c&&o.jsxs("div",{className:`ar-info ${c.layout.mode}`,children:[o.jsxs("div",{className:"ar-info-header",children:[o.jsx("strong",{children:"Layout:"})," ",c.layout.reason]}),o.jsxs("div",{className:"ar-info-details",children:[o.jsxs("span",{children:["Requested: ",c.user.formatted]}),o.jsx("span",{children:""}),o.jsxs("span",{children:["Generated: ",c.canonical.name," panel"]}),c.layout.mode==="framing"&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:""}),o.jsx("span",{className:"layout-note",children:"Panel centred with base colour surround"})]}),c.layout.mode==="tiling"&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:""}),o.jsx("span",{className:"layout-note",children:"Pattern will repeat along length"})]})]})]}),gs.BLEND_MODE_ENABLED,gs.BLEND_MODE_ENABLED,w==="solid"&&v&&x&&o.jsx("div",{ref:Bn,children:o.jsx(T5,{blendSvgUrl:v,recipes:vt||x,mode:"solid",onColorClick:aa,onRegionClick:rs,onEyedropperCancel:la,onMakeTransparent:Hs,onSelectTPVColor:Lr,selectedColor:De,editedColors:b,onResetAll:_i,designName:J,onNameChange:ue,isNameLoading:Tn,onInSituClick:Kr,eyedropperActive:at,eyedropperRegion:et,onRegionUndo:yt,onRegionRedo:is,canUndo:M>0,canRedo:M<T.length-1,regionOverridesCount:j.size})}),gs.BLEND_MODE_ENABLED,(m||v)&&o.jsxs("div",{className:"action-bar",children:[o.jsxs("button",{className:"action-bar__btn action-bar__btn--secondary",onClick:bi,title:"Start a new design",children:[o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M12 5v14M5 12h14"})}),"New"]}),o.jsxs("button",{className:"action-bar__btn action-bar__btn--primary",onClick:Jr,title:"Save this design to your gallery",children:[o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z"}),o.jsx("polyline",{points:"17 21 17 13 7 13 7 21"}),o.jsx("polyline",{points:"7 3 7 8 15 8"})]}),"Save"]}),o.jsx(x7,{onExportSVG:Hn,onExportPNG:ts,onExportPDF:Un,onExportTiles:wi,viewMode:w,exporting:Qr,disabled:!(m||v)})]})]}),gs.BLEND_MODE_ENABLED,w==="solid"&&v&&x&&!_&&o.jsxs("div",{className:"finalize-section",children:[o.jsx("button",{onClick:()=>Ge(!0),className:"finalize-button",children:"View TPV Colours Used"}),o.jsx("p",{className:"finalize-hint",children:"See which pure TPV colours are used in this design"})]}),gs.BLEND_MODE_ENABLED,_&&x&&o.jsx(j5,{recipes:vt||x,onClose:()=>{Ge(!1)},isRecalculating:Yr}),Ke&&De&&o.jsx(FH,{color:De,mode:w,onColorChange:ca,onClose:()=>{Je(!1),Ye(null)}}),nr&&o.jsx(UH,{currentState:{inputMode:i,prompt:s,selectedFile:oe,lengthMM:($t==null?void 0:$t.height)||a,widthMM:($t==null?void 0:$t.width)||l,result:u,viewMode:w,blendRecipes:h,solidRecipes:x,colorMapping:f,solidColorMapping:y,solidEditedColors:b,blendEditedColors:g,blendSvgUrl:m,solidSvgUrl:v,arMapping:c,jobId:p,inSituData:rn,regionOverrides:j,originalTaggedSvg:E},existingDesignId:P,initialName:J,onClose:()=>{rr(!1),_t(null)},onSaved:(Q,ve)=>{rr(!1),_t(null),Xr(!0),ve&&ue(ve),t&&t(ve),console.log("[INSPIRE] Design saved:",Q)}}),Nn&&o.jsx(w_,{designUrl:w==="solid"?v:m,designDimensions:{width:l,length:a},onClose:()=>Nt(!1),onSaved:Q=>{console.log("[INSPIRE] In-situ preview saved:",Q),gt(Q),Nt(!1)}}),o.jsx(r7,{isOpen:Rr,onClose:()=>{ft(!1),Pt(null)},onConfirm:es,aspectRatio:sn,defaultLongestSide:5e3}),o.jsx("style",{jsx:!0,children:`
        .inspire-panel-recraft {
          max-width: var(--max-width-xl);
          margin: 0 auto;
          padding: var(--space-4);
        }

        .panel-header {
          text-align: center;
          margin-bottom: var(--space-6);
        }

        .panel-header h2 {
          font-family: var(--font-heading);
          font-size: var(--text-3xl);
          margin: 0 0 var(--space-2) 0;
          color: var(--color-primary);
          font-weight: var(--font-bold);
          letter-spacing: var(--tracking-tight);
        }

        .subtitle {
          color: var(--color-text-secondary);
          font-size: var(--text-base);
          line-height: var(--leading-relaxed);
        }

        /* Welcome Guidance */
        .welcome-guidance {
          background: linear-gradient(135deg, #fff5f0 0%, #fff9f7 100%);
          border: 2px solid #ff6b35;
          border-radius: var(--radius-lg);
          padding: var(--space-6);
          margin-bottom: var(--space-6);
          text-align: center;
        }

        .welcome-icon {
          font-size: 3rem;
          margin-bottom: var(--space-2);
        }

        .welcome-guidance h3 {
          margin: 0 0 var(--space-3);
          font-size: var(--text-xl);
          font-weight: var(--font-bold);
          color: var(--color-primary);
        }

        .welcome-guidance p {
          margin: 0;
          color: var(--color-text-secondary);
          font-size: var(--text-base);
          line-height: var(--leading-relaxed);
          max-width: 600px;
          margin-left: auto;
          margin-right: auto;
        }

        /* Input Mode Tabs - Enhanced cards */
        .input-mode-tabs {
          display: flex;
          gap: var(--space-2);
          margin-bottom: var(--space-3);
          background: var(--color-bg-subtle);
          padding: var(--space-1);
          border-radius: var(--radius-lg);
        }

        .input-mode-tab {
          flex: 1;
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: var(--space-1);
          padding: var(--space-3);
          background: var(--color-bg-card);
          border: 1px solid var(--color-border);
          border-radius: var(--radius-md);
          cursor: pointer;
          transition: all var(--transition-base);
        }

        .input-mode-tab:hover:not(:disabled) {
          border-color: var(--color-primary);
          transform: translateY(-2px);
          box-shadow: var(--shadow-md);
        }

        .input-mode-tab.active {
          background: linear-gradient(135deg, var(--color-bg-subtle) 0%, var(--color-bg-card) 100%);
          border-color: var(--color-primary);
          box-shadow: var(--shadow-glow);
        }

        .input-mode-tab:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .mode-icon {
          width: 28px;
          height: 28px;
          color: var(--color-text-secondary);
          transition: all var(--transition-base);
        }

        .input-mode-tab:hover:not(:disabled) .mode-icon {
          color: var(--color-primary);
          transform: scale(1.1);
        }

        .input-mode-tab.active .mode-icon {
          color: var(--color-primary);
        }

        .input-mode-tab .mode-title {
          font-family: var(--font-heading);
          font-size: var(--text-sm);
          font-weight: var(--font-semibold);
          color: var(--color-text-primary);
          margin-top: 0;
        }

        .input-mode-tab .mode-description {
          display: none; /* Hidden to save space */
        }

        .input-mode-tab.active .mode-title {
          color: var(--color-primary);
          font-weight: var(--font-bold);
        }

        /* Helper text */
        .helper-text {
          margin-top: var(--space-1);
          font-size: var(--text-sm);
          color: var(--color-text-tertiary);
          font-style: normal;
          line-height: var(--leading-snug);
        }

        /* Drag & Drop File Upload */
        .file-input-hidden {
          position: absolute;
          width: 1px;
          height: 1px;
          padding: 0;
          margin: -1px;
          overflow: hidden;
          clip: rect(0, 0, 0, 0);
          white-space: nowrap;
          border: 0;
        }

        .drop-zone {
          position: relative;
          width: 100%;
          min-height: 120px;
          border: 2px dashed var(--color-border);
          border-radius: var(--radius-lg);
          background: var(--color-bg-subtle);
          transition: all var(--transition-base);
        }

        .drop-zone.dragging {
          border-color: var(--color-primary);
          background: var(--color-primary-light);
          background: linear-gradient(135deg, rgba(30, 74, 122, 0.05) 0%, rgba(30, 74, 122, 0.1) 100%);
          box-shadow: var(--shadow-glow);
        }

        .drop-zone.has-file {
          border-color: var(--color-success);
          background: var(--color-success-light);
        }

        .drop-zone-content {
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          gap: var(--space-1);
          padding: var(--space-4);
          cursor: pointer;
          min-height: 120px;
        }

        .upload-icon {
          width: 36px;
          height: 36px;
          color: var(--color-text-secondary);
          transition: all var(--transition-base);
        }

        .upload-icon.success {
          color: var(--color-success);
        }

        .drop-zone:hover .upload-icon {
          color: var(--color-primary);
          transform: scale(1.1);
        }

        .drop-zone.has-file:hover .upload-icon.success {
          color: var(--color-success);
        }

        .drop-text {
          font-size: var(--text-base);
          font-weight: var(--font-semibold);
          color: var(--color-text-primary);
        }

        .file-name {
          font-size: var(--text-base);
          font-weight: var(--font-semibold);
          color: var(--color-success);
          max-width: 100%;
          overflow: hidden;
          text-overflow: ellipsis;
          white-space: nowrap;
        }

        .drop-hint {
          font-size: var(--text-sm);
          color: var(--color-text-tertiary);
        }

        .file-type-badge {
          display: inline-block;
          font-size: var(--text-xs);
          color: var(--color-text-secondary);
          background: var(--color-bg-tertiary);
          padding: var(--space-1) var(--space-2);
          border-radius: var(--radius-sm);
          margin-top: var(--space-1);
        }

        .supported-formats {
          display: block;
          font-size: var(--text-xs);
          color: var(--color-text-tertiary);
          margin-top: var(--space-2);
          font-weight: var(--font-medium);
        }

        .drop-zone.dragging .drop-text,
        .drop-zone.dragging .drop-hint {
          color: var(--color-primary);
        }

        .upload-progress {
          padding: var(--space-2);
          background: var(--color-info-light);
          border: 1px solid var(--color-info);
          border-radius: var(--radius-md);
          color: var(--color-info);
          margin-bottom: var(--space-2);
          text-align: center;
          font-size: var(--text-sm);
        }

        .form-section {
          background: var(--color-bg-card);
          padding: var(--space-3);
          border-radius: var(--radius-lg);
          margin-bottom: var(--space-3);
          border: 1px solid var(--color-border);
          box-shadow: var(--shadow-xs);
        }

        .form-group {
          margin-bottom: var(--space-3);
        }

        .form-group label {
          display: block;
          margin-bottom: var(--space-2);
          font-weight: var(--font-semibold);
          color: var(--color-text-primary);
          font-size: var(--text-sm);
        }

        .prompt-input {
          width: 100%;
          padding: var(--space-3);
          border: 1px solid var(--color-border);
          border-radius: var(--radius-md);
          font-family: inherit;
          font-size: var(--text-base);
          background: var(--color-bg-card);
          color: var(--color-text-primary);
          transition: border-color var(--transition-base);
        }

        .prompt-input:focus {
          outline: none;
          border-color: var(--color-primary);
          box-shadow: var(--shadow-glow);
        }

        .form-row {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: var(--space-3);
        }

        input[type="number"] {
          width: 100%;
          padding: var(--space-2);
          border: 1px solid var(--color-border);
          border-radius: var(--radius-md);
          background: var(--color-bg-card);
          color: var(--color-text-primary);
          font-size: var(--text-base);
          transition: border-color var(--transition-base);
        }

        input[type="number"]:focus {
          outline: none;
          border-color: var(--color-primary);
          box-shadow: var(--shadow-glow);
        }

        .error-message {
          padding: var(--space-3);
          background: var(--color-error-light);
          border: 1px solid var(--color-error);
          border-radius: var(--radius-md);
          color: var(--color-error);
          margin-bottom: var(--space-4);
          font-size: var(--text-sm);
        }

        .generate-button {
          width: 100%;
          padding: var(--space-4);
          background: var(--color-accent);
          color: white;
          border: none;
          border-radius: var(--radius-md);
          font-size: var(--text-lg);
          font-weight: var(--font-semibold);
          cursor: pointer;
          transition: all var(--transition-base);
          box-shadow: var(--shadow-sm);
        }

        .generate-button:hover:not(:disabled) {
          background: var(--color-accent-hover);
          transform: translateY(-2px);
          box-shadow: 0 8px 24px rgba(255, 107, 53, 0.3);
        }

        .generate-button:disabled {
          background: var(--color-bg-subtle);
          color: var(--color-text-tertiary);
          cursor: not-allowed;
          transform: none;
          box-shadow: none;
        }

        .progress-section {
          padding: var(--space-4);
          background: var(--color-info-light);
          border-radius: var(--radius-lg);
          margin-bottom: var(--space-4);
          border: 1px solid var(--color-info);
        }

        .progress-bar {
          height: 4px;
          background: var(--color-border);
          border-radius: var(--radius-full);
          overflow: hidden;
          margin-bottom: var(--space-3);
        }

        .progress-bar-fill {
          height: 100%;
          background: var(--color-accent);
          animation: progress 2s ease-in-out infinite;
        }

        @keyframes progress {
          0% { transform: translateX(-100%); }
          100% { transform: translateX(100%); }
        }

        .progress-message {
          text-align: center;
          color: var(--color-text-secondary);
          font-weight: var(--font-medium);
          font-size: var(--text-base);
        }

        .results-section {
          background: var(--color-bg-card);
          padding: var(--space-4);
          border-radius: var(--radius-lg);
          border: 1px solid var(--color-border);
          box-shadow: var(--shadow-sm);
        }

        .results-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: var(--space-3);
        }

        .results-header h3 {
          font-family: var(--font-heading);
          margin: 0;
          color: var(--color-primary);
          font-size: var(--text-xl);
          font-weight: var(--font-bold);
        }

        /* Aspect Ratio Info */
        .ar-info {
          padding: var(--space-3) var(--space-4);
          border-radius: var(--radius-md);
          margin-bottom: var(--space-3);
          font-size: var(--text-sm);
        }

        .ar-info.full {
          background: var(--color-success-light);
          border: 1px solid var(--color-success);
        }

        .ar-info.framing {
          background: var(--color-warning-light);
          border: 1px solid var(--color-warning);
        }

        .ar-info.tiling {
          background: var(--color-info-light);
          border: 1px solid var(--color-info);
        }

        .ar-info-header {
          color: var(--color-text-primary);
          margin-bottom: var(--space-2);
          font-weight: var(--font-semibold);
        }

        .ar-info-details {
          display: flex;
          flex-wrap: wrap;
          gap: var(--space-2);
          align-items: center;
          color: var(--color-text-secondary);
          font-size: var(--text-sm);
        }

        .ar-info-details span {
          white-space: nowrap;
        }

        .layout-note {
          color: var(--color-accent);
          font-weight: var(--font-medium);
        }

        /* Mode Toggle Tabs */
        .mode-tabs {
          display: flex;
          gap: var(--space-2);
          margin-bottom: var(--space-3);
          background: var(--color-bg-subtle);
          padding: var(--space-1);
          border-radius: var(--radius-lg);
        }

        .mode-tab {
          flex: 1;
          display: flex;
          flex-direction: row;
          align-items: center;
          justify-content: center;
          gap: var(--space-2);
          padding: var(--space-2);
          background: var(--color-bg-card);
          border: 1px solid var(--color-border);
          border-radius: var(--radius-md);
          cursor: pointer;
          transition: all var(--transition-base);
        }

        .mode-tab:hover:not(:disabled) {
          border-color: var(--color-accent);
          transform: translateY(-2px);
          box-shadow: var(--shadow-md);
        }

        .mode-tab.active {
          background: var(--color-accent);
          border-color: var(--color-accent);
          box-shadow: var(--shadow-glow-accent);
        }

        .mode-tab:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .mode-title {
          font-family: var(--font-heading);
          font-size: var(--text-base);
          font-weight: var(--font-semibold);
          color: var(--color-primary);
        }

        .mode-description {
          display: none; /* Hidden to save space */
        }

        .mode-tab.active .mode-title {
          color: white;
          font-weight: var(--font-bold);
        }

        .svg-preview {
          margin: var(--space-2) 0;
          border: 1px solid var(--color-border);
          border-radius: var(--radius-md);
          background: var(--color-bg-subtle);
          padding: var(--space-2);
        }

        .design-preview {
          width: 100%;
          height: auto;
          display: block;
        }

        /* Finalize Section */
        .finalize-section {
          background: var(--color-accent-light);
          border: 2px solid var(--color-accent);
          border-radius: var(--radius-lg);
          padding: var(--space-3);
          margin-top: var(--space-3);
          text-align: center;
        }

        .finalize-button {
          width: 100%;
          max-width: 400px;
          padding: var(--space-3);
          background: var(--color-accent);
          color: white;
          border: none;
          border-radius: var(--radius-md);
          font-size: var(--text-base);
          font-weight: var(--font-semibold);
          cursor: pointer;
          transition: all var(--transition-base);
          box-shadow: var(--shadow-sm);
        }

        .finalize-button:hover {
          background: var(--color-accent-hover);
          transform: translateY(-1px);
          box-shadow: var(--shadow-md);
        }

        .finalize-hint {
          margin: var(--space-2) 0 0 0;
          color: var(--color-text-secondary);
          font-size: var(--text-xs);
        }

        /* Mixer Widget Container Styles */
        .mixer-widget-container {
          margin-top: var(--space-3);
          background: white;
          border-radius: 12px;
          padding: var(--space-3);
          box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        }

        .mixer-widget-header {
          display: flex;
          justify-content: flex-end;
          margin-bottom: var(--space-2);
          padding-bottom: var(--space-2);
          border-bottom: 2px solid var(--color-border);
        }

        .mixer-close-btn {
          padding: var(--space-2) var(--space-4);
          background: var(--color-primary);
          color: white;
          border: none;
          border-radius: 8px;
          font-weight: 600;
          font-size: var(--text-sm);
          cursor: pointer;
          transition: all 0.2s;
        }

        .mixer-close-btn:hover {
          background: #2563eb;
          box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
          transform: translateY(-1px);
        }

        /* Mobile Responsive Styles */
        @media (max-width: 768px) {
          .inspire-panel-recraft {
            padding: var(--space-2);
          }

          .panel-header {
            margin-bottom: var(--space-4);
          }

          .panel-header h2 {
            font-size: var(--text-xl);
          }

          .subtitle {
            font-size: var(--text-sm);
          }

          .welcome-guidance {
            padding: var(--space-4);
            margin-bottom: var(--space-4);
          }

          .welcome-icon {
            font-size: 2rem;
          }

          .welcome-guidance h3 {
            font-size: var(--text-lg);
          }

          .welcome-guidance p {
            font-size: var(--text-sm);
          }

          /* Stack input mode tabs vertically on mobile */
          .input-mode-tabs {
            flex-direction: column;
            gap: var(--space-1);
          }

          .input-mode-tab {
            flex-direction: row;
            justify-content: flex-start;
            padding: var(--space-3);
            min-height: 44px;
          }

          .mode-icon {
            width: 24px;
            height: 24px;
            flex-shrink: 0;
          }

          .input-mode-tab .mode-title {
            font-size: var(--text-sm);
            margin-top: 0;
          }

          .input-mode-tab .mode-description {
            display: none;
          }

          /* Form sections */
          .form-section {
            padding: var(--space-3);
          }

          .form-group label {
            font-size: var(--text-xs);
          }

          /* Stack form rows on mobile */
          .form-row {
            grid-template-columns: 1fr;
            gap: var(--space-2);
          }

          /* Drop zone adjustments */
          .drop-zone {
            min-height: 140px;
          }

          .drop-zone-content {
            padding: var(--space-4);
            min-height: 140px;
          }

          .upload-icon {
            width: 36px;
            height: 36px;
          }

          .drop-text {
            font-size: var(--text-sm);
          }

          /* Generate button */
          .generate-button {
            padding: var(--space-3);
            font-size: var(--text-base);
            min-height: 44px;
          }

          /* Results section - minimal padding for max image width */
          .results-section {
            padding: var(--space-2);
            border-radius: var(--radius-md);
          }

          .results-header h3 {
            font-size: var(--text-lg);
          }

          /* Mode tabs */
          .mode-tabs {
            flex-direction: column;
            gap: var(--space-1);
          }

          .mode-tab {
            flex-direction: row;
            justify-content: flex-start;
            padding: var(--space-3);
            min-height: 44px;
          }

          .mode-title {
            font-size: var(--text-sm);
          }

          .mode-description {
            display: none;
          }

          /* AR info */
          .ar-info {
            padding: var(--space-2) var(--space-3);
          }

          .ar-info-details {
            flex-direction: column;
            align-items: flex-start;
            gap: var(--space-1);
          }

          /* Finalize section */
          .finalize-section {
            padding: var(--space-3);
          }

          .finalize-button {
            padding: var(--space-3);
            font-size: var(--text-base);
          }
        }

        /* Extra small screens */
        @media (max-width: 480px) {
          .inspire-panel-recraft {
            padding: var(--space-1);
          }

          .panel-header h2 {
            font-size: var(--text-lg);
          }

          /* Results section - even less padding */
          .results-section {
            padding: var(--space-1);
            margin: 0 calc(-1 * var(--space-1));
            border-radius: 0;
          }

          .input-mode-tab {
            padding: var(--space-2);
          }

          .mode-tab {
            padding: var(--space-2);
          }
        }
      `})]})}function w7({isOpen:e,onClose:t}){const[n,r]=R.useState(!1),[i,s]=R.useState(!1),[a,l]=R.useState(!1),{addMotif:c}=st(),d=sd(),{currentDesignId:u,blendSvgUrl:p,solidSvgUrl:h,designName:f}=d,m=p||h,g=!!u;R.useEffect(()=>{if(!e)return;const v=b=>{b.key==="Escape"&&t()};return window.addEventListener("keydown",v),()=>window.removeEventListener("keydown",v)},[e,t]),R.useEffect(()=>{e||(l(!1),r(!1),s(!1))},[e]);const x=R.useCallback((v,b)=>{console.log("[EDITOR] Design saved:",v,b),l(!1)},[]),y=async()=>{var v,b;if(!(!m||n)){r(!0);try{const{blendSvgUrl:w,solidSvgUrl:C,widthMM:_,lengthMM:j}=d;let E=null,T=null;if(C)try{E=await(await fetch(C)).text(),console.log("[EDITOR] Fetched solid SVG from blob:",E.length,"chars")}catch(H){console.error("[EDITOR] Failed to fetch solid SVG:",H)}if(w)try{T=await(await fetch(w)).text(),console.log("[EDITOR] Fetched blend SVG from blob:",T.length,"chars")}catch(H){console.error("[EDITOR] Failed to fetch blend SVG:",H)}if(!E&&!T)throw new Error("No SVG content available. Please ensure a design has been generated.");const J=kf(E||T);let P=_||5e3,q=j||5e3;if(J){const H=J.width/J.height;H>1?(P=Math.max(_||5e3,5e3),q=P/H):(q=Math.max(j||5e3,5e3),P=q*H),console.log("[EDITOR] Using SVG aspect ratio:",H,"",P,"x",q,"mm")}s(!0);let k=u;const z=f||`Design ${new Date().toLocaleString("en-GB",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"})}`,he=y_(d);k=(await _f({id:k||void 0,name:z,description:"",tags:[],design_data:he,input_mode:d.inputMode})).design_id,d.setCurrentDesignId(k),d.setDesignName(z),s(!1);const K=((v=d.result)==null?void 0:v.thumb_url)||((b=d.result)==null?void 0:b.png_url)||null;c(k,z,E||T,P,q,K,{solidSvgContent:E,blendSvgContent:T,hasBothVersions:!!(E&&T)}),l(!0),setTimeout(()=>{t()},600)}catch(w){console.error("[EDITOR] Failed to add to canvas:",w),alert("Failed to add design to canvas: "+w.message),s(!1)}finally{r(!1)}}};return e?o.jsx("div",{className:"design-editor-overlay",children:o.jsxs("div",{className:"design-editor-modal",children:[o.jsxs("div",{className:"design-editor__header",children:[o.jsx("div",{className:"design-editor__title",children:o.jsx("h2",{children:"Design Editor"})}),o.jsx("div",{className:"design-editor__hint",children:"Generate a design with AI or upload your own SVG"}),o.jsx("button",{className:"design-editor__close",onClick:t,title:"Close (Esc)",children:o.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),o.jsx("div",{className:"design-editor__content",children:o.jsx(b7,{onDesignSaved:x,isEmbedded:!0})}),o.jsx("div",{className:`design-editor__footer ${a?"design-editor__footer--success":""}`,children:a?o.jsxs("div",{className:"design-editor__success",children:[o.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M20 6L9 17l-5-5"})}),o.jsx("span",{children:"Added to canvas!"})]}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"design-editor__status",children:m?g?o.jsxs("span",{className:"design-editor__saved-indicator",children:[o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M20 6L9 17l-5-5"})}),"Saved to library"]}):o.jsx("span",{className:"design-editor__unsaved-indicator",children:"Design ready  Will auto-save when added"}):o.jsx("span",{className:"design-editor__no-design",children:"Generate or upload a design to continue"})}),o.jsxs("div",{className:"design-editor__actions",children:[o.jsx("button",{className:"design-editor__btn design-editor__btn--secondary",onClick:t,children:"Cancel"}),o.jsx("button",{className:"design-editor__btn design-editor__btn--primary",onClick:y,disabled:!m||n,children:n?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"design-editor__spinner"}),i?"Saving...":"Adding..."]}):o.jsxs(o.Fragment,{children:[o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),o.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"16"}),o.jsx("line",{x1:"8",y1:"12",x2:"16",y2:"12"})]}),"Add to Canvas"]})})]})]})})]})}):null}function _7(){const{addShape:e,addText:t,addExclusionZone:n,standaloneMode:r,startPathDrawing:i}=st(),[s,a]=R.useState(!1);if(r)return null;const l=[{preset:"rectangle",icon:"",label:"Shape"},{preset:"blob",icon:"",label:"Blob"},{preset:"path",icon:"",label:"Pen"}],c=p=>{p==="path"?(i(),a(!1)):e(p)},d=()=>{t(),a(!1)},u=()=>{n("rectangle")};return o.jsxs("div",{className:`shape-toolbar ${s?"shape-toolbar--expanded":""}`,children:[o.jsxs("button",{className:"shape-toolbar__toggle",onClick:()=>a(!s),title:s?"Collapse elements panel":"Add elements",children:[o.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("polygon",{points:"12 2 2 7 12 12 22 7 12 2"}),o.jsx("polyline",{points:"2 17 12 22 22 17"}),o.jsx("polyline",{points:"2 12 12 17 22 12"})]}),!s&&o.jsx("span",{className:"shape-toolbar__label",children:"Elements"})]}),s&&o.jsxs("div",{className:"shape-toolbar__shapes",children:[o.jsxs("button",{className:"shape-toolbar__btn shape-toolbar__btn--text",onClick:d,title:"Add Text Label",children:[o.jsx("span",{className:"shape-toolbar__icon",children:"T"}),o.jsx("span",{className:"shape-toolbar__name",children:"Text"})]}),o.jsx("div",{className:"shape-toolbar__divider"}),l.map(p=>o.jsxs("button",{className:"shape-toolbar__btn",onClick:()=>c(p.preset),title:`Add ${p.label}`,children:[o.jsx("span",{className:"shape-toolbar__icon",children:p.icon}),o.jsx("span",{className:"shape-toolbar__name",children:p.label})]},p.preset)),o.jsx("div",{className:"shape-toolbar__divider"}),o.jsxs("button",{className:"shape-toolbar__btn shape-toolbar__btn--exclusion",onClick:u,title:"Add Exclusion Zone (building, planter, obstacle)",children:[o.jsx("span",{className:"shape-toolbar__icon",style:{fontSize:"1rem"},children:""}),o.jsx("span",{className:"shape-toolbar__name",children:"Exclusion"})]})]})]})}function S7({loadedDesign:e}){var te,ge;const[t,n]=R.useState(!1),[r,i]=R.useState(()=>{const V=st.getState().surface;return V!=null&&V.width_mm?String(V.width_mm/1e3):"50"}),[s,a]=R.useState(()=>{const V=st.getState().surface;return V!=null&&V.length_mm?String(V.length_mm/1e3):"50"}),[l,c]=R.useState(!1),[d,u]=R.useState(!1),[p,h]=R.useState(!1),[f,m]=R.useState(!1),[g,x]=R.useState(!1),[y,v]=R.useState(null),[b,w]=R.useState(null),[C,_]=R.useState(""),j=R.useRef(null);R.useEffect(()=>{if(e){const V=e.design_data||{},$=e.input_mode||V.input_mode||V.blend_recipes||V.solid_recipes,D=V.courts||V.surface||V.tracks;if(console.log("[TPV] Design detection:",{id:e.id,name:e.name,hasDesignData:!!e.design_data,topLevelInputMode:e.input_mode,isPlaygroundDesign:$,isSportsDesign:D}),$&&!D){console.log("[TPV] Loading playground design into editor:",e.id,e.name);const ae=vp(e),Se=sd.getState();Se.loadDesign(ae),e.name&&Se.setDesignName(e.name),Se.setCurrentDesignId(e.id),m(!0)}else e.design_data?(console.log("[SPORTS] Loading design from prop:",e.id,e.name),st.getState().loadDesign(V),w(e.id),_(e.name||""),n(!1)):console.warn("[TPV] Design has no design_data and is not a playground design:",e.id,e.name)}},[e]);const{surface:E,courts:T,tracks:M,selectedCourtId:J,selectedTrackId:P,selectedMotifId:q,selectedShapeId:k,selectedTextId:z,showCourtLibrary:he,showPropertiesPanel:Z,toggleCourtLibrary:K,togglePropertiesPanel:H,setSurfaceDimensions:X,setSurfaceColor:F,setSurfaceBoundaryPreset:W,resetSurfaceBoundary:re,resetDesign:se,hasUnsavedChanges:me,standaloneMode:ke,toggleStandaloneMode:pe,mobileLibraryOpen:Pe,mobilePropertiesOpen:Re,mobileColoursOpen:Ge,mobileActiveTab:$e,setMobileLibraryOpen:we,setMobilePropertiesOpen:xe,setMobileColoursOpen:S,setMobileActiveTab:ue,closeMobileSheets:ce}=st(),I=V=>{V.preventDefault();const $=parseFloat(r)*1e3,D=parseFloat(s)*1e3;$>0&&D>0&&(X($,D),n(!1))},N=V=>{F({tpv_code:V.code,hex:V.hex,name:V.name}),c(!1)},B=()=>{me()&&!window.confirm(`Start a new design?

You have unsaved changes that will be lost.`)||(se(),w(null),_(""),i("50"),a("50"))},oe=()=>{const V=j.current||document.querySelector(".court-canvas__svg");if(!V){alert("Canvas not ready");return}const $=st.getState().exportDesignData(),D=Cf(V,$),ae=new Blob([D],{type:"image/svg+xml"}),Se=URL.createObjectURL(ae);y&&URL.revokeObjectURL(y),v(Se),x(!0)},de=()=>{x(!1),y&&(URL.revokeObjectURL(y),v(null))},G=async V=>{if(!V){alert("Source design ID not found");return}try{const $=await _l(V),D=($==null?void 0:$.design)||$;if(!D)throw new Error("Design not found");const ae=vp(D),Se=sd.getState();Se.loadDesign(ae),D.name&&Se.setDesignName(D.name),Se.setCurrentDesignId(V),m(!0),console.log("[TPV] Loaded source design for editing:",D.name)}catch($){console.error("[TPV] Failed to load source design:",$),alert("Failed to load design: "+$.message)}};return R.useEffect(()=>{const V=$=>{const D=$.target.tagName.toLowerCase();if(D==="input"||D==="textarea"||D==="select")return;const{removeCourt:ae,removeTrack:Se,removeMotif:le,removeShape:ie,removeText:je,deselectCourt:Y,deselectTrack:ne,deselectMotif:Ie,deselectShape:Ke,deselectText:Je,stopEditingText:De,undo:Ye,redo:at,canUndo:ht,canRedo:et,duplicateCourt:dt,duplicateMotif:nn,duplicateShape:Pr,duplicateText:qr,updateCourtPosition:gi,updateTrackPosition:vi,updateMotifPosition:wt,updateShapePosition:Wt,updateTextPosition:lt,courts:nr,tracks:rr,motifs:Tn,shapes:Yt,texts:Nn,selectedMotifId:Nt,selectedShapeId:rn,selectedTextId:gt,editingTextId:Rr,elementOrder:ft,setElementOrder:sn,toggleSnapToGrid:pt,snapToGrid:zn,addToHistory:Pt}=st.getState(),$t=J||P||Nt||rn||gt;if($.key==="Delete"&&$t&&!Rr&&($.preventDefault(),J?ae(J):P?Se(P):Nt?le(Nt):rn?ie(rn):gt&&je(gt)),$.key==="Escape"&&(Rr?De():$t&&(J?Y():P?ne():Nt?Ie():rn?Ke():gt&&Je())),($.ctrlKey||$.metaKey)&&$.key==="z"&&!$.shiftKey&&($.preventDefault(),ht()&&Ye()),($.ctrlKey||$.metaKey)&&$.key==="z"&&$.shiftKey&&($.preventDefault(),et()&&at()),($.ctrlKey||$.metaKey)&&$.key==="d"&&$t&&($.preventDefault(),J?dt(J):Nt?nn(Nt):rn?Pr(rn):gt&&qr(gt)),$t&&!Rr&&["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes($.key)){$.preventDefault();const _t=$.shiftKey?10:100;let St=0,on=0;if($.key==="ArrowLeft"&&(St=-_t),$.key==="ArrowRight"&&(St=_t),$.key==="ArrowUp"&&(on=-_t),$.key==="ArrowDown"&&(on=_t),J){const vt=nr[J];vt&&(gi(J,{x:vt.position.x+St,y:vt.position.y+on}),Pt())}else if(P){const vt=rr[P];vt&&(vi(P,{x:vt.position.x+St,y:vt.position.y+on}),Pt())}else if(Nt){const vt=Tn[Nt];vt&&(wt(Nt,{x:vt.position.x+St,y:vt.position.y+on}),Pt())}else if(rn){const vt=Yt[rn];vt&&(Wt(rn,{x:vt.position.x+St,y:vt.position.y+on}),Pt())}else if(gt){const vt=Nn[gt];vt&&(lt(gt,{x:vt.position.x+St,y:vt.position.y+on}),Pt())}}if($t&&($.key==="["||$.key==="]")){$.preventDefault();const _t=ft.indexOf($t);if(_t===-1)return;const St=[...ft];$.key==="["&&_t>0?([St[_t],St[_t-1]]=[St[_t-1],St[_t]],sn(St),Pt()):$.key==="]"&&_t<ft.length-1&&([St[_t],St[_t+1]]=[St[_t+1],St[_t]],sn(St),Pt())}($.key==="g"||$.key==="G")&&($.preventDefault(),pt()),($.key==="?"||$.shiftKey&&$.key==="/")&&($.preventDefault(),h(!0))};return window.addEventListener("keydown",V),()=>window.removeEventListener("keydown",V)},[J,P,q,k,z]),o.jsxs("div",{className:"sports-designer",children:[t&&o.jsx("div",{className:"sports-designer__modal-overlay",onClick:()=>n(!1),children:o.jsxs("div",{className:"sports-designer__modal",onClick:V=>V.stopPropagation(),children:[o.jsx("h2",{children:"Edit Surface Size"}),o.jsx("p",{children:"Adjust the dimensions of your sports surface"}),o.jsxs("form",{onSubmit:I,children:[o.jsxs("div",{className:"sports-designer__dimension-inputs",children:[o.jsxs("div",{className:"sports-designer__input-group",children:[o.jsx("label",{htmlFor:"width",children:"Width (metres)"}),o.jsx("input",{id:"width",type:"number",min:"5",max:"100",step:"0.5",value:r,onChange:V=>i(V.target.value),required:!0,autoFocus:!0})]}),o.jsx("span",{className:"sports-designer__dimension-separator",children:""}),o.jsxs("div",{className:"sports-designer__input-group",children:[o.jsx("label",{htmlFor:"length",children:"Length (metres)"}),o.jsx("input",{id:"length",type:"number",min:"5",max:"100",step:"0.5",value:s,onChange:V=>a(V.target.value),required:!0})]})]}),o.jsx("p",{className:"sports-designer__dimension-hint",children:"Common sizes: 37m  34m (tennis), 40m  20m (futsal), 50m  50m (multi-sport)"}),o.jsxs("div",{className:"sports-designer__boundary-section",children:[o.jsx("label",{htmlFor:"boundary-shape",children:"Surface Shape"}),o.jsxs("div",{className:"sports-designer__boundary-options",children:[o.jsxs("select",{id:"boundary-shape",value:((te=E.boundary)==null?void 0:te.type)==="polygon"?E.boundary.preset||"custom":"rectangle",onChange:V=>{const $=V.target.value;$==="rectangle"?re():W($)},className:"sports-designer__select",children:[o.jsx("option",{value:"rectangle",children:"Rectangle (default)"}),o.jsx("option",{value:"l-shape",children:"L-Shape"}),o.jsx("option",{value:"u-shape",children:"U-Shape"}),o.jsx("option",{value:"t-shape",children:"T-Shape"})]}),((ge=E.boundary)==null?void 0:ge.type)==="polygon"&&o.jsx("button",{type:"button",className:"sports-designer__btn-secondary",onClick:re,title:"Reset to rectangle",children:"Reset"})]}),o.jsx("p",{className:"sports-designer__boundary-hint",children:"Non-rectangular shapes are useful for L-shaped buildings or irregular sites"})]}),o.jsx("button",{type:"submit",className:"sports-designer__btn-primary",children:"Update Surface"})]})]})}),o.jsxs(o.Fragment,{children:[o.jsxs("header",{className:"sports-designer__mobile-header",children:[o.jsx("span",{className:"sports-designer__mobile-header-title",children:"TPV Designer"}),o.jsxs("div",{className:"sports-designer__mobile-header-actions",children:[o.jsx("button",{className:"sports-designer__mobile-header-btn",onClick:()=>{i(String(E.width_mm/1e3)),a(String(E.length_mm/1e3)),n(!0)},title:"Surface settings",children:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"12",cy:"12",r:"3"}),o.jsx("path",{d:"M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z"})]})}),o.jsx(O0,{svgRef:j,mobileMode:!0})]})]}),o.jsxs("nav",{className:"sports-designer__mobile-action-bar",children:[o.jsxs("button",{className:`sports-designer__mobile-action-btn ${Pe?"sports-designer__mobile-action-btn--active":""}`,onClick:()=>{ce(),we(!0)},children:[o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"12",cy:"12",r:"10"}),o.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"16"}),o.jsx("line",{x1:"8",y1:"12",x2:"16",y2:"12"})]}),o.jsx("span",{children:"Add"})]}),o.jsxs("button",{className:"sports-designer__mobile-action-btn",onClick:()=>{ce(),S(!0)},children:[o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"13.5",cy:"6.5",r:"2.5"}),o.jsx("circle",{cx:"17.5",cy:"10.5",r:"2.5"}),o.jsx("circle",{cx:"8.5",cy:"7.5",r:"2.5"}),o.jsx("circle",{cx:"6.5",cy:"12.5",r:"2.5"})]}),o.jsx("span",{children:"Colours"})]}),o.jsxs("button",{className:`sports-designer__mobile-action-btn ${J||P||q||k||z?"":"sports-designer__mobile-action-btn--disabled"}`,onClick:()=>{(J||P||q||k||z)&&(ce(),xe(!0))},disabled:!J&&!P&&!q&&!k&&!z,children:[o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("line",{x1:"4",y1:"21",x2:"4",y2:"14"}),o.jsx("line",{x1:"4",y1:"10",x2:"4",y2:"3"}),o.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"12"}),o.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"3"}),o.jsx("line",{x1:"20",y1:"21",x2:"20",y2:"16"}),o.jsx("line",{x1:"20",y1:"12",x2:"20",y2:"3"}),o.jsx("line",{x1:"1",y1:"14",x2:"7",y2:"14"}),o.jsx("line",{x1:"9",y1:"8",x2:"15",y2:"8"}),o.jsx("line",{x1:"17",y1:"16",x2:"23",y2:"16"})]}),o.jsx("span",{children:"Properties"})]}),o.jsxs("button",{className:"sports-designer__mobile-action-btn",onClick:()=>u(!0),children:[o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z"}),o.jsx("polyline",{points:"17 21 17 13 7 13 7 21"}),o.jsx("polyline",{points:"7 3 7 8 15 8"})]}),o.jsx("span",{children:"Save"})]})]}),o.jsx("div",{className:`sports-designer__bottom-sheet-overlay ${Pe?"sports-designer__bottom-sheet-overlay--open":""}`,onClick:()=>we(!1)}),o.jsxs("div",{className:`sports-designer__bottom-sheet ${Pe?"sports-designer__bottom-sheet--open":""}`,children:[o.jsx("div",{className:"sports-designer__bottom-sheet-handle"}),o.jsxs("div",{className:"sports-designer__bottom-sheet-header",children:[o.jsx("h3",{children:"Add Element"}),o.jsx("button",{className:"sports-designer__bottom-sheet-close",onClick:()=>we(!1),children:o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),o.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),o.jsxs("div",{className:"sports-designer__mobile-tabs",children:[o.jsx("button",{className:`sports-designer__mobile-tab ${$e==="courts"?"sports-designer__mobile-tab--active":""}`,onClick:()=>ue("courts"),children:"Courts"}),o.jsx("button",{className:`sports-designer__mobile-tab ${$e==="tracks"?"sports-designer__mobile-tab--active":""}`,onClick:()=>ue("tracks"),children:"Tracks"}),o.jsx("button",{className:`sports-designer__mobile-tab ${$e==="shapes"?"sports-designer__mobile-tab--active":""}`,onClick:()=>ue("shapes"),children:"Shapes"}),o.jsx("button",{className:`sports-designer__mobile-tab ${$e==="designs"?"sports-designer__mobile-tab--active":""}`,onClick:()=>ue("designs"),children:"Designs"})]}),o.jsx("div",{className:"sports-designer__bottom-sheet-content",children:o.jsx(P0,{mobileMode:!0,activeTab:$e,onItemAdded:()=>we(!1),onOpenGenerator:()=>{we(!1),m(!0)}})})]}),o.jsx("div",{className:`sports-designer__bottom-sheet-overlay ${Ge?"sports-designer__bottom-sheet-overlay--open":""}`,onClick:()=>S(!1)}),o.jsxs("div",{className:`sports-designer__bottom-sheet ${Ge?"sports-designer__bottom-sheet--open":""}`,children:[o.jsx("div",{className:"sports-designer__bottom-sheet-handle"}),o.jsxs("div",{className:"sports-designer__bottom-sheet-header",children:[o.jsx("h3",{children:"Surface Colour"}),o.jsx("button",{className:"sports-designer__bottom-sheet-close",onClick:()=>S(!1),children:o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),o.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),o.jsx("div",{className:"sports-designer__bottom-sheet-content",children:o.jsx("div",{className:"sports-designer__color-grid",children:dn.map(V=>o.jsx("button",{className:`sports-designer__color-swatch ${E.color.tpv_code===V.code?"sports-designer__color-swatch--selected":""}`,style:{backgroundColor:V.hex},onClick:()=>{N(V),S(!1)},title:`${V.code} - ${V.name}`,children:o.jsx("span",{className:"sports-designer__color-code",children:V.code})},V.code))})})]}),o.jsx("div",{className:`sports-designer__bottom-sheet-overlay ${Re?"sports-designer__bottom-sheet-overlay--open":""}`,onClick:()=>xe(!1)}),o.jsxs("div",{className:`sports-designer__bottom-sheet ${Re?"sports-designer__bottom-sheet--open":""}`,children:[o.jsx("div",{className:"sports-designer__bottom-sheet-handle"}),o.jsxs("div",{className:"sports-designer__bottom-sheet-header",children:[o.jsx("h3",{children:"Properties"}),o.jsx("button",{className:"sports-designer__bottom-sheet-close",onClick:()=>xe(!1),children:o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),o.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),o.jsx("div",{className:"sports-designer__bottom-sheet-content",children:(J||P||q||k||z)&&o.jsx(R0,{mobileMode:!0,onEditSourceDesign:G})})]}),o.jsxs("div",{className:"sports-designer__content",children:[!ke&&o.jsxs("aside",{className:`sports-designer__sidebar ${he?"":"sports-designer__sidebar--collapsed"}`,children:[o.jsxs("div",{className:"sidebar-content",children:[o.jsx(P0,{onOpenGenerator:()=>m(!0)}),o.jsx(i5,{})]}),o.jsx("button",{className:"sidebar-toggle sidebar-toggle--left",onClick:K,title:he?"Collapse library":"Expand library",children:o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:he?o.jsx("polyline",{points:"15 18 9 12 15 6"}):o.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),o.jsxs("main",{className:"sports-designer__canvas-container",children:[o.jsxs("div",{className:"sports-toolbar",children:[o.jsxs("div",{className:"sports-toolbar__group",children:[o.jsx("button",{className:`sports-toolbar__btn ${he?"sports-toolbar__btn--active":""}`,onClick:K,title:"Element Library",disabled:ke,children:o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),o.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),o.jsx("rect",{x:"3",y:"14",width:"7",height:"7"}),o.jsx("rect",{x:"14",y:"14",width:"7",height:"7"})]})}),o.jsx("button",{className:`sports-toolbar__btn ${Z&&(J||P||q||k||z)?"sports-toolbar__btn--active":""}`,onClick:H,title:"Properties",disabled:!J&&!P&&!q&&!k&&!z||ke,children:o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("line",{x1:"4",y1:"21",x2:"4",y2:"14"}),o.jsx("line",{x1:"4",y1:"10",x2:"4",y2:"3"}),o.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"12"}),o.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"3"}),o.jsx("line",{x1:"20",y1:"21",x2:"20",y2:"16"}),o.jsx("line",{x1:"20",y1:"12",x2:"20",y2:"3"}),o.jsx("line",{x1:"1",y1:"14",x2:"7",y2:"14"}),o.jsx("line",{x1:"9",y1:"8",x2:"15",y2:"8"}),o.jsx("line",{x1:"17",y1:"16",x2:"23",y2:"16"})]})})]}),o.jsx("div",{className:"sports-toolbar__divider"}),o.jsx("div",{className:"sports-toolbar__group",children:o.jsx("button",{className:`sports-toolbar__mode-toggle ${ke?"sports-toolbar__mode-toggle--active":""}`,onClick:pe,title:ke?"Switch to Edit Mode":"Switch to Focus Mode",children:ke?o.jsxs(o.Fragment,{children:[o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"})}),o.jsx("span",{children:"Focus"})]}):o.jsxs(o.Fragment,{children:[o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),o.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),o.jsx("rect",{x:"3",y:"14",width:"7",height:"7"}),o.jsx("rect",{x:"14",y:"14",width:"7",height:"7"})]}),o.jsx("span",{children:"Edit"})]})})}),o.jsx("div",{className:"sports-toolbar__divider"}),o.jsxs("div",{className:"sports-toolbar__group",children:[o.jsxs("button",{className:"sports-toolbar__dimensions",onClick:()=>{i(String(E.width_mm/1e3)),a(String(E.length_mm/1e3)),n(!0)},title:"Click to edit surface size",children:[(E.width_mm/1e3).toFixed(0),"m  ",(E.length_mm/1e3).toFixed(0),"m"]}),o.jsx("button",{className:"sports-toolbar__color-swatch",style:{backgroundColor:E.color.hex},onClick:()=>c(!0),title:`${E.color.name} (${E.color.tpv_code}) - Click to change`})]}),o.jsx("div",{className:"sports-toolbar__divider"}),o.jsxs("div",{className:"sports-toolbar__group",children:[o.jsx("button",{className:"sports-toolbar__btn",disabled:!st.getState().canUndo(),onClick:()=>st.getState().undo(),title:"Undo (Ctrl+Z)",children:o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("path",{d:"M3 7v6h6"}),o.jsx("path",{d:"M21 17a9 9 0 00-9-9 9 9 0 00-6 2.3L3 13"})]})}),o.jsx("button",{className:"sports-toolbar__btn",disabled:!st.getState().canRedo(),onClick:()=>st.getState().redo(),title:"Redo (Ctrl+Shift+Z)",children:o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("path",{d:"M21 7v6h-6"}),o.jsx("path",{d:"M3 17a9 9 0 019-9 9 9 0 016 2.3l3 2.7"})]})})]}),o.jsx("div",{className:"sports-toolbar__divider"}),o.jsxs("div",{className:"sports-toolbar__group",children:[o.jsx("button",{className:"sports-toolbar__btn",onClick:B,title:"Start new design",children:o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),o.jsx("polyline",{points:"14 2 14 8 20 8"}),o.jsx("line",{x1:"12",y1:"18",x2:"12",y2:"12"}),o.jsx("line",{x1:"9",y1:"15",x2:"15",y2:"15"})]})}),o.jsx("button",{className:"sports-toolbar__btn",onClick:oe,title:"View In-Situ Preview",children:o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),o.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),o.jsx("polyline",{points:"21 15 16 10 5 21"})]})}),o.jsx("button",{className:"sports-toolbar__btn",onClick:()=>h(!0),title:"Keyboard shortcuts (?)",children:o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("circle",{cx:"12",cy:"12",r:"10"}),o.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),o.jsx("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]})}),o.jsx("button",{className:"sports-toolbar__btn-primary",onClick:()=>u(!0),children:"Save"}),o.jsx(O0,{svgRef:j})]})]}),o.jsx(RE,{ref:j}),o.jsx(_7,{})]}),(J||P||q||k||z)&&!ke&&o.jsxs("aside",{className:`sports-designer__properties ${Z?"":"sports-designer__properties--collapsed"}`,children:[o.jsx("button",{className:"sidebar-toggle sidebar-toggle--right",onClick:H,title:Z?"Collapse properties":"Expand properties",children:o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:Z?o.jsx("polyline",{points:"9 18 15 12 9 6"}):o.jsx("polyline",{points:"15 18 9 12 15 6"})})}),o.jsx("div",{className:"sidebar-content",children:o.jsx(R0,{onEditSourceDesign:G})})]})]}),l&&o.jsx("div",{className:"sports-designer__color-modal-overlay",onClick:()=>c(!1),children:o.jsxs("div",{className:"sports-designer__color-modal",onClick:V=>V.stopPropagation(),children:[o.jsxs("div",{className:"sports-designer__color-modal-header",children:[o.jsx("h4",{children:"Select Surface Colour"}),o.jsx("button",{onClick:()=>c(!1),children:""})]}),o.jsx("div",{className:"sports-designer__color-grid",children:dn.map(V=>o.jsx("button",{className:`sports-designer__color-swatch ${E.color.tpv_code===V.code?"sports-designer__color-swatch--selected":""}`,style:{backgroundColor:V.hex},onClick:()=>N(V),title:`${V.code} - ${V.name}`,children:o.jsx("span",{className:"sports-designer__color-code",children:V.code})},V.code))})]})}),d&&o.jsx(p5,{existingDesignId:b,initialName:C,svgRef:j,onClose:()=>u(!1),onSaved:(V,$)=>{w(V.design_id),_($),console.log("[SPORTS] Design saved:",V.design_id)}}),o.jsx(S5,{isOpen:p,onClose:()=>h(!1)}),o.jsx(w7,{isOpen:f,onClose:()=>m(!1)}),g&&y&&o.jsx(w_,{designUrl:y,designDimensions:{width:E.width_mm,length:E.length_mm},onClose:de,onSaved:V=>{console.log("[TPV] In-situ preview saved:",V),de()}})]})]})}function k7({onShowDesigns:e,onShowAdmin:t,isAdmin:n,currentDesignName:r}){const[i,s]=R.useState(!1),a=async()=>{confirm("Sign out?")&&(await Br.signOut(),window.location.reload())};return o.jsx("header",{className:"studio-header",children:o.jsxs("div",{className:"header-content",children:[o.jsxs("div",{className:"header-left",children:[o.jsx("h1",{className:"studio-title",children:"TPV Designer"}),r&&o.jsxs("span",{className:"current-design-indicator",children:[o.jsx("svg",{width:"4",height:"4",viewBox:"0 0 4 4",children:o.jsx("circle",{cx:"2",cy:"2",r:"2",fill:"currentColor"})}),r]})]}),o.jsxs("div",{className:"header-right",children:[o.jsxs("button",{onClick:e,className:"btn-my-designs",children:[o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"}),o.jsx("path",{d:"M9 22V12h6v10"})]}),"My Designs"]}),n&&o.jsxs("button",{onClick:t,className:"btn-admin",children:[o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M12 15a3 3 0 100-6 3 3 0 000 6z"}),o.jsx("path",{d:"M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z"})]}),"Admin"]}),o.jsxs("div",{className:"user-menu",children:[o.jsx("button",{onClick:()=>s(!i),className:"user-menu-button",children:o.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"}),o.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),i&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"user-menu-backdrop",onClick:()=>s(!1)}),o.jsx("div",{className:"user-menu-dropdown",children:o.jsxs("button",{onClick:a,className:"menu-item sign-out",children:[o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4M16 17l5-5-5-5M21 12H9"})}),"Sign Out"]})})]})]})]})]})})}function j7({design:e,onLoad:t,onDelete:n,onUpdateMetadata:r}){var m;const[i,s]=R.useState(!1),[a,l]=R.useState(!1),c=async()=>{if(confirm(`Delete "${e.name}"? This cannot be undone.`)){l(!0);try{await n(e.id)}catch(g){console.error("Failed to delete design:",g),alert(`Failed to delete: ${g.message}`),l(!1)}}},d=g=>{const x=new Date(g),y=new Date,v=y-x,b=Math.floor(v/(1e3*60*60*24));return b===0?"Today":b===1?"Yesterday":b<7?`${b} days ago`:b<30?`${Math.floor(b/7)} weeks ago`:x.toLocaleDateString("en-GB",{day:"numeric",month:"short",year:x.getFullYear()!==y.getFullYear()?"numeric":void 0})},u=e.input_mode==="sports_surface"||((m=e.design_data)==null?void 0:m.type)==="sports_surface",p=e.thumbnail_url||e.original_png_url||e.original_svg_url,f=u?{label:"Surface",icon:"",className:"type-surface"}:{label:"Motif",icon:"",className:"type-motif"};return o.jsxs("div",{className:`design-card ${a?"deleting":""}`,onMouseEnter:()=>s(!0),onMouseLeave:()=>s(!1),children:[o.jsxs("div",{className:`design-type-badge ${f.className}`,children:[o.jsx("span",{className:"type-icon",children:f.icon}),o.jsx("span",{className:"type-label",children:f.label})]}),o.jsxs("div",{className:"card-thumbnail",onClick:()=>t(e.id),children:[p?o.jsx("img",{src:p,alt:e.name}):o.jsx("div",{className:"no-thumbnail",children:o.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[o.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),o.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),o.jsx("polyline",{points:"21 15 16 10 5 21"})]})}),i&&o.jsx("div",{className:"thumbnail-overlay",children:o.jsx("button",{className:"btn-load",children:"Open"})})]}),o.jsxs("div",{className:"card-info",children:[o.jsx("h3",{className:"design-name",title:e.name,children:e.name}),e.description&&o.jsx("p",{className:"design-description",title:e.description,children:e.description}),o.jsxs("div",{className:"card-meta",children:[e.projects&&o.jsx("span",{className:"project-badge",style:{backgroundColor:e.projects.color||"#1a365d"},title:e.projects.name,children:e.projects.name}),o.jsx("span",{className:"design-date",title:new Date(e.updated_at).toLocaleString(),children:d(e.updated_at)})]}),e.tags&&e.tags.length>0&&o.jsxs("div",{className:"design-tags",children:[e.tags.slice(0,3).map((g,x)=>o.jsx("span",{className:"tag",children:g},x)),e.tags.length>3&&o.jsxs("span",{className:"tag more",children:["+",e.tags.length-3]})]})]}),i&&!a&&o.jsxs("div",{className:"card-actions",children:[o.jsx("button",{onClick:()=>t(e.id),className:"action-btn load-btn",title:"Load design",children:o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),o.jsx("circle",{cx:"12",cy:"12",r:"3"})]})}),o.jsx("button",{onClick:c,className:"action-btn delete-btn",title:"Delete design",children:o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]}),a&&o.jsx("div",{className:"deleting-overlay",children:o.jsx("div",{className:"spinner"})})]})}function C7({onClose:e,onLoadDesign:t}){const[n,r]=R.useState([]),[i,s]=R.useState([]),[a,l]=R.useState(!0),[c,d]=R.useState(null),[u,p]=R.useState(""),[h,f]=R.useState(""),[m,g]=R.useState(!1),[x,y]=R.useState(!1);R.useEffect(()=>{v()},[u,h]);const v=async()=>{l(!0),d(null);try{const[_,j]=await Promise.all([jf(),rd({project_id:u||void 0,search:h||void 0,limit:12,offset:0})]);s(_.projects),r(j.designs),g(j.pagination.has_more)}catch(_){console.error("Failed to load designs:",_),d(_.message)}finally{l(!1)}},b=async()=>{if(!(x||!m)){y(!0);try{const _=await rd({project_id:u||void 0,search:h||void 0,limit:12,offset:n.length});r([...n,..._.designs]),g(_.pagination.has_more)}catch(_){console.error("Failed to load more designs:",_),d(_.message)}finally{y(!1)}}},w=async _=>{try{const{design:j}=await _l(_);t(j),e()}catch(j){console.error("Failed to load design:",j),alert(`Failed to load design: ${j.message}`)}},C=async _=>{try{await wC(_),r(n.filter(j=>j.id!==_))}catch(j){throw console.error("Failed to delete design:",j),j}};return o.jsx("div",{className:"modal-overlay",onClick:e,children:o.jsxs("div",{className:"modal-content design-gallery-modal",onClick:_=>_.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsx("h2",{children:"My Designs"}),o.jsx("button",{onClick:e,className:"close-button",children:""})]}),o.jsxs("div",{className:"gallery-filters",children:[o.jsx("div",{className:"filter-group",children:o.jsx("input",{type:"text",placeholder:"Search designs...",value:h,onChange:_=>f(_.target.value),className:"search-input"})}),o.jsx("div",{className:"filter-group",children:o.jsxs("select",{value:u,onChange:_=>p(_.target.value),className:"project-filter",children:[o.jsx("option",{value:"",children:"All Projects"}),i.map(_=>o.jsxs("option",{value:_.id,children:[_.name," (",_.design_count,")"]},_.id))]})})]}),o.jsxs("div",{className:"modal-body",children:[c&&o.jsxs("div",{className:"error-message",children:[c,o.jsx("button",{onClick:v,className:"btn-retry",children:"Retry"})]}),a?o.jsxs("div",{className:"loading-state",children:[o.jsx("div",{className:"spinner-large"}),o.jsx("p",{children:"Loading your designs..."})]}):n.length===0?o.jsxs("div",{className:"empty-state",children:[o.jsxs("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[o.jsx("path",{d:"M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z"}),o.jsx("path",{d:"M17 21v-8H7v8M7 3v5h8"})]}),o.jsx("h3",{children:"No designs yet"}),o.jsx("p",{children:h||u?"No designs match your filters. Try adjusting your search.":"Create your first design to see it here!"})]}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"designs-grid",children:n.map(_=>o.jsx(j7,{design:_,onLoad:w,onDelete:C},_.id))}),m&&o.jsx("div",{className:"load-more-section",children:o.jsx("button",{onClick:b,className:"btn-load-more",disabled:x,children:x?"Loading...":"Load More"})})]})]})]})})}function E7(){const[e,t]=R.useState([]),[n,r]=R.useState(0),[i,s]=R.useState(!1),[a,l]=R.useState(null),[c,d]=R.useState("all"),[u,p]=R.useState("all"),[h,f]=R.useState(""),[m,g]=R.useState(0),x=50,y=async()=>{var E,T;const _=await Jt.auth.getSession();return{"Content-Type":"application/json",Authorization:`Bearer ${(T=(E=_==null?void 0:_.data)==null?void 0:E.session)==null?void 0:T.access_token}`}},v=async()=>{s(!0),l(null);try{const _=await y(),j=new URLSearchParams({limit:x.toString(),offset:m.toString()});c!=="all"&&j.append("status",c),u!=="all"&&j.append("saved_status",u),h&&j.append("search",h);const E=await fetch(`/api/admin/jobs?${j.toString()}`,{headers:_}),T=await E.json();if(!E.ok)throw new Error(T.error||"Failed to fetch jobs");t(T.jobs),r(T.total)}catch(_){console.error("Failed to fetch jobs:",_),l(_.message)}finally{s(!1)}};R.useEffect(()=>{v()},[c,u,h,m]);const b=e.filter(_=>_.status==="completed").length,w=e.filter(_=>!_.is_saved&&_.status==="completed").length,C=e.filter(_=>_.is_saved).length;return o.jsxs("div",{className:"generations-tab",children:[o.jsxs("div",{className:"admin-stats-grid",children:[o.jsxs("div",{className:"admin-stat-card",children:[o.jsx("h3",{children:"Total Generations"}),o.jsx("p",{className:"stat-value",children:n}),o.jsx("span",{className:"stat-label",children:"All time"})]}),o.jsxs("div",{className:"admin-stat-card",children:[o.jsx("h3",{children:"Completed"}),o.jsx("p",{className:"stat-value",children:b}),o.jsx("span",{className:"stat-label",children:"Current page"})]}),o.jsxs("div",{className:"admin-stat-card success",children:[o.jsx("h3",{children:"Saved"}),o.jsx("p",{className:"stat-value",children:C}),o.jsx("span",{className:"stat-label",children:" Linked to designs"})]}),o.jsxs("div",{className:"admin-stat-card warning",children:[o.jsx("h3",{children:"Orphaned"}),o.jsx("p",{className:"stat-value",children:w}),o.jsx("span",{className:"stat-label",children:" Not saved"})]})]}),o.jsxs("div",{className:"admin-filters",children:[o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{children:"Status:"}),o.jsxs("select",{value:c,onChange:_=>d(_.target.value),children:[o.jsx("option",{value:"all",children:"All"}),o.jsx("option",{value:"completed",children:"Completed"}),o.jsx("option",{value:"failed",children:"Failed"}),o.jsx("option",{value:"running",children:"Running"}),o.jsx("option",{value:"queued",children:"Queued"})]})]}),o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{children:"Saved:"}),o.jsxs("select",{value:u,onChange:_=>p(_.target.value),children:[o.jsx("option",{value:"all",children:"All"}),o.jsx("option",{value:"saved",children:"Saved only"}),o.jsx("option",{value:"orphaned",children:"Orphaned only"})]})]}),o.jsxs("div",{className:"filter-group search",children:[o.jsx("label",{children:"Search prompt:"}),o.jsx("input",{type:"text",placeholder:"Search in prompts...",value:h,onChange:_=>f(_.target.value)})]})]}),i&&o.jsxs("div",{className:"admin-loading",children:[o.jsx("div",{className:"spinner"}),o.jsx("p",{children:"Loading jobs..."})]}),a&&o.jsx("div",{className:"admin-error",children:o.jsxs("p",{children:["Error: ",a]})}),!i&&e.length>0&&o.jsx("div",{className:"jobs-table-container",children:o.jsxs("table",{className:"jobs-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Thumbnail"}),o.jsx("th",{children:"Prompt"}),o.jsx("th",{children:"Dimensions"}),o.jsx("th",{children:"Status"}),o.jsx("th",{children:"Saved"}),o.jsx("th",{children:"User"}),o.jsx("th",{children:"Created"})]})}),o.jsx("tbody",{children:e.map(_=>o.jsxs("tr",{className:`job-row ${_.is_saved?"saved":"orphaned"} ${_.status}`,children:[o.jsx("td",{className:"thumbnail-cell",children:_.thumbnail_url?o.jsx("img",{src:_.thumbnail_url,alt:"Design",className:"job-thumbnail"}):o.jsx("div",{className:"thumbnail-placeholder",children:"No image"})}),o.jsx("td",{className:"prompt-cell",children:o.jsx("div",{className:"prompt-text",title:_.prompt,children:_.prompt||o.jsx("em",{children:"No prompt"})})}),o.jsx("td",{className:"dimensions-cell",children:_.width_mm&&_.length_mm?o.jsxs("span",{children:[_.width_mm,"  ",_.length_mm," mm"]}):o.jsx("em",{children:"N/A"})}),o.jsx("td",{className:"status-cell",children:o.jsx("span",{className:`status-badge ${_.status}`,children:_.status})}),o.jsx("td",{className:"saved-cell",children:_.is_saved?o.jsx("span",{className:"saved-badge",children:" Saved"}):o.jsx("span",{className:"orphaned-badge",children:" Orphaned"})}),o.jsx("td",{className:"user-cell",children:_.user_email}),o.jsx("td",{className:"date-cell",children:new Date(_.created_at).toLocaleDateString()})]},_.id))})]})}),!i&&e.length===0&&o.jsx("div",{className:"admin-empty",children:o.jsx("p",{children:"No jobs found matching your filters."})}),n>x&&o.jsxs("div",{className:"admin-pagination",children:[o.jsx("button",{onClick:()=>g(Math.max(0,m-x)),disabled:m===0,children:"Previous"}),o.jsxs("span",{children:["Showing ",m+1," to ",Math.min(m+x,n)," of ",n]}),o.jsx("button",{onClick:()=>g(m+x),disabled:m+x>=n,children:"Next"})]}),o.jsx("style",{children:`
        .jobs-table-container {
          overflow-x: auto;
          background: white;
          border-radius: 8px;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .jobs-table {
          width: 100%;
          border-collapse: collapse;
        }

        .jobs-table th {
          background: #f9fafb;
          padding: 1rem;
          text-align: left;
          font-weight: 600;
          font-size: 0.875rem;
          color: #374151;
          border-bottom: 1px solid #e5e7eb;
        }

        .jobs-table td {
          padding: 1rem;
          border-bottom: 1px solid #e5e7eb;
        }

        .job-row.saved {
          background: rgba(16, 185, 129, 0.03);
        }

        .job-row.orphaned {
          background: rgba(245, 158, 11, 0.03);
        }

        .thumbnail-cell {
          width: 80px;
        }

        .job-thumbnail {
          width: 64px;
          height: 64px;
          object-fit: cover;
          border-radius: 4px;
        }

        .thumbnail-placeholder {
          width: 64px;
          height: 64px;
          background: #f3f4f6;
          border-radius: 4px;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 0.75rem;
          color: #9ca3af;
        }

        .prompt-cell {
          max-width: 300px;
        }

        .prompt-text {
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
        }

        .status-badge {
          display: inline-block;
          padding: 0.25rem 0.75rem;
          border-radius: 9999px;
          font-size: 0.75rem;
          font-weight: 500;
        }

        .status-badge.completed {
          background: #d1fae5;
          color: #065f46;
        }

        .status-badge.failed {
          background: #fee2e2;
          color: #991b1b;
        }

        .status-badge.running {
          background: #dbeafe;
          color: #1e40af;
        }

        .status-badge.queued {
          background: #e0e7ff;
          color: #3730a3;
        }

        .saved-badge {
          color: #059669;
          font-weight: 500;
        }

        .orphaned-badge {
          color: #d97706;
          font-weight: 500;
        }

        .user-cell {
          font-size: 0.875rem;
          color: #6b7280;
        }

        .date-cell {
          font-size: 0.875rem;
          color: #6b7280;
          white-space: nowrap;
        }

        .admin-stat-card.success {
          border-left: 4px solid #10b981;
        }

        .admin-stat-card.warning {
          border-left: 4px solid #f59e0b;
        }
      `})]})}function T7(){const[e,t]=R.useState([]),[n,r]=R.useState(null),[i,s]=R.useState(!1),[a,l]=R.useState(null),[c,d]=R.useState(!1),[u,p]=R.useState(new Set),[h,f]=R.useState("all"),m=async()=>{var _,j;const w=await Jt.auth.getSession();return{"Content-Type":"application/json",Authorization:`Bearer ${(j=(_=w==null?void 0:w.data)==null?void 0:_.session)==null?void 0:j.access_token}`}},g=async()=>{s(!0),l(null);try{const w=await m(),C=new URLSearchParams;h!=="all"&&C.append("age_filter",h);const _=await fetch(`/api/admin/recovery/orphaned?${C.toString()}`,{headers:w}),j=await _.json();if(!_.ok)throw new Error(j.error||"Failed to fetch orphaned jobs");t(j.orphaned_jobs),r(j.age_buckets)}catch(w){console.error("Failed to fetch orphaned jobs:",w),l(w.message)}finally{s(!1)}};R.useEffect(()=>{g()},[h]);const x=w=>{const C=new Set(u);C.has(w)?C.delete(w):C.add(w),p(C)},y=()=>{p(new Set(e.map(w=>w.id)))},v=()=>{p(new Set)},b=async()=>{if(u.size===0){alert("Please select at least one job to recover");return}if(confirm(`Recover ${u.size} orphaned ${u.size===1?"design":"designs"}?`)){d(!0),l(null);try{const w=await m(),C=await fetch("/api/admin/recovery/create",{method:"POST",headers:w,body:JSON.stringify({job_ids:Array.from(u)})}),_=await C.json();if(!C.ok)throw new Error(_.error||"Failed to recover designs");alert(`Successfully recovered ${_.recovered_count} ${_.recovered_count===1?"design":"designs"}!`),v(),await g()}catch(w){console.error("Failed to recover designs:",w),l(w.message),alert(`Recovery failed: ${w.message}`)}finally{d(!1)}}};return o.jsxs("div",{className:"recovery-tab",children:[o.jsxs("div",{className:"admin-stats-grid",children:[o.jsxs("div",{className:"admin-stat-card warning",children:[o.jsx("h3",{children:"Total Orphaned"}),o.jsx("p",{className:"stat-value",children:e.length}),o.jsx("span",{className:"stat-label",children:"Designs not saved"})]}),n&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"admin-stat-card",children:[o.jsx("h3",{children:"<24 hours"}),o.jsx("p",{className:"stat-value",children:n["<24h"]}),o.jsx("span",{className:"stat-label",children:"Recent"})]}),o.jsxs("div",{className:"admin-stat-card",children:[o.jsx("h3",{children:"1-7 days"}),o.jsx("p",{className:"stat-value",children:n["1-7d"]}),o.jsx("span",{className:"stat-label",children:"This week"})]}),o.jsxs("div",{className:"admin-stat-card",children:[o.jsx("h3",{children:">7 days"}),o.jsx("p",{className:"stat-value",children:n["7-30d"]+n[">30d"]}),o.jsx("span",{className:"stat-label",children:"Older"})]})]})]}),o.jsxs("div",{className:"recovery-controls",children:[o.jsx("div",{className:"admin-filters",children:o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{children:"Age:"}),o.jsxs("select",{value:h,onChange:w=>f(w.target.value),children:[o.jsx("option",{value:"all",children:"All"}),o.jsx("option",{value:"24h",children:"<24 hours"}),o.jsx("option",{value:"7d",children:"<7 days"}),o.jsx("option",{value:"30d",children:"<30 days"})]})]})}),o.jsxs("div",{className:"bulk-actions",children:[o.jsx("button",{onClick:y,className:"btn-secondary",children:"Select All"}),o.jsxs("button",{onClick:v,className:"btn-secondary",children:["Clear (",u.size,")"]}),o.jsx("button",{onClick:b,disabled:u.size===0||c,className:"btn-primary",children:c?"Recovering...":`Recover Selected (${u.size})`})]})]}),i&&o.jsxs("div",{className:"admin-loading",children:[o.jsx("div",{className:"spinner"}),o.jsx("p",{children:"Loading orphaned jobs..."})]}),a&&o.jsx("div",{className:"admin-error",children:o.jsxs("p",{children:["Error: ",a]})}),!i&&e.length>0&&o.jsx("div",{className:"recovery-table-container",children:o.jsxs("table",{className:"recovery-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{style:{width:"40px"},children:o.jsx("input",{type:"checkbox",checked:u.size===e.length,onChange:w=>w.target.checked?y():v()})}),o.jsx("th",{children:"Thumbnail"}),o.jsx("th",{children:"Prompt / Auto-name"}),o.jsx("th",{children:"Dimensions"}),o.jsx("th",{children:"Age"}),o.jsx("th",{children:"User"})]})}),o.jsx("tbody",{children:e.map(w=>o.jsxs("tr",{className:u.has(w.id)?"selected":"",onClick:()=>x(w.id),children:[o.jsx("td",{onClick:C=>C.stopPropagation(),children:o.jsx("input",{type:"checkbox",checked:u.has(w.id),onChange:()=>x(w.id)})}),o.jsx("td",{className:"thumbnail-cell",children:w.thumbnail_url?o.jsx("img",{src:w.thumbnail_url,alt:"Design",className:"job-thumbnail"}):o.jsx("div",{className:"thumbnail-placeholder",children:"No image"})}),o.jsxs("td",{className:"prompt-cell",children:[o.jsx("div",{className:"prompt-text",title:w.prompt,children:w.auto_name}),w.prompt&&w.prompt.length>50&&o.jsx("div",{className:"prompt-full",children:w.prompt})]}),o.jsx("td",{className:"dimensions-cell",children:w.width_mm&&w.length_mm?o.jsxs("span",{children:[w.width_mm,"  ",w.length_mm," mm"]}):o.jsx("em",{children:"N/A"})}),o.jsx("td",{className:"age-cell",children:o.jsxs("span",{className:`age-badge ${w.age_bucket.replace(/[<>]/g,"")}`,children:[w.age_days," ",w.age_days===1?"day":"days"]})}),o.jsx("td",{className:"user-cell",children:w.user_email})]},w.id))})]})}),!i&&e.length===0&&o.jsx("div",{className:"admin-empty",children:o.jsx("p",{children:"No orphaned jobs found. All designs have been saved!"})}),o.jsx("style",{children:`
        .recovery-controls {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 1.5rem;
          flex-wrap: wrap;
          gap: 1rem;
        }

        .bulk-actions {
          display: flex;
          gap: 0.5rem;
        }

        .btn-primary {
          padding: 0.5rem 1rem;
          background: #ff6b35;
          color: white;
          border: none;
          border-radius: 4px;
          font-weight: 500;
          cursor: pointer;
        }

        .btn-primary:hover:not(:disabled) {
          background: #e55a2b;
        }

        .btn-primary:disabled {
          background: #d1d5db;
          cursor: not-allowed;
        }

        .btn-secondary {
          padding: 0.5rem 1rem;
          background: white;
          color: #374151;
          border: 1px solid #d1d5db;
          border-radius: 4px;
          font-weight: 500;
          cursor: pointer;
        }

        .btn-secondary:hover {
          background: #f9fafb;
        }

        .recovery-table-container {
          overflow-x: auto;
          background: white;
          border-radius: 8px;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .recovery-table {
          width: 100%;
          border-collapse: collapse;
        }

        .recovery-table th {
          background: #f9fafb;
          padding: 1rem;
          text-align: left;
          font-weight: 600;
          font-size: 0.875rem;
          color: #374151;
          border-bottom: 1px solid #e5e7eb;
        }

        .recovery-table td {
          padding: 1rem;
          border-bottom: 1px solid #e5e7eb;
        }

        .recovery-table tbody tr {
          cursor: pointer;
          transition: background 0.15s;
        }

        .recovery-table tbody tr:hover {
          background: #f9fafb;
        }

        .recovery-table tbody tr.selected {
          background: #eff6ff;
        }

        .age-badge {
          display: inline-block;
          padding: 0.25rem 0.75rem;
          border-radius: 9999px;
          font-size: 0.75rem;
          font-weight: 500;
        }

        .age-badge.24h {
          background: #fee2e2;
          color: #991b1b;
        }

        .age-badge.1-7d {
          background: #fed7aa;
          color: #92400e;
        }

        .age-badge.7-30d {
          background: #fef3c7;
          color: #78350f;
        }

        .age-badge.30d {
          background: #e5e7eb;
          color: #374151;
        }

        .prompt-full {
          font-size: 0.75rem;
          color: #6b7280;
          margin-top: 0.25rem;
          display: none;
        }

        .recovery-table tbody tr:hover .prompt-full {
          display: block;
        }
      `})]})}function N7({onClose:e}){const[t,n]=R.useState("overview"),[r,i]=R.useState(!0),[s,a]=R.useState(null),[l,c]=R.useState(null),[d,u]=R.useState([]),[p,h]=R.useState([]),[f,m]=R.useState(0),[g,x]=R.useState(null),y=async()=>{var E,T;const _=await Jt.auth.getSession();return{"Content-Type":"application/json",Authorization:`Bearer ${(T=(E=_==null?void 0:_.data)==null?void 0:E.session)==null?void 0:T.access_token}`}},v=async()=>{try{const _=await y(),j=await fetch("/api/admin/analytics/overview",{headers:_}),E=await j.json();if(!j.ok)throw new Error(E.error||"Failed to fetch overview");c(E.stats)}catch(_){console.error("Failed to fetch overview:",_),a(_.message)}},b=async()=>{try{const _=await y(),j=await fetch("/api/admin/users",{headers:_}),E=await j.json();if(!j.ok)throw new Error(E.error||"Failed to fetch users");u(E.users)}catch(_){console.error("Failed to fetch users:",_),a(_.message)}},w=async()=>{try{const _=await y(),j=await fetch("/api/admin/designs?limit=50",{headers:_}),E=await j.json();if(!j.ok)throw new Error(E.error||"Failed to fetch designs");h(E.designs),m(E.total)}catch(_){console.error("Failed to fetch designs:",_),a(_.message)}},C=async()=>{try{const _=await y(),j=await fetch("/api/admin/analytics/colours",{headers:_}),E=await j.json();if(!j.ok)throw new Error(E.error||"Failed to fetch colour analytics");x(E.analytics)}catch(_){console.error("Failed to fetch colours:",_),a(_.message)}};return R.useEffect(()=>{(async()=>{i(!0),await v(),i(!1)})()},[]),R.useEffect(()=>{t==="users"&&d.length===0?b():t==="designs"&&p.length===0?w():t==="colours"&&!g&&C()},[t]),r?o.jsxs("div",{className:"admin-loading",children:[o.jsx("div",{className:"spinner"}),o.jsx("p",{children:"Loading admin dashboard..."})]}):s?o.jsxs("div",{className:"admin-error",children:[o.jsx("h2",{children:"Access Denied"}),o.jsx("p",{children:s}),o.jsx("p",{children:"You need admin privileges to view this page."})]}):o.jsxs("div",{className:"admin-dashboard",children:[o.jsxs("header",{className:"admin-header",children:[o.jsxs("div",{className:"admin-header-left",children:[o.jsxs("button",{onClick:e,className:"btn-back",children:[o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7"})}),"Back to Studio"]}),o.jsx("h1",{children:"TPV Studio Admin"})]}),o.jsxs("nav",{className:"admin-nav",children:[o.jsx("button",{className:t==="overview"?"active":"",onClick:()=>n("overview"),children:"Overview"}),o.jsx("button",{className:t==="generations"?"active":"",onClick:()=>n("generations"),children:"Generations"}),o.jsx("button",{className:t==="recovery"?"active":"",onClick:()=>n("recovery"),children:"Recovery"}),o.jsx("button",{className:t==="users"?"active":"",onClick:()=>n("users"),children:"Users"}),o.jsx("button",{className:t==="designs"?"active":"",onClick:()=>n("designs"),children:"Designs"}),o.jsx("button",{className:t==="colours"?"active":"",onClick:()=>n("colours"),children:"Colour Analytics"})]})]}),o.jsxs("main",{className:"admin-content",children:[t==="overview"&&l&&o.jsx(P7,{stats:l}),t==="generations"&&o.jsx(E7,{}),t==="recovery"&&o.jsx(T7,{}),t==="users"&&o.jsx(R7,{users:d}),t==="designs"&&o.jsx(O7,{designs:p,total:f}),t==="colours"&&g&&o.jsx(A7,{analytics:g})]}),o.jsx("style",{jsx:!0,children:`
        .admin-dashboard {
          min-height: 100vh;
          background: #f8fafc;
        }

        .admin-header {
          background: white;
          border-bottom: 1px solid #e5e7eb;
          padding: 20px 40px;
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
        }

        .admin-header-left {
          display: flex;
          flex-direction: column;
          gap: 8px;
        }

        .btn-back {
          display: inline-flex;
          align-items: center;
          gap: 6px;
          padding: 6px 12px;
          background: #f3f4f6;
          border: 1px solid #e5e7eb;
          border-radius: 6px;
          font-size: 13px;
          color: #6b7280;
          cursor: pointer;
          transition: all 0.2s;
          width: fit-content;
        }

        .btn-back:hover {
          background: #e5e7eb;
          color: #374151;
        }

        .admin-header h1 {
          margin: 0;
          font-size: 24px;
          color: #1e4a7a;
        }

        .admin-nav {
          display: flex;
          gap: 8px;
        }

        .admin-nav button {
          padding: 8px 16px;
          border: 1px solid #e5e7eb;
          background: white;
          border-radius: 6px;
          cursor: pointer;
          font-size: 14px;
          color: #64748b;
          transition: all 0.2s;
        }

        .admin-nav button:hover {
          background: #f8fafc;
          color: #1e4a7a;
        }

        .admin-nav button.active {
          background: #1e4a7a;
          color: white;
          border-color: #1e4a7a;
        }

        .admin-content {
          padding: 24px 40px;
        }

        .admin-loading,
        .admin-error {
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          min-height: 50vh;
          text-align: center;
        }

        .admin-error h2 {
          color: #dc2626;
        }

        .spinner {
          width: 40px;
          height: 40px;
          border: 3px solid #e5e7eb;
          border-top-color: #1e4a7a;
          border-radius: 50%;
          animation: spin 0.8s linear infinite;
          margin-bottom: 16px;
        }

        @keyframes spin {
          to { transform: rotate(360deg); }
        }
      `})]})}function P7({stats:e}){return o.jsxs("div",{className:"overview-panel",children:[o.jsx("h2",{children:"Dashboard Overview"}),o.jsxs("div",{className:"stats-grid",children:[o.jsxs("div",{className:"stat-card",children:[o.jsx("div",{className:"stat-value",children:e.totals.users}),o.jsx("div",{className:"stat-label",children:"Total Users"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("div",{className:"stat-value",children:e.totals.designs}),o.jsx("div",{className:"stat-label",children:"Total Designs"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("div",{className:"stat-value",children:e.totals.projects}),o.jsx("div",{className:"stat-label",children:"Total Projects"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("div",{className:"stat-value",children:e.totals.jobs}),o.jsx("div",{className:"stat-label",children:"AI Jobs Run"})]})]}),o.jsxs("div",{className:"stats-grid",children:[o.jsxs("div",{className:"stat-card highlight",children:[o.jsx("div",{className:"stat-value",children:e.activity.active_users_30d}),o.jsx("div",{className:"stat-label",children:"Active Users (30d)"})]}),o.jsxs("div",{className:"stat-card highlight",children:[o.jsx("div",{className:"stat-value",children:e.activity.designs_7d}),o.jsx("div",{className:"stat-label",children:"Designs This Week"})]}),o.jsxs("div",{className:"stat-card highlight",children:[o.jsx("div",{className:"stat-value",children:e.activity.designs_30d}),o.jsx("div",{className:"stat-label",children:"Designs This Month"})]}),o.jsxs("div",{className:"stat-card highlight",children:[o.jsxs("div",{className:"stat-value",children:[e.activity.job_success_rate,"%"]}),o.jsx("div",{className:"stat-label",children:"Job Success Rate"})]})]}),o.jsx("h3",{children:"Activity Timeline (14 Days)"}),o.jsx("div",{className:"activity-chart",children:e.timeline.map((t,n)=>o.jsxs("div",{className:"bar-container",children:[o.jsx("div",{className:"bar",style:{height:`${Math.max(4,t.count*20)}px`},title:`${t.date}: ${t.count} designs`}),o.jsx("div",{className:"bar-label",children:t.date.split("-")[2]})]},n))}),o.jsxs("div",{className:"breakdowns",children:[o.jsxs("div",{className:"breakdown-card",children:[o.jsx("h4",{children:"Input Mode"}),o.jsxs("div",{className:"breakdown-items",children:[o.jsxs("div",{className:"breakdown-item",children:[o.jsx("span",{children:"Prompt"}),o.jsx("strong",{children:e.breakdowns.input_mode.prompt})]}),o.jsxs("div",{className:"breakdown-item",children:[o.jsx("span",{children:"Image Upload"}),o.jsx("strong",{children:e.breakdowns.input_mode.image})]}),o.jsxs("div",{className:"breakdown-item",children:[o.jsx("span",{children:"SVG Upload"}),o.jsx("strong",{children:e.breakdowns.input_mode.svg})]})]})]}),o.jsxs("div",{className:"breakdown-card",children:[o.jsx("h4",{children:"View Mode Preference"}),o.jsxs("div",{className:"breakdown-items",children:[o.jsxs("div",{className:"breakdown-item",children:[o.jsx("span",{children:"Solid TPV"}),o.jsx("strong",{children:e.breakdowns.view_mode.solid})]}),o.jsxs("div",{className:"breakdown-item",children:[o.jsx("span",{children:"Blend TPV"}),o.jsx("strong",{children:e.breakdowns.view_mode.blend})]})]})]})]}),o.jsx("style",{jsx:!0,children:`
        .overview-panel h2 {
          margin: 0 0 24px 0;
          color: #1a202c;
        }

        .overview-panel h3 {
          margin: 32px 0 16px 0;
          color: #1a202c;
        }

        .stats-grid {
          display: grid;
          grid-template-columns: repeat(4, 1fr);
          gap: 16px;
          margin-bottom: 16px;
        }

        .stat-card {
          background: white;
          padding: 20px;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
        }

        .stat-card.highlight {
          border-color: #1e4a7a;
          border-width: 2px;
        }

        .stat-value {
          font-size: 32px;
          font-weight: 700;
          color: #1e4a7a;
        }

        .stat-label {
          font-size: 14px;
          color: #64748b;
          margin-top: 4px;
        }

        .activity-chart {
          display: flex;
          align-items: flex-end;
          gap: 8px;
          height: 120px;
          padding: 16px;
          background: white;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
        }

        .bar-container {
          flex: 1;
          display: flex;
          flex-direction: column;
          align-items: center;
        }

        .bar {
          width: 100%;
          background: #1e4a7a;
          border-radius: 4px 4px 0 0;
          min-height: 4px;
        }

        .bar-label {
          font-size: 10px;
          color: #64748b;
          margin-top: 4px;
        }

        .breakdowns {
          display: grid;
          grid-template-columns: repeat(2, 1fr);
          gap: 16px;
          margin-top: 24px;
        }

        .breakdown-card {
          background: white;
          padding: 20px;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
        }

        .breakdown-card h4 {
          margin: 0 0 12px 0;
          color: #1a202c;
        }

        .breakdown-item {
          display: flex;
          justify-content: space-between;
          padding: 8px 0;
          border-bottom: 1px solid #f3f4f6;
        }

        .breakdown-item:last-child {
          border-bottom: none;
        }

        .breakdown-item span {
          color: #64748b;
        }

        .breakdown-item strong {
          color: #1a202c;
        }
      `})]})}function R7({users:e}){return o.jsxs("div",{className:"users-panel",children:[o.jsxs("h2",{children:["User Management (",e.length," users)"]}),o.jsxs("table",{className:"users-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Email"}),o.jsx("th",{children:"Role"}),o.jsx("th",{children:"Designs"}),o.jsx("th",{children:"Projects"}),o.jsx("th",{children:"Jobs"}),o.jsx("th",{children:"Last Design"}),o.jsx("th",{children:"Joined"})]})}),o.jsx("tbody",{children:e.map(t=>o.jsxs("tr",{children:[o.jsx("td",{children:t.email}),o.jsx("td",{children:o.jsx("span",{className:`role-badge ${t.role}`,children:t.role})}),o.jsx("td",{children:t.design_count}),o.jsx("td",{children:t.project_count}),o.jsx("td",{children:t.job_count}),o.jsx("td",{children:t.last_design_at?new Date(t.last_design_at).toLocaleDateString():"-"}),o.jsx("td",{children:new Date(t.created_at).toLocaleDateString()})]},t.id))})]}),o.jsx("style",{jsx:!0,children:`
        .users-panel h2 {
          margin: 0 0 24px 0;
          color: #1a202c;
        }

        .users-table {
          width: 100%;
          background: white;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
          border-collapse: collapse;
        }

        .users-table th,
        .users-table td {
          padding: 12px 16px;
          text-align: left;
          border-bottom: 1px solid #e5e7eb;
        }

        .users-table th {
          background: #f8fafc;
          font-weight: 600;
          color: #64748b;
          font-size: 12px;
          text-transform: uppercase;
        }

        .users-table td {
          font-size: 14px;
          color: #1a202c;
        }

        .role-badge {
          padding: 4px 8px;
          border-radius: 4px;
          font-size: 12px;
          font-weight: 500;
        }

        .role-badge.user {
          background: #f3f4f6;
          color: #64748b;
        }

        .role-badge.admin {
          background: #dbeafe;
          color: #1e40af;
        }

        .role-badge.superadmin {
          background: #fef3c7;
          color: #92400e;
        }
      `})]})}function O7({designs:e,total:t}){return o.jsxs("div",{className:"designs-panel",children:[o.jsxs("h2",{children:["All Designs (",t," total)"]}),o.jsx("div",{className:"designs-grid",children:e.map(n=>o.jsxs("div",{className:"design-card",children:[o.jsx("div",{className:"design-thumbnail",children:n.thumbnail_url||n.original_png_url?o.jsx("img",{src:n.thumbnail_url||n.original_png_url,alt:n.name}):o.jsx("div",{className:"no-image",children:"No preview"})}),o.jsxs("div",{className:"design-info",children:[o.jsx("h4",{children:n.name}),o.jsx("p",{className:"design-user",children:n.user_email}),o.jsx("p",{className:"design-date",children:new Date(n.created_at).toLocaleDateString()}),n.project&&o.jsx("span",{className:"project-badge",style:{backgroundColor:n.project.color||"#64748b"},children:n.project.name})]})]},n.id))}),o.jsx("style",{jsx:!0,children:`
        .designs-panel h2 {
          margin: 0 0 24px 0;
          color: #1a202c;
        }

        .designs-grid {
          display: grid;
          grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
          gap: 16px;
        }

        .design-card {
          background: white;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
          overflow: hidden;
        }

        .design-thumbnail {
          aspect-ratio: 1;
          background: #f3f4f6;
          overflow: hidden;
        }

        .design-thumbnail img {
          width: 100%;
          height: 100%;
          object-fit: cover;
        }

        .no-image {
          width: 100%;
          height: 100%;
          display: flex;
          align-items: center;
          justify-content: center;
          color: #9ca3af;
          font-size: 14px;
        }

        .design-info {
          padding: 12px;
        }

        .design-info h4 {
          margin: 0 0 4px 0;
          font-size: 14px;
          color: #1a202c;
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
        }

        .design-user {
          margin: 0;
          font-size: 12px;
          color: #64748b;
        }

        .design-date {
          margin: 4px 0;
          font-size: 12px;
          color: #9ca3af;
        }

        .project-badge {
          display: inline-block;
          padding: 2px 8px;
          border-radius: 10px;
          font-size: 10px;
          color: white;
        }
      `})]})}function A7({analytics:e}){return o.jsxs("div",{className:"colours-panel",children:[o.jsx("h2",{children:"Colour Usage Analytics"}),o.jsxs("div",{className:"colour-stats",children:[o.jsxs("div",{className:"stat-card",children:[o.jsx("div",{className:"stat-value",children:e.totals.designs_analysed}),o.jsx("div",{className:"stat-label",children:"Designs Analysed"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("div",{className:"stat-value",children:e.totals.colour_usages}),o.jsx("div",{className:"stat-label",children:"Total Colour Uses"})]})]}),o.jsx("h3",{children:"Top 10 TPV Colours"}),o.jsx("div",{className:"colour-list",children:e.top_colours.map((t,n)=>o.jsxs("div",{className:"colour-item",children:[o.jsxs("span",{className:"colour-rank",children:["#",n+1]}),o.jsx("div",{className:"colour-swatch",style:{backgroundColor:t.hex}}),o.jsxs("div",{className:"colour-info",children:[o.jsx("strong",{children:t.code}),o.jsx("span",{children:t.name})]}),o.jsxs("div",{className:"colour-count",children:[t.count," uses"]})]},t.code))}),o.jsx("h3",{children:"Colour Family Breakdown"}),o.jsx("div",{className:"family-bars",children:Object.entries(e.families).map(([t,n])=>o.jsxs("div",{className:"family-bar",children:[o.jsx("span",{className:"family-name",children:t}),o.jsx("div",{className:"bar-bg",children:o.jsx("div",{className:"bar-fill",style:{width:`${n/e.totals.colour_usages*100}%`,backgroundColor:M7(t)}})}),o.jsx("span",{className:"family-count",children:n})]},t))}),e.top_blends.length>0&&o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Top Blend Combinations"}),o.jsx("div",{className:"blend-list",children:e.top_blends.map((t,n)=>o.jsxs("div",{className:"blend-item",children:[o.jsx("div",{className:"blend-swatches",children:t.components.map((r,i)=>o.jsx("div",{className:"blend-swatch",style:{backgroundColor:r.hex},title:`${r.code} - ${r.name}`},i))}),o.jsx("div",{className:"blend-codes",children:t.components.map(r=>r.code).join(" + ")}),o.jsxs("div",{className:"blend-count",children:[t.count," uses"]})]},n))})]}),o.jsx("style",{jsx:!0,children:`
        .colours-panel h2 {
          margin: 0 0 24px 0;
          color: #1a202c;
        }

        .colours-panel h3 {
          margin: 32px 0 16px 0;
          color: #1a202c;
        }

        .colour-stats {
          display: grid;
          grid-template-columns: repeat(2, 1fr);
          gap: 16px;
          margin-bottom: 24px;
        }

        .stat-card {
          background: white;
          padding: 20px;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
        }

        .stat-value {
          font-size: 32px;
          font-weight: 700;
          color: #1e4a7a;
        }

        .stat-label {
          font-size: 14px;
          color: #64748b;
          margin-top: 4px;
        }

        .colour-list {
          background: white;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
          overflow: hidden;
        }

        .colour-item {
          display: flex;
          align-items: center;
          gap: 12px;
          padding: 12px 16px;
          border-bottom: 1px solid #f3f4f6;
        }

        .colour-item:last-child {
          border-bottom: none;
        }

        .colour-rank {
          width: 30px;
          font-size: 12px;
          color: #9ca3af;
        }

        .colour-swatch {
          width: 32px;
          height: 32px;
          border-radius: 6px;
          border: 1px solid #e5e7eb;
        }

        .colour-info {
          flex: 1;
        }

        .colour-info strong {
          display: block;
          color: #1a202c;
        }

        .colour-info span {
          font-size: 12px;
          color: #64748b;
        }

        .colour-count {
          font-weight: 600;
          color: #1e4a7a;
        }

        .family-bars {
          background: white;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
          padding: 16px;
        }

        .family-bar {
          display: flex;
          align-items: center;
          gap: 12px;
          margin-bottom: 12px;
        }

        .family-bar:last-child {
          margin-bottom: 0;
        }

        .family-name {
          width: 80px;
          font-size: 14px;
          color: #64748b;
          text-transform: capitalize;
        }

        .bar-bg {
          flex: 1;
          height: 20px;
          background: #f3f4f6;
          border-radius: 4px;
          overflow: hidden;
        }

        .bar-fill {
          height: 100%;
          border-radius: 4px;
        }

        .family-count {
          width: 50px;
          text-align: right;
          font-weight: 600;
          color: #1a202c;
        }

        .blend-list {
          background: white;
          border-radius: 8px;
          border: 1px solid #e5e7eb;
          overflow: hidden;
        }

        .blend-item {
          display: flex;
          align-items: center;
          gap: 12px;
          padding: 12px 16px;
          border-bottom: 1px solid #f3f4f6;
        }

        .blend-item:last-child {
          border-bottom: none;
        }

        .blend-swatches {
          display: flex;
          gap: 4px;
        }

        .blend-swatch {
          width: 24px;
          height: 24px;
          border-radius: 4px;
          border: 1px solid #e5e7eb;
        }

        .blend-codes {
          flex: 1;
          font-size: 14px;
          color: #1a202c;
        }

        .blend-count {
          font-weight: 600;
          color: #1e4a7a;
        }
      `})]})}function M7(e){return{reds:"#dc2626",greens:"#16a34a",blues:"#2563eb",yellows:"#ca8a04",neutrals:"#6b7280"}[e]||"#6b7280"}const Ju=[{code:"RH30",name:"Beige",hex:"#E4C4AA"},{code:"RH31",name:"Cream",hex:"#E8E3D8"},{code:"RH41",name:"Bright Yellow",hex:"#FFD833"},{code:"RH40",name:"Mustard",hex:"#E5A144"},{code:"RH50",name:"Orange",hex:"#F15B32"},{code:"RH01",name:"Standard Red",hex:"#A5362F"},{code:"RH02",name:"Bright Red",hex:"#E21F2F"},{code:"RH90",name:"Funky Pink",hex:"#E8457E"},{code:"RH21",name:"Purple",hex:"#493D8C"},{code:"RH20",name:"Standard Blue",hex:"#0075BC"},{code:"RH22",name:"Light Blue",hex:"#47AFE3"},{code:"RH23",name:"Azure",hex:"#039DC4"},{code:"RH26",name:"Turquoise",hex:"#00A6A3"},{code:"RH12",name:"Dark Green",hex:"#006C55"},{code:"RH10",name:"Standard Green",hex:"#609B63"},{code:"RH11",name:"Bright Green",hex:"#3BB44A"},{code:"RH32",name:"Brown",hex:"#8B5F3C"},{code:"RH65",name:"Pale Grey",hex:"#D9D9D6"},{code:"RH61",name:"Light Grey",hex:"#939598"},{code:"RH60",name:"Dark Grey",hex:"#59595B"},{code:"RH70",name:"Black",hex:"#231F20"}],xy=["ocean theme with dolphins and waves","jungle adventure with parrots","solar system with planets","garden with butterflies and flowers","racing track with cars","underwater coral reef scene","dinosaur footprints trail","rainbow with clouds"],$7=[...Array(60)].map(e=>({delay:`${Math.random()*3}s`,x:`${Math.random()*100}%`,y:`${Math.random()*100}%`,size:`${8+Math.random()*12}px`}));function L7(){const[e,t]=R.useState(""),[n,r]=R.useState(""),[i,s]=R.useState(""),[a,l]=R.useState(!1),[c,d]=R.useState(!1),[u,p]=R.useState(0);R.useEffect(()=>{const m=setInterval(()=>{p(g=>(g+1)%xy.length)},5e3);return()=>clearInterval(m)},[]);const h=async m=>{m.preventDefault(),s(""),l(!0);try{await Br.signIn(e,n)}catch(g){s(g.message||"Sign in failed")}finally{l(!1)}},f=m=>{var g;(g=document.getElementById(m))==null||g.scrollIntoView({behavior:"smooth"})};return o.jsxs("div",{className:"landing-page",children:[o.jsxs("nav",{className:"landing-nav",children:[o.jsxs("div",{className:"nav-logo",children:[o.jsxs("div",{className:"logo-main",children:[o.jsxs("span",{className:"logo-text",children:["Rosehill TPV",o.jsx("sup",{children:""})]}),o.jsx("span",{className:"logo-accent",children:"Studio"})]}),o.jsx("span",{className:"logo-byline",children:"by Rosehill Sports & Play"})]}),o.jsxs("div",{className:"nav-links",children:[o.jsx("button",{onClick:()=>f("features"),children:"Features"}),o.jsx("button",{onClick:()=>f("palette"),children:"Colours"}),o.jsx("button",{onClick:()=>d(!0),className:"nav-cta",children:"Sign In"})]})]}),o.jsxs("section",{className:"hero",children:[o.jsx("div",{className:"hero-background",children:o.jsx("div",{className:"granule-field",children:$7.map((m,g)=>o.jsx("div",{className:"granule",style:{"--delay":m.delay,"--x":m.x,"--y":m.y,"--color":Ju[g%Ju.length].hex,"--size":m.size}},g))})}),o.jsxs("div",{className:"hero-content",children:[o.jsxs("div",{className:"hero-badge",children:["Rosehill TPV",o.jsx("sup",{children:""})," Surface Design Platform"]}),o.jsxs("h1",{children:[o.jsx("span",{className:"hero-line-1",children:"Design Any"}),o.jsxs("span",{className:"hero-line-2",children:["Rosehill TPV",o.jsx("sup",{children:""})," Surface"]})]}),o.jsxs("p",{className:"hero-subtitle",children:["From AI-generated playground art to professional sports courts  one powerful design platform for all your Rosehill TPV",o.jsx("sup",{children:""})," surfaces."]}),o.jsxs("div",{className:"hero-ctas",children:[o.jsxs("button",{onClick:()=>d(!0),className:"cta-primary",children:["Start Designing",o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M5 12h14M12 5l7 7-7 7"})})]}),o.jsx("button",{onClick:()=>f("how-it-works"),className:"cta-secondary",children:"See How It Works"})]})]}),o.jsx("div",{className:"hero-visual",children:o.jsx("div",{className:"mockup-container",children:o.jsxs("div",{className:"mockup-screen",children:[o.jsx("div",{className:"mockup-header",children:o.jsxs("div",{className:"mockup-dots",children:[o.jsx("span",{}),o.jsx("span",{}),o.jsx("span",{})]})}),o.jsxs("div",{className:"mockup-content",children:[o.jsx("div",{className:"mockup-input",children:o.jsx("span",{className:"typing-text",children:xy[u]},u)}),o.jsxs("div",{className:"mockup-preview",children:[o.jsx("div",{className:"preview-shape shape-1"}),o.jsx("div",{className:"preview-shape shape-2"}),o.jsx("div",{className:"preview-shape shape-3"})]})]})]})})})]}),o.jsxs("section",{className:"unified-showcase",children:[o.jsxs("div",{className:"section-header",children:[o.jsx("span",{className:"section-tag",children:"One Powerful Tool"}),o.jsx("h2",{children:"Design Any Surface"}),o.jsx("p",{className:"section-subtitle",children:"Courts, tracks, playgrounds, and custom graphics  all in one canvas"})]}),o.jsx("div",{className:"showcase-container",children:o.jsxs("div",{className:"showcase-card",children:[o.jsxs("div",{className:"showcase-canvas",children:[o.jsxs("div",{className:"canvas-preview",children:[o.jsx("div",{className:"canvas-grid"}),o.jsxs("div",{className:"canvas-surface",children:[o.jsx("div",{className:"surface-court"}),o.jsx("div",{className:"surface-motif"})]})]}),o.jsxs("div",{className:"capability-pill pill-courts",children:[o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[o.jsx("rect",{x:"2",y:"4",width:"20",height:"16",rx:"2"}),o.jsx("circle",{cx:"12",cy:"12",r:"3"}),o.jsx("path",{d:"M2 12h4M18 12h4"})]}),o.jsx("span",{children:"Courts & Tracks"})]}),o.jsxs("div",{className:"capability-pill pill-ai",children:[o.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:o.jsx("path",{d:"M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2z"})}),o.jsx("span",{children:"AI Artwork"})]}),o.jsxs("div",{className:"capability-pill pill-upload",children:[o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[o.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),o.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),o.jsx("path",{d:"M21 15l-5-5L5 21"})]}),o.jsx("span",{children:"Custom Images"})]}),o.jsxs("div",{className:"capability-pill pill-layers",children:[o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[o.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5z"}),o.jsx("path",{d:"M2 17l10 5 10-5"}),o.jsx("path",{d:"M2 12l10 5 10-5"})]}),o.jsx("span",{children:"Layer & Combine"})]})]}),o.jsx("div",{className:"showcase-tagline",children:"One canvas. Unlimited possibilities."}),o.jsxs("div",{className:"showcase-features",children:[o.jsxs("div",{className:"showcase-feature",children:[o.jsx("div",{className:"feature-badge ai-badge",children:"AI-POWERED"}),o.jsx("span",{children:"Generate motifs from text descriptions"})]}),o.jsxs("div",{className:"showcase-feature",children:[o.jsx("div",{className:"feature-badge template-badge",children:"TEMPLATES"}),o.jsx("span",{children:"15+ professional court layouts"})]}),o.jsxs("div",{className:"showcase-feature",children:[o.jsx("div",{className:"feature-badge compose-badge",children:"COMPOSE"}),o.jsx("span",{children:"Mix courts, tracks & artwork freely"})]})]}),o.jsxs("button",{onClick:()=>d(!0),className:"cta-primary showcase-cta",children:["Start Designing",o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M5 12h14M12 5l7 7-7 7"})})]})]})})]}),o.jsxs("section",{id:"how-it-works",className:"how-it-works",children:[o.jsxs("div",{className:"section-header",children:[o.jsx("span",{className:"section-tag",children:"Process"}),o.jsx("h2",{children:"Three Steps to Production-Ready Designs"})]}),o.jsxs("div",{className:"steps-container",children:[o.jsxs("div",{className:"step",children:[o.jsx("div",{className:"step-number",children:"01"}),o.jsx("div",{className:"step-icon",children:o.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[o.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),o.jsx("path",{d:"M3 9h18M9 21V9"})]})}),o.jsx("h3",{children:"Set Up Your Surface"}),o.jsx("p",{children:"Define your dimensions and choose your base colour. Start with any size from small playgrounds to full athletic facilities."})]}),o.jsx("div",{className:"step-connector",children:o.jsx("svg",{viewBox:"0 0 100 20",preserveAspectRatio:"none",children:o.jsx("path",{d:"M0 10 Q50 10 100 10",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeDasharray:"4 4"})})}),o.jsxs("div",{className:"step",children:[o.jsx("div",{className:"step-number",children:"02"}),o.jsx("div",{className:"step-icon",children:o.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[o.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5z"}),o.jsx("path",{d:"M2 17l10 5 10-5"}),o.jsx("path",{d:"M2 12l10 5 10-5"})]})}),o.jsx("h3",{children:"Add Elements"}),o.jsx("p",{children:"Drop in courts and tracks from the library, generate AI artwork, upload your own designs  layer and combine freely."})]}),o.jsx("div",{className:"step-connector",children:o.jsx("svg",{viewBox:"0 0 100 20",preserveAspectRatio:"none",children:o.jsx("path",{d:"M0 10 Q50 10 100 10",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeDasharray:"4 4"})})}),o.jsxs("div",{className:"step",children:[o.jsx("div",{className:"step-number",children:"03"}),o.jsx("div",{className:"step-icon",children:o.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[o.jsx("path",{d:"M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"}),o.jsx("path",{d:"M14 2v6h6M12 18v-6M9 15l3 3 3-3"})]})}),o.jsx("h3",{children:"Export & Build"}),o.jsx("p",{children:"Generate professional PDFs with material specifications, colour recipes, and exact quantities for installation."})]})]})]}),o.jsxs("section",{id:"features",className:"features",children:[o.jsxs("div",{className:"section-header",children:[o.jsx("span",{className:"section-tag",children:"Capabilities"}),o.jsxs("h2",{children:["Everything You Need to Design Rosehill TPV",o.jsx("sup",{children:""})," Surfaces"]})]}),o.jsxs("div",{className:"features-grid unified-features",children:[o.jsxs("div",{className:"feature-card feature-highlight",children:[o.jsx("div",{className:"feature-icon",children:o.jsx("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:o.jsx("path",{d:"M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2z"})})}),o.jsx("h3",{children:"AI Text-to-Vector"}),o.jsxs("p",{children:["Describe any concept in natural language. Our AI transforms your words into production-ready vector designs optimised for Rosehill TPV",o.jsx("sup",{children:""})," surfaces."]}),o.jsx("div",{className:"feature-example",children:'"vibrant underwater scene with coral reef"'})]}),o.jsxs("div",{className:"feature-card",children:[o.jsx("div",{className:"feature-icon",children:o.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[o.jsx("rect",{x:"2",y:"4",width:"20",height:"16",rx:"2"}),o.jsx("circle",{cx:"12",cy:"12",r:"3"}),o.jsx("path",{d:"M2 12h4M18 12h4"})]})}),o.jsx("h3",{children:"Court & Track Library"}),o.jsx("p",{children:"15+ professional templates including basketball, tennis, netball, futsal, and running tracks."})]}),o.jsxs("div",{className:"feature-card",children:[o.jsx("div",{className:"feature-icon",children:o.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[o.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),o.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),o.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),o.jsx("h3",{children:"Image Vectorisation"}),o.jsxs("p",{children:["Upload any image and convert it to clean vectors optimised for Rosehill TPV",o.jsx("sup",{children:""})," production."]})]}),o.jsxs("div",{className:"feature-card",children:[o.jsx("div",{className:"feature-icon",children:o.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[o.jsx("circle",{cx:"13.5",cy:"6.5",r:"2.5"}),o.jsx("circle",{cx:"17.5",cy:"10.5",r:"2.5"}),o.jsx("circle",{cx:"8.5",cy:"7.5",r:"2.5"}),o.jsx("circle",{cx:"6.5",cy:"12.5",r:"2.5"})]})}),o.jsx("h3",{children:"Colour Matching"}),o.jsxs("p",{children:["Automatic colour matching to the Rosehill TPV",o.jsx("sup",{children:""})," palette with precise specifications."]})]}),o.jsxs("div",{className:"feature-card",children:[o.jsx("div",{className:"feature-icon",children:o.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[o.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5z"}),o.jsx("path",{d:"M2 17l10 5 10-5"}),o.jsx("path",{d:"M2 12l10 5 10-5"})]})}),o.jsx("h3",{children:"Layer Management"}),o.jsx("p",{children:"Combine courts, tracks, and motifs freely. Drag, rotate, and layer with precision controls."})]}),o.jsxs("div",{className:"feature-card",children:[o.jsx("div",{className:"feature-icon",children:o.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[o.jsx("path",{d:"M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"}),o.jsx("path",{d:"M14 2v6h6M12 18v-6M9 15l3 3 3-3"})]})}),o.jsx("h3",{children:"PDF Specifications"}),o.jsx("p",{children:"Export production-ready material specs with colour specifications and installation guides."})]})]})]}),o.jsxs("section",{id:"palette",className:"palette-section",children:[o.jsxs("div",{className:"section-header light",children:[o.jsx("span",{className:"section-tag",children:"Palette"}),o.jsxs("h2",{children:["21 Standard Rosehill TPV",o.jsx("sup",{children:""})," Colours"]}),o.jsxs("p",{className:"section-subtitle",children:["The complete Rosehill TPV",o.jsx("sup",{children:""})," granule palette at your fingertips"]})]}),o.jsx("div",{className:"palette-grid",children:Ju.map((m,g)=>o.jsxs("div",{className:"palette-swatch",style:{"--swatch-color":m.hex,"--delay":`${g*.03}s`},children:[o.jsx("div",{className:"swatch-color"}),o.jsxs("div",{className:"swatch-info",children:[o.jsx("span",{className:"swatch-name",children:m.name}),o.jsx("span",{className:"swatch-code",children:m.code})]})]},m.code))})]}),o.jsx("section",{className:"benefits",children:o.jsxs("div",{className:"benefits-grid benefits-grid-4",children:[o.jsxs("div",{className:"benefit",children:[o.jsx("div",{className:"benefit-metric",children:"10x"}),o.jsx("div",{className:"benefit-label",children:"Faster Design"}),o.jsx("p",{children:"What took hours now takes minutes with AI and templates."})]}),o.jsxs("div",{className:"benefit",children:[o.jsx("div",{className:"benefit-metric",children:"100%"}),o.jsx("div",{className:"benefit-label",children:"Production Accurate"}),o.jsxs("p",{children:["Exact Rosehill TPV",o.jsx("sup",{children:""})," granule specs with precise specifications."]})]}),o.jsxs("div",{className:"benefit",children:[o.jsx("div",{className:"benefit-metric infinite-symbol",children:""}),o.jsx("div",{className:"benefit-label",children:"Combinations"}),o.jsx("p",{children:"Mix courts, tracks, and artwork in unlimited configurations."})]}),o.jsxs("div",{className:"benefit",children:[o.jsx("div",{className:"benefit-metric",children:"21"}),o.jsx("div",{className:"benefit-label",children:"Standard Colours"}),o.jsxs("p",{children:["Complete Rosehill TPV",o.jsx("sup",{children:""})," standard colour palette."]})]})]})}),o.jsx("footer",{className:"landing-footer",children:o.jsxs("div",{className:"footer-content",children:[o.jsxs("div",{className:"footer-brand",children:[o.jsxs("span",{className:"footer-logo",children:["Rosehill TPV",o.jsx("sup",{children:""})," Studio"]}),o.jsx("span",{className:"footer-tagline",children:"A web app by Rosehill Sports & Play"}),o.jsx("span",{className:"footer-division",children:"A Division of Rosehill Group"})]}),o.jsxs("div",{className:"footer-links",children:[o.jsx("a",{href:"https://rosehilltpv.com",target:"_blank",rel:"noopener noreferrer",children:"rosehilltpv.com"}),o.jsx("a",{href:"mailto:info@rosehill.group",children:"info@rosehill.group"})]})]})}),o.jsx("section",{className:"cta-footer",children:o.jsxs("div",{className:"cta-content",children:[o.jsx("h2",{children:"Ready to Design Your Surface?"}),o.jsxs("p",{children:["Create playgrounds or sports facilities with production-ready Rosehill TPV",o.jsx("sup",{children:""})," specifications."]}),o.jsxs("button",{onClick:()=>d(!0),className:"cta-primary large",children:["Sign In to Rosehill TPV",o.jsx("sup",{children:""})," Studio",o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M5 12h14M12 5l7 7-7 7"})})]}),o.jsxs("p",{className:"cta-note",children:["Need an account? Contact ",o.jsx("a",{href:"mailto:info@rosehill.group",children:"info@rosehill.group"})]})]})}),c&&o.jsx("div",{className:"modal-overlay",onClick:()=>d(!1),children:o.jsxs("div",{className:"sign-in-modal",onClick:m=>m.stopPropagation(),children:[o.jsx("button",{className:"modal-close",onClick:()=>d(!1),children:o.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})}),o.jsxs("div",{className:"modal-header",children:[o.jsx("h2",{children:"Sign In"}),o.jsxs("p",{children:["Access your Rosehill TPV",o.jsx("sup",{children:""})," Studio account"]})]}),i&&o.jsx("div",{className:"form-error",children:i}),o.jsxs("form",{onSubmit:h,children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Email"}),o.jsx("input",{type:"email",value:e,onChange:m=>t(m.target.value),placeholder:"your.email@company.com",required:!0})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Password"}),o.jsx("input",{type:"password",value:n,onChange:m=>r(m.target.value),required:!0})]}),o.jsx("button",{type:"submit",disabled:a,className:"submit-btn",children:a?"Signing in...":"Sign In"})]}),o.jsx("p",{className:"modal-footer-text",children:"Don't have an account? Contact your administrator."})]})}),o.jsx("style",{jsx:!0,children:`
        /* ============================================
           TPV STUDIO LANDING PAGE
           Aesthetic: Sophisticated Industrial-Creative
           ============================================ */

        @import url('https://fonts.googleapis.com/css2?family=Overpass:wght@300;400;500;600;700&family=Source+Sans+Pro:wght@300;400;600;700&display=swap');

        .landing-page {
          --primary: #1a365d;
          --primary-light: #2a4a73;
          --accent: #ff6b35;
          --accent-hover: #e55a2a;
          --text: #1a202c;
          --text-secondary: #64748b;
          --text-light: #94a3b8;
          --bg: #fafbfc;
          --bg-dark: #0f172a;
          --card: #ffffff;
          --border: #e2e8f0;

          font-family: 'Source Sans Pro', sans-serif;
          background: var(--bg);
          color: var(--text);
          overflow-x: hidden;
        }

        /* Navigation */
        .landing-nav {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          z-index: 1000;
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 1rem 3rem;
          background: rgba(255, 255, 255, 0.9);
          backdrop-filter: blur(12px);
          border-bottom: 1px solid var(--border);
        }

        .nav-logo {
          font-family: 'Overpass', sans-serif;
          font-size: 1.5rem;
          font-weight: 700;
        }

        .logo-text {
          color: var(--primary);
        }

        .logo-accent {
          color: var(--accent);
        }

        .nav-links {
          display: flex;
          align-items: center;
          gap: 2rem;
        }

        .nav-links button {
          background: none;
          border: none;
          font-family: inherit;
          font-size: 0.875rem;
          font-weight: 500;
          color: var(--text-secondary);
          cursor: pointer;
          transition: color 0.2s;
        }

        .nav-links button:hover {
          color: var(--text);
        }

        .nav-cta {
          background: var(--primary) !important;
          color: white !important;
          padding: 0.5rem 1.25rem !important;
          border-radius: 6px !important;
        }

        .nav-cta:hover {
          background: var(--primary-light) !important;
        }

        .logo-main {
          display: flex;
          align-items: baseline;
          gap: 0.25rem;
        }

        .logo-byline {
          display: block;
          font-size: 0.625rem;
          font-weight: 400;
          color: var(--text-light);
          margin-top: 2px;
          letter-spacing: 0.02em;
        }

        .landing-page sup {
          font-size: 0.6em;
          vertical-align: super;
          line-height: 0;
        }

        /* Hero Section */
        .hero {
          min-height: 100vh;
          display: grid;
          grid-template-columns: 1fr 1fr;
          align-items: center;
          padding: 8rem 4rem 4rem;
          position: relative;
          overflow: hidden;
        }

        .hero-background {
          position: absolute;
          inset: 0;
          pointer-events: none;
        }

        .granule-field {
          position: absolute;
          inset: 0;
        }

        .granule {
          position: absolute;
          left: var(--x);
          top: var(--y);
          width: var(--size);
          height: var(--size);
          background: var(--color);
          border-radius: 50%;
          opacity: 0.15;
          animation: float 8s ease-in-out infinite;
          animation-delay: var(--delay);
        }

        @keyframes float {
          0%, 100% { transform: translateY(0) scale(1); }
          50% { transform: translateY(-20px) scale(1.1); }
        }

        .hero-content {
          position: relative;
          z-index: 10;
        }

        .hero-badge {
          display: inline-block;
          padding: 0.5rem 1rem;
          background: rgba(30, 74, 122, 0.1);
          color: var(--primary);
          font-size: 0.75rem;
          font-weight: 600;
          text-transform: uppercase;
          letter-spacing: 0.1em;
          border-radius: 50px;
          margin-bottom: 1.5rem;
        }

        .hero h1 {
          font-family: 'Overpass', sans-serif;
          font-size: 3.5rem;
          font-weight: 700;
          line-height: 1.1;
          margin: 0 0 1.5rem;
        }

        .hero-line-1 {
          display: block;
          color: var(--text-secondary);
        }

        .hero-line-2 {
          display: block;
          color: var(--primary);
        }

        .hero-subtitle {
          font-size: 1.125rem;
          color: var(--text-secondary);
          line-height: 1.7;
          max-width: 480px;
          margin-bottom: 2rem;
        }

        .hero-ctas {
          display: flex;
          gap: 1rem;
        }

        .cta-primary {
          display: inline-flex;
          align-items: center;
          gap: 0.5rem;
          padding: 0.875rem 1.5rem;
          background: var(--accent);
          color: white;
          border: none;
          border-radius: 8px;
          font-family: inherit;
          font-size: 0.9375rem;
          font-weight: 600;
          cursor: pointer;
          transition: all 0.2s;
        }

        .cta-primary:hover {
          background: var(--accent-hover);
          transform: translateY(-2px);
          box-shadow: 0 8px 24px rgba(255, 107, 53, 0.3);
        }

        .cta-primary.large {
          padding: 1rem 2rem;
          font-size: 1rem;
        }

        .cta-secondary {
          padding: 0.875rem 1.5rem;
          background: white;
          color: var(--text);
          border: 2px solid var(--border);
          border-radius: 8px;
          font-family: inherit;
          font-size: 0.9375rem;
          font-weight: 600;
          cursor: pointer;
          transition: all 0.2s;
        }

        .cta-secondary:hover {
          border-color: var(--primary);
          color: var(--primary);
        }

        /* Hero Visual / Mockup */
        .hero-visual {
          position: relative;
          z-index: 10;
          display: flex;
          justify-content: center;
        }

        .mockup-container {
          perspective: 1000px;
        }

        .mockup-screen {
          width: 400px;
          background: white;
          border-radius: 12px;
          box-shadow: 0 24px 80px rgba(0, 0, 0, 0.15);
          overflow: hidden;
          transform: rotateY(-5deg) rotateX(2deg);
          animation: mockupFloat 6s ease-in-out infinite;
        }

        @keyframes mockupFloat {
          0%, 100% { transform: rotateY(-5deg) rotateX(2deg) translateY(0); }
          50% { transform: rotateY(-5deg) rotateX(2deg) translateY(-10px); }
        }

        .mockup-header {
          padding: 0.75rem 1rem;
          background: #f8f8f8;
          border-bottom: 1px solid #eee;
        }

        .mockup-dots {
          display: flex;
          gap: 6px;
        }

        .mockup-dots span {
          width: 10px;
          height: 10px;
          border-radius: 50%;
          background: #ddd;
        }

        .mockup-dots span:nth-child(1) { background: #ff5f56; }
        .mockup-dots span:nth-child(2) { background: #ffbd2e; }
        .mockup-dots span:nth-child(3) { background: #27ca41; }

        .mockup-content {
          padding: 1.5rem;
        }

        .mockup-input {
          background: #f5f5f5;
          padding: 1rem;
          border-radius: 8px;
          font-size: 0.875rem;
          color: var(--text-secondary);
          margin-bottom: 1.5rem;
          display: flex;
          align-items: center;
        }

        .typing-text {
          display: inline-block;
          overflow: hidden;
          white-space: nowrap;
          border-right: 2px solid var(--primary);
          animation: typing 5s steps(40, end) forwards, blink 0.7s step-end infinite;
        }

        @keyframes typing {
          0% { max-width: 0; }
          35% { max-width: 500px; }
          65% { max-width: 500px; }
          100% { max-width: 0; }
        }

        @keyframes blink {
          50% { border-color: transparent; }
        }

        .mockup-preview {
          height: 180px;
          background: linear-gradient(135deg, #e8f4f8, #f0f4ff);
          border-radius: 8px;
          position: relative;
          overflow: hidden;
        }

        .preview-shape {
          position: absolute;
          border-radius: 50%;
          animation: shapeReveal 4s ease-out infinite;
        }

        .shape-1 {
          width: 80px;
          height: 80px;
          background: var(--accent);
          opacity: 0.8;
          top: 20%;
          left: 15%;
          animation-delay: 0s;
        }

        .shape-2 {
          width: 60px;
          height: 60px;
          background: #30D5C8;
          opacity: 0.8;
          top: 40%;
          left: 50%;
          animation-delay: 0.3s;
        }

        .shape-3 {
          width: 100px;
          height: 100px;
          background: var(--primary);
          opacity: 0.8;
          top: 50%;
          right: 10%;
          animation-delay: 0.6s;
        }

        @keyframes shapeReveal {
          0%, 100% { transform: scale(0.8); opacity: 0.4; }
          50% { transform: scale(1); opacity: 0.8; }
        }

        /* Section Headers */
        .section-header {
          text-align: center;
          margin-bottom: 4rem;
        }

        .section-header.light h2,
        .section-header.light .section-subtitle {
          color: white;
        }

        .section-header.light .section-tag {
          background: rgba(255, 255, 255, 0.1);
          color: rgba(255, 255, 255, 0.9);
        }

        .section-tag {
          display: inline-block;
          padding: 0.375rem 0.875rem;
          background: rgba(30, 74, 122, 0.1);
          color: var(--primary);
          font-size: 0.6875rem;
          font-weight: 600;
          text-transform: uppercase;
          letter-spacing: 0.15em;
          border-radius: 50px;
          margin-bottom: 1rem;
        }

        .section-header h2 {
          font-family: 'Overpass', sans-serif;
          font-size: 2.5rem;
          font-weight: 700;
          color: var(--text);
          margin: 0;
        }

        .section-subtitle {
          margin-top: 1rem;
          font-size: 1.125rem;
          color: var(--text-secondary);
        }

        /* How It Works */
        .how-it-works {
          padding: 6rem 4rem;
          background: white;
        }

        .steps-container {
          display: flex;
          align-items: flex-start;
          justify-content: center;
          gap: 1rem;
        }

        .step {
          flex: 1;
          max-width: 280px;
          text-align: center;
          padding: 2rem 1.5rem;
        }

        .step-number {
          font-family: 'Overpass', sans-serif;
          font-size: 3rem;
          font-weight: 700;
          color: rgba(30, 74, 122, 0.1);
          margin-bottom: 1rem;
        }

        .step-icon {
          width: 64px;
          height: 64px;
          margin: 0 auto 1.5rem;
          display: flex;
          align-items: center;
          justify-content: center;
          background: rgba(255, 107, 53, 0.1);
          border-radius: 16px;
          color: var(--accent);
        }

        .step h3 {
          font-family: 'Overpass', sans-serif;
          font-size: 1.25rem;
          font-weight: 600;
          margin: 0 0 0.75rem;
          color: var(--text);
        }

        .step p {
          font-size: 0.9375rem;
          color: var(--text-secondary);
          line-height: 1.6;
          margin: 0;
        }

        .step-connector {
          width: 100px;
          padding-top: 5rem;
          color: var(--border);
        }

        /* Features */
        .features {
          padding: 6rem 4rem;
          background: var(--bg);
        }

        .features-grid {
          display: grid;
          grid-template-columns: repeat(3, 1fr);
          gap: 1.5rem;
          max-width: 1200px;
          margin: 0 auto;
        }

        .feature-card {
          background: white;
          padding: 2rem;
          border-radius: 12px;
          border: 1px solid var(--border);
          transition: all 0.3s;
        }

        .feature-card:hover {
          transform: translateY(-4px);
          box-shadow: 0 12px 40px rgba(0, 0, 0, 0.08);
        }

        .feature-highlight {
          grid-column: span 2;
          background: linear-gradient(135deg, var(--primary), var(--primary-light));
          color: white;
          border: none;
        }

        .feature-highlight .feature-icon {
          background: rgba(255, 255, 255, 0.2);
          color: white;
        }

        .feature-highlight h3 {
          color: white;
        }

        .feature-highlight p {
          color: rgba(255, 255, 255, 0.9);
        }

        .feature-icon {
          width: 56px;
          height: 56px;
          display: flex;
          align-items: center;
          justify-content: center;
          background: rgba(30, 74, 122, 0.1);
          border-radius: 12px;
          color: var(--primary);
          margin-bottom: 1.25rem;
        }

        .feature-card h3 {
          font-family: 'Overpass', sans-serif;
          font-size: 1.125rem;
          font-weight: 600;
          margin: 0 0 0.5rem;
        }

        .feature-card p {
          font-size: 0.875rem;
          color: var(--text-secondary);
          line-height: 1.6;
          margin: 0;
        }

        .feature-example {
          margin-top: 1.5rem;
          padding: 0.875rem 1rem;
          background: rgba(255, 255, 255, 0.1);
          border-radius: 8px;
          font-size: 0.8125rem;
          font-style: italic;
          opacity: 0.9;
        }

        /* Unified Showcase Section */
        .unified-showcase {
          padding: 6rem 4rem;
          background: white;
        }

        .showcase-container {
          max-width: 900px;
          margin: 0 auto;
        }

        .showcase-card {
          background: linear-gradient(135deg, #f8fafc, #f1f5f9);
          border-radius: 24px;
          padding: 3rem;
          border: 1px solid var(--border);
          text-align: center;
        }

        .showcase-canvas {
          position: relative;
          height: 280px;
          margin-bottom: 2rem;
        }

        .canvas-preview {
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 240px;
          height: 160px;
          background: white;
          border-radius: 12px;
          border: 2px solid var(--border);
          box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08);
          overflow: hidden;
        }

        .canvas-grid {
          position: absolute;
          inset: 0;
          background-image:
            linear-gradient(rgba(30, 74, 122, 0.05) 1px, transparent 1px),
            linear-gradient(90deg, rgba(30, 74, 122, 0.05) 1px, transparent 1px);
          background-size: 20px 20px;
        }

        .canvas-surface {
          position: absolute;
          inset: 10px;
          background: #e8f4f8;
          border-radius: 4px;
        }

        .surface-court {
          position: absolute;
          top: 20%;
          left: 15%;
          width: 70%;
          height: 60%;
          border: 2px solid #00a6a3;
          border-radius: 4px;
          opacity: 0.8;
        }

        .surface-court::before {
          content: '';
          position: absolute;
          top: 50%;
          left: 0;
          right: 0;
          height: 2px;
          background: #00a6a3;
        }

        .surface-court::after {
          content: '';
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 20px;
          height: 20px;
          border: 2px solid #00a6a3;
          border-radius: 50%;
        }

        .surface-motif {
          position: absolute;
          bottom: 10%;
          right: 10%;
          width: 35px;
          height: 35px;
          background: var(--accent);
          border-radius: 50%;
          opacity: 0.8;
          animation: motifPulse 3s ease-in-out infinite;
        }

        @keyframes motifPulse {
          0%, 100% { transform: scale(1); opacity: 0.8; }
          50% { transform: scale(1.1); opacity: 1; }
        }

        .capability-pill {
          position: absolute;
          display: flex;
          align-items: center;
          gap: 0.5rem;
          padding: 0.625rem 1rem;
          background: white;
          border-radius: 50px;
          box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
          font-size: 0.8125rem;
          font-weight: 500;
          color: var(--text);
          animation: pillFloat 4s ease-in-out infinite;
        }

        .pill-courts {
          top: 10%;
          left: 5%;
          animation-delay: 0s;
        }

        .pill-courts svg {
          color: #00a6a3;
        }

        .pill-ai {
          top: 5%;
          right: 10%;
          animation-delay: 0.5s;
        }

        .pill-ai svg {
          color: var(--accent);
        }

        .pill-upload {
          bottom: 15%;
          left: 8%;
          animation-delay: 1s;
        }

        .pill-upload svg {
          color: var(--primary);
        }

        .pill-layers {
          bottom: 10%;
          right: 5%;
          animation-delay: 1.5s;
        }

        .pill-layers svg {
          color: #30D5C8;
        }

        @keyframes pillFloat {
          0%, 100% { transform: translateY(0); }
          50% { transform: translateY(-8px); }
        }

        .showcase-tagline {
          font-family: 'Overpass', sans-serif;
          font-size: 1.5rem;
          font-weight: 600;
          color: var(--text);
          margin-bottom: 2rem;
        }

        .showcase-features {
          display: flex;
          justify-content: center;
          gap: 2rem;
          flex-wrap: wrap;
          margin-bottom: 2rem;
        }

        .showcase-feature {
          display: flex;
          align-items: center;
          gap: 0.625rem;
          font-size: 0.875rem;
          color: var(--text-secondary);
        }

        .feature-badge {
          padding: 0.25rem 0.625rem;
          border-radius: 50px;
          font-size: 0.625rem;
          font-weight: 700;
          letter-spacing: 0.05em;
        }

        .ai-badge {
          background: rgba(255, 107, 53, 0.1);
          color: var(--accent);
        }

        .template-badge {
          background: rgba(0, 166, 163, 0.1);
          color: #00a6a3;
        }

        .compose-badge {
          background: rgba(30, 74, 122, 0.1);
          color: var(--primary);
        }

        .showcase-cta {
          margin: 0 auto;
        }

        /* Unified Features Grid */
        .unified-features {
          grid-template-columns: repeat(3, 1fr);
        }

        /* Infinite symbol styling */
        .infinite-symbol {
          font-size: 3.5rem;
          line-height: 1;
        }

        /* Benefits Grid 4 columns */
        .benefits-grid-4 {
          grid-template-columns: repeat(4, 1fr);
        }

        /* Palette Section */
        .palette-section {
          padding: 6rem 4rem;
          background: var(--bg-dark);
        }

        .palette-grid {
          display: grid;
          grid-template-columns: repeat(7, 1fr);
          gap: 1rem;
          max-width: 1000px;
          margin: 0 auto;
        }

        .palette-swatch {
          animation: swatchReveal 0.5s ease-out forwards;
          animation-delay: var(--delay);
          opacity: 0;
          transform: translateY(20px);
        }

        @keyframes swatchReveal {
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        .swatch-color {
          aspect-ratio: 1;
          background: var(--swatch-color);
          border-radius: 8px;
          margin-bottom: 0.5rem;
          transition: transform 0.2s;
        }

        .palette-swatch:hover .swatch-color {
          transform: scale(1.1);
        }

        .swatch-info {
          text-align: center;
        }

        .swatch-name {
          display: block;
          font-size: 0.6875rem;
          font-weight: 500;
          color: white;
        }

        .swatch-code {
          display: block;
          font-size: 0.625rem;
          color: rgba(255, 255, 255, 0.5);
        }

        /* Benefits */
        .benefits {
          padding: 6rem 4rem;
          background: white;
        }

        .benefits-grid {
          display: grid;
          grid-template-columns: repeat(3, 1fr);
          gap: 3rem;
          max-width: 1000px;
          margin: 0 auto;
          text-align: center;
        }

        .benefit-metric {
          font-family: 'Overpass', sans-serif;
          font-size: 4rem;
          font-weight: 700;
          color: var(--accent);
          line-height: 1;
        }

        .benefit-label {
          font-family: 'Overpass', sans-serif;
          font-size: 1.125rem;
          font-weight: 600;
          color: var(--text);
          margin: 0.5rem 0 1rem;
        }

        .benefit p {
          font-size: 0.875rem;
          color: var(--text-secondary);
          line-height: 1.6;
          margin: 0;
        }

        /* Company Footer */
        .landing-footer {
          padding: 3rem 4rem;
          background: var(--bg-dark);
          border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .footer-content {
          max-width: 1200px;
          margin: 0 auto;
          display: flex;
          justify-content: space-between;
          align-items: center;
          flex-wrap: wrap;
          gap: 2rem;
        }

        .footer-brand {
          display: flex;
          flex-direction: column;
          gap: 0.25rem;
        }

        .footer-logo {
          font-family: 'Overpass', sans-serif;
          font-size: 1.25rem;
          font-weight: 600;
          color: white;
        }

        .footer-tagline {
          font-size: 0.875rem;
          color: rgba(255, 255, 255, 0.8);
        }

        .footer-division {
          font-size: 0.75rem;
          color: rgba(255, 255, 255, 0.5);
        }

        .footer-links {
          display: flex;
          gap: 2rem;
        }

        .footer-links a {
          font-size: 0.875rem;
          color: rgba(255, 255, 255, 0.7);
          text-decoration: none;
          transition: color 0.2s;
        }

        .footer-links a:hover {
          color: var(--accent);
        }

        /* CTA Footer */
        .cta-footer {
          padding: 6rem 4rem;
          background: var(--bg);
          text-align: center;
        }

        .cta-content h2 {
          font-family: 'Overpass', sans-serif;
          font-size: 2.5rem;
          font-weight: 700;
          color: var(--text);
          margin: 0 0 1rem;
        }

        .cta-content > p {
          font-size: 1.125rem;
          color: var(--text-secondary);
          margin-bottom: 2rem;
        }

        .cta-note {
          margin-top: 1.5rem;
          font-size: 0.875rem;
          color: var(--text-light);
        }

        .cta-note a {
          color: var(--primary);
          text-decoration: none;
        }

        .cta-note a:hover {
          text-decoration: underline;
        }

        /* Modal */
        .modal-overlay {
          position: fixed;
          inset: 0;
          background: rgba(0, 0, 0, 0.5);
          backdrop-filter: blur(4px);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 2000;
          padding: 2rem;
        }

        .sign-in-modal {
          background: white;
          border-radius: 16px;
          padding: 2.5rem;
          width: 100%;
          max-width: 400px;
          position: relative;
          animation: modalSlide 0.3s ease-out;
        }

        @keyframes modalSlide {
          from {
            opacity: 0;
            transform: translateY(-20px);
          }
        }

        .modal-close {
          position: absolute;
          top: 1rem;
          right: 1rem;
          width: 32px;
          height: 32px;
          display: flex;
          align-items: center;
          justify-content: center;
          background: none;
          border: none;
          color: var(--text-light);
          cursor: pointer;
          border-radius: 6px;
          transition: all 0.2s;
        }

        .modal-close:hover {
          background: var(--bg);
          color: var(--text);
        }

        .modal-header {
          text-align: center;
          margin-bottom: 1.5rem;
        }

        .modal-header h2 {
          font-family: 'Overpass', sans-serif;
          font-size: 1.5rem;
          font-weight: 600;
          margin: 0 0 0.25rem;
        }

        .modal-header p {
          font-size: 0.875rem;
          color: var(--text-secondary);
          margin: 0;
        }

        .form-error {
          padding: 0.75rem 1rem;
          background: #fef2f2;
          color: #dc2626;
          border-radius: 8px;
          font-size: 0.875rem;
          margin-bottom: 1rem;
        }

        .form-group {
          margin-bottom: 1rem;
        }

        .form-group label {
          display: block;
          font-size: 0.875rem;
          font-weight: 500;
          margin-bottom: 0.5rem;
        }

        .form-group input {
          width: 100%;
          padding: 0.75rem 1rem;
          border: 1px solid var(--border);
          border-radius: 8px;
          font-family: inherit;
          font-size: 0.9375rem;
          transition: all 0.2s;
        }

        .form-group input:focus {
          outline: none;
          border-color: var(--primary);
          box-shadow: 0 0 0 3px rgba(30, 74, 122, 0.1);
        }

        .submit-btn {
          width: 100%;
          padding: 0.875rem;
          background: var(--accent);
          color: white;
          border: none;
          border-radius: 8px;
          font-family: inherit;
          font-size: 0.9375rem;
          font-weight: 600;
          cursor: pointer;
          transition: all 0.2s;
        }

        .submit-btn:hover:not(:disabled) {
          background: var(--accent-hover);
        }

        .submit-btn:disabled {
          opacity: 0.6;
          cursor: not-allowed;
        }

        .modal-footer-text {
          text-align: center;
          font-size: 0.8125rem;
          color: var(--text-light);
          margin: 1.5rem 0 0;
        }

        /* Responsive */
        @media (max-width: 1024px) {
          .hero {
            grid-template-columns: 1fr;
            text-align: center;
          }

          .hero-content {
            max-width: 600px;
            margin: 0 auto;
          }

          .hero-subtitle {
            margin-left: auto;
            margin-right: auto;
          }

          .hero-ctas {
            justify-content: center;
          }

          .hero-visual {
            display: none;
          }

          .showcase-canvas {
            height: 240px;
          }

          .capability-pill {
            padding: 0.5rem 0.75rem;
            font-size: 0.75rem;
          }

          .features-grid {
            grid-template-columns: repeat(2, 1fr);
          }

          .unified-features {
            grid-template-columns: repeat(2, 1fr);
          }

          .feature-highlight {
            grid-column: span 2;
          }

          .benefits-grid-4 {
            grid-template-columns: repeat(2, 1fr);
          }

          .palette-grid {
            grid-template-columns: repeat(5, 1fr);
          }
        }

        @media (max-width: 768px) {
          .landing-nav {
            padding: 1rem 1.5rem;
          }

          .nav-links {
            gap: 1rem;
          }

          .hero {
            padding: 6rem 1.5rem 3rem;
          }

          .hero h1 {
            font-size: 2.5rem;
          }

          .steps-container {
            flex-direction: column;
            gap: 0;
          }

          .step-connector {
            display: none;
          }

          .features-grid,
          .unified-features {
            grid-template-columns: 1fr;
          }

          .feature-highlight {
            grid-column: span 1;
          }

          .section-header h2 {
            font-size: 2rem;
          }

          .how-it-works,
          .features,
          .palette-section,
          .benefits,
          .cta-footer,
          .unified-showcase,
          .landing-footer {
            padding: 4rem 1.5rem;
          }

          .footer-content {
            flex-direction: column;
            text-align: center;
          }

          .footer-links {
            flex-direction: column;
            gap: 1rem;
          }

          .logo-byline {
            display: none;
          }

          .showcase-card {
            padding: 2rem 1.5rem;
          }

          .showcase-canvas {
            height: 200px;
          }

          .canvas-preview {
            width: 180px;
            height: 120px;
          }

          .capability-pill {
            display: none;
          }

          .showcase-features {
            flex-direction: column;
            gap: 1rem;
          }

          .showcase-tagline {
            font-size: 1.25rem;
          }

          .benefits-grid,
          .benefits-grid-4 {
            grid-template-columns: 1fr;
            gap: 2rem;
          }

          .palette-grid {
            grid-template-columns: repeat(4, 1fr);
          }
        }

        @media (max-width: 480px) {
          .nav-links button:not(.nav-cta) {
            display: none;
          }

          .hero h1 {
            font-size: 2rem;
          }

          .cta-content h2 {
            font-size: 1.75rem;
          }

          .palette-grid {
            grid-template-columns: repeat(3, 1fr);
          }
        }
      `})]})}function I7({user:e,onPasswordSet:t}){const[n,r]=R.useState(""),[i,s]=R.useState(""),[a,l]=R.useState(!1),[c,d]=R.useState(""),u=async p=>{if(p.preventDefault(),d(""),n.length<8){d("Password must be at least 8 characters long");return}if(!/[A-Z]/.test(n)){d("Password must contain at least one uppercase letter");return}if(!/[a-z]/.test(n)){d("Password must contain at least one lowercase letter");return}if(!/[0-9]/.test(n)){d("Password must contain at least one number");return}if(n!==i){d("Passwords do not match");return}l(!0);try{await Br.updatePassword(n),t()}catch(h){d(h.message||"Failed to set password. Please try again.")}finally{l(!1)}};return o.jsx("div",{className:"tpv-studio",children:o.jsx("div",{className:"tpv-studio__container",style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh"},children:o.jsxs("div",{style:{maxWidth:"400px",width:"100%",padding:"2rem",background:"#fff",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[o.jsx("h2",{style:{marginBottom:"0.5rem",fontSize:"1.5rem"},children:"Welcome to TPV Studio"}),o.jsxs("p",{style:{marginBottom:"1.5rem",color:"#666",fontSize:"0.9rem"},children:["Please set a password for your account: ",o.jsx("strong",{children:e.email})]}),o.jsxs("form",{onSubmit:u,children:[o.jsxs("div",{style:{marginBottom:"1rem"},children:[o.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.9rem",fontWeight:"500"},children:"New Password"}),o.jsx("input",{type:"password",value:n,onChange:p=>r(p.target.value),placeholder:"Enter your password",required:!0,minLength:8,style:{width:"100%",padding:"0.75rem",border:"1px solid #ddd",borderRadius:"4px",fontSize:"1rem"}}),o.jsx("small",{style:{display:"block",marginTop:"0.25rem",color:"#666"},children:"At least 8 characters with uppercase, lowercase, and a number"})]}),o.jsxs("div",{style:{marginBottom:"1.5rem"},children:[o.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.9rem",fontWeight:"500"},children:"Confirm Password"}),o.jsx("input",{type:"password",value:i,onChange:p=>s(p.target.value),placeholder:"Confirm your password",required:!0,minLength:8,style:{width:"100%",padding:"0.75rem",border:"1px solid #ddd",borderRadius:"4px",fontSize:"1rem"}})]}),c&&o.jsx("div",{style:{padding:"0.75rem",marginBottom:"1rem",background:"#fee",border:"1px solid #fcc",borderRadius:"4px",color:"#c00",fontSize:"0.9rem"},children:c}),o.jsx("button",{type:"submit",disabled:a,style:{width:"100%",padding:"0.75rem",background:a?"#ccc":"#007bff",color:"#fff",border:"none",borderRadius:"4px",fontSize:"1rem",fontWeight:"500",cursor:a?"not-allowed":"pointer"},children:a?"Setting Password...":"Set Password"})]})]})})})}function D7(){const[e,t]=R.useState(null),[n,r]=R.useState(!0),[i,s]=R.useState(!1),[a,l]=R.useState(!1),[c,d]=R.useState(!1),[u,p]=R.useState(!1),[h,f]=R.useState(null),[m,g]=R.useState(null),x=async()=>{try{const w=await Br.getSession();if(!(w!=null&&w.access_token)){d(!1);return}const C=await fetch("/api/admin/users",{headers:{Authorization:`Bearer ${w.access_token}`}});d(C.ok)}catch{console.error("[APP] Admin check failed"),d(!1)}},y=async w=>{try{console.log("[APP] Loading design from URL:",w);const{design:C}=await _l(w);if(C){v(C);const _=new URL(window.location);_.searchParams.delete("design"),window.history.replaceState({},"",_)}}catch(C){console.error("[APP] Failed to load design from URL:",C)}};R.useEffect(()=>{Br.getSession().then(C=>{var j;const _=(C==null?void 0:C.user)||null;if(t(_),r(!1),_){const E=(j=_.user_metadata)==null?void 0:j.password_setup_complete;p(!E),x();const M=new URLSearchParams(window.location.search).get("design");M&&y(M)}});const{data:w}=Br.onAuthStateChange((C,_)=>{var E;const j=(_==null?void 0:_.user)||null;if(t(j),j){const T=(E=j.user_metadata)==null?void 0:E.password_setup_complete;p(!T),x()}else d(!1),p(!1)});return()=>w==null?void 0:w.unsubscribe()},[]);const v=w=>{f(w),g(w.name)},b=async()=>{p(!1);const w=await Br.getSession();t((w==null?void 0:w.user)||null)};return n?o.jsx("div",{className:"tpv-studio",children:o.jsx("div",{className:"tpv-studio__container",children:o.jsxs("div",{className:"tpv-studio__empty",children:[o.jsx("div",{className:"tpv-studio__spinner"}),o.jsx("p",{children:"Loading..."})]})})}):e?u?o.jsx(I7,{user:e,onPasswordSet:b}):a?o.jsx("div",{className:"tpv-studio",children:o.jsx(N7,{onClose:()=>l(!1)})}):o.jsx(_C,{children:o.jsxs("div",{className:"tpv-studio",children:[o.jsx(k7,{onShowDesigns:()=>s(!0),onShowAdmin:()=>l(!0),isAdmin:c,currentDesignName:m}),o.jsx("main",{className:"tpv-studio__container tpv-studio__container--full",children:o.jsx(S7,{loadedDesign:h})}),i&&o.jsx(C7,{onClose:()=>s(!1),onLoadDesign:v})]})}):o.jsx(L7,{})}Qu.createRoot(document.getElementById("root")).render(o.jsx(L.StrictMode,{children:o.jsx(D7,{})}))});export default z7();
//# sourceMappingURL=index-Bn2SPhQ7.js.map
